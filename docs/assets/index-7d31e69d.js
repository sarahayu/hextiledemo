function OE(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var x9=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function z2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function w9(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var R8={exports:{}},pr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gm=Symbol.for("react.element"),b9=Symbol.for("react.portal"),E9=Symbol.for("react.fragment"),T9=Symbol.for("react.strict_mode"),S9=Symbol.for("react.profiler"),C9=Symbol.for("react.provider"),M9=Symbol.for("react.context"),P9=Symbol.for("react.forward_ref"),k9=Symbol.for("react.suspense"),I9=Symbol.for("react.memo"),L9=Symbol.for("react.lazy"),Y5=Symbol.iterator;function D9(t){return t===null||typeof t!="object"?null:(t=Y5&&t[Y5]||t["@@iterator"],typeof t=="function"?t:null)}var B8={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z8=Object.assign,O8={};function Dd(t,e,n){this.props=t,this.context=e,this.refs=O8,this.updater=n||B8}Dd.prototype.isReactComponent={};Dd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Dd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function F8(){}F8.prototype=Dd.prototype;function FE(t,e,n){this.props=t,this.context=e,this.refs=O8,this.updater=n||B8}var NE=FE.prototype=new F8;NE.constructor=FE;z8(NE,Dd.prototype);NE.isPureReactComponent=!0;var X5=Array.isArray,N8=Object.prototype.hasOwnProperty,UE={current:null},U8={key:!0,ref:!0,__self:!0,__source:!0};function V8(t,e,n){var r,i={},s=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(s=""+e.key),e)N8.call(e,r)&&!U8.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var p=Array(o),w=0;w<o;w++)p[w]=arguments[w+2];i.children=p}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:gm,type:t,key:s,ref:l,props:i,_owner:UE.current}}function R9(t,e){return{$$typeof:gm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function VE(t){return typeof t=="object"&&t!==null&&t.$$typeof===gm}function B9(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var K5=/\/+/g;function wx(t,e){return typeof t=="object"&&t!==null&&t.key!=null?B9(""+t.key):e.toString(36)}function py(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case gm:case b9:l=!0}}if(l)return l=t,i=i(l),t=r===""?"."+wx(l,0):r,X5(i)?(n="",t!=null&&(n=t.replace(K5,"$&/")+"/"),py(i,e,n,"",function(w){return w})):i!=null&&(VE(i)&&(i=R9(i,n+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(K5,"$&/")+"/")+t)),e.push(i)),1;if(l=0,r=r===""?".":r+":",X5(t))for(var o=0;o<t.length;o++){s=t[o];var p=r+wx(s,o);l+=py(s,e,n,p,i)}else if(p=D9(t),typeof p=="function")for(t=p.call(t),o=0;!(s=t.next()).done;)s=s.value,p=r+wx(s,o++),l+=py(s,e,n,p,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function c1(t,e,n){if(t==null)return t;var r=[],i=0;return py(t,r,"","",function(s){return e.call(n,s,i++)}),r}function z9(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var No={current:null},gy={transition:null},O9={ReactCurrentDispatcher:No,ReactCurrentBatchConfig:gy,ReactCurrentOwner:UE};pr.Children={map:c1,forEach:function(t,e,n){c1(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return c1(t,function(){e++}),e},toArray:function(t){return c1(t,function(e){return e})||[]},only:function(t){if(!VE(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};pr.Component=Dd;pr.Fragment=E9;pr.Profiler=S9;pr.PureComponent=FE;pr.StrictMode=T9;pr.Suspense=k9;pr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O9;pr.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=z8({},t.props),i=t.key,s=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,l=UE.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(p in e)N8.call(e,p)&&!U8.hasOwnProperty(p)&&(r[p]=e[p]===void 0&&o!==void 0?o[p]:e[p])}var p=arguments.length-2;if(p===1)r.children=n;else if(1<p){o=Array(p);for(var w=0;w<p;w++)o[w]=arguments[w+2];r.children=o}return{$$typeof:gm,type:t.type,key:i,ref:s,props:r,_owner:l}};pr.createContext=function(t){return t={$$typeof:M9,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:C9,_context:t},t.Consumer=t};pr.createElement=V8;pr.createFactory=function(t){var e=V8.bind(null,t);return e.type=t,e};pr.createRef=function(){return{current:null}};pr.forwardRef=function(t){return{$$typeof:P9,render:t}};pr.isValidElement=VE;pr.lazy=function(t){return{$$typeof:L9,_payload:{_status:-1,_result:t},_init:z9}};pr.memo=function(t,e){return{$$typeof:I9,type:t,compare:e===void 0?null:e}};pr.startTransition=function(t){var e=gy.transition;gy.transition={};try{t()}finally{gy.transition=e}};pr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};pr.useCallback=function(t,e){return No.current.useCallback(t,e)};pr.useContext=function(t){return No.current.useContext(t)};pr.useDebugValue=function(){};pr.useDeferredValue=function(t){return No.current.useDeferredValue(t)};pr.useEffect=function(t,e){return No.current.useEffect(t,e)};pr.useId=function(){return No.current.useId()};pr.useImperativeHandle=function(t,e,n){return No.current.useImperativeHandle(t,e,n)};pr.useInsertionEffect=function(t,e){return No.current.useInsertionEffect(t,e)};pr.useLayoutEffect=function(t,e){return No.current.useLayoutEffect(t,e)};pr.useMemo=function(t,e){return No.current.useMemo(t,e)};pr.useReducer=function(t,e,n){return No.current.useReducer(t,e,n)};pr.useRef=function(t){return No.current.useRef(t)};pr.useState=function(t){return No.current.useState(t)};pr.useSyncExternalStore=function(t,e,n){return No.current.useSyncExternalStore(t,e,n)};pr.useTransition=function(){return No.current.useTransition()};pr.version="18.2.0";R8.exports=pr;var Ne=R8.exports;const nt=z2(Ne),F9=OE({__proto__:null,default:nt},[Ne]);var G8={exports:{}},Va={},$8={exports:{}},j8={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_t,Et){var Jt=_t.length;_t.push(Et);e:for(;0<Jt;){var In=Jt-1>>>1,Tn=_t[In];if(0<i(Tn,Et))_t[In]=Et,_t[Jt]=Tn,Jt=In;else break e}}function n(_t){return _t.length===0?null:_t[0]}function r(_t){if(_t.length===0)return null;var Et=_t[0],Jt=_t.pop();if(Jt!==Et){_t[0]=Jt;e:for(var In=0,Tn=_t.length,Pr=Tn>>>1;In<Pr;){var tr=2*(In+1)-1,or=_t[tr],hr=tr+1,Vn=_t[hr];if(0>i(or,Jt))hr<Tn&&0>i(Vn,or)?(_t[In]=Vn,_t[hr]=Jt,In=hr):(_t[In]=or,_t[tr]=Jt,In=tr);else if(hr<Tn&&0>i(Vn,Jt))_t[In]=Vn,_t[hr]=Jt,In=hr;else break e}}return Et}function i(_t,Et){var Jt=_t.sortIndex-Et.sortIndex;return Jt!==0?Jt:_t.id-Et.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var p=[],w=[],C=1,P=null,I=3,U=!1,W=!1,H=!1,ie=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(_t){for(var Et=n(w);Et!==null;){if(Et.callback===null)r(w);else if(Et.startTime<=_t)r(w),Et.sortIndex=Et.expirationTime,e(p,Et);else break;Et=n(w)}}function fe(_t){if(H=!1,se(_t),!W)if(n(p)!==null)W=!0,Tt(me);else{var Et=n(w);Et!==null&&dn(fe,Et.startTime-_t)}}function me(_t,Et){W=!1,H&&(H=!1,X(Qe),Qe=-1),U=!0;var Jt=I;try{for(se(Et),P=n(p);P!==null&&(!(P.expirationTime>Et)||_t&&!Ue());){var In=P.callback;if(typeof In=="function"){P.callback=null,I=P.priorityLevel;var Tn=In(P.expirationTime<=Et);Et=t.unstable_now(),typeof Tn=="function"?P.callback=Tn:P===n(p)&&r(p),se(Et)}else r(p);P=n(p)}if(P!==null)var Pr=!0;else{var tr=n(w);tr!==null&&dn(fe,tr.startTime-Et),Pr=!1}return Pr}finally{P=null,I=Jt,U=!1}}var Se=!1,He=null,Qe=-1,Ke=5,rt=-1;function Ue(){return!(t.unstable_now()-rt<Ke)}function it(){if(He!==null){var _t=t.unstable_now();rt=_t;var Et=!0;try{Et=He(!0,_t)}finally{Et?Ze():(Se=!1,He=null)}}else Se=!1}var Ze;if(typeof ee=="function")Ze=function(){ee(it)};else if(typeof MessageChannel<"u"){var yt=new MessageChannel,Kt=yt.port2;yt.port1.onmessage=it,Ze=function(){Kt.postMessage(null)}}else Ze=function(){ie(it,0)};function Tt(_t){He=_t,Se||(Se=!0,Ze())}function dn(_t,Et){Qe=ie(function(){_t(t.unstable_now())},Et)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_t){_t.callback=null},t.unstable_continueExecution=function(){W||U||(W=!0,Tt(me))},t.unstable_forceFrameRate=function(_t){0>_t||125<_t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ke=0<_t?Math.floor(1e3/_t):5},t.unstable_getCurrentPriorityLevel=function(){return I},t.unstable_getFirstCallbackNode=function(){return n(p)},t.unstable_next=function(_t){switch(I){case 1:case 2:case 3:var Et=3;break;default:Et=I}var Jt=I;I=Et;try{return _t()}finally{I=Jt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_t,Et){switch(_t){case 1:case 2:case 3:case 4:case 5:break;default:_t=3}var Jt=I;I=_t;try{return Et()}finally{I=Jt}},t.unstable_scheduleCallback=function(_t,Et,Jt){var In=t.unstable_now();switch(typeof Jt=="object"&&Jt!==null?(Jt=Jt.delay,Jt=typeof Jt=="number"&&0<Jt?In+Jt:In):Jt=In,_t){case 1:var Tn=-1;break;case 2:Tn=250;break;case 5:Tn=1073741823;break;case 4:Tn=1e4;break;default:Tn=5e3}return Tn=Jt+Tn,_t={id:C++,callback:Et,priorityLevel:_t,startTime:Jt,expirationTime:Tn,sortIndex:-1},Jt>In?(_t.sortIndex=Jt,e(w,_t),n(p)===null&&_t===n(w)&&(H?(X(Qe),Qe=-1):H=!0,dn(fe,Jt-In))):(_t.sortIndex=Tn,e(p,_t),W||U||(W=!0,Tt(me))),_t},t.unstable_shouldYield=Ue,t.unstable_wrapCallback=function(_t){var Et=I;return function(){var Jt=I;I=Et;try{return _t.apply(this,arguments)}finally{I=Jt}}}})(j8);$8.exports=j8;var N9=$8.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H8=Ne,Ua=N9;function Bt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var W8=new Set,wg={};function Sf(t,e){ad(t,e),ad(t+"Capture",e)}function ad(t,e){for(wg[t]=e,t=0;t<e.length;t++)W8.add(e[t])}var Ju=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gb=Object.prototype.hasOwnProperty,U9=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,J5={},eC={};function V9(t){return gb.call(eC,t)?!0:gb.call(J5,t)?!1:U9.test(t)?eC[t]=!0:(J5[t]=!0,!1)}function G9(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function $9(t,e,n,r){if(e===null||typeof e>"u"||G9(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Uo(t,e,n,r,i,s,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=l}var zs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){zs[t]=new Uo(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];zs[e]=new Uo(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){zs[t]=new Uo(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){zs[t]=new Uo(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){zs[t]=new Uo(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){zs[t]=new Uo(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){zs[t]=new Uo(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){zs[t]=new Uo(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){zs[t]=new Uo(t,5,!1,t.toLowerCase(),null,!1,!1)});var GE=/[\-:]([a-z])/g;function $E(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(GE,$E);zs[e]=new Uo(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(GE,$E);zs[e]=new Uo(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(GE,$E);zs[e]=new Uo(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){zs[t]=new Uo(t,1,!1,t.toLowerCase(),null,!1,!1)});zs.xlinkHref=new Uo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){zs[t]=new Uo(t,1,!1,t.toLowerCase(),null,!0,!0)});function jE(t,e,n,r){var i=zs.hasOwnProperty(e)?zs[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&($9(e,n,i,r)&&(n=null),r||i===null?V9(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var dc=H8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,h1=Symbol.for("react.element"),g0=Symbol.for("react.portal"),m0=Symbol.for("react.fragment"),HE=Symbol.for("react.strict_mode"),mb=Symbol.for("react.profiler"),Q8=Symbol.for("react.provider"),q8=Symbol.for("react.context"),WE=Symbol.for("react.forward_ref"),yb=Symbol.for("react.suspense"),_b=Symbol.for("react.suspense_list"),QE=Symbol.for("react.memo"),$c=Symbol.for("react.lazy"),Z8=Symbol.for("react.offscreen"),tC=Symbol.iterator;function dp(t){return t===null||typeof t!="object"?null:(t=tC&&t[tC]||t["@@iterator"],typeof t=="function"?t:null)}var xi=Object.assign,bx;function Hp(t){if(bx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);bx=e&&e[1]||""}return`
`+bx+t}var Ex=!1;function Tx(t,e){if(!t||Ex)return"";Ex=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(w){var r=w}Reflect.construct(t,[],e)}else{try{e.call()}catch(w){r=w}t.call(e.prototype)}else{try{throw Error()}catch(w){r=w}t()}}catch(w){if(w&&r&&typeof w.stack=="string"){for(var i=w.stack.split(`
`),s=r.stack.split(`
`),l=i.length-1,o=s.length-1;1<=l&&0<=o&&i[l]!==s[o];)o--;for(;1<=l&&0<=o;l--,o--)if(i[l]!==s[o]){if(l!==1||o!==1)do if(l--,o--,0>o||i[l]!==s[o]){var p=`
`+i[l].replace(" at new "," at ");return t.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",t.displayName)),p}while(1<=l&&0<=o);break}}}finally{Ex=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Hp(t):""}function j9(t){switch(t.tag){case 5:return Hp(t.type);case 16:return Hp("Lazy");case 13:return Hp("Suspense");case 19:return Hp("SuspenseList");case 0:case 2:case 15:return t=Tx(t.type,!1),t;case 11:return t=Tx(t.type.render,!1),t;case 1:return t=Tx(t.type,!0),t;default:return""}}function vb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case m0:return"Fragment";case g0:return"Portal";case mb:return"Profiler";case HE:return"StrictMode";case yb:return"Suspense";case _b:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case q8:return(t.displayName||"Context")+".Consumer";case Q8:return(t._context.displayName||"Context")+".Provider";case WE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case QE:return e=t.displayName||null,e!==null?e:vb(t.type)||"Memo";case $c:e=t._payload,t=t._init;try{return vb(t(e))}catch{}}return null}function H9(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vb(e);case 8:return e===HE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function dh(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Y8(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function W9(t){var e=Y8(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(l){r=""+l,s.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function f1(t){t._valueTracker||(t._valueTracker=W9(t))}function X8(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Y8(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Jy(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function xb(t,e){var n=e.checked;return xi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function nC(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=dh(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function K8(t,e){e=e.checked,e!=null&&jE(t,"checked",e,!1)}function wb(t,e){K8(t,e);var n=dh(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?bb(t,e.type,n):e.hasOwnProperty("defaultValue")&&bb(t,e.type,dh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function rC(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function bb(t,e,n){(e!=="number"||Jy(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Wp=Array.isArray;function j0(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+dh(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Eb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Bt(91));return xi({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function iC(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Bt(92));if(Wp(n)){if(1<n.length)throw Error(Bt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:dh(n)}}function J8(t,e){var n=dh(e.value),r=dh(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function sC(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function eL(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?eL(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var d1,tL=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(d1=d1||document.createElement("div"),d1.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=d1.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function bg(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var sg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Q9=["Webkit","ms","Moz","O"];Object.keys(sg).forEach(function(t){Q9.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),sg[e]=sg[t]})});function nL(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||sg.hasOwnProperty(t)&&sg[t]?(""+e).trim():e+"px"}function rL(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=nL(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var q9=xi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sb(t,e){if(e){if(q9[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Bt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Bt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Bt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Bt(62))}}function Cb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mb=null;function qE(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Pb=null,H0=null,W0=null;function oC(t){if(t=_m(t)){if(typeof Pb!="function")throw Error(Bt(280));var e=t.stateNode;e&&(e=V2(e),Pb(t.stateNode,t.type,e))}}function iL(t){H0?W0?W0.push(t):W0=[t]:H0=t}function sL(){if(H0){var t=H0,e=W0;if(W0=H0=null,oC(t),e)for(t=0;t<e.length;t++)oC(e[t])}}function oL(t,e){return t(e)}function aL(){}var Sx=!1;function lL(t,e,n){if(Sx)return t(e,n);Sx=!0;try{return oL(t,e,n)}finally{Sx=!1,(H0!==null||W0!==null)&&(aL(),sL())}}function Eg(t,e){var n=t.stateNode;if(n===null)return null;var r=V2(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Bt(231,e,typeof n));return n}var kb=!1;if(Ju)try{var pp={};Object.defineProperty(pp,"passive",{get:function(){kb=!0}}),window.addEventListener("test",pp,pp),window.removeEventListener("test",pp,pp)}catch{kb=!1}function Z9(t,e,n,r,i,s,l,o,p){var w=Array.prototype.slice.call(arguments,3);try{e.apply(n,w)}catch(C){this.onError(C)}}var og=!1,e_=null,t_=!1,Ib=null,Y9={onError:function(t){og=!0,e_=t}};function X9(t,e,n,r,i,s,l,o,p){og=!1,e_=null,Z9.apply(Y9,arguments)}function K9(t,e,n,r,i,s,l,o,p){if(X9.apply(this,arguments),og){if(og){var w=e_;og=!1,e_=null}else throw Error(Bt(198));t_||(t_=!0,Ib=w)}}function Cf(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function AL(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function aC(t){if(Cf(t)!==t)throw Error(Bt(188))}function J9(t){var e=t.alternate;if(!e){if(e=Cf(t),e===null)throw Error(Bt(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return aC(i),t;if(s===r)return aC(i),e;s=s.sibling}throw Error(Bt(188))}if(n.return!==r.return)n=i,r=s;else{for(var l=!1,o=i.child;o;){if(o===n){l=!0,n=i,r=s;break}if(o===r){l=!0,r=i,n=s;break}o=o.sibling}if(!l){for(o=s.child;o;){if(o===n){l=!0,n=s,r=i;break}if(o===r){l=!0,r=s,n=i;break}o=o.sibling}if(!l)throw Error(Bt(189))}}if(n.alternate!==r)throw Error(Bt(190))}if(n.tag!==3)throw Error(Bt(188));return n.stateNode.current===n?t:e}function uL(t){return t=J9(t),t!==null?cL(t):null}function cL(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=cL(t);if(e!==null)return e;t=t.sibling}return null}var hL=Ua.unstable_scheduleCallback,lC=Ua.unstable_cancelCallback,eU=Ua.unstable_shouldYield,tU=Ua.unstable_requestPaint,Oi=Ua.unstable_now,nU=Ua.unstable_getCurrentPriorityLevel,ZE=Ua.unstable_ImmediatePriority,fL=Ua.unstable_UserBlockingPriority,n_=Ua.unstable_NormalPriority,rU=Ua.unstable_LowPriority,dL=Ua.unstable_IdlePriority,O2=null,ZA=null;function iU(t){if(ZA&&typeof ZA.onCommitFiberRoot=="function")try{ZA.onCommitFiberRoot(O2,t,void 0,(t.current.flags&128)===128)}catch{}}var uA=Math.clz32?Math.clz32:aU,sU=Math.log,oU=Math.LN2;function aU(t){return t>>>=0,t===0?32:31-(sU(t)/oU|0)|0}var p1=64,g1=4194304;function Qp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function r_(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,l=n&268435455;if(l!==0){var o=l&~i;o!==0?r=Qp(o):(s&=l,s!==0&&(r=Qp(s)))}else l=n&~i,l!==0?r=Qp(l):s!==0&&(r=Qp(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-uA(e),i=1<<n,r|=t[n],e&=~i;return r}function lU(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AU(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var l=31-uA(s),o=1<<l,p=i[l];p===-1?(!(o&n)||o&r)&&(i[l]=lU(o,e)):p<=e&&(t.expiredLanes|=o),s&=~o}}function Lb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function pL(){var t=p1;return p1<<=1,!(p1&4194240)&&(p1=64),t}function Cx(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function mm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-uA(e),t[e]=n}function uU(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-uA(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function YE(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-uA(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var zr=0;function gL(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var mL,XE,yL,_L,vL,Db=!1,m1=[],nh=null,rh=null,ih=null,Tg=new Map,Sg=new Map,Wc=[],cU="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function AC(t,e){switch(t){case"focusin":case"focusout":nh=null;break;case"dragenter":case"dragleave":rh=null;break;case"mouseover":case"mouseout":ih=null;break;case"pointerover":case"pointerout":Tg.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sg.delete(e.pointerId)}}function gp(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=_m(e),e!==null&&XE(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function hU(t,e,n,r,i){switch(e){case"focusin":return nh=gp(nh,t,e,n,r,i),!0;case"dragenter":return rh=gp(rh,t,e,n,r,i),!0;case"mouseover":return ih=gp(ih,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Tg.set(s,gp(Tg.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Sg.set(s,gp(Sg.get(s)||null,t,e,n,r,i)),!0}return!1}function xL(t){var e=Zh(t.target);if(e!==null){var n=Cf(e);if(n!==null){if(e=n.tag,e===13){if(e=AL(n),e!==null){t.blockedOn=e,vL(t.priority,function(){yL(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function my(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Rb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Mb=r,n.target.dispatchEvent(r),Mb=null}else return e=_m(n),e!==null&&XE(e),t.blockedOn=n,!1;e.shift()}return!0}function uC(t,e,n){my(t)&&n.delete(e)}function fU(){Db=!1,nh!==null&&my(nh)&&(nh=null),rh!==null&&my(rh)&&(rh=null),ih!==null&&my(ih)&&(ih=null),Tg.forEach(uC),Sg.forEach(uC)}function mp(t,e){t.blockedOn===e&&(t.blockedOn=null,Db||(Db=!0,Ua.unstable_scheduleCallback(Ua.unstable_NormalPriority,fU)))}function Cg(t){function e(i){return mp(i,t)}if(0<m1.length){mp(m1[0],t);for(var n=1;n<m1.length;n++){var r=m1[n];r.blockedOn===t&&(r.blockedOn=null)}}for(nh!==null&&mp(nh,t),rh!==null&&mp(rh,t),ih!==null&&mp(ih,t),Tg.forEach(e),Sg.forEach(e),n=0;n<Wc.length;n++)r=Wc[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Wc.length&&(n=Wc[0],n.blockedOn===null);)xL(n),n.blockedOn===null&&Wc.shift()}var Q0=dc.ReactCurrentBatchConfig,i_=!0;function dU(t,e,n,r){var i=zr,s=Q0.transition;Q0.transition=null;try{zr=1,KE(t,e,n,r)}finally{zr=i,Q0.transition=s}}function pU(t,e,n,r){var i=zr,s=Q0.transition;Q0.transition=null;try{zr=4,KE(t,e,n,r)}finally{zr=i,Q0.transition=s}}function KE(t,e,n,r){if(i_){var i=Rb(t,e,n,r);if(i===null)Ox(t,e,r,s_,n),AC(t,r);else if(hU(i,t,e,n,r))r.stopPropagation();else if(AC(t,r),e&4&&-1<cU.indexOf(t)){for(;i!==null;){var s=_m(i);if(s!==null&&mL(s),s=Rb(t,e,n,r),s===null&&Ox(t,e,r,s_,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Ox(t,e,r,null,n)}}var s_=null;function Rb(t,e,n,r){if(s_=null,t=qE(r),t=Zh(t),t!==null)if(e=Cf(t),e===null)t=null;else if(n=e.tag,n===13){if(t=AL(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return s_=t,null}function wL(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nU()){case ZE:return 1;case fL:return 4;case n_:case rU:return 16;case dL:return 536870912;default:return 16}default:return 16}}var Zc=null,JE=null,yy=null;function bL(){if(yy)return yy;var t,e=JE,n=e.length,r,i="value"in Zc?Zc.value:Zc.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var l=n-t;for(r=1;r<=l&&e[n-r]===i[s-r];r++);return yy=i.slice(t,1<r?1-r:void 0)}function _y(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function y1(){return!0}function cC(){return!1}function Ga(t){function e(n,r,i,s,l){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?y1:cC,this.isPropagationStopped=cC,this}return xi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=y1)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=y1)},persist:function(){},isPersistent:y1}),e}var Rd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},eT=Ga(Rd),ym=xi({},Rd,{view:0,detail:0}),gU=Ga(ym),Mx,Px,yp,F2=xi({},ym,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tT,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==yp&&(yp&&t.type==="mousemove"?(Mx=t.screenX-yp.screenX,Px=t.screenY-yp.screenY):Px=Mx=0,yp=t),Mx)},movementY:function(t){return"movementY"in t?t.movementY:Px}}),hC=Ga(F2),mU=xi({},F2,{dataTransfer:0}),yU=Ga(mU),_U=xi({},ym,{relatedTarget:0}),kx=Ga(_U),vU=xi({},Rd,{animationName:0,elapsedTime:0,pseudoElement:0}),xU=Ga(vU),wU=xi({},Rd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bU=Ga(wU),EU=xi({},Rd,{data:0}),fC=Ga(EU),TU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},SU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function MU(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=CU[t])?!!e[t]:!1}function tT(){return MU}var PU=xi({},ym,{key:function(t){if(t.key){var e=TU[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=_y(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?SU[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tT,charCode:function(t){return t.type==="keypress"?_y(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?_y(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),kU=Ga(PU),IU=xi({},F2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dC=Ga(IU),LU=xi({},ym,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tT}),DU=Ga(LU),RU=xi({},Rd,{propertyName:0,elapsedTime:0,pseudoElement:0}),BU=Ga(RU),zU=xi({},F2,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),OU=Ga(zU),FU=[9,13,27,32],nT=Ju&&"CompositionEvent"in window,ag=null;Ju&&"documentMode"in document&&(ag=document.documentMode);var NU=Ju&&"TextEvent"in window&&!ag,EL=Ju&&(!nT||ag&&8<ag&&11>=ag),pC=String.fromCharCode(32),gC=!1;function TL(t,e){switch(t){case"keyup":return FU.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function SL(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var y0=!1;function UU(t,e){switch(t){case"compositionend":return SL(e);case"keypress":return e.which!==32?null:(gC=!0,pC);case"textInput":return t=e.data,t===pC&&gC?null:t;default:return null}}function VU(t,e){if(y0)return t==="compositionend"||!nT&&TL(t,e)?(t=bL(),yy=JE=Zc=null,y0=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return EL&&e.locale!=="ko"?null:e.data;default:return null}}var GU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!GU[t.type]:e==="textarea"}function CL(t,e,n,r){iL(r),e=o_(e,"onChange"),0<e.length&&(n=new eT("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var lg=null,Mg=null;function $U(t){FL(t,0)}function N2(t){var e=x0(t);if(X8(e))return t}function jU(t,e){if(t==="change")return e}var ML=!1;if(Ju){var Ix;if(Ju){var Lx="oninput"in document;if(!Lx){var yC=document.createElement("div");yC.setAttribute("oninput","return;"),Lx=typeof yC.oninput=="function"}Ix=Lx}else Ix=!1;ML=Ix&&(!document.documentMode||9<document.documentMode)}function _C(){lg&&(lg.detachEvent("onpropertychange",PL),Mg=lg=null)}function PL(t){if(t.propertyName==="value"&&N2(Mg)){var e=[];CL(e,Mg,t,qE(t)),lL($U,e)}}function HU(t,e,n){t==="focusin"?(_C(),lg=e,Mg=n,lg.attachEvent("onpropertychange",PL)):t==="focusout"&&_C()}function WU(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return N2(Mg)}function QU(t,e){if(t==="click")return N2(e)}function qU(t,e){if(t==="input"||t==="change")return N2(e)}function ZU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var fA=typeof Object.is=="function"?Object.is:ZU;function Pg(t,e){if(fA(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!gb.call(e,i)||!fA(t[i],e[i]))return!1}return!0}function vC(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function xC(t,e){var n=vC(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=vC(n)}}function kL(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?kL(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function IL(){for(var t=window,e=Jy();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Jy(t.document)}return e}function rT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function YU(t){var e=IL(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&kL(n.ownerDocument.documentElement,n)){if(r!==null&&rT(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=xC(n,s);var l=xC(n,r);i&&l&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var XU=Ju&&"documentMode"in document&&11>=document.documentMode,_0=null,Bb=null,Ag=null,zb=!1;function wC(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;zb||_0==null||_0!==Jy(r)||(r=_0,"selectionStart"in r&&rT(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ag&&Pg(Ag,r)||(Ag=r,r=o_(Bb,"onSelect"),0<r.length&&(e=new eT("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=_0)))}function _1(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var v0={animationend:_1("Animation","AnimationEnd"),animationiteration:_1("Animation","AnimationIteration"),animationstart:_1("Animation","AnimationStart"),transitionend:_1("Transition","TransitionEnd")},Dx={},LL={};Ju&&(LL=document.createElement("div").style,"AnimationEvent"in window||(delete v0.animationend.animation,delete v0.animationiteration.animation,delete v0.animationstart.animation),"TransitionEvent"in window||delete v0.transitionend.transition);function U2(t){if(Dx[t])return Dx[t];if(!v0[t])return t;var e=v0[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in LL)return Dx[t]=e[n];return t}var DL=U2("animationend"),RL=U2("animationiteration"),BL=U2("animationstart"),zL=U2("transitionend"),OL=new Map,bC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bh(t,e){OL.set(t,e),Sf(e,[t])}for(var Rx=0;Rx<bC.length;Rx++){var Bx=bC[Rx],KU=Bx.toLowerCase(),JU=Bx[0].toUpperCase()+Bx.slice(1);bh(KU,"on"+JU)}bh(DL,"onAnimationEnd");bh(RL,"onAnimationIteration");bh(BL,"onAnimationStart");bh("dblclick","onDoubleClick");bh("focusin","onFocus");bh("focusout","onBlur");bh(zL,"onTransitionEnd");ad("onMouseEnter",["mouseout","mouseover"]);ad("onMouseLeave",["mouseout","mouseover"]);ad("onPointerEnter",["pointerout","pointerover"]);ad("onPointerLeave",["pointerout","pointerover"]);Sf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Sf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Sf("onBeforeInput",["compositionend","keypress","textInput","paste"]);Sf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Sf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Sf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eV=new Set("cancel close invalid load scroll toggle".split(" ").concat(qp));function EC(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,K9(r,e,void 0,t),t.currentTarget=null}function FL(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var l=r.length-1;0<=l;l--){var o=r[l],p=o.instance,w=o.currentTarget;if(o=o.listener,p!==s&&i.isPropagationStopped())break e;EC(i,o,w),s=p}else for(l=0;l<r.length;l++){if(o=r[l],p=o.instance,w=o.currentTarget,o=o.listener,p!==s&&i.isPropagationStopped())break e;EC(i,o,w),s=p}}}if(t_)throw t=Ib,t_=!1,Ib=null,t}function ai(t,e){var n=e[Vb];n===void 0&&(n=e[Vb]=new Set);var r=t+"__bubble";n.has(r)||(NL(e,t,2,!1),n.add(r))}function zx(t,e,n){var r=0;e&&(r|=4),NL(n,t,r,e)}var v1="_reactListening"+Math.random().toString(36).slice(2);function kg(t){if(!t[v1]){t[v1]=!0,W8.forEach(function(n){n!=="selectionchange"&&(eV.has(n)||zx(n,!1,t),zx(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[v1]||(e[v1]=!0,zx("selectionchange",!1,e))}}function NL(t,e,n,r){switch(wL(e)){case 1:var i=dU;break;case 4:i=pU;break;default:i=KE}n=i.bind(null,e,n,t),i=void 0,!kb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Ox(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(l===4)for(l=r.return;l!==null;){var p=l.tag;if((p===3||p===4)&&(p=l.stateNode.containerInfo,p===i||p.nodeType===8&&p.parentNode===i))return;l=l.return}for(;o!==null;){if(l=Zh(o),l===null)return;if(p=l.tag,p===5||p===6){r=s=l;continue e}o=o.parentNode}}r=r.return}lL(function(){var w=s,C=qE(n),P=[];e:{var I=OL.get(t);if(I!==void 0){var U=eT,W=t;switch(t){case"keypress":if(_y(n)===0)break e;case"keydown":case"keyup":U=kU;break;case"focusin":W="focus",U=kx;break;case"focusout":W="blur",U=kx;break;case"beforeblur":case"afterblur":U=kx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":U=hC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":U=yU;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":U=DU;break;case DL:case RL:case BL:U=xU;break;case zL:U=BU;break;case"scroll":U=gU;break;case"wheel":U=OU;break;case"copy":case"cut":case"paste":U=bU;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":U=dC}var H=(e&4)!==0,ie=!H&&t==="scroll",X=H?I!==null?I+"Capture":null:I;H=[];for(var ee=w,se;ee!==null;){se=ee;var fe=se.stateNode;if(se.tag===5&&fe!==null&&(se=fe,X!==null&&(fe=Eg(ee,X),fe!=null&&H.push(Ig(ee,fe,se)))),ie)break;ee=ee.return}0<H.length&&(I=new U(I,W,null,n,C),P.push({event:I,listeners:H}))}}if(!(e&7)){e:{if(I=t==="mouseover"||t==="pointerover",U=t==="mouseout"||t==="pointerout",I&&n!==Mb&&(W=n.relatedTarget||n.fromElement)&&(Zh(W)||W[ec]))break e;if((U||I)&&(I=C.window===C?C:(I=C.ownerDocument)?I.defaultView||I.parentWindow:window,U?(W=n.relatedTarget||n.toElement,U=w,W=W?Zh(W):null,W!==null&&(ie=Cf(W),W!==ie||W.tag!==5&&W.tag!==6)&&(W=null)):(U=null,W=w),U!==W)){if(H=hC,fe="onMouseLeave",X="onMouseEnter",ee="mouse",(t==="pointerout"||t==="pointerover")&&(H=dC,fe="onPointerLeave",X="onPointerEnter",ee="pointer"),ie=U==null?I:x0(U),se=W==null?I:x0(W),I=new H(fe,ee+"leave",U,n,C),I.target=ie,I.relatedTarget=se,fe=null,Zh(C)===w&&(H=new H(X,ee+"enter",W,n,C),H.target=se,H.relatedTarget=ie,fe=H),ie=fe,U&&W)t:{for(H=U,X=W,ee=0,se=H;se;se=t0(se))ee++;for(se=0,fe=X;fe;fe=t0(fe))se++;for(;0<ee-se;)H=t0(H),ee--;for(;0<se-ee;)X=t0(X),se--;for(;ee--;){if(H===X||X!==null&&H===X.alternate)break t;H=t0(H),X=t0(X)}H=null}else H=null;U!==null&&TC(P,I,U,H,!1),W!==null&&ie!==null&&TC(P,ie,W,H,!0)}}e:{if(I=w?x0(w):window,U=I.nodeName&&I.nodeName.toLowerCase(),U==="select"||U==="input"&&I.type==="file")var me=jU;else if(mC(I))if(ML)me=qU;else{me=WU;var Se=HU}else(U=I.nodeName)&&U.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(me=QU);if(me&&(me=me(t,w))){CL(P,me,n,C);break e}Se&&Se(t,I,w),t==="focusout"&&(Se=I._wrapperState)&&Se.controlled&&I.type==="number"&&bb(I,"number",I.value)}switch(Se=w?x0(w):window,t){case"focusin":(mC(Se)||Se.contentEditable==="true")&&(_0=Se,Bb=w,Ag=null);break;case"focusout":Ag=Bb=_0=null;break;case"mousedown":zb=!0;break;case"contextmenu":case"mouseup":case"dragend":zb=!1,wC(P,n,C);break;case"selectionchange":if(XU)break;case"keydown":case"keyup":wC(P,n,C)}var He;if(nT)e:{switch(t){case"compositionstart":var Qe="onCompositionStart";break e;case"compositionend":Qe="onCompositionEnd";break e;case"compositionupdate":Qe="onCompositionUpdate";break e}Qe=void 0}else y0?TL(t,n)&&(Qe="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(Qe="onCompositionStart");Qe&&(EL&&n.locale!=="ko"&&(y0||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&y0&&(He=bL()):(Zc=C,JE="value"in Zc?Zc.value:Zc.textContent,y0=!0)),Se=o_(w,Qe),0<Se.length&&(Qe=new fC(Qe,t,null,n,C),P.push({event:Qe,listeners:Se}),He?Qe.data=He:(He=SL(n),He!==null&&(Qe.data=He)))),(He=NU?UU(t,n):VU(t,n))&&(w=o_(w,"onBeforeInput"),0<w.length&&(C=new fC("onBeforeInput","beforeinput",null,n,C),P.push({event:C,listeners:w}),C.data=He))}FL(P,e)})}function Ig(t,e,n){return{instance:t,listener:e,currentTarget:n}}function o_(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Eg(t,n),s!=null&&r.unshift(Ig(t,s,i)),s=Eg(t,e),s!=null&&r.push(Ig(t,s,i))),t=t.return}return r}function t0(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function TC(t,e,n,r,i){for(var s=e._reactName,l=[];n!==null&&n!==r;){var o=n,p=o.alternate,w=o.stateNode;if(p!==null&&p===r)break;o.tag===5&&w!==null&&(o=w,i?(p=Eg(n,s),p!=null&&l.unshift(Ig(n,p,o))):i||(p=Eg(n,s),p!=null&&l.push(Ig(n,p,o)))),n=n.return}l.length!==0&&t.push({event:e,listeners:l})}var tV=/\r\n?/g,nV=/\u0000|\uFFFD/g;function SC(t){return(typeof t=="string"?t:""+t).replace(tV,`
`).replace(nV,"")}function x1(t,e,n){if(e=SC(e),SC(t)!==e&&n)throw Error(Bt(425))}function a_(){}var Ob=null,Fb=null;function Nb(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ub=typeof setTimeout=="function"?setTimeout:void 0,rV=typeof clearTimeout=="function"?clearTimeout:void 0,CC=typeof Promise=="function"?Promise:void 0,iV=typeof queueMicrotask=="function"?queueMicrotask:typeof CC<"u"?function(t){return CC.resolve(null).then(t).catch(sV)}:Ub;function sV(t){setTimeout(function(){throw t})}function Fx(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Cg(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Cg(e)}function sh(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function MC(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Bd=Math.random().toString(36).slice(2),jA="__reactFiber$"+Bd,Lg="__reactProps$"+Bd,ec="__reactContainer$"+Bd,Vb="__reactEvents$"+Bd,oV="__reactListeners$"+Bd,aV="__reactHandles$"+Bd;function Zh(t){var e=t[jA];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ec]||n[jA]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=MC(t);t!==null;){if(n=t[jA])return n;t=MC(t)}return e}t=n,n=t.parentNode}return null}function _m(t){return t=t[jA]||t[ec],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function x0(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Bt(33))}function V2(t){return t[Lg]||null}var Gb=[],w0=-1;function Eh(t){return{current:t}}function li(t){0>w0||(t.current=Gb[w0],Gb[w0]=null,w0--)}function ei(t,e){w0++,Gb[w0]=t.current,t.current=e}var ph={},po=Eh(ph),sa=Eh(!1),of=ph;function ld(t,e){var n=t.type.contextTypes;if(!n)return ph;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function oa(t){return t=t.childContextTypes,t!=null}function l_(){li(sa),li(po)}function PC(t,e,n){if(po.current!==ph)throw Error(Bt(168));ei(po,e),ei(sa,n)}function UL(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Bt(108,H9(t)||"Unknown",i));return xi({},n,r)}function A_(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ph,of=po.current,ei(po,t),ei(sa,sa.current),!0}function kC(t,e,n){var r=t.stateNode;if(!r)throw Error(Bt(169));n?(t=UL(t,e,of),r.__reactInternalMemoizedMergedChildContext=t,li(sa),li(po),ei(po,t)):li(sa),ei(sa,n)}var Nu=null,G2=!1,Nx=!1;function VL(t){Nu===null?Nu=[t]:Nu.push(t)}function lV(t){G2=!0,VL(t)}function Th(){if(!Nx&&Nu!==null){Nx=!0;var t=0,e=zr;try{var n=Nu;for(zr=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Nu=null,G2=!1}catch(i){throw Nu!==null&&(Nu=Nu.slice(t+1)),hL(ZE,Th),i}finally{zr=e,Nx=!1}}return null}var b0=[],E0=0,u_=null,c_=0,pl=[],gl=0,af=null,Gu=1,$u="";function jh(t,e){b0[E0++]=c_,b0[E0++]=u_,u_=t,c_=e}function GL(t,e,n){pl[gl++]=Gu,pl[gl++]=$u,pl[gl++]=af,af=t;var r=Gu;t=$u;var i=32-uA(r)-1;r&=~(1<<i),n+=1;var s=32-uA(e)+i;if(30<s){var l=i-i%5;s=(r&(1<<l)-1).toString(32),r>>=l,i-=l,Gu=1<<32-uA(e)+i|n<<i|r,$u=s+t}else Gu=1<<s|n<<i|r,$u=t}function iT(t){t.return!==null&&(jh(t,1),GL(t,1,0))}function sT(t){for(;t===u_;)u_=b0[--E0],b0[E0]=null,c_=b0[--E0],b0[E0]=null;for(;t===af;)af=pl[--gl],pl[gl]=null,$u=pl[--gl],pl[gl]=null,Gu=pl[--gl],pl[gl]=null}var za=null,Ra=null,di=!1,eA=null;function $L(t,e){var n=ml(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function IC(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,za=t,Ra=sh(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,za=t,Ra=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=af!==null?{id:Gu,overflow:$u}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ml(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,za=t,Ra=null,!0):!1;default:return!1}}function $b(t){return(t.mode&1)!==0&&(t.flags&128)===0}function jb(t){if(di){var e=Ra;if(e){var n=e;if(!IC(t,e)){if($b(t))throw Error(Bt(418));e=sh(n.nextSibling);var r=za;e&&IC(t,e)?$L(r,n):(t.flags=t.flags&-4097|2,di=!1,za=t)}}else{if($b(t))throw Error(Bt(418));t.flags=t.flags&-4097|2,di=!1,za=t}}}function LC(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;za=t}function w1(t){if(t!==za)return!1;if(!di)return LC(t),di=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Nb(t.type,t.memoizedProps)),e&&(e=Ra)){if($b(t))throw jL(),Error(Bt(418));for(;e;)$L(t,e),e=sh(e.nextSibling)}if(LC(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Bt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ra=sh(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ra=null}}else Ra=za?sh(t.stateNode.nextSibling):null;return!0}function jL(){for(var t=Ra;t;)t=sh(t.nextSibling)}function Ad(){Ra=za=null,di=!1}function oT(t){eA===null?eA=[t]:eA.push(t)}var AV=dc.ReactCurrentBatchConfig;function Kl(t,e){if(t&&t.defaultProps){e=xi({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var h_=Eh(null),f_=null,T0=null,aT=null;function lT(){aT=T0=f_=null}function AT(t){var e=h_.current;li(h_),t._currentValue=e}function Hb(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function q0(t,e){f_=t,aT=T0=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ra=!0),t.firstContext=null)}function Sl(t){var e=t._currentValue;if(aT!==t)if(t={context:t,memoizedValue:e,next:null},T0===null){if(f_===null)throw Error(Bt(308));T0=t,f_.dependencies={lanes:0,firstContext:t}}else T0=T0.next=t;return e}var Yh=null;function uT(t){Yh===null?Yh=[t]:Yh.push(t)}function HL(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,uT(e)):(n.next=i.next,i.next=n),e.interleaved=n,tc(t,r)}function tc(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var jc=!1;function cT(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function WL(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qu(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function oh(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Er&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,tc(t,n)}return i=r.interleaved,i===null?(e.next=e,uT(r)):(e.next=i.next,i.next=e),r.interleaved=e,tc(t,n)}function vy(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,YE(t,n)}}function DC(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=l:s=s.next=l,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function d_(t,e,n,r){var i=t.updateQueue;jc=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var p=o,w=p.next;p.next=null,l===null?s=w:l.next=w,l=p;var C=t.alternate;C!==null&&(C=C.updateQueue,o=C.lastBaseUpdate,o!==l&&(o===null?C.firstBaseUpdate=w:o.next=w,C.lastBaseUpdate=p))}if(s!==null){var P=i.baseState;l=0,C=w=p=null,o=s;do{var I=o.lane,U=o.eventTime;if((r&I)===I){C!==null&&(C=C.next={eventTime:U,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var W=t,H=o;switch(I=e,U=n,H.tag){case 1:if(W=H.payload,typeof W=="function"){P=W.call(U,P,I);break e}P=W;break e;case 3:W.flags=W.flags&-65537|128;case 0:if(W=H.payload,I=typeof W=="function"?W.call(U,P,I):W,I==null)break e;P=xi({},P,I);break e;case 2:jc=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,I=i.effects,I===null?i.effects=[o]:I.push(o))}else U={eventTime:U,lane:I,tag:o.tag,payload:o.payload,callback:o.callback,next:null},C===null?(w=C=U,p=P):C=C.next=U,l|=I;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;I=o,o=I.next,I.next=null,i.lastBaseUpdate=I,i.shared.pending=null}}while(1);if(C===null&&(p=P),i.baseState=p,i.firstBaseUpdate=w,i.lastBaseUpdate=C,e=i.shared.interleaved,e!==null){i=e;do l|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Af|=l,t.lanes=l,t.memoizedState=P}}function RC(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Bt(191,i));i.call(r)}}}var QL=new H8.Component().refs;function Wb(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:xi({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var $2={isMounted:function(t){return(t=t._reactInternals)?Cf(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=zo(),i=lh(t),s=qu(r,i);s.payload=e,n!=null&&(s.callback=n),e=oh(t,s,i),e!==null&&(cA(e,t,i,r),vy(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=zo(),i=lh(t),s=qu(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=oh(t,s,i),e!==null&&(cA(e,t,i,r),vy(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=zo(),r=lh(t),i=qu(n,r);i.tag=2,e!=null&&(i.callback=e),e=oh(t,i,r),e!==null&&(cA(e,t,r,n),vy(e,t,r))}};function BC(t,e,n,r,i,s,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,l):e.prototype&&e.prototype.isPureReactComponent?!Pg(n,r)||!Pg(i,s):!0}function qL(t,e,n){var r=!1,i=ph,s=e.contextType;return typeof s=="object"&&s!==null?s=Sl(s):(i=oa(e)?of:po.current,r=e.contextTypes,s=(r=r!=null)?ld(t,i):ph),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=$2,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function zC(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&$2.enqueueReplaceState(e,e.state,null)}function Qb(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=QL,cT(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Sl(s):(s=oa(e)?of:po.current,i.context=ld(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Wb(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&$2.enqueueReplaceState(i,i.state,null),d_(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function _p(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Bt(309));var r=n.stateNode}if(!r)throw Error(Bt(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(l){var o=i.refs;o===QL&&(o=i.refs={}),l===null?delete o[s]:o[s]=l},e._stringRef=s,e)}if(typeof t!="string")throw Error(Bt(284));if(!n._owner)throw Error(Bt(290,t))}return t}function b1(t,e){throw t=Object.prototype.toString.call(e),Error(Bt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function OC(t){var e=t._init;return e(t._payload)}function ZL(t){function e(X,ee){if(t){var se=X.deletions;se===null?(X.deletions=[ee],X.flags|=16):se.push(ee)}}function n(X,ee){if(!t)return null;for(;ee!==null;)e(X,ee),ee=ee.sibling;return null}function r(X,ee){for(X=new Map;ee!==null;)ee.key!==null?X.set(ee.key,ee):X.set(ee.index,ee),ee=ee.sibling;return X}function i(X,ee){return X=Ah(X,ee),X.index=0,X.sibling=null,X}function s(X,ee,se){return X.index=se,t?(se=X.alternate,se!==null?(se=se.index,se<ee?(X.flags|=2,ee):se):(X.flags|=2,ee)):(X.flags|=1048576,ee)}function l(X){return t&&X.alternate===null&&(X.flags|=2),X}function o(X,ee,se,fe){return ee===null||ee.tag!==6?(ee=Wx(se,X.mode,fe),ee.return=X,ee):(ee=i(ee,se),ee.return=X,ee)}function p(X,ee,se,fe){var me=se.type;return me===m0?C(X,ee,se.props.children,fe,se.key):ee!==null&&(ee.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===$c&&OC(me)===ee.type)?(fe=i(ee,se.props),fe.ref=_p(X,ee,se),fe.return=X,fe):(fe=Sy(se.type,se.key,se.props,null,X.mode,fe),fe.ref=_p(X,ee,se),fe.return=X,fe)}function w(X,ee,se,fe){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==se.containerInfo||ee.stateNode.implementation!==se.implementation?(ee=Qx(se,X.mode,fe),ee.return=X,ee):(ee=i(ee,se.children||[]),ee.return=X,ee)}function C(X,ee,se,fe,me){return ee===null||ee.tag!==7?(ee=tf(se,X.mode,fe,me),ee.return=X,ee):(ee=i(ee,se),ee.return=X,ee)}function P(X,ee,se){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=Wx(""+ee,X.mode,se),ee.return=X,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case h1:return se=Sy(ee.type,ee.key,ee.props,null,X.mode,se),se.ref=_p(X,null,ee),se.return=X,se;case g0:return ee=Qx(ee,X.mode,se),ee.return=X,ee;case $c:var fe=ee._init;return P(X,fe(ee._payload),se)}if(Wp(ee)||dp(ee))return ee=tf(ee,X.mode,se,null),ee.return=X,ee;b1(X,ee)}return null}function I(X,ee,se,fe){var me=ee!==null?ee.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return me!==null?null:o(X,ee,""+se,fe);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case h1:return se.key===me?p(X,ee,se,fe):null;case g0:return se.key===me?w(X,ee,se,fe):null;case $c:return me=se._init,I(X,ee,me(se._payload),fe)}if(Wp(se)||dp(se))return me!==null?null:C(X,ee,se,fe,null);b1(X,se)}return null}function U(X,ee,se,fe,me){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return X=X.get(se)||null,o(ee,X,""+fe,me);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case h1:return X=X.get(fe.key===null?se:fe.key)||null,p(ee,X,fe,me);case g0:return X=X.get(fe.key===null?se:fe.key)||null,w(ee,X,fe,me);case $c:var Se=fe._init;return U(X,ee,se,Se(fe._payload),me)}if(Wp(fe)||dp(fe))return X=X.get(se)||null,C(ee,X,fe,me,null);b1(ee,fe)}return null}function W(X,ee,se,fe){for(var me=null,Se=null,He=ee,Qe=ee=0,Ke=null;He!==null&&Qe<se.length;Qe++){He.index>Qe?(Ke=He,He=null):Ke=He.sibling;var rt=I(X,He,se[Qe],fe);if(rt===null){He===null&&(He=Ke);break}t&&He&&rt.alternate===null&&e(X,He),ee=s(rt,ee,Qe),Se===null?me=rt:Se.sibling=rt,Se=rt,He=Ke}if(Qe===se.length)return n(X,He),di&&jh(X,Qe),me;if(He===null){for(;Qe<se.length;Qe++)He=P(X,se[Qe],fe),He!==null&&(ee=s(He,ee,Qe),Se===null?me=He:Se.sibling=He,Se=He);return di&&jh(X,Qe),me}for(He=r(X,He);Qe<se.length;Qe++)Ke=U(He,X,Qe,se[Qe],fe),Ke!==null&&(t&&Ke.alternate!==null&&He.delete(Ke.key===null?Qe:Ke.key),ee=s(Ke,ee,Qe),Se===null?me=Ke:Se.sibling=Ke,Se=Ke);return t&&He.forEach(function(Ue){return e(X,Ue)}),di&&jh(X,Qe),me}function H(X,ee,se,fe){var me=dp(se);if(typeof me!="function")throw Error(Bt(150));if(se=me.call(se),se==null)throw Error(Bt(151));for(var Se=me=null,He=ee,Qe=ee=0,Ke=null,rt=se.next();He!==null&&!rt.done;Qe++,rt=se.next()){He.index>Qe?(Ke=He,He=null):Ke=He.sibling;var Ue=I(X,He,rt.value,fe);if(Ue===null){He===null&&(He=Ke);break}t&&He&&Ue.alternate===null&&e(X,He),ee=s(Ue,ee,Qe),Se===null?me=Ue:Se.sibling=Ue,Se=Ue,He=Ke}if(rt.done)return n(X,He),di&&jh(X,Qe),me;if(He===null){for(;!rt.done;Qe++,rt=se.next())rt=P(X,rt.value,fe),rt!==null&&(ee=s(rt,ee,Qe),Se===null?me=rt:Se.sibling=rt,Se=rt);return di&&jh(X,Qe),me}for(He=r(X,He);!rt.done;Qe++,rt=se.next())rt=U(He,X,Qe,rt.value,fe),rt!==null&&(t&&rt.alternate!==null&&He.delete(rt.key===null?Qe:rt.key),ee=s(rt,ee,Qe),Se===null?me=rt:Se.sibling=rt,Se=rt);return t&&He.forEach(function(it){return e(X,it)}),di&&jh(X,Qe),me}function ie(X,ee,se,fe){if(typeof se=="object"&&se!==null&&se.type===m0&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case h1:e:{for(var me=se.key,Se=ee;Se!==null;){if(Se.key===me){if(me=se.type,me===m0){if(Se.tag===7){n(X,Se.sibling),ee=i(Se,se.props.children),ee.return=X,X=ee;break e}}else if(Se.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===$c&&OC(me)===Se.type){n(X,Se.sibling),ee=i(Se,se.props),ee.ref=_p(X,Se,se),ee.return=X,X=ee;break e}n(X,Se);break}else e(X,Se);Se=Se.sibling}se.type===m0?(ee=tf(se.props.children,X.mode,fe,se.key),ee.return=X,X=ee):(fe=Sy(se.type,se.key,se.props,null,X.mode,fe),fe.ref=_p(X,ee,se),fe.return=X,X=fe)}return l(X);case g0:e:{for(Se=se.key;ee!==null;){if(ee.key===Se)if(ee.tag===4&&ee.stateNode.containerInfo===se.containerInfo&&ee.stateNode.implementation===se.implementation){n(X,ee.sibling),ee=i(ee,se.children||[]),ee.return=X,X=ee;break e}else{n(X,ee);break}else e(X,ee);ee=ee.sibling}ee=Qx(se,X.mode,fe),ee.return=X,X=ee}return l(X);case $c:return Se=se._init,ie(X,ee,Se(se._payload),fe)}if(Wp(se))return W(X,ee,se,fe);if(dp(se))return H(X,ee,se,fe);b1(X,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,ee!==null&&ee.tag===6?(n(X,ee.sibling),ee=i(ee,se),ee.return=X,X=ee):(n(X,ee),ee=Wx(se,X.mode,fe),ee.return=X,X=ee),l(X)):n(X,ee)}return ie}var ud=ZL(!0),YL=ZL(!1),vm={},YA=Eh(vm),Dg=Eh(vm),Rg=Eh(vm);function Xh(t){if(t===vm)throw Error(Bt(174));return t}function hT(t,e){switch(ei(Rg,e),ei(Dg,t),ei(YA,vm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Tb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Tb(e,t)}li(YA),ei(YA,e)}function cd(){li(YA),li(Dg),li(Rg)}function XL(t){Xh(Rg.current);var e=Xh(YA.current),n=Tb(e,t.type);e!==n&&(ei(Dg,t),ei(YA,n))}function fT(t){Dg.current===t&&(li(YA),li(Dg))}var yi=Eh(0);function p_(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ux=[];function dT(){for(var t=0;t<Ux.length;t++)Ux[t]._workInProgressVersionPrimary=null;Ux.length=0}var xy=dc.ReactCurrentDispatcher,Vx=dc.ReactCurrentBatchConfig,lf=0,vi=null,ns=null,ys=null,g_=!1,ug=!1,Bg=0,uV=0;function Js(){throw Error(Bt(321))}function pT(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!fA(t[n],e[n]))return!1;return!0}function gT(t,e,n,r,i,s){if(lf=s,vi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xy.current=t===null||t.memoizedState===null?dV:pV,t=n(r,i),ug){s=0;do{if(ug=!1,Bg=0,25<=s)throw Error(Bt(301));s+=1,ys=ns=null,e.updateQueue=null,xy.current=gV,t=n(r,i)}while(ug)}if(xy.current=m_,e=ns!==null&&ns.next!==null,lf=0,ys=ns=vi=null,g_=!1,e)throw Error(Bt(300));return t}function mT(){var t=Bg!==0;return Bg=0,t}function $A(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ys===null?vi.memoizedState=ys=t:ys=ys.next=t,ys}function Cl(){if(ns===null){var t=vi.alternate;t=t!==null?t.memoizedState:null}else t=ns.next;var e=ys===null?vi.memoizedState:ys.next;if(e!==null)ys=e,ns=t;else{if(t===null)throw Error(Bt(310));ns=t,t={memoizedState:ns.memoizedState,baseState:ns.baseState,baseQueue:ns.baseQueue,queue:ns.queue,next:null},ys===null?vi.memoizedState=ys=t:ys=ys.next=t}return ys}function zg(t,e){return typeof e=="function"?e(t):e}function Gx(t){var e=Cl(),n=e.queue;if(n===null)throw Error(Bt(311));n.lastRenderedReducer=t;var r=ns,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=l=null,p=null,w=s;do{var C=w.lane;if((lf&C)===C)p!==null&&(p=p.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),r=w.hasEagerState?w.eagerState:t(r,w.action);else{var P={lane:C,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};p===null?(o=p=P,l=r):p=p.next=P,vi.lanes|=C,Af|=C}w=w.next}while(w!==null&&w!==s);p===null?l=r:p.next=o,fA(r,e.memoizedState)||(ra=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=p,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,vi.lanes|=s,Af|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function $x(t){var e=Cl(),n=e.queue;if(n===null)throw Error(Bt(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var l=i=i.next;do s=t(s,l.action),l=l.next;while(l!==i);fA(s,e.memoizedState)||(ra=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function KL(){}function JL(t,e){var n=vi,r=Cl(),i=e(),s=!fA(r.memoizedState,i);if(s&&(r.memoizedState=i,ra=!0),r=r.queue,yT(nD.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||ys!==null&&ys.memoizedState.tag&1){if(n.flags|=2048,Og(9,tD.bind(null,n,r,i,e),void 0,null),vs===null)throw Error(Bt(349));lf&30||eD(n,e,i)}return i}function eD(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=vi.updateQueue,e===null?(e={lastEffect:null,stores:null},vi.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function tD(t,e,n,r){e.value=n,e.getSnapshot=r,rD(e)&&iD(t)}function nD(t,e,n){return n(function(){rD(e)&&iD(t)})}function rD(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!fA(t,n)}catch{return!0}}function iD(t){var e=tc(t,1);e!==null&&cA(e,t,1,-1)}function FC(t){var e=$A();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zg,lastRenderedState:t},e.queue=t,t=t.dispatch=fV.bind(null,vi,t),[e.memoizedState,t]}function Og(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=vi.updateQueue,e===null?(e={lastEffect:null,stores:null},vi.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function sD(){return Cl().memoizedState}function wy(t,e,n,r){var i=$A();vi.flags|=t,i.memoizedState=Og(1|e,n,void 0,r===void 0?null:r)}function j2(t,e,n,r){var i=Cl();r=r===void 0?null:r;var s=void 0;if(ns!==null){var l=ns.memoizedState;if(s=l.destroy,r!==null&&pT(r,l.deps)){i.memoizedState=Og(e,n,s,r);return}}vi.flags|=t,i.memoizedState=Og(1|e,n,s,r)}function NC(t,e){return wy(8390656,8,t,e)}function yT(t,e){return j2(2048,8,t,e)}function oD(t,e){return j2(4,2,t,e)}function aD(t,e){return j2(4,4,t,e)}function lD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function AD(t,e,n){return n=n!=null?n.concat([t]):null,j2(4,4,lD.bind(null,e,t),n)}function _T(){}function uD(t,e){var n=Cl();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&pT(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function cD(t,e){var n=Cl();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&pT(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function hD(t,e,n){return lf&21?(fA(n,e)||(n=pL(),vi.lanes|=n,Af|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ra=!0),t.memoizedState=n)}function cV(t,e){var n=zr;zr=n!==0&&4>n?n:4,t(!0);var r=Vx.transition;Vx.transition={};try{t(!1),e()}finally{zr=n,Vx.transition=r}}function fD(){return Cl().memoizedState}function hV(t,e,n){var r=lh(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},dD(t))pD(e,n);else if(n=HL(t,e,n,r),n!==null){var i=zo();cA(n,t,r,i),gD(n,e,r)}}function fV(t,e,n){var r=lh(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(dD(t))pD(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var l=e.lastRenderedState,o=s(l,n);if(i.hasEagerState=!0,i.eagerState=o,fA(o,l)){var p=e.interleaved;p===null?(i.next=i,uT(e)):(i.next=p.next,p.next=i),e.interleaved=i;return}}catch{}finally{}n=HL(t,e,i,r),n!==null&&(i=zo(),cA(n,t,r,i),gD(n,e,r))}}function dD(t){var e=t.alternate;return t===vi||e!==null&&e===vi}function pD(t,e){ug=g_=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function gD(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,YE(t,n)}}var m_={readContext:Sl,useCallback:Js,useContext:Js,useEffect:Js,useImperativeHandle:Js,useInsertionEffect:Js,useLayoutEffect:Js,useMemo:Js,useReducer:Js,useRef:Js,useState:Js,useDebugValue:Js,useDeferredValue:Js,useTransition:Js,useMutableSource:Js,useSyncExternalStore:Js,useId:Js,unstable_isNewReconciler:!1},dV={readContext:Sl,useCallback:function(t,e){return $A().memoizedState=[t,e===void 0?null:e],t},useContext:Sl,useEffect:NC,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,wy(4194308,4,lD.bind(null,e,t),n)},useLayoutEffect:function(t,e){return wy(4194308,4,t,e)},useInsertionEffect:function(t,e){return wy(4,2,t,e)},useMemo:function(t,e){var n=$A();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=$A();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=hV.bind(null,vi,t),[r.memoizedState,t]},useRef:function(t){var e=$A();return t={current:t},e.memoizedState=t},useState:FC,useDebugValue:_T,useDeferredValue:function(t){return $A().memoizedState=t},useTransition:function(){var t=FC(!1),e=t[0];return t=cV.bind(null,t[1]),$A().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=vi,i=$A();if(di){if(n===void 0)throw Error(Bt(407));n=n()}else{if(n=e(),vs===null)throw Error(Bt(349));lf&30||eD(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,NC(nD.bind(null,r,s,t),[t]),r.flags|=2048,Og(9,tD.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=$A(),e=vs.identifierPrefix;if(di){var n=$u,r=Gu;n=(r&~(1<<32-uA(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Bg++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=uV++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},pV={readContext:Sl,useCallback:uD,useContext:Sl,useEffect:yT,useImperativeHandle:AD,useInsertionEffect:oD,useLayoutEffect:aD,useMemo:cD,useReducer:Gx,useRef:sD,useState:function(){return Gx(zg)},useDebugValue:_T,useDeferredValue:function(t){var e=Cl();return hD(e,ns.memoizedState,t)},useTransition:function(){var t=Gx(zg)[0],e=Cl().memoizedState;return[t,e]},useMutableSource:KL,useSyncExternalStore:JL,useId:fD,unstable_isNewReconciler:!1},gV={readContext:Sl,useCallback:uD,useContext:Sl,useEffect:yT,useImperativeHandle:AD,useInsertionEffect:oD,useLayoutEffect:aD,useMemo:cD,useReducer:$x,useRef:sD,useState:function(){return $x(zg)},useDebugValue:_T,useDeferredValue:function(t){var e=Cl();return ns===null?e.memoizedState=t:hD(e,ns.memoizedState,t)},useTransition:function(){var t=$x(zg)[0],e=Cl().memoizedState;return[t,e]},useMutableSource:KL,useSyncExternalStore:JL,useId:fD,unstable_isNewReconciler:!1};function hd(t,e){try{var n="",r=e;do n+=j9(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function jx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function qb(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var mV=typeof WeakMap=="function"?WeakMap:Map;function mD(t,e,n){n=qu(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){__||(__=!0,i3=r),qb(t,e)},n}function yD(t,e,n){n=qu(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){qb(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){qb(t,e),typeof r!="function"&&(ah===null?ah=new Set([this]):ah.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function UC(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new mV;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=IV.bind(null,t,e,n),e.then(t,t))}function VC(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function GC(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=qu(-1,1),e.tag=2,oh(n,e,1))),n.lanes|=1),t)}var yV=dc.ReactCurrentOwner,ra=!1;function Io(t,e,n,r){e.child=t===null?YL(e,null,n,r):ud(e,t.child,n,r)}function $C(t,e,n,r,i){n=n.render;var s=e.ref;return q0(e,i),r=gT(t,e,n,r,s,i),n=mT(),t!==null&&!ra?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,nc(t,e,i)):(di&&n&&iT(e),e.flags|=1,Io(t,e,r,i),e.child)}function jC(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!CT(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,_D(t,e,s,r,i)):(t=Sy(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var l=s.memoizedProps;if(n=n.compare,n=n!==null?n:Pg,n(l,r)&&t.ref===e.ref)return nc(t,e,i)}return e.flags|=1,t=Ah(s,r),t.ref=e.ref,t.return=e,e.child=t}function _D(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Pg(s,r)&&t.ref===e.ref)if(ra=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(ra=!0);else return e.lanes=t.lanes,nc(t,e,i)}return Zb(t,e,n,r,i)}function vD(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ei(C0,Ia),Ia|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ei(C0,Ia),Ia|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ei(C0,Ia),Ia|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ei(C0,Ia),Ia|=r;return Io(t,e,i,n),e.child}function xD(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Zb(t,e,n,r,i){var s=oa(n)?of:po.current;return s=ld(e,s),q0(e,i),n=gT(t,e,n,r,s,i),r=mT(),t!==null&&!ra?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,nc(t,e,i)):(di&&r&&iT(e),e.flags|=1,Io(t,e,n,i),e.child)}function HC(t,e,n,r,i){if(oa(n)){var s=!0;A_(e)}else s=!1;if(q0(e,i),e.stateNode===null)by(t,e),qL(e,n,r),Qb(e,n,r,i),r=!0;else if(t===null){var l=e.stateNode,o=e.memoizedProps;l.props=o;var p=l.context,w=n.contextType;typeof w=="object"&&w!==null?w=Sl(w):(w=oa(n)?of:po.current,w=ld(e,w));var C=n.getDerivedStateFromProps,P=typeof C=="function"||typeof l.getSnapshotBeforeUpdate=="function";P||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==r||p!==w)&&zC(e,l,r,w),jc=!1;var I=e.memoizedState;l.state=I,d_(e,r,l,i),p=e.memoizedState,o!==r||I!==p||sa.current||jc?(typeof C=="function"&&(Wb(e,n,C,r),p=e.memoizedState),(o=jc||BC(e,n,o,r,I,p,w))?(P||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=p),l.props=r,l.state=p,l.context=w,r=o):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,WL(t,e),o=e.memoizedProps,w=e.type===e.elementType?o:Kl(e.type,o),l.props=w,P=e.pendingProps,I=l.context,p=n.contextType,typeof p=="object"&&p!==null?p=Sl(p):(p=oa(n)?of:po.current,p=ld(e,p));var U=n.getDerivedStateFromProps;(C=typeof U=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==P||I!==p)&&zC(e,l,r,p),jc=!1,I=e.memoizedState,l.state=I,d_(e,r,l,i);var W=e.memoizedState;o!==P||I!==W||sa.current||jc?(typeof U=="function"&&(Wb(e,n,U,r),W=e.memoizedState),(w=jc||BC(e,n,w,r,I,W,p)||!1)?(C||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,W,p),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,W,p)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===t.memoizedProps&&I===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&I===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=W),l.props=r,l.state=W,l.context=p,r=w):(typeof l.componentDidUpdate!="function"||o===t.memoizedProps&&I===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&I===t.memoizedState||(e.flags|=1024),r=!1)}return Yb(t,e,n,r,s,i)}function Yb(t,e,n,r,i,s){xD(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return i&&kC(e,n,!1),nc(t,e,s);r=e.stateNode,yV.current=e;var o=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=ud(e,t.child,null,s),e.child=ud(e,null,o,s)):Io(t,e,o,s),e.memoizedState=r.state,i&&kC(e,n,!0),e.child}function wD(t){var e=t.stateNode;e.pendingContext?PC(t,e.pendingContext,e.pendingContext!==e.context):e.context&&PC(t,e.context,!1),hT(t,e.containerInfo)}function WC(t,e,n,r,i){return Ad(),oT(i),e.flags|=256,Io(t,e,n,r),e.child}var Xb={dehydrated:null,treeContext:null,retryLane:0};function Kb(t){return{baseLanes:t,cachePool:null,transitions:null}}function bD(t,e,n){var r=e.pendingProps,i=yi.current,s=!1,l=(e.flags&128)!==0,o;if((o=l)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ei(yi,i&1),t===null)return jb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,s?(r=e.mode,s=e.child,l={mode:"hidden",children:l},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=Q2(l,r,0,null),t=tf(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Kb(n),e.memoizedState=Xb,t):vT(e,l));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return _V(t,e,l,r,o,i,n);if(s){s=r.fallback,l=e.mode,i=t.child,o=i.sibling;var p={mode:"hidden",children:r.children};return!(l&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=p,e.deletions=null):(r=Ah(i,p),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Ah(o,s):(s=tf(s,l,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,l=t.child.memoizedState,l=l===null?Kb(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=Xb,r}return s=t.child,t=s.sibling,r=Ah(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function vT(t,e){return e=Q2({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function E1(t,e,n,r){return r!==null&&oT(r),ud(e,t.child,null,n),t=vT(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function _V(t,e,n,r,i,s,l){if(n)return e.flags&256?(e.flags&=-257,r=jx(Error(Bt(422))),E1(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Q2({mode:"visible",children:r.children},i,0,null),s=tf(s,i,l,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ud(e,t.child,null,l),e.child.memoizedState=Kb(l),e.memoizedState=Xb,s);if(!(e.mode&1))return E1(t,e,l,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(Bt(419)),r=jx(s,r,void 0),E1(t,e,l,r)}if(o=(l&t.childLanes)!==0,ra||o){if(r=vs,r!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,tc(t,i),cA(r,t,i,-1))}return ST(),r=jx(Error(Bt(421))),E1(t,e,l,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=LV.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ra=sh(i.nextSibling),za=e,di=!0,eA=null,t!==null&&(pl[gl++]=Gu,pl[gl++]=$u,pl[gl++]=af,Gu=t.id,$u=t.overflow,af=e),e=vT(e,r.children),e.flags|=4096,e)}function QC(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Hb(t.return,e,n)}function Hx(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function ED(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Io(t,e,r.children,n),r=yi.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&QC(t,n,e);else if(t.tag===19)QC(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ei(yi,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&p_(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Hx(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&p_(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Hx(e,!0,n,null,s);break;case"together":Hx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function by(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function nc(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Af|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Bt(153));if(e.child!==null){for(t=e.child,n=Ah(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ah(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function vV(t,e,n){switch(e.tag){case 3:wD(e),Ad();break;case 5:XL(e);break;case 1:oa(e.type)&&A_(e);break;case 4:hT(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ei(h_,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ei(yi,yi.current&1),e.flags|=128,null):n&e.child.childLanes?bD(t,e,n):(ei(yi,yi.current&1),t=nc(t,e,n),t!==null?t.sibling:null);ei(yi,yi.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return ED(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ei(yi,yi.current),r)break;return null;case 22:case 23:return e.lanes=0,vD(t,e,n)}return nc(t,e,n)}var TD,Jb,SD,CD;TD=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Jb=function(){};SD=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Xh(YA.current);var s=null;switch(n){case"input":i=xb(t,i),r=xb(t,r),s=[];break;case"select":i=xi({},i,{value:void 0}),r=xi({},r,{value:void 0}),s=[];break;case"textarea":i=Eb(t,i),r=Eb(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=a_)}Sb(n,r);var l;n=null;for(w in i)if(!r.hasOwnProperty(w)&&i.hasOwnProperty(w)&&i[w]!=null)if(w==="style"){var o=i[w];for(l in o)o.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(wg.hasOwnProperty(w)?s||(s=[]):(s=s||[]).push(w,null));for(w in r){var p=r[w];if(o=i?.[w],r.hasOwnProperty(w)&&p!==o&&(p!=null||o!=null))if(w==="style")if(o){for(l in o)!o.hasOwnProperty(l)||p&&p.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in p)p.hasOwnProperty(l)&&o[l]!==p[l]&&(n||(n={}),n[l]=p[l])}else n||(s||(s=[]),s.push(w,n)),n=p;else w==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,o=o?o.__html:void 0,p!=null&&o!==p&&(s=s||[]).push(w,p)):w==="children"?typeof p!="string"&&typeof p!="number"||(s=s||[]).push(w,""+p):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(wg.hasOwnProperty(w)?(p!=null&&w==="onScroll"&&ai("scroll",t),s||o===p||(s=[])):(s=s||[]).push(w,p))}n&&(s=s||[]).push("style",n);var w=s;(e.updateQueue=w)&&(e.flags|=4)}};CD=function(t,e,n,r){n!==r&&(e.flags|=4)};function vp(t,e){if(!di)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function eo(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function xV(t,e,n){var r=e.pendingProps;switch(sT(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return eo(e),null;case 1:return oa(e.type)&&l_(),eo(e),null;case 3:return r=e.stateNode,cd(),li(sa),li(po),dT(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(w1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,eA!==null&&(a3(eA),eA=null))),Jb(t,e),eo(e),null;case 5:fT(e);var i=Xh(Rg.current);if(n=e.type,t!==null&&e.stateNode!=null)SD(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Bt(166));return eo(e),null}if(t=Xh(YA.current),w1(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[jA]=e,r[Lg]=s,t=(e.mode&1)!==0,n){case"dialog":ai("cancel",r),ai("close",r);break;case"iframe":case"object":case"embed":ai("load",r);break;case"video":case"audio":for(i=0;i<qp.length;i++)ai(qp[i],r);break;case"source":ai("error",r);break;case"img":case"image":case"link":ai("error",r),ai("load",r);break;case"details":ai("toggle",r);break;case"input":nC(r,s),ai("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ai("invalid",r);break;case"textarea":iC(r,s),ai("invalid",r)}Sb(n,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var o=s[l];l==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&x1(r.textContent,o,t),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&x1(r.textContent,o,t),i=["children",""+o]):wg.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&ai("scroll",r)}switch(n){case"input":f1(r),rC(r,s,!0);break;case"textarea":f1(r),sC(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=a_)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=eL(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),n==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[jA]=e,t[Lg]=r,TD(t,e,!1,!1),e.stateNode=t;e:{switch(l=Cb(n,r),n){case"dialog":ai("cancel",t),ai("close",t),i=r;break;case"iframe":case"object":case"embed":ai("load",t),i=r;break;case"video":case"audio":for(i=0;i<qp.length;i++)ai(qp[i],t);i=r;break;case"source":ai("error",t),i=r;break;case"img":case"image":case"link":ai("error",t),ai("load",t),i=r;break;case"details":ai("toggle",t),i=r;break;case"input":nC(t,r),i=xb(t,r),ai("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=xi({},r,{value:void 0}),ai("invalid",t);break;case"textarea":iC(t,r),i=Eb(t,r),ai("invalid",t);break;default:i=r}Sb(n,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var p=o[s];s==="style"?rL(t,p):s==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&tL(t,p)):s==="children"?typeof p=="string"?(n!=="textarea"||p!=="")&&bg(t,p):typeof p=="number"&&bg(t,""+p):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(wg.hasOwnProperty(s)?p!=null&&s==="onScroll"&&ai("scroll",t):p!=null&&jE(t,s,p,l))}switch(n){case"input":f1(t),rC(t,r,!1);break;case"textarea":f1(t),sC(t);break;case"option":r.value!=null&&t.setAttribute("value",""+dh(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?j0(t,!!r.multiple,s,!1):r.defaultValue!=null&&j0(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=a_)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return eo(e),null;case 6:if(t&&e.stateNode!=null)CD(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Bt(166));if(n=Xh(Rg.current),Xh(YA.current),w1(e)){if(r=e.stateNode,n=e.memoizedProps,r[jA]=e,(s=r.nodeValue!==n)&&(t=za,t!==null))switch(t.tag){case 3:x1(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&x1(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[jA]=e,e.stateNode=r}return eo(e),null;case 13:if(li(yi),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(di&&Ra!==null&&e.mode&1&&!(e.flags&128))jL(),Ad(),e.flags|=98560,s=!1;else if(s=w1(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Bt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Bt(317));s[jA]=e}else Ad(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;eo(e),s=!1}else eA!==null&&(a3(eA),eA=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||yi.current&1?rs===0&&(rs=3):ST())),e.updateQueue!==null&&(e.flags|=4),eo(e),null);case 4:return cd(),Jb(t,e),t===null&&kg(e.stateNode.containerInfo),eo(e),null;case 10:return AT(e.type._context),eo(e),null;case 17:return oa(e.type)&&l_(),eo(e),null;case 19:if(li(yi),s=e.memoizedState,s===null)return eo(e),null;if(r=(e.flags&128)!==0,l=s.rendering,l===null)if(r)vp(s,!1);else{if(rs!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=p_(t),l!==null){for(e.flags|=128,vp(s,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ei(yi,yi.current&1|2),e.child}t=t.sibling}s.tail!==null&&Oi()>fd&&(e.flags|=128,r=!0,vp(s,!1),e.lanes=4194304)}else{if(!r)if(t=p_(l),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),vp(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!di)return eo(e),null}else 2*Oi()-s.renderingStartTime>fd&&n!==1073741824&&(e.flags|=128,r=!0,vp(s,!1),e.lanes=4194304);s.isBackwards?(l.sibling=e.child,e.child=l):(n=s.last,n!==null?n.sibling=l:e.child=l,s.last=l)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Oi(),e.sibling=null,n=yi.current,ei(yi,r?n&1|2:n&1),e):(eo(e),null);case 22:case 23:return TT(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ia&1073741824&&(eo(e),e.subtreeFlags&6&&(e.flags|=8192)):eo(e),null;case 24:return null;case 25:return null}throw Error(Bt(156,e.tag))}function wV(t,e){switch(sT(e),e.tag){case 1:return oa(e.type)&&l_(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return cd(),li(sa),li(po),dT(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return fT(e),null;case 13:if(li(yi),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Bt(340));Ad()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return li(yi),null;case 4:return cd(),null;case 10:return AT(e.type._context),null;case 22:case 23:return TT(),null;case 24:return null;default:return null}}var T1=!1,uo=!1,bV=typeof WeakSet=="function"?WeakSet:Set,cn=null;function S0(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Mi(t,e,r)}else n.current=null}function e3(t,e,n){try{n()}catch(r){Mi(t,e,r)}}var qC=!1;function EV(t,e){if(Ob=i_,t=IL(),rT(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var l=0,o=-1,p=-1,w=0,C=0,P=t,I=null;t:for(;;){for(var U;P!==n||i!==0&&P.nodeType!==3||(o=l+i),P!==s||r!==0&&P.nodeType!==3||(p=l+r),P.nodeType===3&&(l+=P.nodeValue.length),(U=P.firstChild)!==null;)I=P,P=U;for(;;){if(P===t)break t;if(I===n&&++w===i&&(o=l),I===s&&++C===r&&(p=l),(U=P.nextSibling)!==null)break;P=I,I=P.parentNode}P=U}n=o===-1||p===-1?null:{start:o,end:p}}else n=null}n=n||{start:0,end:0}}else n=null;for(Fb={focusedElem:t,selectionRange:n},i_=!1,cn=e;cn!==null;)if(e=cn,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,cn=t;else for(;cn!==null;){e=cn;try{var W=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(W!==null){var H=W.memoizedProps,ie=W.memoizedState,X=e.stateNode,ee=X.getSnapshotBeforeUpdate(e.elementType===e.type?H:Kl(e.type,H),ie);X.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:var se=e.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Bt(163))}}catch(fe){Mi(e,e.return,fe)}if(t=e.sibling,t!==null){t.return=e.return,cn=t;break}cn=e.return}return W=qC,qC=!1,W}function cg(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&e3(e,n,s)}i=i.next}while(i!==r)}}function H2(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function t3(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function MD(t){var e=t.alternate;e!==null&&(t.alternate=null,MD(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[jA],delete e[Lg],delete e[Vb],delete e[oV],delete e[aV])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function PD(t){return t.tag===5||t.tag===3||t.tag===4}function ZC(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||PD(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function n3(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=a_));else if(r!==4&&(t=t.child,t!==null))for(n3(t,e,n),t=t.sibling;t!==null;)n3(t,e,n),t=t.sibling}function r3(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(r3(t,e,n),t=t.sibling;t!==null;)r3(t,e,n),t=t.sibling}var Ls=null,Jl=!1;function Bc(t,e,n){for(n=n.child;n!==null;)kD(t,e,n),n=n.sibling}function kD(t,e,n){if(ZA&&typeof ZA.onCommitFiberUnmount=="function")try{ZA.onCommitFiberUnmount(O2,n)}catch{}switch(n.tag){case 5:uo||S0(n,e);case 6:var r=Ls,i=Jl;Ls=null,Bc(t,e,n),Ls=r,Jl=i,Ls!==null&&(Jl?(t=Ls,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ls.removeChild(n.stateNode));break;case 18:Ls!==null&&(Jl?(t=Ls,n=n.stateNode,t.nodeType===8?Fx(t.parentNode,n):t.nodeType===1&&Fx(t,n),Cg(t)):Fx(Ls,n.stateNode));break;case 4:r=Ls,i=Jl,Ls=n.stateNode.containerInfo,Jl=!0,Bc(t,e,n),Ls=r,Jl=i;break;case 0:case 11:case 14:case 15:if(!uo&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&e3(n,e,l),i=i.next}while(i!==r)}Bc(t,e,n);break;case 1:if(!uo&&(S0(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Mi(n,e,o)}Bc(t,e,n);break;case 21:Bc(t,e,n);break;case 22:n.mode&1?(uo=(r=uo)||n.memoizedState!==null,Bc(t,e,n),uo=r):Bc(t,e,n);break;default:Bc(t,e,n)}}function YC(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new bV),e.forEach(function(r){var i=DV.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Xl(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,l=e,o=l;e:for(;o!==null;){switch(o.tag){case 5:Ls=o.stateNode,Jl=!1;break e;case 3:Ls=o.stateNode.containerInfo,Jl=!0;break e;case 4:Ls=o.stateNode.containerInfo,Jl=!0;break e}o=o.return}if(Ls===null)throw Error(Bt(160));kD(s,l,i),Ls=null,Jl=!1;var p=i.alternate;p!==null&&(p.return=null),i.return=null}catch(w){Mi(i,e,w)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ID(e,t),e=e.sibling}function ID(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xl(e,t),BA(t),r&4){try{cg(3,t,t.return),H2(3,t)}catch(H){Mi(t,t.return,H)}try{cg(5,t,t.return)}catch(H){Mi(t,t.return,H)}}break;case 1:Xl(e,t),BA(t),r&512&&n!==null&&S0(n,n.return);break;case 5:if(Xl(e,t),BA(t),r&512&&n!==null&&S0(n,n.return),t.flags&32){var i=t.stateNode;try{bg(i,"")}catch(H){Mi(t,t.return,H)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,l=n!==null?n.memoizedProps:s,o=t.type,p=t.updateQueue;if(t.updateQueue=null,p!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&K8(i,s),Cb(o,l);var w=Cb(o,s);for(l=0;l<p.length;l+=2){var C=p[l],P=p[l+1];C==="style"?rL(i,P):C==="dangerouslySetInnerHTML"?tL(i,P):C==="children"?bg(i,P):jE(i,C,P,w)}switch(o){case"input":wb(i,s);break;case"textarea":J8(i,s);break;case"select":var I=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var U=s.value;U!=null?j0(i,!!s.multiple,U,!1):I!==!!s.multiple&&(s.defaultValue!=null?j0(i,!!s.multiple,s.defaultValue,!0):j0(i,!!s.multiple,s.multiple?[]:"",!1))}i[Lg]=s}catch(H){Mi(t,t.return,H)}}break;case 6:if(Xl(e,t),BA(t),r&4){if(t.stateNode===null)throw Error(Bt(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(H){Mi(t,t.return,H)}}break;case 3:if(Xl(e,t),BA(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Cg(e.containerInfo)}catch(H){Mi(t,t.return,H)}break;case 4:Xl(e,t),BA(t);break;case 13:Xl(e,t),BA(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(bT=Oi())),r&4&&YC(t);break;case 22:if(C=n!==null&&n.memoizedState!==null,t.mode&1?(uo=(w=uo)||C,Xl(e,t),uo=w):Xl(e,t),BA(t),r&8192){if(w=t.memoizedState!==null,(t.stateNode.isHidden=w)&&!C&&t.mode&1)for(cn=t,C=t.child;C!==null;){for(P=cn=C;cn!==null;){switch(I=cn,U=I.child,I.tag){case 0:case 11:case 14:case 15:cg(4,I,I.return);break;case 1:S0(I,I.return);var W=I.stateNode;if(typeof W.componentWillUnmount=="function"){r=I,n=I.return;try{e=r,W.props=e.memoizedProps,W.state=e.memoizedState,W.componentWillUnmount()}catch(H){Mi(r,n,H)}}break;case 5:S0(I,I.return);break;case 22:if(I.memoizedState!==null){KC(P);continue}}U!==null?(U.return=I,cn=U):KC(P)}C=C.sibling}e:for(C=null,P=t;;){if(P.tag===5){if(C===null){C=P;try{i=P.stateNode,w?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=P.stateNode,p=P.memoizedProps.style,l=p!=null&&p.hasOwnProperty("display")?p.display:null,o.style.display=nL("display",l))}catch(H){Mi(t,t.return,H)}}}else if(P.tag===6){if(C===null)try{P.stateNode.nodeValue=w?"":P.memoizedProps}catch(H){Mi(t,t.return,H)}}else if((P.tag!==22&&P.tag!==23||P.memoizedState===null||P===t)&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===t)break e;for(;P.sibling===null;){if(P.return===null||P.return===t)break e;C===P&&(C=null),P=P.return}C===P&&(C=null),P.sibling.return=P.return,P=P.sibling}}break;case 19:Xl(e,t),BA(t),r&4&&YC(t);break;case 21:break;default:Xl(e,t),BA(t)}}function BA(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(PD(n)){var r=n;break e}n=n.return}throw Error(Bt(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(bg(i,""),r.flags&=-33);var s=ZC(t);r3(t,s,i);break;case 3:case 4:var l=r.stateNode.containerInfo,o=ZC(t);n3(t,o,l);break;default:throw Error(Bt(161))}}catch(p){Mi(t,t.return,p)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function TV(t,e,n){cn=t,LD(t)}function LD(t,e,n){for(var r=(t.mode&1)!==0;cn!==null;){var i=cn,s=i.child;if(i.tag===22&&r){var l=i.memoizedState!==null||T1;if(!l){var o=i.alternate,p=o!==null&&o.memoizedState!==null||uo;o=T1;var w=uo;if(T1=l,(uo=p)&&!w)for(cn=i;cn!==null;)l=cn,p=l.child,l.tag===22&&l.memoizedState!==null?JC(i):p!==null?(p.return=l,cn=p):JC(i);for(;s!==null;)cn=s,LD(s),s=s.sibling;cn=i,T1=o,uo=w}XC(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,cn=s):XC(t)}}function XC(t){for(;cn!==null;){var e=cn;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:uo||H2(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!uo)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Kl(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&RC(e,s,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}RC(e,l,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var p=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&n.focus();break;case"img":p.src&&(n.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var w=e.alternate;if(w!==null){var C=w.memoizedState;if(C!==null){var P=C.dehydrated;P!==null&&Cg(P)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Bt(163))}uo||e.flags&512&&t3(e)}catch(I){Mi(e,e.return,I)}}if(e===t){cn=null;break}if(n=e.sibling,n!==null){n.return=e.return,cn=n;break}cn=e.return}}function KC(t){for(;cn!==null;){var e=cn;if(e===t){cn=null;break}var n=e.sibling;if(n!==null){n.return=e.return,cn=n;break}cn=e.return}}function JC(t){for(;cn!==null;){var e=cn;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{H2(4,e)}catch(p){Mi(e,n,p)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(p){Mi(e,i,p)}}var s=e.return;try{t3(e)}catch(p){Mi(e,s,p)}break;case 5:var l=e.return;try{t3(e)}catch(p){Mi(e,l,p)}}}catch(p){Mi(e,e.return,p)}if(e===t){cn=null;break}var o=e.sibling;if(o!==null){o.return=e.return,cn=o;break}cn=e.return}}var SV=Math.ceil,y_=dc.ReactCurrentDispatcher,xT=dc.ReactCurrentOwner,vl=dc.ReactCurrentBatchConfig,Er=0,vs=null,Zi=null,Bs=0,Ia=0,C0=Eh(0),rs=0,Fg=null,Af=0,W2=0,wT=0,hg=null,na=null,bT=0,fd=1/0,Fu=null,__=!1,i3=null,ah=null,S1=!1,Yc=null,v_=0,fg=0,s3=null,Ey=-1,Ty=0;function zo(){return Er&6?Oi():Ey!==-1?Ey:Ey=Oi()}function lh(t){return t.mode&1?Er&2&&Bs!==0?Bs&-Bs:AV.transition!==null?(Ty===0&&(Ty=pL()),Ty):(t=zr,t!==0||(t=window.event,t=t===void 0?16:wL(t.type)),t):1}function cA(t,e,n,r){if(50<fg)throw fg=0,s3=null,Error(Bt(185));mm(t,n,r),(!(Er&2)||t!==vs)&&(t===vs&&(!(Er&2)&&(W2|=n),rs===4&&Qc(t,Bs)),aa(t,r),n===1&&Er===0&&!(e.mode&1)&&(fd=Oi()+500,G2&&Th()))}function aa(t,e){var n=t.callbackNode;AU(t,e);var r=r_(t,t===vs?Bs:0);if(r===0)n!==null&&lC(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&lC(n),e===1)t.tag===0?lV(eM.bind(null,t)):VL(eM.bind(null,t)),iV(function(){!(Er&6)&&Th()}),n=null;else{switch(gL(r)){case 1:n=ZE;break;case 4:n=fL;break;case 16:n=n_;break;case 536870912:n=dL;break;default:n=n_}n=UD(n,DD.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function DD(t,e){if(Ey=-1,Ty=0,Er&6)throw Error(Bt(327));var n=t.callbackNode;if(Z0()&&t.callbackNode!==n)return null;var r=r_(t,t===vs?Bs:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=x_(t,r);else{e=r;var i=Er;Er|=2;var s=BD();(vs!==t||Bs!==e)&&(Fu=null,fd=Oi()+500,ef(t,e));do try{PV();break}catch(o){RD(t,o)}while(1);lT(),y_.current=s,Er=i,Zi!==null?e=0:(vs=null,Bs=0,e=rs)}if(e!==0){if(e===2&&(i=Lb(t),i!==0&&(r=i,e=o3(t,i))),e===1)throw n=Fg,ef(t,0),Qc(t,r),aa(t,Oi()),n;if(e===6)Qc(t,r);else{if(i=t.current.alternate,!(r&30)&&!CV(i)&&(e=x_(t,r),e===2&&(s=Lb(t),s!==0&&(r=s,e=o3(t,s))),e===1))throw n=Fg,ef(t,0),Qc(t,r),aa(t,Oi()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Bt(345));case 2:Hh(t,na,Fu);break;case 3:if(Qc(t,r),(r&130023424)===r&&(e=bT+500-Oi(),10<e)){if(r_(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){zo(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Ub(Hh.bind(null,t,na,Fu),e);break}Hh(t,na,Fu);break;case 4:if(Qc(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var l=31-uA(r);s=1<<l,l=e[l],l>i&&(i=l),r&=~s}if(r=i,r=Oi()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*SV(r/1960))-r,10<r){t.timeoutHandle=Ub(Hh.bind(null,t,na,Fu),r);break}Hh(t,na,Fu);break;case 5:Hh(t,na,Fu);break;default:throw Error(Bt(329))}}}return aa(t,Oi()),t.callbackNode===n?DD.bind(null,t):null}function o3(t,e){var n=hg;return t.current.memoizedState.isDehydrated&&(ef(t,e).flags|=256),t=x_(t,e),t!==2&&(e=na,na=n,e!==null&&a3(e)),t}function a3(t){na===null?na=t:na.push.apply(na,t)}function CV(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!fA(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qc(t,e){for(e&=~wT,e&=~W2,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-uA(e),r=1<<n;t[n]=-1,e&=~r}}function eM(t){if(Er&6)throw Error(Bt(327));Z0();var e=r_(t,0);if(!(e&1))return aa(t,Oi()),null;var n=x_(t,e);if(t.tag!==0&&n===2){var r=Lb(t);r!==0&&(e=r,n=o3(t,r))}if(n===1)throw n=Fg,ef(t,0),Qc(t,e),aa(t,Oi()),n;if(n===6)throw Error(Bt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Hh(t,na,Fu),aa(t,Oi()),null}function ET(t,e){var n=Er;Er|=1;try{return t(e)}finally{Er=n,Er===0&&(fd=Oi()+500,G2&&Th())}}function uf(t){Yc!==null&&Yc.tag===0&&!(Er&6)&&Z0();var e=Er;Er|=1;var n=vl.transition,r=zr;try{if(vl.transition=null,zr=1,t)return t()}finally{zr=r,vl.transition=n,Er=e,!(Er&6)&&Th()}}function TT(){Ia=C0.current,li(C0)}function ef(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,rV(n)),Zi!==null)for(n=Zi.return;n!==null;){var r=n;switch(sT(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&l_();break;case 3:cd(),li(sa),li(po),dT();break;case 5:fT(r);break;case 4:cd();break;case 13:li(yi);break;case 19:li(yi);break;case 10:AT(r.type._context);break;case 22:case 23:TT()}n=n.return}if(vs=t,Zi=t=Ah(t.current,null),Bs=Ia=e,rs=0,Fg=null,wT=W2=Af=0,na=hg=null,Yh!==null){for(e=0;e<Yh.length;e++)if(n=Yh[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var l=s.next;s.next=i,r.next=l}n.pending=r}Yh=null}return t}function RD(t,e){do{var n=Zi;try{if(lT(),xy.current=m_,g_){for(var r=vi.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}g_=!1}if(lf=0,ys=ns=vi=null,ug=!1,Bg=0,xT.current=null,n===null||n.return===null){rs=1,Fg=e,Zi=null;break}e:{var s=t,l=n.return,o=n,p=e;if(e=Bs,o.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var w=p,C=o,P=C.tag;if(!(C.mode&1)&&(P===0||P===11||P===15)){var I=C.alternate;I?(C.updateQueue=I.updateQueue,C.memoizedState=I.memoizedState,C.lanes=I.lanes):(C.updateQueue=null,C.memoizedState=null)}var U=VC(l);if(U!==null){U.flags&=-257,GC(U,l,o,s,e),U.mode&1&&UC(s,w,e),e=U,p=w;var W=e.updateQueue;if(W===null){var H=new Set;H.add(p),e.updateQueue=H}else W.add(p);break e}else{if(!(e&1)){UC(s,w,e),ST();break e}p=Error(Bt(426))}}else if(di&&o.mode&1){var ie=VC(l);if(ie!==null){!(ie.flags&65536)&&(ie.flags|=256),GC(ie,l,o,s,e),oT(hd(p,o));break e}}s=p=hd(p,o),rs!==4&&(rs=2),hg===null?hg=[s]:hg.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var X=mD(s,p,e);DC(s,X);break e;case 1:o=p;var ee=s.type,se=s.stateNode;if(!(s.flags&128)&&(typeof ee.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(ah===null||!ah.has(se)))){s.flags|=65536,e&=-e,s.lanes|=e;var fe=yD(s,o,e);DC(s,fe);break e}}s=s.return}while(s!==null)}OD(n)}catch(me){e=me,Zi===n&&n!==null&&(Zi=n=n.return);continue}break}while(1)}function BD(){var t=y_.current;return y_.current=m_,t===null?m_:t}function ST(){(rs===0||rs===3||rs===2)&&(rs=4),vs===null||!(Af&268435455)&&!(W2&268435455)||Qc(vs,Bs)}function x_(t,e){var n=Er;Er|=2;var r=BD();(vs!==t||Bs!==e)&&(Fu=null,ef(t,e));do try{MV();break}catch(i){RD(t,i)}while(1);if(lT(),Er=n,y_.current=r,Zi!==null)throw Error(Bt(261));return vs=null,Bs=0,rs}function MV(){for(;Zi!==null;)zD(Zi)}function PV(){for(;Zi!==null&&!eU();)zD(Zi)}function zD(t){var e=ND(t.alternate,t,Ia);t.memoizedProps=t.pendingProps,e===null?OD(t):Zi=e,xT.current=null}function OD(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=wV(n,e),n!==null){n.flags&=32767,Zi=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{rs=6,Zi=null;return}}else if(n=xV(n,e,Ia),n!==null){Zi=n;return}if(e=e.sibling,e!==null){Zi=e;return}Zi=e=t}while(e!==null);rs===0&&(rs=5)}function Hh(t,e,n){var r=zr,i=vl.transition;try{vl.transition=null,zr=1,kV(t,e,n,r)}finally{vl.transition=i,zr=r}return null}function kV(t,e,n,r){do Z0();while(Yc!==null);if(Er&6)throw Error(Bt(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Bt(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(uU(t,s),t===vs&&(Zi=vs=null,Bs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||S1||(S1=!0,UD(n_,function(){return Z0(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=vl.transition,vl.transition=null;var l=zr;zr=1;var o=Er;Er|=4,xT.current=null,EV(t,n),ID(n,t),YU(Fb),i_=!!Ob,Fb=Ob=null,t.current=n,TV(n),tU(),Er=o,zr=l,vl.transition=s}else t.current=n;if(S1&&(S1=!1,Yc=t,v_=i),s=t.pendingLanes,s===0&&(ah=null),iU(n.stateNode),aa(t,Oi()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(__)throw __=!1,t=i3,i3=null,t;return v_&1&&t.tag!==0&&Z0(),s=t.pendingLanes,s&1?t===s3?fg++:(fg=0,s3=t):fg=0,Th(),null}function Z0(){if(Yc!==null){var t=gL(v_),e=vl.transition,n=zr;try{if(vl.transition=null,zr=16>t?16:t,Yc===null)var r=!1;else{if(t=Yc,Yc=null,v_=0,Er&6)throw Error(Bt(331));var i=Er;for(Er|=4,cn=t.current;cn!==null;){var s=cn,l=s.child;if(cn.flags&16){var o=s.deletions;if(o!==null){for(var p=0;p<o.length;p++){var w=o[p];for(cn=w;cn!==null;){var C=cn;switch(C.tag){case 0:case 11:case 15:cg(8,C,s)}var P=C.child;if(P!==null)P.return=C,cn=P;else for(;cn!==null;){C=cn;var I=C.sibling,U=C.return;if(MD(C),C===w){cn=null;break}if(I!==null){I.return=U,cn=I;break}cn=U}}}var W=s.alternate;if(W!==null){var H=W.child;if(H!==null){W.child=null;do{var ie=H.sibling;H.sibling=null,H=ie}while(H!==null)}}cn=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,cn=l;else e:for(;cn!==null;){if(s=cn,s.flags&2048)switch(s.tag){case 0:case 11:case 15:cg(9,s,s.return)}var X=s.sibling;if(X!==null){X.return=s.return,cn=X;break e}cn=s.return}}var ee=t.current;for(cn=ee;cn!==null;){l=cn;var se=l.child;if(l.subtreeFlags&2064&&se!==null)se.return=l,cn=se;else e:for(l=ee;cn!==null;){if(o=cn,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:H2(9,o)}}catch(me){Mi(o,o.return,me)}if(o===l){cn=null;break e}var fe=o.sibling;if(fe!==null){fe.return=o.return,cn=fe;break e}cn=o.return}}if(Er=i,Th(),ZA&&typeof ZA.onPostCommitFiberRoot=="function")try{ZA.onPostCommitFiberRoot(O2,t)}catch{}r=!0}return r}finally{zr=n,vl.transition=e}}return!1}function tM(t,e,n){e=hd(n,e),e=mD(t,e,1),t=oh(t,e,1),e=zo(),t!==null&&(mm(t,1,e),aa(t,e))}function Mi(t,e,n){if(t.tag===3)tM(t,t,n);else for(;e!==null;){if(e.tag===3){tM(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ah===null||!ah.has(r))){t=hd(n,t),t=yD(e,t,1),e=oh(e,t,1),t=zo(),e!==null&&(mm(e,1,t),aa(e,t));break}}e=e.return}}function IV(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=zo(),t.pingedLanes|=t.suspendedLanes&n,vs===t&&(Bs&n)===n&&(rs===4||rs===3&&(Bs&130023424)===Bs&&500>Oi()-bT?ef(t,0):wT|=n),aa(t,e)}function FD(t,e){e===0&&(t.mode&1?(e=g1,g1<<=1,!(g1&130023424)&&(g1=4194304)):e=1);var n=zo();t=tc(t,e),t!==null&&(mm(t,e,n),aa(t,n))}function LV(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),FD(t,n)}function DV(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Bt(314))}r!==null&&r.delete(e),FD(t,n)}var ND;ND=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||sa.current)ra=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ra=!1,vV(t,e,n);ra=!!(t.flags&131072)}else ra=!1,di&&e.flags&1048576&&GL(e,c_,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;by(t,e),t=e.pendingProps;var i=ld(e,po.current);q0(e,n),i=gT(null,e,r,t,i,n);var s=mT();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,oa(r)?(s=!0,A_(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,cT(e),i.updater=$2,e.stateNode=i,i._reactInternals=e,Qb(e,r,t,n),e=Yb(null,e,r,!0,s,n)):(e.tag=0,di&&s&&iT(e),Io(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(by(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=BV(r),t=Kl(r,t),i){case 0:e=Zb(null,e,r,t,n);break e;case 1:e=HC(null,e,r,t,n);break e;case 11:e=$C(null,e,r,t,n);break e;case 14:e=jC(null,e,r,Kl(r.type,t),n);break e}throw Error(Bt(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kl(r,i),Zb(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kl(r,i),HC(t,e,r,i,n);case 3:e:{if(wD(e),t===null)throw Error(Bt(387));r=e.pendingProps,s=e.memoizedState,i=s.element,WL(t,e),d_(e,r,null,n);var l=e.memoizedState;if(r=l.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=hd(Error(Bt(423)),e),e=WC(t,e,r,n,i);break e}else if(r!==i){i=hd(Error(Bt(424)),e),e=WC(t,e,r,n,i);break e}else for(Ra=sh(e.stateNode.containerInfo.firstChild),za=e,di=!0,eA=null,n=YL(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ad(),r===i){e=nc(t,e,n);break e}Io(t,e,r,n)}e=e.child}return e;case 5:return XL(e),t===null&&jb(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,l=i.children,Nb(r,i)?l=null:s!==null&&Nb(r,s)&&(e.flags|=32),xD(t,e),Io(t,e,l,n),e.child;case 6:return t===null&&jb(e),null;case 13:return bD(t,e,n);case 4:return hT(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ud(e,null,r,n):Io(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kl(r,i),$C(t,e,r,i,n);case 7:return Io(t,e,e.pendingProps,n),e.child;case 8:return Io(t,e,e.pendingProps.children,n),e.child;case 12:return Io(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,l=i.value,ei(h_,r._currentValue),r._currentValue=l,s!==null)if(fA(s.value,l)){if(s.children===i.children&&!sa.current){e=nc(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){l=s.child;for(var p=o.firstContext;p!==null;){if(p.context===r){if(s.tag===1){p=qu(-1,n&-n),p.tag=2;var w=s.updateQueue;if(w!==null){w=w.shared;var C=w.pending;C===null?p.next=p:(p.next=C.next,C.next=p),w.pending=p}}s.lanes|=n,p=s.alternate,p!==null&&(p.lanes|=n),Hb(s.return,n,e),o.lanes|=n;break}p=p.next}}else if(s.tag===10)l=s.type===e.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(Bt(341));l.lanes|=n,o=l.alternate,o!==null&&(o.lanes|=n),Hb(l,n,e),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===e){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}Io(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,q0(e,n),i=Sl(i),r=r(i),e.flags|=1,Io(t,e,r,n),e.child;case 14:return r=e.type,i=Kl(r,e.pendingProps),i=Kl(r.type,i),jC(t,e,r,i,n);case 15:return _D(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kl(r,i),by(t,e),e.tag=1,oa(r)?(t=!0,A_(e)):t=!1,q0(e,n),qL(e,r,i),Qb(e,r,i,n),Yb(null,e,r,!0,t,n);case 19:return ED(t,e,n);case 22:return vD(t,e,n)}throw Error(Bt(156,e.tag))};function UD(t,e){return hL(t,e)}function RV(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ml(t,e,n,r){return new RV(t,e,n,r)}function CT(t){return t=t.prototype,!(!t||!t.isReactComponent)}function BV(t){if(typeof t=="function")return CT(t)?1:0;if(t!=null){if(t=t.$$typeof,t===WE)return 11;if(t===QE)return 14}return 2}function Ah(t,e){var n=t.alternate;return n===null?(n=ml(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Sy(t,e,n,r,i,s){var l=2;if(r=t,typeof t=="function")CT(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case m0:return tf(n.children,i,s,e);case HE:l=8,i|=8;break;case mb:return t=ml(12,n,e,i|2),t.elementType=mb,t.lanes=s,t;case yb:return t=ml(13,n,e,i),t.elementType=yb,t.lanes=s,t;case _b:return t=ml(19,n,e,i),t.elementType=_b,t.lanes=s,t;case Z8:return Q2(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Q8:l=10;break e;case q8:l=9;break e;case WE:l=11;break e;case QE:l=14;break e;case $c:l=16,r=null;break e}throw Error(Bt(130,t==null?t:typeof t,""))}return e=ml(l,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function tf(t,e,n,r){return t=ml(7,t,r,e),t.lanes=n,t}function Q2(t,e,n,r){return t=ml(22,t,r,e),t.elementType=Z8,t.lanes=n,t.stateNode={isHidden:!1},t}function Wx(t,e,n){return t=ml(6,t,null,e),t.lanes=n,t}function Qx(t,e,n){return e=ml(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function zV(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cx(0),this.expirationTimes=Cx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cx(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function MT(t,e,n,r,i,s,l,o,p){return t=new zV(t,e,n,o,p),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ml(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},cT(s),t}function OV(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:g0,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function VD(t){if(!t)return ph;t=t._reactInternals;e:{if(Cf(t)!==t||t.tag!==1)throw Error(Bt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(oa(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Bt(171))}if(t.tag===1){var n=t.type;if(oa(n))return UL(t,n,e)}return e}function GD(t,e,n,r,i,s,l,o,p){return t=MT(n,r,!0,t,i,s,l,o,p),t.context=VD(null),n=t.current,r=zo(),i=lh(n),s=qu(r,i),s.callback=e??null,oh(n,s,i),t.current.lanes=i,mm(t,i,r),aa(t,r),t}function q2(t,e,n,r){var i=e.current,s=zo(),l=lh(i);return n=VD(n),e.context===null?e.context=n:e.pendingContext=n,e=qu(s,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=oh(i,e,l),t!==null&&(cA(t,i,l,s),vy(t,i,l)),l}function w_(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function nM(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function PT(t,e){nM(t,e),(t=t.alternate)&&nM(t,e)}function FV(){return null}var $D=typeof reportError=="function"?reportError:function(t){console.error(t)};function kT(t){this._internalRoot=t}Z2.prototype.render=kT.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Bt(409));q2(t,e,null,null)};Z2.prototype.unmount=kT.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;uf(function(){q2(null,t,null,null)}),e[ec]=null}};function Z2(t){this._internalRoot=t}Z2.prototype.unstable_scheduleHydration=function(t){if(t){var e=_L();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Wc.length&&e!==0&&e<Wc[n].priority;n++);Wc.splice(n,0,t),n===0&&xL(t)}};function IT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Y2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function rM(){}function NV(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var w=w_(l);s.call(w)}}var l=GD(e,r,t,0,null,!1,!1,"",rM);return t._reactRootContainer=l,t[ec]=l.current,kg(t.nodeType===8?t.parentNode:t),uf(),l}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var w=w_(p);o.call(w)}}var p=MT(t,0,!1,null,null,!1,!1,"",rM);return t._reactRootContainer=p,t[ec]=p.current,kg(t.nodeType===8?t.parentNode:t),uf(function(){q2(e,p,n,r)}),p}function X2(t,e,n,r,i){var s=n._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var o=i;i=function(){var p=w_(l);o.call(p)}}q2(e,l,t,i)}else l=NV(n,e,t,i,r);return w_(l)}mL=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Qp(e.pendingLanes);n!==0&&(YE(e,n|1),aa(e,Oi()),!(Er&6)&&(fd=Oi()+500,Th()))}break;case 13:uf(function(){var r=tc(t,1);if(r!==null){var i=zo();cA(r,t,1,i)}}),PT(t,1)}};XE=function(t){if(t.tag===13){var e=tc(t,134217728);if(e!==null){var n=zo();cA(e,t,134217728,n)}PT(t,134217728)}};yL=function(t){if(t.tag===13){var e=lh(t),n=tc(t,e);if(n!==null){var r=zo();cA(n,t,e,r)}PT(t,e)}};_L=function(){return zr};vL=function(t,e){var n=zr;try{return zr=t,e()}finally{zr=n}};Pb=function(t,e,n){switch(e){case"input":if(wb(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=V2(r);if(!i)throw Error(Bt(90));X8(r),wb(r,i)}}}break;case"textarea":J8(t,n);break;case"select":e=n.value,e!=null&&j0(t,!!n.multiple,e,!1)}};oL=ET;aL=uf;var UV={usingClientEntryPoint:!1,Events:[_m,x0,V2,iL,sL,ET]},xp={findFiberByHostInstance:Zh,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},VV={bundleType:xp.bundleType,version:xp.version,rendererPackageName:xp.rendererPackageName,rendererConfig:xp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dc.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=uL(t),t===null?null:t.stateNode},findFiberByHostInstance:xp.findFiberByHostInstance||FV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var C1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!C1.isDisabled&&C1.supportsFiber)try{O2=C1.inject(VV),ZA=C1}catch{}}Va.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UV;Va.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!IT(e))throw Error(Bt(200));return OV(t,e,null,n)};Va.createRoot=function(t,e){if(!IT(t))throw Error(Bt(299));var n=!1,r="",i=$D;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=MT(t,1,!1,null,null,n,!1,r,i),t[ec]=e.current,kg(t.nodeType===8?t.parentNode:t),new kT(e)};Va.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Bt(188)):(t=Object.keys(t).join(","),Error(Bt(268,t)));return t=uL(e),t=t===null?null:t.stateNode,t};Va.flushSync=function(t){return uf(t)};Va.hydrate=function(t,e,n){if(!Y2(e))throw Error(Bt(200));return X2(null,t,e,!0,n)};Va.hydrateRoot=function(t,e,n){if(!IT(t))throw Error(Bt(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",l=$D;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=GD(e,null,t,1,n??null,i,!1,s,l),t[ec]=e.current,kg(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Z2(e)};Va.render=function(t,e,n){if(!Y2(e))throw Error(Bt(200));return X2(null,t,e,!1,n)};Va.unmountComponentAtNode=function(t){if(!Y2(t))throw Error(Bt(40));return t._reactRootContainer?(uf(function(){X2(null,null,t,!1,function(){t._reactRootContainer=null,t[ec]=null})}),!0):!1};Va.unstable_batchedUpdates=ET;Va.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Y2(n))throw Error(Bt(200));if(t==null||t._reactInternals===void 0)throw Error(Bt(38));return X2(t,e,n,!1,r)};Va.version="18.2.0-next-9e3b772b8-20220608";function jD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jD)}catch(t){console.error(t)}}jD(),G8.exports=Va;var LT=G8.exports,HD,iM=LT;HD=iM.createRoot,iM.hydrateRoot;/**
 * @remix-run/router v1.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ng(){return Ng=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ng.apply(this,arguments)}var Xc;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Xc||(Xc={}));const sM="popstate";function GV(t){t===void 0&&(t={});function e(i,s){let{pathname:l="/",search:o="",hash:p=""}=Mf(i.location.hash.substr(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),l3("",{pathname:l,search:o,hash:p},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){let l=i.document.querySelector("base"),o="";if(l&&l.getAttribute("href")){let p=i.location.href,w=p.indexOf("#");o=w===-1?p:p.slice(0,w)}return o+"#"+(typeof s=="string"?s:b_(s))}function r(i,s){K2(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return jV(e,n,r,t)}function Yi(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function K2(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function $V(){return Math.random().toString(36).substr(2,8)}function oM(t,e){return{usr:t.state,key:t.key,idx:e}}function l3(t,e,n,r){return n===void 0&&(n=null),Ng({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Mf(e):e,{state:n,key:e&&e.key||r||$V()})}function b_(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Mf(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function jV(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,l=i.history,o=Xc.Pop,p=null,w=C();w==null&&(w=0,l.replaceState(Ng({},l.state,{idx:w}),""));function C(){return(l.state||{idx:null}).idx}function P(){o=Xc.Pop;let ie=C(),X=ie==null?null:ie-w;w=ie,p&&p({action:o,location:H.location,delta:X})}function I(ie,X){o=Xc.Push;let ee=l3(H.location,ie,X);n&&n(ee,ie),w=C()+1;let se=oM(ee,w),fe=H.createHref(ee);try{l.pushState(se,"",fe)}catch(me){if(me instanceof DOMException&&me.name==="DataCloneError")throw me;i.location.assign(fe)}s&&p&&p({action:o,location:H.location,delta:1})}function U(ie,X){o=Xc.Replace;let ee=l3(H.location,ie,X);n&&n(ee,ie),w=C();let se=oM(ee,w),fe=H.createHref(ee);l.replaceState(se,"",fe),s&&p&&p({action:o,location:H.location,delta:0})}function W(ie){let X=i.location.origin!=="null"?i.location.origin:i.location.href,ee=typeof ie=="string"?ie:b_(ie);return Yi(X,"No window.location.(origin|href) available to create URL for href: "+ee),new URL(ee,X)}let H={get action(){return o},get location(){return t(i,l)},listen(ie){if(p)throw new Error("A history only accepts one active listener");return i.addEventListener(sM,P),p=ie,()=>{i.removeEventListener(sM,P),p=null}},createHref(ie){return e(i,ie)},createURL:W,encodeLocation(ie){let X=W(ie);return{pathname:X.pathname,search:X.search,hash:X.hash}},push:I,replace:U,go(ie){return l.go(ie)}};return H}var aM;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(aM||(aM={}));function HV(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Mf(e):e,i=DT(r.pathname||"/",n);if(i==null)return null;let s=WD(t);WV(s);let l=null;for(let o=0;l==null&&o<s.length;++o)l=tG(s[o],iG(i));return l}function WD(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,l,o)=>{let p={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:l,route:s};p.relativePath.startsWith("/")&&(Yi(p.relativePath.startsWith(r),'Absolute route path "'+p.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),p.relativePath=p.relativePath.slice(r.length));let w=uh([r,p.relativePath]),C=n.concat(p);s.children&&s.children.length>0&&(Yi(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+w+'".')),WD(s.children,e,C,w)),!(s.path==null&&!s.index)&&e.push({path:w,score:JV(w,s.index),routesMeta:C})};return t.forEach((s,l)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,l);else for(let p of QD(s.path))i(s,l,p)}),e}function QD(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let l=QD(r.join("/")),o=[];return o.push(...l.map(p=>p===""?s:[s,p].join("/"))),i&&o.push(...l),o.map(p=>t.startsWith("/")&&p===""?"/":p)}function WV(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:eG(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const QV=/^:[\w-]+$/,qV=3,ZV=2,YV=1,XV=10,KV=-2,lM=t=>t==="*";function JV(t,e){let n=t.split("/"),r=n.length;return n.some(lM)&&(r+=KV),e&&(r+=ZV),n.filter(i=>!lM(i)).reduce((i,s)=>i+(QV.test(s)?qV:s===""?YV:XV),r)}function eG(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function tG(t,e){let{routesMeta:n}=t,r={},i="/",s=[];for(let l=0;l<n.length;++l){let o=n[l],p=l===n.length-1,w=i==="/"?e:e.slice(i.length)||"/",C=nG({path:o.relativePath,caseSensitive:o.caseSensitive,end:p},w);if(!C)return null;Object.assign(r,C.params);let P=o.route;s.push({params:r,pathname:uh([i,C.pathname]),pathnameBase:AG(uh([i,C.pathnameBase])),route:P}),C.pathnameBase!=="/"&&(i=uh([i,C.pathnameBase]))}return s}function nG(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=rG(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],l=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((w,C,P)=>{let{paramName:I,isOptional:U}=C;if(I==="*"){let H=o[P]||"";l=s.slice(0,s.length-H.length).replace(/(.)\/+$/,"$1")}const W=o[P];return U&&!W?w[I]=void 0:w[I]=sG(W||"",I),w},{}),pathname:s,pathnameBase:l,pattern:t}}function rG(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),K2(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,p)=>(r.push({paramName:o,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function iG(t){try{return decodeURI(t)}catch(e){return K2(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function sG(t,e){try{return decodeURIComponent(t)}catch(n){return K2(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function DT(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function oG(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Mf(t):t;return{pathname:n?n.startsWith("/")?n:aG(n,e):e,search:uG(r),hash:cG(i)}}function aG(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function qx(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function lG(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function qD(t,e){let n=lG(t);return e?n.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function ZD(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Mf(t):(i=Ng({},t),Yi(!i.pathname||!i.pathname.includes("?"),qx("?","pathname","search",i)),Yi(!i.pathname||!i.pathname.includes("#"),qx("#","pathname","hash",i)),Yi(!i.search||!i.search.includes("#"),qx("#","search","hash",i)));let s=t===""||i.pathname==="",l=s?"/":i.pathname,o;if(l==null)o=n;else{let P=e.length-1;if(!r&&l.startsWith("..")){let I=l.split("/");for(;I[0]==="..";)I.shift(),P-=1;i.pathname=I.join("/")}o=P>=0?e[P]:"/"}let p=oG(i,o),w=l&&l!=="/"&&l.endsWith("/"),C=(s||l===".")&&n.endsWith("/");return!p.pathname.endsWith("/")&&(w||C)&&(p.pathname+="/"),p}const uh=t=>t.join("/").replace(/\/\/+/g,"/"),AG=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),uG=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,cG=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function hG(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const YD=["post","put","patch","delete"];new Set(YD);const fG=["get",...YD];new Set(fG);/**
 * React Router v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ug(){return Ug=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ug.apply(this,arguments)}const RT=Ne.createContext(null),dG=Ne.createContext(null),Pf=Ne.createContext(null),J2=Ne.createContext(null),kf=Ne.createContext({outlet:null,matches:[],isDataRoute:!1}),XD=Ne.createContext(null);function pG(t,e){let{relative:n}=e===void 0?{}:e;xm()||Yi(!1);let{basename:r,navigator:i}=Ne.useContext(Pf),{hash:s,pathname:l,search:o}=JD(t,{relative:n}),p=l;return r!=="/"&&(p=l==="/"?r:uh([r,l])),i.createHref({pathname:p,search:o,hash:s})}function xm(){return Ne.useContext(J2)!=null}function ev(){return xm()||Yi(!1),Ne.useContext(J2).location}function KD(t){Ne.useContext(Pf).static||Ne.useLayoutEffect(t)}function gG(){let{isDataRoute:t}=Ne.useContext(kf);return t?PG():mG()}function mG(){xm()||Yi(!1);let t=Ne.useContext(RT),{basename:e,future:n,navigator:r}=Ne.useContext(Pf),{matches:i}=Ne.useContext(kf),{pathname:s}=ev(),l=JSON.stringify(qD(i,n.v7_relativeSplatPath)),o=Ne.useRef(!1);return KD(()=>{o.current=!0}),Ne.useCallback(function(w,C){if(C===void 0&&(C={}),!o.current)return;if(typeof w=="number"){r.go(w);return}let P=ZD(w,JSON.parse(l),s,C.relative==="path");t==null&&e!=="/"&&(P.pathname=P.pathname==="/"?e:uh([e,P.pathname])),(C.replace?r.replace:r.push)(P,C.state,C)},[e,r,l,s,t])}function JD(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=Ne.useContext(Pf),{matches:i}=Ne.useContext(kf),{pathname:s}=ev(),l=JSON.stringify(qD(i,r.v7_relativeSplatPath));return Ne.useMemo(()=>ZD(t,JSON.parse(l),s,n==="path"),[t,l,s,n])}function yG(t,e){return _G(t,e)}function _G(t,e,n,r){xm()||Yi(!1);let{navigator:i}=Ne.useContext(Pf),{matches:s}=Ne.useContext(kf),l=s[s.length-1],o=l?l.params:{};l&&l.pathname;let p=l?l.pathnameBase:"/";l&&l.route;let w=ev(),C;if(e){var P;let ie=typeof e=="string"?Mf(e):e;p==="/"||(P=ie.pathname)!=null&&P.startsWith(p)||Yi(!1),C=ie}else C=w;let I=C.pathname||"/",U=p==="/"?I:I.slice(p.length)||"/",W=HV(t,{pathname:U}),H=EG(W&&W.map(ie=>Object.assign({},ie,{params:Object.assign({},o,ie.params),pathname:uh([p,i.encodeLocation?i.encodeLocation(ie.pathname).pathname:ie.pathname]),pathnameBase:ie.pathnameBase==="/"?p:uh([p,i.encodeLocation?i.encodeLocation(ie.pathnameBase).pathname:ie.pathnameBase])})),s,n,r);return e&&H?Ne.createElement(J2.Provider,{value:{location:Ug({pathname:"/",search:"",hash:"",state:null,key:"default"},C),navigationType:Xc.Pop}},H):H}function vG(){let t=MG(),e=hG(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return Ne.createElement(Ne.Fragment,null,Ne.createElement("h2",null,"Unexpected Application Error!"),Ne.createElement("h3",{style:{fontStyle:"italic"}},e),n?Ne.createElement("pre",{style:i},n):null,s)}const xG=Ne.createElement(vG,null);class wG extends Ne.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?Ne.createElement(kf.Provider,{value:this.props.routeContext},Ne.createElement(XD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bG(t){let{routeContext:e,match:n,children:r}=t,i=Ne.useContext(RT);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),Ne.createElement(kf.Provider,{value:e},r)}function EG(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let l=t,o=(i=n)==null?void 0:i.errors;if(o!=null){let C=l.findIndex(P=>P.route.id&&o?.[P.route.id]);C>=0||Yi(!1),l=l.slice(0,Math.min(l.length,C+1))}let p=!1,w=-1;if(n&&r&&r.v7_partialHydration)for(let C=0;C<l.length;C++){let P=l[C];if((P.route.HydrateFallback||P.route.hydrateFallbackElement)&&(w=C),P.route.id){let{loaderData:I,errors:U}=n,W=P.route.loader&&I[P.route.id]===void 0&&(!U||U[P.route.id]===void 0);if(P.route.lazy||W){p=!0,w>=0?l=l.slice(0,w+1):l=[l[0]];break}}}return l.reduceRight((C,P,I)=>{let U,W=!1,H=null,ie=null;n&&(U=o&&P.route.id?o[P.route.id]:void 0,H=P.route.errorElement||xG,p&&(w<0&&I===0?(kG("route-fallback",!1),W=!0,ie=null):w===I&&(W=!0,ie=P.route.hydrateFallbackElement||null)));let X=e.concat(l.slice(0,I+1)),ee=()=>{let se;return U?se=H:W?se=ie:P.route.Component?se=Ne.createElement(P.route.Component,null):P.route.element?se=P.route.element:se=C,Ne.createElement(bG,{match:P,routeContext:{outlet:C,matches:X,isDataRoute:n!=null},children:se})};return n&&(P.route.ErrorBoundary||P.route.errorElement||I===0)?Ne.createElement(wG,{location:n.location,revalidation:n.revalidation,component:H,error:U,children:ee(),routeContext:{outlet:null,matches:X,isDataRoute:!0}}):ee()},null)}var eR=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(eR||{}),E_=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(E_||{});function TG(t){let e=Ne.useContext(RT);return e||Yi(!1),e}function SG(t){let e=Ne.useContext(dG);return e||Yi(!1),e}function CG(t){let e=Ne.useContext(kf);return e||Yi(!1),e}function tR(t){let e=CG(),n=e.matches[e.matches.length-1];return n.route.id||Yi(!1),n.route.id}function MG(){var t;let e=Ne.useContext(XD),n=SG(E_.UseRouteError),r=tR(E_.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function PG(){let{router:t}=TG(eR.UseNavigateStable),e=tR(E_.UseNavigateStable),n=Ne.useRef(!1);return KD(()=>{n.current=!0}),Ne.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Ug({fromRouteId:e},s)))},[t,e])}const AM={};function kG(t,e,n){!e&&!AM[t]&&(AM[t]=!0)}function ll(t){Yi(!1)}function IG(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Xc.Pop,navigator:s,static:l=!1,future:o}=t;xm()&&Yi(!1);let p=e.replace(/^\/*/,"/"),w=Ne.useMemo(()=>({basename:p,navigator:s,static:l,future:Ug({v7_relativeSplatPath:!1},o)}),[p,o,s,l]);typeof r=="string"&&(r=Mf(r));let{pathname:C="/",search:P="",hash:I="",state:U=null,key:W="default"}=r,H=Ne.useMemo(()=>{let ie=DT(C,p);return ie==null?null:{location:{pathname:ie,search:P,hash:I,state:U,key:W},navigationType:i}},[p,C,P,I,U,W,i]);return H==null?null:Ne.createElement(Pf.Provider,{value:w},Ne.createElement(J2.Provider,{children:n,value:H}))}function LG(t){let{children:e,location:n}=t;return yG(A3(e),n)}new Promise(()=>{});function A3(t,e){e===void 0&&(e=[]);let n=[];return Ne.Children.forEach(t,(r,i)=>{if(!Ne.isValidElement(r))return;let s=[...e,i];if(r.type===Ne.Fragment){n.push.apply(n,A3(r.props.children,s));return}r.type!==ll&&Yi(!1),!r.props.index||!r.props.children||Yi(!1);let l={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=A3(r.props.children,s)),n.push(l)}),n}/**
 * React Router DOM v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function u3(){return u3=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},u3.apply(this,arguments)}function DG(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function RG(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function BG(t,e){return t.button===0&&(!e||e==="_self")&&!RG(t)}const zG=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],OG="6";try{window.__reactRouterVersion=OG}catch{}const FG="startTransition",uM=F9[FG];function NG(t){let{basename:e,children:n,future:r,window:i}=t,s=Ne.useRef();s.current==null&&(s.current=GV({window:i,v5Compat:!0}));let l=s.current,[o,p]=Ne.useState({action:l.action,location:l.location}),{v7_startTransition:w}=r||{},C=Ne.useCallback(P=>{w&&uM?uM(()=>p(P)):p(P)},[p,w]);return Ne.useLayoutEffect(()=>l.listen(C),[l,C]),Ne.createElement(IG,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:l,future:r})}const UG=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",VG=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Lu=Ne.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:l,state:o,target:p,to:w,preventScrollReset:C,unstable_viewTransition:P}=e,I=DG(e,zG),{basename:U}=Ne.useContext(Pf),W,H=!1;if(typeof w=="string"&&VG.test(w)&&(W=w,UG))try{let se=new URL(window.location.href),fe=w.startsWith("//")?new URL(se.protocol+w):new URL(w),me=DT(fe.pathname,U);fe.origin===se.origin&&me!=null?w=me+fe.search+fe.hash:H=!0}catch{}let ie=pG(w,{relative:i}),X=GG(w,{replace:l,state:o,target:p,preventScrollReset:C,relative:i,unstable_viewTransition:P});function ee(se){r&&r(se),se.defaultPrevented||X(se)}return Ne.createElement("a",u3({},I,{href:W||ie,onClick:H||s?r:ee,ref:n,target:p}))});var cM;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(cM||(cM={}));var hM;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(hM||(hM={}));function GG(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:l,unstable_viewTransition:o}=e===void 0?{}:e,p=gG(),w=ev(),C=JD(t,{relative:l});return Ne.useCallback(P=>{if(BG(P,n)){P.preventDefault();let I=r!==void 0?r:b_(w)===b_(C);p(t,{replace:I,state:i,preventScrollReset:s,relative:l,unstable_viewTransition:o})}},[w,p,C,r,i,n,t,s,l,o])}function T_(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const BT=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),fM=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);fM&&parseFloat(fM[1]);const $G="3.4.14";function rc(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Cy=typeof process!="object"||String(process)!=="[object process]"||process.browser,jG=typeof window<"u"&&typeof window.orientation<"u",dM=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);dM&&parseFloat(dM[1]);function Vg(t){"@babel/helpers - typeof";return Vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vg(t)}function HG(t,e){if(Vg(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Vg(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WG(t){var e=HG(t,"string");return Vg(e)==="symbol"?e:String(e)}function oe(t,e,n){return e=WG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class QG{constructor(e,n){oe(this,"name",void 0),oe(this,"workerThread",void 0),oe(this,"isRunning",!0),oe(this,"result",void 0),oe(this,"_resolve",()=>{}),oe(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){rc(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){rc(this.isRunning),this.isRunning=!1,this._reject(e)}}let Zx=class{terminate(){}};const Yx=new Map;function qG(t){rc(t.source&&!t.url||!t.source&&t.url);let e=Yx.get(t.source||t.url);return e||(t.url&&(e=ZG(t.url),Yx.set(t.url,e)),t.source&&(e=nR(t.source),Yx.set(t.source,e))),rc(e),e}function ZG(t){if(!t.startsWith("http"))return t;const e=YG(t);return nR(e)}function nR(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function YG(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function rR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(pM(t))r.add(t);else if(pM(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)rR(t[i],e,r)}}return n===void 0?Array.from(r):[]}function pM(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const Xx=()=>{};class c3{static isSupported(){return typeof Worker<"u"&&Cy||typeof Zx<"u"&&!Cy}constructor(e){oe(this,"name",void 0),oe(this,"source",void 0),oe(this,"url",void 0),oe(this,"terminated",!1),oe(this,"worker",void 0),oe(this,"onMessage",void 0),oe(this,"onError",void 0),oe(this,"_loadableURL","");const{name:n,source:r,url:i}=e;rc(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=Xx,this.onError=s=>console.log(s),this.worker=Cy?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Xx,this.onError=Xx,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||rR(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=qG({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Zx(r,{eval:!1})}else if(this.source)e=new Zx(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class XG{static isSupported(){return c3.isSupported()}constructor(e){oe(this,"name","unnamed"),oe(this,"source",void 0),oe(this,"url",void 0),oe(this,"maxConcurrency",1),oe(this,"maxMobileConcurrency",1),oe(this,"onDebug",()=>{}),oe(this,"reuseWorkers",!0),oe(this,"props",{}),oe(this,"jobQueue",[]),oe(this,"idleQueue",[]),oe(this,"count",0),oe(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,l,o)=>s.done(o),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,l)=>s.error(l);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new QG(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new c3({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return jG?this.maxMobileConcurrency:this.maxConcurrency}}const KG={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Uu{static isSupported(){return c3.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Uu._workerFarm=Uu._workerFarm||new Uu({}),Uu._workerFarm.setProps(e),Uu._workerFarm}constructor(e){oe(this,"props",void 0),oe(this,"workerPools",new Map),this.props={...KG},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new XG({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}oe(Uu,"_workerFarm",void 0);const JG="latest";function e$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=JG);const l=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(l,"/dist/").concat(r)}return rc(i),i}function t$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$G;rc(t,"no worker provided");const n=t.version;return!(!e||!n)}function n$(t,e){return!Uu.isSupported()||!Cy&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&e?.worker}async function r$(t,e,n,r,i){const s=t.id,l=e$(t,n),p=Uu.getWorkerFarm(n).getWorkerPool({name:s,url:l});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const w=await p.startJob("process-on-worker",i$.bind(null,i));return w.postMessage("process",{input:e,options:n,context:r}),await(await w.result).result}async function i$(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:l}=r;try{const o=await t(s,l);e.postMessage("done",{id:i,result:o})}catch(o){const p=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:p})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function s$(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function o$(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),i=r.reduce((o,p)=>o+p.byteLength,0),s=new Uint8Array(i);let l=0;for(const o of r)s.set(o,l),l+=o.byteLength;return s.buffer}async function a$(t){const e=[];for await(const n of t)e.push(n);return o$(...e)}function gM(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let mM=class{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=gM(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(gM()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},l$=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof mM?i=e:i=new mM(n,r),this.stats[n]=i),i}};const A$="Queued Requests",u$="Active Requests",c$="Cancelled Requests",h$="Queued Requests Ever",f$="Active Requests Ever",d$={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class p${constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};oe(this,"props",void 0),oe(this,"stats",void 0),oe(this,"activeRequestCount",0),oe(this,"requestQueue",[]),oe(this,"requestMap",new Map),oe(this,"deferredUpdate",null),this.props={...d$,...e},this.stats=new l$({id:this.props.id}),this.stats.get(A$),this.stats.get(u$),this.stats.get(c$),this.stats.get(h$),this.stats.get(f$)}scheduleRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:n},i=new Promise(s=>(r.resolve=s,r));return this.requestQueue.push(r),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){const{handle:n,resolve:r}=e;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const r=e[n];this._updateRequest(r)||(e.splice(n,1),this.requestMap.delete(r.handle),n--)}e.sort((n,r)=>n.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let g$="";const yM={};function m$(t){for(const e in yM)if(t.startsWith(e)){const n=yM[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(g$).concat(t)),t}function y$(t){return t&&typeof t=="object"&&t.isBuffer}function iR(t){if(y$(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function sR(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function _$(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const v$=t=>typeof t=="boolean",dg=t=>typeof t=="function",wm=t=>t!==null&&typeof t=="object",_M=t=>wm(t)&&t.constructor==={}.constructor,x$=t=>t&&typeof t[Symbol.iterator]=="function",w$=t=>t&&typeof t[Symbol.asyncIterator]=="function",If=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Lf=t=>typeof Blob<"u"&&t instanceof Blob,b$=t=>t&&typeof t=="object"&&t.isBuffer,E$=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||wm(t)&&dg(t.tee)&&dg(t.cancel)&&dg(t.getReader),T$=t=>wm(t)&&dg(t.read)&&dg(t.pipe)&&v$(t.readable),oR=t=>E$(t)||T$(t),S$=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,C$=/^([-\w.]+\/[-\w.+]+)/;function M$(t){const e=C$.exec(t);return e?e[1]:t}function vM(t){const e=S$.exec(t);return e?e[1]:""}const aR=/\?.*/;function P$(t){const e=t.match(aR);return e&&e[0]}function zT(t){return t.replace(aR,"")}function tv(t){return If(t)?t.url:Lf(t)?t.name||"":typeof t=="string"?t:""}function OT(t){if(If(t)){const e=t,n=e.headers.get("content-type")||"",r=zT(e.url);return M$(n)||vM(r)}return Lf(t)?t.type||"":typeof t=="string"?vM(t):""}function k$(t){return If(t)?t.headers["content-length"]||-1:Lf(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function lR(t){if(If(t))return t;const e={},n=k$(t);n>=0&&(e["content-length"]=String(n));const r=tv(t),i=OT(t);i&&(e["content-type"]=i);const s=await D$(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const l=new Response(t,{headers:e});return Object.defineProperty(l,"url",{value:r}),l}async function I$(t){if(!t.ok){const e=await L$(t);throw new Error(e)}}async function L$(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function D$(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var l;return r(s==null||(l=s.target)===null||l===void 0?void 0:l.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=R$(n);return"data:base64,".concat(r)}return null}function R$(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function xM(t,e){if(typeof t=="string"){t=m$(t);let n=e;return e!=null&&e.fetch&&typeof e?.fetch!="function"&&(n=e.fetch),await fetch(t,n)}return await lR(t)}function B$(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function bm(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||B$()}const M1=globalThis.window||globalThis.self||globalThis.global,wp=globalThis.process||{},AR=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";bm();function z$(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let O$=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=z$(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function F$(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function N$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Kx(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,l=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let S_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(S_||(S_={}));const U$=10;function wM(t){return typeof t!="string"?t:(t=t.toUpperCase(),S_[t]||S_.WHITE)}function V$(t,e,n){if(!bm&&typeof t=="string"){if(e){const r=wM(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=wM(n);t="\x1B[".concat(r+U$,"m").concat(t,"\x1B[49m")}}return t}function G$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const l=i[s];typeof l=="function"&&(e.find(o=>s===o)||(i[s]=l.bind(t)))}}function C_(t,e){if(!t)throw new Error(e||"Assertion failed")}function n0(){let t;if(bm()&&M1.performance){var e,n;t=M1==null||(e=M1.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in wp){var r;const i=wp==null||(r=wp.hrtime)===null||r===void 0?void 0:r.call(wp);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const r0={debug:bm()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},$$={enabled:!0,level:0};function cl(){}const bM={},EM={once:!0};let FT=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=AR,this._startTs=n0(),this._deltaTs=n0(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new O$("__probe-".concat(this.id,"__"),$$),this.timeStamp("".concat(this.id," started")),G$(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((n0()-this._startTs).toPrecision(10))}getDelta(){return Number((n0()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){C_(e,n)}warn(e){return this._getLogFunction(0,e,r0.warn,arguments,EM)}error(e){return this._getLogFunction(0,e,r0.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,r0.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,r0.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,r0.debug||r0.info,arguments,EM)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||cl,r&&[r],{tag:Q$(n)}):cl}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:l=1}=e;return this._shouldLog(n||r)?bm()?W$({image:i,message:s,scale:l}):H$():cl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||cl)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=TM({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||cl)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=uR(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=TM({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,C_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=n0();const l=s.tag||s.message;if(s.once&&l)if(!bM[l])bM[l]=n0();else return cl;return n=j$(this.id,s.message,s),r.bind(console,n,...s.args)}return cl}};FT.VERSION=AR;function uR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return C_(Number.isFinite(e)&&e>=0),e}function TM(t){const{logLevel:e,message:n}=t;t.logLevel=uR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return C_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function j$(t,e,n){if(typeof e=="string"){const r=n.time?N$(F$(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=V$(e,n.color,n.background)}return e}function H$(t){return console.warn("removed"),cl}function W$(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const l=Kx(s,n,r);console.log(...l)},s.src=e,cl}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...Kx(e,n,r)),cl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Kx(s,n,r)),s.src=e.toDataURL(),cl}return cl}function Q$(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const SM=new FT({id:"loaders.gl"});class q${log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class Z${constructor(){oe(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const cR={fetch:null,mimeType:void 0,nothrow:!1,log:new Z$,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:BT,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Y$={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function hR(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const fR=()=>{const t=hR();return t.globalOptions=t.globalOptions||{...cR},t.globalOptions};function X$(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],K$(t,n),ej(e,t,r)}function K$(t,e){CM(t,null,cR,Y$,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};CM(r,n.id,i,s,e)}}function CM(t,e,n,r,i){const s=e||"Top level",l=e?"".concat(e,"."):"";for(const o in t){const p=!e&&wm(t[o]),w=o==="baseUri"&&!e,C=o==="workerUrl"&&e;if(!(o in n)&&!w&&!C){if(o in r)SM.warn("".concat(s," loader option '").concat(l).concat(o,"' no longer supported, use '").concat(r[o],"'"))();else if(!p){const P=J$(o,i);SM.warn("".concat(s," loader option '").concat(l).concat(o,"' not recognized. ").concat(P))()}}}}function J$(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const l=s.toLowerCase();(n.startsWith(l)||l.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function ej(t,e,n){const i={...t.options||{}};return tj(i,n),i.log===null&&(i.log=new q$),MM(i,fR()),MM(i,e),i}function MM(t,e){for(const n in e)if(n in e){const r=e[n];_M(r)&&_M(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function tj(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function NT(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function UT(t){var e,n;T_(t,"null loader"),T_(NT(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const dR=()=>{const t=hR();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function nj(t){const e=dR();t=Array.isArray(t)?t:[t];for(const n of t){const r=UT(n);e.find(i=>r===i)||e.unshift(r)}}function rj(){return dR()}const ij=new FT({id:"loaders.gl"}),sj=/\.([^.]+)$/;async function oj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!pR(t))return null;let i=PM(t,e,{...n,nothrow:!0},r);if(i)return i;if(Lf(t)&&(t=await t.slice(0,10).arrayBuffer(),i=PM(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(gR(t));return i}function PM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!pR(t))return null;if(e&&!Array.isArray(e))return UT(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...rj()),lj(i);const s=aj(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(gR(t));return s}function aj(t,e,n,r){const i=tv(t),s=OT(t),l=zT(i)||r?.url;let o=null,p="";if(n!=null&&n.mimeType&&(o=Jx(e,n?.mimeType),p="match forced by supplied MIME type ".concat(n?.mimeType)),o=o||Aj(e,l),p=p||(o?"matched url ".concat(l):""),o=o||Jx(e,s),p=p||(o?"matched MIME type ".concat(s):""),o=o||cj(e,t),p=p||(o?"matched initial data ".concat(mR(t)):""),o=o||Jx(e,n?.fallbackMimeType),p=p||(o?"matched fallback MIME type ".concat(s):""),p){var w;ij.log(1,"selectLoader selected ".concat((w=o)===null||w===void 0?void 0:w.name,": ").concat(p,"."))}return o}function pR(t){return!(t instanceof Response&&t.status===204)}function gR(t){const e=tv(t),n=OT(t);let r="No valid loader found (";r+=e?"".concat(sR(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?mR(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function lj(t){for(const e of t)UT(e)}function Aj(t,e){const n=e&&sj.exec(e),r=n&&n[1];return r?uj(t,r):null}function uj(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function Jx(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function cj(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(hj(e,n))return n}else if(ArrayBuffer.isView(e)){if(kM(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&kM(e,0,n))return n;return null}function hj(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function kM(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>fj(t,e,n,i))}function fj(t,e,n,r){if(r instanceof ArrayBuffer)return s$(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=h3(t,e,r.length);return r===i;default:return!1}}function mR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?h3(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?h3(t,0,e):""}function h3(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const dj=256*1024;function*pj(t,e){const n=e?.chunkSize||dj;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),l=t.slice(r,r+s);r+=s,yield i.encode(l)}}const gj=256*1024;function mj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=gj}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),l=new Uint8Array(t,r,i);new Uint8Array(s).set(l),r+=i,yield s}}()}const yj=1024*1024;async function*_j(t,e){const n=e?.chunkSize||yj;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function IM(t,e){return BT?vj(t,e):xj(t)}async function*vj(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:l}=await i;if(s)return;yield iR(l)}}catch{n.releaseLock()}}async function*xj(t,e){for await(const n of t)yield iR(n)}function wj(t,e){if(typeof t=="string")return pj(t,e);if(t instanceof ArrayBuffer)return mj(t,e);if(Lf(t))return _j(t,e);if(oR(t))return IM(t,e);if(If(t))return IM(t.body,e);throw new Error("makeIterator")}const yR="Cannot convert supplied data type";function bj(t,e,n){if(e.text&&typeof t=="string")return t;if(b$(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(yR)}async function Ej(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return bj(t,e);if(Lf(t)&&(t=await lR(t)),If(t)){const i=t;return await I$(i),e.binary?await i.arrayBuffer():await i.text()}if(oR(t)&&(t=wj(t,n)),x$(t)||w$(t))return a$(t);throw new Error(yR)}function _R(t,e){const n=fR(),r=t||n;return typeof r.fetch=="function"?r.fetch:wm(r.fetch)?i=>xM(i,r):e!=null&&e.fetch?e?.fetch:xM}function Tj(t,e,n){if(n)return n;const r={fetch:_R(e,t),...t};if(r.url){const i=zT(r.url);r.baseUrl=i,r.queryString=P$(r.url),r.filename=sR(i),r.baseUrl=_$(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function Sj(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function VT(t,e,n,r){rc(!r||typeof r=="object"),e&&!Array.isArray(e)&&!NT(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=tv(t),l=Sj(e,r),o=await oj(t,l,n);return o?(n=X$(n,o,l,i),r=Tj({url:i,parse:VT,loaders:l},n,r||null),await Cj(o,t,n,r)):null}async function Cj(t,e,n,r){if(t$(t),If(e)){const i=e,{ok:s,redirected:l,status:o,statusText:p,type:w,url:C}=i,P=Object.fromEntries(i.headers.entries());r.response={headers:P,ok:s,redirected:l,status:o,statusText:p,type:w,url:C}}if(e=await Ej(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(n$(t,n))return await r$(t,e,n,r,VT);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw rc(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function M_(t,e,n,r){!Array.isArray(e)&&!NT(e)&&(n=e,e=void 0);const i=_R(n);let s=t;return typeof t=="string"&&(s=await i(t)),Lf(t)&&(s=await i(t)),await VT(s,e,n)}const Mj="3.4.14",{_parseImageNode:Pj}=globalThis,f3=typeof Image<"u",d3=typeof ImageBitmap<"u",kj=!!Pj,p3=BT?!0:kj;function Ij(t){switch(t){case"auto":return d3||f3||p3;case"imagebitmap":return d3;case"image":return f3;case"data":return p3;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function Lj(){if(d3)return"imagebitmap";if(f3)return"image";if(p3)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function Dj(t){const e=Bj(t);if(!e)throw new Error("Not an image");return e}function Rj(t){switch(Dj(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function Bj(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const zj=/^data:image\/svg\+xml/,Oj=/\.svg((\?|#).*)?$/;function GT(t){return t&&(zj.test(t)||Oj.test(t))}function Fj(t,e){if(GT(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return vR(t,e)}function vR(t,e){if(GT(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function xR(t,e,n){const r=Fj(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await Nj(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function Nj(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const Uj={};let LM=!0;async function Vj(t,e,n){let r;GT(n)?r=await xR(t,e,n):r=vR(t,n);const i=e&&e.imagebitmap;return await Gj(r,i)}async function Gj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(($j(e)||!LM)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),LM=!1}return await createImageBitmap(t)}function $j(t){for(const e in t||Uj)return!1;return!0}function jj(t){return!qj(t,"ftyp",4)||!(t[8]&96)?null:Hj(t)}function Hj(t){switch(Wj(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Wj(t,e,n){return String.fromCharCode(...t.slice(e,n))}function Qj(t){return[...t].map(e=>e.charCodeAt(0))}function qj(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=Qj(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const HA=!1,pg=!0;function wR(t){const e=Em(t);return Yj(e)||Jj(e)||Xj(e)||Kj(e)||Zj(e)}function Zj(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=jj(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function Yj(t){const e=Em(t);return e.byteLength>=24&&e.getUint32(0,HA)===2303741511?{mimeType:"image/png",width:e.getUint32(16,HA),height:e.getUint32(20,HA)}:null}function Xj(t){const e=Em(t);return e.byteLength>=10&&e.getUint32(0,HA)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,pg),height:e.getUint16(8,pg)}:null}function Kj(t){const e=Em(t);return e.byteLength>=14&&e.getUint16(0,HA)===16973&&e.getUint32(2,pg)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,pg),height:e.getUint32(22,pg)}:null}function Jj(t){const e=Em(t);if(!(e.byteLength>=3&&e.getUint16(0,HA)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=eH();let s=2;for(;s+9<e.byteLength;){const l=e.getUint16(s,HA);if(i.has(l))return{mimeType:"image/jpeg",height:e.getUint16(s+5,HA),width:e.getUint16(s+7,HA)};if(!r.has(l))return null;s+=2,s+=e.getUint16(s,HA)}return null}function eH(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Em(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function tH(t,e){const{mimeType:n}=wR(t)||{},r=globalThis._parseImageNode;return T_(r),await r(t,n)}async function nH(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},l=rH(i);let o;switch(l){case"imagebitmap":o=await Vj(t,e,s);break;case"image":o=await xR(t,e,s);break;case"data":o=await tH(t);break;default:T_(!1)}return i==="data"&&(o=Rj(o)),o}function rH(t){switch(t){case"auto":case"data":return Lj();default:return Ij(t),t}}const iH=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],sH=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],oH={image:{type:"auto",decode:!0}},aH={id:"image",module:"images",name:"Images",version:Mj,mimeTypes:sH,extensions:iH,parse:nH,tests:[t=>!!wR(new DataView(t))],options:oH};function bR(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function zd(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||bR()}const My={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},P1=My.window||My.self||My.global,bp=My.process||{},ER=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";zd();const ew=globalThis;function lH(t){if(!t&&!zd())return"Node";if(bR(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":ew.chrome?"Chrome":ew.safari?"Safari":ew.mozInnerScreenX?"Firefox":"Unknown"}function AH(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let uH=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";oe(this,"storage",void 0),oe(this,"id",void 0),oe(this,"config",void 0),this.storage=AH(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function cH(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function hH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function tw(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,l=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let P_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(P_||(P_={}));function DM(t){return typeof t=="string"?P_[t.toUpperCase()]||P_.WHITE:t}function fH(t,e,n){return!zd&&typeof t=="string"&&(e&&(e=DM(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=DM(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function dH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function k_(t,e){if(!t)throw new Error(e||"Assertion failed")}function i0(){let t;if(zd&&"performance"in P1){var e,n;t=P1==null||(e=P1.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in bp){var r;const i=bp==null||(r=bp.hrtime)===null||r===void 0?void 0:r.call(bp);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const s0={debug:zd&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},pH={enabled:!0,level:0};function hl(){}const RM={},BM={once:!0};let TR=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};oe(this,"id",void 0),oe(this,"VERSION",ER),oe(this,"_startTs",i0()),oe(this,"_deltaTs",i0()),oe(this,"_storage",void 0),oe(this,"userData",{}),oe(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new uH("__probe-".concat(this.id,"__"),pH),this.timeStamp("".concat(this.id," started")),dH(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((i0()-this._startTs).toPrecision(10))}getDelta(){return Number((i0()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){k_(e,n)}warn(e){return this._getLogFunction(0,e,s0.warn,arguments,BM)}error(e){return this._getLogFunction(0,e,s0.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,s0.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,s0.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,s0.debug||s0.info,arguments,BM)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||hl,r&&[r],{tag:_H(n)}):hl}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:l=1}=e;return this._shouldLog(n||r)?zd?yH({image:i,message:s,scale:l}):mH():hl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||hl)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=zM({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||hl)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=SR(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=zM({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,k_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=i0();const l=s.tag||s.message;if(s.once)if(!RM[l])RM[l]=i0();else return hl;return n=gH(this.id,s.message,s),r.bind(console,n,...s.args)}return hl}};oe(TR,"VERSION",ER);function SR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return k_(Number.isFinite(e)&&e>=0),e}function zM(t){const{logLevel:e,message:n}=t;t.logLevel=SR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return k_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function gH(t,e,n){if(typeof e=="string"){const r=n.time?hH(cH(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=fH(e,n.color,n.background)}return e}function mH(t){return console.warn("removed"),hl}function yH(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const l=tw(s,n,r);console.log(...l)},s.src=e,hl}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...tw(e,n,r)),hl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...tw(s,n,r)),s.src=e.toDataURL(),hl}return hl}function _H(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const sr=new TR({id:"deck"});let g3={};function vH(t){g3=t}function lo(t,e,n,r){sr.level>0&&g3[t]&&g3[t].call(null,e,n,r)}function xH(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const wH={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:xH,parseTextSync:JSON.parse};function bH(){const t="8.9.32",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(sr.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:sr,_registerLoggers:vH},nj([wH,[aH,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const EH=bH(),ur={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(ur,"IDENTITY",{get:()=>(sr.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const rA={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},cf={common:0,meters:1,pixels:2},OM={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};function TH(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Od(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||TH()}const Py={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},k1=Py.window||Py.self||Py.global,Ep=Py.process||{},CR=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Od();function SH(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class CH{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";oe(this,"storage",void 0),oe(this,"id",void 0),oe(this,"config",void 0),this.storage=SH(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function MH(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function PH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function nw(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,l=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let I_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(I_||(I_={}));function FM(t){return typeof t=="string"?I_[t.toUpperCase()]||I_.WHITE:t}function kH(t,e,n){return!Od&&typeof t=="string"&&(e&&(e=FM(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=FM(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function IH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function L_(t,e){if(!t)throw new Error(e||"Assertion failed")}function o0(){let t;if(Od&&"performance"in k1){var e,n;t=k1==null||(e=k1.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Ep){var r;const i=Ep==null||(r=Ep.hrtime)===null||r===void 0?void 0:r.call(Ep);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const a0={debug:Od&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},LH={enabled:!0,level:0};function fl(){}const NM={},UM={once:!0};class MR{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};oe(this,"id",void 0),oe(this,"VERSION",CR),oe(this,"_startTs",o0()),oe(this,"_deltaTs",o0()),oe(this,"_storage",void 0),oe(this,"userData",{}),oe(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new CH("__probe-".concat(this.id,"__"),LH),this.timeStamp("".concat(this.id," started")),IH(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((o0()-this._startTs).toPrecision(10))}getDelta(){return Number((o0()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){L_(e,n)}warn(e){return this._getLogFunction(0,e,a0.warn,arguments,UM)}error(e){return this._getLogFunction(0,e,a0.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,a0.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,a0.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,a0.debug||a0.info,arguments,UM)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||fl,r&&[r],{tag:zH(n)}):fl}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:l=1}=e;return this._shouldLog(n||r)?Od?BH({image:i,message:s,scale:l}):RH():fl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||fl)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=VM({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||fl)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=PR(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=VM({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,L_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=o0();const l=s.tag||s.message;if(s.once)if(!NM[l])NM[l]=o0();else return fl;return n=DH(this.id,s.message,s),r.bind(console,n,...s.args)}return fl}}oe(MR,"VERSION",CR);function PR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return L_(Number.isFinite(e)&&e>=0),e}function VM(t){const{logLevel:e,message:n}=t;t.logLevel=PR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return L_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function DH(t,e,n){if(typeof e=="string"){const r=n.time?PH(MH(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=kH(e,n.color,n.background)}return e}function RH(t){return console.warn("removed"),fl}function BH(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const l=nw(s,n,r);console.log(...l)},s.src=e,fl}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...nw(e,n,r)),fl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...nw(s,n,r)),s.src=e.toDataURL(),fl}return fl}function zH(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const vn=new MR({id:"luma.gl"});function Lo(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const OH="Invalid WebGLRenderingContext",FH="Requires WebGL2";function nv(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function cr(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function NH(t){return cr(t)?t:null}function rv(t){return Lo(nv(t),OH),t}function co(t){return Lo(cr(t),FH),t}const Zp={};function UH(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function VH(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function GH(t,e){Zp[t]=!0,e!==void 0&&UH(e)}function $H(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(Zp[r]=!0);while(r!==0);for(r in Zp)if(Zp[r])return delete Zp[r],parseInt(r,10);return 0}}const Tm=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Tm.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Tm.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Df=function(e){const n=this;this.gl=e,$H(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const l=n.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,s);const o=l.attribs[s];return o.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const l=n.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,s);const o=l.attribs[s];return o.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,l){switch(s){case 34962:n.currentArrayBuffer=l;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=l;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,l){const p=n.currentVertexArrayObject.attribs[s];switch(l){case 34975:return p.buffer;case 34338:return p.enabled;case 34339:return p.size;case 34340:return p.stride;case 34341:return p.type;case 34922:return p.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,l,o,p,w,C){const P=n.currentVertexArrayObject;P.maxAttrib=Math.max(P.maxAttrib,s);const I=P.attribs[s];return I.buffer=n.currentArrayBuffer,I.size=l,I.type=o,I.normalized=p,I.stride=w,I.offset=C,I.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{VH("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};Df.prototype.VERTEX_ARRAY_BINDING_OES=34229;Df.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Tm(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Df.prototype.createVertexArrayOES=function(){const e=new Tm(this);return this.vertexArrayObjects.push(e),e};Df.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};Df.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Tm&&e.hasBeenBound&&e.ext===this)};Df.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){GH(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let l=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let p=0;p<=o;p++){const w=s.attribs[p],C=i?i.attribs[p]:null;if((!i||w.enabled!==C.enabled)&&(w.enabled?r.enableVertexAttribArray.call(n,p):r.disableVertexAttribArray.call(n,p)),w.enabled){let P=!1;(!i||w.buffer!==C.buffer)&&(l!==w.buffer&&(r.bindBuffer.call(n,34962,w.buffer),l=w.buffer),P=!0),(P||w.cached!==C.cached)&&r.vertexAttribPointer.call(n,p,w.size,w.type,w.normalized,w.stride,w.offset)}}this.currentArrayBuffer!==l&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function jH(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Df(this)),this.__OESVertexArrayObject))}}const GM="OES_element_index",$M="WEBGL_draw_buffers",HH="EXT_disjoint_timer_query",WH="EXT_disjoint_timer_query_webgl2",QH="EXT_texture_filter_anisotropic",jM="WEBGL_debug_renderer_info",qH=35723,ZH=4352,YH=36795,XH=34047,KH=37445,JH=37446,Kr=t=>cr(t)?void 0:0,eW={3074:t=>cr(t)?void 0:36064,[qH]:t=>cr(t)?void 0:ZH,35977:Kr,32937:Kr,[YH]:(t,e)=>{const n=cr(t)?t.getExtension(WH):t.getExtension(HH);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[KH]:(t,e)=>{const n=t.getExtension(jM);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[JH]:(t,e)=>{const n=t.getExtension(jM);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[XH]:(t,e)=>{const n=t.luma.extensions[QH];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Kr,35071:Kr,37447:Kr,36063:(t,e)=>{if(!cr(t)){const n=t.getExtension($M);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Kr,35374:Kr,35377:Kr,34852:t=>{if(!cr(t)){const e=t.getExtension($M);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(GM)?2147483647:65535,33001:t=>t.getExtension(GM)?16777216:65535,33e3:t=>16777216,37157:Kr,35373:Kr,35657:Kr,36183:Kr,37137:Kr,34045:Kr,35978:Kr,35979:Kr,35968:Kr,35376:Kr,35375:Kr,35659:Kr,37154:Kr,35371:Kr,35658:Kr,35076:Kr,35077:Kr,35380:Kr};function tW(t,e,n){const r=eW[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const nW="OES_vertex_array_object",kR="ANGLE_instanced_arrays",rW="WEBGL_draw_buffers",iW="EXT_disjoint_timer_query",sW="EXT_texture_filter_anisotropic",oW="VertexArray requires WebGL2 or OES_vertex_array_object extension";function aW(t,e){return{webgl2:cr(t),ext:t.getExtension(e)}}const IR={[nW]:{meta:{suffix:"OES"},createVertexArray:()=>{Lo(!1,oW)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[kR]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Lo(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[rW]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Lo(!1)}},[iW]:{meta:{suffix:"EXT"},createQuery:()=>{Lo(!1)},deleteQuery:()=>{Lo(!1)},beginQuery:()=>{Lo(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},rw={readBuffer:(t,e,n)=>{cr(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=aW(t,kR);let l;switch(r){case 35069:l=i?void 0:!1;break;case 35070:l=!i&&!s?0:void 0;break}return l!==void 0?l:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!cr(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!cr(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[sW];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:tW,hint(t,e,n,r){return e(n,r)}};function lW(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(jH(t),AW(t),cW(t,IR),uW(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=lW;function AW(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function uW(t,e){let{target:n,target2:r}=e;Object.keys(rw).forEach(i=>{if(typeof rw[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},l=rw[i].bind(null,t,s);n[i]=l,r[i]=l}})}function cW(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&hW(t,{extension:n,target:t.luma,target2:t})}function hW(t,e){let{extension:n,target:r,target2:i}=e;const s=IR[n];Lo(s);const{meta:l={}}=s,{suffix:o=""}=l,p=t.getExtension(n);for(const w of Object.keys(s)){const C="".concat(w).concat(o);let P=null;w==="meta"||typeof t[w]=="function"||(p&&typeof p[C]=="function"?P=function(){return p[C](...arguments)}:typeof s[w]=="function"&&(P=s[w].bind(r))),P&&(r[w]=P,i[w]=P)}}const $T={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},zc=(t,e,n)=>e?t.enable(n):t.disable(n),HM=(t,e,n)=>t.hint(n,e),Ma=(t,e,n)=>t.pixelStorei(n,e),fW=(t,e)=>{const n=cr(t)?36009:36160;return t.bindFramebuffer(n,e)},dW=(t,e)=>t.bindFramebuffer(36008,e);function Tp(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const pW={3042:zc,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:zc,2885:(t,e)=>t.cullFace(e),2929:zc,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:zc,35723:HM,36006:fW,2886:(t,e)=>t.frontFace(e),33170:HM,2849:(t,e)=>t.lineWidth(e),32823:zc,32824:"polygonOffset",10752:"polygonOffset",35977:zc,32938:"sampleCoverage",32939:"sampleCoverage",3089:zc,3088:(t,e)=>t.scissor(...e),2960:zc,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:Ma,3317:Ma,37440:Ma,37441:Ma,37443:Ma,3330:Ma,3332:Ma,3331:Ma,36010:dW,3314:Ma,32878:Ma,3316:Ma,3315:Ma,32877:Ma,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Tp(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Tp(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Tp(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Tp(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,l,o]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,l,o)},stencilOp:(t,e)=>{e=Tp(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,l,o]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,l,o)},viewport:(t,e)=>t.viewport(...e)};function Si(t,e,n){return e[t]!==void 0?e[t]:n[t]}const gW={blendEquation:(t,e,n)=>t.blendEquationSeparate(Si(32777,e,n),Si(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Si(32969,e,n),Si(32968,e,n),Si(32971,e,n),Si(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Si(32824,e,n),Si(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Si(32938,e,n),Si(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Si(2962,e,n),Si(2967,e,n),Si(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Si(34816,e,n),Si(36003,e,n),Si(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Si(2964,e,n),Si(2965,e,n),Si(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Si(34817,e,n),Si(34818,e,n),Si(34819,e,n))},WM={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},zA=(t,e)=>t.isEnabled(e),QM={3042:zA,2884:zA,2929:zA,3024:zA,32823:zA,32926:zA,32928:zA,3089:zA,2960:zA,35977:zA};function LR(t){for(const e in t)return!1;return!0}function mW(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function qM(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function yW(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,l=new Array(s),o=0;o<s;o++)l[o]=arguments[o];const{valueChanged:p,oldValue:w}=n(t.state._updateCache,...l);return p&&r(...l),w},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function _W(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class vW{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?wW(e):Object.assign({},$T),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Lo(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];ic(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Lo(s!==void 0);const l=e[s],o=this.cache[s];mW(l,o)||(n=!0,r=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=l)}return{valueChanged:n,oldValue:r}}}function DR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Lo(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new vW(t,{copyState:r}),_W(t);for(const s in WM){const l=WM[s];yW(t,s,l)}qM(t,"getParameter"),qM(t,"isEnabled")}return t.state.enable=n,t}function xW(t){t.state||DR(t,{copyState:!1}),t.state.push()}function ZM(t){Lo(t.state),t.state.pop()}function ic(t,e){if(Lo(nv(t),"setParameters requires a WebGL context"),LR(e))return;const n={};for(const i in e){const s=Number(i),l=pW[i];l&&(typeof l=="string"?n[l]=!0:l(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=gW[i];s(t,e,r)}}function wW(t,e){if(e=e||$T,typeof e=="number"){const i=e,s=QM[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=QM[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function bW(t){ic(t,$T)}function hA(t,e,n){if(LR(e))return n(t);const{nocatch:r=!0}=e;xW(t),ic(t,e);let i;if(r)i=n(t),ZM(t);else try{i=n(t)}finally{ZM(t)}return i}function dd(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function iw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=dd(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return TW(e,r,i,s,n)}function EW(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function TW(t,e,n,r,i){const s=YM(t[0],e,n);let l=XM(t[1],e,r,i),o=YM(t[0]+1,e,n);const p=o===n-1?o:o-1;o=XM(t[1]+1,e,r,i);let w;return i?(o=o===0?o:o+1,w=l,l=o):w=o===r-1?o:o-1,{x:s,y:l,width:Math.max(p-s+1,1),height:Math.max(w-l+1,1)}}function YM(t,e,n){return Math.min(Math.round(t*e),n-1)}function XM(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const jT=Od(),SW=jT&&typeof document<"u",RR={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function BR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Lo(jT,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},RR,t);const{width:e,height:n}=t;function r(o){if(t.throwOnError)throw new Error(o);return console.error(o),null}t.onError=r;let i;const{canvas:s}=t,l=kW({canvas:s,width:e,height:n,onError:r});return i=PW(l,t),i?(i=HT(i,t),IW(i),i):null}function HT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||LW(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},RR,e);const{manageState:n,debug:r}=e;return n&&DR(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return vn.log(1,...s)()}}),jT&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),vn.level=Math.max(vn.level,1)):vn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function CW(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function MW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=EW(e.useDevicePixels);DW(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function PW(t,e){const{onError:n}=e;let r=null;const i=p=>r=p.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:l=!0}=e;let o=null;return l&&(o=o||t.getContext("webgl2",e),o=o||t.getContext("experimental-webgl2",e)),s&&(o=o||t.getContext("webgl",e),o=o||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),o?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),o):n("Failed to create ".concat(l&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function kW(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(SW&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function IW(t){const e=cr(t)?"WebGL2":"WebGL1",n=CW(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";vn.info(1,"".concat(e).concat(i," context ").concat(r))()}function LW(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function DW(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(vn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let l=e;const o=Math.floor(r*l),p=Math.floor(i*l);t.canvas.width=o,t.canvas.height=p,(t.drawingBufferWidth!==o||t.drawingBufferHeight!==p)&&(vn.warn("Device pixel ratio clamped")(),l=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*l),t.canvas.height=Math.floor(i*l)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}function KM(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let JM=class{constructor(e,n){oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"sampleSize",1),oe(this,"time",void 0),oe(this,"count",void 0),oe(this,"samples",void 0),oe(this,"lastTiming",void 0),oe(this,"lastSampleTime",void 0),oe(this,"lastSampleCount",void 0),oe(this,"_count",0),oe(this,"_time",0),oe(this,"_samples",0),oe(this,"_startTime",0),oe(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=KM(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(KM()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},RW=class{constructor(e){oe(this,"id",void 0),oe(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof JM?this.stats[n]=e:this.stats[n]=new JM(n,r)),this.stats[n]}};function zR(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function OR(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||zR()}const sw=globalThis;function BW(t){if(!t&&!OR())return"Node";if(zR(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":sw.chrome?"Chrome":sw.safari?"Safari":sw.mozInnerScreenX?"Firefox":"Unknown"}const gg="8.5.21",zW="set luma.log.level=1 (or higher) to trace rendering";class OW{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new RW({id:e})),this.stats.get(e)}}const Kh=new OW;if(globalThis.luma&&globalThis.luma.VERSION!==gg)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(gg));globalThis.luma||(OR()&&vn.log(1,"luma.gl ".concat(gg," - ").concat(zW))(),globalThis.luma=globalThis.luma||{VERSION:gg,version:gg,log:vn,stats:Kh,globals:{modules:{},nodeIO:{}}});function FW(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function NW(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function nn(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function ow(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return nn(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function ch(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const aw={};function gh(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";aw[t]=aw[t]||1;const e=aw[t]++;return"".concat(t,"-").concat(e)}function eP(t){return nn(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function pd(t){let e=!0;for(const n in t){e=!1;break}return e}function FR(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(l=>{s.methodName||(s[l]=()=>{throw vn.removed("Calling removed method ".concat(e,".").concat(l,": "),i)(),new Error(l)})})}const l0="Resource subclass must define virtual methods";let pc=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};rv(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||gh(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=ow(this.gl,e),nn(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=cr(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const o=i.webgl1,p="webgl2"in i?i.webgl2:i.webgl1;return s?p:o}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=cr(this.gl),l={},o=n||Object.keys(i);for(const p of o){const w=i[p];if(w&&(!("webgl2"in w)||s)&&(!("extension"in w)||this.gl.getExtension(w.extension))){const P=r?ch(this.gl,p):p;l[P]=this.getParameter(p,e),r&&w.type==="GLenum"&&(l[P]=ch(this.gl,l[P]))}}return l}setParameter(e,n){e=ow(this.gl,e),nn(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=cr(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=ow(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return FR(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(l0)}_deleteHandle(){throw new Error(l0)}_bindHandle(e){throw new Error(l0)}_getOptsFromHandle(){throw new Error(l0)}_getParameter(e,n){throw new Error(l0)}_setParameter(e,n){throw new Error(l0)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=Kh.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Kh.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=Kh.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=Kh.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const UW="Failed to deduce GL constant from typed array";function m3(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(UW)}}function Gg(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function VW(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const l=n*i;s=s||new Uint8Array(l);for(let o=0;o<r/2;++o){const p=o*l,w=(r-o-1)*l;s.set(e.subarray(p,p+l)),e.copyWithin(p,w,w+l),e.set(s,w)}}function GW(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),l=new Uint8Array(i*s*4);for(let o=0;o<s;o++)for(let p=0;p<i;p++)for(let w=0;w<4;w++)l[(o*i+p)*4+w]=e[(o*2*n+p*2)*4+w];return{data:l,width:i,height:s}}function y3(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const o in r)if(o in e){const w=r[o]?"".concat(t,".").concat(r[o]):"N/A";vn.removed("".concat(t,".").concat(o),w)()}for(const o in i)if(o in e){const p=i[o];vn.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(p))()}let l=null;for(const o in s)if(o in e){const p=s[o];vn.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(p))(),l=l||Object.assign({},e),l[p]=e[o],delete l[o]}return l||e}const $W={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},jW={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class La{static getBytesPerElement(e){return Gg(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return nn(e.size),Gg(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new La($W,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return La.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return La.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=y3("Accessor",e,jW),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const tP=10,NR={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},HW={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:NR},WW={removedProps:NR};class Vr extends pc{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/La.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/La.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=y3("Buffer",e,HW),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=y3("Buffer",e,WW),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new La(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;nn(n);const l=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(l,this.handle),i!==0||s!==void 0?(co(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(l,r,n),this.gl.bindBuffer(l,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:l}=this;return co(l),l.bindBuffer(36662,n.handle),l.bindBuffer(36663,this.handle),l.copyBufferSubData(36662,36663,r,i,s),l.bindBuffer(36662,null),l.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};co(this.gl);const s=Gg(this.accessor.type||5126,{clamped:!1}),l=this._getAvailableElementCount(n),o=r;let p,w;e?(w=e.length,p=w-o):(p=Math.min(l,i||l),w=o+p);const C=Math.min(l,p);return i=i||C,nn(i<=C),e=e||new s(w),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(nn(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(tP,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;nn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,tP),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=m3(e);return nn(s),this.setAccessor(new La(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;nn(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Gg(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new La(this.accessor,{type:m3(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return vn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return vn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return vn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return vn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new La(this.accessor,e),this}}const WT={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},UR={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},VR={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function QW(t,e){const n=WT[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=cr(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function qW(t,e){const n=WT[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const ZW=[9729,9728],nP=globalThis.WebGLBuffer||function(){};class hf extends pc{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&QW(e,r),s=s&&(!i||qW(e,r))),s}constructor(e,n){const{id:r=gh("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(ee=>this.initialize(Object.assign({},e,{pixels:ee,data:ee}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:l=0,recreate:o=!1,parameters:p={},pixelStore:w={},textureUnit:C=void 0}=e;n||(n=i);let{width:P,height:I,dataFormat:U,type:W,compressed:H=!1,mipmaps:ie=!0}=e;const{depth:X=0}=e;return{width:P,height:I,compressed:H,dataFormat:U,type:W}=this._deduceParameters({format:s,type:W,dataFormat:U,compressed:H,data:n,width:P,height:I}),this.width=P,this.height=I,this.depth=X,this.format=s,this.type=W,this.dataFormat=U,this.border=l,this.textureUnit=C,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),ie&&this._isNPOT()&&(vn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),ie=!1,this._updateForNPOT(p)),this.mipmaps=ie,this.setImageData({data:n,width:P,height:I,depth:X,format:s,type:W,dataFormat:U,border:l,mipmaps:ie,parameters:w,compressed:H}),ie&&this.generateMipmap(),this.setParameters(p),o&&(this.data=n),r&&(this._video={video:n,parameters:p,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(vn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),hA(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:l=this.border,offset:o=0,parameters:p={}}=e;let{data:w=null,type:C=this.type,width:P=this.width,height:I=this.height,dataFormat:U=this.dataFormat,compressed:W=!1}=e;w||(w=r),{type:C,dataFormat:U,compressed:W,width:P,height:I}=this._deduceParameters({format:s,type:C,dataFormat:U,compressed:W,data:w,width:P,height:I});const{gl:H}=this;H.bindTexture(this.target,this.handle);let ie=null;({data:w,dataType:ie}=this._getDataType({data:w,compressed:W}));let X,ee=0;if(hA(this.gl,p,()=>{switch(ie){case"null":H.texImage2D(n,i,s,P,I,l,U,C,w);break;case"typed-array":H.texImage2D(n,i,s,P,I,l,U,C,w,o);break;case"buffer":X=co(H),X.bindBuffer(35052,w.handle||w),X.texImage2D(n,i,s,P,I,l,U,C,o),X.bindBuffer(35052,null);break;case"browser-object":cr(H)?H.texImage2D(n,i,s,P,I,l,U,C,w):H.texImage2D(n,i,s,U,C,w);break;case"compressed":for(const[se,fe]of w.entries())H.compressedTexImage2D(n,se,fe.format,fe.width,fe.height,l,fe.data),ee+=fe.levelSize;break;default:nn(!1,"Unknown image data type")}}),ie==="compressed")this._trackAllocatedMemory(ee,"Texture");else if(w&&w.byteLength)this._trackAllocatedMemory(w.byteLength,"Texture");else{const se=UR[this.dataFormat]||4,fe=VR[this.type]||1;this._trackAllocatedMemory(this.width*this.height*se*fe,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:l=0,width:o=this.width,height:p=this.height,level:w=0,format:C=this.format,type:P=this.type,dataFormat:I=this.dataFormat,compressed:U=!1,offset:W=0,border:H=this.border,parameters:ie={}}=e;if({type:P,dataFormat:I,compressed:U,width:o,height:p}=this._deduceParameters({format:C,type:P,dataFormat:I,compressed:U,data:i,width:o,height:p}),nn(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const X=i;i=X.data,o=X.shape[0],p=X.shape[1]}i instanceof Vr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),hA(this.gl,ie,()=>{if(U)this.gl.compressedTexSubImage2D(n,w,s,l,o,p,C,i);else if(i===null)this.gl.texSubImage2D(n,w,s,l,o,p,I,P,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,w,s,l,o,p,I,P,i,W);else if(i instanceof nP){const X=co(this.gl);X.bindBuffer(35052,i),X.texSubImage2D(n,w,s,l,o,p,I,P,W),X.bindBuffer(35052,null)}else cr(this.gl)?co(this.gl).texSubImage2D(n,w,s,l,o,p,I,P,i):this.gl.texSubImage2D(n,w,s,l,I,P,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return vn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof Vr?{data:n.handle,dataType:"buffer"}:n instanceof nP?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:l,type:o,compressed:p}=e;const w=WT[n];return l=l||w&&w.dataFormat,o=o||w&&w.types[0],p=p||w&&w.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:l,type:o,compressed:p,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},nn(i,"Could not deduced texture size"),nn(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),nn(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:nn(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return cr(this.gl)||!this.width||!this.height?!1:!eP(this.width)||!eP(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:ZW.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let YW="";function XW(t,e){return nn(typeof t=="string"),t=YW+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class ca extends hf{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return hf.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};rv(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:XW(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const _3=[34069,34070,34071,34072,34073,34074];class GR extends hf{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};rv(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:l=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:l})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:l=0,format:o=6408,type:p=5121}=e;const{gl:w}=this,C=i||s,P=await Promise.all(_3.map(I=>{const U=C[I];return Promise.all(Array.isArray(U)?U:[U])}));this.bind(),_3.forEach((I,U)=>{P[U].length>1&&this.opts.mipmaps!==!1&&vn.warn("".concat(this.id," has mipmap and multiple LODs."))(),P[U].forEach((W,H)=>{n&&r?w.texImage2D(I,H,o,n,r,l,o,p,W):w.texImage2D(I,H,o,o,p,W)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:l,border:o=0,format:p=6408,type:w=5121}=e,{gl:C}=this,P=s||l;return this.bind(),P instanceof Promise?P.then(I=>this.setImageDataForFace(Object.assign({},e,{face:n,data:I,pixels:I}))):this.width||this.height?C.texImage2D(n,0,p,r,i,o,p,w,P):C.texImage2D(n,0,p,p,w,P),this}}GR.FACES=_3;class KW extends hf{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return cr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};co(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:l=1,border:o=0,format:p,type:w=5121,offset:C=0,data:P,parameters:I={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),hA(this.gl,I,()=>{ArrayBuffer.isView(P)&&this.gl.texImage3D(this.target,n,r,i,s,l,o,p,w,P),P instanceof Vr&&(this.gl.bindBuffer(35052,P.handle),this.gl.texImage3D(this.target,n,r,i,s,l,o,p,w,C))}),P&&P.byteLength)this._trackAllocatedMemory(P.byteLength,"Texture");else{const U=UR[this.dataFormat]||4,W=VR[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*U*W,"Texture")}return this.loaded=!0,this}}const zh="EXT_color_buffer_float",rP={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:zh,bpp:2},33327:{gl2:zh,bpp:4},34842:{gl2:zh,bpp:8},33326:{gl2:zh,bpp:4},33328:{gl2:zh,bpp:8},34836:{gl2:zh,bpp:16},35898:{gl2:zh,bpp:4}};function JW(t,e,n){const r=n[e];if(!r)return!1;const i=cr(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class M0 extends pc{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||JW(e,n,rP)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return nn(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&cr(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*rP[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const eQ=256,tQ=1024,nQ=16384,iP=6144,sP=6145,oP=6146,aP=34041,$R="clear: bad arguments";function QT(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let l=0;n&&(l|=nQ,n!==!0&&(s.clearColor=n)),r&&(l|=eQ,r!==!0&&(s.clearDepth=r)),i&&(l|=tQ,r!==!0&&(s.clearStencil=r)),nn(l!==0,$R),hA(t,s,()=>{t.clear(l)})}function rQ(t){let{framebuffer:e=null,buffer:n=iP,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};co(t),hA(t,{framebuffer:e},()=>{switch(n){case iP:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case sP:t.clearBufferfv(sP,0,[i]);break;case oP:t.clearBufferiv(oP,0,[i]);break;case aP:const[s,l]=i;t.clearBufferfi(aP,0,s,l);break;default:nn(!1,$R)}})}function iQ(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return nn(!1),0}}function iv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:l=null,sourceWidth:o,sourceHeight:p,sourceType:w}=e;const{framebuffer:C,deleteFramebuffer:P}=jR(t);nn(C);const{gl:I,handle:U,attachments:W}=C;o=o||C.width,p=p||C.height,s===36064&&U===null&&(s=1028),nn(W[s]),w=w||W[s].type,l=oQ(l,w,i,o,p),w=w||m3(l);const H=I.bindFramebuffer(36160,U);return I.readPixels(n,r,o,p,i,w,l),I.bindFramebuffer(36160,H||null),P&&C.delete(),l}function lP(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=iv(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=GW({data:r,width:i,height:s}));VW({data:r,width:i,height:s});const l=document.createElement("canvas");l.width=i,l.height=s;const o=l.getContext("2d"),p=o.createImageData(i,s);return p.data.set(r),o.putImageData(p,0,0),l.toDataURL()}function sQ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:l=6408}=n;let{targetX:o,targetY:p,targetZ:w,width:C,height:P}=n;const{framebuffer:I,deleteFramebuffer:U}=jR(t);nn(I);const{gl:W,handle:H}=I,ie=typeof o<"u"||typeof p<"u"||typeof w<"u";o=o||0,p=p||0,w=w||0;const X=W.bindFramebuffer(36160,H);nn(e);let ee=null;if(e instanceof hf&&(ee=e,C=Number.isFinite(C)?C:ee.width,P=Number.isFinite(P)?P:ee.height,ee.bind(0),e=ee.target),!ie)W.copyTexImage2D(e,s,l,r,i,C,P,0);else switch(e){case 3553:case 34067:W.copyTexSubImage2D(e,s,o,p,r,i,C,P);break;case 35866:case 32879:co(W).copyTexSubImage3D(e,s,o,p,w,r,i,C,P);break}return ee&&ee.unbind(),W.bindFramebuffer(36160,X||null),U&&I.delete(),ee}function jR(t){return t instanceof is?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:pQ(t),deleteFramebuffer:!0}}function oQ(t,e,n,r,i){if(t)return t;e=e||5121;const s=Gg(e,{clamped:!1}),l=iQ(n);return new s(r*i*l)}const Jr={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function aQ(t){const e=new ca(t,{format:6408,type:5126,dataFormat:6408}),n=new is(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const HR={[Jr.WEBGL2]:[!1,!0],[Jr.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Jr.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Jr.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Jr.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Jr.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Jr.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Jr.FLOAT_BLEND]:["EXT_float_blend"],[Jr.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Jr.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Jr.TEXTURE_FLOAT]:["OES_texture_float",!0],[Jr.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Jr.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Jr.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Jr.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Jr.COLOR_ATTACHMENT_RGBA32F]:[aQ,"EXT_color_buffer_float"],[Jr.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Jr.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Jr.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Jr.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Jr.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Jr.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},lQ=2;function WR(t,e){return qT(t,e)}function qT(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>QR(t,n))}function AQ(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in HR)t.luma.caps[e]===void 0&&(t.luma.caps[e]=QR(t,e));return t.luma.caps}function QR(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=uQ(t,e)),t.luma.caps[e]||vn.log(lQ,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function uQ(t,e){const n=HR[e];nn(n,e);let r;const i=cr(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:nn(!1);return r}const AP="Multiple render targets not supported";class is extends pc{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new is(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=co(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=co(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:l=!0,stencil:o=!1,check:p=!0,readBuffer:w=void 0,drawBuffers:C=void 0}=e;if(nn(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const P in i){const I=i[P];(Array.isArray(I)?I[0]:I).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,l,o,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:w,drawBuffers:C}),i&&p&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:l=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:l});const{gl:o}=this,p=o.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,p||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return nn(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&vn.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(l=>{i[l]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const l in i){nn(l!==void 0,"Misspelled framebuffer binding point?");const o=Number(l),p=i[o];let w=p;if(!w)this._unattach(o);else if(w instanceof M0)this._attachRenderbuffer({attachment:o,renderbuffer:w});else if(Array.isArray(p)){const[C,P=0,I=0]=p;w=C,this._attachTexture({attachment:o,texture:C,layer:P,level:I})}else this._attachTexture({attachment:o,texture:w,layer:0,level:0});r&&w&&w.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(l=>!this.attachments[l]).forEach(l=>{delete this.attachments[l]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(hQ(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,l=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&QT(this.gl,{color:n,depth:r,stencil:i}),s.forEach((o,p)=>{rQ(this.gl,{drawBuffer:p,value:o})}),this.gl.bindFramebuffer(36160,l||null),this}readPixels(){return vn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return vn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return vn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return vn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return vn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return vn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:l}=e;const o=co(this.gl),p=o.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&l===void 0?o.invalidateFramebuffer(36008,n):o.invalidateFramebuffer(36008,n,r,i,s,l),o.bindFramebuffer(36008,p),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=ch(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const l=n?ch(this.gl,s):s;i[l]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),l=e?ch(this.gl,s):s;r[l]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(lP(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>vn.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=lP(this,{targetMaxHeight:100});return vn.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let l=null;return e&&(l=l||{},l[36064]=new ca(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(l[36064])),n&&r?(l=l||{},l[33306]=new M0(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(l[33306])):n?(l=l||{},l[36096]=new M0(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(l[36096])):r&&nn(!1),l}_unattach(e){const n=this.attachments[e];n&&(n instanceof M0?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:l}=this;switch(l.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:co(l).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const p=cQ(i);l.framebufferTexture2D(36160,n,p,r.handle,s);break;case 3553:l.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:nn(!1,"Illegal texture type")}l.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=NH(this.gl);n?n.readBuffer(e):nn(e===36064||e===1029,AP),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=co(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):nn(e.length===1&&(e[0]===36064||e[0]===1029),AP)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=AQ(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function cQ(t){return t<34069?t+34069:t}function hQ(t){return(is.STATUS||{})[t]||"Framebuffer error ".concat(t)}const fQ=[36049,36048,33296,33298,33299,33300,33301,33302,33303];is.ATTACHMENT_PARAMETERS=fQ;function dQ(t,e){nn(t instanceof ca||t instanceof GR||t instanceof KW);const n=t.constructor,{gl:r,width:i,height:s,format:l,type:o,dataFormat:p,border:w,mipmaps:C}=t,P=Object.assign({width:i,height:s,format:l,type:o,dataFormat:p,border:w,mipmaps:C},e);return new n(r,P)}function pQ(t,e){const{gl:n,width:r,height:i,id:s}=t;return new is(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{36064:t}}))}function ky(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const gQ=35632,mQ=35633;function yQ(t){switch(t){case gQ:return"fragment";case mQ:return"vertex";default:return"unknown type"}}function _Q(t,e,n,r){const i=t.split(/\r?\n/),s={},l={},o=r||ky(e)||"(unnamed)",p="".concat(yQ(n)," shader ").concat(o);for(let C=0;C<i.length;C++){const P=i[C];if(P.length<=1)continue;const I=P.split(":"),U=I[0],W=parseInt(I[2],10);if(isNaN(W))throw new Error("GLSL compilation error in ".concat(p,": ").concat(t));U!=="WARNING"?s[W]=P:l[W]=P}const w=vQ(e);return{shaderName:p,errors:uP(s,w),warnings:uP(l,w)}}function uP(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],l=s.split(":",3),o=l[0],p=parseInt(l[1],10)||0,w=s.substring(l.join(":").length+1).trim();n+=qR("^^^ ".concat(o,": ").concat(w,`

`),p)}}return n}function vQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,l)=>{const o=String(l+e),p=o.length;return qR(o,i-p)+n+s})}function qR(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function ZR(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const xQ="Shader: GLSL source code must be a JavaScript string";class $g extends pc{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return nn(!1),"unknown"}}constructor(e,n){rv(e),nn(typeof n.source=="string",xQ);const r=ky(n.source,null)||n.id||gh("unnamed ".concat($g.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=ky(n,null);r&&(this.id=gh(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat($g.getTypeName(this.shaderType),":").concat(this.id)}getName(){return ky(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:l}=_Q(r,this.source,this.shaderType,this.id);throw vn.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),vn.warn("GLSL compilation warnings in ".concat(i,`
`).concat(l))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class lw extends $g{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Aw extends $g{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const wQ={5126:oi.bind(null,"uniform1fv",Pa,1,to),35664:oi.bind(null,"uniform2fv",Pa,2,to),35665:oi.bind(null,"uniform3fv",Pa,3,to),35666:oi.bind(null,"uniform4fv",Pa,4,to),5124:oi.bind(null,"uniform1iv",Oc,1,to),35667:oi.bind(null,"uniform2iv",Oc,2,to),35668:oi.bind(null,"uniform3iv",Oc,3,to),35669:oi.bind(null,"uniform4iv",Oc,4,to),35670:oi.bind(null,"uniform1iv",Oc,1,to),35671:oi.bind(null,"uniform2iv",Oc,2,to),35672:oi.bind(null,"uniform3iv",Oc,3,to),35673:oi.bind(null,"uniform4iv",Oc,4,to),35674:oi.bind(null,"uniformMatrix2fv",Pa,4,Du),35675:oi.bind(null,"uniformMatrix3fv",Pa,9,Du),35676:oi.bind(null,"uniformMatrix4fv",Pa,16,Du),35678:Is,35680:Is,5125:oi.bind(null,"uniform1uiv",I1,1,to),36294:oi.bind(null,"uniform2uiv",I1,2,to),36295:oi.bind(null,"uniform3uiv",I1,3,to),36296:oi.bind(null,"uniform4uiv",I1,4,to),35685:oi.bind(null,"uniformMatrix2x3fv",Pa,6,Du),35686:oi.bind(null,"uniformMatrix2x4fv",Pa,8,Du),35687:oi.bind(null,"uniformMatrix3x2fv",Pa,6,Du),35688:oi.bind(null,"uniformMatrix3x4fv",Pa,12,Du),35689:oi.bind(null,"uniformMatrix4x2fv",Pa,8,Du),35690:oi.bind(null,"uniformMatrix4x3fv",Pa,12,Du),35678:Is,35680:Is,35679:Is,35682:Is,36289:Is,36292:Is,36293:Is,36298:Is,36299:Is,36300:Is,36303:Is,36306:Is,36307:Is,36308:Is,36311:Is},bQ={},EQ={},TQ={},cP=[0];function ZT(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(cP[0]=t,t=cP);const i=t.length;if(i%e&&vn.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let l=0;l<i;l++)s[l]=t[l];return s}function Pa(t,e){return ZT(t,e,Float32Array,bQ)}function Oc(t,e){return ZT(t,e,Int32Array,EQ)}function I1(t,e){return ZT(t,e,Uint32Array,TQ)}function hP(t,e,n){const r=wQ[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function SQ(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function CQ(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!MQ(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function MQ(t){return Array.isArray(t)||ArrayBuffer.isView(t)?kQ(t):isFinite(t)||t===!0||t===!1||t instanceof hf||t instanceof M0?!0:t instanceof is?!!t.texture:!1}function PQ(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function kQ(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Is(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function oi(t,e,n,r){let i=null,s=null;return(l,o,p)=>{const w=e(p,n),C=w.length;let P=!1;if(i===null)i=new Float32Array(C),s=C,P=!0;else{nn(s===C,"Uniform length cannot change.");for(let I=0;I<C;++I)if(w[I]!==i[I]){P=!0;break}}return P&&(r(l,t,o,w),i.set(w)),P}}function to(t,e,n,r){t[e](n,r)}function Du(t,e,n,r){t[e](n,!1,r)}const IQ=5120,LQ=5121,DQ=5122,RQ=5123,fP=0,L1=1,BQ=2,zQ=3,D1=4,OQ=5,FQ=6,ts=5126,NQ=35664,UQ=35665,VQ=35666,Sp=5124,GQ=35667,$Q=35668,jQ=35669,Cp=5125,HQ=36294,WQ=36295,QQ=36296,qQ=35670,ZQ=35671,YQ=35672,XQ=35673,KQ=35674,JQ=35675,eq=35676,tq=35685,nq=35686,rq=35687,iq=35688,sq=35689,oq=35690,v3={[ts]:[ts,1,"float"],[NQ]:[ts,2,"vec2"],[UQ]:[ts,3,"vec3"],[VQ]:[ts,4,"vec4"],[Sp]:[Sp,1,"int"],[GQ]:[Sp,2,"ivec2"],[$Q]:[Sp,3,"ivec3"],[jQ]:[Sp,4,"ivec4"],[Cp]:[Cp,1,"uint"],[HQ]:[Cp,2,"uvec2"],[WQ]:[Cp,3,"uvec3"],[QQ]:[Cp,4,"uvec4"],[qQ]:[ts,1,"bool"],[ZQ]:[ts,2,"bvec2"],[YQ]:[ts,3,"bvec3"],[XQ]:[ts,4,"bvec4"],[KQ]:[ts,8,"mat2"],[tq]:[ts,8,"mat2x3"],[nq]:[ts,8,"mat2x4"],[JQ]:[ts,12,"mat3"],[rq]:[ts,12,"mat3x2"],[iq]:[ts,12,"mat3x4"],[eq]:[ts,16,"mat4"],[sq]:[ts,16,"mat4x2"],[oq]:[ts,16,"mat4x3"]};function aq(t){switch(t){case fP:return fP;case L1:return L1;case zQ:return L1;case BQ:return L1;case D1:return D1;case OQ:return D1;case FQ:return D1;default:return nn(!1),0}}function dP(t){const e=v3[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function YR(t,e){switch(t){case IQ:case LQ:case DQ:case RQ:t=ts;break}for(const n in v3){const[r,i,s]=v3[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class lq{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:l,size:o}=n.getActiveAttrib(e.handle,i),p=n.getAttribLocation(e.handle,s);p>=0&&this._addAttribute(p,s,l,o)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!cr(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:l,size:o}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,l,o)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:l}=dP(r),o={type:s,size:i*l};this._inferProperties(e,n,o);const p={location:e,name:n,accessor:new La(o)};this.attributeInfos.push(p),this.attributeInfosByLocation[e]=p,this.attributeInfosByName[p.name]=p}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:l}=dP(r),o=new La({type:s,size:i*l}),p={location:e,name:n,accessor:o};this.varyingInfos.push(p),this.varyingInfosByName[p.name]=p}}const pP=4,Aq=35981,uq=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class XR extends pc{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",uq),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:l=Aq}=e;return this.hash=n||"",this.vs=typeof r=="string"?new lw(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new Aw(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,nn(this.vs instanceof lw),nn(this.fs instanceof Aw),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(co(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,l)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new lq(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:l,end:o,isIndexed:p=!1,indexType:w=5123,instanceCount:C=0,isInstanced:P=C>0,vertexArray:I=null,transformFeedback:U,framebuffer:W,parameters:H={},uniforms:ie,samplers:X}=e;if((ie||X)&&(vn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(ie||{})),vn.priority>=n){const ee=W?W.id:"default",se="mode=".concat(ch(this.gl,r)," verts=").concat(i," ")+"instances=".concat(C," indexType=").concat(ch(this.gl,w)," ")+"isInstanced=".concat(P," isIndexed=").concat(p," ")+"Framebuffer=".concat(ee);vn.log(n,se)()}return nn(I),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||P&&C===0?!1:(I.bindForDraw(i,C,()=>{if(W!==void 0&&(H=Object.assign({},H,{framebuffer:W})),U){const ee=aq(r);U.begin(ee)}this._bindTextures(),hA(this.gl,H,()=>{p&&P?this.gl2.drawElementsInstanced(r,i,w,s,C):p&&cr(this.gl)&&!isNaN(l)&&!isNaN(o)?this.gl2.drawRangeElements(r,l,o,i,w,s):p?this.gl.drawElements(r,i,w,s):P?this.gl2.drawArraysInstanced(r,s,i,C):this.gl.drawArrays(r,s,i)}),U&&U.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};vn.priority>=2&&CQ(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,l=!1;if(s instanceof is&&(s=s.texture),s instanceof hf)if(l=this.uniforms[n]!==r,l){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const o=s,{textureIndex:p}=i;o.bind(p),s=p,this._textureUniforms[n]=o}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||l)&&PQ(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new lw({handle:i});break;case 35632:r.fs=new Aw({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=gh(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),vn.time(pP,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),vn.timeEnd(pP,"linkProgram for ".concat(this._getName()))(),e.debug||vn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=SQ(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=hP(e,s,r),r.size>1)for(let l=0;l<r.size;l++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(l,"]")),this._uniformSetters["".concat(i,"[").concat(l,"]")]=hP(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const cq=34918,hq=34919,fq=35007,dq=36795,pq=35976,gq=35887,mq=36202;class D_ extends pc{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=cr(e),i=qT(e,Jr.TIMER_QUERY);let s=r||i;for(const l of n)switch(l){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:nn(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(fq)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?mq:gq)}beginTransformFeedbackQuery(){return this.begin(pq)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,hq);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(dq)}getResult(){return this.gl2.getQueryParameter(this.handle,cq)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return D_.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class KR extends pc{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return cr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};co(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,pd(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:l}=this._getBufferParams(n);return r<0?(this.unused[e]=i,vn.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,l,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof Vr?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let R1=null;function yq(t){return(!R1||R1.byteLength<t)&&(R1=new ArrayBuffer(t)),R1}function _q(t,e){const n=yq(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function vq(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,l=i*s;let o=0;for(let p=r;o<s;o++)e[p++]=n[o];for(;o<l;)o<l-o?(e.copyWithin(r+o,r,r+o),o*=2):(e.copyWithin(r+o,r,r+l-o),o=l);return e}const xq="elements must be GL.ELEMENT_ARRAY_BUFFER";class ka extends pc{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?cr(e)||BW()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new ka(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return ka.MAX_ATTRIBUTES=ka.MAX_ATTRIBUTES||e.getParameter(34921),ka.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:ka._setConstantFloatArray(e,n,r);break;case Int32Array:ka._setConstantIntArray(e,n,r);break;case Uint32Array:ka._setConstantUintArray(e,n,r);break;default:nn(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return ka.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return nn(!e||e.target===34963,xq),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:l,offset:o,normalized:p,integer:w,divisor:C}=r,{gl:P,gl2:I}=this;return e=Number(e),this.bind(()=>{P.bindBuffer(34962,n.handle),w?(nn(cr(P)),I.vertexAttribIPointer(e,i,s,l,o)):P.vertexAttribPointer(e,i,s,p,l,o),P.enableVertexAttribArray(e),I.vertexAttribDivisor(e,C||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!ka.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let l=!this.buffer;if(this.buffer=this.buffer||new Vr(this.gl,i),l=l||this.buffer.reallocate(i),l=l||!this._compareConstantArrayValues(r,this.bufferValue),l){const o=_q(n.constructor,s);vq({target:o,source:r,start:0,count:s}),this.buffer.subData(o),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:nn(!1)}}static _setConstantIntArray(e,n,r){switch(nn(cr(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:nn(!1)}}static _setConstantUintArray(e,n,r){switch(nn(cr(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:nn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return nn(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const wq="VertexArray: attributes must be Buffers or constants (i.e. typed array)",bq=/^(.+)__LOCATION_([0-9]+)$/,Eq=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Tq{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new ka(e),FR(this,"VertexArray","v6.0",Eq),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Vr(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Vr&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof Vr&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:l,name:o}=this._getAttributeIndex(e);if(!Number.isFinite(l)||l<0)return this.unused[e]=n,vn.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const p=this._getAttributeInfo(o||l);if(!p)return s;const w=this.accessors[l]||{},C=La.resolve(p.accessor,w,r,i),{size:P,type:I}=C;return nn(Number.isFinite(P)&&Number.isFinite(I)),{location:l,accessor:C}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=bq.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof Vr)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof Vr){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof Vr){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(wq)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(ka.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){ka.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,l=s>0;if(e.isInstanced=e.isInstanced||l,r instanceof Vr){const o=r;if(l){const p=o.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,p)}else{const p=o.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,p)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function Sq(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let l=0;l<t.length&&l<n;++l)l>0&&(i+=",".concat(l%r===0?" ":"")),i+=jg(t[l],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function jg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return Sq(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function gP(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;nn(n);const s=".*_.*",l=".*Matrix",o=n._uniformSetters,p={},w=Object.keys(o).sort();let C=0;for(const U of w)!U.match(s)&&!U.match(l)&&uw({table:p,header:e,uniforms:r,uniformName:U,undefinedOnly:i})&&C++;for(const U of w)U.match(l)&&uw({table:p,header:e,uniforms:r,uniformName:U,undefinedOnly:i})&&C++;for(const U of w)p[U]||uw({table:p,header:e,uniforms:r,uniformName:U,undefinedOnly:i})&&C++;let P=0;const I={};if(!i)for(const U in r){const W=r[U];p[U]||(P++,I[U]={Type:"NOT USED: ".concat(W),[e]:jg(W)})}return{table:p,count:C,unusedTable:I,unusedCount:P}}function uw(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const l=r[i],o=Cq(l);return!s||!o?(e[i]={[n]:o?jg(l):"N/A","Uniform Type":o?l:"NOT PROVIDED"},!0):!1}function Cq(t){return t!=null}function Mq(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=mP(e,e.elements,null,n));const i=e.values;for(const s in i){const l=e._getAttributeInfo(s);if(l){let o="".concat(s,": ").concat(l.name);const p=e.accessors[l.location];p&&(o="".concat(s,": ").concat(Pq(l.name,p))),r[o]=mP(e,i[s],p,n)}}return r}function mP(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",l=1,o=0,p=0,w,C,P;if(n&&(s=n.type,l=n.size,s=String(s).replace("Array",""),w=s.indexOf("nt")!==-1),e instanceof Vr){const I=e,{data:U,changed:W}=I.getDebugData();C=W?"*":"",P=U,p=I.byteLength,o=p/U.BYTES_PER_ELEMENT/l;let H;if(n){const ie=n.divisor>0;H="".concat(ie?"I ":"P "," ").concat(o," (x").concat(l,"=").concat(p," bytes ").concat(ch(i,s),")")}else w=!0,H="".concat(p," bytes");return{[r]:"".concat(C).concat(jg(P,{size:l,isInteger:w})),"Format ":H}}return P=e,l=e.length,s=String(e.constructor.name).replace("Array",""),w=s.indexOf("nt")!==-1,{[r]:"".concat(jg(P,{size:l,isInteger:w})," (constant)"),"Format ":"".concat(l,"x").concat(s," (constant)")}}function Pq(t,e){const{type:n,size:r}=e,i=YR(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function kq(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=yP(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=yP(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function yP(t){const{type:e,size:n}=t.accessor,r=YR(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}function Iq(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Lq(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||Iq()}const _P=Lq()&&typeof document<"u";let Dq=0;class Rq{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=ie=>BR(ie),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:l=()=>{},onError:o,gl:p=null,glOptions:w={},debug:C=!1,createFramebuffer:P=!1,autoResizeViewport:I=!0,autoResizeDrawingBuffer:U=!0,stats:W=Kh.get("animation-loop-".concat(Dq++))}=e;let{useDevicePixels:H=!0}=e;"useDevicePixelRatio"in e&&(vn.deprecated("useDevicePixelRatio","useDevicePixels")(),H=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:l,onError:o,gl:p,glOptions:w,debug:C,createFramebuffer:P},this.gl=p,this.needsRedraw=null,this.timeline=null,this.stats=W,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:I,autoResizeDrawingBuffer:U,useDevicePixels:H}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return nn(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=D_.isSupported(this.gl,["timers"])?new D_(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return vn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=_P?new Promise((e,n)=>{if(_P&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):NW(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):FW(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?HT(this.props.gl,e):this.onCreateContext(e),!nv(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");bW(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&MW(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new is(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Sm="vs",YT="fs";function Oa(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const cw={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function Bq(t){const e={};for(const n in t){const r=t[n],i=zq(r);e[n]=i}return e}function zq(t){let e=vP(t);return e==="object"?t?"type"in t?Object.assign({},t,cw[t.type]):"value"in t?(e=vP(t.value),Object.assign({type:e},t,cw[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},cw[e])}function vP(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const Oq="vs",Fq="fs";class xP{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:l,getUniforms:o,deprecations:p=[],defines:w={},inject:C={},vertexShader:P,fragmentShader:I}=e;Oa(typeof n=="string"),this.name=n,this.vs=r||P,this.fs=i||I,this.getModuleUniforms=o,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(p),this.defines=w,this.injections=Nq(C),l&&(this.uniforms=Bq(l))}getModuleSource(e){let n;switch(e){case Oq:n=this.vs||"";break;case Fq:n=this.fs||"";break;default:Oa(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&Oa(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function Nq(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function Uq(t){return Vq(eB(t))}function Vq(t){const e={},n={};return JR({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function JR(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&JR({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function eB(t,e){return t.map(n=>(n instanceof xP||(Oa(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Oa(n.name,"shader module has no name"),n=new xP(n),n.dependencies=eB(n.dependencies)),n))}function Gq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const $q=7936,jq=7937,Hq=7938,Wq=35724,XT={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Wh={};Object.keys(XT).forEach(t=>{Wh[t]=t});function Qq(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function qq(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||$q),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||jq);return{gpuVendor:Zq(n,r),vendor:n,renderer:r,version:t.getParameter(Hq),shadingLanguageVersion:t.getParameter(Wq)}}function Zq(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const hw={};function wP(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=XT[e];if(Oa(r,e),!Gq(n))return!0;if(e in hw)return hw[e];const i=r[0],s=n.behavior||"enable",l="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),o=t.createShader(35633);t.shaderSource(o,l),t.compileShader(o);const p=t.getShaderParameter(o,35713);return t.deleteShader(o),hw[e]=p,p}function Yq(t,e){const n=XT[e];Oa(n,e);const r=Qq(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return Oa(i===!1||i===!0),i}function B1(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Yq(t,n))}function Xq(t){switch(qq(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function Kq(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return B1(t,Wh.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),B1(t,Wh.GLSL_DERIVATIVES)&&wP(t,Wh.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),B1(t,Wh.GLSL_FRAG_DATA)&&wP(t,Wh.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),B1(t,Wh.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const Jq=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,eZ=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,tZ={[Sm]:Jq,[YT]:eZ},Iy="__LUMA_INJECT_DECLARATIONS__",bP=/void\s+main\s*\([^)]*\)\s*\{\n?/,EP=/}\n?[^{}]*$/,fw=[];function TP(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Sm;for(const s in n){const l=n[s];l.sort((p,w)=>p.order-w.order),fw.length=l.length;for(let p=0,w=l.length;p<w;++p)fw[p]=l[p].injection;const o="".concat(fw.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(Iy,o));break;case"vs:#main-start":i&&(t=t.replace(bP,p=>p+o));break;case"vs:#main-end":i&&(t=t.replace(EP,p=>o+p));break;case"fs:#decl":i||(t=t.replace(Iy,o));break;case"fs:#main-start":i||(t=t.replace(bP,p=>p+o));break;case"fs:#main-end":i||(t=t.replace(EP,p=>o+p));break;default:t=t.replace(s,p=>p+o)}}return t=t.replace(Iy,""),r&&(t=t.replace(/\}\s*$/,s=>s+tZ[e])),t}function x3(t){const e={};return Oa(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function gd(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const tB=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],nZ=[...tB,[gd("attribute"),"in $1"],[gd("varying"),"out $1"]],rZ=[...tB,[gd("varying"),"in $1"]],nB=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],iZ=[...nB,[gd("in"),"attribute $1"],[gd("out"),"varying $1"]],sZ=[...nB,[gd("in"),"varying $1"]],w3="gl_FragColor",b3=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,oZ=/void\s+main\s*\([^)]*\)\s*\{\n?/;function aZ(t,e,n){switch(e){case 300:return n?R_(t,nZ):lZ(t);case 100:return n?R_(t,iZ):AZ(t);default:throw new Error("unknown GLSL version ".concat(e))}}function R_(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function lZ(t){t=R_(t,rZ);const e=t.match(b3);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(w3,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(oZ,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(w3,"\\b"),"g"),n)}return t}function AZ(t){t=R_(t,sZ);const e=t.match(b3);if(e){const n=e[1];t=t.replace(b3,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),w3)}return t}const uZ=`

`.concat(Iy,`

`),rB={[Sm]:"vertex",[YT]:"fragment"},cZ=`precision highp float;

`;function hZ(t,e){const{vs:n,fs:r}=e,i=Uq(e.modules||[]);return{gl:t,vs:SP(t,Object.assign({},e,{source:n,type:Sm,modules:i})),fs:SP(t,Object.assign({},e,{source:r,type:YT,modules:i})),getUniforms:fZ(i)}}function SP(t,e){let{id:n,source:r,type:i,modules:s,defines:l={},hookFunctions:o=[],inject:p={},transpileToGLSL100:w=!1,prologue:C=!0,log:P}=e;Oa(typeof r=="string","shader source must be a string");const I=i===Sm,U=r.split(`
`);let W=100,H="",ie=r;U[0].indexOf("#version ")===0?(W=300,H=U[0],ie=U.slice(1).join(`
`)):H="#version ".concat(W);const X={};s.forEach(He=>{Object.assign(X,He.getDefines())}),Object.assign(X,l);let ee=C?"".concat(H,`
`).concat(pZ({id:n,source:r,type:i}),`
`).concat(dZ({type:i}),`
`).concat(Xq(t),`
`).concat(Kq(t),`
`).concat(gZ(X),`
`).concat(I?"":cZ,`
`):"".concat(H,`
`);const se=yZ(o),fe={},me={},Se={};for(const He in p){const Qe=typeof p[He]=="string"?{injection:p[He],order:0}:p[He],Ke=He.match(/^(v|f)s:(#)?([\w-]+)$/);if(Ke){const rt=Ke[2],Ue=Ke[3];rt?Ue==="decl"?me[He]=[Qe]:Se[He]=[Qe]:fe[He]=[Qe]}else Se[He]=[Qe]}for(const He of s){P&&He.checkDeprecations(ie,P);const Qe=He.getModuleSource(i,W);ee+=Qe;const Ke=He.injections[i];for(const rt in Ke){const Ue=rt.match(/^(v|f)s:#([\w-]+)$/);if(Ue){const Ze=Ue[2]==="decl"?me:Se;Ze[rt]=Ze[rt]||[],Ze[rt].push(Ke[rt])}else fe[rt]=fe[rt]||[],fe[rt].push(Ke[rt])}}return ee+=uZ,ee=TP(ee,i,me),ee+=mZ(se[i],fe),ee+=ie,ee=TP(ee,i,Se),ee=aZ(ee,w?100:W,I),ee}function fZ(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function dZ(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(rB[e].toUpperCase(),`
`)}function pZ(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(rB[r],`

`):""}function gZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function mZ(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((l,o)=>l.order-o.order);for(const l of s)n+="  ".concat(l.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function yZ(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),l=n.replace(/\(.+/,"");e[i][l]=Object.assign(r,{signature:s})}),e}const _Z="void main() {gl_FragColor = vec4(0);}",iB=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,vZ=`#version 300 es
`.concat(iB);function sB(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const l=s.split(";")[0];return{qualifier:r,type:i,name:l}}function oB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?vZ:e>300?"#version ".concat(e,`
`).concat(iB):_Z;const s=bZ(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function xZ(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Oa(!1),null}}function wZ(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Oa(!1),null}}function bZ(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Oa(!1),null}}const EZ=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,TZ={name:"fp32",vs:EZ,fs:null};function Hg(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Do={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function SZ(t,{precision:e=Do.precision}={}){return t=CZ(t),"".concat(parseFloat(t.toPrecision(e)))}function ff(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Kc(t,e,n){return PZ(t,r=>Math.max(e,Math.min(n,r)))}function xl(t,e,n){return ff(t)?t.map((r,i)=>xl(r,e[i],n)):n*e+(1-n)*t}function Zu(t,e,n){const r=Do.EPSILON;n&&(Do.EPSILON=n);try{if(t===e)return!0;if(ff(t)&&ff(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Zu(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Do.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Do.EPSILON=r}}function CZ(t){return Math.round(t/Do.EPSILON)*Do.EPSILON}function MZ(t){return t.clone?t.clone():new Array(t.length)}function PZ(t,e,n){if(ff(t)){const r=t;n=n||MZ(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function kZ(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class KT extends kZ(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:ff(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Do)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+SZ(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Zu(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Do.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function IZ(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Wr(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function mg(t,e,n=""){if(Do.debug&&!IZ(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class aB extends KT{get x(){return this[0]}set x(e){this[0]=Wr(e)}get y(){return this[1]}set y(e){this[1]=Wr(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return Wr(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Wr(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Hg(e>=0&&e<this.ELEMENTS,"index is out of range"),Wr(this[e])}setComponent(e,n){return Hg(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var yg=1e-6,dA=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function LZ(){var t=new dA(2);return dA!=Float32Array&&(t[0]=0,t[1]=0),t}function E3(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function DZ(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function RZ(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function BZ(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function zZ(t,e){return t[0]=-e[0],t[1]=-e[1],t}function lB(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function OZ(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function FZ(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var NZ=DZ;(function(){var t=LZ();return function(e,n,r,i,s,l){var o,p;for(n||(n=2),r||(r=0),i?p=Math.min(i*n+r,e.length):p=e.length,o=r;o<p;o+=n)t[0]=e[o],t[1]=e[o+1],s(t,t,l),e[o]=t[0],e[o+1]=t[1];return e}})();function UZ(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function AB(t,e,n){const r=e[0],i=e[1],s=e[2],l=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/l,t[1]=(n[1]*r+n[5]*i+n[9]*s)/l,t[2]=(n[2]*r+n[6]*i+n[10]*s)/l,t}function VZ(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function GZ(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function uB(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*s,t[1]=n[1]*r+n[4]*i+n[7]*s,t[2]=n[2]*r+n[5]*i+n[8]*s,t[3]=e[3],t}function cB(){var t=new dA(3);return dA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function $Z(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function CP(t,e,n){var r=new dA(3);return r[0]=t,r[1]=e,r[2]=n,r}function jZ(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function HZ(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function WZ(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function QZ(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function qZ(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function hB(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ly(t,e,n){var r=e[0],i=e[1],s=e[2],l=n[0],o=n[1],p=n[2];return t[0]=i*p-s*o,t[1]=s*l-r*p,t[2]=r*o-i*l,t}function ZZ(t,e,n,r){var i=e[0],s=e[1],l=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=l+r*(n[2]-l),t}function JT(t,e,n){var r=e[0],i=e[1],s=e[2],l=n[3]*r+n[7]*i+n[11]*s+n[15];return l=l||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/l,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/l,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/l,t}function fB(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function dB(t,e,n){var r=n[0],i=n[1],s=n[2],l=n[3],o=e[0],p=e[1],w=e[2],C=i*w-s*p,P=s*o-r*w,I=r*p-i*o,U=i*I-s*P,W=s*C-r*I,H=r*P-i*C,ie=l*2;return C*=ie,P*=ie,I*=ie,U*=2,W*=2,H*=2,t[0]=o+C+U,t[1]=p+P+W,t[2]=w+I+H,t}function YZ(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function XZ(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function KZ(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function JZ(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],l=e[1],o=e[2],p=Math.sqrt(n*n+r*r+i*i),w=Math.sqrt(s*s+l*l+o*o),C=p*w,P=C&&hB(t,e)/C;return Math.acos(Math.min(Math.max(P,-1),1))}var pB=jZ,eY=HZ,gB=$Z,dw=WZ;(function(){var t=cB();return function(e,n,r,i,s,l){var o,p;for(n||(n=3),r||(r=0),i?p=Math.min(i*n+r,e.length):p=e.length,o=r;o<p;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],s(t,t,l),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const pw=[0,0,0];let z1;class An extends aB{static get ZERO(){return z1||(z1=new An(0,0,0),Object.freeze(z1)),z1}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&ff(e)?this.copy(e):(Do.debug&&(Wr(e),Wr(n),Wr(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Do.debug&&(Wr(e.x),Wr(e.y),Wr(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Wr(e)}angle(e){return JZ(this,e)}cross(e){return Ly(this,this,e),this.check()}rotateX({radians:e,origin:n=pw}){return YZ(this,this,n,e),this.check()}rotateY({radians:e,origin:n=pw}){return XZ(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=pw}){return KZ(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return JT(this,this,e),this.check()}transformAsVector(e){return AB(this,this,e),this.check()}transformByMatrix3(e){return fB(this,this,e),this.check()}transformByMatrix2(e){return VZ(this,this,e),this.check()}transformByQuaternion(e){return dB(this,this,e),this.check()}}let O1;class eS extends aB{static get ZERO(){return O1||(O1=new eS(0,0,0,0),Object.freeze(O1)),O1}constructor(e=0,n=0,r=0,i=0){super(-0,-0,-0,-0),ff(e)&&arguments.length===1?this.copy(e):(Do.debug&&(Wr(e),Wr(n),Wr(r),Wr(i)),this[0]=e,this[1]=n,this[2]=r,this[3]=i)}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Do.debug&&(Wr(e.x),Wr(e.y),Wr(e.z),Wr(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Wr(e)}get w(){return this[3]}set w(e){this[3]=Wr(e)}transform(e){return JT(this,this,e),this.check()}transformByMatrix3(e){return uB(this,this,e),this.check()}transformByMatrix2(e){return GZ(this,this,e),this.check()}transformByQuaternion(e){return dB(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class mB extends KT{toString(){let e="[";if(Do.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Wr(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function tY(){var t=new dA(9);return dA!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function nY(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function rY(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=e[4],o=e[5],p=e[6],w=e[7],C=e[8],P=C*l-o*w,I=-C*s+o*p,U=w*s-l*p,W=n*P+r*I+i*U;return W?(W=1/W,t[0]=P*W,t[1]=(-C*r+i*w)*W,t[2]=(o*r-i*l)*W,t[3]=I*W,t[4]=(C*n-i*p)*W,t[5]=(-o*n+i*s)*W,t[6]=U*W,t[7]=(-w*n+r*p)*W,t[8]=(l*n-r*s)*W,t):null}function iY(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],l=t[5],o=t[6],p=t[7],w=t[8];return e*(w*s-l*p)+n*(-w*i+l*o)+r*(p*i-s*o)}function MP(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],p=e[5],w=e[6],C=e[7],P=e[8],I=n[0],U=n[1],W=n[2],H=n[3],ie=n[4],X=n[5],ee=n[6],se=n[7],fe=n[8];return t[0]=I*r+U*l+W*w,t[1]=I*i+U*o+W*C,t[2]=I*s+U*p+W*P,t[3]=H*r+ie*l+X*w,t[4]=H*i+ie*o+X*C,t[5]=H*s+ie*p+X*P,t[6]=ee*r+se*l+fe*w,t[7]=ee*i+se*o+fe*C,t[8]=ee*s+se*p+fe*P,t}function sY(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],p=e[5],w=e[6],C=e[7],P=e[8],I=n[0],U=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=l,t[4]=o,t[5]=p,t[6]=I*r+U*l+w,t[7]=I*i+U*o+C,t[8]=I*s+U*p+P,t}function oY(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],p=e[5],w=e[6],C=e[7],P=e[8],I=Math.sin(n),U=Math.cos(n);return t[0]=U*r+I*l,t[1]=U*i+I*o,t[2]=U*s+I*p,t[3]=U*l-I*r,t[4]=U*o-I*i,t[5]=U*p-I*s,t[6]=w,t[7]=C,t[8]=P,t}function PP(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function aY(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n+n,o=r+r,p=i+i,w=n*l,C=r*l,P=r*o,I=i*l,U=i*o,W=i*p,H=s*l,ie=s*o,X=s*p;return t[0]=1-P-W,t[3]=C-X,t[6]=I+ie,t[1]=C+X,t[4]=1-w-W,t[7]=U-H,t[2]=I-ie,t[5]=U+H,t[8]=1-w-P,t}var T3;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(T3||(T3={}));const lY=Object.freeze([1,0,0,0,1,0,0,0,1]);class Rs extends mB{static get IDENTITY(){return uY()}static get ZERO(){return AY()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return T3}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(lY)}fromObject(e){return this.check()}fromQuaternion(e){return aY(this,e),this.check()}set(e,n,r,i,s,l,o,p,w){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=l,this[6]=o,this[7]=p,this[8]=w,this.check()}setRowMajor(e,n,r,i,s,l,o,p,w){return this[0]=e,this[1]=i,this[2]=o,this[3]=n,this[4]=s,this[5]=p,this[6]=r,this[7]=l,this[8]=w,this.check()}determinant(){return iY(this)}transpose(){return nY(this,this),this.check()}invert(){return rY(this,this),this.check()}multiplyLeft(e){return MP(this,e,this),this.check()}multiplyRight(e){return MP(this,this,e),this.check()}rotate(e){return oY(this,this,e),this.check()}scale(e){return Array.isArray(e)?PP(this,this,e):PP(this,this,[e,e]),this.check()}translate(e){return sY(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=OZ(n||[-0,-0],e,this);break;case 3:r=fB(n||[-0,-0,-0],e,this);break;case 4:r=uB(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return mg(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let F1,N1;function AY(){return F1||(F1=new Rs([0,0,0,0,0,0,0,0,0]),Object.freeze(F1)),F1}function uY(){return N1||(N1=new Rs,Object.freeze(N1)),N1}function cY(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function hY(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],l=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=l,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function S3(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=e[4],o=e[5],p=e[6],w=e[7],C=e[8],P=e[9],I=e[10],U=e[11],W=e[12],H=e[13],ie=e[14],X=e[15],ee=n*o-r*l,se=n*p-i*l,fe=n*w-s*l,me=r*p-i*o,Se=r*w-s*o,He=i*w-s*p,Qe=C*H-P*W,Ke=C*ie-I*W,rt=C*X-U*W,Ue=P*ie-I*H,it=P*X-U*H,Ze=I*X-U*ie,yt=ee*Ze-se*it+fe*Ue+me*rt-Se*Ke+He*Qe;return yt?(yt=1/yt,t[0]=(o*Ze-p*it+w*Ue)*yt,t[1]=(i*it-r*Ze-s*Ue)*yt,t[2]=(H*He-ie*Se+X*me)*yt,t[3]=(I*Se-P*He-U*me)*yt,t[4]=(p*rt-l*Ze-w*Ke)*yt,t[5]=(n*Ze-i*rt+s*Ke)*yt,t[6]=(ie*fe-W*He-X*se)*yt,t[7]=(C*He-I*fe+U*se)*yt,t[8]=(l*it-o*rt+w*Qe)*yt,t[9]=(r*rt-n*it-s*Qe)*yt,t[10]=(W*Se-H*fe+X*ee)*yt,t[11]=(P*fe-C*Se-U*ee)*yt,t[12]=(o*Ke-l*Ue-p*Qe)*yt,t[13]=(n*Ue-r*Ke+i*Qe)*yt,t[14]=(H*se-W*me-ie*ee)*yt,t[15]=(C*me-P*se+I*ee)*yt,t):null}function fY(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],l=t[5],o=t[6],p=t[7],w=t[8],C=t[9],P=t[10],I=t[11],U=t[12],W=t[13],H=t[14],ie=t[15],X=e*l-n*s,ee=e*o-r*s,se=e*p-i*s,fe=n*o-r*l,me=n*p-i*l,Se=r*p-i*o,He=w*W-C*U,Qe=w*H-P*U,Ke=w*ie-I*U,rt=C*H-P*W,Ue=C*ie-I*W,it=P*ie-I*H;return X*it-ee*Ue+se*rt+fe*Ke-me*Qe+Se*He}function nf(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],p=e[5],w=e[6],C=e[7],P=e[8],I=e[9],U=e[10],W=e[11],H=e[12],ie=e[13],X=e[14],ee=e[15],se=n[0],fe=n[1],me=n[2],Se=n[3];return t[0]=se*r+fe*o+me*P+Se*H,t[1]=se*i+fe*p+me*I+Se*ie,t[2]=se*s+fe*w+me*U+Se*X,t[3]=se*l+fe*C+me*W+Se*ee,se=n[4],fe=n[5],me=n[6],Se=n[7],t[4]=se*r+fe*o+me*P+Se*H,t[5]=se*i+fe*p+me*I+Se*ie,t[6]=se*s+fe*w+me*U+Se*X,t[7]=se*l+fe*C+me*W+Se*ee,se=n[8],fe=n[9],me=n[10],Se=n[11],t[8]=se*r+fe*o+me*P+Se*H,t[9]=se*i+fe*p+me*I+Se*ie,t[10]=se*s+fe*w+me*U+Se*X,t[11]=se*l+fe*C+me*W+Se*ee,se=n[12],fe=n[13],me=n[14],Se=n[15],t[12]=se*r+fe*o+me*P+Se*H,t[13]=se*i+fe*p+me*I+Se*ie,t[14]=se*s+fe*w+me*U+Se*X,t[15]=se*l+fe*C+me*W+Se*ee,t}function B_(t,e,n){var r=n[0],i=n[1],s=n[2],l,o,p,w,C,P,I,U,W,H,ie,X;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(l=e[0],o=e[1],p=e[2],w=e[3],C=e[4],P=e[5],I=e[6],U=e[7],W=e[8],H=e[9],ie=e[10],X=e[11],t[0]=l,t[1]=o,t[2]=p,t[3]=w,t[4]=C,t[5]=P,t[6]=I,t[7]=U,t[8]=W,t[9]=H,t[10]=ie,t[11]=X,t[12]=l*r+C*i+W*s+e[12],t[13]=o*r+P*i+H*s+e[13],t[14]=p*r+I*i+ie*s+e[14],t[15]=w*r+U*i+X*s+e[15]),t}function tS(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function dY(t,e,n,r){var i=r[0],s=r[1],l=r[2],o=Math.hypot(i,s,l),p,w,C,P,I,U,W,H,ie,X,ee,se,fe,me,Se,He,Qe,Ke,rt,Ue,it,Ze,yt,Kt;return o<yg?null:(o=1/o,i*=o,s*=o,l*=o,p=Math.sin(n),w=Math.cos(n),C=1-w,P=e[0],I=e[1],U=e[2],W=e[3],H=e[4],ie=e[5],X=e[6],ee=e[7],se=e[8],fe=e[9],me=e[10],Se=e[11],He=i*i*C+w,Qe=s*i*C+l*p,Ke=l*i*C-s*p,rt=i*s*C-l*p,Ue=s*s*C+w,it=l*s*C+i*p,Ze=i*l*C+s*p,yt=s*l*C-i*p,Kt=l*l*C+w,t[0]=P*He+H*Qe+se*Ke,t[1]=I*He+ie*Qe+fe*Ke,t[2]=U*He+X*Qe+me*Ke,t[3]=W*He+ee*Qe+Se*Ke,t[4]=P*rt+H*Ue+se*it,t[5]=I*rt+ie*Ue+fe*it,t[6]=U*rt+X*Ue+me*it,t[7]=W*rt+ee*Ue+Se*it,t[8]=P*Ze+H*yt+se*Kt,t[9]=I*Ze+ie*yt+fe*Kt,t[10]=U*Ze+X*yt+me*Kt,t[11]=W*Ze+ee*yt+Se*Kt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function yB(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],l=e[5],o=e[6],p=e[7],w=e[8],C=e[9],P=e[10],I=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+w*r,t[5]=l*i+C*r,t[6]=o*i+P*r,t[7]=p*i+I*r,t[8]=w*i-s*r,t[9]=C*i-l*r,t[10]=P*i-o*r,t[11]=I*i-p*r,t}function pY(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],l=e[1],o=e[2],p=e[3],w=e[8],C=e[9],P=e[10],I=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-w*r,t[1]=l*i-C*r,t[2]=o*i-P*r,t[3]=p*i-I*r,t[8]=s*r+w*i,t[9]=l*r+C*i,t[10]=o*r+P*i,t[11]=p*r+I*i,t}function _B(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],l=e[1],o=e[2],p=e[3],w=e[4],C=e[5],P=e[6],I=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+w*r,t[1]=l*i+C*r,t[2]=o*i+P*r,t[3]=p*i+I*r,t[4]=w*i-s*r,t[5]=C*i-l*r,t[6]=P*i-o*r,t[7]=I*i-p*r,t}function gY(t,e){var n=e[0],r=e[1],i=e[2],s=e[4],l=e[5],o=e[6],p=e[8],w=e[9],C=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(s,l,o),t[2]=Math.hypot(p,w,C),t}function mY(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n+n,o=r+r,p=i+i,w=n*l,C=r*l,P=r*o,I=i*l,U=i*o,W=i*p,H=s*l,ie=s*o,X=s*p;return t[0]=1-P-W,t[1]=C+X,t[2]=I-ie,t[3]=0,t[4]=C-X,t[5]=1-w-W,t[6]=U+H,t[7]=0,t[8]=I+ie,t[9]=U-H,t[10]=1-w-P,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function yY(t,e,n,r,i,s,l){var o=1/(n-e),p=1/(i-r),w=1/(s-l);return t[0]=s*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*p,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(i+r)*p,t[10]=(l+s)*w,t[11]=-1,t[12]=0,t[13]=0,t[14]=l*s*2*w,t[15]=0,t}function _Y(t,e,n,r,i){var s=1/Math.tan(e/2),l;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(l=1/(r-i),t[10]=(i+r)*l,t[14]=2*i*r*l):(t[10]=-1,t[14]=-2*r),t}var vY=_Y;function xY(t,e,n,r,i,s,l){var o=1/(e-n),p=1/(r-i),w=1/(s-l);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*p,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*w,t[11]=0,t[12]=(e+n)*o,t[13]=(i+r)*p,t[14]=(l+s)*w,t[15]=1,t}var wY=xY;function bY(t,e,n,r){var i,s,l,o,p,w,C,P,I,U,W=e[0],H=e[1],ie=e[2],X=r[0],ee=r[1],se=r[2],fe=n[0],me=n[1],Se=n[2];return Math.abs(W-fe)<yg&&Math.abs(H-me)<yg&&Math.abs(ie-Se)<yg?cY(t):(C=W-fe,P=H-me,I=ie-Se,U=1/Math.hypot(C,P,I),C*=U,P*=U,I*=U,i=ee*I-se*P,s=se*C-X*I,l=X*P-ee*C,U=Math.hypot(i,s,l),U?(U=1/U,i*=U,s*=U,l*=U):(i=0,s=0,l=0),o=P*l-I*s,p=I*i-C*l,w=C*s-P*i,U=Math.hypot(o,p,w),U?(U=1/U,o*=U,p*=U,w*=U):(o=0,p=0,w=0),t[0]=i,t[1]=o,t[2]=C,t[3]=0,t[4]=s,t[5]=p,t[6]=P,t[7]=0,t[8]=l,t[9]=w,t[10]=I,t[11]=0,t[12]=-(i*W+s*H+l*ie),t[13]=-(o*W+p*H+w*ie),t[14]=-(C*W+P*H+I*ie),t[15]=1,t)}function EY(){var t=new dA(4);return dA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function TY(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function nS(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function SY(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function CY(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function MY(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n*n+r*r+i*i+s*s;return l>0&&(l=1/Math.sqrt(l)),t[0]=n*l,t[1]=r*l,t[2]=i*l,t[3]=s*l,t}function PY(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function kY(t,e,n,r){var i=e[0],s=e[1],l=e[2],o=e[3];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=l+r*(n[2]-l),t[3]=o+r*(n[3]-o),t}function Fd(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*l,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*l,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*l,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*l,t}function IY(t,e,n){var r=e[0],i=e[1],s=e[2],l=n[0],o=n[1],p=n[2],w=n[3],C=w*r+o*s-p*i,P=w*i+p*r-l*s,I=w*s+l*i-o*r,U=-l*r-o*i-p*s;return t[0]=C*w+U*-l+P*-p-I*-o,t[1]=P*w+U*-o+I*-l-C*-p,t[2]=I*w+U*-p+C*-o-P*-l,t[3]=e[3],t}(function(){var t=EY();return function(e,n,r,i,s,l){var o,p;for(n||(n=4),r||(r=0),i?p=Math.min(i*n+r,e.length):p=e.length,o=r;o<p;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,l),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var C3;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(C3||(C3={}));const LY=45*Math.PI/180,DY=1,gw=.1,mw=500,RY=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class la extends mB{static get IDENTITY(){return zY()}static get ZERO(){return BY()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return C3}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,l,o,p,w,C,P,I,U,W,H,ie){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=l,this[6]=o,this[7]=p,this[8]=w,this[9]=C,this[10]=P,this[11]=I,this[12]=U,this[13]=W,this[14]=H,this[15]=ie,this.check()}setRowMajor(e,n,r,i,s,l,o,p,w,C,P,I,U,W,H,ie){return this[0]=e,this[1]=s,this[2]=w,this[3]=U,this[4]=n,this[5]=l,this[6]=C,this[7]=W,this[8]=r,this[9]=o,this[10]=P,this[11]=H,this[12]=i,this[13]=p,this[14]=I,this[15]=ie,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(RY)}fromObject(e){return this.check()}fromQuaternion(e){return mY(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:l=gw,far:o=mw}=e;return o===1/0?OY(this,n,r,i,s,l):yY(this,n,r,i,s,l,o),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return bY(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:l=gw,far:o=mw}=e;return wY(this,n,r,i,s,l,o),this.check()}orthographic(e){const{fovy:n=LY,aspect:r=DY,focalDistance:i=1,near:s=gw,far:l=mw}=e;kP(n);const o=n/2,p=i*Math.tan(o),w=p*r;return this.ortho({left:-w,right:w,bottom:-p,top:p,near:s,far:l})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return kP(n),vY(this,n,r,i,s),this.check()}determinant(){return fY(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],l=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*l,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*l,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],l=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*l,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*l,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*l,e}transpose(){return hY(this,this),this.check()}invert(){return S3(this,this),this.check()}multiplyLeft(e){return nf(this,e,this),this.check()}multiplyRight(e){return nf(this,this,e),this.check()}rotateX(e){return yB(this,this,e),this.check()}rotateY(e){return pY(this,this,e),this.check()}rotateZ(e){return _B(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return dY(this,this,e,n),this.check()}scale(e){return tS(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return B_(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Fd(n||[-0,-0,-0,-0],e,this),mg(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=FZ(n||[-0,-0],e,this);break;case 3:i=JT(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return mg(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=UZ(n||[-0,-0],e,this);break;case 3:r=AB(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return mg(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let U1,V1;function BY(){return U1||(U1=new la([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(U1)),U1}function zY(){return V1||(V1=new la,Object.freeze(V1)),V1}function kP(t){if(t>Math.PI*2)throw Error("expected radians")}function OY(t,e,n,r,i,s){const l=2*s/(n-e),o=2*s/(i-r),p=(n+e)/(n-e),w=(i+r)/(i-r),C=-1,P=-1,I=-2*s;return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=p,t[9]=w,t[10]=C,t[11]=P,t[12]=0,t[13]=0,t[14]=I,t[15]=0,t}function IP(){var t=new dA(4);return dA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function FY(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function vB(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function LP(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=n[0],p=n[1],w=n[2],C=n[3];return t[0]=r*C+l*o+i*w-s*p,t[1]=i*C+l*p+s*o-r*w,t[2]=s*C+l*w+r*p-i*o,t[3]=l*C-r*o-i*p-s*w,t}function NY(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],l=e[3],o=Math.sin(n),p=Math.cos(n);return t[0]=r*p+l*o,t[1]=i*p+s*o,t[2]=s*p-i*o,t[3]=l*p-r*o,t}function UY(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],l=e[3],o=Math.sin(n),p=Math.cos(n);return t[0]=r*p-s*o,t[1]=i*p+l*o,t[2]=s*p+r*o,t[3]=l*p-i*o,t}function VY(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],l=e[3],o=Math.sin(n),p=Math.cos(n);return t[0]=r*p+i*o,t[1]=i*p-r*o,t[2]=s*p+l*o,t[3]=l*p-s*o,t}function GY(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Dy(t,e,n,r){var i=e[0],s=e[1],l=e[2],o=e[3],p=n[0],w=n[1],C=n[2],P=n[3],I,U,W,H,ie;return U=i*p+s*w+l*C+o*P,U<0&&(U=-U,p=-p,w=-w,C=-C,P=-P),1-U>yg?(I=Math.acos(U),W=Math.sin(I),H=Math.sin((1-r)*I)/W,ie=Math.sin(r*I)/W):(H=1-r,ie=r),t[0]=H*i+ie*p,t[1]=H*s+ie*w,t[2]=H*l+ie*C,t[3]=H*o+ie*P,t}function $Y(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n*n+r*r+i*i+s*s,o=l?1/l:0;return t[0]=-n*o,t[1]=-r*o,t[2]=-i*o,t[3]=s*o,t}function jY(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function xB(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,l=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[s*3+s]-e[l*3+l]+1),t[i]=.5*r,r=.5/r,t[3]=(e[s*3+l]-e[l*3+s])*r,t[s]=(e[s*3+i]+e[i*3+s])*r,t[l]=(e[l*3+i]+e[i*3+l])*r}return t}var HY=TY,WY=nS,QY=PY,qY=kY,ZY=SY,YY=CY,wB=MY,XY=function(){var t=cB(),e=CP(1,0,0),n=CP(0,1,0);return function(r,i,s){var l=hB(i,s);return l<-.999999?(Ly(t,e,i),gB(t)<1e-6&&Ly(t,n,i),qZ(t,t),vB(r,t,Math.PI),r):l>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Ly(t,i,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+l,wB(r,r))}}();(function(){var t=IP(),e=IP();return function(n,r,i,s,l,o){return Dy(t,r,l,o),Dy(e,i,s,o),Dy(n,t,e,2*o*(1-o)),n}})();(function(){var t=tY();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],wB(e,xB(e,t))}})();const KY=[0,0,0,1];class DP extends KT{constructor(e=0,n=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return xB(this,e),this.check()}fromAxisRotation(e,n){return vB(this,e,n),this.check()}identity(){return FY(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Wr(e)}get y(){return this[1]}set y(e){this[1]=Wr(e)}get z(){return this[2]}set z(e){this[2]=Wr(e)}get w(){return this[3]}set w(e){this[3]=Wr(e)}len(){return ZY(this)}lengthSquared(){return YY(this)}dot(e){return QY(this,e)}rotationTo(e,n){return XY(this,e,n),this.check()}add(e){return HY(this,this,e),this.check()}calculateW(){return GY(this,this),this.check()}conjugate(){return jY(this,this),this.check()}invert(){return $Y(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(qY(this,e,n,r),this.check())}multiplyRight(e){return LP(this,this,e),this.check()}multiplyLeft(e){return LP(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return NY(this,this,e),this.check()}rotateY(e){return UY(this,this,e),this.check()}rotateZ(e){return VY(this,this,e),this.check()}scale(e){return WY(this,this,e),this.check()}slerp(e,n,r){let i,s,l;switch(arguments.length){case 1:({start:i=KY,target:s,ratio:l}=e);break;case 2:i=this,s=e,l=n;break;default:i=e,s=n,l=r}return Dy(this,i,s,l),this.check()}transformVector4(e,n=new eS){return IY(n,e,this),mg(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const bB={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},RP=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,JY={lightSources:{}};function yw(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function eX(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=yw(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,l)=>{i["lighting_uPointLight[".concat(l,"].color")]=yw(s),i["lighting_uPointLight[".concat(l,"].position")]=s.position,i["lighting_uPointLight[".concat(l,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,l)=>{i["lighting_uDirectionalLight[".concat(l,"].color")]=yw(s),i["lighting_uDirectionalLight[".concat(l,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function EB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:JY;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},eX({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return EB({lightSources:e})}return{}}const TB={name:"lights",vs:RP,fs:RP,getUniforms:EB,defines:{MAX_LIGHTS:3}},tX=new Uint8Array([0,255,255,255]),nX={pickingSelectedColor:null,pickingHighlightColor:tX,pickingActive:!1,pickingAttribute:!1};function rX(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:nX;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const iX=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,sX=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,oX={name:"picking",vs:iX,fs:sX,getUniforms:rX},SB=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,aX={};function lX(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function CB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:aX;if(!("material"in t))return{};const{material:e}=t;return e?lX(e):{lighting_uEnabled:!1}}const AX={name:"gouraud-lighting",dependencies:[TB],vs:SB,defines:{LIGHTING_VERTEX:1},getUniforms:CB},uX={name:"phong-lighting",dependencies:[TB],fs:SB,defines:{LIGHTING_FRAGMENT:1},getUniforms:CB},cX=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,hX={name:"transform",vs:cX,fs:null};class Cm{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Cm(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:l=[],bufferMode:o=35981,transpileToGLSL100:p=!1}=e,w=this._getModuleList(e.modules),C=this._getHash(n),P=this._getHash(r),I=w.map(se=>this._getHash(se.name)).sort(),U=l.map(se=>this._getHash(se)),W=Object.keys(i).sort(),H=Object.keys(s).sort(),ie=[],X=[];for(const se of W)ie.push(this._getHash(se)),ie.push(this._getHash(i[se]));for(const se of H)X.push(this._getHash(se)),X.push(this._getHash(s[se]));const ee="".concat(C,"/").concat(P,"D").concat(ie.join("/"),"M").concat(I.join("/"),"I").concat(X.join("/"),"V").concat(U.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(p?"T":"");if(!this._programCache[ee]){const se=hZ(this.gl,{vs:n,fs:r,modules:w,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:p});this._programCache[ee]=new XR(this.gl,{hash:ee,vs:se.vs,fs:se.fs,varyings:l,bufferMode:o}),this._getUniforms[ee]=se.getUniforms||(fe=>{}),this._useCounts[ee]=0}return this._useCounts[ee]++,this._programCache[ee]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,l=this._defaultModules.length;s<l;++s){const o=this._defaultModules[s],p=o.name;n[i++]=o,r[p]=!0}for(let s=0,l=e.length;s<l;++s){const o=e[s],p=o.name;r[p]||(n[i++]=o,r[p]=!0)}return n.length=i,n}}const fX={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function dX(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const l=e.attributes[s],o=pX(s,n);if(s==="indices")i=l;else if(l.constant)r[o]=l.value;else{const p=l.value,w={...l};delete w.value,r[o]=[new Vr(t,p),w],gX(s,w)}}if(i){const s=i.value||i;nn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const l={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new Vr(t,{data:s,target:34963}),l]}return r}function pX(t,e){const{attributeMap:n=fX}=e||{};return n&&n[t]||t}function gX(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}nn(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const A0=2,mX=1e4,yX="Model needs drawMode and vertexCount",BP=()=>{},_X={};class sc{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=gh("model")}=n;nn(nv(e)),this.id=r,this.gl=e,this.id=n.id||gh("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Cm.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:p,bufferMode:w,transpileToGLSL100:C}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:p,bufferMode:w,transpileToGLSL100:C},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},nn(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),yX)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:p,bufferMode:w,transpileToGLSL100:C}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:p,bufferMode:w,transpileToGLSL100:C},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return nn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return nn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=dX(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(pd(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return QT(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:l=this.transformFeedback,parameters:o={},vertexArray:p=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let w;vn.priority>=A0&&(w=this._logDrawCallStart(A0));const C=this.vertexArray.getDrawParams(),{isIndexed:P=C.isIndexed,indexType:I=C.indexType,indexOffset:U=C.indexOffset,vertexArrayInstanced:W=C.isInstanced}=this.props;W&&!this.isInstanced&&vn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:H,instanceCount:ie}=this,{onBeforeRender:X=BP,onAfterRender:ee=BP}=this.props;X(),this.program.setUniforms(this.uniforms);const se=this.program.draw(Object.assign(_X,e,{logPriority:w,uniforms:null,framebuffer:r,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:p,transformFeedback:l,isIndexed:P,indexType:I,isInstanced:H,instanceCount:ie,offset:P?U:0}));return ee(),vn.priority>=A0&&this._logDrawCallEnd(w,p,r),se}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{35977:n})),i.forEach(l=>l.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(l=>l.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return vn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:l,defines:o,varyings:p,bufferMode:w,transpileToGLSL100:C}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:l,defines:o,varyings:p,bufferMode:w,transpileToGLSL100:C}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}nn(n instanceof XR,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Tq(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof Vr&&n.delete()}}_setAnimationProps(e){this.animated&&nn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(pd(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new KR(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:mX;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),vn.group(A0,">>> DRAWING MODEL ".concat(this.id),{collapsed:vn.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=Mq({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:l,unusedTable:o,unusedCount:p}=gP({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:w,count:C}=gP({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});C>0&&vn.log("MISSING UNIFORMS",Object.keys(w))(),p>0&&vn.log("UNUSED UNIFORMS",Object.keys(o))();const P=kq(this.vertexArray.configuration);vn.table(e,s)(),vn.table(e,l)(),vn.table(e+1,P)(),i&&i.log({logLevel:A0,message:"Rendered to ".concat(i.id)}),vn.groupEnd(A0)()}}class vX{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof Vr?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&nn(cr(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const l=n[s],{byteLength:o,usage:p,accessor:w}=l;r[i]=this._createNewBuffer(i,{byteLength:o,usage:p,accessor:w})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new KR(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],nn(r[s]instanceof Vr)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new Vr(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const xX="transform_uSampler_",z_="transform_uSize_",zP="transform_position";function wX(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,l=Object.keys(n).length,o=null;const p={};let w=e,C={};if(l>0||r){const P=w.split(`
`),I=P.slice();if(P.forEach((U,W,H)=>{if(l>0){const ie=CX(U,n);if(ie){const{updatedLine:X,inject:ee}=ie;I[W]=X,C=x3([C,ee]),Object.assign(p,ie.samplerTextureMap),l--}}r&&!o&&(o=SX(U,r))}),r){nn(i);const U="".concat(z_).concat(r),W="uniform vec2 ".concat(U,`;
`),H="     vec2 ".concat(zP," = transform_getPos(").concat(U,`);
     gl_Position = vec4(`).concat(zP,`, 0, 1.);
`);C=x3([C,{"vs:#decl":W,"vs:#main-start":H}])}w=I.join(`
`)}return{vs:w,targetTextureType:o,inject:C,samplerTextureMap:p}}function bX(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,l;n&&({width:s,height:l}=r,i["".concat(z_).concat(n)]=[s,l]);for(const o in e)({width:s,height:l}=e[o]),i["".concat(z_).concat(o)]=[s,l];return i}function EX(t){return sB(t,["attribute","in"])}function TX(t){const e="".concat(xX).concat(t),n="".concat(z_).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function SX(t,e){const n=sB(t,["varying","out"]);return n&&n.name===e?n.type:null}function CX(t,e){const n={},r=EX(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const l="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:o,sizeName:p,uniformDeclerations:w}=TX(s),C=xZ(i),P="  ".concat(i," ").concat(s," = transform_getInput(").concat(o,", ").concat(p,").").concat(C,`;
`);return n[o]=s,{updatedLine:l,inject:{"vs:#decl":w,"vs:#main-start":P},samplerTextureMap:n}}return null}const MX={10241:9728,10240:9728,10242:33071,10243:33071},PX="transform_output";class kX{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],l=Object.assign({},n,e.attributes),o=Object.assign({},e.uniforms),p=Object.assign({},e.parameters);let w=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){l.transform_elementID=this.elementIDBuffer;for(const P in this.samplerTextureMap){const I=this.samplerTextureMap[P];o[P]=r[I]}this._setSourceTextureParameters();const C=bX({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(o,C)}return this.hasTargetTexture&&(w=!1,p.viewport=[0,0,i.width,i.height]),{attributes:l,framebuffer:i,uniforms:o,discard:w,parameters:p}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=iv(n);if(!e)return r;const i=r.constructor,s=wZ(this.targetTextureType),l=new i(r.length*s/4);let o=0;for(let p=0;p<r.length;p+=4)for(let w=0;w<s;w++)l[o++]=r[p+w];return l}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof ca)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new Vr(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:l,height:o}=s,{framebuffer:p}=e;p?(p.update({attachments:{36064:s},resizeAttachments:!1}),p.resize({width:l,height:o})):e.framebuffer=new is(this.gl,{id:"transform-framebuffer",width:l,height:o,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(MX)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=dQ(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:l,inject:o,samplerTextureMap:p}=wX({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),w=x3([e.inject||{},o]);this.targetTextureType=l,this.samplerTextureMap=p;const C=e._fs||oB({version:ZR(i),input:this.targetTextureVarying,inputType:l,output:PX}),P=this.hasSourceTextures||this.targetTextureVarying?[hX].concat(e.modules||[]):e.modules;return{vs:i,fs:C,modules:P,uniforms:s,inject:w}}}let rS=class{static isSupported(e){return cr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();nn(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new sc(n,Object.assign({},e,{fs:e.fs||oB({version:ZR(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){IX(n)&&(this.bufferTransform=new vX(e,n)),LX(n)&&(this.textureTransform=new kX(e,n)),nn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}};function IX(t){return!!(!pd(t.feedbackBuffers)||!pd(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function LX(t){return!!(!pd(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const OP={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Yu{static get DRAW_MODE(){return OP}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=gh("geometry"),drawMode:r=OP.TRIANGLES,attributes:i={},indices:s=null,vertexCount:l=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=l||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,nn(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(nn(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:l,size:o,constant:p}=s;!p&&l&&o>=1&&(r=Math.min(r,l.length/o))}return nn(Number.isFinite(r)),r}}let DX=1,RX=1;class MB{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,l=DX++,o={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(o,this.time),this.channels.set(l,o),l}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:l}=i;s.setTime(this.getTime(l))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=RX++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const BX=[255,255,255],zX=1;let OX=0;class PB{constructor(e={}){oe(this,"id",void 0),oe(this,"color",void 0),oe(this,"intensity",void 0),oe(this,"type","ambient");const{color:n=BX}=e,{intensity:r=zX}=e;this.id=e.id||"ambient-".concat(OX++),this.color=n,this.intensity=r}}const FX=[255,255,255],NX=1,UX=[0,0,-1];let VX=0;class M3{constructor(e={}){oe(this,"id",void 0),oe(this,"color",void 0),oe(this,"intensity",void 0),oe(this,"type","directional"),oe(this,"direction",void 0),oe(this,"shadow",void 0);const{color:n=FX}=e,{intensity:r=NX}=e,{direction:i=UX}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(VX++),this.color=n,this.intensity=r,this.type="directional",this.direction=new An(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class GX{constructor(e,n={id:"pass"}){oe(this,"id",void 0),oe(this,"gl",void 0),oe(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class iS extends GX{constructor(...e){super(...e),oe(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return ic(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:l,clearStack:o=!0,clearCanvas:p=!0}=e;e.pass=e.pass||"unknown";const w=this.gl;p&&jX(w,n),o&&(this._lastRenderIndex=-1);const C=[];for(const P of i){const I=s&&s[P.id];l?.(P);const U=this._getDrawLayerParams(P,e),W=P.subViewports||[P];for(const H of W){const ie=this._drawLayersInViewport(w,{target:n,moduleParameters:r,viewport:H,view:I,pass:e.pass,layers:e.layers},U);C.push(ie)}}return C}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:l,effects:o,moduleParameters:p},w=!1){const C=[],P=kB(this._lastRenderIndex+1),I={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:l},U={};for(let W=0;W<n.length;W++){const H=n[W],ie=this._shouldDrawLayer(H,I,s,U),X={shouldDrawLayer:ie};ie&&!w&&(X.layerRenderIndex=P(H,ie),X.moduleParameters=this._getModuleParameters(H,o,r,p),X.layerParameters=this.getLayerParameters(H,W,e)),C[W]=X}return C}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:l,view:o},p){const w=$X(e,{moduleParameters:r,target:s,viewport:l});if(o&&o.props.clear){const P=o.props.clear===!0?{color:!0,depth:!0}:o.props.clear;hA(e,{scissorTest:!0,scissor:w},()=>QT(e,P))}const C={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};ic(e,{viewport:w});for(let P=0;P<n.length;P++){const I=n[P],{shouldDrawLayer:U,layerRenderIndex:W,moduleParameters:H,layerParameters:ie}=p[P];if(U&&I.props.pickable&&C.pickableCount++,I.isComposite)C.compositeCount++;else if(U){C.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,W),H.viewport=l;try{I._drawLayer({moduleParameters:H,uniforms:{layerIndex:W},parameters:ie})}catch(X){I.raiseError(X,"drawing ".concat(I," to ").concat(i))}}}return C}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let l=e.parent;for(;l;){if(!l.props.visible||!l.filterSubLayer(n))return!1;n.layer=l,l=l.parent}if(r){const o=n.layer.id;if(o in i||(i[o]=r(n)),!i[o])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const l=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:dd(this.gl)});if(n)for(const p of n){var o;Object.assign(l,(o=p.getModuleParameters)===null||o===void 0?void 0:o.call(p,e))}return Object.assign(l,this.getModuleParameters(e,n),i)}}function kB(t=0,e={}){const n={},r=(i,s)=>{const l=i.props._offset,o=i.id,p=i.parent&&i.parent.id;let w;if(p&&!(p in e)&&r(i.parent,!1),p in n){const C=n[p]=n[p]||kB(e[p],e);w=C(i,s),n[o]=C}else Number.isFinite(l)?(w=l+(e[p]||0),n[o]=null):w=t;return s&&w>=t&&(t=w+1),e[o]=w,w};return r}function $X(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||dd(t),l=i?n.height:t.drawingBufferHeight,o=r;return[o.x*s,l-(o.y+o.height)*s,o.width*s,o.height*s]}function jX(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;ic(t,{viewport:[0,0,n,r]}),t.clear(16640)}class HX extends iS{constructor(e,n){super(e,n),oe(this,"shadowMap",void 0),oe(this,"depthBuffer",void 0),oe(this,"fbo",void 0),this.shadowMap=new ca(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new M0(e,{format:33189,width:1,height:1}),this.fbo=new is(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;hA(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=dd(this.gl),s=r.width*i,l=r.height*i;(s!==n.width||l!==n.height)&&n.resize({width:s,height:l}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const IB="#define SMOOTH_EDGE_RADIUS 0.5",WX=`
`.concat(IB,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),QX=`
`.concat(IB,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),qX={name:"geometry",vs:WX,fs:QX},ZX=Object.keys(ur).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(ur[t],";")).join(""),YX=Object.keys(rA).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(rA[t],";")).join(""),XX=Object.keys(cf).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(cf[t],";")).join(""),KX="".concat(ZX,`
`).concat(YX,`
`).concat(XX,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function JX(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Mm(t){let e={},n;return r=>{for(const i in r)if(!JX(r[i],e[i])){n=t(r),e=r;break}return n}}const FP=[0,0,0,0],eK=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],LB=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],tK=[0,0,0],DB=[0,0,0],nK=Mm(sK);function RB(t,e,n=DB){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===ur.LNGLAT_OFFSETS||e===ur.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case rA.WEB_MERCATOR:(e===ur.LNGLAT||e===ur.CARTESIAN)&&(i=[0,0,0],s=!1);break;case rA.WEB_MERCATOR_AUTO_OFFSET:e===ur.LNGLAT?r=i:e===ur.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case rA.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case rA.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function rK(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:l}=t,o=FP,p=FP,w=t.cameraPosition;const{geospatialOrigin:C,shaderCoordinateOrigin:P,offsetMode:I}=RB(t,e,n);return I&&(p=t.projectPosition(C||P),w=[w[0]-p[0],w[1]-p[1],w[2]-p[2]],p[3]=1,o=Fd([],p,l),s=r||s,l=nf([],i,s),l=nf([],l,eK)),{viewMatrix:s,viewProjectionMatrix:l,projectionCenter:o,originCommon:p,cameraPosCommon:w,shaderCoordinateOrigin:P,geospatialOrigin:C}}function iK({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=ur.DEFAULT,coordinateOrigin:i=DB,autoWrapLongitude:s=!1}){r===ur.DEFAULT&&(r=t.isGeospatial?ur.LNGLAT:ur.CARTESIAN);const l=nK({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return l.project_uWrapLongitude=s,l.project_uModelMatrix=n||LB,l}function sK({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:l,cameraPosCommon:o,shaderCoordinateOrigin:p,geospatialOrigin:w}=rK(t,n,r),C=t.getDistanceScales(),P=[t.width*e,t.height*e],I=Fd([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,U={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:p,project_uCommonOrigin:l.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:P,project_uDevicePixelRatio:e,project_uFocalDistance:I,project_uCommonUnitsPerMeter:C.unitsPerMeter,project_uCommonUnitsPerWorldUnit:C.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:tK,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:LB,project_uCameraPosition:o};if(w){const W=t.getDistanceScales(w);switch(n){case ur.METER_OFFSETS:U.project_uCommonUnitsPerWorldUnit=W.unitsPerMeter,U.project_uCommonUnitsPerWorldUnit2=W.unitsPerMeter2;break;case ur.LNGLAT:case ur.LNGLAT_OFFSETS:t._pseudoMeters||(U.project_uCommonUnitsPerMeter=W.unitsPerMeter),U.project_uCommonUnitsPerWorldUnit=W.unitsPerDegree,U.project_uCommonUnitsPerWorldUnit2=W.unitsPerDegree2;break;case ur.CARTESIAN:U.project_uCommonUnitsPerWorldUnit=[1,1,W.unitsPerMeter[2]],U.project_uCommonUnitsPerWorldUnit2=[0,0,W.unitsPerMeter2[2]];break}}return U}const oK={};function aK(t=oK){return"viewport"in t?iK(t):{}}const sS={name:"project",dependencies:[TZ,qX],vs:KX,getUniforms:aK};function lK(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Y0(t,e){const n=Fd([],e,t);return nS(n,n,1/n[3]),n}function NP(t,e){const n=t%e;return n<0?e+n:n}function AK(t,e,n){return n*e+(1-n)*t}function P3(t,e,n){return t<e?e:t>n?n:t}function uK(t){return Math.log(t)*Math.LOG2E}const oS=Math.log2||uK;function oc(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const iA=Math.PI,BB=iA/4,wl=iA/180,k3=180/iA,md=512,O_=4003e4,G1=85.051129,cK=1.5;function UP(t){return Math.pow(2,t)}function zB(t){return oS(t)}function pA(t){const[e,n]=t;oc(Number.isFinite(e)),oc(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*wl,i=n*wl,s=md*(r+iA)/(2*iA),l=md*(iA+Math.log(Math.tan(BB+i*.5)))/(2*iA);return[s,l]}function df(t){const[e,n]=t,r=e/md*(2*iA)-iA,i=2*(Math.atan(Math.exp(n/md*(2*iA)-iA))-BB);return[r*k3,i*k3]}function hK(t){const{latitude:e}=t;oc(Number.isFinite(e));const n=Math.cos(e*wl);return zB(O_*n)-9}function Ry(t){const e=Math.cos(t*wl);return md/O_/e}function I3(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;oc(Number.isFinite(e)&&Number.isFinite(n));const i=md,s=Math.cos(e*wl),l=i/360,o=l/s,p=i/O_/s,w={unitsPerMeter:[p,p,p],metersPerUnit:[1/p,1/p,1/p],unitsPerDegree:[l,o,p],degreesPerUnit:[1/l,1/o,1/p]};if(r){const C=wl*Math.tan(e*wl)/s,P=l*C/2,I=i/O_*C,U=I/o*p;w.unitsPerDegree2=[0,P,I],w.unitsPerMeter2=[U,0,U]}return w}function OB(t,e){const[n,r,i]=t,[s,l,o]=e,{unitsPerMeter:p,unitsPerMeter2:w}=I3({longitude:n,latitude:r,highPrecision:!0}),C=pA(t);C[0]+=s*(p[0]+w[0]*l),C[1]+=l*(p[1]+w[1]*l);const P=df(C),I=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[P[0],P[1],I]:P}function fK(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:l}=t,o=lK();B_(o,o,[0,0,-i]),yB(o,o,-n*wl),_B(o,o,r*wl);const p=s/e;return tS(o,o,[p,p,p]),l&&B_(o,o,QZ([],l)),o}function dK(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:l,scale:o,nearZMultiplier:p=1,farZMultiplier:w=1}=t;let{fovy:C=F_(cK)}=t;r!==void 0&&(C=F_(r));const P=C*wl,I=i*wl,U=FB(C);let W=U;l&&(W+=l[2]*o/Math.cos(I)/n);const H=P*(.5+(s?s[1]:0)/n),ie=Math.sin(H)*W/Math.sin(P3(Math.PI/2-I-H,.01,Math.PI-.01)),X=Math.sin(I)*ie+W,ee=W*10,se=Math.min(X*w,ee);return{fov:P,aspect:e/n,focalDistance:U,near:p,far:se}}function F_(t){return 2*Math.atan(.5/t)*k3}function FB(t){return .5/Math.tan(.5*t*wl)}function NB(t,e){const[n,r,i=0]=t;return oc(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Y0(e,[n,r,i,1])}function aS(t,e,n=0){const[r,i,s]=t;if(oc(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return Y0(e,[r,i,s,1]);const l=Y0(e,[r,i,0,1]),o=Y0(e,[r,i,1,1]),p=l[2],w=o[2],C=p===w?0:((n||0)-p)/(w-p);return lB([],l,o,C)}function pK(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:l=[0,0]}=t,[[o,p],[w,C]]=r,P=gK(t.padding),I=pA([o,P3(C,-G1,G1)]),U=pA([w,P3(p,-G1,G1)]),W=[Math.max(Math.abs(U[0]-I[0]),i),Math.max(Math.abs(U[1]-I[1]),i)],H=[e-P.left-P.right-Math.abs(l[0])*2,n-P.top-P.bottom-Math.abs(l[1])*2];oc(H[0]>0&&H[1]>0);const ie=H[0]/W[0],X=H[1]/W[1],ee=(P.right-P.left)/2/ie,se=(P.top-P.bottom)/2/X,fe=[(U[0]+I[0])/2+ee,(U[1]+I[1])/2+se],me=df(fe),Se=Math.min(s,oS(Math.abs(Math.min(ie,X))));return oc(Number.isFinite(Se)),{longitude:me[0],latitude:me[1],zoom:Se}}function gK(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(oc(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const VP=Math.PI/180;function mK(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},l=i([0,r],s),o=i([n,r],s);let p,w;const C=t.fovy?.5*t.fovy*VP:Math.atan(.5/t.altitude),P=(90-t.pitch)*VP;return C>P-.01?(p=GP(t,0,e),w=GP(t,n,e)):(p=i([0,0],s),w=i([n,0],s)),[l,o,w,p]}function GP(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=Y0(r,[e,0,1,1]),s=Y0(r,[e,t.height,1,1]),o=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),p=lB([],i,s,o),w=df(p);return w.push(n),w}const $P=512;function yK(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:l,bearing:o=0}=t;(i<-180||i>180)&&(i=NP(i+180,360)-180),(o<-180||o>180)&&(o=NP(o+180,360)-180);const p=oS(n/$P);if(l<=p)l=p,s=0;else{const w=n/2/Math.pow(2,l),C=df([0,w])[1];if(s<C)s=C;else{const P=df([0,$P-w])[1];s>P&&(s=P)}}return{width:e,height:n,longitude:i,latitude:s,zoom:l,pitch:r,bearing:o}}const UB=.01,_K=["longitude","latitude","zoom"],VB={curve:1.414,speed:1.2};function vK(t,e,n,r){const{startZoom:i,startCenterXY:s,uDelta:l,w0:o,u1:p,S:w,rho:C,rho2:P,r0:I}=GB(t,e,r);if(p<UB){const fe={};for(const me of _K){const Se=t[me],He=e[me];fe[me]=AK(Se,He,n)}return fe}const U=n*w,W=Math.cosh(I)/Math.cosh(I+C*U),H=o*((Math.cosh(I)*Math.tanh(I+C*U)-Math.sinh(I))/P)/p,ie=1/W,X=i+zB(ie),ee=RZ([],l,H);E3(ee,ee,s);const se=df(ee);return{longitude:se[0],latitude:se[1],zoom:X}}function xK(t,e,n){const r={...VB,...n},{screenSpeed:i,speed:s,maxDuration:l}=r,{S:o,rho:p}=GB(t,e,r),w=1e3*o;let C;return Number.isFinite(i)?C=w/(i/p):C=w/s,Number.isFinite(l)&&C>l?0:C}function GB(t,e,n){n=Object.assign({},VB,n);const r=n.curve,i=t.zoom,s=[t.longitude,t.latitude],l=UP(i),o=e.zoom,p=[e.longitude,e.latitude],w=UP(o-i),C=pA(s),P=pA(p),I=NZ([],P,C),U=Math.max(t.width,t.height),W=U/w,H=BZ(I)*l,ie=Math.max(H,UB),X=r*r,ee=(W*W-U*U+X*X*ie*ie)/(2*U*X*ie),se=(W*W-U*U-X*X*ie*ie)/(2*W*X*ie),fe=Math.log(Math.sqrt(ee*ee+1)-ee),me=Math.log(Math.sqrt(se*se+1)-se),Se=(me-fe)/r;return{startZoom:i,startCenterXY:C,uDelta:I,w0:U,u1:H,S:Se,rho:r,rho2:X,r0:fe,r1:me}}const wK=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,bK=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,EK=Mm(PK),TK=Mm(kK),SK=[0,0,0,1],CK=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function MK(t,e){const[n,r,i]=t,s=aS([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function PK({viewport:t,center:e}){return new la(t.viewProjectionMatrix).invert().transform(e)}function kK({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(l=>MK(l,r));for(const l of e){const o=l.clone().translate(new An(t.center).negate()),p=s.map(C=>o.transform(C)),w=new la().ortho({left:Math.min(...p.map(C=>C[0])),right:Math.max(...p.map(C=>C[0])),bottom:Math.min(...p.map(C=>C[1])),top:Math.max(...p.map(C=>C[1])),near:Math.min(...p.map(C=>-C[2])),far:Math.max(...p.map(C=>-C[2]))});n.push(w.multiplyRight(l))}return n}function IK(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||SK,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=EK({viewport:t.viewport,center:e.project_uCenter}),s=[],l=TK({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let o=0;o<t.shadowMatrices.length;o++){const p=l[o],w=p.clone().translate(new An(t.viewport.center).negate());e.project_uCoordinateSystem===ur.LNGLAT&&e.project_uProjectionMode===rA.WEB_MERCATOR?(l[o]=w,s[o]=i):(l[o]=p.clone().multiplyRight(CK),s[o]=w.transform(i))}for(let o=0;o<l.length;o++)r["shadow_uViewProjectionMatrices[".concat(o,"]")]=l[o],r["shadow_uProjectCenters[".concat(o,"]")]=s[o],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(o)]=t.shadowMaps[o]:r["shadow_uShadowMap".concat(o)]=t.dummyShadowMap;return r}const _w={name:"shadow",dependencies:[sS],vs:wK,fs:bK,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?IK(t,e):{}},LK={color:[255,255,255],intensity:1},jP=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],DK=[0,0,0,200/255];class lS{constructor(e={}){oe(this,"id","lighting-effect"),oe(this,"props",void 0),oe(this,"shadowColor",DK),oe(this,"shadow",void 0),oe(this,"ambientLight",void 0),oe(this,"directionalLights",void 0),oe(this,"pointLights",void 0),oe(this,"shadowPasses",[]),oe(this,"shadowMaps",[]),oe(this,"dummyShadowMap",null),oe(this,"programManager",void 0),oe(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:l}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Cm.getDefaultProgramManager(e),_w&&this.programManager.addDefaultModule(_w)),this.dummyShadowMap||(this.dummyShadowMap=new ca(e,{width:1,height:1}));for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:l,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(_w),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new la().lookAt({eye:new An(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new HX(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new PB(LK),this.directionalLights.push(new M3(jP[0]),new M3(jP[1])))}}class RK{constructor(e={}){oe(this,"_pool",[]),oe(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:l=!1,initialize:o=!1,maxCount:p}){const w=i||e&&e.constructor||Float32Array,C=n*r+s;if(ArrayBuffer.isView(e)){if(C<=e.length)return e;if(C*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new w(e.buffer,0,C)}let P=1/0;p&&(P=p*r+s);const I=this._allocate(w,C,o,P);return e&&l?I.set(e):o||I.fill(0,0,4),this._release(e),I}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const l=this._pool,o=e.BYTES_PER_ELEMENT*s,p=l.findIndex(w=>w.byteLength>=o);if(p>=0){const w=new e(l.splice(p,1)[0],0,s);return r&&w.fill(0),w}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(l=>l.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const yd=new RK;function Yp(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function BK(t){return[t[12],t[13],t[14]]}function zK(t){return{left:u0(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:u0(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:u0(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:u0(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:u0(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:u0(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const HP=new An;function u0(t,e,n,r){HP.set(t,e,n);const i=HP.len();return{distance:r/i,normal:new An(-t/i,-e/i,-n/i)}}function OK(t){return t-Math.fround(t)}let Mp;function vw(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Mp=yd.allocate(Mp,s,{type:Float32Array,size:n*2});let l=r,o=0;for(;l<i;){for(let p=0;p<n;p++){const w=t[l++];Mp[o+p]=w,Mp[o+p+n]=OK(w)}o+=n*2}return Mp.subarray(0,s*n*2)}function FK(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const NK=Math.PI/180,UK=Yp(),WP=[0,0,0],VK={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function GK({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:l,far:o}){const p=t/e,w=n?new la().orthographic({fovy:r,aspect:p,focalDistance:i,near:l,far:o}):new la().perspective({fovy:r,aspect:p,near:l,far:o});if(s){const{left:C=0,right:P=0,top:I=0,bottom:U=0}=s,W=Kc((C+t-P)/2,0,t)-t/2,H=Kc((I+e-U)/2,0,e)-e/2;w[8]-=W*2/t,w[9]+=H*2/e}return w}class Rf{constructor(e={}){oe(this,"id",void 0),oe(this,"x",void 0),oe(this,"y",void 0),oe(this,"width",void 0),oe(this,"height",void 0),oe(this,"padding",void 0),oe(this,"isGeospatial",void 0),oe(this,"zoom",void 0),oe(this,"focalDistance",void 0),oe(this,"position",void 0),oe(this,"modelMatrix",void 0),oe(this,"distanceScales",void 0),oe(this,"scale",void 0),oe(this,"center",void 0),oe(this,"cameraPosition",void 0),oe(this,"projectionMatrix",void 0),oe(this,"viewMatrix",void 0),oe(this,"viewMatrixUncentered",void 0),oe(this,"viewMatrixInverse",void 0),oe(this,"viewProjectionMatrix",void 0),oe(this,"pixelProjectionMatrix",void 0),oe(this,"pixelUnprojectionMatrix",void 0),oe(this,"resolution",void 0),oe(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||VK,this.focalDistance=e.focalDistance||1,this.position=e.position||WP,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?rA.WEB_MERCATOR:rA.WEB_MERCATOR_AUTO_OFFSET:rA.IDENTITY}equals(e){return e instanceof Rf?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Zu(e.projectionMatrix,this.projectionMatrix)&&Zu(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=NB(r,this.pixelProjectionMatrix),[s,l]=i,o=n?l:this.height-l;return e.length===2?[s,o]:[s,o,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,l]=e,o=n?s:this.height-s,p=r&&r*this.distanceScales.unitsPerMeter[2],w=aS([i,o,l],this.pixelUnprojectionMatrix,p),[C,P,I]=this.unprojectPosition(w);return Number.isFinite(l)?[C,P,I]:Number.isFinite(r)?[C,P,r]:[C,P]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=pA(e);return n[1]=Kc(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?df(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),l=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],l[0]),Math.min(r[1],i[1],s[1],l[1]),Math.max(r[0],i[0],s[0],l[0]),Math.max(r[1],i[1],s[1],l[1])]}getDistanceScales(e){return e?I3({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,zK(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=hK({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||I3({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:l}=e;let o=WP;if(s&&(o=l?new la(l).transformAsVector(s,[]):s),this.isGeospatial){const p=this.projectPosition([n,r,0]);this.center=new An(o).scale(this.distanceScales.unitsPerMeter).add(p)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:n=UK,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:l=75,near:o=.1,far:p=1e3,padding:w=null,focalDistance:C=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new la().multiplyRight(n).translate(new An(this.center).negate()),this.projectionMatrix=r||GK({width:this.width,height:this.height,orthographic:i,fovyRadians:s||l*NK,focalDistance:C,padding:w,near:o,far:p});const P=Yp();nf(P,P,this.projectionMatrix),nf(P,P,this.viewMatrix),this.viewProjectionMatrix=P,this.viewMatrixInverse=S3([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=BK(this.viewMatrixInverse);const I=Yp(),U=Yp();tS(I,I,[this.width/2,-this.height/2,1]),B_(I,I,[1,-1,0]),nf(U,I,this.viewProjectionMatrix),this.pixelProjectionMatrix=U,this.pixelUnprojectionMatrix=S3(Yp(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||sr.warn("Pixel project matrix not invertible")()}}oe(Rf,"displayName","Viewport");class ac extends Rf{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:l=0,nearZMultiplier:o=.1,farZMultiplier:p=1.01,nearZ:w,farZ:C,orthographic:P=!1,projectionMatrix:I,repeat:U=!1,worldOffset:W=0,position:H,padding:ie,legacyMeterSizes:X=!1}=e;let{width:ee,height:se,altitude:fe=1.5}=e;const me=Math.pow(2,i);ee=ee||1,se=se||1;let Se,He=null;if(I)fe=I[5]/2,Se=F_(fe);else{e.fovy?(Se=e.fovy,fe=FB(Se)):Se=F_(fe);let Ke;if(ie){const{top:rt=0,bottom:Ue=0}=ie;Ke=[0,Kc((rt+se-Ue)/2,0,se)-se/2]}He=dK({width:ee,height:se,scale:me,center:H&&[0,0,H[2]*Ry(n)],offset:Ke,pitch:s,fovy:Se,nearZMultiplier:o,farZMultiplier:p}),Number.isFinite(w)&&(He.near=w),Number.isFinite(C)&&(He.far=C)}let Qe=fK({height:se,pitch:s,bearing:l,scale:me,altitude:fe});W&&(Qe=new la().translate([512*W,0,0]).multiplyLeft(Qe)),super({...e,width:ee,height:se,viewMatrix:Qe,longitude:r,latitude:n,zoom:i,...He,fovy:Se,focalDistance:fe}),oe(this,"longitude",void 0),oe(this,"latitude",void 0),oe(this,"pitch",void 0),oe(this,"bearing",void 0),oe(this,"altitude",void 0),oe(this,"fovy",void 0),oe(this,"orthographic",void 0),oe(this,"_subViewports",void 0),oe(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=l,this.altitude=fe,this.fovy=Se,this.orthographic=P,this._subViewports=U?[]:null,this._pseudoMeters=X,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new ac({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Ry(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Ry(r);return[n,r,i]}addMetersToLngLat(e,n){return OB(e,n)}panByPosition(e,n){const r=aS(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=E3([],i,zZ([],r)),l=E3([],this.center,s),[o,p]=this.unprojectFlat(l);return{longitude:o,latitude:p}}getBounds(e={}){const n=mK(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:l,zoom:o}=pK({width:r,height:i,bounds:e,...n});return new ac({width:r,height:i,longitude:s,latitude:l,zoom:o})}}oe(ac,"displayName","WebMercatorViewport");const QP=[0,0,0];function xw(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof ac){const[i,s,l=0]=t,o=e.getDistanceScales([i,s]);r[2]=l*o.unitsPerMeter[2]}return r}function $K(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:l}=t;return i===ur.DEFAULT&&(i=e.isGeospatial?ur.LNGLAT:ur.CARTESIAN),s===void 0&&(s=i),l===void 0&&(l=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:l}}function $B(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[l,o,p=0]=t;switch(n&&([l,o,p]=Fd([],[l,o,p,1],n)),r){case ur.LNGLAT:return xw([l,o,p],e,s);case ur.LNGLAT_OFFSETS:return xw([l+i[0],o+i[1],p+(i[2]||0)],e,s);case ur.METER_OFFSETS:return xw(OB(i,[l,o,p]),e,s);case ur.CARTESIAN:default:return e.isGeospatial?[l+i[0],o+i[1],p+i[2]]:e.projectPosition([l,o,p])}}function jK(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:l,fromCoordinateOrigin:o}=$K(e),{autoOffset:p=!0}=e,{geospatialOrigin:w=QP,shaderCoordinateOrigin:C=QP,offsetMode:P=!1}=p?RB(n,r,i):{},I=$B(t,{viewport:n,modelMatrix:s,coordinateSystem:l,coordinateOrigin:o,offsetMode:P});if(P){const U=n.projectPosition(w||C);pB(I,I,U)}return I}const pf=Math.PI/180,HK=1e3*60*60*24,WK=2440588,QK=2451545,N_=pf*23.4397,qK=357.5291,ZK=.98560028,YK=280.147,XK=360.9856235;function KK(t,e,n){const r=pf*-n,i=pf*e,s=eJ(t),l=lJ(s),o=sJ(s,r)-l.rightAscension;return{azimuth:rJ(o,i,l.declination),altitude:iJ(o,i,l.declination)}}function qP(t,e,n){const{azimuth:r,altitude:i}=KK(t,e,n);return[Math.sin(r)*Math.cos(i),Math.cos(r)*Math.cos(i),-Math.sin(i)]}function JK(t){return(typeof t=="number"?t:t.getTime())/HK-.5+WK}function eJ(t){return JK(t)-QK}function tJ(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(N_)-Math.tan(e)*Math.sin(N_),Math.cos(n))}function nJ(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(N_)+Math.cos(e)*Math.sin(N_)*Math.sin(n))}function rJ(t,e,n){const r=t,i=e,s=n;return Math.atan2(Math.sin(r),Math.cos(r)*Math.sin(i)-Math.tan(s)*Math.cos(i))}function iJ(t,e,n){const r=t,i=e,s=n;return Math.asin(Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos(r))}function sJ(t,e){return pf*(YK+XK*t)-e}function oJ(t){return pf*(qK+ZK*t)}function aJ(t){const e=t,n=pf*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e)),r=pf*102.9372;return e+n+r+Math.PI}function lJ(t){const e=oJ(t),n=aJ(e);return{declination:nJ(n,0),rightAscension:tJ(n,0)}}class AJ extends M3{constructor(e){super(e),oe(this,"timestamp",void 0),this.timestamp=e.timestamp}getProjectedLight({layer:e}){const{viewport:n}=e.context;if(n.resolution&&n.resolution>0){const[i,s,l]=qP(this.timestamp,0,0);this.direction=[i,-l,s]}else{const{latitude:i,longitude:s}=n;this.direction=qP(this.timestamp,i,s)}return this}}const ZP={blendFunc:[1,0,32771,0],blendEquation:32774};class jB extends iS{constructor(...e){super(...e),oe(this,"pickZ",void 0),oe(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:l,deviceRect:{x:o,y:p,width:w,height:C},cullRect:P,effects:I,pass:U="picking",pickZ:W,moduleParameters:H}){const ie=this.gl;this.pickZ=W;const X=this._resetColorEncoder(W),ee=hA(ie,{scissorTest:!0,scissor:[o,p,w,C],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...ZP,blend:!W},()=>super.render({target:l,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:P,effects:I?.filter(fe=>fe.useInPicking),pass:U,isPicking:!0,moduleParameters:H}));return this._colorEncoderState=null,{decodePickingColor:X&&cJ.bind(null,X),stats:ee}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:l}=e.props;return this._colorEncoderState?s&&l.includes("draw")&&(Object.assign(i,ZP),i.blend=!0,i.blendColor=uJ(this._colorEncoderState,e,r)):i.blend=!1,l.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function uJ(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,l=r.get(e);return l?(l.viewports.push(n),s=l.a):(s=r.size+1,s<=255?(l={a:s,layer:e,viewports:[n]},r.set(e,l),i[s]=l):(sr.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function cJ(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const p0={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},U_=Symbol.for("component"),hh=Symbol.for("propTypes"),ww=Symbol.for("deprecatedProps"),X0=Symbol.for("asyncPropDefaults"),gf=Symbol.for("asyncPropOriginal"),Jc=Symbol.for("asyncPropResolved");function mf(t,e=()=>!0){return Array.isArray(t)?HB(t,e,[]):e(t)?[t]:[]}function HB(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?HB(i,e,n):e(i)&&n.push(i)}return n}function hJ({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let l=0;for(let o=n;l<i;l++)t[o++]=e[l];for(;l<s;)l<s-l?(t.copyWithin(n+l,n,n+l),l*=2):(t.copyWithin(n+l,n,n+s-l),l=s);return t}function YP(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class XP{constructor(e,n){oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"sampleSize",1),oe(this,"time",void 0),oe(this,"count",void 0),oe(this,"samples",void 0),oe(this,"lastTiming",void 0),oe(this,"lastSampleTime",void 0),oe(this,"lastSampleCount",void 0),oe(this,"_count",0),oe(this,"_time",0),oe(this,"_samples",0),oe(this,"_startTime",0),oe(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=YP(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(YP()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class WB{constructor(e){oe(this,"id",void 0),oe(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof XP?this.stats[n]=e:this.stats[n]=new XP(n,r)),this.stats[n]}}class fJ{constructor(e,n,r){oe(this,"id",void 0),oe(this,"context",void 0),oe(this,"isLoaded",void 0),oe(this,"persistent",void 0),oe(this,"_loadCount",0),oe(this,"_subscribers",new Set),oe(this,"_data",void 0),oe(this,"_loader",void 0),oe(this,"_error",void 0),oe(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=M_(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class dJ{constructor({gl:e,protocol:n}){oe(this,"protocol",void 0),oe(this,"_context",void 0),oe(this,"_resources",void 0),oe(this,"_consumers",void 0),oe(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new fJ(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:l}=this;e.startsWith(l)&&(e=e.replace(l,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const o=s[e];if(this._track(r,i,o,n),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,l=s[e]=s[e]||{},o=l[n]||{},p=o.resourceId&&this._resources[o.resourceId];p&&(p.unsubscribe(o),this.prune()),r&&(l[n]=o,o.onChange=i,o.resourceId=r.id,r.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const pJ=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Bf={name:"project32",dependencies:[sS],vs:pJ},zf={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...oX},gJ=[sS],mJ=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function yJ(t){const e=Cm.getDefaultProgramManager(t);for(const n of gJ)e.addDefaultModule(n);for(const n of mJ)e.addShaderHook(n);return e}const _J="layerManager.setLayers",vJ="layerManager.activateViewport";class xJ{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){oe(this,"layers",void 0),oe(this,"context",void 0),oe(this,"resourceManager",void 0),oe(this,"_lastRenderedLayers",[]),oe(this,"_needsRedraw",!1),oe(this,"_needsUpdate",!1),oe(this,"_nextLayers",null),oe(this,"_debug",!1),oe(this,"activateViewport",l=>{lo(vJ,this,l),l&&(this.context.viewport=l)}),this.layers=[],this.resourceManager=new dJ({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&yJ(e),stats:r||new WB({id:"deck.gl"}),viewport:i||new Rf({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new MB,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){lo(_J,this,n,e),this._lastRenderedLayers=e;const r=mf(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const l of e)r[l.id]?sr.warn("Multiple old layers with same id ".concat(l.id))():r[l.id]=l;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const l of i)if(l.hasUniformTransition()){s="Uniform transition in ".concat(l);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&sr.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let l=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),l=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}l&&this._updateSublayersRecursively(l,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=p0.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=p0.MATCHED,n!==e&&(e.lifecycle=p0.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=p0.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=p0.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function sA(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!sA(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!sA(t[s],e[s],n-1))return!1;return!0}return!1}class wJ{constructor(e){oe(this,"width",void 0),oe(this,"height",void 0),oe(this,"views",void 0),oe(this,"viewState",void 0),oe(this,"controllers",void 0),oe(this,"timeline",void 0),oe(this,"_viewports",void 0),oe(this,"_viewportMap",void 0),oe(this,"_isUpdating",void 0),oe(this,"_needsRedraw",void 0),oe(this,"_needsUpdate",void 0),oe(this,"_eventManager",void 0),oe(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const l=r[s];if(l.containsPixel(i)){const o=e.slice();return o[0]-=l.x,o[1]-=l.y,l.unproject(o,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=mf(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!sA(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):sr.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var l;return(l=this.getView(e.id))===null||l===void 0?void 0:l.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const l={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,l)),i&&i.setProps(l),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],l=this.getViewState(s),o=s.makeViewport({viewState:l,width:this.width,height:this.height});let p=n[s.id];const w=!!s.controller;w&&!p&&(r=!0),(r||!w)&&p&&(p.finalize(),p=null),this.controllers[s.id]=this._updateController(s,l,o,p),o&&this._viewports.unshift(o)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const bJ=/([0-9]+\.?[0-9]*)(%|px)/;function Fc(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=bJ.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Nc(t,e){return t.relative?Math.round(t.position*e):t.position}function Fi(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class bl{constructor(e){oe(this,"id",void 0),oe(this,"viewportInstance",void 0),oe(this,"_x",void 0),oe(this,"_y",void 0),oe(this,"_width",void 0),oe(this,"_height",void 0),oe(this,"_padding",void 0),oe(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:l="100%",padding:o=null,viewportInstance:p}=e||{};Fi(!p||p instanceof Rf),this.viewportInstance=p,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Fc(r),this._y=Fc(i),this._width=Fc(s),this._height=Fc(l),this._padding=o&&{left:Fc(o.left||0),right:Fc(o.right||0),top:Fc(o.top||0),bottom:Fc(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&sA(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Nc(this._x,e),y:Nc(this._y,n),width:Nc(this._width,e),height:Nc(this._height,n)};return this._padding&&(r.padding={left:Nc(this._padding.left,e),top:Nc(this._padding.top,n),right:Nc(this._padding.right,e),bottom:Nc(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let Pm=class{constructor(e){oe(this,"_inProgress",void 0),oe(this,"_handle",void 0),oe(this,"_timeline",void 0),oe(this,"time",void 0),oe(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const KP=()=>{},L3={BREAK:1,SNAP_TO_END:2,IGNORE:3},EJ=t=>t,TJ=L3.BREAK;class SJ{constructor(e){oe(this,"getControllerState",void 0),oe(this,"props",void 0),oe(this,"propsInTransition",void 0),oe(this,"transition",void 0),oe(this,"onViewStateChange",void 0),oe(this,"onStateChange",void 0),oe(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:l,duration:o,easing:p}}=n,w=p(r/o),C=i.interpolateProps(s,l,w);this.propsInTransition=this.getControllerState({...this.props,...C}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Pm(e.timeline),this.onViewStateChange=e.onViewStateChange||KP,this.onStateChange=e.onStateChange||KP}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:l}=this.transition.settings;i={...r,...s===L3.SNAP_TO_END?l:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===L3.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,l=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(l===0)return;const o=s.initializeProps(e,i);this.propsInTransition={};const p={duration:l,easing:n.transitionEasing||EJ,interpolator:s,interruption:n.transitionInterruption||TJ,startProps:o.start,endProps:o.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(p),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(n)}}}class QB{constructor(e){oe(this,"_propsToCompare",void 0),oe(this,"_propsToExtract",void 0),oe(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Zu(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Fi(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const CJ=["longitude","latitude","zoom","bearing","pitch"],MJ=["longitude","latitude","zoom"];class qB extends QB{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:CJ,required:MJ},super(r.transitionProps),oe(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const l=i(e),o=i(n),p=l.unproject(s);r.start.around=s,Object.assign(r.end,{around:o.project(p),aroundPosition:p,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=xl(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,xl(e.around,n.around,r)))}return i}}const Uc={transitionDuration:0},PJ=300,$1=t=>1-(1-t)*(1-t),c0={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Oh={};class kJ{constructor(e){oe(this,"props",void 0),oe(this,"state",{}),oe(this,"transitionManager",void 0),oe(this,"eventManager",void 0),oe(this,"onViewStateChange",void 0),oe(this,"onStateChange",void 0),oe(this,"makeViewport",void 0),oe(this,"_controllerState",void 0),oe(this,"_events",{}),oe(this,"_interactionState",{isDragging:!1}),oe(this,"_customEvents",[]),oe(this,"_eventStartBlocked",null),oe(this,"_panMove",!1),oe(this,"invertPan",!1),oe(this,"dragMode","rotate"),oe(this,"inertia",0),oe(this,"scrollZoom",!0),oe(this,"dragPan",!0),oe(this,"dragRotate",!0),oe(this,"doubleClickZoom",!0),oe(this,"touchZoom",!0),oe(this,"touchRotate",!1),oe(this,"keyboard",!0),this.transitionManager=new SJ({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?PJ:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:l=!0,touchZoom:o=!0,touchRotate:p=!1,keyboard:w=!0}=e,C=!!this.onViewStateChange;this.toggleEvents(c0.WHEEL,C&&r),this.toggleEvents(c0.PAN,C),this.toggleEvents(c0.PINCH,C&&(o||p)),this.toggleEvents(c0.TRIPLE_PAN,C&&p),this.toggleEvents(c0.DOUBLE_TAP,C&&l),this.toggleEvents(c0.KEYBOARD,C&&w),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=l,this.touchZoom=o,this.touchRotate=p,this.keyboard=w}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const l=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:l})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,Uc,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Uc,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:$1},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Uc,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:$1},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let l=2/(1+Math.exp(-Math.abs(s*r)));s<0&&l!==0&&(l=1/l);const o=this.controllerState.zoom({pos:n,scale:l});return this.updateViewport(o,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Uc,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Uc,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:$1},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Oh._startPinchRotation=e.rotation,Oh._lastPinchEvent=e,this.updateViewport(r,Uc,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Oh._startPinchRotation-r})}return this.updateViewport(n,Uc,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Oh._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Oh;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const l=Math.log2(e.scale),o=(l-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),p=Math.pow(2,l+o*n/2);s=s.zoom({pos:i,scale:p}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:$1},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Oh._startPinchRotation=null,Oh._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:l}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let p;const w={};switch(e.srcEvent.code){case"Minus":p=n?o.zoomOut(r).zoomOut(r):o.zoomOut(r),w.isZooming=!0;break;case"Equal":p=n?o.zoomIn(r).zoomIn(r):o.zoomIn(r),w.isZooming=!0;break;case"ArrowLeft":n?(p=o.rotateLeft(s),w.isRotating=!0):(p=o.moveLeft(i),w.isPanning=!0);break;case"ArrowRight":n?(p=o.rotateRight(s),w.isRotating=!0):(p=o.moveRight(i),w.isPanning=!0);break;case"ArrowUp":n?(p=o.rotateUp(l),w.isRotating=!0):(p=o.moveUp(i),w.isPanning=!0);break;case"ArrowDown":n?(p=o.rotateDown(l),w.isRotating=!0):(p=o.moveDown(i),w.isPanning=!0);break;default:return!1}return this.updateViewport(p,this._getTransitionProps(),w),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Uc:e?{...n,transitionInterpolator:new qB({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class IJ{constructor(e,n){oe(this,"_viewportProps",void 0),oe(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const JP=5,LJ=1.2;class DJ extends IJ{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:l,bearing:o=0,pitch:p=0,altitude:w=1.5,position:C=[0,0,0],maxZoom:P=20,minZoom:I=0,maxPitch:U=60,minPitch:W=0,startPanLngLat:H,startZoomLngLat:ie,startRotatePos:X,startBearing:ee,startPitch:se,startZoom:fe,normalize:me=!0}=e;Fi(Number.isFinite(s)),Fi(Number.isFinite(i)),Fi(Number.isFinite(l)),super({width:n,height:r,latitude:i,longitude:s,zoom:l,bearing:o,pitch:p,altitude:w,maxZoom:P,minZoom:I,maxPitch:U,minPitch:W,normalize:me,position:C},{startPanLngLat:H,startZoomLngLat:ie,startRotatePos:X,startBearing:ee,startPitch:se,startZoom:fe}),oe(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:l}=this.getState();if(!i||s===void 0||l===void 0)return this;let o;return e?o=this._getNewRotation(e,i,l,s):o={bearing:s+n,pitch:l+r},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:l,minZoom:o}=this.getViewportProps();let p=i+Math.log2(r);p=Kc(p,o,l);const w=this.makeViewport({...this.getViewportProps(),zoom:p});return this._getUpdatedState({zoom:p,...w.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Kc(i,r,n);const{maxPitch:s,minPitch:l,pitch:o}=e;e.pitch=Kc(o,l,s);const{normalize:p=!0}=e;return p&&Object.assign(e,yK(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],l=e[1]-n[1],o=e[1],p=n[1],{width:w,height:C}=this.getViewportProps(),P=s/w;let I=0;l>0?Math.abs(C-p)>JP&&(I=l/(p-C)*LJ):l<0&&p>JP&&(I=1-o/p),I=Kc(I,-1,1);const{minPitch:U,maxPitch:W}=this.getViewportProps(),H=i+180*P;let ie=r;return I>0?ie=r+I*(W-r):I<0&&(ie=r-I*(U-r)),{pitch:ie,bearing:H}}}class RJ extends kJ{constructor(...e){super(...e),oe(this,"ControllerState",DJ),oe(this,"transition",{transitionDuration:300,transitionInterpolator:new qB({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),oe(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Xu extends bl{get ViewportType(){return ac}get ControllerType(){return RJ}}oe(Xu,"displayName","MapView");const BJ=new lS;function zJ(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,s=(r=e.order)!==null&&r!==void 0?r:1/0;return i-s}class OJ{constructor(){oe(this,"effects",void 0),oe(this,"_resolvedEffects",[]),oe(this,"_defaultEffects",[]),oe(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>zJ(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(sA(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),r.push(s)):(s.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof lS)||this._resolvedEffects.push(BJ),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class FJ extends iS{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const NJ="deckRenderer.renderLayers";class UJ{constructor(e){oe(this,"gl",void 0),oe(this,"layerFilter",void 0),oe(this,"drawPickingColors",void 0),oe(this,"drawLayersPass",void 0),oe(this,"pickLayersPass",void 0),oe(this,"renderCount",void 0),oe(this,"_needsRedraw",void 0),oe(this,"renderBuffers",void 0),oe(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new FJ(e),this.pickLayersPass=new jB(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||is.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,lo(NJ,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new is(this.gl),new is(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const l=s.postRender(this.gl,i);i.inputBuffer=l,i.swapBuffer=l===r[0]?r[1]:r[0]}}}const VJ={pickedColor:null,pickedObjectIndex:-1};function GJ({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:l,y:o,width:p,height:w}=s;let C=i*i,P=-1,I=0;for(let U=0;U<w;U++){const W=U+o-r,H=W*W;if(H>C)I+=4*p;else for(let ie=0;ie<p;ie++){if(t[I+3]-1>=0){const ee=ie+l-n,se=ee*ee+H;se<=C&&(C=se,P=I)}I+=4}}if(P>=0){const U=t.slice(P,P+4),W=e(U);if(W){const H=Math.floor(P/4/p),ie=P/4-H*p;return{...W,pickedColor:U,pickedX:l+ie,pickedY:o+H}}sr.error("Picked non-existent layer. Is picking buffer corrupt?")()}return VJ}function $J({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),l=s.join(",");if(!n.has(l)){const o=e(s);o?n.set(l,{...o,color:s}):sr.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function ZB({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let l=e[0];e.length>1&&(l=HJ(t?.pickedViewports||e,{x:r,y:i}));let o;if(l){const p=[r-l.x,i-l.y];s!==void 0&&(p[2]=s),o=l.unproject(p)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:o,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function jJ(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:l,pickedObjectIndex:o}=e,p=l?[l]:[];if(r==="hover"){const P=n.index,I=n.layerId,U=l?l.props.id:null;if(U!==I||o!==P){if(U!==I){const W=i.find(H=>H.props.id===I);W&&p.unshift(W)}n.layerId=U,n.index=o,n.info=null}}const w=ZB(t),C=new Map;return C.set(null,w),p.forEach(P=>{let I={...w};P===l&&(I.color=s,I.index=o,I.picked=!0),I=YB({layer:P,info:I,mode:r});const U=I.layer;P===l&&r==="hover"&&(n.info=I),C.set(U.id,I),r==="hover"&&U.updateAutoHighlight(I)}),C}function YB({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function HJ(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class WJ{constructor(e){oe(this,"gl",void 0),oe(this,"pickingFBO",void 0),oe(this,"depthFBO",void 0),oe(this,"pickLayersPass",void 0),oe(this,"layerFilter",void 0),oe(this,"lastPickedInfo",void 0),oe(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new jB(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const l=s&&s.layer&&s.layer.id,o=s&&s.viewport&&s.viewport.id,p=l?r.find(I=>I.id===l):null,w=o&&i.find(I=>I.id===o)||i[0],C=w&&w.unproject([e-w.x,n-w.y]);return{...s,...{x:e,y:n,viewport:w,coordinate:C,layer:p}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new is(r),is.isSupported(r,{colorBufferFloat:!0}))){const i=new is(r);i.attach({36064:new ca(r,{format:cr(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:l=0,depth:o=1,mode:p="query",unproject3D:w,onViewportActive:C,effects:P}){const I=this._getPickable(e),U=dd(this.gl);if(!I)return{result:[],emptyInfo:ZB({viewports:r,x:i,y:s,pixelRatio:U})};this._resizeBuffer();const W=iw(this.gl,[i,s],!0),H=[W.x+Math.floor(W.width/2),W.y+Math.floor(W.height/2)],ie=Math.round(l*U),{width:X,height:ee}=this.pickingFBO,se=this._getPickingRect({deviceX:H[0],deviceY:H[1],deviceRadius:ie,deviceWidth:X,deviceHeight:ee}),fe={x:i-l,y:s-l,width:l*2+1,height:l*2+1};let me;const Se=[],He=new Set;for(let Qe=0;Qe<o;Qe++){let Ke;if(se){const Ue=this._drawAndSample({layers:I,views:n,viewports:r,onViewportActive:C,deviceRect:se,cullRect:fe,effects:P,pass:"picking:".concat(p)});Ke=GJ({...Ue,deviceX:H[0],deviceY:H[1],deviceRadius:ie,deviceRect:se})}else Ke={pickedColor:null,pickedObjectIndex:-1};let rt;if(Ke.pickedLayer&&w&&this.depthFBO){const{pickedColors:Ue}=this._drawAndSample({layers:[Ke.pickedLayer],views:n,viewports:r,onViewportActive:C,deviceRect:{x:Ke.pickedX,y:Ke.pickedY,width:1,height:1},cullRect:fe,effects:P,pass:"picking:".concat(p,":z")},!0);Ue[3]&&(rt=Ue[0])}Ke.pickedLayer&&Qe+1<o&&(He.add(Ke.pickedLayer),Ke.pickedLayer.disablePickingIndex(Ke.pickedObjectIndex)),me=jJ({pickInfo:Ke,lastPickedInfo:this.lastPickedInfo,mode:p,layers:I,viewports:r,x:i,y:s,z:rt,pixelRatio:U});for(const Ue of me.values())Ue.layer&&Se.push(Ue);if(!Ke.pickedColor)break}for(const Qe of He)Qe.restorePickingColors();return{result:Se,emptyInfo:me.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:l=1,height:o=1,mode:p="query",maxObjects:w=null,onViewportActive:C,effects:P}){const I=this._getPickable(e);if(!I)return[];this._resizeBuffer();const U=dd(this.gl),W=iw(this.gl,[i,s],!0),H=W.x,ie=W.y+W.height,X=iw(this.gl,[i+l,s+o],!0),ee=X.x+X.width,se=X.y,fe={x:H,y:se,width:ee-H,height:ie-se},me=this._drawAndSample({layers:I,views:n,viewports:r,onViewportActive:C,deviceRect:fe,cullRect:{x:i,y:s,width:l,height:o},effects:P,pass:"picking:".concat(p)}),Se=$J(me),He=new Map,Qe=Number.isFinite(w);for(let Ke=0;Ke<Se.length&&!(Qe&&w&&He.size>=w);Ke++){const rt=Se[Ke];let Ue={color:rt.pickedColor,layer:null,index:rt.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:U};Ue=YB({layer:rt.pickedLayer,info:Ue,mode:p}),He.has(Ue.object)||He.set(Ue.object,Ue)}return Array.from(He.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:l,effects:o,pass:p},w=!1){const C=w?this.depthFBO:this.pickingFBO,P={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:C,deviceRect:s,cullRect:l,effects:o,pass:p,pickZ:w,preRenderStats:{}};for(const ee of o)ee.useInPicking&&(P.preRenderStats[ee.id]=ee.preRender(this.gl,P));const{decodePickingColor:I}=this.pickLayersPass.render(P),{x:U,y:W,width:H,height:ie}=s,X=new(w?Float32Array:Uint8Array)(H*ie*4);return iv(C,{sourceX:U,sourceY:W,sourceWidth:H,sourceHeight:ie,target:X}),{pickedColors:X,decodePickingColor:I}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const l=Math.max(0,e-r),o=Math.max(0,n-r),p=Math.min(i,e+r+1)-l,w=Math.min(s,n+r+1)-o;return p<=0||w<=0?null:{x:l,y:o,width:p,height:w}}}const QJ={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class qJ{constructor(e){oe(this,"el",null),oe(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,QJ),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var XB={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],l=n.createElement("div"),o="function",p=Math.round,w=Math.abs,C=Date.now;function P(ge,Ee,Fe){return setTimeout(se(ge,Fe),Ee)}function I(ge,Ee,Fe){return Array.isArray(ge)?(U(ge,Fe[Ee],Fe),!0):!1}function U(ge,Ee,Fe){var lt;if(ge)if(ge.forEach)ge.forEach(Ee,Fe);else if(ge.length!==i)for(lt=0;lt<ge.length;)Ee.call(Fe,ge[lt],lt,ge),lt++;else for(lt in ge)ge.hasOwnProperty(lt)&&Ee.call(Fe,ge[lt],lt,ge)}function W(ge,Ee,Fe){var lt="DEPRECATED METHOD: "+Ee+`
`+Fe+` AT 
`;return function(){var bt=new Error("get-stack-trace"),Qt=bt&&bt.stack?bt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ln=e.console&&(e.console.warn||e.console.log);return Ln&&Ln.call(e.console,lt,Qt),ge.apply(this,arguments)}}var H;typeof Object.assign!="function"?H=function(Ee){if(Ee===i||Ee===null)throw new TypeError("Cannot convert undefined or null to object");for(var Fe=Object(Ee),lt=1;lt<arguments.length;lt++){var bt=arguments[lt];if(bt!==i&&bt!==null)for(var Qt in bt)bt.hasOwnProperty(Qt)&&(Fe[Qt]=bt[Qt])}return Fe}:H=Object.assign;var ie=W(function(Ee,Fe,lt){for(var bt=Object.keys(Fe),Qt=0;Qt<bt.length;)(!lt||lt&&Ee[bt[Qt]]===i)&&(Ee[bt[Qt]]=Fe[bt[Qt]]),Qt++;return Ee},"extend","Use `assign`."),X=W(function(Ee,Fe){return ie(Ee,Fe,!0)},"merge","Use `assign`.");function ee(ge,Ee,Fe){var lt=Ee.prototype,bt;bt=ge.prototype=Object.create(lt),bt.constructor=ge,bt._super=lt,Fe&&H(bt,Fe)}function se(ge,Ee){return function(){return ge.apply(Ee,arguments)}}function fe(ge,Ee){return typeof ge==o?ge.apply(Ee&&Ee[0]||i,Ee):ge}function me(ge,Ee){return ge===i?Ee:ge}function Se(ge,Ee,Fe){U(rt(Ee),function(lt){ge.addEventListener(lt,Fe,!1)})}function He(ge,Ee,Fe){U(rt(Ee),function(lt){ge.removeEventListener(lt,Fe,!1)})}function Qe(ge,Ee){for(;ge;){if(ge==Ee)return!0;ge=ge.parentNode}return!1}function Ke(ge,Ee){return ge.indexOf(Ee)>-1}function rt(ge){return ge.trim().split(/\s+/g)}function Ue(ge,Ee,Fe){if(ge.indexOf&&!Fe)return ge.indexOf(Ee);for(var lt=0;lt<ge.length;){if(Fe&&ge[lt][Fe]==Ee||!Fe&&ge[lt]===Ee)return lt;lt++}return-1}function it(ge){return Array.prototype.slice.call(ge,0)}function Ze(ge,Ee,Fe){for(var lt=[],bt=[],Qt=0;Qt<ge.length;){var Ln=Ee?ge[Qt][Ee]:ge[Qt];Ue(bt,Ln)<0&&lt.push(ge[Qt]),bt[Qt]=Ln,Qt++}return Fe&&(Ee?lt=lt.sort(function(en,Dr){return en[Ee]>Dr[Ee]}):lt=lt.sort()),lt}function yt(ge,Ee){for(var Fe,lt,bt=Ee[0].toUpperCase()+Ee.slice(1),Qt=0;Qt<s.length;){if(Fe=s[Qt],lt=Fe?Fe+bt:Ee,lt in ge)return lt;Qt++}return i}var Kt=1;function Tt(){return Kt++}function dn(ge){var Ee=ge.ownerDocument||ge;return Ee.defaultView||Ee.parentWindow||e}var _t=/mobile|tablet|ip(ad|hone|od)|android/i,Et="ontouchstart"in e,Jt=yt(e,"PointerEvent")!==i,In=Et&&_t.test(navigator.userAgent),Tn="touch",Pr="pen",tr="mouse",or="kinect",hr=25,Vn=1,Tr=2,wt=4,rn=8,Mn=1,xt=2,nr=4,Wn=8,vr=16,lr=xt|nr,rr=Wn|vr,ti=lr|rr,Gn=["x","y"],Pi=["clientX","clientY"];function qn(ge,Ee){var Fe=this;this.manager=ge,this.callback=Ee,this.element=ge.element,this.target=ge.options.inputTarget,this.domHandler=function(lt){fe(ge.options.enable,[ge])&&Fe.handler(lt)},this.init()}qn.prototype={handler:function(){},init:function(){this.evEl&&Se(this.element,this.evEl,this.domHandler),this.evTarget&&Se(this.target,this.evTarget,this.domHandler),this.evWin&&Se(dn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&He(this.element,this.evEl,this.domHandler),this.evTarget&&He(this.target,this.evTarget,this.domHandler),this.evWin&&He(dn(this.element),this.evWin,this.domHandler)}};function Vi(ge){var Ee,Fe=ge.options.inputClass;return Fe?Ee=Fe:Jt?Ee=Ye:In?Ee=ji:Et?Ee=K:Ee=Sn,new Ee(ge,mo)}function mo(ge,Ee,Fe){var lt=Fe.pointers.length,bt=Fe.changedPointers.length,Qt=Ee&Vn&&lt-bt===0,Ln=Ee&(wt|rn)&&lt-bt===0;Fe.isFirst=!!Qt,Fe.isFinal=!!Ln,Qt&&(ge.session={}),Fe.eventType=Ee,Gr(ge,Fe),ge.emit("hammer.input",Fe),ge.recognize(Fe),ge.session.prevInput=Fe}function Gr(ge,Ee){var Fe=ge.session,lt=Ee.pointers,bt=lt.length;Fe.firstInput||(Fe.firstInput=os(Ee)),bt>1&&!Fe.firstMultiple?Fe.firstMultiple=os(Ee):bt===1&&(Fe.firstMultiple=!1);var Qt=Fe.firstInput,Ln=Fe.firstMultiple,Ir=Ln?Ln.center:Qt.center,en=Ee.center=ht(lt);Ee.timeStamp=C(),Ee.deltaTime=Ee.timeStamp-Qt.timeStamp,Ee.angle=zn(Ir,en),Ee.distance=wi(Ir,en),ki(Fe,Ee),Ee.offsetDirection=Fs(Ee.deltaX,Ee.deltaY);var Dr=It(Ee.deltaTime,Ee.deltaX,Ee.deltaY);Ee.overallVelocityX=Dr.x,Ee.overallVelocityY=Dr.y,Ee.overallVelocity=w(Dr.x)>w(Dr.y)?Dr.x:Dr.y,Ee.scale=Ln?Ii(Ln.pointers,lt):1,Ee.rotation=Ln?Gi(Ln.pointers,lt):0,Ee.maxPointers=Fe.prevInput?Ee.pointers.length>Fe.prevInput.maxPointers?Ee.pointers.length:Fe.prevInput.maxPointers:Ee.pointers.length,Vo(Fe,Ee);var $n=ge.element;Qe(Ee.srcEvent.target,$n)&&($n=Ee.srcEvent.target),Ee.target=$n}function ki(ge,Ee){var Fe=Ee.center,lt=ge.offsetDelta||{},bt=ge.prevDelta||{},Qt=ge.prevInput||{};(Ee.eventType===Vn||Qt.eventType===wt)&&(bt=ge.prevDelta={x:Qt.deltaX||0,y:Qt.deltaY||0},lt=ge.offsetDelta={x:Fe.x,y:Fe.y}),Ee.deltaX=bt.x+(Fe.x-lt.x),Ee.deltaY=bt.y+(Fe.y-lt.y)}function Vo(ge,Ee){var Fe=ge.lastInterval||Ee,lt=Ee.timeStamp-Fe.timeStamp,bt,Qt,Ln,Ir;if(Ee.eventType!=rn&&(lt>hr||Fe.velocity===i)){var en=Ee.deltaX-Fe.deltaX,Dr=Ee.deltaY-Fe.deltaY,$n=It(lt,en,Dr);Qt=$n.x,Ln=$n.y,bt=w($n.x)>w($n.y)?$n.x:$n.y,Ir=Fs(en,Dr),ge.lastInterval=Ee}else bt=Fe.velocity,Qt=Fe.velocityX,Ln=Fe.velocityY,Ir=Fe.direction;Ee.velocity=bt,Ee.velocityX=Qt,Ee.velocityY=Ln,Ee.direction=Ir}function os(ge){for(var Ee=[],Fe=0;Fe<ge.pointers.length;)Ee[Fe]={clientX:p(ge.pointers[Fe].clientX),clientY:p(ge.pointers[Fe].clientY)},Fe++;return{timeStamp:C(),pointers:Ee,center:ht(Ee),deltaX:ge.deltaX,deltaY:ge.deltaY}}function ht(ge){var Ee=ge.length;if(Ee===1)return{x:p(ge[0].clientX),y:p(ge[0].clientY)};for(var Fe=0,lt=0,bt=0;bt<Ee;)Fe+=ge[bt].clientX,lt+=ge[bt].clientY,bt++;return{x:p(Fe/Ee),y:p(lt/Ee)}}function It(ge,Ee,Fe){return{x:Ee/ge||0,y:Fe/ge||0}}function Fs(ge,Ee){return ge===Ee?Mn:w(ge)>=w(Ee)?ge<0?xt:nr:Ee<0?Wn:vr}function wi(ge,Ee,Fe){Fe||(Fe=Gn);var lt=Ee[Fe[0]]-ge[Fe[0]],bt=Ee[Fe[1]]-ge[Fe[1]];return Math.sqrt(lt*lt+bt*bt)}function zn(ge,Ee,Fe){Fe||(Fe=Gn);var lt=Ee[Fe[0]]-ge[Fe[0]],bt=Ee[Fe[1]]-ge[Fe[1]];return Math.atan2(bt,lt)*180/Math.PI}function Gi(ge,Ee){return zn(Ee[1],Ee[0],Pi)+zn(ge[1],ge[0],Pi)}function Ii(ge,Ee){return wi(Ee[0],Ee[1],Pi)/wi(ge[0],ge[1],Pi)}var Li={mousedown:Vn,mousemove:Tr,mouseup:wt},as="mousedown",Lt="mousemove mouseup";function Sn(){this.evEl=as,this.evWin=Lt,this.pressed=!1,qn.apply(this,arguments)}ee(Sn,qn,{handler:function(Ee){var Fe=Li[Ee.type];Fe&Vn&&Ee.button===0&&(this.pressed=!0),Fe&Tr&&Ee.which!==1&&(Fe=wt),this.pressed&&(Fe&wt&&(this.pressed=!1),this.callback(this.manager,Fe,{pointers:[Ee],changedPointers:[Ee],pointerType:tr,srcEvent:Ee}))}});var bn={pointerdown:Vn,pointermove:Tr,pointerup:wt,pointercancel:rn,pointerout:rn},Lr={2:Tn,3:Pr,4:tr,5:or},bs="pointerdown",yn="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(bs="MSPointerDown",yn="MSPointerMove MSPointerUp MSPointerCancel");function Ye(){this.evEl=bs,this.evWin=yn,qn.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ee(Ye,qn,{handler:function(Ee){var Fe=this.store,lt=!1,bt=Ee.type.toLowerCase().replace("ms",""),Qt=bn[bt],Ln=Lr[Ee.pointerType]||Ee.pointerType,Ir=Ln==Tn,en=Ue(Fe,Ee.pointerId,"pointerId");Qt&Vn&&(Ee.button===0||Ir)?en<0&&(Fe.push(Ee),en=Fe.length-1):Qt&(wt|rn)&&(lt=!0),!(en<0)&&(Fe[en]=Ee,this.callback(this.manager,Qt,{pointers:Fe,changedPointers:[Ee],pointerType:Ln,srcEvent:Ee}),lt&&Fe.splice(en,1))}});var Qr={touchstart:Vn,touchmove:Tr,touchend:wt,touchcancel:rn},Ns="touchstart",Or="touchstart touchmove touchend touchcancel";function Ai(){this.evTarget=Ns,this.evWin=Or,this.started=!1,qn.apply(this,arguments)}ee(Ai,qn,{handler:function(Ee){var Fe=Qr[Ee.type];if(Fe===Vn&&(this.started=!0),!!this.started){var lt=Xn.call(this,Ee,Fe);Fe&(wt|rn)&&lt[0].length-lt[1].length===0&&(this.started=!1),this.callback(this.manager,Fe,{pointers:lt[0],changedPointers:lt[1],pointerType:Tn,srcEvent:Ee})}}});function Xn(ge,Ee){var Fe=it(ge.touches),lt=it(ge.changedTouches);return Ee&(wt|rn)&&(Fe=Ze(Fe.concat(lt),"identifier",!0)),[Fe,lt]}var Us={touchstart:Vn,touchmove:Tr,touchend:wt,touchcancel:rn},$i="touchstart touchmove touchend touchcancel";function ji(){this.evTarget=$i,this.targetIds={},qn.apply(this,arguments)}ee(ji,qn,{handler:function(Ee){var Fe=Us[Ee.type],lt=Di.call(this,Ee,Fe);lt&&this.callback(this.manager,Fe,{pointers:lt[0],changedPointers:lt[1],pointerType:Tn,srcEvent:Ee})}});function Di(ge,Ee){var Fe=it(ge.touches),lt=this.targetIds;if(Ee&(Vn|Tr)&&Fe.length===1)return lt[Fe[0].identifier]=!0,[Fe,Fe];var bt,Qt,Ln=it(ge.changedTouches),Ir=[],en=this.target;if(Qt=Fe.filter(function(Dr){return Qe(Dr.target,en)}),Ee===Vn)for(bt=0;bt<Qt.length;)lt[Qt[bt].identifier]=!0,bt++;for(bt=0;bt<Ln.length;)lt[Ln[bt].identifier]&&Ir.push(Ln[bt]),Ee&(wt|rn)&&delete lt[Ln[bt].identifier],bt++;if(Ir.length)return[Ze(Qt.concat(Ir),"identifier",!0),Ir]}var ls=2500,Fr=25;function K(){qn.apply(this,arguments);var ge=se(this.handler,this);this.touch=new ji(this.manager,ge),this.mouse=new Sn(this.manager,ge),this.primaryTouch=null,this.lastTouches=[]}ee(K,qn,{handler:function(Ee,Fe,lt){var bt=lt.pointerType==Tn,Qt=lt.pointerType==tr;if(!(Qt&&lt.sourceCapabilities&&lt.sourceCapabilities.firesTouchEvents)){if(bt)Q.call(this,Fe,lt);else if(Qt&&he.call(this,lt))return;this.callback(Ee,Fe,lt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Q(ge,Ee){ge&Vn?(this.primaryTouch=Ee.changedPointers[0].identifier,te.call(this,Ee)):ge&(wt|rn)&&te.call(this,Ee)}function te(ge){var Ee=ge.changedPointers[0];if(Ee.identifier===this.primaryTouch){var Fe={x:Ee.clientX,y:Ee.clientY};this.lastTouches.push(Fe);var lt=this.lastTouches,bt=function(){var Qt=lt.indexOf(Fe);Qt>-1&&lt.splice(Qt,1)};setTimeout(bt,ls)}}function he(ge){for(var Ee=ge.srcEvent.clientX,Fe=ge.srcEvent.clientY,lt=0;lt<this.lastTouches.length;lt++){var bt=this.lastTouches[lt],Qt=Math.abs(Ee-bt.x),Ln=Math.abs(Fe-bt.y);if(Qt<=Fr&&Ln<=Fr)return!0}return!1}var a=yt(l.style,"touchAction"),G=a!==i,Le="compute",ke="auto",Pe="manipulation",Ie="none",qe="pan-x",At="pan-y",We=Rt();function dt(ge,Ee){this.manager=ge,this.set(Ee)}dt.prototype={set:function(ge){ge==Le&&(ge=this.compute()),G&&this.manager.element.style&&We[ge]&&(this.manager.element.style[a]=ge),this.actions=ge.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ge=[];return U(this.manager.recognizers,function(Ee){fe(Ee.options.enable,[Ee])&&(ge=ge.concat(Ee.getTouchAction()))}),Dt(ge.join(" "))},preventDefaults:function(ge){var Ee=ge.srcEvent,Fe=ge.offsetDirection;if(this.manager.session.prevented){Ee.preventDefault();return}var lt=this.actions,bt=Ke(lt,Ie)&&!We[Ie],Qt=Ke(lt,At)&&!We[At],Ln=Ke(lt,qe)&&!We[qe];if(bt){var Ir=ge.pointers.length===1,en=ge.distance<2,Dr=ge.deltaTime<250;if(Ir&&en&&Dr)return}if(!(Ln&&Qt)&&(bt||Qt&&Fe&lr||Ln&&Fe&rr))return this.preventSrc(Ee)},preventSrc:function(ge){this.manager.session.prevented=!0,ge.preventDefault()}};function Dt(ge){if(Ke(ge,Ie))return Ie;var Ee=Ke(ge,qe),Fe=Ke(ge,At);return Ee&&Fe?Ie:Ee||Fe?Ee?qe:At:Ke(ge,Pe)?Pe:ke}function Rt(){if(!G)return!1;var ge={},Ee=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Fe){ge[Fe]=Ee?e.CSS.supports("touch-action",Fe):!0}),ge}var sn=1,jt=2,pn=4,qt=8,an=qt,xn=16,Ft=32;function Oe(ge){this.options=H({},this.defaults,ge||{}),this.id=Tt(),this.manager=null,this.options.enable=me(this.options.enable,!0),this.state=sn,this.simultaneous={},this.requireFail=[]}Oe.prototype={defaults:{},set:function(ge){return H(this.options,ge),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ge){if(I(ge,"recognizeWith",this))return this;var Ee=this.simultaneous;return ge=un(ge,this),Ee[ge.id]||(Ee[ge.id]=ge,ge.recognizeWith(this)),this},dropRecognizeWith:function(ge){return I(ge,"dropRecognizeWith",this)?this:(ge=un(ge,this),delete this.simultaneous[ge.id],this)},requireFailure:function(ge){if(I(ge,"requireFailure",this))return this;var Ee=this.requireFail;return ge=un(ge,this),Ue(Ee,ge)===-1&&(Ee.push(ge),ge.requireFailure(this)),this},dropRequireFailure:function(ge){if(I(ge,"dropRequireFailure",this))return this;ge=un(ge,this);var Ee=Ue(this.requireFail,ge);return Ee>-1&&this.requireFail.splice(Ee,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ge){return!!this.simultaneous[ge.id]},emit:function(ge){var Ee=this,Fe=this.state;function lt(bt){Ee.manager.emit(bt,ge)}Fe<qt&&lt(Ee.options.event+Mt(Fe)),lt(Ee.options.event),ge.additionalEvent&&lt(ge.additionalEvent),Fe>=qt&&lt(Ee.options.event+Mt(Fe))},tryEmit:function(ge){if(this.canEmit())return this.emit(ge);this.state=Ft},canEmit:function(){for(var ge=0;ge<this.requireFail.length;){if(!(this.requireFail[ge].state&(Ft|sn)))return!1;ge++}return!0},recognize:function(ge){var Ee=H({},ge);if(!fe(this.options.enable,[this,Ee])){this.reset(),this.state=Ft;return}this.state&(an|xn|Ft)&&(this.state=sn),this.state=this.process(Ee),this.state&(jt|pn|qt|xn)&&this.tryEmit(Ee)},process:function(ge){},getTouchAction:function(){},reset:function(){}};function Mt(ge){return ge&xn?"cancel":ge&qt?"end":ge&pn?"move":ge&jt?"start":""}function Ce(ge){return ge==vr?"down":ge==Wn?"up":ge==xt?"left":ge==nr?"right":""}function un(ge,Ee){var Fe=Ee.manager;return Fe?Fe.get(ge):ge}function ui(){Oe.apply(this,arguments)}ee(ui,Oe,{defaults:{pointers:1},attrTest:function(ge){var Ee=this.options.pointers;return Ee===0||ge.pointers.length===Ee},process:function(ge){var Ee=this.state,Fe=ge.eventType,lt=Ee&(jt|pn),bt=this.attrTest(ge);return lt&&(Fe&rn||!bt)?Ee|xn:lt||bt?Fe&wt?Ee|qt:Ee&jt?Ee|pn:jt:Ft}});function ir(){ui.apply(this,arguments),this.pX=null,this.pY=null}ee(ir,ui,{defaults:{event:"pan",threshold:10,pointers:1,direction:ti},getTouchAction:function(){var ge=this.options.direction,Ee=[];return ge&lr&&Ee.push(At),ge&rr&&Ee.push(qe),Ee},directionTest:function(ge){var Ee=this.options,Fe=!0,lt=ge.distance,bt=ge.direction,Qt=ge.deltaX,Ln=ge.deltaY;return bt&Ee.direction||(Ee.direction&lr?(bt=Qt===0?Mn:Qt<0?xt:nr,Fe=Qt!=this.pX,lt=Math.abs(ge.deltaX)):(bt=Ln===0?Mn:Ln<0?Wn:vr,Fe=Ln!=this.pY,lt=Math.abs(ge.deltaY))),ge.direction=bt,Fe&&lt>Ee.threshold&&bt&Ee.direction},attrTest:function(ge){return ui.prototype.attrTest.call(this,ge)&&(this.state&jt||!(this.state&jt)&&this.directionTest(ge))},emit:function(ge){this.pX=ge.deltaX,this.pY=ge.deltaY;var Ee=Ce(ge.direction);Ee&&(ge.additionalEvent=this.options.event+Ee),this._super.emit.call(this,ge)}});function ha(){ui.apply(this,arguments)}ee(ha,ui,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ie]},attrTest:function(ge){return this._super.attrTest.call(this,ge)&&(Math.abs(ge.scale-1)>this.options.threshold||this.state&jt)},emit:function(ge){if(ge.scale!==1){var Ee=ge.scale<1?"in":"out";ge.additionalEvent=this.options.event+Ee}this._super.emit.call(this,ge)}});function De(){Oe.apply(this,arguments),this._timer=null,this._input=null}ee(De,Oe,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ke]},process:function(ge){var Ee=this.options,Fe=ge.pointers.length===Ee.pointers,lt=ge.distance<Ee.threshold,bt=ge.deltaTime>Ee.time;if(this._input=ge,!lt||!Fe||ge.eventType&(wt|rn)&&!bt)this.reset();else if(ge.eventType&Vn)this.reset(),this._timer=P(function(){this.state=an,this.tryEmit()},Ee.time,this);else if(ge.eventType&wt)return an;return Ft},reset:function(){clearTimeout(this._timer)},emit:function(ge){this.state===an&&(ge&&ge.eventType&wt?this.manager.emit(this.options.event+"up",ge):(this._input.timeStamp=C(),this.manager.emit(this.options.event,this._input)))}});function $a(){ui.apply(this,arguments)}ee($a,ui,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ie]},attrTest:function(ge){return this._super.attrTest.call(this,ge)&&(Math.abs(ge.rotation)>this.options.threshold||this.state&jt)}});function we(){ui.apply(this,arguments)}ee(we,ui,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:lr|rr,pointers:1},getTouchAction:function(){return ir.prototype.getTouchAction.call(this)},attrTest:function(ge){var Ee=this.options.direction,Fe;return Ee&(lr|rr)?Fe=ge.overallVelocity:Ee&lr?Fe=ge.overallVelocityX:Ee&rr&&(Fe=ge.overallVelocityY),this._super.attrTest.call(this,ge)&&Ee&ge.offsetDirection&&ge.distance>this.options.threshold&&ge.maxPointers==this.options.pointers&&w(Fe)>this.options.velocity&&ge.eventType&wt},emit:function(ge){var Ee=Ce(ge.offsetDirection);Ee&&this.manager.emit(this.options.event+Ee,ge),this.manager.emit(this.options.event,ge)}});function Go(){Oe.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ee(Go,Oe,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Pe]},process:function(ge){var Ee=this.options,Fe=ge.pointers.length===Ee.pointers,lt=ge.distance<Ee.threshold,bt=ge.deltaTime<Ee.time;if(this.reset(),ge.eventType&Vn&&this.count===0)return this.failTimeout();if(lt&&bt&&Fe){if(ge.eventType!=wt)return this.failTimeout();var Qt=this.pTime?ge.timeStamp-this.pTime<Ee.interval:!0,Ln=!this.pCenter||wi(this.pCenter,ge.center)<Ee.posThreshold;this.pTime=ge.timeStamp,this.pCenter=ge.center,!Ln||!Qt?this.count=1:this.count+=1,this._input=ge;var Ir=this.count%Ee.taps;if(Ir===0)return this.hasRequireFailures()?(this._timer=P(function(){this.state=an,this.tryEmit()},Ee.interval,this),jt):an}return Ft},failTimeout:function(){return this._timer=P(function(){this.state=Ft},this.options.interval,this),Ft},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==an&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Es(ge,Ee){return Ee=Ee||{},Ee.recognizers=me(Ee.recognizers,Es.defaults.preset),new fa(ge,Ee)}Es.VERSION="2.0.7",Es.defaults={domEvents:!1,touchAction:Le,enable:!0,inputTarget:null,inputClass:null,preset:[[$a,{enable:!1}],[ha,{enable:!1},["rotate"]],[we,{direction:lr}],[ir,{direction:lr},["swipe"]],[Go],[Go,{event:"doubletap",taps:2},["tap"]],[De]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ja=1,Ha=2;function fa(ge,Ee){this.options=H({},Es.defaults,Ee||{}),this.options.inputTarget=this.options.inputTarget||ge,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ge,this.input=Vi(this),this.touchAction=new dt(this,this.options.touchAction),Ml(this,!0),U(this.options.recognizers,function(Fe){var lt=this.add(new Fe[0](Fe[1]));Fe[2]&&lt.recognizeWith(Fe[2]),Fe[3]&&lt.requireFailure(Fe[3])},this)}fa.prototype={set:function(ge){return H(this.options,ge),ge.touchAction&&this.touchAction.update(),ge.inputTarget&&(this.input.destroy(),this.input.target=ge.inputTarget,this.input.init()),this},stop:function(ge){this.session.stopped=ge?Ha:ja},recognize:function(ge){var Ee=this.session;if(!Ee.stopped){this.touchAction.preventDefaults(ge);var Fe,lt=this.recognizers,bt=Ee.curRecognizer;(!bt||bt&&bt.state&an)&&(bt=Ee.curRecognizer=null);for(var Qt=0;Qt<lt.length;)Fe=lt[Qt],Ee.stopped!==Ha&&(!bt||Fe==bt||Fe.canRecognizeWith(bt))?Fe.recognize(ge):Fe.reset(),!bt&&Fe.state&(jt|pn|qt)&&(bt=Ee.curRecognizer=Fe),Qt++}},get:function(ge){if(ge instanceof Oe)return ge;for(var Ee=this.recognizers,Fe=0;Fe<Ee.length;Fe++)if(Ee[Fe].options.event==ge)return Ee[Fe];return null},add:function(ge){if(I(ge,"add",this))return this;var Ee=this.get(ge.options.event);return Ee&&this.remove(Ee),this.recognizers.push(ge),ge.manager=this,this.touchAction.update(),ge},remove:function(ge){if(I(ge,"remove",this))return this;if(ge=this.get(ge),ge){var Ee=this.recognizers,Fe=Ue(Ee,ge);Fe!==-1&&(Ee.splice(Fe,1),this.touchAction.update())}return this},on:function(ge,Ee){if(ge!==i&&Ee!==i){var Fe=this.handlers;return U(rt(ge),function(lt){Fe[lt]=Fe[lt]||[],Fe[lt].push(Ee)}),this}},off:function(ge,Ee){if(ge!==i){var Fe=this.handlers;return U(rt(ge),function(lt){Ee?Fe[lt]&&Fe[lt].splice(Ue(Fe[lt],Ee),1):delete Fe[lt]}),this}},emit:function(ge,Ee){this.options.domEvents&&da(ge,Ee);var Fe=this.handlers[ge]&&this.handlers[ge].slice();if(!(!Fe||!Fe.length)){Ee.type=ge,Ee.preventDefault=function(){Ee.srcEvent.preventDefault()};for(var lt=0;lt<Fe.length;)Fe[lt](Ee),lt++}},destroy:function(){this.element&&Ml(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Ml(ge,Ee){var Fe=ge.element;if(Fe.style){var lt;U(ge.options.cssProps,function(bt,Qt){lt=yt(Fe.style,Qt),Ee?(ge.oldCssProps[lt]=Fe.style[lt],Fe.style[lt]=bt):Fe.style[lt]=ge.oldCssProps[lt]||""}),Ee||(ge.oldCssProps={})}}function da(ge,Ee){var Fe=n.createEvent("Event");Fe.initEvent(ge,!0,!0),Fe.gesture=Ee,Ee.target.dispatchEvent(Fe)}H(Es,{INPUT_START:Vn,INPUT_MOVE:Tr,INPUT_END:wt,INPUT_CANCEL:rn,STATE_POSSIBLE:sn,STATE_BEGAN:jt,STATE_CHANGED:pn,STATE_ENDED:qt,STATE_RECOGNIZED:an,STATE_CANCELLED:xn,STATE_FAILED:Ft,DIRECTION_NONE:Mn,DIRECTION_LEFT:xt,DIRECTION_RIGHT:nr,DIRECTION_UP:Wn,DIRECTION_DOWN:vr,DIRECTION_HORIZONTAL:lr,DIRECTION_VERTICAL:rr,DIRECTION_ALL:ti,Manager:fa,Input:qn,TouchAction:dt,TouchInput:ji,MouseInput:Sn,PointerEventInput:Ye,TouchMouseInput:K,SingleTouchInput:Ai,Recognizer:Oe,AttrRecognizer:ui,Tap:Go,Pan:ir,Swipe:we,Pinch:ha,Rotate:$a,Press:De,on:Se,off:He,each:U,merge:X,extend:ie,assign:H,inherit:ee,bindFn:se,prefixed:yt});var ni=typeof e<"u"?e:typeof self<"u"?self:{};ni.Hammer=Es,typeof i=="function"&&i.amd?i(function(){return Es}):t.exports?t.exports=Es:e[r]=Es})(window,document,"Hammer")})(XB);var km=XB.exports;const ZJ=z2(km),OA=OE({__proto__:null,default:ZJ},[km]),KB=1,JB=2,D3=4,YJ={mousedown:KB,mousemove:JB,mouseup:D3};function XJ(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function KJ(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(XJ(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function JJ(t){t.prototype.handler=function(n){let r=YJ[n.type];r&KB&&n.button>=0&&(this.pressed=!0),r&JB&&n.which===0&&(r=D3),this.pressed&&(r&D3&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}KJ(km.PointerEventInput);JJ(km.MouseInput);const eee=km.Manager;class sv{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const tee=OA?[[OA.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[OA.Rotate,{enable:!1}],[OA.Pinch,{enable:!1}],[OA.Swipe,{enable:!1}],[OA.Pan,{threshold:0,enable:!1}],[OA.Press,{enable:!1}],[OA.Tap,{event:"doubletap",taps:2,enable:!1}],[OA.Tap,{event:"anytap",enable:!1}],[OA.Tap,{enable:!1}]]:null,ek={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},nee={doubletap:["tap"]},ree={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},AS={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},iee={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},tk={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},see=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",P0=typeof window<"u"?window:global;let R3=!1;try{const t={get passive(){return R3=!0,!0}};P0.addEventListener("test",null,t),P0.removeEventListener("test",null)}catch{R3=!1}const oee=see.indexOf("firefox")!==-1,{WHEEL_EVENTS:aee}=AS,nk="wheel",rk=4.000244140625,lee=40,Aee=.25;class uee extends sv{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;P0.WheelEvent&&(oee&&i.deltaMode===P0.WheelEvent.DOM_DELTA_PIXEL&&(s/=P0.devicePixelRatio),i.deltaMode===P0.WheelEvent.DOM_DELTA_LINE&&(s*=lee)),s!==0&&s%rk===0&&(s=Math.floor(s/rk)),i.shiftKey&&s&&(s=s*Aee),this.callback({type:nk,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(aee),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,R3?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===nk&&(this.options.enable=n)}}const{MOUSE_EVENTS:cee}=AS,ik="pointermove",sk="pointerover",ok="pointerout",ak="pointerenter",lk="pointerleave";class hee extends sv{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(cee),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===ik&&(this.enableMoveEvent=n),e===sk&&(this.enableOverEvent=n),e===ok&&(this.enableOutEvent=n),e===ak&&(this.enableEnterEvent=n),e===lk&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(sk,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(ok,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(ak,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(lk,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(ik,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:fee}=AS,Ak="keydown",uk="keyup";class dee extends sv{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:Ak,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:uk,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(fee),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Ak&&(this.enableDownEvent=n),e===uk&&(this.enableUpEvent=n)}}const ck="contextmenu";class pee extends sv{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:ck,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===ck&&(this.options.enable=n)}}const B3=1,V_=2,z3=4,gee={pointerdown:B3,pointermove:V_,pointerup:z3,mousedown:B3,mousemove:V_,mouseup:z3},mee=1,yee=2,_ee=3,vee=0,xee=1,wee=2,bee=1,Eee=2,Tee=4;function See(t){const e=gee[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,l=!1,o=!1;return e===z3||e===V_&&!Number.isFinite(n)?(s=i===mee,l=i===yee,o=i===_ee):e===V_?(s=!!(n&bee),l=!!(n&Tee),o=!!(n&Eee)):e===B3&&(s=r===vee,l=r===xee,o=r===wee),{leftButton:s,middleButton:l,rightButton:o}}function Cee(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,l={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:l}}const bw={srcElement:"root",priority:0};class Mee{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:l,handlersByElement:o}=this;let p=bw;typeof r=="string"||r&&r.addEventListener?p={...bw,srcElement:r}:r&&(p={...bw,...r});let w=o.get(p.srcElement);w||(w=[],o.set(p.srcElement,w));const C={type:e,handler:n,srcElement:p.srcElement,priority:p.priority};i&&(C.once=!0),s&&(C.passive=!0),l.push(C),this._active=this._active||!C.passive;let P=w.length-1;for(;P>=0&&!(w[P].priority>=C.priority);)P--;w.splice(P+1,0,C)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const l=r[s];if(l.type===e&&l.handler===n){r.splice(s,1);const o=i.get(l.srcElement);o.splice(o.indexOf(l),1),o.length===0&&i.delete(l.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},l=()=>{e.handled=!0,i=!0},o=[];for(let p=0;p<r.length;p++){const{type:w,handler:C,once:P}=r[p];if(C({...e,type:w,stopPropagation:s,stopImmediatePropagation:l}),P&&o.push(r[p]),i)break}for(let p=0;p<o.length;p++){const{type:w,handler:C}=o[p];this.remove(w,C)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...See(e),...Cee(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const Pee={events:null,recognizers:null,recognizerOptions:{},Manager:eee,touchAction:"none",tabIndex:0};class kee{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,l=ree[s.type];l&&this.manager.emit(l,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...Pee,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||tee}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(ek).forEach(i=>{const s=this.manager.get(i);s&&ek[i].forEach(l=>{s.recognizeWith(l)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const l=n.recognizerOptions[i];delete l.enable,s.set(l)}}this.wheelInput=new uee(e,this._onOtherEvent,{enable:!1}),this.moveInput=new hee(e,this._onOtherEvent,{enable:!1}),this.keyInput=new dee(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new pee(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=nee[e];s&&!this.options.recognizers&&s.forEach(l=>{const o=r.get(l);n?(o.requireFailure(e),i.dropRequireFailure(l)):o.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const C in e)this._addEventHandler(C,e[C],r,i,s);return}const{manager:l,events:o}=this,p=tk[e]||e;let w=o.get(p);w||(w=new Mee(this),o.set(p,w),w.recognizerName=iee[p]||p,l&&l.on(p,w.handleEvent)),w.add(e,n,r,i,s),w.isEmpty()||this._toggleRecognizer(w.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const l in e)this._removeEventHandler(l,e[l]);return}const{events:r}=this,i=tk[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:l}=s;let o=!1;for(const p of r.values())if(p.recognizerName===l&&!p.isEmpty()){o=!0;break}o||this._toggleRecognizer(l,!1)}}}function Fh(){}const Iee=({isDragging:t})=>t?"grabbing":"grab",ez={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Fh,onResize:Fh,onViewStateChange:Fh,onInteractionStateChange:Fh,onBeforeRender:Fh,onAfterRender:Fh,onLoad:Fh,onError:t=>sr.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:Iee,getTooltip:null,debug:!1,drawPickingColors:!1};class yf{constructor(e){oe(this,"props",void 0),oe(this,"width",0),oe(this,"height",0),oe(this,"userData",{}),oe(this,"canvas",null),oe(this,"viewManager",null),oe(this,"layerManager",null),oe(this,"effectManager",null),oe(this,"deckRenderer",null),oe(this,"deckPicker",null),oe(this,"eventManager",null),oe(this,"tooltip",null),oe(this,"metrics",void 0),oe(this,"animationLoop",void 0),oe(this,"stats",void 0),oe(this,"viewState",void 0),oe(this,"cursorState",void 0),oe(this,"_needsRedraw",void 0),oe(this,"_pickRequest",void 0),oe(this,"_lastPointerDownInfo",null),oe(this,"_metricsCounter",void 0),oe(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),oe(this,"_onEvent",n=>{const r=OM[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),l=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=l,p=o&&(o[r.handler]||o.props[r.handler]),w=this.props[r.handler];let C=!1;p&&(C=p.call(o,l,n)),!C&&w&&w(l,n)}),oe(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...ez,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&sr.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),lH()==="IE"&&sr.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new WB({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&yd.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,l,o,p;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(l=this.deckPicker)===null||l===void 0||l.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(p=this.tooltip)===null||p===void 0||p.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var w;(w=this.canvas.parentElement)===null||w===void 0||w.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&sr.removed("onLayerHover","onHover")(),"onLayerClick"in e&&sr.removed("onLayerClick","onClick")(),e.initialViewState&&!sA(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),l=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||l,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Fi(this.viewManager),this.viewManager.views}getViewports(e){return Fi(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){Fi(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Fi(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,s=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||s!==this.height){var l,o;this.width=i,this.height=s,(l=this.viewManager)===null||l===void 0||l.setProps({width:i,height:s}),(o=this.layerManager)===null||o===void 0||o.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:l,onError:o,onBeforeRender:p,onAfterRender:w,useDevicePixels:C}=e;return new Rq({width:n,height:r,useDevicePixels:C,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:P=>BR({...s,...P,canvas:this.canvas,debug:l,onContextLost:()=>this._onContextLost()}),onInitialize:P=>this._setGLContext(P.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:p,onAfterRender:w,onError:o})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Xu({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,l=!1;for(const o of r){var n;s=o,l=((n=o.layer)===null||n===void 0?void 0:n.onHover(o,e.event))||l}if(!l&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const o=this.props.getTooltip(s);this.tooltip.setTooltip(o,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,HT(e,{enable:!0,copyState:!0})),this.tooltip=new qJ(this.canvas),ic(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new MB;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new kee(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in OM)this.eventManager.on(i,this._onEvent);this.viewManager=new wJ({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new xJ(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new OJ,this.deckRenderer=new UJ(e),this.deckPicker=new WJ(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;ic(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),sr.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=Kh.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}oe(yf,"defaultProps",ez);oe(yf,"VERSION",EH);class Ew{constructor(e,n){oe(this,"opts",void 0),oe(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const l=n.elementOffset||0;for(let o=0;o<i;++o)s[o]=r[l+o]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function Lee(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function By(t){return t.stride||t.size*t.bytesPerElement}function tz(t,e){e.offset&&sr.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=By(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function Dee(t,e){const n=tz(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class Ree{constructor(e,n,r){oe(this,"gl",void 0),oe(this,"id",void 0),oe(this,"size",void 0),oe(this,"settings",void 0),oe(this,"value",void 0),oe(this,"doublePrecision",void 0),oe(this,"_buffer",void 0),oe(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:l}=n;l=Number.isFinite(l)?[l]:l||new Array(this.size).fill(0);let o;s?o=5126:!i&&n.isIndexed?o=e&&WR(e,Jr.ELEMENT_INDEX_UINT32)?5125:5123:o=i||5126;let p=Lee(i||o||5126);this.doublePrecision=s,s&&n.fp64===!1&&(p=Float32Array),this.value=null,this.settings={...n,defaultType:p,defaultValue:l,logicalType:i,type:o,size:this.size,bytesPerElement:p.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new Vr(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*By(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),yd.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=Dee(this.getAccessor(),n||{});return r[e]=new Ew(this,s.high),r["".concat(e,"64Low")]=i?new Ew(this,s.low):new Float32Array(this.size),r}if(n){const r=tz(this.getAccessor(),n);return{[e]:new Ew(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const l=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let p=0;p<s;)for(let w=0;w<i;w++){const C=n[p++];C<l[w]&&(l[w]=C),C>o[w]&&(o[w]=C)}e=[l,o]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof Vr?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const l=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(l?2:1),i.stride=By(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=By(i);const{buffer:l,byteOffset:o}=this;this.doublePrecision&&s instanceof Float64Array&&(s=vw(s,i));const p=s.byteLength+o+i.stride*2;l.byteLength<p&&l.reallocate(p),l.setAccessor(null),l.subData({data:s,offset:o}),i.type=r.type||l.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?vw(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=yd.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:l,byteOffset:o}=this;return l.byteLength<s.byteLength+o&&(l.reallocate(s.byteLength+o),n&&i&&l.subData({data:i instanceof Float64Array?vw(i,this):i,offset:o})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&sr.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let l=s;for(;--l>=0;)n[r+l]=i[l];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let l=s;for(;--l>=0;)n[r+l]=Number.isFinite(e[l])?e[l]:i[l]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const hk=[],fk=[];function Nd(t,e=0,n=1/0){let r=hk;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(fk.length=t.length,r=fk):r=hk,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function nz(t){return t&&t[Symbol.asyncIterator]}function rz(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:l}=e,o=t.BYTES_PER_ELEMENT,p=r?r/o:n,w=i?i/o:0,C=Math.floor((t.length-w)/p);return(P,{index:I,target:U})=>{if(!s){const X=I*p+w;for(let ee=0;ee<n;ee++)U[ee]=t[X+ee];return U}const W=s[I],H=s[I+1]||C;let ie;if(l){ie=new Array(H-W);for(let X=W;X<H;X++){const ee=X*p+w;U=new Array(n);for(let se=0;se<n;se++)U[se]=t[ee+se];ie[X-W]=U}}else if(p===n)ie=t.subarray(W*n+w,H*n+w);else{ie=new t.constructor((H-W)*n);let X=0;for(let ee=W;ee<H;ee++){const se=ee*p+w;for(let fe=0;fe<n;fe++)ie[X++]=t[se+fe]}}return ie}}const Bee=[],zy=[[0,1/0]];function zee(t,e){if(t===zy||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const l=t[s];l[1]<e[0]?(n.push(l),i=s+1):l[0]>e[1]?n.push(l):e=[Math.min(l[0],e[0]),Math.max(l[1],e[1])]}return n.splice(i,0,e),n}function Tw(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,l=t.end||n.length,o=e.length,p=l-r;if(o>p){n.set(e.subarray(0,p),r);return}if(n.set(e,r),!s)return;let w=o;for(;w<p;){const C=s(w,e);for(let P=0;P<i;P++)n[r+w]=C[P]||0,w++}}function Oee({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return Tw({source:t,target:e,size:n,getData:r}),e;let l=0,o=0;const p=r&&((C,P)=>r(C+o,P)),w=Math.min(i.length,s.length);for(let C=1;C<w;C++){const P=i[C]*n,I=s[C]*n;Tw({source:t.subarray(l,P),target:e,start:o,end:I,size:n,getData:p}),l=P,o=I}return o<e.length&&Tw({source:[],target:e,start:o,size:n,getData:p}),e}const Fee={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function iz(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...Fee[n],...e,...t,type:n}}function sz(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function oz(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function az(t){t.push(t.shift())}function uS(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,l=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*l}function lz({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=l=>l}){const l=n.doublePrecision&&n.value instanceof Float64Array?2:1,o=n.size*l,p=n.byteOffset,w=n.startIndices,C=i&&w,P=uS(n,e),I=n.isConstant;if(!C&&r>=P)return;const U=I?n.value:n.getBuffer().getData({srcByteOffset:p});if(n.settings.normalized&&!I){const X=s;s=(ee,se)=>n.normalizeConstant(X(ee,se))}const W=I?(X,ee)=>s(U,ee):(X,ee)=>s(U.subarray(X,X+o),ee),H=t.getData({length:r}),ie=new Float32Array(P);Oee({source:H,target:ie,sourceStartIndices:i,targetStartIndices:w,size:o,getData:W}),t.byteLength<ie.byteLength+p&&t.reallocate(ie.byteLength+p),t.subData({data:ie,offset:p})}class cS extends Ree{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:zy}),oe(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return iz(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=zee(this.state.updateRanges,[r,i])}else this.state.updateRanges=zy}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Bee}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==zy),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:l,noAlloc:o}}=this;let p=!0;if(l){for(const[w,C]of s)l.call(i,this,{data:n,startRow:w,endRow:C,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[w,C]of s){const P=Number.isFinite(w)?this.getVertexOffset(w):0,I=Number.isFinite(C)?this.getVertexOffset(C):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:P,endOffset:I})}this._checkAttributeArray()}else p=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),p}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const l=e;Fi(ArrayBuffer.isView(l.value),"invalid ".concat(i.accessor));const o=!!l.size&&l.size!==this.size;return r.binaryAccessor=rz(l.value,{size:l.size||this.size,stride:l.stride,offset:l.offset,startIndices:n,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:l}){if(e.constant)return;const{settings:o,state:p,value:w,size:C,startIndices:P}=e,{accessor:I,transform:U}=o,W=p.binaryAccessor||(typeof I=="function"?I:s[I]);Fi(typeof W=="function",'accessor "'.concat(I,'" is not a function'));let H=e.getVertexOffset(r);const{iterable:ie,objectInfo:X}=Nd(n,r,i);for(const ee of ie){X.index++;let se=W(ee,X);if(U&&(se=U.call(this,se)),P){const fe=(X.index<P.length-1?P[X.index+1]:l)-P[X.index];if(se&&Array.isArray(se[0])){let me=H;for(const Se of se)e._normalizeValue(Se,w,me),me+=C}else se&&se.length>C?w.set(se,H):(e._normalizeValue(se,X.target,0),hJ({target:w,source:X.target,start:H,count:fe}));H+=fe*C}else e._normalizeValue(se,w,H),H+=C}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class Nee{constructor({gl:e,attribute:n,timeline:r}){oe(this,"gl",void 0),oe(this,"type","interpolation"),oe(this,"attributeInTransition",void 0),oe(this,"settings",void 0),oe(this,"attribute",void 0),oe(this,"transition",void 0),oe(this,"currentStartIndices",void 0),oe(this,"currentLength",void 0),oe(this,"transform",void 0),oe(this,"buffers",void 0),this.gl=e,this.transition=new Pm(r),this.attribute=n,this.attributeInTransition=new cS(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=Vee(e,n);const i={byteLength:0,usage:35050};this.buffers=[new Vr(e,i),new Vr(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;az(i);const l={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)lz({buffer:o,...l});this.currentStartIndices=s.startIndices,this.currentLength=uS(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:sz(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const Uee=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function Vee(t,e){const n=oz(e.size);return new rS(t,{vs:Uee,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class Gee{constructor({gl:e,attribute:n,timeline:r}){oe(this,"gl",void 0),oe(this,"type","spring"),oe(this,"attributeInTransition",void 0),oe(this,"settings",void 0),oe(this,"attribute",void 0),oe(this,"transition",void 0),oe(this,"currentStartIndices",void 0),oe(this,"currentLength",void 0),oe(this,"texture",void 0),oe(this,"framebuffer",void 0),oe(this,"transform",void 0),oe(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Pm(r),this.attribute=n,this.attributeInTransition=new cS(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=jee(e),this.framebuffer=Hee(e,this.texture),this.transform=$ee(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new Vr(e,i),new Vr(e,i),new Vr(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,l={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)lz({buffer:o,...l});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=uS(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:sz(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const l=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:l.stiffness,damping:l.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),az(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),iv(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function $ee(t,e,n){const r=oz(e.size);return new rS(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function jee(t){return new ca(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function Hee(t,e){return new is(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const Wee={interpolation:Nee,spring:Gee};class Qee{constructor(e,{id:n,timeline:r}){oe(this,"id",void 0),oe(this,"isSupported",void 0),oe(this,"gl",void 0),oe(this,"timeline",void 0),oe(this,"transitions",void 0),oe(this,"needsRedraw",void 0),oe(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=rS.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],l=s.getTransitionSetting(n);l&&this._updateAttribute(i,s,l)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){sr.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const l=Wee[r.type];l?this.transitions[e]=new l({attribute:n,timeline:this.timeline,gl:this.gl}):(sr.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const dk="attributeManager.invalidate",qee="attributeManager.updateStart",Zee="attributeManager.updateEnd",Yee="attribute.updateStart",Xee="attribute.allocate",Kee="attribute.updateEnd";class Jee{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){oe(this,"id",void 0),oe(this,"gl",void 0),oe(this,"attributes",void 0),oe(this,"updateTriggers",void 0),oe(this,"needsRedraw",void 0),oe(this,"userData",void 0),oe(this,"stats",void 0),oe(this,"attributeTransitionManager",void 0),oe(this,"mergeBoundsMemoized",Mm(FK)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new Qee(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);lo(dk,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);lo(dk,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:l={},context:o={}}){let p=!1;lo(qee,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const w in this.attributes){const C=this.attributes[w],P=C.settings.accessor;C.startIndices=r,C.numInstances=n,s[w]&&sr.removed("props.".concat(w),"data.attributes.".concat(w))(),C.setExternalBuffer(l[w])||C.setBinaryValue(typeof P=="string"?l[P]:void 0,e.startIndices)||typeof P=="string"&&!l[P]&&C.setConstantValue(s[P])||C.needsUpdate()&&(p=!0,this._updateAttribute({attribute:C,numInstances:n,data:e,props:s,context:o})),this.needsRedraw=this.needsRedraw||C.needsRedraw()}p&&lo(Zee,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const l=n[s];l.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=l)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new cS(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(l=>{const o=r[l];o&&o.setNeedsUpdate(o.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(lo(Yee,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&lo(Xee,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,lo(Kee,n,r))}}class ete extends Pm{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,l=s(e/i);this._value=xl(n,r,l)}}const pk=1e-5;function gk(t,e,n,r,i){const s=e-t,o=(n-e)*i,p=-s*r;return o+p+s+e}function tte(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let l=0;l<n.length;l++)s[l]=gk(t[l],e[l],n[l],r,i);return s}return gk(t,e,n,r,i)}function mk(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class nte extends Pm{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:l=e}=this;let o=tte(s,l,n,r,i);const p=mk(o,n),w=mk(o,l);p<pk&&w<pk&&(o=n,this.end()),this._prevValue=l,this._currValue=o}}const rte={interpolation:ete,spring:nte};class ite{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const p=s.get(e),{value:w=p.settings.fromValue}=p;n=w,this.remove(e)}if(i=iz(i),!i)return;const l=rte[i.type];if(!l){sr.error("unsupported transition type '".concat(i.type,"'"))();return}const o=new l(this.timeline);o.start({...i,fromValue:n,toValue:r}),s.set(e,o)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function ste(t){const e=t[hh];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function ote(t,e){const n=Az({newProps:t,oldProps:e,propTypes:t[hh],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=lte(t,e);let i=!1;return r||(i=Ate(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:ute(t,e),transitionsChanged:ate(t,e)}}function ate(t,e){if(!t.transitions)return!1;const n={},r=t[hh];let i=!1;for(const s in t.transitions){const l=r[s],o=l&&l.type;(o==="number"||o==="color"||o==="array")&&O3(t[s],e[s],l)&&(n[s]=!0,i=!0)}return i?n:!1}function Az({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const l=O3(t[s],e[s],r[s]);if(l)return"".concat(i,".").concat(s," ").concat(l)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const l=O3(t[s],e[s],r[s]);if(l)return"".concat(i,".").concat(s," ").concat(l)}}return!1}function O3(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function lte(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function Ate(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&yk(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&yk(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function ute(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function yk(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},Az({oldProps:i,newProps:r,triggerName:n})}const cte="count(): argument not an object",hte="count(): argument not a container";function fte(t){if(!pte(t))throw new Error(cte);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(dte(t))return Object.keys(t).length;throw new Error(hte)}function dte(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function pte(t){return t!==null&&typeof t=="object"}function F3(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const gte={10241:9987,10240:9729,10242:33071,10243:33071},N3={};function mte(t,e,n,r){if(n instanceof ca)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const s=new ca(e,{...n,parameters:{...gte,...i,...r}});return N3[s.id]=t,s}function yte(t,e){!e||!(e instanceof ca)||N3[e.id]===t&&(e.delete(),delete N3[e.id])}const _te={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||U3(t)&&(t.length===3||t.length===4)},equal(t,e,n){return sA(t,e,1)}},accessor:{validate(t,e){const n=G_(t);return n==="function"||n===G_(e.value)},equal(t,e,n){return typeof e=="function"?!0:sA(t,e,1)}},array:{validate(t,e){return e.optional&&!t||U3(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?sA(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?sA(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:mte(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{yte(n.id,t)}}};function vte(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const l=s?.deprecatedFor;if(l)r[i]=Array.isArray(l)?l:[l];else{const o=xte(i,s);e[i]=o,n[i]=o.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function xte(t,e){switch(G_(e)){case"object":return Pp(t,e);case"array":return Pp(t,{type:"array",value:e,compare:!1});case"boolean":return Pp(t,{type:"boolean",value:e});case"number":return Pp(t,{type:"number",value:e});case"function":return Pp(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Pp(t,e){return"type"in e?{name:t,..._te[e.type],...e}:"value"in e?{name:t,type:G_(e.value),...e}:{name:t,type:"object",value:e}}function U3(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function G_(t){return U3(t)?"array":t===null?"null":typeof t}function wte(t,e){let n;for(let s=e.length-1;s>=0;s--){const l=e[s];"extensions"in l&&(n=l.extensions)}const r=V3(t.constructor,n),i=Object.create(r);i[U_]=t,i[gf]={},i[Jc]={};for(let s=0;s<e.length;++s){const l=e[s];for(const o in l)i[o]=l[o]}return Object.freeze(i),i}const bte="_mergedDefaultProps";function V3(t,e){let n=bte;if(e)for(const i of e){const s=i.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const r=uz(t,n);return r||(t[n]=Ete(t,e||[]))}function Ete(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=V3(r),s=uz(t,"defaultProps")||{},l=vte(s),o=Object.assign(Object.create(null),i,l.defaultProps),p=Object.assign(Object.create(null),i?.[hh],l.propTypes),w=Object.assign(Object.create(null),i?.[ww],l.deprecatedProps);for(const C of e){const P=V3(C.constructor);P&&(Object.assign(o,P),Object.assign(p,P[hh]),Object.assign(w,P[ww]))}return Tte(o,t),Cte(o,p),Ste(o,w),o[hh]=p,o[ww]=w,e.length===0&&!hS(t,"_propTypes")&&(t._propTypes=p),o}function Tte(t,e){const n=Pte(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function Ste(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])hS(this,s)||(this[s]=r);sr.deprecated(i,e[n].join("/"))()}})}function Cte(t,e){const n={},r={};for(const i in e){const s=e[i],{name:l,value:o}=s;s.async&&(n[l]=o,r[l]=Mte(l))}t[X0]=n,t[gf]={},Object.defineProperties(t,r)}function Mte(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||nz(e)?this[gf][t]=e:this[Jc][t]=e},get(){if(this[Jc]){if(t in this[Jc])return this[Jc][t]||this[X0][t];if(t in this[gf]){const e=this[U_]&&this[U_].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[X0][t]}}return this[X0][t]}}}function hS(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function uz(t,e){return hS(t,e)&&t[e]}function Pte(t){const e=t.componentName;return e||sr.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let kte=0;class fS{constructor(...e){oe(this,"id",void 0),oe(this,"props",void 0),oe(this,"count",void 0),this.props=wte(this,e),this.id=this.props.id,this.count=kte++}clone(e){const{props:n}=this,r={};for(const i in n[X0])i in n[Jc]?r[i]=n[Jc][i]:i in n[gf]&&(r[i]=n[gf][i]);return new this.constructor({...n,...r,...e})}}oe(fS,"componentName","Component");oe(fS,"defaultProps",{});const Ite=Object.freeze({});class Lte{constructor(e){oe(this,"component",void 0),oe(this,"onAsyncPropUpdated",void 0),oe(this,"asyncProps",void 0),oe(this,"oldProps",void 0),oe(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||Ite}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[U_]||this.component;const n=e[Jc]||{},r=e[gf]||e,i=e[X0]||{};for(const s in n){const l=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,l),n[s]=this.getAsyncProp(s)}for(const s in r){const l=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,l)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(nz(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],l=0;for await(const o of n){if(!this.component)return;const{dataTransform:p}=this.component.props;p?s=p(o,s):s=s.concat(o),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:l,endRow:s.length}]}),l=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[hh];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class Dte extends Lte{constructor({attributeManager:e,layer:n}){super(n),oe(this,"attributeManager",void 0),oe(this,"needsRedraw",void 0),oe(this,"needsUpdate",void 0),oe(this,"subLayers",void 0),oe(this,"usesPickingColorCache",void 0),oe(this,"hasPickingBuffer",void 0),oe(this,"changeFlags",void 0),oe(this,"viewport",void 0),oe(this,"uniformTransitions",void 0),oe(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r?.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const Rte="layer.changeFlag",Bte="layer.initialize",zte="layer.update",Ote="layer.finalize",Fte="layer.matched",_k=2**24-1,Nte=Object.freeze([]),Ute=Mm(({oldViewport:t,viewport:e})=>t.equals(e));let FA=new Uint8ClampedArray(0);const Vte={data:{type:"data",value:Nte,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:l}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var o;i={...i,fetch:{...(o=i)===null||o===void 0?void 0:o.fetch,signal:s}}}let p=l.contains(t);return!p&&!i&&(l.add({resourceId:t,data:M_(t,r),persistent:!1}),p=!0),p?l.subscribe({resourceId:t,onChange:w=>{var C;return(C=n.internalState)===null||C===void 0?void 0:C.reloadAsyncProp(e,w)},consumerId:n.id,requestId:e}):M_(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:ur.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class mA extends fS{constructor(...e){super(...e),oe(this,"internalState",null),oe(this,"lifecycle",p0.NO_STATE),oe(this,"context",void 0),oe(this,"state",void 0),oe(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Fi(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=$B(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,l]=NB(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,l]}unproject(e){return Fi(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Fi(this.internalState);const r=this.internalState.viewport||this.context.viewport;return jK(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===ur.DEFAULT||e===ur.LNGLAT||e===ur.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Fi(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:fte(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=F3(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,l=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(s!==l){this.internalState.hasPickingBuffer=l;const{pickingColors:o,instancePickingColors:p}=n.attributes,w=o||p;w&&(l&&w.constant&&(w.constant=!1,n.invalidate(w.id)),!w.value&&!l&&(w.constant=!0,w.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,l;(s=this.context)===null||s===void 0||(l=s.onError)===null||l===void 0||l.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!Ute({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(FA.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>_k&&sr.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),FA=yd.allocate(FA,n,{size:3,copy:!0,maxCount:Math.max(n,_k)});const i=Math.floor(FA.length/3),s=[];for(let l=r;l<i;l++)this.encodePickingColor(l,s),FA[l*3+0]=s[0],FA[l*3+1]=s[1],FA[l*3+2]=s[2]}e.value=FA.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,l=s&&n.attributes&&n.attributes[s.id];if(l&&l.value){const o=l.value,p=this.encodePickingColor(e);for(let w=0;w<n.length;w++){const C=s.getVertexOffset(w);o[C]===p[0]&&o[C+1]===p[1]&&o[C+2]===p[2]&&this._disablePickingIndex(w)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),l=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(l-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==FA.buffer&&(r.value=FA.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Fi(!this.internalState),Fi(Number.isFinite(this.props.coordinateSystem)),lo(Bte,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Dte({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(sr.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new ite(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){lo(Fte,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(lo(zte,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,l=this._updateUniformTransition();i.propsInTransition=l,r.viewport=i.viewport||s,this.props=l;try{const o=this._getUpdateParams(),p=this.getModels();if(r.gl)this.updateState(o);else try{this.updateState(o)}catch{}for(const C of this.props.extensions)C.updateState.call(this,o,C);const w=this.getModels()[0]!==p[0];this._postUpdate(o,w)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){lo(Ote,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const l=this.props.opacity;n.opacity=Math.pow(l,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:o}=this.props,p=o&&o(n)||[0,0];ic(s.gl,{polygonOffset:p}),hA(s.gl,r,()=>{const w={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const C of this.props.extensions)C.draw.call(this,w,C);this.draw(w)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const l=e[i],o=n[i];l&&Array.isArray(o)&&(n.dataChanged=Array.isArray(l)?o.concat(l):l,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&lo(Rte,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=ote(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){ste(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Jee(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s?.setInstanceCount(this.getNumInstances());const{autoHighlight:l,highlightedObjectIndex:o,highlightColor:p}=r;if(n||i.autoHighlight!==l||i.highlightedObjectIndex!==o||i.highlightColor!==p){const w={};l||(w.pickingSelectedColor=null),Array.isArray(p)&&(w.pickingHighlightColor=p),(n||o!==i.highlightedObjectIndex)&&(w.pickingSelectedColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setModuleParameters(w)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}oe(mA,"defaultProps",Vte);oe(mA,"layerName","Layer");const Gte="compositeLayer.renderLayers";class Bn extends mA{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:l,getPolygonOffset:o,highlightedObjectIndex:p,autoHighlight:w,highlightColor:C,coordinateSystem:P,coordinateOrigin:I,wrapLongitude:U,positionFormat:W,modelMatrix:H,extensions:ie,fetch:X,operation:ee,_subLayerProps:se}=this.props,fe={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:l,getPolygonOffset:o,highlightedObjectIndex:p,autoHighlight:w,highlightColor:C,coordinateSystem:P,coordinateOrigin:I,wrapLongitude:U,positionFormat:W,modelMatrix:H,extensions:ie,fetch:X,operation:ee},me=se&&e.id&&se[e.id],Se=me&&me.updateTriggers,He=e.id||"sublayer";if(me){const Qe=this.props[hh],Ke=e.type?e.type._propTypes:{};for(const rt in me){const Ue=Ke[rt]||Qe[rt];Ue&&Ue.type==="accessor"&&(me[rt]=this.getSubLayerAccessor(me[rt]))}}Object.assign(fe,e,me),fe.id="".concat(this.props.id,"-").concat(He),fe.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...Se};for(const Qe of ie){const Ke=Qe.getSubLayerProps.call(this,Qe);Ke&&Object.assign(fe,Ke,{updateTriggers:Object.assign(fe.updateTriggers,Ke.updateTriggers)})}return fe}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=mf(s,Boolean),this.internalState.subLayers=r}lo(Gte,this,i,r);for(const s of r)s.parent=this}}oe(Bn,"layerName","CompositeLayer");const j1=Math.PI/180,vk=180/Math.PI,Oy=6370972,k0=256;function $te(){const t=k0/Oy,e=Math.PI/180*k0;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class jte extends Rf{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,nearZMultiplier:s=.1,farZMultiplier:l=2,resolution:o=10}=e;let{height:p,altitude:w=1.5}=e;p=p||1,w=Math.max(.75,w);const C=new la().lookAt({eye:[0,-w,0],up:[0,0,1]}),P=Math.pow(2,i);C.rotateX(n*j1),C.rotateZ(-r*j1),C.scale(P/p);const I=Math.atan(.5/w),U=k0*2*P/p;super({...e,height:p,viewMatrix:C,longitude:r,latitude:n,zoom:i,distanceScales:$te(),fovyRadians:I*2,focalDistance:w,near:s,far:Math.min(2,1/U+1)*w*l}),oe(this,"longitude",void 0),oe(this,"latitude",void 0),oe(this,"resolution",void 0),this.latitude=n,this.longitude=r,this.resolution=o}get projectionMode(){return rA.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,this.height/2],n),i=this.unproject([this.width/2,0],n),s=this.unproject([this.width,this.height/2],n),l=this.unproject([this.width/2,this.height],n);return s[0]<this.longitude&&(s[0]+=360),r[0]>this.longitude&&(r[0]-=360),[Math.min(r[0],s[0],i[0],l[0]),Math.min(r[1],s[1],i[1],l[1]),Math.max(r[0],s[0],i[0],l[0]),Math.max(r[1],s[1],i[1],l[1])]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,l]=e,o=n?s:this.height-s,{pixelUnprojectionMatrix:p}=this;let w;if(Number.isFinite(l))w=Sw(p,[i,o,l,1]);else{const U=Sw(p,[i,o,-1,1]),W=Sw(p,[i,o,1,1]),H=((r||0)/Oy+1)*k0,ie=dw(pB([],U,W)),X=dw(U),ee=dw(W),fe=4*((4*X*ee-(ie-X-ee)**2)/16)/ie,me=Math.sqrt(X-fe),Se=Math.sqrt(Math.max(0,H*H-fe)),He=(me-Se)/Math.sqrt(ie);w=ZZ([],U,W,He)}const[C,P,I]=this.unprojectPosition(w);return Number.isFinite(l)?[C,P,I]:Number.isFinite(r)?[C,P,r]:[C,P]}projectPosition(e){const[n,r,i=0]=e,s=n*j1,l=r*j1,o=Math.cos(l),p=(i/Oy+1)*k0;return[Math.sin(s)*o*p,-Math.cos(s)*o*p,Math.sin(l)*p]}unprojectPosition(e){const[n,r,i]=e,s=gB(e),l=Math.asin(i/s),p=Math.atan2(n,-r)*vk,w=l*vk,C=(s/k0-1)*Oy;return[p,w,C]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const r=this.unproject(n);return{longitude:e[0]-r[0]+this.longitude,latitude:e[1]-r[1]+this.latitude}}}function Sw(t,e){const n=Fd([],e,t);return nS(n,n,1/n[3]),n}class dS{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){oe(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&sA(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,r={updateTriggers:{}};for(const i in n)if(i in this.props){const s=n[i],l=this.props[i];r[i]=l,s&&s.type==="accessor"&&(r.updateTriggers[i]=this.props.updateTriggers[i],typeof l=="function"&&(r[i]=this.getSubLayerAccessor(l)))}return r}initializeState(e,n){}updateState(e,n){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,n){}finalizeState(e,n){}}oe(dS,"defaultProps",{});oe(dS,"extensionName","LayerExtension");const Cw={bearing:0,pitch:0,position:[0,0,0]},Hte={speed:1.2,curve:1.414};class Ud extends QB{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),oe(this,"opts",void 0),this.opts={...Hte,...e}}interpolateProps(e,n,r){const i=vK(e,n,r,this.opts);for(const s in Cw)i[s]=xl(e[s]||Cw[s],n[s]||Cw[s],r);return i}getDuration(e,n){let{transitionDuration:r}=n;return r==="auto"&&(r=xK(e,n,this.opts)),r}}class cz{constructor(e){oe(this,"opts",void 0),oe(this,"typedArrayManager",void 0),oe(this,"indexStarts",[0]),oe(this,"vertexStarts",[0]),oe(this,"vertexCount",0),oe(this,"instanceCount",0),oe(this,"attributes",void 0),oe(this,"_attributeDefs",void 0),oe(this,"data",void 0),oe(this,"getGeometry",void 0),oe(this,"geometryBuffer",void 0),oe(this,"buffers",void 0),oe(this,"positionSize",void 0),oe(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=yd,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:l,dataChanged:o,normalize:p=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(l==="XY"?2:3),this.buffers=r,this.normalize=p,s&&(Fi(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),p||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(o))for(const w of o)this._rebuildGeometry(w);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?rz(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:l}=this;for(const o in s)if(o in i)l.release(r[o]),r[o]=null;else{const p=s[o];p.copy=n,r[o]=l.allocate(r[o],e,p)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:l,objectInfo:o}=Nd(i,n,r);for(const p of l){o.index++;const w=s?s(p,o):null;e(w,o.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:l}=this,{startRow:o=0,endRow:p=1/0}=e||{},w={};if(e||(n=[0],r=[0]),this.normalize||!l)this._forEachGeometry((P,I)=>{const U=P&&this.normalizeGeometry(P);w[I]=U,r[I+1]=r[I]+(U?this.getGeometrySize(U):0)},o,p),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(l))i=i||l.length/this.positionSize;else if(l instanceof Vr){const P=l.accessor.stride||this.positionSize*4;i=i||l.byteLength/P}else if(l.buffer){const P=l.stride||this.positionSize*4;i=i||l.buffer.byteLength/P}else if(l.value){const P=l.value,I=l.stride/P.BYTES_PER_ELEMENT||this.positionSize;i=i||P.length/I}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const C={};this._forEachGeometry((P,I)=>{const U=w[I]||P;C.vertexStart=r[I],C.indexStart=n[I];const W=I<r.length-1?r[I+1]:i;C.geometrySize=W-r[I],C.geometryIndex=I,this.updateGeometryAttributes(U,C)},o,p),this.vertexCount=n[n.length-1]}}const Wte=typeof window<"u"?Ne.useLayoutEffect:Ne.useEffect,Qte=Wte;function $_(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const qte={position:"absolute",zIndex:-1};function hz(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>hz(n,e));if(ov(t)){if(Zte(t))return e.style=qte,Ne.cloneElement(t,e);if(Yte(t))return Ne.cloneElement(t,e)}return t}function ov(t){return t&&typeof t=="object"&&"type"in t||!1}function Zte(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function Yte(t){const e=t.type;return e&&e.deckGLViewProps}function G3(t){if(typeof t=="function")return Ne.createElement(bl,{},t);if(Array.isArray(t))return t.map(G3);if(ov(t)){if(t.type===Ne.Fragment)return G3(t.props.children);if($_(t.type,bl))return t}return t}function Xte({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return Ne.Children.forEach(G3(t),l=>{if(ov(l)){const o=l.type;if($_(o,mA)){const p=Kte(o,l.props);i.push(p)}else r.push(l);if($_(o,bl)&&o!==bl&&l.props.id){const p=new o(l.props);s[p.id]=p}}else l&&r.push(l)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(l=>{s[l.id]=l}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function Kte(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function Jte({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const l of t){let o=s,p=l;ov(l)&&$_(l.type,bl)&&(o=l.props.id||s,p=l.props.children);const w=r.getViewport(o),C=r.getViewState(o);if(w){C.padding=w.padding;const{x:P,y:I,width:U,height:W}=w;p=hz(p,{x:P,y:I,width:U,height:W,viewport:w,viewState:C}),i[o]||(i[o]={viewport:w,children:[]}),i[o].children.push(p)}}return Object.keys(i).map(l=>{const{viewport:o,children:p}=i[l],{x:w,y:C,width:P,height:I}=o,U={position:"absolute",left:w,top:C,width:P,height:I},W="view-".concat(l),H=Ne.createElement("div",{key:W,id:W,style:U},...p);if(n){const ie={viewport:o,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:X=>{X.viewId=l,e._onViewStateChange(X)}};return Ne.createElement(n,{key:W,value:ie},H)}return H})}const ene={mixBlendMode:null};function tne({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in ene?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function nne(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function fz(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function rne(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():fz(t)}});return r}const dz=Ne.forwardRef((t,e)=>{const[n,r]=Ne.useState(0),s=Ne.useRef({control:null,version:n,forceUpdate:()=>r(me=>me+1)}).current,l=Ne.useRef(null),o=Ne.useRef(null),p=Ne.useMemo(()=>Xte(t),[t.layers,t.views,t.children]);let w=!0;const C=me=>{var Se;return w&&t.viewState?(s.viewStateUpdateRequested=me,null):(s.viewStateUpdateRequested=null,(Se=t.onViewStateChange)===null||Se===void 0?void 0:Se.call(t,me))},P=me=>{if(w)s.interactionStateUpdateRequested=me;else{var Se;s.interactionStateUpdateRequested=null,(Se=t.onInteractionStateChange)===null||Se===void 0||Se.call(t,me)}},I=Ne.useMemo(()=>{const me={...t,style:null,width:"100%",height:"100%",parent:l.current,canvas:o.current,layers:p.layers,views:p.views,onViewStateChange:C,onInteractionStateChange:P};return delete me._customRender,s.deck&&s.deck.setProps(me),me},[t]);Ne.useEffect(()=>{const me=t.Deck||yf;return s.deck=rne(s,me,{...I,parent:l.current,canvas:o.current}),()=>{var Se;return(Se=s.deck)===null||Se===void 0?void 0:Se.finalize()}},[]),Qte(()=>{fz(s);const{viewStateUpdateRequested:me,interactionStateUpdateRequested:Se}=s;me&&C(me),Se&&P(Se)}),Ne.useImperativeHandle(e,()=>nne(s),[]);const U=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:W,width:H,height:ie,id:X,style:ee}=t,{containerStyle:se,canvasStyle:fe}=Ne.useMemo(()=>tne({width:H,height:ie,style:ee}),[H,ie,ee]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===U||s.version!==n){s.lastRenderedViewports=U,s.version=n;const me=Jte({children:p.children,deck:s.deck,ContextProvider:W}),Se=Ne.createElement("canvas",{key:"canvas",id:X||"deckgl-overlay",ref:o,style:fe});s.control=Ne.createElement("div",{id:"".concat(X||"deckgl","-wrapper"),ref:l,style:se},[Se,me])}return w=!1,s.control});dz.defaultProps=yf.defaultProps;const gc=dz;var pz={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(x9,function(){var n,r,i;function s(o,p){if(!n)n=p;else if(!r)r=p;else{var w="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",C={};n(C),i=p(C),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}s(["exports"],function(o){var p=w;function w(f,u,g,T){this.cx=3*f,this.bx=3*(g-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(T-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=u,this.p2x=g,this.p2y=T}function C(f,u,g,T){const D=new p(f,u,g,T);return function(z){return D.solve(z)}}w.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,u){if(u===void 0&&(u=1e-6),f<0)return 0;if(f>1)return 1;for(var g=f,T=0;T<8;T++){var D=this.sampleCurveX(g)-f;if(Math.abs(D)<u)return g;var z=this.sampleCurveDerivativeX(g);if(Math.abs(z)<1e-6)break;g-=D/z}var F=0,$=1;for(g=f,T=0;T<20&&(D=this.sampleCurveX(g),!(Math.abs(D-f)<u));T++)f>D?F=g:$=g,g=.5*($-F)+F;return g},solve:function(f,u){return this.sampleCurveY(this.solveCurveX(f,u))}};const P=C(.25,.1,.25,1);function I(f,u,g){return Math.min(g,Math.max(u,f))}function U(f,u,g){const T=g-u,D=((f-u)%T+T)%T+u;return D===u?g:D}function W(f,...u){for(const g of u)for(const T in g)f[T]=g[T];return f}let H=1;function ie(f,u){f.forEach(g=>{u[g]&&(u[g]=u[g].bind(u))})}function X(f,u,g){const T={};for(const D in f)T[D]=u.call(g||this,f[D],D,f);return T}function ee(f,u,g){const T={};for(const D in f)u.call(g||this,f[D],D,f)&&(T[D]=f[D]);return T}function se(f){return Array.isArray(f)?f.map(se):typeof f=="object"&&f?X(f,se):f}const fe={};function me(f){fe[f]||(typeof console<"u"&&console.warn(f),fe[f]=!0)}function Se(f,u,g){return(g.y-f.y)*(u.x-f.x)>(u.y-f.y)*(g.x-f.x)}function He(f){let u=0;for(let g,T,D=0,z=f.length,F=z-1;D<z;F=D++)g=f[D],T=f[F],u+=(T.x-g.x)*(g.y+T.y);return u}function Qe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ke(f){const u={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(g,T,D,z)=>{const F=D||z;return u[T]=!F||F.toLowerCase(),""}),u["max-age"]){const g=parseInt(u["max-age"],10);isNaN(g)?delete u["max-age"]:u["max-age"]=g}return u}let rt,Ue,it=null;function Ze(f){if(it==null){const u=f.navigator?f.navigator.userAgent:null;it=!!f.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return it}function yt(f){return typeof ImageBitmap<"u"&&f instanceof ImageBitmap}const Kt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f){const u=requestAnimationFrame(f);return{cancel:()=>cancelAnimationFrame(u)}},getImageData(f,u=0){const g=window.document.createElement("canvas"),T=g.getContext("2d");if(!T)throw new Error("failed to create canvas 2d context");return g.width=f.width,g.height=f.height,T.drawImage(f,0,0,f.width,f.height),T.getImageData(-u,-u,f.width+2*u,f.height+2*u)},resolveURL:f=>(rt||(rt=document.createElement("a")),rt.href=f,rt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ue==null&&(Ue=matchMedia("(prefers-reduced-motion: reduce)")),Ue.matches)}};var Tt=dn;function dn(f,u){this.x=f,this.y=u}dn.prototype={clone:function(){return new dn(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,u){return this.clone()._rotateAround(f,u)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var u=f.x-this.x,g=f.y-this.y;return u*u+g*g},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,u){return Math.atan2(this.x*u-this.y*f,this.x*f+this.y*u)},_matMult:function(f){var u=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=u,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var u=Math.cos(f),g=Math.sin(f),T=g*this.x+u*this.y;return this.x=u*this.x-g*this.y,this.y=T,this},_rotateAround:function(f,u){var g=Math.cos(f),T=Math.sin(f),D=u.y+T*(this.x-u.x)+g*(this.y-u.y);return this.x=u.x+g*(this.x-u.x)-T*(this.y-u.y),this.y=D,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},dn.convert=function(f){return f instanceof dn?f:Array.isArray(f)?new dn(f[0],f[1]):f};const _t={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Et="mapbox-tiles";let Jt,In,Tn=500,Pr=50;function tr(){typeof caches>"u"||Jt||(Jt=caches.open(Et))}let or=1/0;const hr={supported:!1,testSupport:function(f){!wt&&Tr&&(rn?Mn(f):Vn=f)}};let Vn,Tr,wt=!1,rn=!1;function Mn(f){const u=f.createTexture();f.bindTexture(f.TEXTURE_2D,u);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,Tr),f.isContextLost())return;hr.supported=!0}catch{}f.deleteTexture(u),wt=!0}typeof document<"u"&&(Tr=document.createElement("img"),Tr.onload=function(){Vn&&Mn(Vn),Vn=null,rn=!0},Tr.onerror=function(){wt=!0,Vn=null},Tr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const xt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(xt);class nr extends Error{constructor(u,g,T,D){super(`AJAXError: ${g} (${u}): ${T}`),this.status=u,this.statusText=g,this.url=T,this.body=D}}const Wn=Qe()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function vr(f,u){const g=new AbortController,T=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Wn(),signal:g.signal});let D=!1,z=!1;return f.type==="json"&&T.headers.set("Accept","application/json"),((F,$,Z)=>{if(z)return;const re=Date.now();fetch(T).then(Ae=>Ae.ok?((ce,pe,ye)=>{(f.type==="arrayBuffer"?ce.arrayBuffer():f.type==="json"?ce.json():ce.text()).then(_e=>{z||(pe&&ye&&function(Ve,ze,tt){if(tr(),!Jt)return;const ut={status:ze.status,statusText:ze.statusText,headers:new Headers};ze.headers.forEach((at,mt)=>ut.headers.set(mt,at));const et=Ke(ze.headers.get("Cache-Control")||"");et["no-store"]||(et["max-age"]&&ut.headers.set("Expires",new Date(tt+1e3*et["max-age"]).toUTCString()),new Date(ut.headers.get("Expires")).getTime()-tt<42e4||function(at,mt){if(In===void 0)try{new Response(new ReadableStream),In=!0}catch{In=!1}In?mt(at.body):at.blob().then(mt)}(ze,at=>{const mt=new Response(at,ut);tr(),Jt&&Jt.then(gt=>gt.put(function(Zt){const tn=Zt.indexOf("?");return tn<0?Zt:Zt.slice(0,tn)}(Ve.url),mt)).catch(gt=>me(gt.message))}))}(T,pe,ye),D=!0,u(null,_e,ce.headers.get("Cache-Control"),ce.headers.get("Expires")))}).catch(_e=>{z||u(new Error(_e.message))})})(Ae,null,re):Ae.blob().then(ce=>u(new nr(Ae.status,Ae.statusText,f.url,ce)))).catch(Ae=>{Ae.code!==20&&u(new Error(Ae.message))})})(),{cancel:()=>{z=!0,D||g.abort()}}}const lr=function(f,u){if(/:\/\//.test(f.url)&&!/^https?:|^file:/.test(f.url)){if(Qe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u);if(!Qe()){const T=f.url.substring(0,f.url.indexOf("://"));return(_t.REGISTERED_PROTOCOLS[T]||vr)(f,u)}}if(!(/^file:/.test(g=f.url)||/^file:/.test(Wn())&&!/^\w+:/.test(g))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return vr(f,u);if(Qe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u,void 0,!0)}var g;return function(T,D){const z=new XMLHttpRequest;z.open(T.method||"GET",T.url,!0),T.type==="arrayBuffer"&&(z.responseType="arraybuffer");for(const F in T.headers)z.setRequestHeader(F,T.headers[F]);return T.type==="json"&&(z.responseType="text",z.setRequestHeader("Accept","application/json")),z.withCredentials=T.credentials==="include",z.onerror=()=>{D(new Error(z.statusText))},z.onload=()=>{if((z.status>=200&&z.status<300||z.status===0)&&z.response!==null){let F=z.response;if(T.type==="json")try{F=JSON.parse(z.response)}catch($){return D($)}D(null,F,z.getResponseHeader("Cache-Control"),z.getResponseHeader("Expires"))}else{const F=new Blob([z.response],{type:z.getResponseHeader("Content-Type")});D(new nr(z.status,z.statusText,T.url,F))}},z.send(T.body),{cancel:()=>z.abort()}}(f,u)},rr=function(f,u){return lr(W(f,{type:"arrayBuffer"}),u)};function ti(f){const u=window.document.createElement("a");return u.href=f,u.protocol===window.document.location.protocol&&u.host===window.document.location.host}const Gn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Pi,qn;Pi=[],qn=0;const Vi=function(f,u){if(hr.supported&&(f.headers||(f.headers={}),f.headers.accept="image/webp,*/*"),qn>=_t.MAX_PARALLEL_IMAGE_REQUESTS){const z={requestParameters:f,callback:u,cancelled:!1,cancel(){this.cancelled=!0}};return Pi.push(z),z}qn++;let g=!1;const T=()=>{if(!g)for(g=!0,qn--;Pi.length&&qn<_t.MAX_PARALLEL_IMAGE_REQUESTS;){const z=Pi.shift(),{requestParameters:F,callback:$,cancelled:Z}=z;Z||(z.cancel=Vi(F,$).cancel)}},D=rr(f,(z,F,$,Z)=>{T(),z?u(z):F&&function(re,Ae){typeof createImageBitmap=="function"?function(ce,pe){const ye=new Blob([new Uint8Array(ce)],{type:"image/png"});createImageBitmap(ye).then(_e=>{pe(null,_e)}).catch(_e=>{pe(new Error(`Could not load image because of ${_e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(re,Ae):function(ce,pe){const ye=new Image;ye.onload=()=>{pe(null,ye),URL.revokeObjectURL(ye.src),ye.onload=null,window.requestAnimationFrame(()=>{ye.src=Gn})},ye.onerror=()=>pe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _e=new Blob([new Uint8Array(ce)],{type:"image/png"});ye.src=ce.byteLength?URL.createObjectURL(_e):Gn}(re,Ae)}(F,(re,Ae)=>{re!=null?u(re):Ae!=null&&u(null,Ae,{cacheControl:$,expires:Z})})});return{cancel:()=>{D.cancel(),T()}}};function mo(f,u,g){g[f]&&g[f].indexOf(u)!==-1||(g[f]=g[f]||[],g[f].push(u))}function Gr(f,u,g){if(g&&g[f]){const T=g[f].indexOf(u);T!==-1&&g[f].splice(T,1)}}class ki{constructor(u,g={}){W(this,g),this.type=u}}class Vo extends ki{constructor(u,g={}){super("error",W({error:u},g))}}class os{on(u,g){return this._listeners=this._listeners||{},mo(u,g,this._listeners),this}off(u,g){return Gr(u,g,this._listeners),Gr(u,g,this._oneTimeListeners),this}once(u,g){return this._oneTimeListeners=this._oneTimeListeners||{},mo(u,g,this._oneTimeListeners),this}fire(u,g){typeof u=="string"&&(u=new ki(u,g||{}));const T=u.type;if(this.listens(T)){u.target=this;const D=this._listeners&&this._listeners[T]?this._listeners[T].slice():[];for(const $ of D)$.call(this,u);const z=this._oneTimeListeners&&this._oneTimeListeners[T]?this._oneTimeListeners[T].slice():[];for(const $ of z)Gr(T,$,this._oneTimeListeners),$.call(this,u);const F=this._eventedParent;F&&(W(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),F.fire(u))}else u instanceof Vo&&console.error(u.error);return this}listens(u){return this._listeners&&this._listeners[u]&&this._listeners[u].length>0||this._oneTimeListeners&&this._oneTimeListeners[u]&&this._oneTimeListeners[u].length>0||this._eventedParent&&this._eventedParent.listens(u)}setEventedParent(u,g){return this._eventedParent=u,this._eventedParentData=g,this}}var ht={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class It{constructor(u,g,T,D){this.message=(u?`${u}: `:"")+T,D&&(this.identifier=D),g!=null&&g.__line__&&(this.line=g.__line__)}}function Fs(f){const u=f.value;return u?[new It(f.key,u,"constants have been deprecated as of v8")]:[]}function wi(f,...u){for(const g of u)for(const T in g)f[T]=g[T];return f}function zn(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function Gi(f){if(Array.isArray(f))return f.map(Gi);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const u={};for(const g in f)u[g]=Gi(f[g]);return u}return zn(f)}class Ii extends Error{constructor(u,g){super(g),this.message=g,this.key=u}}class Li{constructor(u,g=[]){this.parent=u,this.bindings={};for(const[T,D]of g)this.bindings[T]=D}concat(u){return new Li(this,u)}get(u){if(this.bindings[u])return this.bindings[u];if(this.parent)return this.parent.get(u);throw new Error(`${u} not found in scope.`)}has(u){return!!this.bindings[u]||!!this.parent&&this.parent.has(u)}}const as={kind:"null"},Lt={kind:"number"},Sn={kind:"string"},bn={kind:"boolean"},Lr={kind:"color"},bs={kind:"object"},yn={kind:"value"},Ye={kind:"collator"},Qr={kind:"formatted"},Ns={kind:"padding"},Or={kind:"resolvedImage"};function Ai(f,u){return{kind:"array",itemType:f,N:u}}function Xn(f){if(f.kind==="array"){const u=Xn(f.itemType);return typeof f.N=="number"?`array<${u}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${u}>`}return f.kind}const Us=[as,Lt,Sn,bn,Lr,Qr,bs,Ai(yn),Ns,Or];function $i(f,u){if(u.kind==="error")return null;if(f.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!$i(f.itemType,u.itemType))&&(typeof f.N!="number"||f.N===u.N))return null}else{if(f.kind===u.kind)return null;if(f.kind==="value"){for(const g of Us)if(!$i(g,u))return null}}return`Expected ${Xn(f)} but found ${Xn(u)} instead.`}function ji(f,u){return u.some(g=>g.kind===f.kind)}function Di(f,u){return u.some(g=>g==="null"?f===null:g==="array"?Array.isArray(f):g==="object"?f&&!Array.isArray(f)&&typeof f=="object":g===typeof f)}var ls,Fr={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function K(f){return(f=Math.round(f))<0?0:f>255?255:f}function Q(f){return K(f[f.length-1]==="%"?parseFloat(f)/100*255:parseInt(f))}function te(f){return(u=f[f.length-1]==="%"?parseFloat(f)/100:parseFloat(f))<0?0:u>1?1:u;var u}function he(f,u,g){return g<0?g+=1:g>1&&(g-=1),6*g<1?f+(u-f)*g*6:2*g<1?u:3*g<2?f+(u-f)*(2/3-g)*6:f}try{ls={}.parseCSSColor=function(f){var u,g=f.replace(/ /g,"").toLowerCase();if(g in Fr)return Fr[g].slice();if(g[0]==="#")return g.length===4?(u=parseInt(g.substr(1),16))>=0&&u<=4095?[(3840&u)>>4|(3840&u)>>8,240&u|(240&u)>>4,15&u|(15&u)<<4,1]:null:g.length===7&&(u=parseInt(g.substr(1),16))>=0&&u<=16777215?[(16711680&u)>>16,(65280&u)>>8,255&u,1]:null;var T=g.indexOf("("),D=g.indexOf(")");if(T!==-1&&D+1===g.length){var z=g.substr(0,T),F=g.substr(T+1,D-(T+1)).split(","),$=1;switch(z){case"rgba":if(F.length!==4)return null;$=te(F.pop());case"rgb":return F.length!==3?null:[Q(F[0]),Q(F[1]),Q(F[2]),$];case"hsla":if(F.length!==4)return null;$=te(F.pop());case"hsl":if(F.length!==3)return null;var Z=(parseFloat(F[0])%360+360)%360/360,re=te(F[1]),Ae=te(F[2]),ce=Ae<=.5?Ae*(re+1):Ae+re-Ae*re,pe=2*Ae-ce;return[K(255*he(pe,ce,Z+1/3)),K(255*he(pe,ce,Z)),K(255*he(pe,ce,Z-1/3)),$];default:return null}}return null}}catch{}class a{constructor(u,g,T,D=1){this.r=u,this.g=g,this.b=T,this.a=D}static parse(u){if(!u)return;if(u instanceof a)return u;if(typeof u!="string")return;const g=ls(u);return g?new a(g[0]/255*g[3],g[1]/255*g[3],g[2]/255*g[3],g[3]):void 0}toString(){const[u,g,T,D]=this.toArray();return`rgba(${Math.round(u)},${Math.round(g)},${Math.round(T)},${D})`}toArray(){const{r:u,g,b:T,a:D}=this;return D===0?[0,0,0,0]:[255*u/D,255*g/D,255*T/D,D]}}a.black=new a(0,0,0,1),a.white=new a(1,1,1,1),a.transparent=new a(0,0,0,0),a.red=new a(1,0,0,1);class G{constructor(u,g,T){this.sensitivity=u?g?"variant":"case":g?"accent":"base",this.locale=T,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(u,g){return this.collator.compare(u,g)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Le{constructor(u,g,T,D,z){this.text=u,this.image=g,this.scale=T,this.fontStack=D,this.textColor=z}}class ke{constructor(u){this.sections=u}static fromString(u){return new ke([new Le(u,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(u=>u.text.length!==0||u.image&&u.image.name.length!==0)}static factory(u){return u instanceof ke?u:ke.fromString(u)}toString(){return this.sections.length===0?"":this.sections.map(u=>u.text).join("")}}class Pe{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Pe)return u;if(typeof u=="number")return new Pe([u,u,u,u]);if(Array.isArray(u)&&!(u.length<1||u.length>4)){for(const g of u)if(typeof g!="number")return;switch(u.length){case 1:u=[u[0],u[0],u[0],u[0]];break;case 2:u=[u[0],u[1],u[0],u[1]];break;case 3:u=[u[0],u[1],u[2],u[1]]}return new Pe(u)}}toString(){return JSON.stringify(this.values)}}class Ie{constructor(u){this.name=u.name,this.available=u.available}toString(){return this.name}static fromString(u){return u?new Ie({name:u,available:!1}):null}}function qe(f,u,g,T){return typeof f=="number"&&f>=0&&f<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof g=="number"&&g>=0&&g<=255?T===void 0||typeof T=="number"&&T>=0&&T<=1?null:`Invalid rgba value [${[f,u,g,T].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof T=="number"?[f,u,g,T]:[f,u,g]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function At(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof a||f instanceof G||f instanceof ke||f instanceof Pe||f instanceof Ie)return!0;if(Array.isArray(f)){for(const u of f)if(!At(u))return!1;return!0}if(typeof f=="object"){for(const u in f)if(!At(f[u]))return!1;return!0}return!1}function We(f){if(f===null)return as;if(typeof f=="string")return Sn;if(typeof f=="boolean")return bn;if(typeof f=="number")return Lt;if(f instanceof a)return Lr;if(f instanceof G)return Ye;if(f instanceof ke)return Qr;if(f instanceof Pe)return Ns;if(f instanceof Ie)return Or;if(Array.isArray(f)){const u=f.length;let g;for(const T of f){const D=We(T);if(g){if(g===D)continue;g=yn;break}g=D}return Ai(g||yn,u)}return bs}function dt(f){const u=typeof f;return f===null?"":u==="string"||u==="number"||u==="boolean"?String(f):f instanceof a||f instanceof ke||f instanceof Pe||f instanceof Ie?f.toString():JSON.stringify(f)}class Dt{constructor(u,g){this.type=u,this.value=g}static parse(u,g){if(u.length!==2)return g.error(`'literal' expression requires exactly one argument, but found ${u.length-1} instead.`);if(!At(u[1]))return g.error("invalid value");const T=u[1];let D=We(T);const z=g.expectedType;return D.kind!=="array"||D.N!==0||!z||z.kind!=="array"||typeof z.N=="number"&&z.N!==0||(D=z),new Dt(D,T)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Rt{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}}const sn={string:Sn,number:Lt,boolean:bn,object:bs};class jt{constructor(u,g){this.type=u,this.args=g}static parse(u,g){if(u.length<2)return g.error("Expected at least one argument.");let T,D=1;const z=u[0];if(z==="array"){let $,Z;if(u.length>2){const re=u[1];if(typeof re!="string"||!(re in sn)||re==="object")return g.error('The item type argument of "array" must be one of string, number, boolean',1);$=sn[re],D++}else $=yn;if(u.length>3){if(u[2]!==null&&(typeof u[2]!="number"||u[2]<0||u[2]!==Math.floor(u[2])))return g.error('The length argument to "array" must be a positive integer literal',2);Z=u[2],D++}T=Ai($,Z)}else{if(!sn[z])throw new Error(`Types doesn't contain name = ${z}`);T=sn[z]}const F=[];for(;D<u.length;D++){const $=g.parse(u[D],D,yn);if(!$)return null;F.push($)}return new jt(T,F)}evaluate(u){for(let g=0;g<this.args.length;g++){const T=this.args[g].evaluate(u);if(!$i(this.type,We(T)))return T;if(g===this.args.length-1)throw new Rt(`Expected value to be of type ${Xn(this.type)}, but found ${Xn(We(T))} instead.`)}throw new Error}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const pn={"to-boolean":bn,"to-color":Lr,"to-number":Lt,"to-string":Sn};class qt{constructor(u,g){this.type=u,this.args=g}static parse(u,g){if(u.length<2)return g.error("Expected at least one argument.");const T=u[0];if(!pn[T])throw new Error(`Can't parse ${T} as it is not part of the known types`);if((T==="to-boolean"||T==="to-string")&&u.length!==2)return g.error("Expected one argument.");const D=pn[T],z=[];for(let F=1;F<u.length;F++){const $=g.parse(u[F],F,yn);if(!$)return null;z.push($)}return new qt(D,z)}evaluate(u){if(this.type.kind==="boolean")return!!this.args[0].evaluate(u);if(this.type.kind==="color"){let g,T;for(const D of this.args){if(g=D.evaluate(u),T=null,g instanceof a)return g;if(typeof g=="string"){const z=u.parseColor(g);if(z)return z}else if(Array.isArray(g)&&(T=g.length<3||g.length>4?`Invalid rbga value ${JSON.stringify(g)}: expected an array containing either three or four numeric values.`:qe(g[0],g[1],g[2],g[3]),!T))return new a(g[0]/255,g[1]/255,g[2]/255,g[3])}throw new Rt(T||`Could not parse color from value '${typeof g=="string"?g:JSON.stringify(g)}'`)}if(this.type.kind==="padding"){let g;for(const T of this.args){g=T.evaluate(u);const D=Pe.parse(g);if(D)return D}throw new Rt(`Could not parse padding from value '${typeof g=="string"?g:JSON.stringify(g)}'`)}if(this.type.kind==="number"){let g=null;for(const T of this.args){if(g=T.evaluate(u),g===null)return 0;const D=Number(g);if(!isNaN(D))return D}throw new Rt(`Could not convert ${JSON.stringify(g)} to number.`)}return this.type.kind==="formatted"?ke.fromString(dt(this.args[0].evaluate(u))):this.type.kind==="resolvedImage"?Ie.fromString(dt(this.args[0].evaluate(u))):dt(this.args[0].evaluate(u))}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const an=["Unknown","Point","LineString","Polygon"];class xn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?an[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(u){let g=this._parseColorCache[u];return g||(g=this._parseColorCache[u]=a.parse(u)),g}}class Ft{constructor(u,g,T,D){this.name=u,this.type=g,this._evaluate=T,this.args=D}evaluate(u){return this._evaluate(u,this.args)}eachChild(u){this.args.forEach(u)}outputDefined(){return!1}static parse(u,g){const T=u[0],D=Ft.definitions[T];if(!D)return g.error(`Unknown expression "${T}". If you wanted a literal array, use ["literal", [...]].`,0);const z=Array.isArray(D)?D[0]:D.type,F=Array.isArray(D)?[[D[1],D[2]]]:D.overloads,$=F.filter(([re])=>!Array.isArray(re)||re.length===u.length-1);let Z=null;for(const[re,Ae]of $){Z=new bt(g.registry,g.path,null,g.scope);const ce=[];let pe=!1;for(let ye=1;ye<u.length;ye++){const _e=u[ye],Ve=Array.isArray(re)?re[ye-1]:re.type,ze=Z.parse(_e,1+ce.length,Ve);if(!ze){pe=!0;break}ce.push(ze)}if(!pe)if(Array.isArray(re)&&re.length!==ce.length)Z.error(`Expected ${re.length} arguments, but found ${ce.length} instead.`);else{for(let ye=0;ye<ce.length;ye++){const _e=Array.isArray(re)?re[ye]:re.type,Ve=ce[ye];Z.concat(ye+1).checkSubtype(_e,Ve.type)}if(Z.errors.length===0)return new Ft(T,z,Ae,ce)}}if($.length===1)g.errors.push(...Z.errors);else{const re=($.length?$:F).map(([ce])=>{return pe=ce,Array.isArray(pe)?`(${pe.map(Xn).join(", ")})`:`(${Xn(pe.type)}...)`;var pe}).join(" | "),Ae=[];for(let ce=1;ce<u.length;ce++){const pe=g.parse(u[ce],1+Ae.length);if(!pe)return null;Ae.push(Xn(pe.type))}g.error(`Expected arguments of type ${re}, but found (${Ae.join(", ")}) instead.`)}return null}static register(u,g){Ft.definitions=g;for(const T in g)u[T]=Ft}}class Oe{constructor(u,g,T){this.type=Ye,this.locale=T,this.caseSensitive=u,this.diacriticSensitive=g}static parse(u,g){if(u.length!==2)return g.error("Expected one argument.");const T=u[1];if(typeof T!="object"||Array.isArray(T))return g.error("Collator options argument must be an object.");const D=g.parse(T["case-sensitive"]!==void 0&&T["case-sensitive"],1,bn);if(!D)return null;const z=g.parse(T["diacritic-sensitive"]!==void 0&&T["diacritic-sensitive"],1,bn);if(!z)return null;let F=null;return T.locale&&(F=g.parse(T.locale,1,Sn),!F)?null:new Oe(D,z,F)}evaluate(u){return new G(this.caseSensitive.evaluate(u),this.diacriticSensitive.evaluate(u),this.locale?this.locale.evaluate(u):null)}eachChild(u){u(this.caseSensitive),u(this.diacriticSensitive),this.locale&&u(this.locale)}outputDefined(){return!1}}const Mt=8192;function Ce(f,u){f[0]=Math.min(f[0],u[0]),f[1]=Math.min(f[1],u[1]),f[2]=Math.max(f[2],u[0]),f[3]=Math.max(f[3],u[1])}function un(f,u){return!(f[0]<=u[0]||f[2]>=u[2]||f[1]<=u[1]||f[3]>=u[3])}function ui(f,u){const g=(180+f[0])/360,T=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,D=Math.pow(2,u.z);return[Math.round(g*D*Mt),Math.round(T*D*Mt)]}function ir(f,u,g){const T=f[0]-u[0],D=f[1]-u[1],z=f[0]-g[0],F=f[1]-g[1];return T*F-z*D==0&&T*z<=0&&D*F<=0}function ha(f,u){let g=!1;for(let F=0,$=u.length;F<$;F++){const Z=u[F];for(let re=0,Ae=Z.length;re<Ae-1;re++){if(ir(f,Z[re],Z[re+1]))return!1;(D=Z[re])[1]>(T=f)[1]!=(z=Z[re+1])[1]>T[1]&&T[0]<(z[0]-D[0])*(T[1]-D[1])/(z[1]-D[1])+D[0]&&(g=!g)}}var T,D,z;return g}function De(f,u){for(let g=0;g<u.length;g++)if(ha(f,u[g]))return!0;return!1}function $a(f,u,g,T){const D=T[0]-g[0],z=T[1]-g[1],F=(f[0]-g[0])*z-D*(f[1]-g[1]),$=(u[0]-g[0])*z-D*(u[1]-g[1]);return F>0&&$<0||F<0&&$>0}function we(f,u,g){for(const re of g)for(let Ae=0;Ae<re.length-1;++Ae)if(($=[(F=re[Ae+1])[0]-(z=re[Ae])[0],F[1]-z[1]])[0]*(Z=[(D=u)[0]-(T=f)[0],D[1]-T[1]])[1]-$[1]*Z[0]!=0&&$a(T,D,z,F)&&$a(z,F,T,D))return!0;var T,D,z,F,$,Z;return!1}function Go(f,u){for(let g=0;g<f.length;++g)if(!ha(f[g],u))return!1;for(let g=0;g<f.length-1;++g)if(we(f[g],f[g+1],u))return!1;return!0}function Es(f,u){for(let g=0;g<u.length;g++)if(Go(f,u[g]))return!0;return!1}function ja(f,u,g){const T=[];for(let D=0;D<f.length;D++){const z=[];for(let F=0;F<f[D].length;F++){const $=ui(f[D][F],g);Ce(u,$),z.push($)}T.push(z)}return T}function Ha(f,u,g){const T=[];for(let D=0;D<f.length;D++){const z=ja(f[D],u,g);T.push(z)}return T}function fa(f,u,g,T){if(f[0]<g[0]||f[0]>g[2]){const D=.5*T;let z=f[0]-g[0]>D?-T:g[0]-f[0]>D?T:0;z===0&&(z=f[0]-g[2]>D?-T:g[2]-f[0]>D?T:0),f[0]+=z}Ce(u,f)}function Ml(f,u,g,T){const D=Math.pow(2,T.z)*Mt,z=[T.x*Mt,T.y*Mt],F=[];for(const $ of f)for(const Z of $){const re=[Z.x+z[0],Z.y+z[1]];fa(re,u,g,D),F.push(re)}return F}function da(f,u,g,T){const D=Math.pow(2,T.z)*Mt,z=[T.x*Mt,T.y*Mt],F=[];for(const Z of f){const re=[];for(const Ae of Z){const ce=[Ae.x+z[0],Ae.y+z[1]];Ce(u,ce),re.push(ce)}F.push(re)}if(u[2]-u[0]<=D/2){($=u)[0]=$[1]=1/0,$[2]=$[3]=-1/0;for(const Z of F)for(const re of Z)fa(re,u,g,D)}var $;return F}class ni{constructor(u,g){this.type=bn,this.geojson=u,this.geometries=g}static parse(u,g){if(u.length!==2)return g.error(`'within' expression requires exactly one argument, but found ${u.length-1} instead.`);if(At(u[1])){const T=u[1];if(T.type==="FeatureCollection")for(let D=0;D<T.features.length;++D){const z=T.features[D].geometry.type;if(z==="Polygon"||z==="MultiPolygon")return new ni(T,T.features[D].geometry)}else if(T.type==="Feature"){const D=T.geometry.type;if(D==="Polygon"||D==="MultiPolygon")return new ni(T,T.geometry)}else if(T.type==="Polygon"||T.type==="MultiPolygon")return new ni(T,T)}return g.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(g,T){const D=[1/0,1/0,-1/0,-1/0],z=[1/0,1/0,-1/0,-1/0],F=g.canonicalID();if(T.type==="Polygon"){const $=ja(T.coordinates,z,F),Z=Ml(g.geometry(),D,z,F);if(!un(D,z))return!1;for(const re of Z)if(!ha(re,$))return!1}if(T.type==="MultiPolygon"){const $=Ha(T.coordinates,z,F),Z=Ml(g.geometry(),D,z,F);if(!un(D,z))return!1;for(const re of Z)if(!De(re,$))return!1}return!0}(u,this.geometries);if(u.geometryType()==="LineString")return function(g,T){const D=[1/0,1/0,-1/0,-1/0],z=[1/0,1/0,-1/0,-1/0],F=g.canonicalID();if(T.type==="Polygon"){const $=ja(T.coordinates,z,F),Z=da(g.geometry(),D,z,F);if(!un(D,z))return!1;for(const re of Z)if(!Go(re,$))return!1}if(T.type==="MultiPolygon"){const $=Ha(T.coordinates,z,F),Z=da(g.geometry(),D,z,F);if(!un(D,z))return!1;for(const re of Z)if(!Es(re,$))return!1}return!0}(u,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function ge(f){if(f instanceof Ft&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof ni)return!1;let u=!0;return f.eachChild(g=>{u&&!ge(g)&&(u=!1)}),u}function Ee(f){if(f instanceof Ft&&f.name==="feature-state")return!1;let u=!0;return f.eachChild(g=>{u&&!Ee(g)&&(u=!1)}),u}function Fe(f,u){if(f instanceof Ft&&u.indexOf(f.name)>=0)return!1;let g=!0;return f.eachChild(T=>{g&&!Fe(T,u)&&(g=!1)}),g}class lt{constructor(u,g){this.type=g.type,this.name=u,this.boundExpression=g}static parse(u,g){if(u.length!==2||typeof u[1]!="string")return g.error("'var' expression requires exactly one string literal argument.");const T=u[1];return g.scope.has(T)?new lt(T,g.scope.get(T)):g.error(`Unknown variable "${T}". Make sure "${T}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(u){return this.boundExpression.evaluate(u)}eachChild(){}outputDefined(){return!1}}class bt{constructor(u,g=[],T,D=new Li,z=[]){this.registry=u,this.path=g,this.key=g.map(F=>`[${F}]`).join(""),this.scope=D,this.errors=z,this.expectedType=T}parse(u,g,T,D,z={}){return g?this.concat(g,T,D)._parse(u,z):this._parse(u,z)}_parse(u,g){function T(D,z,F){return F==="assert"?new jt(z,[D]):F==="coerce"?new qt(z,[D]):D}if(u!==null&&typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"||(u=["literal",u]),Array.isArray(u)){if(u.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const D=u[0];if(typeof D!="string")return this.error(`Expression name must be a string, but found ${typeof D} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const z=this.registry[D];if(z){let F=z.parse(u,this);if(!F)return null;if(this.expectedType){const $=this.expectedType,Z=F.type;if($.kind!=="string"&&$.kind!=="number"&&$.kind!=="boolean"&&$.kind!=="object"&&$.kind!=="array"||Z.kind!=="value")if($.kind!=="color"&&$.kind!=="formatted"&&$.kind!=="resolvedImage"||Z.kind!=="value"&&Z.kind!=="string")if($.kind!=="padding"||Z.kind!=="value"&&Z.kind!=="number"&&Z.kind!=="array"){if(this.checkSubtype($,Z))return null}else F=T(F,$,g.typeAnnotation||"coerce");else F=T(F,$,g.typeAnnotation||"coerce");else F=T(F,$,g.typeAnnotation||"assert")}if(!(F instanceof Dt)&&F.type.kind!=="resolvedImage"&&Qt(F)){const $=new xn;try{F=new Dt(F.type,F.evaluate($))}catch(Z){return this.error(Z.message),null}}return F}return this.error(`Unknown expression "${D}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(u===void 0?"'undefined' value invalid. Use null instead.":typeof u=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof u} instead.`)}concat(u,g,T){const D=typeof u=="number"?this.path.concat(u):this.path,z=T?this.scope.concat(T):this.scope;return new bt(this.registry,D,g||null,z,this.errors)}error(u,...g){const T=`${this.key}${g.map(D=>`[${D}]`).join("")}`;this.errors.push(new Ii(T,u))}checkSubtype(u,g){const T=$i(u,g);return T&&this.error(T),T}}function Qt(f){if(f instanceof lt)return Qt(f.boundExpression);if(f instanceof Ft&&f.name==="error"||f instanceof Oe||f instanceof ni)return!1;const u=f instanceof qt||f instanceof jt;let g=!0;return f.eachChild(T=>{g=u?g&&Qt(T):g&&T instanceof Dt}),!!g&&ge(f)&&Fe(f,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ln(f,u){const g=f.length-1;let T,D,z=0,F=g,$=0;for(;z<=F;)if($=Math.floor((z+F)/2),T=f[$],D=f[$+1],T<=u){if($===g||u<D)return $;z=$+1}else{if(!(T>u))throw new Rt("Input is not a number.");F=$-1}return 0}class Ir{constructor(u,g,T){this.type=u,this.input=g,this.labels=[],this.outputs=[];for(const[D,z]of T)this.labels.push(D),this.outputs.push(z)}static parse(u,g){if(u.length-1<4)return g.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return g.error("Expected an even number of arguments.");const T=g.parse(u[1],1,Lt);if(!T)return null;const D=[];let z=null;g.expectedType&&g.expectedType.kind!=="value"&&(z=g.expectedType);for(let F=1;F<u.length;F+=2){const $=F===1?-1/0:u[F],Z=u[F+1],re=F,Ae=F+1;if(typeof $!="number")return g.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',re);if(D.length&&D[D.length-1][0]>=$)return g.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',re);const ce=g.parse(Z,Ae,z);if(!ce)return null;z=z||ce.type,D.push([$,ce])}return new Ir(z,T,D)}evaluate(u){const g=this.labels,T=this.outputs;if(g.length===1)return T[0].evaluate(u);const D=this.input.evaluate(u);if(D<=g[0])return T[0].evaluate(u);const z=g.length;return D>=g[z-1]?T[z-1].evaluate(u):T[Ln(g,D)].evaluate(u)}eachChild(u){u(this.input);for(const g of this.outputs)u(g)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function en(f,u,g){return f*(1-g)+u*g}var Dr=Object.freeze({__proto__:null,number:en,color:function(f,u,g){return new a(en(f.r,u.r,g),en(f.g,u.g,g),en(f.b,u.b,g),en(f.a,u.a,g))},array:function(f,u,g){return f.map((T,D)=>en(T,u[D],g))},padding:function(f,u,g){const T=f.values,D=u.values;return new Pe([en(T[0],D[0],g),en(T[1],D[1],g),en(T[2],D[2],g),en(T[3],D[3],g)])}});const $n=.95047,wA=1.08883,bA=4/29,EA=6/29,iu=3*EA*EA,su=Math.PI/180,TA=180/Math.PI;function Pl(f){return f>.008856451679035631?Math.pow(f,1/3):f/iu+bA}function kl(f){return f>EA?f*f*f:iu*(f-bA)}function SA(f){return 255*(f<=.0031308?12.92*f:1.055*Math.pow(f,1/2.4)-.055)}function CA(f){return(f/=255)<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function Kn(f){const u=CA(f.r),g=CA(f.g),T=CA(f.b),D=Pl((.4124564*u+.3575761*g+.1804375*T)/$n),z=Pl((.2126729*u+.7151522*g+.072175*T)/1);return{l:116*z-16,a:500*(D-z),b:200*(z-Pl((.0193339*u+.119192*g+.9503041*T)/wA)),alpha:f.a}}function ou(f){let u=(f.l+16)/116,g=isNaN(f.a)?u:u+f.a/500,T=isNaN(f.b)?u:u-f.b/200;return u=1*kl(u),g=$n*kl(g),T=wA*kl(T),new a(SA(3.2404542*g-1.5371385*u-.4985314*T),SA(-.969266*g+1.8760108*u+.041556*T),SA(.0556434*g-.2040259*u+1.0572252*T),f.alpha)}function yc(f,u,g){const T=u-f;return f+g*(T>180||T<-180?T-360*Math.round(T/360):T)}const Il={forward:Kn,reverse:ou,interpolate:function(f,u,g){return{l:en(f.l,u.l,g),a:en(f.a,u.a,g),b:en(f.b,u.b,g),alpha:en(f.alpha,u.alpha,g)}}},qr={forward:function(f){const{l:u,a:g,b:T}=Kn(f),D=Math.atan2(T,g)*TA;return{h:D<0?D+360:D,c:Math.sqrt(g*g+T*T),l:u,alpha:f.a}},reverse:function(f){const u=f.h*su,g=f.c;return ou({l:f.l,a:Math.cos(u)*g,b:Math.sin(u)*g,alpha:f.alpha})},interpolate:function(f,u,g){return{h:yc(f.h,u.h,g),c:en(f.c,u.c,g),l:en(f.l,u.l,g),alpha:en(f.alpha,u.alpha,g)}}};var $o=Object.freeze({__proto__:null,lab:Il,hcl:qr});class On{constructor(u,g,T,D,z){this.type=u,this.operator=g,this.interpolation=T,this.input=D,this.labels=[],this.outputs=[];for(const[F,$]of z)this.labels.push(F),this.outputs.push($)}static interpolationFactor(u,g,T,D){let z=0;if(u.name==="exponential")z=Ts(g,u.base,T,D);else if(u.name==="linear")z=Ts(g,1,T,D);else if(u.name==="cubic-bezier"){const F=u.controlPoints;z=new p(F[0],F[1],F[2],F[3]).solve(Ts(g,1,T,D))}return z}static parse(u,g){let[T,D,z,...F]=u;if(!Array.isArray(D)||D.length===0)return g.error("Expected an interpolation type expression.",1);if(D[0]==="linear")D={name:"linear"};else if(D[0]==="exponential"){const re=D[1];if(typeof re!="number")return g.error("Exponential interpolation requires a numeric base.",1,1);D={name:"exponential",base:re}}else{if(D[0]!=="cubic-bezier")return g.error(`Unknown interpolation type ${String(D[0])}`,1,0);{const re=D.slice(1);if(re.length!==4||re.some(Ae=>typeof Ae!="number"||Ae<0||Ae>1))return g.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);D={name:"cubic-bezier",controlPoints:re}}}if(u.length-1<4)return g.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return g.error("Expected an even number of arguments.");if(z=g.parse(z,2,Lt),!z)return null;const $=[];let Z=null;T==="interpolate-hcl"||T==="interpolate-lab"?Z=Lr:g.expectedType&&g.expectedType.kind!=="value"&&(Z=g.expectedType);for(let re=0;re<F.length;re+=2){const Ae=F[re],ce=F[re+1],pe=re+3,ye=re+4;if(typeof Ae!="number")return g.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',pe);if($.length&&$[$.length-1][0]>=Ae)return g.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',pe);const _e=g.parse(ce,ye,Z);if(!_e)return null;Z=Z||_e.type,$.push([Ae,_e])}return Z.kind==="number"||Z.kind==="color"||Z.kind==="padding"||Z.kind==="array"&&Z.itemType.kind==="number"&&typeof Z.N=="number"?new On(Z,T,D,z,$):g.error(`Type ${Xn(Z)} is not interpolatable.`)}evaluate(u){const g=this.labels,T=this.outputs;if(g.length===1)return T[0].evaluate(u);const D=this.input.evaluate(u);if(D<=g[0])return T[0].evaluate(u);const z=g.length;if(D>=g[z-1])return T[z-1].evaluate(u);const F=Ln(g,D),$=On.interpolationFactor(this.interpolation,D,g[F],g[F+1]),Z=T[F].evaluate(u),re=T[F+1].evaluate(u);return this.operator==="interpolate"?Dr[this.type.kind.toLowerCase()](Z,re,$):this.operator==="interpolate-hcl"?qr.reverse(qr.interpolate(qr.forward(Z),qr.forward(re),$)):Il.reverse(Il.interpolate(Il.forward(Z),Il.forward(re),$))}eachChild(u){u(this.input);for(const g of this.outputs)u(g)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function Ts(f,u,g,T){const D=T-g,z=f-g;return D===0?0:u===1?z/D:(Math.pow(u,z)-1)/(Math.pow(u,D)-1)}class ri{constructor(u,g){this.type=u,this.args=g}static parse(u,g){if(u.length<2)return g.error("Expectected at least one argument.");let T=null;const D=g.expectedType;D&&D.kind!=="value"&&(T=D);const z=[];for(const $ of u.slice(1)){const Z=g.parse($,1+z.length,T,void 0,{typeAnnotation:"omit"});if(!Z)return null;T=T||Z.type,z.push(Z)}if(!T)throw new Error("No output type");const F=D&&z.some($=>$i(D,$.type));return new ri(F?yn:T,z)}evaluate(u){let g,T=null,D=0;for(const z of this.args)if(D++,T=z.evaluate(u),T&&T instanceof Ie&&!T.available&&(g||(g=T.name),T=null,D===this.args.length&&(T=g)),T!==null)break;return T}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}class yo{constructor(u,g){this.type=g.type,this.bindings=[].concat(u),this.result=g}evaluate(u){return this.result.evaluate(u)}eachChild(u){for(const g of this.bindings)u(g[1]);u(this.result)}static parse(u,g){if(u.length<4)return g.error(`Expected at least 3 arguments, but found ${u.length-1} instead.`);const T=[];for(let z=1;z<u.length-1;z+=2){const F=u[z];if(typeof F!="string")return g.error(`Expected string, but found ${typeof F} instead.`,z);if(/[^a-zA-Z0-9_]/.test(F))return g.error("Variable names must contain only alphanumeric characters or '_'.",z);const $=g.parse(u[z+1],z+1);if(!$)return null;T.push([F,$])}const D=g.parse(u[u.length-1],u.length-1,g.expectedType,T);return D?new yo(T,D):null}outputDefined(){return this.result.outputDefined()}}class Ll{constructor(u,g,T){this.type=u,this.index=g,this.input=T}static parse(u,g){if(u.length!==3)return g.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const T=g.parse(u[1],1,Lt),D=g.parse(u[2],2,Ai(g.expectedType||yn));return T&&D?new Ll(D.type.itemType,T,D):null}evaluate(u){const g=this.index.evaluate(u),T=this.input.evaluate(u);if(g<0)throw new Rt(`Array index out of bounds: ${g} < 0.`);if(g>=T.length)throw new Rt(`Array index out of bounds: ${g} > ${T.length-1}.`);if(g!==Math.floor(g))throw new Rt(`Array index must be an integer, but found ${g} instead.`);return T[g]}eachChild(u){u(this.index),u(this.input)}outputDefined(){return!1}}class jo{constructor(u,g){this.type=bn,this.needle=u,this.haystack=g}static parse(u,g){if(u.length!==3)return g.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const T=g.parse(u[1],1,yn),D=g.parse(u[2],2,yn);return T&&D?ji(T.type,[bn,Sn,Lt,as,yn])?new jo(T,D):g.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(T.type)} instead`):null}evaluate(u){const g=this.needle.evaluate(u),T=this.haystack.evaluate(u);if(!T)return!1;if(!Di(g,["boolean","string","number","null"]))throw new Rt(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(We(g))} instead.`);if(!Di(T,["string","array"]))throw new Rt(`Expected second argument to be of type array or string, but found ${Xn(We(T))} instead.`);return T.indexOf(g)>=0}eachChild(u){u(this.needle),u(this.haystack)}outputDefined(){return!0}}class pa{constructor(u,g,T){this.type=Lt,this.needle=u,this.haystack=g,this.fromIndex=T}static parse(u,g){if(u.length<=2||u.length>=5)return g.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const T=g.parse(u[1],1,yn),D=g.parse(u[2],2,yn);if(!T||!D)return null;if(!ji(T.type,[bn,Sn,Lt,as,yn]))return g.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(T.type)} instead`);if(u.length===4){const z=g.parse(u[3],3,Lt);return z?new pa(T,D,z):null}return new pa(T,D)}evaluate(u){const g=this.needle.evaluate(u),T=this.haystack.evaluate(u);if(!Di(g,["boolean","string","number","null"]))throw new Rt(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(We(g))} instead.`);if(!Di(T,["string","array"]))throw new Rt(`Expected second argument to be of type array or string, but found ${Xn(We(T))} instead.`);if(this.fromIndex){const D=this.fromIndex.evaluate(u);return T.indexOf(g,D)}return T.indexOf(g)}eachChild(u){u(this.needle),u(this.haystack),this.fromIndex&&u(this.fromIndex)}outputDefined(){return!1}}class _o{constructor(u,g,T,D,z,F){this.inputType=u,this.type=g,this.input=T,this.cases=D,this.outputs=z,this.otherwise=F}static parse(u,g){if(u.length<5)return g.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if(u.length%2!=1)return g.error("Expected an even number of arguments.");let T,D;g.expectedType&&g.expectedType.kind!=="value"&&(D=g.expectedType);const z={},F=[];for(let re=2;re<u.length-1;re+=2){let Ae=u[re];const ce=u[re+1];Array.isArray(Ae)||(Ae=[Ae]);const pe=g.concat(re);if(Ae.length===0)return pe.error("Expected at least one branch label.");for(const _e of Ae){if(typeof _e!="number"&&typeof _e!="string")return pe.error("Branch labels must be numbers or strings.");if(typeof _e=="number"&&Math.abs(_e)>Number.MAX_SAFE_INTEGER)return pe.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof _e=="number"&&Math.floor(_e)!==_e)return pe.error("Numeric branch labels must be integer values.");if(T){if(pe.checkSubtype(T,We(_e)))return null}else T=We(_e);if(z[String(_e)]!==void 0)return pe.error("Branch labels must be unique.");z[String(_e)]=F.length}const ye=g.parse(ce,re,D);if(!ye)return null;D=D||ye.type,F.push(ye)}const $=g.parse(u[1],1,yn);if(!$)return null;const Z=g.parse(u[u.length-1],u.length-1,D);return Z?$.type.kind!=="value"&&g.concat(1).checkSubtype(T,$.type)?null:new _o(T,D,$,z,F,Z):null}evaluate(u){const g=this.input.evaluate(u);return(We(g)===this.inputType&&this.outputs[this.cases[g]]||this.otherwise).evaluate(u)}eachChild(u){u(this.input),this.outputs.forEach(u),u(this.otherwise)}outputDefined(){return this.outputs.every(u=>u.outputDefined())&&this.otherwise.outputDefined()}}class MA{constructor(u,g,T){this.type=u,this.branches=g,this.otherwise=T}static parse(u,g){if(u.length<4)return g.error(`Expected at least 3 arguments, but found only ${u.length-1}.`);if(u.length%2!=0)return g.error("Expected an odd number of arguments.");let T;g.expectedType&&g.expectedType.kind!=="value"&&(T=g.expectedType);const D=[];for(let F=1;F<u.length-1;F+=2){const $=g.parse(u[F],F,bn);if(!$)return null;const Z=g.parse(u[F+1],F+1,T);if(!Z)return null;D.push([$,Z]),T=T||Z.type}const z=g.parse(u[u.length-1],u.length-1,T);if(!z)return null;if(!T)throw new Error("Can't infer output type");return new MA(T,D,z)}evaluate(u){for(const[g,T]of this.branches)if(g.evaluate(u))return T.evaluate(u);return this.otherwise.evaluate(u)}eachChild(u){for(const[g,T]of this.branches)u(g),u(T);u(this.otherwise)}outputDefined(){return this.branches.every(([u,g])=>g.outputDefined())&&this.otherwise.outputDefined()}}class Wa{constructor(u,g,T,D){this.type=u,this.input=g,this.beginIndex=T,this.endIndex=D}static parse(u,g){if(u.length<=2||u.length>=5)return g.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const T=g.parse(u[1],1,yn),D=g.parse(u[2],2,Lt);if(!T||!D)return null;if(!ji(T.type,[Ai(yn),Sn,yn]))return g.error(`Expected first argument to be of type array or string, but found ${Xn(T.type)} instead`);if(u.length===4){const z=g.parse(u[3],3,Lt);return z?new Wa(T.type,T,D,z):null}return new Wa(T.type,T,D)}evaluate(u){const g=this.input.evaluate(u),T=this.beginIndex.evaluate(u);if(!Di(g,["string","array"]))throw new Rt(`Expected first argument to be of type array or string, but found ${Xn(We(g))} instead.`);if(this.endIndex){const D=this.endIndex.evaluate(u);return g.slice(T,D)}return g.slice(T)}eachChild(u){u(this.input),u(this.beginIndex),this.endIndex&&u(this.endIndex)}outputDefined(){return!1}}function Ho(f,u){return f==="=="||f==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function Hi(f,u,g,T){return T.compare(u,g)===0}function Wi(f,u,g){const T=f!=="=="&&f!=="!=";return class gz{constructor(z,F,$){this.type=bn,this.lhs=z,this.rhs=F,this.collator=$,this.hasUntypedArgument=z.type.kind==="value"||F.type.kind==="value"}static parse(z,F){if(z.length!==3&&z.length!==4)return F.error("Expected two or three arguments.");const $=z[0];let Z=F.parse(z[1],1,yn);if(!Z)return null;if(!Ho($,Z.type))return F.concat(1).error(`"${$}" comparisons are not supported for type '${Xn(Z.type)}'.`);let re=F.parse(z[2],2,yn);if(!re)return null;if(!Ho($,re.type))return F.concat(2).error(`"${$}" comparisons are not supported for type '${Xn(re.type)}'.`);if(Z.type.kind!==re.type.kind&&Z.type.kind!=="value"&&re.type.kind!=="value")return F.error(`Cannot compare types '${Xn(Z.type)}' and '${Xn(re.type)}'.`);T&&(Z.type.kind==="value"&&re.type.kind!=="value"?Z=new jt(re.type,[Z]):Z.type.kind!=="value"&&re.type.kind==="value"&&(re=new jt(Z.type,[re])));let Ae=null;if(z.length===4){if(Z.type.kind!=="string"&&re.type.kind!=="string"&&Z.type.kind!=="value"&&re.type.kind!=="value")return F.error("Cannot use collator to compare non-string types.");if(Ae=F.parse(z[3],3,Ye),!Ae)return null}return new gz(Z,re,Ae)}evaluate(z){const F=this.lhs.evaluate(z),$=this.rhs.evaluate(z);if(T&&this.hasUntypedArgument){const Z=We(F),re=We($);if(Z.kind!==re.kind||Z.kind!=="string"&&Z.kind!=="number")throw new Rt(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${Z.kind}, ${re.kind}) instead.`)}if(this.collator&&!T&&this.hasUntypedArgument){const Z=We(F),re=We($);if(Z.kind!=="string"||re.kind!=="string")return u(z,F,$)}return this.collator?g(z,F,$,this.collator.evaluate(z)):u(z,F,$)}eachChild(z){z(this.lhs),z(this.rhs),this.collator&&z(this.collator)}outputDefined(){return!0}}}const au=Wi("==",function(f,u,g){return u===g},Hi),Dl=Wi("!=",function(f,u,g){return u!==g},function(f,u,g,T){return!Hi(0,u,g,T)}),vo=Wi("<",function(f,u,g){return u<g},function(f,u,g,T){return T.compare(u,g)<0}),Wo=Wi(">",function(f,u,g){return u>g},function(f,u,g,T){return T.compare(u,g)>0}),_c=Wi("<=",function(f,u,g){return u<=g},function(f,u,g,T){return T.compare(u,g)<=0}),lu=Wi(">=",function(f,u,g){return u>=g},function(f,u,g,T){return T.compare(u,g)>=0});class Rl{constructor(u,g,T,D,z){this.type=Sn,this.number=u,this.locale=g,this.currency=T,this.minFractionDigits=D,this.maxFractionDigits=z}static parse(u,g){if(u.length!==3)return g.error("Expected two arguments.");const T=g.parse(u[1],1,Lt);if(!T)return null;const D=u[2];if(typeof D!="object"||Array.isArray(D))return g.error("NumberFormat options argument must be an object.");let z=null;if(D.locale&&(z=g.parse(D.locale,1,Sn),!z))return null;let F=null;if(D.currency&&(F=g.parse(D.currency,1,Sn),!F))return null;let $=null;if(D["min-fraction-digits"]&&($=g.parse(D["min-fraction-digits"],1,Lt),!$))return null;let Z=null;return D["max-fraction-digits"]&&(Z=g.parse(D["max-fraction-digits"],1,Lt),!Z)?null:new Rl(T,z,F,$,Z)}evaluate(u){return new Intl.NumberFormat(this.locale?this.locale.evaluate(u):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(u):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(u):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(u):void 0}).format(this.number.evaluate(u))}eachChild(u){u(this.number),this.locale&&u(this.locale),this.currency&&u(this.currency),this.minFractionDigits&&u(this.minFractionDigits),this.maxFractionDigits&&u(this.maxFractionDigits)}outputDefined(){return!1}}class PA{constructor(u){this.type=Qr,this.sections=u}static parse(u,g){if(u.length<2)return g.error("Expected at least one argument.");const T=u[1];if(!Array.isArray(T)&&typeof T=="object")return g.error("First argument must be an image or text section.");const D=[];let z=!1;for(let F=1;F<=u.length-1;++F){const $=u[F];if(z&&typeof $=="object"&&!Array.isArray($)){z=!1;let Z=null;if($["font-scale"]&&(Z=g.parse($["font-scale"],1,Lt),!Z))return null;let re=null;if($["text-font"]&&(re=g.parse($["text-font"],1,Ai(Sn)),!re))return null;let Ae=null;if($["text-color"]&&(Ae=g.parse($["text-color"],1,Lr),!Ae))return null;const ce=D[D.length-1];ce.scale=Z,ce.font=re,ce.textColor=Ae}else{const Z=g.parse(u[F],1,yn);if(!Z)return null;const re=Z.type.kind;if(re!=="string"&&re!=="value"&&re!=="null"&&re!=="resolvedImage")return g.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");z=!0,D.push({content:Z,scale:null,font:null,textColor:null})}}return new PA(D)}evaluate(u){return new ke(this.sections.map(g=>{const T=g.content.evaluate(u);return We(T)===Or?new Le("",T,null,null,null):new Le(dt(T),null,g.scale?g.scale.evaluate(u):null,g.font?g.font.evaluate(u).join(","):null,g.textColor?g.textColor.evaluate(u):null)}))}eachChild(u){for(const g of this.sections)u(g.content),g.scale&&u(g.scale),g.font&&u(g.font),g.textColor&&u(g.textColor)}outputDefined(){return!1}}class Au{constructor(u){this.type=Or,this.input=u}static parse(u,g){if(u.length!==2)return g.error("Expected two arguments.");const T=g.parse(u[1],1,Sn);return T?new Au(T):g.error("No image name provided.")}evaluate(u){const g=this.input.evaluate(u),T=Ie.fromString(g);return T&&u.availableImages&&(T.available=u.availableImages.indexOf(g)>-1),T}eachChild(u){u(this.input)}outputDefined(){return!1}}class Qo{constructor(u){this.type=Lt,this.input=u}static parse(u,g){if(u.length!==2)return g.error(`Expected 1 argument, but found ${u.length-1} instead.`);const T=g.parse(u[1],1);return T?T.type.kind!=="array"&&T.type.kind!=="string"&&T.type.kind!=="value"?g.error(`Expected argument of type string or array, but found ${Xn(T.type)} instead.`):new Qo(T):null}evaluate(u){const g=this.input.evaluate(u);if(typeof g=="string"||Array.isArray(g))return g.length;throw new Rt(`Expected value to be of type string or array, but found ${Xn(We(g))} instead.`)}eachChild(u){u(this.input)}outputDefined(){return!1}}const Qa={"==":au,"!=":Dl,">":Wo,"<":vo,">=":lu,"<=":_c,array:jt,at:Ll,boolean:jt,case:MA,coalesce:ri,collator:Oe,format:PA,image:Au,in:jo,"index-of":pa,interpolate:On,"interpolate-hcl":On,"interpolate-lab":On,length:Qo,let:yo,literal:Dt,match:_o,number:jt,"number-format":Rl,object:jt,slice:Wa,step:Ir,string:jt,"to-boolean":qt,"to-color":qt,"to-number":qt,"to-string":qt,var:lt,within:ni};function uu(f,[u,g,T,D]){u=u.evaluate(f),g=g.evaluate(f),T=T.evaluate(f);const z=D?D.evaluate(f):1,F=qe(u,g,T,z);if(F)throw new Rt(F);return new a(u/255*z,g/255*z,T/255*z,z)}function cu(f,u){return f in u}function xo(f,u){const g=u[f];return g===void 0?null:g}function ga(f){return{type:f}}function hu(f){return{result:"success",value:f}}function ma(f){return{result:"error",value:f}}function fr(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function Vs(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function jn(f){return!!f.expression&&f.expression.interpolated}function Zn(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function wr(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function gr(f){return f}function Bl(f,u){const g=u.type==="color",T=f.stops&&typeof f.stops[0][0]=="object",D=T||!(T||f.property!==void 0),z=f.type||(jn(u)?"exponential":"interval");if(g||u.type==="padding"){const re=g?a.parse:Pe.parse;(f=wi({},f)).stops&&(f.stops=f.stops.map(Ae=>[Ae[0],re(Ae[1])])),f.default=re(f.default?f.default:u.default)}if(f.colorSpace&&f.colorSpace!=="rgb"&&!$o[f.colorSpace])throw new Error(`Unknown color space: ${f.colorSpace}`);let F,$,Z;if(z==="exponential")F=xc;else if(z==="interval")F=qa;else if(z==="categorical"){F=vc,$=Object.create(null);for(const re of f.stops)$[re[0]]=re[1];Z=typeof f.stops[0][0]}else{if(z!=="identity")throw new Error(`Unknown function type "${z}"`);F=fu}if(T){const re={},Ae=[];for(let ye=0;ye<f.stops.length;ye++){const _e=f.stops[ye],Ve=_e[0].zoom;re[Ve]===void 0&&(re[Ve]={zoom:Ve,type:f.type,property:f.property,default:f.default,stops:[]},Ae.push(Ve)),re[Ve].stops.push([_e[0].value,_e[1]])}const ce=[];for(const ye of Ae)ce.push([re[ye].zoom,Bl(re[ye],u)]);const pe={name:"linear"};return{kind:"composite",interpolationType:pe,interpolationFactor:On.interpolationFactor.bind(void 0,pe),zoomStops:ce.map(ye=>ye[0]),evaluate:({zoom:ye},_e)=>xc({stops:ce,base:f.base},u,ye).evaluate(ye,_e)}}if(D){const re=z==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:re,interpolationFactor:On.interpolationFactor.bind(void 0,re),zoomStops:f.stops.map(Ae=>Ae[0]),evaluate:({zoom:Ae})=>F(f,u,Ae,$,Z)}}return{kind:"source",evaluate(re,Ae){const ce=Ae&&Ae.properties?Ae.properties[f.property]:void 0;return ce===void 0?qo(f.default,u.default):F(f,u,ce,$,Z)}}}function qo(f,u,g){return f!==void 0?f:u!==void 0?u:g!==void 0?g:void 0}function vc(f,u,g,T,D){return qo(typeof g===D?T[g]:void 0,f.default,u.default)}function qa(f,u,g){if(Zn(g)!=="number")return qo(f.default,u.default);const T=f.stops.length;if(T===1||g<=f.stops[0][0])return f.stops[0][1];if(g>=f.stops[T-1][0])return f.stops[T-1][1];const D=Ln(f.stops.map(z=>z[0]),g);return f.stops[D][1]}function xc(f,u,g){const T=f.base!==void 0?f.base:1;if(Zn(g)!=="number")return qo(f.default,u.default);const D=f.stops.length;if(D===1||g<=f.stops[0][0])return f.stops[0][1];if(g>=f.stops[D-1][0])return f.stops[D-1][1];const z=Ln(f.stops.map(Ae=>Ae[0]),g),F=function(Ae,ce,pe,ye){const _e=ye-pe,Ve=Ae-pe;return _e===0?0:ce===1?Ve/_e:(Math.pow(ce,Ve)-1)/(Math.pow(ce,_e)-1)}(g,T,f.stops[z][0],f.stops[z+1][0]),$=f.stops[z][1],Z=f.stops[z+1][1];let re=Dr[u.type]||gr;if(f.colorSpace&&f.colorSpace!=="rgb"){const Ae=$o[f.colorSpace];re=(ce,pe)=>Ae.reverse(Ae.interpolate(Ae.forward(ce),Ae.forward(pe),F))}return typeof $.evaluate=="function"?{evaluate(...Ae){const ce=$.evaluate.apply(void 0,Ae),pe=Z.evaluate.apply(void 0,Ae);if(ce!==void 0&&pe!==void 0)return re(ce,pe,F)}}:re($,Z,F)}function fu(f,u,g){switch(u.type){case"color":g=a.parse(g);break;case"formatted":g=ke.fromString(g.toString());break;case"resolvedImage":g=Ie.fromString(g.toString());break;case"padding":g=Pe.parse(g);break;default:Zn(g)===u.type||u.type==="enum"&&u.values[g]||(g=void 0)}return qo(g,f.default,u.default)}Ft.register(Qa,{error:[{kind:"error"},[Sn],(f,[u])=>{throw new Rt(u.evaluate(f))}],typeof:[Sn,[yn],(f,[u])=>Xn(We(u.evaluate(f)))],"to-rgba":[Ai(Lt,4),[Lr],(f,[u])=>u.evaluate(f).toArray()],rgb:[Lr,[Lt,Lt,Lt],uu],rgba:[Lr,[Lt,Lt,Lt,Lt],uu],has:{type:bn,overloads:[[[Sn],(f,[u])=>cu(u.evaluate(f),f.properties())],[[Sn,bs],(f,[u,g])=>cu(u.evaluate(f),g.evaluate(f))]]},get:{type:yn,overloads:[[[Sn],(f,[u])=>xo(u.evaluate(f),f.properties())],[[Sn,bs],(f,[u,g])=>xo(u.evaluate(f),g.evaluate(f))]]},"feature-state":[yn,[Sn],(f,[u])=>xo(u.evaluate(f),f.featureState||{})],properties:[bs,[],f=>f.properties()],"geometry-type":[Sn,[],f=>f.geometryType()],id:[yn,[],f=>f.id()],zoom:[Lt,[],f=>f.globals.zoom],"heatmap-density":[Lt,[],f=>f.globals.heatmapDensity||0],"line-progress":[Lt,[],f=>f.globals.lineProgress||0],accumulated:[yn,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[Lt,ga(Lt),(f,u)=>{let g=0;for(const T of u)g+=T.evaluate(f);return g}],"*":[Lt,ga(Lt),(f,u)=>{let g=1;for(const T of u)g*=T.evaluate(f);return g}],"-":{type:Lt,overloads:[[[Lt,Lt],(f,[u,g])=>u.evaluate(f)-g.evaluate(f)],[[Lt],(f,[u])=>-u.evaluate(f)]]},"/":[Lt,[Lt,Lt],(f,[u,g])=>u.evaluate(f)/g.evaluate(f)],"%":[Lt,[Lt,Lt],(f,[u,g])=>u.evaluate(f)%g.evaluate(f)],ln2:[Lt,[],()=>Math.LN2],pi:[Lt,[],()=>Math.PI],e:[Lt,[],()=>Math.E],"^":[Lt,[Lt,Lt],(f,[u,g])=>Math.pow(u.evaluate(f),g.evaluate(f))],sqrt:[Lt,[Lt],(f,[u])=>Math.sqrt(u.evaluate(f))],log10:[Lt,[Lt],(f,[u])=>Math.log(u.evaluate(f))/Math.LN10],ln:[Lt,[Lt],(f,[u])=>Math.log(u.evaluate(f))],log2:[Lt,[Lt],(f,[u])=>Math.log(u.evaluate(f))/Math.LN2],sin:[Lt,[Lt],(f,[u])=>Math.sin(u.evaluate(f))],cos:[Lt,[Lt],(f,[u])=>Math.cos(u.evaluate(f))],tan:[Lt,[Lt],(f,[u])=>Math.tan(u.evaluate(f))],asin:[Lt,[Lt],(f,[u])=>Math.asin(u.evaluate(f))],acos:[Lt,[Lt],(f,[u])=>Math.acos(u.evaluate(f))],atan:[Lt,[Lt],(f,[u])=>Math.atan(u.evaluate(f))],min:[Lt,ga(Lt),(f,u)=>Math.min(...u.map(g=>g.evaluate(f)))],max:[Lt,ga(Lt),(f,u)=>Math.max(...u.map(g=>g.evaluate(f)))],abs:[Lt,[Lt],(f,[u])=>Math.abs(u.evaluate(f))],round:[Lt,[Lt],(f,[u])=>{const g=u.evaluate(f);return g<0?-Math.round(-g):Math.round(g)}],floor:[Lt,[Lt],(f,[u])=>Math.floor(u.evaluate(f))],ceil:[Lt,[Lt],(f,[u])=>Math.ceil(u.evaluate(f))],"filter-==":[bn,[Sn,yn],(f,[u,g])=>f.properties()[u.value]===g.value],"filter-id-==":[bn,[yn],(f,[u])=>f.id()===u.value],"filter-type-==":[bn,[Sn],(f,[u])=>f.geometryType()===u.value],"filter-<":[bn,[Sn,yn],(f,[u,g])=>{const T=f.properties()[u.value],D=g.value;return typeof T==typeof D&&T<D}],"filter-id-<":[bn,[yn],(f,[u])=>{const g=f.id(),T=u.value;return typeof g==typeof T&&g<T}],"filter->":[bn,[Sn,yn],(f,[u,g])=>{const T=f.properties()[u.value],D=g.value;return typeof T==typeof D&&T>D}],"filter-id->":[bn,[yn],(f,[u])=>{const g=f.id(),T=u.value;return typeof g==typeof T&&g>T}],"filter-<=":[bn,[Sn,yn],(f,[u,g])=>{const T=f.properties()[u.value],D=g.value;return typeof T==typeof D&&T<=D}],"filter-id-<=":[bn,[yn],(f,[u])=>{const g=f.id(),T=u.value;return typeof g==typeof T&&g<=T}],"filter->=":[bn,[Sn,yn],(f,[u,g])=>{const T=f.properties()[u.value],D=g.value;return typeof T==typeof D&&T>=D}],"filter-id->=":[bn,[yn],(f,[u])=>{const g=f.id(),T=u.value;return typeof g==typeof T&&g>=T}],"filter-has":[bn,[yn],(f,[u])=>u.value in f.properties()],"filter-has-id":[bn,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[bn,[Ai(Sn)],(f,[u])=>u.value.indexOf(f.geometryType())>=0],"filter-id-in":[bn,[Ai(yn)],(f,[u])=>u.value.indexOf(f.id())>=0],"filter-in-small":[bn,[Sn,Ai(yn)],(f,[u,g])=>g.value.indexOf(f.properties()[u.value])>=0],"filter-in-large":[bn,[Sn,Ai(yn)],(f,[u,g])=>function(T,D,z,F){for(;z<=F;){const $=z+F>>1;if(D[$]===T)return!0;D[$]>T?F=$-1:z=$+1}return!1}(f.properties()[u.value],g.value,0,g.value.length-1)],all:{type:bn,overloads:[[[bn,bn],(f,[u,g])=>u.evaluate(f)&&g.evaluate(f)],[ga(bn),(f,u)=>{for(const g of u)if(!g.evaluate(f))return!1;return!0}]]},any:{type:bn,overloads:[[[bn,bn],(f,[u,g])=>u.evaluate(f)||g.evaluate(f)],[ga(bn),(f,u)=>{for(const g of u)if(g.evaluate(f))return!0;return!1}]]},"!":[bn,[bn],(f,[u])=>!u.evaluate(f)],"is-supported-script":[bn,[Sn],(f,[u])=>{const g=f.globals&&f.globals.isSupportedScript;return!g||g(u.evaluate(f))}],upcase:[Sn,[Sn],(f,[u])=>u.evaluate(f).toUpperCase()],downcase:[Sn,[Sn],(f,[u])=>u.evaluate(f).toLowerCase()],concat:[Sn,ga(yn),(f,u)=>u.map(g=>dt(g.evaluate(f))).join("")],"resolved-locale":[Sn,[Ye],(f,[u])=>u.evaluate(f).resolvedLocale()]});class Gs{constructor(u,g){this.expression=u,this._warningHistory={},this._evaluator=new xn,this._defaultValue=g?function(T){return T.type==="color"&&wr(T.default)?new a(0,0,0,0):T.type==="color"?a.parse(T.default)||null:T.type==="padding"?Pe.parse(T.default)||null:T.default===void 0?null:T.default}(g):null,this._enumValues=g&&g.type==="enum"?g.values:null}evaluateWithoutErrorHandling(u,g,T,D,z,F){return this._evaluator.globals=u,this._evaluator.feature=g,this._evaluator.featureState=T,this._evaluator.canonical=D,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=F,this.expression.evaluate(this._evaluator)}evaluate(u,g,T,D,z,F){this._evaluator.globals=u,this._evaluator.feature=g||null,this._evaluator.featureState=T||null,this._evaluator.canonical=D,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=F||null;try{const $=this.expression.evaluate(this._evaluator);if($==null||typeof $=="number"&&$!=$)return this._defaultValue;if(this._enumValues&&!($ in this._enumValues))throw new Rt(`Expected value to be one of ${Object.keys(this._enumValues).map(Z=>JSON.stringify(Z)).join(", ")}, but found ${JSON.stringify($)} instead.`);return $}catch($){return this._warningHistory[$.message]||(this._warningHistory[$.message]=!0,typeof console<"u"&&console.warn($.message)),this._defaultValue}}}function zl(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in Qa}function Za(f,u){const g=new bt(Qa,[],u?function(D){const z={color:Lr,string:Sn,number:Lt,enum:Sn,boolean:bn,formatted:Qr,padding:Ns,resolvedImage:Or};return D.type==="array"?Ai(z[D.value]||yn,D.length):z[D.type]}(u):void 0),T=g.parse(f,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return T?hu(new Gs(T,u)):ma(g.errors)}class ya{constructor(u,g){this.kind=u,this._styleExpression=g,this.isStateDependent=u!=="constant"&&!Ee(g.expression)}evaluateWithoutErrorHandling(u,g,T,D,z,F){return this._styleExpression.evaluateWithoutErrorHandling(u,g,T,D,z,F)}evaluate(u,g,T,D,z,F){return this._styleExpression.evaluate(u,g,T,D,z,F)}}class Ol{constructor(u,g,T,D){this.kind=u,this.zoomStops=T,this._styleExpression=g,this.isStateDependent=u!=="camera"&&!Ee(g.expression),this.interpolationType=D}evaluateWithoutErrorHandling(u,g,T,D,z,F){return this._styleExpression.evaluateWithoutErrorHandling(u,g,T,D,z,F)}evaluate(u,g,T,D,z,F){return this._styleExpression.evaluate(u,g,T,D,z,F)}interpolationFactor(u,g,T){return this.interpolationType?On.interpolationFactor(this.interpolationType,u,g,T):0}}function Fl(f,u){const g=Za(f,u);if(g.result==="error")return g;const T=g.value.expression,D=ge(T);if(!D&&!fr(u))return ma([new Ii("","data expressions not supported")]);const z=Fe(T,["zoom"]);if(!z&&!Vs(u))return ma([new Ii("","zoom expressions not supported")]);const F=kA(T);return F||z?F instanceof Ii?ma([F]):F instanceof On&&!jn(u)?ma([new Ii("",'"interpolate" expressions cannot be used with this property')]):hu(F?new Ol(D?"camera":"composite",g.value,F.labels,F instanceof On?F.interpolation:void 0):new ya(D?"constant":"source",g.value)):ma([new Ii("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class mr{constructor(u,g){this._parameters=u,this._specification=g,wi(this,Bl(this._parameters,this._specification))}static deserialize(u){return new mr(u._parameters,u._specification)}static serialize(u){return{_parameters:u._parameters,_specification:u._specification}}}function kA(f){let u=null;if(f instanceof yo)u=kA(f.result);else if(f instanceof ri){for(const g of f.args)if(u=kA(g),u)break}else(f instanceof Ir||f instanceof On)&&f.input instanceof Ft&&f.input.name==="zoom"&&(u=f);return u instanceof Ii||f.eachChild(g=>{const T=kA(g);T instanceof Ii?u=T:!u&&T?u=new Ii("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):u&&T&&u!==T&&(u=new Ii("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),u}function As(f){const u=f.key,g=f.value,T=f.valueSpec||{},D=f.objectElementValidators||{},z=f.style,F=f.styleSpec;let $=[];const Z=Zn(g);if(Z!=="object")return[new It(u,g,`object expected, ${Z} found`)];for(const re in g){const Ae=re.split(".")[0],ce=T[Ae]||T["*"];let pe;if(D[Ae])pe=D[Ae];else if(T[Ae])pe=Ki;else if(D["*"])pe=D["*"];else{if(!T["*"]){$.push(new It(u,g[re],`unknown property "${re}"`));continue}pe=Ki}$=$.concat(pe({key:(u&&`${u}.`)+re,value:g[re],valueSpec:ce,style:z,styleSpec:F,object:g,objectKey:re},g))}for(const re in T)D[re]||T[re].required&&T[re].default===void 0&&g[re]===void 0&&$.push(new It(u,g,`missing required property "${re}"`));return $}function du(f){const u=f.value,g=f.valueSpec,T=f.style,D=f.styleSpec,z=f.key,F=f.arrayElementValidator||Ki;if(Zn(u)!=="array")return[new It(z,u,`array expected, ${Zn(u)} found`)];if(g.length&&u.length!==g.length)return[new It(z,u,`array length ${g.length} expected, length ${u.length} found`)];if(g["min-length"]&&u.length<g["min-length"])return[new It(z,u,`array length at least ${g["min-length"]} expected, length ${u.length} found`)];let $={type:g.value,values:g.values};D.$version<7&&($.function=g.function),Zn(g.value)==="object"&&($=g.value);let Z=[];for(let re=0;re<u.length;re++)Z=Z.concat(F({array:u,arrayIndex:re,value:u[re],valueSpec:$,style:T,styleSpec:D,key:`${z}[${re}]`}));return Z}function Nl(f){const u=f.key,g=f.value,T=f.valueSpec;let D=Zn(g);return D==="number"&&g!=g&&(D="NaN"),D!=="number"?[new It(u,g,`number expected, ${D} found`)]:"minimum"in T&&g<T.minimum?[new It(u,g,`${g} is less than the minimum value ${T.minimum}`)]:"maximum"in T&&g>T.maximum?[new It(u,g,`${g} is greater than the maximum value ${T.maximum}`)]:[]}function wc(f){const u=f.valueSpec,g=zn(f.value.type);let T,D,z,F={};const $=g!=="categorical"&&f.value.property===void 0,Z=!$,re=Zn(f.value.stops)==="array"&&Zn(f.value.stops[0])==="array"&&Zn(f.value.stops[0][0])==="object",Ae=As({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(ye){if(g==="identity")return[new It(ye.key,ye.value,'identity function may not have a "stops" property')];let _e=[];const Ve=ye.value;return _e=_e.concat(du({key:ye.key,value:Ve,valueSpec:ye.valueSpec,style:ye.style,styleSpec:ye.styleSpec,arrayElementValidator:ce})),Zn(Ve)==="array"&&Ve.length===0&&_e.push(new It(ye.key,Ve,"array must have at least one stop")),_e},default:function(ye){return Ki({key:ye.key,value:ye.value,valueSpec:u,style:ye.style,styleSpec:ye.styleSpec})}}});return g==="identity"&&$&&Ae.push(new It(f.key,f.value,'missing required property "property"')),g==="identity"||f.value.stops||Ae.push(new It(f.key,f.value,'missing required property "stops"')),g==="exponential"&&f.valueSpec.expression&&!jn(f.valueSpec)&&Ae.push(new It(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(Z&&!fr(f.valueSpec)?Ae.push(new It(f.key,f.value,"property functions not supported")):$&&!Vs(f.valueSpec)&&Ae.push(new It(f.key,f.value,"zoom functions not supported"))),g!=="categorical"&&!re||f.value.property!==void 0||Ae.push(new It(f.key,f.value,'"property" property is required')),Ae;function ce(ye){let _e=[];const Ve=ye.value,ze=ye.key;if(Zn(Ve)!=="array")return[new It(ze,Ve,`array expected, ${Zn(Ve)} found`)];if(Ve.length!==2)return[new It(ze,Ve,`array length 2 expected, length ${Ve.length} found`)];if(re){if(Zn(Ve[0])!=="object")return[new It(ze,Ve,`object expected, ${Zn(Ve[0])} found`)];if(Ve[0].zoom===void 0)return[new It(ze,Ve,"object stop key must have zoom")];if(Ve[0].value===void 0)return[new It(ze,Ve,"object stop key must have value")];if(z&&z>zn(Ve[0].zoom))return[new It(ze,Ve[0].zoom,"stop zoom values must appear in ascending order")];zn(Ve[0].zoom)!==z&&(z=zn(Ve[0].zoom),D=void 0,F={}),_e=_e.concat(As({key:`${ze}[0]`,value:Ve[0],valueSpec:{zoom:{}},style:ye.style,styleSpec:ye.styleSpec,objectElementValidators:{zoom:Nl,value:pe}}))}else _e=_e.concat(pe({key:`${ze}[0]`,value:Ve[0],valueSpec:{},style:ye.style,styleSpec:ye.styleSpec},Ve));return zl(Gi(Ve[1]))?_e.concat([new It(`${ze}[1]`,Ve[1],"expressions are not allowed in function stops.")]):_e.concat(Ki({key:`${ze}[1]`,value:Ve[1],valueSpec:u,style:ye.style,styleSpec:ye.styleSpec}))}function pe(ye,_e){const Ve=Zn(ye.value),ze=zn(ye.value),tt=ye.value!==null?ye.value:_e;if(T){if(Ve!==T)return[new It(ye.key,tt,`${Ve} stop domain type must match previous stop domain type ${T}`)]}else T=Ve;if(Ve!=="number"&&Ve!=="string"&&Ve!=="boolean")return[new It(ye.key,tt,"stop domain value must be a number, string, or boolean")];if(Ve!=="number"&&g!=="categorical"){let ut=`number expected, ${Ve} found`;return fr(u)&&g===void 0&&(ut+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new It(ye.key,tt,ut)]}return g!=="categorical"||Ve!=="number"||isFinite(ze)&&Math.floor(ze)===ze?g!=="categorical"&&Ve==="number"&&D!==void 0&&ze<D?[new It(ye.key,tt,"stop domain values must appear in ascending order")]:(D=ze,g==="categorical"&&ze in F?[new It(ye.key,tt,"stop domain values must be unique")]:(F[ze]=!0,[])):[new It(ye.key,tt,`integer expected, found ${ze}`)]}}function Zr(f){const u=(f.expressionContext==="property"?Fl:Za)(Gi(f.value),f.valueSpec);if(u.result==="error")return u.value.map(T=>new It(`${f.key}${T.key}`,f.value,T.message));const g=u.value.expression||u.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!g.outputDefined())return[new It(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!Ee(g))return[new It(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!Ee(g))return[new It(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!Fe(g,["zoom","feature-state"]))return[new It(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!ge(g))return[new It(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Rr(f){const u=f.key,g=f.value,T=f.valueSpec,D=[];return Array.isArray(T.values)?T.values.indexOf(zn(g))===-1&&D.push(new It(u,g,`expected one of [${T.values.join(", ")}], ${JSON.stringify(g)} found`)):Object.keys(T.values).indexOf(zn(g))===-1&&D.push(new It(u,g,`expected one of [${Object.keys(T.values).join(", ")}], ${JSON.stringify(g)} found`)),D}function ii(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const u of f.slice(1))if(!ii(u)&&typeof u!="boolean")return!1;return!0;default:return!0}}const pu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function $s(f){if(f==null)return{filter:()=>!0,needGeometry:!1};ii(f)||(f=ci(f));const u=Za(f,pu);if(u.result==="error")throw new Error(u.value.map(g=>`${g.key}: ${g.message}`).join(", "));return{filter:(g,T,D)=>u.value.evaluate(g,T,{},D),needGeometry:IA(f)}}function bc(f,u){return f<u?-1:f>u?1:0}function IA(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(let u=1;u<f.length;u++)if(IA(f[u]))return!0;return!1}function ci(f){if(!f)return!0;const u=f[0];return f.length<=1?u!=="any":u==="=="?bi(f[1],f[2],"=="):u==="!="?Xi(bi(f[1],f[2],"==")):u==="<"||u===">"||u==="<="||u===">="?bi(f[1],f[2],u):u==="any"?(g=f.slice(1),["any"].concat(g.map(ci))):u==="all"?["all"].concat(f.slice(1).map(ci)):u==="none"?["all"].concat(f.slice(1).map(ci).map(Xi)):u==="in"?us(f[1],f.slice(2)):u==="!in"?Xi(us(f[1],f.slice(2))):u==="has"?_a(f[1]):u==="!has"?Xi(_a(f[1])):u!=="within"||f;var g}function bi(f,u,g){switch(f){case"$type":return[`filter-type-${g}`,u];case"$id":return[`filter-id-${g}`,u];default:return[`filter-${g}`,f,u]}}function us(f,u){if(u.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(g=>typeof g!=typeof u[0])?["filter-in-large",f,["literal",u.sort(bc)]]:["filter-in-small",f,["literal",u]]}}function _a(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function Xi(f){return["!",f]}function wo(f){return ii(Gi(f.value))?Zr(wi({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):pi(f)}function pi(f){const u=f.value,g=f.key;if(Zn(u)!=="array")return[new It(g,u,`array expected, ${Zn(u)} found`)];const T=f.styleSpec;let D,z=[];if(u.length<1)return[new It(g,u,"filter array must have at least 1 element")];switch(z=z.concat(Rr({key:`${g}[0]`,value:u[0],valueSpec:T.filter_operator,style:f.style,styleSpec:f.styleSpec})),zn(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&zn(u[1])==="$type"&&z.push(new It(g,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&z.push(new It(g,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(D=Zn(u[1]),D!=="string"&&z.push(new It(`${g}[1]`,u[1],`string expected, ${D} found`)));for(let F=2;F<u.length;F++)D=Zn(u[F]),zn(u[1])==="$type"?z=z.concat(Rr({key:`${g}[${F}]`,value:u[F],valueSpec:T.geometry_type,style:f.style,styleSpec:f.styleSpec})):D!=="string"&&D!=="number"&&D!=="boolean"&&z.push(new It(`${g}[${F}]`,u[F],`string, number, or boolean expected, ${D} found`));break;case"any":case"all":case"none":for(let F=1;F<u.length;F++)z=z.concat(pi({key:`${g}[${F}]`,value:u[F],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":D=Zn(u[1]),u.length!==2?z.push(new It(g,u,`filter array for "${u[0]}" operator must have 2 elements`)):D!=="string"&&z.push(new It(`${g}[1]`,u[1],`string expected, ${D} found`));break;case"within":D=Zn(u[1]),u.length!==2?z.push(new It(g,u,`filter array for "${u[0]}" operator must have 2 elements`)):D!=="object"&&z.push(new It(`${g}[1]`,u[1],`object expected, ${D} found`))}return z}function Ya(f,u){const g=f.key,T=f.style,D=f.styleSpec,z=f.value,F=f.objectKey,$=D[`${u}_${f.layerType}`];if(!$)return[];const Z=F.match(/^(.*)-transition$/);if(u==="paint"&&Z&&$[Z[1]]&&$[Z[1]].transition)return Ki({key:g,value:z,valueSpec:D.transition,style:T,styleSpec:D});const re=f.valueSpec||$[F];if(!re)return[new It(g,z,`unknown property "${F}"`)];let Ae;if(Zn(z)==="string"&&fr(re)&&!re.tokens&&(Ae=/^{([^}]+)}$/.exec(z)))return[new It(g,z,`"${F}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Ae[1])} }\`.`)];const ce=[];return f.layerType==="symbol"&&(F==="text-field"&&T&&!T.glyphs&&ce.push(new It(g,z,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&wr(Gi(z))&&zn(z.type)==="identity"&&ce.push(new It(g,z,'"text-font" does not support identity functions'))),ce.concat(Ki({key:f.key,value:z,valueSpec:re,style:T,styleSpec:D,expressionContext:"property",propertyType:u,propertyKey:F}))}function Ul(f){return Ya(f,"paint")}function Xa(f){return Ya(f,"layout")}function js(f){let u=[];const g=f.value,T=f.key,D=f.style,z=f.styleSpec;g.type||g.ref||u.push(new It(T,g,'either "type" or "ref" is required'));let F=zn(g.type);const $=zn(g.ref);if(g.id){const Z=zn(g.id);for(let re=0;re<f.arrayIndex;re++){const Ae=D.layers[re];zn(Ae.id)===Z&&u.push(new It(T,g.id,`duplicate layer id "${g.id}", previously used at line ${Ae.id.__line__}`))}}if("ref"in g){let Z;["type","source","source-layer","filter","layout"].forEach(re=>{re in g&&u.push(new It(T,g[re],`"${re}" is prohibited for ref layers`))}),D.layers.forEach(re=>{zn(re.id)===$&&(Z=re)}),Z?Z.ref?u.push(new It(T,g.ref,"ref cannot reference another ref layer")):F=zn(Z.type):u.push(new It(T,g.ref,`ref layer "${$}" not found`))}else if(F!=="background")if(g.source){const Z=D.sources&&D.sources[g.source],re=Z&&zn(Z.type);Z?re==="vector"&&F==="raster"?u.push(new It(T,g.source,`layer "${g.id}" requires a raster source`)):re==="raster"&&F!=="raster"?u.push(new It(T,g.source,`layer "${g.id}" requires a vector source`)):re!=="vector"||g["source-layer"]?re==="raster-dem"&&F!=="hillshade"?u.push(new It(T,g.source,"raster-dem source can only be used with layer type 'hillshade'.")):F!=="line"||!g.paint||!g.paint["line-gradient"]||re==="geojson"&&Z.lineMetrics||u.push(new It(T,g,`layer "${g.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new It(T,g,`layer "${g.id}" must specify a "source-layer"`)):u.push(new It(T,g.source,`source "${g.source}" not found`))}else u.push(new It(T,g,'missing required property "source"'));return u=u.concat(As({key:T,value:g,valueSpec:z.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ki({key:`${T}.type`,value:g.type,valueSpec:z.layer.type,style:f.style,styleSpec:f.styleSpec,object:g,objectKey:"type"}),filter:wo,layout:Z=>As({layer:g,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":re=>Xa(wi({layerType:F},re))}}),paint:Z=>As({layer:g,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":re=>Ul(wi({layerType:F},re))}})}})),u}function cs(f){const u=f.value,g=f.key,T=Zn(u);return T!=="string"?[new It(g,u,`string expected, ${T} found`)]:[]}const Ec={promoteId:function({key:f,value:u}){if(Zn(u)==="string")return cs({key:f,value:u});{const g=[];for(const T in u)g.push(...cs({key:`${f}.${T}`,value:u[T]}));return g}}};function va(f){const u=f.value,g=f.key,T=f.styleSpec,D=f.style;if(!u.type)return[new It(g,u,'"type" is required')];const z=zn(u.type);let F;switch(z){case"vector":case"raster":case"raster-dem":return F=As({key:g,value:u,valueSpec:T[`source_${z.replace("-","_")}`],style:f.style,styleSpec:T,objectElementValidators:Ec}),F;case"geojson":if(F=As({key:g,value:u,valueSpec:T.source_geojson,style:D,styleSpec:T,objectElementValidators:Ec}),u.cluster)for(const $ in u.clusterProperties){const[Z,re]=u.clusterProperties[$],Ae=typeof Z=="string"?[Z,["accumulated"],["get",$]]:Z;F.push(...Zr({key:`${g}.${$}.map`,value:re,expressionContext:"cluster-map"})),F.push(...Zr({key:`${g}.${$}.reduce`,value:Ae,expressionContext:"cluster-reduce"}))}return F;case"video":return As({key:g,value:u,valueSpec:T.source_video,style:D,styleSpec:T});case"image":return As({key:g,value:u,valueSpec:T.source_image,style:D,styleSpec:T});case"canvas":return[new It(g,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Rr({key:`${g}.type`,value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:D,styleSpec:T})}}function Ka(f){const u=f.value,g=f.styleSpec,T=g.light,D=f.style;let z=[];const F=Zn(u);if(u===void 0)return z;if(F!=="object")return z=z.concat([new It("light",u,`object expected, ${F} found`)]),z;for(const $ in u){const Z=$.match(/^(.*)-transition$/);z=z.concat(Z&&T[Z[1]]&&T[Z[1]].transition?Ki({key:$,value:u[$],valueSpec:g.transition,style:D,styleSpec:g}):T[$]?Ki({key:$,value:u[$],valueSpec:T[$],style:D,styleSpec:g}):[new It($,u[$],`unknown property "${$}"`)])}return z}function si(f){const u=f.value,g=f.styleSpec,T=g.terrain,D=f.style;let z=[];const F=Zn(u);if(u===void 0)return z;if(F!=="object")return z=z.concat([new It("terrain",u,`object expected, ${F} found`)]),z;for(const $ in u)z=z.concat(T[$]?Ki({key:$,value:u[$],valueSpec:T[$],style:D,styleSpec:g}):[new It($,u[$],`unknown property "${$}"`)]);return z}const Ss={"*":()=>[],array:du,boolean:function(f){const u=f.value,g=f.key,T=Zn(u);return T!=="boolean"?[new It(g,u,`boolean expected, ${T} found`)]:[]},number:Nl,color:function(f){const u=f.key,g=f.value,T=Zn(g);return T!=="string"?[new It(u,g,`color expected, ${T} found`)]:ls(g)===null?[new It(u,g,`color expected, "${g}" found`)]:[]},constants:Fs,enum:Rr,filter:wo,function:wc,layer:js,object:As,source:va,light:Ka,terrain:si,string:cs,formatted:function(f){return cs(f).length===0?[]:Zr(f)},resolvedImage:function(f){return cs(f).length===0?[]:Zr(f)},padding:function(f){const u=f.key,g=f.value;if(Zn(g)==="array"){if(g.length<1||g.length>4)return[new It(u,g,`padding requires 1 to 4 values; ${g.length} values found`)];const T={type:"number"};let D=[];for(let z=0;z<g.length;z++)D=D.concat(Ki({key:`${u}[${z}]`,value:g[z],valueSpec:T}));return D}return Nl({key:u,value:g,valueSpec:{}})}};function Ki(f){const u=f.value,g=f.valueSpec,T=f.styleSpec;return g.expression&&wr(zn(u))?wc(f):g.expression&&zl(Gi(u))?Zr(f):g.type&&Ss[g.type]?Ss[g.type](f):As(wi({},f,{valueSpec:g.type?T[g.type]:g}))}function Vl(f){const u=f.value,g=f.key,T=cs(f);return T.length||(u.indexOf("{fontstack}")===-1&&T.push(new It(g,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&T.push(new It(g,u,'"glyphs" url must include a "{range}" token'))),T}function Zo(f,u=ht){let g=[];return g=g.concat(Ki({key:"",value:f,valueSpec:u.$root,styleSpec:u,style:f,objectElementValidators:{glyphs:Vl,"*":()=>[]}})),f.constants&&(g=g.concat(Fs({key:"constants",value:f.constants,style:f,styleSpec:u}))),Tc(g)}function Tc(f){return[].concat(f).sort((u,g)=>u.line-g.line)}function bo(f){return function(...u){return Tc(f.apply(this,u))}}Zo.source=bo(va),Zo.light=bo(Ka),Zo.terrain=bo(si),Zo.layer=bo(js),Zo.filter=bo(wo),Zo.paintProperty=bo(Ul),Zo.layoutProperty=bo(Xa);const Gl=Zo,Ja=Gl.light,Ch=Gl.paintProperty,Mh=Gl.layoutProperty;function el(f,u){let g=!1;if(u&&u.length)for(const T of u)f.fire(new Vo(new Error(T.message))),g=!0;return g}class xa{constructor(u,g,T){const D=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;const F=new Int32Array(this.arrayBuffer);u=F[0],this.d=(g=F[1])+2*(T=F[2]);for(let Z=0;Z<this.d*this.d;Z++){const re=F[3+Z],Ae=F[3+Z+1];D.push(re===Ae?null:F.subarray(re,Ae))}const $=F[3+D.length+1];this.keys=F.subarray(F[3+D.length],$),this.bboxes=F.subarray($),this.insert=this._insertReadonly}else{this.d=g+2*T;for(let F=0;F<this.d*this.d;F++)D.push([]);this.keys=[],this.bboxes=[]}this.n=g,this.extent=u,this.padding=T,this.scale=g/u,this.uid=0;const z=T/g*u;this.min=-z,this.max=u+z}insert(u,g,T,D,z){this._forEachCell(g,T,D,z,this._insertCell,this.uid++,void 0,void 0),this.keys.push(u),this.bboxes.push(g),this.bboxes.push(T),this.bboxes.push(D),this.bboxes.push(z)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(u,g,T,D,z,F){this.cells[z].push(F)}query(u,g,T,D,z){const F=this.min,$=this.max;if(u<=F&&g<=F&&$<=T&&$<=D&&!z)return Array.prototype.slice.call(this.keys);{const Z=[];return this._forEachCell(u,g,T,D,this._queryCell,Z,{},z),Z}}_queryCell(u,g,T,D,z,F,$,Z){const re=this.cells[z];if(re!==null){const Ae=this.keys,ce=this.bboxes;for(let pe=0;pe<re.length;pe++){const ye=re[pe];if($[ye]===void 0){const _e=4*ye;(Z?Z(ce[_e+0],ce[_e+1],ce[_e+2],ce[_e+3]):u<=ce[_e+2]&&g<=ce[_e+3]&&T>=ce[_e+0]&&D>=ce[_e+1])?($[ye]=!0,F.push(Ae[ye])):$[ye]=!1}}}}_forEachCell(u,g,T,D,z,F,$,Z){const re=this._convertToCellCoord(u),Ae=this._convertToCellCoord(g),ce=this._convertToCellCoord(T),pe=this._convertToCellCoord(D);for(let ye=re;ye<=ce;ye++)for(let _e=Ae;_e<=pe;_e++){const Ve=this.d*_e+ye;if((!Z||Z(this._convertFromCellCoord(ye),this._convertFromCellCoord(_e),this._convertFromCellCoord(ye+1),this._convertFromCellCoord(_e+1)))&&z.call(this,u,g,T,D,Ve,F,$,Z))return}}_convertFromCellCoord(u){return(u-this.padding)/this.scale}_convertToCellCoord(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const u=this.cells,g=3+this.cells.length+1+1;let T=0;for(let F=0;F<this.cells.length;F++)T+=this.cells[F].length;const D=new Int32Array(g+T+this.keys.length+this.bboxes.length);D[0]=this.extent,D[1]=this.n,D[2]=this.padding;let z=g;for(let F=0;F<u.length;F++){const $=u[F];D[3+F]=z,D.set($,z),z+=$.length}return D[3+u.length]=z,D.set(this.keys,z),z+=this.keys.length,D[3+u.length+1]=z,D.set(this.bboxes,z),z+=this.bboxes.length,D.buffer}static serialize(u,g){const T=u.toArrayBuffer();return g&&g.push(T),{buffer:T}}static deserialize(u){return new xa(u.buffer)}}const hs={};function Nt(f,u,g={}){if(hs[f])throw new Error(`${f} is already registered.`);Object.defineProperty(u,"_classRegistryKey",{value:f,writeable:!1}),hs[f]={klass:u,omit:g.omit||[],shallow:g.shallow||[]}}Nt("Object",Object),Nt("TransferableGridIndex",xa),Nt("Color",a),Nt("Error",Error),Nt("AJAXError",nr),Nt("ResolvedImage",Ie),Nt("StylePropertyFunction",mr),Nt("StyleExpression",Gs,{omit:["_evaluator"]}),Nt("ZoomDependentExpression",Ol),Nt("ZoomConstantExpression",ya),Nt("CompoundExpression",Ft,{omit:["_evaluate"]});for(const f in Qa)Qa[f]._classRegistryKey||Nt(`Expression_${f}`,Qa[f]);function gu(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function wa(f,u){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob)return f;if(gu(f)||yt(f))return u&&u.push(f),f;if(ArrayBuffer.isView(f)){const g=f;return u&&u.push(g.buffer),g}if(f instanceof ImageData)return u&&u.push(f.data.buffer),f;if(Array.isArray(f)){const g=[];for(const T of f)g.push(wa(T,u));return g}if(typeof f=="object"){const g=f.constructor,T=g._classRegistryKey;if(!T)throw new Error("can't serialize object of unregistered class");if(!hs[T])throw new Error(`${T} is not registered.`);const D=g.serialize?g.serialize(f,u):{};if(g.serialize){if(u&&D===u[u.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const z in f){if(!f.hasOwnProperty(z)||hs[T].omit.indexOf(z)>=0)continue;const F=f[z];D[z]=hs[T].shallow.indexOf(z)>=0?F:wa(F,u)}f instanceof Error&&(D.message=f.message)}if(D.$name)throw new Error("$name property is reserved for worker serialization logic.");return T!=="Object"&&(D.$name=T),D}throw new Error("can't serialize object of type "+typeof f)}function Yo(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob||gu(f)||yt(f)||ArrayBuffer.isView(f)||f instanceof ImageData)return f;if(Array.isArray(f))return f.map(Yo);if(typeof f=="object"){const u=f.$name||"Object";if(!hs[u])throw new Error(`can't deserialize unregistered class ${u}`);const{klass:g}=hs[u];if(!g)throw new Error(`can't deserialize unregistered class ${u}`);if(g.deserialize)return g.deserialize(f);const T=Object.create(g.prototype);for(const D of Object.keys(f)){if(D==="$name")continue;const z=f[D];T[D]=hs[u].shallow.indexOf(D)>=0?z:Yo(z)}return T}throw new Error("can't deserialize object of type "+typeof f)}class mu{constructor(){this.first=!0}update(u,g){const T=Math.floor(u);return this.first?(this.first=!1,this.lastIntegerZoom=T,this.lastIntegerZoomTime=0,this.lastZoom=u,this.lastFloorZoom=T,!0):(this.lastFloorZoom>T?(this.lastIntegerZoom=T+1,this.lastIntegerZoomTime=g):this.lastFloorZoom<T&&(this.lastIntegerZoom=T,this.lastIntegerZoomTime=g),u!==this.lastZoom&&(this.lastZoom=u,this.lastFloorZoom=T,!0))}}const Vt={"Latin-1 Supplement":f=>f>=128&&f<=255,Arabic:f=>f>=1536&&f<=1791,"Arabic Supplement":f=>f>=1872&&f<=1919,"Arabic Extended-A":f=>f>=2208&&f<=2303,"Hangul Jamo":f=>f>=4352&&f<=4607,"Unified Canadian Aboriginal Syllabics":f=>f>=5120&&f<=5759,Khmer:f=>f>=6016&&f<=6143,"Unified Canadian Aboriginal Syllabics Extended":f=>f>=6320&&f<=6399,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"CJK Radicals Supplement":f=>f>=11904&&f<=12031,"Kangxi Radicals":f=>f>=12032&&f<=12255,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Bopomofo:f=>f>=12544&&f<=12591,"Hangul Compatibility Jamo":f=>f>=12592&&f<=12687,Kanbun:f=>f>=12688&&f<=12703,"Bopomofo Extended":f=>f>=12704&&f<=12735,"CJK Strokes":f=>f>=12736&&f<=12783,"Katakana Phonetic Extensions":f=>f>=12784&&f<=12799,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"CJK Unified Ideographs Extension A":f=>f>=13312&&f<=19903,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Yi Syllables":f=>f>=40960&&f<=42127,"Yi Radicals":f=>f>=42128&&f<=42191,"Hangul Jamo Extended-A":f=>f>=43360&&f<=43391,"Hangul Syllables":f=>f>=44032&&f<=55215,"Hangul Jamo Extended-B":f=>f>=55216&&f<=55295,"Private Use Area":f=>f>=57344&&f<=63743,"CJK Compatibility Ideographs":f=>f>=63744&&f<=64255,"Arabic Presentation Forms-A":f=>f>=64336&&f<=65023,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Arabic Presentation Forms-B":f=>f>=65136&&f<=65279,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519};function LA(f){for(const u of f)if(tl(u.charCodeAt(0)))return!0;return!1}function $l(f){for(const u of f)if(!DA(u.charCodeAt(0)))return!1;return!0}function DA(f){return!(Vt.Arabic(f)||Vt["Arabic Supplement"](f)||Vt["Arabic Extended-A"](f)||Vt["Arabic Presentation Forms-A"](f)||Vt["Arabic Presentation Forms-B"](f))}function tl(f){return!(f!==746&&f!==747&&(f<4352||!(Vt["Bopomofo Extended"](f)||Vt.Bopomofo(f)||Vt["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Vt["CJK Compatibility Ideographs"](f)||Vt["CJK Compatibility"](f)||Vt["CJK Radicals Supplement"](f)||Vt["CJK Strokes"](f)||!(!Vt["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Vt["CJK Unified Ideographs Extension A"](f)||Vt["CJK Unified Ideographs"](f)||Vt["Enclosed CJK Letters and Months"](f)||Vt["Hangul Compatibility Jamo"](f)||Vt["Hangul Jamo Extended-A"](f)||Vt["Hangul Jamo Extended-B"](f)||Vt["Hangul Jamo"](f)||Vt["Hangul Syllables"](f)||Vt.Hiragana(f)||Vt["Ideographic Description Characters"](f)||Vt.Kanbun(f)||Vt["Kangxi Radicals"](f)||Vt["Katakana Phonetic Extensions"](f)||Vt.Katakana(f)&&f!==12540||!(!Vt["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Vt["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Vt["Unified Canadian Aboriginal Syllabics"](f)||Vt["Unified Canadian Aboriginal Syllabics Extended"](f)||Vt["Vertical Forms"](f)||Vt["Yijing Hexagram Symbols"](f)||Vt["Yi Syllables"](f)||Vt["Yi Radicals"](f))))}function Hs(f){return!(tl(f)||function(u){return!!(Vt["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||Vt["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||Vt["Letterlike Symbols"](u)||Vt["Number Forms"](u)||Vt["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||Vt["Control Pictures"](u)&&u!==9251||Vt["Optical Character Recognition"](u)||Vt["Enclosed Alphanumerics"](u)||Vt["Geometric Shapes"](u)||Vt["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||Vt["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||Vt["CJK Symbols and Punctuation"](u)||Vt.Katakana(u)||Vt["Private Use Area"](u)||Vt["CJK Compatibility Forms"](u)||Vt["Small Form Variants"](u)||Vt["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(f))}function yu(f){return f>=1424&&f<=2303||Vt["Arabic Presentation Forms-A"](f)||Vt["Arabic Presentation Forms-B"](f)}function Ph(f,u){return!(!u&&yu(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Vt.Khmer(f))}function Sc(f){for(const u of f)if(yu(u.charCodeAt(0)))return!0;return!1}const _u="deferred",vu="loading",xu="loaded";let Ws=null,Ri="unavailable",Eo=null;const wu=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(Ri="error"),Ws&&Ws(f)};function ba(){Nr.fire(new ki("pluginStateChange",{pluginStatus:Ri,pluginURL:Eo}))}const Nr=new os,jl=function(){return Ri},Cc=function(){if(Ri!==_u||!Eo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ri=vu,ba(),Eo&&rr({url:Eo},f=>{f?wu(f):(Ri=xu,ba())})},fs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ri===xu||fs.applyArabicShaping!=null,isLoading:()=>Ri===vu,setState(f){if(!Qe())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Ri=f.pluginStatus,Eo=f.pluginURL},isParsed(){if(!Qe())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return fs.applyArabicShaping!=null&&fs.processBidirectionalText!=null&&fs.processStyledBidirectionalText!=null},getPluginURL(){if(!Qe())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Eo}};class Sr{constructor(u,g){this.zoom=u,g?(this.now=g.now,this.fadeDuration=g.fadeDuration,this.zoomHistory=g.zoomHistory,this.transition=g.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new mu,this.transition={})}isSupportedScript(u){return function(g,T){for(const D of g)if(!Ph(D.charCodeAt(0),T))return!1;return!0}(u,fs.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const u=this.zoom,g=u-Math.floor(u),T=this.crossFadingFactor();return u>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:g+(1-g)*T}:{fromScale:.5,toScale:1,t:1-(1-T)*g}}}class nl{constructor(u,g){this.property=u,this.value=g,this.expression=function(T,D){if(wr(T))return new mr(T,D);if(zl(T)){const z=Fl(T,D);if(z.result==="error")throw new Error(z.value.map(F=>`${F.key}: ${F.message}`).join(", "));return z.value}{let z=T;return D.type==="color"&&typeof T=="string"?z=a.parse(T):D.type!=="padding"||typeof T!="number"&&!Array.isArray(T)||(z=Pe.parse(T)),{kind:"constant",evaluate:()=>z}}}(g===void 0?u.specification.default:g,u.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(u,g,T){return this.property.possiblyEvaluate(this,u,g,T)}}class Hl{constructor(u){this.property=u,this.value=new nl(u,void 0)}transitioned(u,g){return new Mc(this.property,this.value,g,W({},u.transition,this.transition),u.now)}untransitioned(){return new Mc(this.property,this.value,null,{},0)}}class bu{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitionablePropertyValues)}getValue(u){return se(this._values[u].value.value)}setValue(u,g){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Hl(this._values[u].property)),this._values[u].value=new nl(this._values[u].property,g===null?void 0:se(g))}getTransition(u){return se(this._values[u].transition)}setTransition(u,g){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Hl(this._values[u].property)),this._values[u].transition=se(g)||void 0}serialize(){const u={};for(const g of Object.keys(this._values)){const T=this.getValue(g);T!==void 0&&(u[g]=T);const D=this.getTransition(g);D!==void 0&&(u[`${g}-transition`]=D)}return u}transitioned(u,g){const T=new Eu(this._properties);for(const D of Object.keys(this._values))T._values[D]=this._values[D].transitioned(u,g._values[D]);return T}untransitioned(){const u=new Eu(this._properties);for(const g of Object.keys(this._values))u._values[g]=this._values[g].untransitioned();return u}}class Mc{constructor(u,g,T,D,z){this.property=u,this.value=g,this.begin=z+D.delay||0,this.end=this.begin+D.duration||0,u.specification.transition&&(D.delay||D.duration)&&(this.prior=T)}possiblyEvaluate(u,g,T){const D=u.now||0,z=this.value.possiblyEvaluate(u,g,T),F=this.prior;if(F){if(D>this.end)return this.prior=null,z;if(this.value.isDataDriven())return this.prior=null,z;if(D<this.begin)return F.possiblyEvaluate(u,g,T);{const $=(D-this.begin)/(this.end-this.begin);return this.property.interpolate(F.possiblyEvaluate(u,g,T),z,function(Z){if(Z<=0)return 0;if(Z>=1)return 1;const re=Z*Z,Ae=re*Z;return 4*(Z<.5?Ae:3*(Z-re)+Ae-.75)}($))}}return z}}class Eu{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitioningPropertyValues)}possiblyEvaluate(u,g,T){const D=new Wl(this._properties);for(const z of Object.keys(this._values))D._values[z]=this._values[z].possiblyEvaluate(u,g,T);return D}hasTransition(){for(const u of Object.keys(this._values))if(this._values[u].prior)return!0;return!1}}class Pc{constructor(u){this._properties=u,this._values=Object.create(u.defaultPropertyValues)}getValue(u){return se(this._values[u].value)}setValue(u,g){this._values[u]=new nl(this._values[u].property,g===null?void 0:se(g))}serialize(){const u={};for(const g of Object.keys(this._values)){const T=this.getValue(g);T!==void 0&&(u[g]=T)}return u}possiblyEvaluate(u,g,T){const D=new Wl(this._properties);for(const z of Object.keys(this._values))D._values[z]=this._values[z].possiblyEvaluate(u,g,T);return D}}class yr{constructor(u,g,T){this.property=u,this.value=g,this.parameters=T}isConstant(){return this.value.kind==="constant"}constantOr(u){return this.value.kind==="constant"?this.value.value:u}evaluate(u,g,T,D){return this.property.evaluate(this.value,this.parameters,u,g,T,D)}}class Wl{constructor(u){this._properties=u,this._values=Object.create(u.defaultPossiblyEvaluatedValues)}get(u){return this._values[u]}}class Yt{constructor(u){this.specification=u}possiblyEvaluate(u,g){if(u.isDataDriven())throw new Error("Value should not be data driven");return u.expression.evaluate(g)}interpolate(u,g,T){const D=Dr[this.specification.type];return D?D(u,g,T):u}}class Xt{constructor(u,g){this.specification=u,this.overrides=g}possiblyEvaluate(u,g,T,D){return new yr(this,u.expression.kind==="constant"||u.expression.kind==="camera"?{kind:"constant",value:u.expression.evaluate(g,null,{},T,D)}:u.expression,g)}interpolate(u,g,T){if(u.value.kind!=="constant"||g.value.kind!=="constant")return u;if(u.value.value===void 0||g.value.value===void 0)return new yr(this,{kind:"constant",value:void 0},u.parameters);const D=Dr[this.specification.type];return D?new yr(this,{kind:"constant",value:D(u.value.value,g.value.value,T)},u.parameters):u}evaluate(u,g,T,D,z,F){return u.kind==="constant"?u.value:u.evaluate(g,T,D,z,F)}}class hn extends Xt{possiblyEvaluate(u,g,T,D){if(u.value===void 0)return new yr(this,{kind:"constant",value:void 0},g);if(u.expression.kind==="constant"){const z=u.expression.evaluate(g,null,{},T,D),F=u.property.specification.type==="resolvedImage"&&typeof z!="string"?z.name:z,$=this._calculate(F,F,F,g);return new yr(this,{kind:"constant",value:$},g)}if(u.expression.kind==="camera"){const z=this._calculate(u.expression.evaluate({zoom:g.zoom-1}),u.expression.evaluate({zoom:g.zoom}),u.expression.evaluate({zoom:g.zoom+1}),g);return new yr(this,{kind:"constant",value:z},g)}return new yr(this,u.expression,g)}evaluate(u,g,T,D,z,F){if(u.kind==="source"){const $=u.evaluate(g,T,D,z,F);return this._calculate($,$,$,g)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(g.zoom)-1},T,D),u.evaluate({zoom:Math.floor(g.zoom)},T,D),u.evaluate({zoom:Math.floor(g.zoom)+1},T,D),g):u.value}_calculate(u,g,T,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:u,to:g}:{from:T,to:g}}interpolate(u){return u}}class Ji{constructor(u){this.specification=u}possiblyEvaluate(u,g,T,D){if(u.value!==void 0){if(u.expression.kind==="constant"){const z=u.expression.evaluate(g,null,{},T,D);return this._calculate(z,z,z,g)}return this._calculate(u.expression.evaluate(new Sr(Math.floor(g.zoom-1),g)),u.expression.evaluate(new Sr(Math.floor(g.zoom),g)),u.expression.evaluate(new Sr(Math.floor(g.zoom+1),g)),g)}}_calculate(u,g,T,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:u,to:g}:{from:T,to:g}}interpolate(u){return u}}class Xo{constructor(u){this.specification=u}possiblyEvaluate(u,g,T,D){return!!u.expression.evaluate(g,null,{},T,D)}interpolate(){return!1}}class $r{constructor(u){this.properties=u,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const g in u){const T=u[g];T.specification.overridable&&this.overridableProperties.push(g);const D=this.defaultPropertyValues[g]=new nl(T,void 0),z=this.defaultTransitionablePropertyValues[g]=new Hl(T);this.defaultTransitioningPropertyValues[g]=z.untransitioned(),this.defaultPossiblyEvaluatedValues[g]=D.possiblyEvaluate({})}}}Nt("DataDrivenProperty",Xt),Nt("DataConstantProperty",Yt),Nt("CrossFadedDataDrivenProperty",hn),Nt("CrossFadedProperty",Ji),Nt("ColorRampProperty",Xo);const Qs="-transition";class Cs extends os{constructor(u,g){if(super(),this.id=u.id,this.type=u.type,this._featureFilter={filter:()=>!0,needGeometry:!1},u.type!=="custom"&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),g.layout&&(this._unevaluatedLayout=new Pc(g.layout)),g.paint)){this._transitionablePaint=new bu(g.paint);for(const T in u.paint)this.setPaintProperty(T,u.paint[T],{validate:!1});for(const T in u.layout)this.setLayoutProperty(T,u.layout[T],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wl(g.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)}setLayoutProperty(u,g,T={}){g!=null&&this._validate(Mh,`layers.${this.id}.layout.${u}`,u,g,T)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,g):this.visibility=g)}getPaintProperty(u){return u.endsWith(Qs)?this._transitionablePaint.getTransition(u.slice(0,-Qs.length)):this._transitionablePaint.getValue(u)}setPaintProperty(u,g,T={}){if(g!=null&&this._validate(Ch,`layers.${this.id}.paint.${u}`,u,g,T))return!1;if(u.endsWith(Qs))return this._transitionablePaint.setTransition(u.slice(0,-Qs.length),g||void 0),!1;{const D=this._transitionablePaint._values[u],z=D.property.specification["property-type"]==="cross-faded-data-driven",F=D.value.isDataDriven(),$=D.value;this._transitionablePaint.setValue(u,g),this._handleSpecialPaintPropertyUpdate(u);const Z=this._transitionablePaint._values[u].value;return Z.isDataDriven()||F||z||this._handleOverridablePaintPropertyUpdate(u,$,Z)}}_handleSpecialPaintPropertyUpdate(u){}_handleOverridablePaintPropertyUpdate(u,g,T){return!1}isHidden(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"}updateTransitions(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(u,g){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,g)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,g)}serialize(){const u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),ee(u,(g,T)=>!(g===void 0||T==="layout"&&!Object.keys(g).length||T==="paint"&&!Object.keys(g).length))}_validate(u,g,T,D,z={}){return(!z||z.validate!==!1)&&el(this,u.call(Gl,{key:g,layerType:this.type,objectKey:T,value:D,styleSpec:ht,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const u in this.paint._values){const g=this.paint.get(u);if(g instanceof yr&&fr(g.property.specification)&&(g.value.kind==="source"||g.value.kind==="composite")&&g.value.isStateDependent)return!0}return!1}}const qs={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ct{constructor(u,g){this._structArray=u,this._pos1=g*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Pt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(u,g){return u._trim(),g&&(u.isTransferred=!0,g.push(u.arrayBuffer)),{length:u.length,arrayBuffer:u.arrayBuffer}}static deserialize(u){const g=Object.create(this.prototype);return g.arrayBuffer=u.arrayBuffer,g.length=u.length,g.capacity=u.arrayBuffer.byteLength/g.bytesPerElement,g._refreshViews(),g}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(u){this.reserve(u),this.length=u}reserve(u){if(u>this.capacity){this.capacity=Math.max(u,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const g=this.uint8;this._refreshViews(),g&&this.uint8.set(g)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function jr(f,u=1){let g=0,T=0;return{members:f.map(D=>{const z=qs[D.type].BYTES_PER_ELEMENT,F=g=rl(g,Math.max(u,z)),$=D.components||1;return T=Math.max(T,z),g+=z*$,{name:D.name,type:D.type,components:$,offset:F}}),size:rl(g,Math.max(T,u)),alignment:u}}function rl(f,u){return Math.ceil(f/u)*u}class Zs extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g){const T=this.length;return this.resize(T+1),this.emplace(T,u,g)}emplace(u,g,T){const D=2*u;return this.int16[D+0]=g,this.int16[D+1]=T,u}}Zs.prototype.bytesPerElement=4,Nt("StructArrayLayout2i4",Zs);class L extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,g,T,D)}emplace(u,g,T,D,z){const F=4*u;return this.int16[F+0]=g,this.int16[F+1]=T,this.int16[F+2]=D,this.int16[F+3]=z,u}}L.prototype.bytesPerElement=8,Nt("StructArrayLayout4i8",L);class c extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,F){const $=this.length;return this.resize($+1),this.emplace($,u,g,T,D,z,F)}emplace(u,g,T,D,z,F,$){const Z=6*u;return this.int16[Z+0]=g,this.int16[Z+1]=T,this.int16[Z+2]=D,this.int16[Z+3]=z,this.int16[Z+4]=F,this.int16[Z+5]=$,u}}c.prototype.bytesPerElement=12,Nt("StructArrayLayout2i4i12",c);class _ extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,F){const $=this.length;return this.resize($+1),this.emplace($,u,g,T,D,z,F)}emplace(u,g,T,D,z,F,$){const Z=4*u,re=8*u;return this.int16[Z+0]=g,this.int16[Z+1]=T,this.uint8[re+4]=D,this.uint8[re+5]=z,this.uint8[re+6]=F,this.uint8[re+7]=$,u}}_.prototype.bytesPerElement=8,Nt("StructArrayLayout2i4ub8",_);class A extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g){const T=this.length;return this.resize(T+1),this.emplace(T,u,g)}emplace(u,g,T){const D=2*u;return this.float32[D+0]=g,this.float32[D+1]=T,u}}A.prototype.bytesPerElement=8,Nt("StructArrayLayout2f8",A);class h extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,F,$,Z,re,Ae){const ce=this.length;return this.resize(ce+1),this.emplace(ce,u,g,T,D,z,F,$,Z,re,Ae)}emplace(u,g,T,D,z,F,$,Z,re,Ae,ce){const pe=10*u;return this.uint16[pe+0]=g,this.uint16[pe+1]=T,this.uint16[pe+2]=D,this.uint16[pe+3]=z,this.uint16[pe+4]=F,this.uint16[pe+5]=$,this.uint16[pe+6]=Z,this.uint16[pe+7]=re,this.uint16[pe+8]=Ae,this.uint16[pe+9]=ce,u}}h.prototype.bytesPerElement=20,Nt("StructArrayLayout10ui20",h);class d extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,F,$,Z,re,Ae,ce,pe){const ye=this.length;return this.resize(ye+1),this.emplace(ye,u,g,T,D,z,F,$,Z,re,Ae,ce,pe)}emplace(u,g,T,D,z,F,$,Z,re,Ae,ce,pe,ye){const _e=12*u;return this.int16[_e+0]=g,this.int16[_e+1]=T,this.int16[_e+2]=D,this.int16[_e+3]=z,this.uint16[_e+4]=F,this.uint16[_e+5]=$,this.uint16[_e+6]=Z,this.uint16[_e+7]=re,this.int16[_e+8]=Ae,this.int16[_e+9]=ce,this.int16[_e+10]=pe,this.int16[_e+11]=ye,u}}d.prototype.bytesPerElement=24,Nt("StructArrayLayout4i4ui4i24",d);class x extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,g,T)}emplace(u,g,T,D){const z=3*u;return this.float32[z+0]=g,this.float32[z+1]=T,this.float32[z+2]=D,u}}x.prototype.bytesPerElement=12,Nt("StructArrayLayout3f12",x);class b extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u){const g=this.length;return this.resize(g+1),this.emplace(g,u)}emplace(u,g){return this.uint32[1*u+0]=g,u}}b.prototype.bytesPerElement=4,Nt("StructArrayLayout1ul4",b);class S extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,F,$,Z,re){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,u,g,T,D,z,F,$,Z,re)}emplace(u,g,T,D,z,F,$,Z,re,Ae){const ce=10*u,pe=5*u;return this.int16[ce+0]=g,this.int16[ce+1]=T,this.int16[ce+2]=D,this.int16[ce+3]=z,this.int16[ce+4]=F,this.int16[ce+5]=$,this.uint32[pe+3]=Z,this.uint16[ce+8]=re,this.uint16[ce+9]=Ae,u}}S.prototype.bytesPerElement=20,Nt("StructArrayLayout6i1ul2ui20",S);class M extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,F){const $=this.length;return this.resize($+1),this.emplace($,u,g,T,D,z,F)}emplace(u,g,T,D,z,F,$){const Z=6*u;return this.int16[Z+0]=g,this.int16[Z+1]=T,this.int16[Z+2]=D,this.int16[Z+3]=z,this.int16[Z+4]=F,this.int16[Z+5]=$,u}}M.prototype.bytesPerElement=12,Nt("StructArrayLayout2i2i2i12",M);class B extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z){const F=this.length;return this.resize(F+1),this.emplace(F,u,g,T,D,z)}emplace(u,g,T,D,z,F){const $=4*u,Z=8*u;return this.float32[$+0]=g,this.float32[$+1]=T,this.float32[$+2]=D,this.int16[Z+6]=z,this.int16[Z+7]=F,u}}B.prototype.bytesPerElement=16,Nt("StructArrayLayout2f1f2i16",B);class V extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,g,T,D)}emplace(u,g,T,D,z){const F=12*u,$=3*u;return this.uint8[F+0]=g,this.uint8[F+1]=T,this.float32[$+1]=D,this.float32[$+2]=z,u}}V.prototype.bytesPerElement=12,Nt("StructArrayLayout2ub2f12",V);class j extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,g,T)}emplace(u,g,T,D){const z=3*u;return this.uint16[z+0]=g,this.uint16[z+1]=T,this.uint16[z+2]=D,u}}j.prototype.bytesPerElement=6,Nt("StructArrayLayout3ui6",j);class Y extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ve,ze,tt){const ut=this.length;return this.resize(ut+1),this.emplace(ut,u,g,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ve,ze,tt)}emplace(u,g,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ve,ze,tt,ut){const et=24*u,at=12*u,mt=48*u;return this.int16[et+0]=g,this.int16[et+1]=T,this.uint16[et+2]=D,this.uint16[et+3]=z,this.uint32[at+2]=F,this.uint32[at+3]=$,this.uint32[at+4]=Z,this.uint16[et+10]=re,this.uint16[et+11]=Ae,this.uint16[et+12]=ce,this.float32[at+7]=pe,this.float32[at+8]=ye,this.uint8[mt+36]=_e,this.uint8[mt+37]=Ve,this.uint8[mt+38]=ze,this.uint32[at+10]=tt,this.int16[et+22]=ut,u}}Y.prototype.bytesPerElement=48,Nt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Y);class ae extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ve,ze,tt,ut,et,at,mt,gt,Zt,tn,Ht,Ut,Ot,Wt){const $t=this.length;return this.resize($t+1),this.emplace($t,u,g,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ve,ze,tt,ut,et,at,mt,gt,Zt,tn,Ht,Ut,Ot,Wt)}emplace(u,g,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ve,ze,tt,ut,et,at,mt,gt,Zt,tn,Ht,Ut,Ot,Wt,$t){const St=34*u,gn=17*u;return this.int16[St+0]=g,this.int16[St+1]=T,this.int16[St+2]=D,this.int16[St+3]=z,this.int16[St+4]=F,this.int16[St+5]=$,this.int16[St+6]=Z,this.int16[St+7]=re,this.uint16[St+8]=Ae,this.uint16[St+9]=ce,this.uint16[St+10]=pe,this.uint16[St+11]=ye,this.uint16[St+12]=_e,this.uint16[St+13]=Ve,this.uint16[St+14]=ze,this.uint16[St+15]=tt,this.uint16[St+16]=ut,this.uint16[St+17]=et,this.uint16[St+18]=at,this.uint16[St+19]=mt,this.uint16[St+20]=gt,this.uint16[St+21]=Zt,this.uint16[St+22]=tn,this.uint32[gn+12]=Ht,this.float32[gn+13]=Ut,this.float32[gn+14]=Ot,this.float32[gn+15]=Wt,this.float32[gn+16]=$t,u}}ae.prototype.bytesPerElement=68,Nt("StructArrayLayout8i15ui1ul4f68",ae);class ne extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u){const g=this.length;return this.resize(g+1),this.emplace(g,u)}emplace(u,g){return this.float32[1*u+0]=g,u}}ne.prototype.bytesPerElement=4,Nt("StructArrayLayout1f4",ne);class ue extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,g,T)}emplace(u,g,T,D){const z=3*u;return this.int16[z+0]=g,this.int16[z+1]=T,this.int16[z+2]=D,u}}ue.prototype.bytesPerElement=6,Nt("StructArrayLayout3i6",ue);class be extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,g,T)}emplace(u,g,T,D){const z=4*u;return this.uint32[2*u+0]=g,this.uint16[z+2]=T,this.uint16[z+3]=D,u}}be.prototype.bytesPerElement=8,Nt("StructArrayLayout1ul2ui8",be);class Me extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g){const T=this.length;return this.resize(T+1),this.emplace(T,u,g)}emplace(u,g,T){const D=2*u;return this.uint16[D+0]=g,this.uint16[D+1]=T,u}}Me.prototype.bytesPerElement=4,Nt("StructArrayLayout2ui4",Me);class ve extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u){const g=this.length;return this.resize(g+1),this.emplace(g,u)}emplace(u,g){return this.uint16[1*u+0]=g,u}}ve.prototype.bytesPerElement=2,Nt("StructArrayLayout1ui2",ve);class $e extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,g,T,D)}emplace(u,g,T,D,z){const F=4*u;return this.float32[F+0]=g,this.float32[F+1]=T,this.float32[F+2]=D,this.float32[F+3]=z,u}}$e.prototype.bytesPerElement=16,Nt("StructArrayLayout4f16",$e);class Te extends Ct{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Tt(this.anchorPointX,this.anchorPointY)}}Te.prototype.size=20;class Ge extends S{get(u){return new Te(this,u)}}Nt("CollisionBoxArray",Ge);class xe extends Ct{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(u){this._structArray.uint8[this._pos1+37]=u}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(u){this._structArray.uint8[this._pos1+38]=u}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(u){this._structArray.uint32[this._pos4+10]=u}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}xe.prototype.size=48;class y extends Y{get(u){return new xe(this,u)}}Nt("PlacedSymbolArray",y);class m extends Ct{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(u){this._structArray.uint32[this._pos4+12]=u}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}m.prototype.size=68;class v extends ae{get(u){return new m(this,u)}}Nt("SymbolInstanceArray",v);class E extends ne{getoffsetX(u){return this.float32[1*u+0]}}Nt("GlyphOffsetArray",E);class k extends ue{getx(u){return this.int16[3*u+0]}gety(u){return this.int16[3*u+1]}gettileUnitDistanceFromAnchor(u){return this.int16[3*u+2]}}Nt("SymbolLineVertexArray",k);class R extends Ct{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}R.prototype.size=8;class O extends be{get(u){return new R(this,u)}}Nt("FeatureIndexArray",O);class N extends Zs{}class q extends Zs{}class J extends Zs{}class le extends c{}class de extends _{}class Re extends A{}class je extends h{}class Be extends d{}class Xe extends x{}class ft extends b{}class ct extends M{}class st extends V{}class ot extends j{}class Je extends Me{}const Gt=jr([{name:"a_pos",components:2,type:"Int16"}],4),{members:zt}=Gt;class pt{constructor(u=[]){this.segments=u}prepareSegment(u,g,T,D){let z=this.segments[this.segments.length-1];return u>pt.MAX_VERTEX_ARRAY_LENGTH&&me(`Max vertices per segment is ${pt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${u}`),(!z||z.vertexLength+u>pt.MAX_VERTEX_ARRAY_LENGTH||z.sortKey!==D)&&(z={vertexOffset:g.length,primitiveOffset:T.length,vertexLength:0,primitiveLength:0},D!==void 0&&(z.sortKey=D),this.segments.push(z)),z}get(){return this.segments}destroy(){for(const u of this.segments)for(const g in u.vaos)u.vaos[g].destroy()}static simpleSegment(u,g,T,D){return new pt([{vertexOffset:u,primitiveOffset:g,vertexLength:T,primitiveLength:D,vaos:{},sortKey:0}])}}function vt(f,u){return 256*(f=I(Math.floor(f),0,255))+I(Math.floor(u),0,255)}pt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Nt("SegmentVector",pt);const Pn=jr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var wn={exports:{}},mn={exports:{}};mn.exports=function(f,u){var g,T,D,z,F,$,Z,re;for(T=f.length-(g=3&f.length),D=u,F=3432918353,$=461845907,re=0;re<T;)Z=255&f.charCodeAt(re)|(255&f.charCodeAt(++re))<<8|(255&f.charCodeAt(++re))<<16|(255&f.charCodeAt(++re))<<24,++re,D=27492+(65535&(z=5*(65535&(D=(D^=Z=(65535&(Z=(Z=(65535&Z)*F+(((Z>>>16)*F&65535)<<16)&4294967295)<<15|Z>>>17))*$+(((Z>>>16)*$&65535)<<16)&4294967295)<<13|D>>>19))+((5*(D>>>16)&65535)<<16)&4294967295))+((58964+(z>>>16)&65535)<<16);switch(Z=0,g){case 3:Z^=(255&f.charCodeAt(re+2))<<16;case 2:Z^=(255&f.charCodeAt(re+1))<<8;case 1:D^=Z=(65535&(Z=(Z=(65535&(Z^=255&f.charCodeAt(re)))*F+(((Z>>>16)*F&65535)<<16)&4294967295)<<15|Z>>>17))*$+(((Z>>>16)*$&65535)<<16)&4294967295}return D^=f.length,D=2246822507*(65535&(D^=D>>>16))+((2246822507*(D>>>16)&65535)<<16)&4294967295,D=3266489909*(65535&(D^=D>>>13))+((3266489909*(D>>>16)&65535)<<16)&4294967295,(D^=D>>>16)>>>0};var _n={exports:{}};_n.exports=function(f,u){for(var g,T=f.length,D=u^T,z=0;T>=4;)g=1540483477*(65535&(g=255&f.charCodeAt(z)|(255&f.charCodeAt(++z))<<8|(255&f.charCodeAt(++z))<<16|(255&f.charCodeAt(++z))<<24))+((1540483477*(g>>>16)&65535)<<16),D=1540483477*(65535&D)+((1540483477*(D>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),T-=4,++z;switch(T){case 3:D^=(255&f.charCodeAt(z+2))<<16;case 2:D^=(255&f.charCodeAt(z+1))<<8;case 1:D=1540483477*(65535&(D^=255&f.charCodeAt(z)))+((1540483477*(D>>>16)&65535)<<16)}return D=1540483477*(65535&(D^=D>>>13))+((1540483477*(D>>>16)&65535)<<16),(D^=D>>>15)>>>0};var En=mn.exports,Dn=_n.exports;wn.exports=En,wn.exports.murmur3=En,wn.exports.murmur2=Dn;class ar{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(u,g,T,D){this.ids.push(kn(u)),this.positions.push(g,T,D)}getPositions(u){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const g=kn(u);let T=0,D=this.ids.length-1;for(;T<D;){const F=T+D>>1;this.ids[F]>=g?D=F:T=F+1}const z=[];for(;this.ids[T]===g;)z.push({index:this.positions[3*T],start:this.positions[3*T+1],end:this.positions[3*T+2]}),T++;return z}static serialize(u,g){const T=new Float64Array(u.ids),D=new Uint32Array(u.positions);return br(T,D,0,T.length-1),g&&g.push(T.buffer,D.buffer),{ids:T,positions:D}}static deserialize(u){const g=new ar;return g.ids=u.ids,g.positions=u.positions,g.indexed=!0,g}}function kn(f){const u=+f;return!isNaN(u)&&u<=Number.MAX_SAFE_INTEGER?u:wn.exports(String(f))}function br(f,u,g,T){for(;g<T;){const D=f[g+T>>1];let z=g-1,F=T+1;for(;;){do z++;while(f[z]<D);do F--;while(f[F]>D);if(z>=F)break;Yr(f,z,F),Yr(u,3*z,3*F),Yr(u,3*z+1,3*F+1),Yr(u,3*z+2,3*F+2)}F-g<T-F?(br(f,u,g,F),g=F+1):(br(f,u,F+1,T),T=F)}}function Yr(f,u,g){const T=f[u];f[u]=f[g],f[g]=T}Nt("FeaturePositionMap",ar);class il{constructor(u,g){this.gl=u.gl,this.location=g}}class Tu extends il{constructor(u,g){super(u,g),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Hf extends il{constructor(u,g){super(u,g),this.current=[0,0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))}}class M4 extends il{constructor(u,g){super(u,g),this.current=a.transparent}set(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))}}const D7=new Float32Array(16);function Fv(f){return[vt(255*f.r,255*f.g),vt(255*f.b,255*f.a)]}class Xd{constructor(u,g,T){this.value=u,this.uniformNames=g.map(D=>`u_${D}`),this.type=T}setUniform(u,g,T){u.set(T.constantOr(this.value))}getBinding(u,g,T){return this.type==="color"?new M4(u,g):new Tu(u,g)}}class Wf{constructor(u,g){this.uniformNames=g.map(T=>`u_${T}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(u,g){this.pixelRatioFrom=g.pixelRatio,this.pixelRatioTo=u.pixelRatio,this.patternFrom=g.tlbr,this.patternTo=u.tlbr}setUniform(u,g,T,D){const z=D==="u_pattern_to"?this.patternTo:D==="u_pattern_from"?this.patternFrom:D==="u_pixel_ratio_to"?this.pixelRatioTo:D==="u_pixel_ratio_from"?this.pixelRatioFrom:null;z&&u.set(z)}getBinding(u,g,T){return T.substr(0,9)==="u_pattern"?new Hf(u,g):new Tu(u,g)}}class Su{constructor(u,g,T,D){this.expression=u,this.type=T,this.maxValue=0,this.paintVertexAttributes=g.map(z=>({name:`a_${z}`,type:"Float32",components:T==="color"?2:1,offset:0})),this.paintVertexArray=new D}populatePaintArray(u,g,T,D,z){const F=this.paintVertexArray.length,$=this.expression.evaluate(new Sr(0),g,{},D,[],z);this.paintVertexArray.resize(u),this._setPaintValue(F,u,$)}updatePaintArray(u,g,T,D){const z=this.expression.evaluate({zoom:0},T,D);this._setPaintValue(u,g,z)}_setPaintValue(u,g,T){if(this.type==="color"){const D=Fv(T);for(let z=u;z<g;z++)this.paintVertexArray.emplace(z,D[0],D[1])}else{for(let D=u;D<g;D++)this.paintVertexArray.emplace(D,T);this.maxValue=Math.max(this.maxValue,Math.abs(T))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ql{constructor(u,g,T,D,z,F){this.expression=u,this.uniformNames=g.map($=>`u_${$}_t`),this.type=T,this.useIntegerZoom=D,this.zoom=z,this.maxValue=0,this.paintVertexAttributes=g.map($=>({name:`a_${$}`,type:"Float32",components:T==="color"?4:2,offset:0})),this.paintVertexArray=new F}populatePaintArray(u,g,T,D,z){const F=this.expression.evaluate(new Sr(this.zoom),g,{},D,[],z),$=this.expression.evaluate(new Sr(this.zoom+1),g,{},D,[],z),Z=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValue(Z,u,F,$)}updatePaintArray(u,g,T,D){const z=this.expression.evaluate({zoom:this.zoom},T,D),F=this.expression.evaluate({zoom:this.zoom+1},T,D);this._setPaintValue(u,g,z,F)}_setPaintValue(u,g,T,D){if(this.type==="color"){const z=Fv(T),F=Fv(D);for(let $=u;$<g;$++)this.paintVertexArray.emplace($,z[0],z[1],F[0],F[1])}else{for(let z=u;z<g;z++)this.paintVertexArray.emplace(z,T,D);this.maxValue=Math.max(this.maxValue,Math.abs(T),Math.abs(D))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(u,g){const T=this.useIntegerZoom?Math.floor(g.zoom):g.zoom,D=I(this.expression.interpolationFactor(T,this.zoom,this.zoom+1),0,1);u.set(D)}getBinding(u,g,T){return new Tu(u,g)}}class kc{constructor(u,g,T,D,z,F){this.expression=u,this.type=g,this.useIntegerZoom=T,this.zoom=D,this.layerId=F,this.zoomInPaintVertexArray=new z,this.zoomOutPaintVertexArray=new z}populatePaintArray(u,g,T){const D=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(u),this.zoomOutPaintVertexArray.resize(u),this._setPaintValues(D,u,g.patterns&&g.patterns[this.layerId],T)}updatePaintArray(u,g,T,D,z){this._setPaintValues(u,g,T.patterns&&T.patterns[this.layerId],z)}_setPaintValues(u,g,T,D){if(!D||!T)return;const{min:z,mid:F,max:$}=T,Z=D[z],re=D[F],Ae=D[$];if(Z&&re&&Ae)for(let ce=u;ce<g;ce++)this.zoomInPaintVertexArray.emplace(ce,re.tl[0],re.tl[1],re.br[0],re.br[1],Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],re.pixelRatio,Z.pixelRatio),this.zoomOutPaintVertexArray.emplace(ce,re.tl[0],re.tl[1],re.br[0],re.br[1],Ae.tl[0],Ae.tl[1],Ae.br[0],Ae.br[1],re.pixelRatio,Ae.pixelRatio)}upload(u){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=u.createVertexBuffer(this.zoomInPaintVertexArray,Pn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=u.createVertexBuffer(this.zoomOutPaintVertexArray,Pn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class P4{constructor(u,g,T){this.binders={},this._buffers=[];const D=[];for(const z in u.paint._values){if(!T(z))continue;const F=u.paint.get(z);if(!(F instanceof yr&&fr(F.property.specification)))continue;const $=R7(z,u.type),Z=F.value,re=F.property.specification.type,Ae=F.property.useIntegerZoom,ce=F.property.specification["property-type"],pe=ce==="cross-faded"||ce==="cross-faded-data-driven";if(Z.kind==="constant")this.binders[z]=pe?new Wf(Z.value,$):new Xd(Z.value,$,re),D.push(`/u_${z}`);else if(Z.kind==="source"||pe){const ye=k4(z,re,"source");this.binders[z]=pe?new kc(Z,re,Ae,g,ye,u.id):new Su(Z,$,re,ye),D.push(`/a_${z}`)}else{const ye=k4(z,re,"composite");this.binders[z]=new Ql(Z,$,re,Ae,g,ye),D.push(`/z_${z}`)}}this.cacheKey=D.sort().join("")}getMaxValue(u){const g=this.binders[u];return g instanceof Su||g instanceof Ql?g.maxValue:0}populatePaintArrays(u,g,T,D,z){for(const F in this.binders){const $=this.binders[F];($ instanceof Su||$ instanceof Ql||$ instanceof kc)&&$.populatePaintArray(u,g,T,D,z)}}setConstantPatternPositions(u,g){for(const T in this.binders){const D=this.binders[T];D instanceof Wf&&D.setConstantPatternPositions(u,g)}}updatePaintArrays(u,g,T,D,z){let F=!1;for(const $ in u){const Z=g.getPositions($);for(const re of Z){const Ae=T.feature(re.index);for(const ce in this.binders){const pe=this.binders[ce];if((pe instanceof Su||pe instanceof Ql||pe instanceof kc)&&pe.expression.isStateDependent===!0){const ye=D.paint.get(ce);pe.expression=ye.value,pe.updatePaintArray(re.start,re.end,Ae,u[$],z),F=!0}}}}return F}defines(){const u=[];for(const g in this.binders){const T=this.binders[g];(T instanceof Xd||T instanceof Wf)&&u.push(...T.uniformNames.map(D=>`#define HAS_UNIFORM_${D}`))}return u}getBinderAttributes(){const u=[];for(const g in this.binders){const T=this.binders[g];if(T instanceof Su||T instanceof Ql)for(let D=0;D<T.paintVertexAttributes.length;D++)u.push(T.paintVertexAttributes[D].name);else if(T instanceof kc)for(let D=0;D<Pn.members.length;D++)u.push(Pn.members[D].name)}return u}getBinderUniforms(){const u=[];for(const g in this.binders){const T=this.binders[g];if(T instanceof Xd||T instanceof Wf||T instanceof Ql)for(const D of T.uniformNames)u.push(D)}return u}getPaintVertexBuffers(){return this._buffers}getUniforms(u,g){const T=[];for(const D in this.binders){const z=this.binders[D];if(z instanceof Xd||z instanceof Wf||z instanceof Ql){for(const F of z.uniformNames)if(g[F]){const $=z.getBinding(u,g[F],F);T.push({name:F,property:D,binding:$})}}}return T}setUniforms(u,g,T,D){for(const{name:z,property:F,binding:$}of g)this.binders[F].setUniform($,D,T.get(F),z)}updatePaintBuffers(u){this._buffers=[];for(const g in this.binders){const T=this.binders[g];if(u&&T instanceof kc){const D=u.fromScale===2?T.zoomInPaintVertexBuffer:T.zoomOutPaintVertexBuffer;D&&this._buffers.push(D)}else(T instanceof Su||T instanceof Ql)&&T.paintVertexBuffer&&this._buffers.push(T.paintVertexBuffer)}}upload(u){for(const g in this.binders){const T=this.binders[g];(T instanceof Su||T instanceof Ql||T instanceof kc)&&T.upload(u)}this.updatePaintBuffers()}destroy(){for(const u in this.binders){const g=this.binders[u];(g instanceof Su||g instanceof Ql||g instanceof kc)&&g.destroy()}}}class kh{constructor(u,g,T=()=>!0){this.programConfigurations={};for(const D of u)this.programConfigurations[D.id]=new P4(D,g,T);this.needsUpload=!1,this._featureMap=new ar,this._bufferOffset=0}populatePaintArrays(u,g,T,D,z,F){for(const $ in this.programConfigurations)this.programConfigurations[$].populatePaintArrays(u,g,D,z,F);g.id!==void 0&&this._featureMap.add(g.id,T,this._bufferOffset,u),this._bufferOffset=u,this.needsUpload=!0}updatePaintArrays(u,g,T,D){for(const z of T)this.needsUpload=this.programConfigurations[z.id].updatePaintArrays(u,this._featureMap,g,z,D)||this.needsUpload}get(u){return this.programConfigurations[u]}upload(u){if(this.needsUpload){for(const g in this.programConfigurations)this.programConfigurations[g].upload(u);this.needsUpload=!1}}destroy(){for(const u in this.programConfigurations)this.programConfigurations[u].destroy()}}function R7(f,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(`${u}-`,"").replace(/-/g,"_")]}function k4(f,u,g){const T={color:{source:A,composite:$e},number:{source:ne,composite:A}},D=function(z){return{"line-pattern":{source:je,composite:je},"fill-pattern":{source:je,composite:je},"fill-extrusion-pattern":{source:je,composite:je}}[z]}(f);return D&&D[g]||T[u][g]}Nt("ConstantBinder",Xd),Nt("CrossFadedConstantBinder",Wf),Nt("SourceExpressionBinder",Su),Nt("CrossFadedCompositeBinder",kc),Nt("CompositeExpressionBinder",Ql),Nt("ProgramConfiguration",P4,{omit:["_buffers"]}),Nt("ProgramConfigurationSet",kh);var Bi=8192;const Nv=Math.pow(2,14)-1,I4=-Nv-1;function Ih(f){const u=Bi/f.extent,g=f.loadGeometry();for(let T=0;T<g.length;T++){const D=g[T];for(let z=0;z<D.length;z++){const F=D[z],$=Math.round(F.x*u),Z=Math.round(F.y*u);F.x=I($,I4,Nv),F.y=I(Z,I4,Nv),($<F.x||$>F.x+1||Z<F.y||Z>F.y+1)&&me("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return g}function Lh(f,u){return{type:f.type,id:f.id,properties:f.properties,geometry:u?Ih(f):[]}}function $m(f,u,g,T,D){f.emplaceBack(2*u+(T+1)/2,2*g+(D+1)/2)}class Uv{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(g=>g.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new q,this.indexArray=new ot,this.segments=new pt,this.programConfigurations=new kh(u.layers,u.zoom),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id)}populate(u,g,T){const D=this.layers[0],z=[];let F=null,$=!1;D.type==="circle"&&(F=D.layout.get("circle-sort-key"),$=!F.isConstant());for(const{feature:Z,id:re,index:Ae,sourceLayerIndex:ce}of u){const pe=this.layers[0]._featureFilter.needGeometry,ye=Lh(Z,pe);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),ye,T))continue;const _e=$?F.evaluate(ye,{},T):void 0,Ve={id:re,properties:Z.properties,type:Z.type,sourceLayerIndex:ce,index:Ae,geometry:pe?ye.geometry:Ih(Z),patterns:{},sortKey:_e};z.push(Ve)}$&&z.sort((Z,re)=>Z.sortKey-re.sortKey);for(const Z of z){const{geometry:re,index:Ae,sourceLayerIndex:ce}=Z,pe=u[Ae].feature;this.addFeature(Z,re,Ae,T),g.featureIndex.insert(pe,re,Ae,ce,this.index)}}update(u,g,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,g,this.stateDependentLayers,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,zt),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(u,g,T,D){for(const z of g)for(const F of z){const $=F.x,Z=F.y;if($<0||$>=Bi||Z<0||Z>=Bi)continue;const re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,u.sortKey),Ae=re.vertexLength;$m(this.layoutVertexArray,$,Z,-1,-1),$m(this.layoutVertexArray,$,Z,1,-1),$m(this.layoutVertexArray,$,Z,1,1),$m(this.layoutVertexArray,$,Z,-1,1),this.indexArray.emplaceBack(Ae,Ae+1,Ae+2),this.indexArray.emplaceBack(Ae,Ae+3,Ae+2),re.vertexLength+=4,re.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,{},D)}}function L4(f,u){for(let g=0;g<f.length;g++)if(Qf(u,f[g]))return!0;for(let g=0;g<u.length;g++)if(Qf(f,u[g]))return!0;return!!Vv(f,u)}function B7(f,u,g){return!!Qf(f,u)||!!Gv(u,f,g)}function D4(f,u){if(f.length===1)return B4(u,f[0]);for(let g=0;g<u.length;g++){const T=u[g];for(let D=0;D<T.length;D++)if(Qf(f,T[D]))return!0}for(let g=0;g<f.length;g++)if(B4(u,f[g]))return!0;for(let g=0;g<u.length;g++)if(Vv(f,u[g]))return!0;return!1}function z7(f,u,g){if(f.length>1){if(Vv(f,u))return!0;for(let T=0;T<u.length;T++)if(Gv(u[T],f,g))return!0}for(let T=0;T<f.length;T++)if(Gv(f[T],u,g))return!0;return!1}function Vv(f,u){if(f.length===0||u.length===0)return!1;for(let g=0;g<f.length-1;g++){const T=f[g],D=f[g+1];for(let z=0;z<u.length-1;z++)if(O7(T,D,u[z],u[z+1]))return!0}return!1}function O7(f,u,g,T){return Se(f,g,T)!==Se(u,g,T)&&Se(f,u,g)!==Se(f,u,T)}function Gv(f,u,g){const T=g*g;if(u.length===1)return f.distSqr(u[0])<T;for(let D=1;D<u.length;D++)if(R4(f,u[D-1],u[D])<T)return!0;return!1}function R4(f,u,g){const T=u.distSqr(g);if(T===0)return f.distSqr(u);const D=((f.x-u.x)*(g.x-u.x)+(f.y-u.y)*(g.y-u.y))/T;return f.distSqr(D<0?u:D>1?g:g.sub(u)._mult(D)._add(u))}function B4(f,u){let g,T,D,z=!1;for(let F=0;F<f.length;F++){g=f[F];for(let $=0,Z=g.length-1;$<g.length;Z=$++)T=g[$],D=g[Z],T.y>u.y!=D.y>u.y&&u.x<(D.x-T.x)*(u.y-T.y)/(D.y-T.y)+T.x&&(z=!z)}return z}function Qf(f,u){let g=!1;for(let T=0,D=f.length-1;T<f.length;D=T++){const z=f[T],F=f[D];z.y>u.y!=F.y>u.y&&u.x<(F.x-z.x)*(u.y-z.y)/(F.y-z.y)+z.x&&(g=!g)}return g}function F7(f,u,g){const T=g[0],D=g[2];if(f.x<T.x&&u.x<T.x||f.x>D.x&&u.x>D.x||f.y<T.y&&u.y<T.y||f.y>D.y&&u.y>D.y)return!1;const z=Se(f,u,g[0]);return z!==Se(f,u,g[1])||z!==Se(f,u,g[2])||z!==Se(f,u,g[3])}function Kd(f,u,g){const T=u.paint.get(f).value;return T.kind==="constant"?T.value:g.programConfigurations.get(u.id).getMaxValue(f)}function jm(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function Hm(f,u,g,T,D){if(!u[0]&&!u[1])return f;const z=Tt.convert(u)._mult(D);g==="viewport"&&z._rotate(-T);const F=[];for(let $=0;$<f.length;$++)F.push(f[$].sub(z));return F}Nt("CircleBucket",Uv,{omit:["layers"]});const N7=new $r({"circle-sort-key":new Xt(ht.layout_circle["circle-sort-key"])});var U7={paint:new $r({"circle-radius":new Xt(ht.paint_circle["circle-radius"]),"circle-color":new Xt(ht.paint_circle["circle-color"]),"circle-blur":new Xt(ht.paint_circle["circle-blur"]),"circle-opacity":new Xt(ht.paint_circle["circle-opacity"]),"circle-translate":new Yt(ht.paint_circle["circle-translate"]),"circle-translate-anchor":new Yt(ht.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Yt(ht.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Yt(ht.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Xt(ht.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Xt(ht.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Xt(ht.paint_circle["circle-stroke-opacity"])}),layout:N7},Ys=1e-6,Xs=typeof Float32Array<"u"?Float32Array:Array;function z4(){var f=new Xs(9);return Xs!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[5]=0,f[6]=0,f[7]=0),f[0]=1,f[4]=1,f[8]=1,f}function $v(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function O4(f,u,g){var T=u[0],D=u[1],z=u[2],F=u[3],$=u[4],Z=u[5],re=u[6],Ae=u[7],ce=u[8],pe=u[9],ye=u[10],_e=u[11],Ve=u[12],ze=u[13],tt=u[14],ut=u[15],et=g[0],at=g[1],mt=g[2],gt=g[3];return f[0]=et*T+at*$+mt*ce+gt*Ve,f[1]=et*D+at*Z+mt*pe+gt*ze,f[2]=et*z+at*re+mt*ye+gt*tt,f[3]=et*F+at*Ae+mt*_e+gt*ut,f[4]=(et=g[4])*T+(at=g[5])*$+(mt=g[6])*ce+(gt=g[7])*Ve,f[5]=et*D+at*Z+mt*pe+gt*ze,f[6]=et*z+at*re+mt*ye+gt*tt,f[7]=et*F+at*Ae+mt*_e+gt*ut,f[8]=(et=g[8])*T+(at=g[9])*$+(mt=g[10])*ce+(gt=g[11])*Ve,f[9]=et*D+at*Z+mt*pe+gt*ze,f[10]=et*z+at*re+mt*ye+gt*tt,f[11]=et*F+at*Ae+mt*_e+gt*ut,f[12]=(et=g[12])*T+(at=g[13])*$+(mt=g[14])*ce+(gt=g[15])*Ve,f[13]=et*D+at*Z+mt*pe+gt*ze,f[14]=et*z+at*re+mt*ye+gt*tt,f[15]=et*F+at*Ae+mt*_e+gt*ut,f}Math.hypot||(Math.hypot=function(){for(var f=0,u=arguments.length;u--;)f+=arguments[u]*arguments[u];return Math.sqrt(f)});var Jd,V7=O4;function F4(){var f=new Xs(3);return Xs!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f}function N4(f,u,g){var T=new Xs(3);return T[0]=f,T[1]=u,T[2]=g,T}function Wm(f,u,g){var T=u[0],D=u[1],z=u[2],F=u[3];return f[0]=g[0]*T+g[4]*D+g[8]*z+g[12]*F,f[1]=g[1]*T+g[5]*D+g[9]*z+g[13]*F,f[2]=g[2]*T+g[6]*D+g[10]*z+g[14]*F,f[3]=g[3]*T+g[7]*D+g[11]*z+g[15]*F,f}function U4(){var f=new Xs(4);return Xs!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f[3]=1,f}function V4(f,u){const g=Wm([],[f.x,f.y,0,1],u);return new Tt(g[0]/g[3],g[1]/g[3])}F4(),Jd=new Xs(4),Xs!=Float32Array&&(Jd[0]=0,Jd[1]=0,Jd[2]=0,Jd[3]=0),F4(),N4(1,0,0),N4(0,1,0),U4(),U4(),z4(),function(){var f;f=new Xs(2),Xs!=Float32Array&&(f[0]=0,f[1]=0)}();class G4 extends Uv{}Nt("HeatmapBucket",G4,{omit:["layers"]});var G7={paint:new $r({"heatmap-radius":new Xt(ht.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Xt(ht.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Yt(ht.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Xo(ht.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Yt(ht.paint_heatmap["heatmap-opacity"])})};function jv(f,{width:u,height:g},T,D){if(D){if(D instanceof Uint8ClampedArray)D=new Uint8Array(D.buffer);else if(D.length!==u*g*T)throw new RangeError(`mismatched image size. expected: ${D.length} but got: ${u*g*T}`)}else D=new Uint8Array(u*g*T);return f.width=u,f.height=g,f.data=D,f}function $4(f,{width:u,height:g},T){if(u===f.width&&g===f.height)return;const D=jv({},{width:u,height:g},T);Hv(f,D,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,u),height:Math.min(f.height,g)},T),f.width=u,f.height=g,f.data=D.data}function Hv(f,u,g,T,D,z){if(D.width===0||D.height===0)return u;if(D.width>f.width||D.height>f.height||g.x>f.width-D.width||g.y>f.height-D.height)throw new RangeError("out of range source coordinates for image copy");if(D.width>u.width||D.height>u.height||T.x>u.width-D.width||T.y>u.height-D.height)throw new RangeError("out of range destination coordinates for image copy");const F=f.data,$=u.data;if(F===$)throw new Error("srcData equals dstData, so image is already copied");for(let Z=0;Z<D.height;Z++){const re=((g.y+Z)*f.width+g.x)*z,Ae=((T.y+Z)*u.width+T.x)*z;for(let ce=0;ce<D.width*z;ce++)$[Ae+ce]=F[re+ce]}return u}class ep{constructor(u,g){jv(this,u,1,g)}resize(u){$4(this,u,1)}clone(){return new ep({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,g,T,D,z){Hv(u,g,T,D,z,1)}}class Ea{constructor(u,g){jv(this,u,4,g)}resize(u){$4(this,u,4)}replace(u,g){g?this.data.set(u):this.data=u instanceof Uint8ClampedArray?new Uint8Array(u.buffer):u}clone(){return new Ea({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,g,T,D,z){Hv(u,g,T,D,z,4)}}function j4(f){const u={},g=f.resolution||256,T=f.clips?f.clips.length:1,D=f.image||new Ea({width:g,height:T});if(Math.log(g)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${g}`);const z=(F,$,Z)=>{u[f.evaluationKey]=Z;const re=f.expression.evaluate(u);D.data[F+$+0]=Math.floor(255*re.r/re.a),D.data[F+$+1]=Math.floor(255*re.g/re.a),D.data[F+$+2]=Math.floor(255*re.b/re.a),D.data[F+$+3]=Math.floor(255*re.a)};if(f.clips)for(let F=0,$=0;F<T;++F,$+=4*g)for(let Z=0,re=0;Z<g;Z++,re+=4){const Ae=Z/(g-1),{start:ce,end:pe}=f.clips[F];z($,re,ce*(1-Ae)+pe*Ae)}else for(let F=0,$=0;F<g;F++,$+=4)z(0,$,F/(g-1));return D}Nt("AlphaImage",ep),Nt("RGBAImage",Ea);var $7={paint:new $r({"hillshade-illumination-direction":new Yt(ht.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Yt(ht.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Yt(ht.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Yt(ht.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Yt(ht.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Yt(ht.paint_hillshade["hillshade-accent-color"])})};const j7=jr([{name:"a_pos",components:2,type:"Int16"}],4),{members:H7}=j7;var Qm={exports:{}};function qm(f,u,g){g=g||2;var T,D,z,F,$,Z,re,Ae=u&&u.length,ce=Ae?u[0]*g:f.length,pe=H4(f,0,ce,g,!0),ye=[];if(!pe||pe.next===pe.prev)return ye;if(Ae&&(pe=function(Ve,ze,tt,ut){var et,at,mt,gt=[];for(et=0,at=ze.length;et<at;et++)(mt=H4(Ve,ze[et]*ut,et<at-1?ze[et+1]*ut:Ve.length,ut,!1))===mt.next&&(mt.steiner=!0),gt.push(J7(mt));for(gt.sort(Y7),et=0;et<gt.length;et++)tt=X7(gt[et],tt);return tt}(f,u,pe,g)),f.length>80*g){T=z=f[0],D=F=f[1];for(var _e=g;_e<ce;_e+=g)($=f[_e])<T&&(T=$),(Z=f[_e+1])<D&&(D=Z),$>z&&(z=$),Z>F&&(F=Z);re=(re=Math.max(z-T,F-D))!==0?32767/re:0}return tp(pe,ye,g,T,D,re,0),ye}function H4(f,u,g,T,D){var z,F;if(D===qv(f,u,g,T)>0)for(z=u;z<g;z+=T)F=q4(z,f[z],f[z+1],F);else for(z=g-T;z>=u;z-=T)F=q4(z,f[z],f[z+1],F);return F&&Zm(F,F.next)&&(rp(F),F=F.next),F}function Dh(f,u){if(!f)return f;u||(u=f);var g,T=f;do if(g=!1,T.steiner||!Zm(T,T.next)&&gi(T.prev,T,T.next)!==0)T=T.next;else{if(rp(T),(T=u=T.prev)===T.next)break;g=!0}while(g||T!==u);return u}function tp(f,u,g,T,D,z,F){if(f){!F&&z&&function(Ae,ce,pe,ye){var _e=Ae;do _e.z===0&&(_e.z=Wv(_e.x,_e.y,ce,pe,ye)),_e.prevZ=_e.prev,_e.nextZ=_e.next,_e=_e.next;while(_e!==Ae);_e.prevZ.nextZ=null,_e.prevZ=null,function(Ve){var ze,tt,ut,et,at,mt,gt,Zt,tn=1;do{for(tt=Ve,Ve=null,at=null,mt=0;tt;){for(mt++,ut=tt,gt=0,ze=0;ze<tn&&(gt++,ut=ut.nextZ);ze++);for(Zt=tn;gt>0||Zt>0&&ut;)gt!==0&&(Zt===0||!ut||tt.z<=ut.z)?(et=tt,tt=tt.nextZ,gt--):(et=ut,ut=ut.nextZ,Zt--),at?at.nextZ=et:Ve=et,et.prevZ=at,at=et;tt=ut}at.nextZ=null,tn*=2}while(mt>1)}(_e)}(f,T,D,z);for(var $,Z,re=f;f.prev!==f.next;)if($=f.prev,Z=f.next,z?Q7(f,T,D,z):W7(f))u.push($.i/g|0),u.push(f.i/g|0),u.push(Z.i/g|0),rp(f),f=Z.next,re=Z.next;else if((f=Z)===re){F?F===1?tp(f=q7(Dh(f),u,g),u,g,T,D,z,2):F===2&&Z7(f,u,g,T,D,z):tp(Dh(f),u,g,T,D,z,1);break}}}function W7(f){var u=f.prev,g=f,T=f.next;if(gi(u,g,T)>=0)return!1;for(var D=u.x,z=g.x,F=T.x,$=u.y,Z=g.y,re=T.y,Ae=D<z?D<F?D:F:z<F?z:F,ce=$<Z?$<re?$:re:Z<re?Z:re,pe=D>z?D>F?D:F:z>F?z:F,ye=$>Z?$>re?$:re:Z>re?Z:re,_e=T.next;_e!==u;){if(_e.x>=Ae&&_e.x<=pe&&_e.y>=ce&&_e.y<=ye&&qf(D,$,z,Z,F,re,_e.x,_e.y)&&gi(_e.prev,_e,_e.next)>=0)return!1;_e=_e.next}return!0}function Q7(f,u,g,T){var D=f.prev,z=f,F=f.next;if(gi(D,z,F)>=0)return!1;for(var $=D.x,Z=z.x,re=F.x,Ae=D.y,ce=z.y,pe=F.y,ye=$<Z?$<re?$:re:Z<re?Z:re,_e=Ae<ce?Ae<pe?Ae:pe:ce<pe?ce:pe,Ve=$>Z?$>re?$:re:Z>re?Z:re,ze=Ae>ce?Ae>pe?Ae:pe:ce>pe?ce:pe,tt=Wv(ye,_e,u,g,T),ut=Wv(Ve,ze,u,g,T),et=f.prevZ,at=f.nextZ;et&&et.z>=tt&&at&&at.z<=ut;){if(et.x>=ye&&et.x<=Ve&&et.y>=_e&&et.y<=ze&&et!==D&&et!==F&&qf($,Ae,Z,ce,re,pe,et.x,et.y)&&gi(et.prev,et,et.next)>=0||(et=et.prevZ,at.x>=ye&&at.x<=Ve&&at.y>=_e&&at.y<=ze&&at!==D&&at!==F&&qf($,Ae,Z,ce,re,pe,at.x,at.y)&&gi(at.prev,at,at.next)>=0))return!1;at=at.nextZ}for(;et&&et.z>=tt;){if(et.x>=ye&&et.x<=Ve&&et.y>=_e&&et.y<=ze&&et!==D&&et!==F&&qf($,Ae,Z,ce,re,pe,et.x,et.y)&&gi(et.prev,et,et.next)>=0)return!1;et=et.prevZ}for(;at&&at.z<=ut;){if(at.x>=ye&&at.x<=Ve&&at.y>=_e&&at.y<=ze&&at!==D&&at!==F&&qf($,Ae,Z,ce,re,pe,at.x,at.y)&&gi(at.prev,at,at.next)>=0)return!1;at=at.nextZ}return!0}function q7(f,u,g){var T=f;do{var D=T.prev,z=T.next.next;!Zm(D,z)&&W4(D,T,T.next,z)&&np(D,z)&&np(z,D)&&(u.push(D.i/g|0),u.push(T.i/g|0),u.push(z.i/g|0),rp(T),rp(T.next),T=f=z),T=T.next}while(T!==f);return Dh(T)}function Z7(f,u,g,T,D,z){var F=f;do{for(var $=F.next.next;$!==F.prev;){if(F.i!==$.i&&eN(F,$)){var Z=Q4(F,$);return F=Dh(F,F.next),Z=Dh(Z,Z.next),tp(F,u,g,T,D,z,0),void tp(Z,u,g,T,D,z,0)}$=$.next}F=F.next}while(F!==f)}function Y7(f,u){return f.x-u.x}function X7(f,u){var g=function(D,z){var F,$=z,Z=D.x,re=D.y,Ae=-1/0;do{if(re<=$.y&&re>=$.next.y&&$.next.y!==$.y){var ce=$.x+(re-$.y)*($.next.x-$.x)/($.next.y-$.y);if(ce<=Z&&ce>Ae&&(Ae=ce,F=$.x<$.next.x?$:$.next,ce===Z))return F}$=$.next}while($!==z);if(!F)return null;var pe,ye=F,_e=F.x,Ve=F.y,ze=1/0;$=F;do Z>=$.x&&$.x>=_e&&Z!==$.x&&qf(re<Ve?Z:Ae,re,_e,Ve,re<Ve?Ae:Z,re,$.x,$.y)&&(pe=Math.abs(re-$.y)/(Z-$.x),np($,D)&&(pe<ze||pe===ze&&($.x>F.x||$.x===F.x&&K7(F,$)))&&(F=$,ze=pe)),$=$.next;while($!==ye);return F}(f,u);if(!g)return u;var T=Q4(g,f);return Dh(T,T.next),Dh(g,g.next)}function K7(f,u){return gi(f.prev,f,u.prev)<0&&gi(u.next,f,f.next)<0}function Wv(f,u,g,T,D){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-g)*D|0)|f<<8))|f<<4))|f<<2))|f<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-T)*D|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function J7(f){var u=f,g=f;do(u.x<g.x||u.x===g.x&&u.y<g.y)&&(g=u),u=u.next;while(u!==f);return g}function qf(f,u,g,T,D,z,F,$){return(D-F)*(u-$)>=(f-F)*(z-$)&&(f-F)*(T-$)>=(g-F)*(u-$)&&(g-F)*(z-$)>=(D-F)*(T-$)}function eN(f,u){return f.next.i!==u.i&&f.prev.i!==u.i&&!function(g,T){var D=g;do{if(D.i!==g.i&&D.next.i!==g.i&&D.i!==T.i&&D.next.i!==T.i&&W4(D,D.next,g,T))return!0;D=D.next}while(D!==g);return!1}(f,u)&&(np(f,u)&&np(u,f)&&function(g,T){var D=g,z=!1,F=(g.x+T.x)/2,$=(g.y+T.y)/2;do D.y>$!=D.next.y>$&&D.next.y!==D.y&&F<(D.next.x-D.x)*($-D.y)/(D.next.y-D.y)+D.x&&(z=!z),D=D.next;while(D!==g);return z}(f,u)&&(gi(f.prev,f,u.prev)||gi(f,u.prev,u))||Zm(f,u)&&gi(f.prev,f,f.next)>0&&gi(u.prev,u,u.next)>0)}function gi(f,u,g){return(u.y-f.y)*(g.x-u.x)-(u.x-f.x)*(g.y-u.y)}function Zm(f,u){return f.x===u.x&&f.y===u.y}function W4(f,u,g,T){var D=Xm(gi(f,u,g)),z=Xm(gi(f,u,T)),F=Xm(gi(g,T,f)),$=Xm(gi(g,T,u));return D!==z&&F!==$||!(D!==0||!Ym(f,g,u))||!(z!==0||!Ym(f,T,u))||!(F!==0||!Ym(g,f,T))||!($!==0||!Ym(g,u,T))}function Ym(f,u,g){return u.x<=Math.max(f.x,g.x)&&u.x>=Math.min(f.x,g.x)&&u.y<=Math.max(f.y,g.y)&&u.y>=Math.min(f.y,g.y)}function Xm(f){return f>0?1:f<0?-1:0}function np(f,u){return gi(f.prev,f,f.next)<0?gi(f,u,f.next)>=0&&gi(f,f.prev,u)>=0:gi(f,u,f.prev)<0||gi(f,f.next,u)<0}function Q4(f,u){var g=new Qv(f.i,f.x,f.y),T=new Qv(u.i,u.x,u.y),D=f.next,z=u.prev;return f.next=u,u.prev=f,g.next=D,D.prev=g,T.next=g,g.prev=T,z.next=T,T.prev=z,T}function q4(f,u,g,T){var D=new Qv(f,u,g);return T?(D.next=T.next,D.prev=T,T.next.prev=D,T.next=D):(D.prev=D,D.next=D),D}function rp(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function Qv(f,u,g){this.i=f,this.x=u,this.y=g,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function qv(f,u,g,T){for(var D=0,z=u,F=g-T;z<g;z+=T)D+=(f[F]-f[z])*(f[z+1]+f[F+1]),F=z;return D}function tN(f,u,g,T,D){Z4(f,u,g||0,T||f.length-1,D||nN)}function Z4(f,u,g,T,D){for(;T>g;){if(T-g>600){var z=T-g+1,F=u-g+1,$=Math.log(z),Z=.5*Math.exp(2*$/3),re=.5*Math.sqrt($*Z*(z-Z)/z)*(F-z/2<0?-1:1);Z4(f,u,Math.max(g,Math.floor(u-F*Z/z+re)),Math.min(T,Math.floor(u+(z-F)*Z/z+re)),D)}var Ae=f[u],ce=g,pe=T;for(ip(f,g,u),D(f[T],Ae)>0&&ip(f,g,T);ce<pe;){for(ip(f,ce,pe),ce++,pe--;D(f[ce],Ae)<0;)ce++;for(;D(f[pe],Ae)>0;)pe--}D(f[g],Ae)===0?ip(f,g,pe):ip(f,++pe,T),pe<=u&&(g=pe+1),u<=pe&&(T=pe-1)}}function ip(f,u,g){var T=f[u];f[u]=f[g],f[g]=T}function nN(f,u){return f<u?-1:f>u?1:0}function Zv(f,u){const g=f.length;if(g<=1)return[f];const T=[];let D,z;for(let F=0;F<g;F++){const $=He(f[F]);$!==0&&(f[F].area=Math.abs($),z===void 0&&(z=$<0),z===$<0?(D&&T.push(D),D=[f[F]]):D.push(f[F]))}if(D&&T.push(D),u>1)for(let F=0;F<T.length;F++)T[F].length<=u||(tN(T[F],u,1,T[F].length-1,rN),T[F]=T[F].slice(0,u));return T}function rN(f,u){return u.area-f.area}function Yv(f,u,g){const T=g.patternDependencies;let D=!1;for(const z of u){const F=z.paint.get(`${f}-pattern`);F.isConstant()||(D=!0);const $=F.constantOr(null);$&&(D=!0,T[$.to]=!0,T[$.from]=!0)}return D}function Xv(f,u,g,T,D){const z=D.patternDependencies;for(const F of u){const $=F.paint.get(`${f}-pattern`).value;if($.kind!=="constant"){let Z=$.evaluate({zoom:T-1},g,{},D.availableImages),re=$.evaluate({zoom:T},g,{},D.availableImages),Ae=$.evaluate({zoom:T+1},g,{},D.availableImages);Z=Z&&Z.name?Z.name:Z,re=re&&re.name?re.name:re,Ae=Ae&&Ae.name?Ae.name:Ae,z[Z]=!0,z[re]=!0,z[Ae]=!0,g.patterns[F.id]={min:Z,mid:re,max:Ae}}}return g}Qm.exports=qm,Qm.exports.default=qm,qm.deviation=function(f,u,g,T){var D=u&&u.length,z=Math.abs(qv(f,0,D?u[0]*g:f.length,g));if(D)for(var F=0,$=u.length;F<$;F++)z-=Math.abs(qv(f,u[F]*g,F<$-1?u[F+1]*g:f.length,g));var Z=0;for(F=0;F<T.length;F+=3){var re=T[F]*g,Ae=T[F+1]*g,ce=T[F+2]*g;Z+=Math.abs((f[re]-f[ce])*(f[Ae+1]-f[re+1])-(f[re]-f[Ae])*(f[ce+1]-f[re+1]))}return z===0&&Z===0?0:Math.abs((Z-z)/z)},qm.flatten=function(f){for(var u=f[0][0].length,g={vertices:[],holes:[],dimensions:u},T=0,D=0;D<f.length;D++){for(var z=0;z<f[D].length;z++)for(var F=0;F<u;F++)g.vertices.push(f[D][z][F]);D>0&&g.holes.push(T+=f[D-1].length)}return g};class Kv{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(g=>g.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new J,this.indexArray=new ot,this.indexArray2=new Je,this.programConfigurations=new kh(u.layers,u.zoom),this.segments=new pt,this.segments2=new pt,this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id)}populate(u,g,T){this.hasPattern=Yv("fill",this.layers,g);const D=this.layers[0].layout.get("fill-sort-key"),z=!D.isConstant(),F=[];for(const{feature:$,id:Z,index:re,sourceLayerIndex:Ae}of u){const ce=this.layers[0]._featureFilter.needGeometry,pe=Lh($,ce);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),pe,T))continue;const ye=z?D.evaluate(pe,{},T,g.availableImages):void 0,_e={id:Z,properties:$.properties,type:$.type,sourceLayerIndex:Ae,index:re,geometry:ce?pe.geometry:Ih($),patterns:{},sortKey:ye};F.push(_e)}z&&F.sort(($,Z)=>$.sortKey-Z.sortKey);for(const $ of F){const{geometry:Z,index:re,sourceLayerIndex:Ae}=$;if(this.hasPattern){const ce=Xv("fill",this.layers,$,this.zoom,g);this.patternFeatures.push(ce)}else this.addFeature($,Z,re,T,{});g.featureIndex.insert(u[re].feature,Z,re,Ae,this.index)}}update(u,g,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,g,this.stateDependentLayers,T)}addFeatures(u,g,T){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,g,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,H7),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.indexBuffer2=u.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(u,g,T,D,z){for(const F of Zv(g,500)){let $=0;for(const ye of F)$+=ye.length;const Z=this.segments.prepareSegment($,this.layoutVertexArray,this.indexArray),re=Z.vertexLength,Ae=[],ce=[];for(const ye of F){if(ye.length===0)continue;ye!==F[0]&&ce.push(Ae.length/2);const _e=this.segments2.prepareSegment(ye.length,this.layoutVertexArray,this.indexArray2),Ve=_e.vertexLength;this.layoutVertexArray.emplaceBack(ye[0].x,ye[0].y),this.indexArray2.emplaceBack(Ve+ye.length-1,Ve),Ae.push(ye[0].x),Ae.push(ye[0].y);for(let ze=1;ze<ye.length;ze++)this.layoutVertexArray.emplaceBack(ye[ze].x,ye[ze].y),this.indexArray2.emplaceBack(Ve+ze-1,Ve+ze),Ae.push(ye[ze].x),Ae.push(ye[ze].y);_e.vertexLength+=ye.length,_e.primitiveLength+=ye.length}const pe=Qm.exports(Ae,ce);for(let ye=0;ye<pe.length;ye+=3)this.indexArray.emplaceBack(re+pe[ye],re+pe[ye+1],re+pe[ye+2]);Z.vertexLength+=$,Z.primitiveLength+=pe.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}}Nt("FillBucket",Kv,{omit:["layers","patternFeatures"]});const iN=new $r({"fill-sort-key":new Xt(ht.layout_fill["fill-sort-key"])});var sN={paint:new $r({"fill-antialias":new Yt(ht.paint_fill["fill-antialias"]),"fill-opacity":new Xt(ht.paint_fill["fill-opacity"]),"fill-color":new Xt(ht.paint_fill["fill-color"]),"fill-outline-color":new Xt(ht.paint_fill["fill-outline-color"]),"fill-translate":new Yt(ht.paint_fill["fill-translate"]),"fill-translate-anchor":new Yt(ht.paint_fill["fill-translate-anchor"]),"fill-pattern":new hn(ht.paint_fill["fill-pattern"])}),layout:iN};const oN=jr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),aN=jr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:lN}=oN;var Ic={},AN=Tt,Y4=Zf;function Zf(f,u,g,T,D){this.properties={},this.extent=g,this.type=0,this._pbf=f,this._geometry=-1,this._keys=T,this._values=D,f.readFields(uN,this,u)}function uN(f,u,g){f==1?u.id=g.readVarint():f==2?function(T,D){for(var z=T.readVarint()+T.pos;T.pos<z;){var F=D._keys[T.readVarint()],$=D._values[T.readVarint()];D.properties[F]=$}}(g,u):f==3?u.type=g.readVarint():f==4&&(u._geometry=g.pos)}function cN(f){for(var u,g,T=0,D=0,z=f.length,F=z-1;D<z;F=D++)T+=((g=f[F]).x-(u=f[D]).x)*(u.y+g.y);return T}Zf.types=["Unknown","Point","LineString","Polygon"],Zf.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var u,g=f.readVarint()+f.pos,T=1,D=0,z=0,F=0,$=[];f.pos<g;){if(D<=0){var Z=f.readVarint();T=7&Z,D=Z>>3}if(D--,T===1||T===2)z+=f.readSVarint(),F+=f.readSVarint(),T===1&&(u&&$.push(u),u=[]),u.push(new AN(z,F));else{if(T!==7)throw new Error("unknown command "+T);u&&u.push(u[0].clone())}}return u&&$.push(u),$},Zf.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var u=f.readVarint()+f.pos,g=1,T=0,D=0,z=0,F=1/0,$=-1/0,Z=1/0,re=-1/0;f.pos<u;){if(T<=0){var Ae=f.readVarint();g=7&Ae,T=Ae>>3}if(T--,g===1||g===2)(D+=f.readSVarint())<F&&(F=D),D>$&&($=D),(z+=f.readSVarint())<Z&&(Z=z),z>re&&(re=z);else if(g!==7)throw new Error("unknown command "+g)}return[F,Z,$,re]},Zf.prototype.toGeoJSON=function(f,u,g){var T,D,z=this.extent*Math.pow(2,g),F=this.extent*f,$=this.extent*u,Z=this.loadGeometry(),re=Zf.types[this.type];function Ae(ye){for(var _e=0;_e<ye.length;_e++){var Ve=ye[_e];ye[_e]=[360*(Ve.x+F)/z-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ve.y+$)/z)*Math.PI/180))-90]}}switch(this.type){case 1:var ce=[];for(T=0;T<Z.length;T++)ce[T]=Z[T][0];Ae(Z=ce);break;case 2:for(T=0;T<Z.length;T++)Ae(Z[T]);break;case 3:for(Z=function(ye){var _e=ye.length;if(_e<=1)return[ye];for(var Ve,ze,tt=[],ut=0;ut<_e;ut++){var et=cN(ye[ut]);et!==0&&(ze===void 0&&(ze=et<0),ze===et<0?(Ve&&tt.push(Ve),Ve=[ye[ut]]):Ve.push(ye[ut]))}return Ve&&tt.push(Ve),tt}(Z),T=0;T<Z.length;T++)for(D=0;D<Z[T].length;D++)Ae(Z[T][D])}Z.length===1?Z=Z[0]:re="Multi"+re;var pe={type:"Feature",geometry:{type:re,coordinates:Z},properties:this.properties};return"id"in this&&(pe.id=this.id),pe};var hN=Y4,X4=K4;function K4(f,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(fN,this,u),this.length=this._features.length}function fN(f,u,g){f===15?u.version=g.readVarint():f===1?u.name=g.readString():f===5?u.extent=g.readVarint():f===2?u._features.push(g.pos):f===3?u._keys.push(g.readString()):f===4&&u._values.push(function(T){for(var D=null,z=T.readVarint()+T.pos;T.pos<z;){var F=T.readVarint()>>3;D=F===1?T.readString():F===2?T.readFloat():F===3?T.readDouble():F===4?T.readVarint64():F===5?T.readVarint():F===6?T.readSVarint():F===7?T.readBoolean():null}return D}(g))}K4.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var u=this._pbf.readVarint()+this._pbf.pos;return new hN(this._pbf,u,this.extent,this._keys,this._values)};var dN=X4;function pN(f,u,g){if(f===3){var T=new dN(g,g.readVarint()+g.pos);T.length&&(u[T.name]=T)}}Ic.VectorTile=function(f,u){this.layers=f.readFields(pN,{},u)},Ic.VectorTileFeature=Y4,Ic.VectorTileLayer=X4;const gN=Ic.VectorTileFeature.types,Jv=Math.pow(2,13);function sp(f,u,g,T,D,z,F,$){f.emplaceBack(u,g,2*Math.floor(T*Jv)+F,D*Jv*2,z*Jv*2,Math.round($))}class ex{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(g=>g.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new le,this.centroidVertexArray=new N,this.indexArray=new ot,this.programConfigurations=new kh(u.layers,u.zoom),this.segments=new pt,this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id)}populate(u,g,T){this.features=[],this.hasPattern=Yv("fill-extrusion",this.layers,g);for(const{feature:D,id:z,index:F,sourceLayerIndex:$}of u){const Z=this.layers[0]._featureFilter.needGeometry,re=Lh(D,Z);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),re,T))continue;const Ae={id:z,sourceLayerIndex:$,index:F,geometry:Z?re.geometry:Ih(D),properties:D.properties,type:D.type,patterns:{}};this.hasPattern?this.features.push(Xv("fill-extrusion",this.layers,Ae,this.zoom,g)):this.addFeature(Ae,Ae.geometry,F,T,{}),g.featureIndex.insert(D,Ae.geometry,F,$,this.index,!0)}}addFeatures(u,g,T){for(const D of this.features){const{geometry:z}=D;this.addFeature(D,z,D.index,g,T)}}update(u,g,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,g,this.stateDependentLayers,T)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,lN),this.centroidVertexBuffer=u.createVertexBuffer(this.centroidVertexArray,aN.members,!0),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(u,g,T,D,z){const F={x:0,y:0,vertexCount:0};for(const $ of Zv(g,500)){let Z=0;for(const _e of $)Z+=_e.length;let re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const _e of $){if(_e.length===0||yN(_e))continue;let Ve=0;for(let ze=0;ze<_e.length;ze++){const tt=_e[ze];if(ze>=1){const ut=_e[ze-1];if(!mN(tt,ut)){re.vertexLength+4>pt.MAX_VERTEX_ARRAY_LENGTH&&(re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const et=tt.sub(ut)._perp()._unit(),at=ut.dist(tt);Ve+at>32768&&(Ve=0),sp(this.layoutVertexArray,tt.x,tt.y,et.x,et.y,0,0,Ve),sp(this.layoutVertexArray,tt.x,tt.y,et.x,et.y,0,1,Ve),F.x+=2*tt.x,F.y+=2*tt.y,F.vertexCount+=2,Ve+=at,sp(this.layoutVertexArray,ut.x,ut.y,et.x,et.y,0,0,Ve),sp(this.layoutVertexArray,ut.x,ut.y,et.x,et.y,0,1,Ve),F.x+=2*ut.x,F.y+=2*ut.y,F.vertexCount+=2;const mt=re.vertexLength;this.indexArray.emplaceBack(mt,mt+2,mt+1),this.indexArray.emplaceBack(mt+1,mt+2,mt+3),re.vertexLength+=4,re.primitiveLength+=2}}}}if(re.vertexLength+Z>pt.MAX_VERTEX_ARRAY_LENGTH&&(re=this.segments.prepareSegment(Z,this.layoutVertexArray,this.indexArray)),gN[u.type]!=="Polygon")continue;const Ae=[],ce=[],pe=re.vertexLength;for(const _e of $)if(_e.length!==0){_e!==$[0]&&ce.push(Ae.length/2);for(let Ve=0;Ve<_e.length;Ve++){const ze=_e[Ve];sp(this.layoutVertexArray,ze.x,ze.y,0,0,1,1,0),F.x+=ze.x,F.y+=ze.y,F.vertexCount+=1,Ae.push(ze.x),Ae.push(ze.y)}}const ye=Qm.exports(Ae,ce);for(let _e=0;_e<ye.length;_e+=3)this.indexArray.emplaceBack(pe+ye[_e],pe+ye[_e+2],pe+ye[_e+1]);re.primitiveLength+=ye.length/3,re.vertexLength+=Z}for(let $=0;$<F.vertexCount;$++)this.centroidVertexArray.emplaceBack(Math.floor(F.x/F.vertexCount),Math.floor(F.y/F.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}}function mN(f,u){return f.x===u.x&&(f.x<0||f.x>Bi)||f.y===u.y&&(f.y<0||f.y>Bi)}function yN(f){return f.every(u=>u.x<0)||f.every(u=>u.x>Bi)||f.every(u=>u.y<0)||f.every(u=>u.y>Bi)}Nt("FillExtrusionBucket",ex,{omit:["layers","features"]});var _N={paint:new $r({"fill-extrusion-opacity":new Yt(ht["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Xt(ht["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Yt(ht["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Yt(ht["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new hn(ht["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Xt(ht["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Xt(ht["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Yt(ht["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function op(f,u){return f.x*u.x+f.y*u.y}function J4(f,u){if(f.length===1){let g=0;const T=u[g++];let D;for(;!D||T.equals(D);)if(D=u[g++],!D)return 1/0;for(;g<u.length;g++){const z=u[g],F=f[0],$=D.sub(T),Z=z.sub(T),re=F.sub(T),Ae=op($,$),ce=op($,Z),pe=op(Z,Z),ye=op(re,$),_e=op(re,Z),Ve=Ae*pe-ce*ce,ze=(pe*ye-ce*_e)/Ve,tt=(Ae*_e-ce*ye)/Ve,ut=T.z*(1-ze-tt)+D.z*ze+z.z*tt;if(isFinite(ut))return ut}return 1/0}{let g=1/0;for(const T of u)g=Math.min(g,T.z);return g}}const vN=jr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:xN}=vN,wN=jr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:bN}=wN,EN=Ic.VectorTileFeature.types,TN=Math.cos(Math.PI/180*37.5),e5=Math.pow(2,14)/.5;class tx{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(g=>g.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(g=>{this.gradients[g.id]={}}),this.layoutVertexArray=new de,this.layoutVertexArray2=new Re,this.indexArray=new ot,this.programConfigurations=new kh(u.layers,u.zoom),this.segments=new pt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id)}populate(u,g,T){this.hasPattern=Yv("line",this.layers,g);const D=this.layers[0].layout.get("line-sort-key"),z=!D.isConstant(),F=[];for(const{feature:$,id:Z,index:re,sourceLayerIndex:Ae}of u){const ce=this.layers[0]._featureFilter.needGeometry,pe=Lh($,ce);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),pe,T))continue;const ye=z?D.evaluate(pe,{},T):void 0,_e={id:Z,properties:$.properties,type:$.type,sourceLayerIndex:Ae,index:re,geometry:ce?pe.geometry:Ih($),patterns:{},sortKey:ye};F.push(_e)}z&&F.sort(($,Z)=>$.sortKey-Z.sortKey);for(const $ of F){const{geometry:Z,index:re,sourceLayerIndex:Ae}=$;if(this.hasPattern){const ce=Xv("line",this.layers,$,this.zoom,g);this.patternFeatures.push(ce)}else this.addFeature($,Z,re,T,{});g.featureIndex.insert(u[re].feature,Z,re,Ae,this.index)}}update(u,g,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,g,this.stateDependentLayers,T)}addFeatures(u,g,T){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,g,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=u.createVertexBuffer(this.layoutVertexArray2,bN)),this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,xN),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(u){if(u.properties&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_end"))return{start:+u.properties.mapbox_clip_start,end:+u.properties.mapbox_clip_end}}addFeature(u,g,T,D,z){const F=this.layers[0].layout,$=F.get("line-join").evaluate(u,{}),Z=F.get("line-cap"),re=F.get("line-miter-limit"),Ae=F.get("line-round-limit");this.lineClips=this.lineFeatureClips(u);for(const ce of g)this.addLine(ce,u,$,Z,re,Ae);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}addLine(u,g,T,D,z,F){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let tt=0;tt<u.length-1;tt++)this.totalDistance+=u[tt].dist(u[tt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const $=EN[g.type]==="Polygon";let Z=u.length;for(;Z>=2&&u[Z-1].equals(u[Z-2]);)Z--;let re=0;for(;re<Z-1&&u[re].equals(u[re+1]);)re++;if(Z<($?3:2))return;T==="bevel"&&(z=1.05);const Ae=this.overscaling<=16?122880/(512*this.overscaling):0,ce=this.segments.prepareSegment(10*Z,this.layoutVertexArray,this.indexArray);let pe,ye,_e,Ve,ze;this.e1=this.e2=-1,$&&(pe=u[Z-2],ze=u[re].sub(pe)._unit()._perp());for(let tt=re;tt<Z;tt++){if(_e=tt===Z-1?$?u[re+1]:void 0:u[tt+1],_e&&u[tt].equals(_e))continue;ze&&(Ve=ze),pe&&(ye=pe),pe=u[tt],ze=_e?_e.sub(pe)._unit()._perp():Ve,Ve=Ve||ze;let ut=Ve.add(ze);ut.x===0&&ut.y===0||ut._unit();const et=Ve.x*ze.x+Ve.y*ze.y,at=ut.x*ze.x+ut.y*ze.y,mt=at!==0?1/at:1/0,gt=2*Math.sqrt(2-2*at),Zt=at<TN&&ye&&_e,tn=Ve.x*ze.y-Ve.y*ze.x>0;if(Zt&&tt>re){const Ot=pe.dist(ye);if(Ot>2*Ae){const Wt=pe.sub(pe.sub(ye)._mult(Ae/Ot)._round());this.updateDistance(ye,Wt),this.addCurrentVertex(Wt,Ve,0,0,ce),ye=Wt}}const Ht=ye&&_e;let Ut=Ht?T:$?"butt":D;if(Ht&&Ut==="round"&&(mt<F?Ut="miter":mt<=2&&(Ut="fakeround")),Ut==="miter"&&mt>z&&(Ut="bevel"),Ut==="bevel"&&(mt>2&&(Ut="flipbevel"),mt<z&&(Ut="miter")),ye&&this.updateDistance(ye,pe),Ut==="miter")ut._mult(mt),this.addCurrentVertex(pe,ut,0,0,ce);else if(Ut==="flipbevel"){if(mt>100)ut=ze.mult(-1);else{const Ot=mt*Ve.add(ze).mag()/Ve.sub(ze).mag();ut._perp()._mult(Ot*(tn?-1:1))}this.addCurrentVertex(pe,ut,0,0,ce),this.addCurrentVertex(pe,ut.mult(-1),0,0,ce)}else if(Ut==="bevel"||Ut==="fakeround"){const Ot=-Math.sqrt(mt*mt-1),Wt=tn?Ot:0,$t=tn?0:Ot;if(ye&&this.addCurrentVertex(pe,Ve,Wt,$t,ce),Ut==="fakeround"){const St=Math.round(180*gt/Math.PI/20);for(let gn=1;gn<St;gn++){let ln=gn/St;if(ln!==.5){const Ur=ln-.5;ln+=ln*Ur*(ln-1)*((1.0904+et*(et*(3.55645-1.43519*et)-3.2452))*Ur*Ur+(.848013+et*(.215638*et-1.06021)))}const Hn=ze.sub(Ve)._mult(ln)._add(Ve)._unit()._mult(tn?-1:1);this.addHalfVertex(pe,Hn.x,Hn.y,!1,tn,0,ce)}}_e&&this.addCurrentVertex(pe,ze,-Wt,-$t,ce)}else if(Ut==="butt")this.addCurrentVertex(pe,ut,0,0,ce);else if(Ut==="square"){const Ot=ye?1:-1;this.addCurrentVertex(pe,ut,Ot,Ot,ce)}else Ut==="round"&&(ye&&(this.addCurrentVertex(pe,Ve,0,0,ce),this.addCurrentVertex(pe,Ve,1,1,ce,!0)),_e&&(this.addCurrentVertex(pe,ze,-1,-1,ce,!0),this.addCurrentVertex(pe,ze,0,0,ce)));if(Zt&&tt<Z-1){const Ot=pe.dist(_e);if(Ot>2*Ae){const Wt=pe.add(_e.sub(pe)._mult(Ae/Ot)._round());this.updateDistance(pe,Wt),this.addCurrentVertex(Wt,ze,0,0,ce),pe=Wt}}}}addCurrentVertex(u,g,T,D,z,F=!1){const $=g.y*D-g.x,Z=-g.y-g.x*D;this.addHalfVertex(u,g.x+g.y*T,g.y-g.x*T,F,!1,T,z),this.addHalfVertex(u,$,Z,F,!0,-D,z),this.distance>e5/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(u,g,T,D,z,F))}addHalfVertex({x:u,y:g},T,D,z,F,$,Z){const re=.5*(this.lineClips?this.scaledDistance*(e5-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((u<<1)+(z?1:0),(g<<1)+(F?1:0),Math.round(63*T)+128,Math.round(63*D)+128,1+($===0?0:$<0?-1:1)|(63&re)<<2,re>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Ae=Z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Ae),Z.primitiveLength++),F?this.e2=Ae:this.e1=Ae}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(u,g){this.distance+=u.dist(g),this.updateScaledDistance()}}Nt("LineBucket",tx,{omit:["layers","patternFeatures"]});const SN=new $r({"line-cap":new Yt(ht.layout_line["line-cap"]),"line-join":new Xt(ht.layout_line["line-join"]),"line-miter-limit":new Yt(ht.layout_line["line-miter-limit"]),"line-round-limit":new Yt(ht.layout_line["line-round-limit"]),"line-sort-key":new Xt(ht.layout_line["line-sort-key"])});var t5={paint:new $r({"line-opacity":new Xt(ht.paint_line["line-opacity"]),"line-color":new Xt(ht.paint_line["line-color"]),"line-translate":new Yt(ht.paint_line["line-translate"]),"line-translate-anchor":new Yt(ht.paint_line["line-translate-anchor"]),"line-width":new Xt(ht.paint_line["line-width"]),"line-gap-width":new Xt(ht.paint_line["line-gap-width"]),"line-offset":new Xt(ht.paint_line["line-offset"]),"line-blur":new Xt(ht.paint_line["line-blur"]),"line-dasharray":new Ji(ht.paint_line["line-dasharray"]),"line-pattern":new hn(ht.paint_line["line-pattern"]),"line-gradient":new Xo(ht.paint_line["line-gradient"])}),layout:SN};const n5=new class extends Xt{possiblyEvaluate(f,u){return u=new Sr(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(f,u)}evaluate(f,u,g,T){return u=W({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(f,u,g,T)}}(t5.paint.properties["line-width"].specification);function r5(f,u){return u>0?u+2*f:f}n5.useIntegerZoom=!0;const CN=jr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),MN=jr([{name:"a_projected_pos",components:3,type:"Float32"}],4);jr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const PN=jr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);jr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const i5=jr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),kN=jr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function IN(f,u,g){return f.sections.forEach(T=>{T.text=function(D,z,F){const $=z.layout.get("text-transform").evaluate(F,{});return $==="uppercase"?D=D.toLocaleUpperCase():$==="lowercase"&&(D=D.toLocaleLowerCase()),fs.applyArabicShaping&&(D=fs.applyArabicShaping(D)),D}(T.text,u,g)}),f}jr([{name:"triangle",components:3,type:"Uint16"}]),jr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),jr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),jr([{type:"Float32",name:"offsetX"}]),jr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const ap={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var es=24,nx=kr,s5=function(f,u,g,T,D){var z,F,$=8*D-T-1,Z=(1<<$)-1,re=Z>>1,Ae=-7,ce=g?D-1:0,pe=g?-1:1,ye=f[u+ce];for(ce+=pe,z=ye&(1<<-Ae)-1,ye>>=-Ae,Ae+=$;Ae>0;z=256*z+f[u+ce],ce+=pe,Ae-=8);for(F=z&(1<<-Ae)-1,z>>=-Ae,Ae+=T;Ae>0;F=256*F+f[u+ce],ce+=pe,Ae-=8);if(z===0)z=1-re;else{if(z===Z)return F?NaN:1/0*(ye?-1:1);F+=Math.pow(2,T),z-=re}return(ye?-1:1)*F*Math.pow(2,z-T)},o5=function(f,u,g,T,D,z){var F,$,Z,re=8*z-D-1,Ae=(1<<re)-1,ce=Ae>>1,pe=D===23?Math.pow(2,-24)-Math.pow(2,-77):0,ye=T?0:z-1,_e=T?1:-1,Ve=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?($=isNaN(u)?1:0,F=Ae):(F=Math.floor(Math.log(u)/Math.LN2),u*(Z=Math.pow(2,-F))<1&&(F--,Z*=2),(u+=F+ce>=1?pe/Z:pe*Math.pow(2,1-ce))*Z>=2&&(F++,Z/=2),F+ce>=Ae?($=0,F=Ae):F+ce>=1?($=(u*Z-1)*Math.pow(2,D),F+=ce):($=u*Math.pow(2,ce-1)*Math.pow(2,D),F=0));D>=8;f[g+ye]=255&$,ye+=_e,$/=256,D-=8);for(F=F<<D|$,re+=D;re>0;f[g+ye]=255&F,ye+=_e,F/=256,re-=8);f[g+ye-_e]|=128*Ve};function kr(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}kr.Varint=0,kr.Fixed64=1,kr.Bytes=2,kr.Fixed32=5;var Lc,rx=4294967296,a5=1/rx,l5=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Cu(f){return f.type===kr.Bytes?f.readVarint()+f.pos:f.pos+1}function Yf(f,u,g){return g?4294967296*u+(f>>>0):4294967296*(u>>>0)+(f>>>0)}function A5(f,u,g){var T=u<=16383?1:u<=2097151?2:u<=268435455?3:Math.floor(Math.log(u)/(7*Math.LN2));g.realloc(T);for(var D=g.pos-1;D>=f;D--)g.buf[D+T]=g.buf[D]}function LN(f,u){for(var g=0;g<f.length;g++)u.writeVarint(f[g])}function DN(f,u){for(var g=0;g<f.length;g++)u.writeSVarint(f[g])}function RN(f,u){for(var g=0;g<f.length;g++)u.writeFloat(f[g])}function BN(f,u){for(var g=0;g<f.length;g++)u.writeDouble(f[g])}function zN(f,u){for(var g=0;g<f.length;g++)u.writeBoolean(f[g])}function ON(f,u){for(var g=0;g<f.length;g++)u.writeFixed32(f[g])}function FN(f,u){for(var g=0;g<f.length;g++)u.writeSFixed32(f[g])}function NN(f,u){for(var g=0;g<f.length;g++)u.writeFixed64(f[g])}function UN(f,u){for(var g=0;g<f.length;g++)u.writeSFixed64(f[g])}function Km(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+16777216*f[u+3]}function Xf(f,u,g){f[g]=u,f[g+1]=u>>>8,f[g+2]=u>>>16,f[g+3]=u>>>24}function u5(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+(f[u+3]<<24)}function VN(f,u,g){f===1&&g.readMessage(GN,u)}function GN(f,u,g){if(f===3){const{id:T,bitmap:D,width:z,height:F,left:$,top:Z,advance:re}=g.readMessage($N,{});u.push({id:T,bitmap:new ep({width:z+6,height:F+6},D),metrics:{width:z,height:F,left:$,top:Z,advance:re}})}}function $N(f,u,g){f===1?u.id=g.readVarint():f===2?u.bitmap=g.readBytes():f===3?u.width=g.readVarint():f===4?u.height=g.readVarint():f===5?u.left=g.readSVarint():f===6?u.top=g.readSVarint():f===7&&(u.advance=g.readVarint())}function c5(f){let u=0,g=0;for(const F of f)u+=F.w*F.h,g=Math.max(g,F.w);f.sort((F,$)=>$.h-F.h);const T=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),g),h:1/0}];let D=0,z=0;for(const F of f)for(let $=T.length-1;$>=0;$--){const Z=T[$];if(!(F.w>Z.w||F.h>Z.h)){if(F.x=Z.x,F.y=Z.y,z=Math.max(z,F.y+F.h),D=Math.max(D,F.x+F.w),F.w===Z.w&&F.h===Z.h){const re=T.pop();$<T.length&&(T[$]=re)}else F.h===Z.h?(Z.x+=F.w,Z.w-=F.w):F.w===Z.w?(Z.y+=F.h,Z.h-=F.h):(T.push({x:Z.x+F.w,y:Z.y,w:Z.w-F.w,h:F.h}),Z.y+=F.h,Z.h-=F.h);break}}return{w:D,h:z,fill:u/(D*z)||0}}kr.prototype={destroy:function(){this.buf=null},readFields:function(f,u,g){for(g=g||this.length;this.pos<g;){var T=this.readVarint(),D=T>>3,z=this.pos;this.type=7&T,f(D,u,this),this.pos===z&&this.skip(T)}return u},readMessage:function(f,u){return this.readFields(f,u,this.readVarint()+this.pos)},readFixed32:function(){var f=Km(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=u5(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=Km(this.buf,this.pos)+Km(this.buf,this.pos+4)*rx;return this.pos+=8,f},readSFixed64:function(){var f=Km(this.buf,this.pos)+u5(this.buf,this.pos+4)*rx;return this.pos+=8,f},readFloat:function(){var f=s5(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=s5(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var u,g,T=this.buf;return u=127&(g=T[this.pos++]),g<128?u:(u|=(127&(g=T[this.pos++]))<<7,g<128?u:(u|=(127&(g=T[this.pos++]))<<14,g<128?u:(u|=(127&(g=T[this.pos++]))<<21,g<128?u:function(D,z,F){var $,Z,re=F.buf;if($=(112&(Z=re[F.pos++]))>>4,Z<128||($|=(127&(Z=re[F.pos++]))<<3,Z<128)||($|=(127&(Z=re[F.pos++]))<<10,Z<128)||($|=(127&(Z=re[F.pos++]))<<17,Z<128)||($|=(127&(Z=re[F.pos++]))<<24,Z<128)||($|=(1&(Z=re[F.pos++]))<<31,Z<128))return Yf(D,$,z);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(g=T[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var f=this.readVarint()+this.pos,u=this.pos;return this.pos=f,f-u>=12&&l5?function(g,T,D){return l5.decode(g.subarray(T,D))}(this.buf,u,f):function(g,T,D){for(var z="",F=T;F<D;){var $,Z,re,Ae=g[F],ce=null,pe=Ae>239?4:Ae>223?3:Ae>191?2:1;if(F+pe>D)break;pe===1?Ae<128&&(ce=Ae):pe===2?(192&($=g[F+1]))==128&&(ce=(31&Ae)<<6|63&$)<=127&&(ce=null):pe===3?(Z=g[F+2],(192&($=g[F+1]))==128&&(192&Z)==128&&((ce=(15&Ae)<<12|(63&$)<<6|63&Z)<=2047||ce>=55296&&ce<=57343)&&(ce=null)):pe===4&&(Z=g[F+2],re=g[F+3],(192&($=g[F+1]))==128&&(192&Z)==128&&(192&re)==128&&((ce=(15&Ae)<<18|(63&$)<<12|(63&Z)<<6|63&re)<=65535||ce>=1114112)&&(ce=null)),ce===null?(ce=65533,pe=1):ce>65535&&(ce-=65536,z+=String.fromCharCode(ce>>>10&1023|55296),ce=56320|1023&ce),z+=String.fromCharCode(ce),F+=pe}return z}(this.buf,u,f)},readBytes:function(){var f=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,f);return this.pos=f,u},readPackedVarint:function(f,u){if(this.type!==kr.Bytes)return f.push(this.readVarint(u));var g=Cu(this);for(f=f||[];this.pos<g;)f.push(this.readVarint(u));return f},readPackedSVarint:function(f){if(this.type!==kr.Bytes)return f.push(this.readSVarint());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==kr.Bytes)return f.push(this.readBoolean());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==kr.Bytes)return f.push(this.readFloat());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==kr.Bytes)return f.push(this.readDouble());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==kr.Bytes)return f.push(this.readFixed32());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==kr.Bytes)return f.push(this.readSFixed32());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==kr.Bytes)return f.push(this.readFixed64());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==kr.Bytes)return f.push(this.readSFixed64());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed64());return f},skip:function(f){var u=7&f;if(u===kr.Varint)for(;this.buf[this.pos++]>127;);else if(u===kr.Bytes)this.pos=this.readVarint()+this.pos;else if(u===kr.Fixed32)this.pos+=4;else{if(u!==kr.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(f,u){this.writeVarint(f<<3|u)},realloc:function(f){for(var u=this.length||16;u<this.pos+f;)u*=2;if(u!==this.length){var g=new Uint8Array(u);g.set(this.buf),this.buf=g,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),Xf(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),Xf(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),Xf(this.buf,-1&f,this.pos),Xf(this.buf,Math.floor(f*a5),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),Xf(this.buf,-1&f,this.pos),Xf(this.buf,Math.floor(f*a5),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(u,g){var T,D;if(u>=0?(T=u%4294967296|0,D=u/4294967296|0):(D=~(-u/4294967296),4294967295^(T=~(-u%4294967296))?T=T+1|0:(T=0,D=D+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");g.realloc(10),function(z,F,$){$.buf[$.pos++]=127&z|128,z>>>=7,$.buf[$.pos++]=127&z|128,z>>>=7,$.buf[$.pos++]=127&z|128,z>>>=7,$.buf[$.pos++]=127&z|128,$.buf[$.pos]=127&(z>>>=7)}(T,0,g),function(z,F){var $=(7&z)<<4;F.buf[F.pos++]|=$|((z>>>=3)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z)))))}(D,g)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(!!f)},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var u=this.pos;this.pos=function(T,D,z){for(var F,$,Z=0;Z<D.length;Z++){if((F=D.charCodeAt(Z))>55295&&F<57344){if(!$){F>56319||Z+1===D.length?(T[z++]=239,T[z++]=191,T[z++]=189):$=F;continue}if(F<56320){T[z++]=239,T[z++]=191,T[z++]=189,$=F;continue}F=$-55296<<10|F-56320|65536,$=null}else $&&(T[z++]=239,T[z++]=191,T[z++]=189,$=null);F<128?T[z++]=F:(F<2048?T[z++]=F>>6|192:(F<65536?T[z++]=F>>12|224:(T[z++]=F>>18|240,T[z++]=F>>12&63|128),T[z++]=F>>6&63|128),T[z++]=63&F|128)}return z}(this.buf,f,this.pos);var g=this.pos-u;g>=128&&A5(u,g,this),this.pos=u-1,this.writeVarint(g),this.pos+=g},writeFloat:function(f){this.realloc(4),o5(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),o5(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var u=f.length;this.writeVarint(u),this.realloc(u);for(var g=0;g<u;g++)this.buf[this.pos++]=f[g]},writeRawMessage:function(f,u){this.pos++;var g=this.pos;f(u,this);var T=this.pos-g;T>=128&&A5(g,T,this),this.pos=g-1,this.writeVarint(T),this.pos+=T},writeMessage:function(f,u,g){this.writeTag(f,kr.Bytes),this.writeRawMessage(u,g)},writePackedVarint:function(f,u){u.length&&this.writeMessage(f,LN,u)},writePackedSVarint:function(f,u){u.length&&this.writeMessage(f,DN,u)},writePackedBoolean:function(f,u){u.length&&this.writeMessage(f,zN,u)},writePackedFloat:function(f,u){u.length&&this.writeMessage(f,RN,u)},writePackedDouble:function(f,u){u.length&&this.writeMessage(f,BN,u)},writePackedFixed32:function(f,u){u.length&&this.writeMessage(f,ON,u)},writePackedSFixed32:function(f,u){u.length&&this.writeMessage(f,FN,u)},writePackedFixed64:function(f,u){u.length&&this.writeMessage(f,NN,u)},writePackedSFixed64:function(f,u){u.length&&this.writeMessage(f,UN,u)},writeBytesField:function(f,u){this.writeTag(f,kr.Bytes),this.writeBytes(u)},writeFixed32Field:function(f,u){this.writeTag(f,kr.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(f,u){this.writeTag(f,kr.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(f,u){this.writeTag(f,kr.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(f,u){this.writeTag(f,kr.Fixed64),this.writeSFixed64(u)},writeVarintField:function(f,u){this.writeTag(f,kr.Varint),this.writeVarint(u)},writeSVarintField:function(f,u){this.writeTag(f,kr.Varint),this.writeSVarint(u)},writeStringField:function(f,u){this.writeTag(f,kr.Bytes),this.writeString(u)},writeFloatField:function(f,u){this.writeTag(f,kr.Fixed32),this.writeFloat(u)},writeDoubleField:function(f,u){this.writeTag(f,kr.Fixed64),this.writeDouble(u)},writeBooleanField:function(f,u){this.writeVarintField(f,!!u)}};class ix{constructor(u,{pixelRatio:g,version:T,stretchX:D,stretchY:z,content:F}){this.paddedRect=u,this.pixelRatio=g,this.stretchX=D,this.stretchY=z,this.content=F,this.version=T}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class h5{constructor(u,g){const T={},D={};this.haveRenderCallbacks=[];const z=[];this.addImages(u,T,z),this.addImages(g,D,z);const{w:F,h:$}=c5(z),Z=new Ea({width:F||1,height:$||1});for(const re in u){const Ae=u[re],ce=T[re].paddedRect;Ea.copy(Ae.data,Z,{x:0,y:0},{x:ce.x+1,y:ce.y+1},Ae.data)}for(const re in g){const Ae=g[re],ce=D[re].paddedRect,pe=ce.x+1,ye=ce.y+1,_e=Ae.data.width,Ve=Ae.data.height;Ea.copy(Ae.data,Z,{x:0,y:0},{x:pe,y:ye},Ae.data),Ea.copy(Ae.data,Z,{x:0,y:Ve-1},{x:pe,y:ye-1},{width:_e,height:1}),Ea.copy(Ae.data,Z,{x:0,y:0},{x:pe,y:ye+Ve},{width:_e,height:1}),Ea.copy(Ae.data,Z,{x:_e-1,y:0},{x:pe-1,y:ye},{width:1,height:Ve}),Ea.copy(Ae.data,Z,{x:0,y:0},{x:pe+_e,y:ye},{width:1,height:Ve})}this.image=Z,this.iconPositions=T,this.patternPositions=D}addImages(u,g,T){for(const D in u){const z=u[D],F={x:0,y:0,w:z.data.width+2,h:z.data.height+2};T.push(F),g[D]=new ix(F,z),z.hasRenderCallback&&this.haveRenderCallbacks.push(D)}}patchUpdatedImages(u,g){u.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const T in u.updatedImages)this.patchUpdatedImage(this.iconPositions[T],u.getImage(T),g),this.patchUpdatedImage(this.patternPositions[T],u.getImage(T),g)}patchUpdatedImage(u,g,T){if(!u||!g||u.version===g.version)return;u.version=g.version;const[D,z]=u.tl;T.update(g.data,void 0,{x:D,y:z})}}Nt("ImagePosition",ix),Nt("ImageAtlas",h5),o.WritingMode=void 0,(Lc=o.WritingMode||(o.WritingMode={}))[Lc.none=0]="none",Lc[Lc.horizontal=1]="horizontal",Lc[Lc.vertical=2]="vertical",Lc[Lc.horizontalOnly=3]="horizontalOnly";const Jm=-17;class lp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(u,g){const T=new lp;return T.scale=u||1,T.fontStack=g,T}static forImage(u){const g=new lp;return g.imageName=u,g}}class Kf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(u,g){const T=new Kf;for(let D=0;D<u.sections.length;D++){const z=u.sections[D];z.image?T.addImageSection(z):T.addTextSection(z,g)}return T}length(){return this.text.length}getSection(u){return this.sections[this.sectionIndex[u]]}getSectionIndex(u){return this.sectionIndex[u]}getCharCode(u){return this.text.charCodeAt(u)}verticalizePunctuation(){this.text=function(u){let g="";for(let T=0;T<u.length;T++){const D=u.charCodeAt(T+1)||null,z=u.charCodeAt(T-1)||null;g+=D&&Hs(D)&&!ap[u[T+1]]||z&&Hs(z)&&!ap[u[T-1]]||!ap[u[T]]?u[T]:ap[u[T]]}return g}(this.text)}trim(){let u=0;for(let T=0;T<this.text.length&&t1[this.text.charCodeAt(T)];T++)u++;let g=this.text.length;for(let T=this.text.length-1;T>=0&&T>=u&&t1[this.text.charCodeAt(T)];T--)g--;this.text=this.text.substring(u,g),this.sectionIndex=this.sectionIndex.slice(u,g)}substring(u,g){const T=new Kf;return T.text=this.text.substring(u,g),T.sectionIndex=this.sectionIndex.slice(u,g),T.sections=this.sections,T}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((u,g)=>Math.max(u,this.sections[g].scale),0)}addTextSection(u,g){this.text+=u.text,this.sections.push(lp.forText(u.scale,u.fontStack||g));const T=this.sections.length-1;for(let D=0;D<u.text.length;++D)this.sectionIndex.push(T)}addImageSection(u){const g=u.image?u.image.name:"";if(g.length===0)return void me("Can't add FormattedSection with an empty image.");const T=this.getNextImageSectionCharCode();T?(this.text+=String.fromCharCode(T),this.sections.push(lp.forImage(g)),this.sectionIndex.push(this.sections.length-1)):me("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function e1(f,u,g,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ve){const ze=Kf.fromFeature(f,D);let tt;ce===o.WritingMode.vertical&&ze.verticalizePunctuation();const{processBidirectionalText:ut,processStyledBidirectionalText:et}=fs;if(ut&&ze.sections.length===1){tt=[];const gt=ut(ze.toString(),sx(ze,re,z,u,T,ye,_e));for(const Zt of gt){const tn=new Kf;tn.text=Zt,tn.sections=ze.sections;for(let Ht=0;Ht<Zt.length;Ht++)tn.sectionIndex.push(0);tt.push(tn)}}else if(et){tt=[];const gt=et(ze.text,ze.sectionIndex,sx(ze,re,z,u,T,ye,_e));for(const Zt of gt){const tn=new Kf;tn.text=Zt[0],tn.sectionIndex=Zt[1],tn.sections=ze.sections,tt.push(tn)}}else tt=function(gt,Zt){const tn=[],Ht=gt.text;let Ut=0;for(const Ot of Zt)tn.push(gt.substring(Ut,Ot)),Ut=Ot;return Ut<Ht.length&&tn.push(gt.substring(Ut,Ht.length)),tn}(ze,sx(ze,re,z,u,T,ye,_e));const at=[],mt={positionedLines:at,text:ze.toString(),top:Ae[1],bottom:Ae[1],left:Ae[0],right:Ae[0],writingMode:ce,iconsInText:!1,verticalizable:!1};return function(gt,Zt,tn,Ht,Ut,Ot,Wt,$t,St,gn,ln,Hn){let Ur=0,Hr=Jm,zi=0,Sa=0;const ds=$t==="right"?1:$t==="left"?0:.5;let Ei=0;for(const Ti of Ut){Ti.trim();const gs=Ti.getMaxScale(),Ps=(gs-1)*es,Ks={positionedGlyphs:[],lineOffset:0};gt.positionedLines[Ei]=Ks;const So=Ks.positionedGlyphs;let Co=0;if(!Ti.length()){Hr+=Ot,++Ei;continue}for(let qi=0;qi<Ti.length();qi++){const Jn=Ti.getSection(qi),Ko=Ti.getSectionIndex(qi),ms=Ti.getCharCode(qi);let ks=0,sl=null,ql=null,Zl=null,Pu=es;const ol=!(St===o.WritingMode.horizontal||!ln&&!tl(ms)||ln&&(t1[ms]||(Qi=ms,Vt.Arabic(Qi)||Vt["Arabic Supplement"](Qi)||Vt["Arabic Extended-A"](Qi)||Vt["Arabic Presentation Forms-A"](Qi)||Vt["Arabic Presentation Forms-B"](Qi))));if(Jn.imageName){const Ca=Ht[Jn.imageName];if(!Ca)continue;Zl=Jn.imageName,gt.iconsInText=gt.iconsInText||!0,ql=Ca.paddedRect;const Mo=Ca.displaySize;Jn.scale=Jn.scale*es/Hn,sl={width:Mo[0],height:Mo[1],left:1,top:-3,advance:ol?Mo[1]:Mo[0]},ks=Ps+(es-Mo[1]*Jn.scale),Pu=sl.advance;const ku=ol?Mo[0]*Jn.scale-es*gs:Mo[1]*Jn.scale-es*gs;ku>0&&ku>Co&&(Co=ku)}else{const Ca=tn[Jn.fontStack],Mo=Ca&&Ca[ms];if(Mo&&Mo.rect)ql=Mo.rect,sl=Mo.metrics;else{const ku=Zt[Jn.fontStack],cp=ku&&ku[ms];if(!cp)continue;sl=cp.metrics}ks=(gs-Jn.scale)*es}ol?(gt.verticalizable=!0,So.push({glyph:ms,imageName:Zl,x:Ur,y:Hr+ks,vertical:ol,scale:Jn.scale,fontStack:Jn.fontStack,sectionIndex:Ko,metrics:sl,rect:ql}),Ur+=Pu*Jn.scale+gn):(So.push({glyph:ms,imageName:Zl,x:Ur,y:Hr+ks,vertical:ol,scale:Jn.scale,fontStack:Jn.fontStack,sectionIndex:Ko,metrics:sl,rect:ql}),Ur+=sl.advance*Jn.scale+gn)}So.length!==0&&(zi=Math.max(Ur-gn,zi),WN(So,0,So.length-1,ds,Co)),Ur=0;const Xr=Ot*gs+Co;Ks.lineOffset=Math.max(Co,Ps),Hr+=Xr,Sa=Math.max(Xr,Sa),++Ei}var Qi;const ps=Hr-Jm,{horizontalAlign:Ms,verticalAlign:To}=ox(Wt);(function(Ti,gs,Ps,Ks,So,Co,Xr,qi,Jn){const Ko=(gs-Ps)*So;let ms=0;ms=Co!==Xr?-qi*Ks-Jm:(-Ks*Jn+.5)*Xr;for(const ks of Ti)for(const sl of ks.positionedGlyphs)sl.x+=Ko,sl.y+=ms})(gt.positionedLines,ds,Ms,To,zi,Sa,Ot,ps,Ut.length),gt.top+=-To*ps,gt.bottom=gt.top+ps,gt.left+=-Ms*zi,gt.right=gt.left+zi}(mt,u,g,T,tt,F,$,Z,ce,re,pe,Ve),!function(gt){for(const Zt of gt)if(Zt.positionedGlyphs.length!==0)return!1;return!0}(at)&&mt}const t1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},jN={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function f5(f,u,g,T,D,z){if(u.imageName){const F=T[u.imageName];return F?F.displaySize[0]*u.scale*es/z+D:0}{const F=g[u.fontStack],$=F&&F[f];return $?$.metrics.advance*u.scale+D:0}}function d5(f,u,g,T){const D=Math.pow(f-u,2);return T?f<u?D/2:2*D:D+Math.abs(g)*g}function HN(f,u,g){let T=0;return f===10&&(T-=1e4),g&&(T+=150),f!==40&&f!==65288||(T+=50),u!==41&&u!==65289||(T+=50),T}function p5(f,u,g,T,D,z){let F=null,$=d5(u,g,D,z);for(const Z of T){const re=d5(u-Z.x,g,D,z)+Z.badness;re<=$&&(F=Z,$=re)}return{index:f,x:u,priorBreak:F,badness:$}}function g5(f){return f?g5(f.priorBreak).concat(f.index):[]}function sx(f,u,g,T,D,z,F){if(z!=="point")return[];if(!f)return[];const $=[],Z=function(pe,ye,_e,Ve,ze,tt){let ut=0;for(let et=0;et<pe.length();et++){const at=pe.getSection(et);ut+=f5(pe.getCharCode(et),at,Ve,ze,ye,tt)}return ut/Math.max(1,Math.ceil(ut/_e))}(f,u,g,T,D,F),re=f.text.indexOf("")>=0;let Ae=0;for(let pe=0;pe<f.length();pe++){const ye=f.getSection(pe),_e=f.getCharCode(pe);if(t1[_e]||(Ae+=f5(_e,ye,T,D,u,F)),pe<f.length()-1){const Ve=!((ce=_e)<11904||!(Vt["Bopomofo Extended"](ce)||Vt.Bopomofo(ce)||Vt["CJK Compatibility Forms"](ce)||Vt["CJK Compatibility Ideographs"](ce)||Vt["CJK Compatibility"](ce)||Vt["CJK Radicals Supplement"](ce)||Vt["CJK Strokes"](ce)||Vt["CJK Symbols and Punctuation"](ce)||Vt["CJK Unified Ideographs Extension A"](ce)||Vt["CJK Unified Ideographs"](ce)||Vt["Enclosed CJK Letters and Months"](ce)||Vt["Halfwidth and Fullwidth Forms"](ce)||Vt.Hiragana(ce)||Vt["Ideographic Description Characters"](ce)||Vt["Kangxi Radicals"](ce)||Vt["Katakana Phonetic Extensions"](ce)||Vt.Katakana(ce)||Vt["Vertical Forms"](ce)||Vt["Yi Radicals"](ce)||Vt["Yi Syllables"](ce)));(jN[_e]||Ve||ye.imageName)&&$.push(p5(pe+1,Ae,Z,$,HN(_e,f.getCharCode(pe+1),Ve&&re),!1))}}var ce;return g5(p5(f.length(),Ae,Z,$,0,!0))}function ox(f){let u=.5,g=.5;switch(f){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":g=1;break;case"top":case"top-right":case"top-left":g=0}return{horizontalAlign:u,verticalAlign:g}}function WN(f,u,g,T,D){if(!T&&!D)return;const z=f[g],F=(f[g].x+z.metrics.advance*z.scale)*T;for(let $=u;$<=g;$++)f[$].x-=F,f[$].y+=D}function QN(f,u,g){const{horizontalAlign:T,verticalAlign:D}=ox(g),z=u[0]-f.displaySize[0]*T,F=u[1]-f.displaySize[1]*D;return{image:f,top:F,bottom:F+f.displaySize[1],left:z,right:z+f.displaySize[0]}}function m5(f,u,g,T,D,z){const F=f.image;let $;if(F.content){const ze=F.content,tt=F.pixelRatio||1;$=[ze[0]/tt,ze[1]/tt,F.displaySize[0]-ze[2]/tt,F.displaySize[1]-ze[3]/tt]}const Z=u.left*z,re=u.right*z;let Ae,ce,pe,ye;g==="width"||g==="both"?(ye=D[0]+Z-T[3],ce=D[0]+re+T[1]):(ye=D[0]+(Z+re-F.displaySize[0])/2,ce=ye+F.displaySize[0]);const _e=u.top*z,Ve=u.bottom*z;return g==="height"||g==="both"?(Ae=D[1]+_e-T[0],pe=D[1]+Ve+T[2]):(Ae=D[1]+(_e+Ve-F.displaySize[1])/2,pe=Ae+F.displaySize[1]),{image:F,top:Ae,right:ce,bottom:pe,left:ye,collisionPadding:$}}const Mu=128;function y5(f,u){const{expression:g}=u;if(g.kind==="constant")return{kind:"constant",layoutSize:g.evaluate(new Sr(f+1))};if(g.kind==="source")return{kind:"source"};{const{zoomStops:T,interpolationType:D}=g;let z=0;for(;z<T.length&&T[z]<=f;)z++;z=Math.max(0,z-1);let F=z;for(;F<T.length&&T[F]<f+1;)F++;F=Math.min(T.length-1,F);const $=T[z],Z=T[F];return g.kind==="composite"?{kind:"composite",minZoom:$,maxZoom:Z,interpolationType:D}:{kind:"camera",minZoom:$,maxZoom:Z,minSize:g.evaluate(new Sr($)),maxSize:g.evaluate(new Sr(Z)),interpolationType:D}}}class Dc extends Tt{constructor(u,g,T,D){super(u,g),this.angle=T,D!==void 0&&(this.segment=D)}clone(){return new Dc(this.x,this.y,this.angle,this.segment)}}function _5(f,u,g,T,D){if(u.segment===void 0)return!0;let z=u,F=u.segment+1,$=0;for(;$>-g/2;){if(F--,F<0)return!1;$-=f[F].dist(z),z=f[F]}$+=f[F].dist(f[F+1]),F++;const Z=[];let re=0;for(;$<g/2;){const Ae=f[F],ce=f[F+1];if(!ce)return!1;let pe=f[F-1].angleTo(Ae)-Ae.angleTo(ce);for(pe=Math.abs((pe+3*Math.PI)%(2*Math.PI)-Math.PI),Z.push({distance:$,angleDelta:pe}),re+=pe;$-Z[0].distance>T;)re-=Z.shift().angleDelta;if(re>D)return!1;F++,$+=Ae.dist(ce)}return!0}function v5(f){let u=0;for(let g=0;g<f.length-1;g++)u+=f[g].dist(f[g+1]);return u}function x5(f,u,g){return f?.6*u*g:0}function w5(f,u){return Math.max(f?f.right-f.left:0,u?u.right-u.left:0)}function qN(f,u,g,T,D,z){const F=x5(g,D,z),$=w5(g,T)*z;let Z=0;const re=v5(f)/2;for(let Ae=0;Ae<f.length-1;Ae++){const ce=f[Ae],pe=f[Ae+1],ye=ce.dist(pe);if(Z+ye>re){const _e=(re-Z)/ye,Ve=en(ce.x,pe.x,_e),ze=en(ce.y,pe.y,_e),tt=new Dc(Ve,ze,pe.angleTo(ce),Ae);return tt._round(),!F||_5(f,tt,$,F,u)?tt:void 0}Z+=ye}}function ZN(f,u,g,T,D,z,F,$,Z){const re=x5(T,z,F),Ae=w5(T,D),ce=Ae*F,pe=f[0].x===0||f[0].x===Z||f[0].y===0||f[0].y===Z;return u-ce<u/4&&(u=ce+u/4),b5(f,pe?u/2*$%u:(Ae/2+2*z)*F*$%u,u,re,g,ce,pe,!1,Z)}function b5(f,u,g,T,D,z,F,$,Z){const re=z/2,Ae=v5(f);let ce=0,pe=u-g,ye=[];for(let _e=0;_e<f.length-1;_e++){const Ve=f[_e],ze=f[_e+1],tt=Ve.dist(ze),ut=ze.angleTo(Ve);for(;pe+g<ce+tt;){pe+=g;const et=(pe-ce)/tt,at=en(Ve.x,ze.x,et),mt=en(Ve.y,ze.y,et);if(at>=0&&at<Z&&mt>=0&&mt<Z&&pe-re>=0&&pe+re<=Ae){const gt=new Dc(at,mt,ut,_e);gt._round(),T&&!_5(f,gt,z,T,D)||ye.push(gt)}}ce+=tt}return $||ye.length||F||(ye=b5(f,ce/2,g,T,D,z,F,!0,Z)),ye}function E5(f,u,g,T,D){const z=[];for(let F=0;F<f.length;F++){const $=f[F];let Z;for(let re=0;re<$.length-1;re++){let Ae=$[re],ce=$[re+1];Ae.x<u&&ce.x<u||(Ae.x<u?Ae=new Tt(u,Ae.y+(u-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round():ce.x<u&&(ce=new Tt(u,Ae.y+(u-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round()),Ae.y<g&&ce.y<g||(Ae.y<g?Ae=new Tt(Ae.x+(g-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),g)._round():ce.y<g&&(ce=new Tt(Ae.x+(g-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),g)._round()),Ae.x>=T&&ce.x>=T||(Ae.x>=T?Ae=new Tt(T,Ae.y+(T-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round():ce.x>=T&&(ce=new Tt(T,Ae.y+(T-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round()),Ae.y>=D&&ce.y>=D||(Ae.y>=D?Ae=new Tt(Ae.x+(D-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),D)._round():ce.y>=D&&(ce=new Tt(Ae.x+(D-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),D)._round()),Z&&Ae.equals(Z[Z.length-1])||(Z=[Ae],z.push(Z)),Z.push(ce)))))}}return z}function T5(f,u,g,T){const D=[],z=f.image,F=z.pixelRatio,$=z.paddedRect.w-2,Z=z.paddedRect.h-2,re=f.right-f.left,Ae=f.bottom-f.top,ce=z.stretchX||[[0,$]],pe=z.stretchY||[[0,Z]],ye=(Ot,Wt)=>Ot+Wt[1]-Wt[0],_e=ce.reduce(ye,0),Ve=pe.reduce(ye,0),ze=$-_e,tt=Z-Ve;let ut=0,et=_e,at=0,mt=Ve,gt=0,Zt=ze,tn=0,Ht=tt;if(z.content&&T){const Ot=z.content;ut=n1(ce,0,Ot[0]),at=n1(pe,0,Ot[1]),et=n1(ce,Ot[0],Ot[2]),mt=n1(pe,Ot[1],Ot[3]),gt=Ot[0]-ut,tn=Ot[1]-at,Zt=Ot[2]-Ot[0]-et,Ht=Ot[3]-Ot[1]-mt}const Ut=(Ot,Wt,$t,St)=>{const gn=r1(Ot.stretch-ut,et,re,f.left),ln=i1(Ot.fixed-gt,Zt,Ot.stretch,_e),Hn=r1(Wt.stretch-at,mt,Ae,f.top),Ur=i1(Wt.fixed-tn,Ht,Wt.stretch,Ve),Hr=r1($t.stretch-ut,et,re,f.left),zi=i1($t.fixed-gt,Zt,$t.stretch,_e),Sa=r1(St.stretch-at,mt,Ae,f.top),ds=i1(St.fixed-tn,Ht,St.stretch,Ve),Ei=new Tt(gn,Hn),Qi=new Tt(Hr,Hn),ps=new Tt(Hr,Sa),Ms=new Tt(gn,Sa),To=new Tt(ln/F,Ur/F),Ti=new Tt(zi/F,ds/F),gs=u*Math.PI/180;if(gs){const So=Math.sin(gs),Co=Math.cos(gs),Xr=[Co,-So,So,Co];Ei._matMult(Xr),Qi._matMult(Xr),Ms._matMult(Xr),ps._matMult(Xr)}const Ps=Ot.stretch+Ot.fixed,Ks=Wt.stretch+Wt.fixed;return{tl:Ei,tr:Qi,bl:Ms,br:ps,tex:{x:z.paddedRect.x+1+Ps,y:z.paddedRect.y+1+Ks,w:$t.stretch+$t.fixed-Ps,h:St.stretch+St.fixed-Ks},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:To,pixelOffsetBR:Ti,minFontScaleX:Zt/F/re,minFontScaleY:Ht/F/Ae,isSDF:g}};if(T&&(z.stretchX||z.stretchY)){const Ot=S5(ce,ze,_e),Wt=S5(pe,tt,Ve);for(let $t=0;$t<Ot.length-1;$t++){const St=Ot[$t],gn=Ot[$t+1];for(let ln=0;ln<Wt.length-1;ln++)D.push(Ut(St,Wt[ln],gn,Wt[ln+1]))}}else D.push(Ut({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:$+1},{fixed:0,stretch:Z+1}));return D}function n1(f,u,g){let T=0;for(const D of f)T+=Math.max(u,Math.min(g,D[1]))-Math.max(u,Math.min(g,D[0]));return T}function S5(f,u,g){const T=[{fixed:-1,stretch:0}];for(const[D,z]of f){const F=T[T.length-1];T.push({fixed:D-F.stretch,stretch:F.stretch}),T.push({fixed:D-F.stretch,stretch:F.stretch+(z-D)})}return T.push({fixed:u+1,stretch:g}),T}function r1(f,u,g,T){return f/u*g+T}function i1(f,u,g,T){return f-u*g/T}Nt("Anchor",Dc);class s1{constructor(u,g,T,D,z,F,$,Z,re,Ae){if(this.boxStartIndex=u.length,re){let ce=F.top,pe=F.bottom;const ye=F.collisionPadding;ye&&(ce-=ye[1],pe+=ye[3]);let _e=pe-ce;_e>0&&(_e=Math.max(10,_e),this.circleDiameter=_e)}else{let ce=F.top*$-Z[0],pe=F.bottom*$+Z[2],ye=F.left*$-Z[3],_e=F.right*$+Z[1];const Ve=F.collisionPadding;if(Ve&&(ye-=Ve[0]*$,ce-=Ve[1]*$,_e+=Ve[2]*$,pe+=Ve[3]*$),Ae){const ze=new Tt(ye,ce),tt=new Tt(_e,ce),ut=new Tt(ye,pe),et=new Tt(_e,pe),at=Ae*Math.PI/180;ze._rotate(at),tt._rotate(at),ut._rotate(at),et._rotate(at),ye=Math.min(ze.x,tt.x,ut.x,et.x),_e=Math.max(ze.x,tt.x,ut.x,et.x),ce=Math.min(ze.y,tt.y,ut.y,et.y),pe=Math.max(ze.y,tt.y,ut.y,et.y)}u.emplaceBack(g.x,g.y,ye,ce,_e,pe,T,D,z)}this.boxEndIndex=u.length}}class YN{constructor(u=[],g=XN){if(this.data=u,this.length=this.data.length,this.compare=g,this.length>0)for(let T=(this.length>>1)-1;T>=0;T--)this._down(T)}push(u){this.data.push(u),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const u=this.data[0],g=this.data.pop();return this.length--,this.length>0&&(this.data[0]=g,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:g,compare:T}=this,D=g[u];for(;u>0;){const z=u-1>>1,F=g[z];if(T(D,F)>=0)break;g[u]=F,u=z}g[u]=D}_down(u){const{data:g,compare:T}=this,D=this.length>>1,z=g[u];for(;u<D;){let F=1+(u<<1),$=g[F];const Z=F+1;if(Z<this.length&&T(g[Z],$)<0&&(F=Z,$=g[Z]),T($,z)>=0)break;g[u]=$,u=F}g[u]=z}}function XN(f,u){return f<u?-1:f>u?1:0}function KN(f,u=1,g=!1){let T=1/0,D=1/0,z=-1/0,F=-1/0;const $=f[0];for(let ye=0;ye<$.length;ye++){const _e=$[ye];(!ye||_e.x<T)&&(T=_e.x),(!ye||_e.y<D)&&(D=_e.y),(!ye||_e.x>z)&&(z=_e.x),(!ye||_e.y>F)&&(F=_e.y)}const Z=Math.min(z-T,F-D);let re=Z/2;const Ae=new YN([],JN);if(Z===0)return new Tt(T,D);for(let ye=T;ye<z;ye+=Z)for(let _e=D;_e<F;_e+=Z)Ae.push(new Jf(ye+re,_e+re,re,f));let ce=function(ye){let _e=0,Ve=0,ze=0;const tt=ye[0];for(let ut=0,et=tt.length,at=et-1;ut<et;at=ut++){const mt=tt[ut],gt=tt[at],Zt=mt.x*gt.y-gt.x*mt.y;Ve+=(mt.x+gt.x)*Zt,ze+=(mt.y+gt.y)*Zt,_e+=3*Zt}return new Jf(Ve/_e,ze/_e,0,ye)}(f),pe=Ae.length;for(;Ae.length;){const ye=Ae.pop();(ye.d>ce.d||!ce.d)&&(ce=ye,g&&console.log("found best %d after %d probes",Math.round(1e4*ye.d)/1e4,pe)),ye.max-ce.d<=u||(re=ye.h/2,Ae.push(new Jf(ye.p.x-re,ye.p.y-re,re,f)),Ae.push(new Jf(ye.p.x+re,ye.p.y-re,re,f)),Ae.push(new Jf(ye.p.x-re,ye.p.y+re,re,f)),Ae.push(new Jf(ye.p.x+re,ye.p.y+re,re,f)),pe+=4)}return g&&(console.log(`num probes: ${pe}`),console.log(`best distance: ${ce.d}`)),ce.p}function JN(f,u){return u.max-f.max}function Jf(f,u,g,T){this.p=new Tt(f,u),this.h=g,this.d=function(D,z){let F=!1,$=1/0;for(let Z=0;Z<z.length;Z++){const re=z[Z];for(let Ae=0,ce=re.length,pe=ce-1;Ae<ce;pe=Ae++){const ye=re[Ae],_e=re[pe];ye.y>D.y!=_e.y>D.y&&D.x<(_e.x-ye.x)*(D.y-ye.y)/(_e.y-ye.y)+ye.x&&(F=!F),$=Math.min($,R4(D,ye,_e))}}return(F?1:-1)*Math.sqrt($)}(this.p,T),this.max=this.d+this.h*Math.SQRT2}const ax=Number.POSITIVE_INFINITY;function C5(f,u){return u[1]!==ax?function(g,T,D){let z=0,F=0;switch(T=Math.abs(T),D=Math.abs(D),g){case"top-right":case"top-left":case"top":F=D-7;break;case"bottom-right":case"bottom-left":case"bottom":F=7-D}switch(g){case"top-right":case"bottom-right":case"right":z=-T;break;case"top-left":case"bottom-left":case"left":z=T}return[z,F]}(f,u[0],u[1]):function(g,T){let D=0,z=0;T<0&&(T=0);const F=T/Math.sqrt(2);switch(g){case"top-right":case"top-left":z=F-7;break;case"bottom-right":case"bottom-left":z=7-F;break;case"bottom":z=7-T;break;case"top":z=T-7}switch(g){case"top-right":case"bottom-right":D=-F;break;case"top-left":case"bottom-left":D=F;break;case"left":D=T;break;case"right":D=-T}return[D,z]}(f,u[0])}function lx(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function e9(f,u,g,T,D,z,F,$,Z,re,Ae){let ce=z.textMaxSize.evaluate(u,{});ce===void 0&&(ce=F);const pe=f.layers[0].layout,ye=pe.get("icon-offset").evaluate(u,{},Ae),_e=P5(g.horizontal),Ve=F/24,ze=f.tilePixelRatio*Ve,tt=f.tilePixelRatio*ce/24,ut=f.tilePixelRatio*$,et=f.tilePixelRatio*pe.get("symbol-spacing"),at=pe.get("text-padding")*f.tilePixelRatio,mt=function(St,gn,ln,Hn=1){const Ur=St.get("icon-padding").evaluate(gn,{},ln),Hr=Ur&&Ur.values;return[Hr[0]*Hn,Hr[1]*Hn,Hr[2]*Hn,Hr[3]*Hn]}(pe,u,Ae,f.tilePixelRatio),gt=pe.get("text-max-angle")/180*Math.PI,Zt=pe.get("text-rotation-alignment")!=="viewport"&&pe.get("symbol-placement")!=="point",tn=pe.get("icon-rotation-alignment")==="map"&&pe.get("symbol-placement")!=="point",Ht=pe.get("symbol-placement"),Ut=et/2,Ot=pe.get("icon-text-fit");let Wt;T&&Ot!=="none"&&(f.allowVerticalPlacement&&g.vertical&&(Wt=m5(T,g.vertical,Ot,pe.get("icon-text-fit-padding"),ye,Ve)),_e&&(T=m5(T,_e,Ot,pe.get("icon-text-fit-padding"),ye,Ve)));const $t=(St,gn)=>{gn.x<0||gn.x>=Bi||gn.y<0||gn.y>=Bi||function(ln,Hn,Ur,Hr,zi,Sa,ds,Ei,Qi,ps,Ms,To,Ti,gs,Ps,Ks,So,Co,Xr,qi,Jn,Ko,ms,ks,sl){const ql=ln.addToLineVertexArray(Hn,Ur);let Zl,Pu,ol,Ca,Mo=0,ku=0,cp=0,H5=0,yx=-1,_x=-1;const Iu={};let W5=wn.exports(""),vx=0,xx=0;if(Ei._unevaluatedLayout.getValue("text-radial-offset")===void 0?[vx,xx]=Ei.layout.get("text-offset").evaluate(Jn,{},ks).map(Po=>Po*es):(vx=Ei.layout.get("text-radial-offset").evaluate(Jn,{},ks)*es,xx=ax),ln.allowVerticalPlacement&&Hr.vertical){const Po=Ei.layout.get("text-rotate").evaluate(Jn,{},ks)+90;ol=new s1(Qi,Hn,ps,Ms,To,Hr.vertical,Ti,gs,Ps,Po),ds&&(Ca=new s1(Qi,Hn,ps,Ms,To,ds,So,Co,Ps,Po))}if(zi){const Po=Ei.layout.get("icon-rotate").evaluate(Jn,{}),RA=Ei.layout.get("icon-text-fit")!=="none",hp=T5(zi,Po,ms,RA),fp=ds?T5(ds,Po,ms,RA):void 0;Pu=new s1(Qi,Hn,ps,Ms,To,zi,So,Co,!1,Po),Mo=4*hp.length;const Z5=ln.iconSizeData;let Bh=null;Z5.kind==="source"?(Bh=[Mu*Ei.layout.get("icon-size").evaluate(Jn,{})],Bh[0]>Rc&&me(`${ln.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Z5.kind==="composite"&&(Bh=[Mu*Ko.compositeIconSizes[0].evaluate(Jn,{},ks),Mu*Ko.compositeIconSizes[1].evaluate(Jn,{},ks)],(Bh[0]>Rc||Bh[1]>Rc)&&me(`${ln.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),ln.addSymbols(ln.icon,hp,Bh,qi,Xr,Jn,o.WritingMode.none,Hn,ql.lineStartIndex,ql.lineLength,-1,ks),yx=ln.icon.placedSymbolArray.length-1,fp&&(ku=4*fp.length,ln.addSymbols(ln.icon,fp,Bh,qi,Xr,Jn,o.WritingMode.vertical,Hn,ql.lineStartIndex,ql.lineLength,-1,ks),_x=ln.icon.placedSymbolArray.length-1)}const Q5=Object.keys(Hr.horizontal);for(const Po of Q5){const RA=Hr.horizontal[Po];if(!Zl){W5=wn.exports(RA.text);const fp=Ei.layout.get("text-rotate").evaluate(Jn,{},ks);Zl=new s1(Qi,Hn,ps,Ms,To,RA,Ti,gs,Ps,fp)}const hp=RA.positionedLines.length===1;if(cp+=M5(ln,Hn,RA,Sa,Ei,Ps,Jn,Ks,ql,Hr.vertical?o.WritingMode.horizontal:o.WritingMode.horizontalOnly,hp?Q5:[Po],Iu,yx,Ko,ks),hp)break}Hr.vertical&&(H5+=M5(ln,Hn,Hr.vertical,Sa,Ei,Ps,Jn,Ks,ql,o.WritingMode.vertical,["vertical"],Iu,_x,Ko,ks));const f9=Zl?Zl.boxStartIndex:ln.collisionBoxArray.length,d9=Zl?Zl.boxEndIndex:ln.collisionBoxArray.length,p9=ol?ol.boxStartIndex:ln.collisionBoxArray.length,g9=ol?ol.boxEndIndex:ln.collisionBoxArray.length,m9=Pu?Pu.boxStartIndex:ln.collisionBoxArray.length,y9=Pu?Pu.boxEndIndex:ln.collisionBoxArray.length,_9=Ca?Ca.boxStartIndex:ln.collisionBoxArray.length,v9=Ca?Ca.boxEndIndex:ln.collisionBoxArray.length;let Yl=-1;const u1=(Po,RA)=>Po&&Po.circleDiameter?Math.max(Po.circleDiameter,RA):RA;Yl=u1(Zl,Yl),Yl=u1(ol,Yl),Yl=u1(Pu,Yl),Yl=u1(Ca,Yl);const q5=Yl>-1?1:0;q5&&(Yl*=sl/es),ln.glyphOffsetArray.length>=e0.MAX_GLYPHS&&me("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Jn.sortKey!==void 0&&ln.addToSortKeyRanges(ln.symbolInstances.length,Jn.sortKey),ln.symbolInstances.emplaceBack(Hn.x,Hn.y,Iu.right>=0?Iu.right:-1,Iu.center>=0?Iu.center:-1,Iu.left>=0?Iu.left:-1,Iu.vertical||-1,yx,_x,W5,f9,d9,p9,g9,m9,y9,_9,v9,ps,cp,H5,Mo,ku,q5,0,Ti,vx,xx,Yl)}(f,gn,St,g,T,D,Wt,f.layers[0],f.collisionBoxArray,u.index,u.sourceLayerIndex,f.index,ze,[at,at,at,at],Zt,Z,ut,mt,tn,ye,u,z,re,Ae,F)};if(Ht==="line")for(const St of E5(u.geometry,0,0,Bi,Bi)){const gn=ZN(St,et,gt,g.vertical||_e,T,24,tt,f.overscaling,Bi);for(const ln of gn){const Hn=_e;Hn&&t9(f,Hn.text,Ut,ln)||$t(St,ln)}}else if(Ht==="line-center"){for(const St of u.geometry)if(St.length>1){const gn=qN(St,gt,g.vertical||_e,T,24,tt);gn&&$t(St,gn)}}else if(u.type==="Polygon")for(const St of Zv(u.geometry,0)){const gn=KN(St,16);$t(St[0],new Dc(gn.x,gn.y,0))}else if(u.type==="LineString")for(const St of u.geometry)$t(St,new Dc(St[0].x,St[0].y,0));else if(u.type==="Point")for(const St of u.geometry)for(const gn of St)$t([gn],new Dc(gn.x,gn.y,0))}const Rc=32640;function M5(f,u,g,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e){const Ve=function(ut,et,at,mt,gt,Zt,tn,Ht){const Ut=mt.layout.get("text-rotate").evaluate(Zt,{})*Math.PI/180,Ot=[];for(const Wt of et.positionedLines)for(const $t of Wt.positionedGlyphs){if(!$t.rect)continue;const St=$t.rect||{};let gn=4,ln=!0,Hn=1,Ur=0;const Hr=(gt||Ht)&&$t.vertical,zi=$t.metrics.advance*$t.scale/2;if(Ht&&et.verticalizable){const Xr=($t.scale-1)*es,qi=(es-$t.metrics.width*$t.scale)/2;Ur=Wt.lineOffset/2-($t.imageName?-qi:Xr)}if($t.imageName){const Xr=tn[$t.imageName];ln=Xr.sdf,Hn=Xr.pixelRatio,gn=1/Hn}const Sa=gt?[$t.x+zi,$t.y]:[0,0];let ds=gt?[0,0]:[$t.x+zi+at[0],$t.y+at[1]-Ur],Ei=[0,0];Hr&&(Ei=ds,ds=[0,0]);const Qi=($t.metrics.left-gn)*$t.scale-zi+ds[0],ps=(-$t.metrics.top-gn)*$t.scale+ds[1],Ms=Qi+St.w*$t.scale/Hn,To=ps+St.h*$t.scale/Hn,Ti=new Tt(Qi,ps),gs=new Tt(Ms,ps),Ps=new Tt(Qi,To),Ks=new Tt(Ms,To);if(Hr){const Xr=new Tt(-zi,zi-Jm),qi=-Math.PI/2,Jn=12-zi,Ko=new Tt(22-Jn,-($t.imageName?Jn:0)),ms=new Tt(...Ei);Ti._rotateAround(qi,Xr)._add(Ko)._add(ms),gs._rotateAround(qi,Xr)._add(Ko)._add(ms),Ps._rotateAround(qi,Xr)._add(Ko)._add(ms),Ks._rotateAround(qi,Xr)._add(Ko)._add(ms)}if(Ut){const Xr=Math.sin(Ut),qi=Math.cos(Ut),Jn=[qi,-Xr,Xr,qi];Ti._matMult(Jn),gs._matMult(Jn),Ps._matMult(Jn),Ks._matMult(Jn)}const So=new Tt(0,0),Co=new Tt(0,0);Ot.push({tl:Ti,tr:gs,bl:Ps,br:Ks,tex:St,writingMode:et.writingMode,glyphOffset:Sa,sectionIndex:$t.sectionIndex,isSDF:ln,pixelOffsetTL:So,pixelOffsetBR:Co,minFontScaleX:0,minFontScaleY:0})}return Ot}(0,g,$,D,z,F,T,f.allowVerticalPlacement),ze=f.textSizeData;let tt=null;ze.kind==="source"?(tt=[Mu*D.layout.get("text-size").evaluate(F,{})],tt[0]>Rc&&me(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ze.kind==="composite"&&(tt=[Mu*ye.compositeTextSizes[0].evaluate(F,{},_e),Mu*ye.compositeTextSizes[1].evaluate(F,{},_e)],(tt[0]>Rc||tt[1]>Rc)&&me(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),f.addSymbols(f.text,Ve,tt,$,z,F,re,u,Z.lineStartIndex,Z.lineLength,pe,_e);for(const ut of Ae)ce[ut]=f.text.placedSymbolArray.length-1;return 4*Ve.length}function P5(f){for(const u in f)return f[u];return null}function t9(f,u,g,T){const D=f.compareText;if(u in D){const z=D[u];for(let F=z.length-1;F>=0;F--)if(T.dist(z[F])<g)return!0}else D[u]=[];return D[u].push(T),!1}const n9=Ic.VectorTileFeature.types,r9=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function o1(f,u,g,T,D,z,F,$,Z,re,Ae,ce,pe){const ye=$?Math.min(Rc,Math.round($[0])):0,_e=$?Math.min(Rc,Math.round($[1])):0;f.emplaceBack(u,g,Math.round(32*T),Math.round(32*D),z,F,(ye<<1)+(Z?1:0),_e,16*re,16*Ae,256*ce,256*pe)}function Ax(f,u,g){f.emplaceBack(u.x,u.y,g),f.emplaceBack(u.x,u.y,g),f.emplaceBack(u.x,u.y,g),f.emplaceBack(u.x,u.y,g)}function i9(f){for(const u of f.sections)if(Sc(u.text))return!0;return!1}class ux{constructor(u){this.layoutVertexArray=new Be,this.indexArray=new ot,this.programConfigurations=u,this.segments=new pt,this.dynamicLayoutVertexArray=new Xe,this.opacityVertexArray=new ft,this.placedSymbolArray=new y}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(u,g,T,D){this.isEmpty()||(T&&(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,CN.members),this.indexBuffer=u.createIndexBuffer(this.indexArray,g),this.dynamicLayoutVertexBuffer=u.createVertexBuffer(this.dynamicLayoutVertexArray,MN.members,!0),this.opacityVertexBuffer=u.createVertexBuffer(this.opacityVertexArray,r9,!0),this.opacityVertexBuffer.itemSize=1),(T||D)&&this.programConfigurations.upload(u))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Nt("SymbolBuffers",ux);class cx{constructor(u,g,T){this.layoutVertexArray=new u,this.layoutAttributes=g,this.indexArray=new T,this.segments=new pt,this.collisionVertexArray=new st}upload(u){this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=u.createVertexBuffer(this.collisionVertexArray,PN.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Nt("CollisionBuffers",cx);class e0{constructor(u){this.collisionBoxArray=u.collisionBoxArray,this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(F=>F.id),this.index=u.index,this.pixelRatio=u.pixelRatio,this.sourceLayerIndex=u.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$v([]),this.placementViewportMatrix=$v([]);const g=this.layers[0]._unevaluatedLayout._values;this.textSizeData=y5(this.zoom,g["text-size"]),this.iconSizeData=y5(this.zoom,g["icon-size"]);const T=this.layers[0].layout,D=T.get("symbol-sort-key"),z=T.get("symbol-z-order");this.canOverlap=fx(T,"text-overlap","text-allow-overlap")!=="never"||fx(T,"icon-overlap","icon-allow-overlap")!=="never"||T.get("text-ignore-placement")||T.get("icon-ignore-placement"),this.sortFeaturesByKey=z!=="viewport-y"&&!D.isConstant(),this.sortFeaturesByY=(z==="viewport-y"||z==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,T.get("symbol-placement")==="point"&&(this.writingModes=T.get("text-writing-mode").map(F=>o.WritingMode[F])),this.stateDependentLayerIds=this.layers.filter(F=>F.isStateDependent()).map(F=>F.id),this.sourceID=u.sourceID}createArrays(){this.text=new ux(new kh(this.layers,this.zoom,u=>/^text/.test(u))),this.icon=new ux(new kh(this.layers,this.zoom,u=>/^icon/.test(u))),this.glyphOffsetArray=new E,this.lineVertexArray=new k,this.symbolInstances=new v}calculateGlyphDependencies(u,g,T,D,z){for(let F=0;F<u.length;F++)if(g[u.charCodeAt(F)]=!0,(T||D)&&z){const $=ap[u.charAt(F)];$&&(g[$.charCodeAt(0)]=!0)}}populate(u,g,T){const D=this.layers[0],z=D.layout,F=z.get("text-font"),$=z.get("text-field"),Z=z.get("icon-image"),re=($.value.kind!=="constant"||$.value.value instanceof ke&&!$.value.value.isEmpty()||$.value.value.toString().length>0)&&(F.value.kind!=="constant"||F.value.value.length>0),Ae=Z.value.kind!=="constant"||!!Z.value.value||Object.keys(Z.parameters).length>0,ce=z.get("symbol-sort-key");if(this.features=[],!re&&!Ae)return;const pe=g.iconDependencies,ye=g.glyphDependencies,_e=g.availableImages,Ve=new Sr(this.zoom);for(const{feature:ze,id:tt,index:ut,sourceLayerIndex:et}of u){const at=D._featureFilter.needGeometry,mt=Lh(ze,at);if(!D._featureFilter.filter(Ve,mt,T))continue;let gt,Zt;if(at||(mt.geometry=Ih(ze)),re){const Ht=D.getValueAndResolveTokens("text-field",mt,T,_e),Ut=ke.factory(Ht);i9(Ut)&&(this.hasRTLText=!0),(!this.hasRTLText||jl()==="unavailable"||this.hasRTLText&&fs.isParsed())&&(gt=IN(Ut,D,mt))}if(Ae){const Ht=D.getValueAndResolveTokens("icon-image",mt,T,_e);Zt=Ht instanceof Ie?Ht:Ie.fromString(Ht)}if(!gt&&!Zt)continue;const tn=this.sortFeaturesByKey?ce.evaluate(mt,{},T):void 0;if(this.features.push({id:tt,text:gt,icon:Zt,index:ut,sourceLayerIndex:et,geometry:mt.geometry,properties:ze.properties,type:n9[ze.type],sortKey:tn}),Zt&&(pe[Zt.name]=!0),gt){const Ht=F.evaluate(mt,{},T).join(","),Ut=z.get("text-rotation-alignment")!=="viewport"&&z.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(o.WritingMode.vertical)>=0;for(const Ot of gt.sections)if(Ot.image)pe[Ot.image.name]=!0;else{const Wt=LA(gt.toString()),$t=Ot.fontStack||Ht,St=ye[$t]=ye[$t]||{};this.calculateGlyphDependencies(Ot.text,St,Ut,this.allowVerticalPlacement,Wt)}}}z.get("symbol-placement")==="line"&&(this.features=function(ze){const tt={},ut={},et=[];let at=0;function mt(Ht){et.push(ze[Ht]),at++}function gt(Ht,Ut,Ot){const Wt=ut[Ht];return delete ut[Ht],ut[Ut]=Wt,et[Wt].geometry[0].pop(),et[Wt].geometry[0]=et[Wt].geometry[0].concat(Ot[0]),Wt}function Zt(Ht,Ut,Ot){const Wt=tt[Ut];return delete tt[Ut],tt[Ht]=Wt,et[Wt].geometry[0].shift(),et[Wt].geometry[0]=Ot[0].concat(et[Wt].geometry[0]),Wt}function tn(Ht,Ut,Ot){const Wt=Ot?Ut[0][Ut[0].length-1]:Ut[0][0];return`${Ht}:${Wt.x}:${Wt.y}`}for(let Ht=0;Ht<ze.length;Ht++){const Ut=ze[Ht],Ot=Ut.geometry,Wt=Ut.text?Ut.text.toString():null;if(!Wt){mt(Ht);continue}const $t=tn(Wt,Ot),St=tn(Wt,Ot,!0);if($t in ut&&St in tt&&ut[$t]!==tt[St]){const gn=Zt($t,St,Ot),ln=gt($t,St,et[gn].geometry);delete tt[$t],delete ut[St],ut[tn(Wt,et[ln].geometry,!0)]=ln,et[gn].geometry=null}else $t in ut?gt($t,St,Ot):St in tt?Zt($t,St,Ot):(mt(Ht),tt[$t]=at-1,ut[St]=at-1)}return et.filter(Ht=>Ht.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ze,tt)=>ze.sortKey-tt.sortKey)}update(u,g,T){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(u,g,this.layers,T),this.icon.programConfigurations.updatePaintArrays(u,g,this.layers,T))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(u){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(u),this.iconCollisionBox.upload(u)),this.text.upload(u,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(u,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(u,g){const T=this.lineVertexArray.length;if(u.segment!==void 0){let D=u.dist(g[u.segment+1]),z=u.dist(g[u.segment]);const F={};for(let $=u.segment+1;$<g.length;$++)F[$]={x:g[$].x,y:g[$].y,tileUnitDistanceFromAnchor:D},$<g.length-1&&(D+=g[$+1].dist(g[$]));for(let $=u.segment||0;$>=0;$--)F[$]={x:g[$].x,y:g[$].y,tileUnitDistanceFromAnchor:z},$>0&&(z+=g[$-1].dist(g[$]));for(let $=0;$<g.length;$++){const Z=F[$];this.lineVertexArray.emplaceBack(Z.x,Z.y,Z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:T,lineLength:this.lineVertexArray.length-T}}addSymbols(u,g,T,D,z,F,$,Z,re,Ae,ce,pe){const ye=u.indexArray,_e=u.layoutVertexArray,Ve=u.segments.prepareSegment(4*g.length,_e,ye,this.canOverlap?F.sortKey:void 0),ze=this.glyphOffsetArray.length,tt=Ve.vertexLength,ut=this.allowVerticalPlacement&&$===o.WritingMode.vertical?Math.PI/2:0,et=F.text&&F.text.sections;for(let at=0;at<g.length;at++){const{tl:mt,tr:gt,bl:Zt,br:tn,tex:Ht,pixelOffsetTL:Ut,pixelOffsetBR:Ot,minFontScaleX:Wt,minFontScaleY:$t,glyphOffset:St,isSDF:gn,sectionIndex:ln}=g[at],Hn=Ve.vertexLength,Ur=St[1];o1(_e,Z.x,Z.y,mt.x,Ur+mt.y,Ht.x,Ht.y,T,gn,Ut.x,Ut.y,Wt,$t),o1(_e,Z.x,Z.y,gt.x,Ur+gt.y,Ht.x+Ht.w,Ht.y,T,gn,Ot.x,Ut.y,Wt,$t),o1(_e,Z.x,Z.y,Zt.x,Ur+Zt.y,Ht.x,Ht.y+Ht.h,T,gn,Ut.x,Ot.y,Wt,$t),o1(_e,Z.x,Z.y,tn.x,Ur+tn.y,Ht.x+Ht.w,Ht.y+Ht.h,T,gn,Ot.x,Ot.y,Wt,$t),Ax(u.dynamicLayoutVertexArray,Z,ut),ye.emplaceBack(Hn,Hn+1,Hn+2),ye.emplaceBack(Hn+1,Hn+2,Hn+3),Ve.vertexLength+=4,Ve.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(St[0]),at!==g.length-1&&ln===g[at+1].sectionIndex||u.programConfigurations.populatePaintArrays(_e.length,F,F.index,{},pe,et&&et[ln])}u.placedSymbolArray.emplaceBack(Z.x,Z.y,ze,this.glyphOffsetArray.length-ze,tt,re,Ae,Z.segment,T?T[0]:0,T?T[1]:0,D[0],D[1],$,0,!1,0,ce)}_addCollisionDebugVertex(u,g,T,D,z,F){return g.emplaceBack(0,0),u.emplaceBack(T.x,T.y,D,z,Math.round(F.x),Math.round(F.y))}addCollisionDebugVertices(u,g,T,D,z,F,$){const Z=z.segments.prepareSegment(4,z.layoutVertexArray,z.indexArray),re=Z.vertexLength,Ae=z.layoutVertexArray,ce=z.collisionVertexArray,pe=$.anchorX,ye=$.anchorY;this._addCollisionDebugVertex(Ae,ce,F,pe,ye,new Tt(u,g)),this._addCollisionDebugVertex(Ae,ce,F,pe,ye,new Tt(T,g)),this._addCollisionDebugVertex(Ae,ce,F,pe,ye,new Tt(T,D)),this._addCollisionDebugVertex(Ae,ce,F,pe,ye,new Tt(u,D)),Z.vertexLength+=4;const _e=z.indexArray;_e.emplaceBack(re,re+1),_e.emplaceBack(re+1,re+2),_e.emplaceBack(re+2,re+3),_e.emplaceBack(re+3,re),Z.primitiveLength+=4}addDebugCollisionBoxes(u,g,T,D){for(let z=u;z<g;z++){const F=this.collisionBoxArray.get(z);this.addCollisionDebugVertices(F.x1,F.y1,F.x2,F.y2,D?this.textCollisionBox:this.iconCollisionBox,F.anchorPoint,T)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new cx(ct,i5.members,Je),this.iconCollisionBox=new cx(ct,i5.members,Je);for(let u=0;u<this.symbolInstances.length;u++){const g=this.symbolInstances.get(u);this.addDebugCollisionBoxes(g.textBoxStartIndex,g.textBoxEndIndex,g,!0),this.addDebugCollisionBoxes(g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g,!0),this.addDebugCollisionBoxes(g.iconBoxStartIndex,g.iconBoxEndIndex,g,!1),this.addDebugCollisionBoxes(g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g,!1)}}_deserializeCollisionBoxesForSymbol(u,g,T,D,z,F,$,Z,re){const Ae={};for(let ce=g;ce<T;ce++){const pe=u.get(ce);Ae.textBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.textFeatureIndex=pe.featureIndex;break}for(let ce=D;ce<z;ce++){const pe=u.get(ce);Ae.verticalTextBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.verticalTextFeatureIndex=pe.featureIndex;break}for(let ce=F;ce<$;ce++){const pe=u.get(ce);Ae.iconBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.iconFeatureIndex=pe.featureIndex;break}for(let ce=Z;ce<re;ce++){const pe=u.get(ce);Ae.verticalIconBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.verticalIconFeatureIndex=pe.featureIndex;break}return Ae}deserializeCollisionBoxes(u){this.collisionArrays=[];for(let g=0;g<this.symbolInstances.length;g++){const T=this.symbolInstances.get(g);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(u,T.textBoxStartIndex,T.textBoxEndIndex,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T.iconBoxStartIndex,T.iconBoxEndIndex,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(u,g){const T=u.placedSymbolArray.get(g),D=T.vertexStartIndex+4*T.numGlyphs;for(let z=T.vertexStartIndex;z<D;z+=4)u.indexArray.emplaceBack(z,z+1,z+2),u.indexArray.emplaceBack(z+1,z+2,z+3)}getSortedSymbolIndexes(u){if(this.sortedAngle===u&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const g=Math.sin(u),T=Math.cos(u),D=[],z=[],F=[];for(let $=0;$<this.symbolInstances.length;++$){F.push($);const Z=this.symbolInstances.get($);D.push(0|Math.round(g*Z.anchorX+T*Z.anchorY)),z.push(Z.featureIndex)}return F.sort(($,Z)=>D[$]-D[Z]||z[Z]-z[$]),F}addToSortKeyRanges(u,g){const T=this.sortKeyRanges[this.sortKeyRanges.length-1];T&&T.sortKey===g?T.symbolInstanceEnd=u+1:this.sortKeyRanges.push({sortKey:g,symbolInstanceStart:u,symbolInstanceEnd:u+1})}sortFeatures(u){if(this.sortFeaturesByY&&this.sortedAngle!==u&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(u),this.sortedAngle=u,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const g of this.symbolInstanceIndexes){const T=this.symbolInstances.get(g);this.featureSortOrder.push(T.featureIndex),[T.rightJustifiedTextSymbolIndex,T.centerJustifiedTextSymbolIndex,T.leftJustifiedTextSymbolIndex].forEach((D,z,F)=>{D>=0&&F.indexOf(D)===z&&this.addIndicesForPlacedSymbol(this.text,D)}),T.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,T.verticalPlacedTextSymbolIndex),T.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.placedIconSymbolIndex),T.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Nt("SymbolBucket",e0,{omit:["layers","collisionBoxArray","features","compareText"]}),e0.MAX_GLYPHS=65535,e0.addDynamicAttributes=Ax;const s9=new $r({"symbol-placement":new Yt(ht.layout_symbol["symbol-placement"]),"symbol-spacing":new Yt(ht.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Yt(ht.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Xt(ht.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Yt(ht.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Yt(ht.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Yt(ht.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Yt(ht.layout_symbol["icon-ignore-placement"]),"icon-optional":new Yt(ht.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Yt(ht.layout_symbol["icon-rotation-alignment"]),"icon-size":new Xt(ht.layout_symbol["icon-size"]),"icon-text-fit":new Yt(ht.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Yt(ht.layout_symbol["icon-text-fit-padding"]),"icon-image":new Xt(ht.layout_symbol["icon-image"]),"icon-rotate":new Xt(ht.layout_symbol["icon-rotate"]),"icon-padding":new Xt(ht.layout_symbol["icon-padding"]),"icon-keep-upright":new Yt(ht.layout_symbol["icon-keep-upright"]),"icon-offset":new Xt(ht.layout_symbol["icon-offset"]),"icon-anchor":new Xt(ht.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Yt(ht.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Yt(ht.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Yt(ht.layout_symbol["text-rotation-alignment"]),"text-field":new Xt(ht.layout_symbol["text-field"]),"text-font":new Xt(ht.layout_symbol["text-font"]),"text-size":new Xt(ht.layout_symbol["text-size"]),"text-max-width":new Xt(ht.layout_symbol["text-max-width"]),"text-line-height":new Yt(ht.layout_symbol["text-line-height"]),"text-letter-spacing":new Xt(ht.layout_symbol["text-letter-spacing"]),"text-justify":new Xt(ht.layout_symbol["text-justify"]),"text-radial-offset":new Xt(ht.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Yt(ht.layout_symbol["text-variable-anchor"]),"text-anchor":new Xt(ht.layout_symbol["text-anchor"]),"text-max-angle":new Yt(ht.layout_symbol["text-max-angle"]),"text-writing-mode":new Yt(ht.layout_symbol["text-writing-mode"]),"text-rotate":new Xt(ht.layout_symbol["text-rotate"]),"text-padding":new Yt(ht.layout_symbol["text-padding"]),"text-keep-upright":new Yt(ht.layout_symbol["text-keep-upright"]),"text-transform":new Xt(ht.layout_symbol["text-transform"]),"text-offset":new Xt(ht.layout_symbol["text-offset"]),"text-allow-overlap":new Yt(ht.layout_symbol["text-allow-overlap"]),"text-overlap":new Yt(ht.layout_symbol["text-overlap"]),"text-ignore-placement":new Yt(ht.layout_symbol["text-ignore-placement"]),"text-optional":new Yt(ht.layout_symbol["text-optional"])});var hx={paint:new $r({"icon-opacity":new Xt(ht.paint_symbol["icon-opacity"]),"icon-color":new Xt(ht.paint_symbol["icon-color"]),"icon-halo-color":new Xt(ht.paint_symbol["icon-halo-color"]),"icon-halo-width":new Xt(ht.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Xt(ht.paint_symbol["icon-halo-blur"]),"icon-translate":new Yt(ht.paint_symbol["icon-translate"]),"icon-translate-anchor":new Yt(ht.paint_symbol["icon-translate-anchor"]),"text-opacity":new Xt(ht.paint_symbol["text-opacity"]),"text-color":new Xt(ht.paint_symbol["text-color"],{runtimeType:Lr,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new Xt(ht.paint_symbol["text-halo-color"]),"text-halo-width":new Xt(ht.paint_symbol["text-halo-width"]),"text-halo-blur":new Xt(ht.paint_symbol["text-halo-blur"]),"text-translate":new Yt(ht.paint_symbol["text-translate"]),"text-translate-anchor":new Yt(ht.paint_symbol["text-translate-anchor"])}),layout:s9};class k5{constructor(u){if(u.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=u.property.overrides?u.property.overrides.runtimeType:as,this.defaultValue=u}evaluate(u){if(u.formattedSection){const g=this.defaultValue.property.overrides;if(g&&g.hasOverride(u.formattedSection))return g.getOverride(u.formattedSection)}return u.feature&&u.featureState?this.defaultValue.evaluate(u.feature,u.featureState):this.defaultValue.property.specification.default}eachChild(u){this.defaultValue.isConstant()||u(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Nt("FormatSectionOverride",k5,{omit:["defaultValue"]});class a1 extends Cs{constructor(u){super(u,hx)}recalculate(u,g){if(super.recalculate(u,g),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const T=this.layout.get("text-writing-mode");if(T){const D=[];for(const z of T)D.indexOf(z)<0&&D.push(z);this.layout._values["text-writing-mode"]=D}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(u,g,T,D){const z=this.layout.get(u).evaluate(g,{},T,D),F=this._unevaluatedLayout._values[u];return F.isDataDriven()||zl(F.value)||!z?z:function($,Z){return Z.replace(/{([^{}]+)}/g,(re,Ae)=>Ae in $?String($[Ae]):"")}(g.properties,z)}createBucket(u){return new e0(u)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const u of hx.paint.overridableProperties){if(!a1.hasPaintOverride(this.layout,u))continue;const g=this.paint.get(u),T=new k5(g),D=new Gs(T,g.property.specification);let z=null;z=g.value.kind==="constant"||g.value.kind==="source"?new ya("source",D):new Ol("composite",D,g.value.zoomStops),this.paint._values[u]=new yr(g.property,z,g.parameters)}}_handleOverridablePaintPropertyUpdate(u,g,T){return!(!this.layout||g.isDataDriven()||T.isDataDriven())&&a1.hasPaintOverride(this.layout,u)}static hasPaintOverride(u,g){const T=u.get("text-field"),D=hx.paint.properties[g];let z=!1;const F=$=>{for(const Z of $)if(D.overrides&&D.overrides.hasOverride(Z))return void(z=!0)};if(T.value.kind==="constant"&&T.value.value instanceof ke)F(T.value.value.sections);else if(T.value.kind==="source"){const $=re=>{z||(re instanceof Dt&&We(re.value)===Qr?F(re.value.sections):re instanceof PA?F(re.sections):re.eachChild($))},Z=T.value;Z._styleExpression&&$(Z._styleExpression.expression)}return z}}function fx(f,u,g){let T="never";const D=f.get(u);return D?T=D:f.get(g)&&(T="always"),T}var o9={paint:new $r({"background-color":new Yt(ht.paint_background["background-color"]),"background-pattern":new Ji(ht.paint_background["background-pattern"]),"background-opacity":new Yt(ht.paint_background["background-opacity"])})},a9={paint:new $r({"raster-opacity":new Yt(ht.paint_raster["raster-opacity"]),"raster-hue-rotate":new Yt(ht.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Yt(ht.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Yt(ht.paint_raster["raster-brightness-max"]),"raster-saturation":new Yt(ht.paint_raster["raster-saturation"]),"raster-contrast":new Yt(ht.paint_raster["raster-contrast"]),"raster-resampling":new Yt(ht.paint_raster["raster-resampling"]),"raster-fade-duration":new Yt(ht.paint_raster["raster-fade-duration"])})};class l9 extends Cs{constructor(u){super(u,{}),this.onAdd=g=>{this.implementation.onAdd&&this.implementation.onAdd(g,g.painter.context.gl)},this.onRemove=g=>{this.implementation.onRemove&&this.implementation.onRemove(g,g.painter.context.gl)},this.implementation=u}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const A9={circle:class extends Cs{constructor(f){super(f,U7)}createBucket(f){return new Uv(f)}queryRadius(f){const u=f;return Kd("circle-radius",this,u)+Kd("circle-stroke-width",this,u)+jm(this.paint.get("circle-translate"))}queryIntersectsFeature(f,u,g,T,D,z,F,$){const Z=Hm(f,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),z.angle,F),re=this.paint.get("circle-radius").evaluate(u,g)+this.paint.get("circle-stroke-width").evaluate(u,g),Ae=this.paint.get("circle-pitch-alignment")==="map",ce=Ae?Z:function(ye,_e){return ye.map(Ve=>V4(Ve,_e))}(Z,$),pe=Ae?re*F:re;for(const ye of T)for(const _e of ye){const Ve=Ae?_e:V4(_e,$);let ze=pe;const tt=Wm([],[_e.x,_e.y,0,1],$);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ze*=tt[3]/z.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ze*=z.cameraToCenterDistance/tt[3]),B7(ce,Ve,ze))return!0}return!1}},heatmap:class extends Cs{constructor(f){super(f,G7),this._updateColorRamp()}createBucket(f){return new G4(f)}_handleSpecialPaintPropertyUpdate(f){f==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=j4({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Cs{constructor(f){super(f,$7)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Cs{constructor(f){super(f,sN)}recalculate(f,u){super.recalculate(f,u);const g=this.paint._values["fill-outline-color"];g.value.kind==="constant"&&g.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(f){return new Kv(f)}queryRadius(){return jm(this.paint.get("fill-translate"))}queryIntersectsFeature(f,u,g,T,D,z,F){return D4(Hm(f,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),z.angle,F),T)}isTileClipped(){return!0}},"fill-extrusion":class extends Cs{constructor(f){super(f,_N)}createBucket(f){return new ex(f)}queryRadius(){return jm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(f,u,g,T,D,z,F,$){const Z=Hm(f,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),z.angle,F),re=this.paint.get("fill-extrusion-height").evaluate(u,g),Ae=this.paint.get("fill-extrusion-base").evaluate(u,g),ce=function(ye,_e,Ve,ze){const tt=[];for(const ut of ye){const et=[ut.x,ut.y,0,1];Wm(et,et,_e),tt.push(new Tt(et[0]/et[3],et[1]/et[3]))}return tt}(Z,$),pe=function(ye,_e,Ve,ze){const tt=[],ut=[],et=ze[8]*_e,at=ze[9]*_e,mt=ze[10]*_e,gt=ze[11]*_e,Zt=ze[8]*Ve,tn=ze[9]*Ve,Ht=ze[10]*Ve,Ut=ze[11]*Ve;for(const Ot of ye){const Wt=[],$t=[];for(const St of Ot){const gn=St.x,ln=St.y,Hn=ze[0]*gn+ze[4]*ln+ze[12],Ur=ze[1]*gn+ze[5]*ln+ze[13],Hr=ze[2]*gn+ze[6]*ln+ze[14],zi=ze[3]*gn+ze[7]*ln+ze[15],Sa=Hr+mt,ds=zi+gt,Ei=Hn+Zt,Qi=Ur+tn,ps=Hr+Ht,Ms=zi+Ut,To=new Tt((Hn+et)/ds,(Ur+at)/ds);To.z=Sa/ds,Wt.push(To);const Ti=new Tt(Ei/Ms,Qi/Ms);Ti.z=ps/Ms,$t.push(Ti)}tt.push(Wt),ut.push($t)}return[tt,ut]}(T,Ae,re,$);return function(ye,_e,Ve){let ze=1/0;D4(Ve,_e)&&(ze=J4(Ve,_e[0]));for(let tt=0;tt<_e.length;tt++){const ut=_e[tt],et=ye[tt];for(let at=0;at<ut.length-1;at++){const mt=ut[at],gt=[mt,ut[at+1],et[at+1],et[at],mt];L4(Ve,gt)&&(ze=Math.min(ze,J4(Ve,gt)))}}return ze!==1/0&&ze}(pe[0],pe[1],ce)}},line:class extends Cs{constructor(f){super(f,t5),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(f){f==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ir,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(f,u){super.recalculate(f,u),this.paint._values["line-floorwidth"]=n5.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,f)}createBucket(f){return new tx(f)}queryRadius(f){const u=f,g=r5(Kd("line-width",this,u),Kd("line-gap-width",this,u)),T=Kd("line-offset",this,u);return g/2+Math.abs(T)+jm(this.paint.get("line-translate"))}queryIntersectsFeature(f,u,g,T,D,z,F){const $=Hm(f,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),z.angle,F),Z=F/2*r5(this.paint.get("line-width").evaluate(u,g),this.paint.get("line-gap-width").evaluate(u,g)),re=this.paint.get("line-offset").evaluate(u,g);return re&&(T=function(Ae,ce){const pe=[];for(let ye=0;ye<Ae.length;ye++){const _e=Ae[ye],Ve=[];for(let ze=0;ze<_e.length;ze++){const tt=_e[ze-1],ut=_e[ze],et=_e[ze+1],at=ze===0?new Tt(0,0):ut.sub(tt)._unit()._perp(),mt=ze===_e.length-1?new Tt(0,0):et.sub(ut)._unit()._perp(),gt=at._add(mt)._unit(),Zt=gt.x*mt.x+gt.y*mt.y;Zt!==0&&gt._mult(1/Zt),Ve.push(gt._mult(ce)._add(ut))}pe.push(Ve)}return pe}(T,re*F)),function(Ae,ce,pe){for(let ye=0;ye<ce.length;ye++){const _e=ce[ye];if(Ae.length>=3){for(let Ve=0;Ve<_e.length;Ve++)if(Qf(Ae,_e[Ve]))return!0}if(z7(Ae,_e,pe))return!0}return!1}($,T,Z)}isTileClipped(){return!0}},symbol:a1,background:class extends Cs{constructor(f){super(f,o9)}},raster:class extends Cs{constructor(f){super(f,a9)}}};class u9{constructor(u){this._callback=u,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const I5=63710088e-1;class hi{constructor(u,g){if(isNaN(u)||isNaN(g))throw new Error(`Invalid LngLat object: (${u}, ${g})`);if(this.lng=+u,this.lat=+g,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new hi(U(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(u){const g=Math.PI/180,T=this.lat*g,D=u.lat*g,z=Math.sin(T)*Math.sin(D)+Math.cos(T)*Math.cos(D)*Math.cos((u.lng-this.lng)*g);return I5*Math.acos(Math.min(z,1))}toBounds(u=0){const g=360*u/40075017,T=g/Math.cos(Math.PI/180*this.lat);return new Rh(new hi(this.lng-T,this.lat-g),new hi(this.lng+T,this.lat+g))}static convert(u){if(u instanceof hi)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new hi(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&typeof u=="object"&&u!==null)return new hi(Number("lng"in u?u.lng:u.lon),Number(u.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Rh{constructor(u,g){u&&(g?this.setSouthWest(u).setNorthEast(g):u.length===4?this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]]):this.setSouthWest(u[0]).setNorthEast(u[1]))}setNorthEast(u){return this._ne=u instanceof hi?new hi(u.lng,u.lat):hi.convert(u),this}setSouthWest(u){return this._sw=u instanceof hi?new hi(u.lng,u.lat):hi.convert(u),this}extend(u){const g=this._sw,T=this._ne;let D,z;if(u instanceof hi)D=u,z=u;else{if(!(u instanceof Rh))return Array.isArray(u)?u.length===4||u.every(Array.isArray)?this.extend(Rh.convert(u)):this.extend(hi.convert(u)):this;if(D=u._sw,z=u._ne,!D||!z)return this}return g||T?(g.lng=Math.min(D.lng,g.lng),g.lat=Math.min(D.lat,g.lat),T.lng=Math.max(z.lng,T.lng),T.lat=Math.max(z.lat,T.lat)):(this._sw=new hi(D.lng,D.lat),this._ne=new hi(z.lng,z.lat)),this}getCenter(){return new hi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new hi(this.getWest(),this.getNorth())}getSouthEast(){return new hi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(u){const{lng:g,lat:T}=hi.convert(u);let D=this._sw.lng<=g&&g<=this._ne.lng;return this._sw.lng>this._ne.lng&&(D=this._sw.lng>=g&&g>=this._ne.lng),this._sw.lat<=T&&T<=this._ne.lat&&D}static convert(u){return u instanceof Rh?u:u&&new Rh(u)}}const L5=2*Math.PI*I5;function D5(f){return L5*Math.cos(f*Math.PI/180)}function R5(f){return(180+f)/360}function B5(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function z5(f,u){return f/D5(u)}function dx(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}class l1{constructor(u,g,T=0){this.x=+u,this.y=+g,this.z=+T}static fromLngLat(u,g=0){const T=hi.convert(u);return new l1(R5(T.lng),B5(T.lat),z5(g,T.lat))}toLngLat(){return new hi(360*this.x-180,dx(this.y))}toAltitude(){return this.z*D5(dx(this.y))}meterInMercatorCoordinateUnits(){return 1/L5*(u=dx(this.y),1/Math.cos(u*Math.PI/180));var u}}function O5(f,u,g){var T=2*Math.PI*6378137/256/Math.pow(2,g);return[f*T-2*Math.PI*6378137/2,u*T-2*Math.PI*6378137/2]}class px{constructor(u,g,T){if(u<0||u>25||T<0||T>=Math.pow(2,u)||g<0||g>=Math.pow(2,u))throw new Error(`x=${g}, y=${T}, z=${u} outside of bounds. 0<=x<${Math.pow(2,u)}, 0<=y<${Math.pow(2,u)} 0<=z<=25 `);this.z=u,this.x=g,this.y=T,this.key=Ap(0,u,u,g,T)}equals(u){return this.z===u.z&&this.x===u.x&&this.y===u.y}url(u,g,T){const D=(F=this.y,$=this.z,Z=O5(256*(z=this.x),256*(F=Math.pow(2,$)-F-1),$),re=O5(256*(z+1),256*(F+1),$),Z[0]+","+Z[1]+","+re[0]+","+re[1]);var z,F,$,Z,re;const Ae=function(ce,pe,ye){let _e,Ve="";for(let ze=ce;ze>0;ze--)_e=1<<ze-1,Ve+=(pe&_e?1:0)+(ye&_e?2:0);return Ve}(this.z,this.x,this.y);return u[(this.x+this.y)%u.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(T==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,g>1?"@2x":"").replace(/{quadkey}/g,Ae).replace(/{bbox-epsg-3857}/g,D)}isChildOf(u){const g=this.z-u.z;return g>0&&u.x===this.x>>g&&u.y===this.y>>g}getTilePoint(u){const g=Math.pow(2,this.z);return new Tt((u.x*g-this.x)*Bi,(u.y*g-this.y)*Bi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class F5{constructor(u,g){this.wrap=u,this.canonical=g,this.key=Ap(u,g.z,g.z,g.x,g.y)}}class Ta{constructor(u,g,T,D,z){if(u<T)throw new Error(`overscaledZ should be >= z; overscaledZ = ${u}; z = ${T}`);this.overscaledZ=u,this.wrap=g,this.canonical=new px(T,+D,+z),this.key=Ap(g,u,T,D,z)}clone(){return new Ta(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(u){return this.overscaledZ===u.overscaledZ&&this.wrap===u.wrap&&this.canonical.equals(u.canonical)}scaledTo(u){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const g=this.canonical.z-u;return u>this.canonical.z?new Ta(u,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ta(u,this.wrap,u,this.canonical.x>>g,this.canonical.y>>g)}calculateScaledKey(u,g){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const T=this.canonical.z-u;return u>this.canonical.z?Ap(this.wrap*+g,u,this.canonical.z,this.canonical.x,this.canonical.y):Ap(this.wrap*+g,u,u,this.canonical.x>>T,this.canonical.y>>T)}isChildOf(u){if(u.wrap!==this.wrap)return!1;const g=this.canonical.z-u.canonical.z;return u.overscaledZ===0||u.overscaledZ<this.overscaledZ&&u.canonical.x===this.canonical.x>>g&&u.canonical.y===this.canonical.y>>g}children(u){if(this.overscaledZ>=u)return[new Ta(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const g=this.canonical.z+1,T=2*this.canonical.x,D=2*this.canonical.y;return[new Ta(g,this.wrap,g,T,D),new Ta(g,this.wrap,g,T+1,D),new Ta(g,this.wrap,g,T,D+1),new Ta(g,this.wrap,g,T+1,D+1)]}isLessThan(u){return this.wrap<u.wrap||!(this.wrap>u.wrap)&&(this.overscaledZ<u.overscaledZ||!(this.overscaledZ>u.overscaledZ)&&(this.canonical.x<u.canonical.x||!(this.canonical.x>u.canonical.x)&&this.canonical.y<u.canonical.y))}wrapped(){return new Ta(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(u){return new Ta(this.overscaledZ,u,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new F5(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(u){return this.canonical.getTilePoint(new l1(u.x-this.wrap,u.y))}}function Ap(f,u,g,T,D){(f*=2)<0&&(f=-1*f-1);const z=1<<g;return(z*z*f+z*D+T).toString(36)+g.toString(36)+u.toString(36)}Nt("CanonicalTileID",px),Nt("OverscaledTileID",Ta,{omit:["posMatrix"]});class N5{constructor(u,g,T){if(this.uid=u,g.height!==g.width)throw new RangeError("DEM tiles must be square");if(T&&T!=="mapbox"&&T!=="terrarium")return void me(`"${T}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=g.height;const D=this.dim=g.height-2;this.data=new Uint32Array(g.data.buffer),this.encoding=T||"mapbox";for(let z=0;z<D;z++)this.data[this._idx(-1,z)]=this.data[this._idx(0,z)],this.data[this._idx(D,z)]=this.data[this._idx(D-1,z)],this.data[this._idx(z,-1)]=this.data[this._idx(z,0)],this.data[this._idx(z,D)]=this.data[this._idx(z,D-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(D,-1)]=this.data[this._idx(D-1,0)],this.data[this._idx(-1,D)]=this.data[this._idx(0,D-1)],this.data[this._idx(D,D)]=this.data[this._idx(D-1,D-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let z=0;z<D;z++)for(let F=0;F<D;F++){const $=this.get(z,F);$>this.max&&(this.max=$),$<this.min&&(this.min=$)}}get(u,g){const T=new Uint8Array(this.data.buffer),D=4*this._idx(u,g);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(T[D],T[D+1],T[D+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(u,g){if(u<-1||u>=this.dim+1||g<-1||g>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(g+1)*this.stride+(u+1)}_unpackMapbox(u,g,T){return(256*u*256+256*g+T)/10-1e4}_unpackTerrarium(u,g,T){return 256*u+g+T/256-32768}getPixels(){return new Ea({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(u,g,T){if(this.dim!==u.dim)throw new Error("dem dimension mismatch");let D=g*this.dim,z=g*this.dim+this.dim,F=T*this.dim,$=T*this.dim+this.dim;switch(g){case-1:D=z-1;break;case 1:z=D+1}switch(T){case-1:F=$-1;break;case 1:$=F+1}const Z=-g*this.dim,re=-T*this.dim;for(let Ae=F;Ae<$;Ae++)for(let ce=D;ce<z;ce++)this.data[this._idx(ce,Ae)]=u.data[this._idx(ce+Z,Ae+re)]}}Nt("DEMData",N5);class U5{constructor(u){this._stringToNumber={},this._numberToString=[];for(let g=0;g<u.length;g++){const T=u[g];this._stringToNumber[T]=g,this._numberToString[g]=T}}encode(u){return this._stringToNumber[u]}decode(u){if(u>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${u} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[u]}}class V5{constructor(u,g,T,D,z){this.type="Feature",this._vectorTileFeature=u,u._z=g,u._x=T,u._y=D,this.properties=u.properties,this.id=z}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(u){this._geometry=u}toJSON(){const u={geometry:this.geometry};for(const g in this)g!=="_geometry"&&g!=="_vectorTileFeature"&&(u[g]=this[g]);return u}}class G5{constructor(u,g){this.tileID=u,this.x=u.canonical.x,this.y=u.canonical.y,this.z=u.canonical.z,this.grid=new xa(Bi,16,0),this.grid3D=new xa(Bi,16,0),this.featureIndexArray=new O,this.promoteId=g}insert(u,g,T,D,z,F){const $=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(T,D,z);const Z=F?this.grid3D:this.grid;for(let re=0;re<g.length;re++){const Ae=g[re],ce=[1/0,1/0,-1/0,-1/0];for(let pe=0;pe<Ae.length;pe++){const ye=Ae[pe];ce[0]=Math.min(ce[0],ye.x),ce[1]=Math.min(ce[1],ye.y),ce[2]=Math.max(ce[2],ye.x),ce[3]=Math.max(ce[3],ye.y)}ce[0]<Bi&&ce[1]<Bi&&ce[2]>=0&&ce[3]>=0&&Z.insert($,ce[0],ce[1],ce[2],ce[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ic.VectorTile(new nx(this.rawTileData)).layers,this.sourceLayerCoder=new U5(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(u,g,T,D){this.loadVTLayers();const z=u.params||{},F=Bi/u.tileSize/u.scale,$=$s(z.filter),Z=u.queryGeometry,re=u.queryPadding*F,Ae=j5(Z),ce=this.grid.query(Ae.minX-re,Ae.minY-re,Ae.maxX+re,Ae.maxY+re),pe=j5(u.cameraQueryGeometry),ye=this.grid3D.query(pe.minX-re,pe.minY-re,pe.maxX+re,pe.maxY+re,(ze,tt,ut,et)=>function(at,mt,gt,Zt,tn){for(const Ut of at)if(mt<=Ut.x&&gt<=Ut.y&&Zt>=Ut.x&&tn>=Ut.y)return!0;const Ht=[new Tt(mt,gt),new Tt(mt,tn),new Tt(Zt,tn),new Tt(Zt,gt)];if(at.length>2){for(const Ut of Ht)if(Qf(at,Ut))return!0}for(let Ut=0;Ut<at.length-1;Ut++)if(F7(at[Ut],at[Ut+1],Ht))return!0;return!1}(u.cameraQueryGeometry,ze-re,tt-re,ut+re,et+re));for(const ze of ye)ce.push(ze);ce.sort(c9);const _e={};let Ve;for(let ze=0;ze<ce.length;ze++){const tt=ce[ze];if(tt===Ve)continue;Ve=tt;const ut=this.featureIndexArray.get(tt);let et=null;this.loadMatchingFeature(_e,ut.bucketIndex,ut.sourceLayerIndex,ut.featureIndex,$,z.layers,z.availableImages,g,T,D,(at,mt,gt)=>(et||(et=Ih(at)),mt.queryIntersectsFeature(Z,at,gt,et,this.z,u.transform,F,u.pixelPosMatrix)))}return _e}loadMatchingFeature(u,g,T,D,z,F,$,Z,re,Ae,ce){const pe=this.bucketLayerIDs[g];if(F&&!function(ze,tt){for(let ut=0;ut<ze.length;ut++)if(tt.indexOf(ze[ut])>=0)return!0;return!1}(F,pe))return;const ye=this.sourceLayerCoder.decode(T),_e=this.vtLayers[ye].feature(D);if(z.needGeometry){const ze=Lh(_e,!0);if(!z.filter(new Sr(this.tileID.overscaledZ),ze,this.tileID.canonical))return}else if(!z.filter(new Sr(this.tileID.overscaledZ),_e))return;const Ve=this.getId(_e,ye);for(let ze=0;ze<pe.length;ze++){const tt=pe[ze];if(F&&F.indexOf(tt)<0)continue;const ut=Z[tt];if(!ut)continue;let et={};Ve&&Ae&&(et=Ae.getState(ut.sourceLayer||"_geojsonTileLayer",Ve));const at=W({},re[tt]);at.paint=$5(at.paint,ut.paint,_e,et,$),at.layout=$5(at.layout,ut.layout,_e,et,$);const mt=!ce||ce(_e,ut,et);if(!mt)continue;const gt=new V5(_e,this.z,this.x,this.y,Ve);gt.layer=at;let Zt=u[tt];Zt===void 0&&(Zt=u[tt]=[]),Zt.push({featureIndex:D,feature:gt,intersectionZ:mt})}}lookupSymbolFeatures(u,g,T,D,z,F,$,Z){const re={};this.loadVTLayers();const Ae=$s(z);for(const ce of u)this.loadMatchingFeature(re,T,D,ce,Ae,F,$,Z,g);return re}hasLayer(u){for(const g of this.bucketLayerIDs)for(const T of g)if(u===T)return!0;return!1}getId(u,g){let T=u.id;return this.promoteId&&(T=u.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[g]],typeof T=="boolean"&&(T=Number(T))),T}}function $5(f,u,g,T,D){return X(f,(z,F)=>{const $=u instanceof Wl?u.get(F):null;return $&&$.evaluate?$.evaluate(g,T,D):$})}function j5(f){let u=1/0,g=1/0,T=-1/0,D=-1/0;for(const z of f)u=Math.min(u,z.x),g=Math.min(g,z.y),T=Math.max(T,z.x),D=Math.max(D,z.y);return{minX:u,minY:g,maxX:T,maxY:D}}function c9(f,u){return u-f}var gx;Nt("FeatureIndex",G5,{omit:["rawTileData","sourceLayerCoder"]}),o.PerformanceMarkers=void 0,(gx=o.PerformanceMarkers||(o.PerformanceMarkers={})).create="create",gx.load="load",gx.fullLoad="fullLoad";let A1=null,up=[];const mx=1e3/30,h9={mark(f){performance.mark(f)},frame(f){const u=f;A1!=null&&up.push(u-A1),A1=u},clearMetrics(){A1=null,up=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const f in o.PerformanceMarkers)performance.clearMarks(o.PerformanceMarkers[f])},getPerformanceMetrics(){performance.measure("loadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.load),performance.measure("fullLoadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.fullLoad);const f=performance.getEntriesByName("loadTime")[0].duration,u=performance.getEntriesByName("fullLoadTime")[0].duration,g=up.length,T=1/(up.reduce((z,F)=>z+F,0)/g/1e3),D=up.filter(z=>z>mx).reduce((z,F)=>z+(F-mx)/mx,0);return{loadTime:f,fullLoadTime:u,fps:T,percentDroppedFrames:D/(g+D)*100}}};o.AJAXError=nr,o.ARRAY_TYPE=Xs,o.Actor=class{constructor(f,u,g){this.target=f,this.parent=u,this.mapId=g,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ie(["receive","process"],this),this.invoker=new u9(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Qe()?f:window}send(f,u,g,T,D=!1){const z=Math.round(1e18*Math.random()).toString(36).substring(0,10);g&&(this.callbacks[z]=g);const F=Ze(this.globalScope)?void 0:[];return this.target.postMessage({id:z,type:f,hasCallback:!!g,targetMapId:T,mustQueue:D,sourceMapId:this.mapId,data:wa(u,F)},F),{cancel:()=>{g&&delete this.callbacks[z],this.target.postMessage({id:z,type:"<cancel>",targetMapId:T,sourceMapId:this.mapId})}}}receive(f){const u=f.data,g=u.id;if(g&&(!u.targetMapId||this.mapId===u.targetMapId))if(u.type==="<cancel>"){delete this.tasks[g];const T=this.cancelCallbacks[g];delete this.cancelCallbacks[g],T&&T()}else Qe()||u.mustQueue?(this.tasks[g]=u,this.taskQueue.push(g),this.invoker.trigger()):this.processTask(g,u)}process(){if(!this.taskQueue.length)return;const f=this.taskQueue.shift(),u=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),u&&this.processTask(f,u)}processTask(f,u){if(u.type==="<response>"){const g=this.callbacks[f];delete this.callbacks[f],g&&(u.error?g(Yo(u.error)):g(null,Yo(u.data)))}else{let g=!1;const T=Ze(this.globalScope)?void 0:[],D=u.hasCallback?($,Z)=>{g=!0,delete this.cancelCallbacks[f],this.target.postMessage({id:f,type:"<response>",sourceMapId:this.mapId,error:$?wa($):null,data:wa(Z,T)},T)}:$=>{g=!0};let z=null;const F=Yo(u.data);if(this.parent[u.type])z=this.parent[u.type](u.sourceMapId,F,D);else if(this.parent.getWorkerSource){const $=u.type.split(".");z=this.parent.getWorkerSource(u.sourceMapId,$[0],F.source)[$[1]](F,D)}else D(new Error(`Could not find function ${u.type}`));!g&&z&&z.cancel&&(this.cancelCallbacks[f]=z.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.AlphaImage=ep,o.CanonicalTileID=px,o.CollisionBoxArray=Ge,o.CollisionCircleLayoutArray=class extends B{},o.Color=a,o.DEMData=N5,o.DataConstantProperty=Yt,o.DictionaryCoder=U5,o.EXTENT=Bi,o.ErrorEvent=Vo,o.EvaluationParameters=Sr,o.Event=ki,o.Evented=os,o.FeatureIndex=G5,o.FillBucket=Kv,o.FillExtrusionBucket=ex,o.GeoJSONFeature=V5,o.ImageAtlas=h5,o.ImagePosition=ix,o.LineBucket=tx,o.LineStripIndexArray=class extends ve{},o.LngLat=hi,o.LngLatBounds=Rh,o.MercatorCoordinate=l1,o.ONE_EM=es,o.OverscaledTileID=Ta,o.PerformanceUtils=h9,o.PosArray=N,o.Properties=$r,o.QuadTriangleArray=class extends j{},o.RGBAImage=Ea,o.RasterBoundsArray=class extends L{},o.RequestPerformance=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return f.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),f}},o.ResourceType=xt,o.SegmentVector=pt,o.SymbolBucket=e0,o.Transitionable=bu,o.TriangleIndexArray=ot,o.Uniform1f=Tu,o.Uniform1i=class extends il{constructor(f,u){super(f,u),this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},o.Uniform2f=class extends il{constructor(f,u){super(f,u),this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}},o.Uniform3f=class extends il{constructor(f,u){super(f,u),this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}},o.Uniform4f=Hf,o.UniformColor=M4,o.UniformMatrix4f=class extends il{constructor(f,u){super(f,u),this.current=D7}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let u=1;u<16;u++)if(f[u]!==this.current[u]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}},o.UnwrappedTileID=F5,o.ValidationError=It,o.ZoomHistory=mu,o.add=function(f,u,g){return f[0]=u[0]+g[0],f[1]=u[1]+g[1],f[2]=u[2]+g[2],f},o.addDynamicAttributes=Ax,o.asyncAll=function(f,u,g){if(!f.length)return g(null,[]);let T=f.length;const D=new Array(f.length);let z=null;f.forEach((F,$)=>{u(F,(Z,re)=>{Z&&(z=Z),D[$]=re,--T==0&&g(z,D)})})},o.bezier=C,o.bindAll=ie,o.cacheEntryPossiblyAdded=function(f){or++,or>Pr&&(f.getActor().send("enforceCacheSizeLimit",Tn),or=0)},o.clamp=I,o.clearTileCache=function(f){const u=caches.delete(Et);f&&u.catch(f).then(()=>f())},o.clipLine=E5,o.clone=function(f){var u=new Xs(16);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5],u[6]=f[6],u[7]=f[7],u[8]=f[8],u[9]=f[9],u[10]=f[10],u[11]=f[11],u[12]=f[12],u[13]=f[13],u[14]=f[14],u[15]=f[15],u},o.clone$1=se,o.clone$2=function(f){var u=new Xs(3);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u},o.collisionCircleLayout=kN,o.config=_t,o.copy=function(f,u){return f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[4]=u[4],f[5]=u[5],f[6]=u[6],f[7]=u[7],f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},o.create=function(){var f=new Xs(16);return Xs!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},o.create$1=z4,o.createExpression=Za,o.createFilter=$s,o.createLayout=jr,o.createStyleLayer=function(f){return f.type==="custom"?new l9(f):new A9[f.type](f)},o.cross=function(f,u,g){var T=u[0],D=u[1],z=u[2],F=g[0],$=g[1],Z=g[2];return f[0]=D*Z-z*$,f[1]=z*F-T*Z,f[2]=T*$-D*F,f},o.dot=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]},o.dot$1=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]+f[3]*u[3]},o.ease=P,o.emitValidationErrors=el,o.enforceCacheSizeLimit=function(f){tr(),Jt&&Jt.then(u=>{u.keys().then(g=>{for(let T=0;T<g.length-f;T++)u.delete(g[T])})})},o.equals=function(f,u){var g=f[0],T=f[1],D=f[2],z=f[3],F=f[4],$=f[5],Z=f[6],re=f[7],Ae=f[8],ce=f[9],pe=f[10],ye=f[11],_e=f[12],Ve=f[13],ze=f[14],tt=f[15],ut=u[0],et=u[1],at=u[2],mt=u[3],gt=u[4],Zt=u[5],tn=u[6],Ht=u[7],Ut=u[8],Ot=u[9],Wt=u[10],$t=u[11],St=u[12],gn=u[13],ln=u[14],Hn=u[15];return Math.abs(g-ut)<=Ys*Math.max(1,Math.abs(g),Math.abs(ut))&&Math.abs(T-et)<=Ys*Math.max(1,Math.abs(T),Math.abs(et))&&Math.abs(D-at)<=Ys*Math.max(1,Math.abs(D),Math.abs(at))&&Math.abs(z-mt)<=Ys*Math.max(1,Math.abs(z),Math.abs(mt))&&Math.abs(F-gt)<=Ys*Math.max(1,Math.abs(F),Math.abs(gt))&&Math.abs($-Zt)<=Ys*Math.max(1,Math.abs($),Math.abs(Zt))&&Math.abs(Z-tn)<=Ys*Math.max(1,Math.abs(Z),Math.abs(tn))&&Math.abs(re-Ht)<=Ys*Math.max(1,Math.abs(re),Math.abs(Ht))&&Math.abs(Ae-Ut)<=Ys*Math.max(1,Math.abs(Ae),Math.abs(Ut))&&Math.abs(ce-Ot)<=Ys*Math.max(1,Math.abs(ce),Math.abs(Ot))&&Math.abs(pe-Wt)<=Ys*Math.max(1,Math.abs(pe),Math.abs(Wt))&&Math.abs(ye-$t)<=Ys*Math.max(1,Math.abs(ye),Math.abs($t))&&Math.abs(_e-St)<=Ys*Math.max(1,Math.abs(_e),Math.abs(St))&&Math.abs(Ve-gn)<=Ys*Math.max(1,Math.abs(Ve),Math.abs(gn))&&Math.abs(ze-ln)<=Ys*Math.max(1,Math.abs(ze),Math.abs(ln))&&Math.abs(tt-Hn)<=Ys*Math.max(1,Math.abs(tt),Math.abs(Hn))},o.evaluateSizeForFeature=function(f,{uSize:u,uSizeT:g},{lowerSize:T,upperSize:D}){return f.kind==="source"?T/Mu:f.kind==="composite"?en(T/Mu,D/Mu,g):u},o.evaluateSizeForZoom=function(f,u){let g=0,T=0;if(f.kind==="constant")T=f.layoutSize;else if(f.kind!=="source"){const{interpolationType:D,minZoom:z,maxZoom:F}=f,$=D?I(On.interpolationFactor(D,u,z,F),0,1):0;f.kind==="camera"?T=en(f.minSize,f.maxSize,$):g=$}return{uSizeT:g,uSize:T}},o.evaluateVariableOffset=C5,o.evented=Nr,o.exported=Kt,o.exported$1=hr,o.extend=W,o.filterObject=ee,o.fromRotation=function(f,u){var g=Math.sin(u),T=Math.cos(u);return f[0]=T,f[1]=g,f[2]=0,f[3]=-g,f[4]=T,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},o.fromScaling=function(f,u){return f[0]=u[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=u[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=u[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},o.getAnchorAlignment=ox,o.getAnchorJustification=lx,o.getArrayBuffer=rr,o.getImage=Vi,o.getJSON=function(f,u){return lr(W(f,{type:"json"}),u)},o.getOverlapMode=fx,o.getRTLTextPluginStatus=jl,o.getReferrer=Wn,o.getVideo=function(f,u){const g=window.document.createElement("video");g.muted=!0,g.onloadstart=function(){u(null,g)};for(let T=0;T<f.length;T++){const D=window.document.createElement("source");ti(f[T])||(g.crossOrigin="Anonymous"),D.src=f[T],g.appendChild(D)}return{cancel:()=>{}}},o.identity=$v,o.invert=function(f,u){var g=u[0],T=u[1],D=u[2],z=u[3],F=u[4],$=u[5],Z=u[6],re=u[7],Ae=u[8],ce=u[9],pe=u[10],ye=u[11],_e=u[12],Ve=u[13],ze=u[14],tt=u[15],ut=g*$-T*F,et=g*Z-D*F,at=g*re-z*F,mt=T*Z-D*$,gt=T*re-z*$,Zt=D*re-z*Z,tn=Ae*Ve-ce*_e,Ht=Ae*ze-pe*_e,Ut=Ae*tt-ye*_e,Ot=ce*ze-pe*Ve,Wt=ce*tt-ye*Ve,$t=pe*tt-ye*ze,St=ut*$t-et*Wt+at*Ot+mt*Ut-gt*Ht+Zt*tn;return St?(f[0]=($*$t-Z*Wt+re*Ot)*(St=1/St),f[1]=(D*Wt-T*$t-z*Ot)*St,f[2]=(Ve*Zt-ze*gt+tt*mt)*St,f[3]=(pe*gt-ce*Zt-ye*mt)*St,f[4]=(Z*Ut-F*$t-re*Ht)*St,f[5]=(g*$t-D*Ut+z*Ht)*St,f[6]=(ze*at-_e*Zt-tt*et)*St,f[7]=(Ae*Zt-pe*at+ye*et)*St,f[8]=(F*Wt-$*Ut+re*tn)*St,f[9]=(T*Ut-g*Wt-z*tn)*St,f[10]=(_e*gt-Ve*at+tt*ut)*St,f[11]=(ce*at-Ae*gt-ye*ut)*St,f[12]=($*Ht-F*Ot-Z*tn)*St,f[13]=(g*Ot-T*Ht+D*tn)*St,f[14]=(Ve*et-_e*mt-ze*ut)*St,f[15]=(Ae*mt-ce*et+pe*ut)*St,f):null},o.isImageBitmap=yt,o.isSafari=Ze,o.isWorker=Qe,o.keysDifference=function(f,u){const g=[];for(const T in f)T in u||g.push(T);return g},o.lazyLoadRTLTextPlugin=function(){fs.isLoading()||fs.isLoaded()||jl()!=="deferred"||Cc()},o.makeRequest=lr,o.mapObject=X,o.mercatorXfromLng=R5,o.mercatorYfromLat=B5,o.mercatorZfromAltitude=z5,o.mul=V7,o.mul$1=function(f,u,g){return f[0]=u[0]*g[0],f[1]=u[1]*g[1],f[2]=u[2]*g[2],f[3]=u[3]*g[3],f},o.multiply=O4,o.nextPowerOfTwo=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},o.normalize=function(f,u){var g=u[0],T=u[1],D=u[2],z=g*g+T*T+D*D;return z>0&&(z=1/Math.sqrt(z)),f[0]=u[0]*z,f[1]=u[1]*z,f[2]=u[2]*z,f},o.number=en,o.ortho=function(f,u,g,T,D,z,F){var $=1/(u-g),Z=1/(T-D),re=1/(z-F);return f[0]=-2*$,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*Z,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*re,f[11]=0,f[12]=(u+g)*$,f[13]=(D+T)*Z,f[14]=(F+z)*re,f[15]=1,f},o.parseCacheControl=Ke,o.parseGlyphPbf=function(f){return new nx(f).readFields(VN,[])},o.pbf=nx,o.performSymbolLayout=function(f){f.bucket.createArrays(),f.bucket.tilePixelRatio=Bi/(512*f.bucket.overscaling),f.bucket.compareText={},f.bucket.iconsNeedLinear=!1;const u=f.bucket.layers[0].layout,g=f.bucket.layers[0]._unevaluatedLayout._values,T={layoutIconSize:g["icon-size"].possiblyEvaluate(new Sr(f.bucket.zoom+1),f.canonical),layoutTextSize:g["text-size"].possiblyEvaluate(new Sr(f.bucket.zoom+1),f.canonical),textMaxSize:g["text-size"].possiblyEvaluate(new Sr(18))};if(f.bucket.textSizeData.kind==="composite"){const{minZoom:Z,maxZoom:re}=f.bucket.textSizeData;T.compositeTextSizes=[g["text-size"].possiblyEvaluate(new Sr(Z),f.canonical),g["text-size"].possiblyEvaluate(new Sr(re),f.canonical)]}if(f.bucket.iconSizeData.kind==="composite"){const{minZoom:Z,maxZoom:re}=f.bucket.iconSizeData;T.compositeIconSizes=[g["icon-size"].possiblyEvaluate(new Sr(Z),f.canonical),g["icon-size"].possiblyEvaluate(new Sr(re),f.canonical)]}const D=u.get("text-line-height")*es,z=u.get("text-rotation-alignment")!=="viewport"&&u.get("symbol-placement")!=="point",F=u.get("text-keep-upright"),$=u.get("text-size");for(const Z of f.bucket.features){const re=u.get("text-font").evaluate(Z,{},f.canonical).join(","),Ae=$.evaluate(Z,{},f.canonical),ce=T.layoutTextSize.evaluate(Z,{},f.canonical),pe=T.layoutIconSize.evaluate(Z,{},f.canonical),ye={horizontal:{},vertical:void 0},_e=Z.text;let Ve,ze=[0,0];if(_e){const et=_e.toString(),at=u.get("text-letter-spacing").evaluate(Z,{},f.canonical)*es,mt=$l(et)?at:0,gt=u.get("text-anchor").evaluate(Z,{},f.canonical),Zt=u.get("text-variable-anchor");if(!Zt){const Wt=u.get("text-radial-offset").evaluate(Z,{},f.canonical);ze=Wt?C5(gt,[Wt*es,ax]):u.get("text-offset").evaluate(Z,{},f.canonical).map($t=>$t*es)}let tn=z?"center":u.get("text-justify").evaluate(Z,{},f.canonical);const Ht=u.get("symbol-placement"),Ut=Ht==="point"?u.get("text-max-width").evaluate(Z,{},f.canonical)*es:0,Ot=()=>{f.bucket.allowVerticalPlacement&&LA(et)&&(ye.vertical=e1(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,gt,"left",mt,ze,o.WritingMode.vertical,!0,Ht,ce,Ae))};if(!z&&Zt){const Wt=tn==="auto"?Zt.map(St=>lx(St)):[tn];let $t=!1;for(let St=0;St<Wt.length;St++){const gn=Wt[St];if(!ye.horizontal[gn])if($t)ye.horizontal[gn]=ye.horizontal[0];else{const ln=e1(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,"center",gn,mt,ze,o.WritingMode.horizontal,!1,Ht,ce,Ae);ln&&(ye.horizontal[gn]=ln,$t=ln.positionedLines.length===1)}}Ot()}else{tn==="auto"&&(tn=lx(gt));const Wt=e1(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,gt,tn,mt,ze,o.WritingMode.horizontal,!1,Ht,ce,Ae);Wt&&(ye.horizontal[tn]=Wt),Ot(),LA(et)&&z&&F&&(ye.vertical=e1(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,gt,tn,mt,ze,o.WritingMode.vertical,!1,Ht,ce,Ae))}}let tt=!1;if(Z.icon&&Z.icon.name){const et=f.imageMap[Z.icon.name];et&&(Ve=QN(f.imagePositions[Z.icon.name],u.get("icon-offset").evaluate(Z,{},f.canonical),u.get("icon-anchor").evaluate(Z,{},f.canonical)),tt=!!et.sdf,f.bucket.sdfIcons===void 0?f.bucket.sdfIcons=tt:f.bucket.sdfIcons!==tt&&me("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(et.pixelRatio!==f.bucket.pixelRatio||u.get("icon-rotate").constantOr(1)!==0)&&(f.bucket.iconsNeedLinear=!0))}const ut=P5(ye.horizontal)||ye.vertical;f.bucket.iconsInText=!!ut&&ut.iconsInText,(ut||Ve)&&e9(f.bucket,Z,ye,Ve,f.imageMap,T,ce,pe,ze,tt,f.canonical)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()},o.perspective=function(f,u,g,T,D){var z,F=1/Math.tan(u/2);return f[0]=F/g,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=F,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,D!=null&&D!==1/0?(f[10]=(D+T)*(z=1/(T-D)),f[14]=2*D*T*z):(f[10]=-1,f[14]=-2*T),f},o.pick=function(f,u){const g={};for(let T=0;T<u.length;T++){const D=u[T];D in f&&(g[D]=f[D])}return g},o.plugin=fs,o.pointGeometry=Tt,o.polygonIntersectsPolygon=L4,o.potpack=c5,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=Nt,o.registerForPluginStateChange=function(f){return f({pluginStatus:Ri,pluginURL:Eo}),Nr.on("pluginStateChange",f),f},o.renderColorRamp=j4,o.rotateX=function(f,u,g){var T=Math.sin(g),D=Math.cos(g),z=u[4],F=u[5],$=u[6],Z=u[7],re=u[8],Ae=u[9],ce=u[10],pe=u[11];return u!==f&&(f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[4]=z*D+re*T,f[5]=F*D+Ae*T,f[6]=$*D+ce*T,f[7]=Z*D+pe*T,f[8]=re*D-z*T,f[9]=Ae*D-F*T,f[10]=ce*D-$*T,f[11]=pe*D-Z*T,f},o.rotateZ=function(f,u,g){var T=Math.sin(g),D=Math.cos(g),z=u[0],F=u[1],$=u[2],Z=u[3],re=u[4],Ae=u[5],ce=u[6],pe=u[7];return u!==f&&(f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[0]=z*D+re*T,f[1]=F*D+Ae*T,f[2]=$*D+ce*T,f[3]=Z*D+pe*T,f[4]=re*D-z*T,f[5]=Ae*D-F*T,f[6]=ce*D-$*T,f[7]=pe*D-Z*T,f},o.scale=function(f,u,g){var T=g[0],D=g[1],z=g[2];return f[0]=u[0]*T,f[1]=u[1]*T,f[2]=u[2]*T,f[3]=u[3]*T,f[4]=u[4]*D,f[5]=u[5]*D,f[6]=u[6]*D,f[7]=u[7]*D,f[8]=u[8]*z,f[9]=u[9]*z,f[10]=u[10]*z,f[11]=u[11]*z,f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},o.scale$1=function(f,u,g){return f[0]=u[0]*g,f[1]=u[1]*g,f[2]=u[2]*g,f},o.setCacheLimits=function(f,u){Tn=f,Pr=u},o.setRTLTextPlugin=function(f,u,g=!1){if(Ri===_u||Ri===vu||Ri===xu)throw new Error("setRTLTextPlugin cannot be called multiple times.");Eo=Kt.resolveURL(f),Ri=_u,Ws=u,ba(),g||Cc()},o.spec=ht,o.sphericalToCartesian=function([f,u,g]){return u+=90,u*=Math.PI/180,g*=Math.PI/180,{x:f*Math.cos(u)*Math.sin(g),y:f*Math.sin(u)*Math.sin(g),z:f*Math.cos(g)}},o.sqrLen=function(f){var u=f[0],g=f[1];return u*u+g*g},o.sub=function(f,u,g){return f[0]=u[0]-g[0],f[1]=u[1]-g[1],f[2]=u[2]-g[2],f},o.toEvaluationFeature=Lh,o.transformMat3=function(f,u,g){var T=u[0],D=u[1],z=u[2];return f[0]=T*g[0]+D*g[3]+z*g[6],f[1]=T*g[1]+D*g[4]+z*g[7],f[2]=T*g[2]+D*g[5]+z*g[8],f},o.transformMat4=Wm,o.transformMat4$1=function(f,u,g){var T=u[0],D=u[1];return f[0]=g[0]*T+g[4]*D+g[12],f[1]=g[1]*T+g[5]*D+g[13],f},o.translate=function(f,u,g){var T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ve=g[0],ze=g[1],tt=g[2];return u===f?(f[12]=u[0]*Ve+u[4]*ze+u[8]*tt+u[12],f[13]=u[1]*Ve+u[5]*ze+u[9]*tt+u[13],f[14]=u[2]*Ve+u[6]*ze+u[10]*tt+u[14],f[15]=u[3]*Ve+u[7]*ze+u[11]*tt+u[15]):(D=u[1],z=u[2],F=u[3],$=u[4],Z=u[5],re=u[6],Ae=u[7],ce=u[8],pe=u[9],ye=u[10],_e=u[11],f[0]=T=u[0],f[1]=D,f[2]=z,f[3]=F,f[4]=$,f[5]=Z,f[6]=re,f[7]=Ae,f[8]=ce,f[9]=pe,f[10]=ye,f[11]=_e,f[12]=T*Ve+$*ze+ce*tt+u[12],f[13]=D*Ve+Z*ze+pe*tt+u[13],f[14]=z*Ve+re*ze+ye*tt+u[14],f[15]=F*Ve+Ae*ze+_e*tt+u[15]),f},o.triggerPluginCompletionEvent=wu,o.unicodeBlockLookup=Vt,o.uniqueId=function(){return H++},o.validateCustomStyleLayer=function(f){const u=[],g=f.id;return g===void 0&&u.push({message:`layers.${g}: missing required property "id"`}),f.render===void 0&&u.push({message:`layers.${g}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&u.push({message:`layers.${g}: property "renderingMode" must be either "2d" or "3d"`}),u},o.validateLight=Ja,o.validateStyle=Gl,o.vectorTile=Ic,o.warnOnce=me,o.wrap=U}),s(["./shared"],function(o){function p(K){const Q=typeof K;if(Q==="number"||Q==="boolean"||Q==="string"||K==null)return JSON.stringify(K);if(Array.isArray(K)){let a="[";for(const G of K)a+=`${p(G)},`;return`${a}]`}const te=Object.keys(K).sort();let he="{";for(let a=0;a<te.length;a++)he+=`${JSON.stringify(te[a])}:${p(K[te[a]])},`;return`${he}}`}function w(K){let Q="";for(const te of o.refProperties)Q+=`/${p(K[te])}`;return Q}class C{constructor(Q){this.keyCache={},Q&&this.replace(Q)}replace(Q){this._layerConfigs={},this._layers={},this.update(Q,[])}update(Q,te){for(const a of Q){this._layerConfigs[a.id]=a;const G=this._layers[a.id]=o.createStyleLayer(a);G._featureFilter=o.createFilter(G.filter),this.keyCache[a.id]&&delete this.keyCache[a.id]}for(const a of te)delete this.keyCache[a],delete this._layerConfigs[a],delete this._layers[a];this.familiesBySource={};const he=function(a,G){const Le={};for(let Pe=0;Pe<a.length;Pe++){const Ie=G&&G[a[Pe].id]||w(a[Pe]);G&&(G[a[Pe].id]=Ie);let qe=Le[Ie];qe||(qe=Le[Ie]=[]),qe.push(a[Pe])}const ke=[];for(const Pe in Le)ke.push(Le[Pe]);return ke}(Object.values(this._layerConfigs),this.keyCache);for(const a of he){const G=a.map(At=>this._layers[At.id]),Le=G[0];if(Le.visibility==="none")continue;const ke=Le.source||"";let Pe=this.familiesBySource[ke];Pe||(Pe=this.familiesBySource[ke]={});const Ie=Le.sourceLayer||"_geojsonTileLayer";let qe=Pe[Ie];qe||(qe=Pe[Ie]=[]),qe.push(G)}}}class P{constructor(Q){const te={},he=[];for(const ke in Q){const Pe=Q[ke],Ie=te[ke]={};for(const qe in Pe){const At=Pe[+qe];if(!At||At.bitmap.width===0||At.bitmap.height===0)continue;const We={x:0,y:0,w:At.bitmap.width+2,h:At.bitmap.height+2};he.push(We),Ie[qe]={rect:We,metrics:At.metrics}}}const{w:a,h:G}=o.potpack(he),Le=new o.AlphaImage({width:a||1,height:G||1});for(const ke in Q){const Pe=Q[ke];for(const Ie in Pe){const qe=Pe[+Ie];if(!qe||qe.bitmap.width===0||qe.bitmap.height===0)continue;const At=te[ke][Ie].rect;o.AlphaImage.copy(qe.bitmap,Le,{x:0,y:0},{x:At.x+1,y:At.y+1},qe.bitmap)}}this.image=Le,this.positions=te}}o.register("GlyphAtlas",P);class I{constructor(Q){this.tileID=new o.OverscaledTileID(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),this.uid=Q.uid,this.zoom=Q.zoom,this.pixelRatio=Q.pixelRatio,this.tileSize=Q.tileSize,this.source=Q.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Q.showCollisionBoxes,this.collectResourceTiming=!!Q.collectResourceTiming,this.returnDependencies=!!Q.returnDependencies,this.promoteId=Q.promoteId}parse(Q,te,he,a,G){this.status="parsing",this.data=Q,this.collisionBoxArray=new o.CollisionBoxArray;const Le=new o.DictionaryCoder(Object.keys(Q.layers).sort()),ke=new o.FeatureIndex(this.tileID,this.promoteId);ke.bucketLayerIDs=[];const Pe={},Ie={featureIndex:ke,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:he},qe=te.familiesBySource[this.source];for(const qt in qe){const an=Q.layers[qt];if(!an)continue;an.version===1&&o.warnOnce(`Vector tile source "${this.source}" layer "${qt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xn=Le.encode(qt),Ft=[];for(let Oe=0;Oe<an.length;Oe++){const Mt=an.feature(Oe),Ce=ke.getId(Mt,qt);Ft.push({feature:Mt,id:Ce,index:Oe,sourceLayerIndex:xn})}for(const Oe of qe[qt]){const Mt=Oe[0];Mt.source!==this.source&&o.warnOnce(`layer.source = ${Mt.source} does not equal this.source = ${this.source}`),Mt.minzoom&&this.zoom<Math.floor(Mt.minzoom)||Mt.maxzoom&&this.zoom>=Mt.maxzoom||Mt.visibility!=="none"&&(U(Oe,this.zoom,he),(Pe[Mt.id]=Mt.createBucket({index:ke.bucketLayerIDs.length,layers:Oe,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xn,sourceID:this.source})).populate(Ft,Ie,this.tileID.canonical),ke.bucketLayerIDs.push(Oe.map(Ce=>Ce.id)))}}let At,We,dt,Dt;const Rt=o.mapObject(Ie.glyphDependencies,qt=>Object.keys(qt).map(Number));Object.keys(Rt).length?a.send("getGlyphs",{uid:this.uid,stacks:Rt},(qt,an)=>{At||(At=qt,We=an,pn.call(this))}):We={};const sn=Object.keys(Ie.iconDependencies);sn.length?a.send("getImages",{icons:sn,source:this.source,tileID:this.tileID,type:"icons"},(qt,an)=>{At||(At=qt,dt=an,pn.call(this))}):dt={};const jt=Object.keys(Ie.patternDependencies);function pn(){if(At)return G(At);if(We&&dt&&Dt){const qt=new P(We),an=new o.ImageAtlas(dt,Dt);for(const xn in Pe){const Ft=Pe[xn];Ft instanceof o.SymbolBucket?(U(Ft.layers,this.zoom,he),o.performSymbolLayout({bucket:Ft,glyphMap:We,glyphPositions:qt.positions,imageMap:dt,imagePositions:an.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ft.hasPattern&&(Ft instanceof o.LineBucket||Ft instanceof o.FillBucket||Ft instanceof o.FillExtrusionBucket)&&(U(Ft.layers,this.zoom,he),Ft.addFeatures(Ie,this.tileID.canonical,an.patternPositions))}this.status="done",G(null,{buckets:Object.values(Pe).filter(xn=>!xn.isEmpty()),featureIndex:ke,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:qt.image,imageAtlas:an,glyphMap:this.returnDependencies?We:null,iconMap:this.returnDependencies?dt:null,glyphPositions:this.returnDependencies?qt.positions:null})}}jt.length?a.send("getImages",{icons:jt,source:this.source,tileID:this.tileID,type:"patterns"},(qt,an)=>{At||(At=qt,Dt=an,pn.call(this))}):Dt={},pn.call(this)}}function U(K,Q,te){const he=new o.EvaluationParameters(Q);for(const a of K)a.recalculate(he,te)}function W(K,Q){const te=o.getArrayBuffer(K.request,(he,a,G,Le)=>{he?Q(he):a&&Q(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(a)),rawData:a,cacheControl:G,expires:Le})});return()=>{te.cancel(),Q()}}class H{constructor(Q,te,he,a){this.actor=Q,this.layerIndex=te,this.availableImages=he,this.loadVectorData=a||W,this.loading={},this.loaded={}}loadTile(Q,te){const he=Q.uid;this.loading||(this.loading={});const a=!!(Q&&Q.request&&Q.request.collectResourceTiming)&&new o.RequestPerformance(Q.request),G=this.loading[he]=new I(Q);G.abort=this.loadVectorData(Q,(Le,ke)=>{if(delete this.loading[he],Le||!ke)return G.status="done",this.loaded[he]=G,te(Le);const Pe=ke.rawData,Ie={};ke.expires&&(Ie.expires=ke.expires),ke.cacheControl&&(Ie.cacheControl=ke.cacheControl);const qe={};if(a){const At=a.finish();At&&(qe.resourceTiming=JSON.parse(JSON.stringify(At)))}G.vectorTile=ke.vectorTile,G.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor,(At,We)=>{if(At||!We)return te(At);te(null,o.extend({rawTileData:Pe.slice(0)},We,Ie,qe))}),this.loaded=this.loaded||{},this.loaded[he]=G})}reloadTile(Q,te){const he=this.loaded,a=Q.uid,G=this;if(he&&he[a]){const Le=he[a];Le.showCollisionBoxes=Q.showCollisionBoxes;const ke=(Pe,Ie)=>{const qe=Le.reloadCallback;qe&&(delete Le.reloadCallback,Le.parse(Le.vectorTile,G.layerIndex,this.availableImages,G.actor,qe)),te(Pe,Ie)};Le.status==="parsing"?Le.reloadCallback=ke:Le.status==="done"&&(Le.vectorTile?Le.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.actor,ke):ke())}}abortTile(Q,te){const he=this.loading,a=Q.uid;he&&he[a]&&he[a].abort&&(he[a].abort(),delete he[a]),te()}removeTile(Q,te){const he=this.loaded,a=Q.uid;he&&he[a]&&delete he[a],te()}}class ie{constructor(){this.loaded={}}loadTile(Q,te){const{uid:he,encoding:a,rawImageData:G}=Q,Le=o.isImageBitmap(G)?this.getImageData(G):G,ke=new o.DEMData(he,Le,a);this.loaded=this.loaded||{},this.loaded[he]=ke,te(null,ke)}getImageData(Q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Q.width,Q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Q.width,this.offscreenCanvas.height=Q.height,this.offscreenCanvasContext.drawImage(Q,0,0,Q.width,Q.height);const te=this.offscreenCanvasContext.getImageData(-1,-1,Q.width+2,Q.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:te.width,height:te.height},te.data)}removeTile(Q){const te=this.loaded,he=Q.uid;te&&te[he]&&delete te[he]}}var X=function K(Q,te){var he,a=Q&&Q.type;if(a==="FeatureCollection")for(he=0;he<Q.features.length;he++)K(Q.features[he],te);else if(a==="GeometryCollection")for(he=0;he<Q.geometries.length;he++)K(Q.geometries[he],te);else if(a==="Feature")K(Q.geometry,te);else if(a==="Polygon")ee(Q.coordinates,te);else if(a==="MultiPolygon")for(he=0;he<Q.coordinates.length;he++)ee(Q.coordinates[he],te);return Q};function ee(K,Q){if(K.length!==0){se(K[0],Q);for(var te=1;te<K.length;te++)se(K[te],!Q)}}function se(K,Q){for(var te=0,he=0,a=0,G=K.length,Le=G-1;a<G;Le=a++){var ke=(K[a][0]-K[Le][0])*(K[Le][1]+K[a][1]),Pe=te+ke;he+=Math.abs(te)>=Math.abs(ke)?te-Pe+ke:ke-Pe+te,te=Pe}te+he>=0!=!!Q&&K.reverse()}const fe=o.vectorTile.VectorTileFeature.prototype.toGeoJSON;class me{constructor(Q){this._feature=Q,this.extent=o.EXTENT,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(this._feature.type===1){const Q=[];for(const te of this._feature.geometry)Q.push([new o.pointGeometry(te[0],te[1])]);return Q}{const Q=[];for(const te of this._feature.geometry){const he=[];for(const a of te)he.push(new o.pointGeometry(a[0],a[1]));Q.push(he)}return Q}}toGeoJSON(Q,te,he){return fe.call(this,Q,te,he)}}class Se{constructor(Q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=Q.length,this._features=Q}feature(Q){return new me(this._features[Q])}}var He={exports:{}},Qe=o.pointGeometry,Ke=o.vectorTile.VectorTileFeature,rt=Ue;function Ue(K,Q){this.options=Q||{},this.features=K,this.length=K.length}function it(K,Q){this.id=typeof K.id=="number"?K.id:void 0,this.type=K.type,this.rawGeometry=K.type===1?[K.geometry]:K.geometry,this.properties=K.tags,this.extent=Q||4096}Ue.prototype.feature=function(K){return new it(this.features[K],this.options.extent)},it.prototype.loadGeometry=function(){var K=this.rawGeometry;this.geometry=[];for(var Q=0;Q<K.length;Q++){for(var te=K[Q],he=[],a=0;a<te.length;a++)he.push(new Qe(te[a][0],te[a][1]));this.geometry.push(he)}return this.geometry},it.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var K=this.geometry,Q=1/0,te=-1/0,he=1/0,a=-1/0,G=0;G<K.length;G++)for(var Le=K[G],ke=0;ke<Le.length;ke++){var Pe=Le[ke];Q=Math.min(Q,Pe.x),te=Math.max(te,Pe.x),he=Math.min(he,Pe.y),a=Math.max(a,Pe.y)}return[Q,he,te,a]},it.prototype.toGeoJSON=Ke.prototype.toGeoJSON;var Ze=o.pbf,yt=rt;function Kt(K){var Q=new Ze;return function(te,he){for(var a in te.layers)he.writeMessage(3,Tt,te.layers[a])}(K,Q),Q.finish()}function Tt(K,Q){var te;Q.writeVarintField(15,K.version||1),Q.writeStringField(1,K.name||""),Q.writeVarintField(5,K.extent||4096);var he={keys:[],values:[],keycache:{},valuecache:{}};for(te=0;te<K.length;te++)he.feature=K.feature(te),Q.writeMessage(2,dn,he);var a=he.keys;for(te=0;te<a.length;te++)Q.writeStringField(3,a[te]);var G=he.values;for(te=0;te<G.length;te++)Q.writeMessage(4,Tn,G[te])}function dn(K,Q){var te=K.feature;te.id!==void 0&&Q.writeVarintField(1,te.id),Q.writeMessage(2,_t,K),Q.writeVarintField(3,te.type),Q.writeMessage(4,In,te)}function _t(K,Q){var te=K.feature,he=K.keys,a=K.values,G=K.keycache,Le=K.valuecache;for(var ke in te.properties){var Pe=te.properties[ke],Ie=G[ke];if(Pe!==null){Ie===void 0&&(he.push(ke),G[ke]=Ie=he.length-1),Q.writeVarint(Ie);var qe=typeof Pe;qe!=="string"&&qe!=="boolean"&&qe!=="number"&&(Pe=JSON.stringify(Pe));var At=qe+":"+Pe,We=Le[At];We===void 0&&(a.push(Pe),Le[At]=We=a.length-1),Q.writeVarint(We)}}}function Et(K,Q){return(Q<<3)+(7&K)}function Jt(K){return K<<1^K>>31}function In(K,Q){for(var te=K.loadGeometry(),he=K.type,a=0,G=0,Le=te.length,ke=0;ke<Le;ke++){var Pe=te[ke],Ie=1;he===1&&(Ie=Pe.length),Q.writeVarint(Et(1,Ie));for(var qe=he===3?Pe.length-1:Pe.length,At=0;At<qe;At++){At===1&&he!==1&&Q.writeVarint(Et(2,qe-1));var We=Pe[At].x-a,dt=Pe[At].y-G;Q.writeVarint(Jt(We)),Q.writeVarint(Jt(dt)),a+=We,G+=dt}he===3&&Q.writeVarint(Et(7,1))}}function Tn(K,Q){var te=typeof K;te==="string"?Q.writeStringField(1,K):te==="boolean"?Q.writeBooleanField(7,K):te==="number"&&(K%1!=0?Q.writeDoubleField(3,K):K<0?Q.writeSVarintField(6,K):Q.writeVarintField(5,K))}function Pr(K,Q,te,he,a,G){if(a-he<=te)return;const Le=he+a>>1;tr(K,Q,Le,he,a,G%2),Pr(K,Q,te,he,Le-1,G+1),Pr(K,Q,te,Le+1,a,G+1)}function tr(K,Q,te,he,a,G){for(;a>he;){if(a-he>600){const Ie=a-he+1,qe=te-he+1,At=Math.log(Ie),We=.5*Math.exp(2*At/3),dt=.5*Math.sqrt(At*We*(Ie-We)/Ie)*(qe-Ie/2<0?-1:1);tr(K,Q,te,Math.max(he,Math.floor(te-qe*We/Ie+dt)),Math.min(a,Math.floor(te+(Ie-qe)*We/Ie+dt)),G)}const Le=Q[2*te+G];let ke=he,Pe=a;for(or(K,Q,he,te),Q[2*a+G]>Le&&or(K,Q,he,a);ke<Pe;){for(or(K,Q,ke,Pe),ke++,Pe--;Q[2*ke+G]<Le;)ke++;for(;Q[2*Pe+G]>Le;)Pe--}Q[2*he+G]===Le?or(K,Q,he,Pe):(Pe++,or(K,Q,Pe,a)),Pe<=te&&(he=Pe+1),te<=Pe&&(a=Pe-1)}}function or(K,Q,te,he){hr(K,te,he),hr(Q,2*te,2*he),hr(Q,2*te+1,2*he+1)}function hr(K,Q,te){const he=K[Q];K[Q]=K[te],K[te]=he}function Vn(K,Q,te,he){const a=K-te,G=Q-he;return a*a+G*G}He.exports=Kt,He.exports.fromVectorTileJs=Kt,He.exports.fromGeojsonVt=function(K,Q){Q=Q||{};var te={};for(var he in K)te[he]=new yt(K[he].features,Q),te[he].name=he,te[he].version=Q.version,te[he].extent=Q.extent;return Kt({layers:te})},He.exports.GeoJSONWrapper=yt;const Tr=K=>K[0],wt=K=>K[1];class rn{constructor(Q,te=Tr,he=wt,a=64,G=Float64Array){this.nodeSize=a,this.points=Q;const Le=Q.length<65536?Uint16Array:Uint32Array,ke=this.ids=new Le(Q.length),Pe=this.coords=new G(2*Q.length);for(let Ie=0;Ie<Q.length;Ie++)ke[Ie]=Ie,Pe[2*Ie]=te(Q[Ie]),Pe[2*Ie+1]=he(Q[Ie]);Pr(ke,Pe,a,0,ke.length-1,0)}range(Q,te,he,a){return function(G,Le,ke,Pe,Ie,qe,At){const We=[0,G.length-1,0],dt=[];let Dt,Rt;for(;We.length;){const sn=We.pop(),jt=We.pop(),pn=We.pop();if(jt-pn<=At){for(let xn=pn;xn<=jt;xn++)Dt=Le[2*xn],Rt=Le[2*xn+1],Dt>=ke&&Dt<=Ie&&Rt>=Pe&&Rt<=qe&&dt.push(G[xn]);continue}const qt=Math.floor((pn+jt)/2);Dt=Le[2*qt],Rt=Le[2*qt+1],Dt>=ke&&Dt<=Ie&&Rt>=Pe&&Rt<=qe&&dt.push(G[qt]);const an=(sn+1)%2;(sn===0?ke<=Dt:Pe<=Rt)&&(We.push(pn),We.push(qt-1),We.push(an)),(sn===0?Ie>=Dt:qe>=Rt)&&(We.push(qt+1),We.push(jt),We.push(an))}return dt}(this.ids,this.coords,Q,te,he,a,this.nodeSize)}within(Q,te,he){return function(a,G,Le,ke,Pe,Ie){const qe=[0,a.length-1,0],At=[],We=Pe*Pe;for(;qe.length;){const dt=qe.pop(),Dt=qe.pop(),Rt=qe.pop();if(Dt-Rt<=Ie){for(let an=Rt;an<=Dt;an++)Vn(G[2*an],G[2*an+1],Le,ke)<=We&&At.push(a[an]);continue}const sn=Math.floor((Rt+Dt)/2),jt=G[2*sn],pn=G[2*sn+1];Vn(jt,pn,Le,ke)<=We&&At.push(a[sn]);const qt=(dt+1)%2;(dt===0?Le-Pe<=jt:ke-Pe<=pn)&&(qe.push(Rt),qe.push(sn-1),qe.push(qt)),(dt===0?Le+Pe>=jt:ke+Pe>=pn)&&(qe.push(sn+1),qe.push(Dt),qe.push(qt))}return At}(this.ids,this.coords,Q,te,he,this.nodeSize)}}const Mn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:K=>K},xt=Math.fround||(nr=new Float32Array(1),K=>(nr[0]=+K,nr[0]));var nr;class Wn{constructor(Q){this.options=Vi(Object.create(Mn),Q),this.trees=new Array(this.options.maxZoom+1)}load(Q){const{log:te,minZoom:he,maxZoom:a,nodeSize:G}=this.options;te&&console.time("total time");const Le=`prepare ${Q.length} points`;te&&console.time(Le),this.points=Q;let ke=[];for(let Pe=0;Pe<Q.length;Pe++)Q[Pe].geometry&&ke.push(lr(Q[Pe],Pe));this.trees[a+1]=new rn(ke,mo,Gr,G,Float32Array),te&&console.timeEnd(Le);for(let Pe=a;Pe>=he;Pe--){const Ie=+Date.now();ke=this._cluster(ke,Pe),this.trees[Pe]=new rn(ke,mo,Gr,G,Float32Array),te&&console.log("z%d: %d clusters in %dms",Pe,ke.length,+Date.now()-Ie)}return te&&console.timeEnd("total time"),this}getClusters(Q,te){let he=((Q[0]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,Q[1]));let G=Q[2]===180?180:((Q[2]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)he=-180,G=180;else if(he>G){const qe=this.getClusters([he,a,180,Le],te),At=this.getClusters([-180,a,G,Le],te);return qe.concat(At)}const ke=this.trees[this._limitZoom(te)],Pe=ke.range(Gn(he),Pi(Le),Gn(G),Pi(a)),Ie=[];for(const qe of Pe){const At=ke.points[qe];Ie.push(At.numPoints?rr(At):this.points[At.index])}return Ie}getChildren(Q){const te=this._getOriginId(Q),he=this._getOriginZoom(Q),a="No cluster with the specified id.",G=this.trees[he];if(!G)throw new Error(a);const Le=G.points[te];if(!Le)throw new Error(a);const ke=this.options.radius/(this.options.extent*Math.pow(2,he-1)),Pe=G.within(Le.x,Le.y,ke),Ie=[];for(const qe of Pe){const At=G.points[qe];At.parentId===Q&&Ie.push(At.numPoints?rr(At):this.points[At.index])}if(Ie.length===0)throw new Error(a);return Ie}getLeaves(Q,te,he){const a=[];return this._appendLeaves(a,Q,te=te||10,he=he||0,0),a}getTile(Q,te,he){const a=this.trees[this._limitZoom(Q)],G=Math.pow(2,Q),{extent:Le,radius:ke}=this.options,Pe=ke/Le,Ie=(he-Pe)/G,qe=(he+1+Pe)/G,At={features:[]};return this._addTileFeatures(a.range((te-Pe)/G,Ie,(te+1+Pe)/G,qe),a.points,te,he,G,At),te===0&&this._addTileFeatures(a.range(1-Pe/G,Ie,1,qe),a.points,G,he,G,At),te===G-1&&this._addTileFeatures(a.range(0,Ie,Pe/G,qe),a.points,-1,he,G,At),At.features.length?At:null}getClusterExpansionZoom(Q){let te=this._getOriginZoom(Q)-1;for(;te<=this.options.maxZoom;){const he=this.getChildren(Q);if(te++,he.length!==1)break;Q=he[0].properties.cluster_id}return te}_appendLeaves(Q,te,he,a,G){const Le=this.getChildren(te);for(const ke of Le){const Pe=ke.properties;if(Pe&&Pe.cluster?G+Pe.point_count<=a?G+=Pe.point_count:G=this._appendLeaves(Q,Pe.cluster_id,he,a,G):G<a?G++:Q.push(ke),Q.length===he)break}return G}_addTileFeatures(Q,te,he,a,G,Le){for(const ke of Q){const Pe=te[ke],Ie=Pe.numPoints;let qe,At,We;if(Ie)qe=ti(Pe),At=Pe.x,We=Pe.y;else{const Rt=this.points[Pe.index];qe=Rt.properties,At=Gn(Rt.geometry.coordinates[0]),We=Pi(Rt.geometry.coordinates[1])}const dt={type:1,geometry:[[Math.round(this.options.extent*(At*G-he)),Math.round(this.options.extent*(We*G-a))]],tags:qe};let Dt;Ie?Dt=Pe.id:this.options.generateId?Dt=Pe.index:this.points[Pe.index].id&&(Dt=this.points[Pe.index].id),Dt!==void 0&&(dt.id=Dt),Le.features.push(dt)}}_limitZoom(Q){return Math.max(this.options.minZoom,Math.min(Math.floor(+Q),this.options.maxZoom+1))}_cluster(Q,te){const he=[],{radius:a,extent:G,reduce:Le,minPoints:ke}=this.options,Pe=a/(G*Math.pow(2,te));for(let Ie=0;Ie<Q.length;Ie++){const qe=Q[Ie];if(qe.zoom<=te)continue;qe.zoom=te;const At=this.trees[te+1],We=At.within(qe.x,qe.y,Pe),dt=qe.numPoints||1;let Dt=dt;for(const Rt of We){const sn=At.points[Rt];sn.zoom>te&&(Dt+=sn.numPoints||1)}if(Dt>dt&&Dt>=ke){let Rt=qe.x*dt,sn=qe.y*dt,jt=Le&&dt>1?this._map(qe,!0):null;const pn=(Ie<<5)+(te+1)+this.points.length;for(const qt of We){const an=At.points[qt];if(an.zoom<=te)continue;an.zoom=te;const xn=an.numPoints||1;Rt+=an.x*xn,sn+=an.y*xn,an.parentId=pn,Le&&(jt||(jt=this._map(qe,!0)),Le(jt,this._map(an)))}qe.parentId=pn,he.push(vr(Rt/Dt,sn/Dt,pn,Dt,jt))}else if(he.push(qe),Dt>1)for(const Rt of We){const sn=At.points[Rt];sn.zoom<=te||(sn.zoom=te,he.push(sn))}}return he}_getOriginId(Q){return Q-this.points.length>>5}_getOriginZoom(Q){return(Q-this.points.length)%32}_map(Q,te){if(Q.numPoints)return te?Vi({},Q.properties):Q.properties;const he=this.points[Q.index].properties,a=this.options.map(he);return te&&a===he?Vi({},a):a}}function vr(K,Q,te,he,a){return{x:xt(K),y:xt(Q),zoom:1/0,id:te,parentId:-1,numPoints:he,properties:a}}function lr(K,Q){const[te,he]=K.geometry.coordinates;return{x:xt(Gn(te)),y:xt(Pi(he)),zoom:1/0,index:Q,parentId:-1}}function rr(K){return{type:"Feature",id:K.id,properties:ti(K),geometry:{type:"Point",coordinates:[(Q=K.x,360*(Q-.5)),qn(K.y)]}};var Q}function ti(K){const Q=K.numPoints,te=Q>=1e4?`${Math.round(Q/1e3)}k`:Q>=1e3?Math.round(Q/100)/10+"k":Q;return Vi(Vi({},K.properties),{cluster:!0,cluster_id:K.id,point_count:Q,point_count_abbreviated:te})}function Gn(K){return K/360+.5}function Pi(K){const Q=Math.sin(K*Math.PI/180),te=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return te<0?0:te>1?1:te}function qn(K){const Q=(180-360*K)*Math.PI/180;return 360*Math.atan(Math.exp(Q))/Math.PI-90}function Vi(K,Q){for(const te in Q)K[te]=Q[te];return K}function mo(K){return K.x}function Gr(K){return K.y}function ki(K,Q,te,he){for(var a,G=he,Le=te-Q>>1,ke=te-Q,Pe=K[Q],Ie=K[Q+1],qe=K[te],At=K[te+1],We=Q+3;We<te;We+=3){var dt=Vo(K[We],K[We+1],Pe,Ie,qe,At);if(dt>G)a=We,G=dt;else if(dt===G){var Dt=Math.abs(We-Le);Dt<ke&&(a=We,ke=Dt)}}G>he&&(a-Q>3&&ki(K,Q,a,he),K[a+2]=G,te-a>3&&ki(K,a,te,he))}function Vo(K,Q,te,he,a,G){var Le=a-te,ke=G-he;if(Le!==0||ke!==0){var Pe=((K-te)*Le+(Q-he)*ke)/(Le*Le+ke*ke);Pe>1?(te=a,he=G):Pe>0&&(te+=Le*Pe,he+=ke*Pe)}return(Le=K-te)*Le+(ke=Q-he)*ke}function os(K,Q,te,he){var a={id:K===void 0?null:K,type:Q,geometry:te,tags:he,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(G){var Le=G.geometry,ke=G.type;if(ke==="Point"||ke==="MultiPoint"||ke==="LineString")ht(G,Le);else if(ke==="Polygon"||ke==="MultiLineString")for(var Pe=0;Pe<Le.length;Pe++)ht(G,Le[Pe]);else if(ke==="MultiPolygon")for(Pe=0;Pe<Le.length;Pe++)for(var Ie=0;Ie<Le[Pe].length;Ie++)ht(G,Le[Pe][Ie])}(a),a}function ht(K,Q){for(var te=0;te<Q.length;te+=3)K.minX=Math.min(K.minX,Q[te]),K.minY=Math.min(K.minY,Q[te+1]),K.maxX=Math.max(K.maxX,Q[te]),K.maxY=Math.max(K.maxY,Q[te+1])}function It(K,Q,te,he){if(Q.geometry){var a=Q.geometry.coordinates,G=Q.geometry.type,Le=Math.pow(te.tolerance/((1<<te.maxZoom)*te.extent),2),ke=[],Pe=Q.id;if(te.promoteId?Pe=Q.properties[te.promoteId]:te.generateId&&(Pe=he||0),G==="Point")Fs(a,ke);else if(G==="MultiPoint")for(var Ie=0;Ie<a.length;Ie++)Fs(a[Ie],ke);else if(G==="LineString")wi(a,ke,Le,!1);else if(G==="MultiLineString"){if(te.lineMetrics){for(Ie=0;Ie<a.length;Ie++)wi(a[Ie],ke=[],Le,!1),K.push(os(Pe,"LineString",ke,Q.properties));return}zn(a,ke,Le,!1)}else if(G==="Polygon")zn(a,ke,Le,!0);else{if(G!=="MultiPolygon"){if(G==="GeometryCollection"){for(Ie=0;Ie<Q.geometry.geometries.length;Ie++)It(K,{id:Pe,geometry:Q.geometry.geometries[Ie],properties:Q.properties},te,he);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ie=0;Ie<a.length;Ie++){var qe=[];zn(a[Ie],qe,Le,!0),ke.push(qe)}}K.push(os(Pe,G,ke,Q.properties))}}function Fs(K,Q){Q.push(Gi(K[0])),Q.push(Ii(K[1])),Q.push(0)}function wi(K,Q,te,he){for(var a,G,Le=0,ke=0;ke<K.length;ke++){var Pe=Gi(K[ke][0]),Ie=Ii(K[ke][1]);Q.push(Pe),Q.push(Ie),Q.push(0),ke>0&&(Le+=he?(a*Ie-Pe*G)/2:Math.sqrt(Math.pow(Pe-a,2)+Math.pow(Ie-G,2))),a=Pe,G=Ie}var qe=Q.length-3;Q[2]=1,ki(Q,0,qe,te),Q[qe+2]=1,Q.size=Math.abs(Le),Q.start=0,Q.end=Q.size}function zn(K,Q,te,he){for(var a=0;a<K.length;a++){var G=[];wi(K[a],G,te,he),Q.push(G)}}function Gi(K){return K/360+.5}function Ii(K){var Q=Math.sin(K*Math.PI/180),te=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return te<0?0:te>1?1:te}function Li(K,Q,te,he,a,G,Le,ke){if(he/=Q,G>=(te/=Q)&&Le<he)return K;if(Le<te||G>=he)return null;for(var Pe=[],Ie=0;Ie<K.length;Ie++){var qe=K[Ie],At=qe.geometry,We=qe.type,dt=a===0?qe.minX:qe.minY,Dt=a===0?qe.maxX:qe.maxY;if(dt>=te&&Dt<he)Pe.push(qe);else if(!(Dt<te||dt>=he)){var Rt=[];if(We==="Point"||We==="MultiPoint")as(At,Rt,te,he,a);else if(We==="LineString")Lt(At,Rt,te,he,a,!1,ke.lineMetrics);else if(We==="MultiLineString")bn(At,Rt,te,he,a,!1);else if(We==="Polygon")bn(At,Rt,te,he,a,!0);else if(We==="MultiPolygon")for(var sn=0;sn<At.length;sn++){var jt=[];bn(At[sn],jt,te,he,a,!0),jt.length&&Rt.push(jt)}if(Rt.length){if(ke.lineMetrics&&We==="LineString"){for(sn=0;sn<Rt.length;sn++)Pe.push(os(qe.id,We,Rt[sn],qe.tags));continue}We!=="LineString"&&We!=="MultiLineString"||(Rt.length===1?(We="LineString",Rt=Rt[0]):We="MultiLineString"),We!=="Point"&&We!=="MultiPoint"||(We=Rt.length===3?"Point":"MultiPoint"),Pe.push(os(qe.id,We,Rt,qe.tags))}}}return Pe.length?Pe:null}function as(K,Q,te,he,a){for(var G=0;G<K.length;G+=3){var Le=K[G+a];Le>=te&&Le<=he&&(Q.push(K[G]),Q.push(K[G+1]),Q.push(K[G+2]))}}function Lt(K,Q,te,he,a,G,Le){for(var ke,Pe,Ie=Sn(K),qe=a===0?bs:yn,At=K.start,We=0;We<K.length-3;We+=3){var dt=K[We],Dt=K[We+1],Rt=K[We+2],sn=K[We+3],jt=K[We+4],pn=a===0?dt:Dt,qt=a===0?sn:jt,an=!1;Le&&(ke=Math.sqrt(Math.pow(dt-sn,2)+Math.pow(Dt-jt,2))),pn<te?qt>te&&(Pe=qe(Ie,dt,Dt,sn,jt,te),Le&&(Ie.start=At+ke*Pe)):pn>he?qt<he&&(Pe=qe(Ie,dt,Dt,sn,jt,he),Le&&(Ie.start=At+ke*Pe)):Lr(Ie,dt,Dt,Rt),qt<te&&pn>=te&&(Pe=qe(Ie,dt,Dt,sn,jt,te),an=!0),qt>he&&pn<=he&&(Pe=qe(Ie,dt,Dt,sn,jt,he),an=!0),!G&&an&&(Le&&(Ie.end=At+ke*Pe),Q.push(Ie),Ie=Sn(K)),Le&&(At+=ke)}var xn=K.length-3;dt=K[xn],Dt=K[xn+1],Rt=K[xn+2],(pn=a===0?dt:Dt)>=te&&pn<=he&&Lr(Ie,dt,Dt,Rt),xn=Ie.length-3,G&&xn>=3&&(Ie[xn]!==Ie[0]||Ie[xn+1]!==Ie[1])&&Lr(Ie,Ie[0],Ie[1],Ie[2]),Ie.length&&Q.push(Ie)}function Sn(K){var Q=[];return Q.size=K.size,Q.start=K.start,Q.end=K.end,Q}function bn(K,Q,te,he,a,G){for(var Le=0;Le<K.length;Le++)Lt(K[Le],Q,te,he,a,G,!1)}function Lr(K,Q,te,he){K.push(Q),K.push(te),K.push(he)}function bs(K,Q,te,he,a,G){var Le=(G-Q)/(he-Q);return K.push(G),K.push(te+(a-te)*Le),K.push(1),Le}function yn(K,Q,te,he,a,G){var Le=(G-te)/(a-te);return K.push(Q+(he-Q)*Le),K.push(G),K.push(1),Le}function Ye(K,Q){for(var te=[],he=0;he<K.length;he++){var a,G=K[he],Le=G.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")a=Qr(G.geometry,Q);else if(Le==="MultiLineString"||Le==="Polygon"){a=[];for(var ke=0;ke<G.geometry.length;ke++)a.push(Qr(G.geometry[ke],Q))}else if(Le==="MultiPolygon")for(a=[],ke=0;ke<G.geometry.length;ke++){for(var Pe=[],Ie=0;Ie<G.geometry[ke].length;Ie++)Pe.push(Qr(G.geometry[ke][Ie],Q));a.push(Pe)}te.push(os(G.id,Le,a,G.tags))}return te}function Qr(K,Q){var te=[];te.size=K.size,K.start!==void 0&&(te.start=K.start,te.end=K.end);for(var he=0;he<K.length;he+=3)te.push(K[he]+Q,K[he+1],K[he+2]);return te}function Ns(K,Q){if(K.transformed)return K;var te,he,a,G=1<<K.z,Le=K.x,ke=K.y;for(te=0;te<K.features.length;te++){var Pe=K.features[te],Ie=Pe.geometry,qe=Pe.type;if(Pe.geometry=[],qe===1)for(he=0;he<Ie.length;he+=2)Pe.geometry.push(Or(Ie[he],Ie[he+1],Q,G,Le,ke));else for(he=0;he<Ie.length;he++){var At=[];for(a=0;a<Ie[he].length;a+=2)At.push(Or(Ie[he][a],Ie[he][a+1],Q,G,Le,ke));Pe.geometry.push(At)}}return K.transformed=!0,K}function Or(K,Q,te,he,a,G){return[Math.round(te*(K*he-a)),Math.round(te*(Q*he-G))]}function Ai(K,Q,te,he,a){for(var G=Q===a.maxZoom?0:a.tolerance/((1<<Q)*a.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:te,y:he,z:Q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ke=0;ke<K.length;ke++){Le.numFeatures++,Xn(Le,K[ke],G,a);var Pe=K[ke].minX,Ie=K[ke].minY,qe=K[ke].maxX,At=K[ke].maxY;Pe<Le.minX&&(Le.minX=Pe),Ie<Le.minY&&(Le.minY=Ie),qe>Le.maxX&&(Le.maxX=qe),At>Le.maxY&&(Le.maxY=At)}return Le}function Xn(K,Q,te,he){var a=Q.geometry,G=Q.type,Le=[];if(G==="Point"||G==="MultiPoint")for(var ke=0;ke<a.length;ke+=3)Le.push(a[ke]),Le.push(a[ke+1]),K.numPoints++,K.numSimplified++;else if(G==="LineString")Us(Le,a,K,te,!1,!1);else if(G==="MultiLineString"||G==="Polygon")for(ke=0;ke<a.length;ke++)Us(Le,a[ke],K,te,G==="Polygon",ke===0);else if(G==="MultiPolygon")for(var Pe=0;Pe<a.length;Pe++){var Ie=a[Pe];for(ke=0;ke<Ie.length;ke++)Us(Le,Ie[ke],K,te,!0,ke===0)}if(Le.length){var qe=Q.tags||null;if(G==="LineString"&&he.lineMetrics){for(var At in qe={},Q.tags)qe[At]=Q.tags[At];qe.mapbox_clip_start=a.start/a.size,qe.mapbox_clip_end=a.end/a.size}var We={geometry:Le,type:G==="Polygon"||G==="MultiPolygon"?3:G==="LineString"||G==="MultiLineString"?2:1,tags:qe};Q.id!==null&&(We.id=Q.id),K.features.push(We)}}function Us(K,Q,te,he,a,G){var Le=he*he;if(he>0&&Q.size<(a?Le:he))te.numPoints+=Q.length/3;else{for(var ke=[],Pe=0;Pe<Q.length;Pe+=3)(he===0||Q[Pe+2]>Le)&&(te.numSimplified++,ke.push(Q[Pe]),ke.push(Q[Pe+1])),te.numPoints++;a&&function(Ie,qe){for(var At=0,We=0,dt=Ie.length,Dt=dt-2;We<dt;Dt=We,We+=2)At+=(Ie[We]-Ie[Dt])*(Ie[We+1]+Ie[Dt+1]);if(At>0===qe)for(We=0,dt=Ie.length;We<dt/2;We+=2){var Rt=Ie[We],sn=Ie[We+1];Ie[We]=Ie[dt-2-We],Ie[We+1]=Ie[dt-1-We],Ie[dt-2-We]=Rt,Ie[dt-1-We]=sn}}(ke,G),K.push(ke)}}function $i(K,Q){var te=(Q=this.options=function(a,G){for(var Le in G)a[Le]=G[Le];return a}(Object.create(this.options),Q)).debug;if(te&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");var he=function(a,G){var Le=[];if(a.type==="FeatureCollection")for(var ke=0;ke<a.features.length;ke++)It(Le,a.features[ke],G,ke);else It(Le,a.type==="Feature"?a:{geometry:a},G);return Le}(K,Q);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),he=function(a,G){var Le=G.buffer/G.extent,ke=a,Pe=Li(a,1,-1-Le,Le,0,-1,2,G),Ie=Li(a,1,1-Le,2+Le,0,-1,2,G);return(Pe||Ie)&&(ke=Li(a,1,-Le,1+Le,0,-1,2,G)||[],Pe&&(ke=Ye(Pe,1).concat(ke)),Ie&&(ke=ke.concat(Ye(Ie,-1)))),ke}(he,Q),he.length&&this.splitTile(he,0,0,0),te&&(he.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ji(K,Q,te){return 32*((1<<K)*te+Q)+K}function Di(K,Q){const te=K.tileID.canonical;if(!this._geoJSONIndex)return Q(null,null);const he=this._geoJSONIndex.getTile(te.z,te.x,te.y);if(!he)return Q(null,null);const a=new Se(he.features);let G=He.exports(a);G.byteOffset===0&&G.byteLength===G.buffer.byteLength||(G=new Uint8Array(G)),Q(null,{vectorTile:a,rawData:G.buffer})}$i.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},$i.prototype.splitTile=function(K,Q,te,he,a,G,Le){for(var ke=[K,Q,te,he],Pe=this.options,Ie=Pe.debug;ke.length;){he=ke.pop(),te=ke.pop(),Q=ke.pop(),K=ke.pop();var qe=1<<Q,At=ji(Q,te,he),We=this.tiles[At];if(!We&&(Ie>1&&console.time("creation"),We=this.tiles[At]=Ai(K,Q,te,he,Pe),this.tileCoords.push({z:Q,x:te,y:he}),Ie)){Ie>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,te,he,We.numFeatures,We.numPoints,We.numSimplified),console.timeEnd("creation"));var dt="z"+Q;this.stats[dt]=(this.stats[dt]||0)+1,this.total++}if(We.source=K,a){if(Q===Pe.maxZoom||Q===a)continue;var Dt=1<<a-Q;if(te!==Math.floor(G/Dt)||he!==Math.floor(Le/Dt))continue}else if(Q===Pe.indexMaxZoom||We.numPoints<=Pe.indexMaxPoints)continue;if(We.source=null,K.length!==0){Ie>1&&console.time("clipping");var Rt,sn,jt,pn,qt,an,xn=.5*Pe.buffer/Pe.extent,Ft=.5-xn,Oe=.5+xn,Mt=1+xn;Rt=sn=jt=pn=null,qt=Li(K,qe,te-xn,te+Oe,0,We.minX,We.maxX,Pe),an=Li(K,qe,te+Ft,te+Mt,0,We.minX,We.maxX,Pe),K=null,qt&&(Rt=Li(qt,qe,he-xn,he+Oe,1,We.minY,We.maxY,Pe),sn=Li(qt,qe,he+Ft,he+Mt,1,We.minY,We.maxY,Pe),qt=null),an&&(jt=Li(an,qe,he-xn,he+Oe,1,We.minY,We.maxY,Pe),pn=Li(an,qe,he+Ft,he+Mt,1,We.minY,We.maxY,Pe),an=null),Ie>1&&console.timeEnd("clipping"),ke.push(Rt||[],Q+1,2*te,2*he),ke.push(sn||[],Q+1,2*te,2*he+1),ke.push(jt||[],Q+1,2*te+1,2*he),ke.push(pn||[],Q+1,2*te+1,2*he+1)}}},$i.prototype.getTile=function(K,Q,te){var he=this.options,a=he.extent,G=he.debug;if(K<0||K>24)return null;var Le=1<<K,ke=ji(K,Q=(Q%Le+Le)%Le,te);if(this.tiles[ke])return Ns(this.tiles[ke],a);G>1&&console.log("drilling down to z%d-%d-%d",K,Q,te);for(var Pe,Ie=K,qe=Q,At=te;!Pe&&Ie>0;)Ie--,qe=Math.floor(qe/2),At=Math.floor(At/2),Pe=this.tiles[ji(Ie,qe,At)];return Pe&&Pe.source?(G>1&&console.log("found parent tile z%d-%d-%d",Ie,qe,At),G>1&&console.time("drilling down"),this.splitTile(Pe.source,Ie,qe,At,K,Q,te),G>1&&console.timeEnd("drilling down"),this.tiles[ke]?Ns(this.tiles[ke],a):null):null};class ls extends H{constructor(Q,te,he,a){super(Q,te,he,Di),a&&(this.loadGeoJSON=a)}loadData(Q,te){var he;(he=this._pendingRequest)===null||he===void 0||he.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const a=!!(Q&&Q.request&&Q.request.collectResourceTiming)&&new o.RequestPerformance(Q.request);this._pendingCallback=te,this._pendingRequest=this.loadGeoJSON(Q,(G,Le)=>{if(delete this._pendingCallback,delete this._pendingRequest,G||!Le)return te(G);if(typeof Le!="object")return te(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));{X(Le,!0);try{if(Q.filter){const Pe=o.createExpression(Q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Pe.result==="error")throw new Error(Pe.value.map(qe=>`${qe.key}: ${qe.message}`).join(", "));Le={type:"FeatureCollection",features:Le.features.filter(qe=>Pe.value.evaluate({zoom:0},qe))}}this._geoJSONIndex=Q.cluster?new Wn(function({superclusterOptions:Pe,clusterProperties:Ie}){if(!Ie||!Pe)return Pe;const qe={},At={},We={accumulated:null,zoom:0},dt={properties:null},Dt=Object.keys(Ie);for(const Rt of Dt){const[sn,jt]=Ie[Rt],pn=o.createExpression(jt),qt=o.createExpression(typeof sn=="string"?[sn,["accumulated"],["get",Rt]]:sn);qe[Rt]=pn.value,At[Rt]=qt.value}return Pe.map=Rt=>{dt.properties=Rt;const sn={};for(const jt of Dt)sn[jt]=qe[jt].evaluate(We,dt);return sn},Pe.reduce=(Rt,sn)=>{dt.properties=sn;for(const jt of Dt)We.accumulated=Rt[jt],Rt[jt]=At[jt].evaluate(We,dt)},Pe}(Q)).load(Le.features):function(Pe,Ie){return new $i(Pe,Ie)}(Le,Q.geojsonVtOptions)}catch(Pe){return te(Pe)}this.loaded={};const ke={};if(a){const Pe=a.finish();Pe&&(ke.resourceTiming={},ke.resourceTiming[Q.source]=JSON.parse(JSON.stringify(Pe)))}te(null,ke)}})}reloadTile(Q,te){const he=this.loaded;return he&&he[Q.uid]?super.reloadTile(Q,te):this.loadTile(Q,te)}loadGeoJSON(Q,te){if(Q.request)return o.getJSON(Q.request,te);if(typeof Q.data=="string")try{te(null,JSON.parse(Q.data))}catch{te(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`))}else te(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(Q,te){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),te()}getClusterExpansionZoom(Q,te){try{te(null,this._geoJSONIndex.getClusterExpansionZoom(Q.clusterId))}catch(he){te(he)}}getClusterChildren(Q,te){try{te(null,this._geoJSONIndex.getChildren(Q.clusterId))}catch(he){te(he)}}getClusterLeaves(Q,te){try{te(null,this._geoJSONIndex.getLeaves(Q.clusterId,Q.limit,Q.offset))}catch(he){te(he)}}}class Fr{constructor(Q){this.self=Q,this.actor=new o.Actor(Q,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:H,geojson:ls},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(te,he)=>{if(this.workerSourceTypes[te])throw new Error(`Worker source with name "${te}" already registered.`);this.workerSourceTypes[te]=he},this.self.registerRTLTextPlugin=te=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=te.applyArabicShaping,o.plugin.processBidirectionalText=te.processBidirectionalText,o.plugin.processStyledBidirectionalText=te.processStyledBidirectionalText}}setReferrer(Q,te){this.referrer=te}setImages(Q,te,he){this.availableImages[Q]=te;for(const a in this.workerSources[Q]){const G=this.workerSources[Q][a];for(const Le in G)G[Le].availableImages=te}he()}setLayers(Q,te,he){this.getLayerIndex(Q).replace(te),he()}updateLayers(Q,te,he){this.getLayerIndex(Q).update(te.layers,te.removedIds),he()}loadTile(Q,te,he){this.getWorkerSource(Q,te.type,te.source).loadTile(te,he)}loadDEMTile(Q,te,he){this.getDEMWorkerSource(Q,te.source).loadTile(te,he)}reloadTile(Q,te,he){this.getWorkerSource(Q,te.type,te.source).reloadTile(te,he)}abortTile(Q,te,he){this.getWorkerSource(Q,te.type,te.source).abortTile(te,he)}removeTile(Q,te,he){this.getWorkerSource(Q,te.type,te.source).removeTile(te,he)}removeDEMTile(Q,te){this.getDEMWorkerSource(Q,te.source).removeTile(te)}removeSource(Q,te,he){if(!this.workerSources[Q]||!this.workerSources[Q][te.type]||!this.workerSources[Q][te.type][te.source])return;const a=this.workerSources[Q][te.type][te.source];delete this.workerSources[Q][te.type][te.source],a.removeSource!==void 0?a.removeSource(te,he):he()}loadWorkerSource(Q,te,he){try{this.self.importScripts(te.url),he()}catch(a){he(a.toString())}}syncRTLPluginState(Q,te,he){try{o.plugin.setState(te);const a=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&a!=null){this.self.importScripts(a);const G=o.plugin.isParsed();he(G?void 0:new Error(`RTL Text Plugin failed to import scripts from ${a}`),G)}}catch(a){he(a.toString())}}getAvailableImages(Q){let te=this.availableImages[Q];return te||(te=[]),te}getLayerIndex(Q){let te=this.layerIndexes[Q];return te||(te=this.layerIndexes[Q]=new C),te}getWorkerSource(Q,te,he){if(this.workerSources[Q]||(this.workerSources[Q]={}),this.workerSources[Q][te]||(this.workerSources[Q][te]={}),!this.workerSources[Q][te][he]){const a={send:(G,Le,ke)=>{this.actor.send(G,Le,ke,Q)}};this.workerSources[Q][te][he]=new this.workerSourceTypes[te](a,this.getLayerIndex(Q),this.getAvailableImages(Q))}return this.workerSources[Q][te][he]}getDEMWorkerSource(Q,te){return this.demWorkerSources[Q]||(this.demWorkerSources[Q]={}),this.demWorkerSources[Q][te]||(this.demWorkerSources[Q][te]=new ie),this.demWorkerSources[Q][te]}enforceCacheSizeLimit(Q,te){o.enforceCacheSizeLimit(te)}}return o.isWorker()&&(self.worker=new Fr(self)),Fr}),s(["./shared"],function(o){var p=w;function w(L){return!function(c){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var A,h,d=new Blob([""],{type:"text/javascript"}),x=URL.createObjectURL(d);try{h=new Worker(x),A=!0}catch{A=!1}return h&&h.terminate(),URL.revokeObjectURL(x),A}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var A=document.createElement("canvas");A.width=A.height=1;var h=A.getContext("2d");if(!h)return!1;var d=h.getImageData(0,0,1,1);return d&&d.width===A.width}()?(C[_=c&&c.failIfMajorPerformanceCaveat]===void 0&&(C[_]=function(A){var h,d=function(x){var b=document.createElement("canvas"),S=Object.create(w.webGLContextAttributes);return S.failIfMajorPerformanceCaveat=x,b.getContext("webgl",S)||b.getContext("experimental-webgl",S)}(A);if(!d)return!1;try{h=d.createShader(d.VERTEX_SHADER)}catch{return!1}return!(!h||d.isContextLost())&&(d.shaderSource(h,"void main() {}"),d.compileShader(h),d.getShaderParameter(h,d.COMPILE_STATUS)===!0)}(_)),C[_]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var _}(L)}var C={};function P(L,c){if(Array.isArray(L)){if(!Array.isArray(c)||L.length!==c.length)return!1;for(let _=0;_<L.length;_++)if(!P(L[_],c[_]))return!1;return!0}if(typeof L=="object"&&L!==null&&c!==null){if(typeof c!="object"||Object.keys(L).length!==Object.keys(c).length)return!1;for(const _ in L)if(!P(L[_],c[_]))return!1;return!0}return L===c}w.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class I{static testProp(c){if(!I.docStyle)return c[0];for(let _=0;_<c.length;_++)if(c[_]in I.docStyle)return c[_];return c[0]}static create(c,_,A){const h=window.document.createElement(c);return _!==void 0&&(h.className=_),A&&A.appendChild(h),h}static createNS(c,_){return window.document.createElementNS(c,_)}static disableDrag(){I.docStyle&&I.selectProp&&(I.userSelect=I.docStyle[I.selectProp],I.docStyle[I.selectProp]="none")}static enableDrag(){I.docStyle&&I.selectProp&&(I.docStyle[I.selectProp]=I.userSelect)}static setTransform(c,_){c.style[I.transformProp]=_}static addEventListener(c,_,A,h={}){c.addEventListener(_,A,"passive"in h?h:h.capture)}static removeEventListener(c,_,A,h={}){c.removeEventListener(_,A,"passive"in h?h:h.capture)}static suppressClickInternal(c){c.preventDefault(),c.stopPropagation(),window.removeEventListener("click",I.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",I.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",I.suppressClickInternal,!0)},0)}static mousePos(c,_){const A=c.getBoundingClientRect();return new o.pointGeometry(_.clientX-A.left-c.clientLeft,_.clientY-A.top-c.clientTop)}static touchPos(c,_){const A=c.getBoundingClientRect(),h=[];for(let d=0;d<_.length;d++)h.push(new o.pointGeometry(_[d].clientX-A.left-c.clientLeft,_[d].clientY-A.top-c.clientTop));return h}static mouseButton(c){return c.button}static remove(c){c.parentNode&&c.parentNode.removeChild(c)}}I.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,I.selectProp=I.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),I.transformProp=I.testProp(["transform","WebkitTransform"]);class U{constructor(c){this._transformRequestFn=c}transformRequest(c,_){return this._transformRequestFn&&this._transformRequestFn(c,_)||{url:c}}normalizeSpriteURL(c,_,A){const h=function(d){const x=d.match(W);if(!x)throw new Error(`Unable to parse URL "${d}"`);return{protocol:x[1],authority:x[2],path:x[3]||"/",params:x[4]?x[4].split("&"):[]}}(c);return h.path+=`${_}${A}`,function(d){const x=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${x}`}(h)}setTransformRequest(c){this._transformRequestFn=c}}const W=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class H{constructor(c,_,A,h){this.context=c,this.format=A,this.texture=c.gl.createTexture(),this.update(_,h)}update(c,_,A){const{width:h,height:d}=c,x=!(this.size&&this.size[0]===h&&this.size[1]===d||A),{context:b}=this,{gl:S}=b;if(this.useMipmap=!!(_&&_.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!_||_.premultiply!==!1)),x)this.size=[h,d],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||o.isImageBitmap(c)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,c):S.texImage2D(S.TEXTURE_2D,0,this.format,h,d,0,this.format,S.UNSIGNED_BYTE,c.data);else{const{x:M,y:B}=A||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||o.isImageBitmap(c)?S.texSubImage2D(S.TEXTURE_2D,0,M,B,S.RGBA,S.UNSIGNED_BYTE,c):S.texSubImage2D(S.TEXTURE_2D,0,M,B,h,d,S.RGBA,S.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)}bind(c,_,A){const{context:h}=this,{gl:d}=h;d.bindTexture(d.TEXTURE_2D,this.texture),A!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(A=d.LINEAR),c!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,c),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,A||c),this.filter=c),_!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,_),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,_),this.wrap=_)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}function ie(L){const{userImage:c}=L;return!!(c&&c.render&&c.render())&&(L.data.replace(new Uint8Array(c.data.buffer)),!0)}class X extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:_,callback:A}of this.requestors)this._notify(_,A);this.requestors=[]}}getImage(c){return this.images[c]}addImage(c,_){if(this.images[c])throw new Error(`Image id ${c} already exist, use updateImage instead`);this._validate(c,_)&&(this.images[c]=_)}_validate(c,_){let A=!0;return this._validateStretch(_.stretchX,_.data&&_.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),A=!1),this._validateStretch(_.stretchY,_.data&&_.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),A=!1),this._validateContent(_.content,_)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),A=!1),A}_validateStretch(c,_){if(!c)return!0;let A=0;for(const h of c){if(h[0]<A||h[1]<h[0]||_<h[1])return!1;A=h[1]}return!0}_validateContent(c,_){return!(c&&(c.length!==4||c[0]<0||_.data.width<c[0]||c[1]<0||_.data.height<c[1]||c[2]<0||_.data.width<c[2]||c[3]<0||_.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,_){const A=this.images[c];if(A.data.width!==_.data.width||A.data.height!==_.data.height)throw new Error(`size mismatch between old image (${A.data.width}x${A.data.height}) and new image (${_.data.width}x${_.data.height}).`);_.version=A.version+1,this.images[c]=_,this.updatedImages[c]=!0}removeImage(c){const _=this.images[c];delete this.images[c],delete this.patterns[c],_.userImage&&_.userImage.onRemove&&_.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,_){let A=!0;if(!this.isLoaded())for(const h of c)this.images[h]||(A=!1);this.isLoaded()||A?this._notify(c,_):this.requestors.push({ids:c,callback:_})}_notify(c,_){const A={};for(const h of c){this.images[h]||this.fire(new o.Event("styleimagemissing",{id:h}));const d=this.images[h];d?A[h]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:o.warnOnce(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}_(null,A)}getPixelSize(){const{width:c,height:_}=this.atlasImage;return{width:c,height:_}}getPattern(c){const _=this.patterns[c],A=this.getImage(c);if(!A)return null;if(_&&_.position.version===A.version)return _.position;if(_)_.position.version=A.version;else{const h={w:A.data.width+2,h:A.data.height+2,x:0,y:0},d=new o.ImagePosition(h,A);this.patterns[c]={bin:h,position:d}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const _=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new H(c,this.atlasImage,_.RGBA),this.atlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const d in this.patterns)c.push(this.patterns[d].bin);const{w:_,h:A}=o.potpack(c),h=this.atlasImage;h.resize({width:_||1,height:A||1});for(const d in this.patterns){const{bin:x}=this.patterns[d],b=x.x+1,S=x.y+1,M=this.images[d].data,B=M.width,V=M.height;o.RGBAImage.copy(M,h,{x:0,y:0},{x:b,y:S},{width:B,height:V}),o.RGBAImage.copy(M,h,{x:0,y:V-1},{x:b,y:S-1},{width:B,height:1}),o.RGBAImage.copy(M,h,{x:0,y:0},{x:b,y:S+V},{width:B,height:1}),o.RGBAImage.copy(M,h,{x:B-1,y:0},{x:b-1,y:S},{width:1,height:V}),o.RGBAImage.copy(M,h,{x:0,y:0},{x:b+B,y:S},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const _ of c){if(this.callbackDispatchedThisFrame[_])continue;this.callbackDispatchedThisFrame[_]=!0;const A=this.images[_];A||o.warnOnce(`Image with ID: "${_}" was not found`),ie(A)&&this.updateImage(_,A)}}}const ee=1e20;function se(L,c,_,A,h,d,x,b,S){for(let M=c;M<c+A;M++)fe(L,_*d+M,d,h,x,b,S);for(let M=_;M<_+h;M++)fe(L,M*d+c,1,A,x,b,S)}function fe(L,c,_,A,h,d,x){d[0]=0,x[0]=-ee,x[1]=ee,h[0]=L[c];for(let b=1,S=0,M=0;b<A;b++){h[b]=L[c+b*_];const B=b*b;do{const V=d[S];M=(h[b]-h[V]+B-V*V)/(b-V)/2}while(M<=x[S]&&--S>-1);S++,d[S]=b,x[S]=M,x[S+1]=ee}for(let b=0,S=0;b<A;b++){for(;x[S+1]<b;)S++;const M=d[S],B=b-M;L[c+b*_]=h[M]+B*B}}class me{constructor(c,_){this.requestManager=c,this.localIdeographFontFamily=_,this.entries={}}setURL(c){this.url=c}getGlyphs(c,_){const A=[];for(const h in c)for(const d of c[h])A.push({stack:h,id:d});o.asyncAll(A,({stack:h,id:d},x)=>{let b=this.entries[h];b||(b=this.entries[h]={glyphs:{},requests:{},ranges:{}});let S=b.glyphs[d];if(S!==void 0)return void x(null,{stack:h,id:d,glyph:S});if(S=this._tinySDF(b,h,d),S)return b.glyphs[d]=S,void x(null,{stack:h,id:d,glyph:S});const M=Math.floor(d/256);if(256*M>65535)return void x(new Error("glyphs > 65535 not supported"));if(b.ranges[M])return void x(null,{stack:h,id:d,glyph:S});let B=b.requests[M];B||(B=b.requests[M]=[],me.loadGlyphRange(h,M,this.url,this.requestManager,(V,j)=>{if(j){for(const Y in j)this._doesCharSupportLocalGlyph(+Y)||(b.glyphs[+Y]=j[+Y]);b.ranges[M]=!0}for(const Y of B)Y(V,j);delete b.requests[M]})),B.push((V,j)=>{V?x(V):j&&x(null,{stack:h,id:d,glyph:j[d]||null})})},(h,d)=>{if(h)_(h);else if(d){const x={};for(const{stack:b,id:S,glyph:M}of d)(x[b]||(x[b]={}))[S]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};_(null,x)}})}_doesCharSupportLocalGlyph(c){return!!this.localIdeographFontFamily&&(o.unicodeBlockLookup["CJK Unified Ideographs"](c)||o.unicodeBlockLookup["Hangul Syllables"](c)||o.unicodeBlockLookup.Hiragana(c)||o.unicodeBlockLookup.Katakana(c))}_tinySDF(c,_,A){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(A))return;let d=c.tinySDF;if(!d){let b="400";/bold/i.test(_)?b="900":/medium/i.test(_)?b="500":/light/i.test(_)&&(b="200"),d=c.tinySDF=new me.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:h,fontWeight:b})}const x=d.draw(String.fromCharCode(A));return{id:A,bitmap:new o.AlphaImage({width:x.width||30,height:x.height||30},x.data),metrics:{width:x.glyphWidth||24,height:x.glyphHeight||24,left:x.glyphLeft||0,top:x.glyphTop-27||-8,advance:x.glyphAdvance||24}}}}me.loadGlyphRange=function(L,c,_,A,h){const d=256*c,x=d+255,b=A.transformRequest(_.replace("{fontstack}",L).replace("{range}",`${d}-${x}`),o.ResourceType.Glyphs);o.getArrayBuffer(b,(S,M)=>{if(S)h(S);else if(M){const B={};for(const V of o.parseGlyphPbf(M))B[V.id]=V;h(null,B)}})},me.TinySDF=class{constructor({fontSize:L=24,buffer:c=3,radius:_=8,cutoff:A=.25,fontFamily:h="sans-serif",fontWeight:d="normal",fontStyle:x="normal"}={}){this.buffer=c,this.cutoff=A,this.radius=_;const b=this.size=L+4*c,S=this._createCanvas(b),M=this.ctx=S.getContext("2d",{willReadFrequently:!0});M.font=`${x} ${d} ${L}px ${h}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(L){const c=document.createElement("canvas");return c.width=c.height=L,c}draw(L){const{width:c,actualBoundingBoxAscent:_,actualBoundingBoxDescent:A,actualBoundingBoxLeft:h,actualBoundingBoxRight:d}=this.ctx.measureText(L),x=Math.ceil(_),b=Math.min(this.size-this.buffer,Math.ceil(d-h)),S=Math.min(this.size-this.buffer,x+Math.ceil(A)),M=b+2*this.buffer,B=S+2*this.buffer,V=Math.max(M*B,0),j=new Uint8ClampedArray(V),Y={data:j,width:M,height:B,glyphWidth:b,glyphHeight:S,glyphTop:x,glyphLeft:0,glyphAdvance:c};if(b===0||S===0)return Y;const{ctx:ae,buffer:ne,gridInner:ue,gridOuter:be}=this;ae.clearRect(ne,ne,b,S),ae.fillText(L,ne,ne+x);const Me=ae.getImageData(ne,ne,b,S);be.fill(ee,0,V),ue.fill(0,0,V);for(let ve=0;ve<S;ve++)for(let $e=0;$e<b;$e++){const Te=Me.data[4*(ve*b+$e)+3]/255;if(Te===0)continue;const Ge=(ve+ne)*M+$e+ne;if(Te===1)be[Ge]=0,ue[Ge]=ee;else{const xe=.5-Te;be[Ge]=xe>0?xe*xe:0,ue[Ge]=xe<0?xe*xe:0}}se(be,0,0,M,B,M,this.f,this.v,this.z),se(ue,ne,ne,b,S,M,this.f,this.v,this.z);for(let ve=0;ve<V;ve++){const $e=Math.sqrt(be[ve])-Math.sqrt(ue[ve]);j[ve]=Math.round(255-255*($e/this.radius+this.cutoff))}return Y}};const Se=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(L,c){return o.sphericalToCartesian(L.expression.evaluate(c))}interpolate(L,c,_){return{x:o.number(L.x,c.x,_),y:o.number(L.y,c.y,_),z:o.number(L.z,c.z,_)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),He="-transition";class Qe extends o.Evented{constructor(c){super(),this._transitionable=new o.Transitionable(Se),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,_={}){if(!this._validate(o.validateLight,c,_))for(const A in c){const h=c[A];A.endsWith(He)?this._transitionable.setTransition(A.slice(0,-He.length),h):this._transitionable.setValue(A,h)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,_,A){return(!A||A.validate!==!1)&&o.emitValidationErrors(this,c.call(o.validateStyle,o.extend({value:_,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class Ke{constructor(c,_){this.width=c,this.height=_,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(c,_){const A=c.join(",")+String(_);return this.dashEntry[A]||(this.dashEntry[A]=this.addDash(c,_)),this.dashEntry[A]}getDashRanges(c,_,A){const h=[];let d=c.length%2==1?-c[c.length-1]*A:0,x=c[0]*A,b=!0;h.push({left:d,right:x,isDash:b,zeroLength:c[0]===0});let S=c[0];for(let M=1;M<c.length;M++){b=!b;const B=c[M];d=S*A,S+=B,x=S*A,h.push({left:d,right:x,isDash:b,zeroLength:B===0})}return h}addRoundDash(c,_,A){const h=_/2;for(let d=-A;d<=A;d++){const x=this.width*(this.nextRow+A+d);let b=0,S=c[b];for(let M=0;M<this.width;M++){M/S.right>1&&(S=c[++b]);const B=Math.abs(M-S.left),V=Math.abs(M-S.right),j=Math.min(B,V);let Y;const ae=d/A*(h+1);if(S.isDash){const ne=h-Math.abs(ae);Y=Math.sqrt(j*j+ne*ne)}else Y=h-Math.sqrt(j*j+ae*ae);this.data[x+M]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(c){for(let b=c.length-1;b>=0;--b){const S=c[b],M=c[b+1];S.zeroLength?c.splice(b,1):M&&M.isDash===S.isDash&&(M.left=S.left,c.splice(b,1))}const _=c[0],A=c[c.length-1];_.isDash===A.isDash&&(_.left=A.left-this.width,A.right=_.right+this.width);const h=this.width*this.nextRow;let d=0,x=c[d];for(let b=0;b<this.width;b++){b/x.right>1&&(x=c[++d]);const S=Math.abs(b-x.left),M=Math.abs(b-x.right),B=Math.min(S,M);this.data[h+b]=Math.max(0,Math.min(255,(x.isDash?B:-B)+128))}}addDash(c,_){const A=_?7:0,h=2*A+1;if(this.nextRow+h>this.height)return o.warnOnce("LineAtlas out of space"),null;let d=0;for(let b=0;b<c.length;b++)d+=c[b];if(d!==0){const b=this.width/d,S=this.getDashRanges(c,this.width,b);_?this.addRoundDash(S,b,A):this.addRegularDash(S)}const x={y:(this.nextRow+A+.5)/this.height,height:2*A/this.height,width:d};return this.nextRow+=h,this.dirty=!0,x}bind(c){const _=c.gl;this.texture?(_.bindTexture(_.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,_.texSubImage2D(_.TEXTURE_2D,0,0,0,this.width,this.height,_.ALPHA,_.UNSIGNED_BYTE,this.data))):(this.texture=_.createTexture(),_.bindTexture(_.TEXTURE_2D,this.texture),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.REPEAT),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.REPEAT),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texImage2D(_.TEXTURE_2D,0,_.ALPHA,this.width,this.height,0,_.ALPHA,_.UNSIGNED_BYTE,this.data))}}class rt{constructor(c,_){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const A=this.workerPool.acquire(this.id);for(let h=0;h<A.length;h++){const d=new rt.Actor(A[h],_,this.id);d.name=`Worker ${h}`,this.actors.push(d)}if(!this.actors.length)throw new Error("No actors found")}broadcast(c,_,A){o.asyncAll(this.actors,(h,d)=>{h.send(c,_,d)},A=A||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ue(L,c,_){const A=function(h,d){if(h)return _(h);if(d){const x=o.pick(o.extend(d,L),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);d.vector_layers&&(x.vectorLayers=d.vector_layers,x.vectorLayerIds=x.vectorLayers.map(b=>b.id)),_(null,x)}};return L.url?o.getJSON(c.transformRequest(L.url,o.ResourceType.Source),A):o.exported.frame(()=>A(null,L))}rt.Actor=o.Actor;class it{constructor(c,_,A){this.bounds=o.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=_||0,this.maxzoom=A||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const _=Math.pow(2,c.z),A=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*_),h=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*_),d=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*_),x=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*_);return c.x>=A&&c.x<d&&c.y>=h&&c.y<x}}class Ze extends o.Evented{constructor(c,_,A,h){if(super(),this.id=c,this.dispatcher=A,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(_,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},_),this._collectResourceTiming=_.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ue(this._options,this.map._requestManager,(c,_)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),c?this.fire(new o.ErrorEvent(c)):_&&(o.extend(this,_),_.bounds&&(this.tileBounds=new it(_.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}setSourceProperty(c){this._tileJSONRequest&&this._tileJSONRequest.cancel(),c(),this.load()}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}setUrl(c){return this.setSourceProperty(()=>{this.url=c,this._options.url=c}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}loadTile(c,_){const A=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h={request:this.map._requestManager.transformRequest(A,o.ResourceType.Tile),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function d(x,b){return delete c.request,c.aborted?_(null):x&&x.status!==404?_(x):(b&&b.resourceTiming&&(c.resourceTiming=b.resourceTiming),this.map._refreshExpiredTiles&&b&&c.setExpiryData(b),c.loadVectorData(b,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),_(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}h.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired"?c.state==="loading"?c.reloadCallback=_:c.request=c.actor.send("reloadTile",h,d.bind(this)):(c.actor=this.dispatcher.getActor(),c.request=c.actor.send("loadTile",h,d.bind(this)))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id},void 0)}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class yt extends o.Evented{constructor(c,_,A,h){super(),this.id=c,this.dispatcher=A,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},_),o.extend(this,o.pick(_,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ue(this._options,this.map._requestManager,(c,_)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new o.ErrorEvent(c)):_&&(o.extend(this,_),_.bounds&&(this.tileBounds=new it(_.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,_){const A=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);c.request=o.getImage(this.map._requestManager.transformRequest(A,o.ResourceType.Tile),(h,d,x)=>{if(delete c.request,c.aborted)c.state="unloaded",_(null);else if(h)c.state="errored",_(h);else if(d){this.map._refreshExpiredTiles&&c.setExpiryData(x);const b=this.map.painter.context,S=b.gl;c.texture=this.map.painter.getTileTexture(d.width),c.texture?c.texture.update(d,{useMipmap:!0}):(c.texture=new H(b,d,S.RGBA,{useMipmap:!0}),c.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),b.extTextureFilterAnisotropic&&S.texParameterf(S.TEXTURE_2D,b.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,b.extTextureFilterAnisotropicMax)),c.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),_(null)}})}abortTile(c,_){c.request&&(c.request.cancel(),delete c.request),_()}unloadTile(c,_){c.texture&&this.map.painter.saveTileTexture(c.texture),_()}hasTransition(){return!1}}let Kt;class Tt extends yt{constructor(c,_,A,h){super(c,_,A,h),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},_),this.encoding=_.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(c,_){const A=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function h(d,x){d&&(c.state="errored",_(d)),x&&(c.dem=x,c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0,c.state="loaded",_(null))}c.request=o.getImage(this.map._requestManager.transformRequest(A,o.ResourceType.Tile),function(d,x){if(delete c.request,c.aborted)c.state="unloaded",_(null);else if(d)c.state="errored",_(d);else if(x){this.map._refreshExpiredTiles&&c.setExpiryData(x),delete x.cacheControl,delete x.expires;const b=o.isImageBitmap(x)&&(Kt==null&&(Kt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Kt)?x:o.exported.getImageData(x,1),S={uid:c.uid,coord:c.tileID,source:this.id,rawImageData:b,encoding:this.encoding};c.actor&&c.state!=="expired"||(c.actor=this.dispatcher.getActor(),c.actor.send("loadDEMTile",S,h.bind(this)))}}.bind(this)),c.neighboringTiles=this._getNeighboringTiles(c.tileID)}_getNeighboringTiles(c){const _=c.canonical,A=Math.pow(2,_.z),h=(_.x-1+A)%A,d=_.x===0?c.wrap-1:c.wrap,x=(_.x+1+A)%A,b=_.x+1===A?c.wrap+1:c.wrap,S={};return S[new o.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,b,_.z,x,_.y).key]={backfilled:!1},_.y>0&&(S[new o.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y-1).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,c.wrap,_.z,_.x,_.y-1).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,b,_.z,x,_.y-1).key]={backfilled:!1}),_.y+1<A&&(S[new o.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y+1).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,c.wrap,_.z,_.x,_.y+1).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,b,_.z,x,_.y+1).key]={backfilled:!1}),S}unloadTile(c){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&c.actor.send("removeDEMTile",{uid:c.uid,source:this.id})}}class dn extends o.Evented{constructor(c,_,A,h){super(),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=A.getActor(),this.setEventedParent(h),this._data=_.data,this._options=o.extend({},_),this._collectResourceTiming=_.collectResourceTiming,_.maxzoom!==void 0&&(this.maxzoom=_.maxzoom),_.type&&(this.type=_.type),_.attribution&&(this.attribution=_.attribution),this.promoteId=_.promoteId;const d=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:_.cluster||!1,geojsonVtOptions:{buffer:(_.buffer!==void 0?_.buffer:128)*d,tolerance:(_.tolerance!==void 0?_.tolerance:.375)*d,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:_.lineMetrics||!1,generateId:_.generateId||!1},superclusterOptions:{maxZoom:_.clusterMaxZoom!==void 0?_.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,_.clusterMinPoints||2),extent:o.EXTENT,radius:(_.clusterRadius||50)*d,log:!1,generateId:_.generateId||!1},clusterProperties:_.clusterProperties,filter:_.filter},_.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(c){this.map=c,this.load()}setData(c){return this._data=c,this._updateWorkerData("content"),this}getClusterExpansionZoom(c,_){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:c,source:this.id},_),this}getClusterChildren(c,_){return this.actor.send("geojson.getClusterChildren",{clusterId:c,source:this.id},_),this}getClusterLeaves(c,_,A,h){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:c,limit:_,offset:A},h),this}_updateWorkerData(c){const _=o.extend({},this.workerOptions),A=this._data;typeof A=="string"?(_.request=this.map._requestManager.transformRequest(o.exported.resolveURL(A),o.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(A),this._pendingLoads++,this.fire(new o.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,_,(h,d)=>{if(this._pendingLoads--,this._removed||d&&d.abandoned)return void this.fire(new o.Event("dataabort",{dataType:"source",sourceDataType:c}));let x=null;if(d&&d.resourceTiming&&d.resourceTiming[this.id]&&(x=d.resourceTiming[this.id].slice(0)),h)return void this.fire(new o.ErrorEvent(h));const b={dataType:"source",sourceDataType:c};this._collectResourceTiming&&x&&x.length>0&&o.extend(b,{resourceTiming:x}),this.fire(new o.Event("data",b))})}loaded(){return this._pendingLoads===0}loadTile(c,_){const A=c.actor?"reloadTile":"loadTile";c.actor=this.actor;const h={type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};c.request=this.actor.send(A,h,(d,x)=>(delete c.request,c.unloadVectorData(),c.aborted?_(null):d?_(d):(c.loadVectorData(x,this.map.painter,A==="reloadTile"),_(null))))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.aborted=!0}unloadTile(c){c.unloadVectorData(),this.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var _t=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Et extends o.Evented{constructor(c,_,A,h){super(),this.id=c,this.dispatcher=A,this.coordinates=_.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=_}load(c,_){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(A,h)=>{this._loaded=!0,A?this.fire(new o.ErrorEvent(A)):h&&(this.image=h,c&&(this.coordinates=c),_&&_(),this._finishLoading())})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this.options.url=c.url,this.load(c.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}setCoordinates(c){this.coordinates=c;const _=c.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(h){let d=1/0,x=1/0,b=-1/0,S=-1/0;for(const j of h)d=Math.min(d,j.x),x=Math.min(x,j.y),b=Math.max(b,j.x),S=Math.max(S,j.y);const M=Math.max(b-d,S-x),B=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),V=Math.pow(2,B);return new o.CanonicalTileID(B,Math.floor((d+b)/2*V),Math.floor((x+S)/2*V))}(_),this.minzoom=this.maxzoom=this.tileID.z;const A=_.map(h=>this.tileID.getTilePoint(h)._round());return this._boundsArray=new o.RasterBoundsArray,this._boundsArray.emplaceBack(A[0].x,A[0].y,0,0),this._boundsArray.emplaceBack(A[1].x,A[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(A[3].x,A[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(A[2].x,A[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,_=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,_t.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new H(c,this.image,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE));for(const A in this.tiles){const h=this.tiles[A];h.state!=="loaded"&&(h.state="loaded",h.texture=this.texture)}}loadTile(c,_){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},_(null)):(c.state="errored",_(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Jt extends Et{constructor(c,_,A,h){super(c,_,A,h),this.roundZoom=!0,this.type="video",this.options=_}load(){this._loaded=!1;const c=this.options;this.urls=[];for(const _ of c.urls)this.urls.push(this.map._requestManager.transformRequest(_,o.ResourceType.Source).url);o.getVideo(this.urls,(_,A)=>{this._loaded=!0,_?this.fire(new o.ErrorEvent(_)):A&&(this.video=A,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(c){if(this.video){const _=this.video.seekable;c<_.start(0)||c>_.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${_.start(0)} and ${_.end(0)}-second mark.`))):this.video.currentTime=c}}getVideo(){return this.video}onAdd(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const c=this.map.painter.context,_=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,_t.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE),_.texSubImage2D(_.TEXTURE_2D,0,0,0,_.RGBA,_.UNSIGNED_BYTE,this.video)):(this.texture=new H(c,this.video,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE));for(const A in this.tiles){const h=this.tiles[A];h.state!=="loaded"&&(h.state="loaded",h.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class In extends Et{constructor(c,_,A,h){super(c,_,A,h),_.coordinates?Array.isArray(_.coordinates)&&_.coordinates.length===4&&!_.coordinates.some(d=>!Array.isArray(d)||d.length!==2||d.some(x=>typeof x!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'missing required property "coordinates"'))),_.animate&&typeof _.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'optional "animate" property must be a boolean value'))),_.canvas?typeof _.canvas=="string"||_.canvas instanceof HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'missing required property "canvas"'))),this.options=_,this.animate=_.animate===void 0||_.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const _=this.map.painter.context,A=_.gl;this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,_t.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(c||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new H(_,this.canvas,A.RGBA,{premultiply:!0});for(const h in this.tiles){const d=this.tiles[h];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const c of[this.canvas.width,this.canvas.height])if(isNaN(c)||c<=0)return!0;return!1}}const Tn={vector:Ze,raster:yt,"raster-dem":Tt,geojson:dn,video:Jt,image:Et,canvas:In};function Pr(L,c){const _=o.create();return o.translate(_,_,[1,1,0]),o.scale(_,_,[.5*L.width,.5*L.height,1]),o.multiply(_,_,L.calculatePosMatrix(c.toUnwrapped()))}function tr(L,c,_,A,h,d){const x=function(V,j,Y){if(V)for(const ae of V){const ne=j[ae];if(ne&&ne.source===Y&&ne.type==="fill-extrusion")return!0}else for(const ae in j){const ne=j[ae];if(ne.source===Y&&ne.type==="fill-extrusion")return!0}return!1}(h&&h.layers,c,L.id),b=d.maxPitchScaleFactor(),S=L.tilesIn(A,b,x);S.sort(or);const M=[];for(const V of S)M.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(c,_,L._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,h,d,b,Pr(L.transform,V.tileID))});const B=function(V){const j={},Y={};for(const ae of V){const ne=ae.queryResults,ue=ae.wrappedTileID,be=Y[ue]=Y[ue]||{};for(const Me in ne){const ve=ne[Me],$e=be[Me]=be[Me]||{},Te=j[Me]=j[Me]||[];for(const Ge of ve)$e[Ge.featureIndex]||($e[Ge.featureIndex]=!0,Te.push(Ge))}}return j}(M);for(const V in B)B[V].forEach(j=>{const Y=j.feature,ae=L.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=ae});return B}function or(L,c){const _=L.tileID,A=c.tileID;return _.overscaledZ-A.overscaledZ||_.canonical.y-A.canonical.y||_.wrap-A.wrap||_.canonical.x-A.canonical.x}class hr{constructor(c,_){this.tileID=c,this.uid=o.uniqueId(),this.uses=0,this.tileSize=_,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(c){const _=c+this.timeAdded;_<o.exported.now()||this.fadeEndTime&&_<this.fadeEndTime||(this.fadeEndTime=_)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(c){this.demTexture&&c.saveTileTexture(this.demTexture),this.textures.forEach(_=>c.saveTileTexture(_)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(c,_,A){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(h,d){const x={};if(!d)return x;for(const b of h){const S=b.layerIds.map(M=>d.getLayer(M)).filter(Boolean);if(S.length!==0){b.layers=S,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(M=>S.filter(B=>B.id===M)[0]));for(const M of S)x[M.id]=b}}return x}(c.buckets,_.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const d=this.buckets[h];if(d instanceof o.SymbolBucket){if(this.hasSymbolBuckets=!0,!A)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const d=this.buckets[h];if(d instanceof o.SymbolBucket&&d.hasRTLText){this.hasRTLText=!0,o.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const h in this.buckets){const d=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,_.style.getLayer(h).queryRadius(d))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new o.CollisionBoxArray}unloadVectorData(){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(c){return this.buckets[c.id]}upload(c){for(const A in this.buckets){const h=this.buckets[A];h.uploadPending()&&h.upload(c)}const _=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new H(c,this.imageAtlas.image,_.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new H(c,this.glyphAtlasImage,_.ALPHA),this.glyphAtlasImage=null)}prepare(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)}queryRenderedFeatures(c,_,A,h,d,x,b,S,M,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:d,scale:x,tileSize:this.tileSize,pixelPosMatrix:B,transform:S,params:b,queryPadding:this.queryPadding*M},c,_,A):{}}querySourceFeatures(c,_){const A=this.latestFeatureIndex;if(!A||!A.rawTileData)return;const h=A.loadVTLayers(),d=_?_.sourceLayer:"",x=h._geojsonTileLayer||h[d];if(!x)return;const b=o.createFilter(_&&_.filter),{z:S,x:M,y:B}=this.tileID.canonical,V={z:S,x:M,y:B};for(let j=0;j<x.length;j++){const Y=x.feature(j);if(b.needGeometry){const ue=o.toEvaluationFeature(Y,!0);if(!b.filter(new o.EvaluationParameters(this.tileID.overscaledZ),ue,this.tileID.canonical))continue}else if(!b.filter(new o.EvaluationParameters(this.tileID.overscaledZ),Y))continue;const ae=A.getId(Y,d),ne=new o.GeoJSONFeature(Y,S,M,B,ae);ne.tile=V,c.push(ne)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(c){const _=this.expirationTime;if(c.cacheControl){const A=o.parseCacheControl(c.cacheControl);A["max-age"]&&(this.expirationTime=Date.now()+1e3*A["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){const A=Date.now();let h=!1;if(this.expirationTime>A)h=!1;else if(_)if(this.expirationTime<_)h=!0;else{const d=this.expirationTime-_;d?this.expirationTime=A+Math.max(d,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(c,_){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(c).length===0)return;const A=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!_.style.hasLayer(h))continue;const d=this.buckets[h],x=d.layers[0].sourceLayer||"_geojsonTileLayer",b=A[x],S=c[x];if(!b||!S||Object.keys(S).length===0)continue;d.update(S,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});const M=_&&_.style&&_.style.getLayer(h);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(c){this.symbolFadeHoldUntil=o.exported.now()+c}setDependencies(c,_){const A={};for(const h of _)A[h]=!0;this.dependencies[c]=A}hasDependency(c,_){for(const A of c){const h=this.dependencies[A];if(h){for(const d of _)if(h[d])return!0}}return!1}}class Vn{constructor(c,_){this.max=c,this.onRemove=_,this.reset()}reset(){for(const c in this.data)for(const _ of this.data[c])_.timeout&&clearTimeout(_.timeout),this.onRemove(_.value);return this.data={},this.order=[],this}add(c,_,A){const h=c.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const d={value:_,timeout:void 0};if(A!==void 0&&(d.timeout=setTimeout(()=>{this.remove(c,d)},A)),this.data[h].push(d),this.order.push(h),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(c){return c.wrapped().key in this.data}getAndRemove(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null}_getAndRemoveByKey(c){const _=this.data[c].shift();return _.timeout&&clearTimeout(_.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),_.value}getByKey(c){const _=this.data[c];return _?_[0].value:null}get(c){return this.has(c)?this.data[c.wrapped().key][0].value:null}remove(c,_){if(!this.has(c))return this;const A=c.wrapped().key,h=_===void 0?0:this.data[A].indexOf(_),d=this.data[A][h];return this.data[A].splice(h,1),d.timeout&&clearTimeout(d.timeout),this.data[A].length===0&&delete this.data[A],this.onRemove(d.value),this.order.splice(this.order.indexOf(A),1),this}setMaxSize(c){for(this.max=c;this.order.length>this.max;){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}filter(c){const _=[];for(const A in this.data)for(const h of this.data[A])c(h.value)||_.push(h);for(const A of _)this.remove(A.value.tileID,A)}}class Tr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,_,A){const h=String(_);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][h]=this.stateChanges[c][h]||{},o.extend(this.stateChanges[c][h],A),this.deletedStates[c]===null){this.deletedStates[c]={};for(const d in this.state[c])d!==h&&(this.deletedStates[c][d]=null)}else if(this.deletedStates[c]&&this.deletedStates[c][h]===null){this.deletedStates[c][h]={};for(const d in this.state[c][h])A[d]||(this.deletedStates[c][h][d]=null)}else for(const d in A)this.deletedStates[c]&&this.deletedStates[c][h]&&this.deletedStates[c][h][d]===null&&delete this.deletedStates[c][h][d]}removeFeatureState(c,_,A){if(this.deletedStates[c]===null)return;const h=String(_);if(this.deletedStates[c]=this.deletedStates[c]||{},A&&_!==void 0)this.deletedStates[c][h]!==null&&(this.deletedStates[c][h]=this.deletedStates[c][h]||{},this.deletedStates[c][h][A]=null);else if(_!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][h])for(A in this.deletedStates[c][h]={},this.stateChanges[c][h])this.deletedStates[c][h][A]=null;else this.deletedStates[c][h]=null;else this.deletedStates[c]=null}getState(c,_){const A=String(_),h=o.extend({},(this.state[c]||{})[A],(this.stateChanges[c]||{})[A]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){const d=this.deletedStates[c][_];if(d===null)return{};for(const x in d)delete h[x]}return h}initializeTileState(c,_){c.setFeatureState(this.state,_)}coalesceChanges(c,_){const A={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const d={};for(const x in this.stateChanges[h])this.state[h][x]||(this.state[h][x]={}),o.extend(this.state[h][x],this.stateChanges[h][x]),d[x]=this.state[h][x];A[h]=d}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const d={};if(this.deletedStates[h]===null)for(const x in this.state[h])d[x]={},this.state[h][x]={};else for(const x in this.deletedStates[h]){if(this.deletedStates[h][x]===null)this.state[h][x]={};else for(const b of Object.keys(this.deletedStates[h][x]))delete this.state[h][x][b];d[x]=this.state[h][x]}A[h]=A[h]||{},o.extend(A[h],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(A).length!==0)for(const h in c)c[h].setFeatureState(A,_)}}class wt extends o.Evented{constructor(c,_,A){super(),this.id=c,this.dispatcher=A,this.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(h,d,x,b){const S=new Tn[d.type](h,d,x,b);if(S.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${S.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],S),S}(c,_,A,this),this._tiles={},this._cache=new Vn(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Tr}onAdd(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(c)}onRemove(c){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(c)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const c in this._tiles){const _=this._tiles[c];if(_.state!=="loaded"&&_.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(c,_){return this._source.loadTile(c,_)}_unloadTile(c){if(this._source.unloadTile)return this._source.unloadTile(c,()=>{})}_abortTile(c){this._source.abortTile&&this._source.abortTile(c,()=>{}),this._source.fire(new o.Event("dataabort",{tile:c,coord:c.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(c){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const _ in this._tiles){const A=this._tiles[_];A.upload(c),A.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(c=>c.tileID).sort(rn).map(c=>c.key)}getRenderableIds(c){const _=[];for(const A in this._tiles)this._isIdRenderable(A,c)&&_.push(this._tiles[A]);return c?_.sort((A,h)=>{const d=A.tileID,x=h.tileID,b=new o.pointGeometry(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),S=new o.pointGeometry(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-x.overscaledZ||S.y-b.y||S.x-b.x}).map(A=>A.tileID.key):_.map(A=>A.tileID).sort(rn).map(A=>A.key)}hasRenderableParent(c){const _=this.findLoadedParent(c,0);return!!_&&this._isIdRenderable(_.tileID.key)}_isIdRenderable(c,_){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(_||!this._tiles[c].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)this._tiles[c].state!=="errored"&&this._reloadTile(c,"reloading")}}_reloadTile(c,_){const A=this._tiles[c];A&&(A.state!=="loading"&&(A.state=_),this._loadTile(A,this._tileLoaded.bind(this,A,c,_)))}_tileLoaded(c,_,A,h){if(h)return c.state="errored",void(h.status!==404?this._source.fire(new o.ErrorEvent(h,{tile:c})):this.update(this.transform,this.terrain));c.timeAdded=o.exported.now(),A==="expired"&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(_,c),this.getSource().type==="raster-dem"&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),c.aborted||this._source.fire(new o.Event("data",{dataType:"source",tile:c,coord:c.tileID}))}_backfillDEM(c){const _=this.getRenderableIds();for(let h=0;h<_.length;h++){const d=_[h];if(c.neighboringTiles&&c.neighboringTiles[d]){const x=this.getTileByID(d);A(c,x),A(x,c)}}function A(h,d){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let x=d.tileID.canonical.x-h.tileID.canonical.x;const b=d.tileID.canonical.y-h.tileID.canonical.y,S=Math.pow(2,h.tileID.canonical.z),M=d.tileID.key;x===0&&b===0||Math.abs(b)>1||(Math.abs(x)>1&&(Math.abs(x+S)===1?x+=S:Math.abs(x-S)===1&&(x-=S)),d.dem&&h.dem&&(h.dem.backfillBorder(d.dem,x,b),h.neighboringTiles&&h.neighboringTiles[M]&&(h.neighboringTiles[M].backfilled=!0)))}}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._tiles[c]}_retainLoadedChildren(c,_,A,h){for(const d in this._tiles){let x=this._tiles[d];if(h[d]||!x.hasData()||x.tileID.overscaledZ<=_||x.tileID.overscaledZ>A)continue;let b=x.tileID;for(;x&&x.tileID.overscaledZ>_+1;){const M=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[M.key],x&&x.hasData()&&(b=M)}let S=b;for(;S.overscaledZ>_;)if(S=S.scaledTo(S.overscaledZ-1),c[S.key]){h[b.key]=b;break}}}findLoadedParent(c,_){if(c.key in this._loadedParentTiles){const A=this._loadedParentTiles[c.key];return A&&A.tileID.overscaledZ>=_?A:null}for(let A=c.overscaledZ-1;A>=_;A--){const h=c.scaledTo(A),d=this._getLoadedTile(h);if(d)return d}}_getLoadedTile(c){const _=this._tiles[c.key];return _&&_.hasData()?_:this._cache.getByKey(c.wrapped().key)}updateCacheSize(c){const _=Math.ceil(c.width/this._source.tileSize)+1,A=Math.ceil(c.height/this._source.tileSize)+1,h=Math.floor(_*A*5),d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(d)}handleWrapJump(c){const _=Math.round((c-(this._prevLng===void 0?c:this._prevLng))/360);if(this._prevLng=c,_){const A={};for(const h in this._tiles){const d=this._tiles[h];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+_),A[d.tileID.key]=d}this._tiles=A;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}update(c,_){if(this.transform=c,this.terrain=_,!this._sourceLoaded||this._paused)return;let A;this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?A=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new o.OverscaledTileID(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(A=c.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:_}),this._source.hasTile&&(A=A.filter(M=>this._source.hasTile(M)))):A=[];const h=c.coveringZoomLevel(this._source),d=Math.max(h-wt.maxOverzooming,this._source.minzoom),x=Math.max(h+wt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const M={};for(const B of A)if(B.canonical.z>this._source.minzoom){const V=B.scaledTo(B.canonical.z-1);M[V.key]=V;const j=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));M[j.key]=j}A=A.concat(Object.values(M))}const b=this._updateRetainedTiles(A,h);if(Mn(this._source.type)){const M={},B={},V=Object.keys(b);for(const j of V){const Y=b[j],ae=this._tiles[j];if(!ae||ae.fadeEndTime&&ae.fadeEndTime<=o.exported.now())continue;const ne=this.findLoadedParent(Y,d);ne&&(this._addTile(ne.tileID),M[ne.tileID.key]=ne.tileID),B[j]=Y}this._retainLoadedChildren(B,h,x,b);for(const j in M)b[j]||(this._coveredTiles[j]=!0,b[j]=M[j]);if(_){const j={},Y={};for(const ae of A)this._tiles[ae.key].hasData()?j[ae.key]=ae:Y[ae.key]=ae;for(const ae in Y){const ne=Y[ae].children(this._source.maxzoom);this._tiles[ne[0].key]&&this._tiles[ne[1].key]&&this._tiles[ne[2].key]&&this._tiles[ne[3].key]&&(j[ne[0].key]=b[ne[0].key]=ne[0],j[ne[1].key]=b[ne[1].key]=ne[1],j[ne[2].key]=b[ne[2].key]=ne[2],j[ne[3].key]=b[ne[3].key]=ne[3],delete Y[ae])}for(const ae in Y){const ne=this.findLoadedParent(Y[ae],this._source.minzoom);if(ne){j[ne.tileID.key]=b[ne.tileID.key]=ne.tileID;for(const ue in j)j[ue].isChildOf(ne.tileID)&&delete j[ue]}}for(const ae in this._tiles)j[ae]||(this._coveredTiles[ae]=!0)}}for(const M in b)this._tiles[M].clearFadeHold();const S=o.keysDifference(this._tiles,b);for(const M of S){const B=this._tiles[M];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(M)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(c)}_updateRetainedTiles(c,_){const A={},h={},d=Math.max(_-wt.maxOverzooming,this._source.minzoom),x=Math.max(_+wt.maxUnderzooming,this._source.minzoom),b={};for(const S of c){const M=this._addTile(S);A[S.key]=S,M.hasData()||_<this._source.maxzoom&&(b[S.key]=S)}this._retainLoadedChildren(b,_,x,A);for(const S of c){let M=this._tiles[S.key];if(M.hasData())continue;if(_+1>this._source.maxzoom){const V=S.children(this._source.maxzoom)[0],j=this.getTile(V);if(j&&j.hasData()){A[V.key]=V;continue}}else{const V=S.children(this._source.maxzoom);if(A[V[0].key]&&A[V[1].key]&&A[V[2].key]&&A[V[3].key])continue}let B=M.wasRequested();for(let V=S.overscaledZ-1;V>=d;--V){const j=S.scaledTo(V);if(h[j.key]||(h[j.key]=!0,M=this.getTile(j),!M&&B&&(M=this._addTile(j)),M&&(A[j.key]=j,B=M.wasRequested(),M.hasData())))break}}return A}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const c in this._tiles){const _=[];let A,h=this._tiles[c].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){A=this._loadedParentTiles[h.key];break}_.push(h.key);const d=h.scaledTo(h.overscaledZ-1);if(A=this._getLoadedTile(d),A)break;h=d}for(const d of _)this._loadedParentTiles[d]=A}}_addTile(c){let _=this._tiles[c.key];if(_)return _;_=this._cache.getAndRemove(c),_&&(this._setTileReloadTimer(c.key,_),_.tileID=c,this._state.initializeTileState(_,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,_)));const A=_;return _||(_=new hr(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(_,this._tileLoaded.bind(this,_,c.key,_.state))),_.uses++,this._tiles[c.key]=_,A||this._source.fire(new o.Event("dataloading",{tile:_,coord:_.tileID,dataType:"source"})),_}_setTileReloadTimer(c,_){c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);const A=_.getExpiryTimeout();A&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},A))}_removeTile(c){const _=this._tiles[c];_&&(_.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),_.uses>0||(_.hasData()&&_.state!=="reloading"?this._cache.add(_.tileID,_,_.getExpiryTimeout()):(_.aborted=!0,this._abortTile(_),this._unloadTile(_))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const c in this._tiles)this._removeTile(c);this._cache.reset()}tilesIn(c,_,A){const h=[],d=this.transform;if(!d)return h;const x=A?d.getCameraQueryGeometry(c):c,b=c.map(ae=>d.pointCoordinate(ae,this.terrain)),S=x.map(ae=>d.pointCoordinate(ae,this.terrain)),M=this.getIds();let B=1/0,V=1/0,j=-1/0,Y=-1/0;for(const ae of S)B=Math.min(B,ae.x),V=Math.min(V,ae.y),j=Math.max(j,ae.x),Y=Math.max(Y,ae.y);for(let ae=0;ae<M.length;ae++){const ne=this._tiles[M[ae]];if(ne.holdingForFade())continue;const ue=ne.tileID,be=Math.pow(2,d.zoom-ne.tileID.overscaledZ),Me=_*ne.queryPadding*o.EXTENT/ne.tileSize/be,ve=[ue.getTilePoint(new o.MercatorCoordinate(B,V)),ue.getTilePoint(new o.MercatorCoordinate(j,Y))];if(ve[0].x-Me<o.EXTENT&&ve[0].y-Me<o.EXTENT&&ve[1].x+Me>=0&&ve[1].y+Me>=0){const $e=b.map(Ge=>ue.getTilePoint(Ge)),Te=S.map(Ge=>ue.getTilePoint(Ge));h.push({tile:ne,tileID:ue,queryGeometry:$e,cameraQueryGeometry:Te,scale:be})}}return h}getVisibleCoordinates(c){const _=this.getRenderableIds(c).map(A=>this._tiles[A].tileID);for(const A of _)A.posMatrix=this.transform.calculatePosMatrix(A.toUnwrapped());return _}hasTransition(){if(this._source.hasTransition())return!0;if(Mn(this._source.type))for(const c in this._tiles){const _=this._tiles[c];if(_.fadeEndTime!==void 0&&_.fadeEndTime>=o.exported.now())return!0}return!1}setFeatureState(c,_,A){this._state.updateState(c=c||"_geojsonTileLayer",_,A)}removeFeatureState(c,_,A){this._state.removeFeatureState(c=c||"_geojsonTileLayer",_,A)}getFeatureState(c,_){return this._state.getState(c=c||"_geojsonTileLayer",_)}setDependencies(c,_,A){const h=this._tiles[c];h&&h.setDependencies(_,A)}reloadTilesForDependencies(c,_){for(const A in this._tiles)this._tiles[A].hasDependency(c,_)&&this._reloadTile(A,"reloading");this._cache.filter(A=>!A.hasDependency(c,_))}}function rn(L,c){const _=Math.abs(2*L.wrap)-+(L.wrap<0),A=Math.abs(2*c.wrap)-+(c.wrap<0);return L.overscaledZ-c.overscaledZ||A-_||c.canonical.y-L.canonical.y||c.canonical.x-L.canonical.x}function Mn(L){return L==="raster"||L==="image"||L==="video"}wt.maxOverzooming=10,wt.maxUnderzooming=3;const xt="mapboxgl_preloaded_worker_pool";class nr{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<nr.workerCount;)this.workers.push(new Worker(Zs.workerUrl));return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(_=>{_.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[xt]}numActive(){return Object.keys(this.active).length}}const Wn=Math.floor(o.exported.hardwareConcurrency/2);let vr;function lr(){return vr||(vr=new nr),vr}function rr(L,c){const _={};for(const A in L)A!=="ref"&&(_[A]=L[A]);return o.refProperties.forEach(A=>{A in c&&(_[A]=c[A])}),_}function ti(L){L=L.slice();const c=Object.create(null);for(let _=0;_<L.length;_++)c[L[_].id]=L[_];for(let _=0;_<L.length;_++)"ref"in L[_]&&(L[_]=rr(L[_],c[L[_].ref]));return L}nr.workerCount=Math.max(Math.min(Wn,6),1);const Gn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Pi(L,c,_){_.push({command:Gn.addSource,args:[L,c[L]]})}function qn(L,c,_){c.push({command:Gn.removeSource,args:[L]}),_[L]=!0}function Vi(L,c,_,A){qn(L,_,A),Pi(L,c,_)}function mo(L,c,_){let A;for(A in L[_])if(Object.prototype.hasOwnProperty.call(L[_],A)&&A!=="data"&&!P(L[_][A],c[_][A]))return!1;for(A in c[_])if(Object.prototype.hasOwnProperty.call(c[_],A)&&A!=="data"&&!P(L[_][A],c[_][A]))return!1;return!0}function Gr(L,c,_,A,h,d){let x;for(x in c=c||{},L=L||{})Object.prototype.hasOwnProperty.call(L,x)&&(P(L[x],c[x])||_.push({command:d,args:[A,x,c[x],h]}));for(x in c)Object.prototype.hasOwnProperty.call(c,x)&&!Object.prototype.hasOwnProperty.call(L,x)&&(P(L[x],c[x])||_.push({command:d,args:[A,x,c[x],h]}))}function ki(L){return L.id}function Vo(L,c){return L[c.id]=c,L}class os{constructor(c,_){this.reset(c,_)}reset(c,_){this.points=c||[],this._distances=[0];for(let A=1;A<this.points.length;A++)this._distances[A]=this._distances[A-1]+this.points[A].dist(this.points[A-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(_||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=o.clamp(c,0,1);let _=1,A=this._distances[_];const h=c*this.paddedLength+this.padding;for(;A<h&&_<this._distances.length;)A=this._distances[++_];const d=_-1,x=this._distances[d],b=A-x,S=b>0?(h-x)/b:0;return this.points[d].mult(1-S).add(this.points[_].mult(S))}}function ht(L,c){let _=!0;return L==="always"||L!=="never"&&c!=="never"||(_=!1),_}class It{constructor(c,_,A){const h=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(c/A),this.yCellCount=Math.ceil(_/A);for(let x=0;x<this.xCellCount*this.yCellCount;x++)h.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=_,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/_,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,_,A,h,d){this._forEachCell(_,A,h,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(_),this.bboxes.push(A),this.bboxes.push(h),this.bboxes.push(d)}insertCircle(c,_,A,h){this._forEachCell(_-h,A-h,_+h,A+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(_),this.circles.push(A),this.circles.push(h)}_insertBoxCell(c,_,A,h,d,x){this.boxCells[d].push(x)}_insertCircleCell(c,_,A,h,d,x){this.circleCells[d].push(x)}_query(c,_,A,h,d,x,b){if(A<0||c>this.width||h<0||_>this.height)return[];const S=[];if(c<=0&&_<=0&&this.width<=A&&this.height<=h){if(d)return[{key:null,x1:c,y1:_,x2:A,y2:h}];for(let M=0;M<this.boxKeys.length;M++)S.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const B=this.circles[3*M],V=this.circles[3*M+1],j=this.circles[3*M+2];S.push({key:this.circleKeys[M],x1:B-j,y1:V-j,x2:B+j,y2:V+j})}}else this._forEachCell(c,_,A,h,this._queryCell,S,{hitTest:d,overlapMode:x,seenUids:{box:{},circle:{}}},b);return S}query(c,_,A,h){return this._query(c,_,A,h,!1,null)}hitTest(c,_,A,h,d,x){return this._query(c,_,A,h,!0,d,x).length>0}hitTestCircle(c,_,A,h,d){const x=c-A,b=c+A,S=_-A,M=_+A;if(b<0||x>this.width||M<0||S>this.height)return!1;const B=[];return this._forEachCell(x,S,b,M,this._queryCellCircle,B,{hitTest:!0,overlapMode:h,circle:{x:c,y:_,radius:A},seenUids:{box:{},circle:{}}},d),B.length>0}_queryCell(c,_,A,h,d,x,b,S){const{seenUids:M,hitTest:B,overlapMode:V}=b,j=this.boxCells[d];if(j!==null){const ae=this.bboxes;for(const ne of j)if(!M.box[ne]){M.box[ne]=!0;const ue=4*ne,be=this.boxKeys[ne];if(c<=ae[ue+2]&&_<=ae[ue+3]&&A>=ae[ue+0]&&h>=ae[ue+1]&&(!S||S(be))&&(!B||!ht(V,be.overlapMode))&&(x.push({key:be,x1:ae[ue],y1:ae[ue+1],x2:ae[ue+2],y2:ae[ue+3]}),B))return!0}}const Y=this.circleCells[d];if(Y!==null){const ae=this.circles;for(const ne of Y)if(!M.circle[ne]){M.circle[ne]=!0;const ue=3*ne,be=this.circleKeys[ne];if(this._circleAndRectCollide(ae[ue],ae[ue+1],ae[ue+2],c,_,A,h)&&(!S||S(be))&&(!B||!ht(V,be.overlapMode))){const Me=ae[ue],ve=ae[ue+1],$e=ae[ue+2];if(x.push({key:be,x1:Me-$e,y1:ve-$e,x2:Me+$e,y2:ve+$e}),B)return!0}}}return!1}_queryCellCircle(c,_,A,h,d,x,b,S){const{circle:M,seenUids:B,overlapMode:V}=b,j=this.boxCells[d];if(j!==null){const ae=this.bboxes;for(const ne of j)if(!B.box[ne]){B.box[ne]=!0;const ue=4*ne,be=this.boxKeys[ne];if(this._circleAndRectCollide(M.x,M.y,M.radius,ae[ue+0],ae[ue+1],ae[ue+2],ae[ue+3])&&(!S||S(be))&&!ht(V,be.overlapMode))return x.push(!0),!0}}const Y=this.circleCells[d];if(Y!==null){const ae=this.circles;for(const ne of Y)if(!B.circle[ne]){B.circle[ne]=!0;const ue=3*ne,be=this.circleKeys[ne];if(this._circlesCollide(ae[ue],ae[ue+1],ae[ue+2],M.x,M.y,M.radius)&&(!S||S(be))&&!ht(V,be.overlapMode))return x.push(!0),!0}}}_forEachCell(c,_,A,h,d,x,b,S){const M=this._convertToXCellCoord(c),B=this._convertToYCellCoord(_),V=this._convertToXCellCoord(A),j=this._convertToYCellCoord(h);for(let Y=M;Y<=V;Y++)for(let ae=B;ae<=j;ae++)if(d.call(this,c,_,A,h,this.xCellCount*ae+Y,x,b,S))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,_,A,h,d,x){const b=h-c,S=d-_,M=A+x;return M*M>b*b+S*S}_circleAndRectCollide(c,_,A,h,d,x,b){const S=(x-h)/2,M=Math.abs(c-(h+S));if(M>S+A)return!1;const B=(b-d)/2,V=Math.abs(_-(d+B));if(V>B+A)return!1;if(M<=S||V<=B)return!0;const j=M-S,Y=V-B;return j*j+Y*Y<=A*A}}function Fs(L,c,_,A,h){const d=o.create();return c?(o.scale(d,d,[1/h,1/h,1]),_||o.rotateZ(d,d,A.angle)):o.multiply(d,A.labelPlaneMatrix,L),d}function wi(L,c,_,A,h){if(c){const d=o.clone(L);return o.scale(d,d,[h,h,1]),_||o.rotateZ(d,d,-A.angle),d}return A.glCoordMatrix}function zn(L,c,_){let A;_?(A=[L.x,L.y,_(L.x,L.y),1],o.transformMat4(A,A,c)):(A=[L.x,L.y,0,1],Ye(A,A,c));const h=A[3];return{point:new o.pointGeometry(A[0]/h,A[1]/h),signedDistanceFromCamera:h}}function Gi(L,c){return .5+L/c*.5}function Ii(L,c){const _=L[0]/L[3],A=L[1]/L[3];return _>=-c[0]&&_<=c[0]&&A>=-c[1]&&A<=c[1]}function Li(L,c,_,A,h,d,x,b,S,M){const B=A?L.textSizeData:L.iconSizeData,V=o.evaluateSizeForZoom(B,_.transform.zoom),j=[256/_.width*2+1,256/_.height*2+1],Y=A?L.text.dynamicLayoutVertexArray:L.icon.dynamicLayoutVertexArray;Y.clear();const ae=L.lineVertexArray,ne=A?L.text.placedSymbolArray:L.icon.placedSymbolArray,ue=_.transform.width/_.transform.height;let be=!1;for(let Me=0;Me<ne.length;Me++){const ve=ne.get(Me);if(ve.hidden||ve.writingMode===o.WritingMode.vertical&&!be){yn(ve.numGlyphs,Y);continue}let $e;if(be=!1,M?($e=[ve.anchorX,ve.anchorY,M(ve.anchorX,ve.anchorY),1],o.transformMat4($e,$e,c)):($e=[ve.anchorX,ve.anchorY,0,1],Ye($e,$e,c)),!Ii($e,j)){yn(ve.numGlyphs,Y);continue}const Te=Gi(_.transform.cameraToCenterDistance,$e[3]),Ge=o.evaluateSizeForFeature(B,V,ve),xe=x?Ge/Te:Ge*Te,y=new o.pointGeometry(ve.anchorX,ve.anchorY),m=zn(y,h,M).point,v={},E=Sn(ve,xe,!1,b,c,h,d,L.glyphOffsetArray,ae,Y,m,y,v,ue,S,M);be=E.useVertical,(E.notEnoughRoom||be||E.needsFlipping&&Sn(ve,xe,!0,b,c,h,d,L.glyphOffsetArray,ae,Y,m,y,v,ue,S,M).notEnoughRoom)&&yn(ve.numGlyphs,Y)}A?L.text.dynamicLayoutVertexBuffer.updateData(Y):L.icon.dynamicLayoutVertexBuffer.updateData(Y)}function as(L,c,_,A,h,d,x,b,S,M,B,V,j){const Y=b.glyphStartIndex+b.numGlyphs,ae=b.lineStartIndex,ne=b.lineStartIndex+b.lineLength,ue=c.getoffsetX(b.glyphStartIndex),be=c.getoffsetX(Y-1),Me=Lr(L*ue,_,A,h,d,x,b.segment,ae,ne,S,M,B,V,j);if(!Me)return null;const ve=Lr(L*be,_,A,h,d,x,b.segment,ae,ne,S,M,B,V,j);return ve?{first:Me,last:ve}:null}function Lt(L,c,_,A){return L===o.WritingMode.horizontal&&Math.abs(_.y-c.y)>Math.abs(_.x-c.x)*A?{useVertical:!0}:(L===o.WritingMode.vertical?c.y<_.y:c.x>_.x)?{needsFlipping:!0}:null}function Sn(L,c,_,A,h,d,x,b,S,M,B,V,j,Y,ae,ne){const ue=c/24,be=L.lineOffsetX*ue,Me=L.lineOffsetY*ue;let ve;if(L.numGlyphs>1){const $e=L.glyphStartIndex+L.numGlyphs,Te=L.lineStartIndex,Ge=L.lineStartIndex+L.lineLength,xe=as(ue,b,be,Me,_,B,V,L,S,d,j,ae,ne);if(!xe)return{notEnoughRoom:!0};const y=zn(xe.first.point,x,ne).point,m=zn(xe.last.point,x,ne).point;if(A&&!_){const v=Lt(L.writingMode,y,m,Y);if(v)return v}ve=[xe.first];for(let v=L.glyphStartIndex+1;v<$e-1;v++)ve.push(Lr(ue*b.getoffsetX(v),be,Me,_,B,V,L.segment,Te,Ge,S,d,j,ae,ne));ve.push(xe.last)}else{if(A&&!_){const Te=zn(V,h,ne).point,Ge=L.lineStartIndex+L.segment+1,xe=new o.pointGeometry(S.getx(Ge),S.gety(Ge)),y=zn(xe,h,ne),m=y.signedDistanceFromCamera>0?y.point:bn(V,xe,Te,1,h,ne),v=Lt(L.writingMode,Te,m,Y);if(v)return v}const $e=Lr(ue*b.getoffsetX(L.glyphStartIndex),be,Me,_,B,V,L.segment,L.lineStartIndex,L.lineStartIndex+L.lineLength,S,d,j,ae,ne);if(!$e)return{notEnoughRoom:!0};ve=[$e]}for(const $e of ve)o.addDynamicAttributes(M,$e.point,$e.angle);return{}}function bn(L,c,_,A,h,d){const x=zn(L.add(L.sub(c)._unit()),h,d).point,b=_.sub(x);return _.add(b._mult(A/b.mag()))}function Lr(L,c,_,A,h,d,x,b,S,M,B,V,j,Y){const ae=A?L-c:L+c;let ne=ae>0?1:-1,ue=0;A&&(ne*=-1,ue=Math.PI),ne<0&&(ue+=Math.PI);let be=ne>0?b+x:b+x+1,Me=h,ve=h,$e=0,Te=0;const Ge=Math.abs(ae),xe=[];for(;$e+Te<=Ge;){if(be+=ne,be<b||be>=S)return null;if(ve=Me,xe.push(Me),Me=V[be],Me===void 0){const k=new o.pointGeometry(M.getx(be),M.gety(be)),R=zn(k,B,Y);if(R.signedDistanceFromCamera>0)Me=V[be]=R.point;else{const O=be-ne;Me=bn($e===0?d:new o.pointGeometry(M.getx(O),M.gety(O)),k,ve,Ge-$e+1,B,Y)}}$e+=Te,Te=ve.dist(Me)}const y=(Ge-$e)/Te,m=Me.sub(ve),v=m.mult(y)._add(ve);v._add(m._unit()._perp()._mult(_*ne));const E=ue+Math.atan2(Me.y-ve.y,Me.x-ve.x);return xe.push(v),{point:v,angle:j?E:0,path:xe}}const bs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function yn(L,c){for(let _=0;_<L;_++){const A=c.length;c.resize(A+4),c.float32.set(bs,3*A)}}function Ye(L,c,_){const A=c[0],h=c[1];return L[0]=_[0]*A+_[4]*h+_[12],L[1]=_[1]*A+_[5]*h+_[13],L[3]=_[3]*A+_[7]*h+_[15],L}const Qr=100;class Ns{constructor(c,_=new It(c.width+200,c.height+200,25),A=new It(c.width+200,c.height+200,25)){this.transform=c,this.grid=_,this.ignoredGrid=A,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Qr,this.screenBottomBoundary=c.height+Qr,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(c,_,A,h,d,x){const b=this.projectAndGetPerspectiveRatio(h,c.anchorPointX,c.anchorPointY,x),S=A*b.perspectiveRatio,M=c.x1*S+b.point.x,B=c.y1*S+b.point.y,V=c.x2*S+b.point.x,j=c.y2*S+b.point.y;return!this.isInsideGrid(M,B,V,j)||_!=="always"&&this.grid.hitTest(M,B,V,j,_,d)||b.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[M,B,V,j],offscreen:this.isOffscreen(M,B,V,j)}}placeCollisionCircles(c,_,A,h,d,x,b,S,M,B,V,j,Y,ae){const ne=[],ue=new o.pointGeometry(_.anchorX,_.anchorY),be=zn(ue,x,ae),Me=Gi(this.transform.cameraToCenterDistance,be.signedDistanceFromCamera),ve=(B?d/Me:d*Me)/o.ONE_EM,$e=zn(ue,b,ae).point,Te=as(ve,h,_.lineOffsetX*ve,_.lineOffsetY*ve,!1,$e,ue,_,A,b,{},!1,ae);let Ge=!1,xe=!1,y=!0;if(Te){const m=.5*j*Me+Y,v=new o.pointGeometry(-100,-100),E=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),k=new os,R=Te.first,O=Te.last;let N=[];for(let le=R.path.length-1;le>=1;le--)N.push(R.path[le]);for(let le=1;le<O.path.length;le++)N.push(O.path[le]);const q=2.5*m;if(S){const le=N.map(de=>zn(de,S,ae));N=le.some(de=>de.signedDistanceFromCamera<=0)?[]:le.map(de=>de.point)}let J=[];if(N.length>0){const le=N[0].clone(),de=N[0].clone();for(let Re=1;Re<N.length;Re++)le.x=Math.min(le.x,N[Re].x),le.y=Math.min(le.y,N[Re].y),de.x=Math.max(de.x,N[Re].x),de.y=Math.max(de.y,N[Re].y);J=le.x>=v.x&&de.x<=E.x&&le.y>=v.y&&de.y<=E.y?[N]:de.x<v.x||le.x>E.x||de.y<v.y||le.y>E.y?[]:o.clipLine([N],v.x,v.y,E.x,E.y)}for(const le of J){k.reset(le,.25*m);let de=0;de=k.length<=.5*m?1:Math.ceil(k.paddedLength/q)+1;for(let Re=0;Re<de;Re++){const je=Re/Math.max(de-1,1),Be=k.lerp(je),Xe=Be.x+Qr,ft=Be.y+Qr;ne.push(Xe,ft,m,0);const ct=Xe-m,st=ft-m,ot=Xe+m,Je=ft+m;if(y=y&&this.isOffscreen(ct,st,ot,Je),xe=xe||this.isInsideGrid(ct,st,ot,Je),c!=="always"&&this.grid.hitTestCircle(Xe,ft,m,c,V)&&(Ge=!0,!M))return{circles:[],offscreen:!1,collisionDetected:Ge}}}}return{circles:!M&&Ge||!xe||Me<this.perspectiveRatioCutoff?[]:ne,offscreen:y,collisionDetected:Ge}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const _=[];let A=1/0,h=1/0,d=-1/0,x=-1/0;for(const B of c){const V=new o.pointGeometry(B.x+Qr,B.y+Qr);A=Math.min(A,V.x),h=Math.min(h,V.y),d=Math.max(d,V.x),x=Math.max(x,V.y),_.push(V)}const b=this.grid.query(A,h,d,x).concat(this.ignoredGrid.query(A,h,d,x)),S={},M={};for(const B of b){const V=B.key;if(S[V.bucketInstanceId]===void 0&&(S[V.bucketInstanceId]={}),S[V.bucketInstanceId][V.featureIndex])continue;const j=[new o.pointGeometry(B.x1,B.y1),new o.pointGeometry(B.x2,B.y1),new o.pointGeometry(B.x2,B.y2),new o.pointGeometry(B.x1,B.y2)];o.polygonIntersectsPolygon(_,j)&&(S[V.bucketInstanceId][V.featureIndex]=!0,M[V.bucketInstanceId]===void 0&&(M[V.bucketInstanceId]=[]),M[V.bucketInstanceId].push(V.featureIndex))}return M}insertCollisionBox(c,_,A,h,d,x){(A?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:d,collisionGroupID:x,overlapMode:_},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,_,A,h,d,x){const b=A?this.ignoredGrid:this.grid,S={bucketInstanceId:h,featureIndex:d,collisionGroupID:x,overlapMode:_};for(let M=0;M<c.length;M+=4)b.insertCircle(S,c[M],c[M+1],c[M+2])}projectAndGetPerspectiveRatio(c,_,A,h){let d;return h?(d=[_,A,h(_,A),1],o.transformMat4(d,d,c)):(d=[_,A,0,1],Ye(d,d,c)),{point:new o.pointGeometry((d[0]/d[3]+1)/2*this.transform.width+Qr,(-d[1]/d[3]+1)/2*this.transform.height+Qr),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}}isOffscreen(c,_,A,h){return A<Qr||c>=this.screenRightBoundary||h<Qr||_>this.screenBottomBoundary}isInsideGrid(c,_,A,h){return A>=0&&c<this.gridRightBoundary&&h>=0&&_<this.gridBottomBoundary}getViewportMatrix(){const c=o.identity([]);return o.translate(c,c,[-100,-100,0]),c}}function Or(L,c,_){return c*(o.EXTENT/(L.tileSize*Math.pow(2,_-L.tileID.overscaledZ)))}class Ai{constructor(c,_,A,h){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?_:-_))):h&&A?1:0,this.placed=A}isHidden(){return this.opacity===0&&!this.placed}}class Xn{constructor(c,_,A,h,d){this.text=new Ai(c?c.text:null,_,A,d),this.icon=new Ai(c?c.icon:null,_,h,d)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Us{constructor(c,_,A){this.text=c,this.icon=_,this.skipFade=A}}class $i{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class ji{constructor(c,_,A,h,d){this.bucketInstanceId=c,this.featureIndex=_,this.sourceLayerIndex=A,this.bucketIndex=h,this.tileID=d}}class Di{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const _=++this.maxGroupID;this.collisionGroups[c]={ID:_,predicate:A=>A.collisionGroupID===_}}return this.collisionGroups[c]}}function ls(L,c,_,A,h){const{horizontalAlign:d,verticalAlign:x}=o.getAnchorAlignment(L),b=-(d-.5)*c,S=-(x-.5)*_,M=o.evaluateVariableOffset(L,A);return new o.pointGeometry(b+M[0]*h,S+M[1]*h)}function Fr(L,c,_,A,h,d){const{x1:x,x2:b,y1:S,y2:M,anchorPointX:B,anchorPointY:V}=L,j=new o.pointGeometry(c,_);return A&&j._rotate(h?d:-d),{x1:x+j.x,y1:S+j.y,x2:b+j.x,y2:M+j.y,anchorPointX:B,anchorPointY:V}}class K{constructor(c,_,A,h,d){this.transform=c.clone(),this.terrain=_,this.collisionIndex=new Ns(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=A,this.retainedQueryData={},this.collisionGroups=new Di(h),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,_,A,h){const d=A.getBucket(_),x=A.latestFeatureIndex;if(!d||!x||_.id!==d.layerIds[0])return;const b=A.collisionBoxArray,S=d.layers[0].layout,M=Math.pow(2,this.transform.zoom-A.tileID.overscaledZ),B=A.tileSize/o.EXTENT,V=this.transform.calculatePosMatrix(A.tileID.toUnwrapped()),j=S.get("text-pitch-alignment")==="map",Y=S.get("text-rotation-alignment")==="map",ae=Or(A,1,this.transform.zoom),ne=Fs(V,j,Y,this.transform,ae);let ue=null;if(j){const Me=wi(V,j,Y,this.transform,ae);ue=o.multiply([],this.transform.labelPlaneMatrix,Me)}this.retainedQueryData[d.bucketInstanceId]=new ji(d.bucketInstanceId,x,d.sourceLayerIndex,d.index,A.tileID);const be={bucket:d,layout:S,posMatrix:V,textLabelPlaneMatrix:ne,labelToScreenMatrix:ue,scale:M,textPixelRatio:B,holdingForFade:A.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(h)for(const Me of d.sortKeyRanges){const{sortKey:ve,symbolInstanceStart:$e,symbolInstanceEnd:Te}=Me;c.push({sortKey:ve,symbolInstanceStart:$e,symbolInstanceEnd:Te,parameters:be})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:be})}attemptAnchorPlacement(c,_,A,h,d,x,b,S,M,B,V,j,Y,ae,ne,ue){const be=[j.textOffset0,j.textOffset1],Me=ls(c,A,h,be,d),ve=this.collisionIndex.placeCollisionBox(Fr(_,Me.x,Me.y,x,b,this.transform.angle),V,S,M,B.predicate,ue);if((!ne||this.collisionIndex.placeCollisionBox(Fr(ne,Me.x,Me.y,x,b,this.transform.angle),V,S,M,B.predicate,ue).box.length!==0)&&ve.box.length>0){let $e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID].text&&($e=this.prevPlacement.variableOffsets[j.crossTileID].anchor),j.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[j.crossTileID]={textOffset:be,width:A,height:h,anchor:c,textBoxScale:d,prevAnchor:$e},this.markUsedJustification(Y,c,j,ae),Y.allowVerticalPlacement&&(this.markUsedOrientation(Y,ae,j),this.placedOrientations[j.crossTileID]=ae),{shift:Me,placedGlyphBoxes:ve}}}placeLayerBucketPart(c,_,A){const{bucket:h,layout:d,posMatrix:x,textLabelPlaneMatrix:b,labelToScreenMatrix:S,textPixelRatio:M,holdingForFade:B,collisionBoxArray:V,partiallyEvaluatedTextSize:j,collisionGroup:Y}=c.parameters,ae=d.get("text-optional"),ne=d.get("icon-optional"),ue=o.getOverlapMode(d,"text-overlap","text-allow-overlap"),be=ue==="always",Me=o.getOverlapMode(d,"icon-overlap","icon-allow-overlap"),ve=Me==="always",$e=d.get("text-rotation-alignment")==="map",Te=d.get("text-pitch-alignment")==="map",Ge=d.get("icon-text-fit")!=="none",xe=d.get("symbol-z-order")==="viewport-y",y=be&&(ve||!h.hasIconData()||ne),m=ve&&(be||!h.hasTextData()||ae);!h.collisionArrays&&V&&h.deserializeCollisionBoxes(V);const v=(E,k)=>{if(_[E.crossTileID])return;if(B)return void(this.placements[E.crossTileID]=new Us(!1,!1,!1));let R=!1,O=!1,N=!0,q=null,J={box:null,offscreen:null},le={box:null,offscreen:null},de=null,Re=null,je=null,Be=0,Xe=0,ft=0;k.textFeatureIndex?Be=k.textFeatureIndex:E.useRuntimeCollisionCircles&&(Be=E.featureIndex),k.verticalTextFeatureIndex&&(Xe=k.verticalTextFeatureIndex);const ct=this.retainedQueryData[h.bucketInstanceId].tileID,st=this.terrain?(zt,pt)=>this.terrain.getElevation(ct,zt,pt):null;for(const zt of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const pt=k[zt];pt&&(pt.elevation=st?st(pt.anchorPointX,pt.anchorPointY):0)}const ot=k.textBox;if(ot){const zt=vt=>{let Pn=o.WritingMode.horizontal;if(h.allowVerticalPlacement&&!vt&&this.prevPlacement){const wn=this.prevPlacement.placedOrientations[E.crossTileID];wn&&(this.placedOrientations[E.crossTileID]=wn,Pn=wn,this.markUsedOrientation(h,Pn,E))}return Pn},pt=(vt,Pn)=>{if(h.allowVerticalPlacement&&E.numVerticalGlyphVertices>0&&k.verticalTextBox){for(const wn of h.writingModes)if(wn===o.WritingMode.vertical?(J=Pn(),le=J):J=vt(),J&&J.box&&J.box.length)break}else J=vt()};if(d.get("text-variable-anchor")){let vt=d.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[E.crossTileID]){const mn=this.prevPlacement.variableOffsets[E.crossTileID];vt.indexOf(mn.anchor)>0&&(vt=vt.filter(_n=>_n!==mn.anchor),vt.unshift(mn.anchor))}const Pn=(mn,_n,En)=>{const Dn=mn.x2-mn.x1,ar=mn.y2-mn.y1,kn=E.textBoxScale,br=Ge&&Me==="never"?_n:null;let Yr={box:[],offscreen:!1};const il=ue!=="never"?2*vt.length:vt.length;for(let Tu=0;Tu<il;++Tu){const Hf=this.attemptAnchorPlacement(vt[Tu%vt.length],mn,Dn,ar,kn,$e,Te,M,x,Y,Tu>=vt.length?ue:"never",E,h,En,br,st);if(Hf&&(Yr=Hf.placedGlyphBoxes,Yr&&Yr.box&&Yr.box.length)){R=!0,q=Hf.shift;break}}return Yr};pt(()=>Pn(ot,k.iconBox,o.WritingMode.horizontal),()=>{const mn=k.verticalTextBox;return h.allowVerticalPlacement&&!(J&&J.box&&J.box.length)&&E.numVerticalGlyphVertices>0&&mn?Pn(mn,k.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),J&&(R=J.box,N=J.offscreen);const wn=zt(J&&J.box);if(!R&&this.prevPlacement){const mn=this.prevPlacement.variableOffsets[E.crossTileID];mn&&(this.variableOffsets[E.crossTileID]=mn,this.markUsedJustification(h,mn.anchor,E,wn))}}else{const vt=(Pn,wn)=>{const mn=this.collisionIndex.placeCollisionBox(Pn,ue,M,x,Y.predicate,st);return mn&&mn.box&&mn.box.length&&(this.markUsedOrientation(h,wn,E),this.placedOrientations[E.crossTileID]=wn),mn};pt(()=>vt(ot,o.WritingMode.horizontal),()=>{const Pn=k.verticalTextBox;return h.allowVerticalPlacement&&E.numVerticalGlyphVertices>0&&Pn?vt(Pn,o.WritingMode.vertical):{box:null,offscreen:null}}),zt(J&&J.box&&J.box.length)}}if(de=J,R=de&&de.box&&de.box.length>0,N=de&&de.offscreen,E.useRuntimeCollisionCircles){const zt=h.text.placedSymbolArray.get(E.centerJustifiedTextSymbolIndex),pt=o.evaluateSizeForFeature(h.textSizeData,j,zt),vt=d.get("text-padding");Re=this.collisionIndex.placeCollisionCircles(ue,zt,h.lineVertexArray,h.glyphOffsetArray,pt,x,b,S,A,Te,Y.predicate,E.collisionCircleDiameter,vt,st),Re.circles.length&&Re.collisionDetected&&!A&&o.warnOnce("Collisions detected, but collision boxes are not shown"),R=be||Re.circles.length>0&&!Re.collisionDetected,N=N&&Re.offscreen}if(k.iconFeatureIndex&&(ft=k.iconFeatureIndex),k.iconBox){const zt=pt=>{const vt=Ge&&q?Fr(pt,q.x,q.y,$e,Te,this.transform.angle):pt;return this.collisionIndex.placeCollisionBox(vt,Me,M,x,Y.predicate,st)};le&&le.box&&le.box.length&&k.verticalIconBox?(je=zt(k.verticalIconBox),O=je.box.length>0):(je=zt(k.iconBox),O=je.box.length>0),N=N&&je.offscreen}const Je=ae||E.numHorizontalGlyphVertices===0&&E.numVerticalGlyphVertices===0,Gt=ne||E.numIconVertices===0;if(Je||Gt?Gt?Je||(O=O&&R):R=O&&R:O=R=O&&R,R&&de&&de.box&&this.collisionIndex.insertCollisionBox(de.box,ue,d.get("text-ignore-placement"),h.bucketInstanceId,le&&le.box&&Xe?Xe:Be,Y.ID),O&&je&&this.collisionIndex.insertCollisionBox(je.box,Me,d.get("icon-ignore-placement"),h.bucketInstanceId,ft,Y.ID),Re&&(R&&this.collisionIndex.insertCollisionCircles(Re.circles,ue,d.get("text-ignore-placement"),h.bucketInstanceId,Be,Y.ID),A)){const zt=h.bucketInstanceId;let pt=this.collisionCircleArrays[zt];pt===void 0&&(pt=this.collisionCircleArrays[zt]=new $i);for(let vt=0;vt<Re.circles.length;vt+=4)pt.circles.push(Re.circles[vt+0]),pt.circles.push(Re.circles[vt+1]),pt.circles.push(Re.circles[vt+2]),pt.circles.push(Re.collisionDetected?1:0)}if(E.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[E.crossTileID]=new Us(R||y,O||m,N||h.justReloaded),_[E.crossTileID]=!0};if(xe){if(c.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const E=h.getSortedSymbolIndexes(this.transform.angle);for(let k=E.length-1;k>=0;--k){const R=E[k];v(h.symbolInstances.get(R),h.collisionArrays[R])}}else for(let E=c.symbolInstanceStart;E<c.symbolInstanceEnd;E++)v(h.symbolInstances.get(E),h.collisionArrays[E]);if(A&&h.bucketInstanceId in this.collisionCircleArrays){const E=this.collisionCircleArrays[h.bucketInstanceId];o.invert(E.invProjMatrix,x),E.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}markUsedJustification(c,_,A,h){let d;d=h===o.WritingMode.vertical?A.verticalPlacedTextSymbolIndex:{left:A.leftJustifiedTextSymbolIndex,center:A.centerJustifiedTextSymbolIndex,right:A.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(_)];const x=[A.leftJustifiedTextSymbolIndex,A.centerJustifiedTextSymbolIndex,A.rightJustifiedTextSymbolIndex,A.verticalPlacedTextSymbolIndex];for(const b of x)b>=0&&(c.text.placedSymbolArray.get(b).crossTileID=d>=0&&b!==d?0:A.crossTileID)}markUsedOrientation(c,_,A){const h=_===o.WritingMode.horizontal||_===o.WritingMode.horizontalOnly?_:0,d=_===o.WritingMode.vertical?_:0,x=[A.leftJustifiedTextSymbolIndex,A.centerJustifiedTextSymbolIndex,A.rightJustifiedTextSymbolIndex];for(const b of x)c.text.placedSymbolArray.get(b).placedOrientation=h;A.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(A.verticalPlacedTextSymbolIndex).placedOrientation=d)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const _=this.prevPlacement;let A=!1;this.prevZoomAdjustment=_?_.zoomAdjustment(this.transform.zoom):0;const h=_?_.symbolFadeChange(c):1,d=_?_.opacities:{},x=_?_.variableOffsets:{},b=_?_.placedOrientations:{};for(const S in this.placements){const M=this.placements[S],B=d[S];B?(this.opacities[S]=new Xn(B,h,M.text,M.icon),A=A||M.text!==B.text.placed||M.icon!==B.icon.placed):(this.opacities[S]=new Xn(null,h,M.text,M.icon,M.skipFade),A=A||M.text||M.icon)}for(const S in d){const M=d[S];if(!this.opacities[S]){const B=new Xn(M,h,!1,!1);B.isHidden()||(this.opacities[S]=B,A=A||M.text.placed||M.icon.placed)}}for(const S in x)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=x[S]);for(const S in b)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=b[S]);if(_&&_.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");A?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=_?_.lastPlacementChangeTime:c)}updateLayerOpacities(c,_){const A={};for(const h of _){const d=h.getBucket(c);d&&h.latestFeatureIndex&&c.id===d.layerIds[0]&&this.updateBucketOpacities(d,A,h.collisionBoxArray)}}updateBucketOpacities(c,_,A){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const h=c.layers[0].layout,d=new Xn(null,0,!1,!1,!0),x=h.get("text-allow-overlap"),b=h.get("icon-allow-overlap"),S=h.get("text-variable-anchor"),M=h.get("text-rotation-alignment")==="map",B=h.get("text-pitch-alignment")==="map",V=h.get("icon-text-fit")!=="none",j=new Xn(null,0,x&&(b||!c.hasIconData()||h.get("icon-optional")),b&&(x||!c.hasTextData()||h.get("text-optional")),!0);!c.collisionArrays&&A&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(A);const Y=(ae,ne,ue)=>{for(let be=0;be<ne/4;be++)ae.opacityVertexArray.emplaceBack(ue)};for(let ae=0;ae<c.symbolInstances.length;ae++){const ne=c.symbolInstances.get(ae),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:be,crossTileID:Me}=ne;let ve=this.opacities[Me];_[Me]?ve=d:ve||(ve=j,this.opacities[Me]=ve),_[Me]=!0;const $e=ne.numIconVertices>0,Te=this.placedOrientations[ne.crossTileID],Ge=Te===o.WritingMode.vertical,xe=Te===o.WritingMode.horizontal||Te===o.WritingMode.horizontalOnly;if(ue>0||be>0){const y=Ie(ve.text);Y(c.text,ue,Ge?qe:y),Y(c.text,be,xe?qe:y);const m=ve.text.isHidden();[ne.rightJustifiedTextSymbolIndex,ne.centerJustifiedTextSymbolIndex,ne.leftJustifiedTextSymbolIndex].forEach(k=>{k>=0&&(c.text.placedSymbolArray.get(k).hidden=m||Ge?1:0)}),ne.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(ne.verticalPlacedTextSymbolIndex).hidden=m||xe?1:0);const v=this.variableOffsets[ne.crossTileID];v&&this.markUsedJustification(c,v.anchor,ne,Te);const E=this.placedOrientations[ne.crossTileID];E&&(this.markUsedJustification(c,"left",ne,E),this.markUsedOrientation(c,E,ne))}if($e){const y=Ie(ve.icon),m=!(V&&ne.verticalPlacedIconSymbolIndex&&Ge);ne.placedIconSymbolIndex>=0&&(Y(c.icon,ne.numIconVertices,m?y:qe),c.icon.placedSymbolArray.get(ne.placedIconSymbolIndex).hidden=ve.icon.isHidden()),ne.verticalPlacedIconSymbolIndex>=0&&(Y(c.icon,ne.numVerticalIconVertices,m?qe:y),c.icon.placedSymbolArray.get(ne.verticalPlacedIconSymbolIndex).hidden=ve.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const y=c.collisionArrays[ae];if(y){let m=new o.pointGeometry(0,0);if(y.textBox||y.verticalTextBox){let E=!0;if(S){const k=this.variableOffsets[Me];k?(m=ls(k.anchor,k.width,k.height,k.textOffset,k.textBoxScale),M&&m._rotate(B?this.transform.angle:-this.transform.angle)):E=!1}y.textBox&&Q(c.textCollisionBox.collisionVertexArray,ve.text.placed,!E||Ge,m.x,m.y),y.verticalTextBox&&Q(c.textCollisionBox.collisionVertexArray,ve.text.placed,!E||xe,m.x,m.y)}const v=!!(!xe&&y.verticalIconBox);y.iconBox&&Q(c.iconCollisionBox.collisionVertexArray,ve.icon.placed,v,V?m.x:0,V?m.y:0),y.verticalIconBox&&Q(c.iconCollisionBox.collisionVertexArray,ve.icon.placed,!v,V?m.x:0,V?m.y:0)}}}if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.text.opacityVertexArray.length!==c.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${c.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${c.text.layoutVertexArray.length}) / 4`);if(c.icon.opacityVertexArray.length!==c.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${c.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${c.icon.layoutVertexArray.length}) / 4`);if(c.bucketInstanceId in this.collisionCircleArrays){const ae=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=ae.invProjMatrix,c.placementViewportMatrix=ae.viewportMatrix,c.collisionCircleArray=ae.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,_){const A=this.zoomAtLastRecencyCheck===_?1-this.zoomAdjustment(_):1;return this.zoomAtLastRecencyCheck=_,this.commitTime+this.fadeDuration*A>c}setStale(){this.stale=!0}}function Q(L,c,_,A,h){L.emplaceBack(c?1:0,_?1:0,A||0,h||0),L.emplaceBack(c?1:0,_?1:0,A||0,h||0),L.emplaceBack(c?1:0,_?1:0,A||0,h||0),L.emplaceBack(c?1:0,_?1:0,A||0,h||0)}const te=Math.pow(2,25),he=Math.pow(2,24),a=Math.pow(2,17),G=Math.pow(2,16),Le=Math.pow(2,9),ke=Math.pow(2,8),Pe=Math.pow(2,1);function Ie(L){if(L.opacity===0&&!L.placed)return 0;if(L.opacity===1&&L.placed)return 4294967295;const c=L.placed?1:0,_=Math.floor(127*L.opacity);return _*te+c*he+_*a+c*G+_*Le+c*ke+_*Pe+c}const qe=0;class At{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&!c.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,_,A,h,d){const x=this._bucketParts;for(;this._currentTileIndex<c.length;)if(_.getBucketParts(x,h,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((b,S)=>b.sortKey-S.sortKey));this._currentPartIndex<x.length;)if(_.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,A),this._currentPartIndex++,d())return!0;return!1}}class We{constructor(c,_,A,h,d,x,b,S){this.placement=new K(c,_,x,b,S),this._currentPlacementIndex=A.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=d,this._done=!1}isDone(){return this._done}continuePlacement(c,_,A){const h=o.exported.now(),d=()=>{const x=o.exported.now()-h;return!this._forceFullPlacement&&x>2};for(;this._currentPlacementIndex>=0;){const x=_[c[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=b)&&(!x.maxzoom||x.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new At(x)),this._inProgressLayer.continuePlacement(A[x.source],this.placement,this._showCollisionBoxes,x,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const dt=512/o.EXTENT/2;class Dt{constructor(c,_,A){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=A;for(let h=0;h<_.length;h++){const d=_.get(h),x=d.key;this.indexedSymbolInstances[x]||(this.indexedSymbolInstances[x]=[]),this.indexedSymbolInstances[x].push({crossTileID:d.crossTileID,coord:this.getScaledCoordinates(d,c)})}}getScaledCoordinates(c,_){const A=dt/Math.pow(2,_.canonical.z-this.tileID.canonical.z);return{x:Math.floor((_.canonical.x*o.EXTENT+c.anchorX)*A),y:Math.floor((_.canonical.y*o.EXTENT+c.anchorY)*A)}}findMatches(c,_,A){const h=this.tileID.canonical.z<_.canonical.z?1:Math.pow(2,this.tileID.canonical.z-_.canonical.z);for(let d=0;d<c.length;d++){const x=c.get(d);if(x.crossTileID)continue;const b=this.indexedSymbolInstances[x.key];if(!b)continue;const S=this.getScaledCoordinates(x,_);for(const M of b)if(Math.abs(M.coord.x-S.x)<=h&&Math.abs(M.coord.y-S.y)<=h&&!A[M.crossTileID]){A[M.crossTileID]=!0,x.crossTileID=M.crossTileID;break}}}}class Rt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class sn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const _=Math.round((c-this.lng)/360);if(_!==0)for(const A in this.indexes){const h=this.indexes[A],d={};for(const x in h){const b=h[x];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+_),d[b.tileID.key]=b}this.indexes[A]=d}this.lng=c}addBucket(c,_,A){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===_.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let d=0;d<_.symbolInstances.length;d++)_.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const h=this.usedCrossTileIDs[c.overscaledZ];for(const d in this.indexes){const x=this.indexes[d];if(Number(d)>c.overscaledZ)for(const b in x){const S=x[b];S.tileID.isChildOf(c)&&S.findMatches(_.symbolInstances,c,h)}else{const b=x[c.scaledTo(Number(d)).key];b&&b.findMatches(_.symbolInstances,c,h)}}for(let d=0;d<_.symbolInstances.length;d++){const x=_.symbolInstances.get(d);x.crossTileID||(x.crossTileID=A.generate(),h[x.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Dt(c,_.symbolInstances,_.bucketInstanceId),!0}removeBucketCrossTileIDs(c,_){for(const A in _.indexedSymbolInstances)for(const h of _.indexedSymbolInstances[A])delete this.usedCrossTileIDs[c][h.crossTileID]}removeStaleBuckets(c){let _=!1;for(const A in this.indexes){const h=this.indexes[A];for(const d in h)c[h[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(A,h[d]),delete h[d],_=!0)}return _}}class jt{constructor(){this.layerIndexes={},this.crossTileIDs=new Rt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,_,A){let h=this.layerIndexes[c.id];h===void 0&&(h=this.layerIndexes[c.id]=new sn);let d=!1;const x={};h.handleWrapJump(A);for(const b of _){const S=b.getBucket(c);S&&c.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(b.tileID,S,this.crossTileIDs)&&(d=!0),x[S.bucketInstanceId]=!0)}return h.removeStaleBuckets(x)&&(d=!0),d}pruneUnusedLayers(c){const _={};c.forEach(A=>{_[A]=!0});for(const A in this.layerIndexes)_[A]||delete this.layerIndexes[A]}}var pn=o.createLayout([{name:"a_pos",type:"Int16",components:2}]);class qt extends o.Evented{constructor(c){super(),this.sourceCache=c,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=c._cache.max,c.usedForTerrain=!0,c.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const c in this._tiles){const _=this._tiles[c];_.textures.forEach(A=>A.destroy()),_.textures=[]}}update(c,_){this.sourceCache.update(c,_),this._renderableTilesKeys=[];for(const A of c.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:_}))this._renderableTilesKeys.push(A.key),this._tiles[A.key]||(A.posMatrix=new Float64Array(16),o.ortho(A.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),this._tiles[A.key]=new hr(A,this.tileSize))}removeOutdated(c){const _={};this.renderHistory=this.renderHistory.filter((A,h)=>this.renderHistory.indexOf(A)===h).slice(0,this.renderHistorySize);for(const A of this._renderableTilesKeys)_[A]=!0;for(const A of this.renderHistory)_[A]=!0;for(const A in this._tiles)_[A]||(this._tiles[A].clearTextures(c),delete this._tiles[A])}getRenderableTiles(){return this._renderableTilesKeys.map(c=>this.getTileByID(c))}getTileByID(c){return this._tiles[c]}getTerrainCoords(c){const _={};for(const A of this._renderableTilesKeys){const h=this._tiles[A].tileID;if(h.canonical.equals(c.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16),o.ortho(d.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),_[A]=d}else if(h.canonical.isChildOf(c.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16);const x=h.canonical.z-c.canonical.z,b=h.canonical.x-(h.canonical.x>>x<<x),S=h.canonical.y-(h.canonical.y>>x<<x),M=o.EXTENT>>x;o.ortho(d.posMatrix,0,M,0,M,0,1),o.translate(d.posMatrix,d.posMatrix,[-b*M,-S*M,0]),_[A]=d}else if(c.canonical.isChildOf(h.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16);const x=c.canonical.z-h.canonical.z,b=c.canonical.x-(c.canonical.x>>x<<x),S=c.canonical.y-(c.canonical.y>>x<<x),M=o.EXTENT>>x;o.ortho(d.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),o.translate(d.posMatrix,d.posMatrix,[b*M,S*M,0]),o.scale(d.posMatrix,d.posMatrix,[1/2**x,1/2**x,0]),_[A]=d}}return _}getSourceTile(c,_){const A=this.sourceCache._source;let h=c.overscaledZ-this.deltaZoom;if(h>A.maxzoom&&(h=A.maxzoom),h<A.minzoom)return null;this._sourceTileCache[c.key]||(this._sourceTileCache[c.key]=c.scaledTo(h).key);let d=this.sourceCache.getTileByID(this._sourceTileCache[c.key]);if((!d||!d.dem)&&_)for(;h>=A.minzoom&&(!d||!d.dem);)d=this.sourceCache.getTileByID(c.scaledTo(h--).key);return d}tilesAfterTime(c=Date.now()){return Object.values(this._tiles).filter(_=>_.timeLoaded>=c)}}class an{constructor(c,_,A){this.style=c,this.sourceCache=new qt(_),this.options=A,this.exaggeration=typeof A.exaggeration=="number"?A.exaggeration:1,this.elevationOffset=typeof A.elevationOffset=="number"?A.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(c,_,A,h=o.EXTENT){if(!(_>=0&&_<h&&A>=0&&A<h))return this.elevationOffset;let d=0;const x=this.getTerrainData(c);if(x.tile&&x.tile.dem){const b=o.transformMat4$1([],[_/h*o.EXTENT,A/h*o.EXTENT],x.u_terrain_matrix),S=[b[0]*x.tile.dem.dim,b[1]*x.tile.dem.dim],M=[Math.floor(S[0]),Math.floor(S[1])],B=x.tile.dem.get(M[0],M[1]),V=x.tile.dem.get(M[0],M[1]+1),j=x.tile.dem.get(M[0]+1,M[1]),Y=x.tile.dem.get(M[0]+1,M[1]+1);d=o.number(o.number(B,V,S[0]-M[0]),o.number(j,Y,S[0]-M[0]),S[1]-M[1])}return d}rememberForRerender(c,_){for(const A in this.sourceCache._tiles){const h=this.sourceCache._tiles[A];(h.tileID.equals(_)||h.tileID.isChildOf(_))&&(c===this.sourceCache.sourceCache.id&&(h.timeLoaded=Date.now()),this._rerender[c]=this._rerender[c]||{},this._rerender[c][h.tileID.key]=!0)}}needsRerender(c,_){return this._rerender[c]&&this._rerender[c][_.key]}clearRerenderCache(){this._rerender={}}getElevation(c,_,A,h=o.EXTENT){return(this.getDEMElevation(c,_,A,h)+this.elevationOffset)*this.exaggeration}getTerrainData(c){if(!this._emptyDemTexture){const h=this.style.map.painter.context,d=new o.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new H(h,d,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new H(h,new o.RGBAImage({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.identity([])}const _=this.sourceCache.getSourceTile(c,!0);if(_&&_.dem&&(!_.demTexture||_.needsTerrainPrepare)){const h=this.style.map.painter.context;_.demTexture=this.style.map.painter.getTileTexture(_.dem.stride),_.demTexture?_.demTexture.update(_.dem.getPixels(),{premultiply:!1}):_.demTexture=new H(h,_.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),_.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),_.needsTerrainPrepare=!1}const A=_&&_+_.tileID.key+c.key;if(A&&!this._demMatrixCache[A]){const h=this.sourceCache.sourceCache._source.maxzoom;let d=c.canonical.z-_.tileID.canonical.z;c.overscaledZ>c.canonical.z&&(c.canonical.z>=h?d=c.canonical.z-h:o.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=c.canonical.x-(c.canonical.x>>d<<d),b=c.canonical.y-(c.canonical.y>>d<<d),S=o.fromScaling(new Float64Array(16),[1/(o.EXTENT<<d),1/(o.EXTENT<<d),0]);o.translate(S,S,[x*o.EXTENT,b*o.EXTENT,0]),this._demMatrixCache[c.key]={matrix:S,coord:c}}return{u_depth:2,u_terrain:3,u_terrain_dim:_&&_.dem&&_.dem.dim||1,u_terrain_matrix:A?this._demMatrixCache[c.key].matrix:this._emptyDemMatrix,u_terrain_unpack:_&&_.dem&&_.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(_&&_.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:_}}getRTTFramebuffer(){const c=this.style.map.painter;if(!this._rttFramebuffer){const _=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=c.context.createFramebuffer(_,_,!0),this._rttFramebuffer.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,_,_))}return this._rttFramebuffer}getFramebuffer(c){const _=this.style.map.painter,A=_.width/devicePixelRatio,h=_.height/devicePixelRatio;return!this._fbo||this._fbo.width===A&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new H(_.context,{width:A,height:h,data:null},_.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(_.context.gl.NEAREST,_.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new H(_.context,{width:A,height:h,data:null},_.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(_.context.gl.NEAREST,_.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=_.context.createFramebuffer(A,h,!0),this._fbo.depthAttachment.set(_.context.createRenderbuffer(_.context.gl.DEPTH_COMPONENT16,A,h))),this._fbo.colorAttachment.set(c==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const c=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const _=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let d=0,x=0;d<this._coordsTextureSize;d++)for(let b=0;b<this._coordsTextureSize;b++,x+=4)_[x+0]=255&b,_[x+1]=255&d,_[x+2]=b>>8<<4|d>>8,_[x+3]=0;const A=new o.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(_.buffer)),h=new H(c,A,c.gl.RGBA,{premultiply:!1});return h.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(c){const _=new Uint8Array(4),A=this.style.map.painter,h=A.context,d=h.gl;h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(c.x,A.height/devicePixelRatio-c.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,_),h.bindFramebuffer.set(null);const x=_[0]+(_[2]>>4<<8),b=_[1]+((15&_[2])<<8),S=this.coordsIndex[255-_[3]],M=S&&this.sourceCache.getTileByID(S);if(!M)return null;const B=this._coordsTextureSize,V=(1<<M.tileID.canonical.z)*B;return new o.MercatorCoordinate((M.tileID.canonical.x*B+x)/V,(M.tileID.canonical.y*B+b)/V,this.getElevation(M.tileID,x,b,B))}getTerrainMesh(){if(this._mesh)return this._mesh;const c=this.style.map.painter.context,_=new o.PosArray,A=new o.TriangleIndexArray,h=this.meshSize,d=o.EXTENT/h,x=h*h;for(let b=0;b<=h;b++)for(let S=0;S<=h;S++)_.emplaceBack(S*d,b*d);for(let b=0;b<x;b+=h+1)for(let S=0;S<h;S++)A.emplaceBack(S+b,h+S+b+1,h+S+b+2),A.emplaceBack(S+b,h+S+b+2,S+b+1);return this._mesh={indexBuffer:c.createIndexBuffer(A),vertexBuffer:c.createVertexBuffer(_,pn.members),segments:o.SegmentVector.simpleSegment(0,0,_.length,A.length)},this._mesh}getMinMaxElevation(c){const _=this.getTerrainData(c).tile,A={minElevation:null,maxElevation:null};return _&&_.dem&&(A.minElevation=(_.dem.min+this.elevationOffset)*this.exaggeration,A.maxElevation=(_.dem.max+this.elevationOffset)*this.exaggeration),A}}const xn=(L,c)=>o.emitValidationErrors(L,c&&c.filter(_=>_.identifier!=="source.canvas")),Ft=o.pick(Gn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Oe=o.pick(Gn,["setCenter","setZoom","setBearing","setPitch"]),Mt=function(){const L={},c=o.spec.$version;for(const _ in o.spec.$root){const A=o.spec.$root[_];if(A.required){let h=null;h=_==="version"?c:A.type==="array"?[]:{},h!=null&&(L[_]=h)}}return L}();class Ce extends o.Evented{constructor(c,_={}){super(),this.map=c,this.dispatcher=new rt(lr(),this),this.imageManager=new X,this.imageManager.setEventedParent(this),this.glyphManager=new me(c._requestManager,_.localIdeographFontFamily),this.lineAtlas=new Ke(256,512),this.crossTileSymbolIndex=new jt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const A=this;this._rtlTextPluginCallback=Ce.registerForPluginStateChange(h=>{A.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:h.pluginStatus,pluginURL:h.pluginURL},(d,x)=>{if(o.triggerPluginCompletionEvent(d),x&&x.every(b=>b))for(const b in A.sourceCaches)A.sourceCaches[b].reload()})}),this.on("data",h=>{if(h.dataType!=="source"||h.sourceDataType!=="metadata")return;const d=this.sourceCaches[h.sourceId];if(!d)return;const x=d.getSource();if(x&&x.vectorLayerIds)for(const b in this._layers){const S=this._layers[b];S.source===x.id&&this._validateLayer(S)}})}loadURL(c,_={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const A=typeof _.validate!="boolean"||_.validate,h=this.map._requestManager.transformRequest(c,o.ResourceType.Style);this._request=o.getJSON(h,(d,x)=>{this._request=null,d?this.fire(new o.ErrorEvent(d)):x&&this._load(x,A)})}loadJSON(c,_={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(c,_.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Mt,!1)}_load(c,_){if(_&&xn(this,o.validateStyle(c)))return;this._loaded=!0,this.stylesheet=c;for(const h in c.sources)this.addSource(h,c.sources[h],{validate:!1});c.sprite?this._loadSprite(c.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(c.glyphs);const A=ti(this.stylesheet.layers);this._order=A.map(h=>h.id),this._layers={},this._serializedLayers={};for(let h of A)h=o.createStyleLayer(h),h.setEventedParent(this,{layer:{id:h.id}}),this._layers[h.id]=h,this._serializedLayers[h.id]=h.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Qe(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}_loadSprite(c){this._spriteRequest=function(_,A,h,d){let x,b,S;const M=h>1?"@2x":"";let B=o.getJSON(A.transformRequest(A.normalizeSpriteURL(_,M,".json"),o.ResourceType.SpriteJSON),(Y,ae)=>{B=null,S||(S=Y,x=ae,j())}),V=o.getImage(A.transformRequest(A.normalizeSpriteURL(_,M,".png"),o.ResourceType.SpriteImage),(Y,ae)=>{V=null,S||(S=Y,b=ae,j())});function j(){if(S)d(S);else if(x&&b){const Y=o.exported.getImageData(b),ae={};for(const ne in x){const{width:ue,height:be,x:Me,y:ve,sdf:$e,pixelRatio:Te,stretchX:Ge,stretchY:xe,content:y}=x[ne],m=new o.RGBAImage({width:ue,height:be});o.RGBAImage.copy(Y,m,{x:Me,y:ve},{x:0,y:0},{width:ue,height:be}),ae[ne]={data:m,pixelRatio:Te,sdf:$e,stretchX:Ge,stretchY:xe,content:y}}d(null,ae)}}return{cancel(){B&&(B.cancel(),B=null),V&&(V.cancel(),V=null)}}}(c,this.map._requestManager,this.map.getPixelRatio(),(_,A)=>{if(this._spriteRequest=null,_)this.fire(new o.ErrorEvent(_));else if(A)for(const h in A)this.imageManager.addImage(h,A[h]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(c){const _=this.sourceCaches[c.source];if(!_)return;const A=c.sourceLayer;if(!A)return;const h=_.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(A)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${A}" does not exist on source "${h.id}" as specified by style layer "${c.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this.sourceCaches)if(!this.sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const _=[];for(const A of c){const h=this._layers[A];h.type!=="custom"&&_.push(h.serialize())}return _}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(c){if(!this._loaded)return;const _=this._changed;if(this._changed){const h=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);(h.length||d.length)&&this._updateWorkerLayers(h,d);for(const x in this._updatedSources){const b=this._updatedSources[x];if(b==="reload")this._reloadSource(x);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(x)}}this._updateTilesForChangedImages();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(c);this.light.updateTransitions(c),this._resetUpdates()}const A={};for(const h in this.sourceCaches){const d=this.sourceCaches[h];A[h]=d.used,d.used=!1}for(const h of this._order){const d=this._layers[h];d.recalculate(c,this._availableImages),!d.isHidden(c.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(const h in A){const d=this.sourceCaches[h];A[h]!==d.used&&d.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(c),this.z=c.zoom,_&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const _ in this.sourceCaches)this.sourceCaches[_].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,_){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:_})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(c){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),c){const _=this.sourceCaches[c.source];if(!_)throw new Error(`cannot load terrain, because there exists no source with ID: ${c.source}`);this.terrain=new an(this,_,c),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=A=>{A.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=A=>{A.tile&&(A.sourceId===c.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(A.sourceId,A.tile.tileID)):A.source.type==="geojson"&&this.terrain.rememberForRerender(A.sourceId,A.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new o.Event("terrain",{terrain:c}))}setState(c){if(this._checkLoaded(),xn(this,o.validateStyle(c)))return!1;(c=o.clone$1(c)).layers=ti(c.layers);const _=function(h,d){if(!h)return[{command:Gn.setStyle,args:[d]}];let x=[];try{if(!P(h.version,d.version))return[{command:Gn.setStyle,args:[d]}];P(h.center,d.center)||x.push({command:Gn.setCenter,args:[d.center]}),P(h.zoom,d.zoom)||x.push({command:Gn.setZoom,args:[d.zoom]}),P(h.bearing,d.bearing)||x.push({command:Gn.setBearing,args:[d.bearing]}),P(h.pitch,d.pitch)||x.push({command:Gn.setPitch,args:[d.pitch]}),P(h.sprite,d.sprite)||x.push({command:Gn.setSprite,args:[d.sprite]}),P(h.glyphs,d.glyphs)||x.push({command:Gn.setGlyphs,args:[d.glyphs]}),P(h.transition,d.transition)||x.push({command:Gn.setTransition,args:[d.transition]}),P(h.light,d.light)||x.push({command:Gn.setLight,args:[d.light]});const b={},S=[];(function(B,V,j,Y){let ae;for(ae in V=V||{},B=B||{})Object.prototype.hasOwnProperty.call(B,ae)&&(Object.prototype.hasOwnProperty.call(V,ae)||qn(ae,j,Y));for(ae in V)Object.prototype.hasOwnProperty.call(V,ae)&&(Object.prototype.hasOwnProperty.call(B,ae)?P(B[ae],V[ae])||(B[ae].type==="geojson"&&V[ae].type==="geojson"&&mo(B,V,ae)?j.push({command:Gn.setGeoJSONSourceData,args:[ae,V[ae].data]}):Vi(ae,V,j,Y)):Pi(ae,V,j))})(h.sources,d.sources,S,b);const M=[];h.layers&&h.layers.forEach(B=>{b[B.source]?x.push({command:Gn.removeLayer,args:[B.id]}):M.push(B)}),x=x.concat(S),function(B,V,j){V=V||[];const Y=(B=B||[]).map(ki),ae=V.map(ki),ne=B.reduce(Vo,{}),ue=V.reduce(Vo,{}),be=Y.slice(),Me=Object.create(null);let ve,$e,Te,Ge,xe,y,m;for(ve=0,$e=0;ve<Y.length;ve++)Te=Y[ve],Object.prototype.hasOwnProperty.call(ue,Te)?$e++:(j.push({command:Gn.removeLayer,args:[Te]}),be.splice(be.indexOf(Te,$e),1));for(ve=0,$e=0;ve<ae.length;ve++)Te=ae[ae.length-1-ve],be[be.length-1-ve]!==Te&&(Object.prototype.hasOwnProperty.call(ne,Te)?(j.push({command:Gn.removeLayer,args:[Te]}),be.splice(be.lastIndexOf(Te,be.length-$e),1)):$e++,y=be[be.length-ve],j.push({command:Gn.addLayer,args:[ue[Te],y]}),be.splice(be.length-ve,0,Te),Me[Te]=!0);for(ve=0;ve<ae.length;ve++)if(Te=ae[ve],Ge=ne[Te],xe=ue[Te],!Me[Te]&&!P(Ge,xe))if(P(Ge.source,xe.source)&&P(Ge["source-layer"],xe["source-layer"])&&P(Ge.type,xe.type)){for(m in Gr(Ge.layout,xe.layout,j,Te,null,Gn.setLayoutProperty),Gr(Ge.paint,xe.paint,j,Te,null,Gn.setPaintProperty),P(Ge.filter,xe.filter)||j.push({command:Gn.setFilter,args:[Te,xe.filter]}),P(Ge.minzoom,xe.minzoom)&&P(Ge.maxzoom,xe.maxzoom)||j.push({command:Gn.setLayerZoomRange,args:[Te,xe.minzoom,xe.maxzoom]}),Ge)Object.prototype.hasOwnProperty.call(Ge,m)&&m!=="layout"&&m!=="paint"&&m!=="filter"&&m!=="metadata"&&m!=="minzoom"&&m!=="maxzoom"&&(m.indexOf("paint.")===0?Gr(Ge[m],xe[m],j,Te,m.slice(6),Gn.setPaintProperty):P(Ge[m],xe[m])||j.push({command:Gn.setLayerProperty,args:[Te,m,xe[m]]}));for(m in xe)Object.prototype.hasOwnProperty.call(xe,m)&&!Object.prototype.hasOwnProperty.call(Ge,m)&&m!=="layout"&&m!=="paint"&&m!=="filter"&&m!=="metadata"&&m!=="minzoom"&&m!=="maxzoom"&&(m.indexOf("paint.")===0?Gr(Ge[m],xe[m],j,Te,m.slice(6),Gn.setPaintProperty):P(Ge[m],xe[m])||j.push({command:Gn.setLayerProperty,args:[Te,m,xe[m]]}))}else j.push({command:Gn.removeLayer,args:[Te]}),y=be[be.lastIndexOf(Te)+1],j.push({command:Gn.addLayer,args:[xe,y]})}(M,d.layers,x)}catch(b){console.warn("Unable to compute style diff:",b),x=[{command:Gn.setStyle,args:[d]}]}return x}(this.serialize(),c).filter(h=>!(h.command in Oe));if(_.length===0)return!1;const A=_.filter(h=>!(h.command in Ft));if(A.length>0)throw new Error(`Unimplemented: ${A.map(h=>h.command).join(", ")}.`);return _.forEach(h=>{h.command!=="setTransition"&&this[h.command].apply(this,h.args)}),this.stylesheet=c,!0}addImage(c,_){if(this.getImage(c))return this.fire(new o.ErrorEvent(new Error(`An image named "${c}" already exists.`)));this.imageManager.addImage(c,_),this._afterImageUpdated(c)}updateImage(c,_){this.imageManager.updateImage(c,_)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){if(!this.getImage(c))return this.fire(new o.ErrorEvent(new Error(`An image named "${c}" does not exist.`)));this.imageManager.removeImage(c),this._afterImageUpdated(c)}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(c,_,A={}){if(this._checkLoaded(),this.sourceCaches[c]!==void 0)throw new Error(`Source "${c}" already exists.`);if(!_.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(_).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(_.type)>=0&&this._validate(o.validateStyle.source,`sources.${c}`,_,null,A))return;this.map&&this.map._collectResourceTiming&&(_.collectResourceTiming=!0);const h=this.sourceCaches[c]=new wt(c,_,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:h.serialize(),sourceId:c})),h.onAdd(this.map),this._changed=!0}removeSource(c){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error("There is no source with this ID");for(const A in this._layers)if(this._layers[A].source===c)return this.fire(new o.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${A}" is using it.`)));const _=this.sourceCaches[c];delete this.sourceCaches[c],delete this._updatedSources[c],_.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),_.setEventedParent(null),_.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(c,_){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error(`There is no source with this ID=${c}`);const A=this.sourceCaches[c].getSource();if(A.type!=="geojson")throw new Error(`geojsonSource.type is ${A.type}, which is !== 'geojson`);A.setData(_),this._changed=!0}getSource(c){return this.sourceCaches[c]&&this.sourceCaches[c].getSource()}addLayer(c,_,A={}){this._checkLoaded();const h=c.id;if(this.getLayer(h))return void this.fire(new o.ErrorEvent(new Error(`Layer "${h}" already exists on this map.`)));let d;if(c.type==="custom"){if(xn(this,o.validateCustomStyleLayer(c)))return;d=o.createStyleLayer(c)}else{if(typeof c.source=="object"&&(this.addSource(h,c.source),c=o.clone$1(c),c=o.extend(c,{source:h})),this._validate(o.validateStyle.layer,`layers.${h}`,c,{arrayIndex:-1},A))return;d=o.createStyleLayer(c),this._validateLayer(d),d.setEventedParent(this,{layer:{id:h}}),this._serializedLayers[d.id]=d.serialize()}const x=_?this._order.indexOf(_):this._order.length;if(_&&x===-1)this.fire(new o.ErrorEvent(new Error(`Cannot add layer "${h}" before non-existing layer "${_}".`)));else{if(this._order.splice(x,0,h),this._layerOrderChanged=!0,this._layers[h]=d,this._removedLayers[h]&&d.source&&d.type!=="custom"){const b=this._removedLayers[h];delete this._removedLayers[h],b.type!==d.type?this._updatedSources[d.source]="clear":(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map)}}moveLayer(c,_){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new o.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===_)return;const A=this._order.indexOf(c);this._order.splice(A,1);const h=_?this._order.indexOf(_):this._order.length;_&&h===-1?this.fire(new o.ErrorEvent(new Error(`Cannot move layer "${c}" before non-existing layer "${_}".`))):(this._order.splice(h,0,c),this._layerOrderChanged=!0)}removeLayer(c){this._checkLoaded();const _=this._layers[c];if(!_)return void this.fire(new o.ErrorEvent(new Error(`Cannot remove non-existing layer "${c}".`)));_.setEventedParent(null);const A=this._order.indexOf(c);this._order.splice(A,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=_,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],_.onRemove&&_.onRemove(this.map)}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}setLayerZoomRange(c,_,A){this._checkLoaded();const h=this.getLayer(c);h?h.minzoom===_&&h.maxzoom===A||(_!=null&&(h.minzoom=_),A!=null&&(h.maxzoom=A),this._updateLayer(h)):this.fire(new o.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${c}".`)))}setFilter(c,_,A={}){this._checkLoaded();const h=this.getLayer(c);if(h){if(!P(h.filter,_))return _==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(o.validateStyle.filter,`layers.${h.id}.filter`,_,null,A)||(h.filter=o.clone$1(_),this._updateLayer(h)))}else this.fire(new o.ErrorEvent(new Error(`Cannot filter non-existing layer "${c}".`)))}getFilter(c){return o.clone$1(this.getLayer(c).filter)}setLayoutProperty(c,_,A,h={}){this._checkLoaded();const d=this.getLayer(c);d?P(d.getLayoutProperty(_),A)||(d.setLayoutProperty(_,A,h),this._updateLayer(d)):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getLayoutProperty(c,_){const A=this.getLayer(c);if(A)return A.getLayoutProperty(_);this.fire(new o.ErrorEvent(new Error(`Cannot get style of non-existing layer "${c}".`)))}setPaintProperty(c,_,A,h={}){this._checkLoaded();const d=this.getLayer(c);d?P(d.getPaintProperty(_),A)||(d.setPaintProperty(_,A,h)&&this._updateLayer(d),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getPaintProperty(c,_){return this.getLayer(c).getPaintProperty(_)}setFeatureState(c,_){this._checkLoaded();const A=c.source,h=c.sourceLayer,d=this.sourceCaches[A];if(d===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${A}' does not exist in the map's style.`)));const x=d.getSource().type;x==="geojson"&&h?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||h?(c.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),d.setFeatureState(h,c.id,_)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(c,_){this._checkLoaded();const A=c.source,h=this.sourceCaches[A];if(h===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${A}' does not exist in the map's style.`)));const d=h.getSource().type,x=d==="vector"?c.sourceLayer:void 0;d!=="vector"||x?_&&typeof c.id!="string"&&typeof c.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(x,c.id,_):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(c){this._checkLoaded();const _=c.source,A=c.sourceLayer,h=this.sourceCaches[_];if(h!==void 0)return h.getSource().type!=="vector"||A?(c.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),h.getFeatureState(A,c.id)):void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,c=>c.serialize()),layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&this.sourceCaches[c.source].getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(c){const _=x=>this._layers[x].type==="fill-extrusion",A={},h=[];for(let x=this._order.length-1;x>=0;x--){const b=this._order[x];if(_(b)){A[b]=x;for(const S of c){const M=S[b];if(M)for(const B of M)h.push(B)}}}h.sort((x,b)=>b.intersectionZ-x.intersectionZ);const d=[];for(let x=this._order.length-1;x>=0;x--){const b=this._order[x];if(_(b))for(let S=h.length-1;S>=0;S--){const M=h[S].feature;if(A[M.layer.id]<x)break;d.push(M),h.pop()}else for(const S of c){const M=S[b];if(M)for(const B of M)d.push(B.feature)}}return d}queryRenderedFeatures(c,_,A){_&&_.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",_.filter,null,_);const h={};if(_&&_.layers){if(!Array.isArray(_.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const x of _.layers){const b=this._layers[x];if(!b)return this.fire(new o.ErrorEvent(new Error(`The layer '${x}' does not exist in the map's style and cannot be queried for features.`))),[];h[b.source]=!0}}const d=[];_.availableImages=this._availableImages;for(const x in this.sourceCaches)_.layers&&!h[x]||d.push(tr(this.sourceCaches[x],this._layers,this._serializedLayers,c,_,A));return this.placement&&d.push(function(x,b,S,M,B,V,j){const Y={},ae=V.queryRenderedSymbols(M),ne=[];for(const ue of Object.keys(ae).map(Number))ne.push(j[ue]);ne.sort(or);for(const ue of ne){const be=ue.featureIndex.lookupSymbolFeatures(ae[ue.bucketInstanceId],b,ue.bucketIndex,ue.sourceLayerIndex,B.filter,B.layers,B.availableImages,x);for(const Me in be){const ve=Y[Me]=Y[Me]||[],$e=be[Me];$e.sort((Te,Ge)=>{const xe=ue.featureSortOrder;if(xe){const y=xe.indexOf(Te.featureIndex);return xe.indexOf(Ge.featureIndex)-y}return Ge.featureIndex-Te.featureIndex});for(const Te of $e)ve.push(Te)}}for(const ue in Y)Y[ue].forEach(be=>{const Me=be.feature,ve=S[x[ue].source].getFeatureState(Me.layer["source-layer"],Me.id);Me.source=Me.layer.source,Me.layer["source-layer"]&&(Me.sourceLayer=Me.layer["source-layer"]),Me.state=ve});return Y}(this._layers,this._serializedLayers,this.sourceCaches,c,_,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(c,_){_&&_.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",_.filter,null,_);const A=this.sourceCaches[c];return A?function(h,d){const x=h.getRenderableIds().map(M=>h.getTileByID(M)),b=[],S={};for(let M=0;M<x.length;M++){const B=x[M],V=B.tileID.canonical.key;S[V]||(S[V]=!0,B.querySourceFeatures(b,d))}return b}(A,_):[]}addSourceType(c,_,A){return Ce.getSourceType(c)?A(new Error(`A source type called "${c}" already exists.`)):(Ce.setSourceType(c,_),_.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:_.workerSourceURL},A):A(null,null))}getLight(){return this.light.getLight()}setLight(c,_={}){this._checkLoaded();const A=this.light.getLight();let h=!1;for(const x in c)if(!P(c[x],A[x])){h=!0;break}if(!h)return;const d={now:o.exported.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,_),this.light.updateTransitions(d)}_validate(c,_,A,h,d={}){return(!d||d.validate!==!1)&&xn(this,c.call(o.validateStyle,o.extend({key:_,style:this.serialize(),value:A,styleSpec:o.spec},h)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this.sourceCaches){const _=this.sourceCaches[c];_.setEventedParent(null),_.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){this.sourceCaches[c].clearTiles()}_reloadSource(c){this.sourceCaches[c].resume(),this.sourceCaches[c].reload()}_updateSources(c){for(const _ in this.sourceCaches)this.sourceCaches[_].update(c,this.terrain)}_generateCollisionBoxes(){for(const c in this.sourceCaches)this._reloadSource(c)}_updatePlacement(c,_,A,h,d=!1){let x=!1,b=!1;const S={};for(const M of this._order){const B=this._layers[M];if(B.type!=="symbol")continue;if(!S[B.source]){const j=this.sourceCaches[B.source];S[B.source]=j.getRenderableIds(!0).map(Y=>j.getTileByID(Y)).sort((Y,ae)=>ae.tileID.overscaledZ-Y.tileID.overscaledZ||(Y.tileID.isLessThan(ae.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(B,S[B.source],c.center.lng);x=x||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((d=d||this._layerOrderChanged||A===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),c.zoom))&&(this.pauseablePlacement=new We(c,this.terrain,this._order,d,_,A,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),b=!0),x&&this.pauseablePlacement.placement.setStale()),b||x)for(const M of this._order){const B=this._layers[M];B.type==="symbol"&&this.placement.updateLayerOpacities(B,S[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const c in this.sourceCaches)this.sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,_,A){this.imageManager.getImages(_.icons,A),this._updateTilesForChangedImages();const h=this.sourceCaches[_.source];h&&h.setDependencies(_.tileID.key,_.type,_.icons)}getGlyphs(c,_,A){this.glyphManager.getGlyphs(_.stacks,A)}getResource(c,_,A){return o.makeRequest(_,A)}}Ce.getSourceType=function(L){return Tn[L]},Ce.setSourceType=function(L,c){Tn[L]=c},Ce.registerForPluginStateChange=o.registerForPluginStateChange;var un="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const ui={prelude:ir(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:ir(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:ir(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ir(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ir("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ir(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:ir(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ir("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ir("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ir("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:ir(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:ir(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:ir(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:ir(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ir(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ir(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ir(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ir(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:ir(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ir(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ir(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ir(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ir(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:ir(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ir(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ir(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ir("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",un),terrainDepth:ir("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",un),terrainCoords:ir("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",un)};function ir(L,c){const _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,A=c.match(/attribute ([\w]+) ([\w]+)/g),h=L.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=d?d.concat(h):h,b={};return{fragmentSource:L=L.replace(_,(S,M,B,V,j)=>(b[j]=!0,M==="define"?`
#ifndef HAS_UNIFORM_u_${j}
varying ${B} ${V} ${j};
#else
uniform ${B} ${V} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${B} ${V} ${j} = u_${j};
#endif
`)),vertexSource:c=c.replace(_,(S,M,B,V,j)=>{const Y=V==="float"?"vec2":"vec4",ae=j.match(/color/)?"color":Y;return b[j]?M==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
attribute ${B} ${Y} a_${j};
varying ${B} ${V} ${j};
#else
uniform ${B} ${V} u_${j};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${B} ${V} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${ae}(a_${j}, u_${j}_t);
#else
    ${B} ${V} ${j} = u_${j};
#endif
`:M==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
attribute ${B} ${Y} a_${j};
#else
uniform ${B} ${V} u_${j};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${B} ${V} ${j} = a_${j};
#else
    ${B} ${V} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${B} ${V} ${j} = unpack_mix_${ae}(a_${j}, u_${j}_t);
#else
    ${B} ${V} ${j} = u_${j};
#endif
`}),staticAttributes:A,staticUniforms:x}}class ha{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(c,_,A,h,d,x,b,S,M){this.context=c;let B=this.boundPaintVertexBuffers.length!==h.length;for(let V=0;!B&&V<h.length;V++)this.boundPaintVertexBuffers[V]!==h[V]&&(B=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===_&&this.boundLayoutVertexBuffer===A&&!B&&this.boundIndexBuffer===d&&this.boundVertexOffset===x&&this.boundDynamicVertexBuffer===b&&this.boundDynamicVertexBuffer2===S&&this.boundDynamicVertexBuffer3===M?(c.bindVertexArrayOES.set(this.vao),b&&b.bind(),d&&d.dynamicDraw&&d.bind(),S&&S.bind(),M&&M.bind()):this.freshBind(_,A,h,d,x,b,S,M)}freshBind(c,_,A,h,d,x,b,S){let M;const B=c.numAttributes,V=this.context,j=V.gl;if(V.extVertexArrayObject)this.vao&&this.destroy(),this.vao=V.extVertexArrayObject.createVertexArrayOES(),V.bindVertexArrayOES.set(this.vao),M=0,this.boundProgram=c,this.boundLayoutVertexBuffer=_,this.boundPaintVertexBuffers=A,this.boundIndexBuffer=h,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=S;else{M=V.currentNumAttributes||0;for(let Y=B;Y<M;Y++)j.disableVertexAttribArray(Y)}_.enableAttributes(j,c);for(const Y of A)Y.enableAttributes(j,c);x&&x.enableAttributes(j,c),b&&b.enableAttributes(j,c),S&&S.enableAttributes(j,c),_.bind(),_.setVertexAttribPointers(j,c,d);for(const Y of A)Y.bind(),Y.setVertexAttribPointers(j,c,d);x&&(x.bind(),x.setVertexAttribPointers(j,c,d)),h&&h.bind(),b&&(b.bind(),b.setVertexAttribPointers(j,c,d)),S&&(S.bind(),S.setVertexAttribPointers(j,c,d)),V.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function De(L){const c=[];for(let _=0;_<L.length;_++){if(L[_]===null)continue;const A=L[_].split(" ");c.push(A.pop())}return c}class $a{constructor(c,_,A,h,d,x,b){const S=c.gl;this.program=S.createProgram();const M=De(A.staticAttributes),B=h?h.getBinderAttributes():[],V=M.concat(B),j=ui.prelude.staticUniforms?De(ui.prelude.staticUniforms):[],Y=A.staticUniforms?De(A.staticUniforms):[],ae=h?h.getBinderUniforms():[],ne=j.concat(Y).concat(ae),ue=[];for(const xe of ne)ue.indexOf(xe)<0&&ue.push(xe);const be=h?h.defines():[];x&&be.push("#define OVERDRAW_INSPECTOR;"),b&&be.push("#define TERRAIN3D;");const Me=be.concat(ui.prelude.fragmentSource,A.fragmentSource).join(`
`),ve=be.concat(ui.prelude.vertexSource,A.vertexSource).join(`
`),$e=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource($e,Me),S.compileShader($e),S.attachShader(this.program,$e);const Te=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(Te,ve),S.compileShader(Te),S.attachShader(this.program,Te),this.attributes={};const Ge={};this.numAttributes=V.length;for(let xe=0;xe<this.numAttributes;xe++)V[xe]&&(S.bindAttribLocation(this.program,xe,V[xe]),this.attributes[V[xe]]=xe);S.linkProgram(this.program),S.deleteShader(Te),S.deleteShader($e);for(let xe=0;xe<ue.length;xe++){const y=ue[xe];if(y&&!Ge[y]){const m=S.getUniformLocation(this.program,y);m&&(Ge[y]=m)}}this.fixedUniforms=d(c,Ge),this.terrainUniforms=((xe,y)=>({u_depth:new o.Uniform1i(xe,y.u_depth),u_terrain:new o.Uniform1i(xe,y.u_terrain),u_terrain_dim:new o.Uniform1f(xe,y.u_terrain_dim),u_terrain_matrix:new o.UniformMatrix4f(xe,y.u_terrain_matrix),u_terrain_unpack:new o.Uniform4f(xe,y.u_terrain_unpack),u_terrain_offset:new o.Uniform1f(xe,y.u_terrain_offset),u_terrain_exaggeration:new o.Uniform1f(xe,y.u_terrain_exaggeration)}))(c,Ge),this.binderUniforms=h?h.getUniforms(c,Ge):[]}draw(c,_,A,h,d,x,b,S,M,B,V,j,Y,ae,ne,ue,be,Me){const ve=c.gl;if(this.failedToCreate)return;if(c.program.set(this.program),c.setDepthMode(A),c.setStencilMode(h),c.setColorMode(d),c.setCullFace(x),S){c.activeTexture.set(ve.TEXTURE2),ve.bindTexture(ve.TEXTURE_2D,S.depthTexture),c.activeTexture.set(ve.TEXTURE3),ve.bindTexture(ve.TEXTURE_2D,S.texture);for(const Te in this.terrainUniforms)this.terrainUniforms[Te].set(S[Te])}for(const Te in this.fixedUniforms)this.fixedUniforms[Te].set(b[Te]);ne&&ne.setUniforms(c,this.binderUniforms,Y,{zoom:ae});let $e=0;switch(_){case ve.LINES:$e=2;break;case ve.TRIANGLES:$e=3;break;case ve.LINE_STRIP:$e=1}for(const Te of j.get()){const Ge=Te.vaos||(Te.vaos={});(Ge[M]||(Ge[M]=new ha)).bind(c,this,B,ne?ne.getPaintVertexBuffers():[],V,Te.vertexOffset,ue,be,Me),ve.drawElements(_,Te.primitiveLength*$e,ve.UNSIGNED_SHORT,Te.primitiveOffset*$e*2)}}}function we(L,c,_){const A=1/Or(_,1,c.transform.tileZoom),h=Math.pow(2,_.tileID.overscaledZ),d=_.tileSize*Math.pow(2,c.transform.tileZoom)/h,x=d*(_.tileID.canonical.x+_.tileID.wrap*h),b=d*_.tileID.canonical.y;return{u_image:0,u_texsize:_.imageAtlasTexture.size,u_scale:[A,L.fromScale,L.toScale],u_fade:L.t,u_pixel_coord_upper:[x>>16,b>>16],u_pixel_coord_lower:[65535&x,65535&b]}}const Go=(L,c,_,A)=>{const h=c.style.light,d=h.properties.get("position"),x=[d.x,d.y,d.z],b=o.create$1();h.properties.get("anchor")==="viewport"&&o.fromRotation(b,-c.transform.angle),o.transformMat3(x,x,b);const S=h.properties.get("color");return{u_matrix:L,u_lightpos:x,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[S.r,S.g,S.b],u_vertical_gradient:+_,u_opacity:A}},Es=(L,c,_,A,h,d,x)=>o.extend(Go(L,c,_,A),we(d,c,x),{u_height_factor:-Math.pow(2,h.overscaledZ)/x.tileSize/8}),ja=L=>({u_matrix:L}),Ha=(L,c,_,A)=>o.extend(ja(L),we(_,c,A)),fa=(L,c)=>({u_matrix:L,u_world:c}),Ml=(L,c,_,A,h)=>o.extend(Ha(L,c,_,A),{u_world:h}),da=(L,c,_,A)=>{const h=L.transform;let d,x;if(A.paint.get("circle-pitch-alignment")==="map"){const b=Or(_,1,h.zoom);d=!0,x=[b,b]}else d=!1,x=h.pixelsToGLUnits;return{u_camera_to_center_distance:h.cameraToCenterDistance,u_scale_with_map:+(A.paint.get("circle-pitch-scale")==="map"),u_matrix:L.translatePosMatrix(c.posMatrix,_,A.paint.get("circle-translate"),A.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:L.pixelRatio,u_extrude_scale:x}},ni=(L,c,_)=>{const A=Or(_,1,c.zoom),h=Math.pow(2,c.zoom-_.tileID.overscaledZ),d=_.tileID.overscaleFactor();return{u_matrix:L,u_camera_to_center_distance:c.cameraToCenterDistance,u_pixels_to_tile_units:A,u_extrude_scale:[c.pixelsToGLUnits[0]/(A*h),c.pixelsToGLUnits[1]/(A*h)],u_overscale_factor:d}},ge=(L,c,_=1)=>({u_matrix:L,u_color:c,u_overlay:0,u_overlay_scale:_}),Ee=L=>({u_matrix:L}),Fe=(L,c,_,A)=>({u_matrix:L,u_extrude_scale:Or(c,1,_),u_intensity:A});function lt(L,c){const _=Math.pow(2,c.canonical.z),A=c.canonical.y;return[new o.MercatorCoordinate(0,A/_).toLngLat().lat,new o.MercatorCoordinate(0,(A+1)/_).toLngLat().lat]}const bt=(L,c,_,A)=>{const h=L.transform;return{u_matrix:Dr(L,c,_,A),u_ratio:1/Or(c,1,h.zoom),u_device_pixel_ratio:L.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Qt=(L,c,_,A,h)=>o.extend(bt(L,c,_,h),{u_image:0,u_image_height:A}),Ln=(L,c,_,A,h)=>{const d=L.transform,x=en(c,d);return{u_matrix:Dr(L,c,_,h),u_texsize:c.imageAtlasTexture.size,u_ratio:1/Or(c,1,d.zoom),u_device_pixel_ratio:L.pixelRatio,u_image:0,u_scale:[x,A.fromScale,A.toScale],u_fade:A.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Ir=(L,c,_,A,h,d)=>{const x=L.lineAtlas,b=en(c,L.transform),S=_.layout.get("line-cap")==="round",M=x.getDash(A.from,S),B=x.getDash(A.to,S),V=M.width*h.fromScale,j=B.width*h.toScale;return o.extend(bt(L,c,_,d),{u_patternscale_a:[b/V,-M.height/2],u_patternscale_b:[b/j,-B.height/2],u_sdfgamma:x.width/(256*Math.min(V,j)*L.pixelRatio)/2,u_image:0,u_tex_y_a:M.y,u_tex_y_b:B.y,u_mix:h.t})};function en(L,c){return 1/Or(L,1,c.tileZoom)}function Dr(L,c,_,A){return L.translatePosMatrix(A?A.posMatrix:c.tileID.posMatrix,c,_.paint.get("line-translate"),_.paint.get("line-translate-anchor"))}const $n=(L,c,_,A,h)=>{return{u_matrix:L,u_tl_parent:c,u_scale_parent:_,u_buffer_scale:1,u_fade_t:A.mix,u_opacity:A.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(x=h.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(d=h.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:wA(h.paint.get("raster-hue-rotate"))};var d,x};function wA(L){L*=Math.PI/180;const c=Math.sin(L),_=Math.cos(L);return[(2*_+1)/3,(-Math.sqrt(3)*c-_+1)/3,(Math.sqrt(3)*c-_+1)/3]}const bA=(L,c,_,A,h,d,x,b,S,M)=>{const B=h.transform;return{u_is_size_zoom_constant:+(L==="constant"||L==="source"),u_is_size_feature_constant:+(L==="constant"||L==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:B.cameraToCenterDistance,u_pitch:B.pitch/360*2*Math.PI,u_rotate_symbol:+_,u_aspect_ratio:B.width/B.height,u_fade_change:h.options.fadeDuration?h.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:x,u_coord_matrix:b,u_is_text:+S,u_pitch_with_map:+A,u_texsize:M,u_texture:0}},EA=(L,c,_,A,h,d,x,b,S,M,B)=>{const V=h.transform;return o.extend(bA(L,c,_,A,h,d,x,b,S,M),{u_gamma_scale:A?Math.cos(V._pitch)*V.cameraToCenterDistance:1,u_device_pixel_ratio:h.pixelRatio,u_is_halo:+B})},iu=(L,c,_,A,h,d,x,b,S,M)=>o.extend(EA(L,c,_,A,h,d,x,b,!0,S,!0),{u_texsize_icon:M,u_texture_icon:1}),su=(L,c,_)=>({u_matrix:L,u_opacity:c,u_color:_}),TA=(L,c,_,A,h,d)=>o.extend(function(x,b,S,M){const B=S.imageManager.getPattern(x.from.toString()),V=S.imageManager.getPattern(x.to.toString()),{width:j,height:Y}=S.imageManager.getPixelSize(),ae=Math.pow(2,M.tileID.overscaledZ),ne=M.tileSize*Math.pow(2,S.transform.tileZoom)/ae,ue=ne*(M.tileID.canonical.x+M.tileID.wrap*ae),be=ne*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[j,Y],u_mix:b.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/Or(M,1,S.transform.tileZoom),u_pixel_coord_upper:[ue>>16,be>>16],u_pixel_coord_lower:[65535&ue,65535&be]}}(A,d,_,h),{u_matrix:L,u_opacity:c}),Pl={fillExtrusion:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_lightpos:new o.Uniform3f(L,c.u_lightpos),u_lightintensity:new o.Uniform1f(L,c.u_lightintensity),u_lightcolor:new o.Uniform3f(L,c.u_lightcolor),u_vertical_gradient:new o.Uniform1f(L,c.u_vertical_gradient),u_opacity:new o.Uniform1f(L,c.u_opacity)}),fillExtrusionPattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_lightpos:new o.Uniform3f(L,c.u_lightpos),u_lightintensity:new o.Uniform1f(L,c.u_lightintensity),u_lightcolor:new o.Uniform3f(L,c.u_lightcolor),u_vertical_gradient:new o.Uniform1f(L,c.u_vertical_gradient),u_height_factor:new o.Uniform1f(L,c.u_height_factor),u_image:new o.Uniform1i(L,c.u_image),u_texsize:new o.Uniform2f(L,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade),u_opacity:new o.Uniform1f(L,c.u_opacity)}),fill:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),fillPattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_image:new o.Uniform1i(L,c.u_image),u_texsize:new o.Uniform2f(L,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade)}),fillOutline:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_world:new o.Uniform2f(L,c.u_world)}),fillOutlinePattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_world:new o.Uniform2f(L,c.u_world),u_image:new o.Uniform1i(L,c.u_image),u_texsize:new o.Uniform2f(L,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade)}),circle:(L,c)=>({u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(L,c.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(L,c.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),collisionBox:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(L,c.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(L,c.u_extrude_scale),u_overscale_factor:new o.Uniform1f(L,c.u_overscale_factor)}),collisionCircle:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_inv_matrix:new o.UniformMatrix4f(L,c.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(L,c.u_viewport_size)}),debug:(L,c)=>({u_color:new o.UniformColor(L,c.u_color),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_overlay:new o.Uniform1i(L,c.u_overlay),u_overlay_scale:new o.Uniform1f(L,c.u_overlay_scale)}),clippingMask:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),heatmap:(L,c)=>({u_extrude_scale:new o.Uniform1f(L,c.u_extrude_scale),u_intensity:new o.Uniform1f(L,c.u_intensity),u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),heatmapTexture:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_world:new o.Uniform2f(L,c.u_world),u_image:new o.Uniform1i(L,c.u_image),u_color_ramp:new o.Uniform1i(L,c.u_color_ramp),u_opacity:new o.Uniform1f(L,c.u_opacity)}),hillshade:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_image:new o.Uniform1i(L,c.u_image),u_latrange:new o.Uniform2f(L,c.u_latrange),u_light:new o.Uniform2f(L,c.u_light),u_shadow:new o.UniformColor(L,c.u_shadow),u_highlight:new o.UniformColor(L,c.u_highlight),u_accent:new o.UniformColor(L,c.u_accent)}),hillshadePrepare:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_image:new o.Uniform1i(L,c.u_image),u_dimension:new o.Uniform2f(L,c.u_dimension),u_zoom:new o.Uniform1f(L,c.u_zoom),u_unpack:new o.Uniform4f(L,c.u_unpack)}),line:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels)}),lineGradient:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels),u_image:new o.Uniform1i(L,c.u_image),u_image_height:new o.Uniform1f(L,c.u_image_height)}),linePattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_texsize:new o.Uniform2f(L,c.u_texsize),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_image:new o.Uniform1i(L,c.u_image),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade)}),lineSDF:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(L,c.u_patternscale_a),u_patternscale_b:new o.Uniform2f(L,c.u_patternscale_b),u_sdfgamma:new o.Uniform1f(L,c.u_sdfgamma),u_image:new o.Uniform1i(L,c.u_image),u_tex_y_a:new o.Uniform1f(L,c.u_tex_y_a),u_tex_y_b:new o.Uniform1f(L,c.u_tex_y_b),u_mix:new o.Uniform1f(L,c.u_mix)}),raster:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_tl_parent:new o.Uniform2f(L,c.u_tl_parent),u_scale_parent:new o.Uniform1f(L,c.u_scale_parent),u_buffer_scale:new o.Uniform1f(L,c.u_buffer_scale),u_fade_t:new o.Uniform1f(L,c.u_fade_t),u_opacity:new o.Uniform1f(L,c.u_opacity),u_image0:new o.Uniform1i(L,c.u_image0),u_image1:new o.Uniform1i(L,c.u_image1),u_brightness_low:new o.Uniform1f(L,c.u_brightness_low),u_brightness_high:new o.Uniform1f(L,c.u_brightness_high),u_saturation_factor:new o.Uniform1f(L,c.u_saturation_factor),u_contrast_factor:new o.Uniform1f(L,c.u_contrast_factor),u_spin_weights:new o.Uniform3f(L,c.u_spin_weights)}),symbolIcon:(L,c)=>({u_is_size_zoom_constant:new o.Uniform1i(L,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(L,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(L,c.u_size_t),u_size:new o.Uniform1f(L,c.u_size),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(L,c.u_pitch),u_rotate_symbol:new o.Uniform1i(L,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(L,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(L,c.u_fade_change),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(L,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(L,c.u_coord_matrix),u_is_text:new o.Uniform1i(L,c.u_is_text),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_texsize:new o.Uniform2f(L,c.u_texsize),u_texture:new o.Uniform1i(L,c.u_texture)}),symbolSDF:(L,c)=>({u_is_size_zoom_constant:new o.Uniform1i(L,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(L,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(L,c.u_size_t),u_size:new o.Uniform1f(L,c.u_size),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(L,c.u_pitch),u_rotate_symbol:new o.Uniform1i(L,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(L,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(L,c.u_fade_change),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(L,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(L,c.u_coord_matrix),u_is_text:new o.Uniform1i(L,c.u_is_text),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_texsize:new o.Uniform2f(L,c.u_texsize),u_texture:new o.Uniform1i(L,c.u_texture),u_gamma_scale:new o.Uniform1f(L,c.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(L,c.u_is_halo)}),symbolTextAndIcon:(L,c)=>({u_is_size_zoom_constant:new o.Uniform1i(L,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(L,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(L,c.u_size_t),u_size:new o.Uniform1f(L,c.u_size),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(L,c.u_pitch),u_rotate_symbol:new o.Uniform1i(L,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(L,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(L,c.u_fade_change),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(L,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(L,c.u_coord_matrix),u_is_text:new o.Uniform1i(L,c.u_is_text),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_texsize:new o.Uniform2f(L,c.u_texsize),u_texsize_icon:new o.Uniform2f(L,c.u_texsize_icon),u_texture:new o.Uniform1i(L,c.u_texture),u_texture_icon:new o.Uniform1i(L,c.u_texture_icon),u_gamma_scale:new o.Uniform1f(L,c.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(L,c.u_is_halo)}),background:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_opacity:new o.Uniform1f(L,c.u_opacity),u_color:new o.UniformColor(L,c.u_color)}),backgroundPattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_opacity:new o.Uniform1f(L,c.u_opacity),u_image:new o.Uniform1i(L,c.u_image),u_pattern_tl_a:new o.Uniform2f(L,c.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(L,c.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(L,c.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(L,c.u_pattern_br_b),u_texsize:new o.Uniform2f(L,c.u_texsize),u_mix:new o.Uniform1f(L,c.u_mix),u_pattern_size_a:new o.Uniform2f(L,c.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(L,c.u_pattern_size_b),u_scale_a:new o.Uniform1f(L,c.u_scale_a),u_scale_b:new o.Uniform1f(L,c.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(L,c.u_tile_units_to_pixels)}),terrain:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_texture:new o.Uniform1i(L,c.u_texture)}),terrainDepth:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),terrainCoords:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_texture:new o.Uniform1i(L,c.u_texture),u_terrain_coords_id:new o.Uniform1f(L,c.u_terrain_coords_id)})};class kl{constructor(c,_,A){this.context=c;const h=c.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!A,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete _.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const _=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),_.bufferSubData(_.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const SA={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class CA{constructor(c,_,A,h){this.length=_.length,this.attributes=A,this.itemSize=_.bytesPerElement,this.dynamicDraw=h,this.context=c;const d=c.gl;this.buffer=d.createBuffer(),c.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete _.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){if(c.length!==this.length)throw new Error(`Length of new data is ${c.length}, which doesn't match current length of ${this.length}`);const _=this.context.gl;this.bind(),_.bufferSubData(_.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,_){for(let A=0;A<this.attributes.length;A++){const h=_.attributes[this.attributes[A].name];h!==void 0&&c.enableVertexAttribArray(h)}}setVertexAttribPointers(c,_,A){for(let h=0;h<this.attributes.length;h++){const d=this.attributes[h],x=_.attributes[d.name];x!==void 0&&c.vertexAttribPointer(x,d.components,c[SA[d.type]],!1,this.itemSize,d.offset+this.itemSize*(A||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Kn{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ou extends Kn{getDefault(){return o.Color.transparent}set(c){const _=this.current;(c.r!==_.r||c.g!==_.g||c.b!==_.b||c.a!==_.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class yc extends Kn{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class Il extends Kn{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class qr extends Kn{getDefault(){return[!0,!0,!0,!0]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||c[3]!==_[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class $o extends Kn{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class On extends Kn{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Ts extends Kn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const _=this.current;(c.func!==_.func||c.ref!==_.ref||c.mask!==_.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class ri extends Kn{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class yo extends Kn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.STENCIL_TEST):_.disable(_.STENCIL_TEST),this.current=c,this.dirty=!1}}class Ll extends Kn{getDefault(){return[0,1]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class jo extends Kn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.DEPTH_TEST):_.disable(_.DEPTH_TEST),this.current=c,this.dirty=!1}}class pa extends Kn{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class _o extends Kn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.BLEND):_.disable(_.BLEND),this.current=c,this.dirty=!1}}class MA extends Kn{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class Wa extends Kn{getDefault(){return o.Color.transparent}set(c){const _=this.current;(c.r!==_.r||c.g!==_.g||c.b!==_.b||c.a!==_.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Ho extends Kn{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class Hi extends Kn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.CULL_FACE):_.disable(_.CULL_FACE),this.current=c,this.dirty=!1}}class Wi extends Kn{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class au extends Kn{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class Dl extends Kn{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class vo extends Kn{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class Wo extends Kn{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||c[3]!==_[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class _c extends Kn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindFramebuffer(_.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class lu extends Kn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindRenderbuffer(_.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Rl extends Kn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindTexture(_.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class PA extends Kn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindBuffer(_.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Au extends Kn{getDefault(){return null}set(c){const _=this.gl;_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Qo extends Kn{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class Qa extends Kn{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class uu extends Kn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class cu extends Kn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class xo extends Kn{constructor(c,_){super(c),this.context=c,this.parent=_}getDefault(){return null}}class ga extends xo{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class hu extends xo{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class ma{constructor(c,_,A,h){this.context=c,this.width=_,this.height=A;const d=c.gl,x=this.framebuffer=d.createFramebuffer();if(this.colorAttachment=new ga(c,x),h&&(this.depthAttachment=new hu(c,x)),d.checkFramebufferStatus(d.FRAMEBUFFER)!==d.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const c=this.context.gl,_=this.colorAttachment.get();if(_&&c.deleteTexture(_),this.depthAttachment){const A=this.depthAttachment.get();A&&c.deleteRenderbuffer(A)}c.deleteFramebuffer(this.framebuffer)}}class fr{constructor(c,_,A){this.blendFunction=c,this.blendColor=_,this.mask=A}}fr.Replace=[1,0],fr.disabled=new fr(fr.Replace,o.Color.transparent,[!1,!1,!1,!1]),fr.unblended=new fr(fr.Replace,o.Color.transparent,[!0,!0,!0,!0]),fr.alphaBlended=new fr([1,771],o.Color.transparent,[!0,!0,!0,!0]);class Vs{constructor(c){this.gl=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ou(this),this.clearDepth=new yc(this),this.clearStencil=new Il(this),this.colorMask=new qr(this),this.depthMask=new $o(this),this.stencilMask=new On(this),this.stencilFunc=new Ts(this),this.stencilOp=new ri(this),this.stencilTest=new yo(this),this.depthRange=new Ll(this),this.depthTest=new jo(this),this.depthFunc=new pa(this),this.blend=new _o(this),this.blendFunc=new MA(this),this.blendColor=new Wa(this),this.blendEquation=new Ho(this),this.cullFace=new Hi(this),this.cullFaceSide=new Wi(this),this.frontFace=new au(this),this.program=new Dl(this),this.activeTexture=new vo(this),this.viewport=new Wo(this),this.bindFramebuffer=new _c(this),this.bindRenderbuffer=new lu(this),this.bindTexture=new Rl(this),this.bindVertexBuffer=new PA(this),this.bindElementBuffer=new Au(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Qo(this),this.pixelStoreUnpack=new Qa(this),this.pixelStoreUnpackPremultiplyAlpha=new uu(this),this.pixelStoreUnpackFlipY=new cu(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=c.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(c.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,_){return new kl(this,c,_)}createVertexBuffer(c,_,A){return new CA(this,c,_,A)}createRenderbuffer(c,_,A){const h=this.gl,d=h.createRenderbuffer();return this.bindRenderbuffer.set(d),h.renderbufferStorage(h.RENDERBUFFER,c,_,A),this.bindRenderbuffer.set(null),d}createFramebuffer(c,_,A){return new ma(this,c,_,A)}clear({color:c,depth:_}){const A=this.gl;let h=0;c&&(h|=A.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),_!==void 0&&(h|=A.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(_),this.depthMask.set(!0)),A.clear(h)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){P(c.blendFunction,fr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class jn{constructor(c,_,A){this.func=c,this.mask=_,this.range=A}}jn.ReadOnly=!1,jn.ReadWrite=!0,jn.disabled=new jn(519,jn.ReadOnly,[0,1]);const Zn=7680;class wr{constructor(c,_,A,h,d,x){this.test=c,this.ref=_,this.mask=A,this.fail=h,this.depthFail=d,this.pass=x}}wr.disabled=new wr({func:519,mask:0},0,0,Zn,Zn,Zn);class gr{constructor(c,_,A){this.enable=c,this.mode=_,this.frontFace=A}}let Bl;function qo(L,c,_,A,h,d,x){const b=L.context,S=b.gl,M=L.useProgram("collisionBox"),B=[];let V=0,j=0;for(let ve=0;ve<A.length;ve++){const $e=A[ve],Te=c.getTile($e),Ge=Te.getBucket(_);if(!Ge)continue;let xe=$e.posMatrix;h[0]===0&&h[1]===0||(xe=L.translatePosMatrix($e.posMatrix,Te,h,d));const y=x?Ge.textCollisionBox:Ge.iconCollisionBox,m=Ge.collisionCircleArray;if(m.length>0){const v=o.create(),E=xe;o.mul(v,Ge.placementInvProjMatrix,L.transform.glCoordMatrix),o.mul(v,v,Ge.placementViewportMatrix),B.push({circleArray:m,circleOffset:j,transform:E,invTransform:v,coord:$e}),V+=m.length/4,j=V}y&&M.draw(b,S.LINES,jn.disabled,wr.disabled,L.colorModeForRenderPass(),gr.disabled,ni(xe,L.transform,Te),L.style.terrain&&L.style.terrain.getTerrainData($e),_.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,null,L.transform.zoom,null,null,y.collisionVertexBuffer)}if(!x||!B.length)return;const Y=L.useProgram("collisionCircle"),ae=new o.CollisionCircleLayoutArray;ae.resize(4*V),ae._trim();let ne=0;for(const ve of B)for(let $e=0;$e<ve.circleArray.length/4;$e++){const Te=4*$e,Ge=ve.circleArray[Te+0],xe=ve.circleArray[Te+1],y=ve.circleArray[Te+2],m=ve.circleArray[Te+3];ae.emplace(ne++,Ge,xe,y,m,0),ae.emplace(ne++,Ge,xe,y,m,1),ae.emplace(ne++,Ge,xe,y,m,2),ae.emplace(ne++,Ge,xe,y,m,3)}(!Bl||Bl.length<2*V)&&(Bl=function(ve){const $e=2*ve,Te=new o.QuadTriangleArray;Te.resize($e),Te._trim();for(let Ge=0;Ge<$e;Ge++){const xe=6*Ge;Te.uint16[xe+0]=4*Ge+0,Te.uint16[xe+1]=4*Ge+1,Te.uint16[xe+2]=4*Ge+2,Te.uint16[xe+3]=4*Ge+2,Te.uint16[xe+4]=4*Ge+3,Te.uint16[xe+5]=4*Ge+0}return Te}(V));const ue=b.createIndexBuffer(Bl,!0),be=b.createVertexBuffer(ae,o.collisionCircleLayout.members,!0);for(const ve of B){const $e={u_matrix:ve.transform,u_inv_matrix:ve.invTransform,u_camera_to_center_distance:(Me=L.transform).cameraToCenterDistance,u_viewport_size:[Me.width,Me.height]};Y.draw(b,S.TRIANGLES,jn.disabled,wr.disabled,L.colorModeForRenderPass(),gr.disabled,$e,L.style.terrain&&L.style.terrain.getTerrainData(ve.coord),_.id,be,ue,o.SegmentVector.simpleSegment(0,2*ve.circleOffset,ve.circleArray.length,ve.circleArray.length/2),null,L.transform.zoom,null,null,null)}var Me;be.destroy(),ue.destroy()}gr.disabled=new gr(!1,1029,2305),gr.backCCW=new gr(!0,1029,2305);const vc=o.identity(new Float32Array(16));function qa(L,c,_,A,h,d){const{horizontalAlign:x,verticalAlign:b}=o.getAnchorAlignment(L),S=-(x-.5)*c,M=-(b-.5)*_,B=o.evaluateVariableOffset(L,A);return new o.pointGeometry((S/h+B[0])*d,(M/h+B[1])*d)}function xc(L,c,_,A,h,d,x,b,S,M,B){const V=L.text.placedSymbolArray,j=L.text.dynamicLayoutVertexArray,Y=L.icon.dynamicLayoutVertexArray,ae={};j.clear();for(let ne=0;ne<V.length;ne++){const ue=V.get(ne),be=L.allowVerticalPlacement&&!ue.placedOrientation,Me=ue.hidden||!ue.crossTileID||be?null:A[ue.crossTileID];if(Me){const ve=new o.pointGeometry(ue.anchorX,ue.anchorY),$e=zn(ve,_?x:d,B),Te=Gi(h.cameraToCenterDistance,$e.signedDistanceFromCamera);let Ge=o.evaluateSizeForFeature(L.textSizeData,S,ue)*Te/o.ONE_EM;_&&(Ge*=L.tilePixelRatio/b);const{width:xe,height:y,anchor:m,textOffset:v,textBoxScale:E}=Me,k=qa(m,xe,y,v,E,Ge),R=_?zn(ve.add(k),d,B).point:$e.point.add(c?k.rotate(-h.angle):k),O=L.allowVerticalPlacement&&ue.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let N=0;N<ue.numGlyphs;N++)o.addDynamicAttributes(j,R,O);M&&ue.associatedIconIndex>=0&&(ae[ue.associatedIconIndex]={shiftedAnchor:R,angle:O})}else yn(ue.numGlyphs,j)}if(M){Y.clear();const ne=L.icon.placedSymbolArray;for(let ue=0;ue<ne.length;ue++){const be=ne.get(ue);if(be.hidden)yn(be.numGlyphs,Y);else{const Me=ae[ue];if(Me)for(let ve=0;ve<be.numGlyphs;ve++)o.addDynamicAttributes(Y,Me.shiftedAnchor,Me.angle);else yn(be.numGlyphs,Y)}}L.icon.dynamicLayoutVertexBuffer.updateData(Y)}L.text.dynamicLayoutVertexBuffer.updateData(j)}function fu(L,c,_){return _.iconsInText&&c?"symbolTextAndIcon":L?"symbolSDF":"symbolIcon"}function Gs(L,c,_,A,h,d,x,b,S,M,B,V){const j=L.context,Y=j.gl,ae=L.transform,ne=b==="map",ue=S==="map",be=b!=="viewport"&&_.layout.get("symbol-placement")!=="point",Me=ne&&!ue&&!be,ve=!_.layout.get("symbol-sort-key").isConstant();let $e=!1;const Te=L.depthModeForSublayer(0,jn.ReadOnly),Ge=_.layout.get("text-variable-anchor"),xe=[];for(const y of A){const m=c.getTile(y),v=m.getBucket(_);if(!v)continue;const E=h?v.text:v.icon;if(!E||!E.segments.get().length)continue;const k=E.programConfigurations.get(_.id),R=h||v.sdfIcons,O=h?v.textSizeData:v.iconSizeData,N=ue||ae.pitch!==0,q=L.useProgram(fu(R,h,v),k),J=o.evaluateSizeForZoom(O,ae.zoom),le=L.style.terrain&&L.style.terrain.getTerrainData(y);let de,Re,je,Be,Xe=[0,0],ft=null;if(h){if(Re=m.glyphAtlasTexture,je=Y.LINEAR,de=m.glyphAtlasTexture.size,v.iconsInText){Xe=m.imageAtlasTexture.size,ft=m.imageAtlasTexture;const _n=O.kind==="composite"||O.kind==="camera";Be=N||L.options.rotating||L.options.zooming||_n?Y.LINEAR:Y.NEAREST}}else{const _n=_.layout.get("icon-size").constantOr(0)!==1||v.iconsNeedLinear;Re=m.imageAtlasTexture,je=R||L.options.rotating||L.options.zooming||_n||N?Y.LINEAR:Y.NEAREST,de=m.imageAtlasTexture.size}const ct=Or(m,1,L.transform.zoom),st=Fs(y.posMatrix,ue,ne,L.transform,ct),ot=wi(y.posMatrix,ue,ne,L.transform,ct),Je=Ge&&v.hasTextData(),Gt=_.layout.get("icon-text-fit")!=="none"&&Je&&v.hasIconData();if(be){const _n=L.style.terrain?(Dn,ar)=>L.style.terrain.getElevation(y,Dn,ar):null,En=_.layout.get("text-rotation-alignment")==="map";Li(v,y.posMatrix,L,h,st,ot,ue,M,En,_n)}const zt=L.translatePosMatrix(y.posMatrix,m,d,x),pt=be||h&&Ge||Gt?vc:st,vt=L.translatePosMatrix(ot,m,d,x,!0),Pn=R&&_.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let wn;wn=R?v.iconsInText?iu(O.kind,J,Me,ue,L,zt,pt,vt,de,Xe):EA(O.kind,J,Me,ue,L,zt,pt,vt,h,de,!0):bA(O.kind,J,Me,ue,L,zt,pt,vt,h,de);const mn={program:q,buffers:E,uniformValues:wn,atlasTexture:Re,atlasTextureIcon:ft,atlasInterpolation:je,atlasInterpolationIcon:Be,isSDF:R,hasHalo:Pn};if(ve&&v.canOverlap){$e=!0;const _n=E.segments.get();for(const En of _n)xe.push({segments:new o.SegmentVector([En]),sortKey:En.sortKey,state:mn,terrainData:le})}else xe.push({segments:E.segments,sortKey:0,state:mn,terrainData:le})}$e&&xe.sort((y,m)=>y.sortKey-m.sortKey);for(const y of xe){const m=y.state;if(j.activeTexture.set(Y.TEXTURE0),m.atlasTexture.bind(m.atlasInterpolation,Y.CLAMP_TO_EDGE),m.atlasTextureIcon&&(j.activeTexture.set(Y.TEXTURE1),m.atlasTextureIcon&&m.atlasTextureIcon.bind(m.atlasInterpolationIcon,Y.CLAMP_TO_EDGE)),m.isSDF){const v=m.uniformValues;m.hasHalo&&(v.u_is_halo=1,zl(m.buffers,y.segments,_,L,m.program,Te,B,V,v,y.terrainData)),v.u_is_halo=0}zl(m.buffers,y.segments,_,L,m.program,Te,B,V,m.uniformValues,y.terrainData)}}function zl(L,c,_,A,h,d,x,b,S,M){const B=A.context;h.draw(B,B.gl.TRIANGLES,d,x,b,gr.disabled,S,M,_.id,L.layoutVertexBuffer,L.indexBuffer,c,_.paint,A.transform.zoom,L.programConfigurations.get(_.id),L.dynamicLayoutVertexBuffer,L.opacityVertexBuffer)}function Za(L,c,_,A,h,d,x){const b=L.context.gl,S=_.paint.get("fill-pattern"),M=S&&S.constantOr(1),B=_.getCrossfadeParameters();let V,j,Y,ae,ne;x?(j=M&&!_.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=b.LINES):(j=M?"fillPattern":"fill",V=b.TRIANGLES);for(const ue of A){const be=c.getTile(ue);if(M&&!be.patternsLoaded())continue;const Me=be.getBucket(_);if(!Me)continue;const ve=Me.programConfigurations.get(_.id),$e=L.useProgram(j,ve),Te=L.style.terrain&&L.style.terrain.getTerrainData(ue);M&&(L.context.activeTexture.set(b.TEXTURE0),be.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),ve.updatePaintBuffers(B));const Ge=S.constantOr(null);if(Ge&&be.imageAtlas){const m=be.imageAtlas,v=m.patternPositions[Ge.to.toString()],E=m.patternPositions[Ge.from.toString()];v&&E&&ve.setConstantPatternPositions(v,E)}const xe=Te?ue:null,y=L.translatePosMatrix(xe?xe.posMatrix:ue.posMatrix,be,_.paint.get("fill-translate"),_.paint.get("fill-translate-anchor"));if(x){ae=Me.indexBuffer2,ne=Me.segments2;const m=[b.drawingBufferWidth,b.drawingBufferHeight];Y=j==="fillOutlinePattern"&&M?Ml(y,L,B,be,m):fa(y,m)}else ae=Me.indexBuffer,ne=Me.segments,Y=M?Ha(y,L,B,be):ja(y);$e.draw(L.context,V,h,L.stencilModeForClipping(ue),d,gr.disabled,Y,Te,_.id,Me.layoutVertexBuffer,ae,ne,_.paint,L.transform.zoom,ve)}}function ya(L,c,_,A,h,d,x){const b=L.context,S=b.gl,M=_.paint.get("fill-extrusion-pattern"),B=M.constantOr(1),V=_.getCrossfadeParameters(),j=_.paint.get("fill-extrusion-opacity");for(const Y of A){const ae=c.getTile(Y),ne=ae.getBucket(_);if(!ne)continue;const ue=L.style.terrain&&L.style.terrain.getTerrainData(Y),be=ne.programConfigurations.get(_.id),Me=L.useProgram(B?"fillExtrusionPattern":"fillExtrusion",be);B&&(L.context.activeTexture.set(S.TEXTURE0),ae.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),be.updatePaintBuffers(V));const ve=M.constantOr(null);if(ve&&ae.imageAtlas){const xe=ae.imageAtlas,y=xe.patternPositions[ve.to.toString()],m=xe.patternPositions[ve.from.toString()];y&&m&&be.setConstantPatternPositions(y,m)}const $e=L.translatePosMatrix(Y.posMatrix,ae,_.paint.get("fill-extrusion-translate"),_.paint.get("fill-extrusion-translate-anchor")),Te=_.paint.get("fill-extrusion-vertical-gradient"),Ge=B?Es($e,L,Te,j,Y,V,ae):Go($e,L,Te,j);Me.draw(b,b.gl.TRIANGLES,h,d,x,gr.backCCW,Ge,ue,_.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,_.paint,L.transform.zoom,be,L.style.terrain&&ne.centroidVertexBuffer)}}function Ol(L,c,_,A,h,d,x){const b=L.context,S=b.gl,M=_.fbo;if(!M)return;const B=L.useProgram("hillshade"),V=L.style.terrain&&L.style.terrain.getTerrainData(c);b.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,M.colorAttachment.get()),B.draw(b,S.TRIANGLES,h,d,x,gr.disabled,((j,Y,ae,ne)=>{const ue=ae.paint.get("hillshade-shadow-color"),be=ae.paint.get("hillshade-highlight-color"),Me=ae.paint.get("hillshade-accent-color");let ve=ae.paint.get("hillshade-illumination-direction")*(Math.PI/180);ae.paint.get("hillshade-illumination-anchor")==="viewport"&&(ve-=j.transform.angle);const $e=!j.options.moving;return{u_matrix:ne?ne.posMatrix:j.transform.calculatePosMatrix(Y.tileID.toUnwrapped(),$e),u_image:0,u_latrange:lt(0,Y.tileID),u_light:[ae.paint.get("hillshade-exaggeration"),ve],u_shadow:ue,u_highlight:be,u_accent:Me}})(L,_,A,V?c:null),V,A.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments)}function Fl(L,c,_,A,h,d){const x=L.context,b=x.gl,S=c.dem;if(S&&S.data){const M=S.dim,B=S.stride,V=S.getPixels();if(x.activeTexture.set(b.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||L.getTileTexture(B),c.demTexture){const Y=c.demTexture;Y.update(V,{premultiply:!1}),Y.bind(b.NEAREST,b.CLAMP_TO_EDGE)}else c.demTexture=new H(x,V,b.RGBA,{premultiply:!1}),c.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);x.activeTexture.set(b.TEXTURE0);let j=c.fbo;if(!j){const Y=new H(x,{width:M,height:M,data:null},b.RGBA);Y.bind(b.LINEAR,b.CLAMP_TO_EDGE),j=c.fbo=x.createFramebuffer(M,M,!0),j.colorAttachment.set(Y.texture)}x.bindFramebuffer.set(j.framebuffer),x.viewport.set([0,0,M,M]),L.useProgram("hillshadePrepare").draw(x,b.TRIANGLES,A,h,d,gr.disabled,((Y,ae)=>{const ne=ae.stride,ue=o.create();return o.ortho(ue,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(ue,ue,[0,-o.EXTENT,0]),{u_matrix:ue,u_image:1,u_dimension:[ne,ne],u_zoom:Y.overscaledZ,u_unpack:ae.getUnpackVector()}})(c.tileID,S),null,_.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function mr(L,c,_,A,h,d){const x=A.paint.get("raster-fade-duration");if(!d&&x>0){const b=o.exported.now(),S=(b-L.timeAdded)/x,M=c?(b-c.timeAdded)/x:-1,B=_.getSource(),V=h.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),j=!c||Math.abs(c.tileID.overscaledZ-V)>Math.abs(L.tileID.overscaledZ-V),Y=j&&L.refreshedUponExpiration?1:o.clamp(j?S:1-M,0,1);return L.refreshedUponExpiration&&S>=1&&(L.refreshedUponExpiration=!1),c?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}const kA=new o.Color(1,0,0,1),As=new o.Color(0,1,0,1),du=new o.Color(0,0,1,1),Nl=new o.Color(1,0,1,1),wc=new o.Color(0,1,1,1);function Zr(L,c,_,A){ii(L,0,c+_/2,L.transform.width,_,A)}function Rr(L,c,_,A){ii(L,c-_/2,0,_,L.transform.height,A)}function ii(L,c,_,A,h,d){const x=L.context,b=x.gl;b.enable(b.SCISSOR_TEST),b.scissor(c*L.pixelRatio,_*L.pixelRatio,A*L.pixelRatio,h*L.pixelRatio),x.clear({color:d}),b.disable(b.SCISSOR_TEST)}function pu(L,c,_){const A=L.context,h=A.gl,d=_.posMatrix,x=L.useProgram("debug"),b=jn.disabled,S=wr.disabled,M=L.colorModeForRenderPass(),B="$debug",V=L.style.terrain&&L.style.terrain.getTerrainData(_);A.activeTexture.set(h.TEXTURE0),L.emptyTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE);const j=c.getTileByID(_.key).latestRawTileData,Y=Math.floor((j&&j.byteLength||0)/1024),ae=c.getTile(_).tileSize,ne=512/Math.min(ae,512)*(_.overscaledZ/L.transform.zoom)*.5;let ue=_.canonical.toString();_.overscaledZ!==_.canonical.z&&(ue+=` => ${_.overscaledZ}`),function(be,Me){be.initDebugOverlayCanvas();const ve=be.debugOverlayCanvas,$e=be.context.gl,Te=be.debugOverlayCanvas.getContext("2d");Te.clearRect(0,0,ve.width,ve.height),Te.shadowColor="white",Te.shadowBlur=2,Te.lineWidth=1.5,Te.strokeStyle="white",Te.textBaseline="top",Te.font="bold 36px Open Sans, sans-serif",Te.fillText(Me,5,5),Te.strokeText(Me,5,5),be.debugOverlayTexture.update(ve),be.debugOverlayTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE)}(L,`${ue} ${Y}kB`),x.draw(A,h.TRIANGLES,b,S,fr.alphaBlended,gr.disabled,ge(d,o.Color.transparent,ne),null,B,L.debugBuffer,L.quadTriangleIndexBuffer,L.debugSegments),x.draw(A,h.LINE_STRIP,b,S,M,gr.disabled,ge(d,o.Color.red),V,B,L.debugBuffer,L.tileBorderIndexBuffer,L.debugSegments)}function $s(L,c,_){const A=L.context,h=A.gl,d=L.colorModeForRenderPass(),x=new jn(h.LEQUAL,jn.ReadWrite,L.depthRangeFor3D),b=L.useProgram("terrain"),S=c.getTerrainMesh(),M=c.getTerrainData(_.tileID);A.bindFramebuffer.set(null),A.viewport.set([0,0,L.width,L.height]),A.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,c.getRTTFramebuffer().colorAttachment.get());const B=L.transform.calculatePosMatrix(_.tileID.toUnwrapped());b.draw(A,h.TRIANGLES,x,wr.disabled,d,gr.backCCW,{u_matrix:B,u_texture:0},M,"terrain",S.vertexBuffer,S.indexBuffer,S.segments)}function bc(L,c,_,A){const h=L.context,d=_.tileSize*c.qualityFactor;_.textures[A]||(_.textures[A]=L.getTileTexture(d)||new H(h,{width:d,height:d,data:null},h.gl.RGBA),_.textures[A].bind(h.gl.LINEAR,h.gl.CLAMP_TO_EDGE),A===0&&c.sourceCache.renderHistory.unshift(_.tileID.key));const x=c.getRTTFramebuffer();x.colorAttachment.set(_.textures[A].texture),h.bindFramebuffer.set(x.framebuffer),h.viewport.set([0,0,d,d])}class IA{constructor(c){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=c,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=c.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const c=this.painter.style,_=c.terrain;for(const A in c.sourceCaches){this._coordsDescendingInv[A]={};const h=c.sourceCaches[A].getVisibleCoordinates();for(const d of h){const x=_.sourceCache.getTerrainCoords(d);for(const b in x)this._coordsDescendingInv[A][b]||(this._coordsDescendingInv[A][b]=[]),this._coordsDescendingInv[A][b].push(x[b])}}for(const A of c._order){const h=c._layers[A],d=h.source;if(this._renderToTexture[h.type]&&!this._coordsDescendingInvStr[d]){this._coordsDescendingInvStr[d]={};for(const x in this._coordsDescendingInv[d])this._coordsDescendingInvStr[d][x]=this._coordsDescendingInv[d][x].map(b=>b.key).sort().join()}}return this._renderableTiles.forEach(A=>{for(const h in this._coordsDescendingInvStr){const d=this._coordsDescendingInvStr[h][A.tileID.key];d&&d!==A.textureCoords[h]&&A.clearTextures(this.painter),_.needsRerender(h,A.tileID)&&A.clearTextures(this.painter)}this._rerender[A.tileID.key]=!A.textures.length}),_.clearRerenderCache(),_.sourceCache.removeOutdated(this.painter),this}renderLayer(c){const _=c.type,A=this.painter,h=A.style._order,d=A.currentLayer,x=d+1===h.length;if(this._renderToTexture[_]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=_,this._stacks[this._stacks.length-1].push(h[d]),!x))return!0;if(this._renderToTexture[this._prevType]||_==="hillshade"||this._renderToTexture[_]&&x){this._prevType=_;const b=this._stacks.length-1,S=this._stacks[b]||[];for(const M of this._renderableTiles){if(bc(A,A.style.terrain,M,b),this._rerender[M.tileID.key]){A.context.clear({color:o.Color.transparent});for(let B=0;B<S.length;B++){const V=A.style._layers[S[B]],j=V.source?this._coordsDescendingInv[V.source][M.tileID.key]:[M.tileID];A._renderTileClippingMasks(V,j),A.renderLayer(A,A.style.sourceCaches[V.source],V,j),V.source&&(M.textureCoords[V.source]=this._coordsDescendingInvStr[V.source][M.tileID.key])}}$s(A,A.style.terrain,M)}if(_==="hillshade"){this._stacks.push([h[d]]);for(const M of this._renderableTiles){const B=this._coordsDescendingInv[c.source][M.tileID.key];bc(A,A.style.terrain,M,this._stacks.length-1),A.context.clear({color:o.Color.transparent}),A._renderTileClippingMasks(c,B),A.renderLayer(A,A.style.sourceCaches[c.source],c,B),$s(A,A.style.terrain,M)}return!0}return this._renderToTexture[_]}return!1}}const ci={symbol:function(L,c,_,A,h){if(L.renderPass!=="translucent")return;const d=wr.disabled,x=L.colorModeForRenderPass();_.layout.get("text-variable-anchor")&&function(b,S,M,B,V,j,Y){const ae=S.transform,ne=V==="map",ue=j==="map";for(const be of b){const Me=B.getTile(be),ve=Me.getBucket(M);if(!ve||!ve.text||!ve.text.segments.get().length)continue;const $e=o.evaluateSizeForZoom(ve.textSizeData,ae.zoom),Te=Or(Me,1,S.transform.zoom),Ge=Fs(be.posMatrix,ue,ne,S.transform,Te),xe=M.layout.get("icon-text-fit")!=="none"&&ve.hasIconData();if($e){const y=Math.pow(2,ae.zoom-Me.tileID.overscaledZ);xc(ve,ne,ue,Y,ae,Ge,be.posMatrix,y,$e,xe,S.style.terrain?(m,v)=>S.style.terrain.getElevation(be,m,v):null)}}}(A,L,_,c,_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),h),_.paint.get("icon-opacity").constantOr(1)!==0&&Gs(L,c,_,A,!1,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),_.layout.get("icon-rotation-alignment"),_.layout.get("icon-pitch-alignment"),_.layout.get("icon-keep-upright"),d,x),_.paint.get("text-opacity").constantOr(1)!==0&&Gs(L,c,_,A,!0,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),_.layout.get("text-keep-upright"),d,x),c.map.showCollisionBoxes&&(qo(L,c,_,A,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),!0),qo(L,c,_,A,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),!1))},circle:function(L,c,_,A){if(L.renderPass!=="translucent")return;const h=_.paint.get("circle-opacity"),d=_.paint.get("circle-stroke-width"),x=_.paint.get("circle-stroke-opacity"),b=!_.layout.get("circle-sort-key").isConstant();if(h.constantOr(1)===0&&(d.constantOr(1)===0||x.constantOr(1)===0))return;const S=L.context,M=S.gl,B=L.depthModeForSublayer(0,jn.ReadOnly),V=wr.disabled,j=L.colorModeForRenderPass(),Y=[];for(let ae=0;ae<A.length;ae++){const ne=A[ae],ue=c.getTile(ne),be=ue.getBucket(_);if(!be)continue;const Me=be.programConfigurations.get(_.id),ve=L.useProgram("circle",Me),$e=be.layoutVertexBuffer,Te=be.indexBuffer,Ge=L.style.terrain&&L.style.terrain.getTerrainData(ne),xe={programConfiguration:Me,program:ve,layoutVertexBuffer:$e,indexBuffer:Te,uniformValues:da(L,ne,ue,_),terrainData:Ge};if(b){const y=be.segments.get();for(const m of y)Y.push({segments:new o.SegmentVector([m]),sortKey:m.sortKey,state:xe})}else Y.push({segments:be.segments,sortKey:0,state:xe})}b&&Y.sort((ae,ne)=>ae.sortKey-ne.sortKey);for(const ae of Y){const{programConfiguration:ne,program:ue,layoutVertexBuffer:be,indexBuffer:Me,uniformValues:ve,terrainData:$e}=ae.state;ue.draw(S,M.TRIANGLES,B,V,j,gr.disabled,ve,$e,_.id,be,Me,ae.segments,_.paint,L.transform.zoom,ne)}},heatmap:function(L,c,_,A){if(_.paint.get("heatmap-opacity")!==0)if(L.renderPass==="offscreen"){const h=L.context,d=h.gl,x=wr.disabled,b=new fr([d.ONE,d.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(S,M,B){const V=S.gl;S.activeTexture.set(V.TEXTURE1),S.viewport.set([0,0,M.width/4,M.height/4]);let j=B.heatmapFbo;if(j)V.bindTexture(V.TEXTURE_2D,j.colorAttachment.get()),S.bindFramebuffer.set(j.framebuffer);else{const Y=V.createTexture();V.bindTexture(V.TEXTURE_2D,Y),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.LINEAR),j=B.heatmapFbo=S.createFramebuffer(M.width/4,M.height/4,!1),function(ae,ne,ue,be){const Me=ae.gl;Me.texImage2D(Me.TEXTURE_2D,0,Me.RGBA,ne.width/4,ne.height/4,0,Me.RGBA,ae.extRenderToTextureHalfFloat?ae.extTextureHalfFloat.HALF_FLOAT_OES:Me.UNSIGNED_BYTE,null),be.colorAttachment.set(ue)}(S,M,Y,j)}})(h,L,_),h.clear({color:o.Color.transparent});for(let S=0;S<A.length;S++){const M=A[S];if(c.hasRenderableParent(M))continue;const B=c.getTile(M),V=B.getBucket(_);if(!V)continue;const j=V.programConfigurations.get(_.id),Y=L.useProgram("heatmap",j),{zoom:ae}=L.transform;Y.draw(h,d.TRIANGLES,jn.disabled,x,b,gr.disabled,Fe(M.posMatrix,B,ae,_.paint.get("heatmap-intensity")),null,_.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,_.paint,L.transform.zoom,j)}h.viewport.set([0,0,L.width,L.height])}else L.renderPass==="translucent"&&(L.context.setColorMode(L.colorModeForRenderPass()),function(h,d){const x=h.context,b=x.gl,S=d.heatmapFbo;if(!S)return;x.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,S.colorAttachment.get()),x.activeTexture.set(b.TEXTURE1);let M=d.colorRampTexture;M||(M=d.colorRampTexture=new H(x,d.colorRamp,b.RGBA)),M.bind(b.LINEAR,b.CLAMP_TO_EDGE),h.useProgram("heatmapTexture").draw(x,b.TRIANGLES,jn.disabled,wr.disabled,h.colorModeForRenderPass(),gr.disabled,((B,V,j,Y)=>{const ae=o.create();o.ortho(ae,0,B.width,B.height,0,0,1);const ne=B.context.gl;return{u_matrix:ae,u_world:[ne.drawingBufferWidth,ne.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:V.paint.get("heatmap-opacity")}})(h,d),null,d.id,h.viewportBuffer,h.quadTriangleIndexBuffer,h.viewportSegments,d.paint,h.transform.zoom)}(L,_))},line:function(L,c,_,A){if(L.renderPass!=="translucent")return;const h=_.paint.get("line-opacity"),d=_.paint.get("line-width");if(h.constantOr(1)===0||d.constantOr(1)===0)return;const x=L.depthModeForSublayer(0,jn.ReadOnly),b=L.colorModeForRenderPass(),S=_.paint.get("line-dasharray"),M=_.paint.get("line-pattern"),B=M.constantOr(1),V=_.paint.get("line-gradient"),j=_.getCrossfadeParameters(),Y=B?"linePattern":S?"lineSDF":V?"lineGradient":"line",ae=L.context,ne=ae.gl;let ue=!0;for(const be of A){const Me=c.getTile(be);if(B&&!Me.patternsLoaded())continue;const ve=Me.getBucket(_);if(!ve)continue;const $e=ve.programConfigurations.get(_.id),Te=L.context.program.get(),Ge=L.useProgram(Y,$e),xe=ue||Ge.program!==Te,y=L.style.terrain&&L.style.terrain.getTerrainData(be),m=M.constantOr(null);if(m&&Me.imageAtlas){const k=Me.imageAtlas,R=k.patternPositions[m.to.toString()],O=k.patternPositions[m.from.toString()];R&&O&&$e.setConstantPatternPositions(R,O)}const v=y?be:null,E=B?Ln(L,Me,_,j,v):S?Ir(L,Me,_,S,j,v):V?Qt(L,Me,_,ve.lineClipsArray.length,v):bt(L,Me,_,v);if(B)ae.activeTexture.set(ne.TEXTURE0),Me.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),$e.updatePaintBuffers(j);else if(S&&(xe||L.lineAtlas.dirty))ae.activeTexture.set(ne.TEXTURE0),L.lineAtlas.bind(ae);else if(V){const k=ve.gradients[_.id];let R=k.texture;if(_.gradientVersion!==k.version){let O=256;if(_.stepInterpolant){const N=c.getSource().maxzoom,q=be.canonical.z===N?Math.ceil(1<<L.transform.maxZoom-be.canonical.z):1;O=o.clamp(o.nextPowerOfTwo(ve.maxLineLength/o.EXTENT*1024*q),256,ae.maxTextureSize)}k.gradient=o.renderColorRamp({expression:_.gradientExpression(),evaluationKey:"lineProgress",resolution:O,image:k.gradient||void 0,clips:ve.lineClipsArray}),k.texture?k.texture.update(k.gradient):k.texture=new H(ae,k.gradient,ne.RGBA),k.version=_.gradientVersion,R=k.texture}ae.activeTexture.set(ne.TEXTURE0),R.bind(_.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}Ge.draw(ae,ne.TRIANGLES,x,L.stencilModeForClipping(be),b,gr.disabled,E,y,_.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,_.paint,L.transform.zoom,$e,ve.layoutVertexBuffer2),ue=!1}},fill:function(L,c,_,A){const h=_.paint.get("fill-color"),d=_.paint.get("fill-opacity");if(d.constantOr(1)===0)return;const x=L.colorModeForRenderPass(),b=_.paint.get("fill-pattern"),S=L.opaquePassEnabledForLayer()&&!b.constantOr(1)&&h.constantOr(o.Color.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(L.renderPass===S){const M=L.depthModeForSublayer(1,L.renderPass==="opaque"?jn.ReadWrite:jn.ReadOnly);Za(L,c,_,A,M,x,!1)}if(L.renderPass==="translucent"&&_.paint.get("fill-antialias")){const M=L.depthModeForSublayer(_.getPaintProperty("fill-outline-color")?2:0,jn.ReadOnly);Za(L,c,_,A,M,x,!0)}},"fill-extrusion":function(L,c,_,A){const h=_.paint.get("fill-extrusion-opacity");if(h!==0&&L.renderPass==="translucent"){const d=new jn(L.context.gl.LEQUAL,jn.ReadWrite,L.depthRangeFor3D);if(h!==1||_.paint.get("fill-extrusion-pattern").constantOr(1))ya(L,c,_,A,d,wr.disabled,fr.disabled),ya(L,c,_,A,d,L.stencilModeFor3D(),L.colorModeForRenderPass());else{const x=L.colorModeForRenderPass();ya(L,c,_,A,d,wr.disabled,x)}}},hillshade:function(L,c,_,A){if(L.renderPass!=="offscreen"&&L.renderPass!=="translucent")return;const h=L.context,d=L.depthModeForSublayer(0,jn.ReadOnly),x=L.colorModeForRenderPass(),[b,S]=L.renderPass==="translucent"?L.stencilConfigForOverlap(A):[{},A];for(const M of S){const B=c.getTile(M);B.needsHillshadePrepare!==void 0&&B.needsHillshadePrepare&&L.renderPass==="offscreen"?Fl(L,B,_,d,wr.disabled,x):L.renderPass==="translucent"&&Ol(L,M,B,_,d,b[M.overscaledZ],x)}h.viewport.set([0,0,L.width,L.height])},raster:function(L,c,_,A){if(L.renderPass!=="translucent"||_.paint.get("raster-opacity")===0||!A.length)return;const h=L.context,d=h.gl,x=c.getSource(),b=L.useProgram("raster"),S=L.colorModeForRenderPass(),[M,B]=x instanceof Et?[{},A]:L.stencilConfigForOverlap(A),V=B[B.length-1].overscaledZ,j=!L.options.moving;for(const Y of B){const ae=L.depthModeForSublayer(Y.overscaledZ-V,_.paint.get("raster-opacity")===1?jn.ReadWrite:jn.ReadOnly,d.LESS),ne=c.getTile(Y);ne.registerFadeDuration(_.paint.get("raster-fade-duration"));const ue=c.findLoadedParent(Y,0),be=mr(ne,ue,c,_,L.transform,L.style.terrain);let Me,ve;const $e=_.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;h.activeTexture.set(d.TEXTURE0),ne.texture.bind($e,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(d.TEXTURE1),ue?(ue.texture.bind($e,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),Me=Math.pow(2,ue.tileID.overscaledZ-ne.tileID.overscaledZ),ve=[ne.tileID.canonical.x*Me%1,ne.tileID.canonical.y*Me%1]):ne.texture.bind($e,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);const Te=L.style.terrain&&L.style.terrain.getTerrainData(Y),Ge=Te?Y:null,xe=Ge?Ge.posMatrix:L.transform.calculatePosMatrix(Y.toUnwrapped(),j),y=$n(xe,ve||[0,0],Me||1,be,_);x instanceof Et?b.draw(h,d.TRIANGLES,ae,wr.disabled,S,gr.disabled,y,Te,_.id,x.boundsBuffer,L.quadTriangleIndexBuffer,x.boundsSegments):b.draw(h,d.TRIANGLES,ae,M[Y.overscaledZ],S,gr.disabled,y,Te,_.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments)}},background:function(L,c,_,A){const h=_.paint.get("background-color"),d=_.paint.get("background-opacity");if(d===0)return;const x=L.context,b=x.gl,S=L.transform,M=S.tileSize,B=_.paint.get("background-pattern");if(L.isPatternMissing(B))return;const V=!B&&h.a===1&&d===1&&L.opaquePassEnabledForLayer()?"opaque":"translucent";if(L.renderPass!==V)return;const j=wr.disabled,Y=L.depthModeForSublayer(0,V==="opaque"?jn.ReadWrite:jn.ReadOnly),ae=L.colorModeForRenderPass(),ne=L.useProgram(B?"backgroundPattern":"background"),ue=A||S.coveringTiles({tileSize:M,terrain:L.style.terrain});B&&(x.activeTexture.set(b.TEXTURE0),L.imageManager.bind(L.context));const be=_.getCrossfadeParameters();for(const Me of ue){const ve=A?Me.posMatrix:L.transform.calculatePosMatrix(Me.toUnwrapped()),$e=B?TA(ve,d,L,B,{tileID:Me,tileSize:M},be):su(ve,d,h),Te=L.style.terrain&&L.style.terrain.getTerrainData(Me);ne.draw(x,b.TRIANGLES,Y,j,ae,gr.disabled,$e,Te,_.id,L.tileExtentBuffer,L.quadTriangleIndexBuffer,L.tileExtentSegments)}},debug:function(L,c,_){for(let A=0;A<_.length;A++)pu(L,c,_[A])},custom:function(L,c,_){const A=L.context,h=_.implementation;if(L.renderPass==="offscreen"){const d=h.prerender;d&&(L.setCustomLayerDefaults(),A.setColorMode(L.colorModeForRenderPass()),d.call(h,A.gl,L.transform.customLayerMatrix()),A.setDirty(),L.setBaseState())}else if(L.renderPass==="translucent"){L.setCustomLayerDefaults(),A.setColorMode(L.colorModeForRenderPass()),A.setStencilMode(wr.disabled);const d=h.renderingMode==="3d"?new jn(L.context.gl.LEQUAL,jn.ReadWrite,L.depthRangeFor3D):L.depthModeForSublayer(0,jn.ReadOnly);A.setDepthMode(d),h.render(A.gl,L.transform.customLayerMatrix()),A.setDirty(),L.setBaseState(),A.bindFramebuffer.set(null)}}};class bi{constructor(c,_){this.context=new Vs(c),this.transform=_,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.create(),renderTime:0},this.setup(),this.numSublayers=wt.maxUnderzooming+wt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new jt,this.gpuTimers={}}resize(c,_,A){if(this.width=c*A,this.height=_*A,this.pixelRatio=A,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const c=this.context,_=new o.PosArray;_.emplaceBack(0,0),_.emplaceBack(o.EXTENT,0),_.emplaceBack(0,o.EXTENT),_.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(_,pn.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const A=new o.PosArray;A.emplaceBack(0,0),A.emplaceBack(o.EXTENT,0),A.emplaceBack(0,o.EXTENT),A.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=c.createVertexBuffer(A,pn.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const h=new o.RasterBoundsArray;h.emplaceBack(0,0,0,0),h.emplaceBack(o.EXTENT,0,o.EXTENT,0),h.emplaceBack(0,o.EXTENT,0,o.EXTENT),h.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(h,_t.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const d=new o.PosArray;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(d,pn.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const x=new o.LineStripIndexArray;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(x);const b=new o.TriangleIndexArray;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(b),this.emptyTexture=new H(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA);const S=this.context.gl;this.stencilClearMode=new wr({func:S.ALWAYS,mask:0},0,255,S.ZERO,S.ZERO,S.ZERO)}clearStencil(){const c=this.context,_=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const A=o.create();o.ortho(A,0,this.width,this.height,0,0,1),o.scale(A,A,[_.drawingBufferWidth,_.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,_.TRIANGLES,jn.disabled,this.stencilClearMode,fr.disabled,gr.disabled,Ee(A),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(c,_){if(this.currentStencilSource===c.source||!c.isTileClipped()||!_||!_.length)return;this.currentStencilSource=c.source;const A=this.context,h=A.gl;this.nextStencilID+_.length>256&&this.clearStencil(),A.setColorMode(fr.disabled),A.setDepthMode(jn.disabled);const d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of _){const b=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,S=this.style.terrain&&this.style.terrain.getTerrainData(x);d.draw(A,h.TRIANGLES,jn.disabled,new wr({func:h.ALWAYS,mask:0},b,255,h.KEEP,h.KEEP,h.REPLACE),fr.disabled,gr.disabled,Ee(x.posMatrix),S,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,_=this.context.gl;return new wr({func:_.NOTEQUAL,mask:255},c,255,_.KEEP,_.KEEP,_.REPLACE)}stencilModeForClipping(c){const _=this.context.gl;return new wr({func:_.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,_.KEEP,_.KEEP,_.REPLACE)}stencilConfigForOverlap(c){const _=this.context.gl,A=c.sort((x,b)=>b.overscaledZ-x.overscaledZ),h=A[A.length-1].overscaledZ,d=A[0].overscaledZ-h+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const x={};for(let b=0;b<d;b++)x[b+h]=new wr({func:_.GEQUAL,mask:255},b+this.nextStencilID,255,_.KEEP,_.KEEP,_.REPLACE);return this.nextStencilID+=d,[x,A]}return[{[h]:wr.disabled},A]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new fr([c.CONSTANT_COLOR,c.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fr.unblended:fr.alphaBlended}depthModeForSublayer(c,_,A){if(!this.opaquePassEnabledForLayer())return jn.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new jn(A||this.context.gl.LEQUAL,_,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,_){this.style=c,this.options=_,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const A=this.style._order,h=this.style.sourceCaches,d=this.style.terrain&&new IA(this);for(const M in h){const B=h[M];B.used&&B.prepare(this.context)}const x={},b={},S={};for(const M in h){const B=h[M];x[M]=B.getVisibleCoordinates(),b[M]=x[M].slice().reverse(),S[M]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<A.length;M++)if(this.style._layers[A[M]].is3D()){this.opaquePassCutoff=M;break}if(d){this.opaquePassCutoff=0;const M=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!o.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||M.length)&&(o.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,V){const j=B.context,Y=j.gl,ae=fr.unblended,ne=new jn(Y.LEQUAL,jn.ReadWrite,[0,1]),ue=V.getTerrainMesh(),be=V.sourceCache.getRenderableTiles(),Me=B.useProgram("terrainDepth");j.bindFramebuffer.set(V.getFramebuffer("depth").framebuffer),j.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),j.clear({color:o.Color.transparent,depth:1});for(const ve of be){const $e=V.getTerrainData(ve.tileID),Te=B.transform.calculatePosMatrix(ve.tileID.toUnwrapped());Me.draw(j,Y.TRIANGLES,ne,wr.disabled,ae,gr.backCCW,{u_matrix:Te},$e,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments)}j.bindFramebuffer.set(null),j.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain),function(B,V){const j=B.context,Y=j.gl,ae=fr.unblended,ne=new jn(Y.LEQUAL,jn.ReadWrite,[0,1]),ue=V.getTerrainMesh(),be=V.getCoordsTexture(),Me=V.sourceCache.getRenderableTiles(),ve=B.useProgram("terrainCoords");j.bindFramebuffer.set(V.getFramebuffer("coords").framebuffer),j.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),j.clear({color:o.Color.transparent,depth:1}),V.coordsIndex=[];for(const $e of Me){const Te=V.getTerrainData($e.tileID);j.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,be.texture);const Ge=B.transform.calculatePosMatrix($e.tileID.toUnwrapped());ve.draw(j,Y.TRIANGLES,ne,wr.disabled,ae,gr.backCCW,{u_matrix:Ge,u_terrain_coords_id:(255-V.coordsIndex.length)/255,u_texture:0},Te,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments),V.coordsIndex.push($e.tileID.key)}j.bindFramebuffer.set(null),j.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const M of A){const B=this.style._layers[M];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const V=b[B.source];(B.type==="custom"||V.length)&&this.renderLayer(this,h[B.source],B,V)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:_.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=_.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],!d)for(this.renderPass="opaque",this.currentLayer=A.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[A[this.currentLayer]],B=h[M.source],V=x[M.source];this._renderTileClippingMasks(M,V),this.renderLayer(this,B,M,V)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<A.length;this.currentLayer++){const M=this.style._layers[A[this.currentLayer]],B=h[M.source];if(d&&d.renderLayer(M))continue;const V=(M.type==="symbol"?S:b)[M.source];this._renderTileClippingMasks(M,x[M.source]),this.renderLayer(this,B,M,V)}if(this.options.showTileBoundaries){let M,B;Object.values(this.style._layers).forEach(V=>{V.source&&!V.isHidden(this.transform.zoom)&&(V.source!==(B&&B.id)&&(B=this.style.sourceCaches[V.source]),(!M||M.getSource().maxzoom<B.getSource().maxzoom)&&(M=B))}),M&&ci.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const B=M.transform.padding;Zr(M,M.transform.height-(B.top||0),3,kA),Zr(M,B.bottom||0,3,As),Rr(M,B.left||0,3,du),Rr(M,M.transform.width-(B.right||0),3,Nl);const V=M.transform.centerPoint;(function(j,Y,ae,ne){ii(j,Y-1,ae-10,2,20,ne),ii(j,Y-10,ae-1,20,2,ne)})(M,V.x,M.transform.height-V.y,wc)}(this),this.context.setDefault()}renderLayer(c,_,A,h){A.isHidden(this.transform.zoom)||(A.type==="background"||A.type==="custom"||(h||[]).length)&&(this.id=A.id,this.gpuTimingStart(A),ci[A.type](c,_,A,h,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const _=this.context.extTimerQuery;let A=this.gpuTimers[c.id];A||(A=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:_.createQueryEXT()}),A.calls++,_.beginQueryEXT(_.TIME_ELAPSED_EXT,A.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}queryGpuTimers(c){const _={};for(const A in c){const h=c[A],d=this.context.extTimerQuery,x=d.getQueryObjectEXT(h.query,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(h.query),_[A]=x}return _}translatePosMatrix(c,_,A,h,d){if(!A[0]&&!A[1])return c;const x=d?h==="map"?this.transform.angle:0:h==="viewport"?-this.transform.angle:0;if(x){const M=Math.sin(x),B=Math.cos(x);A=[A[0]*B-A[1]*M,A[0]*M+A[1]*B]}const b=[d?A[0]:Or(_,A[0],this.transform.zoom),d?A[1]:Or(_,A[1],this.transform.zoom),0],S=new Float32Array(16);return o.translate(S,c,b),S}saveTileTexture(c){const _=this._tileTextures[c.size[0]];_?_.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const _=this._tileTextures[c];return _&&_.length>0?_.pop():null}isPatternMissing(c){if(!c)return!1;if(!c.from||!c.to)return!0;const _=this.imageManager.getPattern(c.from.toString()),A=this.imageManager.getPattern(c.to.toString());return!_||!A}useProgram(c,_){this.cache=this.cache||{};const A=c+(_?_.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[A]||(this.cache[A]=new $a(this.context,c,ui[c],_,Pl[c],this._showOverdrawInspector,this.style.terrain)),this.cache[A]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new H(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class us{constructor(c,_){this.points=c,this.planes=_}static fromInvProjectionMatrix(c,_,A){const h=Math.pow(2,A),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const S=1/(b=o.transformMat4([],b,c))[3]/_*h;return o.mul$1(b,b,[S,S,1/b[3],S])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const S=o.sub([],d[b[0]],d[b[1]]),M=o.sub([],d[b[2]],d[b[1]]),B=o.normalize([],o.cross([],S,M)),V=-o.dot(B,d[b[1]]);return B.concat(V)});return new us(d,x)}}class _a{constructor(c,_){this.min=c,this.max=_,this.center=o.scale$1([],o.add([],this.min,this.max),.5)}quadrant(c){const _=[c%2==0,c<2],A=o.clone$2(this.min),h=o.clone$2(this.max);for(let d=0;d<_.length;d++)A[d]=_[d]?this.min[d]:this.center[d],h[d]=_[d]?this.center[d]:this.max[d];return h[2]=this.max[2],new _a(A,h)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}intersects(c){const _=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let A=!0;for(let h=0;h<c.planes.length;h++){const d=c.planes[h];let x=0;for(let b=0;b<_.length;b++)o.dot$1(d,_[b])>=0&&x++;if(x===0)return 0;x!==_.length&&(A=!1)}if(A)return 2;for(let h=0;h<3;h++){let d=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let b=0;b<c.points.length;b++){const S=c.points[b][h]-this.min[h];d=Math.min(d,S),x=Math.max(x,S)}if(x<0||d>this.max[h]-this.min[h])return 0}return 1}}class Xi{constructor(c=0,_=0,A=0,h=0){if(isNaN(c)||c<0||isNaN(_)||_<0||isNaN(A)||A<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=_,this.left=A,this.right=h}interpolate(c,_,A){return _.top!=null&&c.top!=null&&(this.top=o.number(c.top,_.top,A)),_.bottom!=null&&c.bottom!=null&&(this.bottom=o.number(c.bottom,_.bottom,A)),_.left!=null&&c.left!=null&&(this.left=o.number(c.left,_.left,A)),_.right!=null&&c.right!=null&&(this.right=o.number(c.right,_.right,A)),this}getCenter(c,_){const A=o.clamp((this.left+c-this.right)/2,0,c),h=o.clamp((this.top+_-this.bottom)/2,0,_);return new o.pointGeometry(A,h)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Xi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class wo{constructor(c,_,A,h,d){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=d===void 0||!!d,this._minZoom=c||0,this._maxZoom=_||22,this._minPitch=A??0,this._maxPitch=h??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Xi,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const c=new wo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c._center=this._center,c._elevation=this._elevation,c.zoom=this.zoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(c){const _=-o.wrap(c,-180,180)*Math.PI/180;var A;this.angle!==_&&(this._unmodified=!1,this.angle=_,this._calcMatrices(),this.rotationMatrix=(A=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(A[1]=0,A[2]=0),A[0]=1,A[3]=1,A),function(h,d,x){var b=d[0],S=d[1],M=d[2],B=d[3],V=Math.sin(x),j=Math.cos(x);h[0]=b*j+M*V,h[1]=S*j+B*V,h[2]=b*-V+M*j,h[3]=S*-V+B*j}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const _=o.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==_&&(this._unmodified=!1,this._pitch=_,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(c){const _=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==_&&(this._unmodified=!1,this._zoom=_,this.scale=this.zoomScale(_),this.tileZoom=Math.floor(_),this.zoomFraction=_-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(c){c!==this._elevation&&(this._elevation=c,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,_,A){this._unmodified=!1,this._edgeInsets.interpolate(c,_,A),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const _=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,_)}getVisibleUnwrappedCoordinates(c){const _=[new o.UnwrappedTileID(0,c)];if(this._renderWorldCopies){const A=this.pointCoordinate(new o.pointGeometry(0,0)),h=this.pointCoordinate(new o.pointGeometry(this.width,0)),d=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),x=this.pointCoordinate(new o.pointGeometry(0,this.height)),b=Math.floor(Math.min(A.x,h.x,d.x,x.x)),S=Math.floor(Math.max(A.x,h.x,d.x,x.x)),M=1;for(let B=b-M;B<=S+M;B++)B!==0&&_.push(new o.UnwrappedTileID(B,c))}return _}coveringTiles(c){var _,A;let h=this.coveringZoomLevel(c);const d=h;if(c.minzoom!==void 0&&h<c.minzoom)return[];c.maxzoom!==void 0&&h>c.maxzoom&&(h=c.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),b=o.MercatorCoordinate.fromLngLat(this.center),S=Math.pow(2,h),M=[S*x.x,S*x.y,0],B=[S*b.x,S*b.y,0],V=us.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h);let j=c.minzoom||0;!c.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(j=h);const Y=c.terrain?2/Math.min(this.tileSize,c.tileSize)*this.tileSize:3,ae=ve=>({aabb:new _a([ve*S,0,0],[(ve+1)*S,S,0]),zoom:0,x:0,y:0,wrap:ve,fullyVisible:!1}),ne=[],ue=[],be=h,Me=c.reparseOverscaled?d:h;if(this._renderWorldCopies)for(let ve=1;ve<=3;ve++)ne.push(ae(-ve)),ne.push(ae(ve));for(ne.push(ae(0));ne.length>0;){const ve=ne.pop(),$e=ve.x,Te=ve.y;let Ge=ve.fullyVisible;if(!Ge){const k=ve.aabb.intersects(V);if(k===0)continue;Ge=k===2}const xe=c.terrain?M:B,y=ve.aabb.distanceX(xe),m=ve.aabb.distanceY(xe),v=Math.max(Math.abs(y),Math.abs(m)),E=Y+(1<<be-ve.zoom)-2;if(ve.zoom===be||v>E&&ve.zoom>=j){const k=be-ve.zoom,R=M[0]-.5-($e<<k),O=M[1]-.5-(Te<<k);ue.push({tileID:new o.OverscaledTileID(ve.zoom===be?Me:ve.zoom,ve.wrap,ve.zoom,$e,Te),distanceSq:o.sqrLen([B[0]-.5-$e,B[1]-.5-Te]),tileDistanceToCamera:Math.sqrt(R*R+O*O)})}else for(let k=0;k<4;k++){const R=($e<<1)+k%2,O=(Te<<1)+(k>>1),N=ve.zoom+1;let q=ve.aabb.quadrant(k);if(c.terrain){const J=new o.OverscaledTileID(N,ve.wrap,N,R,O),le=c.terrain.getMinMaxElevation(J),de=(_=le.minElevation)!==null&&_!==void 0?_:this.elevation,Re=(A=le.maxElevation)!==null&&A!==void 0?A:this.elevation;q=new _a([q.min[0],q.min[1],de],[q.max[0],q.max[1],Re])}ne.push({aabb:q,zoom:N,x:R,y:O,wrap:ve.wrap,fullyVisible:Ge})}}return ue.sort((ve,$e)=>ve.distanceSq-$e.distanceSq).map(ve=>ve.tileID)}resize(c,_){this.width=c,this.height=_,this.pixelsToGLUnits=[2/c,-2/_],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const _=o.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.pointGeometry(o.mercatorXfromLng(c.lng)*this.worldSize,o.mercatorYfromLat(_)*this.worldSize)}unproject(c){return new o.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(c){this.freezeElevation||(this.elevation=c?this.getElevation(this._center,c):0)}getElevation(c,_){const A=o.MercatorCoordinate.fromLngLat(c),h=(1<<this.tileZoom)*o.EXTENT,d=A.x*h,x=A.y*h,b=Math.floor(d/o.EXTENT),S=Math.floor(x/o.EXTENT),M=new o.OverscaledTileID(this.tileZoom,0,this.tileZoom,b,S);return _.getElevation(M,d%o.EXTENT,x%o.EXTENT,o.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(c){const _=this.pointLocation(this.centerPoint,c),A=this.getElevation(_,c);if(!(this.elevation-A))return;const h=this.getCameraPosition(),d=o.MercatorCoordinate.fromLngLat(h.lngLat,h.altitude),x=o.MercatorCoordinate.fromLngLat(_,A),b=d.x-x.x,S=d.y-x.y,M=d.z-x.z,B=Math.sqrt(b*b+S*S+M*M),V=this.scaleZoom(this.cameraToCenterDistance/B/this.tileSize);this._elevation=A,this._center=_,this.zoom=V}setLocationAtPoint(c,_){const A=this.pointCoordinate(_),h=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(c),x=new o.MercatorCoordinate(d.x-(A.x-h.x),d.y-(A.y-h.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(c,_){return _?this.coordinatePoint(this.locationCoordinate(c),this.getElevation(c,_),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(c))}pointLocation(c,_){return this.coordinateLocation(this.pointCoordinate(c,_))}locationCoordinate(c){return o.MercatorCoordinate.fromLngLat(c)}coordinateLocation(c){return c&&c.toLngLat()}pointCoordinate(c,_){if(_){const j=_.pointCoordinate(c);if(j!=null)return j}const A=[c.x,c.y,0,1],h=[c.x,c.y,1,1];o.transformMat4(A,A,this.pixelMatrixInverse),o.transformMat4(h,h,this.pixelMatrixInverse);const d=A[3],x=h[3],b=A[1]/d,S=h[1]/x,M=A[2]/d,B=h[2]/x,V=M===B?0:(0-M)/(B-M);return new o.MercatorCoordinate(o.number(A[0]/d,h[0]/x,V)/this.worldSize,o.number(b,S,V)/this.worldSize)}coordinatePoint(c,_=0,A=this.pixelMatrix){const h=[c.x*this.worldSize,c.y*this.worldSize,_,1];return o.transformMat4(h,h,A),new o.pointGeometry(h[0]/h[3],h[1]/h[3])}getBounds(){const c=Math.max(0,this.height/2-this.getHorizon());return new o.LngLatBounds().extend(this.pointLocation(new o.pointGeometry(0,c))).extend(this.pointLocation(new o.pointGeometry(this.width,c))).extend(this.pointLocation(new o.pointGeometry(this.width,this.height))).extend(this.pointLocation(new o.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(c,_=!1){const A=c.key,h=_?this._alignedPosMatrixCache:this._posMatrixCache;if(h[A])return h[A];const d=c.canonical,x=this.worldSize/this.zoomScale(d.z),b=d.x+Math.pow(2,d.z)*c.wrap,S=o.identity(new Float64Array(16));return o.translate(S,S,[b*x,d.y*x,0]),o.scale(S,S,[x/o.EXTENT,x/o.EXTENT,1]),o.multiply(S,_?this.alignedProjMatrix:this.projMatrix,S),h[A]=new Float32Array(S),h[A]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let c,_,A,h,d=-90,x=90,b=-180,S=180;const M=this.size,B=this._unmodified;if(this.latRange){const Y=this.latRange;d=o.mercatorYfromLat(Y[1])*this.worldSize,x=o.mercatorYfromLat(Y[0])*this.worldSize,c=x-d<M.y?M.y/(x-d):0}if(this.lngRange){const Y=this.lngRange;b=o.wrap(o.mercatorXfromLng(Y[0])*this.worldSize,0,this.worldSize),S=o.wrap(o.mercatorXfromLng(Y[1])*this.worldSize,0,this.worldSize),S<b&&(S+=this.worldSize),_=S-b<M.x?M.x/(S-b):0}const V=this.point,j=Math.max(_||0,c||0);if(j)return this.center=this.unproject(new o.pointGeometry(_?(S+b)/2:V.x,c?(x+d)/2:V.y)),this.zoom+=this.scaleZoom(j),this._unmodified=B,void(this._constraining=!1);if(this.latRange){const Y=V.y,ae=M.y/2;Y-ae<d&&(h=d+ae),Y+ae>x&&(h=x-ae)}if(this.lngRange){const Y=(b+S)/2,ae=o.wrap(V.x,Y-this.worldSize/2,Y+this.worldSize/2),ne=M.x/2;ae-ne<b&&(A=b+ne),ae+ne>S&&(A=S-ne)}A===void 0&&h===void 0||(this.center=this.unproject(new o.pointGeometry(A!==void 0?A:V.x,h!==void 0?h:V.y)).wrap()),this._unmodified=B,this._constraining=!1}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,_=this.point.x,A=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let h=o.identity(new Float64Array(16));o.scale(h,h,[this.width/2,-this.height/2,1]),o.translate(h,h,[1,-1,0]),this.labelPlaneMatrix=h,h=o.identity(new Float64Array(16)),o.scale(h,h,[1,-1,1]),o.translate(h,h,[-1,-1,0]),o.scale(h,h,[2/this.width,2/this.height,1]),this.glCoordMatrix=h,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const d=Math.PI/2+this._pitch,x=this._fov*(.5+c.y/this.height),b=Math.sin(x)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-d-x,.01,Math.PI-.01)),S=this.getHorizon(),M=2*Math.atan(S/this.cameraToCenterDistance)*(.5+c.y/(2*S)),B=Math.sin(M)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-d-M,.01,Math.PI-.01)),V=Math.cos(Math.PI/2-this._pitch)*b+this.cameraToSeaLevelDistance,j=Math.cos(Math.PI/2-this._pitch)*B+this.cameraToSeaLevelDistance,Y=1.01*Math.min(V,j),ae=this.height/50;h=new Float64Array(16),o.perspective(h,this._fov,this.width/this.height,ae,Y),h[8]=2*-c.x/this.width,h[9]=2*c.y/this.height,o.scale(h,h,[1,-1,1]),o.translate(h,h,[0,0,-this.cameraToCenterDistance]),o.rotateX(h,h,this._pitch),o.rotateZ(h,h,this.angle),o.translate(h,h,[-_,-A,0]),this.mercatorMatrix=o.scale([],h,[this.worldSize,this.worldSize,this.worldSize]),o.scale(h,h,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,h),o.translate(h,h,[0,0,-this.elevation]),this.projMatrix=h,this.invProjMatrix=o.invert([],h),this.pixelMatrix3D=o.multiply(new Float64Array(16),this.labelPlaneMatrix,h);const ne=this.width%2/2,ue=this.height%2/2,be=Math.cos(this.angle),Me=Math.sin(this.angle),ve=_-Math.round(_)+be*ne+Me*ue,$e=A-Math.round(A)+be*ue+Me*ne,Te=new Float64Array(h);if(o.translate(Te,Te,[ve>.5?ve-1:ve,$e>.5?$e-1:$e,0]),this.alignedProjMatrix=Te,h=o.invert(new Float64Array(16),this.pixelMatrix),!h)throw new Error("failed to invert matrix");this.pixelMatrixInverse=h,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const c=this.pointCoordinate(new o.pointGeometry(0,0)),_=[c.x*this.worldSize,c.y*this.worldSize,0,1];return o.transformMat4(_,_,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,c))}getCameraQueryGeometry(c){const _=this.getCameraPoint();if(c.length===1)return[c[0],_];{let A=_.x,h=_.y,d=_.x,x=_.y;for(const b of c)A=Math.min(A,b.x),h=Math.min(h,b.y),d=Math.max(d,b.x),x=Math.max(x,b.y);return[new o.pointGeometry(A,h),new o.pointGeometry(d,h),new o.pointGeometry(d,x),new o.pointGeometry(A,x),new o.pointGeometry(A,h)]}}}class pi{constructor(c){this._hashName=c&&encodeURIComponent(c),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(_,A){let h=!1,d=null;const x=()=>{d=null,h&&(_(),d=setTimeout(x,300),h=!1)};return()=>(h=!0,d||x(),d)}(this._updateHashUnthrottled.bind(this))}addTo(c){return this._map=c,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(c){const _=this._map.getCenter(),A=Math.round(100*this._map.getZoom())/100,h=Math.ceil((A*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,h),x=Math.round(_.lng*d)/d,b=Math.round(_.lat*d)/d,S=this._map.getBearing(),M=this._map.getPitch();let B="";if(B+=c?`/${x}/${b}/${A}`:`${A}/${b}/${x}`,(S||M)&&(B+="/"+Math.round(10*S)/10),M&&(B+=`/${Math.round(M)}`),this._hashName){const V=this._hashName;let j=!1;const Y=window.location.hash.slice(1).split("&").map(ae=>{const ne=ae.split("=")[0];return ne===V?(j=!0,`${ne}=${B}`):ae}).filter(ae=>ae);return j||Y.push(`${V}=${B}`),`#${Y.join("&")}`}return`#${B}`}_getCurrentHash(){const c=window.location.hash.replace("#","");if(this._hashName){let _;return c.split("&").map(A=>A.split("=")).forEach(A=>{A[0]===this._hashName&&(_=A)}),(_&&_[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._getCurrentHash();if(c.length>=3&&!c.some(_=>isNaN(_))){const _=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:_,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,c)}catch{}}}const Ya={linearity:.3,easing:o.bezier(0,0,.3,1)},Ul=o.extend({deceleration:2500,maxSpeed:1400},Ya),Xa=o.extend({deceleration:20,maxSpeed:1400},Ya),js=o.extend({deceleration:1e3,maxSpeed:360},Ya),cs=o.extend({deceleration:1e3,maxSpeed:90},Ya);class Ec{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,_=o.exported.now();for(;c.length>0&&_-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const _={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)_.zoom+=d.zoomDelta||0,_.bearing+=d.bearingDelta||0,_.pitch+=d.pitchDelta||0,d.panDelta&&_.pan._add(d.panDelta),d.around&&(_.around=d.around),d.pinchAround&&(_.pinchAround=d.pinchAround);const A=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(_.pan.mag()){const d=Ka(_.pan.mag(),A,o.extend({},Ul,c||{}));h.offset=_.pan.mult(d.amount/_.pan.mag()),h.center=this._map.transform.center,va(h,d)}if(_.zoom){const d=Ka(_.zoom,A,Xa);h.zoom=this._map.transform.zoom+d.amount,va(h,d)}if(_.bearing){const d=Ka(_.bearing,A,js);h.bearing=this._map.transform.bearing+o.clamp(d.amount,-179,179),va(h,d)}if(_.pitch){const d=Ka(_.pitch,A,cs);h.pitch=this._map.transform.pitch+d.amount,va(h,d)}if(h.zoom||h.bearing){const d=_.pinchAround===void 0?_.around:_.pinchAround;h.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),o.extend(h,{noMoveStart:!0})}}function va(L,c){(!L.duration||L.duration<c.duration)&&(L.duration=c.duration,L.easing=c.easing)}function Ka(L,c,_){const{maxSpeed:A,linearity:h,deceleration:d}=_,x=o.clamp(L*h/(c/1e3),-A,A),b=Math.abs(x)/(d*h);return{easing:_.easing,duration:1e3*b,amount:x*(b/2)}}class si extends o.Event{constructor(c,_,A,h={}){const d=I.mousePos(_.getCanvasContainer(),A),x=_.unproject(d);super(c,o.extend({point:d,lngLat:x,originalEvent:A},h)),this._defaultPrevented=!1,this.target=_}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Ss extends o.Event{constructor(c,_,A){const h=c==="touchend"?A.changedTouches:A.touches,d=I.touchPos(_.getCanvasContainer(),h),x=d.map(S=>_.unproject(S)),b=d.reduce((S,M,B,V)=>S.add(M.div(V.length)),new o.pointGeometry(0,0));super(c,{points:d,point:b,lngLats:x,lngLat:_.unproject(b),originalEvent:A}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Ki extends o.Event{constructor(c,_,A){super(c,{originalEvent:A}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Vl{constructor(c,_){this._map=c,this._clickTolerance=_.clickTolerance}reset(){delete this._mousedownPos}wheel(c){return this._firePreventable(new Ki(c.type,this._map,c))}mousedown(c,_){return this._mousedownPos=_,this._firePreventable(new si(c.type,this._map,c))}mouseup(c){this._map.fire(new si(c.type,this._map,c))}click(c,_){this._mousedownPos&&this._mousedownPos.dist(_)>=this._clickTolerance||this._map.fire(new si(c.type,this._map,c))}dblclick(c){return this._firePreventable(new si(c.type,this._map,c))}mouseover(c){this._map.fire(new si(c.type,this._map,c))}mouseout(c){this._map.fire(new si(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Ss(c.type,this._map,c))}touchmove(c){this._map.fire(new Ss(c.type,this._map,c))}touchend(c){this._map.fire(new Ss(c.type,this._map,c))}touchcancel(c){this._map.fire(new Ss(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zo{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(c){this._map.fire(new si(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new si("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._ignoreContextMenu||this._map.fire(new si(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Tc{constructor(c,_){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=_.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,_){this.isEnabled()&&c.shiftKey&&c.button===0&&(I.disableDrag(),this._startPos=this._lastPos=_,this._active=!0)}mousemoveWindow(c,_){if(!this._active)return;const A=_;if(this._lastPos.equals(A)||!this._box&&A.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=A,this._box||(this._box=I.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const d=Math.min(h.x,A.x),x=Math.max(h.x,A.x),b=Math.min(h.y,A.y),S=Math.max(h.y,A.y);I.setTransform(this._box,`translate(${d}px,${b}px)`),this._box.style.width=x-d+"px",this._box.style.height=S-b+"px"}mouseupWindow(c,_){if(!this._active||c.button!==0)return;const A=this._startPos,h=_;if(this.reset(),I.suppressClick(),A.x!==h.x||A.y!==h.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:d=>d.fitScreenCoordinates(A,h,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",c)}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(I.remove(this._box),this._box=null),I.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(c,_){return this._map.fire(new o.Event(c,{originalEvent:_}))}}function bo(L,c){if(L.length!==c.length)throw new Error(`The number of touches and points are not equal - touches ${L.length}, points ${c.length}`);const _={};for(let A=0;A<L.length;A++)_[L[A].identifier]=c[A];return _}class Gl{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(c,_,A){(this.centroid||A.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),A.length===this.numTouches&&(this.centroid=function(h){const d=new o.pointGeometry(0,0);for(const x of h)d._add(x);return d.div(h.length)}(_),this.touches=bo(A,_)))}touchmove(c,_,A){if(this.aborted||!this.centroid)return;const h=bo(A,_);for(const d in this.touches){const x=this.touches[d],b=h[d];(!b||b.dist(x)>30)&&(this.aborted=!0)}}touchend(c,_,A){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),A.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class Ja{constructor(c){this.singleTap=new Gl(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(c,_,A){this.singleTap.touchstart(c,_,A)}touchmove(c,_,A){this.singleTap.touchmove(c,_,A)}touchend(c,_,A){const h=this.singleTap.touchend(c,_,A);if(h){const d=c.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(h)<30;if(d&&x||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class Ch{constructor(){this._zoomIn=new Ja({numTouches:1,numTaps:2}),this._zoomOut=new Ja({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,_,A){this._zoomIn.touchstart(c,_,A),this._zoomOut.touchstart(c,_,A)}touchmove(c,_,A){this._zoomIn.touchmove(c,_,A),this._zoomOut.touchmove(c,_,A)}touchend(c,_,A){const h=this._zoomIn.touchend(c,_,A),d=this._zoomOut.touchend(c,_,A);return h?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()+1,around:x.unproject(h)},{originalEvent:c})}):d?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()-1,around:x.unproject(d)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Mh={0:1,2:2};class el{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(c,_){return!1}_move(c,_){return{}}mousedown(c,_){if(this._lastPoint)return;const A=I.mouseButton(c);this._correctButton(c,A)&&(this._lastPoint=_,this._eventButton=A)}mousemoveWindow(c,_){const A=this._lastPoint;if(A){if(c.preventDefault(),function(h,d){const x=Mh[d];return h.buttons===void 0||(h.buttons&x)!==x}(c,this._eventButton))this.reset();else if(this._moved||!(_.dist(A)<this._clickTolerance))return this._moved=!0,this._lastPoint=_,this._move(A,_)}}mouseupWindow(c){this._lastPoint&&I.mouseButton(c)===this._eventButton&&(this._moved&&I.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xa extends el{mousedown(c,_){super.mousedown(c,_),this._lastPoint&&(this._active=!0)}_correctButton(c,_){return _===0&&!c.ctrlKey}_move(c,_){return{around:_,panDelta:_.sub(c)}}}class hs extends el{_correctButton(c,_){return _===0&&c.ctrlKey||_===2}_move(c,_){const A=.8*(_.x-c.x);if(A)return this._active=!0,{bearingDelta:A}}contextmenu(c){c.preventDefault()}}class Nt extends el{_correctButton(c,_){return _===0&&c.ctrlKey||_===2}_move(c,_){const A=-.5*(_.y-c.y);if(A)return this._active=!0,{pitchDelta:A}}contextmenu(c){c.preventDefault()}}class gu{constructor(c,_){this._minTouches=c.cooperativeGestures?2:1,this._clickTolerance=c.clickTolerance||1,this._map=_,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(c,_,A){return this._calculateTransform(c,_,A)}touchmove(c,_,A){if(this._map._cooperativeGestures&&(this._minTouches===2&&A.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(c,!1,A.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(A.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,_,A)}touchend(c,_,A){this._calculateTransform(c,_,A),this._active&&A.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,_,A){A.length>0&&(this._active=!0);const h=bo(A,_),d=new o.pointGeometry(0,0),x=new o.pointGeometry(0,0);let b=0;for(const M in h){const B=h[M],V=this._touches[M];V&&(d._add(B),x._add(B.sub(V)),b++,h[M]=B)}if(this._touches=h,b<this._minTouches||!x.mag())return;const S=x.div(b);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(b),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wa{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(c){}_move(c,_,A){return{}}touchstart(c,_,A){this._firstTwoTouches||A.length<2||(this._firstTwoTouches=[A[0].identifier,A[1].identifier],this._start([_[0],_[1]]))}touchmove(c,_,A){if(!this._firstTwoTouches)return;c.preventDefault();const[h,d]=this._firstTwoTouches,x=Yo(A,_,h),b=Yo(A,_,d);if(!x||!b)return;const S=this._aroundCenter?null:x.add(b).div(2);return this._move([x,b],S,c)}touchend(c,_,A){if(!this._firstTwoTouches)return;const[h,d]=this._firstTwoTouches,x=Yo(A,_,h),b=Yo(A,_,d);x&&b||(this._active&&I.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Yo(L,c,_){for(let A=0;A<L.length;A++)if(L[A].identifier===_)return c[A]}function mu(L,c){return Math.log(L/c)/Math.LN2}class Vt extends wa{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,_){const A=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(mu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:mu(this._distance,A),pinchAround:_}}}function LA(L,c){return 180*L.angleWith(c)/Math.PI}class $l extends wa{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,_){const A=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:LA(this._vector,A),pinchAround:_}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const _=25/(Math.PI*this._minDiameter)*360,A=LA(c,this._startVector);return Math.abs(A)<_}}function DA(L){return Math.abs(L.y)>Math.abs(L.x)}class tl extends wa{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(c,_,A){super.touchstart(c,_,A),this._currentTouchCount=A.length}_start(c){this._lastPoints=c,DA(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,_,A){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const h=c[0].sub(this._lastPoints[0]),d=c[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,d,A.timeStamp),this._valid?(this._lastPoints=c,this._active=!0,{pitchDelta:(h.y+d.y)/2*-.5}):void 0}gestureBeginsVertically(c,_,A){if(this._valid!==void 0)return this._valid;const h=c.mag()>=2,d=_.mag()>=2;if(!h&&!d)return;if(!h||!d)return this._firstMove===void 0&&(this._firstMove=A),A-this._firstMove<100&&void 0;const x=c.y>0==_.y>0;return DA(c)&&DA(_)&&x}}const Hs={panStep:100,bearingStep:15,pitchStep:10};class yu{constructor(){const c=Hs;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let _=0,A=0,h=0,d=0,x=0;switch(c.keyCode){case 61:case 107:case 171:case 187:_=1;break;case 189:case 109:case 173:_=-1;break;case 37:c.shiftKey?A=-1:(c.preventDefault(),d=-1);break;case 39:c.shiftKey?A=1:(c.preventDefault(),d=1);break;case 38:c.shiftKey?h=1:(c.preventDefault(),x=-1);break;case 40:c.shiftKey?h=-1:(c.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(A=0,h=0),{cameraAnimation:b=>{const S=b.getZoom();b.easeTo({duration:300,easeId:"keyboardHandler",easing:Ph,zoom:_?Math.round(S)+_*(c.shiftKey?2:1):S,bearing:b.getBearing()+A*this._bearingStep,pitch:b.getPitch()+h*this._pitchStep,offset:[-d*this._panStep,-x*this._panStep],center:b.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ph(L){return L*(2-L)}const Sc=4.000244140625;class _u{constructor(c,_){this._map=c,this._el=c.getCanvasContainer(),this._handler=_,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&c.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;c.preventDefault()}let _=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const A=o.exported.now(),h=A-(this._lastWheelEventTime||0);this._lastWheelEventTime=A,_!==0&&_%Sc==0?this._type="wheel":_!==0&&Math.abs(_)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=_,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(h*_)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,_+=this._lastValue)),c.shiftKey&&_&&(_/=4),this._type&&(this._lastWheelEvent=c,this._delta-=_,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const _=I.mousePos(this._el,c);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(_)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>Sc?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&S!==0&&(S=1/S);const M=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(M*S))),this._type==="wheel"&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const _=typeof this._targetZoom=="number"?this._targetZoom:c.zoom,A=this._startZoom,h=this._easing;let d,x=!1;if(this._type==="wheel"&&A&&h){const b=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),S=h(b);d=o.number(A,_,S),b<1?this._frameId||(this._frameId=!0):x=!0}else d=_,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:d-c.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let _=o.ease;if(this._prevEase){const A=this._prevEase,h=(o.exported.now()-A.start)/A.duration,d=A.easing(h+.01)-A.easing(h),x=.27/Math.sqrt(d*d+1e-4)*.01,b=Math.sqrt(.0729-x*x);_=o.bezier(x,b,.25,1)}return this._prevEase={start:o.exported.now(),duration:c,easing:_},_}reset(){this._active=!1}}class vu{constructor(c,_){this._clickZoom=c,this._tapZoom=_}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class xu{constructor(){this.reset()}reset(){this._active=!1}dblclick(c,_){return c.preventDefault(),{cameraAnimation:A=>{A.easeTo({duration:300,zoom:A.getZoom()+(c.shiftKey?-1:1),around:A.unproject(_)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ws{constructor(){this._tap=new Ja({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(c,_,A){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?A.length>0&&(this._swipePoint=_[0],this._swipeTouch=A[0].identifier):this._tap.touchstart(c,_,A))}touchmove(c,_,A){if(this._tapTime){if(this._swipePoint){if(A[0].identifier!==this._swipeTouch)return;const h=_[0],d=h.y-this._swipePoint.y;return this._swipePoint=h,c.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(c,_,A)}touchend(c,_,A){this._tapTime?this._swipePoint&&A.length===0&&this.reset():this._tap.touchend(c,_,A)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ri{constructor(c,_,A){this._el=c,this._mousePan=_,this._touchPan=A}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Eo{constructor(c,_,A){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=_,this._mousePitch=A}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class wu{constructor(c,_,A,h){this._el=c,this._touchZoom=_,this._touchRotate=A,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ba=L=>L.zoom||L.drag||L.pitch||L.rotate;class Nr extends o.Event{}function jl(L){return L.panDelta&&L.panDelta.mag()||L.zoomDelta||L.bearingDelta||L.pitchDelta}class Cc{constructor(c,_){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ec(c),this._bearingSnap=_.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(_),o.bindAll(["handleEvent","handleWindowEvent"],this);const A=this._el;this._listeners=[[A,"touchstart",{passive:!0}],[A,"touchmove",{passive:!1}],[A,"touchend",void 0],[A,"touchcancel",void 0],[A,"mousedown",void 0],[A,"mousemove",void 0],[A,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[A,"mouseover",void 0],[A,"mouseout",void 0],[A,"dblclick",void 0],[A,"click",void 0],[A,"keydown",{capture:!1}],[A,"keyup",void 0],[A,"wheel",{passive:!1}],[A,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,d,x]of this._listeners)I.addEventListener(h,d,h===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[c,_,A]of this._listeners)I.removeEventListener(c,_,c===document?this.handleWindowEvent:this.handleEvent,A)}_addDefaultHandlers(c){const _=this._map,A=_.getCanvasContainer();this._add("mapEvent",new Vl(_,c));const h=_.boxZoom=new Tc(_,c);this._add("boxZoom",h);const d=new Ch,x=new xu;_.doubleClickZoom=new vu(x,d),this._add("tapZoom",d),this._add("clickZoom",x);const b=new Ws;this._add("tapDragZoom",b);const S=_.touchPitch=new tl(_);this._add("touchPitch",S);const M=new hs(c),B=new Nt(c);_.dragRotate=new Eo(c,M,B),this._add("mouseRotate",M,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]);const V=new xa(c),j=new gu(c,_);_.dragPan=new Ri(A,V,j),this._add("mousePan",V),this._add("touchPan",j,["touchZoom","touchRotate"]);const Y=new $l,ae=new Vt;_.touchZoomRotate=new wu(A,ae,Y,b),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",ae,["touchPan","touchRotate"]);const ne=_.scrollZoom=new _u(_,this);this._add("scrollZoom",ne,["mousePan"]);const ue=_.keyboard=new yu;this._add("keyboard",ue),this._add("blockableMapEvent",new Zo(_));for(const be of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[be]&&_[be].enable(c[be])}_add(c,_,A){this._handlers.push({handlerName:c,handler:_,allowed:A}),this._handlersById[c]=_}stop(c){if(!this._updatingCamera){for(const{handler:_}of this._handlers)_.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ba(this._eventsInProgress)||this.isZooming()}_blockedByActive(c,_,A){for(const h in c)if(h!==A&&(!_||_.indexOf(h)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const _=[];for(const A of c)this._el.contains(A.target)&&_.push(A);return _}handleEvent(c,_){if(c.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const A=c.type==="renderFrame"?void 0:c,h={needsRenderFrame:!1},d={},x={},b=c.touches,S=b?this._getMapTouches(b):void 0,M=S?I.touchPos(this._el,S):I.mousePos(this._el,c);for(const{handlerName:j,handler:Y,allowed:ae}of this._handlers){if(!Y.isEnabled())continue;let ne;this._blockedByActive(x,ae,j)?Y.reset():Y[_||c.type]&&(ne=Y[_||c.type](c,M,S),this.mergeHandlerResult(h,d,ne,j,A),ne&&ne.needsRenderFrame&&this._triggerRenderFrame()),(ne||Y.isActive())&&(x[j]=Y)}const B={};for(const j in this._previousActiveHandlers)x[j]||(B[j]=A);this._previousActiveHandlers=x,(Object.keys(B).length||jl(h))&&(this._changes.push([h,d,B]),this._triggerRenderFrame()),(Object.keys(x).length||jl(h))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=h;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))}mergeHandlerResult(c,_,A,h,d){if(!A)return;o.extend(c,A);const x={handlerName:h,originalEvent:A.originalEvent||d};A.zoomDelta!==void 0&&(_.zoom=x),A.panDelta!==void 0&&(_.drag=x),A.pitchDelta!==void 0&&(_.pitch=x),A.bearingDelta!==void 0&&(_.rotate=x)}_applyChanges(){const c={},_={},A={};for(const[h,d,x]of this._changes)h.panDelta&&(c.panDelta=(c.panDelta||new o.pointGeometry(0,0))._add(h.panDelta)),h.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+h.pitchDelta),h.around!==void 0&&(c.around=h.around),h.pinchAround!==void 0&&(c.pinchAround=h.pinchAround),h.noInertia&&(c.noInertia=h.noInertia),o.extend(_,d),o.extend(A,x);this._updateMapTransform(c,_,A),this._changes=[]}_updateMapTransform(c,_,A){const h=this._map,d=h.transform,x=h.style&&h.style.terrain;if(!(jl(c)||x&&this._drag))return this._fireEvents(_,A,!0);let{panDelta:b,zoomDelta:S,bearingDelta:M,pitchDelta:B,around:V,pinchAround:j}=c;j!==void 0&&(V=j),h._stop(!0),V=V||h.transform.centerPoint;const Y=d.pointLocation(b?V.sub(b):V);M&&(d.bearing+=M),B&&(d.pitch+=B),S&&(d.zoom+=S),x?_.drag&&!this._drag?(this._drag={center:d.centerPoint,lngLat:d.pointLocation(V),point:V,handlerName:_.drag.handlerName},h.fire(new o.Event("freezeElevation",{freeze:!0}))):this._drag&&A[this._drag.handlerName]?(h.fire(new o.Event("freezeElevation",{freeze:!1})),this._drag=null):_.drag&&this._drag&&(d.center=d.pointLocation(d.centerPoint.sub(b))):d.setLocationAtPoint(Y,V),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(_,A,!0)}_fireEvents(c,_,A){const h=ba(this._eventsInProgress),d=ba(c),x={};for(const B in c){const{originalEvent:V}=c[B];this._eventsInProgress[B]||(x[`${B}start`]=V),this._eventsInProgress[B]=c[B]}!h&&d&&this._fireEvent("movestart",d.originalEvent);for(const B in x)this._fireEvent(B,x[B]);d&&this._fireEvent("move",d.originalEvent);for(const B in c){const{originalEvent:V}=c[B];this._fireEvent(B,V)}const b={};let S;for(const B in this._eventsInProgress){const{handlerName:V,originalEvent:j}=this._eventsInProgress[B];this._handlersById[V].isActive()||(delete this._eventsInProgress[B],S=_[V]||j,b[`${B}end`]=S)}for(const B in b)this._fireEvent(B,b[B]);const M=ba(this._eventsInProgress);if(A&&(h||d)&&!M){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=j=>j!==0&&-this._bearingSnap<j&&j<this._bearingSnap;B?(V(B.bearing||this._map.getBearing())&&(B.bearing=0),this._map.easeTo(B,{originalEvent:S})):(this._map.fire(new o.Event("moveend",{originalEvent:S})),V(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,_){this._map.fire(new o.Event(c,_?{originalEvent:_}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{delete this._frameId,this.handleEvent(new Nr("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const fs={extend:(L,...c)=>o.extend(L,...c),run(L){L()},logToElement(L,c=!1,_="log"){const A=window.document.getElementById(_);A&&(c&&(A.innerHTML=""),A.innerHTML+=`<br>${L}`)}};class Sr extends o.Evented{constructor(c,_){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=_.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,_){return this.jumpTo({center:c},_)}panBy(c,_,A){return c=o.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,o.extend({offset:c},_),A)}panTo(c,_,A){return this.easeTo(o.extend({center:c},_),A)}getZoom(){return this.transform.zoom}setZoom(c,_){return this.jumpTo({zoom:c},_),this}zoomTo(c,_,A){return this.easeTo(o.extend({zoom:c},_),A)}zoomIn(c,_){return this.zoomTo(this.getZoom()+1,c,_),this}zoomOut(c,_){return this.zoomTo(this.getZoom()-1,c,_),this}getBearing(){return this.transform.bearing}setBearing(c,_){return this.jumpTo({bearing:c},_),this}getPadding(){return this.transform.padding}setPadding(c,_){return this.jumpTo({padding:c},_),this}rotateTo(c,_,A){return this.easeTo(o.extend({bearing:c},_),A)}resetNorth(c,_){return this.rotateTo(0,o.extend({duration:1e3},c),_),this}resetNorthPitch(c,_){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},c),_),this}snapToNorth(c,_){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,_):this}getPitch(){return this.transform.pitch}setPitch(c,_){return this.jumpTo({pitch:c},_),this}cameraForBounds(c,_){c=o.LngLatBounds.convert(c);const A=_&&_.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),A,_)}_cameraForBoxAndBearing(c,_,A,h){const d={top:0,bottom:0,right:0,left:0};if(typeof(h=o.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const Te=h.padding;h.padding={top:Te,bottom:Te,right:Te,left:Te}}h.padding=o.extend(d,h.padding);const x=this.transform,b=x.padding,S=x.project(o.LngLat.convert(c)),M=x.project(o.LngLat.convert(_)),B=S.rotate(-A*Math.PI/180),V=M.rotate(-A*Math.PI/180),j=new o.pointGeometry(Math.max(B.x,V.x),Math.max(B.y,V.y)),Y=new o.pointGeometry(Math.min(B.x,V.x),Math.min(B.y,V.y)),ae=j.sub(Y),ne=(x.width-(b.left+b.right+h.padding.left+h.padding.right))/ae.x,ue=(x.height-(b.top+b.bottom+h.padding.top+h.padding.bottom))/ae.y;if(ue<0||ne<0)return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const be=Math.min(x.scaleZoom(x.scale*Math.min(ne,ue)),h.maxZoom),Me=o.pointGeometry.convert(h.offset),ve=new o.pointGeometry((h.padding.left-h.padding.right)/2,(h.padding.top-h.padding.bottom)/2).rotate(A*Math.PI/180),$e=Me.add(ve).mult(x.scale/x.zoomScale(be));return{center:x.unproject(S.add(M).div(2).sub($e)),zoom:be,bearing:A}}fitBounds(c,_,A){return this._fitInternal(this.cameraForBounds(c,_),_,A)}fitScreenCoordinates(c,_,A,h,d){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.pointGeometry.convert(c)),this.transform.pointLocation(o.pointGeometry.convert(_)),A,h),h,d)}_fitInternal(c,_,A){return c?(delete(_=o.extend(c,_)).padding,_.linear?this.easeTo(_,A):this.flyTo(_,A)):this}jumpTo(c,_){this.stop();const A=this.transform;let h=!1,d=!1,x=!1;return"zoom"in c&&A.zoom!==+c.zoom&&(h=!0,A.zoom=+c.zoom),c.center!==void 0&&(A.center=o.LngLat.convert(c.center)),"bearing"in c&&A.bearing!==+c.bearing&&(d=!0,A.bearing=+c.bearing),"pitch"in c&&A.pitch!==+c.pitch&&(x=!0,A.pitch=+c.pitch),c.padding==null||A.isPaddingEqual(c.padding)||(A.padding=c.padding),this.fire(new o.Event("movestart",_)).fire(new o.Event("move",_)),h&&this.fire(new o.Event("zoomstart",_)).fire(new o.Event("zoom",_)).fire(new o.Event("zoomend",_)),d&&this.fire(new o.Event("rotatestart",_)).fire(new o.Event("rotate",_)).fire(new o.Event("rotateend",_)),x&&this.fire(new o.Event("pitchstart",_)).fire(new o.Event("pitch",_)).fire(new o.Event("pitchend",_)),this.fire(new o.Event("moveend",_))}calculateCameraOptionsFromTo(c,_,A,h=0){const d=o.MercatorCoordinate.fromLngLat(c,_),x=o.MercatorCoordinate.fromLngLat(A,h),b=x.x-d.x,S=x.y-d.y,M=x.z-d.z,B=Math.hypot(b,S,M);if(B===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(b,S),j=this.transform.scaleZoom(this.transform.cameraToCenterDistance/B/this.transform.tileSize),Y=180*Math.atan2(b,-S)/Math.PI;let ae=180*Math.acos(V/B)/Math.PI;return ae=M<0?90-ae:90+ae,{center:x.toLngLat(),zoom:j,pitch:ae,bearing:Y}}easeTo(c,_){this._stop(!1,c.easeId),((c=o.extend({offset:[0,0],duration:500,easing:o.ease},c)).animate===!1||!c.essential&&o.exported.prefersReducedMotion)&&(c.duration=0);const A=this.transform,h=this.getZoom(),d=this.getBearing(),x=this.getPitch(),b=this.getPadding(),S="zoom"in c?+c.zoom:h,M="bearing"in c?this._normalizeBearing(c.bearing,d):d,B="pitch"in c?+c.pitch:x,V="padding"in c?c.padding:A.padding,j=o.pointGeometry.convert(c.offset);let Y=A.centerPoint.add(j);const ae=A.pointLocation(Y),ne=o.LngLat.convert(c.center||ae);this._normalizeCenter(ne);const ue=A.project(ae),be=A.project(ne).sub(ue),Me=A.zoomScale(S-h);let ve,$e;c.around&&(ve=o.LngLat.convert(c.around),$e=A.locationPoint(ve));const Te={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||S!==h,this._rotating=this._rotating||d!==M,this._pitching=this._pitching||B!==x,this._padding=!A.isPaddingEqual(V),this._easeId=c.easeId,this._prepareEase(_,c.noMoveStart,Te),this._ease(Ge=>{if(this._zooming&&(A.zoom=o.number(h,S,Ge)),this._rotating&&(A.bearing=o.number(d,M,Ge)),this._pitching&&(A.pitch=o.number(x,B,Ge)),this._padding&&(A.interpolatePadding(b,V,Ge),Y=A.centerPoint.add(j)),ve)A.setLocationAtPoint(ve,$e);else{const xe=A.zoomScale(A.zoom-h),y=S>h?Math.min(2,Me):Math.max(.5,Me),m=Math.pow(y,1-Ge),v=A.unproject(ue.add(be.mult(Ge*m)).mult(xe));A.setLocationAtPoint(A.renderWorldCopies?v.wrap():v,Y)}this._fireMoveEvents(_)},Ge=>{this._afterEase(_,Ge)},c),this}_prepareEase(c,_,A={}){this._moving=!0,this.fire(new o.Event("freezeElevation",{freeze:!0})),_||A.moving||this.fire(new o.Event("movestart",c)),this._zooming&&!A.zooming&&this.fire(new o.Event("zoomstart",c)),this._rotating&&!A.rotating&&this.fire(new o.Event("rotatestart",c)),this._pitching&&!A.pitching&&this.fire(new o.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new o.Event("move",c)),this._zooming&&this.fire(new o.Event("zoom",c)),this._rotating&&this.fire(new o.Event("rotate",c)),this._pitching&&this.fire(new o.Event("pitch",c))}_afterEase(c,_){if(this._easeId&&_&&this._easeId===_)return;delete this._easeId,this.fire(new o.Event("freezeElevation",{freeze:!1}));const A=this._zooming,h=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,A&&this.fire(new o.Event("zoomend",c)),h&&this.fire(new o.Event("rotateend",c)),d&&this.fire(new o.Event("pitchend",c)),this.fire(new o.Event("moveend",c))}flyTo(c,_){if(!c.essential&&o.exported.prefersReducedMotion){const N=o.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(N,_)}this.stop(),c=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},c);const A=this.transform,h=this.getZoom(),d=this.getBearing(),x=this.getPitch(),b=this.getPadding(),S="zoom"in c?o.clamp(+c.zoom,A.minZoom,A.maxZoom):h,M="bearing"in c?this._normalizeBearing(c.bearing,d):d,B="pitch"in c?+c.pitch:x,V="padding"in c?c.padding:A.padding,j=A.zoomScale(S-h),Y=o.pointGeometry.convert(c.offset);let ae=A.centerPoint.add(Y);const ne=A.pointLocation(ae),ue=o.LngLat.convert(c.center||ne);this._normalizeCenter(ue);const be=A.project(ne),Me=A.project(ue).sub(be);let ve=c.curve;const $e=Math.max(A.width,A.height),Te=$e/j,Ge=Me.mag();if("minZoom"in c){const N=o.clamp(Math.min(c.minZoom,h,S),A.minZoom,A.maxZoom),q=$e/A.zoomScale(N-h);ve=Math.sqrt(q/Ge*2)}const xe=ve*ve;function y(N){const q=(Te*Te-$e*$e+(N?-1:1)*xe*xe*Ge*Ge)/(2*(N?Te:$e)*xe*Ge);return Math.log(Math.sqrt(q*q+1)-q)}function m(N){return(Math.exp(N)-Math.exp(-N))/2}function v(N){return(Math.exp(N)+Math.exp(-N))/2}const E=y(0);let k=function(N){return v(E)/v(E+ve*N)},R=function(N){return $e*((v(E)*(m(q=E+ve*N)/v(q))-m(E))/xe)/Ge;var q},O=(y(1)-E)/ve;if(Math.abs(Ge)<1e-6||!isFinite(O)){if(Math.abs($e-Te)<1e-6)return this.easeTo(c,_);const N=Te<$e?-1:1;O=Math.abs(Math.log(Te/$e))/ve,R=function(){return 0},k=function(q){return Math.exp(N*ve*q)}}return c.duration="duration"in c?+c.duration:1e3*O/("screenSpeed"in c?+c.screenSpeed/ve:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=d!==M,this._pitching=B!==x,this._padding=!A.isPaddingEqual(V),this._prepareEase(_,!1),this._ease(N=>{const q=N*O,J=1/k(q);A.zoom=N===1?S:h+A.scaleZoom(J),this._rotating&&(A.bearing=o.number(d,M,N)),this._pitching&&(A.pitch=o.number(x,B,N)),this._padding&&(A.interpolatePadding(b,V,N),ae=A.centerPoint.add(Y));const le=N===1?ue:A.unproject(be.add(Me.mult(R(q))).mult(J));A.setLocationAtPoint(A.renderWorldCopies?le.wrap():le,ae),this._fireMoveEvents(_)},()=>this._afterEase(_),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,_){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const A=this._onEaseEnd;delete this._onEaseEnd,A.call(this,_)}if(!c){const A=this.handlers;A&&A.stop(!1)}return this}_ease(c,_,A){A.animate===!1||A.duration===0?(c(1),_()):(this._easeStart=o.exported.now(),this._easeOptions=A,this._onEaseFrame=c,this._onEaseEnd=_,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,_){c=o.wrap(c,-180,180);const A=Math.abs(c-_);return Math.abs(c-360-_)<A&&(c-=360),Math.abs(c+360-_)<A&&(c+=360),c}_normalizeCenter(c){const _=this.transform;if(!_.renderWorldCopies||_.lngRange)return;const A=c.lng-_.center.lng;c.lng+=A>180?-360:A<-180?360:0}}class nl{constructor(c={}){this.options=c,o.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){return this._map=c,this._compact=this.options&&this.options.compact,this._container=I.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=I.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=I.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){I.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(c,_){const A=this._map._getUIString(`AttributionControl.${_}`);c.title=A,c.setAttribute("aria-label",A)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const _=this._map.style.sourceCaches;for(const h in _){const d=_[h];if(d.used||d.usedForTerrain){const x=d.getSource();x.attribution&&c.indexOf(x.attribution)<0&&c.push(x.attribution)}}c=c.filter(h=>String(h).trim()),c.sort((h,d)=>h.length-d.length),c=c.filter((h,d)=>{for(let x=d+1;x<c.length;x++)if(c[x].indexOf(h)>=0)return!1;return!0});const A=c.join(" | ");A!==this._attribHTML&&(this._attribHTML=A,c.length?(this._innerContainer.innerHTML=A,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Hl{constructor(c={}){this.options=c,o.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(c){this._map=c,this._compact=this.options&&this.options.compact,this._container=I.create("div","maplibregl-ctrl mapboxgl-ctrl");const _=I.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return _.target="_blank",_.rel="noopener nofollow",_.href="https://maplibre.org/",_.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),_.setAttribute("rel","noopener nofollow"),this._container.appendChild(_),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){I.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const c=this._container.children;if(c.length){const _=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&_.classList.add("maplibregl-compact","mapboxgl-compact"):_.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class bu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const _=++this._id;return this._queue.push({callback:c,id:_,cancelled:!1}),_}remove(c){const _=this._currentlyRunning,A=_?this._queue.concat(_):this._queue;for(const h of A)if(h.id===c)return void(h.cancelled=!0)}run(c=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const _=this._currentlyRunning=this._queue;this._queue=[];for(const A of _)if(!A.cancelled&&(A.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Mc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},Eu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Pc={showCompass:!0,showZoom:!0,visualizePitch:!1};class yr{constructor(c,_,A=!1){this._clickTolerance=10,this.element=_,this.mouseRotate=new hs({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,A&&(this.mousePitch=new Nt({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),I.addEventListener(_,"mousedown",this.mousedown),I.addEventListener(_,"touchstart",this.touchstart,{passive:!1}),I.addEventListener(_,"touchmove",this.touchmove),I.addEventListener(_,"touchend",this.touchend),I.addEventListener(_,"touchcancel",this.reset)}down(c,_){this.mouseRotate.mousedown(c,_),this.mousePitch&&this.mousePitch.mousedown(c,_),I.disableDrag()}move(c,_){const A=this.map,h=this.mouseRotate.mousemoveWindow(c,_);if(h&&h.bearingDelta&&A.setBearing(A.getBearing()+h.bearingDelta),this.mousePitch){const d=this.mousePitch.mousemoveWindow(c,_);d&&d.pitchDelta&&A.setPitch(A.getPitch()+d.pitchDelta)}}off(){const c=this.element;I.removeEventListener(c,"mousedown",this.mousedown),I.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),I.removeEventListener(c,"touchmove",this.touchmove),I.removeEventListener(c,"touchend",this.touchend),I.removeEventListener(c,"touchcancel",this.reset),this.offTemp()}offTemp(){I.enableDrag(),I.removeEventListener(window,"mousemove",this.mousemove),I.removeEventListener(window,"mouseup",this.mouseup)}mousedown(c){this.down(o.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),I.mousePos(this.element,c)),I.addEventListener(window,"mousemove",this.mousemove),I.addEventListener(window,"mouseup",this.mouseup)}mousemove(c){this.move(c,I.mousePos(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=I.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){c.targetTouches.length!==1?this.reset():(this._lastPos=I.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Wl(L,c,_){if(L=new o.LngLat(L.lng,L.lat),c){const A=new o.LngLat(L.lng-360,L.lat),h=new o.LngLat(L.lng+360,L.lat),d=_.locationPoint(L).distSqr(c);_.locationPoint(A).distSqr(c)<d?L=A:_.locationPoint(h).distSqr(c)<d&&(L=h)}for(;Math.abs(L.lng-_.center.lng)>180;){const A=_.locationPoint(L);if(A.x>=0&&A.y>=0&&A.x<=_.width&&A.y<=_.height)break;L.lng>_.center.lng?L.lng-=360:L.lng+=360}return L}const Yt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Xt(L,c,_){const A=L.classList;for(const h in Yt)A.remove(`maplibregl-${_}-anchor-${h}`,`mapboxgl-${_}-anchor-${h}`);A.add(`maplibregl-${_}-anchor-${c}`,`mapboxgl-${_}-anchor-${c}`)}class hn extends o.Evented{constructor(c,_){if(super(),(c instanceof HTMLElement||_)&&(c=o.extend({element:c},_)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment!=="auto"?c.pitchAlignment:this._rotationAlignment,c&&c.element)this._element=c.element,this._offset=o.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=I.create("div"),this._element.setAttribute("aria-label","Map marker");const A=I.createNS("http://www.w3.org/2000/svg","svg"),h=41,d=27;A.setAttributeNS(null,"display","block"),A.setAttributeNS(null,"height",`${h}px`),A.setAttributeNS(null,"width",`${d}px`),A.setAttributeNS(null,"viewBox",`0 0 ${d} ${h}`);const x=I.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const b=I.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const S=I.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Me of M){const ve=I.createNS("http://www.w3.org/2000/svg","ellipse");ve.setAttributeNS(null,"opacity","0.04"),ve.setAttributeNS(null,"cx","10.5"),ve.setAttributeNS(null,"cy","5.80029008"),ve.setAttributeNS(null,"rx",Me.rx),ve.setAttributeNS(null,"ry",Me.ry),S.appendChild(ve)}const B=I.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const V=I.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(V);const j=I.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"fill","#000000");const Y=I.createNS("http://www.w3.org/2000/svg","path");Y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),j.appendChild(Y);const ae=I.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ae.setAttributeNS(null,"fill","#FFFFFF");const ne=I.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ue=I.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#000000"),ue.setAttributeNS(null,"opacity","0.25"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962");const be=I.createNS("http://www.w3.org/2000/svg","circle");be.setAttributeNS(null,"fill","#FFFFFF"),be.setAttributeNS(null,"cx","5.5"),be.setAttributeNS(null,"cy","5.5"),be.setAttributeNS(null,"r","5.4999962"),ne.appendChild(ue),ne.appendChild(be),b.appendChild(S),b.appendChild(B),b.appendChild(j),b.appendChild(ae),b.appendChild(ne),A.appendChild(b),A.setAttributeNS(null,"height",h*this._scale+"px"),A.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(A),this._offset=o.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",A=>{A.preventDefault()}),this._element.addEventListener("mousedown",A=>{A.preventDefault()}),Xt(this._element,this._anchor,"marker"),this._popup=null}addTo(c){return this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),I.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=o.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const h=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(c){const _=c.code,A=c.charCode||c.keyCode;_!=="Space"&&_!=="Enter"&&A!==32&&A!==13||this.togglePopup()}_onMapClick(c){const _=c.originalEvent.target,A=this._element;this._popup&&(_===A||A.contains(_))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?c.remove():c.addTo(this._map),this):this}_update(c){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Wl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let A="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?A="rotateX(0deg)":this._pitchAlignment==="map"&&(A=`rotateX(${this._map.getPitch()}deg)`),c&&c.type!=="moveend"||(this._pos=this._pos.round()),I.setTransform(this._element,`${Yt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${A} ${_}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const h=this._map.unproject(this._pos),d=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=h.distanceTo(this._lngLat)>20*d?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(c){return this._offset=o.pointGeometry.convert(c),this._update(),this}_onMove(c){if(!this._isDragging){const _=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=_}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(c){this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c&&c!=="auto"?c:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Ji={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Xo,$r=0,Qs=!1;const Cs={maxWidth:100,unit:"metric"};function qs(L,c,_){const A=_&&_.maxWidth||100,h=L._container.clientHeight/2,d=L.unproject([0,h]),x=L.unproject([A,h]),b=d.distanceTo(x);if(_&&_.unit==="imperial"){const S=3.2808*b;S>5280?Ct(c,A,S/5280,L._getUIString("ScaleControl.Miles")):Ct(c,A,S,L._getUIString("ScaleControl.Feet"))}else _&&_.unit==="nautical"?Ct(c,A,b/1852,L._getUIString("ScaleControl.NauticalMiles")):b>=1e3?Ct(c,A,b/1e3,L._getUIString("ScaleControl.Kilometers")):Ct(c,A,b,L._getUIString("ScaleControl.Meters"))}function Ct(L,c,_,A){const h=function(d){const x=Math.pow(10,`${Math.floor(d)}`.length-1);let b=d/x;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(S){const M=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*M)/M}(b),x*b}(_);L.style.width=c*(h/_)+"px",L.innerHTML=`${h}&nbsp;${A}`}const Pt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},jr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function rl(L){if(L){if(typeof L=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(L,2)));return{center:new o.pointGeometry(0,0),top:new o.pointGeometry(0,L),"top-left":new o.pointGeometry(c,c),"top-right":new o.pointGeometry(-c,c),bottom:new o.pointGeometry(0,-L),"bottom-left":new o.pointGeometry(c,-c),"bottom-right":new o.pointGeometry(-c,-c),left:new o.pointGeometry(L,0),right:new o.pointGeometry(-L,0)}}if(L instanceof o.pointGeometry||Array.isArray(L)){const c=o.pointGeometry.convert(L);return{center:c,top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}return{center:o.pointGeometry.convert(L.center||[0,0]),top:o.pointGeometry.convert(L.top||[0,0]),"top-left":o.pointGeometry.convert(L["top-left"]||[0,0]),"top-right":o.pointGeometry.convert(L["top-right"]||[0,0]),bottom:o.pointGeometry.convert(L.bottom||[0,0]),"bottom-left":o.pointGeometry.convert(L["bottom-left"]||[0,0]),"bottom-right":o.pointGeometry.convert(L["bottom-right"]||[0,0]),left:o.pointGeometry.convert(L.left||[0,0]),right:o.pointGeometry.convert(L.right||[0,0])}}return rl(new o.pointGeometry(0,0))}const Zs={supported:p,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends Sr{constructor(L){var c;if(o.PerformanceUtils.mark(o.PerformanceMarkers.create),(L=o.extend({},Eu,L)).minZoom!=null&&L.maxZoom!=null&&L.minZoom>L.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(L.minPitch!=null&&L.maxPitch!=null&&L.minPitch>L.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(L.minPitch!=null&&L.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(L.maxPitch!=null&&L.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new wo(L.minZoom,L.maxZoom,L.minPitch,L.maxPitch,L.renderWorldCopies),{bearingSnap:L.bearingSnap}),this._interactive=L.interactive,this._cooperativeGestures=L.cooperativeGestures,this._maxTileCacheSize=L.maxTileCacheSize,this._failIfMajorPerformanceCaveat=L.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=L.preserveDrawingBuffer,this._antialias=L.antialias,this._trackResize=L.trackResize,this._bearingSnap=L.bearingSnap,this._refreshExpiredTiles=L.refreshExpiredTiles,this._fadeDuration=L.fadeDuration,this._crossSourceCollisions=L.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=L.collectResourceTiming,this._renderTaskQueue=new bu,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},Mc,L.locale),this._clickTolerance=L.clickTolerance,this._pixelRatio=(c=L.pixelRatio)!==null&&c!==void 0?c:devicePixelRatio,this._requestManager=new U(L.transformRequest),typeof L.container=="string"){if(this._container=document.getElementById(L.container),!this._container)throw new Error(`Container '${L.container}' not found.`)}else{if(!(L.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=L.container}if(L.maxBounds&&this.setMaxBounds(L.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Cc(this,L),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=L.hash&&new pi(typeof L.hash=="string"&&L.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:L.center,zoom:L.zoom,bearing:L.bearing,pitch:L.pitch}),L.bounds&&(this.resize(),this.fitBounds(L.bounds,o.extend({},L.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=L.localIdeographFontFamily,L.style&&this.setStyle(L.style,{localIdeographFontFamily:L.localIdeographFontFamily}),L.attributionControl&&this.addControl(new nl({customAttribution:L.customAttribution})),L.maplibreLogo&&this.addControl(new Hl,L.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",_=>{this._update(_.dataType==="style"),this.fire(new o.Event(`${_.dataType}data`,_))}),this.on("dataloading",_=>{this.fire(new o.Event(`${_.dataType}dataloading`,_))}),this.on("dataabort",_=>{this.fire(new o.Event("sourcedataabort",_))})}_getMapId(){return this._mapId}addControl(L,c){if(c===void 0&&(c=L.getDefaultPosition?L.getDefaultPosition():"top-right"),!L||!L.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const _=L.onAdd(this);this._controls.push(L);const A=this._controlPositions[c];return c.indexOf("bottom")!==-1?A.insertBefore(_,A.firstChild):A.appendChild(_),this}removeControl(L){if(!L||!L.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(L);return c>-1&&this._controls.splice(c,1),L.onRemove(this),this}hasControl(L){return this._controls.indexOf(L)>-1}calculateCameraOptionsFromTo(L,c,_,A){return A==null&&this.style.terrain&&(A=this.transform.getElevation(_,this.style.terrain)),super.calculateCameraOptionsFromTo(L,c,_,A)}resize(L){const c=this._containerDimensions(),_=c[0],A=c[1];this._resizeCanvas(_,A,this.getPixelRatio()),this.transform.resize(_,A),this.painter.resize(_,A,this.getPixelRatio());const h=!this._moving;return h&&(this.stop(),this.fire(new o.Event("movestart",L)).fire(new o.Event("move",L))),this.fire(new o.Event("resize",L)),h&&this.fire(new o.Event("moveend",L)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(L){const[c,_]=this._containerDimensions();this._pixelRatio=L,this._resizeCanvas(c,_,L),this.painter.resize(c,_,L)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(L){return this.transform.setMaxBounds(o.LngLatBounds.convert(L)),this._update()}setMinZoom(L){if((L=L??-2)>=-2&&L<=this.transform.maxZoom)return this.transform.minZoom=L,this._update(),this.getZoom()<L&&this.setZoom(L),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(L){if((L=L??22)>=this.transform.minZoom)return this.transform.maxZoom=L,this._update(),this.getZoom()>L&&this.setZoom(L),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(L){if((L=L??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(L>=0&&L<=this.transform.maxPitch)return this.transform.minPitch=L,this._update(),this.getPitch()<L&&this.setPitch(L),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(L){if((L=L??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(L>=this.transform.minPitch)return this.transform.maxPitch=L,this._update(),this.getPitch()>L&&this.setPitch(L),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(L){return this.transform.renderWorldCopies=L,this._update()}project(L){return this.transform.locationPoint(o.LngLat.convert(L),this.style&&this.style.terrain)}unproject(L){return this.transform.pointLocation(o.pointGeometry.convert(L),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(L,c,_){if(L==="mouseenter"||L==="mouseover"){let A=!1;return{layer:c,listener:_,delegates:{mousemove:d=>{const x=this.getLayer(c)?this.queryRenderedFeatures(d.point,{layers:[c]}):[];x.length?A||(A=!0,_.call(this,new si(L,this,d.originalEvent,{features:x}))):A=!1},mouseout:()=>{A=!1}}}}if(L==="mouseleave"||L==="mouseout"){let A=!1;return{layer:c,listener:_,delegates:{mousemove:x=>{(this.getLayer(c)?this.queryRenderedFeatures(x.point,{layers:[c]}):[]).length?A=!0:A&&(A=!1,_.call(this,new si(L,this,x.originalEvent)))},mouseout:x=>{A&&(A=!1,_.call(this,new si(L,this,x.originalEvent)))}}}}{const A=h=>{const d=this.getLayer(c)?this.queryRenderedFeatures(h.point,{layers:[c]}):[];d.length&&(h.features=d,_.call(this,h),delete h.features)};return{layer:c,listener:_,delegates:{[L]:A}}}}on(L,c,_){if(_===void 0)return super.on(L,c);const A=this._createDelegatedListener(L,c,_);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[L]=this._delegatedListeners[L]||[],this._delegatedListeners[L].push(A);for(const h in A.delegates)this.on(h,A.delegates[h]);return this}once(L,c,_){if(_===void 0)return super.once(L,c);const A=this._createDelegatedListener(L,c,_);for(const h in A.delegates)this.once(h,A.delegates[h]);return this}off(L,c,_){return _===void 0?super.off(L,c):(this._delegatedListeners&&this._delegatedListeners[L]&&(A=>{const h=this._delegatedListeners[L];for(let d=0;d<h.length;d++){const x=h[d];if(x.layer===c&&x.listener===_){for(const b in x.delegates)this.off(b,x.delegates[b]);return h.splice(d,1),this}}})(),this)}queryRenderedFeatures(L,c){if(!this.style)return[];let _;if(c!==void 0||L===void 0||L instanceof o.pointGeometry||Array.isArray(L)||(c=L,L=void 0),c=c||{},(L=L||[[0,0],[this.transform.width,this.transform.height]])instanceof o.pointGeometry||typeof L[0]=="number")_=[o.pointGeometry.convert(L)];else{const A=o.pointGeometry.convert(L[0]),h=o.pointGeometry.convert(L[1]);_=[A,new o.pointGeometry(h.x,A.y),h,new o.pointGeometry(A.x,h.y),A]}return this.style.queryRenderedFeatures(_,c,this.transform)}querySourceFeatures(L,c){return this.style.querySourceFeatures(L,c)}setStyle(L,c){return(c=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&L?(this._diffStyle(L,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._updateStyle(L,c))}setTransformRequest(L){return this._requestManager.setTransformRequest(L),this}_getUIString(L){const c=this._locale[L];if(c==null)throw new Error(`Missing UI string '${L}'`);return c}_updateStyle(L,c){return this.style&&(this.style.setEventedParent(null),this.style._remove()),L?(this.style=new Ce(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof L=="string"?this.style.loadURL(L):this.style.loadJSON(L),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ce(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(L,c){if(typeof L=="string"){const _=this._requestManager.transformRequest(L,o.ResourceType.Style);o.getJSON(_,(A,h)=>{A?this.fire(new o.ErrorEvent(A)):h&&this._updateDiff(h,c)})}else typeof L=="object"&&this._updateDiff(L,c)}_updateDiff(L,c){try{this.style.setState(L)&&this._update(!0)}catch(_){o.warnOnce(`Unable to perform style diff: ${_.message||_.error||_}.  Rebuilding the style from scratch.`),this._updateStyle(L,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")}addSource(L,c){return this._lazyInitEmptyStyle(),this.style.addSource(L,c),this._update(!0)}isSourceLoaded(L){const c=this.style&&this.style.sourceCaches[L];if(c!==void 0)return c.loaded();this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${L}'`)))}setTerrain(L){return this.style.setTerrain(L),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const L=this.style&&this.style.sourceCaches;for(const c in L){const _=L[c]._tiles;for(const A in _){const h=_[A];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}addSourceType(L,c,_){return this._lazyInitEmptyStyle(),this.style.addSourceType(L,c,_)}removeSource(L){return this.style.removeSource(L),this._update(!0)}getSource(L){return this.style.getSource(L)}addImage(L,c,{pixelRatio:_=1,sdf:A=!1,stretchX:h,stretchY:d,content:x}={}){if(this._lazyInitEmptyStyle(),c instanceof HTMLImageElement||o.isImageBitmap(c)){const{width:b,height:S,data:M}=o.exported.getImageData(c);this.style.addImage(L,{data:new o.RGBAImage({width:b,height:S},M),pixelRatio:_,stretchX:h,stretchY:d,content:x,sdf:A,version:0})}else{if(c.width===void 0||c.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:b,height:S,data:M}=c,B=c;this.style.addImage(L,{data:new o.RGBAImage({width:b,height:S},new Uint8Array(M)),pixelRatio:_,stretchX:h,stretchY:d,content:x,sdf:A,version:0,userImage:B}),B.onAdd&&B.onAdd(this,L)}}}updateImage(L,c){const _=this.style.getImage(L);if(!_)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const A=c instanceof HTMLImageElement||o.isImageBitmap(c)?o.exported.getImageData(c):c,{width:h,height:d,data:x}=A;if(h===void 0||d===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==_.data.width||d!==_.data.height)return this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(c instanceof HTMLImageElement||o.isImageBitmap(c));_.data.replace(x,b),this.style.updateImage(L,_)}hasImage(L){return L?!!this.style.getImage(L):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(L){this.style.removeImage(L)}loadImage(L,c){o.getImage(this._requestManager.transformRequest(L,o.ResourceType.Image),c)}listImages(){return this.style.listImages()}addLayer(L,c){return this._lazyInitEmptyStyle(),this.style.addLayer(L,c),this._update(!0)}moveLayer(L,c){return this.style.moveLayer(L,c),this._update(!0)}removeLayer(L){return this.style.removeLayer(L),this._update(!0)}getLayer(L){return this.style.getLayer(L)}setLayerZoomRange(L,c,_){return this.style.setLayerZoomRange(L,c,_),this._update(!0)}setFilter(L,c,_={}){return this.style.setFilter(L,c,_),this._update(!0)}getFilter(L){return this.style.getFilter(L)}setPaintProperty(L,c,_,A={}){return this.style.setPaintProperty(L,c,_,A),this._update(!0)}getPaintProperty(L,c){return this.style.getPaintProperty(L,c)}setLayoutProperty(L,c,_,A={}){return this.style.setLayoutProperty(L,c,_,A),this._update(!0)}getLayoutProperty(L,c){return this.style.getLayoutProperty(L,c)}setLight(L,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(L,c),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(L,c){return this.style.setFeatureState(L,c),this._update()}removeFeatureState(L,c){return this.style.removeFeatureState(L,c),this._update()}getFeatureState(L){return this.style.getFeatureState(L)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let L=0,c=0;return this._container&&(L=this._container.clientWidth||400,c=this._container.clientHeight||300),[L,c]}_setupContainer(){const L=this._container;L.classList.add("maplibregl-map","mapboxgl-map");const c=this._canvasContainer=I.create("div","maplibregl-canvas-container mapboxgl-canvas-container",L);this._interactive&&c.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=I.create("canvas","maplibregl-canvas mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const _=this._containerDimensions();this._resizeCanvas(_[0],_[1],this.getPixelRatio());const A=this._controlContainer=I.create("div","maplibregl-control-container mapboxgl-control-container",L),h=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(d=>{h[d]=I.create("div",`maplibregl-ctrl-${d} mapboxgl-ctrl-${d}`,A)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const L=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=I.create("div","maplibregl-cooperative-gesture-screen",L);let c="Control",_=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(_=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map",c="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${_}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",A=>{A.key===c&&(this._metaPress=!0)}),document.addEventListener("keyup",A=>{A.key===c&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",A=>{this._onCooperativeGesture(A,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(L,c,_){this._canvas.width=_*L,this._canvas.height=_*c,this._canvas.style.width=`${L}px`,this._canvas.style.height=`${c}px`}_setupPainter(){const L=o.extend({},p.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._canvas.getContext("webgl",L)||this._canvas.getContext("experimental-webgl",L);c?(this.painter=new bi(c,this.transform),o.exported$1.testSupport(c)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(L){L.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:L}))}_contextRestored(L){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:L}))}_onMapScroll(L){if(L.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(L,c,_){return!c&&_<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(L){return this.style?(this._styleDirty=this._styleDirty||L,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(L){return this._update(),this._renderTaskQueue.add(L)}_cancelRenderFrame(L){this._renderTaskQueue.remove(L)}_render(L){let c,_=0;const A=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(c=A.createQueryEXT(),A.beginQueryEXT(A.TIME_ELAPSED_EXT,c),_=o.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(L),this._removed)return;let h=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const x=this.transform.zoom,b=o.exported.now();this.style.zoomHistory.update(x,b);const S=new o.EvaluationParameters(x,{now:b,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),M=S.crossFadingFactor();M===1&&M===this._crossFadingFactor||(h=!0,this._crossFadingFactor=M),this.style.update(S)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.load),this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||h)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const x=o.exported.now()-_;A.endQueryEXT(A.TIME_ELAPSED_EXT,c),setTimeout(()=>{const b=A.getQueryObjectEXT(c,A.QUERY_RESULT_EXT)/1e6;A.deleteQueryEXT(c),this.fire(new o.Event("gpu-timing-frame",{cpuTime:x,gpuTime:b}))},50)}if(this.listens("gpu-timing-layer")){const x=this.painter.collectGpuTimers();setTimeout(()=>{const b=this.painter.queryGpuTimers(x);this.fire(new o.Event("gpu-timing-layer",{layerTimes:b}))},50)}const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const L=this.painter.context.gl.getExtension("WEBGL_lose_context");L&&L.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),I.remove(this._canvasContainer),I.remove(this._controlContainer),this._cooperativeGestures&&I.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),o.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=o.exported.frame(L=>{o.PerformanceUtils.frame(L),this._frame=null,this._render(L)}))}_onWindowOnline(){this._update()}_onWindowResize(L){this._trackResize&&this.resize({originalEvent:L})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(L){this._showTileBoundaries!==L&&(this._showTileBoundaries=L,this._update())}get showPadding(){return!!this._showPadding}set showPadding(L){this._showPadding!==L&&(this._showPadding=L,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(L){this._showCollisionBoxes!==L&&(this._showCollisionBoxes=L,L?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(L){this._showOverdrawInspector!==L&&(this._showOverdrawInspector=L,this._update())}get repaint(){return!!this._repaint}set repaint(L){this._repaint!==L&&(this._repaint=L,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(L){this._vertices=L,this._update()}_setCacheLimits(L,c){o.setCacheLimits(L,c)}get version(){return"2.4.0"}},NavigationControl:class{constructor(L){this.options=o.extend({},Pc,L),this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",c=>this._map.zoomIn({},{originalEvent:c})),I.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",c=>this._map.zoomOut({},{originalEvent:c})),I.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",c=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:c}):this._map.resetNorth({},{originalEvent:c})}),this._compassIcon=I.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const L=this._map.getZoom(),c=L===this._map.getMaxZoom(),_=L===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const L=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=L}onAdd(L){return this._map=L,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new yr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){I.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(L,c){const _=I.create("button",L,this._container);return _.type="button",_.addEventListener("click",c),_}_setButtonTitle(L,c){const _=this._map._getUIString(`NavigationControl.${c}`);L.title=_,L.setAttribute("aria-label",_)}},GeolocateControl:class extends o.Evented{constructor(L){super(),this.options=o.extend({},Ji,L),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(L){var c;return this._map=L,this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,Xo!==void 0?c(Xo):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(_=>{Xo=_.state!=="denied",c(Xo)}):(Xo=!!window.navigator.geolocation,c(Xo)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),I.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,$r=0,Qs=!1}_isOutOfMapMaxBounds(L){const c=this._map.getMaxBounds(),_=L.coords;return c&&(_.longitude<c.getWest()||_.longitude>c.getEast()||_.latitude<c.getSouth()||_.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(L){if(this._map){if(this._isOutOfMapMaxBounds(L))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",L)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=L,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(L),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(L),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",L)),this._finish()}}_updateCamera(L){const c=new o.LngLat(L.coords.longitude,L.coords.latitude),_=L.coords.accuracy,A=this._map.getBearing(),h=o.extend({bearing:A},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(_),h,{geolocateSource:!0})}_updateMarker(L){if(L){const c=new o.LngLat(L.coords.longitude,L.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=L.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const L=this._map._container.clientHeight/2,c=this._map.unproject([0,L]),_=this._map.unproject([1,L]),A=c.distanceTo(_),h=Math.ceil(2*this._accuracy/A);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(L){if(this._map){if(this.options.trackUserLocation)if(L.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(L.code===3&&Qs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",L)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(L){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=I.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),I.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",L===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=I.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new hn(this._dotElement),this._circleElement=I.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new hn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":$r--,Qs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let L;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),$r++,$r>1?(L={maximumAge:6e5,timeout:0},Qs=!0):(L=this.options.positionOptions,Qs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,L)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:nl,LogoControl:Hl,ScaleControl:class{constructor(L){this.options=o.extend({},Cs,L),o.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){qs(this._map,this._container,this.options)}onAdd(L){return this._map=L,this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",L.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){I.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(L){this.options.unit=L,qs(this._map,this._container,this.options)}},FullscreenControl:class{constructor(L){this._fullscreen=!1,L&&L.container&&(L.container instanceof HTMLElement?this._container=L.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(L){return this._map=L,this._container||(this._container=this._map.getContainer()),this._controlContainer=I.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){I.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const L=this._fullscreenButton=I.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);I.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",L).setAttribute("aria-hidden","true"),L.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const L=this._getTitle();this._fullscreenButton.setAttribute("aria-label",L),this._fullscreenButton.title=L}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(L){this.options=L,o.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(L){return this._map=L,this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=I.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),I.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){I.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends o.Evented{constructor(L){super(),this.options=o.extend(Object.create(Pt),L),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(L){return this._map&&this.remove(),this._map=L,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&I.remove(this._content),this._container&&(I.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(L){return this._lngLat=o.LngLat.convert(L),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(L){return this.setDOMContent(document.createTextNode(L))}setHTML(L){const c=document.createDocumentFragment(),_=document.createElement("body");let A;for(_.innerHTML=L;A=_.firstChild,A;)c.appendChild(A);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(L){return this.options.maxWidth=L,this._update(),this}setDOMContent(L){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=I.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(L),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(L){this._container&&this._container.classList.add(L)}removeClassName(L){this._container&&this._container.classList.remove(L)}setOffset(L){return this.options.offset=L,this._update(),this}toggleClassName(L){if(this._container)return this._container.classList.toggle(L)}_createCloseButton(){this.options.closeButton&&(this._closeButton=I.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(L){this._update(L.point)}_onMouseMove(L){this._update(L.point)}_onDrag(L){this._update(L.point)}_update(L){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=I.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=I.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(d=>this._container.classList.add(d)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Wl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!L))return;const c=this._pos=this._trackPointer&&L?L:this._map.project(this._lngLat);let _=this.options.anchor;const A=rl(this.options.offset);if(!_){const d=this._container.offsetWidth,x=this._container.offsetHeight;let b;b=c.y+A.bottom.y<x?["top"]:c.y>this._map.transform.height-x?["bottom"]:[],c.x<d/2?b.push("left"):c.x>this._map.transform.width-d/2&&b.push("right"),_=b.length===0?"bottom":b.join("-")}const h=c.add(A[_]).round();I.setTransform(this._container,`${Yt[_]} translate(${h.x}px,${h.y}px)`),Xt(this._container,_,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const L=this._container.querySelector(jr);L&&L.focus()}_onClose(){this.remove()}},Marker:hn,Style:Ce,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,AJAXError:o.AJAXError,config:o.config,CanvasSource:In,GeoJSONSource:dn,ImageSource:Et,RasterDEMTileSource:Tt,RasterTileSource:yt,VectorTileSource:Ze,VideoSource:Jt,prewarm:function(){lr().acquire(xt)},clearPrewarmedResources:function(){const L=vr;L&&(L.isPreloaded()&&L.numActive()===1?(L.release(xt),vr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return nr.workerCount},set workerCount(L){nr.workerCount=L},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(L){o.config.MAX_PARALLEL_IMAGE_REQUESTS=L},clearStorage(L){o.clearTileCache(L)},workerUrl:"",addProtocol(L,c){o.config.REGISTERED_PROTOCOLS[L]=c},removeProtocol(L){delete o.config.REGISTERED_PROTOCOLS[L]}};return fs.extend(Zs,{isSafari:o.isSafari,getPerformanceMetrics:o.PerformanceUtils.getPerformanceMetrics}),Zs});var l=i;return l})})(pz);var mz=pz.exports;const Oo=z2(mz),ine=OE({__proto__:null,default:Oo},[mz]),sne="modulepreload",one=function(t){return"/"+t},xk={},yz=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=one(s),s in xk)return;xk[s]=!0;const l=s.endsWith(".css"),o=l?'[rel="stylesheet"]':"";if(!!r)for(let C=i.length-1;C>=0;C--){const P=i[C];if(P.href===s&&(!l||P.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const w=document.createElement("link");if(w.rel=l?"stylesheet":sne,l||(w.as="script",w.crossOrigin=""),w.href=s,document.head.appendChild(w),l)return new Promise((C,P)=>{w.addEventListener("load",C),w.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s})},_z=Ne.createContext(null);function ane(){var t;const e=(t=Ne.useContext(_z))===null||t===void 0?void 0:t.maps,n=Ne.useContext(Im);return Ne.useMemo(()=>({...e,current:n?.map}),[e,n])}function lne(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function Vu(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Vu(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!Vu(t[i],e[i]))return!1;return!0}return!1}function Ane(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function wk(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();Vu(n,r)||e.setProjection(n)}function bk(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function Ek(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const une=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Tk(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const l of une)l in s&&(i[l]=s[l])}return i||r});return{...t,layers:n}}const Sk={version:8,sources:{},layers:[]},Ck={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Mw={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Mk={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},cne=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],hne=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class _d{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[Mk[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[Ck[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[Mw[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=_d.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const l=i._resizeObserver;l&&(l.disconnect(),l.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:o}=e;return o&&(o.bounds?i.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):r._updateViewState(o,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=Sk}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||fne()||null,container:e,style:Tk(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const C=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=C,n.gl)}const l=new this._MapClass(i);s.padding&&l.setPadding(s.padding),n.cursor&&(l.getCanvas().style.cursor=n.cursor),this._createShadowTransform(l);const o=l._render;l._render=C=>{this._inRender=!0,o.call(l,C),this._inRender=!1};const p=l._renderTaskQueue.run;l._renderTaskQueue.run=C=>{p.call(l._renderTaskQueue,C),this._onBeforeRepaint()},l.on("render",()=>this._onAfterRepaint());const w=l.fire;l.fire=this._fireEvent.bind(this,w),l.on("resize",()=>{this._renderTransform.resize(l.transform.width,l.transform.height)}),l.on("styledata",()=>{this._updateStyleComponents(this.props,{}),wk(l.transform,this._renderTransform)}),l.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const C in Ck)l.on(C,this._onPointerEvent);for(const C in Mw)l.on(C,this._onCameraEvent);for(const C in Mk)l.on(C,this._onEvent);this._map=l}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n?.remove(),_d.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=Ane(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:l,bearing:o}=i,p=r.isMoving();p&&(i.cameraElevationReference="sea");const w=Ek(i,{...bk(r.transform),...e});if(p&&(i.cameraElevationReference="ground"),w&&n){const C=this._deferredEvents;C.move=!0,C.zoom||(C.zoom=s!==i.zoom),C.rotate||(C.rotate=o!==i.bearing),C.pitch||(C.pitch=l!==i.pitch)}return p||Ek(r.transform,e),w}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of cne)if(s in e&&!Vu(e[s],n[s])){i=!0;const l=r[`set${s[0].toUpperCase()}${s.slice(1)}`];l?.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=Sk,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(Tk(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!Vu(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!Vu(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!Vu(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let l=!1;for(const o of hne){const p=(r=e[o])!==null&&r!==void 0?r:!0,w=(i=n[o])!==null&&i!==void 0?i:!0;Vu(p,w)||(l=!0,p?s[o].enable(p):s[o].disable())}return l}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,l=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,o=this._queryRenderedFeatures(e.point),p=o.length>0;!p&&l&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=o,p&&!l&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,l=typeof n=="string"?n:n.type;return l==="move"&&this._updateViewState(this.props,!1),l in Mw&&(typeof n=="object"&&(n.viewState=bk(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{wk(this._renderTransform,n),e.transform=n}}}_d.savedMaps=[];function fne(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const dne=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function pne(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const l=e.queryTerrainElevation(r,i);return e.transform=s,l},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const l=e.queryRenderedFeatures(r,i);return e.transform=s,l}};for(const r of gne(e))!(r in n)&&!dne.includes(r)&&(n[r]=e[r].bind(e));return n}function gne(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const mne=typeof document<"u"?Ne.useLayoutEffect:Ne.useEffect,yne=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function _ne(t,e){for(const r of yne)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!1)}const Im=Ne.createContext(null);function vz(t,e,n){const r=Ne.useContext(_z),[i,s]=Ne.useState(null),l=Ne.useRef(),{current:o}=Ne.useRef({mapLib:null,map:null});Ne.useEffect(()=>{const C=t.mapLib;let P=!0,I;return Promise.resolve(C||n).then(U=>{if(!P)return;if(!U)throw new Error("Invalid mapLib");const W="Map"in U?U:U.default;if(!W.Map)throw new Error("Invalid mapLib");if(_ne(W,t),!W.supported||W.supported(t))t.reuseMaps&&(I=_d.reuse(t,l.current)),I||(I=new _d(W.Map,t,l.current)),o.map=pne(I),o.mapLib=W,s(I),r?.onMapMount(o.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(U=>{const{onError:W}=t;W?W({type:"error",target:null,originalEvent:null,error:U}):console.error(U)}),()=>{P=!1,I&&(r?.onMapUnmount(t.id),t.reuseMaps?I.recycle():I.destroy())}},[]),mne(()=>{i&&i.setProps(t)}),Ne.useImperativeHandle(e,()=>o.map,[i]);const p=Ne.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),w={height:"100%"};return Ne.createElement("div",{id:t.id,ref:l,style:p},i&&Ne.createElement(Im.Provider,{value:o},Ne.createElement("div",{"mapboxgl-children":"",style:w},t.children)))}const vne=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Of(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!vne.test(r)?n[r]=`${i}px`:n[r]=i}}function xne(t,e){const{map:n,mapLib:r}=Ne.useContext(Im),i=Ne.useRef({props:t});i.current.props=t;const s=Ne.useMemo(()=>{let H=!1;Ne.Children.forEach(t.children,ee=>{ee&&(H=!0)});const ie={...t,element:H?document.createElement("div"):null},X=new r.Marker(ie);return X.setLngLat([t.longitude,t.latitude]),X.getElement().addEventListener("click",ee=>{var se,fe;(fe=(se=i.current.props).onClick)===null||fe===void 0||fe.call(se,{type:"click",target:X,originalEvent:ee})}),X.on("dragstart",ee=>{var se,fe;const me=ee;me.lngLat=s.getLngLat(),(fe=(se=i.current.props).onDragStart)===null||fe===void 0||fe.call(se,me)}),X.on("drag",ee=>{var se,fe;const me=ee;me.lngLat=s.getLngLat(),(fe=(se=i.current.props).onDrag)===null||fe===void 0||fe.call(se,me)}),X.on("dragend",ee=>{var se,fe;const me=ee;me.lngLat=s.getLngLat(),(fe=(se=i.current.props).onDragEnd)===null||fe===void 0||fe.call(se,me)}),X},[]);Ne.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:l,latitude:o,offset:p,style:w,draggable:C=!1,popup:P=null,rotation:I=0,rotationAlignment:U="auto",pitchAlignment:W="auto"}=t;return Ne.useEffect(()=>{Of(s.getElement(),w)},[w]),Ne.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==l||s.getLngLat().lat!==o)&&s.setLngLat([l,o]),p&&!lne(s.getOffset(),p)&&s.setOffset(p),s.isDraggable()!==C&&s.setDraggable(C),s.getRotation()!==I&&s.setRotation(I),s.getRotationAlignment()!==U&&s.setRotationAlignment(U),s.getPitchAlignment()!==W&&s.setPitchAlignment(W),s.getPopup()!==P&&s.setPopup(P),LT.createPortal(t.children,s.getElement())}Ne.memo(Ne.forwardRef(xne));function Pk(t){return new Set(t?t.trim().split(/\s+/):[])}function wne(t,e){const{map:n,mapLib:r}=Ne.useContext(Im),i=Ne.useMemo(()=>document.createElement("div"),[]),s=Ne.useRef({props:t});s.current.props=t;const l=Ne.useMemo(()=>{const o={...t},p=new r.Popup(o);return p.setLngLat([t.longitude,t.latitude]),p.once("open",w=>{var C,P;(P=(C=s.current.props).onOpen)===null||P===void 0||P.call(C,w)}),p},[]);if(Ne.useEffect(()=>{const o=p=>{var w,C;(C=(w=s.current.props).onClose)===null||C===void 0||C.call(w,p)};return l.on("close",o),l.setDOMContent(i).addTo(n.getMap()),()=>{l.off("close",o),l.isOpen()&&l.remove()}},[]),Ne.useEffect(()=>{Of(l.getElement(),t.style)},[t.style]),Ne.useImperativeHandle(e,()=>l,[]),l.isOpen()&&((l.getLngLat().lng!==t.longitude||l.getLngLat().lat!==t.latitude)&&l.setLngLat([t.longitude,t.latitude]),t.offset&&!Vu(l.options.offset,t.offset)&&l.setOffset(t.offset),(l.options.anchor!==t.anchor||l.options.maxWidth!==t.maxWidth)&&(l.options.anchor=t.anchor,l.setMaxWidth(t.maxWidth)),l.options.className!==t.className)){const o=Pk(l.options.className),p=Pk(t.className);for(const w of o)p.has(w)||l.removeClassName(w);for(const w of p)o.has(w)||l.addClassName(w);l.options.className=t.className}return LT.createPortal(t.children,i)}Ne.memo(Ne.forwardRef(wne));function Lm(t,e,n,r){const i=Ne.useContext(Im),s=Ne.useMemo(()=>t(i),[]);return Ne.useEffect(()=>{const l=r||n||e,o=typeof e=="function"&&typeof n=="function"?e:null,p=typeof n=="function"?n:typeof e=="function"?e:null,{map:w}=i;return w.hasControl(s)||(w.addControl(s,l?.position),o&&o(i)),()=>{p&&p(i),w.hasControl(s)&&w.removeControl(s)}},[]),s}function bne(t){const e=Lm(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return Ne.useEffect(()=>{Of(e._container,t.style)},[t.style]),null}Ne.memo(bne);function Ene(t){const e=Lm(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return Ne.useEffect(()=>{Of(e._controlContainer,t.style)},[t.style]),null}Ne.memo(Ene);function Tne(t,e){const n=Ne.useRef({props:t}),r=Lm(({mapLib:i})=>{const s=new i.GeolocateControl(t),l=s._setupUI;return s._setupUI=o=>{s._container.hasChildNodes()||l(o)},s.on("geolocate",o=>{var p,w;(w=(p=n.current.props).onGeolocate)===null||w===void 0||w.call(p,o)}),s.on("error",o=>{var p,w;(w=(p=n.current.props).onError)===null||w===void 0||w.call(p,o)}),s.on("outofmaxbounds",o=>{var p,w;(w=(p=n.current.props).onOutOfMaxBounds)===null||w===void 0||w.call(p,o)}),s.on("trackuserlocationstart",o=>{var p,w;(w=(p=n.current.props).onTrackUserLocationStart)===null||w===void 0||w.call(p,o)}),s.on("trackuserlocationend",o=>{var p,w;(w=(p=n.current.props).onTrackUserLocationEnd)===null||w===void 0||w.call(p,o)}),s},{position:t.position});return n.current.props=t,Ne.useImperativeHandle(e,()=>r,[]),Ne.useEffect(()=>{Of(r._container,t.style)},[t.style]),null}Ne.memo(Ne.forwardRef(Tne));function Sne(t){const e=Lm(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return Ne.useEffect(()=>{Of(e._container,t.style)},[t.style]),null}Ne.memo(Sne);function Cne(t){const e=Lm(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=Ne.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),Ne.useEffect(()=>{Of(e._container,i)},[i]),null}Ne.memo(Cne);function Mne(){return ane()}const Pne=yz(()=>import("./__vite-optional-peer-dep_mapbox-gl_react-map-gl-b25bb000.js"),[]),Fa=(()=>Ne.forwardRef(function(e,n){return vz(e,n,Pne)}))(),kne=8,Ine="Positron",Lne={},Dne={carto:{type:"vector",url:"https://tiles.basemaps.cartocdn.com/vector/carto.streets/v1/tiles.json"}},Rne="https://tiles.basemaps.cartocdn.com/gl/positron-gl-style/sprite",Bne="https://tiles.basemaps.cartocdn.com/fonts/{fontstack}/{range}.pbf",zne=[{id:"waterway_label",type:"symbol",source:"carto","source-layer":"waterway",filter:["all",["has","name"],["==","class","river"]],layout:{"text-field":"{name_en}","text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-placement":"line","symbol-spacing":100,"symbol-avoid-edges":!1,"text-size":27,"text-padding":2,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-offset":[0,-.2],"text-letter-spacing":0,"text-keep-upright":!0},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"watername_ocean",type:"symbol",source:"carto","source-layer":"water_name",minzoom:0,maxzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","ocean"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":27,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":0}},{id:"watername_sea",type:"symbol",source:"carto","source-layer":"water_name",minzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","sea"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":27,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":0}},{id:"watername_lake",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","Point"],["==","class","lake"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"point","text-size":27,"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto"},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":1}},{id:"watername_lake_line",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","LineString"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"line","text-size":27,"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-spacing":350,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-line-height":1.2},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":1}},{id:"place_city_r6",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",6]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,12],[9,13],[10,14],[13,17],[14,20]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_r5",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",0],["<=","rank",5]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,14],[10,16],[13,19],[14,22]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",["!has","capital"],["!in","class","country","state"],[">=","rank",0],["<=","rank",7]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2]},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_capital_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",[">","capital",0]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"poi_stadium",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["in","class","stadium","cemetery","attraction"],["<=","rank",3]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"poi_park",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["==","class","park"]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"roadname_minor",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:16,filter:["all",["in","class","minor","service"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":9,"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_sec",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:15,filter:["all",["in","class","secondary","tertiary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,9],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_pri",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:14,filter:["all",["in","class","primary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[14,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_major",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:13,filter:["all",["in","class","trunk","motorway"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[13,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}}],One="voyager",Fne="Carto",Na={version:kne,name:Ine,metadata:Lne,sources:Dne,sprite:Rne,glyphs:Bne,layers:zne,id:One,owner:Fne};function Fy(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Nne(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function pS(t){let e,n,r;t.length!==2?(e=Fy,n=(o,p)=>Fy(t(o),p),r=(o,p)=>t(o)-p):(e=t===Fy||t===Nne?t:Une,n=t,r=t);function i(o,p,w=0,C=o.length){if(w<C){if(e(p,p)!==0)return C;do{const P=w+C>>>1;n(o[P],p)<0?w=P+1:C=P}while(w<C)}return w}function s(o,p,w=0,C=o.length){if(w<C){if(e(p,p)!==0)return C;do{const P=w+C>>>1;n(o[P],p)<=0?w=P+1:C=P}while(w<C)}return w}function l(o,p,w=0,C=o.length){const P=i(o,p,w,C-1);return P>w&&r(o[P-1],p)>-r(o[P],p)?P-1:P}return{left:i,center:l,right:s}}function Une(){return 0}function Vne(t){return t===null?NaN:+t}const Gne=pS(Fy),$ne=Gne.right;pS(Vne).center;const xz=$ne;function al(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of t)(s=e(s,++i,t))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}const jne=Math.sqrt(50),Hne=Math.sqrt(10),Wne=Math.sqrt(2);function j_(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),l=s>=jne?10:s>=Hne?5:s>=Wne?2:1;let o,p,w;return i<0?(w=Math.pow(10,-i)/l,o=Math.round(t*w),p=Math.round(e*w),o/w<t&&++o,p/w>e&&--p,w=-w):(w=Math.pow(10,i)*l,o=Math.round(t/w),p=Math.round(e/w),o*w<t&&++o,p*w>e&&--p),p<o&&.5<=n&&n<2?j_(t,e,n*2):[o,p,w]}function Qne(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,l]=r?j_(e,t,n):j_(t,e,n);if(!(s>=i))return[];const o=s-i+1,p=new Array(o);if(r)if(l<0)for(let w=0;w<o;++w)p[w]=(s-w)/-l;else for(let w=0;w<o;++w)p[w]=(s-w)*l;else if(l<0)for(let w=0;w<o;++w)p[w]=(i+w)/-l;else for(let w=0;w<o;++w)p[w]=(i+w)*l;return p}function $3(t,e,n){return e=+e,t=+t,n=+n,j_(t,e,n)[2]}function j3(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?$3(e,t,n):$3(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function qne(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Wg(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var Zne={value:()=>{}};function wz(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ny(n)}function Ny(t){this._=t}function Yne(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ny.prototype=wz.prototype={constructor:Ny,on:function(t,e){var n=this._,r=Yne(t+"",n),i,s=-1,l=r.length;if(arguments.length<2){for(;++s<l;)if((i=(t=r[s]).type)&&(i=Xne(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<l;)if(i=(t=r[s]).type)n[i]=kk(n[i],t.name,e);else if(e==null)for(i in n)n[i]=kk(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ny(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function Xne(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function kk(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Zne,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var H3="http://www.w3.org/1999/xhtml";const Ik={svg:"http://www.w3.org/2000/svg",xhtml:H3,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function av(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Ik.hasOwnProperty(e)?{space:Ik[e],local:t}:t}function Kne(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===H3&&e.documentElement.namespaceURI===H3?e.createElement(t):e.createElementNS(n,t)}}function Jne(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function bz(t){var e=av(t);return(e.local?Jne:Kne)(e)}function ere(){}function gS(t){return t==null?ere:function(){return this.querySelector(t)}}function tre(t){typeof t!="function"&&(t=gS(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=new Array(l),p,w,C=0;C<l;++C)(p=s[C])&&(w=t.call(p,p.__data__,C,s))&&("__data__"in p&&(w.__data__=p.__data__),o[C]=w);return new Fo(r,this._parents)}function Ez(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function nre(){return[]}function Tz(t){return t==null?nre:function(){return this.querySelectorAll(t)}}function rre(t){return function(){return Ez(t.apply(this,arguments))}}function ire(t){typeof t=="function"?t=rre(t):t=Tz(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var l=e[s],o=l.length,p,w=0;w<o;++w)(p=l[w])&&(r.push(t.call(p,p.__data__,w,l)),i.push(p));return new Fo(r,i)}function Sz(t){return function(){return this.matches(t)}}function Cz(t){return function(e){return e.matches(t)}}var sre=Array.prototype.find;function ore(t){return function(){return sre.call(this.children,t)}}function are(){return this.firstElementChild}function lre(t){return this.select(t==null?are:ore(typeof t=="function"?t:Cz(t)))}var Are=Array.prototype.filter;function ure(){return Array.from(this.children)}function cre(t){return function(){return Are.call(this.children,t)}}function hre(t){return this.selectAll(t==null?ure:cre(typeof t=="function"?t:Cz(t)))}function fre(t){typeof t!="function"&&(t=Sz(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=[],p,w=0;w<l;++w)(p=s[w])&&t.call(p,p.__data__,w,s)&&o.push(p);return new Fo(r,this._parents)}function Mz(t){return new Array(t.length)}function dre(){return new Fo(this._enter||this._groups.map(Mz),this._parents)}function H_(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}H_.prototype={constructor:H_,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function pre(t){return function(){return t}}function gre(t,e,n,r,i,s){for(var l=0,o,p=e.length,w=s.length;l<w;++l)(o=e[l])?(o.__data__=s[l],r[l]=o):n[l]=new H_(t,s[l]);for(;l<p;++l)(o=e[l])&&(i[l]=o)}function mre(t,e,n,r,i,s,l){var o,p,w=new Map,C=e.length,P=s.length,I=new Array(C),U;for(o=0;o<C;++o)(p=e[o])&&(I[o]=U=l.call(p,p.__data__,o,e)+"",w.has(U)?i[o]=p:w.set(U,p));for(o=0;o<P;++o)U=l.call(t,s[o],o,s)+"",(p=w.get(U))?(r[o]=p,p.__data__=s[o],w.delete(U)):n[o]=new H_(t,s[o]);for(o=0;o<C;++o)(p=e[o])&&w.get(I[o])===p&&(i[o]=p)}function yre(t){return t.__data__}function _re(t,e){if(!arguments.length)return Array.from(this,yre);var n=e?mre:gre,r=this._parents,i=this._groups;typeof t!="function"&&(t=pre(t));for(var s=i.length,l=new Array(s),o=new Array(s),p=new Array(s),w=0;w<s;++w){var C=r[w],P=i[w],I=P.length,U=vre(t.call(C,C&&C.__data__,w,r)),W=U.length,H=o[w]=new Array(W),ie=l[w]=new Array(W),X=p[w]=new Array(I);n(C,P,H,ie,X,U,e);for(var ee=0,se=0,fe,me;ee<W;++ee)if(fe=H[ee]){for(ee>=se&&(se=ee+1);!(me=ie[se])&&++se<W;);fe._next=me||null}}return l=new Fo(l,r),l._enter=o,l._exit=p,l}function vre(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function xre(){return new Fo(this._exit||this._groups.map(Mz),this._parents)}function wre(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function bre(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,l=Math.min(i,s),o=new Array(i),p=0;p<l;++p)for(var w=n[p],C=r[p],P=w.length,I=o[p]=new Array(P),U,W=0;W<P;++W)(U=w[W]||C[W])&&(I[W]=U);for(;p<i;++p)o[p]=n[p];return new Fo(o,this._parents)}function Ere(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],l;--i>=0;)(l=r[i])&&(s&&l.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(l,s),s=l);return this}function Tre(t){t||(t=Sre);function e(P,I){return P&&I?t(P.__data__,I.__data__):!P-!I}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var l=n[s],o=l.length,p=i[s]=new Array(o),w,C=0;C<o;++C)(w=l[C])&&(p[C]=w);p.sort(e)}return new Fo(i,this._parents).order()}function Sre(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Cre(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Mre(){return Array.from(this)}function Pre(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var l=r[i];if(l)return l}return null}function kre(){let t=0;for(const e of this)++t;return t}function Ire(){return!this.node()}function Lre(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,l=i.length,o;s<l;++s)(o=i[s])&&t.call(o,o.__data__,s,i);return this}function Dre(t){return function(){this.removeAttribute(t)}}function Rre(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Bre(t,e){return function(){this.setAttribute(t,e)}}function zre(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ore(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Fre(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Nre(t,e){var n=av(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Rre:Dre:typeof e=="function"?n.local?Fre:Ore:n.local?zre:Bre)(n,e))}function Pz(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ure(t){return function(){this.style.removeProperty(t)}}function Vre(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Gre(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function $re(t,e,n){return arguments.length>1?this.each((e==null?Ure:typeof e=="function"?Gre:Vre)(t,e,n??"")):vd(this.node(),t)}function vd(t,e){return t.style.getPropertyValue(e)||Pz(t).getComputedStyle(t,null).getPropertyValue(e)}function jre(t){return function(){delete this[t]}}function Hre(t,e){return function(){this[t]=e}}function Wre(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Qre(t,e){return arguments.length>1?this.each((e==null?jre:typeof e=="function"?Wre:Hre)(t,e)):this.node()[t]}function kz(t){return t.trim().split(/^|\s+/)}function mS(t){return t.classList||new Iz(t)}function Iz(t){this._node=t,this._names=kz(t.getAttribute("class")||"")}Iz.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Lz(t,e){for(var n=mS(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Dz(t,e){for(var n=mS(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function qre(t){return function(){Lz(this,t)}}function Zre(t){return function(){Dz(this,t)}}function Yre(t,e){return function(){(e.apply(this,arguments)?Lz:Dz)(this,t)}}function Xre(t,e){var n=kz(t+"");if(arguments.length<2){for(var r=mS(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Yre:e?qre:Zre)(n,e))}function Kre(){this.textContent=""}function Jre(t){return function(){this.textContent=t}}function eie(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function tie(t){return arguments.length?this.each(t==null?Kre:(typeof t=="function"?eie:Jre)(t)):this.node().textContent}function nie(){this.innerHTML=""}function rie(t){return function(){this.innerHTML=t}}function iie(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function sie(t){return arguments.length?this.each(t==null?nie:(typeof t=="function"?iie:rie)(t)):this.node().innerHTML}function oie(){this.nextSibling&&this.parentNode.appendChild(this)}function aie(){return this.each(oie)}function lie(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Aie(){return this.each(lie)}function uie(t){var e=typeof t=="function"?t:bz(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function cie(){return null}function hie(t,e){var n=typeof t=="function"?t:bz(t),r=e==null?cie:typeof e=="function"?e:gS(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function fie(){var t=this.parentNode;t&&t.removeChild(this)}function die(){return this.each(fie)}function pie(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function gie(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function mie(t){return this.select(t?gie:pie)}function yie(t){return arguments.length?this.property("__data__",t):this.node().__data__}function _ie(t){return function(e){t.call(this,e,this.__data__)}}function vie(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function xie(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function wie(t,e,n){return function(){var r=this.__on,i,s=_ie(e);if(r){for(var l=0,o=r.length;l<o;++l)if((i=r[l]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function bie(t,e,n){var r=vie(t+""),i,s=r.length,l;if(arguments.length<2){var o=this.node().__on;if(o){for(var p=0,w=o.length,C;p<w;++p)for(i=0,C=o[p];i<s;++i)if((l=r[i]).type===C.type&&l.name===C.name)return C.value}return}for(o=e?wie:xie,i=0;i<s;++i)this.each(o(r[i],e,n));return this}function Rz(t,e,n){var r=Pz(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Eie(t,e){return function(){return Rz(this,t,e)}}function Tie(t,e){return function(){return Rz(this,t,e.apply(this,arguments))}}function Sie(t,e){return this.each((typeof e=="function"?Tie:Eie)(t,e))}function*Cie(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,l;i<s;++i)(l=r[i])&&(yield l)}var yS=[null];function Fo(t,e){this._groups=t,this._parents=e}function Dm(){return new Fo([[document.documentElement]],yS)}function Mie(){return this}Fo.prototype=Dm.prototype={constructor:Fo,select:tre,selectAll:ire,selectChild:lre,selectChildren:hre,filter:fre,data:_re,enter:dre,exit:xre,join:wre,merge:bre,selection:Mie,order:Ere,sort:Tre,call:Cre,nodes:Mre,node:Pre,size:kre,empty:Ire,each:Lre,attr:Nre,style:$re,property:Qre,classed:Xre,text:tie,html:sie,raise:aie,lower:Aie,append:uie,insert:hie,remove:die,clone:mie,datum:yie,on:bie,dispatch:Sie,[Symbol.iterator]:Cie};function mi(t){return typeof t=="string"?new Fo([[document.querySelector(t)]],[document.documentElement]):new Fo([[t]],yS)}function Pie(t){return typeof t=="string"?new Fo([document.querySelectorAll(t)],[document.documentElement]):new Fo([Ez(t)],yS)}function Rm(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function lv(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ff(){}var Qg=.7,W_=1/Qg,K0="\\s*([+-]?\\d+)\\s*",qg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",XA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",kie=/^#([0-9a-f]{3,8})$/,Iie=new RegExp(`^rgb\\(${K0},${K0},${K0}\\)$`),Lie=new RegExp(`^rgb\\(${XA},${XA},${XA}\\)$`),Die=new RegExp(`^rgba\\(${K0},${K0},${K0},${qg}\\)$`),Rie=new RegExp(`^rgba\\(${XA},${XA},${XA},${qg}\\)$`),Bie=new RegExp(`^hsl\\(${qg},${XA},${XA}\\)$`),zie=new RegExp(`^hsla\\(${qg},${XA},${XA},${qg}\\)$`),Lk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Rm(Ff,_f,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Dk,formatHex:Dk,formatHex8:Oie,formatHsl:Fie,formatRgb:Rk,toString:Rk});function Dk(){return this.rgb().formatHex()}function Oie(){return this.rgb().formatHex8()}function Fie(){return zz(this).formatHsl()}function Rk(){return this.rgb().formatRgb()}function _f(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=kie.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Bk(e):n===3?new ho(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?H1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?H1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Iie.exec(t))?new ho(e[1],e[2],e[3],1):(e=Lie.exec(t))?new ho(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Die.exec(t))?H1(e[1],e[2],e[3],e[4]):(e=Rie.exec(t))?H1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Bie.exec(t))?Fk(e[1],e[2]/100,e[3]/100,1):(e=zie.exec(t))?Fk(e[1],e[2]/100,e[3]/100,e[4]):Lk.hasOwnProperty(t)?Bk(Lk[t]):t==="transparent"?new ho(NaN,NaN,NaN,0):null}function Bk(t){return new ho(t>>16&255,t>>8&255,t&255,1)}function H1(t,e,n,r){return r<=0&&(t=e=n=NaN),new ho(t,e,n,r)}function Bz(t){return t instanceof Ff||(t=_f(t)),t?(t=t.rgb(),new ho(t.r,t.g,t.b,t.opacity)):new ho}function vf(t,e,n,r){return arguments.length===1?Bz(t):new ho(t,e,n,r??1)}function ho(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Rm(ho,vf,lv(Ff,{brighter(t){return t=t==null?W_:Math.pow(W_,t),new ho(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Qg:Math.pow(Qg,t),new ho(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ho(rf(this.r),rf(this.g),rf(this.b),Q_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zk,formatHex:zk,formatHex8:Nie,formatRgb:Ok,toString:Ok}));function zk(){return`#${Jh(this.r)}${Jh(this.g)}${Jh(this.b)}`}function Nie(){return`#${Jh(this.r)}${Jh(this.g)}${Jh(this.b)}${Jh((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ok(){const t=Q_(this.opacity);return`${t===1?"rgb(":"rgba("}${rf(this.r)}, ${rf(this.g)}, ${rf(this.b)}${t===1?")":`, ${t})`}`}function Q_(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function rf(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Jh(t){return t=rf(t),(t<16?"0":"")+t.toString(16)}function Fk(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new nA(t,e,n,r)}function zz(t){if(t instanceof nA)return new nA(t.h,t.s,t.l,t.opacity);if(t instanceof Ff||(t=_f(t)),!t)return new nA;if(t instanceof nA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),l=NaN,o=s-i,p=(s+i)/2;return o?(e===s?l=(n-r)/o+(n<r)*6:n===s?l=(r-e)/o+2:l=(e-n)/o+4,o/=p<.5?s+i:2-s-i,l*=60):o=p>0&&p<1?0:l,new nA(l,o,p,t.opacity)}function Uie(t,e,n,r){return arguments.length===1?zz(t):new nA(t,e,n,r??1)}function nA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Rm(nA,Uie,lv(Ff,{brighter(t){return t=t==null?W_:Math.pow(W_,t),new nA(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Qg:Math.pow(Qg,t),new nA(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new ho(Pw(t>=240?t-240:t+120,i,r),Pw(t,i,r),Pw(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new nA(Nk(this.h),W1(this.s),W1(this.l),Q_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Q_(this.opacity);return`${t===1?"hsl(":"hsla("}${Nk(this.h)}, ${W1(this.s)*100}%, ${W1(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Nk(t){return t=(t||0)%360,t<0?t+360:t}function W1(t){return Math.max(0,Math.min(1,t||0))}function Pw(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Vie=Math.PI/180,Gie=180/Math.PI,q_=18,Oz=.96422,Fz=1,Nz=.82521,Uz=4/29,J0=6/29,Vz=3*J0*J0,$ie=J0*J0*J0;function Gz(t){if(t instanceof KA)return new KA(t.l,t.a,t.b,t.opacity);if(t instanceof qA)return jz(t);t instanceof ho||(t=Bz(t));var e=Dw(t.r),n=Dw(t.g),r=Dw(t.b),i=kw((.2225045*e+.7168786*n+.0606169*r)/Fz),s,l;return e===n&&n===r?s=l=i:(s=kw((.4360747*e+.3850649*n+.1430804*r)/Oz),l=kw((.0139322*e+.0971045*n+.7141733*r)/Nz)),new KA(116*i-16,500*(s-i),200*(i-l),t.opacity)}function jie(t,e,n,r){return arguments.length===1?Gz(t):new KA(t,e,n,r??1)}function KA(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}Rm(KA,jie,lv(Ff,{brighter(t){return new KA(this.l+q_*(t??1),this.a,this.b,this.opacity)},darker(t){return new KA(this.l-q_*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=Oz*Iw(e),t=Fz*Iw(t),n=Nz*Iw(n),new ho(Lw(3.1338561*e-1.6168667*t-.4906146*n),Lw(-.9787684*e+1.9161415*t+.033454*n),Lw(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function kw(t){return t>$ie?Math.pow(t,1/3):t/Vz+Uz}function Iw(t){return t>J0?t*t*t:Vz*(t-Uz)}function Lw(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Dw(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function $z(t){if(t instanceof qA)return new qA(t.h,t.c,t.l,t.opacity);if(t instanceof KA||(t=Gz(t)),t.a===0&&t.b===0)return new qA(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Gie;return new qA(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Uk(t,e,n,r){return arguments.length===1?$z(t):new qA(n,e,t,r??1)}function Hie(t,e,n,r){return arguments.length===1?$z(t):new qA(t,e,n,r??1)}function qA(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function jz(t){if(isNaN(t.h))return new KA(t.l,0,0,t.opacity);var e=t.h*Vie;return new KA(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Rm(qA,Hie,lv(Ff,{brighter(t){return new qA(this.h,this.c,this.l+q_*(t??1),this.opacity)},darker(t){return new qA(this.h,this.c,this.l-q_*(t??1),this.opacity)},rgb(){return jz(this).rgb()}}));function Wie(t,e,n,r,i){var s=t*t,l=s*t;return((1-3*t+3*s-l)*e+(4-6*s+3*l)*n+(1+3*t+3*s-3*l)*r+l*i)/6}function Qie(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],s=t[r+1],l=r>0?t[r-1]:2*i-s,o=r<e-1?t[r+2]:2*s-i;return Wie((n-r/e)*e,l,i,s,o)}}const _S=t=>()=>t;function qie(t,e){return function(n){return t+n*e}}function Zie(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Yie(t){return(t=+t)==1?Hz:function(e,n){return n-e?Zie(e,n,t):_S(isNaN(e)?n:e)}}function Hz(t,e){var n=e-t;return n?qie(t,n):_S(isNaN(t)?e:t)}const Z_=function t(e){var n=Yie(e);function r(i,s){var l=n((i=vf(i)).r,(s=vf(s)).r),o=n(i.g,s.g),p=n(i.b,s.b),w=Hz(i.opacity,s.opacity);return function(C){return i.r=l(C),i.g=o(C),i.b=p(C),i.opacity=w(C),i+""}}return r.gamma=t,r}(1);function Xie(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),s=new Array(n),l,o;for(l=0;l<n;++l)o=vf(e[l]),r[l]=o.r||0,i[l]=o.g||0,s[l]=o.b||0;return r=t(r),i=t(i),s=t(s),o.opacity=1,function(p){return o.r=r(p),o.g=i(p),o.b=s(p),o+""}}}var Wz=Xie(Qie);function Kie(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function Jie(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ese(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),l;for(l=0;l<r;++l)i[l]=vS(t[l],e[l]);for(;l<n;++l)s[l]=e[l];return function(o){for(l=0;l<r;++l)s[l]=i[l](o);return s}}function tse(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function tA(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function nse(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=vS(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var W3=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Rw=new RegExp(W3.source,"g");function rse(t){return function(){return t}}function ise(t){return function(e){return t(e)+""}}function Qz(t,e){var n=W3.lastIndex=Rw.lastIndex=0,r,i,s,l=-1,o=[],p=[];for(t=t+"",e=e+"";(r=W3.exec(t))&&(i=Rw.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[l]?o[l]+=s:o[++l]=s),(r=r[0])===(i=i[0])?o[l]?o[l]+=i:o[++l]=i:(o[++l]=null,p.push({i:l,x:tA(r,i)})),n=Rw.lastIndex;return n<e.length&&(s=e.slice(n),o[l]?o[l]+=s:o[++l]=s),o.length<2?p[0]?ise(p[0].x):rse(e):(e=p.length,function(w){for(var C=0,P;C<e;++C)o[(P=p[C]).i]=P.x(w);return o.join("")})}function vS(t,e){var n=typeof e,r;return e==null||n==="boolean"?_S(e):(n==="number"?tA:n==="string"?(r=_f(e))?(e=r,Z_):Qz:e instanceof _f?Z_:e instanceof Date?tse:Jie(e)?Kie:Array.isArray(e)?ese:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?nse:tA)(t,e)}function sse(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Vk=180/Math.PI,Q3={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function qz(t,e,n,r,i,s){var l,o,p;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(p=t*n+e*r)&&(n-=t*p,r-=e*p),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,p/=o),t*r<e*n&&(t=-t,e=-e,p=-p,l=-l),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*Vk,skewX:Math.atan(p)*Vk,scaleX:l,scaleY:o}}var Q1;function ose(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Q3:qz(e.a,e.b,e.c,e.d,e.e,e.f)}function ase(t){return t==null||(Q1||(Q1=document.createElementNS("http://www.w3.org/2000/svg","g")),Q1.setAttribute("transform",t),!(t=Q1.transform.baseVal.consolidate()))?Q3:(t=t.matrix,qz(t.a,t.b,t.c,t.d,t.e,t.f))}function Zz(t,e,n,r){function i(w){return w.length?w.pop()+" ":""}function s(w,C,P,I,U,W){if(w!==P||C!==I){var H=U.push("translate(",null,e,null,n);W.push({i:H-4,x:tA(w,P)},{i:H-2,x:tA(C,I)})}else(P||I)&&U.push("translate("+P+e+I+n)}function l(w,C,P,I){w!==C?(w-C>180?C+=360:C-w>180&&(w+=360),I.push({i:P.push(i(P)+"rotate(",null,r)-2,x:tA(w,C)})):C&&P.push(i(P)+"rotate("+C+r)}function o(w,C,P,I){w!==C?I.push({i:P.push(i(P)+"skewX(",null,r)-2,x:tA(w,C)}):C&&P.push(i(P)+"skewX("+C+r)}function p(w,C,P,I,U,W){if(w!==P||C!==I){var H=U.push(i(U)+"scale(",null,",",null,")");W.push({i:H-4,x:tA(w,P)},{i:H-2,x:tA(C,I)})}else(P!==1||I!==1)&&U.push(i(U)+"scale("+P+","+I+")")}return function(w,C){var P=[],I=[];return w=t(w),C=t(C),s(w.translateX,w.translateY,C.translateX,C.translateY,P,I),l(w.rotate,C.rotate,P,I),o(w.skewX,C.skewX,P,I),p(w.scaleX,w.scaleY,C.scaleX,C.scaleY,P,I),w=C=null,function(U){for(var W=-1,H=I.length,ie;++W<H;)P[(ie=I[W]).i]=ie.x(U);return P.join("")}}}var lse=Zz(ose,"px, ","px)","deg)"),Ase=Zz(ase,", ",")",")");function Gk(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}var xd=0,Xp=0,kp=0,Yz=1e3,Y_,Kp,X_=0,xf=0,Av=0,Zg=typeof performance=="object"&&performance.now?performance:Date,Xz=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function xS(){return xf||(Xz(use),xf=Zg.now()+Av)}function use(){xf=0}function K_(){this._call=this._time=this._next=null}K_.prototype=Kz.prototype={constructor:K_,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?xS():+n)+(e==null?0:+e),!this._next&&Kp!==this&&(Kp?Kp._next=this:Y_=this,Kp=this),this._call=t,this._time=n,q3()},stop:function(){this._call&&(this._call=null,this._time=1/0,q3())}};function Kz(t,e,n){var r=new K_;return r.restart(t,e,n),r}function cse(){xS(),++xd;for(var t=Y_,e;t;)(e=xf-t._time)>=0&&t._call.call(void 0,e),t=t._next;--xd}function $k(){xf=(X_=Zg.now())+Av,xd=Xp=0;try{cse()}finally{xd=0,fse(),xf=0}}function hse(){var t=Zg.now(),e=t-X_;e>Yz&&(Av-=e,X_=t)}function fse(){for(var t,e=Y_,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Y_=n);Kp=t,q3(r)}function q3(t){if(!xd){Xp&&(Xp=clearTimeout(Xp));var e=t-xf;e>24?(t<1/0&&(Xp=setTimeout($k,t-Zg.now()-Av)),kp&&(kp=clearInterval(kp))):(kp||(X_=Zg.now(),kp=setInterval(hse,Yz)),xd=1,Xz($k))}}function jk(t,e,n){var r=new K_;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var dse=wz("start","end","cancel","interrupt"),pse=[],Jz=0,Hk=1,Z3=2,Uy=3,Wk=4,Y3=5,Vy=6;function uv(t,e,n,r,i,s){var l=t.__transition;if(!l)t.__transition={};else if(n in l)return;gse(t,n,{name:e,index:r,group:i,on:dse,tween:pse,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Jz})}function wS(t,e){var n=yA(t,e);if(n.state>Jz)throw new Error("too late; already scheduled");return n}function ru(t,e){var n=yA(t,e);if(n.state>Uy)throw new Error("too late; already running");return n}function yA(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function gse(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Kz(s,0,n.time);function s(w){n.state=Hk,n.timer.restart(l,n.delay,n.time),n.delay<=w&&l(w-n.delay)}function l(w){var C,P,I,U;if(n.state!==Hk)return p();for(C in r)if(U=r[C],U.name===n.name){if(U.state===Uy)return jk(l);U.state===Wk?(U.state=Vy,U.timer.stop(),U.on.call("interrupt",t,t.__data__,U.index,U.group),delete r[C]):+C<e&&(U.state=Vy,U.timer.stop(),U.on.call("cancel",t,t.__data__,U.index,U.group),delete r[C])}if(jk(function(){n.state===Uy&&(n.state=Wk,n.timer.restart(o,n.delay,n.time),o(w))}),n.state=Z3,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Z3){for(n.state=Uy,i=new Array(I=n.tween.length),C=0,P=-1;C<I;++C)(U=n.tween[C].value.call(t,t.__data__,n.index,n.group))&&(i[++P]=U);i.length=P+1}}function o(w){for(var C=w<n.duration?n.ease.call(null,w/n.duration):(n.timer.restart(p),n.state=Y3,1),P=-1,I=i.length;++P<I;)i[P].call(t,C);n.state===Y3&&(n.on.call("end",t,t.__data__,n.index,n.group),p())}function p(){n.state=Vy,n.timer.stop(),delete r[e];for(var w in r)return;delete t.__transition}}function mse(t,e){var n=t.__transition,r,i,s=!0,l;if(n){e=e==null?null:e+"";for(l in n){if((r=n[l]).name!==e){s=!1;continue}i=r.state>Z3&&r.state<Y3,r.state=Vy,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[l]}s&&delete t.__transition}}function yse(t){return this.each(function(){mse(this,t)})}function _se(t,e){var n,r;return function(){var i=ru(this,t),s=i.tween;if(s!==n){r=n=s;for(var l=0,o=r.length;l<o;++l)if(r[l].name===e){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function vse(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=ru(this,t),l=s.tween;if(l!==r){i=(r=l).slice();for(var o={name:e,value:n},p=0,w=i.length;p<w;++p)if(i[p].name===e){i[p]=o;break}p===w&&i.push(o)}s.tween=i}}function xse(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=yA(this.node(),n).tween,i=0,s=r.length,l;i<s;++i)if((l=r[i]).name===t)return l.value;return null}return this.each((e==null?_se:vse)(n,t,e))}function bS(t,e,n){var r=t._id;return t.each(function(){var i=ru(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return yA(i,r).value[e]}}function eO(t,e){var n;return(typeof e=="number"?tA:e instanceof _f?Z_:(n=_f(e))?(e=n,Z_):Qz)(t,e)}function wse(t){return function(){this.removeAttribute(t)}}function bse(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ese(t,e,n){var r,i=n+"",s;return function(){var l=this.getAttribute(t);return l===i?null:l===r?s:s=e(r=l,n)}}function Tse(t,e,n){var r,i=n+"",s;return function(){var l=this.getAttributeNS(t.space,t.local);return l===i?null:l===r?s:s=e(r=l,n)}}function Sse(t,e,n){var r,i,s;return function(){var l,o=n(this),p;return o==null?void this.removeAttribute(t):(l=this.getAttribute(t),p=o+"",l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o)))}}function Cse(t,e,n){var r,i,s;return function(){var l,o=n(this),p;return o==null?void this.removeAttributeNS(t.space,t.local):(l=this.getAttributeNS(t.space,t.local),p=o+"",l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o)))}}function Mse(t,e){var n=av(t),r=n==="transform"?Ase:eO;return this.attrTween(t,typeof e=="function"?(n.local?Cse:Sse)(n,r,bS(this,"attr."+t,e)):e==null?(n.local?bse:wse)(n):(n.local?Tse:Ese)(n,r,e))}function Pse(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function kse(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ise(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&kse(t,s)),n}return i._value=e,i}function Lse(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&Pse(t,s)),n}return i._value=e,i}function Dse(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=av(t);return this.tween(n,(r.local?Ise:Lse)(r,e))}function Rse(t,e){return function(){wS(this,t).delay=+e.apply(this,arguments)}}function Bse(t,e){return e=+e,function(){wS(this,t).delay=e}}function zse(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Rse:Bse)(e,t)):yA(this.node(),e).delay}function Ose(t,e){return function(){ru(this,t).duration=+e.apply(this,arguments)}}function Fse(t,e){return e=+e,function(){ru(this,t).duration=e}}function Nse(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Ose:Fse)(e,t)):yA(this.node(),e).duration}function Use(t,e){if(typeof e!="function")throw new Error;return function(){ru(this,t).ease=e}}function Vse(t){var e=this._id;return arguments.length?this.each(Use(e,t)):yA(this.node(),e).ease}function Gse(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ru(this,t).ease=n}}function $se(t){if(typeof t!="function")throw new Error;return this.each(Gse(this._id,t))}function jse(t){typeof t!="function"&&(t=Sz(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=[],p,w=0;w<l;++w)(p=s[w])&&t.call(p,p.__data__,w,s)&&o.push(p);return new lc(r,this._parents,this._name,this._id)}function Hse(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),l=new Array(r),o=0;o<s;++o)for(var p=e[o],w=n[o],C=p.length,P=l[o]=new Array(C),I,U=0;U<C;++U)(I=p[U]||w[U])&&(P[U]=I);for(;o<r;++o)l[o]=e[o];return new lc(l,this._parents,this._name,this._id)}function Wse(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Qse(t,e,n){var r,i,s=Wse(e)?wS:ru;return function(){var l=s(this,t),o=l.on;o!==r&&(i=(r=o).copy()).on(e,n),l.on=i}}function qse(t,e){var n=this._id;return arguments.length<2?yA(this.node(),n).on.on(t):this.each(Qse(n,t,e))}function Zse(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Yse(){return this.on("end.remove",Zse(this._id))}function Xse(t){var e=this._name,n=this._id;typeof t!="function"&&(t=gS(t));for(var r=this._groups,i=r.length,s=new Array(i),l=0;l<i;++l)for(var o=r[l],p=o.length,w=s[l]=new Array(p),C,P,I=0;I<p;++I)(C=o[I])&&(P=t.call(C,C.__data__,I,o))&&("__data__"in C&&(P.__data__=C.__data__),w[I]=P,uv(w[I],e,n,I,w,yA(C,n)));return new lc(s,this._parents,e,n)}function Kse(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Tz(t));for(var r=this._groups,i=r.length,s=[],l=[],o=0;o<i;++o)for(var p=r[o],w=p.length,C,P=0;P<w;++P)if(C=p[P]){for(var I=t.call(C,C.__data__,P,p),U,W=yA(C,n),H=0,ie=I.length;H<ie;++H)(U=I[H])&&uv(U,e,n,H,I,W);s.push(I),l.push(C)}return new lc(s,l,e,n)}var Jse=Dm.prototype.constructor;function eoe(){return new Jse(this._groups,this._parents)}function toe(t,e){var n,r,i;return function(){var s=vd(this,t),l=(this.style.removeProperty(t),vd(this,t));return s===l?null:s===n&&l===r?i:i=e(n=s,r=l)}}function tO(t){return function(){this.style.removeProperty(t)}}function noe(t,e,n){var r,i=n+"",s;return function(){var l=vd(this,t);return l===i?null:l===r?s:s=e(r=l,n)}}function roe(t,e,n){var r,i,s;return function(){var l=vd(this,t),o=n(this),p=o+"";return o==null&&(p=o=(this.style.removeProperty(t),vd(this,t))),l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o))}}function ioe(t,e){var n,r,i,s="style."+e,l="end."+s,o;return function(){var p=ru(this,t),w=p.on,C=p.value[s]==null?o||(o=tO(e)):void 0;(w!==n||i!==C)&&(r=(n=w).copy()).on(l,i=C),p.on=r}}function soe(t,e,n){var r=(t+="")=="transform"?lse:eO;return e==null?this.styleTween(t,toe(t,r)).on("end.style."+t,tO(t)):typeof e=="function"?this.styleTween(t,roe(t,r,bS(this,"style."+t,e))).each(ioe(this._id,t)):this.styleTween(t,noe(t,r,e),n).on("end.style."+t,null)}function ooe(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function aoe(t,e,n){var r,i;function s(){var l=e.apply(this,arguments);return l!==i&&(r=(i=l)&&ooe(t,l,n)),r}return s._value=e,s}function loe(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,aoe(t,e,n??""))}function Aoe(t){return function(){this.textContent=t}}function uoe(t){return function(){var e=t(this);this.textContent=e??""}}function coe(t){return this.tween("text",typeof t=="function"?uoe(bS(this,"text",t)):Aoe(t==null?"":t+""))}function hoe(t){return function(e){this.textContent=t.call(this,e)}}function foe(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&hoe(i)),e}return r._value=t,r}function doe(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,foe(t))}function poe(){for(var t=this._name,e=this._id,n=nO(),r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],o=l.length,p,w=0;w<o;++w)if(p=l[w]){var C=yA(p,e);uv(p,t,n,w,l,{time:C.time+C.delay+C.duration,delay:0,duration:C.duration,ease:C.ease})}return new lc(r,this._parents,t,n)}function goe(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,l){var o={value:l},p={value:function(){--i===0&&s()}};n.each(function(){var w=ru(this,r),C=w.on;C!==t&&(e=(t=C).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(p)),w.on=e}),i===0&&s()})}var moe=0;function lc(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function nO(){return++moe}var Ru=Dm.prototype;lc.prototype={constructor:lc,select:Xse,selectAll:Kse,selectChild:Ru.selectChild,selectChildren:Ru.selectChildren,filter:jse,merge:Hse,selection:eoe,transition:poe,call:Ru.call,nodes:Ru.nodes,node:Ru.node,size:Ru.size,empty:Ru.empty,each:Ru.each,on:qse,attr:Mse,attrTween:Dse,style:soe,styleTween:loe,text:coe,textTween:doe,remove:Yse,tween:xse,delay:zse,duration:Nse,ease:Vse,easeVarying:$se,end:goe,[Symbol.iterator]:Ru[Symbol.iterator]};function yoe(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var _oe={time:null,delay:0,duration:250,ease:yoe};function voe(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function xoe(t){var e,n;t instanceof lc?(e=t._id,t=t._name):(e=nO(),(n=_oe).time=xS(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],o=l.length,p,w=0;w<o;++w)(p=l[w])&&uv(p,t,e,w,l,n||voe(p,e));return new lc(r,this._parents,t,e)}Dm.prototype.interrupt=yse;Dm.prototype.transition=xoe;const X3=Math.PI,K3=2*X3,Qh=1e-6,woe=K3-Qh;function rO(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function boe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return rO;const n=10**e;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let Eoe=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?rO:boe(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,s,l){this._append`C${+e},${+n},${+r},${+i},${this._x1=+s},${this._y1=+l}`}arcTo(e,n,r,i,s){if(e=+e,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let l=this._x1,o=this._y1,p=r-e,w=i-n,C=l-e,P=o-n,I=C*C+P*P;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(I>Qh)if(!(Math.abs(P*p-w*C)>Qh)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let U=r-l,W=i-o,H=p*p+w*w,ie=U*U+W*W,X=Math.sqrt(H),ee=Math.sqrt(I),se=s*Math.tan((X3-Math.acos((H+I-ie)/(2*X*ee)))/2),fe=se/ee,me=se/X;Math.abs(fe-1)>Qh&&this._append`L${e+fe*C},${n+fe*P}`,this._append`A${s},${s},0,0,${+(P*U>C*W)},${this._x1=e+me*p},${this._y1=n+me*w}`}}arc(e,n,r,i,s,l){if(e=+e,n=+n,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),p=r*Math.sin(i),w=e+o,C=n+p,P=1^l,I=l?i-s:s-i;this._x1===null?this._append`M${w},${C}`:(Math.abs(this._x1-w)>Qh||Math.abs(this._y1-C)>Qh)&&this._append`L${w},${C}`,r&&(I<0&&(I=I%K3+K3),I>woe?this._append`A${r},${r},0,1,${P},${e-o},${n-p}A${r},${r},0,1,${P},${this._x1=w},${this._y1=C}`:I>Qh&&this._append`A${r},${r},0,${+(I>=X3)},${P},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};const Ku=11102230246251565e-32,no=134217729,Toe=(3+8*Ku)*Ku;function Bw(t,e,n,r,i){let s,l,o,p,w=e[0],C=r[0],P=0,I=0;C>w==C>-w?(s=w,w=e[++P]):(s=C,C=r[++I]);let U=0;if(P<t&&I<n)for(C>w==C>-w?(l=w+s,o=s-(l-w),w=e[++P]):(l=C+s,o=s-(l-C),C=r[++I]),s=l,o!==0&&(i[U++]=o);P<t&&I<n;)C>w==C>-w?(l=s+w,p=l-s,o=s-(l-p)+(w-p),w=e[++P]):(l=s+C,p=l-s,o=s-(l-p)+(C-p),C=r[++I]),s=l,o!==0&&(i[U++]=o);for(;P<t;)l=s+w,p=l-s,o=s-(l-p)+(w-p),w=e[++P],s=l,o!==0&&(i[U++]=o);for(;I<n;)l=s+C,p=l-s,o=s-(l-p)+(C-p),C=r[++I],s=l,o!==0&&(i[U++]=o);return(s!==0||U===0)&&(i[U++]=s),U}function Soe(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}function Bm(t){return new Float64Array(t)}const Coe=(3+16*Ku)*Ku,Moe=(2+12*Ku)*Ku,Poe=(9+64*Ku)*Ku*Ku,h0=Bm(4),Qk=Bm(8),qk=Bm(12),Zk=Bm(16),ko=Bm(4);function koe(t,e,n,r,i,s,l){let o,p,w,C,P,I,U,W,H,ie,X,ee,se,fe,me,Se,He,Qe;const Ke=t-i,rt=n-i,Ue=e-s,it=r-s;fe=Ke*it,I=no*Ke,U=I-(I-Ke),W=Ke-U,I=no*it,H=I-(I-it),ie=it-H,me=W*ie-(fe-U*H-W*H-U*ie),Se=Ue*rt,I=no*Ue,U=I-(I-Ue),W=Ue-U,I=no*rt,H=I-(I-rt),ie=rt-H,He=W*ie-(Se-U*H-W*H-U*ie),X=me-He,P=me-X,h0[0]=me-(X+P)+(P-He),ee=fe+X,P=ee-fe,se=fe-(ee-P)+(X-P),X=se-Se,P=se-X,h0[1]=se-(X+P)+(P-Se),Qe=ee+X,P=Qe-ee,h0[2]=ee-(Qe-P)+(X-P),h0[3]=Qe;let Ze=Soe(4,h0),yt=Moe*l;if(Ze>=yt||-Ze>=yt||(P=t-Ke,o=t-(Ke+P)+(P-i),P=n-rt,w=n-(rt+P)+(P-i),P=e-Ue,p=e-(Ue+P)+(P-s),P=r-it,C=r-(it+P)+(P-s),o===0&&p===0&&w===0&&C===0)||(yt=Poe*l+Toe*Math.abs(Ze),Ze+=Ke*C+it*o-(Ue*w+rt*p),Ze>=yt||-Ze>=yt))return Ze;fe=o*it,I=no*o,U=I-(I-o),W=o-U,I=no*it,H=I-(I-it),ie=it-H,me=W*ie-(fe-U*H-W*H-U*ie),Se=p*rt,I=no*p,U=I-(I-p),W=p-U,I=no*rt,H=I-(I-rt),ie=rt-H,He=W*ie-(Se-U*H-W*H-U*ie),X=me-He,P=me-X,ko[0]=me-(X+P)+(P-He),ee=fe+X,P=ee-fe,se=fe-(ee-P)+(X-P),X=se-Se,P=se-X,ko[1]=se-(X+P)+(P-Se),Qe=ee+X,P=Qe-ee,ko[2]=ee-(Qe-P)+(X-P),ko[3]=Qe;const Kt=Bw(4,h0,4,ko,Qk);fe=Ke*C,I=no*Ke,U=I-(I-Ke),W=Ke-U,I=no*C,H=I-(I-C),ie=C-H,me=W*ie-(fe-U*H-W*H-U*ie),Se=Ue*w,I=no*Ue,U=I-(I-Ue),W=Ue-U,I=no*w,H=I-(I-w),ie=w-H,He=W*ie-(Se-U*H-W*H-U*ie),X=me-He,P=me-X,ko[0]=me-(X+P)+(P-He),ee=fe+X,P=ee-fe,se=fe-(ee-P)+(X-P),X=se-Se,P=se-X,ko[1]=se-(X+P)+(P-Se),Qe=ee+X,P=Qe-ee,ko[2]=ee-(Qe-P)+(X-P),ko[3]=Qe;const Tt=Bw(Kt,Qk,4,ko,qk);fe=o*C,I=no*o,U=I-(I-o),W=o-U,I=no*C,H=I-(I-C),ie=C-H,me=W*ie-(fe-U*H-W*H-U*ie),Se=p*w,I=no*p,U=I-(I-p),W=p-U,I=no*w,H=I-(I-w),ie=w-H,He=W*ie-(Se-U*H-W*H-U*ie),X=me-He,P=me-X,ko[0]=me-(X+P)+(P-He),ee=fe+X,P=ee-fe,se=fe-(ee-P)+(X-P),X=se-Se,P=se-X,ko[1]=se-(X+P)+(P-Se),Qe=ee+X,P=Qe-ee,ko[2]=ee-(Qe-P)+(X-P),ko[3]=Qe;const dn=Bw(Tt,qk,4,ko,Zk);return Zk[dn-1]}function Ioe(t,e,n,r,i,s){const l=(e-s)*(n-i),o=(t-i)*(r-s),p=l-o,w=Math.abs(l+o);return Math.abs(p)>=Coe*w?p:-koe(t,e,n,r,i,s,w)}function Loe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function J_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function wd(t){return t=J_(Math.abs(t)),t?t[1]:NaN}function Doe(t,e){return function(n,r){for(var i=n.length,s=[],l=0,o=t[0],p=0;i>0&&o>0&&(p+o+1>r&&(o=Math.max(1,r-p)),s.push(n.substring(i-=o,i+o)),!((p+=o+1)>r));)o=t[l=(l+1)%t.length];return s.reverse().join(e)}}function Roe(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Boe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function e2(t){if(!(e=Boe.exec(t)))throw new Error("invalid format: "+t);var e;return new ES({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}e2.prototype=ES.prototype;function ES(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}ES.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function zoe(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var iO;function Ooe(t,e){var n=J_(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(iO=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+J_(t,Math.max(0,e+s-1))[0]}function Yk(t,e){var n=J_(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Xk={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Loe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Yk(t*100,e),r:Yk,s:Ooe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Kk(t){return t}var Jk=Array.prototype.map,eI=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Foe(t){var e=t.grouping===void 0||t.thousands===void 0?Kk:Doe(Jk.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?Kk:Roe(Jk.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"":t.minus+"",p=t.nan===void 0?"NaN":t.nan+"";function w(P){P=e2(P);var I=P.fill,U=P.align,W=P.sign,H=P.symbol,ie=P.zero,X=P.width,ee=P.comma,se=P.precision,fe=P.trim,me=P.type;me==="n"?(ee=!0,me="g"):Xk[me]||(se===void 0&&(se=12),fe=!0,me="g"),(ie||I==="0"&&U==="=")&&(ie=!0,I="0",U="=");var Se=H==="$"?n:H==="#"&&/[boxX]/.test(me)?"0"+me.toLowerCase():"",He=H==="$"?r:/[%p]/.test(me)?l:"",Qe=Xk[me],Ke=/[defgprs%]/.test(me);se=se===void 0?6:/[gprs]/.test(me)?Math.max(1,Math.min(21,se)):Math.max(0,Math.min(20,se));function rt(Ue){var it=Se,Ze=He,yt,Kt,Tt;if(me==="c")Ze=Qe(Ue)+Ze,Ue="";else{Ue=+Ue;var dn=Ue<0||1/Ue<0;if(Ue=isNaN(Ue)?p:Qe(Math.abs(Ue),se),fe&&(Ue=zoe(Ue)),dn&&+Ue==0&&W!=="+"&&(dn=!1),it=(dn?W==="("?W:o:W==="-"||W==="("?"":W)+it,Ze=(me==="s"?eI[8+iO/3]:"")+Ze+(dn&&W==="("?")":""),Ke){for(yt=-1,Kt=Ue.length;++yt<Kt;)if(Tt=Ue.charCodeAt(yt),48>Tt||Tt>57){Ze=(Tt===46?i+Ue.slice(yt+1):Ue.slice(yt))+Ze,Ue=Ue.slice(0,yt);break}}}ee&&!ie&&(Ue=e(Ue,1/0));var _t=it.length+Ue.length+Ze.length,Et=_t<X?new Array(X-_t+1).join(I):"";switch(ee&&ie&&(Ue=e(Et+Ue,Et.length?X-Ze.length:1/0),Et=""),U){case"<":Ue=it+Ue+Ze+Et;break;case"=":Ue=it+Et+Ue+Ze;break;case"^":Ue=Et.slice(0,_t=Et.length>>1)+it+Ue+Ze+Et.slice(_t);break;default:Ue=Et+it+Ue+Ze;break}return s(Ue)}return rt.toString=function(){return P+""},rt}function C(P,I){var U=w((P=e2(P),P.type="f",P)),W=Math.max(-8,Math.min(8,Math.floor(wd(I)/3)))*3,H=Math.pow(10,-W),ie=eI[8+W/3];return function(X){return U(H*X)+ie}}return{format:w,formatPrefix:C}}var q1,yl,sO;Noe({thousands:",",grouping:[3],currency:["$",""]});function Noe(t){return q1=Foe(t),yl=q1.format,sO=q1.formatPrefix,q1}function Uoe(t){return Math.max(0,-wd(Math.abs(t)))}function Voe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(wd(e)/3)))*3-wd(Math.abs(t)))}function Goe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,wd(e)-wd(t))+1}function TS(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function $oe(t){return function(){return t}}function joe(t){return+t}var tI=[0,1];function I0(t){return t}function J3(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:$oe(isNaN(e)?NaN:.5)}function Hoe(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function Woe(t,e,n){var r=t[0],i=t[1],s=e[0],l=e[1];return i<r?(r=J3(i,r),s=n(l,s)):(r=J3(r,i),s=n(s,l)),function(o){return s(r(o))}}function Qoe(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),l=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<r;)i[l]=J3(t[l],t[l+1]),s[l]=n(e[l],e[l+1]);return function(o){var p=xz(t,o,1,r)-1;return s[p](i[p](o))}}function oO(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function qoe(){var t=tI,e=tI,n=vS,r,i,s,l=I0,o,p,w;function C(){var I=Math.min(t.length,e.length);return l!==I0&&(l=Hoe(t[0],t[I-1])),o=I>2?Qoe:Woe,p=w=null,P}function P(I){return I==null||isNaN(I=+I)?s:(p||(p=o(t.map(r),e,n)))(r(l(I)))}return P.invert=function(I){return l(i((w||(w=o(e,t.map(r),tA)))(I)))},P.domain=function(I){return arguments.length?(t=Array.from(I,joe),C()):t.slice()},P.range=function(I){return arguments.length?(e=Array.from(I),C()):e.slice()},P.rangeRound=function(I){return e=Array.from(I),n=sse,C()},P.clamp=function(I){return arguments.length?(l=I?!0:I0,C()):l!==I0},P.interpolate=function(I){return arguments.length?(n=I,C()):n},P.unknown=function(I){return arguments.length?(s=I,P):s},function(I,U){return r=I,i=U,C()}}function aO(){return qoe()(I0,I0)}function Zoe(t,e,n,r){var i=j3(t,e,n),s;switch(r=e2(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=Voe(i,l))&&(r.precision=s),sO(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=Goe(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=Uoe(i))&&(r.precision=s-(r.type==="%")*2);break}}return yl(r)}function lO(t){var e=t.domain;return t.ticks=function(n){var r=e();return Qne(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return Zoe(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,l=r[i],o=r[s],p,w,C=10;for(o<l&&(w=l,l=o,o=w,w=i,i=s,s=w);C-- >0;){if(w=$3(l,o,n),w===p)return r[i]=l,r[s]=o,e(r);if(w>0)l=Math.floor(l/w)*w,o=Math.ceil(o/w)*w;else if(w<0)l=Math.ceil(l*w)/w,o=Math.floor(o*w)/w;else break;p=w}return t},t}function Br(){var t=aO();return t.copy=function(){return oO(t,Br())},TS.apply(t,arguments),lO(t)}function Yoe(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],s=t[r],l;return s<i&&(l=n,n=r,r=l,l=i,i=s,s=l),t[n]=e.floor(i),t[r]=e.ceil(s),t}function _s(){var t=0,e=1,n=1,r=[.5],i=[0,1],s;function l(p){return p!=null&&p<=p?i[xz(r,p,0,n)]:s}function o(){var p=-1;for(r=new Array(n);++p<n;)r[p]=((p+1)*e-(p-n)*t)/(n+1);return l}return l.domain=function(p){return arguments.length?([t,e]=p,t=+t,e=+e,o()):[t,e]},l.range=function(p){return arguments.length?(n=(i=Array.from(p)).length-1,o()):i.slice()},l.invertExtent=function(p){var w=i.indexOf(p);return w<0?[NaN,NaN]:w<1?[t,r[0]]:w>=n?[r[n-1],e]:[r[w-1],r[w]]},l.unknown=function(p){return arguments.length&&(s=p),l},l.thresholds=function(){return r.slice()},l.copy=function(){return _s().domain([t,e]).range(i).unknown(s)},TS.apply(lO(l),arguments)}const zw=new Date,Ow=new Date;function ss(t,e,n,r){function i(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(t(s=new Date(+s)),s),i.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),i.round=s=>{const l=i(s),o=i.ceil(s);return s-l<o-s?l:o},i.offset=(s,l)=>(e(s=new Date(+s),l==null?1:Math.floor(l)),s),i.range=(s,l,o)=>{const p=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<l)||!(o>0))return p;let w;do p.push(w=new Date(+s)),e(s,o),t(s);while(w<s&&s<l);return p},i.filter=s=>ss(l=>{if(l>=l)for(;t(l),!s(l);)l.setTime(l-1)},(l,o)=>{if(l>=l)if(o<0)for(;++o<=0;)for(;e(l,-1),!s(l););else for(;--o>=0;)for(;e(l,1),!s(l););}),n&&(i.count=(s,l)=>(zw.setTime(+s),Ow.setTime(+l),t(zw),t(Ow),Math.floor(n(zw,Ow))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?l=>r(l)%s===0:l=>i.count(0,l)%s===0):i)),i}const t2=ss(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);t2.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?ss(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):t2);t2.range;const ju=1e3,_l=ju*60,Hu=_l*60,Ac=Hu*24,SS=Ac*7,nI=Ac*30,Fw=Ac*365,L0=ss(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*ju)},(t,e)=>(e-t)/ju,t=>t.getUTCSeconds());L0.range;const CS=ss(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*ju)},(t,e)=>{t.setTime(+t+e*_l)},(t,e)=>(e-t)/_l,t=>t.getMinutes());CS.range;const Xoe=ss(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*_l)},(t,e)=>(e-t)/_l,t=>t.getUTCMinutes());Xoe.range;const MS=ss(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*ju-t.getMinutes()*_l)},(t,e)=>{t.setTime(+t+e*Hu)},(t,e)=>(e-t)/Hu,t=>t.getHours());MS.range;const Koe=ss(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Hu)},(t,e)=>(e-t)/Hu,t=>t.getUTCHours());Koe.range;const zm=ss(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*_l)/Ac,t=>t.getDate()-1);zm.range;const PS=ss(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Ac,t=>t.getUTCDate()-1);PS.range;const Joe=ss(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Ac,t=>Math.floor(t/Ac));Joe.range;function Nf(t){return ss(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*_l)/SS)}const cv=Nf(0),n2=Nf(1),eae=Nf(2),tae=Nf(3),bd=Nf(4),nae=Nf(5),rae=Nf(6);cv.range;n2.range;eae.range;tae.range;bd.range;nae.range;rae.range;function Uf(t){return ss(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/SS)}const AO=Uf(0),r2=Uf(1),iae=Uf(2),sae=Uf(3),Ed=Uf(4),oae=Uf(5),aae=Uf(6);AO.range;r2.range;iae.range;sae.range;Ed.range;oae.range;aae.range;const kS=ss(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());kS.range;const lae=ss(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());lae.range;const uc=ss(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());uc.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:ss(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});uc.range;const wf=ss(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());wf.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:ss(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});wf.range;function Aae(t,e,n,r,i,s){const l=[[L0,1,ju],[L0,5,5*ju],[L0,15,15*ju],[L0,30,30*ju],[s,1,_l],[s,5,5*_l],[s,15,15*_l],[s,30,30*_l],[i,1,Hu],[i,3,3*Hu],[i,6,6*Hu],[i,12,12*Hu],[r,1,Ac],[r,2,2*Ac],[n,1,SS],[e,1,nI],[e,3,3*nI],[t,1,Fw]];function o(w,C,P){const I=C<w;I&&([w,C]=[C,w]);const U=P&&typeof P.range=="function"?P:p(w,C,P),W=U?U.range(w,+C+1):[];return I?W.reverse():W}function p(w,C,P){const I=Math.abs(C-w)/P,U=pS(([,,ie])=>ie).right(l,I);if(U===l.length)return t.every(j3(w/Fw,C/Fw,P));if(U===0)return t2.every(Math.max(j3(w,C,P),1));const[W,H]=l[I/l[U-1][2]<l[U][2]/I?U-1:U];return W.every(H)}return[o,p]}const[uae,cae]=Aae(uc,kS,cv,zm,MS,CS);function Nw(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Uw(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Ip(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function hae(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,s=t.days,l=t.shortDays,o=t.months,p=t.shortMonths,w=Lp(i),C=Dp(i),P=Lp(s),I=Dp(s),U=Lp(l),W=Dp(l),H=Lp(o),ie=Dp(o),X=Lp(p),ee=Dp(p),se={a:dn,A:_t,b:Et,B:Jt,c:null,d:lI,e:lI,f:Bae,g:Hae,G:Qae,H:Lae,I:Dae,j:Rae,L:uO,m:zae,M:Oae,p:In,q:Tn,Q:cI,s:hI,S:Fae,u:Nae,U:Uae,V:Vae,w:Gae,W:$ae,x:null,X:null,y:jae,Y:Wae,Z:qae,"%":uI},fe={a:Pr,A:tr,b:or,B:hr,c:null,d:AI,e:AI,f:Kae,g:lle,G:ule,H:Zae,I:Yae,j:Xae,L:hO,m:Jae,M:ele,p:Vn,q:Tr,Q:cI,s:hI,S:tle,u:nle,U:rle,V:ile,w:sle,W:ole,x:null,X:null,y:ale,Y:Ale,Z:cle,"%":uI},me={a:rt,A:Ue,b:it,B:Ze,c:yt,d:oI,e:oI,f:Mae,g:sI,G:iI,H:aI,I:aI,j:Eae,L:Cae,m:bae,M:Tae,p:Ke,q:wae,Q:kae,s:Iae,S:Sae,u:mae,U:yae,V:_ae,w:gae,W:vae,x:Kt,X:Tt,y:sI,Y:iI,Z:xae,"%":Pae};se.x=Se(n,se),se.X=Se(r,se),se.c=Se(e,se),fe.x=Se(n,fe),fe.X=Se(r,fe),fe.c=Se(e,fe);function Se(wt,rn){return function(Mn){var xt=[],nr=-1,Wn=0,vr=wt.length,lr,rr,ti;for(Mn instanceof Date||(Mn=new Date(+Mn));++nr<vr;)wt.charCodeAt(nr)===37&&(xt.push(wt.slice(Wn,nr)),(rr=rI[lr=wt.charAt(++nr)])!=null?lr=wt.charAt(++nr):rr=lr==="e"?" ":"0",(ti=rn[lr])&&(lr=ti(Mn,rr)),xt.push(lr),Wn=nr+1);return xt.push(wt.slice(Wn,nr)),xt.join("")}}function He(wt,rn){return function(Mn){var xt=Ip(1900,void 0,1),nr=Qe(xt,wt,Mn+="",0),Wn,vr;if(nr!=Mn.length)return null;if("Q"in xt)return new Date(xt.Q);if("s"in xt)return new Date(xt.s*1e3+("L"in xt?xt.L:0));if(rn&&!("Z"in xt)&&(xt.Z=0),"p"in xt&&(xt.H=xt.H%12+xt.p*12),xt.m===void 0&&(xt.m="q"in xt?xt.q:0),"V"in xt){if(xt.V<1||xt.V>53)return null;"w"in xt||(xt.w=1),"Z"in xt?(Wn=Uw(Ip(xt.y,0,1)),vr=Wn.getUTCDay(),Wn=vr>4||vr===0?r2.ceil(Wn):r2(Wn),Wn=PS.offset(Wn,(xt.V-1)*7),xt.y=Wn.getUTCFullYear(),xt.m=Wn.getUTCMonth(),xt.d=Wn.getUTCDate()+(xt.w+6)%7):(Wn=Nw(Ip(xt.y,0,1)),vr=Wn.getDay(),Wn=vr>4||vr===0?n2.ceil(Wn):n2(Wn),Wn=zm.offset(Wn,(xt.V-1)*7),xt.y=Wn.getFullYear(),xt.m=Wn.getMonth(),xt.d=Wn.getDate()+(xt.w+6)%7)}else("W"in xt||"U"in xt)&&("w"in xt||(xt.w="u"in xt?xt.u%7:"W"in xt?1:0),vr="Z"in xt?Uw(Ip(xt.y,0,1)).getUTCDay():Nw(Ip(xt.y,0,1)).getDay(),xt.m=0,xt.d="W"in xt?(xt.w+6)%7+xt.W*7-(vr+5)%7:xt.w+xt.U*7-(vr+6)%7);return"Z"in xt?(xt.H+=xt.Z/100|0,xt.M+=xt.Z%100,Uw(xt)):Nw(xt)}}function Qe(wt,rn,Mn,xt){for(var nr=0,Wn=rn.length,vr=Mn.length,lr,rr;nr<Wn;){if(xt>=vr)return-1;if(lr=rn.charCodeAt(nr++),lr===37){if(lr=rn.charAt(nr++),rr=me[lr in rI?rn.charAt(nr++):lr],!rr||(xt=rr(wt,Mn,xt))<0)return-1}else if(lr!=Mn.charCodeAt(xt++))return-1}return xt}function Ke(wt,rn,Mn){var xt=w.exec(rn.slice(Mn));return xt?(wt.p=C.get(xt[0].toLowerCase()),Mn+xt[0].length):-1}function rt(wt,rn,Mn){var xt=U.exec(rn.slice(Mn));return xt?(wt.w=W.get(xt[0].toLowerCase()),Mn+xt[0].length):-1}function Ue(wt,rn,Mn){var xt=P.exec(rn.slice(Mn));return xt?(wt.w=I.get(xt[0].toLowerCase()),Mn+xt[0].length):-1}function it(wt,rn,Mn){var xt=X.exec(rn.slice(Mn));return xt?(wt.m=ee.get(xt[0].toLowerCase()),Mn+xt[0].length):-1}function Ze(wt,rn,Mn){var xt=H.exec(rn.slice(Mn));return xt?(wt.m=ie.get(xt[0].toLowerCase()),Mn+xt[0].length):-1}function yt(wt,rn,Mn){return Qe(wt,e,rn,Mn)}function Kt(wt,rn,Mn){return Qe(wt,n,rn,Mn)}function Tt(wt,rn,Mn){return Qe(wt,r,rn,Mn)}function dn(wt){return l[wt.getDay()]}function _t(wt){return s[wt.getDay()]}function Et(wt){return p[wt.getMonth()]}function Jt(wt){return o[wt.getMonth()]}function In(wt){return i[+(wt.getHours()>=12)]}function Tn(wt){return 1+~~(wt.getMonth()/3)}function Pr(wt){return l[wt.getUTCDay()]}function tr(wt){return s[wt.getUTCDay()]}function or(wt){return p[wt.getUTCMonth()]}function hr(wt){return o[wt.getUTCMonth()]}function Vn(wt){return i[+(wt.getUTCHours()>=12)]}function Tr(wt){return 1+~~(wt.getUTCMonth()/3)}return{format:function(wt){var rn=Se(wt+="",se);return rn.toString=function(){return wt},rn},parse:function(wt){var rn=He(wt+="",!1);return rn.toString=function(){return wt},rn},utcFormat:function(wt){var rn=Se(wt+="",fe);return rn.toString=function(){return wt},rn},utcParse:function(wt){var rn=He(wt+="",!0);return rn.toString=function(){return wt},rn}}}var rI={"-":"",_:" ",0:"0"},ws=/^\s*\d+/,fae=/^%/,dae=/[\\^$*+?|[\]().{}]/g;function Mr(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(e)+i:i)}function pae(t){return t.replace(dae,"\\$&")}function Lp(t){return new RegExp("^(?:"+t.map(pae).join("|")+")","i")}function Dp(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function gae(t,e,n){var r=ws.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function mae(t,e,n){var r=ws.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function yae(t,e,n){var r=ws.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function _ae(t,e,n){var r=ws.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function vae(t,e,n){var r=ws.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function iI(t,e,n){var r=ws.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function sI(t,e,n){var r=ws.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function xae(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function wae(t,e,n){var r=ws.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function bae(t,e,n){var r=ws.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function oI(t,e,n){var r=ws.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Eae(t,e,n){var r=ws.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function aI(t,e,n){var r=ws.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Tae(t,e,n){var r=ws.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Sae(t,e,n){var r=ws.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Cae(t,e,n){var r=ws.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Mae(t,e,n){var r=ws.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Pae(t,e,n){var r=fae.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function kae(t,e,n){var r=ws.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Iae(t,e,n){var r=ws.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function lI(t,e){return Mr(t.getDate(),e,2)}function Lae(t,e){return Mr(t.getHours(),e,2)}function Dae(t,e){return Mr(t.getHours()%12||12,e,2)}function Rae(t,e){return Mr(1+zm.count(uc(t),t),e,3)}function uO(t,e){return Mr(t.getMilliseconds(),e,3)}function Bae(t,e){return uO(t,e)+"000"}function zae(t,e){return Mr(t.getMonth()+1,e,2)}function Oae(t,e){return Mr(t.getMinutes(),e,2)}function Fae(t,e){return Mr(t.getSeconds(),e,2)}function Nae(t){var e=t.getDay();return e===0?7:e}function Uae(t,e){return Mr(cv.count(uc(t)-1,t),e,2)}function cO(t){var e=t.getDay();return e>=4||e===0?bd(t):bd.ceil(t)}function Vae(t,e){return t=cO(t),Mr(bd.count(uc(t),t)+(uc(t).getDay()===4),e,2)}function Gae(t){return t.getDay()}function $ae(t,e){return Mr(n2.count(uc(t)-1,t),e,2)}function jae(t,e){return Mr(t.getFullYear()%100,e,2)}function Hae(t,e){return t=cO(t),Mr(t.getFullYear()%100,e,2)}function Wae(t,e){return Mr(t.getFullYear()%1e4,e,4)}function Qae(t,e){var n=t.getDay();return t=n>=4||n===0?bd(t):bd.ceil(t),Mr(t.getFullYear()%1e4,e,4)}function qae(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Mr(e/60|0,"0",2)+Mr(e%60,"0",2)}function AI(t,e){return Mr(t.getUTCDate(),e,2)}function Zae(t,e){return Mr(t.getUTCHours(),e,2)}function Yae(t,e){return Mr(t.getUTCHours()%12||12,e,2)}function Xae(t,e){return Mr(1+PS.count(wf(t),t),e,3)}function hO(t,e){return Mr(t.getUTCMilliseconds(),e,3)}function Kae(t,e){return hO(t,e)+"000"}function Jae(t,e){return Mr(t.getUTCMonth()+1,e,2)}function ele(t,e){return Mr(t.getUTCMinutes(),e,2)}function tle(t,e){return Mr(t.getUTCSeconds(),e,2)}function nle(t){var e=t.getUTCDay();return e===0?7:e}function rle(t,e){return Mr(AO.count(wf(t)-1,t),e,2)}function fO(t){var e=t.getUTCDay();return e>=4||e===0?Ed(t):Ed.ceil(t)}function ile(t,e){return t=fO(t),Mr(Ed.count(wf(t),t)+(wf(t).getUTCDay()===4),e,2)}function sle(t){return t.getUTCDay()}function ole(t,e){return Mr(r2.count(wf(t)-1,t),e,2)}function ale(t,e){return Mr(t.getUTCFullYear()%100,e,2)}function lle(t,e){return t=fO(t),Mr(t.getUTCFullYear()%100,e,2)}function Ale(t,e){return Mr(t.getUTCFullYear()%1e4,e,4)}function ule(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Ed(t):Ed.ceil(t),Mr(t.getUTCFullYear()%1e4,e,4)}function cle(){return"+0000"}function uI(){return"%"}function cI(t){return+t}function hI(t){return Math.floor(+t/1e3)}var f0,dO;hle({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function hle(t){return f0=hae(t),dO=f0.format,f0.parse,f0.utcFormat,f0.utcParse,f0}function fle(t){return new Date(t)}function dle(t){return t instanceof Date?+t:+new Date(+t)}function pO(t,e,n,r,i,s,l,o,p,w){var C=aO(),P=C.invert,I=C.domain,U=w(".%L"),W=w(":%S"),H=w("%I:%M"),ie=w("%I %p"),X=w("%a %d"),ee=w("%b %d"),se=w("%B"),fe=w("%Y");function me(Se){return(p(Se)<Se?U:o(Se)<Se?W:l(Se)<Se?H:s(Se)<Se?ie:r(Se)<Se?i(Se)<Se?X:ee:n(Se)<Se?se:fe)(Se)}return C.invert=function(Se){return new Date(P(Se))},C.domain=function(Se){return arguments.length?I(Array.from(Se,dle)):I().map(fle)},C.ticks=function(Se){var He=I();return t(He[0],He[He.length-1],Se??10)},C.tickFormat=function(Se,He){return He==null?me:w(He)},C.nice=function(Se){var He=I();return(!Se||typeof Se.range!="function")&&(Se=e(He[0],He[He.length-1],Se??10)),Se?I(Yoe(He,Se)):C},C.copy=function(){return oO(C,pO(t,e,n,r,i,s,l,o,p,w))},C}function ple(){return TS.apply(pO(uae,cae,uc,kS,cv,zm,MS,CS,L0,dO).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Vd(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const Gd=t=>Wz(t[t.length-1]);var gle=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Vd);const mle=Gd(gle);var yle=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Vd);const _le=Gd(yle);var vle=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Vd);const xle=Gd(vle);var wle=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Vd);const ble=Gd(wle);var Ele=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Vd);const fI=Gd(Ele);var Tle=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Vd);const dI=Gd(Tle);function ta(t){return function(){return t}}const pI=Math.abs,ro=Math.atan2,Nh=Math.cos,Sle=Math.max,Vw=Math.min,NA=Math.sin,D0=Math.sqrt,oo=1e-12,Yg=Math.PI,i2=Yg/2,Cle=2*Yg;function Mle(t){return t>1?0:t<-1?Yg:Math.acos(t)}function gI(t){return t>=1?i2:t<=-1?-i2:Math.asin(t)}function gO(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Eoe(e)}function Ple(t){return t.innerRadius}function kle(t){return t.outerRadius}function Ile(t){return t.startAngle}function Lle(t){return t.endAngle}function Dle(t){return t&&t.padAngle}function Rle(t,e,n,r,i,s,l,o){var p=n-t,w=r-e,C=l-i,P=o-s,I=P*p-C*w;if(!(I*I<oo))return I=(C*(e-s)-P*(t-i))/I,[t+I*p,e+I*w]}function Z1(t,e,n,r,i,s,l){var o=t-n,p=e-r,w=(l?s:-s)/D0(o*o+p*p),C=w*p,P=-w*o,I=t+C,U=e+P,W=n+C,H=r+P,ie=(I+W)/2,X=(U+H)/2,ee=W-I,se=H-U,fe=ee*ee+se*se,me=i-s,Se=I*H-W*U,He=(se<0?-1:1)*D0(Sle(0,me*me*fe-Se*Se)),Qe=(Se*se-ee*He)/fe,Ke=(-Se*ee-se*He)/fe,rt=(Se*se+ee*He)/fe,Ue=(-Se*ee+se*He)/fe,it=Qe-ie,Ze=Ke-X,yt=rt-ie,Kt=Ue-X;return it*it+Ze*Ze>yt*yt+Kt*Kt&&(Qe=rt,Ke=Ue),{cx:Qe,cy:Ke,x01:-C,y01:-P,x11:Qe*(i/me-1),y11:Ke*(i/me-1)}}function mI(){var t=Ple,e=kle,n=ta(0),r=null,i=Ile,s=Lle,l=Dle,o=null,p=gO(w);function w(){var C,P,I=+t.apply(this,arguments),U=+e.apply(this,arguments),W=i.apply(this,arguments)-i2,H=s.apply(this,arguments)-i2,ie=pI(H-W),X=H>W;if(o||(o=C=p()),U<I&&(P=U,U=I,I=P),!(U>oo))o.moveTo(0,0);else if(ie>Cle-oo)o.moveTo(U*Nh(W),U*NA(W)),o.arc(0,0,U,W,H,!X),I>oo&&(o.moveTo(I*Nh(H),I*NA(H)),o.arc(0,0,I,H,W,X));else{var ee=W,se=H,fe=W,me=H,Se=ie,He=ie,Qe=l.apply(this,arguments)/2,Ke=Qe>oo&&(r?+r.apply(this,arguments):D0(I*I+U*U)),rt=Vw(pI(U-I)/2,+n.apply(this,arguments)),Ue=rt,it=rt,Ze,yt;if(Ke>oo){var Kt=gI(Ke/I*NA(Qe)),Tt=gI(Ke/U*NA(Qe));(Se-=Kt*2)>oo?(Kt*=X?1:-1,fe+=Kt,me-=Kt):(Se=0,fe=me=(W+H)/2),(He-=Tt*2)>oo?(Tt*=X?1:-1,ee+=Tt,se-=Tt):(He=0,ee=se=(W+H)/2)}var dn=U*Nh(ee),_t=U*NA(ee),Et=I*Nh(me),Jt=I*NA(me);if(rt>oo){var In=U*Nh(se),Tn=U*NA(se),Pr=I*Nh(fe),tr=I*NA(fe),or;if(ie<Yg)if(or=Rle(dn,_t,Pr,tr,In,Tn,Et,Jt)){var hr=dn-or[0],Vn=_t-or[1],Tr=In-or[0],wt=Tn-or[1],rn=1/NA(Mle((hr*Tr+Vn*wt)/(D0(hr*hr+Vn*Vn)*D0(Tr*Tr+wt*wt)))/2),Mn=D0(or[0]*or[0]+or[1]*or[1]);Ue=Vw(rt,(I-Mn)/(rn-1)),it=Vw(rt,(U-Mn)/(rn+1))}else Ue=it=0}He>oo?it>oo?(Ze=Z1(Pr,tr,dn,_t,U,it,X),yt=Z1(In,Tn,Et,Jt,U,it,X),o.moveTo(Ze.cx+Ze.x01,Ze.cy+Ze.y01),it<rt?o.arc(Ze.cx,Ze.cy,it,ro(Ze.y01,Ze.x01),ro(yt.y01,yt.x01),!X):(o.arc(Ze.cx,Ze.cy,it,ro(Ze.y01,Ze.x01),ro(Ze.y11,Ze.x11),!X),o.arc(0,0,U,ro(Ze.cy+Ze.y11,Ze.cx+Ze.x11),ro(yt.cy+yt.y11,yt.cx+yt.x11),!X),o.arc(yt.cx,yt.cy,it,ro(yt.y11,yt.x11),ro(yt.y01,yt.x01),!X))):(o.moveTo(dn,_t),o.arc(0,0,U,ee,se,!X)):o.moveTo(dn,_t),!(I>oo)||!(Se>oo)?o.lineTo(Et,Jt):Ue>oo?(Ze=Z1(Et,Jt,In,Tn,I,-Ue,X),yt=Z1(dn,_t,Pr,tr,I,-Ue,X),o.lineTo(Ze.cx+Ze.x01,Ze.cy+Ze.y01),Ue<rt?o.arc(Ze.cx,Ze.cy,Ue,ro(Ze.y01,Ze.x01),ro(yt.y01,yt.x01),!X):(o.arc(Ze.cx,Ze.cy,Ue,ro(Ze.y01,Ze.x01),ro(Ze.y11,Ze.x11),!X),o.arc(0,0,I,ro(Ze.cy+Ze.y11,Ze.cx+Ze.x11),ro(yt.cy+yt.y11,yt.cx+yt.x11),X),o.arc(yt.cx,yt.cy,Ue,ro(yt.y11,yt.x11),ro(yt.y01,yt.x01),!X))):o.arc(0,0,I,me,fe,X)}if(o.closePath(),C)return o=null,C+""||null}return w.centroid=function(){var C=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,P=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-Yg/2;return[Nh(P)*C,NA(P)*C]},w.innerRadius=function(C){return arguments.length?(t=typeof C=="function"?C:ta(+C),w):t},w.outerRadius=function(C){return arguments.length?(e=typeof C=="function"?C:ta(+C),w):e},w.cornerRadius=function(C){return arguments.length?(n=typeof C=="function"?C:ta(+C),w):n},w.padRadius=function(C){return arguments.length?(r=C==null?null:typeof C=="function"?C:ta(+C),w):r},w.startAngle=function(C){return arguments.length?(i=typeof C=="function"?C:ta(+C),w):i},w.endAngle=function(C){return arguments.length?(s=typeof C=="function"?C:ta(+C),w):s},w.padAngle=function(C){return arguments.length?(l=typeof C=="function"?C:ta(+C),w):l},w.context=function(C){return arguments.length?(o=C??null,w):o},w}function Ble(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function mO(t){this._context=t}mO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function yO(t){return new mO(t)}function zle(t){return t[0]}function Ole(t){return t[1]}function s2(t,e){var n=ta(!0),r=null,i=yO,s=null,l=gO(o);t=typeof t=="function"?t:t===void 0?zle:ta(t),e=typeof e=="function"?e:e===void 0?Ole:ta(e);function o(p){var w,C=(p=Ble(p)).length,P,I=!1,U;for(r==null&&(s=i(U=l())),w=0;w<=C;++w)!(w<C&&n(P=p[w],w,p))===I&&((I=!I)?s.lineStart():s.lineEnd()),I&&s.point(+t(P,w,p),+e(P,w,p));if(U)return s=null,U+""||null}return o.x=function(p){return arguments.length?(t=typeof p=="function"?p:ta(+p),o):t},o.y=function(p){return arguments.length?(e=typeof p=="function"?p:ta(+p),o):e},o.defined=function(p){return arguments.length?(n=typeof p=="function"?p:ta(!!p),o):n},o.curve=function(p){return arguments.length?(i=p,r!=null&&(s=i(r)),o):i},o.context=function(p){return arguments.length?(p==null?r=s=null:s=i(r=p),o):r},o}var Fle=vO(yO);function _O(t){this._curve=t}_O.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};function vO(t){function e(n){return new _O(t(n))}return e._curve=t,e}function Nle(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(n){return arguments.length?e(vO(n)):e()._curve},t}function yI(){return Nle(s2().curve(Fle))}function _I(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function IS(t,e){this._context=t,this._k=(1-e)/6}IS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:_I(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:_I(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(r){return new IS(r,e)}return n.tension=function(r){return t(+r)},n})(0);function Ule(t,e,n){var r=t._x1,i=t._y1,s=t._x2,l=t._y2;if(t._l01_a>oo){var o=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,p=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*o-t._x0*t._l12_2a+t._x2*t._l01_2a)/p,i=(i*o-t._y0*t._l12_2a+t._y2*t._l01_2a)/p}if(t._l23_a>oo){var w=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,C=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*w+t._x1*t._l23_2a-e*t._l12_2a)/C,l=(l*w+t._y1*t._l23_2a-n*t._l12_2a)/C}t._context.bezierCurveTo(r,i,s,l,t._x2,t._y2)}function xO(t,e){this._context=t,this._alpha=e}xO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Ule(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const vI=function t(e){function n(r){return e?new xO(r,e):new IS(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function Jp(t,e,n){this.k=t,this.x=e,this.y=n}Jp.prototype={constructor:Jp,scale:function(t){return t===1?this:new Jp(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Jp(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Jp.prototype;const Vle=new Uint16Array([0,2,1,0,3,2]),Gle=new Float32Array([0,1,0,0,1,0,1,1]);function $le(t,e){if(!e)return jle(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,s=Math.ceil(r/e)+1,l=(i-1)*(s-1)*6,o=new Uint32Array(l),p=new Float32Array(i*s*2),w=new Float64Array(i*s*3);let C=0,P=0;for(let I=0;I<i;I++){const U=I/(i-1);for(let W=0;W<s;W++){const H=W/(s-1),ie=Hle(t,U,H);w[C*3+0]=ie[0],w[C*3+1]=ie[1],w[C*3+2]=ie[2]||0,p[C*2+0]=U,p[C*2+1]=1-H,I>0&&W>0&&(o[P++]=C-s,o[P++]=C-s-1,o[P++]=C-1,o[P++]=C-s,o[P++]=C-1,o[P++]=C),C++}}return{vertexCount:l,positions:w,indices:o,texCoords:p}}function jle(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:Vle,texCoords:Gle}}function Hle(t,e,n){return xl(xl(t[0],t[1],n),xl(t[3],t[2],n),e)}const Wle=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,Qle=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,qle=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(Qle,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive && !picking_uAttribute) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),Zle={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:ur.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class mh extends mA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:Wle,fs:qle,modules:[Bf,zf]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:r=>r.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:r=>r.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:r=>r.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:r}){const i=this.getAttributeManager();if(r.extensionsChanged){var s;const{gl:l}=this.context;(s=this.state.model)===null||s===void 0||s.delete(),this.state.model=this._getModel(l),i.invalidateAll()}if(e.bounds!==n.bounds){const l=this.state.mesh,o=this._createMesh();this.state.model.setVertexCount(o.vertexCount);for(const p in o)l&&l[p]!==o[p]&&i.invalidate(p);this.setState({mesh:o,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,r=e.info;if(!r.color||!n)return r.bitmap=null,r;const{width:i,height:s}=n;r.index=0;const l=Yle(r.color),o=[Math.floor(l[0]*i),Math.floor(l[1]*s)];return r.bitmap={size:{width:i,height:s},uv:l,pixel:o},r}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return xI(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),$le(n,this.context.viewport.resolution)}_getModel(e){return e?new sc(e,{...this.getShaders(),id:this.props.id,geometry:new Yu({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:r}=e,{model:i,coordinateConversion:s,bounds:l,disablePicking:o}=this.state,{image:p,desaturate:w,transparentColor:C,tintColor:P}=this.props;r.pickingActive&&o||p&&i&&i.setUniforms(n).setUniforms({bitmapTexture:p,desaturate:w,transparentColor:C.map(I=>I/255),tintColor:P.slice(0,3).map(I=>I/255),coordinateConversion:s,bounds:l}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:r}=ur;let{_imageCoordinateSystem:i}=this.props;if(i!==r){const{bounds:s}=this.props;if(!xI(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const l=this.context.viewport.resolution?e:n;if(i=i===e?e:n,i===e&&l===n)return{coordinateConversion:-1,bounds:s};if(i===n&&l===e){const o=pA([s[0],s[1]]),p=pA([s[2],s[3]]);return{coordinateConversion:1,bounds:[o[0],o[1],p[0],p[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}oe(mh,"layerName","BitmapLayer");oe(mh,"defaultProps",Zle);function Yle(t){const[e,n,r]=t,i=(r&240)/256,s=(r&15)/16;return[(e+s)/256,(n+i)/256]}function xI(t){return Number.isFinite(t[0])}const Xle=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,Kle=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Jle=1024,eAe=4,wI=()=>{},bI={10241:9987,10240:9729,10242:33071,10243:33071};function tAe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function nAe(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),l=Math.floor(e.height*i);return i===1?{data:e,width:s,height:l}:(t.canvas.height=l,t.canvas.width=s,t.clearRect(0,0,s,l),t.drawImage(e,0,0,e.width,e.height,0,0,s,l),{data:t.canvas,width:s,height:l})}function Xg(t){return t&&(t.id||t.url)}function rAe(t,e,n,r){const i=t.width,s=t.height,l=new ca(t.gl,{width:e,height:n,parameters:r});return sQ(t,l,{targetY:0,width:i,height:s}),t.delete(),l}function EI(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],l=Xg(i);t[l]={...i,x:s,y:n}}}function iAe({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:l}){let o=[];for(let p=0;p<t.length;p++){const w=t[p],C=Xg(w);if(!n[C]){const{height:P,width:I}=w;r+I+e>l&&(EI(n,o,i),r=0,i=s+i+e,s=0,o=[]),o.push({icon:w,xOffset:r}),r=r+I+e,s=Math.max(s,P)}}return o.length>0&&EI(n,o,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:l,canvasHeight:tAe(s+i+e)}}function sAe(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=Nd(t);for(const l of i){s.index++;const o=e(l,s),p=Xg(o);if(!o)throw new Error("Icon is missing.");if(!o.url)throw new Error("Icon url is missing.");!r[p]&&(!n[p]||o.url!==n[p].url)&&(r[p]={...o,source:l,sourceIndex:s.index})}return r}class oAe{constructor(e,{onUpdate:n=wI,onError:r=wI}){oe(this,"gl",void 0),oe(this,"onUpdate",void 0),oe(this,"onError",void 0),oe(this,"_loadOptions",null),oe(this,"_texture",null),oe(this,"_externalTexture",null),oe(this,"_mapping",{}),oe(this,"_textureParameters",null),oe(this,"_pendingCount",0),oe(this,"_autoPacking",!1),oe(this,"_xOffset",0),oe(this,"_yOffset",0),oe(this,"_rowHeight",0),oe(this,"_buffer",eAe),oe(this,"_canvasWidth",Jle),oe(this,"_canvasHeight",0),oe(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Xg(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var l;(l=this._texture)===null||l===void 0||l.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(sAe(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:l,rowHeight:o,canvasHeight:p}=iAe({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=o,this._mapping=i,this._xOffset=s,this._yOffset=l,this._canvasHeight=p,this._texture||(this._texture=new ca(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||bI})),this._texture.height!==this._canvasHeight&&(this._texture=rAe(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||bI)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,M_(r.url,this._loadOptions).then(i=>{const s=Xg(r),l=this._mapping[s],{x:o,y:p,width:w,height:C}=l,{data:P,width:I,height:U}=nAe(n,i,w,C);this._texture.setSubImageData({data:P,x:o+(w-I)/2,y:p+(C-U)/2,width:I,height:U}),l.width=I,l.height=U,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const wO=[0,0,0,255],aAe={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:wO},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class hv extends mA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:Xle,fs:Kle,modules:[Bf,zf]})}initializeState(){this.state={iconManager:new oAe(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:wO},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:l,iconMapping:o,data:p,getIcon:w,textureParameters:C}=n,{iconManager:P}=this.state,I=l||this.internalState.isAsyncPropLoading("iconAtlas");if(P.setProps({loadOptions:n.loadOptions,autoPacking:!I,iconAtlas:l,iconMapping:I?o:null,textureParameters:C}),I?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&P.packIcons(p,w),i.extensionsChanged){var U;const{gl:W}=this.context;(U=this.state.model)===null||U===void 0||U.delete(),this.state.model=this._getModel(W),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:l,alphaCutoff:o}=this.props,{iconManager:p}=this.state,w=p.getTexture();w&&this.state.model.setUniforms(e).setUniforms({iconsTexture:w,iconsTextureDim:[w.width,w.height],sizeUnits:cf[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:l,alphaCutoff:o}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new sc(e,{...this.getShaders(),id:this.props.id,geometry:new Yu({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):sr.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}oe(hv,"defaultProps",aAe);oe(hv,"layerName","IconLayer");const lAe=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,AAe=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,TI=[0,0,0,255],uAe={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:TI},getLineColor:{type:"accessor",value:TI},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class LS extends mA{getShaders(){return super.getShaders({vs:lAe,fs:AAe,modules:[Bf,zf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:l,filled:o,billboard:p,antialiasing:w,lineWidthUnits:C,lineWidthScale:P,lineWidthMinPixels:I,lineWidthMaxPixels:U}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:l?1:0,filled:o,billboard:p,antialiasing:w,radiusUnits:cf[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:cf[C],lineWidthScale:P,lineWidthMinPixels:I,lineWidthMaxPixels:U}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new sc(e,{...this.getShaders(),id:this.props.id,geometry:new Yu({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}oe(LS,"defaultProps",uAe);oe(LS,"layerName","ScatterplotLayer");const bO={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function EO(t,e,n={}){return cAe(t,n)!==e?(fAe(t,n),!0):!1}function cAe(t,e={}){return Math.sign(hAe(t,e))}function hAe(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let l=n,o=r-i;l<r;l+=i)s+=(t[l]-t[o])*(t[l+1]+t[o+1]),o=l;return s/2}function fAe(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,l=Math.floor(s/2);for(let o=0;o<l;++o){const p=n+o*i,w=n+(s-1-o)*i;for(let C=0;C<i;++C){const P=t[p+C];t[p+C]=t[w+C],t[w+C]=P}}}function oA(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function eE(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function Kg(t,e,n,r,i=[]){const s=r+e*n;for(let l=0;l<n;l++)i[l]=t[s+l];return i}function tE(t,e,n,r,i=[]){let s,l;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),l=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),l=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),l=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),l=0;else return null;for(let o=0;o<t.length;o++)i[o]=(l&1)===o?r[l]:s*(e[o]-t[o])+t[o];return i}function Gy(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function TO(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:l=0,endIndex:o=t.length}=e||{},p=(o-l)/n;let w=[];const C=[w],P=Kg(t,0,n,l);let I,U;const W=CO(P,i,s,[]),H=[];oA(w,P);for(let ie=1;ie<p;ie++){for(I=Kg(t,ie,n,l,I),U=Gy(I,W);U;){tE(P,I,U,W,H);const X=Gy(H,W);X&&(tE(P,H,X,W,H),U=X),oA(w,H),eE(P,H),pAe(W,i,U),r&&w.length>n&&(w=[],C.push(w),oA(w,P)),U=Gy(I,W)}oA(w,I),eE(P,I)}return r?C:C[0]}const SI=0,dAe=1;function Y1(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function SO(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:l=!1}=n||{},o=[],p=[{pos:t,types:l?new Array(t.length/r).fill(dAe):null,holes:e||[]}],w=[[],[]];let C=[];for(;p.length;){const{pos:P,types:I,holes:U}=p.shift();gAe(P,r,U[0]||P.length,w),C=CO(w[0],i,s,C);const W=Gy(w[1],C);if(W){let H=CI(P,I,r,0,U[0]||P.length,C,W);const ie={pos:H[0].pos,types:H[0].types,holes:[]},X={pos:H[1].pos,types:H[1].types,holes:[]};p.push(ie,X);for(let ee=0;ee<U.length;ee++)H=CI(P,I,r,U[ee],U[ee+1]||P.length,C,W),H[0]&&(ie.holes.push(ie.pos.length),ie.pos=Y1(ie.pos,H[0].pos),l&&(ie.types=Y1(ie.types,H[0].types))),H[1]&&(X.holes.push(X.pos.length),X.pos=Y1(X.pos,H[1].pos),l&&(X.types=Y1(X.types,H[1].types)))}else{const H={positions:P};l&&(H.edgeTypes=I),U.length&&(H.holeIndices=U),o.push(H)}}return o}function CI(t,e,n,r,i,s,l){const o=(i-r)/n,p=[],w=[],C=[],P=[],I=[];let U,W,H;const ie=Kg(t,o-1,n,r);let X=Math.sign(l&8?ie[1]-s[3]:ie[0]-s[2]),ee=e&&e[o-1],se=0,fe=0;for(let me=0;me<o;me++)U=Kg(t,me,n,r,U),W=Math.sign(l&8?U[1]-s[3]:U[0]-s[2]),H=e&&e[r/n+me],W&&X&&X!==W&&(tE(ie,U,l,s,I),oA(p,I)&&C.push(ee),oA(w,I)&&P.push(ee)),W<=0?(oA(p,U)&&C.push(H),se-=W):C.length&&(C[C.length-1]=SI),W>=0?(oA(w,U)&&P.push(H),fe+=W):P.length&&(P[P.length-1]=SI),eE(ie,U),X=W,ee=H;return[se?{pos:p,types:e&&C}:null,fe?{pos:w,types:e&&P}:null]}function CO(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function pAe(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function gAe(t,e,n,r){let i=1/0,s=-1/0,l=1/0,o=-1/0;for(let p=0;p<n;p+=e){const w=t[p],C=t[p+1];i=w<i?w:i,s=w>s?w:s,l=C<l?C:l,o=C>o?C:o}return r[0][0]=i,r[0][1]=l,r[1][0]=s,r[1][1]=o,r}const mAe=85.051129;function yAe(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},l=t.slice(r,i);MO(l,n,0,i-r);const o=TO(l,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const p of o)PO(p,n);return o}function _Ae(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const l=[],o=[];let p=0,w=0;for(let P=0;P<=e.length;P++){const I=e[P]||t.length,U=w,W=vAe(t,r,p,I);for(let H=W;H<I;H++)l[w++]=t[H];for(let H=p;H<W;H++)l[w++]=t[H];MO(l,r,U,w),xAe(l,r,U,w,n?.maxLatitude),p=I,o[P]=w}o.pop();const C=SO(l,o,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const P of C)PO(P.positions,r);return C}function vAe(t,e,n,r){let i=-1,s=-1;for(let l=n+1;l<r;l+=e){const o=Math.abs(t[l]);o>i&&(i=o,s=l-1)}return s}function xAe(t,e,n,r,i=mAe){const s=t[n],l=t[r-e];if(Math.abs(s-l)>180){const o=Kg(t,0,e,n);o[0]+=Math.round((l-s)/360)*360,oA(t,o),o[1]=Math.sign(o[1])*i,oA(t,o),o[0]=s,oA(t,o)}}function MO(t,e,n,r){let i=t[0],s;for(let l=n;l<r;l+=e){s=t[l];const o=s-i;(o>180||o<-180)&&(s-=Math.round(o/360)*360),t[l]=i=s}}function PO(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}function wAe(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let l=0;l<t.length;l++)for(let o=0;o<e;o++)i[l*e+o]=t[l][o]||0}else i=t;return n?TO(i,{size:e,gridResolution:n}):r?yAe(i,{size:e}):i}const bAe=1,EAe=2,Gw=4;class TAe extends cz{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?wAe(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(MI(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&MI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:l}=n;r.fill(0,s,s+l),i?(r[s]=Gw,r[s+l-2]=Gw):(r[s]+=bAe,r[s+l-2]+=EAe),r[s+l-1]=Gw}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,l=new Array(3);for(let o=i,p=0;p<s;o++,p++)this.getPointOnPath(e,p,l),r[o*3]=l[0],r[o*3+1]=l[1],r[o*3+2]=l[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function MI(t){return Array.isArray(t[0])}const SAe=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,CAe=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,kO=[0,0,0,255],MAe={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:kO},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},$w={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class fv extends mA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:SAe,fs:CAe,modules:[Bf,zf]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:$w,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:$w,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:$w,defaultValue:kO},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new TAe({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:o}=this.state,p=n.data.attributes||{};o.updateGeometry({data:n.data,geometryBuffer:p.getPath,buffers:p,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var l;const{gl:o}=this.context;(l=this.state.model)===null||l===void 0||l.delete(),this.state.model=this._getModel(o),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:l,widthScale:o,widthMinPixels:p,widthMaxPixels:w}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:cf[l],widthScale:o,miterLimit:s,widthMinPixels:p,widthMaxPixels:w}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new sc(e,{...this.getShaders(),id:this.props.id,geometry:new Yu({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}oe(fv,"defaultProps",MAe);oe(fv,"layerName","PathLayer");var DS={exports:{}};DS.exports=dv;DS.exports.default=dv;function dv(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=IO(t,0,i,n,!0),l=[];if(!s||s.next===s.prev)return l;var o,p,w,C,P,I,U;if(r&&(s=DAe(t,e,s,n)),t.length>80*n){o=w=t[0],p=C=t[1];for(var W=n;W<i;W+=n)P=t[W],I=t[W+1],P<o&&(o=P),I<p&&(p=I),P>w&&(w=P),I>C&&(C=I);U=Math.max(w-o,C-p),U=U!==0?32767/U:0}return Jg(s,l,n,o,p,U,0),l}function IO(t,e,n,r,i){var s,l;if(i===iE(t,e,n,r)>0)for(s=e;s<n;s+=r)l=PI(s,t[s],t[s+1],l);else for(s=n-r;s>=e;s-=r)l=PI(s,t[s],t[s+1],l);return l&&pv(l,l.next)&&(tm(l),l=l.next),l}function bf(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(pv(n,n.next)||_i(n.prev,n,n.next)===0)){if(tm(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function Jg(t,e,n,r,i,s,l){if(t){!l&&s&&FAe(t,r,i,s);for(var o=t,p,w;t.prev!==t.next;){if(p=t.prev,w=t.next,s?kAe(t,r,i,s):PAe(t)){e.push(p.i/n|0),e.push(t.i/n|0),e.push(w.i/n|0),tm(t),t=w.next,o=w.next;continue}if(t=w,t===o){l?l===1?(t=IAe(bf(t),e,n),Jg(t,e,n,r,i,s,2)):l===2&&LAe(t,e,n,r,i,s):Jg(bf(t),e,n,r,i,s,1);break}}}}function PAe(t){var e=t.prev,n=t,r=t.next;if(_i(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,l=r.x,o=e.y,p=n.y,w=r.y,C=i<s?i<l?i:l:s<l?s:l,P=o<p?o<w?o:w:p<w?p:w,I=i>s?i>l?i:l:s>l?s:l,U=o>p?o>w?o:w:p>w?p:w,W=r.next;W!==e;){if(W.x>=C&&W.x<=I&&W.y>=P&&W.y<=U&&R0(i,o,s,p,l,w,W.x,W.y)&&_i(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function kAe(t,e,n,r){var i=t.prev,s=t,l=t.next;if(_i(i,s,l)>=0)return!1;for(var o=i.x,p=s.x,w=l.x,C=i.y,P=s.y,I=l.y,U=o<p?o<w?o:w:p<w?p:w,W=C<P?C<I?C:I:P<I?P:I,H=o>p?o>w?o:w:p>w?p:w,ie=C>P?C>I?C:I:P>I?P:I,X=nE(U,W,e,n,r),ee=nE(H,ie,e,n,r),se=t.prevZ,fe=t.nextZ;se&&se.z>=X&&fe&&fe.z<=ee;){if(se.x>=U&&se.x<=H&&se.y>=W&&se.y<=ie&&se!==i&&se!==l&&R0(o,C,p,P,w,I,se.x,se.y)&&_i(se.prev,se,se.next)>=0||(se=se.prevZ,fe.x>=U&&fe.x<=H&&fe.y>=W&&fe.y<=ie&&fe!==i&&fe!==l&&R0(o,C,p,P,w,I,fe.x,fe.y)&&_i(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;se&&se.z>=X;){if(se.x>=U&&se.x<=H&&se.y>=W&&se.y<=ie&&se!==i&&se!==l&&R0(o,C,p,P,w,I,se.x,se.y)&&_i(se.prev,se,se.next)>=0)return!1;se=se.prevZ}for(;fe&&fe.z<=ee;){if(fe.x>=U&&fe.x<=H&&fe.y>=W&&fe.y<=ie&&fe!==i&&fe!==l&&R0(o,C,p,P,w,I,fe.x,fe.y)&&_i(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function IAe(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!pv(i,s)&&LO(i,r,r.next,s)&&em(i,s)&&em(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),tm(r),tm(r.next),r=t=s),r=r.next}while(r!==t);return bf(r)}function LAe(t,e,n,r,i,s){var l=t;do{for(var o=l.next.next;o!==l.prev;){if(l.i!==o.i&&VAe(l,o)){var p=DO(l,o);l=bf(l,l.next),p=bf(p,p.next),Jg(l,e,n,r,i,s,0),Jg(p,e,n,r,i,s,0);return}o=o.next}l=l.next}while(l!==t)}function DAe(t,e,n,r){var i=[],s,l,o,p,w;for(s=0,l=e.length;s<l;s++)o=e[s]*r,p=s<l-1?e[s+1]*r:t.length,w=IO(t,o,p,r,!1),w===w.next&&(w.steiner=!0),i.push(UAe(w));for(i.sort(RAe),s=0;s<i.length;s++)n=BAe(i[s],n);return n}function RAe(t,e){return t.x-e.x}function BAe(t,e){var n=zAe(t,e);if(!n)return e;var r=DO(n,t);return bf(r,r.next),bf(n,n.next)}function zAe(t,e){var n=e,r=t.x,i=t.y,s=-1/0,l;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var o=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=r&&o>s&&(s=o,l=n.x<n.next.x?n:n.next,o===r))return l}n=n.next}while(n!==e);if(!l)return null;var p=l,w=l.x,C=l.y,P=1/0,I;n=l;do r>=n.x&&n.x>=w&&r!==n.x&&R0(i<C?r:s,i,w,C,i<C?s:r,i,n.x,n.y)&&(I=Math.abs(i-n.y)/(r-n.x),em(n,t)&&(I<P||I===P&&(n.x>l.x||n.x===l.x&&OAe(l,n)))&&(l=n,P=I)),n=n.next;while(n!==p);return l}function OAe(t,e){return _i(t.prev,t,e.prev)<0&&_i(e.next,t,t.next)<0}function FAe(t,e,n,r){var i=t;do i.z===0&&(i.z=nE(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,NAe(i)}function NAe(t){var e,n,r,i,s,l,o,p,w=1;do{for(n=t,t=null,s=null,l=0;n;){for(l++,r=n,o=0,e=0;e<w&&(o++,r=r.nextZ,!!r);e++);for(p=w;o>0||p>0&&r;)o!==0&&(p===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,o--):(i=r,r=r.nextZ,p--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,w*=2}while(l>1);return t}function nE(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function UAe(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function R0(t,e,n,r,i,s,l,o){return(i-l)*(e-o)>=(t-l)*(s-o)&&(t-l)*(r-o)>=(n-l)*(e-o)&&(n-l)*(s-o)>=(i-l)*(r-o)}function VAe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!GAe(t,e)&&(em(t,e)&&em(e,t)&&$Ae(t,e)&&(_i(t.prev,t,e.prev)||_i(t,e.prev,e))||pv(t,e)&&_i(t.prev,t,t.next)>0&&_i(e.prev,e,e.next)>0)}function _i(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function pv(t,e){return t.x===e.x&&t.y===e.y}function LO(t,e,n,r){var i=K1(_i(t,e,n)),s=K1(_i(t,e,r)),l=K1(_i(n,r,t)),o=K1(_i(n,r,e));return!!(i!==s&&l!==o||i===0&&X1(t,n,e)||s===0&&X1(t,r,e)||l===0&&X1(n,t,r)||o===0&&X1(n,e,r))}function X1(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function K1(t){return t>0?1:t<0?-1:0}function GAe(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&LO(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function em(t,e){return _i(t.prev,t,t.next)<0?_i(t,e,t.next)>=0&&_i(t,t.prev,e)>=0:_i(t,e,t.prev)<0||_i(t,t.next,e)<0}function $Ae(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function DO(t,e){var n=new rE(t.i,t.x,t.y),r=new rE(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function PI(t,e,n,r){var i=new rE(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function tm(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function rE(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}dv.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,l=Math.abs(iE(t,0,s,n));if(i)for(var o=0,p=e.length;o<p;o++){var w=e[o]*n,C=o<p-1?e[o+1]*n:t.length;l-=Math.abs(iE(t,w,C,n))}var P=0;for(o=0;o<r.length;o+=3){var I=r[o]*n,U=r[o+1]*n,W=r[o+2]*n;P+=Math.abs((t[I]-t[W])*(t[U+1]-t[I+1])-(t[I]-t[U])*(t[W+1]-t[I+1]))}return l===0&&P===0?0:Math.abs((P-l)/l)};function iE(t,e,n,r){for(var i=0,s=e,l=n-r;s<n;s+=r)i+=(t[l]-t[s])*(t[s+1]+t[l+1]),l=s;return i}dv.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var l=0;l<e;l++)n.vertices.push(t[i][s][l]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var jAe=DS.exports;const HAe=z2(jAe),J1=bO.CLOCKWISE,kI=bO.COUNTER_CLOCKWISE,eh={isClosed:!0};function WAe(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function eg(t){return"positions"in t?t.positions:t}function $y(t){return"holeIndices"in t?t.holeIndices:null}function QAe(t){return Array.isArray(t[0])}function qAe(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function ZAe(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function YAe(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function II(t,e,n,r,i){let s=e;const l=n.length;for(let o=0;o<l;o++)for(let p=0;p<r;p++)t[s++]=n[o][p]||0;if(!ZAe(n))for(let o=0;o<r;o++)t[s++]=n[0][o]||0;return eh.start=e,eh.end=s,eh.size=r,EO(t,i,eh),s}function LI(t,e,n,r,i=0,s,l){s=s||n.length;const o=s-i;if(o<=0)return e;let p=e;for(let w=0;w<o;w++)t[p++]=n[i+w];if(!YAe(n,r,i,s))for(let w=0;w<r;w++)t[p++]=n[i+w];return eh.start=e,eh.end=p,eh.size=r,EO(t,l,eh),p}function RO(t,e){WAe(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let l=0;for(let o=0;o<=s.length;o++)l=LI(n,l,i,e,s[o-1],s[o],o===0?J1:kI),r.push(l);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!QAe(t))return LI(n,0,t,e,0,n.length,J1),n;if(!qAe(t)){let i=0;for(const[s,l]of t.entries())i=II(n,i,l,e,s===0?J1:kI),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return II(n,0,t,e,J1),n}function jw(t,e,n){const r=t.length/3;let i=0;for(let s=0;s<r;s++){const l=(s+1)%r;i+=t[s*3+e]*t[l*3+n],i-=t[l*3+e]*t[s*3+n]}return Math.abs(i/2)}function DI(t,e,n,r){const i=t.length/3;for(let s=0;s<i;s++){const l=s*3,o=t[l+0],p=t[l+1],w=t[l+2];t[l+e]=o,t[l+n]=p,t[l+r]=w}}function XAe(t,e,n,r){let i=$y(t);i&&(i=i.map(o=>o/e));let s=eg(t);const l=r&&e===3;if(n){const o=s.length;s=s.slice();const p=[];for(let w=0;w<o;w+=e){p[0]=s[w],p[1]=s[w+1],l&&(p[2]=s[w+2]);const C=n(p);s[w]=C[0],s[w+1]=C[1],l&&(s[w+2]=C[2])}}if(l){const o=jw(s,0,1),p=jw(s,0,2),w=jw(s,1,2);if(!o&&!p&&!w)return[];o>p&&o>w||(p>w?(n||(s=s.slice()),DI(s,0,2,1)):(n||(s=s.slice()),DI(s,2,0,1)))}return HAe(s,i,e)}class KAe extends cz{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=RO(e,this.positionSize);return this.opts.resolution?SO(eg(n),$y(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?_Ae(eg(n),$y(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(RI(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return eg(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&RI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:l,typedArrayManager:o}=this;let p=s.indices;if(!p||!e)return;let w=i;const C=XAe(e,this.positionSize,this.opts.preproject,this.opts.full3d);p=o.allocate(p,i+C.length,{copy:!0});for(let P=0;P<C.length;P++)p[w++]=C[P]+r;l[n+1]=i+C.length,s.indices=p}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const l=eg(e);for(let o=n,p=0;p<r;o++,p++){const w=l[p*s],C=l[p*s+1],P=s>2?l[p*s+2]:0;i[o*3]=w,i[o*3+1]=C,i[o*3+2]=P}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,l=e&&$y(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),l)for(let o=0;o<l.length;o++)s[n+l[o]/i-1]=0;s[n+r-1]=0}}function RI(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const BO=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,JAe=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(BO,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),eue=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(BO,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),tue=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,o2=[0,0,0,255],nue={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:o2},getLineColor:{type:"accessor",value:o2},material:!0},ey={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class gv extends mA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?JAe:eue,fs:tue,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Bf,AX,zf]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===ur.DEFAULT&&(r=ur.LNGLAT);let s;r===ur.LNGLAT&&(i?s=n.projectPosition.bind(n):s=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new KAe({preproject:s,fp64:this.use64bitPositions(),IndexType:!e||qT(e,Jr.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const l=this.getAttributeManager(),o=!0;l.remove(["instancePickingColors"]),l.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:ey,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,transition:ey,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:ey,accessor:"getFillColor",defaultValue:o2,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:ey,accessor:"getLineColor",defaultValue:o2,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(p,{index:w,target:C})=>this.encodePickingColor(p&&p.__source?p.__source.index:w,C),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:l,sideModel:o,polygonTesselator:p}=this.state,w={...e,extruded:!!n,elevationScale:s};o&&(o.setInstanceCount(p.instanceCount-1),o.setUniforms(w),i&&(o.setDrawMode(3),o.setUniforms({isWireframe:!0}).draw()),r&&(o.setDrawMode(6),o.setUniforms({isWireframe:!1}).draw())),l&&(l.setVertexCount(p.vertexCount),l.setUniforms(w).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var o;(o=this.state.models)===null||o===void 0||o.forEach(p=>p.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,l=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:l.getPolygon,buffers:l,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let s,l;if(r){const o=this.getShaders("top");o.defines.NON_INSTANCED_MODEL=1,s=new sc(e,{...o,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(l=new sc(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Yu({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),l.userData.excludeAttributes={indices:!0}),{models:[l,s].filter(Boolean),topModel:s,sideModel:l}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}oe(gv,"defaultProps",nue);oe(gv,"layerName","SolidPolygonLayer");function zO({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,l=t.length;let o=l,p=l;for(let I=0;I<l;I++){const U=e(t[I]);if(o>I&&U>=i&&(o=I),U>=s){p=I;break}}let w=o;const P=p-o!==r.length?t.slice(p):void 0;for(let I=0;I<r.length;I++)t[w++]=r[I];if(P){for(let I=0;I<P.length;I++)t[w++]=P[I];t.length=w}return{startRow:o,endRow:o+r.length}}const OO=[0,0,0,255],rue=[0,0,0,255],iue={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:rue},getLineColor:{type:"accessor",value:OO},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class Vf extends Bn{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&sr.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(s=>zO({data:r,getIndex:l=>l.__source.index,dataRange:s,replace:this._getPaths(s)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:s}=this.props,l=[],o=i==="XY"?2:3,{startRow:p,endRow:w}=e,{iterable:C,objectInfo:P}=Nd(n,p,w);for(const I of C){P.index++;let U=r(I,P);s&&(U=RO(U,o));const{holeIndices:W}=U,H=U.positions||U;if(W)for(let ie=0;ie<=W.length;ie++){const X=H.slice(W[ie-1]||0,W[ie]||H.length);l.push(this.getSubLayerRow({path:X},I,P.index))}else l.push(this.getSubLayerRow({path:H},I,P.index))}return l}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:s,wireframe:l,_normalize:o,_windingOrder:p,elevationScale:w,transitions:C,positionFormat:P}=this.props,{lineWidthUnits:I,lineWidthScale:U,lineWidthMinPixels:W,lineWidthMaxPixels:H,lineJointRounded:ie,lineMiterLimit:X,lineDashJustified:ee}=this.props,{getFillColor:se,getLineColor:fe,getLineWidth:me,getLineDashArray:Se,getElevation:He,getPolygon:Qe,updateTriggers:Ke,material:rt}=this.props,{paths:Ue,pathsDiff:it}=this.state,Ze=this.getSubLayerClass("fill",gv),yt=this.getSubLayerClass("stroke",fv),Kt=this.shouldRenderSubLayer("fill",Ue)&&new Ze({_dataDiff:n,extruded:s,elevationScale:w,filled:i,wireframe:l,_normalize:o,_windingOrder:p,getElevation:He,getFillColor:se,getLineColor:s&&l?fe:OO,material:rt,transitions:C},this.getSubLayerProps({id:"fill",updateTriggers:Ke&&{getPolygon:Ke.getPolygon,getElevation:Ke.getElevation,getFillColor:Ke.getFillColor,lineColors:s&&l,getLineColor:Ke.getLineColor}}),{data:e,positionFormat:P,getPolygon:Qe}),Tt=!s&&r&&this.shouldRenderSubLayer("stroke",Ue)&&new yt({_dataDiff:it&&(()=>it),widthUnits:I,widthScale:U,widthMinPixels:W,widthMaxPixels:H,jointRounded:ie,miterLimit:X,dashJustified:ee,_pathType:"loop",transitions:C&&{getWidth:C.getLineWidth,getColor:C.getLineColor,getPath:C.getPolygon},getColor:this.getSubLayerAccessor(fe),getWidth:this.getSubLayerAccessor(me),getDashArray:this.getSubLayerAccessor(Se)},this.getSubLayerProps({id:"stroke",updateTriggers:Ke&&{getWidth:Ke.getLineWidth,getColor:Ke.getLineColor,getDashArray:Ke.getLineDashArray}}),{data:Ue,positionFormat:P,getPath:dn=>dn.path});return[!s&&Kt,Tt,s&&Kt]}}oe(Vf,"layerName","PolygonLayer");oe(Vf,"defaultProps",iue);function sue(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?oue(t,r,n):null}function oue(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function aue(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let l=0;l<i.length;l++)e(i[l],s),n[r][l*3+0]=s[0],n[r][l*3+1]=s[1],n[r][l*3+2]=s[2]}return n}const lue=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Hw=192/256,BI=[],Aue={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class RS extends hv{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:lue}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&sr.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,l=i?Math.max(r,Hw*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:Hw,outlineBuffer:l,gamma:r,sdf:!!n,outlineColor:s},super.draw(e),n&&i){const{iconManager:o}=this.state;o.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:Hw}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):BI}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):BI}}oe(RS,"defaultProps",Aue);oe(RS,"layerName","MultiIconLayer");const _g=1e20;class uue{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:l="normal",fontStyle:o="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const p=this.size=e+n*4,w=this._createCanvas(p),C=this.ctx=w.getContext("2d",{willReadFrequently:!0});C.font=`${o} ${l} ${e}px ${s}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(p*p),this.gridInner=new Float64Array(p*p),this.f=new Float64Array(p),this.z=new Float64Array(p+1),this.v=new Uint16Array(p)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:l}=this.ctx.measureText(e),o=Math.ceil(r),p=0,w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(l-s))),C=Math.min(this.size-this.buffer,o+Math.ceil(i)),P=w+2*this.buffer,I=C+2*this.buffer,U=Math.max(P*I,0),W=new Uint8ClampedArray(U),H={data:W,width:P,height:I,glyphWidth:w,glyphHeight:C,glyphTop:o,glyphLeft:p,glyphAdvance:n};if(w===0||C===0)return H;const{ctx:ie,buffer:X,gridInner:ee,gridOuter:se}=this;ie.clearRect(X,X,w,C),ie.fillText(e,X,X+o);const fe=ie.getImageData(X,X,w,C);se.fill(_g,0,U),ee.fill(0,0,U);for(let me=0;me<C;me++)for(let Se=0;Se<w;Se++){const He=fe.data[4*(me*w+Se)+3]/255;if(He===0)continue;const Qe=(me+X)*P+Se+X;if(He===1)se[Qe]=0,ee[Qe]=_g;else{const Ke=.5-He;se[Qe]=Ke>0?Ke*Ke:0,ee[Qe]=Ke<0?Ke*Ke:0}}zI(se,0,0,P,I,P,this.f,this.v,this.z),zI(ee,X,X,w,C,P,this.f,this.v,this.z);for(let me=0;me<U;me++){const Se=Math.sqrt(se[me])-Math.sqrt(ee[me]);W[me]=Math.round(255-255*(Se/this.radius+this.cutoff))}return H}}function zI(t,e,n,r,i,s,l,o,p){for(let w=e;w<e+r;w++)OI(t,n*s+w,s,i,l,o,p);for(let w=n;w<n+i;w++)OI(t,w*s+e,1,r,l,o,p)}function OI(t,e,n,r,i,s,l){s[0]=0,l[0]=-_g,l[1]=_g,i[0]=t[e];for(let o=1,p=0,w=0;o<r;o++){i[o]=t[e+o*n];const C=o*o;do{const P=s[p];w=(i[o]-i[P]+C-P*P)/(o-P)/2}while(w<=l[p]&&--p>-1);p++,s[p]=o,l[p]=w,l[p+1]=_g}for(let o=0,p=0;o<r;o++){for(;l[p+1]<o;)p++;const w=s[p],C=o-w;t[e+o*n]=i[w]+C*C}}const cue=32,hue=[];function fue(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function due({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:l=0,yOffset:o=0}){let p=0,w=l;const C=n+r*2;for(const P of t)if(!s[P]){const I=e(P);w+I+r*2>i&&(w=0,p++),s[P]={x:w+r,y:o+p*C+r,width:I,height:C,layoutWidth:I,layoutHeight:n},w+=I+r*2}return{mapping:s,xOffset:w,yOffset:o+p*C,canvasHeight:fue(o+(p+1)*C)}}function FO(t,e,n,r){let i=0;for(let l=e;l<n;l++){var s;const o=t[l];i+=((s=r[o])===null||s===void 0?void 0:s.layoutWidth)||0}return i}function NO(t,e,n,r,i,s){let l=e,o=0;for(let p=e;p<n;p++){const w=FO(t,p,p+1,i);o+w>r&&(l<p&&s.push(p),l=p,o=0),o+=w}return o}function pue(t,e,n,r,i,s){let l=e,o=e,p=e,w=0;for(let C=e;C<n;C++)if((t[C]===" "||t[C+1]===" "||C+1===n)&&(p=C+1),p>o){let P=FO(t,o,p,i);w+P>r&&(l<o&&(s.push(o),l=o,w=0),P>r&&(P=NO(t,o,p,r,i,s),l=s[s.length-1])),o=p,w+=P}return w}function gue(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const l=[];return e==="break-all"?NO(t,i,s,n,r,l):pue(t,i,s,n,r,l),l}function mue(t,e,n,r,i,s){let l=0,o=0;for(let p=e;p<n;p++){const w=t[p],C=r[w];C?(o||(o=C.layoutHeight),i[p]=l+C.layoutWidth/2,l+=C.layoutWidth):(sr.warn("Missing character: ".concat(w," (").concat(w.codePointAt(0),")"))(),i[p]=l,l+=cue)}s[0]=l,s[1]=o}function yue(t,e,n,r,i){const s=Array.from(t),l=s.length,o=new Array(l),p=new Array(l),w=new Array(l),C=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,P=[0,0],I=[0,0];let U=0,W=0,H=0;for(let X=0;X<=l;X++){const ee=s[X];if((ee===`
`||X===l)&&(H=X),H>W){const se=C?gue(s,n,r,i,W,H):hue;for(let fe=0;fe<=se.length;fe++){const me=fe===0?W:se[fe-1],Se=fe<se.length?se[fe]:H;mue(s,me,Se,i,o,I);for(let He=me;He<Se;He++){var ie;const Qe=s[He],Ke=((ie=i[Qe])===null||ie===void 0?void 0:ie.layoutOffsetY)||0;p[He]=U+I[1]/2+Ke,w[He]=I[0]}U=U+I[1]*e,P[0]=Math.max(P[0],I[0])}W=H}ee===`
`&&(o[W]=0,p[W]=0,w[W]=0,W++)}return P[1]=U,{x:o,y:p,rowWidth:w,size:P}}function _ue({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const l=t.BYTES_PER_ELEMENT,o=n?n/l:1,p=r?r/l:0,w=i[e]||Math.ceil((t.length-p)/o),C=s&&new Set,P=new Array(e);let I=t;if(o>1||p>0){const U=t.constructor;I=new U(w);for(let W=0;W<w;W++)I[W]=t[W*o+p]}for(let U=0;U<e;U++){const W=i[U],H=i[U+1]||w,ie=I.subarray(W,H);P[U]=String.fromCodePoint.apply(null,ie),C&&ie.forEach(C.add,C)}if(C)for(const U of C)s.add(String.fromCodePoint(U));return{texts:P,characterCount:w}}class UO{constructor(e=5){oe(this,"limit",void 0),oe(this,"_cache",{}),oe(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function vue(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const ed={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:vue(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},FI=1024,NI=.9,UI=1.2,VO=3;let a2=new UO(VO);function xue(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=a2.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function wue(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function VI(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function bue(t){sr.assert(Number.isFinite(t)&&t>=VO,"Invalid cache limit"),a2=new UO(t)}class Eue{constructor(){oe(this,"props",{...ed}),oe(this,"_key",void 0),oe(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*UI+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=xue(this._key,this.props.characterSet),r=a2.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,a2.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:l,sdf:o,radius:p,cutoff:w}=this.props;let C=n&&n.data;C||(C=document.createElement("canvas"),C.width=FI);const P=C.getContext("2d",{willReadFrequently:!0});VI(P,r,s,i);const{mapping:I,canvasHeight:U,xOffset:W,yOffset:H}=due({getFontWidth:ie=>P.measureText(ie).width,fontHeight:s*UI,buffer:l,characterSet:e,maxCanvasWidth:FI,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(C.height!==U){const ie=P.getImageData(0,0,C.width,C.height);C.height=U,P.putImageData(ie,0,0)}if(VI(P,r,s,i),o){const ie=new uue({fontSize:s,buffer:l,radius:p,cutoff:w,fontFamily:r,fontWeight:"".concat(i)});for(const X of e){const{data:ee,width:se,height:fe,glyphTop:me}=ie.draw(X);I[X].width=se,I[X].layoutOffsetY=s*NI-me;const Se=P.createImageData(se,fe);wue(ee,Se),P.putImageData(Se,I[X].x,I[X].y)}}else for(const ie of e)P.fillText(ie,I[ie].x,I[ie].y+l+s*NI);return{xOffset:W,yOffset:H,mapping:I,data:C,width:C.width,height:C.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:l,cutoff:o}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(l," ").concat(o):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const Tue=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,Sue=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Cue={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class BS extends mA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:Tue,fs:Sue,modules:[Bf,zf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:l,getLineWidth:o}=this.props;let{padding:p}=this.props;p.length<4&&(p=[p[0],p[1],p[0],p[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!o,padding:p,sizeUnits:cf[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:l}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new sc(e,{...this.getShaders(),id:this.props.id,geometry:new Yu({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}oe(BS,"defaultProps",Cue);oe(BS,"layerName","TextBackgroundLayer");const GI={start:1,middle:0,end:-1},$I={top:1,center:0,bottom:-1},Ww=[0,0,0,255],Mue=1,Pue={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Ww},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:ed.characterSet},fontFamily:ed.fontFamily,fontWeight:ed.fontWeight,lineHeight:Mue,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Ww},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Ww},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class zS extends Bn{constructor(...e){super(...e),oe(this,"state",void 0),oe(this,"getBoundingRect",(n,r)=>{let{size:[i,s]}=this.transformParagraph(n,r);const{fontSize:l}=this.state.fontAtlasManager.props;i/=l,s/=l;const{getTextAnchor:o,getAlignmentBaseline:p}=this.props,w=GI[typeof o=="function"?o(n,r):o],C=$I[typeof p=="function"?p(n,r):p];return[(w-1)*i/2,(C-1)*s/2,i,s]}),oe(this,"getIconOffsets",(n,r)=>{const{getTextAnchor:i,getAlignmentBaseline:s}=this.props,{x:l,y:o,rowWidth:p,size:[w,C]}=this.transformParagraph(n,r),P=GI[typeof i=="function"?i(n,r):i],I=$I[typeof s=="function"?s(n,r):s],U=l.length,W=new Array(U*2);let H=0;for(let ie=0;ie<U;ie++){const X=(1-P)*(w-p[ie])/2;W[H++]=(P-1)*w/2+X+l[ie],W[H++]=(I-1)*C/2+o[ie]}return W})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new Eue},this.props.maxWidth>0&&sr.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,l={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(l),!0;for(const o in l)if(l[o]!==i.props[o])return i.setProps(l),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,l=n.startIndices,o;const p=r==="auto"&&new Set;if(i&&l){const{texts:w,characterCount:C}=_ue({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:l,characterSet:p});o=C,s=(P,{index:I})=>w[I]}else{const{iterable:w,objectInfo:C}=Nd(n);l=[0],o=0;for(const P of w){C.index++;const I=Array.from(s(P,C)||"");p&&I.forEach(p.add,p),o+=I.length,l.push(o)}}this.setState({getText:s,startIndices:l,numInstances:o,characterSet:p||r})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:l,lineHeight:o,maxWidth:p}=this.props,w=s(e,n)||"";return yue(w,o,l,p*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:l},styleVersion:o}=this.state,{data:p,_dataDiff:w,getPosition:C,getColor:P,getSize:I,getAngle:U,getPixelOffset:W,getBackgroundColor:H,getBorderColor:ie,getBorderWidth:X,backgroundPadding:ee,background:se,billboard:fe,fontSettings:me,outlineWidth:Se,outlineColor:He,sizeScale:Qe,sizeUnits:Ke,sizeMinPixels:rt,sizeMaxPixels:Ue,transitions:it,updateTriggers:Ze}=this.props,yt=this.getSubLayerClass("characters",RS),Kt=this.getSubLayerClass("background",BS);return[se&&new Kt({getFillColor:H,getLineColor:ie,getLineWidth:X,padding:ee,getPosition:C,getSize:I,getAngle:U,getPixelOffset:W,billboard:fe,sizeScale:Qe,sizeUnits:Ke,sizeMinPixels:rt,sizeMaxPixels:Ue,transitions:it&&{getPosition:it.getPosition,getAngle:it.getAngle,getSize:it.getSize,getFillColor:it.getBackgroundColor,getLineColor:it.getBorderColor,getLineWidth:it.getBorderWidth,getPixelOffset:it.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:Ze.getPosition,getAngle:Ze.getAngle,getSize:Ze.getSize,getFillColor:Ze.getBackgroundColor,getLineColor:Ze.getBorderColor,getLineWidth:Ze.getBorderWidth,getPixelOffset:Ze.getPixelOffset,getBoundingRect:{getText:Ze.getText,getTextAnchor:Ze.getTextAnchor,getAlignmentBaseline:Ze.getAlignmentBaseline,styleVersion:o}}}),{data:p.attributes&&p.attributes.background?{length:p.length,attributes:p.attributes.background}:p,_dataDiff:w,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new yt({sdf:me.sdf,smoothing:Number.isFinite(me.smoothing)?me.smoothing:ed.smoothing,outlineWidth:Se/(me.radius||ed.radius),outlineColor:He,iconAtlas:s,iconMapping:l,getPosition:C,getColor:P,getSize:I,getAngle:U,getPixelOffset:W,billboard:fe,sizeScale:Qe*i,sizeUnits:Ke,sizeMinPixels:rt*i,sizeMaxPixels:Ue*i,transitions:it&&{getPosition:it.getPosition,getAngle:it.getAngle,getColor:it.getColor,getSize:it.getSize,getPixelOffset:it.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:Ze.getText,getPosition:Ze.getPosition,getAngle:Ze.getAngle,getColor:Ze.getColor,getSize:Ze.getSize,getPixelOffset:Ze.getPixelOffset,getIconOffsets:{getTextAnchor:Ze.getTextAnchor,getAlignmentBaseline:Ze.getAlignmentBaseline,styleVersion:o}}}),{data:p,_dataDiff:w,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){bue(e)}}oe(zS,"defaultProps",Pue);oe(zS,"layerName","TextLayer");const jy={circle:{type:LS,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:hv,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:zS,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Hy={type:fv,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},sE={type:gv,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Rp({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function Qw(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const l=e[s];let o=t.props[s];s.startsWith("get")&&(o=t.getSubLayerAccessor(o),i.updateTriggers[l]=r[s],n&&(i.transitions[l]=n[s])),i[l]=o}return i}function kue(t){if(Array.isArray(t))return t;switch(sr.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return sr.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function jI(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let l=i;l<s;l++){const o=t[l],{geometry:p}=o;if(p)if(p.type==="GeometryCollection"){sr.assert(Array.isArray(p.geometries),"GeoJSON does not have geometries array");const{geometries:w}=p;for(let C=0;C<w.length;C++){const P=w[C];HI(P,r,e,o,l)}}else HI(p,r,e,o,l)}return r}function HI(t,e,n,r,i){const{type:s,coordinates:l}=t,{pointFeatures:o,lineFeatures:p,polygonFeatures:w,polygonOutlineFeatures:C}=e;if(!Lue(s,l)){sr.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":o.push(n({geometry:t},r,i));break;case"MultiPoint":l.forEach(P=>{o.push(n({geometry:{type:"Point",coordinates:P}},r,i))});break;case"LineString":p.push(n({geometry:t},r,i));break;case"MultiLineString":l.forEach(P=>{p.push(n({geometry:{type:"LineString",coordinates:P}},r,i))});break;case"Polygon":w.push(n({geometry:t},r,i)),l.forEach(P=>{C.push(n({geometry:{type:"LineString",coordinates:P}},r,i))});break;case"MultiPolygon":l.forEach(P=>{w.push(n({geometry:{type:"Polygon",coordinates:P}},r,i)),P.forEach(I=>{C.push(n({geometry:{type:"LineString",coordinates:I}},r,i))})});break}}const Iue={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function Lue(t,e){let n=Iue[t];for(sr.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function GO(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function ty(t){return t.geometry.coordinates}function Due(t,e){const n=GO(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:l}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=ty,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=ty,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=ty,n.polygonsOutline.data=l,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=ty,n}function Rue(t,e){const n=GO(),{points:r,lines:i,polygons:s}=t,l=aue(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:l.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:l.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:l.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:l.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const Bue=["points","linestrings","polygons"],zue={...Rp(jy.circle),...Rp(jy.icon),...Rp(jy.text),...Rp(Hy),...Rp(sE),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class Ni extends Bn{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=Rue(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=kue(e.data),i=this.getSubLayerRow.bind(this);let s={};const l={};if(Array.isArray(n.dataChanged)){const p=this.state.features;for(const w in p)s[w]=p[w].slice(),l[w]=[];for(const w of n.dataChanged){const C=jI(r,i,w);for(const P in p)l[P].push(zO({data:s[P],getIndex:I=>I.__source.index,dataRange:w,replace:C[P]}))}}else s=jI(r,i);const o=Due(s,l);this.setState({features:s,featuresDiff:l,layerProps:o})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=Bue.find(s=>i.id.startsWith("".concat(this.id,"-").concat(s,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,sE.type);if(s){const l=Qw(this,sE.props),o=e&&n;return o||delete l.getLineColor,l.updateTriggers.lineColors=o,new s(l,this.getSubLayerProps({id:i,updateTriggers:l.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",l=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,Hy.type),o=this.shouldRenderSubLayer(s,r.lines.data)&&this.getSubLayerClass(s,Hy.type);if(l||o){const p=Qw(this,Hy.props);return[l&&new l(p,this.getSubLayerProps({id:i,updateTriggers:p.updateTriggers}),r.polygonsOutline),o&&new o(p,this.getSubLayerProps({id:s,updateTriggers:p.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(o=>o.__source.index===i));const s=new Set(e.split("+")),l=[];for(const o of s){const p="points-".concat(o),w=jy[o],C=w&&this.shouldRenderSubLayer(p,n.points.data)&&this.getSubLayerClass(p,w.type);if(C){const P=Qw(this,w.props);let I=n.points;if(o==="text"&&r){const{instancePickingColors:U,...W}=I.data.attributes;I={...I,data:{...I.data,attributes:W}}}l.push(new C(P,this.getSubLayerProps({id:p,updateTriggers:P.updateTriggers,highlightedObjectIndex:i}),I))}}return l}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:l}=i,o=sue(s,l);return e(o,i)}}}oe(Ni,"layerName","GeoJsonLayer");oe(Ni,"defaultProps",zue);class Oue{constructor(e){oe(this,"index",void 0),oe(this,"isVisible",void 0),oe(this,"isSelected",void 0),oe(this,"parent",void 0),oe(this,"children",void 0),oe(this,"content",void 0),oe(this,"state",void 0),oe(this,"layers",void 0),oe(this,"id",void 0),oe(this,"zoom",void 0),oe(this,"userData",void 0),oe(this,"boundingBox",void 0),oe(this,"_abortController",void 0),oe(this,"_loader",void 0),oe(this,"_loaderId",void 0),oe(this,"_isLoaded",void 0),oe(this,"_isCancelled",void 0),oe(this,"_needsReload",void 0),oe(this,"_bbox",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:n,onLoad:r,onError:i}){const{index:s,id:l,bbox:o,userData:p,zoom:w}=this,C=this._loaderId;this._abortController=new AbortController;const{signal:P}=this._abortController,I=await n.scheduleRequest(this,H=>H.isSelected?1:-1);if(!I){this._isCancelled=!0;return}if(this._isCancelled){I.done();return}let U=null,W;try{U=await e({index:s,id:l,bbox:o,userData:p,zoom:w,signal:P})}catch(H){W=H||!0}finally{I.done()}if(C===this._loaderId){if(this._loader=void 0,this.content=U,this._isCancelled&&!U){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,W?i(W,this):r(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const Ao={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},WI=new An,Fue=new An;class OS{constructor(e=[0,0,0],n=[0,0,0],r){oe(this,"center",void 0),oe(this,"halfDiagonal",void 0),oe(this,"minimum",void 0),oe(this,"maximum",void 0),r=r||WI.copy(e).add(n).scale(.5),this.center=new An(r),this.halfDiagonal=new An(n).subtract(this.center),this.minimum=new An(e),this.maximum=new An(n)}clone(){return new OS(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,r=Fue.from(e.normal),i=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),s=this.center.dot(r)+e.distance;return s-i>0?Ao.INSIDE:s+i<0?Ao.OUTSIDE:Ao.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=WI.from(e).subtract(this.center),{halfDiagonal:r}=this;let i=0,s;return s=Math.abs(n.x)-r.x,s>0&&(i+=s*s),s=Math.abs(n.y)-r.y,s>0&&(i+=s*s),s=Math.abs(n.z)-r.z,s>0&&(i+=s*s),i}}const Bp=new An,QI=new An;class FS{constructor(e=[0,0,0],n=0){oe(this,"center",void 0),oe(this,"radius",void 0),this.radius=-0,this.center=new An,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=Bp.from(n),this.center=new An().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new FS(this.center,this.radius)}union(e){const n=this.center,r=this.radius,i=e.center,s=e.radius,l=Bp.copy(i).subtract(n),o=l.magnitude();if(r>=o+s)return this.clone();if(s>=o+r)return e.clone();const p=(r+o+s)*.5;return QI.copy(l).scale((-r+p)/o).add(n),this.center.copy(QI),this.radius=p,this}expand(e){const r=Bp.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=gY(Bp,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=Bp.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,s=e.normal.dot(n)+e.distance;return s<-r?Ao.OUTSIDE:s<r?Ao.INTERSECTING:Ao.INSIDE}}const Nue=new An,Uue=new An,ny=new An,ry=new An,iy=new An,Vue=new An,Gue=new An,Bu={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class NS{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){oe(this,"center",void 0),oe(this,"halfAxes",void 0),this.center=new An().from(e),this.halfAxes=new Rs(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new An(e).len(),new An(n).len(),new An(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),i=new An(e).normalize(),s=new An(n).normalize(),l=new An(r).normalize();return new DP().fromMatrix3(new Rs([...i,...s,...l]))}fromCenterHalfSizeQuaternion(e,n,r){const i=new DP(r),s=new Rs().fromQuaternion(i);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new An().from(e),this.halfAxes=s,this}clone(){return new NS(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new FS){const n=this.halfAxes,r=n.getColumn(0,ny),i=n.getColumn(1,ry),s=n.getColumn(2,iy),l=Nue.copy(r).add(i).add(s);return e.center.copy(this.center),e.radius=l.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,i=this.halfAxes,s=r.x,l=r.y,o=r.z,p=Math.abs(s*i[Bu.COLUMN0ROW0]+l*i[Bu.COLUMN0ROW1]+o*i[Bu.COLUMN0ROW2])+Math.abs(s*i[Bu.COLUMN1ROW0]+l*i[Bu.COLUMN1ROW1]+o*i[Bu.COLUMN1ROW2])+Math.abs(s*i[Bu.COLUMN2ROW0]+l*i[Bu.COLUMN2ROW1]+o*i[Bu.COLUMN2ROW2]),w=r.dot(n)+e.distance;return w<=-p?Ao.OUTSIDE:w>=p?Ao.INSIDE:Ao.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=Uue.from(e).subtract(this.center),r=this.halfAxes,i=r.getColumn(0,ny),s=r.getColumn(1,ry),l=r.getColumn(2,iy),o=i.magnitude(),p=s.magnitude(),w=l.magnitude();i.normalize(),s.normalize(),l.normalize();let C=0,P;return P=Math.abs(n.dot(i))-o,P>0&&(C+=P*P),P=Math.abs(n.dot(s))-p,P>0&&(C+=P*P),P=Math.abs(n.dot(l))-w,P>0&&(C+=P*P),C}computePlaneDistances(e,n,r=[-0,-0]){let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const l=this.center,o=this.halfAxes,p=o.getColumn(0,ny),w=o.getColumn(1,ry),C=o.getColumn(2,iy),P=Vue.copy(p).add(w).add(C).add(l),I=Gue.copy(P).subtract(e);let U=n.dot(I);return i=Math.min(U,i),s=Math.max(U,s),P.copy(l).add(p).add(w).subtract(C),I.copy(P).subtract(e),U=n.dot(I),i=Math.min(U,i),s=Math.max(U,s),P.copy(l).add(p).subtract(w).add(C),I.copy(P).subtract(e),U=n.dot(I),i=Math.min(U,i),s=Math.max(U,s),P.copy(l).add(p).subtract(w).subtract(C),I.copy(P).subtract(e),U=n.dot(I),i=Math.min(U,i),s=Math.max(U,s),l.copy(P).subtract(p).add(w).add(C),I.copy(P).subtract(e),U=n.dot(I),i=Math.min(U,i),s=Math.max(U,s),l.copy(P).subtract(p).add(w).subtract(C),I.copy(P).subtract(e),U=n.dot(I),i=Math.min(U,i),s=Math.max(U,s),l.copy(P).subtract(p).subtract(w).add(C),I.copy(P).subtract(e),U=n.dot(I),i=Math.min(U,i),s=Math.max(U,s),l.copy(P).subtract(p).subtract(w).subtract(C),I.copy(P).subtract(e),U=n.dot(I),i=Math.min(U,i),s=Math.max(U,s),r[0]=i,r[1]=s,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,ny);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,ry);r.transformAsPoint(e);const i=this.halfAxes.getColumn(2,iy);return i.transformAsPoint(e),this.halfAxes=new Rs([...n,...r,...i]),this}getTransform(){throw new Error("not implemented")}}const qI=new An,ZI=new An;class Td{constructor(e=[0,0,1],n=0){oe(this,"normal",void 0),oe(this,"distance",void 0),this.normal=new An,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return Hg(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=qI.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,i){return this.normal.set(e,n,r),Hg(Zu(this.normal.len(),1)),this.distance=i,this}clone(){return new Td(this.normal,this.distance)}equals(e){return Zu(this.distance,e.distance)&&Zu(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=ZI.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){e=qI.from(e);const r=this.getPointDistance(e),i=ZI.copy(this.normal).scale(r);return e.subtract(i).to(n)}}const YI=[new An([1,0,0]),new An([0,1,0]),new An([0,0,1])],XI=new An,$ue=new An;new Td(new An(1,0,0),0);class Wu{constructor(e=[]){oe(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*YI.length;const n=e.center,r=e.radius;let i=0;for(const s of YI){let l=this.planes[i],o=this.planes[i+1];l||(l=this.planes[i]=new Td),o||(o=this.planes[i+1]=new Td);const p=XI.copy(s).scale(-r).add(n);-s.dot(p),l.fromPointNormal(p,s);const w=XI.copy(s).scale(r).add(n),C=$ue.copy(s).negate();-C.dot(w),o.fromPointNormal(w,C),i+=2}return this}computeVisibility(e){let n=Ao.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case Ao.OUTSIDE:return Ao.OUTSIDE;case Ao.INTERSECTING:n=Ao.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(Hg(Number.isFinite(n),"parentPlaneMask is required."),n===Wu.MASK_OUTSIDE||n===Wu.MASK_INSIDE)return n;let r=Wu.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const l=s<31?1<<s:0;if(s<31&&!(n&l))continue;const o=i[s],p=e.intersectPlane(o);if(p===Ao.OUTSIDE)return Wu.MASK_OUTSIDE;p===Ao.INTERSECTING&&(r|=l)}return r}}oe(Wu,"MASK_OUTSIDE",4294967295);oe(Wu,"MASK_INSIDE",0);oe(Wu,"MASK_INDETERMINATE",2147483647);new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;const VA=new Rs,jue=new Rs,Hue=new Rs,sy=new Rs,KI=new Rs;function Wue(t,e={}){const n=bB.EPSILON20,r=10;let i=0,s=0;const l=jue,o=Hue;l.identity(),o.copy(t);const p=n*Que(o);for(;s<r&&que(o)>p;)Zue(o,sy),KI.copy(sy).transpose(),o.multiplyRight(sy),o.multiplyLeft(KI),l.multiplyRight(sy),++i>2&&(++s,i=0);return e.unitary=l.toTarget(e.unitary),e.diagonal=o.toTarget(e.diagonal),e}function Que(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const oE=[1,0,0],aE=[2,2,1];function que(t){let e=0;for(let n=0;n<3;++n){const r=t[VA.getElementIndex(aE[n],oE[n])];e+=2*r*r}return Math.sqrt(e)}function Zue(t,e){const n=bB.EPSILON15;let r=0,i=1;for(let w=0;w<3;++w){const C=Math.abs(t[VA.getElementIndex(aE[w],oE[w])]);C>r&&(i=w,r=C)}const s=oE[i],l=aE[i];let o=1,p=0;if(Math.abs(t[VA.getElementIndex(l,s)])>n){const w=t[VA.getElementIndex(l,l)],C=t[VA.getElementIndex(s,s)],P=t[VA.getElementIndex(l,s)],I=(w-C)/2/P;let U;I<0?U=-1/(-I+Math.sqrt(1+I*I)):U=1/(I+Math.sqrt(1+I*I)),o=1/Math.sqrt(1+U*U),p=U*o}return Rs.IDENTITY.to(e),e[VA.getElementIndex(s,s)]=e[VA.getElementIndex(l,l)]=o,e[VA.getElementIndex(l,s)]=p,e[VA.getElementIndex(s,l)]=-p,e}const Vc=new An,Yue=new An,Xue=new An,Kue=new An,Jue=new An,ece=new Rs,tce={diagonal:new Rs,unitary:new Rs};function nce(t,e=new NS){if(!t||t.length===0)return e.halfAxes=new Rs([0,0,0,0,0,0,0,0,0]),e.center=new An,e;const n=t.length,r=new An(0,0,0);for(const Ke of t)r.add(Ke);const i=1/n;r.multiplyByScalar(i);let s=0,l=0,o=0,p=0,w=0,C=0;for(const Ke of t){const rt=Vc.copy(Ke).subtract(r);s+=rt.x*rt.x,l+=rt.x*rt.y,o+=rt.x*rt.z,p+=rt.y*rt.y,w+=rt.y*rt.z,C+=rt.z*rt.z}s*=i,l*=i,o*=i,p*=i,w*=i,C*=i;const P=ece;P[0]=s,P[1]=l,P[2]=o,P[3]=l,P[4]=p,P[5]=w,P[6]=o,P[7]=w,P[8]=C;const{unitary:I}=Wue(P,tce),U=e.halfAxes.copy(I);let W=U.getColumn(0,Xue),H=U.getColumn(1,Kue),ie=U.getColumn(2,Jue),X=-Number.MAX_VALUE,ee=-Number.MAX_VALUE,se=-Number.MAX_VALUE,fe=Number.MAX_VALUE,me=Number.MAX_VALUE,Se=Number.MAX_VALUE;for(const Ke of t)Vc.copy(Ke),X=Math.max(Vc.dot(W),X),ee=Math.max(Vc.dot(H),ee),se=Math.max(Vc.dot(ie),se),fe=Math.min(Vc.dot(W),fe),me=Math.min(Vc.dot(H),me),Se=Math.min(Vc.dot(ie),Se);W=W.multiplyByScalar(.5*(fe+X)),H=H.multiplyByScalar(.5*(me+ee)),ie=ie.multiplyByScalar(.5*(Se+se)),e.center.copy(W).add(H).add(ie);const He=Yue.set(X-fe,ee-me,se-Se).multiplyByScalar(.5),Qe=new Rs([He[0],0,0,0,He[1],0,0,0,He[2]]);return e.halfAxes.multiplyRight(Qe),e}const B0=512,JI=3,$O=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],jO=$O.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),rce=jO.concat([[.25,.5],[.75,.5]]);class z0{constructor(e,n,r){oe(this,"x",void 0),oe(this,"y",void 0),oe(this,"z",void 0),oe(this,"childVisible",void 0),oe(this,"selected",void 0),oe(this,"_children",void 0),this.x=e,this.y=n,this.z=r}get children(){if(!this._children){const e=this.x*2,n=this.y*2,r=this.z+1;this._children=[new z0(e,n,r),new z0(e,n+1,r),new z0(e+1,n,r),new z0(e+1,n+1,r)]}return this._children}update(e){const{viewport:n,cullingVolume:r,elevationBounds:i,minZ:s,maxZ:l,bounds:o,offset:p,project:w}=e,C=this.getBoundingVolume(i,p,w);if(o&&!this.insideBounds(o)||r.computeVisibility(C)<0)return!1;if(!this.childVisible){let{z:I}=this;if(I<l&&I>=s){const U=C.distanceTo(n.cameraPosition)*n.scale/n.height;I+=Math.floor(Math.log2(U))}if(I>=l)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const I of this.children)I.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,r,i]){const s=Math.pow(2,this.z),l=B0/s;return this.x*l<r&&this.y*l<i&&(this.x+1)*l>e&&(this.y+1)*l>n}getBoundingVolume(e,n,r){if(r){const p=this.z<1?rce:this.z<2?jO:$O,w=[];for(const C of p){const P=AE(this.x+C[0],this.y+C[1],this.z);P[2]=e[0],w.push(r(P)),e[0]!==e[1]&&(P[2]=e[1],w.push(r(P)))}return nce(w)}const i=Math.pow(2,this.z),s=B0/i,l=this.x*s+n*B0,o=B0-(this.y+1)*s;return new OS([l,o,e[0]],[l+s,o+s,e[1]])}}function ice(t,e,n,r){const i=t instanceof jte&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map(({normal:U,distance:W})=>new Td(U.clone().negate(),W)),l=new Wu(s),o=t.distanceScales.unitsPerMeter[2],p=n&&n[0]*o||0,w=n&&n[1]*o||0,C=t instanceof ac&&t.pitch<=60?e:0;if(r){const[U,W,H,ie]=r,X=pA([U,ie]),ee=pA([H,W]);r=[X[0],B0-X[1],ee[0],B0-ee[1]]}const P=new z0(0,0,0),I={viewport:t,project:i,cullingVolume:l,elevationBounds:[p,w],minZ:C,maxZ:e,bounds:r,offset:0};if(P.update(I),t instanceof ac&&t.subViewports&&t.subViewports.length>1){for(I.offset=-1;P.update(I)&&!(--I.offset<-JI););for(I.offset=1;P.update(I)&&!(++I.offset>JI););}return P.getSelected()}const cc=512,sce=[-1/0,-1/0,1/0,1/0],oce={type:"object",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function HO(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(i=>i[0])),Math.min(...n.map(i=>i[1])),Math.max(...n.map(i=>i[0])),Math.max(...n.map(i=>i[1]))]}function ace(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function lce(t,e){if(!t||!t.length)return null;const{index:n,id:r}=e;if(Array.isArray(t)){const s=ace(r)%t.length;t=t[s]}let i=t;for(const s of Object.keys(n)){const l=new RegExp("{".concat(s,"}"),"g");i=i.replace(l,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function Ace(t,e,n){let r;if(e&&e.length===2){const[i,s]=e,l=t.getBounds({z:i}),o=t.getBounds({z:s});r=[Math.min(l[0],o[0]),Math.min(l[1],o[1]),Math.max(l[2],o[2]),Math.max(l[3],o[3])]}else r=t.getBounds();return t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}function uce({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map(i=>lE(i,e,n))}function lE(t,e,n){if(!Array.isArray(e)){const s=n.x-t.x,l=n.y-t.y,{width:o,height:p}=n,w={targetZ:e},C=t.unproject([s,l],w),P=t.unproject([s+o,l],w),I=t.unproject([s,l+p],w),U=t.unproject([s+o,l+p],w);return[Math.min(C[0],P[0],I[0],U[0]),Math.min(C[1],P[1],I[1],U[1]),Math.max(C[0],P[0],I[0],U[0]),Math.max(C[1],P[1],I[1],U[1])]}const r=lE(t,e[0],n),i=lE(t,e[1],n);return[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[2],i[2]),Math.max(r[3],i[3])]}function cce(t,e,n){return n?HO(t,n).map(i=>i*e/cc):t.map(r=>r*e/cc)}function US(t,e){return Math.pow(2,t)*cc/e}function AE(t,e,n){const r=US(n,cc),i=t/r*360-180,s=Math.PI-2*Math.PI*e/r,l=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[i,l]}function e6(t,e,n,r){const i=US(n,r);return[t/i*cc,e/i*cc]}function hce(t,e,n,r,i=cc){if(t.isGeospatial){const[w,C]=AE(e,n,r),[P,I]=AE(e+1,n+1,r);return{west:w,north:C,east:P,south:I}}const[s,l]=e6(e,n,r,i),[o,p]=e6(e+1,n+1,r,i);return{left:s,top:l,right:o,bottom:p}}function fce(t,e,n,r,i){const s=Ace(t,null,r),l=US(e,n),[o,p,w,C]=cce(s,l,i),P=[];for(let I=Math.floor(o);I<w;I++)for(let U=Math.floor(p);U<C;U++)P.push({x:I,y:U,z:e});return P}function dce({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:s=cc,modelMatrix:l,modelMatrixInverse:o,zoomOffset:p=0}){let w=t.isGeospatial?Math.round(t.zoom+Math.log2(cc/s))+p:Math.ceil(t.zoom)+p;if(typeof n=="number"&&Number.isFinite(n)&&w<n){if(!i)return[];w=n}typeof e=="number"&&Number.isFinite(e)&&w>e&&(w=e);let C=i;return l&&o&&i&&!t.isGeospatial&&(C=HO(i,l)),t.isGeospatial?ice(t,w,r,i):fce(t,w,s,C||sce,o)}function pce(t){let e={},n;return r=>{for(const i in r)if(!gce(r[i],e[i])){n=t(r),e=r;break}return n}}function gce(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}const t6=1,mv=2,mce="never",yce="no-overlap",VS="best-available",_ce=5,vce={[VS]:bce,[yce]:Ece,[mce]:()=>{}},xce={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class wce{constructor(e){oe(this,"opts",void 0),oe(this,"_requestScheduler",void 0),oe(this,"_cache",void 0),oe(this,"_dirty",void 0),oe(this,"_tiles",void 0),oe(this,"_cacheByteSize",void 0),oe(this,"_viewport",void 0),oe(this,"_zRange",void 0),oe(this,"_selectedTiles",void 0),oe(this,"_frameNumber",void 0),oe(this,"_modelMatrix",void 0),oe(this,"_modelMatrixInverse",void 0),oe(this,"_maxZoom",void 0),oe(this,"_minZoom",void 0),oe(this,"onTileLoad",void 0),oe(this,"_getCullBounds",pce(uce)),this.opts={...xce,...e},this.onTileLoad=n=>{var r,i;(r=(i=this.opts).onTileLoad)===null||r===void 0||r.call(i,n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new p$({maxRequests:e.maxRequests,throttleRequests:!!(e.maxRequests&&e.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new la,this._modelMatrixInverse=new la,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:r}={}){const i=new la(r),s=!i.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!Zu(this._zRange,n)||s){s&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=e,this._zRange=n;const o=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=o.map(p=>this._getTile(p,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(o=>this._getTile(o.index,!0)));const l=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),l&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const r=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:i}=e;for(const[s,l,o,p]of r){let w;if("west"in i)w=i.west<o&&i.east>s&&i.south<p&&i.north>l;else{const C=Math.min(i.top,i.bottom),P=Math.max(i.top,i.bottom);w=i.left<o&&i.right>s&&C<p&&P>l}if(w)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:r,zRange:i,modelMatrix:s,modelMatrixInverse:l}){const{tileSize:o,extent:p,zoomOffset:w}=this.opts;return dce({viewport:e,maxZoom:n,minZoom:r,zRange:i,tileSize:o,extent:p,modelMatrix:s,modelMatrixInverse:l,zoomOffset:w})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:hce(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),r=Math.floor(e.y/2),i=e.z-1;return{x:n,y:r,z:i}}updateTileStates(){const e=this.opts.refinementStrategy||VS,n=new Array(this._cache.size);let r=0;for(const i of this._cache.values())n[r++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(const i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof e=="function"?e:vce[e])(Array.from(this._cache.values())),r=0;for(const i of this._cache.values())if(n[r++]!==i.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,n=[];let r=0;for(const i of this._cache.values())i.isLoading&&(r++,!i.isSelected&&!i.isVisible&&n.push(i));for(;e>0&&r>e&&n.length>0;)n.shift().abort(),r--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const r=this._getNearestAncestor(n);n.parent=r,r!=null&&r.children&&r.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,r=n.maxCacheSize||(n.maxCacheByteSize?1/0:_ce*this.selectedTiles.length),i=n.maxCacheByteSize||1/0;if(e.size>r||this._cacheByteSize>i){for(const[p,w]of e){if(!w.isVisible&&!w.isSelected){var l,o;this._cacheByteSize-=n.maxCacheByteSize?w.byteLength:0,e.delete(p),(l=(o=this.opts).onTileUnload)===null||l===void 0||l.call(o,w)}if(e.size<=r&&this._cacheByteSize<=i)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((p,w)=>p.zoom-w.zoom),this._dirty=!1)}_getTile(e,n){const r=this.getTileId(e);let i=this._cache.get(r),s=!1;return!i&&n?(i=new Oue(e),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:r,zoom:this.getTileZoom(i.index)}),s=!0,this._cache.set(r,i),this._dirty=!0):i&&i.needsReload&&(s=!0),i&&s&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(e){const{_minZoom:n=0}=this;let r=e.index;for(;this.getTileZoom(r)>n;){r=this.getParentIndex(r);const i=this._getTile(r);if(i)return i}return null}}function bce(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!WO(e)&&GS(e);for(const e of t)e.isVisible=!!(e.state&mv)}function Ece(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&WO(n);const e=Array.from(t).sort((n,r)=>n.zoom-r.zoom);for(const n of e)if(n.isVisible=!!(n.state&mv),n.children&&(n.isVisible||n.state&t6))for(const r of n.children)r.state=t6;else n.isSelected&&GS(n)}function WO(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=mv,!0;e=e.parent}return!1}function GS(t){for(const e of t.children)e.isLoaded||e.content?e.state|=mv:GS(e)}const Tce={TilesetClass:wce,data:{type:"data",value:[]},dataComparator:oce.equal,renderSubLayers:{type:"function",value:t=>new Ni(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:VS,zRange:null,maxRequests:6,zoomOffset:0};class yh extends Bn{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n,r;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||(r=n.selectedTiles)===null||r===void 0?void 0:r.every(i=>i.isLoaded&&i.layers&&i.layers.every(s=>s.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:s,maxZoom:l,minZoom:o,maxRequests:p,zoomOffset:w}=this.props;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:l,minZoom:o,tileSize:e,refinementStrategy:i,extent:s,maxRequests:p,zoomOffset:w,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:r}=this.props,i=e.update(this.context.viewport,{zRange:n,modelMatrix:r}),{isLoaded:s}=e,l=this.state.isLoaded!==s,o=this.state.frameNumber!==i;s&&(l||o)&&this._onViewportLoad(),o&&this.setState({frameNumber:i}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:r,fetch:i}=this.props,{signal:s}=e;return e.url=typeof n=="string"||Array.isArray(n)?lce(n,e):null,r?r(e):i&&e.url?i(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){const r=n.props.tile;return e.picked&&(e.tile=r),e.sourceTile=r,e}_updateAutoHighlight(e){const n=e.sourceTile;if(n&&n.layers)for(const r of n.layers)r.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(r=>e.layers[0].props[r]!==n[r])&&(e.layers=e.layers.map(r=>r.clone(n)));else{const r=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=mf(r,Boolean).map(i=>i.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:r}=e.props;return this.state.tileset.isTileVisible(r,n)}}oe(yh,"defaultProps",Tce);oe(yh,"layerName","TileLayer");const qw=Math.PI/180,oy=new Float32Array(16),n6=new Float32Array(12);function r6(t,e,n){const r=e[0]*qw,i=e[1]*qw,s=e[2]*qw,l=Math.sin(s),o=Math.sin(r),p=Math.sin(i),w=Math.cos(s),C=Math.cos(r),P=Math.cos(i),I=n[0],U=n[1],W=n[2];t[0]=I*P*C,t[1]=I*p*C,t[2]=I*-o,t[3]=U*(-p*w+P*o*l),t[4]=U*(P*w+p*o*l),t[5]=U*C*l,t[6]=W*(p*l+P*o*w),t[7]=W*(-P*l+p*o*w),t[8]=W*C*w}function i6(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const Sce={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:i,getScale:s,getTranslation:l,getTransformMatrix:o}=this.props,p=Array.isArray(o),w=p&&o.length===16,C=Array.isArray(s),P=Array.isArray(i),I=Array.isArray(l),U=w||!p&&!!o(r[0]);U?t.constant=w:t.constant=P&&C&&I;const W=t.value;if(t.constant){let H;U?(oy.set(o),H=i6(oy)):(H=n6,r6(H,i,s),H.set(l,9)),t.value=new Float32Array(H)}else{let H=e*t.size;const{iterable:ie,objectInfo:X}=Nd(r,e,n);for(const ee of ie){X.index++;let se;if(U)oy.set(w?o:o(ee,X)),se=i6(oy);else{se=n6;const fe=P?i:i(ee,X),me=C?s:s(ee,X);r6(se,fe,me),se.set(I?l:l(ee,X),9)}W[H++]=se[0],W[H++]=se[1],W[H++]=se[2],W[H++]=se[3],W[H++]=se[4],W[H++]=se[5],W[H++]=se[6],W[H++]=se[7],W[H++]=se[8],W[H++]=se[9],W[H++]=se[10],W[H++]=se[11]}}}};function Cce(t,e){return e===ur.CARTESIAN||e===ur.METER_OFFSETS||e===ur.DEFAULT&&!t.isGeospatial}const Mce=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Pce=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function QO(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,l=-1/0;const o=t.POSITION?t.POSITION.value:[],p=o&&o.length;for(let w=0;w<p;w+=3){const C=o[w],P=o[w+1],I=o[w+2];e=C<e?C:e,n=P<n?P:n,r=I<r?I:r,i=C>i?C:i,s=P>s?P:s,l=I>l?I:l}return[[e,n,r],[i,s,l]]}function kce(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class O0{constructor(e,n){oe(this,"fields",void 0),oe(this,"metadata",void 0),kce(Array.isArray(e)),Ice(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(const l of r)e[l]=!0;const s=this.fields.filter(l=>e[l.name]);return new O0(s,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=n.map(s=>this.fields[s]).filter(Boolean);return new O0(i,this.metadata)}assign(e){let n,r=this.metadata;if(e instanceof O0){const l=e;n=l.fields,r=s6(s6(new Map,this.metadata),l.metadata)}else n=e;const i=Object.create(null);for(const l of this.fields)i[l.name]=l;for(const l of n)i[l.name]=l;const s=Object.values(i);return new O0(s,r)}}function Ice(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function s6(t,e){return new Map([...t||new Map,...e||new Map])}class vg{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"nullable",void 0),oe(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new vg(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Ci=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({}),qO,ZO,YO;class $S{static isNull(e){return e&&e.typeId===Ci.Null}static isInt(e){return e&&e.typeId===Ci.Int}static isFloat(e){return e&&e.typeId===Ci.Float}static isBinary(e){return e&&e.typeId===Ci.Binary}static isUtf8(e){return e&&e.typeId===Ci.Utf8}static isBool(e){return e&&e.typeId===Ci.Bool}static isDecimal(e){return e&&e.typeId===Ci.Decimal}static isDate(e){return e&&e.typeId===Ci.Date}static isTime(e){return e&&e.typeId===Ci.Time}static isTimestamp(e){return e&&e.typeId===Ci.Timestamp}static isInterval(e){return e&&e.typeId===Ci.Interval}static isList(e){return e&&e.typeId===Ci.List}static isStruct(e){return e&&e.typeId===Ci.Struct}static isUnion(e){return e&&e.typeId===Ci.Union}static isFixedSizeBinary(e){return e&&e.typeId===Ci.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Ci.FixedSizeList}static isMap(e){return e&&e.typeId===Ci.Map}static isDictionary(e){return e&&e.typeId===Ci.Dictionary}get typeId(){return Ci.NONE}compareTo(e){return this===e}}qO=Symbol.toStringTag;class $d extends $S{constructor(e,n){super(),oe(this,"isSigned",void 0),oe(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return Ci.Int}get[qO](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class Lce extends $d{constructor(){super(!0,8)}}class Dce extends $d{constructor(){super(!0,16)}}class Rce extends $d{constructor(){super(!0,32)}}class Bce extends $d{constructor(){super(!1,8)}}class zce extends $d{constructor(){super(!1,16)}}class Oce extends $d{constructor(){super(!1,32)}}const XO={HALF:16,SINGLE:32,DOUBLE:64};ZO=Symbol.toStringTag;class KO extends $S{constructor(e){super(),oe(this,"precision",void 0),this.precision=e}get typeId(){return Ci.Float}get[ZO](){return"Float"}toString(){return"Float".concat(this.precision)}}class Fce extends KO{constructor(){super(XO.SINGLE)}}class Nce extends KO{constructor(){super(XO.DOUBLE)}}YO=Symbol.toStringTag;class Uce extends $S{constructor(e,n){super(),oe(this,"listSize",void 0),oe(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return Ci.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[YO](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function Vce(t){switch(t.constructor){case Int8Array:return new Lce;case Uint8Array:return new Bce;case Int16Array:return new Dce;case Uint16Array:return new zce;case Int32Array:return new Rce;case Uint32Array:return new Oce;case Float32Array:return new Fce;case Float64Array:return new Nce;default:throw new Error("array type not supported")}}function o6(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),sr.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function a6(t,e){if(t.attributes)return o6(t.attributes,e),t instanceof Yu?t:new Yu(t);if(t.positions||t.POSITION)return o6(t,e),new Yu({attributes:t});throw Error("Invalid mesh")}const Gce=[0,0,0,255],$ce={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Gce},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class yv extends mA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){const e=!cr(this.context.gl),n={};return WR(this.context.gl,Jr.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:Mce,fs:Pce,modules:[Bf,uX,zf],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:r}=this.props;if(!r)return null;if(n=(e=r.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:i}=a6(r,this.props._useMeshColors);i.POSITION=i.POSITION||i.positions,n=QO(i)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:Sce}),this.setState({emptyTexture:new ca(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e;if(n.mesh!==r.mesh||i.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const l=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(l.NORMAL||l.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:r,coordinateSystem:i,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:r,composeModelMatrix:!s||Cce(n,i),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new sc(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:a6(e,this.props._useMeshColors),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:i}=this.state;return n.setUniforms({sampler:r||i,hasTexture:!!r}),n}setTexture(e){const{emptyTexture:n,model:r}=this.state;r&&r.setUniforms({sampler:e||n,hasTexture:!!e})}}oe(yv,"defaultProps",$ce);oe(yv,"layerName","SimpleMeshLayer");const jce={inject:{"vs:#decl":`
attribute vec2 instanceDashArrays;
attribute float instanceDashOffsets;
varying vec2 vDashArray;
varying float vDashOffset;
`,"vs:#main-end":`
vDashArray = instanceDashArrays;
vDashOffset = instanceDashOffsets / width.x;
`,"fs:#decl":`
uniform float dashAlignMode;
uniform float capType;
uniform bool dashGapPickable;
varying vec2 vDashArray;
varying float vDashOffset;

float round(float x) {
  return floor(x + 0.5);
}
`,"fs:#main-start":`
  float solidLength = vDashArray.x;
  float gapLength = vDashArray.y;
  float unitLength = solidLength + gapLength;

  float offset;

  if (unitLength > 0.0) {
    if (dashAlignMode == 0.0) {
      offset = vDashOffset;
    } else {
      unitLength = vPathLength / round(vPathLength / unitLength);
      offset = solidLength / 2.0;
    }

    float unitOffset = mod(vPathPosition.y + offset, unitLength);

    if (gapLength > 0.0 && unitOffset > solidLength) {
      if (capType <= 0.5) {
        if (!(dashGapPickable && picking_uActive)) {
          discard;
        }
      } else {
        float distToEnd = length(vec2(
          min(unitOffset - solidLength, unitLength - unitOffset),
          vPathPosition.x
        ));
        if (distToEnd > 1.0) {
          if (!(dashGapPickable && picking_uActive)) {
            discard;
          }
        }
      }
    }
  }
`}},Hce={inject:{"vs:#decl":`
attribute float instanceOffsets;
`,"vs:DECKGL_FILTER_SIZE":`
  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
  size *= offsetWidth;
`,"vs:#main-end":`
  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
  float offsetDir = sign(instanceOffsets);
  vPathPosition.x = (vPathPosition.x + offsetDir) * offsetWidth - offsetDir;
  vPathPosition.y *= offsetWidth;
  vPathLength *= offsetWidth;
`,"fs:#main-start":`
  float isInside;
  isInside = step(-1.0, vPathPosition.x) * step(vPathPosition.x, 1.0);
  if (isInside == 0.0) {
    discard;
  }
`}},Wce={getDashArray:{type:"accessor",value:[0,0]},getOffset:{type:"accessor",value:0},dashJustified:!1,dashGapPickable:!1};class Gf extends dS{constructor({dash:e=!1,offset:n=!1,highPrecisionDash:r=!1}={}){super({dash:e||r,offset:n,highPrecisionDash:r})}isEnabled(e){return"pathTesselator"in e.state}getShaders(e){if(!e.isEnabled(this))return null;let n={};return e.opts.dash&&(n=F3(n,jce)),e.opts.offset&&(n=F3(n,Hce)),n}initializeState(e,n){const r=this.getAttributeManager();!r||!n.isEnabled(this)||(n.opts.dash&&r.addInstanced({instanceDashArrays:{size:2,accessor:"getDashArray"}}),n.opts.highPrecisionDash&&r.addInstanced({instanceDashOffsets:{size:1,accessor:"getPath",transform:n.getDashOffsets.bind(this)}}),n.opts.offset&&r.addInstanced({instanceOffsets:{size:1,accessor:"getOffset"}}))}updateState(e,n){if(!n.isEnabled(this))return;const r={};n.opts.dash&&(r.dashAlignMode=this.props.dashJustified?1:0,r.dashGapPickable=!!this.props.dashGapPickable),this.state.model.setUniforms(r)}getDashOffsets(e){const n=[0],r=this.props.positionFormat==="XY"?2:3,i=Array.isArray(e[0]),s=i?e.length:e.length/r;let l,o;for(let p=0;p<s-1;p++)l=i?e[p]:e.slice(p*r,p*r+r),l=this.projectPosition(l),p>0&&(n[p]=n[p-1]+eY(o,l)),o=l;return n}}oe(Gf,"defaultProps",Wce);oe(Gf,"extensionName","PathStyleExtension");function JO(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Qce(t){return t.length===1&&(t=qce(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}function qce(t){return function(e,n){return JO(t(e),n)}}Qce(JO);function nm(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var Zw=Array.prototype.slice;function Zce(t){return t}var Wy=1,Qy=2,uE=3,ay=4,l6=1e-6;function Yce(t){return"translate("+(t+.5)+",0)"}function Xce(t){return"translate(0,"+(t+.5)+")"}function Kce(t){return function(e){return+t(e)}}function Jce(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function ehe(){return!this.__axis}function jS(t,e){var n=[],r=null,i=null,s=6,l=6,o=3,p=t===Wy||t===ay?-1:1,w=t===ay||t===Qy?"x":"y",C=t===Wy||t===uE?Yce:Xce;function P(I){var U=r??(e.ticks?e.ticks.apply(e,n):e.domain()),W=i??(e.tickFormat?e.tickFormat.apply(e,n):Zce),H=Math.max(s,0)+o,ie=e.range(),X=+ie[0]+.5,ee=+ie[ie.length-1]+.5,se=(e.bandwidth?Jce:Kce)(e.copy()),fe=I.selection?I.selection():I,me=fe.selectAll(".domain").data([null]),Se=fe.selectAll(".tick").data(U,e).order(),He=Se.exit(),Qe=Se.enter().append("g").attr("class","tick"),Ke=Se.select("line"),rt=Se.select("text");me=me.merge(me.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Se=Se.merge(Qe),Ke=Ke.merge(Qe.append("line").attr("stroke","currentColor").attr(w+"2",p*s)),rt=rt.merge(Qe.append("text").attr("fill","currentColor").attr(w,p*H).attr("dy",t===Wy?"0em":t===uE?"0.71em":"0.32em")),I!==fe&&(me=me.transition(I),Se=Se.transition(I),Ke=Ke.transition(I),rt=rt.transition(I),He=He.transition(I).attr("opacity",l6).attr("transform",function(Ue){return isFinite(Ue=se(Ue))?C(Ue):this.getAttribute("transform")}),Qe.attr("opacity",l6).attr("transform",function(Ue){var it=this.parentNode.__axis;return C(it&&isFinite(it=it(Ue))?it:se(Ue))})),He.remove(),me.attr("d",t===ay||t==Qy?l?"M"+p*l+","+X+"H0.5V"+ee+"H"+p*l:"M0.5,"+X+"V"+ee:l?"M"+X+","+p*l+"V0.5H"+ee+"V"+p*l:"M"+X+",0.5H"+ee),Se.attr("opacity",1).attr("transform",function(Ue){return C(se(Ue))}),Ke.attr(w+"2",p*s),rt.attr(w,p*H).text(W),fe.filter(ehe).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Qy?"start":t===ay?"end":"middle"),fe.each(function(){this.__axis=se})}return P.scale=function(I){return arguments.length?(e=I,P):e},P.ticks=function(){return n=Zw.call(arguments),P},P.tickArguments=function(I){return arguments.length?(n=I==null?[]:Zw.call(I),P):n.slice()},P.tickValues=function(I){return arguments.length?(r=I==null?null:Zw.call(I),P):r&&r.slice()},P.tickFormat=function(I){return arguments.length?(i=I,P):i},P.tickSize=function(I){return arguments.length?(s=l=+I,P):s},P.tickSizeInner=function(I){return arguments.length?(s=+I,P):s},P.tickSizeOuter=function(I){return arguments.length?(l=+I,P):l},P.tickPadding=function(I){return arguments.length?(o=+I,P):o},P}function the(t){return jS(Wy,t)}function eF(t){return jS(Qy,t)}function nhe(t){return jS(uE,t)}var rhe={value:function(){}};function tF(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new qy(n)}function qy(t){this._=t}function ihe(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}qy.prototype=tF.prototype={constructor:qy,on:function(t,e){var n=this._,r=ihe(t+"",n),i,s=-1,l=r.length;if(arguments.length<2){for(;++s<l;)if((i=(t=r[s]).type)&&(i=she(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<l;)if(i=(t=r[s]).type)n[i]=A6(n[i],t.name,e);else if(e==null)for(i in n)n[i]=A6(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new qy(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function she(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function A6(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=rhe,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var cE="http://www.w3.org/1999/xhtml";const u6={svg:"http://www.w3.org/2000/svg",xhtml:cE,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function _v(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),u6.hasOwnProperty(e)?{space:u6[e],local:t}:t}function ohe(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===cE&&e.documentElement.namespaceURI===cE?e.createElement(t):e.createElementNS(n,t)}}function ahe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function nF(t){var e=_v(t);return(e.local?ahe:ohe)(e)}function lhe(){}function HS(t){return t==null?lhe:function(){return this.querySelector(t)}}function Ahe(t){typeof t!="function"&&(t=HS(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=new Array(l),p,w,C=0;C<l;++C)(p=s[C])&&(w=t.call(p,p.__data__,C,s))&&("__data__"in p&&(w.__data__=p.__data__),o[C]=w);return new gA(r,this._parents)}function uhe(){return[]}function rF(t){return t==null?uhe:function(){return this.querySelectorAll(t)}}function che(t){typeof t!="function"&&(t=rF(t));for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var l=e[s],o=l.length,p,w=0;w<o;++w)(p=l[w])&&(r.push(t.call(p,p.__data__,w,l)),i.push(p));return new gA(r,i)}function iF(t){return function(){return this.matches(t)}}function hhe(t){typeof t!="function"&&(t=iF(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=[],p,w=0;w<l;++w)(p=s[w])&&t.call(p,p.__data__,w,s)&&o.push(p);return new gA(r,this._parents)}function sF(t){return new Array(t.length)}function fhe(){return new gA(this._enter||this._groups.map(sF),this._parents)}function l2(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}l2.prototype={constructor:l2,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function dhe(t){return function(){return t}}var c6="$";function phe(t,e,n,r,i,s){for(var l=0,o,p=e.length,w=s.length;l<w;++l)(o=e[l])?(o.__data__=s[l],r[l]=o):n[l]=new l2(t,s[l]);for(;l<p;++l)(o=e[l])&&(i[l]=o)}function ghe(t,e,n,r,i,s,l){var o,p,w={},C=e.length,P=s.length,I=new Array(C),U;for(o=0;o<C;++o)(p=e[o])&&(I[o]=U=c6+l.call(p,p.__data__,o,e),U in w?i[o]=p:w[U]=p);for(o=0;o<P;++o)U=c6+l.call(t,s[o],o,s),(p=w[U])?(r[o]=p,p.__data__=s[o],w[U]=null):n[o]=new l2(t,s[o]);for(o=0;o<C;++o)(p=e[o])&&w[I[o]]===p&&(i[o]=p)}function mhe(t,e){if(!t)return U=new Array(this.size()),w=-1,this.each(function(Se){U[++w]=Se}),U;var n=e?ghe:phe,r=this._parents,i=this._groups;typeof t!="function"&&(t=dhe(t));for(var s=i.length,l=new Array(s),o=new Array(s),p=new Array(s),w=0;w<s;++w){var C=r[w],P=i[w],I=P.length,U=t.call(C,C&&C.__data__,w,r),W=U.length,H=o[w]=new Array(W),ie=l[w]=new Array(W),X=p[w]=new Array(I);n(C,P,H,ie,X,U,e);for(var ee=0,se=0,fe,me;ee<W;++ee)if(fe=H[ee]){for(ee>=se&&(se=ee+1);!(me=ie[se])&&++se<W;);fe._next=me||null}}return l=new gA(l,r),l._enter=o,l._exit=p,l}function yhe(){return new gA(this._exit||this._groups.map(sF),this._parents)}function _he(t,e,n){var r=this.enter(),i=this,s=this.exit();return r=typeof t=="function"?t(r):r.append(t+""),e!=null&&(i=e(i)),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function vhe(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),l=new Array(r),o=0;o<s;++o)for(var p=e[o],w=n[o],C=p.length,P=l[o]=new Array(C),I,U=0;U<C;++U)(I=p[U]||w[U])&&(P[U]=I);for(;o<r;++o)l[o]=e[o];return new gA(l,this._parents)}function xhe(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],l;--i>=0;)(l=r[i])&&(s&&l.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(l,s),s=l);return this}function whe(t){t||(t=bhe);function e(P,I){return P&&I?t(P.__data__,I.__data__):!P-!I}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var l=n[s],o=l.length,p=i[s]=new Array(o),w,C=0;C<o;++C)(w=l[C])&&(p[C]=w);p.sort(e)}return new gA(i,this._parents).order()}function bhe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ehe(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function The(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function She(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var l=r[i];if(l)return l}return null}function Che(){var t=0;return this.each(function(){++t}),t}function Mhe(){return!this.node()}function Phe(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,l=i.length,o;s<l;++s)(o=i[s])&&t.call(o,o.__data__,s,i);return this}function khe(t){return function(){this.removeAttribute(t)}}function Ihe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Lhe(t,e){return function(){this.setAttribute(t,e)}}function Dhe(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Rhe(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Bhe(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function zhe(t,e){var n=_v(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Ihe:khe:typeof e=="function"?n.local?Bhe:Rhe:n.local?Dhe:Lhe)(n,e))}function oF(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ohe(t){return function(){this.style.removeProperty(t)}}function Fhe(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Nhe(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Uhe(t,e,n){return arguments.length>1?this.each((e==null?Ohe:typeof e=="function"?Nhe:Fhe)(t,e,n??"")):Sd(this.node(),t)}function Sd(t,e){return t.style.getPropertyValue(e)||oF(t).getComputedStyle(t,null).getPropertyValue(e)}function Vhe(t){return function(){delete this[t]}}function Ghe(t,e){return function(){this[t]=e}}function $he(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function jhe(t,e){return arguments.length>1?this.each((e==null?Vhe:typeof e=="function"?$he:Ghe)(t,e)):this.node()[t]}function aF(t){return t.trim().split(/^|\s+/)}function WS(t){return t.classList||new lF(t)}function lF(t){this._node=t,this._names=aF(t.getAttribute("class")||"")}lF.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function AF(t,e){for(var n=WS(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function uF(t,e){for(var n=WS(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Hhe(t){return function(){AF(this,t)}}function Whe(t){return function(){uF(this,t)}}function Qhe(t,e){return function(){(e.apply(this,arguments)?AF:uF)(this,t)}}function qhe(t,e){var n=aF(t+"");if(arguments.length<2){for(var r=WS(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Qhe:e?Hhe:Whe)(n,e))}function Zhe(){this.textContent=""}function Yhe(t){return function(){this.textContent=t}}function Xhe(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Khe(t){return arguments.length?this.each(t==null?Zhe:(typeof t=="function"?Xhe:Yhe)(t)):this.node().textContent}function Jhe(){this.innerHTML=""}function efe(t){return function(){this.innerHTML=t}}function tfe(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function nfe(t){return arguments.length?this.each(t==null?Jhe:(typeof t=="function"?tfe:efe)(t)):this.node().innerHTML}function rfe(){this.nextSibling&&this.parentNode.appendChild(this)}function ife(){return this.each(rfe)}function sfe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ofe(){return this.each(sfe)}function afe(t){var e=typeof t=="function"?t:nF(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function lfe(){return null}function Afe(t,e){var n=typeof t=="function"?t:nF(t),r=e==null?lfe:typeof e=="function"?e:HS(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ufe(){var t=this.parentNode;t&&t.removeChild(this)}function cfe(){return this.each(ufe)}function hfe(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ffe(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function dfe(t){return this.select(t?ffe:hfe)}function pfe(t){return arguments.length?this.property("__data__",t):this.node().__data__}var cF={};if(typeof document<"u"){var gfe=document.documentElement;"onmouseenter"in gfe||(cF={mouseenter:"mouseover",mouseleave:"mouseout"})}function mfe(t,e,n){return t=hF(t,e,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&t.call(this,r)}}function hF(t,e,n){return function(r){try{t.call(this,this.__data__,e,n)}finally{}}}function yfe(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function _fe(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.capture):e[++r]=s;++r?e.length=r:delete this.__on}}}function vfe(t,e,n){var r=cF.hasOwnProperty(t.type)?mfe:hF;return function(i,s,l){var o=this.__on,p,w=r(e,s,l);if(o){for(var C=0,P=o.length;C<P;++C)if((p=o[C]).type===t.type&&p.name===t.name){this.removeEventListener(p.type,p.listener,p.capture),this.addEventListener(p.type,p.listener=w,p.capture=n),p.value=e;return}}this.addEventListener(t.type,w,n),p={type:t.type,name:t.name,value:e,listener:w,capture:n},o?o.push(p):this.__on=[p]}}function xfe(t,e,n){var r=yfe(t+""),i,s=r.length,l;if(arguments.length<2){var o=this.node().__on;if(o){for(var p=0,w=o.length,C;p<w;++p)for(i=0,C=o[p];i<s;++i)if((l=r[i]).type===C.type&&l.name===C.name)return C.value}return}for(o=e?vfe:_fe,n==null&&(n=!1),i=0;i<s;++i)this.each(o(r[i],e,n));return this}function fF(t,e,n){var r=oF(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function wfe(t,e){return function(){return fF(this,t,e)}}function bfe(t,e){return function(){return fF(this,t,e.apply(this,arguments))}}function Efe(t,e){return this.each((typeof e=="function"?bfe:wfe)(t,e))}var Tfe=[null];function gA(t,e){this._groups=t,this._parents=e}function Om(){return new gA([[document.documentElement]],Tfe)}gA.prototype=Om.prototype={constructor:gA,select:Ahe,selectAll:che,filter:hhe,data:mhe,enter:fhe,exit:yhe,join:_he,merge:vhe,order:xhe,sort:whe,call:Ehe,nodes:The,node:She,size:Che,empty:Mhe,each:Phe,attr:zhe,style:Uhe,property:jhe,classed:qhe,text:Khe,html:nfe,raise:ife,lower:ofe,append:afe,insert:Afe,remove:cfe,clone:dfe,datum:pfe,on:xfe,dispatch:Efe};function Fm(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function vv(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function $f(){}var rm=.7,A2=1/rm,td="\\s*([+-]?\\d+)\\s*",im="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",JA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Sfe=/^#([0-9a-f]{3,8})$/,Cfe=new RegExp("^rgb\\("+[td,td,td]+"\\)$"),Mfe=new RegExp("^rgb\\("+[JA,JA,JA]+"\\)$"),Pfe=new RegExp("^rgba\\("+[td,td,td,im]+"\\)$"),kfe=new RegExp("^rgba\\("+[JA,JA,JA,im]+"\\)$"),Ife=new RegExp("^hsl\\("+[im,JA,JA]+"\\)$"),Lfe=new RegExp("^hsla\\("+[im,JA,JA,im]+"\\)$"),h6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Fm($f,Ef,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:f6,formatHex:f6,formatHsl:Dfe,formatRgb:d6,toString:d6});function f6(){return this.rgb().formatHex()}function Dfe(){return pF(this).formatHsl()}function d6(){return this.rgb().formatRgb()}function Ef(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Sfe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?p6(e):n===3?new Ro(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ly(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ly(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Cfe.exec(t))?new Ro(e[1],e[2],e[3],1):(e=Mfe.exec(t))?new Ro(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Pfe.exec(t))?ly(e[1],e[2],e[3],e[4]):(e=kfe.exec(t))?ly(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Ife.exec(t))?y6(e[1],e[2]/100,e[3]/100,1):(e=Lfe.exec(t))?y6(e[1],e[2]/100,e[3]/100,e[4]):h6.hasOwnProperty(t)?p6(h6[t]):t==="transparent"?new Ro(NaN,NaN,NaN,0):null}function p6(t){return new Ro(t>>16&255,t>>8&255,t&255,1)}function ly(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ro(t,e,n,r)}function dF(t){return t instanceof $f||(t=Ef(t)),t?(t=t.rgb(),new Ro(t.r,t.g,t.b,t.opacity)):new Ro}function hE(t,e,n,r){return arguments.length===1?dF(t):new Ro(t,e,n,r??1)}function Ro(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Fm(Ro,hE,vv($f,{brighter:function(t){return t=t==null?A2:Math.pow(A2,t),new Ro(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?rm:Math.pow(rm,t),new Ro(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:g6,formatHex:g6,formatRgb:m6,toString:m6}));function g6(){return"#"+Yw(this.r)+Yw(this.g)+Yw(this.b)}function m6(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function Yw(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function y6(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new WA(t,e,n,r)}function pF(t){if(t instanceof WA)return new WA(t.h,t.s,t.l,t.opacity);if(t instanceof $f||(t=Ef(t)),!t)return new WA;if(t instanceof WA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),l=NaN,o=s-i,p=(s+i)/2;return o?(e===s?l=(n-r)/o+(n<r)*6:n===s?l=(r-e)/o+2:l=(e-n)/o+4,o/=p<.5?s+i:2-s-i,l*=60):o=p>0&&p<1?0:l,new WA(l,o,p,t.opacity)}function fE(t,e,n,r){return arguments.length===1?pF(t):new WA(t,e,n,r??1)}function WA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Fm(WA,fE,vv($f,{brighter:function(t){return t=t==null?A2:Math.pow(A2,t),new WA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?rm:Math.pow(rm,t),new WA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ro(Xw(t>=240?t-240:t+120,i,r),Xw(t,i,r),Xw(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function Xw(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}var Rfe=Math.PI/180,Bfe=180/Math.PI,u2=18,gF=.96422,mF=1,yF=.82521,_F=4/29,nd=6/29,vF=3*nd*nd,zfe=nd*nd*nd;function xF(t){if(t instanceof eu)return new eu(t.l,t.a,t.b,t.opacity);if(t instanceof Qu)return wF(t);t instanceof Ro||(t=dF(t));var e=tb(t.r),n=tb(t.g),r=tb(t.b),i=Kw((.2225045*e+.7168786*n+.0606169*r)/mF),s,l;return e===n&&n===r?s=l=i:(s=Kw((.4360747*e+.3850649*n+.1430804*r)/gF),l=Kw((.0139322*e+.0971045*n+.7141733*r)/yF)),new eu(116*i-16,500*(s-i),200*(i-l),t.opacity)}function sm(t,e,n,r){return arguments.length===1?xF(t):new eu(t,e,n,r??1)}function eu(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}Fm(eu,sm,vv($f,{brighter:function(t){return new eu(this.l+u2*(t??1),this.a,this.b,this.opacity)},darker:function(t){return new eu(this.l-u2*(t??1),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=gF*Jw(e),t=mF*Jw(t),n=yF*Jw(n),new Ro(eb(3.1338561*e-1.6168667*t-.4906146*n),eb(-.9787684*e+1.9161415*t+.033454*n),eb(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function Kw(t){return t>zfe?Math.pow(t,1/3):t/vF+_F}function Jw(t){return t>nd?t*t*t:vF*(t-_F)}function eb(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function tb(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ofe(t){if(t instanceof Qu)return new Qu(t.h,t.c,t.l,t.opacity);if(t instanceof eu||(t=xF(t)),t.a===0&&t.b===0)return new Qu(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Bfe;return new Qu(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Ffe(t,e,n,r){return arguments.length===1?Ofe(t):new Qu(t,e,n,r??1)}function Qu(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function wF(t){if(isNaN(t.h))return new eu(t.l,0,0,t.opacity);var e=t.h*Rfe;return new eu(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Fm(Qu,Ffe,vv($f,{brighter:function(t){return new Qu(this.h,this.c,this.l+u2*(t??1),this.opacity)},darker:function(t){return new Qu(this.h,this.c,this.l-u2*(t??1),this.opacity)},rgb:function(){return wF(this).rgb()}}));function bF(t){return function(){return t}}function Nfe(t,e){return function(n){return t+n*e}}function Ufe(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Vfe(t){return(t=+t)==1?F0:function(e,n){return n-e?Ufe(e,n,t):bF(isNaN(e)?n:e)}}function F0(t,e){var n=e-t;return n?Nfe(t,n):bF(isNaN(t)?e:t)}const _6=function t(e){var n=Vfe(e);function r(i,s){var l=n((i=hE(i)).r,(s=hE(s)).r),o=n(i.g,s.g),p=n(i.b,s.b),w=F0(i.opacity,s.opacity);return function(C){return i.r=l(C),i.g=o(C),i.b=p(C),i.opacity=w(C),i+""}}return r.gamma=t,r}(1);function Hc(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var dE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nb=new RegExp(dE.source,"g");function Gfe(t){return function(){return t}}function $fe(t){return function(e){return t(e)+""}}function jfe(t,e){var n=dE.lastIndex=nb.lastIndex=0,r,i,s,l=-1,o=[],p=[];for(t=t+"",e=e+"";(r=dE.exec(t))&&(i=nb.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[l]?o[l]+=s:o[++l]=s),(r=r[0])===(i=i[0])?o[l]?o[l]+=i:o[++l]=i:(o[++l]=null,p.push({i:l,x:Hc(r,i)})),n=nb.lastIndex;return n<e.length&&(s=e.slice(n),o[l]?o[l]+=s:o[++l]=s),o.length<2?p[0]?$fe(p[0].x):Gfe(e):(e=p.length,function(w){for(var C=0,P;C<e;++C)o[(P=p[C]).i]=P.x(w);return o.join("")})}var v6=180/Math.PI,pE={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function EF(t,e,n,r,i,s){var l,o,p;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(p=t*n+e*r)&&(n-=t*p,r-=e*p),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,p/=o),t*r<e*n&&(t=-t,e=-e,p=-p,l=-l),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*v6,skewX:Math.atan(p)*v6,scaleX:l,scaleY:o}}var zp,rb,x6,Ay;function Hfe(t){return t==="none"?pE:(zp||(zp=document.createElement("DIV"),rb=document.documentElement,x6=document.defaultView),zp.style.transform=t,t=x6.getComputedStyle(rb.appendChild(zp),null).getPropertyValue("transform"),rb.removeChild(zp),t=t.slice(7,-1).split(","),EF(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function Wfe(t){return t==null||(Ay||(Ay=document.createElementNS("http://www.w3.org/2000/svg","g")),Ay.setAttribute("transform",t),!(t=Ay.transform.baseVal.consolidate()))?pE:(t=t.matrix,EF(t.a,t.b,t.c,t.d,t.e,t.f))}function TF(t,e,n,r){function i(w){return w.length?w.pop()+" ":""}function s(w,C,P,I,U,W){if(w!==P||C!==I){var H=U.push("translate(",null,e,null,n);W.push({i:H-4,x:Hc(w,P)},{i:H-2,x:Hc(C,I)})}else(P||I)&&U.push("translate("+P+e+I+n)}function l(w,C,P,I){w!==C?(w-C>180?C+=360:C-w>180&&(w+=360),I.push({i:P.push(i(P)+"rotate(",null,r)-2,x:Hc(w,C)})):C&&P.push(i(P)+"rotate("+C+r)}function o(w,C,P,I){w!==C?I.push({i:P.push(i(P)+"skewX(",null,r)-2,x:Hc(w,C)}):C&&P.push(i(P)+"skewX("+C+r)}function p(w,C,P,I,U,W){if(w!==P||C!==I){var H=U.push(i(U)+"scale(",null,",",null,")");W.push({i:H-4,x:Hc(w,P)},{i:H-2,x:Hc(C,I)})}else(P!==1||I!==1)&&U.push(i(U)+"scale("+P+","+I+")")}return function(w,C){var P=[],I=[];return w=t(w),C=t(C),s(w.translateX,w.translateY,C.translateX,C.translateY,P,I),l(w.rotate,C.rotate,P,I),o(w.skewX,C.skewX,P,I),p(w.scaleX,w.scaleY,C.scaleX,C.scaleY,P,I),w=C=null,function(U){for(var W=-1,H=I.length,ie;++W<H;)P[(ie=I[W]).i]=ie.x(U);return P.join("")}}}var Qfe=TF(Hfe,"px, ","px)","deg)"),qfe=TF(Wfe,", ",")",")");function Zfe(t,e){var n=F0((t=sm(t)).l,(e=sm(e)).l),r=F0(t.a,e.a),i=F0(t.b,e.b),s=F0(t.opacity,e.opacity);return function(l){return t.l=n(l),t.a=r(l),t.b=i(l),t.opacity=s(l),t+""}}var Cd=0,tg=0,Op=0,SF=1e3,c2,ng,h2=0,Tf=0,xv=0,om=typeof performance=="object"&&performance.now?performance:Date,CF=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function wv(){return Tf||(CF(Yfe),Tf=om.now()+xv)}function Yfe(){Tf=0}function f2(){this._call=this._time=this._next=null}f2.prototype=MF.prototype={constructor:f2,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?wv():+n)+(e==null?0:+e),!this._next&&ng!==this&&(ng?ng._next=this:c2=this,ng=this),this._call=t,this._time=n,gE()},stop:function(){this._call&&(this._call=null,this._time=1/0,gE())}};function MF(t,e,n){var r=new f2;return r.restart(t,e,n),r}function Xfe(){wv(),++Cd;for(var t=c2,e;t;)(e=Tf-t._time)>=0&&t._call.call(null,e),t=t._next;--Cd}function w6(){Tf=(h2=om.now())+xv,Cd=tg=0;try{Xfe()}finally{Cd=0,Jfe(),Tf=0}}function Kfe(){var t=om.now(),e=t-h2;e>SF&&(xv-=e,h2=t)}function Jfe(){for(var t,e=c2,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:c2=n);ng=t,gE(r)}function gE(t){if(!Cd){tg&&(tg=clearTimeout(tg));var e=t-Tf;e>24?(t<1/0&&(tg=setTimeout(w6,t-om.now()-xv)),Op&&(Op=clearInterval(Op))):(Op||(h2=om.now(),Op=setInterval(Kfe,SF)),Cd=1,CF(w6))}}function b6(t,e,n){var r=new f2;return e=e==null?0:+e,r.restart(function(i){r.stop(),t(i+e)},e,n),r}var e0e=tF("start","end","cancel","interrupt"),t0e=[],PF=0,E6=1,mE=2,Zy=3,T6=4,yE=5,Yy=6;function bv(t,e,n,r,i,s){var l=t.__transition;if(!l)t.__transition={};else if(n in l)return;n0e(t,n,{name:e,index:r,group:i,on:e0e,tween:t0e,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:PF})}function QS(t,e){var n=_A(t,e);if(n.state>PF)throw new Error("too late; already scheduled");return n}function mc(t,e){var n=_A(t,e);if(n.state>Zy)throw new Error("too late; already running");return n}function _A(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function n0e(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=MF(s,0,n.time);function s(w){n.state=E6,n.timer.restart(l,n.delay,n.time),n.delay<=w&&l(w-n.delay)}function l(w){var C,P,I,U;if(n.state!==E6)return p();for(C in r)if(U=r[C],U.name===n.name){if(U.state===Zy)return b6(l);U.state===T6?(U.state=Yy,U.timer.stop(),U.on.call("interrupt",t,t.__data__,U.index,U.group),delete r[C]):+C<e&&(U.state=Yy,U.timer.stop(),U.on.call("cancel",t,t.__data__,U.index,U.group),delete r[C])}if(b6(function(){n.state===Zy&&(n.state=T6,n.timer.restart(o,n.delay,n.time),o(w))}),n.state=mE,n.on.call("start",t,t.__data__,n.index,n.group),n.state===mE){for(n.state=Zy,i=new Array(I=n.tween.length),C=0,P=-1;C<I;++C)(U=n.tween[C].value.call(t,t.__data__,n.index,n.group))&&(i[++P]=U);i.length=P+1}}function o(w){for(var C=w<n.duration?n.ease.call(null,w/n.duration):(n.timer.restart(p),n.state=yE,1),P=-1,I=i.length;++P<I;)i[P].call(t,C);n.state===yE&&(n.on.call("end",t,t.__data__,n.index,n.group),p())}function p(){n.state=Yy,n.timer.stop(),delete r[e];for(var w in r)return;delete t.__transition}}function r0e(t,e){var n=t.__transition,r,i,s=!0,l;if(n){e=e==null?null:e+"";for(l in n){if((r=n[l]).name!==e){s=!1;continue}i=r.state>mE&&r.state<yE,r.state=Yy,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[l]}s&&delete t.__transition}}function i0e(t){return this.each(function(){r0e(this,t)})}function s0e(t,e){var n,r;return function(){var i=mc(this,t),s=i.tween;if(s!==n){r=n=s;for(var l=0,o=r.length;l<o;++l)if(r[l].name===e){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function o0e(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=mc(this,t),l=s.tween;if(l!==r){i=(r=l).slice();for(var o={name:e,value:n},p=0,w=i.length;p<w;++p)if(i[p].name===e){i[p]=o;break}p===w&&i.push(o)}s.tween=i}}function a0e(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=_A(this.node(),n).tween,i=0,s=r.length,l;i<s;++i)if((l=r[i]).name===t)return l.value;return null}return this.each((e==null?s0e:o0e)(n,t,e))}function qS(t,e,n){var r=t._id;return t.each(function(){var i=mc(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return _A(i,r).value[e]}}function kF(t,e){var n;return(typeof e=="number"?Hc:e instanceof Ef?_6:(n=Ef(e))?(e=n,_6):jfe)(t,e)}function l0e(t){return function(){this.removeAttribute(t)}}function A0e(t){return function(){this.removeAttributeNS(t.space,t.local)}}function u0e(t,e,n){var r,i=n+"",s;return function(){var l=this.getAttribute(t);return l===i?null:l===r?s:s=e(r=l,n)}}function c0e(t,e,n){var r,i=n+"",s;return function(){var l=this.getAttributeNS(t.space,t.local);return l===i?null:l===r?s:s=e(r=l,n)}}function h0e(t,e,n){var r,i,s;return function(){var l,o=n(this),p;return o==null?void this.removeAttribute(t):(l=this.getAttribute(t),p=o+"",l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o)))}}function f0e(t,e,n){var r,i,s;return function(){var l,o=n(this),p;return o==null?void this.removeAttributeNS(t.space,t.local):(l=this.getAttributeNS(t.space,t.local),p=o+"",l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o)))}}function d0e(t,e){var n=_v(t),r=n==="transform"?qfe:kF;return this.attrTween(t,typeof e=="function"?(n.local?f0e:h0e)(n,r,qS(this,"attr."+t,e)):e==null?(n.local?A0e:l0e)(n):(n.local?c0e:u0e)(n,r,e))}function p0e(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function g0e(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function m0e(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&g0e(t,s)),n}return i._value=e,i}function y0e(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&p0e(t,s)),n}return i._value=e,i}function _0e(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=_v(t);return this.tween(n,(r.local?m0e:y0e)(r,e))}function v0e(t,e){return function(){QS(this,t).delay=+e.apply(this,arguments)}}function x0e(t,e){return e=+e,function(){QS(this,t).delay=e}}function w0e(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?v0e:x0e)(e,t)):_A(this.node(),e).delay}function b0e(t,e){return function(){mc(this,t).duration=+e.apply(this,arguments)}}function E0e(t,e){return e=+e,function(){mc(this,t).duration=e}}function T0e(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?b0e:E0e)(e,t)):_A(this.node(),e).duration}function S0e(t,e){if(typeof e!="function")throw new Error;return function(){mc(this,t).ease=e}}function C0e(t){var e=this._id;return arguments.length?this.each(S0e(e,t)):_A(this.node(),e).ease}function M0e(t){typeof t!="function"&&(t=iF(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=[],p,w=0;w<l;++w)(p=s[w])&&t.call(p,p.__data__,w,s)&&o.push(p);return new hc(r,this._parents,this._name,this._id)}function P0e(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),l=new Array(r),o=0;o<s;++o)for(var p=e[o],w=n[o],C=p.length,P=l[o]=new Array(C),I,U=0;U<C;++U)(I=p[U]||w[U])&&(P[U]=I);for(;o<r;++o)l[o]=e[o];return new hc(l,this._parents,this._name,this._id)}function k0e(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function I0e(t,e,n){var r,i,s=k0e(e)?QS:mc;return function(){var l=s(this,t),o=l.on;o!==r&&(i=(r=o).copy()).on(e,n),l.on=i}}function L0e(t,e){var n=this._id;return arguments.length<2?_A(this.node(),n).on.on(t):this.each(I0e(n,t,e))}function D0e(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function R0e(){return this.on("end.remove",D0e(this._id))}function B0e(t){var e=this._name,n=this._id;typeof t!="function"&&(t=HS(t));for(var r=this._groups,i=r.length,s=new Array(i),l=0;l<i;++l)for(var o=r[l],p=o.length,w=s[l]=new Array(p),C,P,I=0;I<p;++I)(C=o[I])&&(P=t.call(C,C.__data__,I,o))&&("__data__"in C&&(P.__data__=C.__data__),w[I]=P,bv(w[I],e,n,I,w,_A(C,n)));return new hc(s,this._parents,e,n)}function z0e(t){var e=this._name,n=this._id;typeof t!="function"&&(t=rF(t));for(var r=this._groups,i=r.length,s=[],l=[],o=0;o<i;++o)for(var p=r[o],w=p.length,C,P=0;P<w;++P)if(C=p[P]){for(var I=t.call(C,C.__data__,P,p),U,W=_A(C,n),H=0,ie=I.length;H<ie;++H)(U=I[H])&&bv(U,e,n,H,I,W);s.push(I),l.push(C)}return new hc(s,l,e,n)}var O0e=Om.prototype.constructor;function F0e(){return new O0e(this._groups,this._parents)}function N0e(t,e){var n,r,i;return function(){var s=Sd(this,t),l=(this.style.removeProperty(t),Sd(this,t));return s===l?null:s===n&&l===r?i:i=e(n=s,r=l)}}function IF(t){return function(){this.style.removeProperty(t)}}function U0e(t,e,n){var r,i=n+"",s;return function(){var l=Sd(this,t);return l===i?null:l===r?s:s=e(r=l,n)}}function V0e(t,e,n){var r,i,s;return function(){var l=Sd(this,t),o=n(this),p=o+"";return o==null&&(p=o=(this.style.removeProperty(t),Sd(this,t))),l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o))}}function G0e(t,e){var n,r,i,s="style."+e,l="end."+s,o;return function(){var p=mc(this,t),w=p.on,C=p.value[s]==null?o||(o=IF(e)):void 0;(w!==n||i!==C)&&(r=(n=w).copy()).on(l,i=C),p.on=r}}function $0e(t,e,n){var r=(t+="")=="transform"?Qfe:kF;return e==null?this.styleTween(t,N0e(t,r)).on("end.style."+t,IF(t)):typeof e=="function"?this.styleTween(t,V0e(t,r,qS(this,"style."+t,e))).each(G0e(this._id,t)):this.styleTween(t,U0e(t,r,e),n).on("end.style."+t,null)}function j0e(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function H0e(t,e,n){var r,i;function s(){var l=e.apply(this,arguments);return l!==i&&(r=(i=l)&&j0e(t,l,n)),r}return s._value=e,s}function W0e(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,H0e(t,e,n??""))}function Q0e(t){return function(){this.textContent=t}}function q0e(t){return function(){var e=t(this);this.textContent=e??""}}function Z0e(t){return this.tween("text",typeof t=="function"?q0e(qS(this,"text",t)):Q0e(t==null?"":t+""))}function Y0e(t){return function(e){this.textContent=t.call(this,e)}}function X0e(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Y0e(i)),e}return r._value=t,r}function K0e(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,X0e(t))}function J0e(){for(var t=this._name,e=this._id,n=LF(),r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],o=l.length,p,w=0;w<o;++w)if(p=l[w]){var C=_A(p,e);bv(p,t,n,w,l,{time:C.time+C.delay+C.duration,delay:0,duration:C.duration,ease:C.ease})}return new hc(r,this._parents,t,n)}function ede(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,l){var o={value:l},p={value:function(){--i===0&&s()}};n.each(function(){var w=mc(this,r),C=w.on;C!==t&&(e=(t=C).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(p)),w.on=e})})}var tde=0;function hc(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function LF(){return++tde}var d0=Om.prototype;hc.prototype={constructor:hc,select:B0e,selectAll:z0e,filter:M0e,merge:P0e,selection:F0e,transition:J0e,call:d0.call,nodes:d0.nodes,node:d0.node,size:d0.size,empty:d0.empty,each:d0.each,on:L0e,attr:d0e,attrTween:_0e,style:$0e,styleTween:W0e,text:Z0e,textTween:K0e,remove:R0e,tween:a0e,delay:w0e,duration:T0e,ease:C0e,end:ede};function nde(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var _E={time:null,delay:0,duration:250,ease:nde};function rde(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return _E.time=wv(),_E;return n}function ide(t){var e,n;t instanceof hc?(e=t._id,t=t._name):(e=LF(),(n=_E).time=wv(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],o=l.length,p,w=0;w<o;++w)(p=l[w])&&bv(p,t,e,w,l,n||rde(p,e));return new hc(r,this._parents,t,e)}Om.prototype.interrupt=i0e;Om.prototype.transition=ide;var vE=Math.PI,xE=2*vE,qh=1e-6,sde=xE-qh;function wE(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function DF(){return new wE}wE.prototype=DF.prototype={constructor:wE,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var s=this._x1,l=this._y1,o=n-t,p=r-e,w=s-t,C=l-e,P=w*w+C*C;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(P>qh)if(!(Math.abs(C*o-p*w)>qh)||!i)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var I=n-s,U=r-l,W=o*o+p*p,H=I*I+U*U,ie=Math.sqrt(W),X=Math.sqrt(P),ee=i*Math.tan((vE-Math.acos((W+P-H)/(2*ie*X)))/2),se=ee/X,fe=ee/ie;Math.abs(se-1)>qh&&(this._+="L"+(t+se*w)+","+(e+se*C)),this._+="A"+i+","+i+",0,0,"+ +(C*I>w*U)+","+(this._x1=t+fe*o)+","+(this._y1=e+fe*p)}},arc:function(t,e,n,r,i,s){t=+t,e=+e,n=+n,s=!!s;var l=n*Math.cos(r),o=n*Math.sin(r),p=t+l,w=e+o,C=1^s,P=s?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+p+","+w:(Math.abs(this._x1-p)>qh||Math.abs(this._y1-w)>qh)&&(this._+="L"+p+","+w),n&&(P<0&&(P=P%xE+xE),P>sde?this._+="A"+n+","+n+",0,1,"+C+","+(t-l)+","+(e-o)+"A"+n+","+n+",0,1,"+C+","+(this._x1=p)+","+(this._y1=w):P>qh&&(this._+="A"+n+","+n+",0,"+ +(P>=vE)+","+C+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Al="$";function d2(){}d2.prototype=p2.prototype={constructor:d2,has:function(t){return Al+t in this},get:function(t){return this[Al+t]},set:function(t,e){return this[Al+t]=e,this},remove:function(t){var e=Al+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Al&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Al&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Al&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Al&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Al&&++t;return t},empty:function(){for(var t in this)if(t[0]===Al)return!1;return!0},each:function(t){for(var e in this)e[0]===Al&&t(this[e],e.slice(1),this)}};function p2(t,e){var n=new d2;if(t instanceof d2)t.each(function(o,p){n.set(p,o)});else if(Array.isArray(t)){var r=-1,i=t.length,s;if(e==null)for(;++r<i;)n.set(r,t[r]);else for(;++r<i;)n.set(e(s=t[r],r,t),s)}else if(t)for(var l in t)n.set(l,t[l]);return n}function S6(){}var Uh=p2.prototype;S6.prototype={constructor:S6,has:Uh.has,add:function(t){return t+="",this[Al+t]=t,this},remove:Uh.remove,clear:Uh.clear,values:Uh.keys,size:Uh.size,empty:Uh.empty,each:Uh.each};function ode(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function g2(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function ade(t){return t=g2(Math.abs(t)),t?t[1]:NaN}function lde(t,e){return function(n,r){for(var i=n.length,s=[],l=0,o=t[0],p=0;i>0&&o>0&&(p+o+1>r&&(o=Math.max(1,r-p)),s.push(n.substring(i-=o,i+o)),!((p+=o+1)>r));)o=t[l=(l+1)%t.length];return s.reverse().join(e)}}function Ade(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var ude=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function bE(t){if(!(e=ude.exec(t)))throw new Error("invalid format: "+t);var e;return new ZS({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}bE.prototype=ZS.prototype;function ZS(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}ZS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function cde(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var RF;function hde(t,e){var n=g2(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(RF=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+g2(t,Math.max(0,e+s-1))[0]}function C6(t,e){var n=g2(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const M6={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:ode,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return C6(t*100,e)},r:C6,s:hde,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function P6(t){return t}var k6=Array.prototype.map,I6=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function fde(t){var e=t.grouping===void 0||t.thousands===void 0?P6:lde(k6.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?P6:Ade(k6.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"-":t.minus+"",p=t.nan===void 0?"NaN":t.nan+"";function w(P){P=bE(P);var I=P.fill,U=P.align,W=P.sign,H=P.symbol,ie=P.zero,X=P.width,ee=P.comma,se=P.precision,fe=P.trim,me=P.type;me==="n"?(ee=!0,me="g"):M6[me]||(se===void 0&&(se=12),fe=!0,me="g"),(ie||I==="0"&&U==="=")&&(ie=!0,I="0",U="=");var Se=H==="$"?n:H==="#"&&/[boxX]/.test(me)?"0"+me.toLowerCase():"",He=H==="$"?r:/[%p]/.test(me)?l:"",Qe=M6[me],Ke=/[defgprs%]/.test(me);se=se===void 0?6:/[gprs]/.test(me)?Math.max(1,Math.min(21,se)):Math.max(0,Math.min(20,se));function rt(Ue){var it=Se,Ze=He,yt,Kt,Tt;if(me==="c")Ze=Qe(Ue)+Ze,Ue="";else{Ue=+Ue;var dn=Ue<0||1/Ue<0;if(Ue=isNaN(Ue)?p:Qe(Math.abs(Ue),se),fe&&(Ue=cde(Ue)),dn&&+Ue==0&&W!=="+"&&(dn=!1),it=(dn?W==="("?W:o:W==="-"||W==="("?"":W)+it,Ze=(me==="s"?I6[8+RF/3]:"")+Ze+(dn&&W==="("?")":""),Ke){for(yt=-1,Kt=Ue.length;++yt<Kt;)if(Tt=Ue.charCodeAt(yt),48>Tt||Tt>57){Ze=(Tt===46?i+Ue.slice(yt+1):Ue.slice(yt))+Ze,Ue=Ue.slice(0,yt);break}}}ee&&!ie&&(Ue=e(Ue,1/0));var _t=it.length+Ue.length+Ze.length,Et=_t<X?new Array(X-_t+1).join(I):"";switch(ee&&ie&&(Ue=e(Et+Ue,Et.length?X-Ze.length:1/0),Et=""),U){case"<":Ue=it+Ue+Ze+Et;break;case"=":Ue=it+Et+Ue+Ze;break;case"^":Ue=Et.slice(0,_t=Et.length>>1)+it+Ue+Ze+Et.slice(_t);break;default:Ue=Et+it+Ue+Ze;break}return s(Ue)}return rt.toString=function(){return P+""},rt}function C(P,I){var U=w((P=bE(P),P.type="f",P)),W=Math.max(-8,Math.min(8,Math.floor(ade(I)/3)))*3,H=Math.pow(10,-W),ie=I6[8+W/3];return function(X){return U(H*X)+ie}}return{format:w,formatPrefix:C}}var uy,Md;dde({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function dde(t){return uy=fde(t),Md=uy.format,uy.formatPrefix,uy}function jd(){return Math.random()}(function t(e){function n(r,i){return r=r==null?0:+r,i=i==null?1:+i,arguments.length===1?(i=r,r=0):i-=r,function(){return e()*i+r}}return n.source=t,n})(jd);const pde=function t(e){function n(r,i){var s,l;return r=r==null?0:+r,i=i==null?1:+i,function(){var o;if(s!=null)o=s,s=null;else do s=e()*2-1,o=e()*2-1,l=s*s+o*o;while(!l||l>1);return r+i*o*Math.sqrt(-2*Math.log(l)/l)}}return n.source=t,n}(jd);(function t(e){function n(){var r=pde.source(e).apply(this,arguments);return function(){return Math.exp(r())}}return n.source=t,n})(jd);const gde=function t(e){function n(r){return function(){for(var i=0,s=0;s<r;++s)i+=e();return i}}return n.source=t,n}(jd);(function t(e){function n(r){var i=gde.source(e)(r);return function(){return i()/r}}return n.source=t,n})(jd);(function t(e){function n(r){return function(){return-Math.log(1-e())/r}}return n.source=t,n})(jd);function BF(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function mde(t){return t.length===1&&(t=yde(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}function yde(t){return function(e,n){return BF(t(e),n)}}var _de=mde(BF),vde=_de.right;function xde(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var EE=Math.sqrt(50),TE=Math.sqrt(10),SE=Math.sqrt(2);function wde(t,e,n){var r,i=-1,s,l,o;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(s=t,t=e,e=s),(o=Xy(t,e,n))===0||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),l=new Array(s=Math.ceil(e-t+1));++i<s;)l[i]=(t+i)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),l=new Array(s=Math.ceil(t-e+1));++i<s;)l[i]=(t-i)/o;return r&&l.reverse(),l}function Xy(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,i);return i>=0?(s>=EE?10:s>=TE?5:s>=SE?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=EE?10:s>=TE?5:s>=SE?2:1)}function bde(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=EE?i*=10:s>=TE?i*=5:s>=SE&&(i*=2),e<t?-i:i}function YS(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var zF=Array.prototype,Ede=zF.map,CE=zF.slice,L6={name:"implicit"};function OF(){var t=p2(),e=[],n=[],r=L6;function i(s){var l=s+"",o=t.get(l);if(!o){if(r!==L6)return r;t.set(l,o=e.push(s))}return n[(o-1)%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=p2();for(var l=-1,o=s.length,p,w;++l<o;)t.has(w=(p=s[l])+"")||t.set(w,e.push(p));return i},i.range=function(s){return arguments.length?(n=CE.call(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return OF(e,n).unknown(r)},YS.apply(i,arguments),i}function FF(){var t=OF().unknown(void 0),e=t.domain,n=t.range,r=[0,1],i,s,l=!1,o=0,p=0,w=.5;delete t.unknown;function C(){var P=e().length,I=r[1]<r[0],U=r[I-0],W=r[1-I];i=(W-U)/Math.max(1,P-o+p*2),l&&(i=Math.floor(i)),U+=(W-U-i*(P-o))*w,s=i*(1-o),l&&(U=Math.round(U),s=Math.round(s));var H=xde(P).map(function(ie){return U+i*ie});return n(I?H.reverse():H)}return t.domain=function(P){return arguments.length?(e(P),C()):e()},t.range=function(P){return arguments.length?(r=[+P[0],+P[1]],C()):r.slice()},t.rangeRound=function(P){return r=[+P[0],+P[1]],l=!0,C()},t.bandwidth=function(){return s},t.step=function(){return i},t.round=function(P){return arguments.length?(l=!!P,C()):l},t.padding=function(P){return arguments.length?(o=Math.min(1,p=+P),C()):o},t.paddingInner=function(P){return arguments.length?(o=Math.min(1,P),C()):o},t.paddingOuter=function(P){return arguments.length?(p=+P,C()):p},t.align=function(P){return arguments.length?(w=Math.max(0,Math.min(1,P)),C()):w},t.copy=function(){return FF(e(),r).round(l).paddingInner(o).paddingOuter(p).align(w)},YS.apply(C(),arguments)}function NF(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return NF(e())},t}function m2(){return NF(FF.apply(null,arguments).paddingInner(1))}function XS(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function UF(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Nm(){}var am=.7,y2=1/am,rd="\\s*([+-]?\\d+)\\s*",lm="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",tu="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Tde=/^#([0-9a-f]{3,8})$/,Sde=new RegExp("^rgb\\("+[rd,rd,rd]+"\\)$"),Cde=new RegExp("^rgb\\("+[tu,tu,tu]+"\\)$"),Mde=new RegExp("^rgba\\("+[rd,rd,rd,lm]+"\\)$"),Pde=new RegExp("^rgba\\("+[tu,tu,tu,lm]+"\\)$"),kde=new RegExp("^hsl\\("+[lm,tu,tu]+"\\)$"),Ide=new RegExp("^hsla\\("+[lm,tu,tu,lm]+"\\)$"),D6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};XS(Nm,Am,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:R6,formatHex:R6,formatHsl:Lde,formatRgb:B6,toString:B6});function R6(){return this.rgb().formatHex()}function Lde(){return VF(this).formatHsl()}function B6(){return this.rgb().formatRgb()}function Am(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Tde.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?z6(e):n===3?new Ba(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?cy(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?cy(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Sde.exec(t))?new Ba(e[1],e[2],e[3],1):(e=Cde.exec(t))?new Ba(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Mde.exec(t))?cy(e[1],e[2],e[3],e[4]):(e=Pde.exec(t))?cy(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=kde.exec(t))?N6(e[1],e[2]/100,e[3]/100,1):(e=Ide.exec(t))?N6(e[1],e[2]/100,e[3]/100,e[4]):D6.hasOwnProperty(t)?z6(D6[t]):t==="transparent"?new Ba(NaN,NaN,NaN,0):null}function z6(t){return new Ba(t>>16&255,t>>8&255,t&255,1)}function cy(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ba(t,e,n,r)}function Dde(t){return t instanceof Nm||(t=Am(t)),t?(t=t.rgb(),new Ba(t.r,t.g,t.b,t.opacity)):new Ba}function ME(t,e,n,r){return arguments.length===1?Dde(t):new Ba(t,e,n,r??1)}function Ba(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}XS(Ba,ME,UF(Nm,{brighter:function(t){return t=t==null?y2:Math.pow(y2,t),new Ba(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?am:Math.pow(am,t),new Ba(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:O6,formatHex:O6,formatRgb:F6,toString:F6}));function O6(){return"#"+ib(this.r)+ib(this.g)+ib(this.b)}function F6(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function ib(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function N6(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new QA(t,e,n,r)}function VF(t){if(t instanceof QA)return new QA(t.h,t.s,t.l,t.opacity);if(t instanceof Nm||(t=Am(t)),!t)return new QA;if(t instanceof QA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),l=NaN,o=s-i,p=(s+i)/2;return o?(e===s?l=(n-r)/o+(n<r)*6:n===s?l=(r-e)/o+2:l=(e-n)/o+4,o/=p<.5?s+i:2-s-i,l*=60):o=p>0&&p<1?0:l,new QA(l,o,p,t.opacity)}function Rde(t,e,n,r){return arguments.length===1?VF(t):new QA(t,e,n,r??1)}function QA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}XS(QA,Rde,UF(Nm,{brighter:function(t){return t=t==null?y2:Math.pow(y2,t),new QA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?am:Math.pow(am,t),new QA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ba(sb(t>=240?t-240:t+120,i,r),sb(t,i,r),sb(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function sb(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function KS(t){return function(){return t}}function Bde(t,e){return function(n){return t+n*e}}function zde(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Ode(t){return(t=+t)==1?GF:function(e,n){return n-e?zde(e,n,t):KS(isNaN(e)?n:e)}}function GF(t,e){var n=e-t;return n?Bde(t,n):KS(isNaN(t)?e:t)}const U6=function t(e){var n=Ode(e);function r(i,s){var l=n((i=ME(i)).r,(s=ME(s)).r),o=n(i.g,s.g),p=n(i.b,s.b),w=GF(i.opacity,s.opacity);return function(C){return i.r=l(C),i.g=o(C),i.b=p(C),i.opacity=w(C),i+""}}return r.gamma=t,r}(1);function Fde(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function Nde(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Ude(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),l;for(l=0;l<r;++l)i[l]=JS(t[l],e[l]);for(;l<n;++l)s[l]=e[l];return function(o){for(l=0;l<r;++l)s[l]=i[l](o);return s}}function Vde(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function _2(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Gde(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=JS(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var PE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ob=new RegExp(PE.source,"g");function $de(t){return function(){return t}}function jde(t){return function(e){return t(e)+""}}function Hde(t,e){var n=PE.lastIndex=ob.lastIndex=0,r,i,s,l=-1,o=[],p=[];for(t=t+"",e=e+"";(r=PE.exec(t))&&(i=ob.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[l]?o[l]+=s:o[++l]=s),(r=r[0])===(i=i[0])?o[l]?o[l]+=i:o[++l]=i:(o[++l]=null,p.push({i:l,x:_2(r,i)})),n=ob.lastIndex;return n<e.length&&(s=e.slice(n),o[l]?o[l]+=s:o[++l]=s),o.length<2?p[0]?jde(p[0].x):$de(e):(e=p.length,function(w){for(var C=0,P;C<e;++C)o[(P=p[C]).i]=P.x(w);return o.join("")})}function JS(t,e){var n=typeof e,r;return e==null||n==="boolean"?KS(e):(n==="number"?_2:n==="string"?(r=Am(e))?(e=r,U6):Hde:e instanceof Am?U6:e instanceof Date?Vde:Nde(e)?Fde:Array.isArray(e)?Ude:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Gde:_2)(t,e)}function Wde(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Qde(t){return function(){return t}}function qde(t){return+t}var V6=[0,1];function N0(t){return t}function kE(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Qde(isNaN(e)?NaN:.5)}function G6(t){var e=t[0],n=t[t.length-1],r;return e>n&&(r=e,e=n,n=r),function(i){return Math.max(e,Math.min(n,i))}}function Zde(t,e,n){var r=t[0],i=t[1],s=e[0],l=e[1];return i<r?(r=kE(i,r),s=n(l,s)):(r=kE(r,i),s=n(s,l)),function(o){return s(r(o))}}function Yde(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),l=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<r;)i[l]=kE(t[l],t[l+1]),s[l]=n(e[l],e[l+1]);return function(o){var p=vde(t,o,1,r)-1;return s[p](i[p](o))}}function Xde(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Kde(){var t=V6,e=V6,n=JS,r,i,s,l=N0,o,p,w;function C(){return o=Math.min(t.length,e.length)>2?Yde:Zde,p=w=null,P}function P(I){return isNaN(I=+I)?s:(p||(p=o(t.map(r),e,n)))(r(l(I)))}return P.invert=function(I){return l(i((w||(w=o(e,t.map(r),_2)))(I)))},P.domain=function(I){return arguments.length?(t=Ede.call(I,qde),l===N0||(l=G6(t)),C()):t.slice()},P.range=function(I){return arguments.length?(e=CE.call(I),C()):e.slice()},P.rangeRound=function(I){return e=CE.call(I),n=Wde,C()},P.clamp=function(I){return arguments.length?(l=I?G6(t):N0,P):l!==N0},P.interpolate=function(I){return arguments.length?(n=I,C()):n},P.unknown=function(I){return arguments.length?(s=I,P):s},function(I,U){return r=I,i=U,C()}}function Jde(t,e){return Kde()(t,e)}function epe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function v2(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Pd(t){return t=v2(Math.abs(t)),t?t[1]:NaN}function tpe(t,e){return function(n,r){for(var i=n.length,s=[],l=0,o=t[0],p=0;i>0&&o>0&&(p+o+1>r&&(o=Math.max(1,r-p)),s.push(n.substring(i-=o,i+o)),!((p+=o+1)>r));)o=t[l=(l+1)%t.length];return s.reverse().join(e)}}function npe(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var rpe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function x2(t){if(!(e=rpe.exec(t)))throw new Error("invalid format: "+t);var e;return new e4({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}x2.prototype=e4.prototype;function e4(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}e4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function ipe(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var $F;function spe(t,e){var n=v2(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-($F=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+v2(t,Math.max(0,e+s-1))[0]}function $6(t,e){var n=v2(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const j6={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:epe,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return $6(t*100,e)},r:$6,s:spe,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function H6(t){return t}var W6=Array.prototype.map,Q6=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function ope(t){var e=t.grouping===void 0||t.thousands===void 0?H6:tpe(W6.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?H6:npe(W6.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"-":t.minus+"",p=t.nan===void 0?"NaN":t.nan+"";function w(P){P=x2(P);var I=P.fill,U=P.align,W=P.sign,H=P.symbol,ie=P.zero,X=P.width,ee=P.comma,se=P.precision,fe=P.trim,me=P.type;me==="n"?(ee=!0,me="g"):j6[me]||(se===void 0&&(se=12),fe=!0,me="g"),(ie||I==="0"&&U==="=")&&(ie=!0,I="0",U="=");var Se=H==="$"?n:H==="#"&&/[boxX]/.test(me)?"0"+me.toLowerCase():"",He=H==="$"?r:/[%p]/.test(me)?l:"",Qe=j6[me],Ke=/[defgprs%]/.test(me);se=se===void 0?6:/[gprs]/.test(me)?Math.max(1,Math.min(21,se)):Math.max(0,Math.min(20,se));function rt(Ue){var it=Se,Ze=He,yt,Kt,Tt;if(me==="c")Ze=Qe(Ue)+Ze,Ue="";else{Ue=+Ue;var dn=Ue<0||1/Ue<0;if(Ue=isNaN(Ue)?p:Qe(Math.abs(Ue),se),fe&&(Ue=ipe(Ue)),dn&&+Ue==0&&W!=="+"&&(dn=!1),it=(dn?W==="("?W:o:W==="-"||W==="("?"":W)+it,Ze=(me==="s"?Q6[8+$F/3]:"")+Ze+(dn&&W==="("?")":""),Ke){for(yt=-1,Kt=Ue.length;++yt<Kt;)if(Tt=Ue.charCodeAt(yt),48>Tt||Tt>57){Ze=(Tt===46?i+Ue.slice(yt+1):Ue.slice(yt))+Ze,Ue=Ue.slice(0,yt);break}}}ee&&!ie&&(Ue=e(Ue,1/0));var _t=it.length+Ue.length+Ze.length,Et=_t<X?new Array(X-_t+1).join(I):"";switch(ee&&ie&&(Ue=e(Et+Ue,Et.length?X-Ze.length:1/0),Et=""),U){case"<":Ue=it+Ue+Ze+Et;break;case"=":Ue=it+Et+Ue+Ze;break;case"^":Ue=Et.slice(0,_t=Et.length>>1)+it+Ue+Ze+Et.slice(_t);break;default:Ue=Et+it+Ue+Ze;break}return s(Ue)}return rt.toString=function(){return P+""},rt}function C(P,I){var U=w((P=x2(P),P.type="f",P)),W=Math.max(-8,Math.min(8,Math.floor(Pd(I)/3)))*3,H=Math.pow(10,-W),ie=Q6[8+W/3];return function(X){return U(H*X)+ie}}return{format:w,formatPrefix:C}}var hy,jF,HF;ape({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function ape(t){return hy=ope(t),jF=hy.format,HF=hy.formatPrefix,hy}function lpe(t){return Math.max(0,-Pd(Math.abs(t)))}function Ape(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Pd(e)/3)))*3-Pd(Math.abs(t)))}function upe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Pd(e)-Pd(t))+1}function cpe(t,e,n,r){var i=bde(t,e,n),s;switch(r=x2(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=Ape(i,l))&&(r.precision=s),HF(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=upe(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=lpe(i))&&(r.precision=s-(r.type==="%")*2);break}}return jF(r)}function hpe(t){var e=t.domain;return t.ticks=function(n){var r=e();return wde(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return cpe(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,l=r[i],o=r[s],p;return o<l&&(p=l,l=o,o=p,p=i,i=s,s=p),p=Xy(l,o,n),p>0?(l=Math.floor(l/p)*p,o=Math.ceil(o/p)*p,p=Xy(l,o,n)):p<0&&(l=Math.ceil(l*p)/p,o=Math.floor(o*p)/p,p=Xy(l,o,n)),p>0?(r[i]=Math.floor(l/p)*p,r[s]=Math.ceil(o/p)*p,e(r)):p<0&&(r[i]=Math.ceil(l*p)/p,r[s]=Math.floor(o*p)/p,e(r)),t},t}function aA(){var t=Jde(N0,N0);return t.copy=function(){return Xde(t,aA())},YS.apply(t,arguments),hpe(t)}function Ev(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}function Tv(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const fpe=Tv(Ev("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));Tv(Ev("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));Tv(Ev("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));Tv(Ev("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Gc(t){return function(){return t}}var q6=Math.abs,io=Math.atan2,Vh=Math.cos,dpe=Math.max,ab=Math.min,UA=Math.sin,U0=Math.sqrt,ea=1e-12,um=Math.PI,w2=um/2,ppe=2*um;function gpe(t){return t>1?0:t<-1?um:Math.acos(t)}function Z6(t){return t>=1?w2:t<=-1?-w2:Math.asin(t)}function mpe(t){return t.innerRadius}function ype(t){return t.outerRadius}function _pe(t){return t.startAngle}function vpe(t){return t.endAngle}function xpe(t){return t&&t.padAngle}function wpe(t,e,n,r,i,s,l,o){var p=n-t,w=r-e,C=l-i,P=o-s,I=P*p-C*w;if(!(I*I<ea))return I=(C*(e-s)-P*(t-i))/I,[t+I*p,e+I*w]}function fy(t,e,n,r,i,s,l){var o=t-n,p=e-r,w=(l?s:-s)/U0(o*o+p*p),C=w*p,P=-w*o,I=t+C,U=e+P,W=n+C,H=r+P,ie=(I+W)/2,X=(U+H)/2,ee=W-I,se=H-U,fe=ee*ee+se*se,me=i-s,Se=I*H-W*U,He=(se<0?-1:1)*U0(dpe(0,me*me*fe-Se*Se)),Qe=(Se*se-ee*He)/fe,Ke=(-Se*ee-se*He)/fe,rt=(Se*se+ee*He)/fe,Ue=(-Se*ee+se*He)/fe,it=Qe-ie,Ze=Ke-X,yt=rt-ie,Kt=Ue-X;return it*it+Ze*Ze>yt*yt+Kt*Kt&&(Qe=rt,Ke=Ue),{cx:Qe,cy:Ke,x01:-C,y01:-P,x11:Qe*(i/me-1),y11:Ke*(i/me-1)}}function WF(){var t=mpe,e=ype,n=Gc(0),r=null,i=_pe,s=vpe,l=xpe,o=null;function p(){var w,C,P=+t.apply(this,arguments),I=+e.apply(this,arguments),U=i.apply(this,arguments)-w2,W=s.apply(this,arguments)-w2,H=q6(W-U),ie=W>U;if(o||(o=w=DF()),I<P&&(C=I,I=P,P=C),!(I>ea))o.moveTo(0,0);else if(H>ppe-ea)o.moveTo(I*Vh(U),I*UA(U)),o.arc(0,0,I,U,W,!ie),P>ea&&(o.moveTo(P*Vh(W),P*UA(W)),o.arc(0,0,P,W,U,ie));else{var X=U,ee=W,se=U,fe=W,me=H,Se=H,He=l.apply(this,arguments)/2,Qe=He>ea&&(r?+r.apply(this,arguments):U0(P*P+I*I)),Ke=ab(q6(I-P)/2,+n.apply(this,arguments)),rt=Ke,Ue=Ke,it,Ze;if(Qe>ea){var yt=Z6(Qe/P*UA(He)),Kt=Z6(Qe/I*UA(He));(me-=yt*2)>ea?(yt*=ie?1:-1,se+=yt,fe-=yt):(me=0,se=fe=(U+W)/2),(Se-=Kt*2)>ea?(Kt*=ie?1:-1,X+=Kt,ee-=Kt):(Se=0,X=ee=(U+W)/2)}var Tt=I*Vh(X),dn=I*UA(X),_t=P*Vh(fe),Et=P*UA(fe);if(Ke>ea){var Jt=I*Vh(ee),In=I*UA(ee),Tn=P*Vh(se),Pr=P*UA(se),tr;if(H<um&&(tr=wpe(Tt,dn,Tn,Pr,Jt,In,_t,Et))){var or=Tt-tr[0],hr=dn-tr[1],Vn=Jt-tr[0],Tr=In-tr[1],wt=1/UA(gpe((or*Vn+hr*Tr)/(U0(or*or+hr*hr)*U0(Vn*Vn+Tr*Tr)))/2),rn=U0(tr[0]*tr[0]+tr[1]*tr[1]);rt=ab(Ke,(P-rn)/(wt-1)),Ue=ab(Ke,(I-rn)/(wt+1))}}Se>ea?Ue>ea?(it=fy(Tn,Pr,Tt,dn,I,Ue,ie),Ze=fy(Jt,In,_t,Et,I,Ue,ie),o.moveTo(it.cx+it.x01,it.cy+it.y01),Ue<Ke?o.arc(it.cx,it.cy,Ue,io(it.y01,it.x01),io(Ze.y01,Ze.x01),!ie):(o.arc(it.cx,it.cy,Ue,io(it.y01,it.x01),io(it.y11,it.x11),!ie),o.arc(0,0,I,io(it.cy+it.y11,it.cx+it.x11),io(Ze.cy+Ze.y11,Ze.cx+Ze.x11),!ie),o.arc(Ze.cx,Ze.cy,Ue,io(Ze.y11,Ze.x11),io(Ze.y01,Ze.x01),!ie))):(o.moveTo(Tt,dn),o.arc(0,0,I,X,ee,!ie)):o.moveTo(Tt,dn),!(P>ea)||!(me>ea)?o.lineTo(_t,Et):rt>ea?(it=fy(_t,Et,Jt,In,P,-rt,ie),Ze=fy(Tt,dn,Tn,Pr,P,-rt,ie),o.lineTo(it.cx+it.x01,it.cy+it.y01),rt<Ke?o.arc(it.cx,it.cy,rt,io(it.y01,it.x01),io(Ze.y01,Ze.x01),!ie):(o.arc(it.cx,it.cy,rt,io(it.y01,it.x01),io(it.y11,it.x11),!ie),o.arc(0,0,P,io(it.cy+it.y11,it.cx+it.x11),io(Ze.cy+Ze.y11,Ze.cx+Ze.x11),ie),o.arc(Ze.cx,Ze.cy,rt,io(Ze.y11,Ze.x11),io(Ze.y01,Ze.x01),!ie))):o.arc(0,0,P,fe,se,ie)}if(o.closePath(),w)return o=null,w+""||null}return p.centroid=function(){var w=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,C=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-um/2;return[Vh(C)*w,UA(C)*w]},p.innerRadius=function(w){return arguments.length?(t=typeof w=="function"?w:Gc(+w),p):t},p.outerRadius=function(w){return arguments.length?(e=typeof w=="function"?w:Gc(+w),p):e},p.cornerRadius=function(w){return arguments.length?(n=typeof w=="function"?w:Gc(+w),p):n},p.padRadius=function(w){return arguments.length?(r=w==null?null:typeof w=="function"?w:Gc(+w),p):r},p.startAngle=function(w){return arguments.length?(i=typeof w=="function"?w:Gc(+w),p):i},p.endAngle=function(w){return arguments.length?(s=typeof w=="function"?w:Gc(+w),p):s},p.padAngle=function(w){return arguments.length?(l=typeof w=="function"?w:Gc(+w),p):l},p.context=function(w){return arguments.length?(o=w??null,p):o},p}function b2(){this._=null}function Sv(t){t.U=t.C=t.L=t.R=t.P=t.N=null}b2.prototype={constructor:b2,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Y6(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(Fp(this,n),t=n,n=t.U),n.C=!1,r.C=!0,Np(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(Np(this,n),t=n,n=t.U),n.C=!1,r.C=!0,Fp(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e=t.U,n,r=t.L,i=t.R,s,l;if(r?i?s=Y6(i):s=r:s=i,e?e.L===t?e.L=s:e.R=s:this._=s,r&&i?(l=s.C,s.C=t.C,s.L=r,r.U=s,s!==i?(e=s.U,s.U=t.U,t=s.R,e.L=t,s.R=i,i.U=s):(s.U=e,e=s,t=s.R)):(l=t.C,t=s),t&&(t.U=e),!l){if(t&&t.C){t.C=!1;return}do{if(t===this._)break;if(t===e.L){if(n=e.R,n.C&&(n.C=!1,e.C=!0,Fp(this,e),n=e.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,Np(this,n),n=e.R),n.C=e.C,e.C=n.R.C=!1,Fp(this,e),t=this._;break}}else if(n=e.L,n.C&&(n.C=!1,e.C=!0,Np(this,e),n=e.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,Fp(this,n),n=e.L),n.C=e.C,e.C=n.L.C=!1,Np(this,e),t=this._;break}n.C=!0,t=e,e=e.U}while(!t.C);t&&(t.C=!1)}}};function Fp(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Np(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Y6(t){for(;t.L;)t=t.L;return t}function rg(t,e,n,r){var i=[null,null],s=ao.push(i)-1;return i.left=t,i.right=e,n&&E2(i,t,e,n),r&&E2(i,e,t,r),Da[t.index].halfedges.push(s),Da[e.index].halfedges.push(s),i}function Up(t,e,n){var r=[e,n];return r.left=t,r}function E2(t,e,n,r){!t[0]&&!t[1]?(t[0]=r,t.left=e,t.right=n):t.left===n?t[1]=r:t[0]=r}function bpe(t,e,n,r,i){var s=t[0],l=t[1],o=s[0],p=s[1],w=l[0],C=l[1],P=0,I=1,U=w-o,W=C-p,H;if(H=e-o,!(!U&&H>0)){if(H/=U,U<0){if(H<P)return;H<I&&(I=H)}else if(U>0){if(H>I)return;H>P&&(P=H)}if(H=r-o,!(!U&&H<0)){if(H/=U,U<0){if(H>I)return;H>P&&(P=H)}else if(U>0){if(H<P)return;H<I&&(I=H)}if(H=n-p,!(!W&&H>0)){if(H/=W,W<0){if(H<P)return;H<I&&(I=H)}else if(W>0){if(H>I)return;H>P&&(P=H)}if(H=i-p,!(!W&&H<0)){if(H/=W,W<0){if(H>I)return;H>P&&(P=H)}else if(W>0){if(H<P)return;H<I&&(I=H)}return!(P>0)&&!(I<1)||(P>0&&(t[0]=[o+P*U,p+P*W]),I<1&&(t[1]=[o+I*U,p+I*W])),!0}}}}}function Epe(t,e,n,r,i){var s=t[1];if(s)return!0;var l=t[0],o=t.left,p=t.right,w=o[0],C=o[1],P=p[0],I=p[1],U=(w+P)/2,W=(C+I)/2,H,ie;if(I===C){if(U<e||U>=r)return;if(w>P){if(!l)l=[U,n];else if(l[1]>=i)return;s=[U,i]}else{if(!l)l=[U,i];else if(l[1]<n)return;s=[U,n]}}else if(H=(w-P)/(I-C),ie=W-H*U,H<-1||H>1)if(w>P){if(!l)l=[(n-ie)/H,n];else if(l[1]>=i)return;s=[(i-ie)/H,i]}else{if(!l)l=[(i-ie)/H,i];else if(l[1]<n)return;s=[(n-ie)/H,n]}else if(C<I){if(!l)l=[e,H*e+ie];else if(l[0]>=r)return;s=[r,H*r+ie]}else{if(!l)l=[r,H*r+ie];else if(l[0]<e)return;s=[e,H*e+ie]}return t[0]=l,t[1]=s,!0}function Tpe(t,e,n,r){for(var i=ao.length,s;i--;)(!Epe(s=ao[i],t,e,n,r)||!bpe(s,t,e,n,r)||!(Math.abs(s[0][0]-s[1][0])>fi||Math.abs(s[0][1]-s[1][1])>fi))&&delete ao[i]}function Spe(t){return Da[t.index]={site:t,halfedges:[]}}function Cpe(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function QF(t,e){return e[+(e.left!==t.site)]}function Mpe(t,e){return e[+(e.left===t.site)]}function Ppe(){for(var t=0,e=Da.length,n,r,i,s;t<e;++t)if((n=Da[t])&&(s=(r=n.halfedges).length)){var l=new Array(s),o=new Array(s);for(i=0;i<s;++i)l[i]=i,o[i]=Cpe(n,ao[r[i]]);for(l.sort(function(p,w){return o[w]-o[p]}),i=0;i<s;++i)o[i]=r[l[i]];for(i=0;i<s;++i)r[i]=o[i]}}function kpe(t,e,n,r){var i=Da.length,s,l,o,p,w,C,P,I,U,W,H,ie,X=!0;for(s=0;s<i;++s)if(l=Da[s]){for(o=l.site,w=l.halfedges,p=w.length;p--;)ao[w[p]]||w.splice(p,1);for(p=0,C=w.length;p<C;)W=Mpe(l,ao[w[p]]),H=W[0],ie=W[1],P=QF(l,ao[w[++p%C]]),I=P[0],U=P[1],(Math.abs(H-I)>fi||Math.abs(ie-U)>fi)&&(w.splice(p,0,ao.push(Up(o,W,Math.abs(H-t)<fi&&r-ie>fi?[t,Math.abs(I-t)<fi?U:r]:Math.abs(ie-r)<fi&&n-H>fi?[Math.abs(U-r)<fi?I:n,r]:Math.abs(H-n)<fi&&ie-e>fi?[n,Math.abs(I-n)<fi?U:e]:Math.abs(ie-e)<fi&&H-t>fi?[Math.abs(U-e)<fi?I:t,e]:null))-1),++C);C&&(X=!1)}if(X){var ee,se,fe,me=1/0;for(s=0,X=null;s<i;++s)(l=Da[s])&&(o=l.site,ee=o[0]-t,se=o[1]-e,fe=ee*ee+se*se,fe<me&&(me=fe,X=l));if(X){var Se=[t,e],He=[t,r],Qe=[n,r],Ke=[n,e];X.halfedges.push(ao.push(Up(o=X.site,Se,He))-1,ao.push(Up(o,He,Qe))-1,ao.push(Up(o,Qe,Ke))-1,ao.push(Up(o,Ke,Se))-1)}}for(s=0;s<i;++s)(l=Da[s])&&(l.halfedges.length||delete Da[s])}var qF=[],t4;function Ipe(){Sv(this),this.x=this.y=this.arc=this.site=this.cy=null}function V0(t){var e=t.P,n=t.N;if(!(!e||!n)){var r=e.site,i=t.site,s=n.site;if(r!==s){var l=i[0],o=i[1],p=r[0]-l,w=r[1]-o,C=s[0]-l,P=s[1]-o,I=2*(p*P-w*C);if(!(I>=-zpe)){var U=p*p+w*w,W=C*C+P*P,H=(P*U-w*W)/I,ie=(p*W-C*U)/I,X=qF.pop()||new Ipe;X.arc=t,X.site=i,X.x=H+l,X.y=(X.cy=ie+o)+Math.sqrt(H*H+ie*ie),t.circle=X;for(var ee=null,se=cm._;se;)if(X.y<se.y||X.y===se.y&&X.x<=se.x)if(se.L)se=se.L;else{ee=se.P;break}else if(se.R)se=se.R;else{ee=se;break}cm.insert(ee,X),ee||(t4=X)}}}}function id(t){var e=t.circle;e&&(e.P||(t4=e.N),cm.remove(e),qF.push(e),Sv(e),t.circle=null)}var ZF=[];function Lpe(){Sv(this),this.edge=this.site=this.circle=null}function X6(t){var e=ZF.pop()||new Lpe;return e.site=t,e}function lb(t){id(t),sd.remove(t),ZF.push(t),Sv(t)}function Dpe(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],s=t.P,l=t.N,o=[t];lb(t);for(var p=s;p.circle&&Math.abs(n-p.circle.x)<fi&&Math.abs(r-p.circle.cy)<fi;)s=p.P,o.unshift(p),lb(p),p=s;o.unshift(p),id(p);for(var w=l;w.circle&&Math.abs(n-w.circle.x)<fi&&Math.abs(r-w.circle.cy)<fi;)l=w.N,o.push(w),lb(w),w=l;o.push(w),id(w);var C=o.length,P;for(P=1;P<C;++P)w=o[P],p=o[P-1],E2(w.edge,p.site,w.site,i);p=o[0],w=o[C-1],w.edge=rg(p.site,w.site,null,i),V0(p),V0(w)}function Rpe(t){for(var e=t[0],n=t[1],r,i,s,l,o=sd._;o;)if(s=YF(o,n)-e,s>fi)o=o.L;else if(l=e-Bpe(o,n),l>fi){if(!o.R){r=o;break}o=o.R}else{s>-fi?(r=o.P,i=o):l>-fi?(r=o,i=o.N):r=i=o;break}Spe(t);var p=X6(t);if(sd.insert(r,p),!(!r&&!i)){if(r===i){id(r),i=X6(r.site),sd.insert(p,i),p.edge=i.edge=rg(r.site,p.site),V0(r),V0(i);return}if(!i){p.edge=rg(r.site,p.site);return}id(r),id(i);var w=r.site,C=w[0],P=w[1],I=t[0]-C,U=t[1]-P,W=i.site,H=W[0]-C,ie=W[1]-P,X=2*(I*ie-U*H),ee=I*I+U*U,se=H*H+ie*ie,fe=[(ie*ee-U*se)/X+C,(I*se-H*ee)/X+P];E2(i.edge,w,W,fe),p.edge=rg(w,t,null,fe),i.edge=rg(t,W,null,fe),V0(r),V0(i)}}function YF(t,e){var n=t.site,r=n[0],i=n[1],s=i-e;if(!s)return r;var l=t.P;if(!l)return-1/0;n=l.site;var o=n[0],p=n[1],w=p-e;if(!w)return o;var C=o-r,P=1/s-1/w,I=C/w;return P?(-I+Math.sqrt(I*I-2*P*(C*C/(-2*w)-p+w/2+i-s/2)))/P+r:(r+o)/2}function Bpe(t,e){var n=t.N;if(n)return YF(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var fi=1e-6,zpe=1e-12,sd,Da,cm,ao;function Ope(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function Fpe(t,e){return e[1]-t[1]||e[0]-t[0]}function K6(t,e){var n=t.sort(Fpe).pop(),r,i,s;for(ao=[],Da=new Array(t.length),sd=new b2,cm=new b2;;)if(s=t4,n&&(!s||n[1]<s.y||n[1]===s.y&&n[0]<s.x))(n[0]!==r||n[1]!==i)&&(Rpe(n),r=n[0],i=n[1]),n=t.pop();else if(s)Dpe(s.arc);else break;if(Ppe(),e){var l=+e[0][0],o=+e[0][1],p=+e[1][0],w=+e[1][1];Tpe(l,o,p,w),kpe(l,o,p,w)}this.edges=ao,this.cells=Da,sd=cm=ao=Da=null}K6.prototype={constructor:K6,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(r){return QF(e,t[r])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,r){if(o=(s=n.halfedges).length)for(var i=n.site,s,l=-1,o,p,w=e[s[o-1]],C=w.left===i?w.right:w.left;++l<o;)p=C,w=e[s[l]],C=w.left===i?w.right:w.left,p&&C&&r<p.index&&r<C.index&&Ope(i,p,C)<0&&t.push([i.data,p.data,C.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var r=this,i,s=r._found||0,l=r.cells.length,o;!(o=r.cells[s]);)if(++s>=l)return null;var p=t-o.site[0],w=e-o.site[1],C=p*p+w*w;do o=r.cells[i=s],s=null,o.halfedges.forEach(function(P){var I=r.edges[P],U=I.left;if(!((U===o.site||!U)&&!(U=I.right))){var W=t-U[0],H=e-U[1],ie=W*W+H*H;ie<C&&(C=ie,s=U.index)}});while(s!==null);return r._found=i,n==null||C<=n*n?o.site:null}};function ig(t,e,n){this.k=t,this.x=e,this.y=n}ig.prototype={constructor:ig,scale:function(t){return t===1?this:new ig(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ig(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};ig.prototype;function XF(t,e,n,r,i,s){var l=i||0,o=s||0,p=n||0,w=e||function(){return"#fff"},C=r,P;function I(U){I.el=U,I.setProperties()}return I.setProperties=function(){this.el&&(I.svgGroup||(I.svgGroup=I.el.append("g")),I.svgGroup.attr("transform","translate("+l+","+o+")"),I.svgGroup.selectAll("g").data(t).enter().append("g").selectAll("rect").data(function(U,W){return U.map(function(H){return{r:W,v:H}})}).enter().append("rect").datum(function(U,W){return U.c=W,U}),I.svgGroup.selectAll("g").selectAll("rect").attr("x",function(U){return p/t[U.r].length*U.c}).attr("y",function(U){return U.r*P}).attr("width",function(U){return p/t[U.r].length}).attr("height",P).attr("fill",function(U){return w(U.v)}),C&&I.svgGroup.attr("id",C))},I.data=function(U){return arguments.length?(t=U,P=p/t.length,I.setProperties(),I):t},I.x=function(U){return arguments.length?(l=U,I.setProperties(),I):l},I.y=function(U){return arguments.length?(o=U,I.setProperties(),I):o},I.size=function(U){return arguments.length?(p=U,t&&(P=p/t.length,I.setProperties()),I):p},I.scale=function(U){return arguments.length?(w=U,t&&I.setProperties(),I):w},I.id=function(U){return arguments.length?(C=U,I.setProperties(),I):C},I}function Npe(t,e,n,r,i,s){var l=XF(t,e,n,r,i,s);function o(p,w,C,P){var I=aA().domain([0,P]).range([-Math.PI/6,Math.PI/6]),U=aA().domain([0,C]).range([w,0]),W=WF().innerRadius(U(p.r+1)).outerRadius(U(p.r)).startAngle(I(p.c)).endAngle(I(p.c+1));return W()}return l.setProperties=function(){var p=l.data(),w=l.size(),C=l.scale(),P=l.id(),I=l.x(),U=l.y();l.el&&(l.svgGroup||(l.svgGroup=l.el.append("g")),l.svgGroup.attr("transform","translate("+I+","+U+")"),l.svgGroup.selectAll("g").data(p).enter().append("g").selectAll("path").data(function(W,H){return W.map(function(ie){return{r:H,v:ie}})}).enter().append("path").datum(function(W,H){return W.c=H,W}),l.svgGroup.selectAll("g").selectAll("path").attr("transform","translate("+w/2+","+w+")").attr("d",function(W){return o(W,w,p.length,p[W.r].length)}).attr("fill",function(W){return C(W.v)}),P&&l.svgGroup.attr("id",P))},l}var Upe=1e-9;function Vpe(t,e){var n=t||2,r=e||2,i=aA(),s=aA(),l=p();function o(w,C){for(var P=C??w.u,I=C!=null?w:w.v,U=0;U<l.length-1&&i(P)<1-(U+1)/r-Upe;)U++;for(var W=l[U].length>1?(l[U][1].v-l[U][0].v)/2:0,H=0;H<l[U].length-1&&I>l[U][H].v+W;)H++;return l[U][H]}function p(){var w=[],C;s.nice(Math.pow(n,r-1)),i.nice(r),w[0]=[],w[0].push({u:i.invert((r-1)/r),v:s.invert(.5)});for(var P=1;P<r;P++){w[P]=[],C=2*Math.pow(n,P);for(var I=1;I<C;I+=2)w[P].push({u:i.invert(1-(P+1)/r),v:s.invert(I/C)})}return w}return o.range=function(){return[].concat.apply([],l)},o.tree=function(){return l},o.data=o.tree,o.branching=function(w){return arguments.length?(n=Math.max(1,w),l=p(),o):n},o.layers=function(w){return arguments.length?(r=Math.max(1,w),l=p(),o):r},o.uncertaintyDomain=function(w){return arguments.length?(i.domain(w),l=p(),o):i.domain()},o.valueDomain=function(w){return arguments.length?(s.domain(w),l=p(),o):s.domain()},o}function Gpe(t,e,n){var r=e||fpe,i=n||function(p,w){var C=w!=null?{v:p,u:w}:{v:p.v,u:p.u};return C},s=t;function l(p,w){var C=sm(Ef(p)),P=sm(Ef(w));return Math.sqrt(Math.pow(C.l-P.l,2)+Math.pow(C.a-P.a,2)+Math.pow(C.b-P.b,2))}function o(p,w){var C=i(p,w),P=[0,1],I=[0,1];i.uncertaintyDomain&&(P=i.uncertaintyDomain()),i.valueDomain&&(I=i.valueDomain());var U=aA().domain(P).range([0,1]),W=aA().domain(I).range([0,1]),H=r(W(C.v));switch(s){case"usl":default:H=Zfe(H,"#fff")(U(C.u));break;case"us":H=fE(H);var ie=aA().domain([0,1]).range([H.s,0]);H.s=ie(U(C.u));break;case"ul":H=fE(H);var X=aA().domain([0,1]).range([H.l,1]);H.l=X(U(C.u));break}return H}return o.colorList=function(){return this.quantize().range().map(function(p){return o(p)})},o.colorDists=function(){for(var p=this.colorList(),w=new Array(p.length),C,P=new Array(2),I,U=0;U<w.length;U++){w[U]=new Array(p.length);for(var W=0;W<w[U].length;W++)I=l(p[U],p[W]),w[U][W]=I,U!=W&&(U==0&&W==1||I<C)&&(C=I,P=[p[U],p[W]])}return w.minDist=C,w.minPair=P,w},o.mode=function(p){return arguments.length?(s=p,o):s},o.range=function(p){return arguments.length?(r=p,o):r},o.quantize=function(p){return arguments.length?(i=p,o):i},o}function $pe(t,e,n,r,i,s,l){var o=null,p=i,w=t||null,C=e||200,P=n||30,I=r||null,U=s||0,W=l||0;function H(ie){o=ie,H.setProperties()}return H.setProperties=function(){if(o){var ie=w.domain?w.domain():[0,1],X=C/w.range().length,ee=(ie[1]-ie[0])/w.range().length,se=nm(ie[0],ie[1]+ee,ee),fe=m2().range([0,C]).domain(se).round(!0);o.attr("class","legend").attr("transform","translate("+U+","+W+")");var me=o.selectAll("rect").data(w.range());me.enter().append("rect").merge(me).attr("x",function(Qe,Ke){return Ke*X}).attr("y",0).attr("height",P).attr("width",X).attr("fill",function(Qe){return Qe});var Se=o.select("g.legend > g");Se.empty()&&(Se=o.append("g")),Se.attr("transform","translate(0, "+P+")").call(nhe(fe).tickFormat(Md(I||"")));var He=o.select("g.legend > text");He.empty()&&(He=o.append("text")),He.style("text-anchor","middle").style("font-size",13).attr("transform","translate("+C/2+", "+(P+30)+")").text(p)}},H.title=function(ie){return arguments.length?(p=ie,H.setProperties(),H):p},H.scale=function(ie){return arguments.length?(w=ie,H.setProperties(),H):w},H.size=function(ie){return arguments.length?(C=ie,H.setProperties(),H):C},H.height=function(ie){return arguments.length?(P=ie,H.setProperties(),H):P},H.format=function(ie){return arguments.length?(I=ie,H.setProperties(),H):I},H.x=function(ie){return arguments.length?(U=ie,H.setProperties(),H):U},H.y=function(ie){return arguments.length?(W=ie,H.setProperties(),H):W},H}function jpe(t,e,n,r,i,s,l){var o=null,p=r||"Uncertainty",w=i||"Value",C=t||null,P=e||200,I=n||null,U=s||0,W=l||0,H=null,ie=XF(),X=function(ee){o=ee,X.setProperties(),o.call(ie)};return X.setProperties=function(){if(o){var ee=H;ee||(ee=C.quantize().data());for(var se=[],fe=0;fe<ee.length;fe++)se[fe]=ee[ee.length-fe-1];ie.y(1),ie.data(se),ie.scale(C),ie.size(P),o.attr("class","legend").attr("transform","translate("+U+","+W+")");var me=C&&C.quantize?C.quantize().uncertaintyDomain():[0,1],Se=(me[1]-me[0])/se.length,He=nm(me[0],me[1]+Se,Se),Qe=C&&C.quantize?C.quantize().valueDomain():[0,1],Ke=(Qe[1]-Qe[0])/se.length,rt=nm(Qe[0],Qe[1]+Ke,Ke),Ue=m2().range([0,P]).domain(rt);o.append("g").call(the(Ue).tickFormat(Md(I||""))),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+P/2+", -25)").text(w);var it=m2().range([0,P]).domain(He);o.append("g").attr("transform","translate("+P+", 0)").call(eF(it).tickFormat(Md(I||""))),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(P+40)+", "+P/2+")rotate(90)").text(p)}},X.data=function(ee){return arguments.length?(H=ee,X.setProperties(),X):H},X.scale=function(ee){return arguments.length?(C=ee,X.setProperties(),X):C},X.size=function(ee){return arguments.length?(P=ee,X.setProperties(),X):P},X.format=function(ee){return arguments.length?(I=ee,X.setProperties(),X):I},X.x=function(ee){return arguments.length?(U=ee,X.setProperties(),X):U},X.y=function(ee){return arguments.length?(W=ee,X.setProperties(),X):W},X.utitle=function(ee){return arguments.length?(p=ee,X.setProperties(),X):p},X.vtitle=function(ee){return arguments.length?(w=ee,X.setProperties(),X):w},X}function Hpe(t,e,n,r,i,s,l){var o=null,p=r||"Uncertainty",w=i||"Value",C=t||null,P=e||200,I=n||null,U=s||0,W=l||0,H=null,ie=Npe(),X=function(ee){o=ee,X.setProperties(),o.call(ie)};return X.setProperties=function(){if(o){var ee=H;ee||(ee=C.quantize().data());for(var se=[],fe=0;fe<ee.length;fe++)se[fe]=ee[ee.length-fe-1];ie.data(se),ie.scale(C),ie.size(P),o.attr("class","legend").attr("transform","translate("+U+","+W+")");var me=C&&C.quantize?C.quantize().uncertaintyDomain():[0,1],Se=(me[1]-me[0])/se.length,He=nm(me[0],me[1]+Se,Se),Qe=m2().range([0,P]).domain(He),Ke=P/180;o.append("g").attr("transform","translate("+(P+6*Ke)+","+28*Ke+")rotate(30)").call(eF(Qe).tickFormat(Md(I||""))),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(P+10*Ke)+","+(40*Ke+P/2)+")rotate(-60)").text(p);var rt=C&&C.quantize?C.quantize().valueDomain():[0,1],Ue=(rt[1]-rt[0])/se[0].length,it=nm(rt[0],rt[1]+Ue,Ue),Ze=aA().range([0,P]).domain(rt),yt=I?Md(I):Ze.tickFormat(it.length),Kt=aA().domain(rt).range([-30,30]),Tt=3*Ke,dn=WF().innerRadius(P+Tt).outerRadius(P+Tt+1).startAngle(-Math.PI/6).endAngle(Math.PI/6),_t=o.append("g").attr("transform","translate("+P/2+","+(P-Tt)+")");_t.append("path").attr("fill","black").attr("stroke","transparent").attr("d",dn);var Et=_t.selectAll(".arc-label").data(it).enter().append("g").attr("class","arc-label").attr("transform",function(Jt){return"rotate("+Kt(Jt)+")translate(0,"+(-P-Tt)+")"});Et.append("text").style("font-size","11").style("text-anchor","middle").attr("y",-10).text(yt),Et.append("line").attr("x1",.5).attr("x2",.5).attr("y1",-6).attr("y2",0).attr("stroke","#000"),o.append("text").style("text-anchor","middle").style("font-size",13).attr("x",P/2).attr("y",-30).text(w)}},X.data=function(ee){return arguments.length?(H=ee,X.setProperties(),X):H},X.scale=function(ee){return arguments.length?(C=ee,X.setProperties(),X):C},X.size=function(ee){return arguments.length?(P=ee,X.setProperties(),X):P},X.format=function(ee){return arguments.length?(I=ee,X.setProperties(),X):I},X.x=function(ee){return arguments.length?(U=ee,X.setProperties(),X):U},X.y=function(ee){return arguments.length?(W=ee,X.setProperties(),X):W},X.utitle=function(ee){return arguments.length?(p=ee,X.setProperties(),X):p},X.vtitle=function(ee){return arguments.length?(w=ee,X.setProperties(),X):w},X}const Wpe=Object.freeze(Object.defineProperty({__proto__:null,arcmapLegend:Hpe,heatmapLegend:jpe,simpleLegend:$pe},Symbol.toStringTag,{value:"Module"}));var Aa=Wpe;function kd(t,e){return t+e}function lA(t,e=1,n=1){if(typeof t=="function")return l=>lA(t(l),e,n);Array.isArray(t)&&(t=vf(...t).toString());const{l:r,c:i,h:s}=Uk(t);return Uk(r+18*n,i+18*e,s).toString()}function KF(t,e,n){let r={};return n||(n=[]),Object.keys(t).forEach(i=>{if(n.includes(i))return;let s=t[i],l={};Object.keys(s).forEach(o=>{e(s[o])&&(l[o]=s[o])}),r[i]=l}),r}function JF(t,e){return t.reduce(function(n,r){return n[e(r)]=r,n},{})}const Um=t=>!!(t.properties||{}).id,_h=t=>!Um(t),T2=t=>t.toLocaleString("default",{month:"long"})+" "+t.toLocaleString("default",{year:"numeric"}),od=t=>Xpe[t.properties.LandUse.constructor===Array?t.properties.LandUse[0]:t.properties.LandUse],Qpe=1e-9;function qpe(t,e){let n=t||2,r=e||2;const i=Br(),s=Br();let l=p();function o(w,C){var P=C??w.u,I=C!=null?w:w.v;let U=0;for(;U<l.length-1&&i(P)<1-(U+1)/r-Qpe;)U++;const W=l[U].length>1?(l[U][1].v-l[U][0].v)/2:0;let H=0;for(;H<l[U].length-1&&I>l[U][H].v+W;)H++;return l[U][H]}function p(){const w=[];let C;s.nice(Math.pow(n,r-1)),i.nice(r),w[0]=[],w[0].push({u:i.invert((r-1)/r),v:s.invert(.5)});for(let P=1;P<=r;P++){w[P-1]=[],C=2*Math.pow(n,P);for(let I=1;I<C;I+=2)w[P-1].push({u:i.invert(1-P/r),v:s.invert(I/C)})}return w}return o.range=()=>[].concat.apply([],l),o.tree=()=>l,o.data=o.tree,o.branching=function(w){return arguments.length?(n=Math.max(1,w),l=p(),o):n},o.layers=function(w){return arguments.length?(r=Math.max(1,w),l=p(),o):r},o.uncertaintyDomain=function(w){return arguments.length?(i.domain(w),l=p(),o):i.domain()},o.valueDomain=function(w){return arguments.length?(s.domain(w),l=p(),o):s.domain()},o}const Ab=t=>t.replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),GA=7,ub=(t,e=0,n=1/GA)=>{let r=e==0?n:n/2;return Math.abs(t-e)<r?0:1},n4=(t,e,n=!0,r=!0)=>{const i=Object.keys(t);for(const s of i){const l=t[s],o=l.value.range||[0,1],p=l.variance.range||[1,0],w=l.value.color||fI,C=l.variance.color||fI;if(typeof l.value.domain=="function")if(n){const H=Object.values(e).slice(-1)[0];console.log(l.value.domain,al(Object.values(H).map(ie=>ie[l.value.domain]))),l.value.domain=al(Object.values(H).map(l.value.domain))}else l.value.domain=al(e.features.map(l.value.domain));if(typeof l.value.domain=="string")if(n){const H=Object.values(e).slice(-1)[0];console.log(l.value.domain,al(Object.values(H).map(ie=>ie[l.value.domain]))),l.value.domain=al(Object.values(H).map(ie=>ie[l.value.domain]))}else l.value.domain=al(e.features.map(H=>H.properties[l.value.domain]));if(typeof l.variance.domain=="function")if(n){const H=Object.values(e).slice(-1)[0];console.log(l.variance.domain,al(Object.values(H).map(ie=>ie[l.variance.domain]))),l.variance.domain=al(Object.values(H).map(l.variance.domain))}else l.variance.domain=al(e.features.map(l.variance.domain));if(typeof l.variance.domain=="string")if(n){const H=Object.values(e).slice(-1)[0];console.log(l.variance.domain,al(Object.values(H).map(ie=>ie[l.variance.domain]))),l.variance.domain=al(Object.values(H).map(ie=>ie[l.variance.domain]))}else l.variance.domain=al(e.features.map(H=>H.properties[l.variance.domain]));const P=Br().domain(l.value.domain).range(o),I=Br().domain(l.variance.domain).range(p);l.scaleLinear=P.copy().clamp(!0);const U=_s().domain(l.value.domain).range(Wg(GA).map(H=>H/(GA-1)*(o[1]-o[0])+o[0]));l.scaleLinearVar=I.copy().clamp(!0);const W=_s().domain(l.variance.domain).range(Wg(GA).map(H=>H/(GA-1)*(p[1]-p[0])+p[0]));l.colorsLinear=H=>w(P(H)),l.colorsStepped=_s().domain(l.value.domain).range(Gk(H=>w(Br([0,1]).range(o)(H)),GA)),l.colorsLinearVar=H=>C(I(H)),l.colorsSteppedVar=_s().domain(l.variance.domain).range(Gk(H=>C(Br([0,1]).range(p)(H)),GA)),l.vsup=Gpe().quantize((r?Vpe():qpe()).branching(2).layers(r?4:3).valueDomain(l.value.domain).uncertaintyDomain(l.variance.domain)).range(w),l.interpColor=(H,ie=!1,X=!0,ee=1/GA)=>[...Ab((X?l.colorsStepped:l.colorsLinear)(H)),...ie?[ub(U(H),l.value.zero||0,ee)*255]:[]],l.interpColorVar=(H,ie=!1,X=!0,ee=1/GA)=>[...Ab((X?l.colorsSteppedVar:l.colorsLinearVar)(H)),...ie?[ub(W(H),l.variance.zero||0,ee)*255]:[]],l.interpVsup=(H,ie,X=!1,ee=1/GA)=>[...Ab(l.vsup(H,ie)),...X?[ub(l.scaleStepped(H),l.value.zero||0,ee)*255]:[]]}return t},Vm=(t,e,n,r)=>{const i=Math.sqrt(3)/2,s=n,l=t,o=e,p=[[s+l,0+o],[s/2+l,s*i+o],[-s/2+l,s*i+o],[-s+l,0+o],[-s/2+l,-s*i+o],[s/2+l,-s*i+o]];return function(w){w.selectAll("path.area").data([p]).enter().append("path").attr("d",s2()).attr("fill",r)}},J6=(t,e,n,r,i=.2)=>{const s=Math.sqrt(3)/2;let l=n;const o=t,p=e,w=[[l+o,0+p],[l/2+o,l*s+p],[-l/2+o,l*s+p],[-l+o,0+p],[-l/2+o,-l*s+p],[l/2+o,-l*s+p]];l=n*(1-i);const C=[[l/2+o,-l*s+p],[-l/2+o,-l*s+p],[-l+o,0+p],[-l/2+o,l*s+p],[l/2+o,l*s+p],[l+o,0+p]],P=s2()(w),I=s2()(C);return function(U){U.append("path").attr("d",P+" "+I).attr("fill",r)}};function e7(t,e){const n=Br().range([.21568627450980393,1]);return r=>r.call(i=>{const s=t.scaleLinear.invert;i.selectAll(".some").data(ul).enter().append("g").attr("transform",(l,o)=>`translate(${o*60},0)`).each(function(l){mi(this).selectAll(".others").data(l.filter(o=>o[2]>-1)).enter().append("svg:image").attr("xlink:href",e).attr("x",(o,p)=>o[0]*20).attr("y",(o,p)=>-o[1]*20+15).attr("width",16).attr("height",16)}).append("text").attr("x",8).attr("y",0).style("font-size","10px").attr("text-anchor","middle").text((l,o)=>`${yl(".2s")(-s(o/ul.length))}  ${yl(".2s")(-s((o+1)/ul.length))}`)}).call(i=>{const s=t.scaleLinearVar.invert;i.selectAll(".budy").data(ul).enter().append("g").attr("transform",(l,o)=>`translate(${o*60},${15+40})`).call(l=>{l.append("g").each(function(o){mi(this).selectAll(".others").data(ul[1].filter(p=>p[2]>-1)).enter().append("svg:image").attr("xlink:href",e).attr("x",(p,w)=>p[0]*20).attr("y",(p,w)=>-p[1]*20).attr("width",16).attr("height",16)}).attr("opacity",(o,p)=>n(1-p/(ul.length-1)))}).append("text").attr("x",8).attr("y",25).style("font-size","10px").attr("text-anchor","middle").text((l,o)=>`${yl(".2s")(s(1-o/ul.length))}  ${yl(".2s")(s(1-(o+1)/ul.length))}`)})}function t7(t){const e=[.4,.65],n=[.3,1],r=p=>Br().range([0,(e[1]-e[0])/e[1]])(Br().range(n)(p)),i=7,s=20,l=s*2+10,o=Br().range([r(0),r(1)]);return p=>p.call(w=>{const C=Br().range(t.scaleLinear.domain());let P=Br().range([C(1/(i*2)),C(1-1/(i*2))]);w.append("g").selectAll(".asdf").data(Wg(i).map(I=>I/(i-1))).enter().append("g").attr("transform",(I,U)=>`translate(${U*l},0)`).each(function(I,U){mi(this).call(J6(0,20,s,vf(...t.interpColor(P(I))),o(1)))}).append("text").style("font-size","10px").attr("text-anchor","middle").attr("x",0).attr("y",0).text((I,U)=>`${yl(".2s")(C(U/i))}  ${yl(".2s")(C((U+1)/i))}`)}).call(w=>{const C=t.scaleLinear.invert,P=t.scaleLinearVar.invert;let I=Br().range([C(1/(i*2)),C(1-1/(i*2))]);w.append("g").selectAll(".asdf").data(Wg(i).map(U=>U/(i-1))).enter().append("g").attr("transform",(U,W)=>`translate(${W*l},${20+s*2})`).each(function(U,W){mi(this).call(J6(0,0,s,vf(...t.interpColor(I(0))),o(1-U)))}).append("text").style("font-size","10px").attr("text-anchor","middle").attr("x",0).attr("y",s+10).text((U,W)=>`${yl(".2s")(P(1-W/i))}  ${yl(".2s")(P(1-(W+1)/i))}`)})}const ul=[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,0],[-.67,0,0],[.67,0,0],[-.33,.58,0],[.33,.58,0],[-.33,-.58,0],[.33,-.58,0]]],Id={longitude:-121.046040643251,latitude:37.53320315272563,zoom:7.3252675985610685,minZoom:7,maxZoom:15,pitch:50.85,bearing:32.58};new Ud;new Ud;new Ud;new Ud;new Ud;new Ud;const Zpe=new PB({color:[255,255,255],intensity:1.7}),Ype=new AJ({timestamp:Date.UTC(2019,6,1,22),color:[255,255,255],intensity:.8}),Xpe={0:"Settlement",1:"Exchange",2:"Project",3:"Non-Project"},dr={0:"bl_h000",1:"CS3_ALT3_2022med_L2020ADV",2:"LTO_BA_EXP1_2022MED"},S2={0:"Scenario 1",1:"Scenario 2",2:"Scenario 3"},vA=new lS({ambientLight:Zpe,dirLight:Ype}),Kpe={longitude:-119.99582643167989,latitude:37.88453894208306,zoom:10.364947995424346,pitch:49.903969287830776,bearing:28.126875},Jpe={party:{value:{domain:[-100,100],color:lA(Wz(["red","purple","blue"]),-1,.2)},variance:{domain:[0,2e3]}},votes:{value:{domain:[0,42508]},variance:{domain:[0,1]}},population:{value:{domain:[0,200],color:ble},variance:{domain:[0,8e5]}},poc:{value:{domain:[0,50],color:lA(_le,.5,-.3)},variance:{domain:[0,100]}}},ege={power:{value:{domain:[0,300]},variance:{domain:[0,100],range:[0,1]}},personnel:{value:{domain:[0,100]},variance:{domain:[0,1]}}},tge={groundwater:{value:{domain:[-300,700],color:lA(t=>xle(Br([.75,1])(t)),-.5,.5)},variance:{domain:[0,1e4]}},demand:{value:{domain:[0,150],color:lA(dI,1,1)},variance:{domain:[0,650]}},unmetDemand:{value:{domain:[-150,0],range:[1,0],color:lA(dI,0,0)},variance:{domain:[0,650]}},difference:{value:{domain:[-30,30],color:lA(mle,0,0),zero:.5},variance:{domain:[0,650]}}},Ld=KF(await(await fetch("./assets/hex_5_6.json")).json(),t=>t.DemandBaseline),nge=KF(await(await fetch("./assets/square_5_6.json")).json(),t=>t.DemandBaseline),cb=await(await fetch("./assets/averages.json")).json(),El=await(await fetch("./assets/demand_geo.json")).json(),Tl=await(await fetch("./assets/election_hex_3_4.json")).json(),hm=await(await fetch("./assets/election_square_3_4.json")).json(),Hd=await(await fetch("./assets/precinct_geo.json")).json(),r4=await(await fetch("./assets/groundwater_geo.json")).json(),rge=await(await fetch("./assets/fire_hex_7_9.json")).json(),i4=await(await fetch("./assets/precinct_geo.json")).json(),C2=await(await fetch("./assets/county_geo.json")).json();function Cv(){const[t,e]=Ne.useState(1027),[n,r]=Ne.useState(!1),[i,s]=Ne.useState(1);return Ne.useEffect(()=>{if(n){let l=setTimeout(()=>e(o=>o%1199+1),33.333333333333336);return function(){clearTimeout(l)}}},[t,n]),{speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r,curOption:i,setCurOption:s}}function ige(t,e){var n,r,i,s,l,o,p,w,C,P,I=0,U=t.type==="FeatureCollection",W=t.type==="Feature",H=U?t.features.length:1;for(n=0;n<H;n++){for(o=U?t.features[n].geometry:W?t.geometry:t,w=U?t.features[n].properties:W?t.properties:{},C=U?t.features[n].bbox:W?t.bbox:void 0,P=U?t.features[n].id:W?t.id:void 0,p=o?o.type==="GeometryCollection":!1,l=p?o.geometries.length:1,i=0;i<l;i++){if(s=p?o.geometries[i]:o,s===null){if(e(null,I,w,C,P)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,I,w,C,P)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(e(s.geometries[r],I,w,C,P)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}I++}}function sge(t,e,n){var r=n;return ige(t,function(i,s,l,o,p){s===0&&n===void 0?r=i:r=e(r,i,s,l,o,p)}),r}var e8=6378137;function M2(t){return sge(t,function(e,n){return e+oge(n)},0)}function oge(t){var e=0,n;switch(t.type){case"Polygon":return t8(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)e+=t8(t.coordinates[n]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function t8(t){var e=0;if(t&&t.length>0){e+=Math.abs(n8(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(n8(t[n]))}return e}function n8(t){var e,n,r,i,s,l,o,p=0,w=t.length;if(w>2){for(o=0;o<w;o++)o===w-2?(i=w-2,s=w-1,l=0):o===w-1?(i=w-1,s=0,l=1):(i=o,s=o+1,l=o+2),e=t[i],n=t[s],r=t[l],p+=(hb(r[0])-hb(e[0]))*Math.sin(hb(n[1]));p=p*e8*e8/2}return p}function hb(t){return t*Math.PI/180}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function age(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function o(w){return function(C){return p([w,C])}}function p(w){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=w[0]&2?i.return:w[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,w[1])).done)return s;switch(i=0,s&&(w=[w[0]&2,s.value]),w[0]){case 0:case 1:s=w;break;case 4:return n.label++,{value:w[1],done:!1};case 5:n.label++,i=w[1],w=[0];continue;case 7:w=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(w[0]===6||w[0]===2)){n=0;continue}if(w[0]===3&&(!s||w[1]>s[0]&&w[1]<s[3])){n.label=w[1];break}if(w[0]===6&&n.label<s[1]){n.label=s[1],s=w;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(w);break}s[2]&&n.ops.pop(),n.trys.pop();continue}w=e.call(t,n)}catch(C){w=[6,C],i=0}finally{r=s=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}}var vh=function(){function t(e,n){this.next=null,this.key=e,this.data=n,this.left=null,this.right=null}return t}();function lge(t,e){return t>e?1:t<e?-1:0}function qc(t,e,n){for(var r=new vh(null,null),i=r,s=r;;){var l=n(t,e.key);if(l<0){if(e.left===null)break;if(n(t,e.left.key)<0){var o=e.left;if(e.left=o.right,o.right=e,e=o,e.left===null)break}s.left=e,s=e,e=e.left}else if(l>0){if(e.right===null)break;if(n(t,e.right.key)>0){var o=e.right;if(e.right=o.left,o.left=e,e=o,e.right===null)break}i.right=e,i=e,e=e.right}else break}return i.right=e.left,s.left=e.right,e.left=r.right,e.right=r.left,e}function fb(t,e,n,r){var i=new vh(t,e);if(n===null)return i.left=i.right=null,i;n=qc(t,n,r);var s=r(t,n.key);return s<0?(i.left=n.left,i.right=n,n.left=null):s>=0&&(i.right=n.right,i.left=n,n.right=null),i}function r8(t,e,n){var r=null,i=null;if(e){e=qc(t,e,n);var s=n(e.key,t);s===0?(r=e.left,i=e.right):s<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function Age(t,e,n){return e===null?t:(t===null||(e=qc(t.key,e,n),e.left=t),e)}function IE(t,e,n,r,i){if(t){r(""+e+(n?" ":" ")+i(t)+`
`);var s=e+(n?"    ":"   ");t.left&&IE(t.left,s,!1,r,i),t.right&&IE(t.right,s,!0,r,i)}}var s4=function(){function t(e){e===void 0&&(e=lge),this._root=null,this._size=0,this._comparator=e}return t.prototype.insert=function(e,n){return this._size++,this._root=fb(e,n,this._root,this._comparator)},t.prototype.add=function(e,n){var r=new vh(e,n);this._root===null&&(r.left=r.right=null,this._size++,this._root=r);var i=this._comparator,s=qc(e,this._root,i),l=i(e,s.key);return l===0?this._root=s:(l<0?(r.left=s.left,r.right=s,s.left=null):l>0&&(r.right=s.right,r.left=s,s.right=null),this._size++,this._root=r),this._root},t.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},t.prototype._remove=function(e,n,r){var i;if(n===null)return null;n=qc(e,n,r);var s=r(e,n.key);return s===0?(n.left===null?i=n.right:(i=qc(e,n.left,r),i.right=n.right),this._size--,i):n},t.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=qc(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},t.prototype.findStatic=function(e){for(var n=this._root,r=this._comparator;n;){var i=r(e,n.key);if(i===0)return n;i<0?n=n.left:n=n.right}return null},t.prototype.find=function(e){return this._root&&(this._root=qc(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},t.prototype.contains=function(e){for(var n=this._root,r=this._comparator;n;){var i=r(e,n.key);if(i===0)return!0;i<0?n=n.left:n=n.right}return!1},t.prototype.forEach=function(e,n){for(var r=this._root,i=[],s=!1;!s;)r!==null?(i.push(r),r=r.left):i.length!==0?(r=i.pop(),e.call(n,r),r=r.right):s=!0;return this},t.prototype.range=function(e,n,r,i){for(var s=[],l=this._comparator,o=this._root,p;s.length!==0||o;)if(o)s.push(o),o=o.left;else{if(o=s.pop(),p=l(o.key,n),p>0)break;if(l(o.key,e)>=0&&r.call(i,o))return this;o=o.right}return this},t.prototype.keys=function(){var e=[];return this.forEach(function(n){var r=n.key;return e.push(r)}),e},t.prototype.values=function(){var e=[];return this.forEach(function(n){var r=n.data;return e.push(r)}),e},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},t.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},t.prototype.at=function(e){for(var n=this._root,r=!1,i=0,s=[];!r;)if(n)s.push(n),n=n.left;else if(s.length>0){if(n=s.pop(),i===e)return n;i++,n=n.right}else r=!0;return null},t.prototype.next=function(e){var n=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var i=this._comparator;n;){var s=i(e.key,n.key);if(s===0)break;s<0?(r=n,n=n.left):n=n.right}return r},t.prototype.prev=function(e){var n=this._root,r=null;if(e.left!==null){for(r=e.left;r.right;)r=r.right;return r}for(var i=this._comparator;n;){var s=i(e.key,n.key);if(s===0)break;s<0?n=n.left:(r=n,n=n.right)}return r},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return cge(this._root)},t.prototype.load=function(e,n,r){n===void 0&&(n=[]),r===void 0&&(r=!1);var i=e.length,s=this._comparator;if(r&&RE(e,n,0,i-1,s),this._root===null)this._root=LE(e,n,0,i),this._size=i;else{var l=hge(this.toList(),uge(e,n),s);i=this._size+i,this._root=DE({head:l},0,i)}return this},t.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){e===void 0&&(e=function(r){return String(r.key)});var n=[];return IE(this._root,"",!0,function(r){return n.push(r)},e),n.join("")},t.prototype.update=function(e,n,r){var i=this._comparator,s=r8(e,this._root,i),l=s.left,o=s.right;i(e,n)<0?o=fb(n,r,o,i):l=fb(n,r,l,i),this._root=Age(l,o,i)},t.prototype.split=function(e){return r8(e,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var e,n,r;return age(this,function(i){switch(i.label){case 0:e=this._root,n=[],r=!1,i.label=1;case 1:return r?[3,6]:e===null?[3,2]:(n.push(e),e=e.left,[3,5]);case 2:return n.length===0?[3,4]:(e=n.pop(),[4,e]);case 3:return i.sent(),e=e.right,[3,5];case 4:r=!0,i.label=5;case 5:return[3,1];case 6:return[2]}})},t}();function LE(t,e,n,r){var i=r-n;if(i>0){var s=n+Math.floor(i/2),l=t[s],o=e[s],p=new vh(l,o);return p.left=LE(t,e,n,s),p.right=LE(t,e,s+1,r),p}return null}function uge(t,e){for(var n=new vh(null,null),r=n,i=0;i<t.length;i++)r=r.next=new vh(t[i],e[i]);return r.next=null,n.next}function cge(t){for(var e=t,n=[],r=!1,i=new vh(null,null),s=i;!r;)e?(n.push(e),e=e.left):n.length>0?(e=s=s.next=n.pop(),e=e.right):r=!0;return s.next=null,i.next}function DE(t,e,n){var r=n-e;if(r>0){var i=e+Math.floor(r/2),s=DE(t,e,i),l=t.head;return l.left=s,t.head=t.head.next,l.right=DE(t,i+1,n),l}return null}function hge(t,e,n){for(var r=new vh(null,null),i=r,s=t,l=e;s!==null&&l!==null;)n(s.key,l.key)<0?(i.next=s,s=s.next):(i.next=l,l=l.next),i=i.next;return s!==null?i.next=s:l!==null&&(i.next=l),r.next}function RE(t,e,n,r,i){if(!(n>=r)){for(var s=t[n+r>>1],l=n-1,o=r+1;;){do l++;while(i(t[l],s)<0);do o--;while(i(t[o],s)>0);if(l>=o)break;var p=t[l];t[l]=t[o],t[o]=p,p=e[l],e[l]=e[o],e[o]=p}RE(t,e,n,o,i),RE(t,e,o+1,r,i)}}const Vp=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,BE=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;const n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x,i=t.ll.y<e.ll.y?e.ll.y:t.ll.y,s=t.ur.y<e.ur.y?t.ur.y:e.ur.y;return{ll:{x:n,y:i},ur:{x:r,y:s}}};let th=Number.EPSILON;th===void 0&&(th=Math.pow(2,-52));const fge=th*th,i8=(t,e)=>{if(-th<t&&t<th&&-th<e&&e<th)return 0;const n=t-e;return n*n<fge*t*e?0:t<e?-1:1};class dge{constructor(){this.reset()}reset(){this.xRounder=new s8,this.yRounder=new s8}round(e,n){return{x:this.xRounder.round(e),y:this.yRounder.round(n)}}}class s8{constructor(){this.tree=new s4,this.round(0)}round(e){const n=this.tree.add(e),r=this.tree.prev(n);if(r!==null&&i8(n.key,r.key)===0)return this.tree.remove(e),r.key;const i=this.tree.next(n);return i!==null&&i8(n.key,i.key)===0?(this.tree.remove(e),i.key):e}}const fm=new dge,Ky=(t,e)=>t.x*e.y-t.y*e.x,n7=(t,e)=>t.x*e.x+t.y*e.y,o8=(t,e,n)=>{const r=Ioe(t.x,t.y,e.x,e.y,n.x,n.y);return r>0?-1:r<0?1:0},P2=t=>Math.sqrt(n7(t,t)),pge=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return Ky(i,r)/P2(i)/P2(r)},gge=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return n7(i,r)/P2(i)/P2(r)},a8=(t,e,n)=>e.y===0?null:{x:t.x+e.x/e.y*(n-t.y),y:n},l8=(t,e,n)=>e.x===0?null:{x:n,y:t.y+e.y/e.x*(n-t.x)},mge=(t,e,n,r)=>{if(e.x===0)return l8(n,r,t.x);if(r.x===0)return l8(t,e,n.x);if(e.y===0)return a8(n,r,t.y);if(r.y===0)return a8(t,e,n.y);const i=Ky(e,r);if(i==0)return null;const s={x:n.x-t.x,y:n.y-t.y},l=Ky(s,e)/i,o=Ky(s,r)/i,p=t.x+o*e.x,w=n.x+l*r.x,C=t.y+o*e.y,P=n.y+l*r.y,I=(p+w)/2,U=(C+P)/2;return{x:I,y:U}};class dl{static compare(e,n){const r=dl.comparePoints(e.point,n.point);return r!==0?r:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:fh.compare(e.segment,n.segment))}static comparePoints(e,n){return e.x<n.x?-1:e.x>n.x?1:e.y<n.y?-1:e.y>n.y?1:0}constructor(e,n){e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const n=e.point.events;for(let r=0,i=n.length;r<i;r++){const s=n[r];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let n=0;n<e;n++){const r=this.point.events[n];if(r.segment.consumedBy===void 0)for(let i=n+1;i<e;i++){const s=this.point.events[i];s.consumedBy===void 0&&r.otherSE.point.events===s.otherSE.point.events&&r.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const e=[];for(let n=0,r=this.point.events.length;n<r;n++){const i=this.point.events[n];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&e.push(i)}return e}getLeftmostComparator(e){const n=new Map,r=i=>{const s=i.otherSE;n.set(i,{sine:pge(this.point,e.point,s.point),cosine:gge(this.point,e.point,s.point)})};return(i,s)=>{n.has(i)||r(i),n.has(s)||r(s);const{sine:l,cosine:o}=n.get(i),{sine:p,cosine:w}=n.get(s);return l>=0&&p>=0?o<w?1:o>w?-1:0:l<0&&p<0?o<w?-1:o>w?1:0:p<l?-1:p>l?1:0}}}let yge=0;class fh{static compare(e,n){const r=e.leftSE.point.x,i=n.leftSE.point.x,s=e.rightSE.point.x,l=n.rightSE.point.x;if(l<r)return 1;if(s<i)return-1;const o=e.leftSE.point.y,p=n.leftSE.point.y,w=e.rightSE.point.y,C=n.rightSE.point.y;if(r<i){if(p<o&&p<w)return 1;if(p>o&&p>w)return-1;const P=e.comparePoint(n.leftSE.point);if(P<0)return 1;if(P>0)return-1;const I=n.comparePoint(e.rightSE.point);return I!==0?I:-1}if(r>i){if(o<p&&o<C)return-1;if(o>p&&o>C)return 1;const P=n.comparePoint(e.leftSE.point);if(P!==0)return P;const I=e.comparePoint(n.rightSE.point);return I<0?1:I>0?-1:1}if(o<p)return-1;if(o>p)return 1;if(s<l){const P=n.comparePoint(e.rightSE.point);if(P!==0)return P}if(s>l){const P=e.comparePoint(n.rightSE.point);if(P<0)return 1;if(P>0)return-1}if(s!==l){const P=w-o,I=s-r,U=C-p,W=l-i;if(P>I&&U<W)return 1;if(P<I&&U>W)return-1}return s>l?1:s<l||w<C?-1:w>C?1:e.id<n.id?-1:e.id>n.id?1:0}constructor(e,n,r,i){this.id=++yge,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=r,this.windings=i}static fromRing(e,n,r){let i,s,l;const o=dl.comparePoints(e,n);if(o<0)i=e,s=n,l=1;else if(o>0)i=n,s=e,l=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const p=new dl(i,!0),w=new dl(s,!1);return new fh(p,w,[r],[l])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<n?e:n},ur:{x:this.rightSE.point.x,y:e>n?e:n}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}comparePoint(e){if(this.isAnEndpoint(e))return 0;const n=this.leftSE.point,r=this.rightSE.point,i=this.vector();if(n.x===r.x)return e.x===n.x?0:e.x<n.x?1:-1;const s=(e.y-n.y)/i.y,l=n.x+s*i.x;if(e.x===l)return 0;const o=(e.x-n.x)/i.x,p=n.y+o*i.y;return e.y===p?0:e.y<p?-1:1}getIntersection(e){const n=this.bbox(),r=e.bbox(),i=BE(n,r);if(i===null)return null;const s=this.leftSE.point,l=this.rightSE.point,o=e.leftSE.point,p=e.rightSE.point,w=Vp(n,o)&&this.comparePoint(o)===0,C=Vp(r,s)&&e.comparePoint(s)===0,P=Vp(n,p)&&this.comparePoint(p)===0,I=Vp(r,l)&&e.comparePoint(l)===0;if(C&&w)return I&&!P?l:!I&&P?p:null;if(C)return P&&s.x===p.x&&s.y===p.y?null:s;if(w)return I&&l.x===o.x&&l.y===o.y?null:o;if(I&&P)return null;if(I)return l;if(P)return p;const U=mge(s,this.vector(),o,e.vector());return U===null||!Vp(i,U)?null:fm.round(U.x,U.y)}split(e){const n=[],r=e.events!==void 0,i=new dl(e,!0),s=new dl(e,!1),l=this.rightSE;this.replaceRightSE(s),n.push(s),n.push(i);const o=new fh(i,l,this.rings.slice(),this.windings.slice());return dl.comparePoints(o.leftSE.point,o.rightSE.point)>0&&o.swapEvents(),dl.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),s.checkForConsuming()),n}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,r=this.windings.length;n<r;n++)this.windings[n]*=-1}consume(e){let n=this,r=e;for(;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;const i=fh.compare(n,r);if(i!==0){if(i>0){const s=n;n=r,r=s}if(n.prev===r){const s=n;n=r,r=s}for(let s=0,l=r.rings.length;s<l;s++){const o=r.rings[s],p=r.windings[s],w=n.rings.indexOf(o);w===-1?(n.rings.push(o),n.windings.push(p)):n.windings[w]+=p}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,r=this._afterState.windings,i=this._afterState.multiPolys;for(let o=0,p=this.rings.length;o<p;o++){const w=this.rings[o],C=this.windings[o],P=n.indexOf(w);P===-1?(n.push(w),r.push(C)):r[P]+=C}const s=[],l=[];for(let o=0,p=n.length;o<p;o++){if(r[o]===0)continue;const w=n[o],C=w.poly;if(l.indexOf(C)===-1)if(w.isExterior)s.push(C);else{l.indexOf(C)===-1&&l.push(C);const P=s.indexOf(w.poly);P!==-1&&s.splice(P,1)}}for(let o=0,p=s.length;o<p;o++){const w=s[o].multiPoly;i.indexOf(w)===-1&&i.push(w)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(AA.type){case"union":{const r=e.length===0,i=n.length===0;this._isInResult=r!==i;break}case"intersection":{let r,i;e.length<n.length?(r=e.length,i=n.length):(r=n.length,i=e.length),this._isInResult=i===AA.numMultiPolys&&r<i;break}case"xor":{const r=Math.abs(e.length-n.length);this._isInResult=r%2===1;break}case"difference":{const r=i=>i.length===1&&i[0].isSubject;this._isInResult=r(e)!==r(n);break}default:throw new Error(`Unrecognized operation type found ${AA.type}`)}return this._isInResult}}class A8{constructor(e,n,r){if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=fm.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let s=i;for(let l=1,o=e.length;l<o;l++){if(typeof e[l][0]!="number"||typeof e[l][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let p=fm.round(e[l][0],e[l][1]);p.x===s.x&&p.y===s.y||(this.segments.push(fh.fromRing(s,p,this)),p.x<this.bbox.ll.x&&(this.bbox.ll.x=p.x),p.y<this.bbox.ll.y&&(this.bbox.ll.y=p.y),p.x>this.bbox.ur.x&&(this.bbox.ur.x=p.x),p.y>this.bbox.ur.y&&(this.bbox.ur.y=p.y),s=p)}(i.x!==s.x||i.y!==s.y)&&this.segments.push(fh.fromRing(s,i,this))}getSweepEvents(){const e=[];for(let n=0,r=this.segments.length;n<r;n++){const i=this.segments[n];e.push(i.leftSE),e.push(i.rightSE)}return e}}class _ge{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new A8(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let r=1,i=e.length;r<i;r++){const s=new A8(e[r],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,r=this.interiorRings.length;n<r;n++){const i=this.interiorRings[n].getSweepEvents();for(let s=0,l=i.length;s<l;s++)e.push(i[s])}return e}}class u8{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let r=0,i=e.length;r<i;r++){const s=new _ge(e[r],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,r=this.polys.length;n<r;n++){const i=this.polys[n].getSweepEvents();for(let s=0,l=i.length;s<l;s++)e.push(i[s])}return e}}class k2{static factory(e){const n=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s.isInResult()||s.ringOut)continue;let l=null,o=s.leftSE,p=s.rightSE;const w=[o],C=o.point,P=[];for(;l=o,o=p,w.push(o),o.point!==C;)for(;;){const I=o.getAvailableLinkedEvents();if(I.length===0){const H=w[0].point,ie=w[w.length-1].point;throw new Error(`Unable to complete output ring starting at [${H.x}, ${H.y}]. Last matching segment found ends at [${ie.x}, ${ie.y}].`)}if(I.length===1){p=I[0].otherSE;break}let U=null;for(let H=0,ie=P.length;H<ie;H++)if(P[H].point===o.point){U=H;break}if(U!==null){const H=P.splice(U)[0],ie=w.splice(H.index);ie.unshift(ie[0].otherSE),n.push(new k2(ie.reverse()));continue}P.push({index:w.length,point:o.point});const W=o.getLeftmostComparator(l);p=I.sort(W)[0].otherSE;break}n.push(new k2(w))}return n}constructor(e){this.events=e;for(let n=0,r=e.length;n<r;n++)e[n].segment.ringOut=this;this.poly=null}getGeom(){let e=this.events[0].point;const n=[e];for(let w=1,C=this.events.length-1;w<C;w++){const P=this.events[w].point,I=this.events[w+1].point;o8(P,e,I)!==0&&(n.push(P),e=P)}if(n.length===1)return null;const r=n[0],i=n[1];o8(r,e,i)===0&&n.shift(),n.push(n[0]);const s=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:n.length-1,o=this.isExteriorRing()?n.length:-1,p=[];for(let w=l;w!=o;w+=s)p.push([n[w].x,n[w].y]);return p}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let e=this.events[0];for(let i=1,s=this.events.length;i<s;i++){const l=this.events[i];dl.compare(e,l)>0&&(e=l)}let n=e.segment.prevInResult(),r=n?n.prevInResult():null;for(;;){if(!n)return null;if(!r)return n.ringOut;if(r.ringOut!==n.ringOut)return r.ringOut.enclosingRing()!==n.ringOut?n.ringOut:n.ringOut.enclosingRing();n=r.prevInResult(),r=n?n.prevInResult():null}}}class c8{constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(let n=0,r=this.interiorRings.length;n<r;n++){const i=this.interiorRings[n].getGeom();i!==null&&e.push(i)}return e}}class vge{constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,r=this.polys.length;n<r;n++){const i=this.polys[n].getGeom();i!==null&&e.push(i)}return e}_composePolys(e){const n=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s.poly)if(s.isExteriorRing())n.push(new c8(s));else{const l=s.enclosingRing();l.poly||n.push(new c8(l)),l.poly.addInterior(s)}}return n}}class xge{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fh.compare;this.queue=e,this.tree=new s4(n),this.segments=[]}process(e){const n=e.segment,r=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(n),r;const i=e.isLeft?this.tree.add(n):this.tree.find(n);if(!i)throw new Error(`Unable to find segment #${n.id} [${n.leftSE.point.x}, ${n.leftSE.point.y}] -> [${n.rightSE.point.x}, ${n.rightSE.point.y}] in SweepLine tree.`);let s=i,l=i,o,p;for(;o===void 0;)s=this.tree.prev(s),s===null?o=null:s.key.consumedBy===void 0&&(o=s.key);for(;p===void 0;)l=this.tree.next(l),l===null?p=null:l.key.consumedBy===void 0&&(p=l.key);if(e.isLeft){let w=null;if(o){const P=o.getIntersection(n);if(P!==null&&(n.isAnEndpoint(P)||(w=P),!o.isAnEndpoint(P))){const I=this._splitSafely(o,P);for(let U=0,W=I.length;U<W;U++)r.push(I[U])}}let C=null;if(p){const P=p.getIntersection(n);if(P!==null&&(n.isAnEndpoint(P)||(C=P),!p.isAnEndpoint(P))){const I=this._splitSafely(p,P);for(let U=0,W=I.length;U<W;U++)r.push(I[U])}}if(w!==null||C!==null){let P=null;w===null?P=C:C===null?P=w:P=dl.comparePoints(w,C)<=0?w:C,this.queue.remove(n.rightSE),r.push(n.rightSE);const I=n.split(P);for(let U=0,W=I.length;U<W;U++)r.push(I[U])}r.length>0?(this.tree.remove(n),r.push(e)):(this.segments.push(n),n.prev=o)}else{if(o&&p){const w=o.getIntersection(p);if(w!==null){if(!o.isAnEndpoint(w)){const C=this._splitSafely(o,w);for(let P=0,I=C.length;P<I;P++)r.push(C[P])}if(!p.isAnEndpoint(w)){const C=this._splitSafely(p,w);for(let P=0,I=C.length;P<I;P++)r.push(C[P])}}}this.tree.remove(n)}return r}_splitSafely(e,n){this.tree.remove(e);const r=e.rightSE;this.queue.remove(r);const i=e.split(n);return i.push(r),e.consumedBy===void 0&&this.tree.add(e),i}}const h8=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,wge=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class bge{run(e,n,r){AA.type=e,fm.reset();const i=[new u8(n,!0)];for(let P=0,I=r.length;P<I;P++)i.push(new u8(r[P],!1));if(AA.numMultiPolys=i.length,AA.type==="difference"){const P=i[0];let I=1;for(;I<i.length;)BE(i[I].bbox,P.bbox)!==null?I++:i.splice(I,1)}if(AA.type==="intersection")for(let P=0,I=i.length;P<I;P++){const U=i[P];for(let W=P+1,H=i.length;W<H;W++)if(BE(U.bbox,i[W].bbox)===null)return[]}const s=new s4(dl.compare);for(let P=0,I=i.length;P<I;P++){const U=i[P].getSweepEvents();for(let W=0,H=U.length;W<H;W++)if(s.insert(U[W]),s.size>h8)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const l=new xge(s);let o=s.size,p=s.pop();for(;p;){const P=p.key;if(s.size===o){const U=P.segment;throw new Error(`Unable to pop() ${P.isLeft?"left":"right"} SweepEvent [${P.point.x}, ${P.point.y}] from segment #${U.id} [${U.leftSE.point.x}, ${U.leftSE.point.y}] -> [${U.rightSE.point.x}, ${U.rightSE.point.y}] from queue.`)}if(s.size>h8)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(l.segments.length>wge)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const I=l.process(P);for(let U=0,W=I.length;U<W;U++){const H=I[U];H.consumedBy===void 0&&s.insert(H)}o=s.size,p=s.pop()}fm.reset();const w=k2.factory(l.segments);return new vge(w).getGeom()}}const AA=new bge,Ege=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return AA.run("union",t,n)},Tge=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return AA.run("intersection",t,n)},Sge=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return AA.run("xor",t,n)},Cge=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return AA.run("difference",t,n)};var Mge={union:Ege,intersection:Tge,xor:Sge,difference:Cge};function r7(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function Pge(t,e,n){n===void 0&&(n={});for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<s[s.length-1].length;l++)if(s[s.length-1][l]!==s[0][l])throw new Error("First and last Position are not equivalent.")}var o={type:"Polygon",coordinates:t};return r7(o,e,n)}function kge(t,e,n){n===void 0&&(n={});var r={type:"MultiPolygon",coordinates:t};return r7(r,e,n)}function f8(t){return t.type==="Feature"?t.geometry:t}function I2(t,e,n){n===void 0&&(n={});var r=f8(t),i=f8(e),s=Mge.intersection(r.coordinates,i.coordinates);return s.length===0?null:s.length===1?Pge(s[0],n.properties):kge(s,n.properties)}var kt=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(K){return e.locateFile?e.locateFile(K,i):i+K}var l;document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",l=function(Q,te,he){var a=new XMLHttpRequest;a.open("GET",Q,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status==200||a.status==0&&a.response){te(a.response);return}var Le=Lr(Q);if(Le){te(Le.buffer);return}he()},a.onerror=he,a.send(null)};var o=e.print||console.log.bind(console),p=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var w=0,C=function(K){w=K},P=function(){return w},I=8;function U(K,Q,te,he){switch(te=te||"i8",te.charAt(te.length-1)==="*"&&(te="i32"),te){case"i1":it[K>>0]=Q;break;case"i8":it[K>>0]=Q;break;case"i16":yt[K>>1]=Q;break;case"i32":Kt[K>>2]=Q;break;case"i64":ki=[Q>>>0,(Gr=Q,+nr(Gr)>=1?Gr>0?(lr(+vr(Gr/4294967296),4294967295)|0)>>>0:~~+Wn((Gr-+(~~Gr>>>0))/4294967296)>>>0:0)],Kt[K>>2]=ki[0],Kt[K+4>>2]=ki[1];break;case"float":Tt[K>>2]=Q;break;case"double":dn[K>>3]=Q;break;default:Fr("invalid type for setValue: "+te)}}function W(K,Q,te){switch(Q=Q||"i8",Q.charAt(Q.length-1)==="*"&&(Q="i32"),Q){case"i1":return it[K>>0];case"i8":return it[K>>0];case"i16":return yt[K>>1];case"i32":return Kt[K>>2];case"i64":return Kt[K>>2];case"float":return Tt[K>>2];case"double":return dn[K>>3];default:Fr("invalid type for getValue: "+Q)}return null}var H=!1;function ie(K,Q){K||Fr("Assertion failed: "+Q)}function X(K){var Q=e["_"+K];return ie(Q,"Cannot call unknown function "+K+", make sure it is exported"),Q}function ee(K,Q,te,he,a){var G={string:function(dt){var Dt=0;if(dt!=null&&dt!==0){var Rt=(dt.length<<2)+1;Dt=Ns(Rt),Qe(dt,Dt,Rt)}return Dt},array:function(dt){var Dt=Ns(dt.length);return Ke(dt,Dt),Dt}};function Le(dt){return Q==="string"?Se(dt):Q==="boolean"?!!dt:dt}var ke=X(K),Pe=[],Ie=0;if(he)for(var qe=0;qe<he.length;qe++){var At=G[te[qe]];At?(Ie===0&&(Ie=Ai()),Pe[qe]=At(he[qe])):Pe[qe]=he[qe]}var We=ke.apply(null,Pe);return We=Le(We),Ie!==0&&Or(Ie),We}function se(K,Q,te,he){te=te||[];var a=te.every(function(Le){return Le==="number"}),G=Q!=="string";return G&&a&&!he?X(K):function(){return ee(K,Q,te,arguments)}}var fe=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function me(K,Q,te){for(var he=Q+te,a=Q;K[a]&&!(a>=he);)++a;if(a-Q>16&&K.subarray&&fe)return fe.decode(K.subarray(Q,a));for(var G="";Q<a;){var Le=K[Q++];if(!(Le&128)){G+=String.fromCharCode(Le);continue}var ke=K[Q++]&63;if((Le&224)==192){G+=String.fromCharCode((Le&31)<<6|ke);continue}var Pe=K[Q++]&63;if((Le&240)==224?Le=(Le&15)<<12|ke<<6|Pe:Le=(Le&7)<<18|ke<<12|Pe<<6|K[Q++]&63,Le<65536)G+=String.fromCharCode(Le);else{var Ie=Le-65536;G+=String.fromCharCode(55296|Ie>>10,56320|Ie&1023)}}return G}function Se(K,Q){return K?me(Ze,K,Q):""}function He(K,Q,te,he){if(!(he>0))return 0;for(var a=te,G=te+he-1,Le=0;Le<K.length;++Le){var ke=K.charCodeAt(Le);if(ke>=55296&&ke<=57343){var Pe=K.charCodeAt(++Le);ke=65536+((ke&1023)<<10)|Pe&1023}if(ke<=127){if(te>=G)break;Q[te++]=ke}else if(ke<=2047){if(te+1>=G)break;Q[te++]=192|ke>>6,Q[te++]=128|ke&63}else if(ke<=65535){if(te+2>=G)break;Q[te++]=224|ke>>12,Q[te++]=128|ke>>6&63,Q[te++]=128|ke&63}else{if(te+3>=G)break;Q[te++]=240|ke>>18,Q[te++]=128|ke>>12&63,Q[te++]=128|ke>>6&63,Q[te++]=128|ke&63}}return Q[te]=0,te-a}function Qe(K,Q,te){return He(K,Ze,Q,te)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Ke(K,Q){it.set(K,Q)}function rt(K,Q){return K%Q>0&&(K+=Q-K%Q),K}var Ue,it,Ze,yt,Kt,Tt,dn;function _t(K){Ue=K,e.HEAP8=it=new Int8Array(K),e.HEAP16=yt=new Int16Array(K),e.HEAP32=Kt=new Int32Array(K),e.HEAPU8=Ze=new Uint8Array(K),e.HEAPU16=new Uint16Array(K),e.HEAPU32=new Uint32Array(K),e.HEAPF32=Tt=new Float32Array(K),e.HEAPF64=dn=new Float64Array(K)}var Et=5266928,Jt=24016,In=e.TOTAL_MEMORY||33554432;e.buffer?Ue=e.buffer:Ue=new ArrayBuffer(In),In=Ue.byteLength,_t(Ue),Kt[Jt>>2]=Et;function Tn(K){for(;K.length>0;){var Q=K.shift();if(typeof Q=="function"){Q();continue}var te=Q.func;typeof te=="number"?Q.arg===void 0?e.dynCall_v(te):e.dynCall_vi(te,Q.arg):te(Q.arg===void 0?null:Q.arg)}}var Pr=[],tr=[],or=[],hr=[];function Vn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Mn(e.preRun.shift());Tn(Pr)}function Tr(){Tn(tr)}function wt(){Tn(or)}function rn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)xt(e.postRun.shift());Tn(hr)}function Mn(K){Pr.unshift(K)}function xt(K){hr.unshift(K)}var nr=Math.abs,Wn=Math.ceil,vr=Math.floor,lr=Math.min,rr=0,ti=null;function Gn(K){rr++,e.monitorRunDependencies&&e.monitorRunDependencies(rr)}function Pi(K){if(rr--,e.monitorRunDependencies&&e.monitorRunDependencies(rr),rr==0&&ti){var Q=ti;ti=null,Q()}}e.preloadedImages={},e.preloadedAudios={};var qn=null,Vi="data:application/octet-stream;base64,";function mo(K){return String.prototype.startsWith?K.startsWith(Vi):K.indexOf(Vi)===0}var Gr,ki;qn="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var Vo=24032;function os(K){return K}function ht(K){var Q=/\b__Z[\w\d_]+/g;return K.replace(Q,function(te){var he=te;return te===he?te:he+" ["+te+"]"})}function It(){var K=new Error;if(!K.stack){try{throw new Error(0)}catch(Q){K=Q}if(!K.stack)return"(no stack trace available)"}return K.stack.toString()}function Fs(){var K=It();return e.extraStackTrace&&(K+=`
`+e.extraStackTrace()),ht(K)}function wi(K,Q,te,he){Fr("Assertion failed: "+Se(K)+", at: "+[Q?Se(Q):"unknown filename",te,he?Se(he):"unknown function"])}function zn(){return it.length}function Gi(K,Q,te){Ze.set(Ze.subarray(Q,Q+te),K)}function Ii(K){return e.___errno_location&&(Kt[e.___errno_location()>>2]=K),K}function Li(K){Fr("OOM")}function as(K){try{var Q=new ArrayBuffer(K);return Q.byteLength!=K?void 0:(new Int8Array(Q).set(it),Qr(Q),_t(Q),1)}catch{}}function Lt(K){var Q=zn(),te=16777216,he=2147483648-te;if(K>he)return!1;for(var a=16777216,G=Math.max(Q,a);G<K;)G<=536870912?G=rt(2*G,te):G=Math.min(rt((3*G+2147483648)/4,te),he);var Le=as(G);return!!Le}var Sn=typeof atob=="function"?atob:function(K){var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",te="",he,a,G,Le,ke,Pe,Ie,qe=0;K=K.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Le=Q.indexOf(K.charAt(qe++)),ke=Q.indexOf(K.charAt(qe++)),Pe=Q.indexOf(K.charAt(qe++)),Ie=Q.indexOf(K.charAt(qe++)),he=Le<<2|ke>>4,a=(ke&15)<<4|Pe>>2,G=(Pe&3)<<6|Ie,te=te+String.fromCharCode(he),Pe!==64&&(te=te+String.fromCharCode(a)),Ie!==64&&(te=te+String.fromCharCode(G));while(qe<K.length);return te};function bn(K){try{for(var Q=Sn(K),te=new Uint8Array(Q.length),he=0;he<Q.length;++he)te[he]=Q.charCodeAt(he);return te}catch{throw new Error("Converting base64 string to bytes failed.")}}function Lr(K){if(mo(K))return bn(K.slice(Vi.length))}var bs={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},yn={a:Fr,b:C,c:P,d:wi,e:Ii,f:zn,g:Gi,h:Lt,i:Li,j:os,k:ht,l:as,m:It,n:Fs,o:Vo,p:Jt},Ye=function(K,Q,te){"almost asm";var he=new K.Int8Array(te),a=new K.Int32Array(te);new K.Uint8Array(te),new K.Float32Array(te);var G=new K.Float64Array(te),Le=Q.p|0,ke=K.Math.floor,Pe=K.Math.abs,Ie=K.Math.sqrt,qe=K.Math.pow,At=K.Math.cos,We=K.Math.sin,dt=K.Math.tan,Dt=K.Math.acos,Rt=K.Math.asin,sn=K.Math.atan,jt=K.Math.atan2,pn=K.Math.ceil,qt=K.Math.imul,an=K.Math.min,xn=K.Math.clz32,Ft=Q.b,Oe=Q.c,Mt=Q.d,Ce=Q.e,un=Q.f,ui=Q.g,ir=Q.h,ha=Q.i,De=24048;function $a(A){return he=new Int8Array(A),a=new Int32Array(A),G=new Float64Array(A),te=A,!0}function we(A){A=A|0;var h=0;return h=De,De=De+A|0,De=De+15&-16,h|0}function Go(){return De|0}function Es(A){A=A|0,De=A}function ja(A,h){A=A|0,De=A}function Ha(A){return A=A|0,(qt(A*3|0,A+1|0)|0)+1|0}function fa(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0;da(A,h,d,x,0)|0&&(S=(qt(d*3|0,d+1|0)|0)+1|0,L(x|0,0,S<<3|0)|0,b=Ji(S,4)|0,b&&(ni(A,h,d,x,b,S,0),hn(b)))}function Ml(A,h,d,x,b){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0;if(da(A,h,d,x,b)|0){if(S=(qt(d*3|0,d+1|0)|0)+1|0,L(x|0,0,S<<3|0)|0,b|0){L(b|0,0,S<<2|0)|0,ni(A,h,d,x,b,S,0);return}b=Ji(S,4)|0,b&&(ni(A,h,d,x,b,S,0),hn(b))}}function da(A,h,d,x,b){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0;if(ue=De,De=De+16|0,ne=ue,S=x,a[S>>2]=A,a[S+4>>2]=h,S=(b|0)!=0,S&&(a[b>>2]=0),Rr(A,h)|0)return ne=1,De=ue,ne|0;a[ne>>2]=0;e:do if((d|0)>=1)if(S)for(j=0,Y=1,ae=1,M=0,S=A;;){if(!(M|j)){if(S=ge(S,h,4,ne)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(Rr(S,h)|0){S=1;break e}}if(S=ge(S,h,a[16+(j<<2)>>2]|0,ne)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(A=x+(ae<<3)|0,a[A>>2]=S,a[A+4>>2]=h,a[b+(ae<<2)>>2]=Y,M=M+1|0,A=(M|0)==(Y|0),B=j+1|0,V=(B|0)==6,Rr(S,h)|0){S=1;break e}if(Y=Y+(V&A&1)|0,(Y|0)>(d|0)){S=0;break}else j=A?V?0:B:j,ae=ae+1|0,M=A?0:M}else for(j=0,Y=1,ae=1,M=0,S=A;;){if(!(M|j)){if(S=ge(S,h,4,ne)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(Rr(S,h)|0){S=1;break e}}if(S=ge(S,h,a[16+(j<<2)>>2]|0,ne)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(A=x+(ae<<3)|0,a[A>>2]=S,a[A+4>>2]=h,M=M+1|0,A=(M|0)==(Y|0),B=j+1|0,V=(B|0)==6,Rr(S,h)|0){S=1;break e}if(Y=Y+(V&A&1)|0,(Y|0)>(d|0)){S=0;break}else j=A?V?0:B:j,ae=ae+1|0,M=A?0:M}else S=0;while(0);return ne=S,De=ue,ne|0}function ni(A,h,d,x,b,S,M){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0,S=S|0,M=M|0;var B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0;if(ae=De,De=De+16|0,Y=ae,(A|0)==0&(h|0)==0){De=ae;return}if(B=qs(A|0,h|0,S|0,((S|0)<0)<<31>>31|0)|0,Oe()|0,V=x+(B<<3)|0,ne=V,ue=a[ne>>2]|0,ne=a[ne+4>>2]|0,j=(ue|0)==(A|0)&(ne|0)==(h|0),!((ue|0)==0&(ne|0)==0|j))do B=(B+1|0)%(S|0)|0,V=x+(B<<3)|0,ue=V,ne=a[ue>>2]|0,ue=a[ue+4>>2]|0,j=(ne|0)==(A|0)&(ue|0)==(h|0);while(!((ne|0)==0&(ue|0)==0|j));if(B=b+(B<<2)|0,j&&(a[B>>2]|0)<=(M|0)){De=ae;return}if(ue=V,a[ue>>2]=A,a[ue+4>>2]=h,a[B>>2]=M,(M|0)>=(d|0)){De=ae;return}ue=M+1|0,a[Y>>2]=0,ne=ge(A,h,2,Y)|0,ni(ne,Oe()|0,d,x,b,S,ue),a[Y>>2]=0,ne=ge(A,h,3,Y)|0,ni(ne,Oe()|0,d,x,b,S,ue),a[Y>>2]=0,ne=ge(A,h,1,Y)|0,ni(ne,Oe()|0,d,x,b,S,ue),a[Y>>2]=0,ne=ge(A,h,5,Y)|0,ni(ne,Oe()|0,d,x,b,S,ue),a[Y>>2]=0,ne=ge(A,h,4,Y)|0,ni(ne,Oe()|0,d,x,b,S,ue),a[Y>>2]=0,ne=ge(A,h,6,Y)|0,ni(ne,Oe()|0,d,x,b,S,ue),De=ae}function ge(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0;if((a[x>>2]|0)>0){b=0;do d=Hi(d)|0,b=b+1|0;while((b|0)<(a[x>>2]|0))}B=Ct(A|0,h|0,45)|0,Oe()|0,V=B&127,S=ci(A,h)|0,b=Ct(A|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!b)M=6;else for(;;){if(ae=(15-b|0)*3|0,ne=Ct(A|0,h|0,ae|0)|0,Oe()|0,ne=ne&7,ue=(pi(b)|0)==0,b=b+-1|0,Y=Pt(7,0,ae|0)|0,h=h&~(Oe()|0),ae=Pt(a[(ue?464:48)+(ne*28|0)+(d<<2)>>2]|0,0,ae|0)|0,j=Oe()|0,d=a[(ue?672:256)+(ne*28|0)+(d<<2)>>2]|0,A=ae|A&~Y,h=j|h,!d){d=0;break e}if(!b){M=6;break}}while(0);(M|0)==6&&(ue=a[880+(V*28|0)+(d<<2)>>2]|0,ne=Pt(ue|0,0,45)|0,A=ne|A,h=Oe()|0|h&-1040385,d=a[4304+(V*28|0)+(d<<2)>>2]|0,(ue&127|0)==127&&(ue=Pt(a[880+(V*28|0)+20>>2]|0,0,45)|0,h=Oe()|0|h&-1040385,d=a[4304+(V*28|0)+20>>2]|0,A=us(ue|A,h)|0,h=Oe()|0,a[x>>2]=(a[x>>2]|0)+1)),M=Ct(A|0,h|0,45)|0,Oe()|0,M=M&127;e:do if(en(M)|0){t:do if((ci(A,h)|0)==1){if((V|0)!=(M|0))if(iu(M,a[7728+(V*28|0)>>2]|0)|0){A=Xi(A,h)|0,S=1,h=Oe()|0;break}else{A=us(A,h)|0,S=1,h=Oe()|0;break}switch(S|0){case 5:{A=Xi(A,h)|0,h=Oe()|0,a[x>>2]=(a[x>>2]|0)+5,S=0;break t}case 3:{A=us(A,h)|0,h=Oe()|0,a[x>>2]=(a[x>>2]|0)+1,S=0;break t}default:return ne=0,ue=0,Ft(ne|0),ue|0}}else S=0;while(0);if((d|0)>0){b=0;do A=bi(A,h)|0,h=Oe()|0,b=b+1|0;while((b|0)!=(d|0))}if((V|0)!=(M|0)){if(!(Dr(M)|0)){if((S|0)!=0|(ci(A,h)|0)!=5)break;a[x>>2]=(a[x>>2]|0)+1;break}switch(B&127){case 8:case 118:break e}(ci(A,h)|0)!=3&&(a[x>>2]=(a[x>>2]|0)+1)}}else if((d|0)>0){b=0;do A=us(A,h)|0,h=Oe()|0,b=b+1|0;while((b|0)!=(d|0))}while(0);return a[x>>2]=((a[x>>2]|0)+d|0)%6|0,ne=h,ue=A,Ft(ne|0),ue|0}function Ee(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0;if(ae=De,De=De+16|0,Y=ae,!d)return Y=x,a[Y>>2]=A,a[Y+4>>2]=h,Y=0,De=ae,Y|0;a[Y>>2]=0;e:do if(Rr(A,h)|0)A=1;else{if(S=(d|0)>0,S){b=0,j=A;do{if(j=ge(j,h,4,Y)|0,h=Oe()|0,(j|0)==0&(h|0)==0){A=2;break e}if(b=b+1|0,Rr(j,h)|0){A=1;break e}}while((b|0)<(d|0));if(V=x,a[V>>2]=j,a[V+4>>2]=h,V=d+-1|0,S){S=0,M=1,b=j,A=h;do{if(b=ge(b,A,2,Y)|0,A=Oe()|0,(b|0)==0&(A|0)==0){A=2;break e}if(B=x+(M<<3)|0,a[B>>2]=b,a[B+4>>2]=A,M=M+1|0,Rr(b,A)|0){A=1;break e}S=S+1|0}while((S|0)<(d|0));B=0,S=M;do{if(b=ge(b,A,3,Y)|0,A=Oe()|0,(b|0)==0&(A|0)==0){A=2;break e}if(M=x+(S<<3)|0,a[M>>2]=b,a[M+4>>2]=A,S=S+1|0,Rr(b,A)|0){A=1;break e}B=B+1|0}while((B|0)<(d|0));M=0;do{if(b=ge(b,A,1,Y)|0,A=Oe()|0,(b|0)==0&(A|0)==0){A=2;break e}if(B=x+(S<<3)|0,a[B>>2]=b,a[B+4>>2]=A,S=S+1|0,Rr(b,A)|0){A=1;break e}M=M+1|0}while((M|0)<(d|0));M=0;do{if(b=ge(b,A,5,Y)|0,A=Oe()|0,(b|0)==0&(A|0)==0){A=2;break e}if(B=x+(S<<3)|0,a[B>>2]=b,a[B+4>>2]=A,S=S+1|0,Rr(b,A)|0){A=1;break e}M=M+1|0}while((M|0)<(d|0));M=0;do{if(b=ge(b,A,4,Y)|0,A=Oe()|0,(b|0)==0&(A|0)==0){A=2;break e}if(B=x+(S<<3)|0,a[B>>2]=b,a[B+4>>2]=A,S=S+1|0,Rr(b,A)|0){A=1;break e}M=M+1|0}while((M|0)<(d|0));for(M=0;;){if(b=ge(b,A,6,Y)|0,A=Oe()|0,(b|0)==0&(A|0)==0){A=2;break e}if((M|0)!=(V|0))if(B=x+(S<<3)|0,a[B>>2]=b,a[B+4>>2]=A,!(Rr(b,A)|0))S=S+1|0;else{A=1;break e}if(M=M+1|0,(M|0)>=(d|0)){M=j,S=h;break}}}else M=j,b=j,S=h,A=h}else M=x,a[M>>2]=A,a[M+4>>2]=h,M=A,b=A,S=h,A=h;A=((M|0)!=(b|0)|(S|0)!=(A|0))&1}while(0);return Y=A,De=ae,Y|0}function Fe(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;if(S=De,De=De+48|0,b=S+8|0,x=S,B=A,M=a[B+4>>2]|0,d=x,a[d>>2]=a[B>>2],a[d+4>>2]=M,tl(x,b),b=Kn(b,h)|0,h=a[x>>2]|0,x=a[A+8>>2]|0,(x|0)<=0)return B=h,M=(b|0)<(B|0),B=M?B:b,B=B+12|0,De=S,B|0;d=a[A+12>>2]|0,A=0;do h=(a[d+(A<<3)>>2]|0)+h|0,A=A+1|0;while((A|0)<(x|0));return B=(b|0)<(h|0),B=B?h:b,B=B+12|0,De=S,B|0}function lt(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0;if(B=De,De=De+48|0,x=B+8|0,b=B,!(bt(A,h,d)|0)){De=B;return}if(V=A,S=a[V+4>>2]|0,M=b,a[M>>2]=a[V>>2],a[M+4>>2]=S,tl(b,x),M=Kn(x,h)|0,h=a[b>>2]|0,S=a[A+8>>2]|0,(S|0)>0){b=a[A+12>>2]|0,x=0;do h=(a[b+(x<<3)>>2]|0)+h|0,x=x+1|0;while((x|0)!=(S|0))}if(h=(M|0)<(h|0)?h:M,(h|0)<=-12){De=B;return}V=h+11|0,L(d|0,0,(((V|0)>0?V:0)<<3)+8|0)|0,De=B}function bt(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Te=0,Ge=0,xe=0,y=0,m=0,v=0,E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0;if(de=De,De=De+112|0,N=de+80|0,V=de+72|0,q=de,J=de+56|0,j=A+8|0,le=Xt((a[j>>2]<<5)+32|0)|0,le||Mt(22848,22448,800,22456),Hs(A,le),S=A,x=a[S+4>>2]|0,B=V,a[B>>2]=a[S>>2],a[B+4>>2]=x,tl(V,N),B=Kn(N,h)|0,x=a[V>>2]|0,S=a[j>>2]|0,(S|0)>0){M=a[A+12>>2]|0,b=0;do x=(a[M+(b<<3)>>2]|0)+x|0,b=b+1|0;while((b|0)!=(S|0))}if(B=(B|0)<(x|0)?x:B,O=B+12|0,b=Ji(O,8)|0,Y=Ji(O,8)|0,a[N>>2]=0,k=A,R=a[k+4>>2]|0,x=V,a[x>>2]=a[k>>2],a[x+4>>2]=R,x=Qt(V,O,h,N,b,Y)|0,x|0)return hn(b),hn(Y),hn(le),le=x,De=de,le|0;e:do if((a[j>>2]|0)>0){for(S=A+12|0,x=0;M=Qt((a[S>>2]|0)+(x<<3)|0,O,h,N,b,Y)|0,x=x+1|0,!(M|0);)if((x|0)>=(a[j>>2]|0))break e;return hn(b),hn(Y),hn(le),le=M,De=de,le|0}while(0);(B|0)>-12&&L(Y|0,0,((O|0)>1?O:1)<<3|0)|0;e:do if((a[N>>2]|0)>0){R=((O|0)<0)<<31>>31,xe=b,y=Y,m=b,v=b,E=Y,k=b,x=b,ve=b,$e=Y,Te=Y,Ge=Y,b=Y;t:for(;;){for(Me=a[N>>2]|0,ue=0,be=0,S=0;;){M=q,B=M+56|0;do a[M>>2]=0,M=M+4|0;while((M|0)<(B|0));if(h=xe+(ue<<3)|0,V=a[h>>2]|0,h=a[h+4>>2]|0,da(V,h,1,q,0)|0){M=q,B=M+56|0;do a[M>>2]=0,M=M+4|0;while((M|0)<(B|0));M=Ji(7,4)|0,M|0&&(ni(V,h,1,q,M,7,0),hn(M))}ne=0;do{ae=q+(ne<<3)|0,Y=a[ae>>2]|0,ae=a[ae+4>>2]|0;n:do if(!((Y|0)==0&(ae|0)==0)){if(V=qs(Y|0,ae|0,O|0,R|0)|0,Oe()|0,M=d+(V<<3)|0,B=M,h=a[B>>2]|0,B=a[B+4>>2]|0,!((h|0)==0&(B|0)==0))for(j=0;;){if((j|0)>(O|0))break t;if((h|0)==(Y|0)&(B|0)==(ae|0))break n;if(V=(V+1|0)%(O|0)|0,M=d+(V<<3)|0,B=M,h=a[B>>2]|0,B=a[B+4>>2]|0,(h|0)==0&(B|0)==0)break;j=j+1|0}(Y|0)==0&(ae|0)==0||(js(Y,ae,J),yu(A,le,J)|0&&(j=M,a[j>>2]=Y,a[j+4>>2]=ae,j=y+(S<<3)|0,a[j>>2]=Y,a[j+4>>2]=ae,S=S+1|0))}while(0);ne=ne+1|0}while(ne>>>0<7);if(be=be+1|0,(be|0)>=(Me|0))break;ue=ue+1|0}if((Me|0)>0&&L(m|0,0,Me<<3|0)|0,a[N>>2]=S,(S|0)>0)Y=b,ae=Ge,ne=k,ue=Te,be=$e,Me=y,b=ve,Ge=x,Te=v,$e=m,ve=Y,x=ae,k=E,E=ne,v=ue,m=be,y=xe,xe=Me;else break e}return hn(v),hn(E),hn(le),le=-1,De=de,le|0}else x=Y;while(0);return hn(le),hn(b),hn(x),le=0,De=de,le|0}function Qt(A,h,d,x,b,S){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0,S=S|0;var M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Te=0,Ge=0,xe=0,y=0,m=0,v=0,E=0,k=0,R=0,O=0,N=0;if(R=De,De=De+48|0,m=R+32|0,v=R+16|0,E=R,M=a[A>>2]|0,(M|0)<=0)return k=0,De=R,k|0;$e=A+4|0,Te=m+8|0,Ge=v+8|0,xe=E+8|0,y=((h|0)<0)<<31>>31,ve=0;e:for(;;){B=a[$e>>2]|0,be=B+(ve<<4)|0,a[m>>2]=a[be>>2],a[m+4>>2]=a[be+4>>2],a[m+8>>2]=a[be+8>>2],a[m+12>>2]=a[be+12>>2],(ve|0)==(M+-1|0)?(a[v>>2]=a[B>>2],a[v+4>>2]=a[B+4>>2],a[v+8>>2]=a[B+8>>2],a[v+12>>2]=a[B+12>>2]):(be=B+(ve+1<<4)|0,a[v>>2]=a[be>>2],a[v+4>>2]=a[be+4>>2],a[v+8>>2]=a[be+8>>2],a[v+12>>2]=a[be+12>>2]),be=ou(m,v,d)|0;t:do if((be|0)>0){Me=+(be|0),ue=0;n:for(;;){N=+(be-ue|0),O=+(ue|0),G[E>>3]=+G[m>>3]*N/Me+ +G[v>>3]*O/Me,G[xe>>3]=+G[Te>>3]*N/Me+ +G[Ge>>3]*O/Me,ae=Ya(E,d)|0,ne=Oe()|0,B=qs(ae|0,ne|0,h|0,y|0)|0,Oe()|0,M=S+(B<<3)|0,V=M,j=a[V>>2]|0,V=a[V+4>>2]|0;r:do if((j|0)==0&(V|0)==0)k=14;else for(Y=0;;){if((Y|0)>(h|0)){M=1;break r}if((j|0)==(ae|0)&(V|0)==(ne|0)){M=7;break r}if(B=(B+1|0)%(h|0)|0,M=S+(B<<3)|0,V=M,j=a[V>>2]|0,V=a[V+4>>2]|0,(j|0)==0&(V|0)==0){k=14;break}else Y=Y+1|0}while(0);switch((k|0)==14&&(k=0,(ae|0)==0&(ne|0)==0?M=7:(a[M>>2]=ae,a[M+4>>2]=ne,M=a[x>>2]|0,Y=b+(M<<3)|0,a[Y>>2]=ae,a[Y+4>>2]=ne,a[x>>2]=M+1,M=0)),M&7){case 7:case 0:break;default:break n}if(ue=ue+1|0,(be|0)<=(ue|0)){k=8;break t}}if(M|0){M=-1,k=20;break e}}else k=8;while(0);if((k|0)==8&&(k=0),ve=ve+1|0,M=a[A>>2]|0,(ve|0)>=(M|0)){M=0,k=20;break}}return(k|0)==20?(De=R,M|0):0}function Ln(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0;if(j=De,De=De+176|0,V=j,(h|0)<1){Sr(d,0,0),De=j;return}M=A,M=Ct(a[M>>2]|0,a[M+4>>2]|0,52)|0,Oe()|0,Sr(d,(h|0)>6?h:6,M&15),M=0;do{if(x=A+(M<<3)|0,cs(a[x>>2]|0,a[x+4>>2]|0,V),x=a[V>>2]|0,(x|0)>0){B=0;do S=V+8+(B<<4)|0,B=B+1|0,x=V+8+(((B|0)%(x|0)|0)<<4)|0,b=Eu(d,x,S)|0,b?bu(d,b)|0:Mc(d,S,x)|0,x=a[V>>2]|0;while((B|0)<(x|0))}M=M+1|0}while((M|0)!=(h|0));De=j}function Ir(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if(S=De,De=De+32|0,x=S,b=S+16|0,Ln(A,h,b),a[d>>2]=0,a[d+4>>2]=0,a[d+8>>2]=0,A=Hl(b)|0,!A){xa(d)|0,nl(b),De=S;return}do{h=Ch(d)|0;do Mh(h,A)|0,M=A+16|0,a[x>>2]=a[M>>2],a[x+4>>2]=a[M+4>>2],a[x+8>>2]=a[M+8>>2],a[x+12>>2]=a[M+12>>2],bu(b,A)|0,A=Pc(b,x)|0;while(A|0);A=Hl(b)|0}while(A|0);xa(d)|0,nl(b),De=S}function en(A){return A=A|0,a[7728+(A*28|0)+16>>2]|0}function Dr(A){return A=A|0,(A|0)==4|(A|0)==117|0}function $n(A){return A=A|0,a[11152+((a[A>>2]|0)*216|0)+((a[A+4>>2]|0)*72|0)+((a[A+8>>2]|0)*24|0)+(a[A+12>>2]<<3)>>2]|0}function wA(A){return A=A|0,a[11152+((a[A>>2]|0)*216|0)+((a[A+4>>2]|0)*72|0)+((a[A+8>>2]|0)*24|0)+(a[A+12>>2]<<3)+4>>2]|0}function bA(A,h){A=A|0,h=h|0,A=7728+(A*28|0)|0,a[h>>2]=a[A>>2],a[h+4>>2]=a[A+4>>2],a[h+8>>2]=a[A+8>>2],a[h+12>>2]=a[A+12>>2]}function EA(A,h){A=A|0,h=h|0;var d=0,x=0;if(h>>>0>20)return h=-1,h|0;do if((a[11152+(h*216|0)>>2]|0)!=(A|0))if((a[11152+(h*216|0)+8>>2]|0)!=(A|0))if((a[11152+(h*216|0)+16>>2]|0)!=(A|0))if((a[11152+(h*216|0)+24>>2]|0)!=(A|0))if((a[11152+(h*216|0)+32>>2]|0)!=(A|0))if((a[11152+(h*216|0)+40>>2]|0)!=(A|0))if((a[11152+(h*216|0)+48>>2]|0)!=(A|0))if((a[11152+(h*216|0)+56>>2]|0)!=(A|0))if((a[11152+(h*216|0)+64>>2]|0)!=(A|0))if((a[11152+(h*216|0)+72>>2]|0)!=(A|0))if((a[11152+(h*216|0)+80>>2]|0)!=(A|0))if((a[11152+(h*216|0)+88>>2]|0)!=(A|0))if((a[11152+(h*216|0)+96>>2]|0)!=(A|0))if((a[11152+(h*216|0)+104>>2]|0)!=(A|0))if((a[11152+(h*216|0)+112>>2]|0)!=(A|0))if((a[11152+(h*216|0)+120>>2]|0)!=(A|0))if((a[11152+(h*216|0)+128>>2]|0)!=(A|0))if((a[11152+(h*216|0)+136>>2]|0)==(A|0))A=2,d=1,x=2;else{if((a[11152+(h*216|0)+144>>2]|0)==(A|0)){A=0,d=2,x=0;break}if((a[11152+(h*216|0)+152>>2]|0)==(A|0)){A=0,d=2,x=1;break}if((a[11152+(h*216|0)+160>>2]|0)==(A|0)){A=0,d=2,x=2;break}if((a[11152+(h*216|0)+168>>2]|0)==(A|0)){A=1,d=2,x=0;break}if((a[11152+(h*216|0)+176>>2]|0)==(A|0)){A=1,d=2,x=1;break}if((a[11152+(h*216|0)+184>>2]|0)==(A|0)){A=1,d=2,x=2;break}if((a[11152+(h*216|0)+192>>2]|0)==(A|0)){A=2,d=2,x=0;break}if((a[11152+(h*216|0)+200>>2]|0)==(A|0)){A=2,d=2,x=1;break}if((a[11152+(h*216|0)+208>>2]|0)==(A|0)){A=2,d=2,x=2;break}else A=-1;return A|0}else A=2,d=1,x=1;else A=2,d=1,x=0;else A=1,d=1,x=2;else A=1,d=1,x=1;else A=1,d=1,x=0;else A=0,d=1,x=2;else A=0,d=1,x=1;else A=0,d=1,x=0;else A=2,d=0,x=2;else A=2,d=0,x=1;else A=2,d=0,x=0;else A=1,d=0,x=2;else A=1,d=0,x=1;else A=1,d=0,x=0;else A=0,d=0,x=2;else A=0,d=0,x=1;else A=0,d=0,x=0;while(0);return h=a[11152+(h*216|0)+(d*72|0)+(A*24|0)+(x<<3)+4>>2]|0,h|0}function iu(A,h){return A=A|0,h=h|0,(a[7728+(A*28|0)+20>>2]|0)==(h|0)?(h=1,h|0):(h=(a[7728+(A*28|0)+24>>2]|0)==(h|0),h|0)}function su(A,h){return A=A|0,h=h|0,a[880+(A*28|0)+(h<<2)>>2]|0}function TA(A,h){return A=A|0,h=h|0,(a[880+(A*28|0)>>2]|0)==(h|0)?(h=0,h|0):(a[880+(A*28|0)+4>>2]|0)==(h|0)?(h=1,h|0):(a[880+(A*28|0)+8>>2]|0)==(h|0)?(h=2,h|0):(a[880+(A*28|0)+12>>2]|0)==(h|0)?(h=3,h|0):(a[880+(A*28|0)+16>>2]|0)==(h|0)?(h=4,h|0):(a[880+(A*28|0)+20>>2]|0)==(h|0)?(h=5,h|0):((a[880+(A*28|0)+24>>2]|0)==(h|0)?6:7)|0}function Pl(){return 122}function kl(A){A=A|0;var h=0,d=0,x=0;h=0;do Pt(h|0,0,45)|0,x=Oe()|0|134225919,d=A+(h<<3)|0,a[d>>2]=-1,a[d+4>>2]=x,h=h+1|0;while((h|0)!=122)}function SA(A){return A=A|0,+G[A+16>>3]<+G[A+24>>3]|0}function CA(A,h){A=A|0,h=h|0;var d=0,x=0,b=0;return d=+G[h>>3],!(d>=+G[A+8>>3])||!(d<=+G[A>>3])?(h=0,h|0):(x=+G[A+16>>3],d=+G[A+24>>3],b=+G[h+8>>3],h=b>=d,A=b<=x&1,x<d?h&&(A=1):h||(A=0),h=(A|0)!=0,h|0)}function Kn(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0;M=De,De=De+288|0,d=M+264|0,x=M+96|0,b=M,S=b,B=S+96|0;do a[S>>2]=0,S=S+4|0;while((S|0)<(B|0));return si(h,b),S=b,B=a[S>>2]|0,S=a[S+4>>2]|0,js(B,S,d),cs(B,S,x),V=+Zn(d,x+8|0),G[d>>3]=+G[A>>3],S=d+8|0,G[S>>3]=+G[A+16>>3],G[x>>3]=+G[A+8>>3],B=x+8|0,G[B>>3]=+G[A+24>>3],j=+Zn(d,x),B=~~+pn(+(j*j/+jr(+ +Pe(+((+G[S>>3]-+G[B>>3])/(+G[d>>3]-+G[x>>3]))),3)/(V*(V*2.59807621135)*.8))),De=M,(B|0?B:1)|0}function ou(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0;B=De,De=De+288|0,x=B+264|0,b=B+96|0,S=B,M=S,V=M+96|0;do a[M>>2]=0,M=M+4|0;while((M|0)<(V|0));return si(d,S),V=S,M=a[V>>2]|0,V=a[V+4>>2]|0,js(M,V,x),cs(M,V,b),j=+Zn(x,b+8|0),V=~~+pn(+(+Zn(A,h)/(j*2))),De=B,(V|0?V:1)|0}function yc(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0,a[A>>2]=h,a[A+4>>2]=d,a[A+8>>2]=x}function Il(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0;ae=h+8|0,a[ae>>2]=0,V=+G[A>>3],M=+Pe(+V),j=+G[A+8>>3],B=+Pe(+j)/.8660254037844386,M=M+B*.5,d=~~M,A=~~B,M=M-+(d|0),B=B-+(A|0);do if(M<.5)if(M<.3333333333333333)if(a[h>>2]=d,B<(M+1)*.5){a[h+4>>2]=A;break}else{A=A+1|0,a[h+4>>2]=A;break}else if(ne=1-M,A=(!(B<ne)&1)+A|0,a[h+4>>2]=A,ne<=B&B<M*2){d=d+1|0,a[h>>2]=d;break}else{a[h>>2]=d;break}else{if(!(M<.6666666666666666))if(d=d+1|0,a[h>>2]=d,B<M*.5){a[h+4>>2]=A;break}else{A=A+1|0,a[h+4>>2]=A;break}if(B<1-M){if(a[h+4>>2]=A,M*2+-1<B){a[h>>2]=d;break}}else A=A+1|0,a[h+4>>2]=A;d=d+1|0,a[h>>2]=d}while(0);do if(V<0)if(A&1){Y=(A+1|0)/2|0,Y=$r(d|0,((d|0)<0)<<31>>31|0,Y|0,((Y|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-((+(Y>>>0)+4294967296*+(Oe()|0))*2+1)),a[h>>2]=d;break}else{Y=(A|0)/2|0,Y=$r(d|0,((d|0)<0)<<31>>31|0,Y|0,((Y|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-(+(Y>>>0)+4294967296*+(Oe()|0))*2),a[h>>2]=d;break}while(0);Y=h+4|0,j<0&&(d=d-((A<<1|1|0)/2|0)|0,a[h>>2]=d,A=0-A|0,a[Y>>2]=A),x=A-d|0,(d|0)<0?(b=0-d|0,a[Y>>2]=x,a[ae>>2]=b,a[h>>2]=0,A=x,d=0):b=0,(A|0)<0&&(d=d-A|0,a[h>>2]=d,b=b-A|0,a[ae>>2]=b,a[Y>>2]=0,A=0),S=d-b|0,x=A-b|0,(b|0)<0&&(a[h>>2]=S,a[Y>>2]=x,a[ae>>2]=0,A=x,d=S,b=0),x=(A|0)<(d|0)?A:d,x=(b|0)<(x|0)?b:x,!((x|0)<=0)&&(a[h>>2]=d-x,a[Y>>2]=A-x,a[ae>>2]=b-x)}function qr(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0;h=a[A>>2]|0,M=A+4|0,d=a[M>>2]|0,(h|0)<0&&(d=d-h|0,a[M>>2]=d,S=A+8|0,a[S>>2]=(a[S>>2]|0)-h,a[A>>2]=0,h=0),(d|0)<0?(h=h-d|0,a[A>>2]=h,S=A+8|0,b=(a[S>>2]|0)-d|0,a[S>>2]=b,a[M>>2]=0,d=0):(b=A+8|0,S=b,b=a[b>>2]|0),(b|0)<0&&(h=h-b|0,a[A>>2]=h,d=d-b|0,a[M>>2]=d,a[S>>2]=0,b=0),x=(d|0)<(h|0)?d:h,x=(b|0)<(x|0)?b:x,!((x|0)<=0)&&(a[A>>2]=h-x,a[M>>2]=d-x,a[S>>2]=b-x)}function $o(A,h){A=A|0,h=h|0;var d=0,x=0;x=a[A+8>>2]|0,d=+((a[A+4>>2]|0)-x|0),G[h>>3]=+((a[A>>2]|0)-x|0)-d*.5,G[h+8>>3]=d*.8660254037844386}function On(A,h,d){A=A|0,h=h|0,d=d|0,a[d>>2]=(a[h>>2]|0)+(a[A>>2]|0),a[d+4>>2]=(a[h+4>>2]|0)+(a[A+4>>2]|0),a[d+8>>2]=(a[h+8>>2]|0)+(a[A+8>>2]|0)}function Ts(A,h,d){A=A|0,h=h|0,d=d|0,a[d>>2]=(a[A>>2]|0)-(a[h>>2]|0),a[d+4>>2]=(a[A+4>>2]|0)-(a[h+4>>2]|0),a[d+8>>2]=(a[A+8>>2]|0)-(a[h+8>>2]|0)}function ri(A,h){A=A|0,h=h|0;var d=0,x=0;d=qt(a[A>>2]|0,h)|0,a[A>>2]=d,d=A+4|0,x=qt(a[d>>2]|0,h)|0,a[d>>2]=x,A=A+8|0,h=qt(a[A>>2]|0,h)|0,a[A>>2]=h}function yo(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;M=a[A>>2]|0,B=(M|0)<0,x=(a[A+4>>2]|0)-(B?M:0)|0,S=(x|0)<0,b=(S?0-x|0:0)+((a[A+8>>2]|0)-(B?M:0))|0,d=(b|0)<0,A=d?0:b,h=(S?0:x)-(d?b:0)|0,b=(B?0:M)-(S?x:0)-(d?b:0)|0,d=(h|0)<(b|0)?h:b,d=(A|0)<(d|0)?A:d,x=(d|0)>0,A=A-(x?d:0)|0,h=h-(x?d:0)|0;e:do switch(b-(x?d:0)|0){case 0:switch(h|0){case 0:return B=A|0?(A|0)==1?1:7:0,B|0;case 1:return B=A|0?(A|0)==1?3:7:2,B|0;default:break e}case 1:switch(h|0){case 0:return B=A|0?(A|0)==1?5:7:4,B|0;case 1:{if(!A)A=6;else break e;return A|0}default:break e}}while(0);return B=7,B|0}function Ll(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;M=A+8|0,d=a[M>>2]|0,h=(a[A>>2]|0)-d|0,B=A+4|0,d=(a[B>>2]|0)-d|0,x=Yt(+((h*3|0)-d|0)/7)|0,a[A>>2]=x,h=Yt(+((d<<1)+h|0)/7)|0,a[B>>2]=h,a[M>>2]=0,d=h-x|0,(x|0)<0?(S=0-x|0,a[B>>2]=d,a[M>>2]=S,a[A>>2]=0,h=d,x=0,d=S):d=0,(h|0)<0&&(x=x-h|0,a[A>>2]=x,d=d-h|0,a[M>>2]=d,a[B>>2]=0,h=0),S=x-d|0,b=h-d|0,(d|0)<0?(a[A>>2]=S,a[B>>2]=b,a[M>>2]=0,h=b,b=S,d=0):b=x,x=(h|0)<(b|0)?h:b,x=(d|0)<(x|0)?d:x,!((x|0)<=0)&&(a[A>>2]=b-x,a[B>>2]=h-x,a[M>>2]=d-x)}function jo(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;M=A+8|0,d=a[M>>2]|0,h=(a[A>>2]|0)-d|0,B=A+4|0,d=(a[B>>2]|0)-d|0,x=Yt(+((h<<1)+d|0)/7)|0,a[A>>2]=x,h=Yt(+((d*3|0)-h|0)/7)|0,a[B>>2]=h,a[M>>2]=0,d=h-x|0,(x|0)<0?(S=0-x|0,a[B>>2]=d,a[M>>2]=S,a[A>>2]=0,h=d,x=0,d=S):d=0,(h|0)<0&&(x=x-h|0,a[A>>2]=x,d=d-h|0,a[M>>2]=d,a[B>>2]=0,h=0),S=x-d|0,b=h-d|0,(d|0)<0?(a[A>>2]=S,a[B>>2]=b,a[M>>2]=0,h=b,b=S,d=0):b=x,x=(h|0)<(b|0)?h:b,x=(d|0)<(x|0)?d:x,!((x|0)<=0)&&(a[A>>2]=b-x,a[B>>2]=h-x,a[M>>2]=d-x)}function pa(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;h=a[A>>2]|0,M=A+4|0,d=a[M>>2]|0,B=A+8|0,x=a[B>>2]|0,b=d+(h*3|0)|0,a[A>>2]=b,d=x+(d*3|0)|0,a[M>>2]=d,h=(x*3|0)+h|0,a[B>>2]=h,x=d-b|0,(b|0)<0?(h=h-b|0,a[M>>2]=x,a[B>>2]=h,a[A>>2]=0,d=x,x=0):x=b,(d|0)<0&&(x=x-d|0,a[A>>2]=x,h=h-d|0,a[B>>2]=h,a[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=S,a[M>>2]=b,a[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=x-d,a[M>>2]=b-d,a[B>>2]=h-d)}function _o(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=a[A>>2]|0,M=A+4|0,h=a[M>>2]|0,B=A+8|0,d=a[B>>2]|0,x=(h*3|0)+b|0,b=d+(b*3|0)|0,a[A>>2]=b,a[M>>2]=x,h=(d*3|0)+h|0,a[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,a[M>>2]=d,a[B>>2]=h,a[A>>2]=0,b=0):d=x,(d|0)<0&&(b=b-d|0,a[A>>2]=b,h=h-d|0,a[B>>2]=h,a[M>>2]=0,d=0),S=b-h|0,x=d-h|0,(h|0)<0?(a[A>>2]=S,a[M>>2]=x,a[B>>2]=0,b=S,h=0):x=d,d=(x|0)<(b|0)?x:b,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=b-d,a[M>>2]=x-d,a[B>>2]=h-d)}function MA(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;(h+-1|0)>>>0>=6||(b=(a[15472+(h*12|0)>>2]|0)+(a[A>>2]|0)|0,a[A>>2]=b,B=A+4|0,x=(a[15472+(h*12|0)+4>>2]|0)+(a[B>>2]|0)|0,a[B>>2]=x,M=A+8|0,h=(a[15472+(h*12|0)+8>>2]|0)+(a[M>>2]|0)|0,a[M>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,a[B>>2]=d,a[M>>2]=h,a[A>>2]=0,x=0):(d=x,x=b),(d|0)<0&&(x=x-d|0,a[A>>2]=x,h=h-d|0,a[M>>2]=h,a[B>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=S,a[B>>2]=b,a[M>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=x-d,a[B>>2]=b-d,a[M>>2]=h-d))}function Wa(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=a[A>>2]|0,M=A+4|0,h=a[M>>2]|0,B=A+8|0,d=a[B>>2]|0,x=h+b|0,b=d+b|0,a[A>>2]=b,a[M>>2]=x,h=d+h|0,a[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,a[M>>2]=d,a[B>>2]=h,a[A>>2]=0,x=0):(d=x,x=b),(d|0)<0&&(x=x-d|0,a[A>>2]=x,h=h-d|0,a[B>>2]=h,a[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=S,a[M>>2]=b,a[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=x-d,a[M>>2]=b-d,a[B>>2]=h-d)}function Ho(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;h=a[A>>2]|0,M=A+4|0,x=a[M>>2]|0,B=A+8|0,d=a[B>>2]|0,b=x+h|0,a[A>>2]=b,x=d+x|0,a[M>>2]=x,h=d+h|0,a[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,a[M>>2]=d,a[B>>2]=h,a[A>>2]=0,x=0):(d=x,x=b),(d|0)<0&&(x=x-d|0,a[A>>2]=x,h=h-d|0,a[B>>2]=h,a[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=S,a[M>>2]=b,a[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=x-d,a[M>>2]=b-d,a[B>>2]=h-d)}function Hi(A){switch(A=A|0,A|0){case 1:{A=5;break}case 5:{A=4;break}case 4:{A=6;break}case 6:{A=2;break}case 2:{A=3;break}case 3:{A=1;break}}return A|0}function Wi(A){switch(A=A|0,A|0){case 1:{A=3;break}case 3:{A=2;break}case 2:{A=6;break}case 6:{A=4;break}case 4:{A=5;break}case 5:{A=1;break}}return A|0}function au(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;h=a[A>>2]|0,M=A+4|0,d=a[M>>2]|0,B=A+8|0,x=a[B>>2]|0,b=d+(h<<1)|0,a[A>>2]=b,d=x+(d<<1)|0,a[M>>2]=d,h=(x<<1)+h|0,a[B>>2]=h,x=d-b|0,(b|0)<0?(h=h-b|0,a[M>>2]=x,a[B>>2]=h,a[A>>2]=0,d=x,x=0):x=b,(d|0)<0&&(x=x-d|0,a[A>>2]=x,h=h-d|0,a[B>>2]=h,a[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=S,a[M>>2]=b,a[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=x-d,a[M>>2]=b-d,a[B>>2]=h-d)}function Dl(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=a[A>>2]|0,M=A+4|0,h=a[M>>2]|0,B=A+8|0,d=a[B>>2]|0,x=(h<<1)+b|0,b=d+(b<<1)|0,a[A>>2]=b,a[M>>2]=x,h=(d<<1)+h|0,a[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,a[M>>2]=d,a[B>>2]=h,a[A>>2]=0,b=0):d=x,(d|0)<0&&(b=b-d|0,a[A>>2]=b,h=h-d|0,a[B>>2]=h,a[M>>2]=0,d=0),S=b-h|0,x=d-h|0,(h|0)<0?(a[A>>2]=S,a[M>>2]=x,a[B>>2]=0,b=S,h=0):x=d,d=(x|0)<(b|0)?x:b,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=b-d,a[M>>2]=x-d,a[B>>2]=h-d)}function vo(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;return M=(a[A>>2]|0)-(a[h>>2]|0)|0,B=(M|0)<0,x=(a[A+4>>2]|0)-(a[h+4>>2]|0)-(B?M:0)|0,S=(x|0)<0,b=(B?0-M|0:0)+(a[A+8>>2]|0)-(a[h+8>>2]|0)+(S?0-x|0:0)|0,A=(b|0)<0,h=A?0:b,d=(S?0:x)-(A?b:0)|0,b=(B?0:M)-(S?x:0)-(A?b:0)|0,A=(d|0)<(b|0)?d:b,A=(h|0)<(A|0)?h:A,x=(A|0)>0,h=h-(x?A:0)|0,d=d-(x?A:0)|0,A=b-(x?A:0)|0,A=(A|0)>-1?A:0-A|0,d=(d|0)>-1?d:0-d|0,h=(h|0)>-1?h:0-h|0,h=(d|0)>(h|0)?d:h,((A|0)>(h|0)?A:h)|0}function Wo(A,h){A=A|0,h=h|0;var d=0;d=a[A+8>>2]|0,a[h>>2]=(a[A>>2]|0)-d,a[h+4>>2]=(a[A+4>>2]|0)-d}function _c(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;x=a[A>>2]|0,a[h>>2]=x,A=a[A+4>>2]|0,M=h+4|0,a[M>>2]=A,B=h+8|0,a[B>>2]=0,d=A-x|0,(x|0)<0?(A=0-x|0,a[M>>2]=d,a[B>>2]=A,a[h>>2]=0,x=0):(d=A,A=0),(d|0)<0&&(x=x-d|0,a[h>>2]=x,A=A-d|0,a[B>>2]=A,a[M>>2]=0,d=0),S=x-A|0,b=d-A|0,(A|0)<0?(a[h>>2]=S,a[M>>2]=b,a[B>>2]=0,d=b,b=S,A=0):b=x,x=(d|0)<(b|0)?d:b,x=(A|0)<(x|0)?A:x,!((x|0)<=0)&&(a[h>>2]=b-x,a[M>>2]=d-x,a[B>>2]=A-x)}function lu(A){A=A|0;var h=0,d=0,x=0,b=0;h=A+8|0,b=a[h>>2]|0,d=b-(a[A>>2]|0)|0,a[A>>2]=d,x=A+4|0,A=(a[x>>2]|0)-b|0,a[x>>2]=A,a[h>>2]=0-(A+d)}function Rl(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;d=a[A>>2]|0,h=0-d|0,a[A>>2]=h,M=A+8|0,a[M>>2]=0,B=A+4|0,x=a[B>>2]|0,b=x+d|0,(d|0)>0?(a[B>>2]=b,a[M>>2]=d,a[A>>2]=0,h=0,x=b):d=0,(x|0)<0?(S=h-x|0,a[A>>2]=S,d=d-x|0,a[M>>2]=d,a[B>>2]=0,b=S-d|0,h=0-d|0,(d|0)<0?(a[A>>2]=b,a[B>>2]=h,a[M>>2]=0,x=h,d=0):(x=0,b=S)):b=h,h=(x|0)<(b|0)?x:b,h=(d|0)<(h|0)?d:h,!((h|0)<=0)&&(a[A>>2]=b-h,a[B>>2]=x-h,a[M>>2]=d-h)}function PA(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0;x=De,De=De+16|0,b=x,Au(A,h,d,b),Il(b,d+4|0),De=x}function Au(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0;if(V=De,De=De+32|0,S=V,jl(A,S),a[d>>2]=0,b=+Nr(15888,S),M=+Nr(15912,S),M<b&&(a[d>>2]=1,b=M),M=+Nr(15936,S),M<b&&(a[d>>2]=2,b=M),M=+Nr(15960,S),M<b&&(a[d>>2]=3,b=M),M=+Nr(15984,S),M<b&&(a[d>>2]=4,b=M),M=+Nr(16008,S),M<b&&(a[d>>2]=5,b=M),M=+Nr(16032,S),M<b&&(a[d>>2]=6,b=M),M=+Nr(16056,S),M<b&&(a[d>>2]=7,b=M),M=+Nr(16080,S),M<b&&(a[d>>2]=8,b=M),M=+Nr(16104,S),M<b&&(a[d>>2]=9,b=M),M=+Nr(16128,S),M<b&&(a[d>>2]=10,b=M),M=+Nr(16152,S),M<b&&(a[d>>2]=11,b=M),M=+Nr(16176,S),M<b&&(a[d>>2]=12,b=M),M=+Nr(16200,S),M<b&&(a[d>>2]=13,b=M),M=+Nr(16224,S),M<b&&(a[d>>2]=14,b=M),M=+Nr(16248,S),M<b&&(a[d>>2]=15,b=M),M=+Nr(16272,S),M<b&&(a[d>>2]=16,b=M),M=+Nr(16296,S),M<b&&(a[d>>2]=17,b=M),M=+Nr(16320,S),M<b&&(a[d>>2]=18,b=M),M=+Nr(16344,S),M<b&&(a[d>>2]=19,b=M),M=+Dt(+(1-b*.5)),M<1e-16){a[x>>2]=0,a[x+4>>2]=0,a[x+8>>2]=0,a[x+12>>2]=0,De=V;return}if(d=a[d>>2]|0,b=+G[16368+(d*24|0)>>3],b=+fr(b-+fr(+gr(15568+(d<<4)|0,A))),pi(h)|0?B=+fr(b+-.3334731722518321):B=b,b=+dt(+M)/.381966011250105,(h|0)>0){S=0;do b=b*2.6457513110645907,S=S+1|0;while((S|0)!=(h|0))}M=+At(+B)*b,G[x>>3]=M,B=+We(+B)*b,G[x+8>>3]=B,De=V}function Qo(A,h,d,x,b){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0;if(S=+Eo(A),S<1e-16){h=15568+(h<<4)|0,a[b>>2]=a[h>>2],a[b+4>>2]=a[h+4>>2],a[b+8>>2]=a[h+8>>2],a[b+12>>2]=a[h+12>>2];return}if(M=+jt(+ +G[A+8>>3],+ +G[A>>3]),(d|0)>0){A=0;do S=S/2.6457513110645907,A=A+1|0;while((A|0)!=(d|0))}x?(S=S/3,d=(pi(d)|0)==0,S=+sn(+((d?S:S/2.6457513110645907)*.381966011250105))):(S=+sn(+(S*.381966011250105)),pi(d)|0&&(M=+fr(M+.3334731722518321))),Bl(15568+(h<<4)|0,+fr(+G[16368+(h*24|0)>>3]-M),S,b)}function Qa(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0;x=De,De=De+16|0,b=x,$o(A+4|0,b),Qo(b,a[A>>2]|0,h,0,d),De=x}function uu(A,h,d,x,b){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Te=0,Ge=0,xe=0,y=0,m=0,v=0,E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0;if(J=De,De=De+272|0,S=J+256|0,Te=J+240|0,O=J,N=J+224|0,q=J+208|0,Ge=J+176|0,xe=J+160|0,y=J+192|0,m=J+144|0,v=J+128|0,E=J+112|0,k=J+96|0,R=J+80|0,a[S>>2]=h,a[Te>>2]=a[A>>2],a[Te+4>>2]=a[A+4>>2],a[Te+8>>2]=a[A+8>>2],a[Te+12>>2]=a[A+12>>2],cu(Te,S,O),a[b>>2]=0,Te=x+d+((x|0)==5&1)|0,(Te|0)<=(d|0)){De=J;return}V=a[S>>2]|0,j=N+4|0,Y=Ge+4|0,ae=d+5|0,ne=16848+(V<<2)|0,ue=16928+(V<<2)|0,be=v+8|0,Me=E+8|0,ve=k+8|0,$e=q+4|0,B=d;e:for(;;){M=O+(((B|0)%5|0)<<4)|0,a[q>>2]=a[M>>2],a[q+4>>2]=a[M+4>>2],a[q+8>>2]=a[M+8>>2],a[q+12>>2]=a[M+12>>2];do;while((xo(q,V,0,1)|0)==2);if((B|0)>(d|0)&(pi(h)|0)!=0){if(a[Ge>>2]=a[q>>2],a[Ge+4>>2]=a[q+4>>2],a[Ge+8>>2]=a[q+8>>2],a[Ge+12>>2]=a[q+12>>2],$o(j,xe),x=a[Ge>>2]|0,S=a[17008+(x*80|0)+(a[N>>2]<<2)>>2]|0,a[Ge>>2]=a[18608+(x*80|0)+(S*20|0)>>2],M=a[18608+(x*80|0)+(S*20|0)+16>>2]|0,(M|0)>0){A=0;do Wa(Y),A=A+1|0;while((A|0)<(M|0))}switch(M=18608+(x*80|0)+(S*20|0)+4|0,a[y>>2]=a[M>>2],a[y+4>>2]=a[M+4>>2],a[y+8>>2]=a[M+8>>2],ri(y,(a[ne>>2]|0)*3|0),On(Y,y,Y),qr(Y),$o(Y,m),le=+(a[ue>>2]|0),G[v>>3]=le*3,G[be>>3]=0,de=le*-1.5,G[E>>3]=de,G[Me>>3]=le*2.598076211353316,G[k>>3]=de,G[ve>>3]=le*-2.598076211353316,a[17008+((a[Ge>>2]|0)*80|0)+(a[q>>2]<<2)>>2]|0){case 1:{A=E,x=v;break}case 3:{A=k,x=E;break}case 2:{A=v,x=k;break}default:{A=12;break e}}wu(xe,m,x,A,R),Qo(R,a[Ge>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1}if((B|0)<(ae|0)&&($o($e,Ge),Qo(Ge,a[q>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1),a[N>>2]=a[q>>2],a[N+4>>2]=a[q+4>>2],a[N+8>>2]=a[q+8>>2],a[N+12>>2]=a[q+12>>2],B=B+1|0,(B|0)>=(Te|0)){A=3;break}}if((A|0)==3){De=J;return}else(A|0)==12&&Mt(22474,22521,581,22531)}function cu(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0;V=De,De=De+128|0,x=V+64|0,b=V,S=x,M=20208,B=S+60|0;do a[S>>2]=a[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));S=b,M=20272,B=S+60|0;do a[S>>2]=a[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));B=(pi(a[h>>2]|0)|0)==0,x=B?x:b,b=A+4|0,au(b),Dl(b),pi(a[h>>2]|0)|0&&(_o(b),a[h>>2]=(a[h>>2]|0)+1),a[d>>2]=a[A>>2],h=d+4|0,On(b,x,h),qr(h),a[d+16>>2]=a[A>>2],h=d+20|0,On(b,x+12|0,h),qr(h),a[d+32>>2]=a[A>>2],h=d+36|0,On(b,x+24|0,h),qr(h),a[d+48>>2]=a[A>>2],h=d+52|0,On(b,x+36|0,h),qr(h),a[d+64>>2]=a[A>>2],d=d+68|0,On(b,x+48|0,d),qr(d),De=V}function xo(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0;if(be=De,De=De+32|0,ne=be+12|0,B=be,ue=A+4|0,ae=a[16928+(h<<2)>>2]|0,Y=(x|0)!=0,ae=Y?ae*3|0:ae,b=a[ue>>2]|0,j=A+8|0,M=a[j>>2]|0,Y){if(S=A+12|0,x=a[S>>2]|0,b=M+b+x|0,(b|0)==(ae|0))return ue=1,De=be,ue|0;V=S}else V=A+12|0,x=a[V>>2]|0,b=M+b+x|0;if((b|0)<=(ae|0))return ue=0,De=be,ue|0;do if((x|0)>0){if(x=a[A>>2]|0,(M|0)>0){S=18608+(x*80|0)+60|0,x=A;break}x=18608+(x*80|0)+40|0,d?(yc(ne,ae,0,0),Ts(ue,ne,B),Ho(B),On(B,ne,ue),S=x,x=A):(S=x,x=A)}else S=18608+((a[A>>2]|0)*80|0)+20|0,x=A;while(0);if(a[x>>2]=a[S>>2],b=S+16|0,(a[b>>2]|0)>0){x=0;do Wa(ue),x=x+1|0;while((x|0)<(a[b>>2]|0))}return A=S+4|0,a[ne>>2]=a[A>>2],a[ne+4>>2]=a[A+4>>2],a[ne+8>>2]=a[A+8>>2],h=a[16848+(h<<2)>>2]|0,ri(ne,Y?h*3|0:h),On(ue,ne,ue),qr(ue),Y?x=((a[j>>2]|0)+(a[ue>>2]|0)+(a[V>>2]|0)|0)==(ae|0)?1:2:x=2,ue=x,De=be,ue|0}function ga(A,h){A=A|0,h=h|0;var d=0;do d=xo(A,h,0,1)|0;while((d|0)==2);return d|0}function hu(A,h,d,x,b){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Te=0,Ge=0,xe=0,y=0,m=0,v=0,E=0,k=0,R=0,O=0;if(k=De,De=De+240|0,S=k+224|0,y=k+208|0,m=k,v=k+192|0,E=k+176|0,ve=k+160|0,$e=k+144|0,Te=k+128|0,Ge=k+112|0,xe=k+96|0,a[S>>2]=h,a[y>>2]=a[A>>2],a[y+4>>2]=a[A+4>>2],a[y+8>>2]=a[A+8>>2],a[y+12>>2]=a[A+12>>2],ma(y,S,m),a[b>>2]=0,Me=x+d+((x|0)==6&1)|0,(Me|0)<=(d|0)){De=k;return}V=a[S>>2]|0,j=d+6|0,Y=16928+(V<<2)|0,ae=$e+8|0,ne=Te+8|0,ue=Ge+8|0,be=v+4|0,M=0,B=d,x=-1;e:for(;;){if(S=(B|0)%6|0,A=m+(S<<4)|0,a[v>>2]=a[A>>2],a[v+4>>2]=a[A+4>>2],a[v+8>>2]=a[A+8>>2],a[v+12>>2]=a[A+12>>2],A=M,M=xo(v,V,0,1)|0,(B|0)>(d|0)&(pi(h)|0)!=0&&(A|0)!=1&&(a[v>>2]|0)!=(x|0)){switch($o(m+(((S+5|0)%6|0)<<4)+4|0,E),$o(m+(S<<4)+4|0,ve),R=+(a[Y>>2]|0),G[$e>>3]=R*3,G[ae>>3]=0,O=R*-1.5,G[Te>>3]=O,G[ne>>3]=R*2.598076211353316,G[Ge>>3]=O,G[ue>>3]=R*-2.598076211353316,S=a[y>>2]|0,a[17008+(S*80|0)+(((x|0)==(S|0)?a[v>>2]|0:x)<<2)>>2]|0){case 1:{A=Te,x=$e;break}case 3:{A=Ge,x=Te;break}case 2:{A=$e,x=Ge;break}default:{A=8;break e}}wu(E,ve,x,A,xe),!(ba(E,xe)|0)&&!(ba(ve,xe)|0)&&(Qo(xe,a[y>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1)}if((B|0)<(j|0)&&($o(be,E),Qo(E,a[v>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1),B=B+1|0,(B|0)>=(Me|0)){A=3;break}else x=a[v>>2]|0}if((A|0)==3){De=k;return}else(A|0)==8&&Mt(22557,22521,746,22602)}function ma(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0;V=De,De=De+160|0,x=V+80|0,b=V,S=x,M=20336,B=S+72|0;do a[S>>2]=a[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));S=b,M=20416,B=S+72|0;do a[S>>2]=a[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));B=(pi(a[h>>2]|0)|0)==0,x=B?x:b,b=A+4|0,au(b),Dl(b),pi(a[h>>2]|0)|0&&(_o(b),a[h>>2]=(a[h>>2]|0)+1),a[d>>2]=a[A>>2],h=d+4|0,On(b,x,h),qr(h),a[d+16>>2]=a[A>>2],h=d+20|0,On(b,x+12|0,h),qr(h),a[d+32>>2]=a[A>>2],h=d+36|0,On(b,x+24|0,h),qr(h),a[d+48>>2]=a[A>>2],h=d+52|0,On(b,x+36|0,h),qr(h),a[d+64>>2]=a[A>>2],h=d+68|0,On(b,x+48|0,h),qr(h),a[d+80>>2]=a[A>>2],d=d+84|0,On(b,x+60|0,d),qr(d),De=V}function fr(A){A=+A;var h=0;return h=A<0?A+6.283185307179586:A,+(A>=6.283185307179586?h+-6.283185307179586:h)}function Vs(A,h){return A=A|0,h=h|0,+Pe(+(+G[A>>3]-+G[h>>3]))<17453292519943298e-27?(h=+Pe(+(+G[A+8>>3]-+G[h+8>>3]))<17453292519943298e-27,h|0):(h=0,h|0)}function jn(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0;return b=+G[h>>3],x=+G[A>>3],S=+We(+((b-x)*.5)),d=+We(+((+G[h+8>>3]-+G[A+8>>3])*.5)),d=S*S+d*(+At(+b)*+At(+x)*d),+(+jt(+ +Ie(+d),+ +Ie(+(1-d)))*2)}function Zn(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0;return b=+G[h>>3],x=+G[A>>3],S=+We(+((b-x)*.5)),d=+We(+((+G[h+8>>3]-+G[A+8>>3])*.5)),d=S*S+d*(+At(+b)*+At(+x)*d),+(+jt(+ +Ie(+d),+ +Ie(+(1-d)))*2*6371.007180918475)}function wr(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0;return b=+G[h>>3],x=+G[A>>3],S=+We(+((b-x)*.5)),d=+We(+((+G[h+8>>3]-+G[A+8>>3])*.5)),d=S*S+d*(+At(+b)*+At(+x)*d),+(+jt(+ +Ie(+d),+ +Ie(+(1-d)))*2*6371.007180918475*1e3)}function gr(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;return S=+G[h>>3],x=+At(+S),b=+G[h+8>>3]-+G[A+8>>3],M=x*+We(+b),d=+G[A>>3],+ +jt(+M,+(+We(+S)*+At(+d)-+At(+b)*(x*+We(+d))))}function Bl(A,h,d,x){A=A|0,h=+h,d=+d,x=x|0;var b=0,S=0,M=0,B=0;if(d<1e-16){a[x>>2]=a[A>>2],a[x+4>>2]=a[A+4>>2],a[x+8>>2]=a[A+8>>2],a[x+12>>2]=a[A+12>>2];return}S=h<0?h+6.283185307179586:h,S=h>=6.283185307179586?S+-6.283185307179586:S;do if(S<1e-16)h=+G[A>>3]+d,G[x>>3]=h,b=x;else{if(b=+Pe(+(S+-3.141592653589793))<1e-16,h=+G[A>>3],b){h=h-d,G[x>>3]=h,b=x;break}if(M=+At(+d),d=+We(+d),h=M*+We(+h)+ +At(+S)*(d*+At(+h)),h=h>1?1:h,h=+Rt(+(h<-1?-1:h)),G[x>>3]=h,+Pe(+(h+-1.5707963267948966))<1e-16){G[x>>3]=1.5707963267948966,G[x+8>>3]=0;return}if(+Pe(+(h+1.5707963267948966))<1e-16){G[x>>3]=-1.5707963267948966,G[x+8>>3]=0;return}if(B=+At(+h),S=d*+We(+S)/B,d=+G[A>>3],h=(M-+We(+h)*+We(+d))/+At(+d)/B,M=S>1?1:S,h=h>1?1:h,h=+G[A+8>>3]+ +jt(+(M<-1?-1:M),+(h<-1?-1:h)),h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);G[x+8>>3]=h;return}while(0);if(+Pe(+(h+-1.5707963267948966))<1e-16){G[b>>3]=1.5707963267948966,G[x+8>>3]=0;return}if(+Pe(+(h+1.5707963267948966))<1e-16){G[b>>3]=-1.5707963267948966,G[x+8>>3]=0;return}if(h=+G[A+8>>3],h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);G[x+8>>3]=h}function qo(A){return A=A|0,+ +G[20496+(A<<3)>>3]}function vc(A){return A=A|0,+ +G[20624+(A<<3)>>3]}function qa(A){return A=A|0,+ +G[20752+(A<<3)>>3]}function xc(A){return A=A|0,+ +G[20880+(A<<3)>>3]}function fu(A){A=A|0;var h=0;return h=21008+(A<<3)|0,A=a[h>>2]|0,Ft(a[h+4>>2]|0),A|0}function Gs(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0;return ne=+G[h>>3],Y=+G[A>>3],V=+We(+((ne-Y)*.5)),S=+G[h+8>>3],j=+G[A+8>>3],M=+We(+((S-j)*.5)),B=+At(+Y),ae=+At(+ne),M=V*V+M*(ae*B*M),M=+jt(+ +Ie(+M),+ +Ie(+(1-M)))*2,V=+G[d>>3],ne=+We(+((V-ne)*.5)),x=+G[d+8>>3],S=+We(+((x-S)*.5)),b=+At(+V),S=ne*ne+S*(ae*b*S),S=+jt(+ +Ie(+S),+ +Ie(+(1-S)))*2,V=+We(+((Y-V)*.5)),x=+We(+((j-x)*.5)),x=V*V+x*(B*b*x),x=+jt(+ +Ie(+x),+ +Ie(+(1-x)))*2,b=(M+S+x)*.5,+(+sn(+ +Ie(+(+dt(+(b*.5))*+dt(+((b-M)*.5))*+dt(+((b-S)*.5))*+dt(+((b-x)*.5)))))*4)}function zl(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(S=De,De=De+192|0,x=S+168|0,b=S,js(A,h,x),cs(A,h,b),h=a[b>>2]|0,(h|0)<=0)return d=0,De=S,+d;if(d=+Gs(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,x)+0,(h|0)==1)return De=S,+d;A=1;do M=A,A=A+1|0,d=d+ +Gs(b+8+(M<<4)|0,b+8+(((A|0)%(h|0)|0)<<4)|0,x);while((A|0)<(h|0));return De=S,+d}function Za(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(S=De,De=De+192|0,x=S+168|0,b=S,js(A,h,x),cs(A,h,b),h=a[b>>2]|0,(h|0)>0){if(d=+Gs(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,x)+0,(h|0)!=1){A=1;do M=A,A=A+1|0,d=d+ +Gs(b+8+(M<<4)|0,b+8+(((A|0)%(h|0)|0)<<4)|0,x);while((A|0)<(h|0))}}else d=0;return De=S,+(d*6371.007180918475*6371.007180918475)}function ya(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(S=De,De=De+192|0,x=S+168|0,b=S,js(A,h,x),cs(A,h,b),h=a[b>>2]|0,(h|0)>0){if(d=+Gs(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,x)+0,(h|0)!=1){A=1;do M=A,A=A+1|0,d=d+ +Gs(b+8+(M<<4)|0,b+8+(((A|0)%(h|0)|0)<<4)|0,x);while((A|0)<(h|0))}}else d=0;return De=S,+(d*6371.007180918475*6371.007180918475*1e3*1e3)}function Ol(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0;if(M=De,De=De+176|0,S=M,Ja(A,h,S),A=a[S>>2]|0,(A|0)<=1)return b=0,De=M,+b;h=A+-1|0,A=0,d=0,x=+G[S+8>>3],b=+G[S+16>>3];do A=A+1|0,V=x,x=+G[S+8+(A<<4)>>3],j=+We(+((x-V)*.5)),B=b,b=+G[S+8+(A<<4)+8>>3],B=+We(+((b-B)*.5)),B=j*j+B*(+At(+x)*+At(+V)*B),d=d+ +jt(+ +Ie(+B),+ +Ie(+(1-B)))*2;while((A|0)<(h|0));return De=M,+d}function Fl(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0;if(M=De,De=De+176|0,S=M,Ja(A,h,S),A=a[S>>2]|0,(A|0)<=1)return b=0,De=M,+b;h=A+-1|0,A=0,d=0,x=+G[S+8>>3],b=+G[S+16>>3];do A=A+1|0,V=x,x=+G[S+8+(A<<4)>>3],j=+We(+((x-V)*.5)),B=b,b=+G[S+8+(A<<4)+8>>3],B=+We(+((b-B)*.5)),B=j*j+B*(+At(+V)*+At(+x)*B),d=d+ +jt(+ +Ie(+B),+ +Ie(+(1-B)))*2;while((A|0)!=(h|0));return j=d*6371.007180918475,De=M,+j}function mr(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0;if(M=De,De=De+176|0,S=M,Ja(A,h,S),A=a[S>>2]|0,(A|0)<=1)return b=0,De=M,+b;h=A+-1|0,A=0,d=0,x=+G[S+8>>3],b=+G[S+16>>3];do A=A+1|0,V=x,x=+G[S+8+(A<<4)>>3],j=+We(+((x-V)*.5)),B=b,b=+G[S+8+(A<<4)+8>>3],B=+We(+((b-B)*.5)),B=j*j+B*(+At(+V)*+At(+x)*B),d=d+ +jt(+ +Ie(+B),+ +Ie(+(1-B)))*2;while((A|0)!=(h|0));return j=d*6371.007180918475*1e3,De=M,+j}function kA(A,h){return A=A|0,h=h|0,h=Ct(A|0,h|0,52)|0,Oe()|0,h&15|0}function As(A,h){return A=A|0,h=h|0,h=Ct(A|0,h|0,45)|0,Oe()|0,h&127|0}function du(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;if(!(!0&(h&-16777216|0)==134217728)||(M=Ct(A|0,h|0,45)|0,Oe()|0,M=M&127,M>>>0>121))return h=0,h|0;d=Ct(A|0,h|0,52)|0,Oe()|0,d=d&15;do if(d|0){for(b=1,x=0;;){if(S=Ct(A|0,h|0,(15-b|0)*3|0)|0,Oe()|0,S=S&7,(S|0)!=0&(x^1))if((S|0)==1&(en(M)|0)!=0){B=0,x=13;break}else x=1;if((S|0)==7){B=0,x=13;break}if(b>>>0<d>>>0)b=b+1|0;else{x=9;break}}if((x|0)==9){if((d|0)==15)B=1;else break;return B|0}else if((x|0)==13)return B|0}while(0);for(;;){if(B=Ct(A|0,h|0,(14-d|0)*3|0)|0,Oe()|0,!((B&7|0)==7&!0)){B=0,x=13;break}if(d>>>0<14)d=d+1|0;else{B=1,x=13;break}}return(x|0)==13?B|0:0}function Nl(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0;if(x=Ct(A|0,h|0,52)|0,Oe()|0,x=x&15,(x|0)>=(d|0)){if((x|0)!=(d|0))if(d>>>0<=15){if(b=Pt(d|0,0,52)|0,A=b|A,h=Oe()|0|h&-15728641,(x|0)>(d|0))do b=Pt(7,0,(14-d|0)*3|0)|0,d=d+1|0,A=b|A,h=Oe()|0|h;while((d|0)<(x|0))}else h=0,A=0}else h=0,A=0;return Ft(h|0),A|0}function wc(A,h,d){return A=A|0,h=h|0,d=d|0,A=Ct(A|0,h|0,52)|0,Oe()|0,A=A&15,(d|0)<16&(A|0)<=(d|0)?(d=$l(7,d-A|0)|0,d|0):(d=0,d|0)}function Zr(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0,Y=0;if(M=Ct(A|0,h|0,52)|0,Oe()|0,M=M&15,!!((d|0)<16&(M|0)<=(d|0))){if((M|0)==(d|0)){d=x,a[d>>2]=A,a[d+4>>2]=h;return}if(V=$l(7,d-M|0)|0,j=(V|0)/7|0,B=Ct(A|0,h|0,45)|0,Oe()|0,!(en(B&127)|0))S=0;else{e:do if(!M)b=0;else for(S=1;;){if(b=Ct(A|0,h|0,(15-S|0)*3|0)|0,Oe()|0,b=b&7,b|0)break e;if(S>>>0<M>>>0)S=S+1|0;else{b=0;break}}while(0);S=(b|0)==0}if(Y=Pt(M+1|0,0,52)|0,b=Oe()|0|h&-15728641,B=(14-M|0)*3|0,h=Pt(7,0,B|0)|0,h=(Y|A)&~h,M=b&~(Oe()|0),Zr(h,M,d,x),b=x+(j<<3)|0,!S){Y=Pt(1,0,B|0)|0,Zr(Y|h,Oe()|0|M,d,b),Y=b+(j<<3)|0,V=Pt(2,0,B|0)|0,Zr(V|h,Oe()|0|M,d,Y),Y=Y+(j<<3)|0,V=Pt(3,0,B|0)|0,Zr(V|h,Oe()|0|M,d,Y),Y=Y+(j<<3)|0,V=Pt(4,0,B|0)|0,Zr(V|h,Oe()|0|M,d,Y),Y=Y+(j<<3)|0,V=Pt(5,0,B|0)|0,Zr(V|h,Oe()|0|M,d,Y),V=Pt(6,0,B|0)|0,Zr(V|h,Oe()|0|M,d,Y+(j<<3)|0);return}S=b+(j<<3)|0,(V|0)>6&&(V=b+8|0,Y=(S>>>0>V>>>0?S:V)+-1+(0-b)|0,L(b|0,0,Y+8&-8|0)|0,b=V+(Y>>>3<<3)|0),Y=Pt(2,0,B|0)|0,Zr(Y|h,Oe()|0|M,d,b),Y=b+(j<<3)|0,V=Pt(3,0,B|0)|0,Zr(V|h,Oe()|0|M,d,Y),Y=Y+(j<<3)|0,V=Pt(4,0,B|0)|0,Zr(V|h,Oe()|0|M,d,Y),Y=Y+(j<<3)|0,V=Pt(5,0,B|0)|0,Zr(V|h,Oe()|0|M,d,Y),V=Pt(6,0,B|0)|0,Zr(V|h,Oe()|0|M,d,Y+(j<<3)|0)}}function Rr(A,h){A=A|0,h=h|0;var d=0,x=0,b=0;if(b=Ct(A|0,h|0,45)|0,Oe()|0,!(en(b&127)|0))return b=0,b|0;b=Ct(A|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!b)d=0;else for(x=1;;){if(d=Ct(A|0,h|0,(15-x|0)*3|0)|0,Oe()|0,d=d&7,d|0)break e;if(x>>>0<b>>>0)x=x+1|0;else{d=0;break}}while(0);return b=(d|0)==0&1,b|0}function ii(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0;if(x=Ct(A|0,h|0,52)|0,Oe()|0,x=x&15,(d|0)<16&(x|0)<=(d|0)){if((x|0)!=(d|0)&&(b=Pt(d|0,0,52)|0,A=b|A,h=Oe()|0|h&-15728641,(x|0)<(d|0)))do b=Pt(7,0,(14-x|0)*3|0)|0,x=x+1|0,A=A&~b,h=h&~(Oe()|0);while((x|0)<(d|0))}else h=0,A=0;return Ft(h|0),A|0}function pu(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Te=0,Ge=0,xe=0,y=0,m=0,v=0,E=0;if(!d)return v=0,v|0;if(b=A,x=a[b>>2]|0,b=a[b+4>>2]|0,!0&(b&15728640|0)==0){if((d|0)<=0||(v=h,a[v>>2]=x,a[v+4>>2]=b,(d|0)==1))return v=0,v|0;x=1;do y=A+(x<<3)|0,m=a[y+4>>2]|0,v=h+(x<<3)|0,a[v>>2]=a[y>>2],a[v+4>>2]=m,x=x+1|0;while((x|0)!=(d|0));return x=0,x|0}if(y=d<<3,m=Xt(y)|0,!m)return v=-3,v|0;if(Zs(m|0,A|0,y|0)|0,xe=Ji(d,8)|0,!xe)return hn(m),v=-3,v|0;x=d;e:for(;;){M=m,Y=a[M>>2]|0,M=a[M+4>>2]|0,Te=Ct(Y|0,M|0,52)|0,Oe()|0,Te=Te&15,Ge=Te+-1|0,$e=(x|0)>0;t:do if($e){if(ve=((x|0)<0)<<31>>31,be=Pt(Ge|0,0,52)|0,Me=Oe()|0,Ge>>>0>15)for(b=0,A=Y,d=M;;){if(!((A|0)==0&(d|0)==0)){if(S=Ct(A|0,d|0,52)|0,Oe()|0,S=S&15,B=(S|0)<(Ge|0),S=(S|0)==(Ge|0),j=B?0:S?A:0,A=B?0:S?d:0,d=qs(j|0,A|0,x|0,ve|0)|0,Oe()|0,S=xe+(d<<3)|0,B=S,V=a[B>>2]|0,B=a[B+4>>2]|0,(V|0)==0&(B|0)==0)d=j;else for(be=0,ue=d,ne=B,d=j;;){if((be|0)>(x|0)){v=41;break e}if((V|0)==(d|0)&(ne&-117440513|0)==(A|0)){j=Ct(V|0,ne|0,56)|0,Oe()|0,j=j&7,ae=j+1|0,Me=Ct(V|0,ne|0,45)|0,Oe()|0;n:do if(!(en(Me&127)|0))B=7;else{if(V=Ct(V|0,ne|0,52)|0,Oe()|0,V=V&15,!V){B=6;break}for(B=1;;){if(Me=Pt(7,0,(15-B|0)*3|0)|0,!((Me&d|0)==0&((Oe()|0)&A|0)==0)){B=7;break n}if(B>>>0<V>>>0)B=B+1|0;else{B=6;break}}}while(0);if((j+2|0)>>>0>B>>>0){v=51;break e}Me=Pt(ae|0,0,56)|0,A=Oe()|0|A&-117440513,B=S,a[B>>2]=0,a[B+4>>2]=0,B=ue,d=Me|d}else B=(ue+1|0)%(x|0)|0;if(S=xe+(B<<3)|0,ne=S,V=a[ne>>2]|0,ne=a[ne+4>>2]|0,(V|0)==0&(ne|0)==0)break;be=be+1|0,ue=B}Me=S,a[Me>>2]=d,a[Me+4>>2]=A}if(b=b+1|0,(b|0)>=(x|0))break t;d=m+(b<<3)|0,A=a[d>>2]|0,d=a[d+4>>2]|0}for(b=0,A=Y,d=M;;){if(!((A|0)==0&(d|0)==0)){if(B=Ct(A|0,d|0,52)|0,Oe()|0,B=B&15,(B|0)>=(Ge|0)){if((B|0)!=(Ge|0)&&(A=A|be,d=d&-15728641|Me,B>>>0>=Te>>>0)){S=Ge;do ue=Pt(7,0,(14-S|0)*3|0)|0,S=S+1|0,A=ue|A,d=Oe()|0|d;while(S>>>0<B>>>0)}}else A=0,d=0;if(B=qs(A|0,d|0,x|0,ve|0)|0,Oe()|0,S=xe+(B<<3)|0,V=S,j=a[V>>2]|0,V=a[V+4>>2]|0,!((j|0)==0&(V|0)==0))for(ue=0;;){if((ue|0)>(x|0)){v=41;break e}if((j|0)==(A|0)&(V&-117440513|0)==(d|0)){ae=Ct(j|0,V|0,56)|0,Oe()|0,ae=ae&7,ne=ae+1|0,E=Ct(j|0,V|0,45)|0,Oe()|0;n:do if(!(en(E&127)|0))V=7;else{if(j=Ct(j|0,V|0,52)|0,Oe()|0,j=j&15,!j){V=6;break}for(V=1;;){if(E=Pt(7,0,(15-V|0)*3|0)|0,!((E&A|0)==0&((Oe()|0)&d|0)==0)){V=7;break n}if(V>>>0<j>>>0)V=V+1|0;else{V=6;break}}}while(0);if((ae+2|0)>>>0>V>>>0){v=51;break e}E=Pt(ne|0,0,56)|0,d=Oe()|0|d&-117440513,ne=S,a[ne>>2]=0,a[ne+4>>2]=0,A=E|A}else B=(B+1|0)%(x|0)|0;if(S=xe+(B<<3)|0,V=S,j=a[V>>2]|0,V=a[V+4>>2]|0,(j|0)==0&(V|0)==0)break;ue=ue+1|0}E=S,a[E>>2]=A,a[E+4>>2]=d}if(b=b+1|0,(b|0)>=(x|0))break t;d=m+(b<<3)|0,A=a[d>>2]|0,d=a[d+4>>2]|0}}while(0);if((x+5|0)>>>0<11){v=99;break}if(Me=Ji((x|0)/6|0,8)|0,!Me){v=58;break}t:do if($e){ue=0,ne=0;do{if(B=xe+(ue<<3)|0,A=B,b=a[A>>2]|0,A=a[A+4>>2]|0,!((b|0)==0&(A|0)==0)){V=Ct(b|0,A|0,56)|0,Oe()|0,V=V&7,d=V+1|0,j=A&-117440513,E=Ct(b|0,A|0,45)|0,Oe()|0;n:do if(en(E&127)|0){if(ae=Ct(b|0,A|0,52)|0,Oe()|0,ae=ae&15,ae|0)for(S=1;;){if(E=Pt(7,0,(15-S|0)*3|0)|0,!((b&E|0)==0&(j&(Oe()|0)|0)==0))break n;if(S>>>0<ae>>>0)S=S+1|0;else break}A=Pt(d|0,0,56)|0,b=A|b,A=Oe()|0|j,d=B,a[d>>2]=b,a[d+4>>2]=A,d=V+2|0}while(0);(d|0)==7&&(E=Me+(ne<<3)|0,a[E>>2]=b,a[E+4>>2]=A&-117440513,ne=ne+1|0)}ue=ue+1|0}while((ue|0)!=(x|0));if($e){if(be=((x|0)<0)<<31>>31,ae=Pt(Ge|0,0,52)|0,ue=Oe()|0,Ge>>>0>15)for(A=0,b=0;;){do if(!((Y|0)==0&(M|0)==0)){for(V=Ct(Y|0,M|0,52)|0,Oe()|0,V=V&15,S=(V|0)<(Ge|0),V=(V|0)==(Ge|0),B=S?0:V?Y:0,V=S?0:V?M:0,S=qs(B|0,V|0,x|0,be|0)|0,Oe()|0,d=0;;){if((d|0)>(x|0)){v=98;break e}if(E=xe+(S<<3)|0,j=a[E+4>>2]|0,(j&-117440513|0)==(V|0)&&(a[E>>2]|0)==(B|0)){v=70;break}if(S=(S+1|0)%(x|0)|0,E=xe+(S<<3)|0,(a[E>>2]|0)==(B|0)&&(a[E+4>>2]|0)==(V|0))break;d=d+1|0}if((v|0)==70&&(v=0,!0&(j&117440512|0)==100663296))break;E=h+(b<<3)|0,a[E>>2]=Y,a[E+4>>2]=M,b=b+1|0}while(0);if(A=A+1|0,(A|0)>=(x|0)){x=ne;break t}M=m+(A<<3)|0,Y=a[M>>2]|0,M=a[M+4>>2]|0}for(A=0,b=0;;){do if(!((Y|0)==0&(M|0)==0)){if(V=Ct(Y|0,M|0,52)|0,Oe()|0,V=V&15,(V|0)>=(Ge|0))if((V|0)!=(Ge|0))if(d=Y|ae,S=M&-15728641|ue,V>>>0<Te>>>0)V=S;else{B=Ge;do E=Pt(7,0,(14-B|0)*3|0)|0,B=B+1|0,d=E|d,S=Oe()|0|S;while(B>>>0<V>>>0);V=S}else d=Y,V=M;else d=0,V=0;for(B=qs(d|0,V|0,x|0,be|0)|0,Oe()|0,S=0;;){if((S|0)>(x|0)){v=98;break e}if(E=xe+(B<<3)|0,j=a[E+4>>2]|0,(j&-117440513|0)==(V|0)&&(a[E>>2]|0)==(d|0)){v=93;break}if(B=(B+1|0)%(x|0)|0,E=xe+(B<<3)|0,(a[E>>2]|0)==(d|0)&&(a[E+4>>2]|0)==(V|0))break;S=S+1|0}if((v|0)==93&&(v=0,!0&(j&117440512|0)==100663296))break;E=h+(b<<3)|0,a[E>>2]=Y,a[E+4>>2]=M,b=b+1|0}while(0);if(A=A+1|0,(A|0)>=(x|0)){x=ne;break t}M=m+(A<<3)|0,Y=a[M>>2]|0,M=a[M+4>>2]|0}}else b=0,x=ne}else b=0,x=0;while(0);if(L(xe|0,0,y|0)|0,Zs(m|0,Me|0,x<<3|0)|0,hn(Me),x)h=h+(b<<3)|0;else break}return(v|0)==41?(hn(m),hn(xe),E=-1,E|0):(v|0)==51?(hn(m),hn(xe),E=-2,E|0):(v|0)==58?(hn(m),hn(xe),E=-3,E|0):(v|0)==98?(hn(Me),hn(m),hn(xe),E=-1,E|0):((v|0)==99&&Zs(h|0,m|0,x<<3|0)|0,hn(m),hn(xe),E=0,E|0)}function $s(A,h,d,x,b){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0;if((h|0)<=0)return b=0,b|0;if((b|0)>=16){for(S=0;;){if(Y=A+(S<<3)|0,!((a[Y>>2]|0)==0&(a[Y+4>>2]|0)==0)){S=14;break}if(S=S+1|0,(S|0)>=(h|0)){M=0,S=16;break}}if((S|0)==14)return((x|0)>0?-2:-1)|0;if((S|0)==16)return M|0}S=0,Y=0;e:for(;;){j=A+(Y<<3)|0,B=j,M=a[B>>2]|0,B=a[B+4>>2]|0;do if(!((M|0)==0&(B|0)==0)){if((S|0)>=(x|0)){M=-1,S=16;break e}if(V=Ct(M|0,B|0,52)|0,Oe()|0,V=V&15,(V|0)>(b|0)){M=-2,S=16;break e}if((V|0)==(b|0)){j=d+(S<<3)|0,a[j>>2]=M,a[j+4>>2]=B,S=S+1|0;break}if(M=($l(7,b-V|0)|0)+S|0,(M|0)>(x|0)){M=-1,S=16;break e}Zr(a[j>>2]|0,a[j+4>>2]|0,b,d+(S<<3)|0),S=M}while(0);if(Y=Y+1|0,(Y|0)>=(h|0)){M=0,S=16;break}}return(S|0)==16?M|0:0}function bc(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if((h|0)<=0)return d=0,d|0;if((d|0)>=16){for(x=0;;){if(M=A+(x<<3)|0,!((a[M>>2]|0)==0&(a[M+4>>2]|0)==0)){x=-1,b=13;break}if(x=x+1|0,(x|0)>=(h|0)){x=0,b=13;break}}if((b|0)==13)return x|0}x=0,M=0;e:for(;;){b=A+(M<<3)|0,S=a[b>>2]|0,b=a[b+4>>2]|0;do if(!((S|0)==0&(b|0)==0)){if(b=Ct(S|0,b|0,52)|0,Oe()|0,b=b&15,(b|0)>(d|0)){x=-1,b=13;break e}if((b|0)==(d|0)){x=x+1|0;break}else{x=($l(7,d-b|0)|0)+x|0;break}}while(0);if(M=M+1|0,(M|0)>=(h|0)){b=13;break}}return(b|0)==13?x|0:0}function IA(A,h){return A=A|0,h=h|0,h=Ct(A|0,h|0,52)|0,Oe()|0,h&1|0}function ci(A,h){A=A|0,h=h|0;var d=0,x=0,b=0;if(b=Ct(A|0,h|0,52)|0,Oe()|0,b=b&15,!b)return b=0,b|0;for(x=1;;){if(d=Ct(A|0,h|0,(15-x|0)*3|0)|0,Oe()|0,d=d&7,d|0){x=5;break}if(x>>>0<b>>>0)x=x+1|0;else{d=0,x=5;break}}return(x|0)==5?d|0:0}function bi(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(V=Ct(A|0,h|0,52)|0,Oe()|0,V=V&15,!V)return B=h,V=A,Ft(B|0),V|0;for(B=1,d=0;;){S=(15-B|0)*3|0,x=Pt(7,0,S|0)|0,b=Oe()|0,M=Ct(A|0,h|0,S|0)|0,Oe()|0,S=Pt(Hi(M&7)|0,0,S|0)|0,M=Oe()|0,A=S|A&~x,h=M|h&~b;e:do if(!d)if((S&x|0)==0&(M&b|0)==0)d=0;else if(x=Ct(A|0,h|0,52)|0,Oe()|0,x=x&15,!x)d=1;else{d=1;t:for(;;){switch(M=Ct(A|0,h|0,(15-d|0)*3|0)|0,Oe()|0,M&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<x>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(M=(15-d|0)*3|0,b=Ct(A|0,h|0,M|0)|0,Oe()|0,S=Pt(7,0,M|0)|0,h=h&~(Oe()|0),M=Pt(Hi(b&7)|0,0,M|0)|0,A=A&~S|M,h=h|(Oe()|0),d>>>0<x>>>0)d=d+1|0;else{d=1;break}}while(0);if(B>>>0<V>>>0)B=B+1|0;else break}return Ft(h|0),A|0}function us(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(x=Ct(A|0,h|0,52)|0,Oe()|0,x=x&15,!x)return d=h,x=A,Ft(d|0),x|0;for(d=1;S=(15-d|0)*3|0,M=Ct(A|0,h|0,S|0)|0,Oe()|0,b=Pt(7,0,S|0)|0,h=h&~(Oe()|0),S=Pt(Hi(M&7)|0,0,S|0)|0,A=S|A&~b,h=Oe()|0|h,d>>>0<x>>>0;)d=d+1|0;return Ft(h|0),A|0}function _a(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(V=Ct(A|0,h|0,52)|0,Oe()|0,V=V&15,!V)return B=h,V=A,Ft(B|0),V|0;for(B=1,d=0;;){S=(15-B|0)*3|0,x=Pt(7,0,S|0)|0,b=Oe()|0,M=Ct(A|0,h|0,S|0)|0,Oe()|0,S=Pt(Wi(M&7)|0,0,S|0)|0,M=Oe()|0,A=S|A&~x,h=M|h&~b;e:do if(!d)if((S&x|0)==0&(M&b|0)==0)d=0;else if(x=Ct(A|0,h|0,52)|0,Oe()|0,x=x&15,!x)d=1;else{d=1;t:for(;;){switch(M=Ct(A|0,h|0,(15-d|0)*3|0)|0,Oe()|0,M&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<x>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(b=(15-d|0)*3|0,S=Pt(7,0,b|0)|0,M=h&~(Oe()|0),h=Ct(A|0,h|0,b|0)|0,Oe()|0,h=Pt(Wi(h&7)|0,0,b|0)|0,A=A&~S|h,h=M|(Oe()|0),d>>>0<x>>>0)d=d+1|0;else{d=1;break}}while(0);if(B>>>0<V>>>0)B=B+1|0;else break}return Ft(h|0),A|0}function Xi(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(x=Ct(A|0,h|0,52)|0,Oe()|0,x=x&15,!x)return d=h,x=A,Ft(d|0),x|0;for(d=1;M=(15-d|0)*3|0,S=Pt(7,0,M|0)|0,b=h&~(Oe()|0),h=Ct(A|0,h|0,M|0)|0,Oe()|0,h=Pt(Wi(h&7)|0,0,M|0)|0,A=h|A&~S,h=Oe()|0|b,d>>>0<x>>>0;)d=d+1|0;return Ft(h|0),A|0}function wo(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0;if(V=De,De=De+64|0,B=V+40|0,x=V+24|0,b=V+12|0,S=V,Pt(h|0,0,52)|0,d=Oe()|0|134225919,!h)return(a[A+4>>2]|0)>2||(a[A+8>>2]|0)>2||(a[A+12>>2]|0)>2?(M=0,B=0,Ft(M|0),De=V,B|0):(Pt($n(A)|0,0,45)|0,M=Oe()|0|d,B=-1,Ft(M|0),De=V,B|0);if(a[B>>2]=a[A>>2],a[B+4>>2]=a[A+4>>2],a[B+8>>2]=a[A+8>>2],a[B+12>>2]=a[A+12>>2],M=B+4|0,(h|0)>0)for(A=-1;a[x>>2]=a[M>>2],a[x+4>>2]=a[M+4>>2],a[x+8>>2]=a[M+8>>2],h&1?(Ll(M),a[b>>2]=a[M>>2],a[b+4>>2]=a[M+4>>2],a[b+8>>2]=a[M+8>>2],pa(b)):(jo(M),a[b>>2]=a[M>>2],a[b+4>>2]=a[M+4>>2],a[b+8>>2]=a[M+8>>2],_o(b)),Ts(x,b,S),qr(S),Y=(15-h|0)*3|0,j=Pt(7,0,Y|0)|0,d=d&~(Oe()|0),Y=Pt(yo(S)|0,0,Y|0)|0,A=Y|A&~j,d=Oe()|0|d,(h|0)>1;)h=h+-1|0;else A=-1;e:do if((a[M>>2]|0)<=2&&(a[B+8>>2]|0)<=2&&(a[B+12>>2]|0)<=2){if(x=$n(B)|0,h=Pt(x|0,0,45)|0,h=h|A,A=Oe()|0|d&-1040385,S=wA(B)|0,!(en(x)|0)){if((S|0)<=0)break;for(b=0;;){if(x=Ct(h|0,A|0,52)|0,Oe()|0,x=x&15,x)for(d=1;Y=(15-d|0)*3|0,B=Ct(h|0,A|0,Y|0)|0,Oe()|0,j=Pt(7,0,Y|0)|0,A=A&~(Oe()|0),Y=Pt(Hi(B&7)|0,0,Y|0)|0,h=h&~j|Y,A=A|(Oe()|0),d>>>0<x>>>0;)d=d+1|0;if(b=b+1|0,(b|0)==(S|0))break e}}b=Ct(h|0,A|0,52)|0,Oe()|0,b=b&15;t:do if(b){d=1;n:for(;;){switch(Y=Ct(h|0,A|0,(15-d|0)*3|0)|0,Oe()|0,Y&7){case 1:break n;case 0:break;default:break t}if(d>>>0<b>>>0)d=d+1|0;else break t}if(iu(x,a[B>>2]|0)|0)for(d=1;B=(15-d|0)*3|0,j=Pt(7,0,B|0)|0,Y=A&~(Oe()|0),A=Ct(h|0,A|0,B|0)|0,Oe()|0,A=Pt(Wi(A&7)|0,0,B|0)|0,h=h&~j|A,A=Y|(Oe()|0),d>>>0<b>>>0;)d=d+1|0;else for(d=1;Y=(15-d|0)*3|0,B=Ct(h|0,A|0,Y|0)|0,Oe()|0,j=Pt(7,0,Y|0)|0,A=A&~(Oe()|0),Y=Pt(Hi(B&7)|0,0,Y|0)|0,h=h&~j|Y,A=A|(Oe()|0),d>>>0<b>>>0;)d=d+1|0}while(0);if((S|0)>0){d=0;do h=bi(h,A)|0,A=Oe()|0,d=d+1|0;while((d|0)!=(S|0))}}else h=0,A=0;while(0);return j=A,Y=h,Ft(j|0),De=V,Y|0}function pi(A){return A=A|0,(A|0)%2|0|0}function Ya(A,h){A=A|0,h=h|0;var d=0,x=0;return x=De,De=De+16|0,d=x,h>>>0<=15&&(a[A+4>>2]&2146435072|0)!=2146435072&&(a[A+8+4>>2]&2146435072|0)!=2146435072?(PA(A,h,d),h=wo(d,h)|0,A=Oe()|0):(A=0,h=0),Ft(A|0),De=x,h|0}function Ul(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if(b=d+4|0,S=Ct(A|0,h|0,52)|0,Oe()|0,S=S&15,M=Ct(A|0,h|0,45)|0,Oe()|0,x=(S|0)==0,en(M&127)|0){if(x)return M=1,M|0;x=1}else{if(x)return M=0,M|0;!(a[b>>2]|0)&&!(a[d+8>>2]|0)?x=(a[d+12>>2]|0)!=0&1:x=1}for(d=1;d&1?pa(b):_o(b),M=Ct(A|0,h|0,(15-d|0)*3|0)|0,Oe()|0,MA(b,M&7),d>>>0<S>>>0;)d=d+1|0;return x|0}function Xa(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0;Y=De,De=De+16|0,V=Y,j=Ct(A|0,h|0,45)|0,Oe()|0,j=j&127;e:do if(en(j)|0&&(S=Ct(A|0,h|0,52)|0,Oe()|0,S=S&15,(S|0)!=0)){x=1;t:for(;;){switch(B=Ct(A|0,h|0,(15-x|0)*3|0)|0,Oe()|0,B&7){case 5:break t;case 0:break;default:{x=h;break e}}if(x>>>0<S>>>0)x=x+1|0;else{x=h;break e}}for(b=1,x=h;h=(15-b|0)*3|0,M=Pt(7,0,h|0)|0,B=x&~(Oe()|0),x=Ct(A|0,x|0,h|0)|0,Oe()|0,x=Pt(Wi(x&7)|0,0,h|0)|0,A=A&~M|x,x=B|(Oe()|0),b>>>0<S>>>0;)b=b+1|0}else x=h;while(0);if(B=7728+(j*28|0)|0,a[d>>2]=a[B>>2],a[d+4>>2]=a[B+4>>2],a[d+8>>2]=a[B+8>>2],a[d+12>>2]=a[B+12>>2],!(Ul(A,x,d)|0)){De=Y;return}if(M=d+4|0,a[V>>2]=a[M>>2],a[V+4>>2]=a[M+4>>2],a[V+8>>2]=a[M+8>>2],S=Ct(A|0,x|0,52)|0,Oe()|0,B=S&15,S&1?(_o(M),S=B+1|0):S=B,!(en(j)|0))x=0;else{e:do if(!B)x=0;else for(h=1;;){if(b=Ct(A|0,x|0,(15-h|0)*3|0)|0,Oe()|0,b=b&7,b|0){x=b;break e}if(h>>>0<B>>>0)h=h+1|0;else{x=0;break}}while(0);x=(x|0)==4&1}if(!(xo(d,S,x,0)|0))(S|0)!=(B|0)&&(a[M>>2]=a[V>>2],a[M+4>>2]=a[V+4>>2],a[M+8>>2]=a[V+8>>2]);else{if(en(j)|0)do;while(xo(d,S,0,0)|0);(S|0)!=(B|0)&&jo(M)}De=Y}function js(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0;x=De,De=De+16|0,b=x,Xa(A,h,b),h=Ct(A|0,h|0,52)|0,Oe()|0,Qa(b,h&15,d),De=x}function cs(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0;M=De,De=De+16|0,S=M,Xa(A,h,S),x=Ct(A|0,h|0,45)|0,Oe()|0,x=(en(x&127)|0)==0,b=Ct(A|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!x){if(b|0)for(x=1;;){if(B=Pt(7,0,(15-x|0)*3|0)|0,!((B&A|0)==0&((Oe()|0)&h|0)==0))break e;if(x>>>0<b>>>0)x=x+1|0;else break}uu(S,b,0,5,d),De=M;return}while(0);hu(S,b,0,6,d),De=M}function Ec(A,h){A=A|0,h=h|0;var d=0,x=0,b=0;if(x=Ct(A|0,h|0,45)|0,Oe()|0,!(en(x&127)|0))return x=2,x|0;if(x=Ct(A|0,h|0,52)|0,Oe()|0,x=x&15,!x)return x=5,x|0;for(d=1;;){if(b=Pt(7,0,(15-d|0)*3|0)|0,!((b&A|0)==0&((Oe()|0)&h|0)==0)){d=2,A=6;break}if(d>>>0<x>>>0)d=d+1|0;else{d=5,A=6;break}}return(A|0)==6?d|0:0}function va(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0;ae=De,De=De+128|0,j=ae+112|0,S=ae+96|0,Y=ae,b=Ct(A|0,h|0,52)|0,Oe()|0,B=b&15,a[j>>2]=B,M=Ct(A|0,h|0,45)|0,Oe()|0,M=M&127;e:do if(en(M)|0){if(B|0)for(x=1;;){if(V=Pt(7,0,(15-x|0)*3|0)|0,!((V&A|0)==0&((Oe()|0)&h|0)==0)){b=0;break e}if(x>>>0<B>>>0)x=x+1|0;else break}if(b&1)b=1;else{V=Pt(B+1|0,0,52)|0,Y=Oe()|0|h&-15728641,j=Pt(7,0,(14-B|0)*3|0)|0,va((V|A)&~j,Y&~(Oe()|0),d),De=ae;return}}else b=0;while(0);Xa(A,h,S),b?(cu(S,j,Y),V=5):(ma(S,j,Y),V=6);e:do if(en(M)|0)if(!B)x=20;else for(x=1;;){if(M=Pt(7,0,(15-x|0)*3|0)|0,!((M&A|0)==0&((Oe()|0)&h|0)==0)){x=8;break e}if(x>>>0<B>>>0)x=x+1|0;else{x=20;break}}else x=8;while(0);if(L(d|0,-1,x|0)|0,b){b=0;do{for(S=Y+(b<<4)|0,ga(S,a[j>>2]|0)|0,S=a[S>>2]|0,x=0;M=d+(x<<2)|0,B=a[M>>2]|0,!((B|0)==-1|(B|0)==(S|0));)x=x+1|0;a[M>>2]=S,b=b+1|0}while((b|0)!=(V|0))}else{b=0;do{for(S=Y+(b<<4)|0,xo(S,a[j>>2]|0,0,1)|0,S=a[S>>2]|0,x=0;M=d+(x<<2)|0,B=a[M>>2]|0,!((B|0)==-1|(B|0)==(S|0));)x=x+1|0;a[M>>2]=S,b=b+1|0}while((b|0)!=(V|0))}De=ae}function Ka(){return 12}function si(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(Pt(A|0,0,52)|0,B=Oe()|0|134225919,(A|0)<1){x=0,d=0;do en(x)|0&&(Pt(x|0,0,45)|0,M=B|(Oe()|0),A=h+(d<<3)|0,a[A>>2]=-1,a[A+4>>2]=M,d=d+1|0),x=x+1|0;while((x|0)!=122);return}M=0,d=0;do{if(en(M)|0){for(Pt(M|0,0,45)|0,x=1,b=-1,S=B|(Oe()|0);V=Pt(7,0,(15-x|0)*3|0)|0,b=b&~V,S=S&~(Oe()|0),(x|0)!=(A|0);)x=x+1|0;V=h+(d<<3)|0,a[V>>2]=b,a[V+4>>2]=S,d=d+1|0}M=M+1|0}while((M|0)!=122)}function Ss(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0;if(B=De,De=De+64|0,M=B,(A|0)==(d|0)&(h|0)==(x|0)|(!1|(h&2013265920|0)!=134217728|(!1|(x&2013265920|0)!=134217728))||(b=Ct(A|0,h|0,52)|0,Oe()|0,b=b&15,S=Ct(d|0,x|0,52)|0,Oe()|0,(b|0)!=(S&15|0)))return M=0,De=B,M|0;if(S=b+-1|0,b>>>0>1&&(j=Nl(A,h,S)|0,V=Oe()|0,S=Nl(d,x,S)|0,(j|0)==(S|0)&(V|0)==(Oe()|0))&&(S=(b^15)*3|0,b=Ct(A|0,h|0,S|0)|0,Oe()|0,b=b&7,S=Ct(d|0,x|0,S|0)|0,Oe()|0,S=S&7,(b|0)==0|(S|0)==0||(a[21136+(b<<2)>>2]|0)==(S|0)||(a[21168+(b<<2)>>2]|0)==(S|0)))return j=1,De=B,j|0;b=M,S=b+56|0;do a[b>>2]=0,b=b+4|0;while((b|0)<(S|0));return fa(A,h,1,M),j=M,!((a[j>>2]|0)==(d|0)&&(a[j+4>>2]|0)==(x|0))&&(j=M+8|0,!((a[j>>2]|0)==(d|0)&&(a[j+4>>2]|0)==(x|0)))&&(j=M+16|0,!((a[j>>2]|0)==(d|0)&&(a[j+4>>2]|0)==(x|0)))&&(j=M+24|0,!((a[j>>2]|0)==(d|0)&&(a[j+4>>2]|0)==(x|0)))&&(j=M+32|0,!((a[j>>2]|0)==(d|0)&&(a[j+4>>2]|0)==(x|0)))&&(j=M+40|0,!((a[j>>2]|0)==(d|0)&&(a[j+4>>2]|0)==(x|0)))?(b=M+48|0,b=((a[b>>2]|0)==(d|0)?(a[b+4>>2]|0)==(x|0):0)&1):b=1,j=b,De=B,j|0}function Ki(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0,Y=0;if(j=De,De=De+16|0,M=j,!(Ss(A,h,d,x)|0))return B=0,V=0,Ft(B|0),De=j,V|0;for(B=h&-2130706433,b=(Rr(A,h)|0)==0,b=b?1:2;a[M>>2]=0,Y=ge(A,h,b,M)|0,S=b+1|0,!((Y|0)==(d|0)&(Oe()|0)==(x|0));)if(S>>>0<7)b=S;else{b=0,A=0,V=6;break}return(V|0)==6?(Ft(b|0),De=j,A|0):(Y=Pt(b|0,0,56)|0,V=B|(Oe()|0)|268435456,Y=A|Y,Ft(V|0),De=j,Y|0)}function Vl(A,h){A=A|0,h=h|0;var d=0;return d=!0&(h&2013265920|0)==268435456,Ft((d?h&-2130706433|134217728:0)|0),(d?A:0)|0}function Zo(A,h){A=A|0,h=h|0;var d=0,x=0,b=0;return x=De,De=De+16|0,d=x,!0&(h&2013265920|0)==268435456?(b=Ct(A|0,h|0,56)|0,Oe()|0,a[d>>2]=0,d=ge(A,h&-2130706433|134217728,b&7,d)|0,h=Oe()|0,Ft(h|0),De=x,d|0):(h=0,d=0,Ft(h|0),De=x,d|0)}function Tc(A,h){A=A|0,h=h|0;var d=0;if(!(!0&(h&2013265920|0)==268435456))return d=0,d|0;switch(d=Ct(A|0,h|0,56)|0,Oe()|0,d&7){case 0:case 7:return d=0,d|0}return d=h&-2130706433|134217728,!0&(h&117440512|0)==16777216&(Rr(A,d)|0)!=0?(d=0,d|0):(d=du(A,d)|0,d|0)}function bo(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0;S=De,De=De+16|0,x=S,M=!0&(h&2013265920|0)==268435456,b=h&-2130706433|134217728,B=d,a[B>>2]=M?A:0,a[B+4>>2]=M?b:0,M?(h=Ct(A|0,h|0,56)|0,Oe()|0,a[x>>2]=0,A=ge(A,b,h&7,x)|0,h=Oe()|0):(A=0,h=0),B=d+8|0,a[B>>2]=A,a[B+4>>2]=h,De=S}function Gl(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0;b=(Rr(A,h)|0)==0,h=h&-2130706433,x=d,a[x>>2]=b?A:0,a[x+4>>2]=b?h|285212672:0,x=d+8|0,a[x>>2]=A,a[x+4>>2]=h|301989888,x=d+16|0,a[x>>2]=A,a[x+4>>2]=h|318767104,x=d+24|0,a[x>>2]=A,a[x+4>>2]=h|335544320,x=d+32|0,a[x>>2]=A,a[x+4>>2]=h|352321536,d=d+40|0,a[d>>2]=A,a[d+4>>2]=h|369098752}function Ja(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0;if(M=De,De=De+16|0,S=M,x=Ct(A|0,h|0,56)|0,Oe()|0,B=!0&(h&2013265920|0)==268435456,b=B?A:0,A=B?h&-2130706433|134217728:0,h=fs(b,A,x&7)|0,(h|0)==-1){a[d>>2]=0,De=M;return}Xa(b,A,S),x=Ct(b|0,A|0,52)|0,Oe()|0,x=x&15,Rr(b,A)|0?uu(S,x,h,2,d):hu(S,x,h,2,d),De=M}function Ch(A){A=A|0;var h=0,d=0,x=0;return h=Ji(1,12)|0,h||Mt(22691,22646,49,22704),d=A+4|0,x=a[d>>2]|0,x|0?(x=x+8|0,a[x>>2]=h,a[d>>2]=h,h|0):(a[A>>2]|0&&Mt(22721,22646,61,22744),x=A,a[x>>2]=h,a[d>>2]=h,h|0)}function Mh(A,h){A=A|0,h=h|0;var d=0,x=0;return x=Xt(24)|0,x||Mt(22758,22646,78,22772),a[x>>2]=a[h>>2],a[x+4>>2]=a[h+4>>2],a[x+8>>2]=a[h+8>>2],a[x+12>>2]=a[h+12>>2],a[x+16>>2]=0,h=A+4|0,d=a[h>>2]|0,d|0?(a[d+16>>2]=x,a[h>>2]=x,x|0):(a[A>>2]|0&&Mt(22787,22646,82,22772),a[A>>2]=x,a[h>>2]=x,x|0)}function el(A){A=A|0;var h=0,d=0,x=0,b=0;if(A)for(x=1;;){if(h=a[A>>2]|0,h|0)do{if(d=a[h>>2]|0,d|0)do b=d,d=a[d+16>>2]|0,hn(b);while(d|0);b=h,h=a[h+8>>2]|0,hn(b)}while(h|0);if(h=A,A=a[A+8>>2]|0,x||hn(h),A)x=0;else break}}function xa(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Te=0,Ge=0,xe=0,y=0,m=0,v=0,E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0;if(b=A+8|0,a[b>>2]|0)return de=1,de|0;if(x=a[A>>2]|0,!x)return de=0,de|0;h=x,d=0;do d=d+1|0,h=a[h+8>>2]|0;while(h|0);if(d>>>0<2)return de=0,de|0;J=Xt(d<<2)|0,J||Mt(22807,22646,317,22826),q=Xt(d<<5)|0,q||Mt(22848,22646,321,22826),a[A>>2]=0,m=A+4|0,a[m>>2]=0,a[b>>2]=0,d=0,N=0,y=0,ae=0;e:for(;;){if(Y=a[x>>2]|0,Y){S=0,M=Y;do{if(V=+G[M+8>>3],h=M,M=a[M+16>>2]|0,j=(M|0)==0,b=j?Y:M,B=+G[b+8>>3],+Pe(+(V-B))>3.141592653589793){de=14;break}S=S+(B-V)*(+G[h>>3]+ +G[b>>3])}while(!j);if((de|0)==14){de=0,S=0,h=Y;do xe=+G[h+8>>3],O=h+16|0,R=a[O>>2]|0,R=R|0?R:Y,Ge=+G[R+8>>3],S=S+(+G[h>>3]+ +G[R>>3])*((Ge<0?Ge+6.283185307179586:Ge)-(xe<0?xe+6.283185307179586:xe)),h=a[(h|0?O:x)>>2]|0;while(h|0)}S>0?(a[J+(N<<2)>>2]=x,N=N+1|0,b=y,h=ae):de=19}else de=19;if((de|0)==19){de=0;do if(d){if(h=d+8|0,a[h>>2]|0){de=21;break e}if(d=Ji(1,12)|0,!d){de=23;break e}a[h>>2]=d,b=d+4|0,M=d,h=ae}else if(ae){b=m,M=ae+8|0,h=x,d=A;break}else if(a[A>>2]|0){de=27;break e}else{b=m,M=A,h=x,d=A;break}while(0);if(a[M>>2]=x,a[b>>2]=x,M=q+(y<<5)|0,j=a[x>>2]|0,j){for(Y=q+(y<<5)+8|0,G[Y>>3]=17976931348623157e292,ae=q+(y<<5)+24|0,G[ae>>3]=17976931348623157e292,G[M>>3]=-17976931348623157e292,ne=q+(y<<5)+16|0,G[ne>>3]=-17976931348623157e292,$e=17976931348623157e292,Te=-17976931348623157e292,b=0,ue=j,V=17976931348623157e292,Me=17976931348623157e292,ve=-17976931348623157e292,B=-17976931348623157e292;S=+G[ue>>3],xe=+G[ue+8>>3],ue=a[ue+16>>2]|0,be=(ue|0)==0,Ge=+G[(be?j:ue)+8>>3],S<V&&(G[Y>>3]=S,V=S),xe<Me&&(G[ae>>3]=xe,Me=xe),S>ve?G[M>>3]=S:S=ve,xe>B&&(G[ne>>3]=xe,B=xe),$e=xe>0&xe<$e?xe:$e,Te=xe<0&xe>Te?xe:Te,b=b|+Pe(+(xe-Ge))>3.141592653589793,!be;)ve=S;b&&(G[ne>>3]=Te,G[ae>>3]=$e)}else a[M>>2]=0,a[M+4>>2]=0,a[M+8>>2]=0,a[M+12>>2]=0,a[M+16>>2]=0,a[M+20>>2]=0,a[M+24>>2]=0,a[M+28>>2]=0;b=y+1|0}if(O=x+8|0,x=a[O>>2]|0,a[O>>2]=0,x)y=b,ae=h;else{de=45;break}}if((de|0)==21)Mt(22624,22646,35,22658);else if((de|0)==23)Mt(22678,22646,37,22658);else if((de|0)==27)Mt(22721,22646,61,22744);else if((de|0)==45){e:do if((N|0)>0){for(O=(b|0)==0,k=b<<2,R=(A|0)==0,E=0,h=0;;){if(v=a[J+(E<<2)>>2]|0,O)de=73;else{if(y=Xt(k)|0,!y){de=50;break}if(m=Xt(k)|0,!m){de=52;break}t:do if(R)d=0;else{for(b=0,d=0,M=A;x=q+(b<<5)|0,hs(a[M>>2]|0,x,a[v>>2]|0)|0?(a[y+(d<<2)>>2]=M,a[m+(d<<2)>>2]=x,be=d+1|0):be=d,M=a[M+8>>2]|0,M;)b=b+1|0,d=be;if((be|0)>0)if(x=a[y>>2]|0,(be|0)==1)d=x;else for(ne=0,ue=-1,d=x,ae=x;;){for(j=a[ae>>2]|0,x=0,M=0;b=a[a[y+(M<<2)>>2]>>2]|0,(b|0)==(j|0)?Y=x:Y=x+((hs(b,a[m+(M<<2)>>2]|0,a[j>>2]|0)|0)&1)|0,M=M+1|0,(M|0)!=(be|0);)x=Y;if(b=(Y|0)>(ue|0),d=b?ae:d,x=ne+1|0,(x|0)==(be|0))break t;ne=x,ue=b?Y:ue,ae=a[y+(x<<2)>>2]|0}else d=0}while(0);if(hn(y),hn(m),d){if(b=d+4|0,x=a[b>>2]|0,x)d=x+8|0;else if(a[d>>2]|0){de=70;break}a[d>>2]=v,a[b>>2]=v}else de=73}if((de|0)==73){if(de=0,h=a[v>>2]|0,h|0)do m=h,h=a[h+16>>2]|0,hn(m);while(h|0);hn(v),h=2}if(E=E+1|0,(E|0)>=(N|0)){le=h;break e}}(de|0)==50?Mt(22863,22646,249,22882):(de|0)==52?Mt(22901,22646,252,22882):(de|0)==70&&Mt(22721,22646,61,22744)}else le=0;while(0);return hn(J),hn(q),de=le,de|0}return 0}function hs(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0;if(!(CA(h,d)|0)||(h=SA(h)|0,j=+G[d>>3],x=+G[d+8>>3],x=h&x<0?x+6.283185307179586:x,A=a[A>>2]|0,!A))return A=0,A|0;if(h){h=0,d=A;e:for(;;){for(;M=+G[d>>3],V=+G[d+8>>3],d=d+16|0,Y=a[d>>2]|0,Y=Y|0?Y:A,S=+G[Y>>3],b=+G[Y+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!(j<S|j>B);)if(d=a[d>>2]|0,!d){d=22;break e}if(V=b<0?b+6.283185307179586:b,M=M<0?M+6.283185307179586:M,x=M==x|V==x?x+-2220446049250313e-31:x,V=V+(j-S)/(B-S)*(M-V),(V<0?V+6.283185307179586:V)>x&&(h=h^1),d=a[d>>2]|0,!d){d=22;break}}if((d|0)==22)return h|0}else{h=0,d=A;e:for(;;){for(;M=+G[d>>3],V=+G[d+8>>3],d=d+16|0,Y=a[d>>2]|0,Y=Y|0?Y:A,S=+G[Y>>3],b=+G[Y+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!(j<S|j>B);)if(d=a[d>>2]|0,!d){d=22;break e}if(x=M==x|b==x?x+-2220446049250313e-31:x,b+(j-S)/(B-S)*(M-b)>x&&(h=h^1),d=a[d>>2]|0,!d){d=22;break}}if((d|0)==22)return h|0}return 0}function Nt(A,h,d,x,b){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Te=0;if(Te=De,De=De+32|0,$e=Te+16|0,ve=Te,S=Ct(A|0,h|0,52)|0,Oe()|0,S=S&15,ue=Ct(d|0,x|0,52)|0,Oe()|0,(S|0)!=(ue&15|0))return $e=1,De=Te,$e|0;if(j=Ct(A|0,h|0,45)|0,Oe()|0,j=j&127,Y=Ct(d|0,x|0,45)|0,Oe()|0,Y=Y&127,ue=(j|0)!=(Y|0),ue){if(B=TA(j,Y)|0,(B|0)==7)return $e=2,De=Te,$e|0;V=TA(Y,j)|0,(V|0)==7?Mt(22925,22949,151,22959):(be=B,M=V)}else be=0,M=0;ae=en(j)|0,ne=en(Y)|0,a[$e>>2]=0,a[$e+4>>2]=0,a[$e+8>>2]=0,a[$e+12>>2]=0;do if(be){if(Y=a[4304+(j*28|0)+(be<<2)>>2]|0,B=(Y|0)>0,ne)if(B){j=0,V=d,B=x;do V=_a(V,B)|0,B=Oe()|0,M=Wi(M)|0,(M|0)==1&&(M=Wi(1)|0),j=j+1|0;while((j|0)!=(Y|0));Y=M,j=V,V=B}else Y=M,j=d,V=x;else if(B){j=0,V=d,B=x;do V=Xi(V,B)|0,B=Oe()|0,M=Wi(M)|0,j=j+1|0;while((j|0)!=(Y|0));Y=M,j=V,V=B}else Y=M,j=d,V=x;if(Ul(j,V,$e)|0,ue||Mt(22972,22949,181,22959),B=(ae|0)!=0,M=(ne|0)!=0,B&M&&Mt(22999,22949,182,22959),B){if(M=ci(A,h)|0,he[22032+(M*7|0)+be>>0]|0){S=3;break}V=a[21200+(M*28|0)+(be<<2)>>2]|0,j=V,Me=26}else if(M){if(M=ci(j,V)|0,he[22032+(M*7|0)+Y>>0]|0){S=4;break}j=0,V=a[21200+(Y*28|0)+(M<<2)>>2]|0,Me=26}else M=0;if((Me|0)==26)if((V|0)<=-1&&Mt(23030,22949,212,22959),(j|0)<=-1&&Mt(23053,22949,213,22959),(V|0)>0){B=$e+4|0,M=0;do Ho(B),M=M+1|0;while((M|0)!=(V|0));M=j}else M=j;if(a[ve>>2]=0,a[ve+4>>2]=0,a[ve+8>>2]=0,MA(ve,be),S|0)for(;pi(S)|0?pa(ve):_o(ve),(S|0)>1;)S=S+-1|0;if((M|0)>0){S=0;do Ho(ve),S=S+1|0;while((S|0)!=(M|0))}Me=$e+4|0,On(Me,ve,Me),qr(Me),Me=50}else if(Ul(d,x,$e)|0,(ae|0)!=0&(ne|0)!=0)if((Y|0)!=(j|0)&&Mt(23077,22949,243,22959),M=ci(A,h)|0,S=ci(d,x)|0,he[22032+(M*7|0)+S>>0]|0)S=5;else if(M=a[21200+(M*28|0)+(S<<2)>>2]|0,(M|0)>0){B=$e+4|0,S=0;do Ho(B),S=S+1|0;while((S|0)!=(M|0));Me=50}else Me=50;else Me=50;while(0);return(Me|0)==50&&(S=$e+4|0,a[b>>2]=a[S>>2],a[b+4>>2]=a[S+4>>2],a[b+8>>2]=a[S+8>>2],S=0),$e=S,De=Te,$e|0}function gu(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Te=0;if(be=De,De=De+48|0,M=be+36|0,B=be+24|0,V=be+12|0,j=be,S=Ct(A|0,h|0,52)|0,Oe()|0,S=S&15,ne=Ct(A|0,h|0,45)|0,Oe()|0,ne=ne&127,Y=en(ne)|0,Pt(S|0,0,52)|0,ve=Oe()|0|134225919,Me=x,a[Me>>2]=-1,a[Me+4>>2]=ve,!S)return(a[d>>2]|0)>1||(a[d+4>>2]|0)>1||(a[d+8>>2]|0)>1||(b=su(ne,yo(d)|0)|0,(b|0)==127)?(ve=1,De=be,ve|0):(ue=Pt(b|0,0,45)|0,Me=Oe()|0,ne=x,Me=a[ne+4>>2]&-1040385|Me,ve=x,a[ve>>2]=a[ne>>2]|ue,a[ve+4>>2]=Me,ve=0,De=be,ve|0);for(a[M>>2]=a[d>>2],a[M+4>>2]=a[d+4>>2],a[M+8>>2]=a[d+8>>2];a[B>>2]=a[M>>2],a[B+4>>2]=a[M+4>>2],a[B+8>>2]=a[M+8>>2],pi(S)|0?(Ll(M),a[V>>2]=a[M>>2],a[V+4>>2]=a[M+4>>2],a[V+8>>2]=a[M+8>>2],pa(V)):(jo(M),a[V>>2]=a[M>>2],a[V+4>>2]=a[M+4>>2],a[V+8>>2]=a[M+8>>2],_o(V)),Ts(B,V,j),qr(j),Me=x,$e=a[Me>>2]|0,Me=a[Me+4>>2]|0,Te=(15-S|0)*3|0,d=Pt(7,0,Te|0)|0,Me=Me&~(Oe()|0),Te=Pt(yo(j)|0,0,Te|0)|0,Me=Oe()|0|Me,ve=x,a[ve>>2]=Te|$e&~d,a[ve+4>>2]=Me,(S|0)>1;)S=S+-1|0;e:do if((a[M>>2]|0)<=1&&(a[M+4>>2]|0)<=1&&(a[M+8>>2]|0)<=1){S=yo(M)|0,B=su(ne,S)|0,(B|0)==127?j=0:j=en(B)|0;t:do if(S){if(Y){if(M=21408+((ci(A,h)|0)*28|0)+(S<<2)|0,M=a[M>>2]|0,(M|0)>0){d=0;do S=Hi(S)|0,d=d+1|0;while((d|0)!=(M|0))}if((S|0)==1){b=3;break e}d=su(ne,S)|0,(d|0)==127&&Mt(23104,22949,376,23134),en(d)|0?Mt(23147,22949,377,23134):(ue=M,ae=S,b=d)}else ue=0,ae=S,b=B;if(V=a[4304+(ne*28|0)+(ae<<2)>>2]|0,(V|0)<=-1&&Mt(23178,22949,384,23134),!j){if((ue|0)<=-1&&Mt(23030,22949,417,23134),ue|0){M=x,S=0,d=a[M>>2]|0,M=a[M+4>>2]|0;do d=us(d,M)|0,M=Oe()|0,Te=x,a[Te>>2]=d,a[Te+4>>2]=M,S=S+1|0;while((S|0)<(ue|0))}if((V|0)<=0){S=54;break}for(M=x,S=0,d=a[M>>2]|0,M=a[M+4>>2]|0;;)if(d=us(d,M)|0,M=Oe()|0,Te=x,a[Te>>2]=d,a[Te+4>>2]=M,S=S+1|0,(S|0)==(V|0)){S=54;break t}}if(B=TA(b,ne)|0,(B|0)==7&&Mt(22925,22949,393,23134),S=x,d=a[S>>2]|0,S=a[S+4>>2]|0,(V|0)>0){M=0;do d=us(d,S)|0,S=Oe()|0,Te=x,a[Te>>2]=d,a[Te+4>>2]=S,M=M+1|0;while((M|0)!=(V|0))}if(d=ci(d,S)|0,Te=Dr(b)|0,d=a[(Te?21824:21616)+(B*28|0)+(d<<2)>>2]|0,(d|0)<=-1&&Mt(23030,22949,412,23134),!d)S=54;else{B=x,S=0,M=a[B>>2]|0,B=a[B+4>>2]|0;do M=bi(M,B)|0,B=Oe()|0,Te=x,a[Te>>2]=M,a[Te+4>>2]=B,S=S+1|0;while((S|0)<(d|0));S=54}}else if((Y|0)!=0&(j|0)!=0)if(Te=ci(A,h)|0,S=x,S=21408+(Te*28|0)+((ci(a[S>>2]|0,a[S+4>>2]|0)|0)<<2)|0,S=a[S>>2]|0,(S|0)<=-1&&Mt(23201,22949,433,23134),!S)b=B,S=55;else{M=x,b=0,d=a[M>>2]|0,M=a[M+4>>2]|0;do d=us(d,M)|0,M=Oe()|0,Te=x,a[Te>>2]=d,a[Te+4>>2]=M,b=b+1|0;while((b|0)<(S|0));b=B,S=54}else b=B,S=54;while(0);if((S|0)==54&&j&&(S=55),(S|0)==55&&(Te=x,(ci(a[Te>>2]|0,a[Te+4>>2]|0)|0)==1)){b=4;break}Te=x,ve=a[Te>>2]|0,Te=a[Te+4>>2]&-1040385,$e=Pt(b|0,0,45)|0,Te=Te|(Oe()|0),b=x,a[b>>2]=ve|$e,a[b+4>>2]=Te,b=0}else b=2;while(0);return Te=b,De=be,Te|0}function wa(A,h,d,x,b){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0;return M=De,De=De+16|0,S=M,A=Nt(A,h,d,x,S)|0,A||(Wo(S,b),A=0),De=M,A|0}function Yo(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0;return b=De,De=De+16|0,S=b,_c(d,S),x=gu(A,h,S,x)|0,De=b,x|0}function mu(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0;return M=De,De=De+32|0,b=M+12|0,S=M,!(Nt(A,h,A,h,b)|0)&&!(Nt(A,h,d,x,S)|0)?A=vo(b,S)|0:A=-1,De=M,A|0}function Vt(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0;return M=De,De=De+32|0,b=M+12|0,S=M,!(Nt(A,h,A,h,b)|0)&&!(Nt(A,h,d,x,S)|0)?A=vo(b,S)|0:A=-1,De=M,(A>>>31^1)+A|0}function LA(A,h,d,x,b){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Te=0,Ge=0,xe=0,y=0,m=0;if(y=De,De=De+48|0,S=y+24|0,M=y+12|0,xe=y,!(Nt(A,h,A,h,S)|0)&&!(Nt(A,h,d,x,M)|0)){if(Ge=vo(S,M)|0,(Ge|0)<0)return xe=Ge,De=y,xe|0;for(a[S>>2]=0,a[S+4>>2]=0,a[S+8>>2]=0,a[M>>2]=0,a[M+4>>2]=0,a[M+8>>2]=0,Nt(A,h,A,h,S)|0,Nt(A,h,d,x,M)|0,lu(S),lu(M),Ge?(Y=a[S>>2]|0,ue=+(Ge|0),ve=S+4|0,ae=a[ve>>2]|0,$e=S+8|0,ne=a[$e>>2]|0,Te=S,d=Y,x=ae,S=ne,be=+((a[M>>2]|0)-Y|0)/ue,Me=+((a[M+4>>2]|0)-ae|0)/ue,ue=+((a[M+8>>2]|0)-ne|0)/ue):(x=S+4|0,ne=S+8|0,ve=x,$e=ne,Te=S,d=a[S>>2]|0,x=a[x>>2]|0,S=a[ne>>2]|0,be=0,Me=0,ue=0),a[xe>>2]=d,ne=xe+4|0,a[ne>>2]=x,ae=xe+8|0,a[ae>>2]=S,Y=0;;){V=+(Y|0),m=be*V+ +(d|0),B=Me*V+ +(a[ve>>2]|0),V=ue*V+ +(a[$e>>2]|0),x=~~+rl(+m),M=~~+rl(+B),d=~~+rl(+V),m=+Pe(+(+(x|0)-m)),B=+Pe(+(+(M|0)-B)),V=+Pe(+(+(d|0)-V));do if(m>B&m>V)x=0-(M+d)|0,S=M;else if(j=0-x|0,B>V){S=j-d|0;break}else{S=M,d=j-M|0;break}while(0);if(a[xe>>2]=x,a[ne>>2]=S,a[ae>>2]=d,Rl(xe),gu(A,h,xe,b+(Y<<3)|0)|0,(Y|0)==(Ge|0))break;Y=Y+1|0,d=a[Te>>2]|0}return xe=0,De=y,xe|0}return xe=-1,De=y,xe|0}function $l(A,h){A=A|0,h=h|0;var d=0;if(!h)return d=1,d|0;d=A,A=1;do A=qt(h&1|0?d:1,A)|0,h=h>>1,d=qt(d,d)|0;while(h|0);return A|0}function DA(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0;if(!(CA(h,d)|0)||(h=SA(h)|0,ne=+G[d>>3],x=+G[d+8>>3],x=h&x<0?x+6.283185307179586:x,ae=a[A>>2]|0,(ae|0)<=0))return ae=0,ae|0;if(Y=a[A+4>>2]|0,h){h=0,d=-1,A=0;e:for(;;){for(j=A;M=+G[Y+(j<<4)>>3],V=+G[Y+(j<<4)+8>>3],A=(d+2|0)%(ae|0)|0,S=+G[Y+(A<<4)>>3],b=+G[Y+(A<<4)+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!(ne<S|ne>B);)if(d=j+1|0,(d|0)<(ae|0))A=j,j=d,d=A;else{d=22;break e}if(V=b<0?b+6.283185307179586:b,M=M<0?M+6.283185307179586:M,x=M==x|V==x?x+-2220446049250313e-31:x,V=V+(ne-S)/(B-S)*(M-V),(V<0?V+6.283185307179586:V)>x&&(h=h^1),A=j+1|0,(A|0)>=(ae|0)){d=22;break}else d=j}if((d|0)==22)return h|0}else{h=0,d=-1,A=0;e:for(;;){for(j=A;M=+G[Y+(j<<4)>>3],V=+G[Y+(j<<4)+8>>3],A=(d+2|0)%(ae|0)|0,S=+G[Y+(A<<4)>>3],b=+G[Y+(A<<4)+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!(ne<S|ne>B);)if(d=j+1|0,(d|0)<(ae|0))A=j,j=d,d=A;else{d=22;break e}if(x=M==x|b==x?x+-2220446049250313e-31:x,b+(ne-S)/(B-S)*(M-b)>x&&(h=h^1),A=j+1|0,(A|0)>=(ae|0)){d=22;break}else d=j}if((d|0)==22)return h|0}return 0}function tl(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Te=0;if(be=a[A>>2]|0,!be){a[h>>2]=0,a[h+4>>2]=0,a[h+8>>2]=0,a[h+12>>2]=0,a[h+16>>2]=0,a[h+20>>2]=0,a[h+24>>2]=0,a[h+28>>2]=0;return}if(Me=h+8|0,G[Me>>3]=17976931348623157e292,ve=h+24|0,G[ve>>3]=17976931348623157e292,G[h>>3]=-17976931348623157e292,$e=h+16|0,G[$e>>3]=-17976931348623157e292,!((be|0)<=0)){for(ne=a[A+4>>2]|0,j=17976931348623157e292,Y=-17976931348623157e292,ae=0,A=-1,S=17976931348623157e292,M=17976931348623157e292,V=-17976931348623157e292,x=-17976931348623157e292,ue=0;d=+G[ne+(ue<<4)>>3],B=+G[ne+(ue<<4)+8>>3],A=A+2|0,b=+G[ne+(((A|0)==(be|0)?0:A)<<4)+8>>3],d<S&&(G[Me>>3]=d,S=d),B<M&&(G[ve>>3]=B,M=B),d>V?G[h>>3]=d:d=V,B>x&&(G[$e>>3]=B,x=B),j=B>0&B<j?B:j,Y=B<0&B>Y?B:Y,ae=ae|+Pe(+(B-b))>3.141592653589793,A=ue+1|0,(A|0)!=(be|0);)Te=ue,V=d,ue=A,A=Te;ae&&(G[$e>>3]=Y,G[ve>>3]=j)}}function Hs(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Te=0,Ge=0,xe=0,y=0,m=0,v=0;if(be=a[A>>2]|0,be){if(Me=h+8|0,G[Me>>3]=17976931348623157e292,ve=h+24|0,G[ve>>3]=17976931348623157e292,G[h>>3]=-17976931348623157e292,$e=h+16|0,G[$e>>3]=-17976931348623157e292,(be|0)>0){for(b=a[A+4>>2]|0,ne=17976931348623157e292,ue=-17976931348623157e292,x=0,d=-1,V=17976931348623157e292,j=17976931348623157e292,ae=-17976931348623157e292,M=-17976931348623157e292,Te=0;S=+G[b+(Te<<4)>>3],Y=+G[b+(Te<<4)+8>>3],m=d+2|0,B=+G[b+(((m|0)==(be|0)?0:m)<<4)+8>>3],S<V&&(G[Me>>3]=S,V=S),Y<j&&(G[ve>>3]=Y,j=Y),S>ae?G[h>>3]=S:S=ae,Y>M&&(G[$e>>3]=Y,M=Y),ne=Y>0&Y<ne?Y:ne,ue=Y<0&Y>ue?Y:ue,x=x|+Pe(+(Y-B))>3.141592653589793,d=Te+1|0,(d|0)!=(be|0);)m=Te,ae=S,Te=d,d=m;x&&(G[$e>>3]=ue,G[ve>>3]=ne)}}else a[h>>2]=0,a[h+4>>2]=0,a[h+8>>2]=0,a[h+12>>2]=0,a[h+16>>2]=0,a[h+20>>2]=0,a[h+24>>2]=0,a[h+28>>2]=0;if(m=A+8|0,d=a[m>>2]|0,!((d|0)<=0)){y=A+12|0,xe=0;do if(b=a[y>>2]|0,x=xe,xe=xe+1|0,ve=h+(xe<<5)|0,$e=a[b+(x<<3)>>2]|0,$e){if(Te=h+(xe<<5)+8|0,G[Te>>3]=17976931348623157e292,A=h+(xe<<5)+24|0,G[A>>3]=17976931348623157e292,G[ve>>3]=-17976931348623157e292,Ge=h+(xe<<5)+16|0,G[Ge>>3]=-17976931348623157e292,($e|0)>0){for(be=a[b+(x<<3)+4>>2]|0,ne=17976931348623157e292,ue=-17976931348623157e292,b=0,x=-1,Me=0,V=17976931348623157e292,j=17976931348623157e292,Y=-17976931348623157e292,M=-17976931348623157e292;S=+G[be+(Me<<4)>>3],ae=+G[be+(Me<<4)+8>>3],x=x+2|0,B=+G[be+(((x|0)==($e|0)?0:x)<<4)+8>>3],S<V&&(G[Te>>3]=S,V=S),ae<j&&(G[A>>3]=ae,j=ae),S>Y?G[ve>>3]=S:S=Y,ae>M&&(G[Ge>>3]=ae,M=ae),ne=ae>0&ae<ne?ae:ne,ue=ae<0&ae>ue?ae:ue,b=b|+Pe(+(ae-B))>3.141592653589793,x=Me+1|0,(x|0)!=($e|0);)v=Me,Me=x,Y=S,x=v;b&&(G[Ge>>3]=ue,G[A>>3]=ne)}}else a[ve>>2]=0,a[ve+4>>2]=0,a[ve+8>>2]=0,a[ve+12>>2]=0,a[ve+16>>2]=0,a[ve+20>>2]=0,a[ve+24>>2]=0,a[ve+28>>2]=0,d=a[m>>2]|0;while((xe|0)<(d|0))}}function yu(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0;if(!(DA(A,h,d)|0))return b=0,b|0;if(b=A+8|0,(a[b>>2]|0)<=0)return b=1,b|0;for(x=A+12|0,A=0;;){if(S=A,A=A+1|0,DA((a[x>>2]|0)+(S<<3)|0,h+(A<<5)|0,d)|0){A=0,x=6;break}if((A|0)>=(a[b>>2]|0)){A=1,x=6;break}}return(x|0)==6?A|0:0}function Ph(){return 8}function Sc(){return 16}function _u(){return 168}function vu(){return 8}function xu(){return 16}function Ws(){return 12}function Ri(){return 8}function Eo(A){A=A|0;var h=0,d=0;return d=+G[A>>3],h=+G[A+8>>3],+ +Ie(+(d*d+h*h))}function wu(A,h,d,x,b){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0;j=+G[A>>3],V=+G[h>>3]-j,B=+G[A+8>>3],M=+G[h+8>>3]-B,ae=+G[d>>3],S=+G[x>>3]-ae,ne=+G[d+8>>3],Y=+G[x+8>>3]-ne,S=(S*(B-ne)-(j-ae)*Y)/(V*Y-M*S),G[b>>3]=j+V*S,G[b+8>>3]=B+M*S}function ba(A,h){return A=A|0,h=h|0,+G[A>>3]!=+G[h>>3]?(h=0,h|0):(h=+G[A+8>>3]==+G[h+8>>3],h|0)}function Nr(A,h){A=A|0,h=h|0;var d=0,x=0,b=0;return b=+G[A>>3]-+G[h>>3],x=+G[A+8>>3]-+G[h+8>>3],d=+G[A+16>>3]-+G[h+16>>3],+(b*b+x*x+d*d)}function jl(A,h){A=A|0,h=h|0;var d=0,x=0,b=0;d=+G[A>>3],x=+At(+d),d=+We(+d),G[h+16>>3]=d,d=+G[A+8>>3],b=x*+At(+d),G[h>>3]=b,d=x*+We(+d),G[h+8>>3]=d}function Cc(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0;if(j=De,De=De+32|0,b=j+16|0,S=j,Xa(A,h,b),M=As(A,h)|0,V=ci(A,h)|0,bA(M,S),h=EA(M,a[b>>2]|0)|0,!(en(M)|0))return V=h,De=j,V|0;do switch(M|0){case 4:{A=0,d=14;break}case 14:{A=1,d=14;break}case 24:{A=2,d=14;break}case 38:{A=3,d=14;break}case 49:{A=4,d=14;break}case 58:{A=5,d=14;break}case 63:{A=6,d=14;break}case 72:{A=7,d=14;break}case 83:{A=8,d=14;break}case 97:{A=9,d=14;break}case 107:{A=10,d=14;break}case 117:{A=11,d=14;break}default:B=0,x=0}while(0);return(d|0)==14&&(B=a[22096+(A*24|0)+8>>2]|0,x=a[22096+(A*24|0)+16>>2]|0),A=a[b>>2]|0,(A|0)!=(a[S>>2]|0)&&(M=Dr(M)|0,A=a[b>>2]|0,M|(A|0)==(x|0)&&(h=(h+1|0)%6|0)),(V|0)==3&(A|0)==(x|0)?(V=(h+5|0)%6|0,De=j,V|0):(V|0)==5&(A|0)==(B|0)?(V=(h+1|0)%6|0,De=j,V|0):(V=h,De=j,V|0)}function fs(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0;return x=Rr(A,h)|0,(d+-1|0)>>>0>5||(b=(x|0)!=0,(d|0)==1&b)?(d=-1,d|0):(x=Cc(A,h)|0,b?(d=(5-x+(a[22384+(d<<2)>>2]|0)|0)%5|0,d|0):(d=(6-x+(a[22416+(d<<2)>>2]|0)|0)%6|0,d|0))}function Sr(A,h,d){A=A|0,h=h|0,d=d|0;var x=0;(h|0)>0?(x=Ji(h,4)|0,a[A>>2]=x,x||Mt(23230,23253,40,23267)):a[A>>2]=0,a[A+4>>2]=h,a[A+8>>2]=0,a[A+12>>2]=d}function nl(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=A+4|0,S=A+12|0,M=A+8|0;e:for(;;){for(d=a[b>>2]|0,h=0;;){if((h|0)>=(d|0))break e;if(x=a[A>>2]|0,B=a[x+(h<<2)>>2]|0,!B)h=h+1|0;else break}h=x+(~~(+Pe(+(+qe(10,+ +(15-(a[S>>2]|0)|0))*(+G[B>>3]+ +G[B+8>>3])))%+(d|0))>>>0<<2)|0,d=a[h>>2]|0;t:do if(d|0){if(x=B+32|0,(d|0)==(B|0))a[h>>2]=a[x>>2];else{if(d=d+32|0,h=a[d>>2]|0,!h)break;for(;(h|0)!=(B|0);)if(d=h+32|0,h=a[d>>2]|0,!h)break t;a[d>>2]=a[x>>2]}hn(B),a[M>>2]=(a[M>>2]|0)+-1}while(0)}hn(a[A>>2]|0)}function Hl(A){A=A|0;var h=0,d=0,x=0;for(x=a[A+4>>2]|0,d=0;;){if((d|0)>=(x|0)){h=0,d=4;break}if(h=a[(a[A>>2]|0)+(d<<2)>>2]|0,!h)d=d+1|0;else{d=4;break}}return(d|0)==4?h|0:0}function bu(A,h){A=A|0,h=h|0;var d=0,x=0,b=0,S=0;if(d=~~(+Pe(+(+qe(10,+ +(15-(a[A+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[A+4>>2]|0))>>>0,d=(a[A>>2]|0)+(d<<2)|0,x=a[d>>2]|0,!x)return S=1,S|0;S=h+32|0;do if((x|0)!=(h|0)){if(d=a[x+32>>2]|0,!d)return S=1,S|0;for(b=d;;){if((b|0)==(h|0)){b=8;break}if(d=a[b+32>>2]|0,d)x=b,b=d;else{d=1,b=10;break}}if((b|0)==8){a[x+32>>2]=a[S>>2];break}else if((b|0)==10)return d|0}else a[d>>2]=a[S>>2];while(0);return hn(h),S=A+8|0,a[S>>2]=(a[S>>2]|0)+-1,S=0,S|0}function Mc(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;S=Xt(40)|0,S||Mt(23283,23253,98,23296),a[S>>2]=a[h>>2],a[S+4>>2]=a[h+4>>2],a[S+8>>2]=a[h+8>>2],a[S+12>>2]=a[h+12>>2],b=S+16|0,a[b>>2]=a[d>>2],a[b+4>>2]=a[d+4>>2],a[b+8>>2]=a[d+8>>2],a[b+12>>2]=a[d+12>>2],a[S+32>>2]=0,b=~~(+Pe(+(+qe(10,+ +(15-(a[A+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[A+4>>2]|0))>>>0,b=(a[A>>2]|0)+(b<<2)|0,x=a[b>>2]|0;do if(!x)a[b>>2]=S;else{for(;!(Vs(x,h)|0&&Vs(x+16|0,d)|0);)if(b=a[x+32>>2]|0,x=b|0?b:x,!(a[x+32>>2]|0)){M=10;break}if((M|0)==10){a[x+32>>2]=S;break}return hn(S),M=x,M|0}while(0);return M=A+8|0,a[M>>2]=(a[M>>2]|0)+1,M=S,M|0}function Eu(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0;if(b=~~(+Pe(+(+qe(10,+ +(15-(a[A+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[A+4>>2]|0))>>>0,b=a[(a[A>>2]|0)+(b<<2)>>2]|0,!b)return d=0,d|0;if(!d){for(A=b;;){if(Vs(A,h)|0){x=10;break}if(A=a[A+32>>2]|0,!A){A=0,x=10;break}}if((x|0)==10)return A|0}for(A=b;;){if(Vs(A,h)|0&&Vs(A+16|0,d)|0){x=10;break}if(A=a[A+32>>2]|0,!A){A=0,x=10;break}}return(x|0)==10?A|0:0}function Pc(A,h){A=A|0,h=h|0;var d=0;if(d=~~(+Pe(+(+qe(10,+ +(15-(a[A+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[A+4>>2]|0))>>>0,A=a[(a[A>>2]|0)+(d<<2)>>2]|0,!A)return d=0,d|0;for(;;){if(Vs(A,h)|0){h=5;break}if(A=a[A+32>>2]|0,!A){A=0,h=5;break}}return(h|0)==5?A|0:0}function yr(){return 23312}function Wl(A){return A=+A,+ +c(+A)}function Yt(A){return A=+A,~~+Wl(A)|0}function Xt(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Te=0,Ge=0,xe=0,y=0;y=De,De=De+16|0,ne=y;do if(A>>>0<245){if(j=A>>>0<11?16:A+11&-8,A=j>>>3,ae=a[5829]|0,d=ae>>>A,d&3|0)return h=(d&1^1)+A|0,A=23356+(h<<1<<2)|0,d=A+8|0,x=a[d>>2]|0,b=x+8|0,S=a[b>>2]|0,(S|0)==(A|0)?a[5829]=ae&~(1<<h):(a[S+12>>2]=A,a[d>>2]=S),xe=h<<3,a[x+4>>2]=xe|3,xe=x+xe+4|0,a[xe>>2]=a[xe>>2]|1,xe=b,De=y,xe|0;if(Y=a[5831]|0,j>>>0>Y>>>0){if(d|0)return h=2<<A,h=d<<A&(h|0-h),h=(h&0-h)+-1|0,B=h>>>12&16,h=h>>>B,d=h>>>5&8,h=h>>>d,S=h>>>2&4,h=h>>>S,A=h>>>1&2,h=h>>>A,x=h>>>1&1,x=(d|B|S|A|x)+(h>>>x)|0,h=23356+(x<<1<<2)|0,A=h+8|0,S=a[A>>2]|0,B=S+8|0,d=a[B>>2]|0,(d|0)==(h|0)?(A=ae&~(1<<x),a[5829]=A):(a[d+12>>2]=h,a[A>>2]=d,A=ae),xe=x<<3,M=xe-j|0,a[S+4>>2]=j|3,b=S+j|0,a[b+4>>2]=M|1,a[S+xe>>2]=M,Y|0&&(x=a[5834]|0,h=Y>>>3,d=23356+(h<<1<<2)|0,h=1<<h,A&h?(A=d+8|0,h=a[A>>2]|0):(a[5829]=A|h,h=d,A=d+8|0),a[A>>2]=x,a[h+12>>2]=x,a[x+8>>2]=h,a[x+12>>2]=d),a[5831]=M,a[5834]=b,xe=B,De=y,xe|0;if(S=a[5830]|0,S){for(d=(S&0-S)+-1|0,b=d>>>12&16,d=d>>>b,x=d>>>5&8,d=d>>>x,M=d>>>2&4,d=d>>>M,B=d>>>1&2,d=d>>>B,V=d>>>1&1,V=a[23620+((x|b|M|B|V)+(d>>>V)<<2)>>2]|0,d=V,B=V,V=(a[V+4>>2]&-8)-j|0;A=a[d+16>>2]|0,!(!A&&(A=a[d+20>>2]|0,!A));)M=(a[A+4>>2]&-8)-j|0,b=M>>>0<V>>>0,d=A,B=b?A:B,V=b?M:V;if(M=B+j|0,M>>>0>B>>>0){b=a[B+24>>2]|0,h=a[B+12>>2]|0;do if((h|0)==(B|0)){if(A=B+20|0,h=a[A>>2]|0,!h&&(A=B+16|0,h=a[A>>2]|0,!h)){d=0;break}for(;;)if(x=h+20|0,d=a[x>>2]|0,d)h=d,A=x;else if(x=h+16|0,d=a[x>>2]|0,d)h=d,A=x;else break;a[A>>2]=0,d=h}else d=a[B+8>>2]|0,a[d+12>>2]=h,a[h+8>>2]=d,d=h;while(0);do if(b|0){if(h=a[B+28>>2]|0,A=23620+(h<<2)|0,(B|0)==(a[A>>2]|0)){if(a[A>>2]=d,!d){a[5830]=S&~(1<<h);break}}else if(xe=b+16|0,a[((a[xe>>2]|0)==(B|0)?xe:b+20|0)>>2]=d,!d)break;a[d+24>>2]=b,h=a[B+16>>2]|0,h|0&&(a[d+16>>2]=h,a[h+24>>2]=d),h=a[B+20>>2]|0,h|0&&(a[d+20>>2]=h,a[h+24>>2]=d)}while(0);return V>>>0<16?(xe=V+j|0,a[B+4>>2]=xe|3,xe=B+xe+4|0,a[xe>>2]=a[xe>>2]|1):(a[B+4>>2]=j|3,a[M+4>>2]=V|1,a[M+V>>2]=V,Y|0&&(x=a[5834]|0,h=Y>>>3,d=23356+(h<<1<<2)|0,h=1<<h,h&ae?(A=d+8|0,h=a[A>>2]|0):(a[5829]=h|ae,h=d,A=d+8|0),a[A>>2]=x,a[h+12>>2]=x,a[x+8>>2]=h,a[x+12>>2]=d),a[5831]=V,a[5834]=M),xe=B+8|0,De=y,xe|0}else ae=j}else ae=j}else ae=j}else if(A>>>0<=4294967231)if(A=A+11|0,j=A&-8,x=a[5830]|0,x){b=0-j|0,A=A>>>8,A?j>>>0>16777215?V=31:(ae=(A+1048320|0)>>>16&8,Me=A<<ae,B=(Me+520192|0)>>>16&4,Me=Me<<B,V=(Me+245760|0)>>>16&2,V=14-(B|ae|V)+(Me<<V>>>15)|0,V=j>>>(V+7|0)&1|V<<1):V=0,d=a[23620+(V<<2)>>2]|0;e:do if(!d)d=0,A=0,Me=61;else for(A=0,B=j<<((V|0)==31?0:25-(V>>>1)|0),S=0;;){if(M=(a[d+4>>2]&-8)-j|0,M>>>0<b>>>0)if(M)A=d,b=M;else{A=d,b=0,Me=65;break e}if(Me=a[d+20>>2]|0,d=a[d+16+(B>>>31<<2)>>2]|0,S=(Me|0)==0|(Me|0)==(d|0)?S:Me,d)B=B<<1;else{d=S,Me=61;break}}while(0);if((Me|0)==61){if((d|0)==0&(A|0)==0){if(A=2<<V,A=(A|0-A)&x,!A){ae=j;break}ae=(A&0-A)+-1|0,M=ae>>>12&16,ae=ae>>>M,S=ae>>>5&8,ae=ae>>>S,B=ae>>>2&4,ae=ae>>>B,V=ae>>>1&2,ae=ae>>>V,d=ae>>>1&1,A=0,d=a[23620+((S|M|B|V|d)+(ae>>>d)<<2)>>2]|0}d?Me=65:(B=A,M=b)}if((Me|0)==65)for(S=d;;)if(ae=(a[S+4>>2]&-8)-j|0,d=ae>>>0<b>>>0,b=d?ae:b,A=d?S:A,d=a[S+16>>2]|0,d||(d=a[S+20>>2]|0),d)S=d;else{B=A,M=b;break}if(B|0&&M>>>0<((a[5831]|0)-j|0)>>>0&&(Y=B+j|0,Y>>>0>B>>>0)){S=a[B+24>>2]|0,h=a[B+12>>2]|0;do if((h|0)==(B|0)){if(A=B+20|0,h=a[A>>2]|0,!h&&(A=B+16|0,h=a[A>>2]|0,!h)){h=0;break}for(;;)if(b=h+20|0,d=a[b>>2]|0,d)h=d,A=b;else if(b=h+16|0,d=a[b>>2]|0,d)h=d,A=b;else break;a[A>>2]=0}else xe=a[B+8>>2]|0,a[xe+12>>2]=h,a[h+8>>2]=xe;while(0);do if(S){if(A=a[B+28>>2]|0,d=23620+(A<<2)|0,(B|0)==(a[d>>2]|0)){if(a[d>>2]=h,!h){x=x&~(1<<A),a[5830]=x;break}}else if(xe=S+16|0,a[((a[xe>>2]|0)==(B|0)?xe:S+20|0)>>2]=h,!h)break;a[h+24>>2]=S,A=a[B+16>>2]|0,A|0&&(a[h+16>>2]=A,a[A+24>>2]=h),A=a[B+20>>2]|0,A&&(a[h+20>>2]=A,a[A+24>>2]=h)}while(0);e:do if(M>>>0<16)xe=M+j|0,a[B+4>>2]=xe|3,xe=B+xe+4|0,a[xe>>2]=a[xe>>2]|1;else{if(a[B+4>>2]=j|3,a[Y+4>>2]=M|1,a[Y+M>>2]=M,h=M>>>3,M>>>0<256){d=23356+(h<<1<<2)|0,A=a[5829]|0,h=1<<h,A&h?(A=d+8|0,h=a[A>>2]|0):(a[5829]=A|h,h=d,A=d+8|0),a[A>>2]=Y,a[h+12>>2]=Y,a[Y+8>>2]=h,a[Y+12>>2]=d;break}if(h=M>>>8,h?M>>>0>16777215?d=31:(Ge=(h+1048320|0)>>>16&8,xe=h<<Ge,Te=(xe+520192|0)>>>16&4,xe=xe<<Te,d=(xe+245760|0)>>>16&2,d=14-(Te|Ge|d)+(xe<<d>>>15)|0,d=M>>>(d+7|0)&1|d<<1):d=0,h=23620+(d<<2)|0,a[Y+28>>2]=d,A=Y+16|0,a[A+4>>2]=0,a[A>>2]=0,A=1<<d,!(x&A)){a[5830]=x|A,a[h>>2]=Y,a[Y+24>>2]=h,a[Y+12>>2]=Y,a[Y+8>>2]=Y;break}h=a[h>>2]|0;t:do if((a[h+4>>2]&-8|0)!=(M|0)){for(x=M<<((d|0)==31?0:25-(d>>>1)|0);d=h+16+(x>>>31<<2)|0,A=a[d>>2]|0,!!A;)if((a[A+4>>2]&-8|0)==(M|0)){h=A;break t}else x=x<<1,h=A;a[d>>2]=Y,a[Y+24>>2]=h,a[Y+12>>2]=Y,a[Y+8>>2]=Y;break e}while(0);Ge=h+8|0,xe=a[Ge>>2]|0,a[xe+12>>2]=Y,a[Ge>>2]=Y,a[Y+8>>2]=xe,a[Y+12>>2]=h,a[Y+24>>2]=0}while(0);return xe=B+8|0,De=y,xe|0}else ae=j}else ae=j;else ae=-1;while(0);if(d=a[5831]|0,d>>>0>=ae>>>0)return h=d-ae|0,A=a[5834]|0,h>>>0>15?(xe=A+ae|0,a[5834]=xe,a[5831]=h,a[xe+4>>2]=h|1,a[A+d>>2]=h,a[A+4>>2]=ae|3):(a[5831]=0,a[5834]=0,a[A+4>>2]=d|3,xe=A+d+4|0,a[xe>>2]=a[xe>>2]|1),xe=A+8|0,De=y,xe|0;if(M=a[5832]|0,M>>>0>ae>>>0)return Te=M-ae|0,a[5832]=Te,xe=a[5835]|0,Ge=xe+ae|0,a[5835]=Ge,a[Ge+4>>2]=Te|1,a[xe+4>>2]=ae|3,xe=xe+8|0,De=y,xe|0;if(a[5947]|0?A=a[5949]|0:(a[5949]=4096,a[5948]=4096,a[5950]=-1,a[5951]=-1,a[5952]=0,a[5940]=0,a[5947]=ne&-16^1431655768,A=4096),B=ae+48|0,V=ae+47|0,S=A+V|0,b=0-A|0,j=S&b,j>>>0<=ae>>>0||(A=a[5939]|0,A|0&&(Y=a[5937]|0,ne=Y+j|0,ne>>>0<=Y>>>0|ne>>>0>A>>>0)))return xe=0,De=y,xe|0;e:do if(a[5940]&4)h=0,Me=143;else{d=a[5835]|0;t:do if(d){for(x=23764;ne=a[x>>2]|0,!(ne>>>0<=d>>>0&&(ne+(a[x+4>>2]|0)|0)>>>0>d>>>0);)if(A=a[x+8>>2]|0,A)x=A;else{Me=128;break t}if(h=S-M&b,h>>>0<2147483647)if(A=_(h|0)|0,(A|0)==((a[x>>2]|0)+(a[x+4>>2]|0)|0)){if((A|0)!=-1){M=h,S=A,Me=145;break e}}else x=A,Me=136;else h=0}else Me=128;while(0);do if((Me|0)==128)if(d=_(0)|0,(d|0)!=-1&&(h=d,ue=a[5948]|0,be=ue+-1|0,h=(be&h|0?(be+h&0-ue)-h|0:0)+j|0,ue=a[5937]|0,be=h+ue|0,h>>>0>ae>>>0&h>>>0<2147483647)){if(ne=a[5939]|0,ne|0&&be>>>0<=ue>>>0|be>>>0>ne>>>0){h=0;break}if(A=_(h|0)|0,(A|0)==(d|0)){M=h,S=d,Me=145;break e}else x=A,Me=136}else h=0;while(0);do if((Me|0)==136){if(d=0-h|0,!(B>>>0>h>>>0&(h>>>0<2147483647&(x|0)!=-1)))if((x|0)==-1){h=0;break}else{M=h,S=x,Me=145;break e}if(A=a[5949]|0,A=V-h+A&0-A,A>>>0>=2147483647){M=h,S=x,Me=145;break e}if((_(A|0)|0)==-1){_(d|0)|0,h=0;break}else{M=A+h|0,S=x,Me=145;break e}}while(0);a[5940]=a[5940]|4,Me=143}while(0);if((Me|0)==143&&j>>>0<2147483647&&(Te=_(j|0)|0,be=_(0)|0,ve=be-Te|0,$e=ve>>>0>(ae+40|0)>>>0,!((Te|0)==-1|$e^1|Te>>>0<be>>>0&((Te|0)!=-1&(be|0)!=-1)^1))&&(M=$e?ve:h,S=Te,Me=145),(Me|0)==145){h=(a[5937]|0)+M|0,a[5937]=h,h>>>0>(a[5938]|0)>>>0&&(a[5938]=h),V=a[5835]|0;e:do if(V){for(h=23764;;){if(A=a[h>>2]|0,d=a[h+4>>2]|0,(S|0)==(A+d|0)){Me=154;break}if(x=a[h+8>>2]|0,x)h=x;else break}if((Me|0)==154&&(Ge=h+4|0,(a[h+12>>2]&8|0)==0)&&S>>>0>V>>>0&A>>>0<=V>>>0){a[Ge>>2]=d+M,xe=(a[5832]|0)+M|0,Te=V+8|0,Te=Te&7|0?0-Te&7:0,Ge=V+Te|0,Te=xe-Te|0,a[5835]=Ge,a[5832]=Te,a[Ge+4>>2]=Te|1,a[V+xe+4>>2]=40,a[5836]=a[5951];break}for(S>>>0<(a[5833]|0)>>>0&&(a[5833]=S),d=S+M|0,h=23764;;){if((a[h>>2]|0)==(d|0)){Me=162;break}if(A=a[h+8>>2]|0,A)h=A;else break}if((Me|0)==162&&!(a[h+12>>2]&8|0)){a[h>>2]=S,Y=h+4|0,a[Y>>2]=(a[Y>>2]|0)+M,Y=S+8|0,Y=S+(Y&7|0?0-Y&7:0)|0,h=d+8|0,h=d+(h&7|0?0-h&7:0)|0,j=Y+ae|0,B=h-Y-ae|0,a[Y+4>>2]=ae|3;t:do if((V|0)==(h|0))xe=(a[5832]|0)+B|0,a[5832]=xe,a[5835]=j,a[j+4>>2]=xe|1;else{if((a[5834]|0)==(h|0)){xe=(a[5831]|0)+B|0,a[5831]=xe,a[5834]=j,a[j+4>>2]=xe|1,a[j+xe>>2]=xe;break}if(A=a[h+4>>2]|0,(A&3|0)==1){M=A&-8,x=A>>>3;n:do if(A>>>0<256)if(A=a[h+8>>2]|0,d=a[h+12>>2]|0,(d|0)==(A|0)){a[5829]=a[5829]&~(1<<x);break}else{a[A+12>>2]=d,a[d+8>>2]=A;break}else{S=a[h+24>>2]|0,A=a[h+12>>2]|0;do if((A|0)==(h|0)){if(d=h+16|0,x=d+4|0,A=a[x>>2]|0,A)d=x;else if(A=a[d>>2]|0,!A){A=0;break}for(;;)if(b=A+20|0,x=a[b>>2]|0,x)A=x,d=b;else if(b=A+16|0,x=a[b>>2]|0,x)A=x,d=b;else break;a[d>>2]=0}else xe=a[h+8>>2]|0,a[xe+12>>2]=A,a[A+8>>2]=xe;while(0);if(!S)break;d=a[h+28>>2]|0,x=23620+(d<<2)|0;do if((a[x>>2]|0)!=(h|0)){if(xe=S+16|0,a[((a[xe>>2]|0)==(h|0)?xe:S+20|0)>>2]=A,!A)break n}else{if(a[x>>2]=A,A|0)break;a[5830]=a[5830]&~(1<<d);break n}while(0);if(a[A+24>>2]=S,d=h+16|0,x=a[d>>2]|0,x|0&&(a[A+16>>2]=x,a[x+24>>2]=A),d=a[d+4>>2]|0,!d)break;a[A+20>>2]=d,a[d+24>>2]=A}while(0);h=h+M|0,b=M+B|0}else b=B;if(h=h+4|0,a[h>>2]=a[h>>2]&-2,a[j+4>>2]=b|1,a[j+b>>2]=b,h=b>>>3,b>>>0<256){d=23356+(h<<1<<2)|0,A=a[5829]|0,h=1<<h,A&h?(A=d+8|0,h=a[A>>2]|0):(a[5829]=A|h,h=d,A=d+8|0),a[A>>2]=j,a[h+12>>2]=j,a[j+8>>2]=h,a[j+12>>2]=d;break}h=b>>>8;do if(!h)x=0;else{if(b>>>0>16777215){x=31;break}Ge=(h+1048320|0)>>>16&8,xe=h<<Ge,Te=(xe+520192|0)>>>16&4,xe=xe<<Te,x=(xe+245760|0)>>>16&2,x=14-(Te|Ge|x)+(xe<<x>>>15)|0,x=b>>>(x+7|0)&1|x<<1}while(0);if(h=23620+(x<<2)|0,a[j+28>>2]=x,A=j+16|0,a[A+4>>2]=0,a[A>>2]=0,A=a[5830]|0,d=1<<x,!(A&d)){a[5830]=A|d,a[h>>2]=j,a[j+24>>2]=h,a[j+12>>2]=j,a[j+8>>2]=j;break}h=a[h>>2]|0;n:do if((a[h+4>>2]&-8|0)!=(b|0)){for(x=b<<((x|0)==31?0:25-(x>>>1)|0);d=h+16+(x>>>31<<2)|0,A=a[d>>2]|0,!!A;)if((a[A+4>>2]&-8|0)==(b|0)){h=A;break n}else x=x<<1,h=A;a[d>>2]=j,a[j+24>>2]=h,a[j+12>>2]=j,a[j+8>>2]=j;break t}while(0);Ge=h+8|0,xe=a[Ge>>2]|0,a[xe+12>>2]=j,a[Ge>>2]=j,a[j+8>>2]=xe,a[j+12>>2]=h,a[j+24>>2]=0}while(0);return xe=Y+8|0,De=y,xe|0}for(h=23764;A=a[h>>2]|0,!(A>>>0<=V>>>0&&(xe=A+(a[h+4>>2]|0)|0,xe>>>0>V>>>0));)h=a[h+8>>2]|0;b=xe+-47|0,A=b+8|0,A=b+(A&7|0?0-A&7:0)|0,b=V+16|0,A=A>>>0<b>>>0?V:A,h=A+8|0,d=M+-40|0,Te=S+8|0,Te=Te&7|0?0-Te&7:0,Ge=S+Te|0,Te=d-Te|0,a[5835]=Ge,a[5832]=Te,a[Ge+4>>2]=Te|1,a[S+d+4>>2]=40,a[5836]=a[5951],d=A+4|0,a[d>>2]=27,a[h>>2]=a[5941],a[h+4>>2]=a[5942],a[h+8>>2]=a[5943],a[h+12>>2]=a[5944],a[5941]=S,a[5942]=M,a[5944]=0,a[5943]=h,h=A+24|0;do Ge=h,h=h+4|0,a[h>>2]=7;while((Ge+8|0)>>>0<xe>>>0);if((A|0)!=(V|0)){if(S=A-V|0,a[d>>2]=a[d>>2]&-2,a[V+4>>2]=S|1,a[A>>2]=S,h=S>>>3,S>>>0<256){d=23356+(h<<1<<2)|0,A=a[5829]|0,h=1<<h,A&h?(A=d+8|0,h=a[A>>2]|0):(a[5829]=A|h,h=d,A=d+8|0),a[A>>2]=V,a[h+12>>2]=V,a[V+8>>2]=h,a[V+12>>2]=d;break}if(h=S>>>8,h?S>>>0>16777215?x=31:(Ge=(h+1048320|0)>>>16&8,xe=h<<Ge,Te=(xe+520192|0)>>>16&4,xe=xe<<Te,x=(xe+245760|0)>>>16&2,x=14-(Te|Ge|x)+(xe<<x>>>15)|0,x=S>>>(x+7|0)&1|x<<1):x=0,d=23620+(x<<2)|0,a[V+28>>2]=x,a[V+20>>2]=0,a[b>>2]=0,h=a[5830]|0,A=1<<x,!(h&A)){a[5830]=h|A,a[d>>2]=V,a[V+24>>2]=d,a[V+12>>2]=V,a[V+8>>2]=V;break}h=a[d>>2]|0;t:do if((a[h+4>>2]&-8|0)!=(S|0)){for(x=S<<((x|0)==31?0:25-(x>>>1)|0);d=h+16+(x>>>31<<2)|0,A=a[d>>2]|0,!!A;)if((a[A+4>>2]&-8|0)==(S|0)){h=A;break t}else x=x<<1,h=A;a[d>>2]=V,a[V+24>>2]=h,a[V+12>>2]=V,a[V+8>>2]=V;break e}while(0);Ge=h+8|0,xe=a[Ge>>2]|0,a[xe+12>>2]=V,a[Ge>>2]=V,a[V+8>>2]=xe,a[V+12>>2]=h,a[V+24>>2]=0}}else xe=a[5833]|0,(xe|0)==0|S>>>0<xe>>>0&&(a[5833]=S),a[5941]=S,a[5942]=M,a[5944]=0,a[5838]=a[5947],a[5837]=-1,a[5842]=23356,a[5841]=23356,a[5844]=23364,a[5843]=23364,a[5846]=23372,a[5845]=23372,a[5848]=23380,a[5847]=23380,a[5850]=23388,a[5849]=23388,a[5852]=23396,a[5851]=23396,a[5854]=23404,a[5853]=23404,a[5856]=23412,a[5855]=23412,a[5858]=23420,a[5857]=23420,a[5860]=23428,a[5859]=23428,a[5862]=23436,a[5861]=23436,a[5864]=23444,a[5863]=23444,a[5866]=23452,a[5865]=23452,a[5868]=23460,a[5867]=23460,a[5870]=23468,a[5869]=23468,a[5872]=23476,a[5871]=23476,a[5874]=23484,a[5873]=23484,a[5876]=23492,a[5875]=23492,a[5878]=23500,a[5877]=23500,a[5880]=23508,a[5879]=23508,a[5882]=23516,a[5881]=23516,a[5884]=23524,a[5883]=23524,a[5886]=23532,a[5885]=23532,a[5888]=23540,a[5887]=23540,a[5890]=23548,a[5889]=23548,a[5892]=23556,a[5891]=23556,a[5894]=23564,a[5893]=23564,a[5896]=23572,a[5895]=23572,a[5898]=23580,a[5897]=23580,a[5900]=23588,a[5899]=23588,a[5902]=23596,a[5901]=23596,a[5904]=23604,a[5903]=23604,xe=M+-40|0,Te=S+8|0,Te=Te&7|0?0-Te&7:0,Ge=S+Te|0,Te=xe-Te|0,a[5835]=Ge,a[5832]=Te,a[Ge+4>>2]=Te|1,a[S+xe+4>>2]=40,a[5836]=a[5951];while(0);if(h=a[5832]|0,h>>>0>ae>>>0)return Te=h-ae|0,a[5832]=Te,xe=a[5835]|0,Ge=xe+ae|0,a[5835]=Ge,a[Ge+4>>2]=Te|1,a[xe+4>>2]=ae|3,xe=xe+8|0,De=y,xe|0}return xe=yr()|0,a[xe>>2]=12,xe=0,De=y,xe|0}function hn(A){A=A|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(A){d=A+-8|0,b=a[5833]|0,A=a[A+-4>>2]|0,h=A&-8,V=d+h|0;do if(A&1)B=d,M=d;else{if(x=a[d>>2]|0,!(A&3)||(M=d+(0-x)|0,S=x+h|0,M>>>0<b>>>0))return;if((a[5834]|0)==(M|0)){if(A=V+4|0,h=a[A>>2]|0,(h&3|0)!=3){B=M,h=S;break}a[5831]=S,a[A>>2]=h&-2,a[M+4>>2]=S|1,a[M+S>>2]=S;return}if(d=x>>>3,x>>>0<256)if(A=a[M+8>>2]|0,h=a[M+12>>2]|0,(h|0)==(A|0)){a[5829]=a[5829]&~(1<<d),B=M,h=S;break}else{a[A+12>>2]=h,a[h+8>>2]=A,B=M,h=S;break}b=a[M+24>>2]|0,A=a[M+12>>2]|0;do if((A|0)==(M|0)){if(h=M+16|0,d=h+4|0,A=a[d>>2]|0,A)h=d;else if(A=a[h>>2]|0,!A){A=0;break}for(;;)if(x=A+20|0,d=a[x>>2]|0,d)A=d,h=x;else if(x=A+16|0,d=a[x>>2]|0,d)A=d,h=x;else break;a[h>>2]=0}else B=a[M+8>>2]|0,a[B+12>>2]=A,a[A+8>>2]=B;while(0);if(b){if(h=a[M+28>>2]|0,d=23620+(h<<2)|0,(a[d>>2]|0)==(M|0)){if(a[d>>2]=A,!A){a[5830]=a[5830]&~(1<<h),B=M,h=S;break}}else if(B=b+16|0,a[((a[B>>2]|0)==(M|0)?B:b+20|0)>>2]=A,!A){B=M,h=S;break}a[A+24>>2]=b,h=M+16|0,d=a[h>>2]|0,d|0&&(a[A+16>>2]=d,a[d+24>>2]=A),h=a[h+4>>2]|0,h?(a[A+20>>2]=h,a[h+24>>2]=A,B=M,h=S):(B=M,h=S)}else B=M,h=S}while(0);if(!(M>>>0>=V>>>0)&&(A=V+4|0,x=a[A>>2]|0,!!(x&1))){if(x&2)a[A>>2]=x&-2,a[B+4>>2]=h|1,a[M+h>>2]=h,b=h;else{if((a[5835]|0)==(V|0)){if(V=(a[5832]|0)+h|0,a[5832]=V,a[5835]=B,a[B+4>>2]=V|1,(B|0)!=(a[5834]|0))return;a[5834]=0,a[5831]=0;return}if((a[5834]|0)==(V|0)){V=(a[5831]|0)+h|0,a[5831]=V,a[5834]=M,a[B+4>>2]=V|1,a[M+V>>2]=V;return}b=(x&-8)+h|0,d=x>>>3;do if(x>>>0<256)if(h=a[V+8>>2]|0,A=a[V+12>>2]|0,(A|0)==(h|0)){a[5829]=a[5829]&~(1<<d);break}else{a[h+12>>2]=A,a[A+8>>2]=h;break}else{S=a[V+24>>2]|0,A=a[V+12>>2]|0;do if((A|0)==(V|0)){if(h=V+16|0,d=h+4|0,A=a[d>>2]|0,A)h=d;else if(A=a[h>>2]|0,!A){d=0;break}for(;;)if(x=A+20|0,d=a[x>>2]|0,d)A=d,h=x;else if(x=A+16|0,d=a[x>>2]|0,d)A=d,h=x;else break;a[h>>2]=0,d=A}else d=a[V+8>>2]|0,a[d+12>>2]=A,a[A+8>>2]=d,d=A;while(0);if(S|0){if(A=a[V+28>>2]|0,h=23620+(A<<2)|0,(a[h>>2]|0)==(V|0)){if(a[h>>2]=d,!d){a[5830]=a[5830]&~(1<<A);break}}else if(x=S+16|0,a[((a[x>>2]|0)==(V|0)?x:S+20|0)>>2]=d,!d)break;a[d+24>>2]=S,A=V+16|0,h=a[A>>2]|0,h|0&&(a[d+16>>2]=h,a[h+24>>2]=d),A=a[A+4>>2]|0,A|0&&(a[d+20>>2]=A,a[A+24>>2]=d)}}while(0);if(a[B+4>>2]=b|1,a[M+b>>2]=b,(B|0)==(a[5834]|0)){a[5831]=b;return}}if(A=b>>>3,b>>>0<256){d=23356+(A<<1<<2)|0,h=a[5829]|0,A=1<<A,h&A?(h=d+8|0,A=a[h>>2]|0):(a[5829]=h|A,A=d,h=d+8|0),a[h>>2]=B,a[A+12>>2]=B,a[B+8>>2]=A,a[B+12>>2]=d;return}A=b>>>8,A?b>>>0>16777215?x=31:(M=(A+1048320|0)>>>16&8,V=A<<M,S=(V+520192|0)>>>16&4,V=V<<S,x=(V+245760|0)>>>16&2,x=14-(S|M|x)+(V<<x>>>15)|0,x=b>>>(x+7|0)&1|x<<1):x=0,A=23620+(x<<2)|0,a[B+28>>2]=x,a[B+20>>2]=0,a[B+16>>2]=0,h=a[5830]|0,d=1<<x;e:do if(!(h&d))a[5830]=h|d,a[A>>2]=B,a[B+24>>2]=A,a[B+12>>2]=B,a[B+8>>2]=B;else{A=a[A>>2]|0;t:do if((a[A+4>>2]&-8|0)!=(b|0)){for(x=b<<((x|0)==31?0:25-(x>>>1)|0);d=A+16+(x>>>31<<2)|0,h=a[d>>2]|0,!!h;)if((a[h+4>>2]&-8|0)==(b|0)){A=h;break t}else x=x<<1,A=h;a[d>>2]=B,a[B+24>>2]=A,a[B+12>>2]=B,a[B+8>>2]=B;break e}while(0);M=A+8|0,V=a[M>>2]|0,a[V+12>>2]=B,a[M>>2]=B,a[B+8>>2]=V,a[B+12>>2]=A,a[B+24>>2]=0}while(0);if(V=(a[5837]|0)+-1|0,a[5837]=V,!(V|0)){for(A=23772;A=a[A>>2]|0,A;)A=A+8|0;a[5837]=-1}}}}function Ji(A,h){A=A|0,h=h|0;var d=0;return A?(d=qt(h,A)|0,(h|A)>>>0>65535&&(d=((d>>>0)/(A>>>0)|0|0)==(h|0)?d:-1)):d=0,A=Xt(d)|0,!A||!(a[A+-4>>2]&3)||L(A|0,0,d|0)|0,A|0}function Xo(A,h,d,x){return A=A|0,h=h|0,d=d|0,x=x|0,d=A+d>>>0,Ft(h+x+(d>>>0<A>>>0|0)>>>0|0),d|0|0}function $r(A,h,d,x){return A=A|0,h=h|0,d=d|0,x=x|0,x=h-x-(d>>>0>A>>>0|0)>>>0,Ft(x|0),A-d>>>0|0|0}function Qs(A){return A=A|0,(A?31-(xn(A^A-1)|0)|0:32)|0}function Cs(A,h,d,x,b){A=A|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0;if(Y=A,V=h,j=V,M=d,ne=x,B=ne,!j)return S=(b|0)!=0,B?S?(a[b>>2]=A|0,a[b+4>>2]=h&0,ne=0,b=0,Ft(ne|0),b|0):(ne=0,b=0,Ft(ne|0),b|0):(S&&(a[b>>2]=(Y>>>0)%(M>>>0),a[b+4>>2]=0),ne=0,b=(Y>>>0)/(M>>>0)>>>0,Ft(ne|0),b|0);S=(B|0)==0;do if(M){if(!S){if(S=(xn(B|0)|0)-(xn(j|0)|0)|0,S>>>0<=31){ae=S+1|0,B=31-S|0,h=S-31>>31,M=ae,A=Y>>>(ae>>>0)&h|j<<B,h=j>>>(ae>>>0)&h,S=0,B=Y<<B;break}return b?(a[b>>2]=A|0,a[b+4>>2]=V|h&0,ne=0,b=0,Ft(ne|0),b|0):(ne=0,b=0,Ft(ne|0),b|0)}if(S=M-1|0,S&M|0){B=(xn(M|0)|0)+33-(xn(j|0)|0)|0,be=64-B|0,ae=32-B|0,V=ae>>31,ue=B-32|0,h=ue>>31,M=B,A=ae-1>>31&j>>>(ue>>>0)|(j<<ae|Y>>>(B>>>0))&h,h=h&j>>>(B>>>0),S=Y<<be&V,B=(j<<be|Y>>>(ue>>>0))&V|Y<<ae&B-33>>31;break}return b|0&&(a[b>>2]=S&Y,a[b+4>>2]=0),(M|0)==1?(ue=V|h&0,be=A|0|0,Ft(ue|0),be|0):(be=Qs(M|0)|0,ue=j>>>(be>>>0)|0,be=j<<32-be|Y>>>(be>>>0)|0,Ft(ue|0),be|0)}else{if(S)return b|0&&(a[b>>2]=(j>>>0)%(M>>>0),a[b+4>>2]=0),ue=0,be=(j>>>0)/(M>>>0)>>>0,Ft(ue|0),be|0;if(!Y)return b|0&&(a[b>>2]=0,a[b+4>>2]=(j>>>0)%(B>>>0)),ue=0,be=(j>>>0)/(B>>>0)>>>0,Ft(ue|0),be|0;if(S=B-1|0,!(S&B))return b|0&&(a[b>>2]=A|0,a[b+4>>2]=S&j|h&0),ue=0,be=j>>>((Qs(B|0)|0)>>>0),Ft(ue|0),be|0;if(S=(xn(B|0)|0)-(xn(j|0)|0)|0,S>>>0<=30){h=S+1|0,B=31-S|0,M=h,A=j<<B|Y>>>(h>>>0),h=j>>>(h>>>0),S=0,B=Y<<B;break}return b?(a[b>>2]=A|0,a[b+4>>2]=V|h&0,ue=0,be=0,Ft(ue|0),be|0):(ue=0,be=0,Ft(ue|0),be|0)}while(0);if(!M)j=B,V=0,B=0;else{ae=d|0|0,Y=ne|x&0,j=Xo(ae|0,Y|0,-1,-1)|0,d=Oe()|0,V=B,B=0;do x=V,V=S>>>31|V<<1,S=B|S<<1,x=A<<1|x>>>31|0,ne=A>>>31|h<<1|0,$r(j|0,d|0,x|0,ne|0)|0,be=Oe()|0,ue=be>>31|((be|0)<0?-1:0)<<1,B=ue&1,A=$r(x|0,ne|0,ue&ae|0,(((be|0)<0?-1:0)>>31|((be|0)<0?-1:0)<<1)&Y|0)|0,h=Oe()|0,M=M-1|0;while(M|0);j=V,V=0}return M=0,b|0&&(a[b>>2]=A,a[b+4>>2]=h),ue=(S|0)>>>31|(j|M)<<1|(M<<1|S>>>31)&0|V,be=(S<<1|0)&-2|B,Ft(ue|0),be|0}function qs(A,h,d,x){A=A|0,h=h|0,d=d|0,x=x|0;var b=0,S=0;return S=De,De=De+16|0,b=S|0,Cs(A,h,d,x,b)|0,De=S,Ft(a[b+4>>2]|0),a[b>>2]|0|0}function Ct(A,h,d){return A=A|0,h=h|0,d=d|0,(d|0)<32?(Ft(h>>>d|0),A>>>d|(h&(1<<d)-1)<<32-d):(Ft(0),h>>>d-32|0)}function Pt(A,h,d){return A=A|0,h=h|0,d=d|0,(d|0)<32?(Ft(h<<d|(A&(1<<d)-1<<32-d)>>>32-d|0),A<<d):(Ft(A<<d-32|0),0)}function jr(A,h){return A=+A,h=+h,A!=A?+h:h!=h?+A:+an(+A,+h)}function rl(A){return A=+A,A>=0?+ke(A+.5):+pn(A-.5)}function Zs(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0;if((d|0)>=8192)return ui(A|0,h|0,d|0)|0,A|0;if(S=A|0,b=A+d|0,(A&3)==(h&3)){for(;A&3;){if(!d)return S|0;he[A>>0]=he[h>>0]|0,A=A+1|0,h=h+1|0,d=d-1|0}for(d=b&-4|0,x=d-64|0;(A|0)<=(x|0);)a[A>>2]=a[h>>2],a[A+4>>2]=a[h+4>>2],a[A+8>>2]=a[h+8>>2],a[A+12>>2]=a[h+12>>2],a[A+16>>2]=a[h+16>>2],a[A+20>>2]=a[h+20>>2],a[A+24>>2]=a[h+24>>2],a[A+28>>2]=a[h+28>>2],a[A+32>>2]=a[h+32>>2],a[A+36>>2]=a[h+36>>2],a[A+40>>2]=a[h+40>>2],a[A+44>>2]=a[h+44>>2],a[A+48>>2]=a[h+48>>2],a[A+52>>2]=a[h+52>>2],a[A+56>>2]=a[h+56>>2],a[A+60>>2]=a[h+60>>2],A=A+64|0,h=h+64|0;for(;(A|0)<(d|0);)a[A>>2]=a[h>>2],A=A+4|0,h=h+4|0}else for(d=b-4|0;(A|0)<(d|0);)he[A>>0]=he[h>>0]|0,he[A+1>>0]=he[h+1>>0]|0,he[A+2>>0]=he[h+2>>0]|0,he[A+3>>0]=he[h+3>>0]|0,A=A+4|0,h=h+4|0;for(;(A|0)<(b|0);)he[A>>0]=he[h>>0]|0,A=A+1|0,h=h+1|0;return S|0}function L(A,h,d){A=A|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if(S=A+d|0,h=h&255,(d|0)>=67){for(;A&3;)he[A>>0]=h,A=A+1|0;for(x=S&-4|0,M=h|h<<8|h<<16|h<<24,b=x-64|0;(A|0)<=(b|0);)a[A>>2]=M,a[A+4>>2]=M,a[A+8>>2]=M,a[A+12>>2]=M,a[A+16>>2]=M,a[A+20>>2]=M,a[A+24>>2]=M,a[A+28>>2]=M,a[A+32>>2]=M,a[A+36>>2]=M,a[A+40>>2]=M,a[A+44>>2]=M,a[A+48>>2]=M,a[A+52>>2]=M,a[A+56>>2]=M,a[A+60>>2]=M,A=A+64|0;for(;(A|0)<(x|0);)a[A>>2]=M,A=A+4|0}for(;(A|0)<(S|0);)he[A>>0]=h,A=A+1|0;return S-d|0}function c(A){return A=+A,A>=0?+ke(A+.5):+pn(A-.5)}function _(A){A=A|0;var h=0,d=0,x=0;return x=un()|0,d=a[Le>>2]|0,h=d+A|0,(A|0)>0&(h|0)<(d|0)|(h|0)<0?(ha(h|0)|0,Ce(12),-1):(h|0)>(x|0)&&!(ir(h|0)|0)?(Ce(12),-1):(a[Le>>2]=h,d|0)}return{___uremdi3:qs,_bitshift64Lshr:Ct,_bitshift64Shl:Pt,_calloc:Ji,_cellAreaKm2:Za,_cellAreaM2:ya,_cellAreaRads2:zl,_compact:pu,_destroyLinkedPolygon:el,_edgeLengthKm:qa,_edgeLengthM:xc,_emscripten_replace_memory:$a,_exactEdgeLengthKm:Fl,_exactEdgeLengthM:mr,_exactEdgeLengthRads:Ol,_experimentalH3ToLocalIj:wa,_experimentalLocalIjToH3:Yo,_free:hn,_geoToH3:Ya,_getDestinationH3IndexFromUnidirectionalEdge:Zo,_getH3IndexesFromUnidirectionalEdge:bo,_getH3UnidirectionalEdge:Ki,_getH3UnidirectionalEdgeBoundary:Ja,_getH3UnidirectionalEdgesFromHexagon:Gl,_getOriginH3IndexFromUnidirectionalEdge:Vl,_getPentagonIndexes:si,_getRes0Indexes:kl,_h3Distance:mu,_h3GetBaseCell:As,_h3GetFaces:va,_h3GetResolution:kA,_h3IndexesAreNeighbors:Ss,_h3IsPentagon:Rr,_h3IsResClassIII:IA,_h3IsValid:du,_h3Line:LA,_h3LineSize:Vt,_h3SetToLinkedGeo:Ir,_h3ToCenterChild:ii,_h3ToChildren:Zr,_h3ToGeo:js,_h3ToGeoBoundary:cs,_h3ToParent:Nl,_h3UnidirectionalEdgeIsValid:Tc,_hexAreaKm2:qo,_hexAreaM2:vc,_hexRing:Ee,_i64Subtract:$r,_kRing:fa,_kRingDistances:Ml,_llvm_minnum_f64:jr,_llvm_round_f64:rl,_malloc:Xt,_maxFaceCount:Ec,_maxH3ToChildrenSize:wc,_maxKringSize:Ha,_maxPolyfillSize:Fe,_maxUncompactSize:bc,_memcpy:Zs,_memset:L,_numHexagons:fu,_pentagonIndexCount:Ka,_pointDistKm:Zn,_pointDistM:wr,_pointDistRads:jn,_polyfill:lt,_res0IndexCount:Pl,_round:c,_sbrk:_,_sizeOfCoordIJ:Ri,_sizeOfGeoBoundary:_u,_sizeOfGeoCoord:Sc,_sizeOfGeoPolygon:xu,_sizeOfGeofence:vu,_sizeOfH3Index:Ph,_sizeOfLinkedGeoPolygon:Ws,_uncompact:$s,establishStackSpace:ja,stackAlloc:we,stackRestore:Es,stackSave:Go}}(bs,yn,Ue);e.___uremdi3=Ye.___uremdi3,e._bitshift64Lshr=Ye._bitshift64Lshr,e._bitshift64Shl=Ye._bitshift64Shl,e._calloc=Ye._calloc,e._cellAreaKm2=Ye._cellAreaKm2,e._cellAreaM2=Ye._cellAreaM2,e._cellAreaRads2=Ye._cellAreaRads2,e._compact=Ye._compact,e._destroyLinkedPolygon=Ye._destroyLinkedPolygon,e._edgeLengthKm=Ye._edgeLengthKm,e._edgeLengthM=Ye._edgeLengthM;var Qr=e._emscripten_replace_memory=Ye._emscripten_replace_memory;e._exactEdgeLengthKm=Ye._exactEdgeLengthKm,e._exactEdgeLengthM=Ye._exactEdgeLengthM,e._exactEdgeLengthRads=Ye._exactEdgeLengthRads,e._experimentalH3ToLocalIj=Ye._experimentalH3ToLocalIj,e._experimentalLocalIjToH3=Ye._experimentalLocalIjToH3,e._free=Ye._free,e._geoToH3=Ye._geoToH3,e._getDestinationH3IndexFromUnidirectionalEdge=Ye._getDestinationH3IndexFromUnidirectionalEdge,e._getH3IndexesFromUnidirectionalEdge=Ye._getH3IndexesFromUnidirectionalEdge,e._getH3UnidirectionalEdge=Ye._getH3UnidirectionalEdge,e._getH3UnidirectionalEdgeBoundary=Ye._getH3UnidirectionalEdgeBoundary,e._getH3UnidirectionalEdgesFromHexagon=Ye._getH3UnidirectionalEdgesFromHexagon,e._getOriginH3IndexFromUnidirectionalEdge=Ye._getOriginH3IndexFromUnidirectionalEdge,e._getPentagonIndexes=Ye._getPentagonIndexes,e._getRes0Indexes=Ye._getRes0Indexes,e._h3Distance=Ye._h3Distance,e._h3GetBaseCell=Ye._h3GetBaseCell,e._h3GetFaces=Ye._h3GetFaces,e._h3GetResolution=Ye._h3GetResolution,e._h3IndexesAreNeighbors=Ye._h3IndexesAreNeighbors,e._h3IsPentagon=Ye._h3IsPentagon,e._h3IsResClassIII=Ye._h3IsResClassIII,e._h3IsValid=Ye._h3IsValid,e._h3Line=Ye._h3Line,e._h3LineSize=Ye._h3LineSize,e._h3SetToLinkedGeo=Ye._h3SetToLinkedGeo,e._h3ToCenterChild=Ye._h3ToCenterChild,e._h3ToChildren=Ye._h3ToChildren,e._h3ToGeo=Ye._h3ToGeo,e._h3ToGeoBoundary=Ye._h3ToGeoBoundary,e._h3ToParent=Ye._h3ToParent,e._h3UnidirectionalEdgeIsValid=Ye._h3UnidirectionalEdgeIsValid,e._hexAreaKm2=Ye._hexAreaKm2,e._hexAreaM2=Ye._hexAreaM2,e._hexRing=Ye._hexRing,e._i64Subtract=Ye._i64Subtract,e._kRing=Ye._kRing,e._kRingDistances=Ye._kRingDistances,e._llvm_minnum_f64=Ye._llvm_minnum_f64,e._llvm_round_f64=Ye._llvm_round_f64,e._malloc=Ye._malloc,e._maxFaceCount=Ye._maxFaceCount,e._maxH3ToChildrenSize=Ye._maxH3ToChildrenSize,e._maxKringSize=Ye._maxKringSize,e._maxPolyfillSize=Ye._maxPolyfillSize,e._maxUncompactSize=Ye._maxUncompactSize,e._memcpy=Ye._memcpy,e._memset=Ye._memset,e._numHexagons=Ye._numHexagons,e._pentagonIndexCount=Ye._pentagonIndexCount,e._pointDistKm=Ye._pointDistKm,e._pointDistM=Ye._pointDistM,e._pointDistRads=Ye._pointDistRads,e._polyfill=Ye._polyfill,e._res0IndexCount=Ye._res0IndexCount,e._round=Ye._round,e._sbrk=Ye._sbrk,e._sizeOfCoordIJ=Ye._sizeOfCoordIJ,e._sizeOfGeoBoundary=Ye._sizeOfGeoBoundary,e._sizeOfGeoCoord=Ye._sizeOfGeoCoord,e._sizeOfGeoPolygon=Ye._sizeOfGeoPolygon,e._sizeOfGeofence=Ye._sizeOfGeofence,e._sizeOfH3Index=Ye._sizeOfH3Index,e._sizeOfLinkedGeoPolygon=Ye._sizeOfLinkedGeoPolygon,e._uncompact=Ye._uncompact,e.establishStackSpace=Ye.establishStackSpace;var Ns=e.stackAlloc=Ye.stackAlloc,Or=e.stackRestore=Ye.stackRestore,Ai=e.stackSave=Ye.stackSave;if(e.asm=Ye,e.cwrap=se,e.setValue=U,e.getValue=W,e.getTempRet0=P,qn){mo(qn)||(qn=s(qn));{Gn();var Xn=function(K){K.byteLength&&(K=new Uint8Array(K)),Ze.set(K,I),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Pi()},Us=function(){l(qn,Xn,function(){throw"could not load memory initializer "+qn})},$i=Lr(qn);if($i)Xn($i.buffer);else if(e.memoryInitializerRequest){var ji=function(){var K=e.memoryInitializerRequest,Q=K.response;if(K.status!==200&&K.status!==0){var te=Lr(e.memoryInitializerRequestURL);if(te)Q=te.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+K.status+", retrying "+qn),Us();return}}Xn(Q)};e.memoryInitializerRequest.response?setTimeout(ji,0):e.memoryInitializerRequest.addEventListener("load",ji)}else Us()}}var Di;ti=function K(){Di||ls(),Di||(ti=K)};function ls(K){if(rr>0||(Vn(),rr>0))return;function Q(){Di||(Di=!0,!H&&(Tr(),wt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),rn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),Q()},1)):Q()}e.run=ls;function Fr(K){throw e.onAbort&&e.onAbort(K),K+="",o(K),p(K),H=!0,"abort("+K+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Fr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return ls(),t}(typeof kt=="object"?kt:{}),Cn="number",Gp=Cn,Fn=Cn,er=Cn,Jo=Cn,xr=Cn,Ige=[["sizeOfH3Index",Cn],["sizeOfGeoCoord",Cn],["sizeOfGeoBoundary",Cn],["sizeOfGeoPolygon",Cn],["sizeOfGeofence",Cn],["sizeOfLinkedGeoPolygon",Cn],["sizeOfCoordIJ",Cn],["h3IsValid",Gp,[Fn,er]],["geoToH3",Fn,[Cn,Cn,Jo]],["h3ToGeo",null,[Fn,er,xr]],["h3ToGeoBoundary",null,[Fn,er,xr]],["maxKringSize",Cn,[Cn]],["kRing",null,[Fn,er,Cn,xr]],["kRingDistances",null,[Fn,er,Cn,xr,xr]],["hexRing",null,[Fn,er,Cn,xr]],["maxPolyfillSize",Cn,[xr,Jo]],["polyfill",null,[xr,Jo,xr]],["h3SetToLinkedGeo",null,[xr,Cn,xr]],["destroyLinkedPolygon",null,[xr]],["compact",Cn,[xr,xr,Cn]],["uncompact",Cn,[xr,Cn,xr,Cn,Jo]],["maxUncompactSize",Cn,[xr,Cn,Jo]],["h3IsPentagon",Gp,[Fn,er]],["h3IsResClassIII",Gp,[Fn,er]],["h3GetBaseCell",Cn,[Fn,er]],["h3GetResolution",Cn,[Fn,er]],["maxFaceCount",Cn,[Fn,er]],["h3GetFaces",null,[Fn,er,xr]],["h3ToParent",Fn,[Fn,er,Jo]],["h3ToChildren",null,[Fn,er,Jo,xr]],["h3ToCenterChild",Fn,[Fn,er,Jo]],["maxH3ToChildrenSize",Cn,[Fn,er,Jo]],["h3IndexesAreNeighbors",Gp,[Fn,er,Fn,er]],["getH3UnidirectionalEdge",Fn,[Fn,er,Fn,er]],["getOriginH3IndexFromUnidirectionalEdge",Fn,[Fn,er]],["getDestinationH3IndexFromUnidirectionalEdge",Fn,[Fn,er]],["h3UnidirectionalEdgeIsValid",Gp,[Fn,er]],["getH3IndexesFromUnidirectionalEdge",null,[Fn,er,xr]],["getH3UnidirectionalEdgesFromHexagon",null,[Fn,er,xr]],["getH3UnidirectionalEdgeBoundary",null,[Fn,er,xr]],["h3Distance",Cn,[Fn,er,Fn,er]],["h3Line",Cn,[Fn,er,Fn,er,xr]],["h3LineSize",Cn,[Fn,er,Fn,er]],["experimentalH3ToLocalIj",Cn,[Fn,er,Fn,er,xr]],["experimentalLocalIjToH3",Cn,[Fn,er,xr,xr]],["hexAreaM2",Cn,[Jo]],["hexAreaKm2",Cn,[Jo]],["edgeLengthM",Cn,[Jo]],["edgeLengthKm",Cn,[Jo]],["pointDistM",Cn,[xr,xr]],["pointDistKm",Cn,[xr,xr]],["pointDistRads",Cn,[xr,xr]],["cellAreaM2",Cn,[Fn,er]],["cellAreaKm2",Cn,[Fn,er]],["cellAreaRads2",Cn,[Fn,er]],["exactEdgeLengthM",Cn,[Fn,er]],["exactEdgeLengthKm",Cn,[Fn,er]],["exactEdgeLengthRads",Cn,[Fn,er]],["numHexagons",Cn,[Jo]],["getRes0Indexes",null,[xr]],["res0IndexCount",Cn],["getPentagonIndexes",null,[Cn,xr]],["pentagonIndexCount",Cn]],on={};Ige.forEach(function(e){on[e[0]]=kt.cwrap.apply(kt,e)});var G0=16,Bo=4,d8=4,xh=8,go=on.sizeOfH3Index(),Mv=on.sizeOfGeoCoord(),i7=on.sizeOfGeoBoundary(),Lge=on.sizeOfGeoPolygon(),xg=on.sizeOfGeofence(),Dge=on.sizeOfLinkedGeoPolygon(),s7=on.sizeOfCoordIJ(),ua={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function Wd(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var Rge=/[^0-9a-fA-F]/;function _r(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||Rge.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),G0),n=parseInt(t.substring(t.length-8),G0);return[n,e]}function p8(t){if(t>=0)return t.toString(G0);t=t&2147483647;var e=o7(8,t.toString(G0)),n=(parseInt(e[0],G0)+8).toString(G0);return e=n+e.substring(1),e}function Pv(t,e){return p8(e)+o7(8,p8(t))}function o7(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function g8(t,e,n){for(var r=t.length,i=kt._calloc(r,Mv),s=n?1:0,l=n?0:1,o=0;o<r*2;o+=2)kt.HEAPF64.set([t[o/2][s],t[o/2][l]].map(kv),i/xh+o);return kt.HEAPU32.set([r,i],e/Bo),e}function Bge(t,e){var n=t.length-1,r=kt._calloc(Lge),i=0,s=i+xg,l=s+Bo;g8(t[0],r+i,e);var o;if(n>0){o=kt._calloc(n,xg);for(var p=0;p<n;p++)g8(t[p+1],o+xg*p,e)}return kt.setValue(r+s,n,"i32"),kt.setValue(r+l,o,"i32"),r}function zge(t){var e=0,n=e+xg,r=n+Bo,i=Bo;kt._free(kt.getValue(t+e+i,"i8*"));var s=kt.getValue(t+n,"i32");if(s>0){for(var l=kt.getValue(t+r,"i32"),o=0;o<s;o++)kt._free(kt.getValue(l+xg*o+i,"i8*"));kt._free(l)}kt._free(t)}function a7(t){var e=kt.getTempRet0();return[t,e]}function Qd(t){var e=a7(t),n=e[0],r=e[1];return r?Pv(n,r):null}function l7(t,e){e===void 0&&(e=0);var n=kt.getValue(t+Bo*e*2,"i32"),r=kt.getValue(t+Bo*(e*2+1),"i32");return r?Pv(n,r):null}function Oge(t,e,n){kt.HEAPU32.set(_r(t),e/Bo+2*n)}function xA(t,e){for(var n=[],r=0;r<e;r++){var i=l7(t,r);i!==null&&n.push(i)}return n}function o4(t,e){for(var n=e.length,r=0;r<n;r++)Oge(e[r],t,r)}function m8(t,e){var n=kt._calloc(1,Mv);return kt.HEAPF64.set([t,e].map(kv),n/xh),n}function L2(t){return h7(kt.getValue(t,"double"))}function a4(t){return[L2(t),L2(t+xh)]}function A7(t){return[L2(t+xh),L2(t)]}function u7(t,e,n){for(var r=kt.getValue(t,"i32"),i=t+xh,s=[],l=e?A7:a4,o=0;o<r*2;o+=2)s.push(l(i+xh*o));return n&&s.push(s[0]),s}function Fge(t,e){for(var n=[],r=e?A7:a4,i,s,l,o;t;){for(n.push(i=[]),s=kt.getValue(t,"i8*");s;){for(i.push(l=[]),o=kt.getValue(s,"i8*");o;)l.push(r(o)),o=kt.getValue(o+xh*2,"i8*");e&&l.push(l[0]),s=kt.getValue(s+d8*2,"i8*")}t=kt.getValue(t+d8*2,"i8*")}return n}function Nge(t){return{i:kt.getValue(t,"i32"),j:kt.getValue(t+Bo,"i32")}}function Uge(t,e){var n=e.i,r=e.j;kt.setValue(t,n,"i32"),kt.setValue(t+Bo,r,"i32")}function Vge(t,e){for(var n=[],r=0;r<e;r++){var i=kt.getValue(t+Bo*r,"i32");i>=0&&n.push(i)}return n}function c7(t){var e=_r(t),n=e[0],r=e[1];return!!on.h3IsValid(n,r)}function Gge(t){var e=_r(t),n=e[0],r=e[1];return!!on.h3IsPentagon(n,r)}function $ge(t){var e=_r(t),n=e[0],r=e[1];return!!on.h3IsResClassIII(n,r)}function jge(t){var e=_r(t),n=e[0],r=e[1];return on.h3GetBaseCell(n,r)}function Hge(t){var e=_r(t),n=e[0],r=e[1],i=on.maxFaceCount(n,r),s=kt._malloc(Bo*i);on.h3GetFaces(n,r,s);var l=Vge(s,i);return kt._free(s),l}function Wge(t){var e=_r(t),n=e[0],r=e[1];return on.h3IsValid(n,r)?on.h3GetResolution(n,r):-1}function Qge(t,e,n){var r=kt._malloc(Mv);kt.HEAPF64.set([t,e].map(kv),r/xh);var i=Qd(on.geoToH3(r,n));return kt._free(r),i}function qge(t){var e=kt._malloc(Mv),n=_r(t),r=n[0],i=n[1];on.h3ToGeo(r,i,e);var s=a4(e);return kt._free(e),s}function Zge(t,e){var n=kt._malloc(i7),r=_r(t),i=r[0],s=r[1];on.h3ToGeoBoundary(i,s,n);var l=u7(n,e,e);return kt._free(n),l}function Yge(t,e){var n=_r(t),r=n[0],i=n[1];return Qd(on.h3ToParent(r,i,e))}function Xge(t,e){if(!c7(t))return[];var n=_r(t),r=n[0],i=n[1],s=on.maxH3ToChildrenSize(r,i,e),l=kt._calloc(s,go);on.h3ToChildren(r,i,e,l);var o=xA(l,s);return kt._free(l),o}function Kge(t,e){var n=_r(t),r=n[0],i=n[1];return Qd(on.h3ToCenterChild(r,i,e))}function Jge(t,e){var n=_r(t),r=n[0],i=n[1],s=on.maxKringSize(e),l=kt._calloc(s,go);on.kRing(r,i,e,l);var o=xA(l,s);return kt._free(l),o}function eme(t,e){var n=_r(t),r=n[0],i=n[1],s=on.maxKringSize(e),l=kt._calloc(s,go),o=kt._calloc(s,Bo);on.kRingDistances(r,i,e,l,o);for(var p=[],w=0;w<e+1;w++)p.push([]);for(var C=0;C<s*2;C+=2){var P=kt.getValue(l+Bo*C,"i32"),I=kt.getValue(l+Bo*(C+1),"i32"),U=kt.getValue(o+Bo*(C/2),"i32");(P!==0||I!==0)&&p[U].push(Pv(P,I))}return kt._free(l),kt._free(o),p}function tme(t,e){var n=e===0?1:6*e,r=kt._calloc(n,go),i=on.hexRing.apply(on,_r(t).concat([e],[r]));if(i!==0)throw kt._free(r),new Error("Failed to get hexRing (encountered a pentagon?)");var s=xA(r,n);return kt._free(r),s}function nme(t,e,n){if(Wd(e),n=!!n,t.length===0||t[0].length===0)return[];typeof t[0][0]=="number"&&(t=[t]);var r=Bge(t,n),i=on.maxPolyfillSize(r,e),s=kt._calloc(i,go);on.polyfill(r,e,s);var l=xA(s,i);return kt._free(s),zge(r),l}function rme(t,e){if(!t||!t.length)return[];var n=t.length,r=kt._calloc(n,go);o4(r,t);var i=kt._calloc(Dge),s=i;on.h3SetToLinkedGeo(r,n,i);var l=Fge(i,e);return on.destroyLinkedPolygon(s),kt._free(s),kt._free(r),l}function ime(t){if(!t||!t.length)return[];var e=t.length,n=kt._calloc(e,go);o4(n,t);var r=kt._calloc(e,go),i=on.compact(n,r,e);if(i!==0)throw kt._free(n),kt._free(r),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var s=xA(r,e);return kt._free(n),kt._free(r),s}function sme(t,e){if(Wd(e),!t||!t.length)return[];var n=t.length,r=kt._calloc(n,go);o4(r,t);var i=on.maxUncompactSize(r,n,e),s=kt._calloc(i,go),l=on.uncompact(r,n,s,i,e);if(l!==0)throw kt._free(r),kt._free(s),new Error("Failed to uncompact (bad resolution?)");var o=xA(s,i);return kt._free(r),kt._free(s),o}function ome(t,e){var n=_r(t),r=n[0],i=n[1],s=_r(e),l=s[0],o=s[1];return!!on.h3IndexesAreNeighbors(r,i,l,o)}function ame(t,e){var n=_r(t),r=n[0],i=n[1],s=_r(e),l=s[0],o=s[1];return Qd(on.getH3UnidirectionalEdge(r,i,l,o))}function lme(t){var e=_r(t),n=e[0],r=e[1];return Qd(on.getOriginH3IndexFromUnidirectionalEdge(n,r))}function Ame(t){var e=_r(t),n=e[0],r=e[1];return Qd(on.getDestinationH3IndexFromUnidirectionalEdge(n,r))}function ume(t){var e=_r(t),n=e[0],r=e[1];return!!on.h3UnidirectionalEdgeIsValid(n,r)}function cme(t){var e=_r(t),n=e[0],r=e[1],i=2,s=kt._calloc(i,go);on.getH3IndexesFromUnidirectionalEdge(n,r,s);var l=xA(s,i);return kt._free(s),l}function hme(t){var e=_r(t),n=e[0],r=e[1],i=6,s=kt._calloc(i,go);on.getH3UnidirectionalEdgesFromHexagon(n,r,s);var l=xA(s,i);return kt._free(s),l}function fme(t,e){var n=kt._malloc(i7),r=_r(t),i=r[0],s=r[1];on.getH3UnidirectionalEdgeBoundary(i,s,n);var l=u7(n,e);return kt._free(n),l}function dme(t,e){var n=_r(t),r=n[0],i=n[1],s=_r(e),l=s[0],o=s[1];return on.h3Distance(r,i,l,o)}function pme(t,e){var n=_r(t),r=n[0],i=n[1],s=_r(e),l=s[0],o=s[1],p=on.h3LineSize(r,i,l,o);if(p<0)throw new Error("Line cannot be calculated");var w=kt._calloc(p,go);on.h3Line(r,i,l,o,w);var C=xA(w,p);return kt._free(w),C}function gme(t,e){var n=kt._malloc(s7),r=on.experimentalH3ToLocalIj.apply(on,_r(t).concat(_r(e),[n])),i=Nge(n);switch(kt._free(n),r){case 0:return i;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function mme(t,e){if(!e||typeof e.i!="number"||typeof e.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var n=kt._malloc(s7),r=kt._malloc(go);Uge(n,e);var i=on.experimentalLocalIjToH3.apply(on,_r(t).concat([n],[r])),s=l7(r);if(kt._free(n),kt._free(r),i!==0)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return s}function yme(t,e,n){var r=m8(t[0],t[1]),i=m8(e[0],e[1]),s;switch(n){case ua.m:s=on.pointDistM(r,i);break;case ua.km:s=on.pointDistKm(r,i);break;case ua.rads:s=on.pointDistRads(r,i);break;default:s=null}if(kt._free(r),kt._free(i),s===null)throw new Error("Unknown unit: "+n);return s}function _me(t,e){var n=_r(t),r=n[0],i=n[1];switch(e){case ua.m2:return on.cellAreaM2(r,i);case ua.km2:return on.cellAreaKm2(r,i);case ua.rads2:return on.cellAreaRads2(r,i);default:throw new Error("Unknown unit: "+e)}}function vme(t,e){var n=_r(t),r=n[0],i=n[1];switch(e){case ua.m:return on.exactEdgeLengthM(r,i);case ua.km:return on.exactEdgeLengthKm(r,i);case ua.rads:return on.exactEdgeLengthRads(r,i);default:throw new Error("Unknown unit: "+e)}}function xme(t,e){switch(Wd(t),e){case ua.m2:return on.hexAreaM2(t);case ua.km2:return on.hexAreaKm2(t);default:throw new Error("Unknown unit: "+e)}}function wme(t,e){switch(Wd(t),e){case ua.m:return on.edgeLengthM(t);case ua.km:return on.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function bme(t){Wd(t);var e=a7(on.numHexagons(t)),n=e[0],r=e[1];return r?r*Math.pow(2,32)+n:n}function Eme(){var t=on.res0IndexCount(),e=kt._malloc(go*t);on.getRes0Indexes(e);var n=xA(e,t);return kt._free(e),n}function Tme(t){Wd(t);var e=on.pentagonIndexCount(),n=kt._malloc(go*e);on.getPentagonIndexes(t,n);var r=xA(n,e);return kt._free(n),r}function kv(t){return t*Math.PI/180}function h7(t){return t*180/Math.PI}const Sme=Object.freeze(Object.defineProperty({__proto__:null,UNITS:ua,cellArea:_me,compact:ime,degsToRads:kv,edgeLength:wme,exactEdgeLength:vme,experimentalH3ToLocalIj:gme,experimentalLocalIjToH3:mme,geoToH3:Qge,getDestinationH3IndexFromUnidirectionalEdge:Ame,getH3IndexesFromUnidirectionalEdge:cme,getH3UnidirectionalEdge:ame,getH3UnidirectionalEdgeBoundary:fme,getH3UnidirectionalEdgesFromHexagon:hme,getOriginH3IndexFromUnidirectionalEdge:lme,getPentagonIndexes:Tme,getRes0Indexes:Eme,h3Distance:dme,h3GetBaseCell:jge,h3GetFaces:Hge,h3GetResolution:Wge,h3IndexToSplitLong:_r,h3IndexesAreNeighbors:ome,h3IsPentagon:Gge,h3IsResClassIII:$ge,h3IsValid:c7,h3Line:pme,h3SetToMultiPolygon:rme,h3ToCenterChild:Kge,h3ToChildren:Xge,h3ToGeo:qge,h3ToGeoBoundary:Zge,h3ToParent:Yge,h3UnidirectionalEdgeIsValid:ume,hexArea:xme,hexRing:tme,kRing:Jge,kRingDistances:eme,numHexagons:bme,pointDist:yme,polyfill:nme,radsToDegs:h7,splitLongToh3Index:Pv,uncompact:sme},Symbol.toStringTag,{value:"Module"})),Cme=w9(Sme);var dm=Cme,Iv="Feature",f7="FeatureCollection",D2="Polygon",l4="MultiPolygon";function d7(t){for(var e=null,n=0;n<t.length;n++)if(e!==null)for(var r=0;r<t[n].length;r++)e.push(t[n][r]);else e=t[n];return Array.from(new Set(e))}function Mme(t){for(var e=0,n=0,r=0,i=t[0],s=0;s<i.length;s++)e+=i[s][0],n+=i[s][1],r++;return[e/r,n/r]}function Pme(t,e){var n=t.features;if(!n)throw new Error("No features found");return d7(n.map(function(r){return p7(r,e)}))}function p7(t,e,n){n===void 0&&(n={});var r=t.type,i=t.geometry,s=i&&i.type;if(r===f7)return Pme(t,e);if(r!==Iv)throw new Error("Unhandled type: "+r);if(s!==D2&&s!==l4)throw new Error("Unhandled geometry type: "+s);var l=s===D2?[i.coordinates]:i.coordinates;return d7(l.map(function(o){var p=dm.polyfill(o,e,!0);if(p.length||!n.ensureOutput)return p;var w=Mme(o),C=w[0],P=w[1];return[dm.geoToH3(P,C,e)]}))}function g7(t,e){e===void 0&&(e={});var n=[dm.h3ToGeoBoundary(t,!0)];return{type:Iv,id:t,properties:e,geometry:{type:D2,coordinates:n}}}function kme(t,e){e===void 0&&(e={});var n=dm.h3SetToMultiPolygon(t,!0),r=n.length>1,i=r?l4:D2,s=r?n:n[0]||[];return{type:Iv,properties:e,geometry:{type:i,coordinates:s}}}function Ime(t,e){e===void 0&&(e={});var n=t.map(function(r){return[dm.h3ToGeoBoundary(r,{geoJson:!0})]});return{type:Iv,properties:e,geometry:{type:l4,coordinates:n}}}function Lme(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r],s=e?e(i):{};n.push(g7(i,s))}return{type:f7,features:n}}var Dme={featureToH3Set:p7,h3ToFeature:g7,h3SetToFeature:kme,h3SetToMultiPolygonFeature:Ime,h3SetToFeatureCollection:Lme},R2=Dme;function jf({dataDeag:t,disabled:e=!1,deagKey:n}){const{current:r}=Ne.useRef(JF(t.features,fe=>fe.properties.id)),[i,s]=Ne.useState(null),[l,o]=Ne.useState({}),[p,w]=Ne.useState([]),[C,P]=Ne.useState({}),[I,U]=Ne.useState({type:"FeatureCollection",features:[]}),[W,H]=Ne.useState({}),[ie,X]=Ne.useState(!1),ee=Ne.useCallback(({object:fe})=>{if(!fe){s(null),o({}),w([]);return}if(!e){if(ie)s(null),o({}),w(fe.properties.id);else if(fe.properties[n]){const me=R2.h3ToFeature(fe.hexId),Se={};for(const He of fe.properties[n]){const Qe=r[He],Ke=I2(me,Qe.geometry);Se[Qe.properties.id]=M2(Ke)/M2(me)}o(Se),s(fe.hexId)}return!0}},[C,ie,e,n]),se=Ne.useCallback(({object:fe},me)=>{if(fe.properties.id==p)return U({type:"FeatureCollection",features:[]}),H({}),P({}),X(!1),!0;if(fe.properties[n]==null)return;if(me.srcEvent.shiftKey)return P(Ke=>({...Ke,[fe.hexId]:fe.properties[n]})),!0;X(!0),s(null),o({}),w(fe.properties.id),P({});const Se={...C,[fe.hexId]:fe.properties[n]};P(Se);const He={},Qe={type:"FeatureCollection",features:[]};for(const Ke in Se)for(const rt of Se[Ke]){const Ue=r[rt],it=R2.h3ToFeature(Ke),Ze=I2(it,Ue.geometry);Qe.features.push({...Ze,properties:{...Ue.properties}}),He[Ue.properties.id]={...Ue.properties}}return H(He),U(Qe),!0},[C,p,ie,n]);return{hoveredHex:i,clickedHexes:C,hoveredGeos:l,selectedGeoJSON:I,selectedGeos:W,hoveredGeoActive:p,onHover:ee,onClick:se,selectionFinalized:ie}}const Ar=n4(tge,Ld),Qn=n4(Jpe,Tl,!0,!1),$p=n4(ege,{});Br().domain([9,14]).range([0,1]).clamp(!0);const sf=ple().domain([new Date("10/31/1921"),new Date("9/30/2021")]).range([0,1199]).invert,zu=0;function A4({speedyCounter:t,curOption:e}){const n=Ne.useRef(),r=Ne.useRef(),i=Ne.useRef({});Ne.useEffect(()=>{n.current=document.querySelector("#main-tooltip"),r.current=document.querySelector("#secondary-tooltip")},[]);const s=Ne.useCallback(w=>{const C=w.properties.Demand[dr[zu]][t],P=-w.properties.UnmetDemand[dr[zu]][t],I=-P-w.properties.UnmetDemandBaseline[t];n.current.classList.add("active"),r.current.classList.add("active"),r.current.innerHTML=`        <div><b>Region ID</b> ${w.properties.id}</div>
        <div><b>Scenario Demand</b> ${C}</div>
        <div><b>Scen. Unmet Demand</b> ${P}</div>
        <div><b>Difference in Unmet Demand</b> ${I}</div>
        <div><b>Land Holder</b> ${od(w)}</div>
      `},[t]),l=Ne.useCallback(w=>{if(r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${T2(sf(t))}</i></div>
      `,w.properties.Demand){const C=w.properties.Demand[dr[zu]][t],P=-w.properties.UnmetDemand[dr[zu]][t],I=-P-w.properties.UnmetDemandBaseline[t];n.current.innerHTML+=`        
          <div><i>${S2[zu]}</i></div>
          <div><b>Region ID</b> ${w.properties.id}</div>
          <div><b>Scenario Demand</b> ${C}</div>
          <div><b>Scen. Unmet Demand</b> ${P}</div>
          <div><b>Difference in Unmet Demand</b> ${I}</div>
          <div><b>Land Holder</b> ${od(w)}</div>
        `}else{const C=w.properties.Groundwater[t];n.current.innerHTML+=`     
          <div><b>Elem ID</b> ${w.properties.id}</div>
          <div><b>Groundwater</b> ${C}</div>
      `}},[t]),o=Ne.useCallback(w=>{const C=w.properties.Demand[dr[zu]][t],P=-w.properties.UnmetDemand[dr[zu]][t],I=-P-w.properties.UnmetDemandBaseline[t],U=w.properties.Groundwater[t],W=w.properties.GroundwaterVar[t],H=w.properties.UnmetDemandVar[dr[zu]][t],ie=kd(w.properties.UnmetDemandBaselineVar[t],H),X=w.properties.DURgs.join(", "),ee=w.properties.GWRgs.join(", ");r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${T2(sf(t))}</i></div>
        <div><i>${S2[zu]}</i></div>
        <div><b>Groundwater</b> ${U}</div>
        <div><b>Scenario Demand</b> ${C}</div>
        <div><b>Scen. Unmet Demand</b> ${P}</div>
        <div><b>Difference in Unmet Demand</b> ${I}</div>
        <div><b>Land Holder</b> ${od(w)}</div>
        <div><b>Variance (GW)</b> ${W}</div>
        <div><b>Var. (Scen. UnmetDem)</b> ${H}</div>
        <div><b>Var. (Difference)</b> ${ie}</div>
        <div><b>Demand Regions</b> ${X}</div>
        <div><b>GW Regions</b> ${ee}</div>
      `},[t]);return{getTooltip:Ne.useCallback(({object:w})=>{if(!w){i.current&&(r.current.classList.remove("active"),_h(i.current)&&n.current.classList.remove("active"),i.current=w),e>1&&(r.current.classList.remove("active"),n.current.classList.remove("active"));return}e<=1&&_h(w)?o(w):e<=1&&Um(w)?s(w):l(w),i.current=w},[t,e])}}let Gm=class extends Bn{renderLayers(){return[new yh({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new mh(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}};Gm.layerName="BaseTerrainLayer";Gm.defaultProps={...Bn.defaultProps};const y8=0;let m7=class extends Bn{renderLayers(){const{curOption:e,speedyCounter:n}=this.props;return[new Ni({id:"GroundwaterGeo",data:r4,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...Ar.groundwater.interpColor(r.properties.Groundwater[n]),255],visible:e==2,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new Ni({id:"UDemGeo",data:El,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...Ar.unmetDemand.interpColor(r.properties.UnmetDemand[dr[y8]][n]),255],visible:e==3,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new Ni({id:"DemDiffGeo",data:El,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...Ar.difference.interpColor(r.properties.UnmetDemand[dr[y8]][n]-r.properties.UnmetDemandBaseline[n]),255],visible:e==4,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0})]}};m7.layerName="BasicGeoLayer";m7.defaultProps={...Bn.defaultProps,autoHighlight:!0};const _8=lA("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),v8=lA("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),x8=lA("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),w8=lA("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t));function Lv({counter:t,displayMonth:e,dataset:n}){const r=(t+9)%12+1,i=Ne.useRef();Ne.useEffect(()=>{i.current=Object.groupBy(cb[n],(w,C)=>sf(C).toLocaleString("default",{year:"numeric"}))},[n]);const s=Br().domain([0,qne(cb[n],w=>w)]).range([40,90]),l=Br().domain([1,12]).range([0,2*Math.PI]),o=yI().radius(w=>s(w)).curve(vI).angle((w,C)=>l((C+9)%12+1)),p=yI().radius(w=>s(w)).curve(vI).angle((w,C)=>l(C%12+1));Ne.useEffect(()=>(mi("#clockContainer").style("visibility","visible"),mi("#pieOutline path").attr("d",mI().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*2)).attr("fill","none").attr("stroke",n=="averageGroundwater"?`rgb(${_8})`:`rgba(${x8}, 1)`),mi("#demandLine path").data([cb[n]]).join("path").attr("d",w=>o(w)).attr("stroke",n=="averageGroundwater"?`rgba(${v8}, 0.3)`:`rgba(${w8}, 0.3)`).attr("stroke-width","0.2").attr("fill","none"),function(){mi("#clockContainer").style("visibility","hidden"),mi("#pie path").attr("d",""),mi("#pieOutline path").attr("d",""),mi("#demandLine path").attr("d",""),mi("#demandLineCur path").attr("d",""),mi("#date").text("")}),[n]),Ne.useEffect(()=>{mi("#pie path").attr("d",mI().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*r/12*2)).attr("fill",n=="averageGroundwater"?`rgb(${_8})`:`rgba(${x8}, 1)`);let w=sf(t);e?mi("#date").html("<b>"+w.toLocaleString("default",{year:"numeric"})+"</b><br/>"+w.toLocaleString("default",{month:"long"})):mi("#date").html("<b>"+w.toLocaleString("default",{year:"numeric"})+"</b>"),Pie("#demandLineCur path").data([i.current[sf(t).toLocaleString("default",{year:"numeric"})]]).join("path").attr("d",C=>p(C)).attr("stroke",n=="averageGroundwater"?`rgba(${v8}, 1)`:`rgba(${w8}, 1)`).attr("stroke-width","2").attr("fill","none")},[n,t])}var Ui=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(K){return e.locateFile?e.locateFile(K,i):i+K}var l;typeof document<"u"&&document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",l=function(Q,te,he){var a=new XMLHttpRequest;a.open("GET",Q,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status==200||a.status==0&&a.response){te(a.response);return}var Le=Lr(Q);if(Le){te(Le.buffer);return}he()},a.onerror=he,a.send(null)};var o=e.print||console.log.bind(console),p=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var w=0,C=function(K){w=K},P=function(){return w},I=8;function U(K,Q,te,he){switch(te=te||"i8",te.charAt(te.length-1)==="*"&&(te="i32"),te){case"i1":it[K>>0]=Q;break;case"i8":it[K>>0]=Q;break;case"i16":yt[K>>1]=Q;break;case"i32":Kt[K>>2]=Q;break;case"i64":ki=[Q>>>0,(Gr=Q,+nr(Gr)>=1?Gr>0?(lr(+vr(Gr/4294967296),4294967295)|0)>>>0:~~+Wn((Gr-+(~~Gr>>>0))/4294967296)>>>0:0)],Kt[K>>2]=ki[0],Kt[K+4>>2]=ki[1];break;case"float":Tt[K>>2]=Q;break;case"double":dn[K>>3]=Q;break;default:Fr("invalid type for setValue: "+te)}}function W(K,Q,te){switch(Q=Q||"i8",Q.charAt(Q.length-1)==="*"&&(Q="i32"),Q){case"i1":return it[K>>0];case"i8":return it[K>>0];case"i16":return yt[K>>1];case"i32":return Kt[K>>2];case"i64":return Kt[K>>2];case"float":return Tt[K>>2];case"double":return dn[K>>3];default:Fr("invalid type for getValue: "+Q)}return null}var H=!1;function ie(K,Q){K||Fr("Assertion failed: "+Q)}function X(K){var Q=e["_"+K];return ie(Q,"Cannot call unknown function "+K+", make sure it is exported"),Q}function ee(K,Q,te,he,a){var G={string:function(dt){var Dt=0;if(dt!=null&&dt!==0){var Rt=(dt.length<<2)+1;Dt=Ns(Rt),Qe(dt,Dt,Rt)}return Dt},array:function(dt){var Dt=Ns(dt.length);return Ke(dt,Dt),Dt}};function Le(dt){return Q==="string"?Se(dt):Q==="boolean"?!!dt:dt}var ke=X(K),Pe=[],Ie=0;if(he)for(var qe=0;qe<he.length;qe++){var At=G[te[qe]];At?(Ie===0&&(Ie=Ai()),Pe[qe]=At(he[qe])):Pe[qe]=he[qe]}var We=ke.apply(null,Pe);return We=Le(We),Ie!==0&&Or(Ie),We}function se(K,Q,te,he){te=te||[];var a=te.every(function(Le){return Le==="number"}),G=Q!=="string";return G&&a&&!he?X(K):function(){return ee(K,Q,te,arguments)}}var fe=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function me(K,Q,te){for(var he=Q+te,a=Q;K[a]&&!(a>=he);)++a;if(a-Q>16&&K.subarray&&fe)return fe.decode(K.subarray(Q,a));for(var G="";Q<a;){var Le=K[Q++];if(!(Le&128)){G+=String.fromCharCode(Le);continue}var ke=K[Q++]&63;if((Le&224)==192){G+=String.fromCharCode((Le&31)<<6|ke);continue}var Pe=K[Q++]&63;if((Le&240)==224?Le=(Le&15)<<12|ke<<6|Pe:Le=(Le&7)<<18|ke<<12|Pe<<6|K[Q++]&63,Le<65536)G+=String.fromCharCode(Le);else{var Ie=Le-65536;G+=String.fromCharCode(55296|Ie>>10,56320|Ie&1023)}}return G}function Se(K,Q){return K?me(Ze,K,Q):""}function He(K,Q,te,he){if(!(he>0))return 0;for(var a=te,G=te+he-1,Le=0;Le<K.length;++Le){var ke=K.charCodeAt(Le);if(ke>=55296&&ke<=57343){var Pe=K.charCodeAt(++Le);ke=65536+((ke&1023)<<10)|Pe&1023}if(ke<=127){if(te>=G)break;Q[te++]=ke}else if(ke<=2047){if(te+1>=G)break;Q[te++]=192|ke>>6,Q[te++]=128|ke&63}else if(ke<=65535){if(te+2>=G)break;Q[te++]=224|ke>>12,Q[te++]=128|ke>>6&63,Q[te++]=128|ke&63}else{if(te+3>=G)break;Q[te++]=240|ke>>18,Q[te++]=128|ke>>12&63,Q[te++]=128|ke>>6&63,Q[te++]=128|ke&63}}return Q[te]=0,te-a}function Qe(K,Q,te){return He(K,Ze,Q,te)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Ke(K,Q){it.set(K,Q)}function rt(K,Q){return K%Q>0&&(K+=Q-K%Q),K}var Ue,it,Ze,yt,Kt,Tt,dn;function _t(K){Ue=K,e.HEAP8=it=new Int8Array(K),e.HEAP16=yt=new Int16Array(K),e.HEAP32=Kt=new Int32Array(K),e.HEAPU8=Ze=new Uint8Array(K),e.HEAPU16=new Uint16Array(K),e.HEAPU32=new Uint32Array(K),e.HEAPF32=Tt=new Float32Array(K),e.HEAPF64=dn=new Float64Array(K)}var Et=5267040,Jt=24128,In=e.TOTAL_MEMORY||33554432;e.buffer?Ue=e.buffer:Ue=new ArrayBuffer(In),In=Ue.byteLength,_t(Ue),Kt[Jt>>2]=Et;function Tn(K){for(;K.length>0;){var Q=K.shift();if(typeof Q=="function"){Q();continue}var te=Q.func;typeof te=="number"?Q.arg===void 0?e.dynCall_v(te):e.dynCall_vi(te,Q.arg):te(Q.arg===void 0?null:Q.arg)}}var Pr=[],tr=[],or=[],hr=[];function Vn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Mn(e.preRun.shift());Tn(Pr)}function Tr(){Tn(tr)}function wt(){Tn(or)}function rn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)xt(e.postRun.shift());Tn(hr)}function Mn(K){Pr.unshift(K)}function xt(K){hr.unshift(K)}var nr=Math.abs,Wn=Math.ceil,vr=Math.floor,lr=Math.min,rr=0,ti=null;function Gn(K){rr++,e.monitorRunDependencies&&e.monitorRunDependencies(rr)}function Pi(K){if(rr--,e.monitorRunDependencies&&e.monitorRunDependencies(rr),rr==0&&ti){var Q=ti;ti=null,Q()}}e.preloadedImages={},e.preloadedAudios={};var qn=null,Vi="data:application/octet-stream;base64,";function mo(K){return String.prototype.startsWith?K.startsWith(Vi):K.indexOf(Vi)===0}var Gr,ki;qn="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var Vo=24144;function os(K){return K}function ht(K){var Q=/\b__Z[\w\d_]+/g;return K.replace(Q,function(te){var he=te;return te===he?te:he+" ["+te+"]"})}function It(){var K=new Error;if(!K.stack){try{throw new Error(0)}catch(Q){K=Q}if(!K.stack)return"(no stack trace available)"}return K.stack.toString()}function Fs(){var K=It();return e.extraStackTrace&&(K+=`
`+e.extraStackTrace()),ht(K)}function wi(K,Q,te,he){Fr("Assertion failed: "+Se(K)+", at: "+[Q?Se(Q):"unknown filename",te,he?Se(he):"unknown function"])}function zn(){return it.length}function Gi(K,Q,te){Ze.set(Ze.subarray(Q,Q+te),K)}function Ii(K){return e.___errno_location&&(Kt[e.___errno_location()>>2]=K),K}function Li(K){Fr("OOM")}function as(K){try{var Q=new ArrayBuffer(K);return Q.byteLength!=K?void 0:(new Int8Array(Q).set(it),Qr(Q),_t(Q),1)}catch{}}function Lt(K){var Q=zn(),te=16777216,he=2147483648-te;if(K>he)return!1;for(var a=16777216,G=Math.max(Q,a);G<K;)G<=536870912?G=rt(2*G,te):G=Math.min(rt((3*G+2147483648)/4,te),he);var Le=as(G);return!!Le}var Sn=typeof atob=="function"?atob:function(K){var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",te="",he,a,G,Le,ke,Pe,Ie,qe=0;K=K.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Le=Q.indexOf(K.charAt(qe++)),ke=Q.indexOf(K.charAt(qe++)),Pe=Q.indexOf(K.charAt(qe++)),Ie=Q.indexOf(K.charAt(qe++)),he=Le<<2|ke>>4,a=(ke&15)<<4|Pe>>2,G=(Pe&3)<<6|Ie,te=te+String.fromCharCode(he),Pe!==64&&(te=te+String.fromCharCode(a)),Ie!==64&&(te=te+String.fromCharCode(G));while(qe<K.length);return te};function bn(K){try{for(var Q=Sn(K),te=new Uint8Array(Q.length),he=0;he<Q.length;++he)te[he]=Q.charCodeAt(he);return te}catch{throw new Error("Converting base64 string to bytes failed.")}}function Lr(K){if(mo(K))return bn(K.slice(Vi.length))}var bs={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},yn={a:Fr,b:C,c:P,d:wi,e:Ii,f:zn,g:Gi,h:Lt,i:Li,j:os,k:ht,l:as,m:It,n:Fs,o:Vo,p:Jt},Ye=function(K,Q,te){"almost asm";var he=new K.Int8Array(te),a=new K.Int32Array(te);new K.Uint8Array(te),new K.Float32Array(te);var G=new K.Float64Array(te),Le=Q.o|0,ke=Q.p|0,Pe=K.Math.floor,Ie=K.Math.abs,qe=K.Math.sqrt,At=K.Math.pow,We=K.Math.cos,dt=K.Math.sin,Dt=K.Math.tan,Rt=K.Math.acos,sn=K.Math.asin,jt=K.Math.atan,pn=K.Math.atan2,qt=K.Math.ceil,an=K.Math.imul,xn=K.Math.min,Ft=K.Math.max,Oe=K.Math.clz32,Mt=Q.b,Ce=Q.c,un=Q.d,ui=Q.e,ir=Q.f,ha=Q.g,De=Q.h,$a=Q.i,we=24160;function Go(y){return he=new Int8Array(y),a=new Int32Array(y),G=new Float64Array(y),te=y,!0}function Es(y){y=y|0;var m=0;return m=we,we=we+y|0,we=we+15&-16,m|0}function ja(){return we|0}function Ha(y){y=y|0,we=y}function fa(y,m){y=y|0,we=y}function Ml(y,m){y=y|0,m=m|0;var v=0,E=0,k=0;return(y|0)<0?(m=2,m|0):(y|0)>13780509?(m=el(15,m)|0,m|0):(v=((y|0)<0)<<31>>31,k=V(y|0,v|0,3,0)|0,E=Ce()|0,v=d(y|0,v|0,1,0)|0,v=V(k|0,E|0,v|0,Ce()|0)|0,v=d(v|0,Ce()|0,1,0)|0,y=Ce()|0,a[m>>2]=v,a[m+4>>2]=y,m=0,m|0)}function da(y,m,v,E){return y=y|0,m=m|0,v=v|0,E=E|0,ni(y,m,v,E,0)|0}function ni(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0,J=0;if(q=we,we=we+16|0,O=q,!(ge(y,m,v,E,k)|0))return E=0,we=q,E|0;do if((v|0)>=0){if((v|0)>13780509){if(R=el(15,O)|0,R|0)break;N=O,O=a[N>>2]|0,N=a[N+4>>2]|0}else R=((v|0)<0)<<31>>31,J=V(v|0,R|0,3,0)|0,N=Ce()|0,R=d(v|0,R|0,1,0)|0,R=V(J|0,N|0,R|0,Ce()|0)|0,R=d(R|0,Ce()|0,1,0)|0,N=Ce()|0,a[O>>2]=R,a[O+4>>2]=N,O=R;if(Te(E|0,0,O<<3|0)|0,k|0){Te(k|0,0,O<<2|0)|0,R=Ee(y,m,v,E,k,O,N,0)|0;break}R=h(O,4)|0,R?(J=Ee(y,m,v,E,R,O,N,0)|0,A(R),R=J):R=13}else R=2;while(0);return J=R,we=q,J|0}function ge(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0;if(Xe=we,we=we+16|0,je=Xe,Be=Xe+8|0,Re=je,a[Re>>2]=y,a[Re+4>>2]=m,(v|0)<0)return Be=2,we=Xe,Be|0;if(R=E,a[R>>2]=y,a[R+4>>2]=m,R=(k|0)!=0,R&&(a[k>>2]=0),mr(y,m)|0)return Be=9,we=Xe,Be|0;a[Be>>2]=0;e:do if((v|0)>=1)if(R)for(le=1,J=0,de=0,Re=1,R=y;;){if(!(J|de)){if(R=Fe(R,m,4,Be,je)|0,R|0)break e;if(m=je,R=a[m>>2]|0,m=a[m+4>>2]|0,mr(R,m)|0){R=9;break e}}if(R=Fe(R,m,a[22384+(de<<2)>>2]|0,Be,je)|0,R|0)break e;if(m=je,R=a[m>>2]|0,m=a[m+4>>2]|0,y=E+(le<<3)|0,a[y>>2]=R,a[y+4>>2]=m,a[k+(le<<2)>>2]=Re,y=J+1|0,O=(y|0)==(Re|0),N=de+1|0,q=(N|0)==6,mr(R,m)|0){R=9;break e}if(Re=Re+(q&O&1)|0,(Re|0)>(v|0)){R=0;break}else le=le+1|0,J=O?0:y,de=O?q?0:N:de}else for(le=1,J=0,de=0,Re=1,R=y;;){if(!(J|de)){if(R=Fe(R,m,4,Be,je)|0,R|0)break e;if(m=je,R=a[m>>2]|0,m=a[m+4>>2]|0,mr(R,m)|0){R=9;break e}}if(R=Fe(R,m,a[22384+(de<<2)>>2]|0,Be,je)|0,R|0)break e;if(m=je,R=a[m>>2]|0,m=a[m+4>>2]|0,y=E+(le<<3)|0,a[y>>2]=R,a[y+4>>2]=m,y=J+1|0,O=(y|0)==(Re|0),N=de+1|0,q=(N|0)==6,mr(R,m)|0){R=9;break e}if(Re=Re+(q&O&1)|0,(Re|0)>(v|0)){R=0;break}else le=le+1|0,J=O?0:y,de=O?q?0:N:de}else R=0;while(0);return Be=R,we=Xe,Be|0}function Ee(y,m,v,E,k,R,O,N){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0,R=R|0,O=O|0,N=N|0;var q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0;if(Xe=we,we=we+16|0,je=Xe+8|0,Be=Xe,q=Y(y|0,m|0,R|0,O|0)|0,le=Ce()|0,de=E+(q<<3)|0,ft=de,ct=a[ft>>2]|0,ft=a[ft+4>>2]|0,J=(ct|0)==(y|0)&(ft|0)==(m|0),!((ct|0)==0&(ft|0)==0|J))do q=d(q|0,le|0,1,0)|0,q=j(q|0,Ce()|0,R|0,O|0)|0,le=Ce()|0,de=E+(q<<3)|0,ct=de,ft=a[ct>>2]|0,ct=a[ct+4>>2]|0,J=(ft|0)==(y|0)&(ct|0)==(m|0);while(!((ft|0)==0&(ct|0)==0|J));if(q=k+(q<<2)|0,J&&(a[q>>2]|0)<=(N|0)||(ct=de,a[ct>>2]=y,a[ct+4>>2]=m,a[q>>2]=N,(N|0)>=(v|0)))return ct=0,we=Xe,ct|0;switch(J=N+1|0,a[je>>2]=0,q=Fe(y,m,2,je,Be)|0,q|0){case 9:{Re=9;break}case 0:{q=Be,q=Ee(a[q>>2]|0,a[q+4>>2]|0,v,E,k,R,O,J)|0,q||(Re=9);break}}e:do if((Re|0)==9){switch(a[je>>2]=0,q=Fe(y,m,3,je,Be)|0,q|0){case 9:break;case 0:{if(q=Be,q=Ee(a[q>>2]|0,a[q+4>>2]|0,v,E,k,R,O,J)|0,q|0)break e;break}default:break e}switch(a[je>>2]=0,q=Fe(y,m,1,je,Be)|0,q|0){case 9:break;case 0:{if(q=Be,q=Ee(a[q>>2]|0,a[q+4>>2]|0,v,E,k,R,O,J)|0,q|0)break e;break}default:break e}switch(a[je>>2]=0,q=Fe(y,m,5,je,Be)|0,q|0){case 9:break;case 0:{if(q=Be,q=Ee(a[q>>2]|0,a[q+4>>2]|0,v,E,k,R,O,J)|0,q|0)break e;break}default:break e}switch(a[je>>2]=0,q=Fe(y,m,4,je,Be)|0,q|0){case 9:break;case 0:{if(q=Be,q=Ee(a[q>>2]|0,a[q+4>>2]|0,v,E,k,R,O,J)|0,q|0)break e;break}default:break e}switch(a[je>>2]=0,q=Fe(y,m,6,je,Be)|0,q|0){case 9:break;case 0:{if(q=Be,q=Ee(a[q>>2]|0,a[q+4>>2]|0,v,E,k,R,O,J)|0,q|0)break e;break}default:break e}return ct=0,we=Xe,ct|0}while(0);return ct=q,we=Xe,ct|0}function Fe(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0;if(v>>>0>6)return k=1,k|0;if(de=(a[E>>2]|0)%6|0,a[E>>2]=de,(de|0)>0){R=0;do v=vo(v)|0,R=R+1|0;while((R|0)<(a[E>>2]|0))}if(de=ne(y|0,m|0,45)|0,Ce()|0,le=de&127,le>>>0>121)return k=5,k|0;q=ii(y,m)|0,R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15;e:do if(!R)J=8;else{for(;;){if(O=(15-R|0)*3|0,N=ne(y|0,m|0,O|0)|0,Ce()|0,N=N&7,(N|0)==7){m=5;break}if(Be=(bi(R)|0)==0,R=R+-1|0,Re=ue(7,0,O|0)|0,m=m&~(Ce()|0),je=ue(a[(Be?432:16)+(N*28|0)+(v<<2)>>2]|0,0,O|0)|0,O=Ce()|0,v=a[(Be?640:224)+(N*28|0)+(v<<2)>>2]|0,y=je|y&~Re,m=O|m,!v){v=0;break e}if(!R){J=8;break e}}return m|0}while(0);(J|0)==8&&(Be=a[848+(le*28|0)+(v<<2)>>2]|0,je=ue(Be|0,0,45)|0,y=je|y,m=Ce()|0|m&-1040385,v=a[4272+(le*28|0)+(v<<2)>>2]|0,(Be&127|0)==127&&(Be=ue(a[848+(le*28|0)+20>>2]|0,0,45)|0,m=Ce()|0|m&-1040385,v=a[4272+(le*28|0)+20>>2]|0,y=$s(Be|y,m)|0,m=Ce()|0,a[E>>2]=(a[E>>2]|0)+1)),N=ne(y|0,m|0,45)|0,Ce()|0,N=N&127;e:do if($n(N)|0){t:do if((ii(y,m)|0)==1){if((le|0)!=(N|0))if(TA(N,a[7696+(le*28|0)>>2]|0)|0){y=IA(y,m)|0,O=1,m=Ce()|0;break}else un(23313,22416,436,22424);switch(q|0){case 3:{y=$s(y,m)|0,m=Ce()|0,a[E>>2]=(a[E>>2]|0)+1,O=0;break t}case 5:{y=IA(y,m)|0,m=Ce()|0,a[E>>2]=(a[E>>2]|0)+5,O=0;break t}case 0:return Be=9,Be|0;default:return Be=1,Be|0}}else O=0;while(0);if((v|0)>0){R=0;do y=pu(y,m)|0,m=Ce()|0,R=R+1|0;while((R|0)!=(v|0))}if((le|0)!=(N|0)){if(!(wA(N)|0)){if((O|0)!=0|(ii(y,m)|0)!=5)break;a[E>>2]=(a[E>>2]|0)+1;break}switch(de&127){case 8:case 118:break e}(ii(y,m)|0)!=3&&(a[E>>2]=(a[E>>2]|0)+1)}}else if((v|0)>0){R=0;do y=$s(y,m)|0,m=Ce()|0,R=R+1|0;while((R|0)!=(v|0))}while(0);return a[E>>2]=((a[E>>2]|0)+v|0)%6|0,Be=k,a[Be>>2]=y,a[Be+4>>2]=m,Be=0,Be|0}function lt(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0,J=0;for(N=we,we=we+16|0,R=N,O=N+8|0,k=(mr(y,m)|0)==0,k=k?1:2;;){if(a[O>>2]=0,J=(Fe(y,m,k,O,R)|0)==0,q=R,J&((a[q>>2]|0)==(v|0)?(a[q+4>>2]|0)==(E|0):0)){y=4;break}if(k=k+1|0,k>>>0>=7){k=7,y=4;break}}return(y|0)==4?(we=N,k|0):0}function bt(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0;if(Be=we,we=we+16|0,Re=Be,je=Be+8|0,de=Re,a[de>>2]=y,a[de+4>>2]=m,!v)return je=E,a[je>>2]=y,a[je+4>>2]=m,je=0,we=Be,je|0;a[je>>2]=0;e:do if(mr(y,m)|0)y=9;else{if(R=(v|0)>0,R){k=0,de=y;do{if(y=Fe(de,m,4,je,Re)|0,y|0)break e;if(m=Re,de=a[m>>2]|0,m=a[m+4>>2]|0,k=k+1|0,mr(de,m)|0){y=9;break e}}while((k|0)<(v|0));if(le=E,a[le>>2]=de,a[le+4>>2]=m,le=v+-1|0,R){J=0,y=1;do{if(k=22384+(J<<2)|0,(J|0)==5)for(O=a[k>>2]|0,R=0,k=y;;){if(y=Re,y=Fe(a[y>>2]|0,a[y+4>>2]|0,O,je,Re)|0,y|0)break e;if((R|0)!=(le|0))if(q=Re,N=a[q>>2]|0,q=a[q+4>>2]|0,y=E+(k<<3)|0,a[y>>2]=N,a[y+4>>2]=q,!(mr(N,q)|0))y=k+1|0;else{y=9;break e}else y=k;if(R=R+1|0,(R|0)>=(v|0))break;k=y}else for(O=Re,q=a[k>>2]|0,N=0,k=y,R=a[O>>2]|0,O=a[O+4>>2]|0;;){if(y=Fe(R,O,q,je,Re)|0,y|0)break e;if(O=Re,R=a[O>>2]|0,O=a[O+4>>2]|0,y=E+(k<<3)|0,a[y>>2]=R,a[y+4>>2]=O,y=k+1|0,mr(R,O)|0){y=9;break e}if(N=N+1|0,(N|0)>=(v|0))break;k=y}J=J+1|0}while(J>>>0<6);y=Re,O=de,k=a[y>>2]|0,R=m,y=a[y+4>>2]|0}else O=de,k=de,R=m,y=m}else O=E,a[O>>2]=y,a[O+4>>2]=m,O=y,k=y,R=m,y=m;y=(O|0)==(k|0)&(R|0)==(y|0)?0:9}while(0);return je=y,we=Be,je|0}function Qt(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0,J=0;if(N=we,we=we+48|0,k=N+16|0,R=N+8|0,O=N,v|0)return O=15,we=N,O|0;if(J=y,q=a[J+4>>2]|0,v=R,a[v>>2]=a[J>>2],a[v+4>>2]=q,Eo(R,k),m=yc(k,m,O)|0,!m){if(v=a[R>>2]|0,R=a[y+8>>2]|0,(R|0)>0){k=a[y+12>>2]|0,m=0;do v=(a[k+(m<<3)>>2]|0)+v|0,m=m+1|0;while((m|0)<(R|0))}m=O,k=a[m>>2]|0,m=a[m+4>>2]|0,R=((v|0)<0)<<31>>31,(m|0)<(R|0)|(m|0)==(R|0)&k>>>0<v>>>0?(m=O,a[m>>2]=v,a[m+4>>2]=R,m=R):v=k,q=d(v|0,m|0,12,0)|0,J=Ce()|0,m=O,a[m>>2]=q,a[m+4>>2]=J,m=E,a[m>>2]=q,a[m+4>>2]=J,m=0}return J=m,we=N,J|0}function Ln(y,m,v,E,k,R,O){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0,R=R|0,O=O|0;var N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,pt=0,vt=0,Pn=0,wn=0,mn=0,_n=0,En=0,Dn=0,ar=0,kn=0,br=0,Yr=0,il=0;if(ar=we,we=we+64|0,mn=ar+48|0,_n=ar+32|0,En=ar+24|0,Gt=ar+8|0,zt=ar,q=a[y>>2]|0,(q|0)<=0)return Dn=0,we=ar,Dn|0;for(pt=y+4|0,vt=mn+8|0,Pn=_n+8|0,wn=Gt+8|0,N=0,ot=0;;){J=a[pt>>2]|0,st=J+(ot<<4)|0,a[mn>>2]=a[st>>2],a[mn+4>>2]=a[st+4>>2],a[mn+8>>2]=a[st+8>>2],a[mn+12>>2]=a[st+12>>2],(ot|0)==(q+-1|0)?(a[_n>>2]=a[J>>2],a[_n+4>>2]=a[J+4>>2],a[_n+8>>2]=a[J+8>>2],a[_n+12>>2]=a[J+12>>2]):(st=J+(ot+1<<4)|0,a[_n>>2]=a[st>>2],a[_n+4>>2]=a[st+4>>2],a[_n+8>>2]=a[st+8>>2],a[_n+12>>2]=a[st+12>>2]),q=Il(mn,_n,E,En)|0;e:do if(q)J=0,N=q;else if(J=En,q=a[J>>2]|0,J=a[J+4>>2]|0,(J|0)>0|(J|0)==0&q>>>0>0){ct=0,st=0;t:for(;;){if(il=+G[mn>>3],ft=x(q|0,J|0,ct|0,st|0)|0,Yr=+(ft>>>0)+4294967296*+(Ce()|0),kn=+(q>>>0)+4294967296*+(J|0),br=+(ct>>>0)+4294967296*+(st|0),G[Gt>>3]=il*Yr/kn+ +G[_n>>3]*br/kn,G[wn>>3]=+G[vt>>3]*Yr/kn+ +G[Pn>>3]*br/kn,q=us(Gt,E,zt)|0,q|0){N=q;break}ft=zt,Xe=a[ft>>2]|0,ft=a[ft+4>>2]|0,Re=Y(Xe|0,ft|0,m|0,v|0)|0,le=Ce()|0,q=O+(Re<<3)|0,de=q,J=a[de>>2]|0,de=a[de+4>>2]|0;n:do if((J|0)==0&(de|0)==0)Je=q,Dn=16;else for(je=0,Be=0;;){if((je|0)>(v|0)|(je|0)==(v|0)&Be>>>0>m>>>0){N=1;break t}if((J|0)==(Xe|0)&(de|0)==(ft|0))break n;if(q=d(Re|0,le|0,1,0)|0,Re=j(q|0,Ce()|0,m|0,v|0)|0,le=Ce()|0,Be=d(Be|0,je|0,1,0)|0,je=Ce()|0,q=O+(Re<<3)|0,de=q,J=a[de>>2]|0,de=a[de+4>>2]|0,(J|0)==0&(de|0)==0){Je=q,Dn=16;break}}while(0);if((Dn|0)==16&&(Dn=0,!((Xe|0)==0&(ft|0)==0))&&(Be=Je,a[Be>>2]=Xe,a[Be+4>>2]=ft,Be=R+(a[k>>2]<<3)|0,a[Be>>2]=Xe,a[Be+4>>2]=ft,Be=k,Be=d(a[Be>>2]|0,a[Be+4>>2]|0,1,0)|0,Xe=Ce()|0,ft=k,a[ft>>2]=Be,a[ft+4>>2]=Xe),ct=d(ct|0,st|0,1,0)|0,st=Ce()|0,J=En,q=a[J>>2]|0,J=a[J+4>>2]|0,!((J|0)>(st|0)|(J|0)==(st|0)&q>>>0>ct>>>0)){J=1;break e}}J=0}else J=1;while(0);if(ot=ot+1|0,!J){Dn=21;break}if(q=a[y>>2]|0,(ot|0)>=(q|0)){N=0,Dn=21;break}}return(Dn|0)==21?(we=ar,N|0):0}function Ir(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,pt=0,vt=0,Pn=0,wn=0,mn=0,_n=0,En=0,Dn=0,ar=0,kn=0,br=0,Yr=0;if(Yr=we,we=we+112|0,Dn=Yr+80|0,q=Yr+72|0,ar=Yr,kn=Yr+56|0,v|0)return br=15,we=Yr,br|0;if(J=y+8|0,br=_((a[J>>2]<<5)+32|0)|0,!br)return br=13,we=Yr,br|0;if(wu(y,br),_n=y,En=a[_n+4>>2]|0,v=q,a[v>>2]=a[_n>>2],a[v+4>>2]=En,Eo(q,Dn),v=yc(Dn,m,ar)|0,v)_n=0,En=0;else{if(v=a[q>>2]|0,R=a[J>>2]|0,(R|0)>0){O=a[y+12>>2]|0,k=0;do v=(a[O+(k<<3)>>2]|0)+v|0,k=k+1|0;while((k|0)!=(R|0));k=v}else k=v;v=ar,R=a[v>>2]|0,v=a[v+4>>2]|0,O=((k|0)<0)<<31>>31,(v|0)<(O|0)|(v|0)==(O|0)&R>>>0<k>>>0?(v=ar,a[v>>2]=k,a[v+4>>2]=O,v=O):k=R,_n=d(k|0,v|0,12,0)|0,En=Ce()|0,v=ar,a[v>>2]=_n,a[v+4>>2]=En,v=0}if(v|0)return A(br),br=v,we=Yr,br|0;if(k=h(_n,8)|0,!k)return A(br),br=13,we=Yr,br|0;if(N=h(_n,8)|0,!N)return A(br),A(k),br=13,we=Yr,br|0;wn=Dn,a[wn>>2]=0,a[wn+4>>2]=0,wn=y,mn=a[wn+4>>2]|0,v=q,a[v>>2]=a[wn>>2],a[v+4>>2]=mn,v=Ln(q,_n,En,m,Dn,k,N)|0;e:do if(v)A(k),A(N),A(br);else{t:do if((a[J>>2]|0)>0){for(O=y+12|0,R=0;v=Ln((a[O>>2]|0)+(R<<3)|0,_n,En,m,Dn,k,N)|0,R=R+1|0,!(v|0);)if((R|0)>=(a[J>>2]|0))break t;A(k),A(N),A(br);break e}while(0);(En|0)>0|(En|0)==0&_n>>>0>0&&Te(N|0,0,_n<<3|0)|0,mn=Dn,wn=a[mn+4>>2]|0;t:do if((wn|0)>0|(wn|0)==0&(a[mn>>2]|0)>>>0>0){pt=k,vt=N,Pn=k,wn=N,mn=k,v=k,Je=k,Gt=N,zt=N,k=N;n:for(;;){for(ft=0,ct=0,st=0,ot=0,R=0,O=0;;){N=ar,q=N+56|0;do a[N>>2]=0,N=N+4|0;while((N|0)<(q|0));if(m=pt+(ft<<3)|0,J=a[m>>2]|0,m=a[m+4>>2]|0,ge(J,m,1,ar,0)|0){N=ar,q=N+56|0;do a[N>>2]=0,N=N+4|0;while((N|0)<(q|0));N=h(7,4)|0,N|0&&(Ee(J,m,1,ar,N,7,0,0)|0,A(N))}for(Xe=0;;){Be=ar+(Xe<<3)|0,je=a[Be>>2]|0,Be=a[Be+4>>2]|0;r:do if((je|0)==0&(Be|0)==0)N=R,q=O;else{if(le=Y(je|0,Be|0,_n|0,En|0)|0,J=Ce()|0,N=E+(le<<3)|0,m=N,q=a[m>>2]|0,m=a[m+4>>2]|0,!((q|0)==0&(m|0)==0)){de=0,Re=0;do{if((de|0)>(En|0)|(de|0)==(En|0)&Re>>>0>_n>>>0)break n;if((q|0)==(je|0)&(m|0)==(Be|0)){N=R,q=O;break r}N=d(le|0,J|0,1,0)|0,le=j(N|0,Ce()|0,_n|0,En|0)|0,J=Ce()|0,Re=d(Re|0,de|0,1,0)|0,de=Ce()|0,N=E+(le<<3)|0,m=N,q=a[m>>2]|0,m=a[m+4>>2]|0}while(!((q|0)==0&(m|0)==0))}(je|0)==0&(Be|0)==0?(N=R,q=O):(wo(je,Be,kn)|0,ba(y,br,kn)|0&&(Re=d(R|0,O|0,1,0)|0,O=Ce()|0,de=N,a[de>>2]=je,a[de+4>>2]=Be,R=vt+(R<<3)|0,a[R>>2]=je,a[R+4>>2]=Be,R=Re),N=R,q=O)}while(0);if(Xe=Xe+1|0,Xe>>>0>=7)break;R=N,O=q}if(ft=d(ft|0,ct|0,1,0)|0,ct=Ce()|0,st=d(st|0,ot|0,1,0)|0,ot=Ce()|0,O=Dn,R=a[O>>2]|0,O=a[O+4>>2]|0,(ot|0)<(O|0)|(ot|0)==(O|0)&st>>>0<R>>>0)R=N,O=q;else break}if((O|0)>0|(O|0)==0&R>>>0>0){R=0,O=0;do ot=pt+(R<<3)|0,a[ot>>2]=0,a[ot+4>>2]=0,R=d(R|0,O|0,1,0)|0,O=Ce()|0,ot=Dn,st=a[ot+4>>2]|0;while((O|0)<(st|0)|((O|0)==(st|0)?R>>>0<(a[ot>>2]|0)>>>0:0))}if(ot=Dn,a[ot>>2]=N,a[ot+4>>2]=q,(q|0)>0|(q|0)==0&N>>>0>0)Xe=k,ft=zt,ct=mn,st=Gt,ot=vt,k=Je,zt=v,Gt=Pn,Je=Xe,v=ft,mn=wn,wn=ct,Pn=st,vt=pt,pt=ot;else break t}A(Pn),A(wn),A(br),v=1;break e}else v=N;while(0);A(br),A(k),A(v),v=0}while(0);return br=v,we=Yr,br|0}function en(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0;if(le=we,we=we+176|0,q=le,(m|0)<1)return Qs(v,0,0),J=0,we=le,J|0;for(N=y,N=ne(a[N>>2]|0,a[N+4>>2]|0,52)|0,Ce()|0,Qs(v,(m|0)>6?m:6,N&15),N=0;E=y+(N<<3)|0,E=pi(a[E>>2]|0,a[E+4>>2]|0,q)|0,!(E|0);){if(E=a[q>>2]|0,(E|0)>0){O=0;do R=q+8+(O<<4)|0,O=O+1|0,E=q+8+(((O|0)%(E|0)|0)<<4)|0,k=jr(v,E,R)|0,k?Ct(v,k)|0:Pt(v,R,E)|0,E=a[q>>2]|0;while((O|0)<(E|0))}if(N=N+1|0,(N|0)>=(m|0)){E=0,J=13;break}}return(J|0)==13?(we=le,E|0):(Cs(v),J=E,we=le,J|0)}function Dr(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0;if(R=we,we=we+32|0,E=R,k=R+16|0,y=en(y,m,k)|0,y|0)return v=y,we=R,v|0;if(a[v>>2]=0,a[v+4>>2]=0,a[v+8>>2]=0,y=qs(k)|0,y|0)do{m=Vt(v)|0;do LA(m,y)|0,O=y+16|0,a[E>>2]=a[O>>2],a[E+4>>2]=a[O+4>>2],a[E+8>>2]=a[O+8>>2],a[E+12>>2]=a[O+12>>2],Ct(k,y)|0,y=rl(k,E)|0;while(y|0);y=qs(k)|0}while(y|0);return Cs(k),y=DA(v)|0,y?($l(v),O=y,we=R,O|0):(O=0,we=R,O|0)}function $n(y){return y=y|0,y>>>0>121?(y=0,y|0):(y=a[7696+(y*28|0)+16>>2]|0,y|0)}function wA(y){return y=y|0,(y|0)==4|(y|0)==117|0}function bA(y){return y=y|0,a[11120+((a[y>>2]|0)*216|0)+((a[y+4>>2]|0)*72|0)+((a[y+8>>2]|0)*24|0)+(a[y+12>>2]<<3)>>2]|0}function EA(y){return y=y|0,a[11120+((a[y>>2]|0)*216|0)+((a[y+4>>2]|0)*72|0)+((a[y+8>>2]|0)*24|0)+(a[y+12>>2]<<3)+4>>2]|0}function iu(y,m){y=y|0,m=m|0,y=7696+(y*28|0)|0,a[m>>2]=a[y>>2],a[m+4>>2]=a[y+4>>2],a[m+8>>2]=a[y+8>>2],a[m+12>>2]=a[y+12>>2]}function su(y,m){y=y|0,m=m|0;var v=0,E=0;if(m>>>0>20)return m=-1,m|0;do if((a[11120+(m*216|0)>>2]|0)!=(y|0))if((a[11120+(m*216|0)+8>>2]|0)!=(y|0))if((a[11120+(m*216|0)+16>>2]|0)!=(y|0))if((a[11120+(m*216|0)+24>>2]|0)!=(y|0))if((a[11120+(m*216|0)+32>>2]|0)!=(y|0))if((a[11120+(m*216|0)+40>>2]|0)!=(y|0))if((a[11120+(m*216|0)+48>>2]|0)!=(y|0))if((a[11120+(m*216|0)+56>>2]|0)!=(y|0))if((a[11120+(m*216|0)+64>>2]|0)!=(y|0))if((a[11120+(m*216|0)+72>>2]|0)!=(y|0))if((a[11120+(m*216|0)+80>>2]|0)!=(y|0))if((a[11120+(m*216|0)+88>>2]|0)!=(y|0))if((a[11120+(m*216|0)+96>>2]|0)!=(y|0))if((a[11120+(m*216|0)+104>>2]|0)!=(y|0))if((a[11120+(m*216|0)+112>>2]|0)!=(y|0))if((a[11120+(m*216|0)+120>>2]|0)!=(y|0))if((a[11120+(m*216|0)+128>>2]|0)!=(y|0))if((a[11120+(m*216|0)+136>>2]|0)==(y|0))y=2,v=1,E=2;else{if((a[11120+(m*216|0)+144>>2]|0)==(y|0)){y=0,v=2,E=0;break}if((a[11120+(m*216|0)+152>>2]|0)==(y|0)){y=0,v=2,E=1;break}if((a[11120+(m*216|0)+160>>2]|0)==(y|0)){y=0,v=2,E=2;break}if((a[11120+(m*216|0)+168>>2]|0)==(y|0)){y=1,v=2,E=0;break}if((a[11120+(m*216|0)+176>>2]|0)==(y|0)){y=1,v=2,E=1;break}if((a[11120+(m*216|0)+184>>2]|0)==(y|0)){y=1,v=2,E=2;break}if((a[11120+(m*216|0)+192>>2]|0)==(y|0)){y=2,v=2,E=0;break}if((a[11120+(m*216|0)+200>>2]|0)==(y|0)){y=2,v=2,E=1;break}if((a[11120+(m*216|0)+208>>2]|0)==(y|0)){y=2,v=2,E=2;break}else y=-1;return y|0}else y=2,v=1,E=1;else y=2,v=1,E=0;else y=1,v=1,E=2;else y=1,v=1,E=1;else y=1,v=1,E=0;else y=0,v=1,E=2;else y=0,v=1,E=1;else y=0,v=1,E=0;else y=2,v=0,E=2;else y=2,v=0,E=1;else y=2,v=0,E=0;else y=1,v=0,E=2;else y=1,v=0,E=1;else y=1,v=0,E=0;else y=0,v=0,E=2;else y=0,v=0,E=1;else y=0,v=0,E=0;while(0);return m=a[11120+(m*216|0)+(v*72|0)+(y*24|0)+(E<<3)+4>>2]|0,m|0}function TA(y,m){return y=y|0,m=m|0,(a[7696+(y*28|0)+20>>2]|0)==(m|0)?(m=1,m|0):(m=(a[7696+(y*28|0)+24>>2]|0)==(m|0),m|0)}function Pl(y,m){return y=y|0,m=m|0,a[848+(y*28|0)+(m<<2)>>2]|0}function kl(y,m){return y=y|0,m=m|0,(a[848+(y*28|0)>>2]|0)==(m|0)?(m=0,m|0):(a[848+(y*28|0)+4>>2]|0)==(m|0)?(m=1,m|0):(a[848+(y*28|0)+8>>2]|0)==(m|0)?(m=2,m|0):(a[848+(y*28|0)+12>>2]|0)==(m|0)?(m=3,m|0):(a[848+(y*28|0)+16>>2]|0)==(m|0)?(m=4,m|0):(a[848+(y*28|0)+20>>2]|0)==(m|0)?(m=5,m|0):((a[848+(y*28|0)+24>>2]|0)==(m|0)?6:7)|0}function SA(){return 122}function CA(y){y=y|0;var m=0,v=0,E=0;m=0;do ue(m|0,0,45)|0,E=Ce()|0|134225919,v=y+(m<<3)|0,a[v>>2]=-1,a[v+4>>2]=E,m=m+1|0;while((m|0)!=122);return 0}function Kn(y){return y=y|0,+G[y+16>>3]<+G[y+24>>3]|0}function ou(y,m){y=y|0,m=m|0;var v=0,E=0,k=0;return v=+G[m>>3],!(v>=+G[y+8>>3])||!(v<=+G[y>>3])?(m=0,m|0):(E=+G[y+16>>3],v=+G[y+24>>3],k=+G[m+8>>3],m=k>=v,y=k<=E&1,E<v?m&&(y=1):m||(y=0),m=(y|0)!=0,m|0)}function yc(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0;Be=we,we=we+288|0,le=Be+264|0,de=Be+96|0,J=Be,N=J,q=N+96|0;do a[N>>2]=0,N=N+4|0;while((N|0)<(q|0));return m=js(m,J)|0,m|0?(je=m,we=Be,je|0):(q=J,J=a[q>>2]|0,q=a[q+4>>2]|0,wo(J,q,le)|0,pi(J,q,de)|0,O=+Vl(le,de+8|0),G[le>>3]=+G[y>>3],q=le+8|0,G[q>>3]=+G[y+16>>3],G[de>>3]=+G[y+8>>3],J=de+8|0,G[J>>3]=+G[y+24>>3],k=+Vl(le,de),ft=+G[q>>3]-+G[J>>3],R=+Ie(+ft),Xe=+G[le>>3]-+G[de>>3],E=+Ie(+Xe),!(ft==0|Xe==0)&&(ft=+be(+R,+E),ft=+qt(+(k*k/+Me(+(ft/+Me(+R,+E)),3)/(O*(O*2.59807621135)*.8))),G[Le>>3]=ft,Re=~~ft>>>0,je=+Ie(ft)>=1?ft>0?~~+xn(+Pe(ft/4294967296),4294967295)>>>0:~~+qt((ft-+(~~ft>>>0))/4294967296)>>>0:0,(a[Le+4>>2]&2146435072|0)!=2146435072)?(de=(Re|0)==0&(je|0)==0,m=v,a[m>>2]=de?1:Re,a[m+4>>2]=de?0:je,m=0):m=1,je=m,we=Be,je|0)}function Il(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0,J=0,le=0;J=we,we=we+288|0,O=J+264|0,N=J+96|0,q=J,k=q,R=k+96|0;do a[k>>2]=0,k=k+4|0;while((k|0)<(R|0));return v=js(v,q)|0,v|0?(E=v,we=J,E|0):(v=q,k=a[v>>2]|0,v=a[v+4>>2]|0,wo(k,v,O)|0,pi(k,v,N)|0,le=+Vl(O,N+8|0),le=+qt(+(+Vl(y,m)/(le*2))),G[Le>>3]=le,v=~~le>>>0,k=+Ie(le)>=1?le>0?~~+xn(+Pe(le/4294967296),4294967295)>>>0:~~+qt((le-+(~~le>>>0))/4294967296)>>>0:0,(a[Le+4>>2]&2146435072|0)==2146435072?(E=1,we=J,E|0):(q=(v|0)==0&(k|0)==0,a[E>>2]=q?1:v,a[E+4>>2]=q?0:k,E=0,we=J,E|0))}function qr(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0,a[y>>2]=m,a[y+4>>2]=v,a[y+8>>2]=E}function $o(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0;de=m+8|0,a[de>>2]=0,q=+G[y>>3],O=+Ie(+q),J=+G[y+8>>3],N=+Ie(+J)/.8660254037844386,O=O+N*.5,v=~~O,y=~~N,O=O-+(v|0),N=N-+(y|0);do if(O<.5)if(O<.3333333333333333)if(a[m>>2]=v,N<(O+1)*.5){a[m+4>>2]=y;break}else{y=y+1|0,a[m+4>>2]=y;break}else if(Re=1-O,y=(!(N<Re)&1)+y|0,a[m+4>>2]=y,Re<=N&N<O*2){v=v+1|0,a[m>>2]=v;break}else{a[m>>2]=v;break}else{if(!(O<.6666666666666666))if(v=v+1|0,a[m>>2]=v,N<O*.5){a[m+4>>2]=y;break}else{y=y+1|0,a[m+4>>2]=y;break}if(N<1-O){if(a[m+4>>2]=y,O*2+-1<N){a[m>>2]=v;break}}else y=y+1|0,a[m+4>>2]=y;v=v+1|0,a[m>>2]=v}while(0);do if(q<0)if(y&1){le=(y+1|0)/2|0,le=x(v|0,((v|0)<0)<<31>>31|0,le|0,((le|0)<0)<<31>>31|0)|0,v=~~(+(v|0)-((+(le>>>0)+4294967296*+(Ce()|0))*2+1)),a[m>>2]=v;break}else{le=(y|0)/2|0,le=x(v|0,((v|0)<0)<<31>>31|0,le|0,((le|0)<0)<<31>>31|0)|0,v=~~(+(v|0)-(+(le>>>0)+4294967296*+(Ce()|0))*2),a[m>>2]=v;break}while(0);le=m+4|0,J<0&&(v=v-((y<<1|1|0)/2|0)|0,a[m>>2]=v,y=0-y|0,a[le>>2]=y),E=y-v|0,(v|0)<0?(k=0-v|0,a[le>>2]=E,a[de>>2]=k,a[m>>2]=0,y=E,v=0):k=0,(y|0)<0&&(v=v-y|0,a[m>>2]=v,k=k-y|0,a[de>>2]=k,a[le>>2]=0,y=0),R=v-k|0,E=y-k|0,(k|0)<0&&(a[m>>2]=R,a[le>>2]=E,a[de>>2]=0,y=E,v=R,k=0),E=(y|0)<(v|0)?y:v,E=(k|0)<(E|0)?k:E,!((E|0)<=0)&&(a[m>>2]=v-E,a[le>>2]=y-E,a[de>>2]=k-E)}function On(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0;m=a[y>>2]|0,O=y+4|0,v=a[O>>2]|0,(m|0)<0&&(v=v-m|0,a[O>>2]=v,R=y+8|0,a[R>>2]=(a[R>>2]|0)-m,a[y>>2]=0,m=0),(v|0)<0?(m=m-v|0,a[y>>2]=m,R=y+8|0,k=(a[R>>2]|0)-v|0,a[R>>2]=k,a[O>>2]=0,v=0):(k=y+8|0,R=k,k=a[k>>2]|0),(k|0)<0&&(m=m-k|0,a[y>>2]=m,v=v-k|0,a[O>>2]=v,a[R>>2]=0,k=0),E=(v|0)<(m|0)?v:m,E=(k|0)<(E|0)?k:E,!((E|0)<=0)&&(a[y>>2]=m-E,a[O>>2]=v-E,a[R>>2]=k-E)}function Ts(y,m){y=y|0,m=m|0;var v=0,E=0;E=a[y+8>>2]|0,v=+((a[y+4>>2]|0)-E|0),G[m>>3]=+((a[y>>2]|0)-E|0)-v*.5,G[m+8>>3]=v*.8660254037844386}function ri(y,m,v){y=y|0,m=m|0,v=v|0,a[v>>2]=(a[m>>2]|0)+(a[y>>2]|0),a[v+4>>2]=(a[m+4>>2]|0)+(a[y+4>>2]|0),a[v+8>>2]=(a[m+8>>2]|0)+(a[y+8>>2]|0)}function yo(y,m,v){y=y|0,m=m|0,v=v|0,a[v>>2]=(a[y>>2]|0)-(a[m>>2]|0),a[v+4>>2]=(a[y+4>>2]|0)-(a[m+4>>2]|0),a[v+8>>2]=(a[y+8>>2]|0)-(a[m+8>>2]|0)}function Ll(y,m){y=y|0,m=m|0;var v=0,E=0;v=an(a[y>>2]|0,m)|0,a[y>>2]=v,v=y+4|0,E=an(a[v>>2]|0,m)|0,a[v>>2]=E,y=y+8|0,m=an(a[y>>2]|0,m)|0,a[y>>2]=m}function jo(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;O=a[y>>2]|0,N=(O|0)<0,E=(a[y+4>>2]|0)-(N?O:0)|0,R=(E|0)<0,k=(R?0-E|0:0)+((a[y+8>>2]|0)-(N?O:0))|0,v=(k|0)<0,y=v?0:k,m=(R?0:E)-(v?k:0)|0,k=(N?0:O)-(R?E:0)-(v?k:0)|0,v=(m|0)<(k|0)?m:k,v=(y|0)<(v|0)?y:v,E=(v|0)>0,y=y-(E?v:0)|0,m=m-(E?v:0)|0;e:do switch(k-(E?v:0)|0){case 0:switch(m|0){case 0:return N=y|0?(y|0)==1?1:7:0,N|0;case 1:return N=y|0?(y|0)==1?3:7:2,N|0;default:break e}case 1:switch(m|0){case 0:return N=y|0?(y|0)==1?5:7:4,N|0;case 1:{if(!y)y=6;else break e;return y|0}default:break e}}while(0);return N=7,N|0}function pa(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;O=y+8|0,k=a[O>>2]|0,R=(a[y>>2]|0)-k|0,N=y+4|0,k=(a[N>>2]|0)-k|0;do if(R>>>0>715827881|k>>>0>715827881){if(v=(R|0)>0,v){if((2147483647-R|0)<(R|0)||(2147483647-(R<<1)|0)<(R|0))return N=1,N|0}else if((-2147483648-R|0)>(R|0)||(-2147483648-(R<<1)|0)>(R|0))return N=1,N|0;if(m=R*3|0,(k|0)>0){if((2147483647-k|0)<(k|0))return N=1,N|0}else if((-2147483648-k|0)>(k|0))return N=1,N|0;if(E=k<<1,(R|0)>-1){if((m|-2147483648|0)>=(k|0))return N=1,N|0}else if((m^-2147483648|0)<(k|0))return N=1,N|0;if(v){if((2147483647-R|0)<(E|0))m=1;else{v=E;break}return m|0}else{if((-2147483648-R|0)>(E|0))m=1;else{v=E;break}return m|0}}else v=k<<1,m=R*3|0;while(0);E=c(+(m-k|0)/7)|0,a[y>>2]=E,k=c(+(v+R|0)/7)|0,a[N>>2]=k,a[O>>2]=0,v=(k|0)<(E|0),m=v?E:k,v=v?k:E;do if((v|0)<0){if((m|0)>0){if((m|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-m|0)>=(v|0)))break;un(23313,22444,355,22455)}if((v|0)==-2147483648|(-2147483648-m|0)>(v|0)&&un(23313,22444,355,22455),(m|0)>-1){if((m|-2147483648|0)<(v|0))break;un(23313,22444,355,22455)}else{if((m^-2147483648|0)>=(v|0))break;un(23313,22444,355,22455)}}while(0);return m=k-E|0,(E|0)<0?(v=0-E|0,a[N>>2]=m,a[O>>2]=v,a[y>>2]=0,E=0):(m=k,v=0),(m|0)<0&&(E=E-m|0,a[y>>2]=E,v=v-m|0,a[O>>2]=v,a[N>>2]=0,m=0),R=E-v|0,k=m-v|0,(v|0)<0?(a[y>>2]=R,a[N>>2]=k,a[O>>2]=0,m=k,k=R,v=0):k=E,E=(m|0)<(k|0)?m:k,E=(v|0)<(E|0)?v:E,(E|0)<=0?(N=0,N|0):(a[y>>2]=k-E,a[N>>2]=m-E,a[O>>2]=v-E,N=0,N|0)}function _o(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;O=y+8|0,k=a[O>>2]|0,R=(a[y>>2]|0)-k|0,N=y+4|0,k=(a[N>>2]|0)-k|0;do if(R>>>0>715827881|k>>>0>715827881){if(v=(R|0)>0,v){if((2147483647-R|0)<(R|0))return N=1,N|0}else if((-2147483648-R|0)>(R|0))return N=1,N|0;if(m=R<<1,(k|0)>0){if((2147483647-k|0)<(k|0)||(2147483647-(k<<1)|0)<(k|0))return N=1,N|0}else if((-2147483648-k|0)>(k|0)||(-2147483648-(k<<1)|0)>(k|0))return N=1,N|0;if(E=k*3|0,v){if((2147483647-m|0)<(k|0))return N=1,N|0}else if((-2147483648-m|0)>(k|0))return N=1,N|0;if((k|0)>-1){if((E|-2147483648|0)<(R|0)){v=E;break}else m=1;return m|0}else{if((E^-2147483648|0)<(R|0))m=1;else{v=E;break}return m|0}}else v=k*3|0,m=R<<1;while(0);E=c(+(m+k|0)/7)|0,a[y>>2]=E,k=c(+(v-R|0)/7)|0,a[N>>2]=k,a[O>>2]=0,v=(k|0)<(E|0),m=v?E:k,v=v?k:E;do if((v|0)<0){if((m|0)>0){if((m|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-m|0)>=(v|0)))break;un(23313,22444,404,22469)}if((v|0)==-2147483648|(-2147483648-m|0)>(v|0)&&un(23313,22444,404,22469),(m|0)>-1){if((m|-2147483648|0)<(v|0))break;un(23313,22444,404,22469)}else{if((m^-2147483648|0)>=(v|0))break;un(23313,22444,404,22469)}}while(0);return m=k-E|0,(E|0)<0?(v=0-E|0,a[N>>2]=m,a[O>>2]=v,a[y>>2]=0,E=0):(m=k,v=0),(m|0)<0&&(E=E-m|0,a[y>>2]=E,v=v-m|0,a[O>>2]=v,a[N>>2]=0,m=0),R=E-v|0,k=m-v|0,(v|0)<0?(a[y>>2]=R,a[N>>2]=k,a[O>>2]=0,m=k,k=R,v=0):k=E,E=(m|0)<(k|0)?m:k,E=(v|0)<(E|0)?v:E,(E|0)<=0?(N=0,N|0):(a[y>>2]=k-E,a[N>>2]=m-E,a[O>>2]=v-E,N=0,N|0)}function MA(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;O=y+8|0,v=a[O>>2]|0,m=(a[y>>2]|0)-v|0,N=y+4|0,v=(a[N>>2]|0)-v|0,E=c(+((m*3|0)-v|0)/7)|0,a[y>>2]=E,m=c(+((v<<1)+m|0)/7)|0,a[N>>2]=m,a[O>>2]=0,v=m-E|0,(E|0)<0?(R=0-E|0,a[N>>2]=v,a[O>>2]=R,a[y>>2]=0,m=v,E=0,v=R):v=0,(m|0)<0&&(E=E-m|0,a[y>>2]=E,v=v-m|0,a[O>>2]=v,a[N>>2]=0,m=0),R=E-v|0,k=m-v|0,(v|0)<0?(a[y>>2]=R,a[N>>2]=k,a[O>>2]=0,m=k,k=R,v=0):k=E,E=(m|0)<(k|0)?m:k,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(a[y>>2]=k-E,a[N>>2]=m-E,a[O>>2]=v-E)}function Wa(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;O=y+8|0,v=a[O>>2]|0,m=(a[y>>2]|0)-v|0,N=y+4|0,v=(a[N>>2]|0)-v|0,E=c(+((m<<1)+v|0)/7)|0,a[y>>2]=E,m=c(+((v*3|0)-m|0)/7)|0,a[N>>2]=m,a[O>>2]=0,v=m-E|0,(E|0)<0?(R=0-E|0,a[N>>2]=v,a[O>>2]=R,a[y>>2]=0,m=v,E=0,v=R):v=0,(m|0)<0&&(E=E-m|0,a[y>>2]=E,v=v-m|0,a[O>>2]=v,a[N>>2]=0,m=0),R=E-v|0,k=m-v|0,(v|0)<0?(a[y>>2]=R,a[N>>2]=k,a[O>>2]=0,m=k,k=R,v=0):k=E,E=(m|0)<(k|0)?m:k,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(a[y>>2]=k-E,a[N>>2]=m-E,a[O>>2]=v-E)}function Ho(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;m=a[y>>2]|0,O=y+4|0,v=a[O>>2]|0,N=y+8|0,E=a[N>>2]|0,k=v+(m*3|0)|0,a[y>>2]=k,v=E+(v*3|0)|0,a[O>>2]=v,m=(E*3|0)+m|0,a[N>>2]=m,E=v-k|0,(k|0)<0?(m=m-k|0,a[O>>2]=E,a[N>>2]=m,a[y>>2]=0,v=E,E=0):E=k,(v|0)<0&&(E=E-v|0,a[y>>2]=E,m=m-v|0,a[N>>2]=m,a[O>>2]=0,v=0),R=E-m|0,k=v-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=k,a[N>>2]=0,E=R,m=0):k=v,v=(k|0)<(E|0)?k:E,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=E-v,a[O>>2]=k-v,a[N>>2]=m-v)}function Hi(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;k=a[y>>2]|0,O=y+4|0,m=a[O>>2]|0,N=y+8|0,v=a[N>>2]|0,E=(m*3|0)+k|0,k=v+(k*3|0)|0,a[y>>2]=k,a[O>>2]=E,m=(v*3|0)+m|0,a[N>>2]=m,v=E-k|0,(k|0)<0?(m=m-k|0,a[O>>2]=v,a[N>>2]=m,a[y>>2]=0,k=0):v=E,(v|0)<0&&(k=k-v|0,a[y>>2]=k,m=m-v|0,a[N>>2]=m,a[O>>2]=0,v=0),R=k-m|0,E=v-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=E,a[N>>2]=0,k=R,m=0):E=v,v=(E|0)<(k|0)?E:k,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=k-v,a[O>>2]=E-v,a[N>>2]=m-v)}function Wi(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0,N=0;(m+-1|0)>>>0>=6||(k=(a[15440+(m*12|0)>>2]|0)+(a[y>>2]|0)|0,a[y>>2]=k,N=y+4|0,E=(a[15440+(m*12|0)+4>>2]|0)+(a[N>>2]|0)|0,a[N>>2]=E,O=y+8|0,m=(a[15440+(m*12|0)+8>>2]|0)+(a[O>>2]|0)|0,a[O>>2]=m,v=E-k|0,(k|0)<0?(m=m-k|0,a[N>>2]=v,a[O>>2]=m,a[y>>2]=0,E=0):(v=E,E=k),(v|0)<0&&(E=E-v|0,a[y>>2]=E,m=m-v|0,a[O>>2]=m,a[N>>2]=0,v=0),R=E-m|0,k=v-m|0,(m|0)<0?(a[y>>2]=R,a[N>>2]=k,a[O>>2]=0,E=R,m=0):k=v,v=(k|0)<(E|0)?k:E,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=E-v,a[N>>2]=k-v,a[O>>2]=m-v))}function au(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;k=a[y>>2]|0,O=y+4|0,m=a[O>>2]|0,N=y+8|0,v=a[N>>2]|0,E=m+k|0,k=v+k|0,a[y>>2]=k,a[O>>2]=E,m=v+m|0,a[N>>2]=m,v=E-k|0,(k|0)<0?(m=m-k|0,a[O>>2]=v,a[N>>2]=m,a[y>>2]=0,E=0):(v=E,E=k),(v|0)<0&&(E=E-v|0,a[y>>2]=E,m=m-v|0,a[N>>2]=m,a[O>>2]=0,v=0),R=E-m|0,k=v-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=k,a[N>>2]=0,E=R,m=0):k=v,v=(k|0)<(E|0)?k:E,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=E-v,a[O>>2]=k-v,a[N>>2]=m-v)}function Dl(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;m=a[y>>2]|0,O=y+4|0,E=a[O>>2]|0,N=y+8|0,v=a[N>>2]|0,k=E+m|0,a[y>>2]=k,E=v+E|0,a[O>>2]=E,m=v+m|0,a[N>>2]=m,v=E-k|0,(k|0)<0?(m=m-k|0,a[O>>2]=v,a[N>>2]=m,a[y>>2]=0,E=0):(v=E,E=k),(v|0)<0&&(E=E-v|0,a[y>>2]=E,m=m-v|0,a[N>>2]=m,a[O>>2]=0,v=0),R=E-m|0,k=v-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=k,a[N>>2]=0,E=R,m=0):k=v,v=(k|0)<(E|0)?k:E,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=E-v,a[O>>2]=k-v,a[N>>2]=m-v)}function vo(y){switch(y=y|0,y|0){case 1:{y=5;break}case 5:{y=4;break}case 4:{y=6;break}case 6:{y=2;break}case 2:{y=3;break}case 3:{y=1;break}}return y|0}function Wo(y){switch(y=y|0,y|0){case 1:{y=3;break}case 3:{y=2;break}case 2:{y=6;break}case 6:{y=4;break}case 4:{y=5;break}case 5:{y=1;break}}return y|0}function _c(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;m=a[y>>2]|0,O=y+4|0,v=a[O>>2]|0,N=y+8|0,E=a[N>>2]|0,k=v+(m<<1)|0,a[y>>2]=k,v=E+(v<<1)|0,a[O>>2]=v,m=(E<<1)+m|0,a[N>>2]=m,E=v-k|0,(k|0)<0?(m=m-k|0,a[O>>2]=E,a[N>>2]=m,a[y>>2]=0,v=E,E=0):E=k,(v|0)<0&&(E=E-v|0,a[y>>2]=E,m=m-v|0,a[N>>2]=m,a[O>>2]=0,v=0),R=E-m|0,k=v-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=k,a[N>>2]=0,E=R,m=0):k=v,v=(k|0)<(E|0)?k:E,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=E-v,a[O>>2]=k-v,a[N>>2]=m-v)}function lu(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;k=a[y>>2]|0,O=y+4|0,m=a[O>>2]|0,N=y+8|0,v=a[N>>2]|0,E=(m<<1)+k|0,k=v+(k<<1)|0,a[y>>2]=k,a[O>>2]=E,m=(v<<1)+m|0,a[N>>2]=m,v=E-k|0,(k|0)<0?(m=m-k|0,a[O>>2]=v,a[N>>2]=m,a[y>>2]=0,k=0):v=E,(v|0)<0&&(k=k-v|0,a[y>>2]=k,m=m-v|0,a[N>>2]=m,a[O>>2]=0,v=0),R=k-m|0,E=v-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=E,a[N>>2]=0,k=R,m=0):E=v,v=(E|0)<(k|0)?E:k,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=k-v,a[O>>2]=E-v,a[N>>2]=m-v)}function Rl(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0,N=0;return O=(a[y>>2]|0)-(a[m>>2]|0)|0,N=(O|0)<0,E=(a[y+4>>2]|0)-(a[m+4>>2]|0)-(N?O:0)|0,R=(E|0)<0,k=(N?0-O|0:0)+(a[y+8>>2]|0)-(a[m+8>>2]|0)+(R?0-E|0:0)|0,y=(k|0)<0,m=y?0:k,v=(R?0:E)-(y?k:0)|0,k=(N?0:O)-(R?E:0)-(y?k:0)|0,y=(v|0)<(k|0)?v:k,y=(m|0)<(y|0)?m:y,E=(y|0)>0,m=m-(E?y:0)|0,v=v-(E?y:0)|0,y=k-(E?y:0)|0,y=(y|0)>-1?y:0-y|0,v=(v|0)>-1?v:0-v|0,m=(m|0)>-1?m:0-m|0,m=(v|0)>(m|0)?v:m,((y|0)>(m|0)?y:m)|0}function PA(y,m){y=y|0,m=m|0;var v=0;v=a[y+8>>2]|0,a[m>>2]=(a[y>>2]|0)-v,a[m+4>>2]=(a[y+4>>2]|0)-v}function Au(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0,N=0;E=a[y>>2]|0,a[m>>2]=E,k=a[y+4>>2]|0,O=m+4|0,a[O>>2]=k,N=m+8|0,a[N>>2]=0,v=(k|0)<(E|0),y=v?E:k,v=v?k:E;do if((v|0)<0){if((y|0)>0){if((y|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-y|0)>=(v|0)))break;return y=1,y|0}if((v|0)==-2147483648|(-2147483648-y|0)>(v|0))return m=1,m|0;if((y|0)>-1){if((y|-2147483648|0)<(v|0))break;return y=1,y|0}else{if((y^-2147483648|0)<(v|0))y=1;else break;return y|0}}while(0);return y=k-E|0,(E|0)<0?(v=0-E|0,a[O>>2]=y,a[N>>2]=v,a[m>>2]=0,E=0):(y=k,v=0),(y|0)<0&&(E=E-y|0,a[m>>2]=E,v=v-y|0,a[N>>2]=v,a[O>>2]=0,y=0),R=E-v|0,k=y-v|0,(v|0)<0?(a[m>>2]=R,a[O>>2]=k,a[N>>2]=0,y=k,k=R,v=0):k=E,E=(y|0)<(k|0)?y:k,E=(v|0)<(E|0)?v:E,(E|0)<=0?(m=0,m|0):(a[m>>2]=k-E,a[O>>2]=y-E,a[N>>2]=v-E,m=0,m|0)}function Qo(y){y=y|0;var m=0,v=0,E=0,k=0;m=y+8|0,k=a[m>>2]|0,v=k-(a[y>>2]|0)|0,a[y>>2]=v,E=y+4|0,y=(a[E>>2]|0)-k|0,a[E>>2]=y,a[m>>2]=0-(y+v)}function Qa(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;v=a[y>>2]|0,m=0-v|0,a[y>>2]=m,O=y+8|0,a[O>>2]=0,N=y+4|0,E=a[N>>2]|0,k=E+v|0,(v|0)>0?(a[N>>2]=k,a[O>>2]=v,a[y>>2]=0,m=0,E=k):v=0,(E|0)<0?(R=m-E|0,a[y>>2]=R,v=v-E|0,a[O>>2]=v,a[N>>2]=0,k=R-v|0,m=0-v|0,(v|0)<0?(a[y>>2]=k,a[N>>2]=m,a[O>>2]=0,E=m,v=0):(E=0,k=R)):k=m,m=(E|0)<(k|0)?E:k,m=(v|0)<(m|0)?v:m,!((m|0)<=0)&&(a[y>>2]=k-m,a[N>>2]=E-m,a[O>>2]=v-m)}function uu(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0,J=0,le=0,de=0;if(de=we,we=we+64|0,le=de,N=de+56|0,!(!0&(m&2013265920|0)==134217728&(!0&(E&2013265920|0)==134217728)))return k=5,we=de,k|0;if((y|0)==(v|0)&(m|0)==(E|0))return a[k>>2]=0,k=0,we=de,k|0;if(O=ne(y|0,m|0,52)|0,Ce()|0,O=O&15,J=ne(v|0,E|0,52)|0,Ce()|0,(O|0)!=(J&15|0))return k=12,we=de,k|0;if(R=O+-1|0,O>>>0>1){Ol(y,m,R,le)|0,Ol(v,E,R,N)|0,J=le,q=a[J>>2]|0,J=a[J+4>>2]|0;e:do if((q|0)==(a[N>>2]|0)&&(J|0)==(a[N+4>>2]|0)){O=(O^15)*3|0,R=ne(y|0,m|0,O|0)|0,Ce()|0,R=R&7,O=ne(v|0,E|0,O|0)|0,Ce()|0,O=O&7;do if((R|0)==0|(O|0)==0)a[k>>2]=1,R=0;else if((R|0)==7)R=5;else{if((R|0)==1|(O|0)==1&&mr(q,J)|0){R=5;break}if((a[15536+(R<<2)>>2]|0)!=(O|0)&&(a[15568+(R<<2)>>2]|0)!=(O|0))break e;a[k>>2]=1,R=0}while(0);return k=R,we=de,k|0}while(0)}R=le,O=R+56|0;do a[R>>2]=0,R=R+4|0;while((R|0)<(O|0));return da(y,m,1,le)|0,m=le,!((a[m>>2]|0)==(v|0)&&(a[m+4>>2]|0)==(E|0))&&(m=le+8|0,!((a[m>>2]|0)==(v|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+16|0,!((a[m>>2]|0)==(v|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+24|0,!((a[m>>2]|0)==(v|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+32|0,!((a[m>>2]|0)==(v|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+40|0,!((a[m>>2]|0)==(v|0)&&(a[m+4>>2]|0)==(E|0)))?(R=le+48|0,R=((a[R>>2]|0)==(v|0)?(a[R+4>>2]|0)==(E|0):0)&1):R=1,a[k>>2]=R,k=0,we=de,k|0}function cu(y,m,v,E,k){return y=y|0,m=m|0,v=v|0,E=E|0,k=k|0,v=lt(y,m,v,E)|0,(v|0)==7?(k=11,k|0):(E=ue(v|0,0,56)|0,m=m&-2130706433|(Ce()|0)|268435456,a[k>>2]=y|E,a[k+4>>2]=m,k=0,k|0)}function xo(y,m,v){return y=y|0,m=m|0,v=v|0,!0&(m&2013265920|0)==268435456?(a[v>>2]=y,a[v+4>>2]=m&-2130706433|134217728,v=0,v|0):(v=6,v|0)}function ga(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0;return k=we,we=we+16|0,E=k,a[E>>2]=0,!0&(m&2013265920|0)==268435456?(R=ne(y|0,m|0,56)|0,Ce()|0,E=Fe(y,m&-2130706433|134217728,R&7,E,v)|0,we=k,E|0):(E=6,we=k,E|0)}function hu(y,m){y=y|0,m=m|0;var v=0;switch(v=ne(y|0,m|0,56)|0,Ce()|0,v&7){case 0:case 7:return v=0,v|0}return v=m&-2130706433|134217728,!(!0&(m&2013265920|0)==268435456)||!0&(m&117440512|0)==16777216&(mr(y,v)|0)!=0?(v=0,v|0):(v=ya(y,v)|0,v|0)}function ma(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0;return k=we,we=we+16|0,E=k,!0&(m&2013265920|0)==268435456?(R=m&-2130706433|134217728,O=v,a[O>>2]=y,a[O+4>>2]=R,a[E>>2]=0,m=ne(y|0,m|0,56)|0,Ce()|0,E=Fe(y,R,m&7,E,v+8|0)|0,we=k,E|0):(E=6,we=k,E|0)}function fr(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0;return k=(mr(y,m)|0)==0,m=m&-2130706433,E=v,a[E>>2]=k?y:0,a[E+4>>2]=k?m|285212672:0,E=v+8|0,a[E>>2]=y,a[E+4>>2]=m|301989888,E=v+16|0,a[E>>2]=y,a[E+4>>2]=m|318767104,E=v+24|0,a[E>>2]=y,a[E+4>>2]=m|335544320,E=v+32|0,a[E>>2]=y,a[E+4>>2]=m|352321536,v=v+40|0,a[v>>2]=y,a[v+4>>2]=m|369098752,0}function Vs(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0;return O=we,we=we+16|0,k=O,R=m&-2130706433|134217728,!0&(m&2013265920|0)==268435456?(E=ne(y|0,m|0,56)|0,Ce()|0,E=Yt(y,R,E&7)|0,(E|0)==-1?(a[v>>2]=0,R=6,we=O,R|0):(Xi(y,R,k)|0&&un(23313,22484,282,22499),m=ne(y|0,m|0,52)|0,Ce()|0,m=m&15,mr(y,R)|0?qo(k,m,E,2,v):fu(k,m,E,2,v),R=0,we=O,R|0)):(R=6,we=O,R|0)}function jn(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0;E=we,we=we+16|0,k=E,Zn(y,m,v,k),$o(k,v+4|0),we=E}function Zn(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0;if(N=we,we=we+16|0,q=N,wr(y,v,q),R=+Rt(+(1-+G[q>>3]*.5)),R<1e-16){a[E>>2]=0,a[E+4>>2]=0,a[E+8>>2]=0,a[E+12>>2]=0,we=N;return}if(q=a[v>>2]|0,k=+G[15920+(q*24|0)>>3],k=+si(k-+si(+Tc(15600+(q<<4)|0,y))),bi(m)|0?O=+si(k+-.3334731722518321):O=k,k=+Dt(+R)/.381966011250105,(m|0)>0){y=0;do k=k*2.6457513110645907,y=y+1|0;while((y|0)!=(m|0))}R=+We(+O)*k,G[E>>3]=R,O=+dt(+O)*k,G[E+8>>3]=O,we=N}function wr(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0;if(R=we,we=we+32|0,k=R,Wl(y,k),a[m>>2]=0,G[v>>3]=5,E=+yr(16400,k),E<+G[v>>3]&&(a[m>>2]=0,G[v>>3]=E),E=+yr(16424,k),E<+G[v>>3]&&(a[m>>2]=1,G[v>>3]=E),E=+yr(16448,k),E<+G[v>>3]&&(a[m>>2]=2,G[v>>3]=E),E=+yr(16472,k),E<+G[v>>3]&&(a[m>>2]=3,G[v>>3]=E),E=+yr(16496,k),E<+G[v>>3]&&(a[m>>2]=4,G[v>>3]=E),E=+yr(16520,k),E<+G[v>>3]&&(a[m>>2]=5,G[v>>3]=E),E=+yr(16544,k),E<+G[v>>3]&&(a[m>>2]=6,G[v>>3]=E),E=+yr(16568,k),E<+G[v>>3]&&(a[m>>2]=7,G[v>>3]=E),E=+yr(16592,k),E<+G[v>>3]&&(a[m>>2]=8,G[v>>3]=E),E=+yr(16616,k),E<+G[v>>3]&&(a[m>>2]=9,G[v>>3]=E),E=+yr(16640,k),E<+G[v>>3]&&(a[m>>2]=10,G[v>>3]=E),E=+yr(16664,k),E<+G[v>>3]&&(a[m>>2]=11,G[v>>3]=E),E=+yr(16688,k),E<+G[v>>3]&&(a[m>>2]=12,G[v>>3]=E),E=+yr(16712,k),E<+G[v>>3]&&(a[m>>2]=13,G[v>>3]=E),E=+yr(16736,k),E<+G[v>>3]&&(a[m>>2]=14,G[v>>3]=E),E=+yr(16760,k),E<+G[v>>3]&&(a[m>>2]=15,G[v>>3]=E),E=+yr(16784,k),E<+G[v>>3]&&(a[m>>2]=16,G[v>>3]=E),E=+yr(16808,k),E<+G[v>>3]&&(a[m>>2]=17,G[v>>3]=E),E=+yr(16832,k),E<+G[v>>3]&&(a[m>>2]=18,G[v>>3]=E),E=+yr(16856,k),!(E<+G[v>>3])){we=R;return}a[m>>2]=19,G[v>>3]=E,we=R}function gr(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0;if(R=+Mc(y),R<1e-16){m=15600+(m<<4)|0,a[k>>2]=a[m>>2],a[k+4>>2]=a[m+4>>2],a[k+8>>2]=a[m+8>>2],a[k+12>>2]=a[m+12>>2];return}if(O=+pn(+ +G[y+8>>3],+ +G[y>>3]),(v|0)>0){y=0;do R=R/2.6457513110645907,y=y+1|0;while((y|0)!=(v|0))}E?(R=R/3,v=(bi(v)|0)==0,R=+jt(+((v?R:R/2.6457513110645907)*.381966011250105))):(R=+jt(+(R*.381966011250105)),bi(v)|0&&(O=+si(O+.3334731722518321))),bo(15600+(m<<4)|0,+si(+G[15920+(m*24|0)>>3]-O),R,k)}function Bl(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0;E=we,we=we+16|0,k=E,Ts(y+4|0,k),gr(k,a[y>>2]|0,m,0,v),we=E}function qo(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,pt=0,vt=0,Pn=0,wn=0,mn=0,_n=0,En=0,Dn=0,ar=0,kn=0;if(Dn=we,we=we+272|0,R=Dn+256|0,st=Dn+240|0,mn=Dn,_n=Dn+224|0,En=Dn+208|0,ot=Dn+176|0,Je=Dn+160|0,Gt=Dn+192|0,zt=Dn+144|0,pt=Dn+128|0,vt=Dn+112|0,Pn=Dn+96|0,wn=Dn+80|0,a[R>>2]=m,a[st>>2]=a[y>>2],a[st+4>>2]=a[y+4>>2],a[st+8>>2]=a[y+8>>2],a[st+12>>2]=a[y+12>>2],vc(st,R,mn),a[k>>2]=0,st=E+v+((E|0)==5&1)|0,(st|0)<=(v|0)){we=Dn;return}q=a[R>>2]|0,J=_n+4|0,le=ot+4|0,de=v+5|0,Re=16880+(q<<2)|0,je=16960+(q<<2)|0,Be=pt+8|0,Xe=vt+8|0,ft=Pn+8|0,ct=En+4|0,N=v;e:for(;;){O=mn+(((N|0)%5|0)<<4)|0,a[En>>2]=a[O>>2],a[En+4>>2]=a[O+4>>2],a[En+8>>2]=a[O+8>>2],a[En+12>>2]=a[O+12>>2];do;while((qa(En,q,0,1)|0)==2);if((N|0)>(v|0)&(bi(m)|0)!=0){if(a[ot>>2]=a[En>>2],a[ot+4>>2]=a[En+4>>2],a[ot+8>>2]=a[En+8>>2],a[ot+12>>2]=a[En+12>>2],Ts(J,Je),E=a[ot>>2]|0,R=a[17040+(E*80|0)+(a[_n>>2]<<2)>>2]|0,a[ot>>2]=a[18640+(E*80|0)+(R*20|0)>>2],O=a[18640+(E*80|0)+(R*20|0)+16>>2]|0,(O|0)>0){y=0;do au(le),y=y+1|0;while((y|0)<(O|0))}switch(O=18640+(E*80|0)+(R*20|0)+4|0,a[Gt>>2]=a[O>>2],a[Gt+4>>2]=a[O+4>>2],a[Gt+8>>2]=a[O+8>>2],Ll(Gt,(a[Re>>2]|0)*3|0),ri(le,Gt,le),On(le),Ts(le,zt),ar=+(a[je>>2]|0),G[pt>>3]=ar*3,G[Be>>3]=0,kn=ar*-1.5,G[vt>>3]=kn,G[Xe>>3]=ar*2.598076211353316,G[Pn>>3]=kn,G[ft>>3]=ar*-2.598076211353316,a[17040+((a[ot>>2]|0)*80|0)+(a[En>>2]<<2)>>2]|0){case 1:{y=vt,E=pt;break}case 3:{y=Pn,E=vt;break}case 2:{y=pt,E=Pn;break}default:{y=12;break e}}Eu(Je,zt,E,y,wn),gr(wn,a[ot>>2]|0,q,1,k+8+(a[k>>2]<<4)|0),a[k>>2]=(a[k>>2]|0)+1}if((N|0)<(de|0)&&(Ts(ct,ot),gr(ot,a[En>>2]|0,q,1,k+8+(a[k>>2]<<4)|0),a[k>>2]=(a[k>>2]|0)+1),a[_n>>2]=a[En>>2],a[_n+4>>2]=a[En+4>>2],a[_n+8>>2]=a[En+8>>2],a[_n+12>>2]=a[En+12>>2],N=N+1|0,(N|0)>=(st|0)){y=3;break}}if((y|0)==3){we=Dn;return}else(y|0)==12&&un(22522,22569,571,22579)}function vc(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0;q=we,we=we+128|0,E=q+64|0,k=q,R=E,O=20240,N=R+60|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));R=k,O=20304,N=R+60|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));N=(bi(a[m>>2]|0)|0)==0,E=N?E:k,k=y+4|0,_c(k),lu(k),bi(a[m>>2]|0)|0&&(Hi(k),a[m>>2]=(a[m>>2]|0)+1),a[v>>2]=a[y>>2],m=v+4|0,ri(k,E,m),On(m),a[v+16>>2]=a[y>>2],m=v+20|0,ri(k,E+12|0,m),On(m),a[v+32>>2]=a[y>>2],m=v+36|0,ri(k,E+24|0,m),On(m),a[v+48>>2]=a[y>>2],m=v+52|0,ri(k,E+36|0,m),On(m),a[v+64>>2]=a[y>>2],v=v+68|0,ri(k,E+48|0,v),On(v),we=q}function qa(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0;if(Be=we,we=we+32|0,Re=Be+12|0,N=Be,je=y+4|0,de=a[16960+(m<<2)>>2]|0,le=(E|0)!=0,de=le?de*3|0:de,k=a[je>>2]|0,J=y+8|0,O=a[J>>2]|0,le){if(R=y+12|0,E=a[R>>2]|0,k=O+k+E|0,(k|0)==(de|0))return je=1,we=Be,je|0;q=R}else q=y+12|0,E=a[q>>2]|0,k=O+k+E|0;if((k|0)<=(de|0))return je=0,we=Be,je|0;do if((E|0)>0){if(E=a[y>>2]|0,(O|0)>0){R=18640+(E*80|0)+60|0,E=y;break}E=18640+(E*80|0)+40|0,v?(qr(Re,de,0,0),yo(je,Re,N),Dl(N),ri(N,Re,je),R=E,E=y):(R=E,E=y)}else R=18640+((a[y>>2]|0)*80|0)+20|0,E=y;while(0);if(a[E>>2]=a[R>>2],k=R+16|0,(a[k>>2]|0)>0){E=0;do au(je),E=E+1|0;while((E|0)<(a[k>>2]|0))}return y=R+4|0,a[Re>>2]=a[y>>2],a[Re+4>>2]=a[y+4>>2],a[Re+8>>2]=a[y+8>>2],m=a[16880+(m<<2)>>2]|0,Ll(Re,le?m*3|0:m),ri(je,Re,je),On(je),le?E=((a[J>>2]|0)+(a[je>>2]|0)+(a[q>>2]|0)|0)==(de|0)?1:2:E=2,je=E,we=Be,je|0}function xc(y,m){y=y|0,m=m|0;var v=0;do v=qa(y,m,0,1)|0;while((v|0)==2);return v|0}function fu(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,pt=0,vt=0,Pn=0,wn=0,mn=0;if(Pn=we,we=we+240|0,R=Pn+224|0,Gt=Pn+208|0,zt=Pn,pt=Pn+192|0,vt=Pn+176|0,ft=Pn+160|0,ct=Pn+144|0,st=Pn+128|0,ot=Pn+112|0,Je=Pn+96|0,a[R>>2]=m,a[Gt>>2]=a[y>>2],a[Gt+4>>2]=a[y+4>>2],a[Gt+8>>2]=a[y+8>>2],a[Gt+12>>2]=a[y+12>>2],Gs(Gt,R,zt),a[k>>2]=0,Xe=E+v+((E|0)==6&1)|0,(Xe|0)<=(v|0)){we=Pn;return}q=a[R>>2]|0,J=v+6|0,le=16960+(q<<2)|0,de=ct+8|0,Re=st+8|0,je=ot+8|0,Be=pt+4|0,O=0,N=v,E=-1;e:for(;;){if(R=(N|0)%6|0,y=zt+(R<<4)|0,a[pt>>2]=a[y>>2],a[pt+4>>2]=a[y+4>>2],a[pt+8>>2]=a[y+8>>2],a[pt+12>>2]=a[y+12>>2],y=O,O=qa(pt,q,0,1)|0,(N|0)>(v|0)&(bi(m)|0)!=0&&(y|0)!=1&&(a[pt>>2]|0)!=(E|0)){switch(Ts(zt+(((R+5|0)%6|0)<<4)+4|0,vt),Ts(zt+(R<<4)+4|0,ft),wn=+(a[le>>2]|0),G[ct>>3]=wn*3,G[de>>3]=0,mn=wn*-1.5,G[st>>3]=mn,G[Re>>3]=wn*2.598076211353316,G[ot>>3]=mn,G[je>>3]=wn*-2.598076211353316,R=a[Gt>>2]|0,a[17040+(R*80|0)+(((E|0)==(R|0)?a[pt>>2]|0:E)<<2)>>2]|0){case 1:{y=st,E=ct;break}case 3:{y=ot,E=st;break}case 2:{y=ct,E=ot;break}default:{y=8;break e}}Eu(vt,ft,E,y,Je),!(Pc(vt,Je)|0)&&!(Pc(ft,Je)|0)&&(gr(Je,a[Gt>>2]|0,q,1,k+8+(a[k>>2]<<4)|0),a[k>>2]=(a[k>>2]|0)+1)}if((N|0)<(J|0)&&(Ts(Be,vt),gr(vt,a[pt>>2]|0,q,1,k+8+(a[k>>2]<<4)|0),a[k>>2]=(a[k>>2]|0)+1),N=N+1|0,(N|0)>=(Xe|0)){y=3;break}else E=a[pt>>2]|0}if((y|0)==3){we=Pn;return}else(y|0)==8&&un(22606,22569,736,22651)}function Gs(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0;q=we,we=we+160|0,E=q+80|0,k=q,R=E,O=20368,N=R+72|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));R=k,O=20448,N=R+72|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));N=(bi(a[m>>2]|0)|0)==0,E=N?E:k,k=y+4|0,_c(k),lu(k),bi(a[m>>2]|0)|0&&(Hi(k),a[m>>2]=(a[m>>2]|0)+1),a[v>>2]=a[y>>2],m=v+4|0,ri(k,E,m),On(m),a[v+16>>2]=a[y>>2],m=v+20|0,ri(k,E+12|0,m),On(m),a[v+32>>2]=a[y>>2],m=v+36|0,ri(k,E+24|0,m),On(m),a[v+48>>2]=a[y>>2],m=v+52|0,ri(k,E+36|0,m),On(m),a[v+64>>2]=a[y>>2],m=v+68|0,ri(k,E+48|0,m),On(m),a[v+80>>2]=a[y>>2],v=v+84|0,ri(k,E+60|0,v),On(v),we=q}function zl(y,m){return y=y|0,m=m|0,m=ne(y|0,m|0,52)|0,Ce()|0,m&15|0}function Za(y,m){return y=y|0,m=m|0,m=ne(y|0,m|0,45)|0,Ce()|0,m&127|0}function ya(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0,N=0;if(!(!0&(m&-16777216|0)==134217728)||(O=ne(y|0,m|0,45)|0,Ce()|0,O=O&127,O>>>0>121))return m=0,m|0;v=ne(y|0,m|0,52)|0,Ce()|0,v=v&15;do if(v|0){for(k=1,E=0;;){if(R=ne(y|0,m|0,(15-k|0)*3|0)|0,Ce()|0,R=R&7,(R|0)!=0&(E^1))if((R|0)==1&($n(O)|0)!=0){N=0,E=13;break}else E=1;if((R|0)==7){N=0,E=13;break}if(k>>>0<v>>>0)k=k+1|0;else{E=9;break}}if((E|0)==9){if((v|0)==15)N=1;else break;return N|0}else if((E|0)==13)return N|0}while(0);for(;;){if(N=ne(y|0,m|0,(14-v|0)*3|0)|0,Ce()|0,!((N&7|0)==7&!0)){N=0,E=13;break}if(v>>>0<14)v=v+1|0;else{N=1,E=13;break}}return(E|0)==13?N|0:0}function Ol(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0;if(R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,v>>>0>15)return E=4,E|0;if((R|0)<(v|0))return E=12,E|0;if((R|0)==(v|0))return a[E>>2]=y,a[E+4>>2]=m,E=0,E|0;if(k=ue(v|0,0,52)|0,k=k|y,y=Ce()|0|m&-15728641,(R|0)>(v|0))do m=ue(7,0,(14-v|0)*3|0)|0,v=v+1|0,k=m|k,y=Ce()|0|y;while((v|0)<(R|0));return a[E>>2]=k,a[E+4>>2]=y,E=0,E|0}function Fl(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0;if(R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,!((v|0)<16&(R|0)<=(v|0)))return E=4,E|0;k=v-R|0,v=ne(y|0,m|0,45)|0,Ce()|0;e:do if(!($n(v&127)|0))v=Ws(7,0,k,((k|0)<0)<<31>>31)|0,k=Ce()|0;else{t:do if(R|0){for(v=1;O=ue(7,0,(15-v|0)*3|0)|0,!!((O&y|0)==0&((Ce()|0)&m|0)==0);)if(v>>>0<R>>>0)v=v+1|0;else break t;v=Ws(7,0,k,((k|0)<0)<<31>>31)|0,k=Ce()|0;break e}while(0);v=Ws(7,0,k,((k|0)<0)<<31>>31)|0,v=V(v|0,Ce()|0,5,0)|0,v=d(v|0,Ce()|0,-5,-1)|0,v=M(v|0,Ce()|0,6,0)|0,v=d(v|0,Ce()|0,1,0)|0,k=Ce()|0}while(0);return O=E,a[O>>2]=v,a[O+4>>2]=k,O=0,O|0}function mr(y,m){y=y|0,m=m|0;var v=0,E=0,k=0;if(k=ne(y|0,m|0,45)|0,Ce()|0,!($n(k&127)|0))return k=0,k|0;k=ne(y|0,m|0,52)|0,Ce()|0,k=k&15;e:do if(!k)v=0;else for(E=1;;){if(v=ne(y|0,m|0,(15-E|0)*3|0)|0,Ce()|0,v=v&7,v|0)break e;if(E>>>0<k>>>0)E=E+1|0;else{v=0;break}}while(0);return k=(v|0)==0&1,k|0}function kA(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0;if(O=we,we=we+16|0,R=O,va(R,y,m,v),m=R,y=a[m>>2]|0,m=a[m+4>>2]|0,(y|0)==0&(m|0)==0)return we=O,0;k=0,v=0;do N=E+(k<<3)|0,a[N>>2]=y,a[N+4>>2]=m,k=d(k|0,v|0,1,0)|0,v=Ce()|0,Ka(R),N=R,y=a[N>>2]|0,m=a[N+4>>2]|0;while(!((y|0)==0&(m|0)==0));return we=O,0}function As(y,m,v,E){return y=y|0,m=m|0,v=v|0,E=E|0,(E|0)<(v|0)?(v=m,E=y,Mt(v|0),E|0):(v=ue(-1,-1,((E-v|0)*3|0)+3|0)|0,E=ue(~v|0,~(Ce()|0)|0,(15-E|0)*3|0)|0,v=~(Ce()|0)&m,E=~E&y,Mt(v|0),E|0)}function du(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0;return k=ne(y|0,m|0,52)|0,Ce()|0,k=k&15,(v|0)<16&(k|0)<=(v|0)?((k|0)<(v|0)&&(k=ue(-1,-1,((v+-1-k|0)*3|0)+3|0)|0,k=ue(~k|0,~(Ce()|0)|0,(15-v|0)*3|0)|0,m=~(Ce()|0)&m,y=~k&y),k=ue(v|0,0,52)|0,v=m&-15728641|(Ce()|0),a[E>>2]=y|k,a[E+4>>2]=v,E=0,E|0):(E=4,E|0)}function Nl(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,pt=0,vt=0;if((v|0)==0&(E|0)==0)return pt=0,pt|0;if(k=y,R=a[k>>2]|0,k=a[k+4>>2]|0,!0&(k&15728640|0)==0){if(!((E|0)>0|(E|0)==0&v>>>0>0)||(pt=m,a[pt>>2]=R,a[pt+4>>2]=k,(v|0)==1&(E|0)==0))return pt=0,pt|0;k=1;do Gt=y+(k<<3)|0,zt=a[Gt+4>>2]|0,pt=m+(k<<3)|0,a[pt>>2]=a[Gt>>2],a[pt+4>>2]=zt,k=k+1|0;while(0<(E|0)|(E|0)==0&k>>>0<v>>>0);return k=0,k|0}if(Je=v<<3,zt=_(Je)|0,!zt)return pt=13,pt|0;if($e(zt|0,y|0,Je|0)|0,Gt=h(v,8)|0,!Gt)return A(zt),pt=13,pt|0;e:do if(v|0){t:for(;;){k=zt,ct=a[k>>2]|0,k=a[k+4>>2]|0,st=ne(ct|0,k|0,52)|0,Ce()|0,st=st&15,ot=st+-1|0,ft=(v|0)>0;n:do if((st|0)!=0&ft){if(je=((v|0)<0)<<31>>31,Be=ue(ot|0,0,52)|0,Xe=Ce()|0,ot>>>0>15){if(!((ct|0)==0&(k|0)==0)){pt=17;break t}for(R=0;;){if(R=R+1|0,(R|0)>=(v|0))break n;if(E=zt+(R<<3)|0,Xe=a[E>>2]|0,E=a[E+4>>2]|0,!((Xe|0)==0&(E|0)==0)){k=E,pt=17;break t}}}for(R=0,y=ct,E=k;;){if(!((y|0)==0&(E|0)==0)){if(!(!0&(E&117440512|0)==0)){pt=22;break t}if(N=ne(y|0,E|0,52)|0,Ce()|0,N=N&15,(N|0)<(ot|0)){k=12,pt=28;break t}if((N|0)!=(ot|0)&&(y=y|Be,E=E&-15728641|Xe,N>>>0>=st>>>0)){O=ot;do Re=ue(7,0,(14-O|0)*3|0)|0,O=O+1|0,y=Re|y,E=Ce()|0|E;while(O>>>0<N>>>0)}if(O=Y(y|0,E|0,v|0,je|0)|0,Ce()|0,J=Gt+(O<<3)|0,N=J,q=a[N>>2]|0,N=a[N+4>>2]|0,(q|0)==0&(N|0)==0)O=J;else for(Re=0;;){if((Re|0)>(v|0)){pt=32;break t}if((q|0)==(y|0)&(N&-117440513|0)==(E|0)){le=ne(q|0,N|0,56)|0,Ce()|0,le=le&7,de=le+1|0,vt=ne(q|0,N|0,45)|0,Ce()|0;r:do if(!($n(vt&127)|0))N=7;else{if(q=ne(q|0,N|0,52)|0,Ce()|0,q=q&15,!q){N=6;break}for(N=1;;){if(vt=ue(7,0,(15-N|0)*3|0)|0,!((vt&y|0)==0&((Ce()|0)&E|0)==0)){N=7;break r}if(N>>>0<q>>>0)N=N+1|0;else{N=6;break}}}while(0);if((le+2|0)>>>0>N>>>0){pt=42;break t}vt=ue(de|0,0,56)|0,E=Ce()|0|E&-117440513,de=J,a[de>>2]=0,a[de+4>>2]=0,y=vt|y}else O=(O+1|0)%(v|0)|0;if(J=Gt+(O<<3)|0,N=J,q=a[N>>2]|0,N=a[N+4>>2]|0,(q|0)==0&(N|0)==0){O=J;break}else Re=Re+1|0}vt=O,a[vt>>2]=y,a[vt+4>>2]=E}if(R=R+1|0,(R|0)>=(v|0))break n;E=zt+(R<<3)|0,y=a[E>>2]|0,E=a[E+4>>2]|0}}while(0);if((v+5|0)>>>0<11){pt=85;break}if(Xe=h((v|0)/6|0,8)|0,!Xe){pt=49;break}n:do if(ft){Re=0,de=0;do{if(N=Gt+(Re<<3)|0,E=N,R=a[E>>2]|0,E=a[E+4>>2]|0,!((R|0)==0&(E|0)==0)){q=ne(R|0,E|0,56)|0,Ce()|0,q=q&7,y=q+1|0,J=E&-117440513,vt=ne(R|0,E|0,45)|0,Ce()|0;r:do if($n(vt&127)|0){if(le=ne(R|0,E|0,52)|0,Ce()|0,le=le&15,le|0)for(O=1;;){if(vt=ue(7,0,(15-O|0)*3|0)|0,!((R&vt|0)==0&(J&(Ce()|0)|0)==0))break r;if(O>>>0<le>>>0)O=O+1|0;else break}E=ue(y|0,0,56)|0,R=E|R,E=Ce()|0|J,y=N,a[y>>2]=R,a[y+4>>2]=E,y=q+2|0}while(0);(y|0)==7&&(vt=Xe+(de<<3)|0,a[vt>>2]=R,a[vt+4>>2]=E&-117440513,de=de+1|0)}Re=Re+1|0}while((Re|0)!=(v|0));if(ft){if(Re=((v|0)<0)<<31>>31,je=ue(ot|0,0,52)|0,Be=Ce()|0,ot>>>0>15){if(!((ct|0)==0&(k|0)==0)){k=4,pt=84;break t}for(k=0;;){if(k=k+1|0,(k|0)>=(v|0)){R=0,k=de;break n}if(vt=zt+(k<<3)|0,!((a[vt>>2]|0)==0&(a[vt+4>>2]|0)==0)){k=4,pt=84;break t}}}for(le=0,R=0,J=ct;;){do if(!((J|0)==0&(k|0)==0)){if(N=ne(J|0,k|0,52)|0,Ce()|0,N=N&15,(N|0)<(ot|0)){k=12,pt=84;break t}do if((N|0)==(ot|0))E=J,N=k;else{if(E=J|je,y=k&-15728641|Be,N>>>0<st>>>0){N=y;break}O=ot;do vt=ue(7,0,(14-O|0)*3|0)|0,O=O+1|0,E=vt|E,y=Ce()|0|y;while(O>>>0<N>>>0);N=y}while(0);for(O=Y(E|0,N|0,v|0,Re|0)|0,Ce()|0,y=0;;){if((y|0)>(v|0)){pt=77;break t}if(vt=Gt+(O<<3)|0,q=a[vt+4>>2]|0,(q&-117440513|0)==(N|0)&&(a[vt>>2]|0)==(E|0)){pt=79;break}if(O=(O+1|0)%(v|0)|0,vt=Gt+(O<<3)|0,(a[vt>>2]|0)==(E|0)&&(a[vt+4>>2]|0)==(N|0))break;y=y+1|0}if((pt|0)==79&&(pt=0,!0&(q&117440512|0)==100663296))break;vt=m+(R<<3)|0,a[vt>>2]=J,a[vt+4>>2]=k,R=R+1|0}while(0);if(k=le+1|0,(k|0)>=(v|0)){k=de;break n}vt=zt+(k<<3)|0,le=k,J=a[vt>>2]|0,k=a[vt+4>>2]|0}}else R=0,k=de}else R=0,k=0;while(0);if(Te(Gt|0,0,Je|0)|0,$e(zt|0,Xe|0,k<<3|0)|0,A(Xe),k)m=m+(R<<3)|0,v=k;else break e}if((pt|0)==17)!0&(k&117440512|0)==0?(k=4,pt=28):pt=22;else if((pt|0)==32)un(23313,22674,362,22684);else{if((pt|0)==42)return A(zt),A(Gt),vt=10,vt|0;if((pt|0)==49)return A(zt),A(Gt),vt=13,vt|0;if((pt|0)==77)un(23313,22674,462,22684);else{if((pt|0)==84)return A(Xe),A(zt),A(Gt),vt=k,vt|0;if((pt|0)==85){$e(m|0,zt|0,v<<3|0)|0;break}}}if((pt|0)==22)return A(zt),A(Gt),vt=5,vt|0;if((pt|0)==28)return A(zt),A(Gt),vt=k,vt|0}while(0);return A(zt),A(Gt),vt=0,vt|0}function wc(y,m,v,E,k,R,O){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0,R=R|0,O=O|0;var N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0;if(Xe=we,we=we+16|0,Be=Xe,!((v|0)>0|(v|0)==0&m>>>0>0))return Be=0,we=Xe,Be|0;if((O|0)>=16)return Be=12,we=Xe,Be|0;Re=0,je=0,de=0,N=0;e:for(;;){if(J=y+(Re<<3)|0,q=a[J>>2]|0,J=a[J+4>>2]|0,le=ne(q|0,J|0,52)|0,Ce()|0,(le&15|0)>(O|0)){N=12,q=11;break}if(va(Be,q,J,O),le=Be,J=a[le>>2]|0,le=a[le+4>>2]|0,(J|0)==0&(le|0)==0)q=de;else{q=de;do{if(!((N|0)<(R|0)|(N|0)==(R|0)&q>>>0<k>>>0)){q=10;break e}de=E+(q<<3)|0,a[de>>2]=J,a[de+4>>2]=le,q=d(q|0,N|0,1,0)|0,N=Ce()|0,Ka(Be),de=Be,J=a[de>>2]|0,le=a[de+4>>2]|0}while(!((J|0)==0&(le|0)==0))}if(Re=d(Re|0,je|0,1,0)|0,je=Ce()|0,(je|0)<(v|0)|(je|0)==(v|0)&Re>>>0<m>>>0)de=q;else{N=0,q=11;break}}return(q|0)==10?(Be=14,we=Xe,Be|0):(q|0)==11?(we=Xe,N|0):0}function Zr(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0;Re=we,we=we+16|0,de=Re;e:do if((v|0)>0|(v|0)==0&m>>>0>0){for(J=0,O=0,R=0,le=0;;){if(q=y+(J<<3)|0,N=a[q>>2]|0,q=a[q+4>>2]|0,!((N|0)==0&(q|0)==0)&&(q=(Fl(N,q,E,de)|0)==0,N=de,O=d(a[N>>2]|0,a[N+4>>2]|0,O|0,R|0)|0,R=Ce()|0,!q)){R=12;break}if(J=d(J|0,le|0,1,0)|0,le=Ce()|0,!((le|0)<(v|0)|(le|0)==(v|0)&J>>>0<m>>>0))break e}return we=Re,R|0}else O=0,R=0;while(0);return a[k>>2]=O,a[k+4>>2]=R,k=0,we=Re,k|0}function Rr(y,m){return y=y|0,m=m|0,m=ne(y|0,m|0,52)|0,Ce()|0,m&1|0}function ii(y,m){y=y|0,m=m|0;var v=0,E=0,k=0;if(k=ne(y|0,m|0,52)|0,Ce()|0,k=k&15,!k)return k=0,k|0;for(E=1;;){if(v=ne(y|0,m|0,(15-E|0)*3|0)|0,Ce()|0,v=v&7,v|0){E=5;break}if(E>>>0<k>>>0)E=E+1|0;else{v=0,E=5;break}}return(E|0)==5?v|0:0}function pu(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0,N=0,q=0;if(q=ne(y|0,m|0,52)|0,Ce()|0,q=q&15,!q)return N=m,q=y,Mt(N|0),q|0;for(N=1,v=0;;){R=(15-N|0)*3|0,E=ue(7,0,R|0)|0,k=Ce()|0,O=ne(y|0,m|0,R|0)|0,Ce()|0,R=ue(vo(O&7)|0,0,R|0)|0,O=Ce()|0,y=R|y&~E,m=O|m&~k;e:do if(!v)if((R&E|0)==0&(O&k|0)==0)v=0;else if(E=ne(y|0,m|0,52)|0,Ce()|0,E=E&15,!E)v=1;else{v=1;t:for(;;){switch(O=ne(y|0,m|0,(15-v|0)*3|0)|0,Ce()|0,O&7){case 1:break t;case 0:break;default:{v=1;break e}}if(v>>>0<E>>>0)v=v+1|0;else{v=1;break e}}for(v=1;;)if(O=(15-v|0)*3|0,k=ne(y|0,m|0,O|0)|0,Ce()|0,R=ue(7,0,O|0)|0,m=m&~(Ce()|0),O=ue(vo(k&7)|0,0,O|0)|0,y=y&~R|O,m=m|(Ce()|0),v>>>0<E>>>0)v=v+1|0;else{v=1;break}}while(0);if(N>>>0<q>>>0)N=N+1|0;else break}return Mt(m|0),y|0}function $s(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0;if(E=ne(y|0,m|0,52)|0,Ce()|0,E=E&15,!E)return v=m,E=y,Mt(v|0),E|0;for(v=1;R=(15-v|0)*3|0,O=ne(y|0,m|0,R|0)|0,Ce()|0,k=ue(7,0,R|0)|0,m=m&~(Ce()|0),R=ue(vo(O&7)|0,0,R|0)|0,y=R|y&~k,m=Ce()|0|m,v>>>0<E>>>0;)v=v+1|0;return Mt(m|0),y|0}function bc(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0,N=0,q=0;if(q=ne(y|0,m|0,52)|0,Ce()|0,q=q&15,!q)return N=m,q=y,Mt(N|0),q|0;for(N=1,v=0;;){R=(15-N|0)*3|0,E=ue(7,0,R|0)|0,k=Ce()|0,O=ne(y|0,m|0,R|0)|0,Ce()|0,R=ue(Wo(O&7)|0,0,R|0)|0,O=Ce()|0,y=R|y&~E,m=O|m&~k;e:do if(!v)if((R&E|0)==0&(O&k|0)==0)v=0;else if(E=ne(y|0,m|0,52)|0,Ce()|0,E=E&15,!E)v=1;else{v=1;t:for(;;){switch(O=ne(y|0,m|0,(15-v|0)*3|0)|0,Ce()|0,O&7){case 1:break t;case 0:break;default:{v=1;break e}}if(v>>>0<E>>>0)v=v+1|0;else{v=1;break e}}for(v=1;;)if(k=(15-v|0)*3|0,R=ue(7,0,k|0)|0,O=m&~(Ce()|0),m=ne(y|0,m|0,k|0)|0,Ce()|0,m=ue(Wo(m&7)|0,0,k|0)|0,y=y&~R|m,m=O|(Ce()|0),v>>>0<E>>>0)v=v+1|0;else{v=1;break}}while(0);if(N>>>0<q>>>0)N=N+1|0;else break}return Mt(m|0),y|0}function IA(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0;if(E=ne(y|0,m|0,52)|0,Ce()|0,E=E&15,!E)return v=m,E=y,Mt(v|0),E|0;for(v=1;O=(15-v|0)*3|0,R=ue(7,0,O|0)|0,k=m&~(Ce()|0),m=ne(y|0,m|0,O|0)|0,Ce()|0,m=ue(Wo(m&7)|0,0,O|0)|0,y=m|y&~R,m=Ce()|0|k,v>>>0<E>>>0;)v=v+1|0;return Mt(m|0),y|0}function ci(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0;if(q=we,we=we+64|0,N=q+40|0,E=q+24|0,k=q+12|0,R=q,ue(m|0,0,52)|0,v=Ce()|0|134225919,!m)return(a[y+4>>2]|0)>2||(a[y+8>>2]|0)>2||(a[y+12>>2]|0)>2?(O=0,N=0,Mt(O|0),we=q,N|0):(ue(bA(y)|0,0,45)|0,O=Ce()|0|v,N=-1,Mt(O|0),we=q,N|0);if(a[N>>2]=a[y>>2],a[N+4>>2]=a[y+4>>2],a[N+8>>2]=a[y+8>>2],a[N+12>>2]=a[y+12>>2],O=N+4|0,(m|0)>0)for(y=-1;a[E>>2]=a[O>>2],a[E+4>>2]=a[O+4>>2],a[E+8>>2]=a[O+8>>2],m&1?(MA(O),a[k>>2]=a[O>>2],a[k+4>>2]=a[O+4>>2],a[k+8>>2]=a[O+8>>2],Ho(k)):(Wa(O),a[k>>2]=a[O>>2],a[k+4>>2]=a[O+4>>2],a[k+8>>2]=a[O+8>>2],Hi(k)),yo(E,k,R),On(R),le=(15-m|0)*3|0,J=ue(7,0,le|0)|0,v=v&~(Ce()|0),le=ue(jo(R)|0,0,le|0)|0,y=le|y&~J,v=Ce()|0|v,(m|0)>1;)m=m+-1|0;else y=-1;e:do if((a[O>>2]|0)<=2&&(a[N+8>>2]|0)<=2&&(a[N+12>>2]|0)<=2){if(E=bA(N)|0,m=ue(E|0,0,45)|0,m=m|y,y=Ce()|0|v&-1040385,R=EA(N)|0,!($n(E)|0)){if((R|0)<=0)break;for(k=0;;){if(E=ne(m|0,y|0,52)|0,Ce()|0,E=E&15,E)for(v=1;le=(15-v|0)*3|0,N=ne(m|0,y|0,le|0)|0,Ce()|0,J=ue(7,0,le|0)|0,y=y&~(Ce()|0),le=ue(vo(N&7)|0,0,le|0)|0,m=m&~J|le,y=y|(Ce()|0),v>>>0<E>>>0;)v=v+1|0;if(k=k+1|0,(k|0)==(R|0))break e}}k=ne(m|0,y|0,52)|0,Ce()|0,k=k&15;t:do if(k){v=1;n:for(;;){switch(le=ne(m|0,y|0,(15-v|0)*3|0)|0,Ce()|0,le&7){case 1:break n;case 0:break;default:break t}if(v>>>0<k>>>0)v=v+1|0;else break t}if(TA(E,a[N>>2]|0)|0)for(v=1;N=(15-v|0)*3|0,J=ue(7,0,N|0)|0,le=y&~(Ce()|0),y=ne(m|0,y|0,N|0)|0,Ce()|0,y=ue(Wo(y&7)|0,0,N|0)|0,m=m&~J|y,y=le|(Ce()|0),v>>>0<k>>>0;)v=v+1|0;else for(v=1;le=(15-v|0)*3|0,N=ne(m|0,y|0,le|0)|0,Ce()|0,J=ue(7,0,le|0)|0,y=y&~(Ce()|0),le=ue(vo(N&7)|0,0,le|0)|0,m=m&~J|le,y=y|(Ce()|0),v>>>0<k>>>0;)v=v+1|0}while(0);if((R|0)>0){v=0;do m=pu(m,y)|0,y=Ce()|0,v=v+1|0;while((v|0)!=(R|0))}}else m=0,y=0;while(0);return J=y,le=m,Mt(J|0),we=q,le|0}function bi(y){return y=y|0,(y|0)%2|0|0}function us(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0;return k=we,we=we+16|0,E=k,m>>>0>15?(E=4,we=k,E|0):(a[y+4>>2]&2146435072|0)==2146435072||(a[y+8+4>>2]&2146435072|0)==2146435072?(E=3,we=k,E|0):(jn(y,m,E),m=ci(E,m)|0,E=Ce()|0,a[v>>2]=m,a[v+4>>2]=E,(m|0)==0&(E|0)==0&&un(23313,22674,786,22697),E=0,we=k,E|0)}function _a(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0;if(k=v+4|0,R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,O=ne(y|0,m|0,45)|0,Ce()|0,E=(R|0)==0,$n(O&127)|0){if(E)return O=1,O|0;E=1}else{if(E)return O=0,O|0;!(a[k>>2]|0)&&!(a[v+8>>2]|0)?E=(a[v+12>>2]|0)!=0&1:E=1}for(v=1;v&1?Ho(k):Hi(k),O=ne(y|0,m|0,(15-v|0)*3|0)|0,Ce()|0,Wi(k,O&7),v>>>0<R>>>0;)v=v+1|0;return E|0}function Xi(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0;if(le=we,we=we+16|0,q=le,J=ne(y|0,m|0,45)|0,Ce()|0,J=J&127,J>>>0>121)return a[v>>2]=0,a[v+4>>2]=0,a[v+8>>2]=0,a[v+12>>2]=0,J=5,we=le,J|0;e:do if($n(J)|0&&(R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,(R|0)!=0)){E=1;t:for(;;){switch(N=ne(y|0,m|0,(15-E|0)*3|0)|0,Ce()|0,N&7){case 5:break t;case 0:break;default:{E=m;break e}}if(E>>>0<R>>>0)E=E+1|0;else{E=m;break e}}for(k=1,E=m;m=(15-k|0)*3|0,O=ue(7,0,m|0)|0,N=E&~(Ce()|0),E=ne(y|0,E|0,m|0)|0,Ce()|0,E=ue(Wo(E&7)|0,0,m|0)|0,y=y&~O|E,E=N|(Ce()|0),k>>>0<R>>>0;)k=k+1|0}else E=m;while(0);if(N=7696+(J*28|0)|0,a[v>>2]=a[N>>2],a[v+4>>2]=a[N+4>>2],a[v+8>>2]=a[N+8>>2],a[v+12>>2]=a[N+12>>2],!(_a(y,E,v)|0))return J=0,we=le,J|0;if(O=v+4|0,a[q>>2]=a[O>>2],a[q+4>>2]=a[O+4>>2],a[q+8>>2]=a[O+8>>2],R=ne(y|0,E|0,52)|0,Ce()|0,N=R&15,R&1?(Hi(O),R=N+1|0):R=N,!($n(J)|0))E=0;else{e:do if(!N)E=0;else for(m=1;;){if(k=ne(y|0,E|0,(15-m|0)*3|0)|0,Ce()|0,k=k&7,k|0){E=k;break e}if(m>>>0<N>>>0)m=m+1|0;else{E=0;break}}while(0);E=(E|0)==4&1}if(!(qa(v,R,E,0)|0))(R|0)!=(N|0)&&(a[O>>2]=a[q>>2],a[O+4>>2]=a[q+4>>2],a[O+8>>2]=a[q+8>>2]);else{if($n(J)|0)do;while(qa(v,R,0,0)|0);(R|0)!=(N|0)&&Wa(O)}return J=0,we=le,J|0}function wo(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0;return R=we,we=we+16|0,E=R,k=Xi(y,m,E)|0,k|0?(we=R,k|0):(k=ne(y|0,m|0,52)|0,Ce()|0,Bl(E,k&15,v),k=0,we=R,k|0)}function pi(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0;if(O=we,we=we+16|0,R=O,E=Xi(y,m,R)|0,E|0)return R=E,we=O,R|0;E=ne(y|0,m|0,45)|0,Ce()|0,E=($n(E&127)|0)==0,k=ne(y|0,m|0,52)|0,Ce()|0,k=k&15;e:do if(!E){if(k|0)for(E=1;;){if(N=ue(7,0,(15-E|0)*3|0)|0,!((N&y|0)==0&((Ce()|0)&m|0)==0))break e;if(E>>>0<k>>>0)E=E+1|0;else break}return qo(R,k,0,5,v),N=0,we=O,N|0}while(0);return fu(R,k,0,6,v),N=0,we=O,N|0}function Ya(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0;if(k=ne(y|0,m|0,45)|0,Ce()|0,!($n(k&127)|0))return k=2,a[v>>2]=k,0;if(k=ne(y|0,m|0,52)|0,Ce()|0,k=k&15,!k)return k=5,a[v>>2]=k,0;for(E=1;;){if(R=ue(7,0,(15-E|0)*3|0)|0,!((R&y|0)==0&((Ce()|0)&m|0)==0)){E=2,y=6;break}if(E>>>0<k>>>0)E=E+1|0;else{E=5,y=6;break}}return(y|0)==6&&(a[v>>2]=E),0}function Ul(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0;de=we,we=we+128|0,J=de+112|0,R=de+96|0,le=de,k=ne(y|0,m|0,52)|0,Ce()|0,N=k&15,a[J>>2]=N,O=ne(y|0,m|0,45)|0,Ce()|0,O=O&127;e:do if($n(O)|0){if(N|0)for(E=1;;){if(q=ue(7,0,(15-E|0)*3|0)|0,!((q&y|0)==0&((Ce()|0)&m|0)==0)){k=0;break e}if(E>>>0<N>>>0)E=E+1|0;else break}if(k&1)k=1;else return q=ue(N+1|0,0,52)|0,le=Ce()|0|m&-15728641,J=ue(7,0,(14-N|0)*3|0)|0,le=Ul((q|y)&~J,le&~(Ce()|0),v)|0,we=de,le|0}else k=0;while(0);if(E=Xi(y,m,R)|0,!E){k?(vc(R,J,le),q=5):(Gs(R,J,le),q=6);e:do if($n(O)|0)if(!N)y=5;else for(E=1;;){if(O=ue(7,0,(15-E|0)*3|0)|0,!((O&y|0)==0&((Ce()|0)&m|0)==0)){y=2;break e}if(E>>>0<N>>>0)E=E+1|0;else{y=5;break}}else y=2;while(0);Te(v|0,-1,y<<2|0)|0;e:do if(k)for(R=0;;){if(O=le+(R<<4)|0,xc(O,a[J>>2]|0)|0,O=a[O>>2]|0,N=a[v>>2]|0,(N|0)==-1|(N|0)==(O|0))E=v;else{k=0;do{if(k=k+1|0,k>>>0>=y>>>0){E=1;break e}E=v+(k<<2)|0,N=a[E>>2]|0}while(!((N|0)==-1|(N|0)==(O|0)))}if(a[E>>2]=O,R=R+1|0,R>>>0>=q>>>0){E=0;break}}else for(R=0;;){if(O=le+(R<<4)|0,qa(O,a[J>>2]|0,0,1)|0,O=a[O>>2]|0,N=a[v>>2]|0,(N|0)==-1|(N|0)==(O|0))E=v;else{k=0;do{if(k=k+1|0,k>>>0>=y>>>0){E=1;break e}E=v+(k<<2)|0,N=a[E>>2]|0}while(!((N|0)==-1|(N|0)==(O|0)))}if(a[E>>2]=O,R=R+1|0,R>>>0>=q>>>0){E=0;break}}while(0)}return le=E,we=de,le|0}function Xa(){return 12}function js(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0,N=0,q=0;if(y>>>0>15)return N=4,N|0;if(ue(y|0,0,52)|0,N=Ce()|0|134225919,!y){v=0,E=0;do $n(E)|0&&(ue(E|0,0,45)|0,O=N|(Ce()|0),y=m+(v<<3)|0,a[y>>2]=-1,a[y+4>>2]=O,v=v+1|0),E=E+1|0;while((E|0)!=122);return v=0,v|0}v=0,O=0;do{if($n(O)|0){for(ue(O|0,0,45)|0,E=1,k=-1,R=N|(Ce()|0);q=ue(7,0,(15-E|0)*3|0)|0,k=k&~q,R=R&~(Ce()|0),(E|0)!=(y|0);)E=E+1|0;q=m+(v<<3)|0,a[q>>2]=k,a[q+4>>2]=R,v=v+1|0}O=O+1|0}while((O|0)!=122);return v=0,v|0}function cs(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0;if(st=we,we=we+16|0,ft=st,ct=ne(y|0,m|0,52)|0,Ce()|0,ct=ct&15,v>>>0>15)return ct=4,we=st,ct|0;if((ct|0)<(v|0))return ct=12,we=st,ct|0;if((ct|0)!=(v|0))if(R=ue(v|0,0,52)|0,R=R|y,N=Ce()|0|m&-15728641,(ct|0)>(v|0)){q=v;do Xe=ue(7,0,(14-q|0)*3|0)|0,q=q+1|0,R=Xe|R,N=Ce()|0|N;while((q|0)<(ct|0));Xe=R}else Xe=R;else Xe=y,N=m;Be=ne(Xe|0,N|0,45)|0,Ce()|0;e:do if($n(Be&127)|0){if(q=ne(Xe|0,N|0,52)|0,Ce()|0,q=q&15,q|0)for(R=1;;){if(Be=ue(7,0,(15-R|0)*3|0)|0,!((Be&Xe|0)==0&((Ce()|0)&N|0)==0)){J=33;break e}if(R>>>0<q>>>0)R=R+1|0;else break}if(Be=E,a[Be>>2]=0,a[Be+4>>2]=0,(ct|0)>(v|0)){for(Be=m&-15728641,je=ct;;){if(Re=je,je=je+-1|0,je>>>0>15|(ct|0)<(je|0)){J=19;break}if((ct|0)!=(je|0))if(R=ue(je|0,0,52)|0,R=R|y,q=Ce()|0|Be,(ct|0)<(Re|0))de=R;else{J=je;do de=ue(7,0,(14-J|0)*3|0)|0,J=J+1|0,R=de|R,q=Ce()|0|q;while((J|0)<(ct|0));de=R}else de=y,q=m;if(le=ne(de|0,q|0,45)|0,Ce()|0,!($n(le&127)|0))R=0;else{le=ne(de|0,q|0,52)|0,Ce()|0,le=le&15;t:do if(!le)R=0;else for(J=1;;){if(R=ne(de|0,q|0,(15-J|0)*3|0)|0,Ce()|0,R=R&7,R|0)break t;if(J>>>0<le>>>0)J=J+1|0;else{R=0;break}}while(0);R=(R|0)==0&1}if(q=ne(y|0,m|0,(15-Re|0)*3|0)|0,Ce()|0,q=q&7,(q|0)==7){k=5,J=42;break}if(R=(R|0)!=0,(q|0)==1&R){k=5,J=42;break}if(de=q+(((q|0)!=0&R)<<31>>31)|0,de|0&&(J=ct-Re|0,J=Ws(7,0,J,((J|0)<0)<<31>>31)|0,le=Ce()|0,R?(R=V(J|0,le|0,5,0)|0,R=d(R|0,Ce()|0,-5,-1)|0,R=M(R|0,Ce()|0,6,0)|0,R=d(R|0,Ce()|0,1,0)|0,q=Ce()|0):(R=J,q=le),Re=de+-1|0,Re=V(J|0,le|0,Re|0,((Re|0)<0)<<31>>31|0)|0,Re=d(R|0,q|0,Re|0,Ce()|0)|0,de=Ce()|0,le=E,le=d(Re|0,de|0,a[le>>2]|0,a[le+4>>2]|0)|0,de=Ce()|0,Re=E,a[Re>>2]=le,a[Re+4>>2]=de),(je|0)<=(v|0)){J=37;break}}if((J|0)==19)un(23313,22674,1099,22710);else if((J|0)==37){O=E,k=a[O+4>>2]|0,O=a[O>>2]|0;break}else if((J|0)==42)return we=st,k|0}else k=0,O=0}else J=33;while(0);e:do if((J|0)==33)if(Be=E,a[Be>>2]=0,a[Be+4>>2]=0,(ct|0)>(v|0)){for(R=ct;;){if(k=ne(y|0,m|0,(15-R|0)*3|0)|0,Ce()|0,k=k&7,(k|0)==7){k=5;break}if(O=ct-R|0,O=Ws(7,0,O,((O|0)<0)<<31>>31)|0,k=V(O|0,Ce()|0,k|0,0)|0,O=Ce()|0,Be=E,O=d(a[Be>>2]|0,a[Be+4>>2]|0,k|0,O|0)|0,k=Ce()|0,Be=E,a[Be>>2]=O,a[Be+4>>2]=k,R=R+-1|0,(R|0)<=(v|0))break e}return we=st,k|0}else k=0,O=0;while(0);return Fl(Xe,N,ct,ft)|0&&un(23313,22674,1063,22725),ct=ft,ft=a[ct+4>>2]|0,((k|0)>-1|(k|0)==-1&O>>>0>4294967295)&((ft|0)>(k|0)|((ft|0)==(k|0)?(a[ct>>2]|0)>>>0>O>>>0:0))?(ct=0,we=st,ct|0):(un(23313,22674,1139,22710),0)}function Ec(y,m,v,E,k,R){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0,R=R|0;var O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0;if(de=we,we=we+16|0,O=de,k>>>0>15)return R=4,we=de,R|0;if(N=ne(v|0,E|0,52)|0,Ce()|0,N=N&15,(N|0)>(k|0))return R=12,we=de,R|0;if(Fl(v,E,k,O)|0&&un(23313,22674,1063,22725),le=O,J=a[le+4>>2]|0,!(((m|0)>-1|(m|0)==-1&y>>>0>4294967295)&((J|0)>(m|0)|((J|0)==(m|0)?(a[le>>2]|0)>>>0>y>>>0:0))))return R=2,we=de,R|0;le=k-N|0,k=ue(k|0,0,52)|0,q=Ce()|0|E&-15728641,J=R,a[J>>2]=k|v,a[J+4>>2]=q,J=ne(v|0,E|0,45)|0,Ce()|0;e:do if($n(J&127)|0){if(N|0)for(O=1;;){if(J=ue(7,0,(15-O|0)*3|0)|0,!((J&v|0)==0&((Ce()|0)&E|0)==0))break e;if(O>>>0<N>>>0)O=O+1|0;else break}if((le|0)<1)return R=0,we=de,R|0;for(J=N^15,E=-1,q=1,O=1;;){N=le-q|0,N=Ws(7,0,N,((N|0)<0)<<31>>31)|0,v=Ce()|0;do if(O)if(O=V(N|0,v|0,5,0)|0,O=d(O|0,Ce()|0,-5,-1)|0,O=M(O|0,Ce()|0,6,0)|0,k=Ce()|0,(m|0)>(k|0)|(m|0)==(k|0)&y>>>0>O>>>0){m=d(y|0,m|0,-1,-1)|0,m=x(m|0,Ce()|0,O|0,k|0)|0,O=Ce()|0,Re=R,Be=a[Re>>2]|0,Re=a[Re+4>>2]|0,Xe=(J+E|0)*3|0,je=ue(7,0,Xe|0)|0,Re=Re&~(Ce()|0),E=M(m|0,O|0,N|0,v|0)|0,y=Ce()|0,k=d(E|0,y|0,2,0)|0,Xe=ue(k|0,Ce()|0,Xe|0)|0,Re=Ce()|0|Re,k=R,a[k>>2]=Xe|Be&~je,a[k+4>>2]=Re,y=V(E|0,y|0,N|0,v|0)|0,y=x(m|0,O|0,y|0,Ce()|0)|0,O=0,m=Ce()|0;break}else{Xe=R,je=a[Xe>>2]|0,Xe=a[Xe+4>>2]|0,Be=ue(7,0,(J+E|0)*3|0)|0,Xe=Xe&~(Ce()|0),O=R,a[O>>2]=je&~Be,a[O+4>>2]=Xe,O=1;break}else je=R,k=a[je>>2]|0,je=a[je+4>>2]|0,E=(J+E|0)*3|0,Re=ue(7,0,E|0)|0,je=je&~(Ce()|0),Xe=M(y|0,m|0,N|0,v|0)|0,O=Ce()|0,E=ue(Xe|0,O|0,E|0)|0,je=Ce()|0|je,Be=R,a[Be>>2]=E|k&~Re,a[Be+4>>2]=je,O=V(Xe|0,O|0,N|0,v|0)|0,y=x(y|0,m|0,O|0,Ce()|0)|0,O=0,m=Ce()|0;while(0);if((le|0)>(q|0))E=~q,q=q+1|0;else{m=0;break}}return we=de,m|0}while(0);if((le|0)<1)return Xe=0,we=de,Xe|0;for(k=N^15,O=1;;)if(Be=le-O|0,Be=Ws(7,0,Be,((Be|0)<0)<<31>>31)|0,Xe=Ce()|0,q=R,v=a[q>>2]|0,q=a[q+4>>2]|0,N=(k-O|0)*3|0,E=ue(7,0,N|0)|0,q=q&~(Ce()|0),Re=M(y|0,m|0,Be|0,Xe|0)|0,je=Ce()|0,N=ue(Re|0,je|0,N|0)|0,q=Ce()|0|q,J=R,a[J>>2]=N|v&~E,a[J+4>>2]=q,Xe=V(Re|0,je|0,Be|0,Xe|0)|0,y=x(y|0,m|0,Xe|0,Ce()|0)|0,m=Ce()|0,(le|0)<=(O|0)){m=0;break}else O=O+1|0;return we=de,m|0}function va(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0;k=ne(m|0,v|0,52)|0,Ce()|0,k=k&15,(m|0)==0&(v|0)==0|((E|0)>15|(k|0)>(E|0))?(E=-1,k=-1,m=0,v=0):(R=As(m,v,k+1|0,E)|0,v=(Ce()|0)&-15728641,m=ue(E|0,0,52)|0,m=R|m,v=v|(Ce()|0),R=(mr(m,v)|0)==0,E=R?-1:E),R=y,a[R>>2]=m,a[R+4>>2]=v,a[y+8>>2]=k,a[y+12>>2]=E}function Ka(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0,q=0,J=0;if(v=y,m=a[v>>2]|0,v=a[v+4>>2]|0,!((m|0)==0&(v|0)==0)&&(E=ne(m|0,v|0,52)|0,Ce()|0,E=E&15,N=ue(1,0,(E^15)*3|0)|0,m=d(N|0,Ce()|0,m|0,v|0)|0,v=Ce()|0,N=y,a[N>>2]=m,a[N+4>>2]=v,N=y+8|0,O=a[N>>2]|0,!((E|0)<(O|0)))){for(q=y+12|0,R=E;;){if((R|0)==(O|0)){E=5;break}if(J=(R|0)==(a[q>>2]|0),k=(15-R|0)*3|0,E=ne(m|0,v|0,k|0)|0,Ce()|0,E=E&7,J&((E|0)==1&!0)){E=7;break}if(!((E|0)==7&!0)){E=10;break}if(J=ue(1,0,k|0)|0,m=d(m|0,v|0,J|0,Ce()|0)|0,v=Ce()|0,J=y,a[J>>2]=m,a[J+4>>2]=v,(R|0)>(O|0))R=R+-1|0;else{E=10;break}}if((E|0)==5){J=y,a[J>>2]=0,a[J+4>>2]=0,a[N>>2]=-1,a[q>>2]=-1;return}else if((E|0)==7){O=ue(1,0,k|0)|0,O=d(m|0,v|0,O|0,Ce()|0)|0,N=Ce()|0,J=y,a[J>>2]=O,a[J+4>>2]=N,a[q>>2]=R+-1;return}else if((E|0)==10)return}}function si(y){y=+y;var m=0;return m=y<0?y+6.283185307179586:y,+(y>=6.283185307179586?m+-6.283185307179586:m)}function Ss(y,m){return y=y|0,m=m|0,+Ie(+(+G[y>>3]-+G[m>>3]))<17453292519943298e-27?(m=+Ie(+(+G[y+8>>3]-+G[m+8>>3]))<17453292519943298e-27,m|0):(m=0,m|0)}function Ki(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0;return k=+G[m>>3],E=+G[y>>3],R=+dt(+((k-E)*.5)),v=+dt(+((+G[m+8>>3]-+G[y+8>>3])*.5)),v=R*R+v*(+We(+k)*+We(+E)*v),+(+pn(+ +qe(+v),+ +qe(+(1-v)))*2)}function Vl(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0;return k=+G[m>>3],E=+G[y>>3],R=+dt(+((k-E)*.5)),v=+dt(+((+G[m+8>>3]-+G[y+8>>3])*.5)),v=R*R+v*(+We(+k)*+We(+E)*v),+(+pn(+ +qe(+v),+ +qe(+(1-v)))*2*6371.007180918475)}function Zo(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0;return k=+G[m>>3],E=+G[y>>3],R=+dt(+((k-E)*.5)),v=+dt(+((+G[m+8>>3]-+G[y+8>>3])*.5)),v=R*R+v*(+We(+k)*+We(+E)*v),+(+pn(+ +qe(+v),+ +qe(+(1-v)))*2*6371.007180918475*1e3)}function Tc(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0;return R=+G[m>>3],E=+We(+R),k=+G[m+8>>3]-+G[y+8>>3],O=E*+dt(+k),v=+G[y>>3],+ +pn(+O,+(+dt(+R)*+We(+v)-+We(+k)*(E*+dt(+v))))}function bo(y,m,v,E){y=y|0,m=+m,v=+v,E=E|0;var k=0,R=0,O=0,N=0;if(v<1e-16){a[E>>2]=a[y>>2],a[E+4>>2]=a[y+4>>2],a[E+8>>2]=a[y+8>>2],a[E+12>>2]=a[y+12>>2];return}R=m<0?m+6.283185307179586:m,R=m>=6.283185307179586?R+-6.283185307179586:R;do if(R<1e-16)m=+G[y>>3]+v,G[E>>3]=m,k=E;else{if(k=+Ie(+(R+-3.141592653589793))<1e-16,m=+G[y>>3],k){m=m-v,G[E>>3]=m,k=E;break}if(O=+We(+v),v=+dt(+v),m=O*+dt(+m)+ +We(+R)*(v*+We(+m)),m=m>1?1:m,m=+sn(+(m<-1?-1:m)),G[E>>3]=m,+Ie(+(m+-1.5707963267948966))<1e-16){G[E>>3]=1.5707963267948966,G[E+8>>3]=0;return}if(+Ie(+(m+1.5707963267948966))<1e-16){G[E>>3]=-1.5707963267948966,G[E+8>>3]=0;return}if(N=+We(+m),R=v*+dt(+R)/N,v=+G[y>>3],m=(O-+dt(+m)*+dt(+v))/+We(+v)/N,O=R>1?1:R,m=m>1?1:m,m=+G[y+8>>3]+ +pn(+(O<-1?-1:O),+(m<-1?-1:m)),m>3.141592653589793)do m=m+-6.283185307179586;while(m>3.141592653589793);if(m<-3.141592653589793)do m=m+6.283185307179586;while(m<-3.141592653589793);G[E+8>>3]=m;return}while(0);if(+Ie(+(m+-1.5707963267948966))<1e-16){G[k>>3]=1.5707963267948966,G[E+8>>3]=0;return}if(+Ie(+(m+1.5707963267948966))<1e-16){G[k>>3]=-1.5707963267948966,G[E+8>>3]=0;return}if(m=+G[y+8>>3],m>3.141592653589793)do m=m+-6.283185307179586;while(m>3.141592653589793);if(m<-3.141592653589793)do m=m+6.283185307179586;while(m<-3.141592653589793);G[E+8>>3]=m}function Gl(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20528+(y<<3)>>3],m=0,m|0)}function Ja(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20656+(y<<3)>>3],m=0,m|0)}function Ch(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20784+(y<<3)>>3],m=0,m|0)}function Mh(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20912+(y<<3)>>3],m=0,m|0)}function el(y,m){y=y|0,m=m|0;var v=0;return y>>>0>15?(m=4,m|0):(v=Ws(7,0,y,((y|0)<0)<<31>>31)|0,v=V(v|0,Ce()|0,120,0)|0,y=Ce()|0,a[m>>2]=v|2,a[m+4>>2]=y,m=0,m|0)}function xa(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0;return Re=+G[m>>3],le=+G[y>>3],q=+dt(+((Re-le)*.5)),R=+G[m+8>>3],J=+G[y+8>>3],O=+dt(+((R-J)*.5)),N=+We(+le),de=+We(+Re),O=q*q+O*(de*N*O),O=+pn(+ +qe(+O),+ +qe(+(1-O)))*2,q=+G[v>>3],Re=+dt(+((q-Re)*.5)),E=+G[v+8>>3],R=+dt(+((E-R)*.5)),k=+We(+q),R=Re*Re+R*(de*k*R),R=+pn(+ +qe(+R),+ +qe(+(1-R)))*2,q=+dt(+((le-q)*.5)),E=+dt(+((J-E)*.5)),E=q*q+E*(N*k*E),E=+pn(+ +qe(+E),+ +qe(+(1-E)))*2,k=(O+R+E)*.5,+(+jt(+ +qe(+(+Dt(+(k*.5))*+Dt(+((k-O)*.5))*+Dt(+((k-R)*.5))*+Dt(+((k-E)*.5)))))*4)}function hs(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0;if(N=we,we=we+192|0,R=N+168|0,O=N,k=wo(y,m,R)|0,k|0)return v=k,we=N,v|0;if(pi(y,m,O)|0&&un(23313,22742,386,22751),m=a[O>>2]|0,(m|0)>0){if(E=+xa(O+8|0,O+8+(((m|0)!=1&1)<<4)|0,R)+0,(m|0)!=1){y=1;do k=y,y=y+1|0,E=E+ +xa(O+8+(k<<4)|0,O+8+(((y|0)%(m|0)|0)<<4)|0,R);while((y|0)<(m|0))}}else E=0;return G[v>>3]=E,v=0,we=N,v|0}function Nt(y,m,v){return y=y|0,m=m|0,v=v|0,y=hs(y,m,v)|0,y|0||(G[v>>3]=+G[v>>3]*6371.007180918475*6371.007180918475),y|0}function gu(y,m,v){return y=y|0,m=m|0,v=v|0,y=hs(y,m,v)|0,y|0||(G[v>>3]=+G[v>>3]*6371.007180918475*6371.007180918475*1e3*1e3),y|0}function wa(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0;if(N=we,we=we+176|0,O=N,y=Vs(y,m,O)|0,y|0)return O=y,we=N,O|0;if(G[v>>3]=0,y=a[O>>2]|0,(y|0)<=1)return O=0,we=N,O|0;m=y+-1|0,y=0,E=+G[O+8>>3],k=+G[O+16>>3],R=0;do y=y+1|0,J=E,E=+G[O+8+(y<<4)>>3],le=+dt(+((E-J)*.5)),q=k,k=+G[O+8+(y<<4)+8>>3],q=+dt(+((k-q)*.5)),q=le*le+q*(+We(+E)*+We(+J)*q),R=R+ +pn(+ +qe(+q),+ +qe(+(1-q)))*2;while((y|0)<(m|0));return G[v>>3]=R,O=0,we=N,O|0}function Yo(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0;if(N=we,we=we+176|0,O=N,y=Vs(y,m,O)|0,y|0)return O=y,R=+G[v>>3],R=R*6371.007180918475,G[v>>3]=R,we=N,O|0;if(G[v>>3]=0,y=a[O>>2]|0,(y|0)<=1)return O=0,R=0,R=R*6371.007180918475,G[v>>3]=R,we=N,O|0;m=y+-1|0,y=0,E=+G[O+8>>3],k=+G[O+16>>3],R=0;do y=y+1|0,J=E,E=+G[O+8+(y<<4)>>3],le=+dt(+((E-J)*.5)),q=k,k=+G[O+8+(y<<4)+8>>3],q=+dt(+((k-q)*.5)),q=le*le+q*(+We(+J)*+We(+E)*q),R=R+ +pn(+ +qe(+q),+ +qe(+(1-q)))*2;while((y|0)!=(m|0));return G[v>>3]=R,O=0,le=R,le=le*6371.007180918475,G[v>>3]=le,we=N,O|0}function mu(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0;if(N=we,we=we+176|0,O=N,y=Vs(y,m,O)|0,y|0)return O=y,R=+G[v>>3],R=R*6371.007180918475,R=R*1e3,G[v>>3]=R,we=N,O|0;if(G[v>>3]=0,y=a[O>>2]|0,(y|0)<=1)return O=0,R=0,R=R*6371.007180918475,R=R*1e3,G[v>>3]=R,we=N,O|0;m=y+-1|0,y=0,E=+G[O+8>>3],k=+G[O+16>>3],R=0;do y=y+1|0,J=E,E=+G[O+8+(y<<4)>>3],le=+dt(+((E-J)*.5)),q=k,k=+G[O+8+(y<<4)+8>>3],q=+dt(+((k-q)*.5)),q=le*le+q*(+We(+J)*+We(+E)*q),R=R+ +pn(+ +qe(+q),+ +qe(+(1-q)))*2;while((y|0)!=(m|0));return G[v>>3]=R,O=0,le=R,le=le*6371.007180918475,le=le*1e3,G[v>>3]=le,we=N,O|0}function Vt(y){y=y|0;var m=0,v=0,E=0;return m=h(1,12)|0,m||un(22832,22787,49,22845),v=y+4|0,E=a[v>>2]|0,E|0?(E=E+8|0,a[E>>2]=m,a[v>>2]=m,m|0):(a[y>>2]|0&&un(22862,22787,61,22885),E=y,a[E>>2]=m,a[v>>2]=m,m|0)}function LA(y,m){y=y|0,m=m|0;var v=0,E=0;return E=_(24)|0,E||un(22899,22787,78,22913),a[E>>2]=a[m>>2],a[E+4>>2]=a[m+4>>2],a[E+8>>2]=a[m+8>>2],a[E+12>>2]=a[m+12>>2],a[E+16>>2]=0,m=y+4|0,v=a[m>>2]|0,v|0?(a[v+16>>2]=E,a[m>>2]=E,E|0):(a[y>>2]|0&&un(22928,22787,82,22913),a[y>>2]=E,a[m>>2]=E,E|0)}function $l(y){y=y|0;var m=0,v=0,E=0,k=0;if(y)for(E=1;;){if(m=a[y>>2]|0,m|0)do{if(v=a[m>>2]|0,v|0)do k=v,v=a[v+16>>2]|0,A(k);while(v|0);k=m,m=a[m+8>>2]|0,A(k)}while(m|0);if(m=y,y=a[y+8>>2]|0,E||A(m),y)E=0;else break}}function DA(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,pt=0,vt=0,Pn=0,wn=0,mn=0,_n=0,En=0,Dn=0,ar=0,kn=0;if(k=y+8|0,a[k>>2]|0)return kn=1,kn|0;if(E=a[y>>2]|0,!E)return kn=0,kn|0;m=E,v=0;do v=v+1|0,m=a[m+8>>2]|0;while(m|0);if(v>>>0<2)return kn=0,kn|0;Dn=_(v<<2)|0,Dn||un(22948,22787,317,22967),En=_(v<<5)|0,En||un(22989,22787,321,22967),a[y>>2]=0,zt=y+4|0,a[zt>>2]=0,a[k>>2]=0,v=0,_n=0,Gt=0,de=0;e:for(;;){if(le=a[E>>2]|0,le){R=0,O=le;do{if(q=+G[O+8>>3],m=O,O=a[O+16>>2]|0,J=(O|0)==0,k=J?le:O,N=+G[k+8>>3],+Ie(+(q-N))>3.141592653589793){kn=14;break}R=R+(N-q)*(+G[m>>3]+ +G[k>>3])}while(!J);if((kn|0)==14){kn=0,R=0,m=le;do Je=+G[m+8>>3],mn=m+16|0,wn=a[mn>>2]|0,wn=wn|0?wn:le,ot=+G[wn+8>>3],R=R+(+G[m>>3]+ +G[wn>>3])*((ot<0?ot+6.283185307179586:ot)-(Je<0?Je+6.283185307179586:Je)),m=a[(m|0?mn:E)>>2]|0;while(m|0)}R>0?(a[Dn+(_n<<2)>>2]=E,_n=_n+1|0,k=Gt,m=de):kn=19}else kn=19;if((kn|0)==19){kn=0;do if(v){if(m=v+8|0,a[m>>2]|0){kn=21;break e}if(v=h(1,12)|0,!v){kn=23;break e}a[m>>2]=v,k=v+4|0,O=v,m=de}else if(de){k=zt,O=de+8|0,m=E,v=y;break}else if(a[y>>2]|0){kn=27;break e}else{k=zt,O=y,m=E,v=y;break}while(0);if(a[O>>2]=E,a[k>>2]=E,O=En+(Gt<<5)|0,J=a[E>>2]|0,J){for(le=En+(Gt<<5)+8|0,G[le>>3]=17976931348623157e292,de=En+(Gt<<5)+24|0,G[de>>3]=17976931348623157e292,G[O>>3]=-17976931348623157e292,Re=En+(Gt<<5)+16|0,G[Re>>3]=-17976931348623157e292,ct=17976931348623157e292,st=-17976931348623157e292,k=0,je=J,q=17976931348623157e292,Xe=17976931348623157e292,ft=-17976931348623157e292,N=-17976931348623157e292;R=+G[je>>3],Je=+G[je+8>>3],je=a[je+16>>2]|0,Be=(je|0)==0,ot=+G[(Be?J:je)+8>>3],R<q&&(G[le>>3]=R,q=R),Je<Xe&&(G[de>>3]=Je,Xe=Je),R>ft?G[O>>3]=R:R=ft,Je>N&&(G[Re>>3]=Je,N=Je),ct=Je>0&Je<ct?Je:ct,st=Je<0&Je>st?Je:st,k=k|+Ie(+(Je-ot))>3.141592653589793,!Be;)ft=R;k&&(G[Re>>3]=st,G[de>>3]=ct)}else a[O>>2]=0,a[O+4>>2]=0,a[O+8>>2]=0,a[O+12>>2]=0,a[O+16>>2]=0,a[O+20>>2]=0,a[O+24>>2]=0,a[O+28>>2]=0;k=Gt+1|0}if(mn=E+8|0,E=a[mn>>2]|0,a[mn>>2]=0,E)Gt=k,de=m;else{kn=45;break}}if((kn|0)==21)un(22765,22787,35,22799);else if((kn|0)==23)un(22819,22787,37,22799);else if((kn|0)==27)un(22862,22787,61,22885);else if((kn|0)==45){e:do if((_n|0)>0){for(mn=(k|0)==0,Pn=k<<2,wn=(y|0)==0,vt=0,m=0;;){if(pt=a[Dn+(vt<<2)>>2]|0,mn)kn=73;else{if(Gt=_(Pn)|0,!Gt){kn=50;break}if(zt=_(Pn)|0,!zt){kn=52;break}t:do if(wn)v=0;else{for(k=0,v=0,O=y;E=En+(k<<5)|0,tl(a[O>>2]|0,E,a[pt>>2]|0)|0?(a[Gt+(v<<2)>>2]=O,a[zt+(v<<2)>>2]=E,Be=v+1|0):Be=v,O=a[O+8>>2]|0,O;)k=k+1|0,v=Be;if((Be|0)>0)if(E=a[Gt>>2]|0,(Be|0)==1)v=E;else for(Re=0,je=-1,v=E,de=E;;){for(J=a[de>>2]|0,E=0,O=0;k=a[a[Gt+(O<<2)>>2]>>2]|0,(k|0)==(J|0)?le=E:le=E+((tl(k,a[zt+(O<<2)>>2]|0,a[J>>2]|0)|0)&1)|0,O=O+1|0,(O|0)!=(Be|0);)E=le;if(k=(le|0)>(je|0),v=k?de:v,E=Re+1|0,(E|0)==(Be|0))break t;Re=E,je=k?le:je,de=a[Gt+(E<<2)>>2]|0}else v=0}while(0);if(A(Gt),A(zt),v){if(k=v+4|0,E=a[k>>2]|0,E)v=E+8|0;else if(a[v>>2]|0){kn=70;break}a[v>>2]=pt,a[k>>2]=pt}else kn=73}if((kn|0)==73){if(kn=0,m=a[pt>>2]|0,m|0)do zt=m,m=a[m+16>>2]|0,A(zt);while(m|0);A(pt),m=1}if(vt=vt+1|0,(vt|0)>=(_n|0)){ar=m;break e}}(kn|0)==50?un(23004,22787,249,23023):(kn|0)==52?un(23042,22787,252,23023):(kn|0)==70&&un(22862,22787,61,22885)}else ar=0;while(0);return A(Dn),A(En),kn=ar,kn|0}return 0}function tl(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0;if(!(ou(m,v)|0)||(m=Kn(m)|0,E=+G[v>>3],k=+G[v+8>>3],k=m&k<0?k+6.283185307179586:k,y=a[y>>2]|0,!y))return y=0,y|0;if(m){m=0,J=k,v=y;e:for(;;){for(;O=+G[v>>3],k=+G[v+8>>3],v=v+16|0,le=a[v>>2]|0,le=le|0?le:y,R=+G[le>>3],N=+G[le+8>>3],O>R?(q=O,O=N):(q=R,R=O,O=k,k=N),E=E==R|E==q?E+2220446049250313e-31:E,!!(E<R|E>q);)if(v=a[v>>2]|0,!v){v=22;break e}if(N=O<0?O+6.283185307179586:O,O=k<0?k+6.283185307179586:k,J=N==J|O==J?J+-2220446049250313e-31:J,q=N+(O-N)*((E-R)/(q-R)),(q<0?q+6.283185307179586:q)>J&&(m=m^1),v=a[v>>2]|0,!v){v=22;break}}if((v|0)==22)return m|0}else{m=0,J=k,v=y;e:for(;;){for(;O=+G[v>>3],k=+G[v+8>>3],v=v+16|0,le=a[v>>2]|0,le=le|0?le:y,R=+G[le>>3],N=+G[le+8>>3],O>R?(q=O,O=N):(q=R,R=O,O=k,k=N),E=E==R|E==q?E+2220446049250313e-31:E,!!(E<R|E>q);)if(v=a[v>>2]|0,!v){v=22;break e}if(J=O==J|k==J?J+-2220446049250313e-31:J,O+(k-O)*((E-R)/(q-R))>J&&(m=m^1),v=a[v>>2]|0,!v){v=22;break}}if((v|0)==22)return m|0}return 0}function Hs(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0;if(st=we,we=we+32|0,ct=st+16|0,ft=st,R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,je=ne(v|0,E|0,52)|0,Ce()|0,(R|0)!=(je&15|0))return ct=12,we=st,ct|0;if(J=ne(y|0,m|0,45)|0,Ce()|0,J=J&127,le=ne(v|0,E|0,45)|0,Ce()|0,le=le&127,J>>>0>121|le>>>0>121)return ct=5,we=st,ct|0;if(je=(J|0)!=(le|0),je){if(N=kl(J,le)|0,(N|0)==7)return ct=1,we=st,ct|0;q=kl(le,J)|0,(q|0)==7?un(23066,23090,161,23100):(Be=N,O=q)}else Be=0,O=0;de=$n(J)|0,Re=$n(le)|0,a[ct>>2]=0,a[ct+4>>2]=0,a[ct+8>>2]=0,a[ct+12>>2]=0;do if(Be){if(le=a[4272+(J*28|0)+(Be<<2)>>2]|0,N=(le|0)>0,Re)if(N){J=0,q=v,N=E;do q=bc(q,N)|0,N=Ce()|0,O=Wo(O)|0,(O|0)==1&&(O=Wo(1)|0),J=J+1|0;while((J|0)!=(le|0));le=O,J=q,q=N}else le=O,J=v,q=E;else if(N){J=0,q=v,N=E;do q=IA(q,N)|0,N=Ce()|0,O=Wo(O)|0,J=J+1|0;while((J|0)!=(le|0));le=O,J=q,q=N}else le=O,J=v,q=E;if(_a(J,q,ct)|0,je||un(23115,23090,191,23100),N=(de|0)!=0,O=(Re|0)!=0,N&O&&un(23142,23090,192,23100),N){if(O=ii(y,m)|0,(O|0)==7){R=5;break}if(he[21872+(O*7|0)+Be>>0]|0){R=1;break}q=a[21040+(O*28|0)+(Be<<2)>>2]|0,J=q}else if(O){if(O=ii(J,q)|0,(O|0)==7){R=5;break}if(he[21872+(O*7|0)+le>>0]|0){R=1;break}J=0,q=a[21040+(le*28|0)+(O<<2)>>2]|0}else J=0,q=0;if((J|q|0)<0)R=5;else{if((q|0)>0){N=ct+4|0,O=0;do Dl(N),O=O+1|0;while((O|0)!=(q|0))}if(a[ft>>2]=0,a[ft+4>>2]=0,a[ft+8>>2]=0,Wi(ft,Be),R|0)for(;bi(R)|0?Ho(ft):Hi(ft),(R|0)>1;)R=R+-1|0;if((J|0)>0){R=0;do Dl(ft),R=R+1|0;while((R|0)!=(J|0))}Xe=ct+4|0,ri(Xe,ft,Xe),On(Xe),Xe=51}}else if(_a(v,E,ct)|0,(de|0)!=0&(Re|0)!=0)if((le|0)!=(J|0)&&un(23173,23090,261,23100),O=ii(y,m)|0,R=ii(v,E)|0,(O|0)==7|(R|0)==7)R=5;else if(he[21872+(O*7|0)+R>>0]|0)R=1;else if(O=a[21040+(O*28|0)+(R<<2)>>2]|0,(O|0)>0){N=ct+4|0,R=0;do Dl(N),R=R+1|0;while((R|0)!=(O|0));Xe=51}else Xe=51;else Xe=51;while(0);return(Xe|0)==51&&(R=ct+4|0,a[k>>2]=a[R>>2],a[k+4>>2]=a[R+4>>2],a[k+8>>2]=a[R+8>>2],R=0),ct=R,we=st,ct|0}function yu(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0,ot=0;if(Xe=we,we=we+48|0,J=Xe+36|0,O=Xe+24|0,N=Xe+12|0,q=Xe,k=ne(y|0,m|0,52)|0,Ce()|0,k=k&15,Re=ne(y|0,m|0,45)|0,Ce()|0,Re=Re&127,Re>>>0>121)return E=5,we=Xe,E|0;if(le=$n(Re)|0,ue(k|0,0,52)|0,ft=Ce()|0|134225919,R=E,a[R>>2]=-1,a[R+4>>2]=ft,!k)return k=jo(v)|0,(k|0)==7||(k=Pl(Re,k)|0,(k|0)==127)?(ft=1,we=Xe,ft|0):(je=ue(k|0,0,45)|0,Be=Ce()|0,Re=E,Be=a[Re+4>>2]&-1040385|Be,ft=E,a[ft>>2]=a[Re>>2]|je,a[ft+4>>2]=Be,ft=0,we=Xe,ft|0);for(a[J>>2]=a[v>>2],a[J+4>>2]=a[v+4>>2],a[J+8>>2]=a[v+8>>2],v=k;;){if(R=v,v=v+-1|0,a[O>>2]=a[J>>2],a[O+4>>2]=a[J+4>>2],a[O+8>>2]=a[J+8>>2],bi(R)|0){if(k=pa(J)|0,k|0){v=13;break}a[N>>2]=a[J>>2],a[N+4>>2]=a[J+4>>2],a[N+8>>2]=a[J+8>>2],Ho(N)}else{if(k=_o(J)|0,k|0){v=13;break}a[N>>2]=a[J>>2],a[N+4>>2]=a[J+4>>2],a[N+8>>2]=a[J+8>>2],Hi(N)}if(yo(O,N,q),On(q),k=E,st=a[k>>2]|0,k=a[k+4>>2]|0,ot=(15-R|0)*3|0,ct=ue(7,0,ot|0)|0,k=k&~(Ce()|0),ot=ue(jo(q)|0,0,ot|0)|0,k=Ce()|0|k,ft=E,a[ft>>2]=ot|st&~ct,a[ft+4>>2]=k,(R|0)<=1){v=14;break}}e:do if((v|0)!=13&&(v|0)==14)if((a[J>>2]|0)<=1&&(a[J+4>>2]|0)<=1&&(a[J+8>>2]|0)<=1){v=jo(J)|0,k=Pl(Re,v)|0,(k|0)==127?q=0:q=$n(k)|0;t:do if(v){if(le){if(k=ii(y,m)|0,(k|0)==7){k=5;break e}if(R=a[21248+(k*28|0)+(v<<2)>>2]|0,(R|0)>0){k=v,v=0;do k=vo(k)|0,v=v+1|0;while((v|0)!=(R|0))}else k=v;if((k|0)==1){k=9;break e}v=Pl(Re,k)|0,(v|0)==127&&un(23200,23090,411,23230),$n(v)|0?un(23245,23090,412,23230):(Be=v,je=R,de=k)}else Be=k,je=0,de=v;if(N=a[4272+(Re*28|0)+(de<<2)>>2]|0,(N|0)<=-1&&un(23276,23090,419,23230),!q){if((je|0)<0){k=5;break e}if(je|0){R=E,k=0,v=a[R>>2]|0,R=a[R+4>>2]|0;do v=$s(v,R)|0,R=Ce()|0,ot=E,a[ot>>2]=v,a[ot+4>>2]=R,k=k+1|0;while((k|0)<(je|0))}if((N|0)<=0){k=Be,v=58;break}for(R=E,k=0,v=a[R>>2]|0,R=a[R+4>>2]|0;;)if(v=$s(v,R)|0,R=Ce()|0,ot=E,a[ot>>2]=v,a[ot+4>>2]=R,k=k+1|0,(k|0)==(N|0)){k=Be,v=58;break t}}if(O=kl(Be,Re)|0,(O|0)==7&&un(23066,23090,428,23230),k=E,v=a[k>>2]|0,k=a[k+4>>2]|0,(N|0)>0){R=0;do v=$s(v,k)|0,k=Ce()|0,ot=E,a[ot>>2]=v,a[ot+4>>2]=k,R=R+1|0;while((R|0)!=(N|0))}if(k=ii(v,k)|0,(k|0)==7&&un(23313,23090,440,23230),v=wA(Be)|0,v=a[(v?21664:21456)+(O*28|0)+(k<<2)>>2]|0,(v|0)<0&&un(23313,23090,454,23230),!v)k=Be,v=58;else{O=E,k=0,R=a[O>>2]|0,O=a[O+4>>2]|0;do R=pu(R,O)|0,O=Ce()|0,ot=E,a[ot>>2]=R,a[ot+4>>2]=O,k=k+1|0;while((k|0)<(v|0));k=Be,v=58}}else if((le|0)!=0&(q|0)!=0){if(v=ii(y,m)|0,R=E,R=ii(a[R>>2]|0,a[R+4>>2]|0)|0,(v|0)==7|(R|0)==7){k=5;break e}if(R=a[21248+(v*28|0)+(R<<2)>>2]|0,(R|0)<0){k=5;break e}if(!R)v=59;else{N=E,v=0,O=a[N>>2]|0,N=a[N+4>>2]|0;do O=$s(O,N)|0,N=Ce()|0,ot=E,a[ot>>2]=O,a[ot+4>>2]=N,v=v+1|0;while((v|0)<(R|0));v=58}}else v=58;while(0);if((v|0)==58&&q&&(v=59),(v|0)==59&&(ot=E,(ii(a[ot>>2]|0,a[ot+4>>2]|0)|0)==1)){k=9;break}ot=E,ct=a[ot>>2]|0,ot=a[ot+4>>2]&-1040385,st=ue(k|0,0,45)|0,ot=ot|(Ce()|0),k=E,a[k>>2]=ct|st,a[k+4>>2]=ot,k=0}else k=1;while(0);return ot=k,we=Xe,ot|0}function Ph(y,m,v,E,k,R){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0,R=R|0;var O=0,N=0;return N=we,we=we+16|0,O=N,k?y=15:(y=Hs(y,m,v,E,O)|0,y||(PA(O,R),y=0)),we=N,y|0}function Sc(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0;return O=we,we=we+16|0,R=O,E?v=15:(v=Au(v,R)|0,v||(v=yu(y,m,R,k)|0)),we=O,v|0}function _u(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0;return q=we,we=we+32|0,O=q+12|0,N=q,R=Hs(y,m,y,m,O)|0,R|0?(N=R,we=q,N|0):(y=Hs(y,m,v,E,N)|0,y|0?(N=y,we=q,N|0):(O=Rl(O,N)|0,N=k,a[N>>2]=O,a[N+4>>2]=((O|0)<0)<<31>>31,N=0,we=q,N|0))}function vu(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0;return q=we,we=we+32|0,O=q+12|0,N=q,R=Hs(y,m,y,m,O)|0,!R&&(R=Hs(y,m,v,E,N)|0,!R)?(E=Rl(O,N)|0,E=d(E|0,((E|0)<0)<<31>>31|0,1,0)|0,O=Ce()|0,N=k,a[N>>2]=E,a[N+4>>2]=O,N=0,we=q,N|0):(N=R,we=q,N|0)}function xu(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,pt=0,vt=0;if(pt=we,we=we+48|0,O=pt+24|0,N=pt+12|0,zt=pt,R=Hs(y,m,y,m,O)|0,!R&&(R=Hs(y,m,v,E,N)|0,!R)){Je=Rl(O,N)|0,Gt=((Je|0)<0)<<31>>31,a[O>>2]=0,a[O+4>>2]=0,a[O+8>>2]=0,a[N>>2]=0,a[N+4>>2]=0,a[N+8>>2]=0,Hs(y,m,y,m,O)|0&&un(23313,23090,691,23299),Hs(y,m,v,E,N)|0&&un(23313,23090,696,23299),Qo(O),Qo(N),Je?(de=a[O>>2]|0,Be=+(Je|0),ct=O+4|0,Re=a[ct>>2]|0,st=O+8|0,je=a[st>>2]|0,ot=O,E=de,R=Re,v=je,Xe=+((a[N>>2]|0)-de|0)/Be,ft=+((a[N+4>>2]|0)-Re|0)/Be,Be=+((a[N+8>>2]|0)-je|0)/Be):(R=O+4|0,v=O+8|0,ct=R,st=v,ot=O,E=a[O>>2]|0,R=a[R>>2]|0,v=a[v>>2]|0,Xe=0,ft=0,Be=0),a[zt>>2]=E,je=zt+4|0,a[je>>2]=R,Re=zt+8|0,a[Re>>2]=v;e:do if((Je|0)<0)R=0;else for(le=0,de=0,R=E;;){J=+(de>>>0)+4294967296*+(le|0),vt=Xe*J+ +(R|0),q=ft*J+ +(a[ct>>2]|0),J=Be*J+ +(a[st>>2]|0),v=~~+ve(+vt),O=~~+ve(+q),R=~~+ve(+J),vt=+Ie(+(+(v|0)-vt)),q=+Ie(+(+(O|0)-q)),J=+Ie(+(+(R|0)-J));do if(vt>q&vt>J)v=0-(O+R)|0,E=O;else if(N=0-v|0,q>J){E=N-R|0;break}else{E=O,R=N-O|0;break}while(0);if(a[zt>>2]=v,a[je>>2]=E,a[Re>>2]=R,Qa(zt),R=yu(y,m,zt,k+(de<<3)|0)|0,R|0)break e;if(!((le|0)<(Gt|0)|(le|0)==(Gt|0)&de>>>0<Je>>>0)){R=0;break e}R=d(de|0,le|0,1,0)|0,N=Ce()|0,le=N,de=R,R=a[ot>>2]|0}while(0);return zt=R,we=pt,zt|0}return zt=R,we=pt,zt|0}function Ws(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0;if((v|0)==0&(E|0)==0)return k=0,R=1,Mt(k|0),R|0;R=y,k=m,y=1,m=0;do O=(v&1|0)==0&!0,y=V((O?1:R)|0,(O?0:k)|0,y|0,m|0)|0,m=Ce()|0,v=ae(v|0,E|0,1)|0,E=Ce()|0,R=V(R|0,k|0,R|0,k|0)|0,k=Ce()|0;while(!((v|0)==0&(E|0)==0));return Mt(m|0),y|0}function Ri(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0;if(!(ou(m,v)|0)||(m=Kn(m)|0,E=+G[v>>3],k=+G[v+8>>3],k=m&k<0?k+6.283185307179586:k,Re=a[y>>2]|0,(Re|0)<=0))return Re=0,Re|0;if(de=a[y+4>>2]|0,m){m=0,le=k,v=-1,y=0;e:for(;;){for(J=y;O=+G[de+(J<<4)>>3],k=+G[de+(J<<4)+8>>3],y=(v+2|0)%(Re|0)|0,R=+G[de+(y<<4)>>3],N=+G[de+(y<<4)+8>>3],O>R?(q=O,O=N):(q=R,R=O,O=k,k=N),E=E==R|E==q?E+2220446049250313e-31:E,!!(E<R|E>q);)if(v=J+1|0,(v|0)>=(Re|0)){v=22;break e}else y=J,J=v,v=y;if(N=O<0?O+6.283185307179586:O,O=k<0?k+6.283185307179586:k,le=N==le|O==le?le+-2220446049250313e-31:le,q=N+(O-N)*((E-R)/(q-R)),(q<0?q+6.283185307179586:q)>le&&(m=m^1),y=J+1|0,(y|0)>=(Re|0)){v=22;break}else v=J}if((v|0)==22)return m|0}else{m=0,le=k,v=-1,y=0;e:for(;;){for(J=y;O=+G[de+(J<<4)>>3],k=+G[de+(J<<4)+8>>3],y=(v+2|0)%(Re|0)|0,R=+G[de+(y<<4)>>3],N=+G[de+(y<<4)+8>>3],O>R?(q=O,O=N):(q=R,R=O,O=k,k=N),E=E==R|E==q?E+2220446049250313e-31:E,!!(E<R|E>q);)if(v=J+1|0,(v|0)>=(Re|0)){v=22;break e}else y=J,J=v,v=y;if(le=O==le|k==le?le+-2220446049250313e-31:le,O+(k-O)*((E-R)/(q-R))>le&&(m=m^1),y=J+1|0,(y|0)>=(Re|0)){v=22;break}else v=J}if((v|0)==22)return m|0}return 0}function Eo(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0;if(Be=a[y>>2]|0,!Be){a[m>>2]=0,a[m+4>>2]=0,a[m+8>>2]=0,a[m+12>>2]=0,a[m+16>>2]=0,a[m+20>>2]=0,a[m+24>>2]=0,a[m+28>>2]=0;return}if(Xe=m+8|0,G[Xe>>3]=17976931348623157e292,ft=m+24|0,G[ft>>3]=17976931348623157e292,G[m>>3]=-17976931348623157e292,ct=m+16|0,G[ct>>3]=-17976931348623157e292,!((Be|0)<=0)){for(Re=a[y+4>>2]|0,J=17976931348623157e292,le=-17976931348623157e292,de=0,y=-1,R=17976931348623157e292,O=17976931348623157e292,q=-17976931348623157e292,E=-17976931348623157e292,je=0;v=+G[Re+(je<<4)>>3],N=+G[Re+(je<<4)+8>>3],y=y+2|0,k=+G[Re+(((y|0)==(Be|0)?0:y)<<4)+8>>3],v<R&&(G[Xe>>3]=v,R=v),N<O&&(G[ft>>3]=N,O=N),v>q?G[m>>3]=v:v=q,N>E&&(G[ct>>3]=N,E=N),J=N>0&N<J?N:J,le=N<0&N>le?N:le,de=de|+Ie(+(N-k))>3.141592653589793,y=je+1|0,(y|0)!=(Be|0);)st=je,q=v,je=y,y=st;de&&(G[ct>>3]=le,G[ft>>3]=J)}}function wu(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,pt=0;if(Be=a[y>>2]|0,Be){if(Xe=m+8|0,G[Xe>>3]=17976931348623157e292,ft=m+24|0,G[ft>>3]=17976931348623157e292,G[m>>3]=-17976931348623157e292,ct=m+16|0,G[ct>>3]=-17976931348623157e292,(Be|0)>0){for(k=a[y+4>>2]|0,Re=17976931348623157e292,je=-17976931348623157e292,E=0,v=-1,q=17976931348623157e292,J=17976931348623157e292,de=-17976931348623157e292,O=-17976931348623157e292,st=0;R=+G[k+(st<<4)>>3],le=+G[k+(st<<4)+8>>3],zt=v+2|0,N=+G[k+(((zt|0)==(Be|0)?0:zt)<<4)+8>>3],R<q&&(G[Xe>>3]=R,q=R),le<J&&(G[ft>>3]=le,J=le),R>de?G[m>>3]=R:R=de,le>O&&(G[ct>>3]=le,O=le),Re=le>0&le<Re?le:Re,je=le<0&le>je?le:je,E=E|+Ie(+(le-N))>3.141592653589793,v=st+1|0,(v|0)!=(Be|0);)zt=st,de=R,st=v,v=zt;E&&(G[ct>>3]=je,G[ft>>3]=Re)}}else a[m>>2]=0,a[m+4>>2]=0,a[m+8>>2]=0,a[m+12>>2]=0,a[m+16>>2]=0,a[m+20>>2]=0,a[m+24>>2]=0,a[m+28>>2]=0;if(zt=y+8|0,v=a[zt>>2]|0,!((v|0)<=0)){Gt=y+12|0,Je=0;do if(k=a[Gt>>2]|0,E=Je,Je=Je+1|0,ft=m+(Je<<5)|0,ct=a[k+(E<<3)>>2]|0,ct){if(st=m+(Je<<5)+8|0,G[st>>3]=17976931348623157e292,y=m+(Je<<5)+24|0,G[y>>3]=17976931348623157e292,G[ft>>3]=-17976931348623157e292,ot=m+(Je<<5)+16|0,G[ot>>3]=-17976931348623157e292,(ct|0)>0){for(Be=a[k+(E<<3)+4>>2]|0,Re=17976931348623157e292,je=-17976931348623157e292,k=0,E=-1,Xe=0,q=17976931348623157e292,J=17976931348623157e292,le=-17976931348623157e292,O=-17976931348623157e292;R=+G[Be+(Xe<<4)>>3],de=+G[Be+(Xe<<4)+8>>3],E=E+2|0,N=+G[Be+(((E|0)==(ct|0)?0:E)<<4)+8>>3],R<q&&(G[st>>3]=R,q=R),de<J&&(G[y>>3]=de,J=de),R>le?G[ft>>3]=R:R=le,de>O&&(G[ot>>3]=de,O=de),Re=de>0&de<Re?de:Re,je=de<0&de>je?de:je,k=k|+Ie(+(de-N))>3.141592653589793,E=Xe+1|0,(E|0)!=(ct|0);)pt=Xe,Xe=E,le=R,E=pt;k&&(G[ot>>3]=je,G[y>>3]=Re)}}else a[ft>>2]=0,a[ft+4>>2]=0,a[ft+8>>2]=0,a[ft+12>>2]=0,a[ft+16>>2]=0,a[ft+20>>2]=0,a[ft+24>>2]=0,a[ft+28>>2]=0,v=a[zt>>2]|0;while((Je|0)<(v|0))}}function ba(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0;if(!(Ri(y,m,v)|0))return k=0,k|0;if(k=y+8|0,(a[k>>2]|0)<=0)return k=1,k|0;for(E=y+12|0,y=0;;){if(R=y,y=y+1|0,Ri((a[E>>2]|0)+(R<<3)|0,m+(y<<5)|0,v)|0){y=0,E=6;break}if((y|0)>=(a[k>>2]|0)){y=1,E=6;break}}return(E|0)==6?y|0:0}function Nr(){return 8}function jl(){return 16}function Cc(){return 168}function fs(){return 8}function Sr(){return 16}function nl(){return 12}function Hl(){return 8}function bu(y){return y=y|0,+(+((a[y>>2]|0)>>>0)+4294967296*+(a[y+4>>2]|0))}function Mc(y){y=y|0;var m=0,v=0;return v=+G[y>>3],m=+G[y+8>>3],+ +qe(+(v*v+m*m))}function Eu(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0;J=+G[y>>3],q=+G[m>>3]-J,N=+G[y+8>>3],O=+G[m+8>>3]-N,de=+G[v>>3],R=+G[E>>3]-de,Re=+G[v+8>>3],le=+G[E+8>>3]-Re,R=(R*(N-Re)-(J-de)*le)/(q*le-O*R),G[k>>3]=J+q*R,G[k+8>>3]=N+O*R}function Pc(y,m){return y=y|0,m=m|0,+Ie(+(+G[y>>3]-+G[m>>3]))<11920928955078125e-23?(m=+Ie(+(+G[y+8>>3]-+G[m+8>>3]))<11920928955078125e-23,m|0):(m=0,m|0)}function yr(y,m){y=y|0,m=m|0;var v=0,E=0,k=0;return k=+G[y>>3]-+G[m>>3],E=+G[y+8>>3]-+G[m+8>>3],v=+G[y+16>>3]-+G[m+16>>3],+(k*k+E*E+v*v)}function Wl(y,m){y=y|0,m=m|0;var v=0,E=0,k=0;v=+G[y>>3],E=+We(+v),v=+dt(+v),G[m+16>>3]=v,v=+G[y+8>>3],k=E*+We(+v),G[m>>3]=k,v=E*+dt(+v),G[m+8>>3]=v}function Yt(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0;if(R=we,we=we+16|0,k=R,E=mr(y,m)|0,(v+-1|0)>>>0>5||(E=(E|0)!=0,(v|0)==1&E))return k=-1,we=R,k|0;do if(Xt(y,m,k)|0)E=-1;else if(E){E=((a[21936+(v<<2)>>2]|0)+5-(a[k>>2]|0)|0)%5|0;break}else{E=((a[21968+(v<<2)>>2]|0)+6-(a[k>>2]|0)|0)%6|0;break}while(0);return k=E,we=R,k|0}function Xt(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0,J=0;if(J=we,we=we+32|0,O=J+16|0,N=J,E=Xi(y,m,O)|0,E|0)return v=E,we=J,v|0;R=Za(y,m)|0,q=ii(y,m)|0,iu(R,N),E=su(R,a[O>>2]|0)|0;e:do if($n(R)|0){do switch(R|0){case 4:{y=0;break}case 14:{y=1;break}case 24:{y=2;break}case 38:{y=3;break}case 49:{y=4;break}case 58:{y=5;break}case 63:{y=6;break}case 72:{y=7;break}case 83:{y=8;break}case 97:{y=9;break}case 107:{y=10;break}case 117:{y=11;break}default:{E=1;break e}}while(0);if(k=a[22e3+(y*24|0)+8>>2]|0,m=a[22e3+(y*24|0)+16>>2]|0,y=a[O>>2]|0,(y|0)!=(a[N>>2]|0)&&(N=wA(R)|0,y=a[O>>2]|0,N|(y|0)==(m|0)&&(E=(E+1|0)%6|0)),(q|0)==3&(y|0)==(m|0)){E=(E+5|0)%6|0,k=22;break}(q|0)==5&(y|0)==(k|0)&&(E=(E+1|0)%6|0),k=22}else k=22;while(0);return(k|0)==22&&(a[v>>2]=E,E=0),v=E,we=J,v|0}function hn(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0,ot=0;if(ot=we,we=we+32|0,st=ot+24|0,ft=ot+20|0,Be=ot+8|0,je=ot+16|0,Re=ot,q=(mr(y,m)|0)==0,q=q?6:5,le=ne(y|0,m|0,52)|0,Ce()|0,le=le&15,q>>>0<=v>>>0)return E=2,we=ot,E|0;de=(le|0)==0,!de&&(Xe=ue(7,0,(le^15)*3|0)|0,(Xe&y|0)==0&((Ce()|0)&m|0)==0)?k=v:R=4;e:do if((R|0)==4){if(k=(mr(y,m)|0)!=0,((k?4:5)|0)<(v|0)||Xt(y,m,st)|0||(R=(a[st>>2]|0)+v|0,k?k=22288+(((R|0)%5|0)<<2)|0:k=22320+(((R|0)%6|0)<<2)|0,Xe=a[k>>2]|0,(Xe|0)==7))return E=1,we=ot,E|0;a[ft>>2]=0,k=Fe(y,m,Xe,ft,Be)|0;do if(!k){if(N=Be,J=a[N>>2]|0,N=a[N+4>>2]|0,O=N>>>0<m>>>0|(N|0)==(m|0)&J>>>0<y>>>0,R=O?J:y,O=O?N:m,!de&&(de=ue(7,0,(le^15)*3|0)|0,(J&de|0)==0&(N&(Ce()|0)|0)==0))k=v;else{if(N=(v+-1+q|0)%(q|0)|0,k=mr(y,m)|0,(N|0)<0&&un(23313,23315,245,23324),q=(k|0)!=0,((q?4:5)|0)<(N|0)&&un(23313,23315,245,23324),Xt(y,m,st)|0&&un(23313,23315,245,23324),k=(a[st>>2]|0)+N|0,q?k=22288+(((k|0)%5|0)<<2)|0:k=22320+(((k|0)%6|0)<<2)|0,N=a[k>>2]|0,(N|0)==7&&un(23313,23315,245,23324),a[je>>2]=0,k=Fe(y,m,N,je,Re)|0,k|0)break;J=Re,q=a[J>>2]|0,J=a[J+4>>2]|0;do if(J>>>0<O>>>0|(J|0)==(O|0)&q>>>0<R>>>0){if(mr(q,J)|0?R=lt(q,J,y,m)|0:R=a[22384+((((a[je>>2]|0)+(a[22352+(N<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,k=mr(q,J)|0,(R+-1|0)>>>0>5){k=-1,R=q,O=J;break}if(k=(k|0)!=0,(R|0)==1&k){k=-1,R=q,O=J;break}do if(Xt(q,J,st)|0)k=-1;else if(k){k=((a[21936+(R<<2)>>2]|0)+5-(a[st>>2]|0)|0)%5|0;break}else{k=((a[21968+(R<<2)>>2]|0)+6-(a[st>>2]|0)|0)%6|0;break}while(0);R=q,O=J}else k=v;while(0);N=Be,J=a[N>>2]|0,N=a[N+4>>2]|0}if((R|0)==(J|0)&(O|0)==(N|0)){if(q=(mr(J,N)|0)!=0,q?y=lt(J,N,y,m)|0:y=a[22384+((((a[ft>>2]|0)+(a[22352+(Xe<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,k=mr(J,N)|0,(y+-1|0)>>>0<=5&&(ct=(k|0)!=0,!((y|0)==1&ct)))do if(Xt(J,N,st)|0)k=-1;else if(ct){k=((a[21936+(y<<2)>>2]|0)+5-(a[st>>2]|0)|0)%5|0;break}else{k=((a[21968+(y<<2)>>2]|0)+6-(a[st>>2]|0)|0)%6|0;break}while(0);else k=-1;k=k+1|0,k=(k|0)==6|q&(k|0)==5?0:k}m=O,y=R;break e}while(0);return E=k,we=ot,E|0}while(0);return ct=ue(k|0,0,56)|0,st=Ce()|0|m&-2130706433|536870912,a[E>>2]=ct|y,a[E+4>>2]=st,E=0,we=ot,E|0}function Ji(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0;return R=(mr(y,m)|0)==0,E=hn(y,m,0,v)|0,k=(E|0)==0,R?!k||(E=hn(y,m,1,v+8|0)|0,E|0)||(E=hn(y,m,2,v+16|0)|0,E|0)||(E=hn(y,m,3,v+24|0)|0,E|0)||(E=hn(y,m,4,v+32|0)|0,E)?(R=E,R|0):hn(y,m,5,v+40|0)|0:!k||(E=hn(y,m,1,v+8|0)|0,E|0)||(E=hn(y,m,2,v+16|0)|0,E|0)||(E=hn(y,m,3,v+24|0)|0,E|0)||(E=hn(y,m,4,v+32|0)|0,E|0)?(R=E,R|0):(R=v+40|0,a[R>>2]=0,a[R+4>>2]=0,R=0,R|0)}function Xo(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0,N=0,q=0;return q=we,we=we+192|0,k=q,R=q+168|0,O=ne(y|0,m|0,56)|0,Ce()|0,O=O&7,N=m&-2130706433|134217728,E=Xi(y,N,R)|0,E|0?(N=E,we=q,N|0):(m=ne(y|0,m|0,52)|0,Ce()|0,m=m&15,mr(y,N)|0?qo(R,m,O,1,k):fu(R,m,O,1,k),N=k+8|0,a[v>>2]=a[N>>2],a[v+4>>2]=a[N+4>>2],a[v+8>>2]=a[N+8>>2],a[v+12>>2]=a[N+12>>2],N=0,we=q,N|0)}function $r(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0;return k=we,we=we+16|0,v=k,!(!0&(m&2013265920|0)==536870912)||(E=m&-2130706433|134217728,!(ya(y,E)|0))?(E=0,we=k,E|0):(R=ne(y|0,m|0,56)|0,Ce()|0,R=(hn(y,E,R&7,v)|0)==0,E=v,E=R&((a[E>>2]|0)==(y|0)?(a[E+4>>2]|0)==(m|0):0)&1,we=k,E|0)}function Qs(y,m,v){y=y|0,m=m|0,v=v|0;var E=0;(m|0)>0?(E=h(m,4)|0,a[y>>2]=E,E||un(23337,23360,40,23374)):a[y>>2]=0,a[y+4>>2]=m,a[y+8>>2]=0,a[y+12>>2]=v}function Cs(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0;k=y+4|0,R=y+12|0,O=y+8|0;e:for(;;){for(v=a[k>>2]|0,m=0;;){if((m|0)>=(v|0))break e;if(E=a[y>>2]|0,N=a[E+(m<<2)>>2]|0,!N)m=m+1|0;else break}m=E+(~~(+Ie(+(+At(10,+ +(15-(a[R>>2]|0)|0))*(+G[N>>3]+ +G[N+8>>3])))%+(v|0))>>>0<<2)|0,v=a[m>>2]|0;t:do if(v|0){if(E=N+32|0,(v|0)==(N|0))a[m>>2]=a[E>>2];else{if(v=v+32|0,m=a[v>>2]|0,!m)break;for(;(m|0)!=(N|0);)if(v=m+32|0,m=a[v>>2]|0,!m)break t;a[v>>2]=a[E>>2]}A(N),a[O>>2]=(a[O>>2]|0)+-1}while(0)}A(a[y>>2]|0)}function qs(y){y=y|0;var m=0,v=0,E=0;for(E=a[y+4>>2]|0,v=0;;){if((v|0)>=(E|0)){m=0,v=4;break}if(m=a[(a[y>>2]|0)+(v<<2)>>2]|0,!m)v=v+1|0;else{v=4;break}}return(v|0)==4?m|0:0}function Ct(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0;if(v=~~(+Ie(+(+At(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,v=(a[y>>2]|0)+(v<<2)|0,E=a[v>>2]|0,!E)return R=1,R|0;R=m+32|0;do if((E|0)!=(m|0)){if(v=a[E+32>>2]|0,!v)return R=1,R|0;for(k=v;;){if((k|0)==(m|0)){k=8;break}if(v=a[k+32>>2]|0,v)E=k,k=v;else{v=1,k=10;break}}if((k|0)==8){a[E+32>>2]=a[R>>2];break}else if((k|0)==10)return v|0}else a[v>>2]=a[R>>2];while(0);return A(m),R=y+8|0,a[R>>2]=(a[R>>2]|0)+-1,R=0,R|0}function Pt(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0;R=_(40)|0,R||un(23390,23360,98,23403),a[R>>2]=a[m>>2],a[R+4>>2]=a[m+4>>2],a[R+8>>2]=a[m+8>>2],a[R+12>>2]=a[m+12>>2],k=R+16|0,a[k>>2]=a[v>>2],a[k+4>>2]=a[v+4>>2],a[k+8>>2]=a[v+8>>2],a[k+12>>2]=a[v+12>>2],a[R+32>>2]=0,k=~~(+Ie(+(+At(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,k=(a[y>>2]|0)+(k<<2)|0,E=a[k>>2]|0;do if(!E)a[k>>2]=R;else{for(;!(Ss(E,m)|0&&Ss(E+16|0,v)|0);)if(k=a[E+32>>2]|0,E=k|0?k:E,!(a[E+32>>2]|0)){O=10;break}if((O|0)==10){a[E+32>>2]=R;break}return A(R),O=E,O|0}while(0);return O=y+8|0,a[O>>2]=(a[O>>2]|0)+1,O=R,O|0}function jr(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0;if(k=~~(+Ie(+(+At(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,k=a[(a[y>>2]|0)+(k<<2)>>2]|0,!k)return v=0,v|0;if(!v){for(y=k;;){if(Ss(y,m)|0){E=10;break}if(y=a[y+32>>2]|0,!y){y=0,E=10;break}}if((E|0)==10)return y|0}for(y=k;;){if(Ss(y,m)|0&&Ss(y+16|0,v)|0){E=10;break}if(y=a[y+32>>2]|0,!y){y=0,E=10;break}}return(E|0)==10?y|0:0}function rl(y,m){y=y|0,m=m|0;var v=0;if(v=~~(+Ie(+(+At(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,y=a[(a[y>>2]|0)+(v<<2)>>2]|0,!y)return v=0,v|0;for(;;){if(Ss(y,m)|0){m=5;break}if(y=a[y+32>>2]|0,!y){y=0,m=5;break}}return(m|0)==5?y|0:0}function Zs(){return 23424}function L(y){return y=+y,+ +Ge(+y)}function c(y){return y=+y,~~+L(y)|0}function _(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Xe=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0;Gt=we,we=we+16|0,Re=Gt;do if(y>>>0<245){if(J=y>>>0<11?16:y+11&-8,y=J>>>3,de=a[5857]|0,v=de>>>y,v&3|0)return m=(v&1^1)+y|0,y=23468+(m<<1<<2)|0,v=y+8|0,E=a[v>>2]|0,k=E+8|0,R=a[k>>2]|0,(R|0)==(y|0)?a[5857]=de&~(1<<m):(a[R+12>>2]=y,a[v>>2]=R),Je=m<<3,a[E+4>>2]=Je|3,Je=E+Je+4|0,a[Je>>2]=a[Je>>2]|1,Je=k,we=Gt,Je|0;if(le=a[5859]|0,J>>>0>le>>>0){if(v|0)return m=2<<y,m=v<<y&(m|0-m),m=(m&0-m)+-1|0,N=m>>>12&16,m=m>>>N,v=m>>>5&8,m=m>>>v,R=m>>>2&4,m=m>>>R,y=m>>>1&2,m=m>>>y,E=m>>>1&1,E=(v|N|R|y|E)+(m>>>E)|0,m=23468+(E<<1<<2)|0,y=m+8|0,R=a[y>>2]|0,N=R+8|0,v=a[N>>2]|0,(v|0)==(m|0)?(y=de&~(1<<E),a[5857]=y):(a[v+12>>2]=m,a[y>>2]=v,y=de),Je=E<<3,O=Je-J|0,a[R+4>>2]=J|3,k=R+J|0,a[k+4>>2]=O|1,a[R+Je>>2]=O,le|0&&(E=a[5862]|0,m=le>>>3,v=23468+(m<<1<<2)|0,m=1<<m,y&m?(y=v+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=v,y=v+8|0),a[y>>2]=E,a[m+12>>2]=E,a[E+8>>2]=m,a[E+12>>2]=v),a[5859]=O,a[5862]=k,Je=N,we=Gt,Je|0;if(R=a[5858]|0,R){for(v=(R&0-R)+-1|0,k=v>>>12&16,v=v>>>k,E=v>>>5&8,v=v>>>E,O=v>>>2&4,v=v>>>O,N=v>>>1&2,v=v>>>N,q=v>>>1&1,q=a[23732+((E|k|O|N|q)+(v>>>q)<<2)>>2]|0,v=q,N=q,q=(a[q+4>>2]&-8)-J|0;y=a[v+16>>2]|0,!(!y&&(y=a[v+20>>2]|0,!y));)O=(a[y+4>>2]&-8)-J|0,k=O>>>0<q>>>0,v=y,N=k?y:N,q=k?O:q;if(O=N+J|0,O>>>0>N>>>0){k=a[N+24>>2]|0,m=a[N+12>>2]|0;do if((m|0)==(N|0)){if(y=N+20|0,m=a[y>>2]|0,!m&&(y=N+16|0,m=a[y>>2]|0,!m)){v=0;break}for(;;)if(E=m+20|0,v=a[E>>2]|0,v)m=v,y=E;else if(E=m+16|0,v=a[E>>2]|0,v)m=v,y=E;else break;a[y>>2]=0,v=m}else v=a[N+8>>2]|0,a[v+12>>2]=m,a[m+8>>2]=v,v=m;while(0);do if(k|0){if(m=a[N+28>>2]|0,y=23732+(m<<2)|0,(N|0)==(a[y>>2]|0)){if(a[y>>2]=v,!v){a[5858]=R&~(1<<m);break}}else if(Je=k+16|0,a[((a[Je>>2]|0)==(N|0)?Je:k+20|0)>>2]=v,!v)break;a[v+24>>2]=k,m=a[N+16>>2]|0,m|0&&(a[v+16>>2]=m,a[m+24>>2]=v),m=a[N+20>>2]|0,m|0&&(a[v+20>>2]=m,a[m+24>>2]=v)}while(0);return q>>>0<16?(Je=q+J|0,a[N+4>>2]=Je|3,Je=N+Je+4|0,a[Je>>2]=a[Je>>2]|1):(a[N+4>>2]=J|3,a[O+4>>2]=q|1,a[O+q>>2]=q,le|0&&(E=a[5862]|0,m=le>>>3,v=23468+(m<<1<<2)|0,m=1<<m,m&de?(y=v+8|0,m=a[y>>2]|0):(a[5857]=m|de,m=v,y=v+8|0),a[y>>2]=E,a[m+12>>2]=E,a[E+8>>2]=m,a[E+12>>2]=v),a[5859]=q,a[5862]=O),Je=N+8|0,we=Gt,Je|0}else de=J}else de=J}else de=J}else if(y>>>0<=4294967231)if(y=y+11|0,J=y&-8,E=a[5858]|0,E){k=0-J|0,y=y>>>8,y?J>>>0>16777215?q=31:(de=(y+1048320|0)>>>16&8,Xe=y<<de,N=(Xe+520192|0)>>>16&4,Xe=Xe<<N,q=(Xe+245760|0)>>>16&2,q=14-(N|de|q)+(Xe<<q>>>15)|0,q=J>>>(q+7|0)&1|q<<1):q=0,v=a[23732+(q<<2)>>2]|0;e:do if(!v)v=0,y=0,Xe=61;else for(y=0,N=J<<((q|0)==31?0:25-(q>>>1)|0),R=0;;){if(O=(a[v+4>>2]&-8)-J|0,O>>>0<k>>>0)if(O)y=v,k=O;else{y=v,k=0,Xe=65;break e}if(Xe=a[v+20>>2]|0,v=a[v+16+(N>>>31<<2)>>2]|0,R=(Xe|0)==0|(Xe|0)==(v|0)?R:Xe,v)N=N<<1;else{v=R,Xe=61;break}}while(0);if((Xe|0)==61){if((v|0)==0&(y|0)==0){if(y=2<<q,y=(y|0-y)&E,!y){de=J;break}de=(y&0-y)+-1|0,O=de>>>12&16,de=de>>>O,R=de>>>5&8,de=de>>>R,N=de>>>2&4,de=de>>>N,q=de>>>1&2,de=de>>>q,v=de>>>1&1,y=0,v=a[23732+((R|O|N|q|v)+(de>>>v)<<2)>>2]|0}v?Xe=65:(N=y,O=k)}if((Xe|0)==65)for(R=v;;)if(de=(a[R+4>>2]&-8)-J|0,v=de>>>0<k>>>0,k=v?de:k,y=v?R:y,v=a[R+16>>2]|0,v||(v=a[R+20>>2]|0),v)R=v;else{N=y,O=k;break}if(N|0&&O>>>0<((a[5859]|0)-J|0)>>>0&&(le=N+J|0,le>>>0>N>>>0)){R=a[N+24>>2]|0,m=a[N+12>>2]|0;do if((m|0)==(N|0)){if(y=N+20|0,m=a[y>>2]|0,!m&&(y=N+16|0,m=a[y>>2]|0,!m)){m=0;break}for(;;)if(k=m+20|0,v=a[k>>2]|0,v)m=v,y=k;else if(k=m+16|0,v=a[k>>2]|0,v)m=v,y=k;else break;a[y>>2]=0}else Je=a[N+8>>2]|0,a[Je+12>>2]=m,a[m+8>>2]=Je;while(0);do if(R){if(y=a[N+28>>2]|0,v=23732+(y<<2)|0,(N|0)==(a[v>>2]|0)){if(a[v>>2]=m,!m){E=E&~(1<<y),a[5858]=E;break}}else if(Je=R+16|0,a[((a[Je>>2]|0)==(N|0)?Je:R+20|0)>>2]=m,!m)break;a[m+24>>2]=R,y=a[N+16>>2]|0,y|0&&(a[m+16>>2]=y,a[y+24>>2]=m),y=a[N+20>>2]|0,y&&(a[m+20>>2]=y,a[y+24>>2]=m)}while(0);e:do if(O>>>0<16)Je=O+J|0,a[N+4>>2]=Je|3,Je=N+Je+4|0,a[Je>>2]=a[Je>>2]|1;else{if(a[N+4>>2]=J|3,a[le+4>>2]=O|1,a[le+O>>2]=O,m=O>>>3,O>>>0<256){v=23468+(m<<1<<2)|0,y=a[5857]|0,m=1<<m,y&m?(y=v+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=v,y=v+8|0),a[y>>2]=le,a[m+12>>2]=le,a[le+8>>2]=m,a[le+12>>2]=v;break}if(m=O>>>8,m?O>>>0>16777215?v=31:(ot=(m+1048320|0)>>>16&8,Je=m<<ot,st=(Je+520192|0)>>>16&4,Je=Je<<st,v=(Je+245760|0)>>>16&2,v=14-(st|ot|v)+(Je<<v>>>15)|0,v=O>>>(v+7|0)&1|v<<1):v=0,m=23732+(v<<2)|0,a[le+28>>2]=v,y=le+16|0,a[y+4>>2]=0,a[y>>2]=0,y=1<<v,!(E&y)){a[5858]=E|y,a[m>>2]=le,a[le+24>>2]=m,a[le+12>>2]=le,a[le+8>>2]=le;break}m=a[m>>2]|0;t:do if((a[m+4>>2]&-8|0)!=(O|0)){for(E=O<<((v|0)==31?0:25-(v>>>1)|0);v=m+16+(E>>>31<<2)|0,y=a[v>>2]|0,!!y;)if((a[y+4>>2]&-8|0)==(O|0)){m=y;break t}else E=E<<1,m=y;a[v>>2]=le,a[le+24>>2]=m,a[le+12>>2]=le,a[le+8>>2]=le;break e}while(0);ot=m+8|0,Je=a[ot>>2]|0,a[Je+12>>2]=le,a[ot>>2]=le,a[le+8>>2]=Je,a[le+12>>2]=m,a[le+24>>2]=0}while(0);return Je=N+8|0,we=Gt,Je|0}else de=J}else de=J;else de=-1;while(0);if(v=a[5859]|0,v>>>0>=de>>>0)return m=v-de|0,y=a[5862]|0,m>>>0>15?(Je=y+de|0,a[5862]=Je,a[5859]=m,a[Je+4>>2]=m|1,a[y+v>>2]=m,a[y+4>>2]=de|3):(a[5859]=0,a[5862]=0,a[y+4>>2]=v|3,Je=y+v+4|0,a[Je>>2]=a[Je>>2]|1),Je=y+8|0,we=Gt,Je|0;if(O=a[5860]|0,O>>>0>de>>>0)return st=O-de|0,a[5860]=st,Je=a[5863]|0,ot=Je+de|0,a[5863]=ot,a[ot+4>>2]=st|1,a[Je+4>>2]=de|3,Je=Je+8|0,we=Gt,Je|0;if(a[5975]|0?y=a[5977]|0:(a[5977]=4096,a[5976]=4096,a[5978]=-1,a[5979]=-1,a[5980]=0,a[5968]=0,a[5975]=Re&-16^1431655768,y=4096),N=de+48|0,q=de+47|0,R=y+q|0,k=0-y|0,J=R&k,J>>>0<=de>>>0||(y=a[5967]|0,y|0&&(le=a[5965]|0,Re=le+J|0,Re>>>0<=le>>>0|Re>>>0>y>>>0)))return Je=0,we=Gt,Je|0;e:do if(a[5968]&4)m=0,Xe=143;else{v=a[5863]|0;t:do if(v){for(E=23876;Re=a[E>>2]|0,!(Re>>>0<=v>>>0&&(Re+(a[E+4>>2]|0)|0)>>>0>v>>>0);)if(y=a[E+8>>2]|0,y)E=y;else{Xe=128;break t}if(m=R-O&k,m>>>0<2147483647)if(y=xe(m|0)|0,(y|0)==((a[E>>2]|0)+(a[E+4>>2]|0)|0)){if((y|0)!=-1){O=m,R=y,Xe=145;break e}}else E=y,Xe=136;else m=0}else Xe=128;while(0);do if((Xe|0)==128)if(v=xe(0)|0,(v|0)!=-1&&(m=v,je=a[5976]|0,Be=je+-1|0,m=(Be&m|0?(Be+m&0-je)-m|0:0)+J|0,je=a[5965]|0,Be=m+je|0,m>>>0>de>>>0&m>>>0<2147483647)){if(Re=a[5967]|0,Re|0&&Be>>>0<=je>>>0|Be>>>0>Re>>>0){m=0;break}if(y=xe(m|0)|0,(y|0)==(v|0)){O=m,R=v,Xe=145;break e}else E=y,Xe=136}else m=0;while(0);do if((Xe|0)==136){if(v=0-m|0,!(N>>>0>m>>>0&(m>>>0<2147483647&(E|0)!=-1)))if((E|0)==-1){m=0;break}else{O=m,R=E,Xe=145;break e}if(y=a[5977]|0,y=q-m+y&0-y,y>>>0>=2147483647){O=m,R=E,Xe=145;break e}if((xe(y|0)|0)==-1){xe(v|0)|0,m=0;break}else{O=y+m|0,R=E,Xe=145;break e}}while(0);a[5968]=a[5968]|4,Xe=143}while(0);if((Xe|0)==143&&J>>>0<2147483647&&(st=xe(J|0)|0,Be=xe(0)|0,ft=Be-st|0,ct=ft>>>0>(de+40|0)>>>0,!((st|0)==-1|ct^1|st>>>0<Be>>>0&((st|0)!=-1&(Be|0)!=-1)^1))&&(O=ct?ft:m,R=st,Xe=145),(Xe|0)==145){m=(a[5965]|0)+O|0,a[5965]=m,m>>>0>(a[5966]|0)>>>0&&(a[5966]=m),q=a[5863]|0;e:do if(q){for(m=23876;;){if(y=a[m>>2]|0,v=a[m+4>>2]|0,(R|0)==(y+v|0)){Xe=154;break}if(E=a[m+8>>2]|0,E)m=E;else break}if((Xe|0)==154&&(ot=m+4|0,(a[m+12>>2]&8|0)==0)&&R>>>0>q>>>0&y>>>0<=q>>>0){a[ot>>2]=v+O,Je=(a[5860]|0)+O|0,st=q+8|0,st=st&7|0?0-st&7:0,ot=q+st|0,st=Je-st|0,a[5863]=ot,a[5860]=st,a[ot+4>>2]=st|1,a[q+Je+4>>2]=40,a[5864]=a[5979];break}for(R>>>0<(a[5861]|0)>>>0&&(a[5861]=R),v=R+O|0,m=23876;;){if((a[m>>2]|0)==(v|0)){Xe=162;break}if(y=a[m+8>>2]|0,y)m=y;else break}if((Xe|0)==162&&!(a[m+12>>2]&8|0)){a[m>>2]=R,le=m+4|0,a[le>>2]=(a[le>>2]|0)+O,le=R+8|0,le=R+(le&7|0?0-le&7:0)|0,m=v+8|0,m=v+(m&7|0?0-m&7:0)|0,J=le+de|0,N=m-le-de|0,a[le+4>>2]=de|3;t:do if((q|0)==(m|0))Je=(a[5860]|0)+N|0,a[5860]=Je,a[5863]=J,a[J+4>>2]=Je|1;else{if((a[5862]|0)==(m|0)){Je=(a[5859]|0)+N|0,a[5859]=Je,a[5862]=J,a[J+4>>2]=Je|1,a[J+Je>>2]=Je;break}if(y=a[m+4>>2]|0,(y&3|0)==1){O=y&-8,E=y>>>3;n:do if(y>>>0<256)if(y=a[m+8>>2]|0,v=a[m+12>>2]|0,(v|0)==(y|0)){a[5857]=a[5857]&~(1<<E);break}else{a[y+12>>2]=v,a[v+8>>2]=y;break}else{R=a[m+24>>2]|0,y=a[m+12>>2]|0;do if((y|0)==(m|0)){if(v=m+16|0,E=v+4|0,y=a[E>>2]|0,y)v=E;else if(y=a[v>>2]|0,!y){y=0;break}for(;;)if(k=y+20|0,E=a[k>>2]|0,E)y=E,v=k;else if(k=y+16|0,E=a[k>>2]|0,E)y=E,v=k;else break;a[v>>2]=0}else Je=a[m+8>>2]|0,a[Je+12>>2]=y,a[y+8>>2]=Je;while(0);if(!R)break;v=a[m+28>>2]|0,E=23732+(v<<2)|0;do if((a[E>>2]|0)!=(m|0)){if(Je=R+16|0,a[((a[Je>>2]|0)==(m|0)?Je:R+20|0)>>2]=y,!y)break n}else{if(a[E>>2]=y,y|0)break;a[5858]=a[5858]&~(1<<v);break n}while(0);if(a[y+24>>2]=R,v=m+16|0,E=a[v>>2]|0,E|0&&(a[y+16>>2]=E,a[E+24>>2]=y),v=a[v+4>>2]|0,!v)break;a[y+20>>2]=v,a[v+24>>2]=y}while(0);m=m+O|0,k=O+N|0}else k=N;if(m=m+4|0,a[m>>2]=a[m>>2]&-2,a[J+4>>2]=k|1,a[J+k>>2]=k,m=k>>>3,k>>>0<256){v=23468+(m<<1<<2)|0,y=a[5857]|0,m=1<<m,y&m?(y=v+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=v,y=v+8|0),a[y>>2]=J,a[m+12>>2]=J,a[J+8>>2]=m,a[J+12>>2]=v;break}m=k>>>8;do if(!m)E=0;else{if(k>>>0>16777215){E=31;break}ot=(m+1048320|0)>>>16&8,Je=m<<ot,st=(Je+520192|0)>>>16&4,Je=Je<<st,E=(Je+245760|0)>>>16&2,E=14-(st|ot|E)+(Je<<E>>>15)|0,E=k>>>(E+7|0)&1|E<<1}while(0);if(m=23732+(E<<2)|0,a[J+28>>2]=E,y=J+16|0,a[y+4>>2]=0,a[y>>2]=0,y=a[5858]|0,v=1<<E,!(y&v)){a[5858]=y|v,a[m>>2]=J,a[J+24>>2]=m,a[J+12>>2]=J,a[J+8>>2]=J;break}m=a[m>>2]|0;n:do if((a[m+4>>2]&-8|0)!=(k|0)){for(E=k<<((E|0)==31?0:25-(E>>>1)|0);v=m+16+(E>>>31<<2)|0,y=a[v>>2]|0,!!y;)if((a[y+4>>2]&-8|0)==(k|0)){m=y;break n}else E=E<<1,m=y;a[v>>2]=J,a[J+24>>2]=m,a[J+12>>2]=J,a[J+8>>2]=J;break t}while(0);ot=m+8|0,Je=a[ot>>2]|0,a[Je+12>>2]=J,a[ot>>2]=J,a[J+8>>2]=Je,a[J+12>>2]=m,a[J+24>>2]=0}while(0);return Je=le+8|0,we=Gt,Je|0}for(m=23876;y=a[m>>2]|0,!(y>>>0<=q>>>0&&(Je=y+(a[m+4>>2]|0)|0,Je>>>0>q>>>0));)m=a[m+8>>2]|0;k=Je+-47|0,y=k+8|0,y=k+(y&7|0?0-y&7:0)|0,k=q+16|0,y=y>>>0<k>>>0?q:y,m=y+8|0,v=O+-40|0,st=R+8|0,st=st&7|0?0-st&7:0,ot=R+st|0,st=v-st|0,a[5863]=ot,a[5860]=st,a[ot+4>>2]=st|1,a[R+v+4>>2]=40,a[5864]=a[5979],v=y+4|0,a[v>>2]=27,a[m>>2]=a[5969],a[m+4>>2]=a[5970],a[m+8>>2]=a[5971],a[m+12>>2]=a[5972],a[5969]=R,a[5970]=O,a[5972]=0,a[5971]=m,m=y+24|0;do ot=m,m=m+4|0,a[m>>2]=7;while((ot+8|0)>>>0<Je>>>0);if((y|0)!=(q|0)){if(R=y-q|0,a[v>>2]=a[v>>2]&-2,a[q+4>>2]=R|1,a[y>>2]=R,m=R>>>3,R>>>0<256){v=23468+(m<<1<<2)|0,y=a[5857]|0,m=1<<m,y&m?(y=v+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=v,y=v+8|0),a[y>>2]=q,a[m+12>>2]=q,a[q+8>>2]=m,a[q+12>>2]=v;break}if(m=R>>>8,m?R>>>0>16777215?E=31:(ot=(m+1048320|0)>>>16&8,Je=m<<ot,st=(Je+520192|0)>>>16&4,Je=Je<<st,E=(Je+245760|0)>>>16&2,E=14-(st|ot|E)+(Je<<E>>>15)|0,E=R>>>(E+7|0)&1|E<<1):E=0,v=23732+(E<<2)|0,a[q+28>>2]=E,a[q+20>>2]=0,a[k>>2]=0,m=a[5858]|0,y=1<<E,!(m&y)){a[5858]=m|y,a[v>>2]=q,a[q+24>>2]=v,a[q+12>>2]=q,a[q+8>>2]=q;break}m=a[v>>2]|0;t:do if((a[m+4>>2]&-8|0)!=(R|0)){for(E=R<<((E|0)==31?0:25-(E>>>1)|0);v=m+16+(E>>>31<<2)|0,y=a[v>>2]|0,!!y;)if((a[y+4>>2]&-8|0)==(R|0)){m=y;break t}else E=E<<1,m=y;a[v>>2]=q,a[q+24>>2]=m,a[q+12>>2]=q,a[q+8>>2]=q;break e}while(0);ot=m+8|0,Je=a[ot>>2]|0,a[Je+12>>2]=q,a[ot>>2]=q,a[q+8>>2]=Je,a[q+12>>2]=m,a[q+24>>2]=0}}else Je=a[5861]|0,(Je|0)==0|R>>>0<Je>>>0&&(a[5861]=R),a[5969]=R,a[5970]=O,a[5972]=0,a[5866]=a[5975],a[5865]=-1,a[5870]=23468,a[5869]=23468,a[5872]=23476,a[5871]=23476,a[5874]=23484,a[5873]=23484,a[5876]=23492,a[5875]=23492,a[5878]=23500,a[5877]=23500,a[5880]=23508,a[5879]=23508,a[5882]=23516,a[5881]=23516,a[5884]=23524,a[5883]=23524,a[5886]=23532,a[5885]=23532,a[5888]=23540,a[5887]=23540,a[5890]=23548,a[5889]=23548,a[5892]=23556,a[5891]=23556,a[5894]=23564,a[5893]=23564,a[5896]=23572,a[5895]=23572,a[5898]=23580,a[5897]=23580,a[5900]=23588,a[5899]=23588,a[5902]=23596,a[5901]=23596,a[5904]=23604,a[5903]=23604,a[5906]=23612,a[5905]=23612,a[5908]=23620,a[5907]=23620,a[5910]=23628,a[5909]=23628,a[5912]=23636,a[5911]=23636,a[5914]=23644,a[5913]=23644,a[5916]=23652,a[5915]=23652,a[5918]=23660,a[5917]=23660,a[5920]=23668,a[5919]=23668,a[5922]=23676,a[5921]=23676,a[5924]=23684,a[5923]=23684,a[5926]=23692,a[5925]=23692,a[5928]=23700,a[5927]=23700,a[5930]=23708,a[5929]=23708,a[5932]=23716,a[5931]=23716,Je=O+-40|0,st=R+8|0,st=st&7|0?0-st&7:0,ot=R+st|0,st=Je-st|0,a[5863]=ot,a[5860]=st,a[ot+4>>2]=st|1,a[R+Je+4>>2]=40,a[5864]=a[5979];while(0);if(m=a[5860]|0,m>>>0>de>>>0)return st=m-de|0,a[5860]=st,Je=a[5863]|0,ot=Je+de|0,a[5863]=ot,a[ot+4>>2]=st|1,a[Je+4>>2]=de|3,Je=Je+8|0,we=Gt,Je|0}return Je=Zs()|0,a[Je>>2]=12,Je=0,we=Gt,Je|0}function A(y){y=y|0;var m=0,v=0,E=0,k=0,R=0,O=0,N=0,q=0;if(y){v=y+-8|0,k=a[5861]|0,y=a[y+-4>>2]|0,m=y&-8,q=v+m|0;do if(y&1)N=v,O=v;else{if(E=a[v>>2]|0,!(y&3)||(O=v+(0-E)|0,R=E+m|0,O>>>0<k>>>0))return;if((a[5862]|0)==(O|0)){if(y=q+4|0,m=a[y>>2]|0,(m&3|0)!=3){N=O,m=R;break}a[5859]=R,a[y>>2]=m&-2,a[O+4>>2]=R|1,a[O+R>>2]=R;return}if(v=E>>>3,E>>>0<256)if(y=a[O+8>>2]|0,m=a[O+12>>2]|0,(m|0)==(y|0)){a[5857]=a[5857]&~(1<<v),N=O,m=R;break}else{a[y+12>>2]=m,a[m+8>>2]=y,N=O,m=R;break}k=a[O+24>>2]|0,y=a[O+12>>2]|0;do if((y|0)==(O|0)){if(m=O+16|0,v=m+4|0,y=a[v>>2]|0,y)m=v;else if(y=a[m>>2]|0,!y){y=0;break}for(;;)if(E=y+20|0,v=a[E>>2]|0,v)y=v,m=E;else if(E=y+16|0,v=a[E>>2]|0,v)y=v,m=E;else break;a[m>>2]=0}else N=a[O+8>>2]|0,a[N+12>>2]=y,a[y+8>>2]=N;while(0);if(k){if(m=a[O+28>>2]|0,v=23732+(m<<2)|0,(a[v>>2]|0)==(O|0)){if(a[v>>2]=y,!y){a[5858]=a[5858]&~(1<<m),N=O,m=R;break}}else if(N=k+16|0,a[((a[N>>2]|0)==(O|0)?N:k+20|0)>>2]=y,!y){N=O,m=R;break}a[y+24>>2]=k,m=O+16|0,v=a[m>>2]|0,v|0&&(a[y+16>>2]=v,a[v+24>>2]=y),m=a[m+4>>2]|0,m?(a[y+20>>2]=m,a[m+24>>2]=y,N=O,m=R):(N=O,m=R)}else N=O,m=R}while(0);if(!(O>>>0>=q>>>0)&&(y=q+4|0,E=a[y>>2]|0,!!(E&1))){if(E&2)a[y>>2]=E&-2,a[N+4>>2]=m|1,a[O+m>>2]=m,k=m;else{if((a[5863]|0)==(q|0)){if(q=(a[5860]|0)+m|0,a[5860]=q,a[5863]=N,a[N+4>>2]=q|1,(N|0)!=(a[5862]|0))return;a[5862]=0,a[5859]=0;return}if((a[5862]|0)==(q|0)){q=(a[5859]|0)+m|0,a[5859]=q,a[5862]=O,a[N+4>>2]=q|1,a[O+q>>2]=q;return}k=(E&-8)+m|0,v=E>>>3;do if(E>>>0<256)if(m=a[q+8>>2]|0,y=a[q+12>>2]|0,(y|0)==(m|0)){a[5857]=a[5857]&~(1<<v);break}else{a[m+12>>2]=y,a[y+8>>2]=m;break}else{R=a[q+24>>2]|0,y=a[q+12>>2]|0;do if((y|0)==(q|0)){if(m=q+16|0,v=m+4|0,y=a[v>>2]|0,y)m=v;else if(y=a[m>>2]|0,!y){v=0;break}for(;;)if(E=y+20|0,v=a[E>>2]|0,v)y=v,m=E;else if(E=y+16|0,v=a[E>>2]|0,v)y=v,m=E;else break;a[m>>2]=0,v=y}else v=a[q+8>>2]|0,a[v+12>>2]=y,a[y+8>>2]=v,v=y;while(0);if(R|0){if(y=a[q+28>>2]|0,m=23732+(y<<2)|0,(a[m>>2]|0)==(q|0)){if(a[m>>2]=v,!v){a[5858]=a[5858]&~(1<<y);break}}else if(E=R+16|0,a[((a[E>>2]|0)==(q|0)?E:R+20|0)>>2]=v,!v)break;a[v+24>>2]=R,y=q+16|0,m=a[y>>2]|0,m|0&&(a[v+16>>2]=m,a[m+24>>2]=v),y=a[y+4>>2]|0,y|0&&(a[v+20>>2]=y,a[y+24>>2]=v)}}while(0);if(a[N+4>>2]=k|1,a[O+k>>2]=k,(N|0)==(a[5862]|0)){a[5859]=k;return}}if(y=k>>>3,k>>>0<256){v=23468+(y<<1<<2)|0,m=a[5857]|0,y=1<<y,m&y?(m=v+8|0,y=a[m>>2]|0):(a[5857]=m|y,y=v,m=v+8|0),a[m>>2]=N,a[y+12>>2]=N,a[N+8>>2]=y,a[N+12>>2]=v;return}y=k>>>8,y?k>>>0>16777215?E=31:(O=(y+1048320|0)>>>16&8,q=y<<O,R=(q+520192|0)>>>16&4,q=q<<R,E=(q+245760|0)>>>16&2,E=14-(R|O|E)+(q<<E>>>15)|0,E=k>>>(E+7|0)&1|E<<1):E=0,y=23732+(E<<2)|0,a[N+28>>2]=E,a[N+20>>2]=0,a[N+16>>2]=0,m=a[5858]|0,v=1<<E;e:do if(!(m&v))a[5858]=m|v,a[y>>2]=N,a[N+24>>2]=y,a[N+12>>2]=N,a[N+8>>2]=N;else{y=a[y>>2]|0;t:do if((a[y+4>>2]&-8|0)!=(k|0)){for(E=k<<((E|0)==31?0:25-(E>>>1)|0);v=y+16+(E>>>31<<2)|0,m=a[v>>2]|0,!!m;)if((a[m+4>>2]&-8|0)==(k|0)){y=m;break t}else E=E<<1,y=m;a[v>>2]=N,a[N+24>>2]=y,a[N+12>>2]=N,a[N+8>>2]=N;break e}while(0);O=y+8|0,q=a[O>>2]|0,a[q+12>>2]=N,a[O>>2]=N,a[N+8>>2]=q,a[N+12>>2]=y,a[N+24>>2]=0}while(0);if(q=(a[5865]|0)+-1|0,a[5865]=q,!(q|0)){for(y=23884;y=a[y>>2]|0,y;)y=y+8|0;a[5865]=-1}}}}function h(y,m){y=y|0,m=m|0;var v=0;return y?(v=an(m,y)|0,(m|y)>>>0>65535&&(v=((v>>>0)/(y>>>0)|0|0)==(m|0)?v:-1)):v=0,y=_(v)|0,!y||!(a[y+-4>>2]&3)||Te(y|0,0,v|0)|0,y|0}function d(y,m,v,E){return y=y|0,m=m|0,v=v|0,E=E|0,v=y+v>>>0,Mt(m+E+(v>>>0<y>>>0|0)>>>0|0),v|0|0}function x(y,m,v,E){return y=y|0,m=m|0,v=v|0,E=E|0,E=m-E-(v>>>0>y>>>0|0)>>>0,Mt(E|0),y-v>>>0|0|0}function b(y){return y=y|0,(y?31-(Oe(y^y-1)|0)|0:32)|0}function S(y,m,v,E,k){y=y|0,m=m|0,v=v|0,E=E|0,k=k|0;var R=0,O=0,N=0,q=0,J=0,le=0,de=0,Re=0,je=0,Be=0;if(le=y,q=m,J=q,O=v,Re=E,N=Re,!J)return R=(k|0)!=0,N?R?(a[k>>2]=y|0,a[k+4>>2]=m&0,Re=0,k=0,Mt(Re|0),k|0):(Re=0,k=0,Mt(Re|0),k|0):(R&&(a[k>>2]=(le>>>0)%(O>>>0),a[k+4>>2]=0),Re=0,k=(le>>>0)/(O>>>0)>>>0,Mt(Re|0),k|0);R=(N|0)==0;do if(O){if(!R){if(R=(Oe(N|0)|0)-(Oe(J|0)|0)|0,R>>>0<=31){de=R+1|0,N=31-R|0,m=R-31>>31,O=de,y=le>>>(de>>>0)&m|J<<N,m=J>>>(de>>>0)&m,R=0,N=le<<N;break}return k?(a[k>>2]=y|0,a[k+4>>2]=q|m&0,Re=0,k=0,Mt(Re|0),k|0):(Re=0,k=0,Mt(Re|0),k|0)}if(R=O-1|0,R&O|0){N=(Oe(O|0)|0)+33-(Oe(J|0)|0)|0,Be=64-N|0,de=32-N|0,q=de>>31,je=N-32|0,m=je>>31,O=N,y=de-1>>31&J>>>(je>>>0)|(J<<de|le>>>(N>>>0))&m,m=m&J>>>(N>>>0),R=le<<Be&q,N=(J<<Be|le>>>(je>>>0))&q|le<<de&N-33>>31;break}return k|0&&(a[k>>2]=R&le,a[k+4>>2]=0),(O|0)==1?(je=q|m&0,Be=y|0|0,Mt(je|0),Be|0):(Be=b(O|0)|0,je=J>>>(Be>>>0)|0,Be=J<<32-Be|le>>>(Be>>>0)|0,Mt(je|0),Be|0)}else{if(R)return k|0&&(a[k>>2]=(J>>>0)%(O>>>0),a[k+4>>2]=0),je=0,Be=(J>>>0)/(O>>>0)>>>0,Mt(je|0),Be|0;if(!le)return k|0&&(a[k>>2]=0,a[k+4>>2]=(J>>>0)%(N>>>0)),je=0,Be=(J>>>0)/(N>>>0)>>>0,Mt(je|0),Be|0;if(R=N-1|0,!(R&N))return k|0&&(a[k>>2]=y|0,a[k+4>>2]=R&J|m&0),je=0,Be=J>>>((b(N|0)|0)>>>0),Mt(je|0),Be|0;if(R=(Oe(N|0)|0)-(Oe(J|0)|0)|0,R>>>0<=30){m=R+1|0,N=31-R|0,O=m,y=J<<N|le>>>(m>>>0),m=J>>>(m>>>0),R=0,N=le<<N;break}return k?(a[k>>2]=y|0,a[k+4>>2]=q|m&0,je=0,Be=0,Mt(je|0),Be|0):(je=0,Be=0,Mt(je|0),Be|0)}while(0);if(!O)J=N,q=0,N=0;else{de=v|0|0,le=Re|E&0,J=d(de|0,le|0,-1,-1)|0,v=Ce()|0,q=N,N=0;do E=q,q=R>>>31|q<<1,R=N|R<<1,E=y<<1|E>>>31|0,Re=y>>>31|m<<1|0,x(J|0,v|0,E|0,Re|0)|0,Be=Ce()|0,je=Be>>31|((Be|0)<0?-1:0)<<1,N=je&1,y=x(E|0,Re|0,je&de|0,(((Be|0)<0?-1:0)>>31|((Be|0)<0?-1:0)<<1)&le|0)|0,m=Ce()|0,O=O-1|0;while(O|0);J=q,q=0}return O=0,k|0&&(a[k>>2]=y,a[k+4>>2]=m),je=(R|0)>>>31|(J|O)<<1|(O<<1|R>>>31)&0|q,Be=(R<<1|0)&-2|N,Mt(je|0),Be|0}function M(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0,J=0;return J=m>>31|((m|0)<0?-1:0)<<1,q=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,R=E>>31|((E|0)<0?-1:0)<<1,k=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,N=x(J^y|0,q^m|0,J|0,q|0)|0,O=Ce()|0,y=R^J,m=k^q,x((S(N,O,x(R^v|0,k^E|0,R|0,k|0)|0,Ce()|0,0)|0)^y|0,(Ce()|0)^m|0,y|0,m|0)|0}function B(y,m){y=y|0,m=m|0;var v=0,E=0,k=0,R=0;return R=y&65535,k=m&65535,v=an(k,R)|0,E=y>>>16,y=(v>>>16)+(an(k,E)|0)|0,k=m>>>16,m=an(k,R)|0,Mt((y>>>16)+(an(k,E)|0)+(((y&65535)+m|0)>>>16)|0),y+m<<16|v&65535|0|0}function V(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0;return k=y,R=v,v=B(k,R)|0,y=Ce()|0,Mt((an(m,R)|0)+(an(E,k)|0)+y|y&0|0),v|0|0|0}function j(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0,O=0,N=0,q=0,J=0;return k=we,we=we+16|0,N=k|0,O=m>>31|((m|0)<0?-1:0)<<1,R=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,J=E>>31|((E|0)<0?-1:0)<<1,q=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,y=x(O^y|0,R^m|0,O|0,R|0)|0,m=Ce()|0,S(y,m,x(J^v|0,q^E|0,J|0,q|0)|0,Ce()|0,N)|0,E=x(a[N>>2]^O|0,a[N+4>>2]^R|0,O|0,R|0)|0,v=Ce()|0,we=k,Mt(v|0),E|0}function Y(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var k=0,R=0;return R=we,we=we+16|0,k=R|0,S(y,m,v,E,k)|0,we=R,Mt(a[k+4>>2]|0),a[k>>2]|0|0}function ae(y,m,v){return y=y|0,m=m|0,v=v|0,(v|0)<32?(Mt(m>>v|0),y>>>v|(m&(1<<v)-1)<<32-v):(Mt(((m|0)<0?-1:0)|0),m>>v-32|0)}function ne(y,m,v){return y=y|0,m=m|0,v=v|0,(v|0)<32?(Mt(m>>>v|0),y>>>v|(m&(1<<v)-1)<<32-v):(Mt(0),m>>>v-32|0)}function ue(y,m,v){return y=y|0,m=m|0,v=v|0,(v|0)<32?(Mt(m<<v|(y&(1<<v)-1<<32-v)>>>32-v|0),y<<v):(Mt(y<<v-32|0),0)}function be(y,m){return y=+y,m=+m,y!=y?+m:m!=m?+y:+Ft(+y,+m)}function Me(y,m){return y=+y,m=+m,y!=y?+m:m!=m?+y:+xn(+y,+m)}function ve(y){return y=+y,y>=0?+Pe(y+.5):+qt(y-.5)}function $e(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0;if((v|0)>=8192)return ha(y|0,m|0,v|0)|0,y|0;if(R=y|0,k=y+v|0,(y&3)==(m&3)){for(;y&3;){if(!v)return R|0;he[y>>0]=he[m>>0]|0,y=y+1|0,m=m+1|0,v=v-1|0}for(v=k&-4|0,E=v-64|0;(y|0)<=(E|0);)a[y>>2]=a[m>>2],a[y+4>>2]=a[m+4>>2],a[y+8>>2]=a[m+8>>2],a[y+12>>2]=a[m+12>>2],a[y+16>>2]=a[m+16>>2],a[y+20>>2]=a[m+20>>2],a[y+24>>2]=a[m+24>>2],a[y+28>>2]=a[m+28>>2],a[y+32>>2]=a[m+32>>2],a[y+36>>2]=a[m+36>>2],a[y+40>>2]=a[m+40>>2],a[y+44>>2]=a[m+44>>2],a[y+48>>2]=a[m+48>>2],a[y+52>>2]=a[m+52>>2],a[y+56>>2]=a[m+56>>2],a[y+60>>2]=a[m+60>>2],y=y+64|0,m=m+64|0;for(;(y|0)<(v|0);)a[y>>2]=a[m>>2],y=y+4|0,m=m+4|0}else for(v=k-4|0;(y|0)<(v|0);)he[y>>0]=he[m>>0]|0,he[y+1>>0]=he[m+1>>0]|0,he[y+2>>0]=he[m+2>>0]|0,he[y+3>>0]=he[m+3>>0]|0,y=y+4|0,m=m+4|0;for(;(y|0)<(k|0);)he[y>>0]=he[m>>0]|0,y=y+1|0,m=m+1|0;return R|0}function Te(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,k=0,R=0,O=0;if(R=y+v|0,m=m&255,(v|0)>=67){for(;y&3;)he[y>>0]=m,y=y+1|0;for(E=R&-4|0,O=m|m<<8|m<<16|m<<24,k=E-64|0;(y|0)<=(k|0);)a[y>>2]=O,a[y+4>>2]=O,a[y+8>>2]=O,a[y+12>>2]=O,a[y+16>>2]=O,a[y+20>>2]=O,a[y+24>>2]=O,a[y+28>>2]=O,a[y+32>>2]=O,a[y+36>>2]=O,a[y+40>>2]=O,a[y+44>>2]=O,a[y+48>>2]=O,a[y+52>>2]=O,a[y+56>>2]=O,a[y+60>>2]=O,y=y+64|0;for(;(y|0)<(E|0);)a[y>>2]=O,y=y+4|0}for(;(y|0)<(R|0);)he[y>>0]=m,y=y+1|0;return R-v|0}function Ge(y){return y=+y,y>=0?+Pe(y+.5):+qt(y-.5)}function xe(y){y=y|0;var m=0,v=0,E=0;return E=ir()|0,v=a[ke>>2]|0,m=v+y|0,(y|0)>0&(m|0)<(v|0)|(m|0)<0?($a(m|0)|0,ui(12),-1):(m|0)>(E|0)&&!(De(m|0)|0)?(ui(12),-1):(a[ke>>2]=m,v|0)}return{___divdi3:M,___muldi3:V,___remdi3:j,___uremdi3:Y,_areNeighborCells:uu,_bitshift64Ashr:ae,_bitshift64Lshr:ne,_bitshift64Shl:ue,_calloc:h,_cellAreaKm2:Nt,_cellAreaM2:gu,_cellAreaRads2:hs,_cellToBoundary:pi,_cellToCenterChild:du,_cellToChildPos:cs,_cellToChildren:kA,_cellToChildrenSize:Fl,_cellToLatLng:wo,_cellToLocalIj:Ph,_cellToParent:Ol,_cellToVertex:hn,_cellToVertexes:Ji,_cellsToDirectedEdge:cu,_cellsToLinkedMultiPolygon:Dr,_childPosToCell:Ec,_compactCells:Nl,_destroyLinkedMultiPolygon:$l,_directedEdgeToBoundary:Vs,_directedEdgeToCells:ma,_edgeLengthKm:Yo,_edgeLengthM:mu,_edgeLengthRads:wa,_emscripten_replace_memory:Go,_free:A,_getBaseCellNumber:Za,_getDirectedEdgeDestination:ga,_getDirectedEdgeOrigin:xo,_getHexagonAreaAvgKm2:Gl,_getHexagonAreaAvgM2:Ja,_getHexagonEdgeLengthAvgKm:Ch,_getHexagonEdgeLengthAvgM:Mh,_getIcosahedronFaces:Ul,_getNumCells:el,_getPentagons:js,_getRes0Cells:CA,_getResolution:zl,_greatCircleDistanceKm:Vl,_greatCircleDistanceM:Zo,_greatCircleDistanceRads:Ki,_gridDisk:da,_gridDiskDistances:ni,_gridDistance:_u,_gridPathCells:xu,_gridPathCellsSize:vu,_gridRingUnsafe:bt,_i64Add:d,_i64Subtract:x,_isPentagon:mr,_isResClassIII:Rr,_isValidCell:ya,_isValidDirectedEdge:hu,_isValidVertex:$r,_latLngToCell:us,_llvm_maxnum_f64:be,_llvm_minnum_f64:Me,_llvm_round_f64:ve,_localIjToCell:Sc,_malloc:_,_maxFaceCount:Ya,_maxGridDiskSize:Ml,_maxPolygonToCellsSize:Qt,_memcpy:$e,_memset:Te,_originToDirectedEdges:fr,_pentagonCount:Xa,_polygonToCells:Ir,_readInt64AsDoubleFromPointer:bu,_res0CellCount:SA,_round:Ge,_sbrk:xe,_sizeOfCellBoundary:Cc,_sizeOfCoordIJ:Hl,_sizeOfGeoLoop:fs,_sizeOfGeoPolygon:Sr,_sizeOfH3Index:Nr,_sizeOfLatLng:jl,_sizeOfLinkedGeoPolygon:nl,_uncompactCells:wc,_uncompactCellsSize:Zr,_vertexToLatLng:Xo,establishStackSpace:fa,stackAlloc:Es,stackRestore:Ha,stackSave:ja}}(bs,yn,Ue);e.___divdi3=Ye.___divdi3,e.___muldi3=Ye.___muldi3,e.___remdi3=Ye.___remdi3,e.___uremdi3=Ye.___uremdi3,e._areNeighborCells=Ye._areNeighborCells,e._bitshift64Ashr=Ye._bitshift64Ashr,e._bitshift64Lshr=Ye._bitshift64Lshr,e._bitshift64Shl=Ye._bitshift64Shl,e._calloc=Ye._calloc,e._cellAreaKm2=Ye._cellAreaKm2,e._cellAreaM2=Ye._cellAreaM2,e._cellAreaRads2=Ye._cellAreaRads2,e._cellToBoundary=Ye._cellToBoundary,e._cellToCenterChild=Ye._cellToCenterChild,e._cellToChildPos=Ye._cellToChildPos,e._cellToChildren=Ye._cellToChildren,e._cellToChildrenSize=Ye._cellToChildrenSize,e._cellToLatLng=Ye._cellToLatLng,e._cellToLocalIj=Ye._cellToLocalIj,e._cellToParent=Ye._cellToParent,e._cellToVertex=Ye._cellToVertex,e._cellToVertexes=Ye._cellToVertexes,e._cellsToDirectedEdge=Ye._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=Ye._cellsToLinkedMultiPolygon,e._childPosToCell=Ye._childPosToCell,e._compactCells=Ye._compactCells,e._destroyLinkedMultiPolygon=Ye._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=Ye._directedEdgeToBoundary,e._directedEdgeToCells=Ye._directedEdgeToCells,e._edgeLengthKm=Ye._edgeLengthKm,e._edgeLengthM=Ye._edgeLengthM,e._edgeLengthRads=Ye._edgeLengthRads;var Qr=e._emscripten_replace_memory=Ye._emscripten_replace_memory;e._free=Ye._free,e._getBaseCellNumber=Ye._getBaseCellNumber,e._getDirectedEdgeDestination=Ye._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=Ye._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=Ye._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=Ye._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=Ye._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=Ye._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=Ye._getIcosahedronFaces,e._getNumCells=Ye._getNumCells,e._getPentagons=Ye._getPentagons,e._getRes0Cells=Ye._getRes0Cells,e._getResolution=Ye._getResolution,e._greatCircleDistanceKm=Ye._greatCircleDistanceKm,e._greatCircleDistanceM=Ye._greatCircleDistanceM,e._greatCircleDistanceRads=Ye._greatCircleDistanceRads,e._gridDisk=Ye._gridDisk,e._gridDiskDistances=Ye._gridDiskDistances,e._gridDistance=Ye._gridDistance,e._gridPathCells=Ye._gridPathCells,e._gridPathCellsSize=Ye._gridPathCellsSize,e._gridRingUnsafe=Ye._gridRingUnsafe,e._i64Add=Ye._i64Add,e._i64Subtract=Ye._i64Subtract,e._isPentagon=Ye._isPentagon,e._isResClassIII=Ye._isResClassIII,e._isValidCell=Ye._isValidCell,e._isValidDirectedEdge=Ye._isValidDirectedEdge,e._isValidVertex=Ye._isValidVertex,e._latLngToCell=Ye._latLngToCell,e._llvm_maxnum_f64=Ye._llvm_maxnum_f64,e._llvm_minnum_f64=Ye._llvm_minnum_f64,e._llvm_round_f64=Ye._llvm_round_f64,e._localIjToCell=Ye._localIjToCell,e._malloc=Ye._malloc,e._maxFaceCount=Ye._maxFaceCount,e._maxGridDiskSize=Ye._maxGridDiskSize,e._maxPolygonToCellsSize=Ye._maxPolygonToCellsSize,e._memcpy=Ye._memcpy,e._memset=Ye._memset,e._originToDirectedEdges=Ye._originToDirectedEdges,e._pentagonCount=Ye._pentagonCount,e._polygonToCells=Ye._polygonToCells,e._readInt64AsDoubleFromPointer=Ye._readInt64AsDoubleFromPointer,e._res0CellCount=Ye._res0CellCount,e._round=Ye._round,e._sbrk=Ye._sbrk,e._sizeOfCellBoundary=Ye._sizeOfCellBoundary,e._sizeOfCoordIJ=Ye._sizeOfCoordIJ,e._sizeOfGeoLoop=Ye._sizeOfGeoLoop,e._sizeOfGeoPolygon=Ye._sizeOfGeoPolygon,e._sizeOfH3Index=Ye._sizeOfH3Index,e._sizeOfLatLng=Ye._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=Ye._sizeOfLinkedGeoPolygon,e._uncompactCells=Ye._uncompactCells,e._uncompactCellsSize=Ye._uncompactCellsSize,e._vertexToLatLng=Ye._vertexToLatLng,e.establishStackSpace=Ye.establishStackSpace;var Ns=e.stackAlloc=Ye.stackAlloc,Or=e.stackRestore=Ye.stackRestore,Ai=e.stackSave=Ye.stackSave;if(e.asm=Ye,e.cwrap=se,e.setValue=U,e.getValue=W,qn){mo(qn)||(qn=s(qn));{Gn();var Xn=function(K){K.byteLength&&(K=new Uint8Array(K)),Ze.set(K,I),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Pi()},Us=function(){l(qn,Xn,function(){throw"could not load memory initializer "+qn})},$i=Lr(qn);if($i)Xn($i.buffer);else if(e.memoryInitializerRequest){var ji=function(){var K=e.memoryInitializerRequest,Q=K.response;if(K.status!==200&&K.status!==0){var te=Lr(e.memoryInitializerRequestURL);if(te)Q=te.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+K.status+", retrying "+qn),Us();return}}Xn(Q)};e.memoryInitializerRequest.response?setTimeout(ji,0):e.memoryInitializerRequest.addEventListener("load",ji)}else Us()}}var Di;ti=function K(){Di||ls(),Di||(ti=K)};function ls(K){if(rr>0||(Vn(),rr>0))return;function Q(){Di||(Di=!0,!H&&(Tr(),wt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),rn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),Q()},1)):Q()}e.run=ls;function Fr(K){throw e.onAbort&&e.onAbort(K),K+="",o(K),p(K),H=!0,"abort("+K+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Fr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return ls(),t}(typeof Ui=="object"?Ui:{}),Yn="number",Rn=Yn,jp=Yn,Nn=Yn,Un=Yn,so=Yn,fn=Yn,Rme=[["sizeOfH3Index",Yn],["sizeOfLatLng",Yn],["sizeOfCellBoundary",Yn],["sizeOfGeoLoop",Yn],["sizeOfGeoPolygon",Yn],["sizeOfLinkedGeoPolygon",Yn],["sizeOfCoordIJ",Yn],["readInt64AsDoubleFromPointer",Yn],["isValidCell",jp,[Nn,Un]],["latLngToCell",Rn,[Yn,Yn,so,fn]],["cellToLatLng",Rn,[Nn,Un,fn]],["cellToBoundary",Rn,[Nn,Un,fn]],["maxGridDiskSize",Rn,[Yn,fn]],["gridDisk",Rn,[Nn,Un,Yn,fn]],["gridDiskDistances",Rn,[Nn,Un,Yn,fn,fn]],["gridRingUnsafe",Rn,[Nn,Un,Yn,fn]],["maxPolygonToCellsSize",Rn,[fn,so,Yn,fn]],["polygonToCells",Rn,[fn,so,Yn,fn]],["cellsToLinkedMultiPolygon",Rn,[fn,Yn,fn]],["destroyLinkedMultiPolygon",null,[fn]],["compactCells",Rn,[fn,fn,Yn,Yn]],["uncompactCells",Rn,[fn,Yn,Yn,fn,Yn,so]],["uncompactCellsSize",Rn,[fn,Yn,Yn,so,fn]],["isPentagon",jp,[Nn,Un]],["isResClassIII",jp,[Nn,Un]],["getBaseCellNumber",Yn,[Nn,Un]],["getResolution",Yn,[Nn,Un]],["maxFaceCount",Rn,[Nn,Un,fn]],["getIcosahedronFaces",Rn,[Nn,Un,fn]],["cellToParent",Rn,[Nn,Un,so,fn]],["cellToChildren",Rn,[Nn,Un,so,fn]],["cellToCenterChild",Rn,[Nn,Un,so,fn]],["cellToChildrenSize",Rn,[Nn,Un,so,fn]],["cellToChildPos",Rn,[Nn,Un,so,fn]],["childPosToCell",Rn,[Yn,Yn,Nn,Un,so,fn]],["areNeighborCells",Rn,[Nn,Un,Nn,Un,fn]],["cellsToDirectedEdge",Rn,[Nn,Un,Nn,Un,fn]],["getDirectedEdgeOrigin",Rn,[Nn,Un,fn]],["getDirectedEdgeDestination",Rn,[Nn,Un,fn]],["isValidDirectedEdge",jp,[Nn,Un]],["directedEdgeToCells",Rn,[Nn,Un,fn]],["originToDirectedEdges",Rn,[Nn,Un,fn]],["directedEdgeToBoundary",Rn,[Nn,Un,fn]],["gridDistance",Rn,[Nn,Un,Nn,Un,fn]],["gridPathCells",Rn,[Nn,Un,Nn,Un,fn]],["gridPathCellsSize",Rn,[Nn,Un,Nn,Un,fn]],["cellToLocalIj",Rn,[Nn,Un,Nn,Un,Yn,fn]],["localIjToCell",Rn,[Nn,Un,fn,Yn,fn]],["getHexagonAreaAvgM2",Rn,[so,fn]],["getHexagonAreaAvgKm2",Rn,[so,fn]],["getHexagonEdgeLengthAvgM",Rn,[so,fn]],["getHexagonEdgeLengthAvgKm",Rn,[so,fn]],["greatCircleDistanceM",Yn,[fn,fn]],["greatCircleDistanceKm",Yn,[fn,fn]],["greatCircleDistanceRads",Yn,[fn,fn]],["cellAreaM2",Rn,[Nn,Un,fn]],["cellAreaKm2",Rn,[Nn,Un,fn]],["cellAreaRads2",Rn,[Nn,Un,fn]],["edgeLengthM",Rn,[Nn,Un,fn]],["edgeLengthKm",Rn,[Nn,Un,fn]],["edgeLengthRads",Rn,[Nn,Un,fn]],["getNumCells",Rn,[so,fn]],["getRes0Cells",Rn,[fn]],["res0CellCount",Yn],["getPentagons",Rn,[Yn,fn]],["pentagonCount",Yn],["cellToVertex",Rn,[Nn,Un,Yn,fn]],["cellToVertexes",Rn,[Nn,Un,fn]],["vertexToLatLng",Rn,[Nn,Un,fn]],["isValidVertex",jp,[Nn,Un]]],Bme=0,zme=1,Ome=2,Fme=3,y7=4,Nme=5,Ume=6,Vme=7,Gme=8,$me=9,jme=10,Hme=11,Wme=12,Qme=13,qme=14,Zme=15,Os={};Os[Bme]="Success";Os[zme]="The operation failed but a more specific error is not available";Os[Ome]="Argument was outside of acceptable range";Os[Fme]="Latitude or longitude arguments were outside of acceptable range";Os[y7]="Resolution argument was outside of acceptable range";Os[Nme]="Cell argument was not valid";Os[Ume]="Directed edge argument was not valid";Os[Vme]="Undirected edge argument was not valid";Os[Gme]="Vertex argument was not valid";Os[$me]="Pentagon distortion was encountered";Os[jme]="Duplicate input";Os[Hme]="Cell arguments were not neighbors";Os[Wme]="Cell arguments had incompatible resolutions";Os[Qme]="Memory allocation failed";Os[qme]="Bounds of provided memory were insufficient";Os[Zme]="Mode or flags argument was not valid";var Dv=1e3,Yme=1001,Xme=1002,Rv={};Rv[Dv]="Unknown unit";Rv[Yme]="Array length out of bounds";Rv[Xme]="Got unexpected null value for H3 index";var Kme="Unknown error";function _7(t,e,n){var r=n&&"value"in n,i=new Error((t[e]||Kme)+" (code: "+e+(r?", value: "+n.value:"")+")");return i.code=e,i}function v7(t,e){var n=arguments.length===2?{value:e}:{};return _7(Os,t,n)}function u4(t,e){var n=arguments.length===2?{value:e}:{};return _7(Rv,t,n)}function nu(t){if(t!==0)throw v7(t)}var xs={};Rme.forEach(function(e){xs[e[0]]=Ui.cwrap.apply(Ui,e)});var $0=16,Jme=4,wh=8,zE=xs.sizeOfH3Index(),e1e=xs.sizeOfLatLng(),t1e=xs.sizeOfCellBoundary();xs.sizeOfGeoPolygon();xs.sizeOfGeoLoop();xs.sizeOfLinkedGeoPolygon();xs.sizeOfCoordIJ();var Cr={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function x7(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw v7(y7,t);return t}var n1e=/[^0-9a-fA-F]/;function Bv(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||n1e.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),$0),n=parseInt(t.substring(t.length-8),$0);return[n,e]}function b8(t){if(t>=0)return t.toString($0);t=t&2147483647;var e=w7(8,t.toString($0)),n=(parseInt(e[0],$0)+8).toString($0);return e=n+e.substring(1),e}function r1e(t,e){return b8(e)+w7(8,b8(t))}function w7(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function i1e(t,e){e===void 0&&(e=0);var n=Ui.getValue(t+zE*e,"i32"),r=Ui.getValue(t+zE*e+Jme,"i32");return r?r1e(n,r):null}function c4(t,e){return e===void 0&&(e=0),Ui.getValue(t+wh*e,"double")}function s1e(t,e){for(var n=[],r=0;r<e;r++){var i=i1e(t,r);i!==null&&n.push(i)}return n}function B2(t){return A1e(Ui.getValue(t,"double"))}function b7(t){return[B2(t),B2(t+wh)]}function o1e(t){return[B2(t+wh),B2(t)]}function a1e(t,e,n){for(var r=Ui.getValue(t,"i32"),i=t+wh,s=[],l=e?o1e:b7,o=0;o<r*2;o+=2)s.push(l(i+wh*o));return n&&s.push(s[0]),s}function E7(t){var e=Ui._malloc(e1e),n=Bv(t),r=n[0],i=n[1];try{return nu(xs.cellToLatLng(r,i,e)),b7(e)}finally{Ui._free(e)}}function l1e(t,e){var n=Ui._malloc(t1e),r=Bv(t),i=r[0],s=r[1];try{return nu(xs.cellToBoundary(i,s,n)),a1e(n,e,e)}finally{Ui._free(n)}}function E8(t){var e=Bv(t),n=e[0],r=e[1],i=6,s=Ui._calloc(i,zE);try{return nu(xs.originToDirectedEdges(n,r,s)),s1e(s,i)}finally{Ui._free(s)}}function T8(t,e){var n=Bv(t),r=n[0],i=n[1],s=Ui._malloc(wh);try{switch(e){case Cr.m:nu(xs.edgeLengthM(r,i,s));break;case Cr.km:nu(xs.edgeLengthKm(r,i,s));break;case Cr.rads:nu(xs.edgeLengthRads(r,i,s));break;default:throw u4(Dv,e)}return c4(s)}finally{Ui._free(s)}}function fc(t,e){x7(t);var n=Ui._malloc(wh);try{switch(e){case Cr.m2:nu(xs.getHexagonAreaAvgM2(t,n));break;case Cr.km2:nu(xs.getHexagonAreaAvgKm2(t,n));break;default:throw u4(Dv,e)}return c4(n)}finally{Ui._free(n)}}function ia(t,e){x7(t);var n=Ui._malloc(wh);try{switch(e){case Cr.m:nu(xs.getHexagonEdgeLengthAvgM(t,n));break;case Cr.km:nu(xs.getHexagonEdgeLengthAvgKm(t,n));break;default:throw u4(Dv,e)}return c4(n)}finally{Ui._free(n)}}function A1e(t){return t*180/Math.PI}function u1e({res:t}){const e=Ne.useRef(),n=Ne.useRef();return Ne.useLayoutEffect(()=>{const r=window.innerHeight,i=800,s=mi(e.current).attr("width",i).attr("height",r);s.append("g").call(Aa.arcmapLegend().vtitle("Groundwater").utitle("Variance").scale(Ar.groundwater.vsup).size(150).x(i-180).y(r-470));let l=i-600,o=r-150;s.append("g").attr("transform",`translate(${l},${o})`).call(t7(Ar.difference)),l=i-600,o=r-275,s.append("g").attr("transform",`translate(${l},${o})`).call(e7(Ar.unmetDemand)),s.append("g").call(Vm(i-100,r-100,70,"rgba(146, 146, 146, 0.5)")).call(function(p){n.current=[p.append("text").attr("x",i-100).attr("y",r-92).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${Math.round(fc(t,Cr.km2))} km`),p.append("text").attr("x",i-100).attr("y",r-50).attr("text-anchor","middle").style("font-size","11px").text(` ${Math.round(ia(t,Cr.km))} km ;`)]})},[]),Ne.useEffect(()=>{let[r,i]=n.current;r.text(`${Math.round(fc(t,Cr.km2))} km`),i.text(` ${Math.round(ia(t,Cr.km))} km ;`)},[t]),nt.createElement("svg",{className:"legend-area",ref:e})}function c1e({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s,res:l}){return nt.createElement(nt.Fragment,null,nt.createElement(Lv,{counter:n,displayMonth:!1,dataset:"averageDemandBaseline"}),nt.createElement(u1e,{res:l}),nt.createElement("div",{className:"styled-input"},nt.createElement("button",{onClick:()=>{s(o=>!o)}},i?"Pause":"Play"),nt.createElement("div",null,nt.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:n,onChange:function(o){r(parseInt(o.target.value))}}),nt.createElement("input",{onChange:function(o){s(!1),r(parseInt(o.target.value))},onInput:function(o){r(parseInt(o.target.value))},value:n,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))))}const h1e=/^[og]\s*(.+)?/,f1e=/^mtllib /,d1e=/^usemtl /;class h4{constructor(e){let{index:n,name:r="",mtllib:i,smooth:s,groupStart:l}=e;this.index=n,this.name=r,this.mtllib=i,this.smooth=s,this.groupStart=l,this.groupEnd=-1,this.groupCount=-1,this.inherited=!1}clone(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.index;return new h4({index:e,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0})}}class p1e{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.name=e,this.geometry={vertices:[],normals:[],colors:[],uvs:[]},this.materials=[],this.smooth=!0,this.fromDeclaration=null}startMaterial(e,n){const r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);const i=new h4({index:this.materials.length,name:e,mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:r!==void 0?r.smooth:this.smooth,groupStart:r!==void 0?r.groupEnd:0});return this.materials.push(i),i}currentMaterial(){if(this.materials.length>0)return this.materials[this.materials.length-1]}_finalize(e){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),e&&this.materials.length>1)for(let r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}}class g1e{constructor(){this.objects=[],this.object=null,this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.materialLibraries=[],this.startObject("",!1)}startObject(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.object&&!this.object.fromDeclaration){this.object.name=e,this.object.fromDeclaration=n;return}const r=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object=new p1e(e),this.object.fromDeclaration=n,r&&r.name&&typeof r.clone=="function"){const i=r.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)}finalize(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)}parseVertexIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/3)*3}parseNormalIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/3)*3}parseUVIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/2)*2}addVertex(e,n,r){const i=this.vertices,s=this.object.geometry.vertices;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addVertexPoint(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addVertexLine(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addNormal(e,n,r){const i=this.normals,s=this.object.geometry.normals;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addColor(e,n,r){const i=this.colors,s=this.object.geometry.colors;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addUV(e,n,r){const i=this.uvs,s=this.object.geometry.uvs;s.push(i[e+0],i[e+1]),s.push(i[n+0],i[n+1]),s.push(i[r+0],i[r+1])}addUVLine(e){const n=this.uvs;this.object.geometry.uvs.push(n[e+0],n[e+1])}addFace(e,n,r,i,s,l,o,p,w){const C=this.vertices.length;let P=this.parseVertexIndex(e,C),I=this.parseVertexIndex(n,C),U=this.parseVertexIndex(r,C);if(this.addVertex(P,I,U),i!==void 0&&i!==""){const W=this.uvs.length;P=this.parseUVIndex(i,W),I=this.parseUVIndex(s,W),U=this.parseUVIndex(l,W),this.addUV(P,I,U)}if(o!==void 0&&o!==""){const W=this.normals.length;P=this.parseNormalIndex(o,W),I=o===p?P:this.parseNormalIndex(p,W),U=o===w?P:this.parseNormalIndex(w,W),this.addNormal(P,I,U)}this.colors.length>0&&this.addColor(P,I,U)}addPointGeometry(e){this.object.geometry.type="Points";const n=this.vertices.length;for(const r of e)this.addVertexPoint(this.parseVertexIndex(r,n))}addLineGeometry(e,n){this.object.geometry.type="Line";const r=this.vertices.length,i=this.uvs.length;for(const s of e)this.addVertexLine(this.parseVertexIndex(s,r));for(const s of n)this.addUVLine(this.parseUVIndex(s,i))}}function m1e(t){const e=new g1e;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let r="",i="",s=0,l=[];const o=typeof"".trimLeft=="function";for(let C=0,P=n.length;C<P;C++)if(r=n[C],r=o?r.trimLeft():r.trim(),s=r.length,s!==0&&(i=r.charAt(0),i!=="#"))if(i==="v"){const I=r.split(/\s+/);switch(I[0]){case"v":e.vertices.push(parseFloat(I[1]),parseFloat(I[2]),parseFloat(I[3])),I.length>=7&&e.colors.push(parseFloat(I[4]),parseFloat(I[5]),parseFloat(I[6]));break;case"vn":e.normals.push(parseFloat(I[1]),parseFloat(I[2]),parseFloat(I[3]));break;case"vt":e.uvs.push(parseFloat(I[1]),parseFloat(I[2]));break}}else if(i==="f"){const U=r.substr(1).trim().split(/\s+/),W=[];for(let ie=0,X=U.length;ie<X;ie++){const ee=U[ie];if(ee.length>0){const se=ee.split("/");W.push(se)}}const H=W[0];for(let ie=1,X=W.length-1;ie<X;ie++){const ee=W[ie],se=W[ie+1];e.addFace(H[0],ee[0],se[0],H[1],ee[1],se[1],H[2],ee[2],se[2])}}else if(i==="l"){const I=r.substring(1).trim().split(" ");let U;const W=[];if(r.indexOf("/")===-1)U=I;else{U=[];for(let H=0,ie=I.length;H<ie;H++){const X=I[H].split("/");X[0]!==""&&U.push(X[0]),X[1]!==""&&W.push(X[1])}}e.addLineGeometry(U,W)}else if(i==="p"){const U=r.substr(1).trim().split(" ");e.addPointGeometry(U)}else if((l=h1e.exec(r))!==null){const I=(" "+l[0].substr(1).trim()).substr(1);e.startObject(I)}else if(d1e.test(r))e.object.startMaterial(r.substring(7).trim(),e.materialLibraries);else if(f1e.test(r))e.materialLibraries.push(r.substring(7).trim());else if(i==="s"){if(l=r.split(" "),l.length>1){const U=l[1].trim().toLowerCase();e.object.smooth=U!=="0"&&U!=="off"}else e.object.smooth=!0;const I=e.object.currentMaterial();I&&(I.smooth=e.object.smooth)}else{if(r==="\0")continue;throw new Error('Unexpected line: "'.concat(r,'"'))}e.finalize();const p=[],w=[];for(const C of e.objects){const{geometry:P}=C;if(P.vertices.length===0)continue;const I={header:{vertexCount:P.vertices.length/3},attributes:{}};switch(P.type){case"Points":I.mode=0;break;case"Line":I.mode=1;break;default:I.mode=4;break}I.attributes.POSITION={value:new Float32Array(P.vertices),size:3},P.normals.length>0&&(I.attributes.NORMAL={value:new Float32Array(P.normals),size:3}),P.colors.length>0&&(I.attributes.COLOR_0={value:new Float32Array(P.colors),size:3}),P.uvs.length>0&&(I.attributes.TEXCOORD_0={value:new Float32Array(P.uvs),size:2}),I.materials=[];for(const U of C.materials){const W={name:U.name,flatShading:!U.smooth};I.materials.push(W),w.push(W)}I.name=C.name,p.push(I)}return{meshes:p,materials:w}}function y1e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;for(const i in e)n=n||new Map,i!=="value"&&n.set(i,JSON.stringify(e[i]));const r=[];for(const i in t){const s=t[i],l=_1e(i,s);r.push(l)}return new O0(r,n)}function _1e(t,e){const n=new Map;for(const s in e)s!=="value"&&n.set(s,JSON.stringify(e[s]));const r=Vce(e.value);return!("size"in e)||e.size===1?new vg(t,r,!1,n):new vg(t,new Uce(e.size,new vg("value",r)),!1,n)}function S8(t,e){const{meshes:n}=m1e(t),r=n.reduce((o,p)=>o+p.header.vertexCount,0),i=v1e(n,r),s={vertexCount:r,boundingBox:QO(i)},l=y1e(i,{mode:4,boundingBox:s.boundingBox});return{loaderData:{header:{}},schema:l,header:s,mode:4,attributes:i}}function v1e(t,e){const n=new Float32Array(e*3);let r,i,s,l=0;for(const p of t){const{POSITION:w,NORMAL:C,COLOR_0:P,TEXCOORD_0:I}=p.attributes;n.set(w.value,l*3),C&&(r=r||new Float32Array(e*3),r.set(C.value,l*3)),P&&(i=i||new Float32Array(e*3),i.set(P.value,l*3)),I&&(s=s||new Float32Array(e*2),s.set(I.value,l*2)),l+=w.value.length/3}const o={};return o.POSITION={value:n,size:3},r&&(o.NORMAL={value:r,size:3}),i&&(o.COLOR_0={value:i,size:3}),s&&(o.TEXCOORD_0={value:s,size:2}),o}const x1e="3.4.14",w1e={name:"OBJ",id:"obj",module:"obj",version:x1e,worker:!0,extensions:["obj"],mimeTypes:["text/plain"],testText:b1e,options:{obj:{}}};function b1e(t){return t[0]==="v"}const qd={...w1e,parse:async(t,e)=>S8(new TextDecoder().decode(t)),parseTextSync:(t,e)=>S8(t)},E1e=_s().domain([0,1]).range(Wg(0,ul.length)),T1e=ul[0];class Sh extends Bn{initializeState(){super.initializeState();const{zoom:e}=this.context.viewport,n=Object.keys(this.props.data).map(s=>parseInt(s)),r=Br().domain(this.props.zoomRange).range([0,1]).clamp(!0),i=_s().domain([0,1]).range(n)(r(e));this.setState({hextiles:this.props.data,resRange:n,lastResolution:i,valueInterpResolution:r}),this.createPolygons()}createPolygons(){const{hextiles:e,lastResolution:n}=this.state,r=[],i=e[n],[s,l]=this.props.offset;Object.keys(i).forEach(o=>{const p=i[o],w=T8(E8(o)[0],Cr.km)*.48,[C,P]=E7(o);let I=0;const U=ia(n,Cr.km)/ia(5,Cr.km);for(let[W,H,ie]of this.props.getValue?T1e:[[0,0,0]])r.push({position:[P+(W+s)*w/(111.32*Math.cos(C*Math.PI/180)),C+(H+l)*w/110.574,(typeof this.props.getElevation=="function"?this.props.getElevation({properties:p}):this.props.getElevation)+ie*1e5*U],properties:p,polyIdx:I++,hexID:o})}),this.setState({...this.state,polygons:r})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:l,changeFlags:o,context:p}=e;if(s.getElevation!=l.getElevation||o.viewportChanged){const w=_s().domain([0,1]).range(n)(i(p.viewport.zoom));(w!=r||s.getElevation!=l.getElevation)&&(this.setState({...this.state,lastResolution:w}),this.createPolygons())}}renderLayers(){const{polygons:e,lastResolution:n,resRange:r}=this.state,i=ia(n,Cr.km)/ia(5,Cr.km);return[new yv(this.getSubLayerProps({data:this.props.data,mesh:this.props.mesh,texture:this.props.texture,textureParameters:this.props.textureParameters,getPosition:this.props.getPosition,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,sizeScale:this.props.sizeScale,_useMeshColors:this.props._useMeshColors,_instanced:this.props._instanced,wireframe:this.props.wireframe,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,id:"IconHexTileLayer",data:e,getPosition:s=>s.position,sizeScale:this.props.sizeScale*i,getTranslation:this.props.getValue===null?[0,0,0]:s=>{const l=ul[E1e(this.props.getValue(s))][s.polyIdx],o=ul[0][s.polyIdx],p=T8(E8(s.hexID)[0],Cr.m)*.5;return[(l[0]-o[0])*p,(l[1]-o[1])*p,(l[2]-o[2])*1e5*i]}}))]}}Sh.layerName="IconHexTileLayer";Sh.defaultProps={...Bn.defaultProps,...yv.defaultProps,thicknessRange:[.7,.9],getValue:null,getElevation:()=>0,offset:[0,0],zoomRange:[7,9]};function C8(t,e,n=1){const r=n,[i,s]=E7(t);return e.map(o=>{let p=xl(s,o[0],r),w=xl(i,o[1],r);return[p,w]})}function S1e(t,[e,n]){let r=l1e(t).map(l=>[l[1],l[0]]),i=C8(t,r,n),s=C8(t,r,e);return[i,s]}class fo extends Bn{initializeState(){super.initializeState();const e=Object.keys(this.props.data).map(i=>parseInt(i)),n=Br().domain(this.props.zoomRange).range([0,1]).clamp(!0),r=_s().domain([0,1]).range(e)(n(this.context.viewport.zoom));this.setState({...this.state,resRange:e,lastResolution:r,valueInterpResolution:n}),this.createPolygons()}createPolygons(){const{lastResolution:e}=this.state,n=[],r=this.props.data[e];Object.keys(r).forEach((i,s)=>{let l=r[i];const o=this.props.getValue?Br().domain([0,1]).range([this.props.thicknessRange[1],this.props.thicknessRange[0]])(this.props.getValue({properties:l})):this.props.thicknessRange[0];let p=S1e(i,[o,this.props.thicknessRange[1]]);this.props.raised?n.push({polygon:p.map(w=>w.map(([C,P])=>[C,P,typeof this.props.getElevation=="function"?this.props.getElevation({hexId:i,properties:l}):this.props.getElevation])),hexId:i,properties:l}):n.push({hexId:i,polygon:p,properties:l})}),this.setState({...this.state,polygons:n})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:l,changeFlags:o,context:p}=e;if(s.getElevation!=l.getElevation||s.getValue!=l.getValue||o.viewportChanged){const w=_s().domain([0,1]).range(n)(i(p.viewport.zoom));(w!=r||s.getValue!=l.getValue||s.getElevation!=l.getElevation)&&(this.setState({...this.state,lastResolution:w}),this.createPolygons())}}renderLayers(){return[new Vf(this.getSubLayerProps({data:this.props.data,filled:this.props.filled,stroked:this.props.stroked,extruded:this.props.extruded,wireframe:this.props.wireframe,_normalize:this.props._normalize,_windingOrder:this.props._windingOrder,_full3d:this.props._full3d,elevationScale:this.props.elevationScale,getPolygon:this.props.getPolygon,getElevation:this.props.getElevation,getFillColor:this.props.getFillColor,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,onClick:this.props.onClick,id:"SolidHexTileLayer",data:this.state.polygons,getPolygon:e=>e.polygon,pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,extensions:this.props.extensions,getOffset:this.props.getOffset,lineJointRounded:this.props.lineJointRounded}))]}}fo.layerName="SolidHexTileLayer";fo.defaultProps={...Bn.defaultProps,...Vf.defaultProps,thicknessRange:[.7,.9],getValue:void 0,raised:!1,zoomRange:[7,9]};class Zd extends Bn{renderLayers(){const{data:e,deagData:n,curOption:r,hoveredHex:i,visible:s,clickedHexes:l,hoveredGeoActive:o,hoveredGeos:p,selectedGeoJSON:w,selectedGeos:C,selectionFinalized:P,zoomRange:I,getFillColor:U}=this.props;return[new Ni({id:"GeoJsonGray",data:n,opacity:.3,stroked:!1,getFillColor:W=>!P&&W.properties.id in p?[100,100,100,205*p[W.properties.id]+50]:[0,0,0,0],visible:s&&!P,updateTriggers:{getFillColor:[i,P]}}),new Ni({id:"GeoJsonColor",data:n,opacity:1,pickable:!0,visible:s,getLineWidth:W=>W.properties.id in C?W.properties.id==o?100:20:0,getFillColor:W=>{if(W.properties.id in C){if(W.properties.id==o){const H=[0,0,.5019607843137255,.5019607843137255],ie=[...U({properties:C[W.properties.id]}),255];return[(H[0]*H[3]+ie[0]/255*(1-H[3]))*255,(H[1]*H[3]+ie[1]/255*(1-H[3]))*255,(H[2]*H[3]+ie[2]/255*(1-H[3]))*255,(H[3]*H[3]+ie[3]/255*(1-H[3]))*255]}return[...U({properties:C[W.properties.id]}),255]}return[0,0,0,0]},getLineColor:[0,0,0],updateTriggers:{getFillColor:[...this.props.updateTriggers.getFillColor||[],o,r,P],getLineWidth:[o,r,P]}}),new fo({id:"HoveringTiles",data:e,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:!P,autoHighlight:!P,visible:s,zoomRange:I})]}}Zd.layerName="DeaggregatedLayer";Zd.defaultProps={...Bn.defaultProps,autoHighlight:!0};const Gh=0;let f4=class extends Bn{renderLayers(){const{data:e,curOption:n,speedyCounter:r,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new fo({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:p=>Ar.groundwater.interpVsup(p.properties.Groundwater[r],p.properties.GroundwaterVar[r]),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o}),new fo({id:"DiffRings",data:e,thicknessRange:[.4,.65],getFillColor:p=>n==0?Ar.difference.interpVsup(p.properties.UnmetDemand[dr[Gh]][r]-p.properties.UnmetDemandBaseline[r],kd(p.properties.UnmetDemandBaselineVar[r],p.properties.UnmetDemandVar[dr[Gh]][r]),!0):Ar.difference.interpColor(p.properties.UnmetDemand[dr[Gh]][r]-p.properties.UnmetDemandBaseline[r],!0),getValue:p=>n==0?1:Ar.difference.scaleLinearVar(kd(p.properties.UnmetDemandBaselineVar[r],p.properties.UnmetDemandVar[dr[Gh]][r]))*.8+.2,raised:!0,visible:l,getElevation:p=>p.hexId in i?5e3:0,getLineWidth:p=>p.hexId in i?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new Gf({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r],getElevation:[s],getLineWidth:[s]},zoomRange:o}),new Sh({id:"ScenarioUnmet",data:e,loaders:[qd],mesh:"./assets/drop.obj",raised:!0,getColor:p=>[255,130,35,Ar.unmetDemand.scaleLinearVar(p.properties.UnmetDemandVar[dr[Gh]][r])*200+55],getValue:p=>Ar.unmetDemand.scaleLinear(p.properties.UnmetDemand[dr[Gh]][r]),visible:l,sizeScale:3e3,opacity:1,updateTriggers:{getTranslation:[r]},zoomRange:o}),new Zd({...this.props,id:"DeagLayer",data:e,deagData:El,getFillColor:p=>Ar.unmetDemand.interpColor(p.properties.UnmetDemand[dr[Gh]][r],!1,!1),updateTriggers:{getFillColor:[r]}})]}};f4.layerName="MultivariableHextileLayer";f4.defaultProps={...Bn.defaultProps,autoHighlight:!0};function C1e(){const{current:t}=Ne.useRef(Object.keys(Ld).map(o=>parseInt(o))),[e,n]=Ne.useState(Id.zoom),r=Cv(),i=jf({disabled:r.curOption>1,dataDeag:El,deagKey:"DURgs"}),{getTooltip:s}=A4(r),l={data:Ld,...r,...i};return nt.createElement(nt.Fragment,null,nt.createElement(gc,{controller:!0,effects:[vA],initialViewState:Id,getTooltip:s,onViewStateChange:({viewState:o})=>{n(o.zoom)}},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na}),nt.createElement(Gm,{id:"slide-terrain",...l}),nt.createElement(f4,{id:"slide-waters",...l,zoomRange:[7,9],visible:!0})),nt.createElement(c1e,{...l,res:_s().domain([0,1]).range(t)(Br().domain([7,9]).range([0,1]).clamp(!0)(e))}))}function M1e(){const[t,e]=Ne.useState(1027),[n,r]=Ne.useState(!1),[i,s]=Ne.useState(1);return Ne.useEffect(()=>{if(n){let l=setTimeout(()=>e(o=>o%1199+1),33.333333333333336);return function(){clearTimeout(l)}}},[t,n]),{speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r,curOption:i,setCurOption:s}}function P1e({dataDeag:t,disabled:e=!1,deagKey:n}){const{current:r}=Ne.useRef(JF(t.features,fe=>fe.properties.id)),[i,s]=Ne.useState(null),[l,o]=Ne.useState({}),[p,w]=Ne.useState([]),[C,P]=Ne.useState({}),[I,U]=Ne.useState({type:"FeatureCollection",features:[]}),[W,H]=Ne.useState({}),[ie,X]=Ne.useState(!1),ee=Ne.useCallback(({object:fe})=>{if(!fe){s(null),o({}),w([]);return}if(!e){if(ie)s(null),o({}),w(fe.properties.id);else if(fe.properties[n]){const me=R2.h3ToFeature(fe.hexId),Se={};for(const He of fe.properties[n]){const Qe=r[He],Ke=I2(me,Qe.geometry);Se[Qe.properties.id]=M2(Ke)/M2(me)}o(Se),s(fe.hexId)}return!0}},[C,ie,e,n]),se=Ne.useCallback(({object:fe},me)=>{if(fe.properties.id==p)return U({type:"FeatureCollection",features:[]}),H({}),P({}),X(!1),!0;if(fe.properties[n]==null)return;if(me.srcEvent.shiftKey)return P(Ke=>({...Ke,[fe.hexId]:fe.properties[n]})),!0;X(!0),s(null),o({}),w(fe.properties.id),P({});const Se={...C,[fe.hexId]:fe.properties[n]};P(Se);const He={},Qe={type:"FeatureCollection",features:[]};for(const Ke in Se)for(const rt of Se[Ke]){const Ue=r[rt],it=R2.h3ToFeature(Ke),Ze=I2(it,Ue.geometry);Qe.features.push({...Ze,properties:{...Ue.properties}}),He[Ue.properties.id]={...Ue.properties}}return H(He),U(Qe),!0},[C,p,ie,n]);return{hoveredHex:i,clickedHexes:C,hoveredGeos:l,selectedGeoJSON:I,selectedGeos:W,hoveredGeoActive:p,onHover:ee,onClick:se,selectionFinalized:ie}}const Ou=0;function k1e({speedyCounter:t,curOption:e}){const n=Ne.useRef(),r=Ne.useRef(),i=Ne.useRef({});Ne.useEffect(()=>{n.current=document.querySelector("#main-tooltip"),r.current=document.querySelector("#secondary-tooltip")},[]);const s=Ne.useCallback(w=>{const C=w.properties.Demand[dr[Ou]][t],P=-w.properties.UnmetDemand[dr[Ou]][t],I=-P-w.properties.UnmetDemandBaseline[t];n.current.classList.add("active"),r.current.classList.add("active"),r.current.innerHTML=`        <div><b>Region ID</b> ${w.properties.id}</div>
        <div><b>Scenario Demand</b> ${C}</div>
        <div><b>Scen. Unmet Demand</b> ${P}</div>
        <div><b>Difference in Unmet Demand</b> ${I}</div>
        <div><b>Land Holder</b> ${od(w)}</div>
      `},[t]),l=Ne.useCallback(w=>{if(r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${T2(sf(t))}</i></div>
      `,w.properties.Demand){const C=w.properties.Demand[dr[Ou]][t],P=-w.properties.UnmetDemand[dr[Ou]][t],I=-P-w.properties.UnmetDemandBaseline[t];n.current.innerHTML+=`        
          <div><i>${S2[Ou]}</i></div>
          <div><b>Region ID</b> ${w.properties.id}</div>
          <div><b>Scenario Demand</b> ${C}</div>
          <div><b>Scen. Unmet Demand</b> ${P}</div>
          <div><b>Difference in Unmet Demand</b> ${I}</div>
          <div><b>Land Holder</b> ${od(w)}</div>
        `}else{const C=w.properties.Groundwater[t];n.current.innerHTML+=`     
          <div><b>Elem ID</b> ${w.properties.id}</div>
          <div><b>Groundwater</b> ${C}</div>
      `}},[t]),o=Ne.useCallback(w=>{const C=w.properties.Demand[dr[Ou]][t],P=-w.properties.UnmetDemand[dr[Ou]][t],I=-P-w.properties.UnmetDemandBaseline[t],U=w.properties.Groundwater[t],W=w.properties.GroundwaterVar[t],H=w.properties.UnmetDemandVar[dr[Ou]][t],ie=kd(w.properties.UnmetDemandBaselineVar[t],H),X=w.properties.DURgs.join(", "),ee=w.properties.GWRgs.join(", ");r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${T2(sf(t))}</i></div>
        <div><i>${S2[Ou]}</i></div>
        <div><b>Groundwater</b> ${U}</div>
        <div><b>Scenario Demand</b> ${C}</div>
        <div><b>Scen. Unmet Demand</b> ${P}</div>
        <div><b>Difference in Unmet Demand</b> ${I}</div>
        <div><b>Land Holder</b> ${od(w)}</div>
        <div><b>Variance (GW)</b> ${W}</div>
        <div><b>Var. (Scen. UnmetDem)</b> ${H}</div>
        <div><b>Var. (Difference)</b> ${ie}</div>
        <div><b>Demand Regions</b> ${X}</div>
        <div><b>GW Regions</b> ${ee}</div>
      `},[t]);return{getTooltip:Ne.useCallback(({object:w})=>{if(!w){i.current&&(r.current.classList.remove("active"),_h(i.current)&&n.current.classList.remove("active"),i.current=w),e>1&&(r.current.classList.remove("active"),n.current.classList.remove("active"));return}e<=1&&_h(w)?o(w):e<=1&&Um(w)?s(w):l(w),i.current=w},[t,e])}}let d4=class extends Bn{renderLayers(){return[new yh({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new mh(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}};d4.layerName="BaseTerrainLayer";d4.defaultProps={...Bn.defaultProps};const M8=0;let p4=class extends Bn{renderLayers(){const{curOption:e,speedyCounter:n}=this.props;return[new Ni({id:"GroundwaterGeo",data:r4,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...Ar.groundwater.interpColor(r.properties.Groundwater[n]),255],visible:e==2,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new Ni({id:"UDemGeo",data:El,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...Ar.unmetDemand.interpColor(r.properties.UnmetDemand[dr[M8]][n]),255],visible:e==3,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new Ni({id:"DemDiffGeo",data:El,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...Ar.difference.interpColor(r.properties.UnmetDemand[dr[M8]][n]-r.properties.UnmetDemandBaseline[n]),255],visible:e==4,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0})]}};p4.layerName="BasicGeoLayer";p4.defaultProps={...Bn.defaultProps,autoHighlight:!0};function I1e({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s}){return nt.createElement(nt.Fragment,null,nt.createElement(Lv,{counter:n,displayMonth:!1,dataset:"averageDemandBaseline"}),nt.createElement("div",{className:"styled-input"},nt.createElement("button",{onClick:()=>{s(l=>!l)}},i?"Pause":"Play"),nt.createElement("div",null,nt.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:n,onChange:function(l){r(parseInt(l.target.value))}}),nt.createElement("input",{onChange:function(l){s(!1),r(parseInt(l.target.value))},onInput:function(l){r(parseInt(l.target.value))},value:n,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))))}function T7(t){const[e,n,r]=t.split("/"),i=g4(r);return[parseFloat(e)+i/2,parseFloat(n)+i/2]}function L1e(t,e,n=1,r){const i=n,[s,l]=T7(t),o=S7(t),p=g4(o)/4*i;return e.map(C=>{let P=xl(l,C[0],i),I=xl(s,C[1],i);return[P+p*r[0],I+p*r[1]]})}function S7(t){const[e,n,r]=t.split("/");return parseInt(r)}function D1e(t){const[e,n]=T7(t),r=S7(t),i=g4(r)/4;return[[e+i,n-i],[e+i,n+i],[e-i,n+i],[e-i,n-i]]}function R1e(t){return t/111.1}function B1e(t){return ia(parseInt(t),Cr.km)*2}function g4(t){return R1e(B1e(t))}function z1e(t,[e,n],r){let i=D1e(t).map(l=>[l[1],l[0]]);return[L1e(t,i,1-e,r)]}class Ds extends Bn{initializeState(){super.initializeState();const e=Object.keys(this.props.data).map(i=>parseInt(i)),n=Br().domain(this.props.zoomRange).range([0,1]).clamp(!0),r=_s().domain([0,1]).range(e)(n(this.context.viewport.zoom));this.setState({...this.state,resRange:e,lastResolution:r,valueInterpResolution:n}),this.createPolygons()}createPolygons(){const{lastResolution:e}=this.state,n=[],r=this.props.data[e];Object.keys(r).forEach((i,s)=>{let l=r[i];const o=this.props.getValue?Br().domain([0,1]).range([this.props.thicknessRange[1],this.props.thicknessRange[0]])(this.props.getValue({properties:l})):this.props.thicknessRange[0];let p=z1e(i,[o,this.props.thicknessRange[1]],this.props.offset);this.props.raised?n.push({polygon:p.map(w=>w.map(([C,P])=>[C,P,typeof this.props.getElevation=="function"?this.props.getElevation({hexId:i,properties:l}):this.props.getElevation])),hexId:i,properties:l}):n.push({hexId:i,polygon:p,properties:l})}),this.setState({...this.state,polygons:n})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:l,changeFlags:o,context:p}=e;if(s.getElevation!=l.getElevation||s.getValue!=l.getValue||o.viewportChanged){const w=_s().domain([0,1]).range(n)(i(p.viewport.zoom));(w!=r||s.getValue!=l.getValue||s.getElevation!=l.getElevation)&&(this.setState({...this.state,lastResolution:w}),this.createPolygons())}}renderLayers(){return[new Vf(this.getSubLayerProps({data:this.props.data,filled:this.props.filled,stroked:this.props.stroked,lineWidthUnits:this.props.lineWidthUnits,extruded:this.props.extruded,wireframe:this.props.wireframe,_normalize:this.props._normalize,_windingOrder:this.props._windingOrder,_full3d:this.props._full3d,elevationScale:this.props.elevationScale,getPolygon:this.props.getPolygon,getElevation:this.props.getElevation,getFillColor:this.props.getFillColor,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,onClick:this.props.onClick,id:"SolidSquareTileLayer",data:this.state.polygons,getPolygon:e=>e.polygon,pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,extensions:this.props.extensions,getOffset:this.props.getOffset,lineJointRounded:this.props.lineJointRounded}))]}}Ds.layerName="SolidSquareTileLayer";Ds.defaultProps={...Bn.defaultProps,...Vf.defaultProps,thicknessRange:[0,1],getValue:void 0,raised:!1,zoomRange:[7,9],offset:[0,0]};const P8=0;let m4=class extends Bn{renderLayers(){const{data:e,curOption:n,speedyCounter:r,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new Ds({id:"SquareBorders",data:e,getFillColor:[0,0,0,0],getLineColor:[80,80,80,100],stroked:!0,lineWidthUnits:"pixels",getValue:p=>2,visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[0,0]}),new Ds({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:p=>Ar.groundwater.interpColor(450),getValue:p=>Ar.groundwater.scaleLinear(p.properties.Groundwater[r]),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o,offset:[1,1]}),new Ds({id:"Difference",data:e,thicknessRange:[0,1],getFillColor:p=>Ar.difference.interpColor(18,!1),getValue:p=>Ar.difference.scaleLinear(p.properties.UnmetDemand[dr[P8]][r]-p.properties.UnmetDemandBaseline[r]),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o,offset:[1,-1]}),new Ds({id:"UnmetDemand",data:e,thicknessRange:[0,1],getFillColor:p=>Ar.difference.interpColor(-18,!1),getValue:p=>Ar.unmetDemand.scaleLinear(p.properties.UnmetDemand[dr[P8]][r]),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o,offset:[-1,-1]})]}};m4.layerName="MultivariableHextileLayer";m4.defaultProps={...Bn.defaultProps,autoHighlight:!0};function O1e(){const t=M1e(),e=P1e({disabled:t.curOption>1,dataDeag:El,deagKey:"DURgs"}),{getTooltip:n}=k1e(t),r={data:nge,...t,...e};return nt.createElement(nt.Fragment,null,nt.createElement(gc,{controller:!0,effects:[vA],initialViewState:Id,getTooltip:n},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na}),nt.createElement(d4,{id:"slide-terrain",...r}),nt.createElement(m4,{id:"slide-waters",...r,zoomRange:[7,9],visible:!0}),nt.createElement(p4,{id:"slide-basic",...r})),nt.createElement(I1e,{...r}))}const db=512,F1e=Math.PI/180;function C7({map:t,gl:e,deck:n}){if(t.__deck)return t.__deck;const r=n?.props._customRender,i=n?.props.onLoad,s=P7({...n?.props,_customRender:()=>{t.triggerRepaint(),r?.("")}});let l;return(!n||n.props.gl===e)&&(Object.assign(s,{gl:e,width:null,height:null,touchAction:"unset",viewState:pm(t)}),n!=null&&n.isInitialized?k8(n,t):s.onLoad=()=>{i?.(),k8(l,t)}),n?(l=n,n.setProps(s),n.userData.isExternal=!0):(l=new yf(s),t.on("remove",()=>{M7(t)})),l.userData.mapboxLayers=new Set,t.__deck=l,t.on("render",()=>{l.isInitialized&&j1e(l,t)}),l}function k8(t,e){const n=()=>{t.isInitialized?H1e(t,e):e.off("move",n)};e.on("move",n)}function M7(t){var e;(e=t.__deck)===null||e===void 0||e.finalize(),t.__deck=null}function P7(t){return{...t,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...t.parameters},views:t.views||[new Xu({id:"mapbox"})]}}function N1e(t,e){t.userData.mapboxLayers.add(e),y4(t)}function U1e(t,e){t.userData.mapboxLayers.delete(e),y4(t)}function V1e(t,e){y4(t)}function G1e(t,e,n){let{currentViewport:r}=t.userData,i=!1;r||(r=k7(t,e,!0),t.userData.currentViewport=r,i=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[r],layerFilter:({layer:s})=>n.id===s.id||s.props.operation.includes("terrain"),clearStack:i,clearCanvas:!1})}function pm(t){var e;const{lng:n,lat:r}=t.getCenter(),i={longitude:(n+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return(e=t.getTerrain)!==null&&e!==void 0&&e.call(t)&&$1e(t,i),i}function $1e(t,e){if(t.getFreeCameraOptions){const{position:n}=t.getFreeCameraOptions();if(!n||n.z===void 0)return;const r=t.transform.height,{longitude:i,latitude:s,pitch:l}=e,o=n.x*db,p=(1-n.y)*db,w=n.z*db,C=pA([i,s]),P=o-C[0],I=p-C[1],U=Math.sqrt(P*P+I*I),W=l*F1e,H=1.5*r,ie=W<.001?H*Math.cos(W)/w:H*Math.sin(W)/U;e.zoom=Math.log2(ie);const X=H*Math.cos(W)/ie,ee=w-X;e.position=[0,0,ee/Ry(s)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function k7(t,e,n=!0){return new ac({id:"mapbox",x:0,y:0,width:t.width,height:t.height,...pm(e),nearZMultiplier:n?.02:.1,nearZ:e.transform._nearZ/e.transform.height,farZ:e.transform._farZ/e.transform.height})}function j1e(t,e){const{mapboxLayers:n,isExternal:r}=t.userData;if(r){const i=Array.from(n,C=>C.id),l=mf(t.props.layers,Boolean).some(C=>C&&!i.includes(C.id));let o=t.getViewports();const p=o.findIndex(C=>C.id==="mapbox"),w=o.length>1||p<0;(l||w)&&(p>=0&&(o=o.slice(),o[p]=k7(t,e,!1)),t._drawLayers("mapbox-repaint",{viewports:o,layerFilter:C=>(!t.props.layerFilter||t.props.layerFilter(C))&&(C.viewport.id!=="mapbox"||!i.includes(C.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function H1e(t,e){t.setProps({viewState:pm(e)}),t.needsRedraw({clearRedrawFlags:!0})}function y4(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(n=>{const r=n.props.type,i=new r(n.props);e.push(i)}),t.setProps({layers:e})}class W1e{constructor(e){if(oe(this,"id",void 0),oe(this,"type",void 0),oe(this,"renderingMode",void 0),oe(this,"map",void 0),oe(this,"deck",void 0),oe(this,"props",void 0),!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}onAdd(e,n){this.map=e,this.deck=C7({map:e,gl:n,deck:this.props.deck}),N1e(this.deck,this)}onRemove(){this.deck&&U1e(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&V1e(this.deck)}render(){G1e(this.deck,this.map,this)}}const pb="__UNDEFINED__";function dy(t,e,n,r){if(!t||!e||!t.style||!t.style._loaded)return;const i=mf(r,Boolean);if(n!==r){const o=mf(n,Boolean),p=new Set(o.map(w=>w.id));for(const w of i)p.delete(w.id);for(const w of p)t.getLayer(w)&&t.removeLayer(w)}for(const o of i){const p=t.getLayer(o.id);p?p.implementation.setProps(o.props):t.addLayer(new W1e({id:o.id,deck:e}),o.props.beforeId)}const s=t.style._order,l={};for(const o of i){let{beforeId:p}=o.props;(!p||!s.includes(p))&&(p=pb),l[p]=l[p]||[],l[p].push(o.id)}for(const o in l){const p=l[o];let w=o===pb?s.length:s.indexOf(o),C=o===pb?void 0:o;for(let P=p.length-1;P>=0;P--){const I=p[P],U=s.indexOf(I);U!==w-1&&(t.moveLayer(I,C),U>w&&w++),w--,C=I}}}class Q1e{constructor(e){oe(this,"_props",void 0),oe(this,"_deck",void 0),oe(this,"_map",void 0),oe(this,"_container",void 0),oe(this,"_interleaved",void 0),oe(this,"_lastMouseDownPoint",void 0),oe(this,"_handleStyleChange",()=>{dy(this._map,this._deck,this._props.layers,this._props.layers)}),oe(this,"_updateContainerSize",()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:s}=this._map.getContainer();Object.assign(this._container.style,{width:"".concat(i,"px"),height:"".concat(s,"px")})}}),oe(this,"_updateViewState",()=>{const i=this._deck;i&&(i.setProps({viewState:pm(this._map)}),i.isInitialized&&i.redraw())}),oe(this,"_handleMouseEvent",i=>{const s=this._deck;if(!s||!s.isInitialized)return;const l={type:i.type,offsetCenter:i.point,srcEvent:i},o=this._lastMouseDownPoint;switch(!i.point&&o&&(l.deltaX=i.originalEvent.clientX-o.clientX,l.deltaY=i.originalEvent.clientY-o.clientY,l.offsetCenter={x:o.x+l.deltaX,y:o.y+l.deltaY}),l.type){case"mousedown":s._onPointerDown(l),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":l.type="panstart",s._onEvent(l);break;case"drag":l.type="panmove",s._onEvent(l);break;case"dragend":l.type="panend",s._onEvent(l);break;case"click":l.tapCount=1,s._onEvent(l);break;case"dblclick":l.type="click",l.tapCount=2,s._onEvent(l);break;case"mousemove":l.type="pointermove",s._onPointerMove(l);break;case"mouseout":l.type="pointerleave",s._onPointerMove(l);break;default:return}});const{interleaved:n=!1,...r}=e;this._interleaved=n,this._props=r}setProps(e){this._interleaved&&e.layers&&dy(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._deck.setProps(this._interleaved?P7(this._props):this._props)}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const n=document.createElement("div");return Object.assign(n.style,{position:"absolute",left:0,top:0,pointerEvents:"none"}),this._container=n,this._deck=new yf({...this._props,parent:n,viewState:pm(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),n}_onAddInterleaved(e){return this._deck=C7({map:e,gl:e.painter.context.gl,deck:new yf({...this._props,gl:e.painter.context.gl})}),e.on("styledata",this._handleStyleChange),dy(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){var n;e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),(n=this._deck)===null||n===void 0||n.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),dy(e,this._deck,this._props.layers,[]),M7(e)}getDefaultPosition(){return"top-left"}pickObject(e){return Fi(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return Fi(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return Fi(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}const q1e=yz(()=>Promise.resolve().then(()=>ine),void 0),Z1e=(()=>Ne.forwardRef(function(e,n){return vz(e,n,q1e)}))();function Y1e(){const t=Cv(),{getTooltip:e}=K1e(t);return nt.createElement(Z1e,{getTooltip:e,id:"mymap",style:{width:1200,height:800},effects:[vA],light:{anchor:"viewport",color:"yellow",intensity:1},antialias:!0,interleaved:!0,initialViewState:Kpe,mapLib:Oo,mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",preventStyleDiffing:!0},nt.createElement(X1e,{curInput:t}))}function X1e({curInput:t}){const{current:e}=Mne();Ne.useEffect(()=>{if(!e)return;const n={data:rge,...t};e.on("load",()=>{const r=new Q1e({interleaved:!0,effects:[vA],layers:[new yh({id:"carto",data:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:i=>{const{bbox:{west:s,south:l,east:o,north:p}}=i.tile;return new mh(i,{data:null,image:i.data,bounds:[s,l,o,p]})},beforeId:"waterway"}),new yh({id:"supply",data:"http://infovis.cs.ucdavis.edu/mapProxy/wmts/fbfm40/webmercator/{z}/{x}/{y}.png",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:i=>{const{bbox:{west:s,south:l,east:o,north:p}}=i.tile;if(-(s- -119.94742725262628)<p-37.90192590898632)return new mh(i,{data:null,image:i.data,bounds:[s,l,o,p]})},beforeId:"waterway"}),new Vf({id:"ground",data:[[[-120.99582643167989,36.88453894208306],[-120.99582643167989,38.88453894208306],[-118.99582643167989,38.88453894208306],[-118.99582643167989,36.88453894208306]]],stroked:!1,getPolygon:i=>i,getFillColor:[0,0,0,0],getPolygonOffset:({layerIndex:i})=>[0,i*1e3],beforeId:"background"}),new _4({id:"slide-fire",...n,zoomRange:[9,14]})]});e.getMap().addControl(r).setLight({anchor:"viewport",color:"yellow",intensity:1})})},[])}class _4 extends Bn{renderLayers(){const{data:e,visible:n,zoomRange:r}=this.props;return[new fo({id:"DiffRings",data:e,thicknessRange:[0,1],getFillColor:i=>$p.power.interpColor(i.properties.power,!1,!1),extruded:!0,getElevation:i=>3e3*Math.pow($p.power.scaleLinearVar(i.properties.confidence),4),stroked:!1,getValue:i=>$p.power.scaleLinearVar(i.properties.confidence),visible:n,zoomRange:r}),new Sh({id:"ScenarioUnmet",raised:!0,getElevation:i=>3e3*Math.pow($p.power.scaleLinearVar(i.properties.confidence),4),data:e,loaders:[qd],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",getColor:[0,188,242],getValue:i=>$p.personnel.scaleLinear(i.properties.personnel),visible:n,sizeScale:400,zoomRange:r}),new v4({...this.props,id:"DeagLayer",data:e})]}}_4.layerName="WildfireLayer";_4.defaultProps={...Bn.defaultProps,autoHighlight:!0};class v4 extends Bn{renderLayers(){const{data:e,visible:n,zoomRange:r,selectionFinalized:i=!1}=this.props;return[new fo({id:"HoveringTiles",data:e,stroked:!1,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:!i,autoHighlight:!i,visible:n,zoomRange:r})]}}v4.layerName="DeaggregatedLayer";v4.defaultProps={...Bn.defaultProps,autoHighlight:!0};function K1e({speedyCounter:t,curOption:e}){const n=Ne.useRef(),r=Ne.useRef(),i=Ne.useRef({});Ne.useEffect(()=>{n.current=document.querySelector("#main-tooltip"),r.current=document.querySelector("#secondary-tooltip")},[]);const s=Ne.useCallback(o=>{const p=o.properties.power,w=o.properties.confidence,C=o.properties.personnel;r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`      <div><b>Power</b> ${p}</div>
      <div><b>Confidence</b> ${w}</div>
      <div><b>Personnel</b> ${C}</div>
      `},[t]);return{getTooltip:Ne.useCallback(({object:o})=>{if(!o){r.current.classList.remove("active"),n.current.classList.remove("active");return}s(o),i.current=o},[t,e])}}function zv(){const[t,e]=Ne.useState(1);return{curOption:t,setCurOption:e}}function Ov({curOption:t}){const e=Ne.useRef(),n=Ne.useRef(),r=Ne.useRef({});Ne.useEffect(()=>{e.current=document.querySelector("#main-tooltip"),n.current=document.querySelector("#secondary-tooltip")},[]);const i=Ne.useCallback(p=>{e.current.classList.add("active"),n.current.classList.add("active"),n.current.innerHTML=`      <div><b>GEOID</b> ${p.properties.GEOID}</div>
      <div><b>Votes / Km2</b> ${p.properties.votes_per_sqkm}</div>
      <div><b>Percent Dem. Lead</b> ${p.properties.pct_dem_lead}</div>
    `},[]),s=Ne.useCallback(p=>{n.current.classList.remove("active"),e.current.classList.add("active"),p.properties.pct_dem_lead?e.current.innerHTML=`        <div><b>GEOID</b> ${p.properties.GEOID}</div>
        <div><b>Votes / Km2</b> ${p.properties.votes_per_sqkm}</div>
        <div><b>% Dem. Lead</b> ${p.properties.pct_dem_lead}</div>
      `:e.current.innerHTML=`        <div><b>County Subdiv.</b> ${p.properties["county_subdivision_dec_Geographic Area Name"]}</div>
        <div><b>GEOID</b> ${p.properties.GEOID}</div>
        <div><b>% PoC</b> ${100-p.properties["county_subdivision_dec_Percent White"]}</div>
        <div><b>Pop. / Km2</b> ${p.properties["Population per Sqkm"]}</div>
      `},[]),l=Ne.useCallback(p=>{n.current.classList.remove("active"),e.current.classList.add("active"),e.current.innerHTML=`    <div><b>% PoC</b> ${p.properties.PoC}</div>
    <div><b>% PoC Var</b> ${p.properties.PoCVar}</div>
      <div><b>Pop. Den</b> ${p.properties.PopSqKm}</div>
      <div><b>Pop. Den Var</b> ${p.properties.PopSqKmVar}</div>
      <div><b>% Dem. Lead</b> ${p.properties.DemLead}</div>
      <div><b>% Dem. Lead Var</b> ${p.properties.DemLeadVar}</div>
      <div><b>Num. of County Subdivs</b> ${p.properties.CountyRgs.length}</div>
      <div><b>Num. of Precincts</b> ${p.properties.PrecinctRgs.length}</div>
      `},[]);return{getTooltip:Ne.useCallback(({object:p})=>{if(!p){r.current&&(n.current.classList.remove("active"),_h(r.current)&&e.current.classList.remove("active"),r.current=p),t>1&&(n.current.classList.remove("active"),e.current.classList.remove("active"));return}t<=1&&_h(p)?l(p):t<=1&&Um(p)?i(p):s(p),r.current=p},[t])}}let Yd=class extends Bn{renderLayers(){return[new yh({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:2,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new mh(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}};Yd.layerName="BaseTerrainLayer";Yd.defaultProps={...Bn.defaultProps};let x4=class extends Bn{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new fo({id:"Party",data:e,thicknessRange:[0,1],getFillColor:p=>Qn.party.interpVsup(p.properties.DemLead||0,p.properties.DemLeadVar||0),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o}),new fo({id:"White",data:e,thicknessRange:[.4,.65],getFillColor:p=>Qn.poc.interpColor(p.properties.PoC,!1),getValue:p=>Qn.poc.scaleLinearVar(p.properties.PoCVar)*.7+.3,raised:!0,visible:l,getElevation:p=>p.hexId in i?5e3:0,getLineWidth:p=>p.hexId in i?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new Gf({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r],getElevation:[s],getLineWidth:[s]},zoomRange:o}),new Sh({id:"Population",data:e,loaders:[qd],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",raised:!0,getColor:p=>[255,255,7,Qn.population.scaleLinearVar(p.properties.PopSqKmVar)*200+55],getValue:p=>Qn.population.scaleLinear(p.properties.PopSqKm),visible:l,sizeScale:400,opacity:1,updateTriggers:{getTranslation:[r]},zoomRange:o}),new Zd({...this.props,id:"DeagLayer",data:e,deagData:Hd,getFillColor:p=>Qn.party.interpColor(p.properties.pct_dem_lead,!1,!1)})]}};x4.layerName="MultivariableHextileLayer";x4.defaultProps={...Bn.defaultProps,autoHighlight:!0};function J1e({res:t}){const e=Ne.useRef(),n=Ne.useRef();return Ne.useLayoutEffect(()=>{const r=window.innerHeight,i=400,s=mi(e.current).attr("width",i).attr("height",r);s.append("g").call(Aa.arcmapLegend().vtitle("Percent Dem Lead").utitle("Variance").scale(Qn.party.vsup).size(150).x(i-180).y(r-500)),s.append("g").call(Aa.simpleLegend().title("Percent PoC").size(250).height(20).scale(Qn.poc.colorsStepped).x(i-280).y(r-300)),s.append("g").call(Vm(i-100,r-100,70,"rgba(146, 146, 146, 0.5)")).call(function(l){n.current=[l.append("text").attr("x",i-100).attr("y",r-92).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${Math.round(fc(t,Cr.km2))} km`),l.append("text").attr("x",i-100).attr("y",r-50).attr("text-anchor","middle").style("font-size","11px").text(` ${Math.round(ia(t,Cr.km))} km ;`)]})},[]),Ne.useEffect(()=>{let[r,i]=n.current;r.text(`${Math.round(fc(t,Cr.km2))} km`),i.text(` ${Math.round(ia(t,Cr.km))} km ;`)},[t]),nt.createElement("svg",{className:"legend-area",ref:e})}function eye(){const{current:t}=Ne.useRef(Object.keys(Tl).map(o=>parseInt(o))),[e,n]=Ne.useState(5),r=zv(),i=jf({disabled:r.curOption>1,dataDeag:Hd,deagKey:"PrecinctRgs"}),{getTooltip:s}=Ov(r),l={data:Tl,...r,...i};return nt.createElement(nt.Fragment,null,nt.createElement(gc,{controller:!0,effects:[vA],initialViewState:{longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:15,pitch:50.85,bearing:32.58},onViewStateChange:({viewState:o})=>{n(o.zoom)},getTooltip:s},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na}),nt.createElement(Yd,{id:"slide-terrain",...l}),nt.createElement(x4,{id:"slide-election",...l,zoomRange:[5,8],visible:r.curOption==1})),nt.createElement(tye,{res:_s().domain([0,1]).range(t)(Br().domain([5,8]).range([0,1]).clamp(!0)(e))}))}function tye(t){return nt.createElement(nt.Fragment,null,nt.createElement(J1e,{...t}))}const I8=0;function nye(){const t=Cv(),e=jf({disabled:t.curOption>1,dataDeag:El,deagKey:"DURgs"}),{getTooltip:n}=A4({...t,curOption:100}),r={data:Ld,...t,...e},[i,s]=Ne.useState(Id),l=Ne.useCallback(({viewId:o,viewState:p})=>{s({one:p,two:p,three:p})},[]);return nt.createElement(nt.Fragment,null,nt.createElement(gc,{controller:!0,effects:[vA],viewState:i,onViewStateChange:l,getTooltip:n,layerFilter:({layer:o,viewport:p})=>o.id=="slide-terrain"||o.id=="GroundwaterGeo"&&p.id=="one"||o.id=="UDemGeo"&&p.id=="two"||o.id=="DemDiffGeo"&&p.id=="three",views:[new Xu({id:"one",x:"0%",y:"0%",height:"50%",width:"50%",controller:!0}),new Xu({id:"two",x:"50%",y:"0%",height:"50%",width:"50%",controller:!0}),new Xu({id:"three",x:"25%",y:"50%",height:"50%",width:"50%",controller:!0})]},nt.createElement(bl,{id:"one"},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na})),nt.createElement(bl,{id:"two"},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na})),nt.createElement(bl,{id:"three"},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na})),nt.createElement(Gm,{id:"slide-terrain",...r}),nt.createElement(Ni,{id:"GroundwaterGeo",data:r4,opacity:1,stroked:!1,filled:!0,getFillColor:o=>[...Ar.groundwater.interpColor(o.properties.Groundwater[t.speedyCounter]),255],updateTriggers:{getFillColor:[t.speedyCounter]},pickable:!0,autoHighlight:!0}),nt.createElement(Ni,{id:"UDemGeo",data:El,opacity:1,stroked:!1,filled:!0,getFillColor:o=>[...Ar.unmetDemand.interpColor(o.properties.UnmetDemand[dr[I8]][t.speedyCounter]),255],updateTriggers:{getFillColor:[t.speedyCounter]},pickable:!0,autoHighlight:!0}),nt.createElement(Ni,{id:"DemDiffGeo",data:El,opacity:1,stroked:!1,filled:!0,getFillColor:o=>[...Ar.difference.interpColor(o.properties.UnmetDemand[dr[I8]][t.speedyCounter]-o.properties.UnmetDemandBaseline[t.speedyCounter]),255],updateTriggers:{getFillColor:[t.speedyCounter]},pickable:!0,autoHighlight:!0})),nt.createElement(rye,{...r}))}function rye({speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r}){return nt.createElement(nt.Fragment,null,nt.createElement(Lv,{counter:t,displayMonth:!1,dataset:"averageDemandBaseline"}),nt.createElement(iye,null),nt.createElement("div",{className:"styled-input"},nt.createElement("button",{onClick:()=>{r(i=>!i)}},n?"Pause":"Play"),nt.createElement("div",null,nt.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:t,onChange:function(i){e(parseInt(i.target.value))}}),nt.createElement("input",{onChange:function(i){r(!1),e(parseInt(i.target.value))},onInput:function(i){e(parseInt(i.target.value))},value:t,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))))}function iye({}){const t=Ne.useRef();return Ne.useLayoutEffect(()=>{mi(t.current).attr("width",400).attr("height",500).call(function(r){r.append("g").call(Aa.simpleLegend().title("Groundwater").size(250).height(20).scale(Ar.groundwater.colorsStepped).x(400-280).y(500-240))}).call(function(r){r.append("g").call(Aa.simpleLegend().title("Scenario Unmet Demand").size(250).height(20).scale(Ar.unmetDemand.colorsStepped).x(400-280).y(500-170))}).call(function(r){r.append("g").call(Aa.simpleLegend().title("Difference w/ Baseline").size(250).height(20).scale(Ar.difference.colorsStepped).x(400-280).y(500-100))})},[]),nt.createElement("svg",{className:"legend-area",ref:t})}let I7=class extends Bn{renderLayers(){const{curOption:e,speedyCounter:n=1026}=this.props;return[new Ni({id:"Votes",data:i4,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,extruded:!0,getElevation:r=>Qn.votes.scaleLinear(r.properties.votes_per_sqkm)*3e5,getFillColor:r=>Qn.party.interpColor(r.properties.pct_dem_lead,!1,!1),visible:e==2,pickable:!0,autoHighlight:!0}),new Ni({id:"Demog",data:C2,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,extruded:!0,getElevation:r=>Qn.population.scaleLinear(r.properties["county_subdivision_dec_Total population"]/(r.properties.area/1e6)||0)*3e4,getFillColor:r=>Qn.poc.interpColor(100-(r.properties["county_subdivision_dec_Percent White"]||100),!1,!1),visible:e==3,pickable:!0,autoHighlight:!0})]}};I7.layerName="BasicGeoLayer";I7.defaultProps={...Bn.defaultProps,autoHighlight:!0};function sye(){const t=zv(),e=jf({disabled:t.curOption>1,dataDeag:Hd,deagKey:"PrecinctRgs"}),{getTooltip:n}=Ov(t),r={data:hm,...t,...e};return nt.createElement(nt.Fragment,null,nt.createElement(gc,{controller:!0,effects:[vA],initialViewState:{longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:15,pitch:50.85,bearing:32.58},getTooltip:n},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na}),nt.createElement(Yd,{id:"slide-terrain",...r}),nt.createElement(w4,{id:"slide-election",...r,zoomRange:[5,8],visible:!0})),nt.createElement(oye,{...r}))}class w4 extends Bn{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new Ds({id:"SquareBorders",data:e,getFillColor:[0,0,0,0],getLineColor:[80,80,80,100],stroked:!0,lineWidthUnits:"pixels",getValue:p=>2,visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[0,0]}),new Ds({id:"PoC",data:e,getFillColor:[0,121,42],getValue:p=>Qn.poc.scaleLinear(p.properties.PoC),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[-1,-1]}),new Ds({id:"Dem",data:e,getFillColor:[72,30,197],getValue:p=>Qn.party.scaleLinear(p.properties.DemLead>0?p.properties.DemLead*2-100:-100),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[-1,1]}),new Ds({id:"Repub",data:e,getFillColor:[165,0,38],getValue:p=>Qn.party.scaleLinear(p.properties.DemLead<0?-p.properties.DemLead*2-100:-100),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[1,1]}),new Ds({id:"Pop",data:e,getFillColor:[156,156,156],getValue:p=>Qn.population.scaleLinear(p.properties.PopSqKm),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[1,-1]})]}}w4.layerName="MultivariableSquareTileLayer";w4.defaultProps={...Bn.defaultProps,autoHighlight:!0};function oye({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s}){return nt.createElement(nt.Fragment,null)}function aye(){const t=zv(),e=jf({disabled:t.curOption>1,dataDeag:Hd,deagKey:"PrecinctRgs"}),{getTooltip:n}=Ov({...t,curOption:100}),r={data:Tl,...t,...e},[i,s]=Ne.useState({longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:15,pitch:50.85,bearing:32.58}),l=Ne.useCallback(({viewId:o,viewState:p})=>{s({one:p,two:p,three:p})},[]);return nt.createElement(nt.Fragment,null,nt.createElement(gc,{controller:!0,effects:[vA],viewState:i,onViewStateChange:l,getTooltip:n,layerFilter:({layer:o,viewport:p})=>o.id=="slide-terrain"||o.id=="Pop"&&p.id=="one"||o.id=="Votes"&&p.id=="two"||o.id=="Demog"&&p.id=="three",views:[new Xu({id:"one",x:"0%",y:"0%",height:"50%",width:"50%",controller:!0}),new Xu({id:"two",x:"50%",y:"0%",height:"50%",width:"50%",controller:!0}),new Xu({id:"three",x:"25%",y:"50%",height:"50%",width:"50%",controller:!0})]},nt.createElement(bl,{id:"one"},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na})),nt.createElement(bl,{id:"two"},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na})),nt.createElement(bl,{id:"three"},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na})),nt.createElement(Yd,{id:"slide-terrain",...r}),nt.createElement(Ni,{id:"Pop",data:C2,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,getFillColor:o=>Qn.population.interpColor(o.properties["Population per Sqkm"],!1,!1),pickable:!0,autoHighlight:!0}),nt.createElement(Ni,{id:"Votes",data:i4,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,getFillColor:o=>Qn.party.interpColor(o.properties.DemLeadCount,!1,!1),pickable:!0,autoHighlight:!0}),nt.createElement(Ni,{id:"Demog",data:C2,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,getFillColor:o=>Qn.poc.interpColor(o.properties.PoCCount||0,!1,!1),pickable:!0,autoHighlight:!0})),nt.createElement(lye,{...r}))}function lye({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s}){return nt.createElement(nt.Fragment,null,nt.createElement(Aye,null))}function Aye({}){const t=Ne.useRef();return Ne.useLayoutEffect(()=>{mi(t.current).attr("width",400).attr("height",500).call(function(r){r.append("g").call(Aa.simpleLegend().title("Population / Km2").size(250).height(20).scale(Qn.population.colorsStepped).x(400-280).y(500-240))}).call(function(r){r.append("g").call(Aa.simpleLegend().title("Percent Democrat Lead").size(250).height(20).scale(Qn.party.colorsStepped).x(400-280).y(500-170))}).call(function(r){r.append("g").call(Aa.simpleLegend().title("Percent PoC").size(250).height(20).scale(Qn.poc.colorsStepped).x(400-280).y(500-100))})},[]),nt.createElement("svg",{className:"legend-area",ref:t})}function uye(){const{current:t}=Ne.useRef(Object.keys(Tl).map(o=>parseInt(o))),[e,n]=Ne.useState(5),r=zv(),i=jf({disabled:r.curOption>1,dataDeag:Hd,deagKey:"PrecinctRgs"}),{getTooltip:s}=Ov(r),l={data:Tl,...r,...i};return nt.createElement(nt.Fragment,null,nt.createElement(gc,{controller:!0,effects:[vA],initialViewState:{longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:15,pitch:50.85,bearing:32.58},onViewStateChange:({viewState:o})=>{n(o.zoom)},getTooltip:s},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na}),nt.createElement(Yd,{id:"slide-terrain",...l}),nt.createElement(b4,{id:"slide-election",...l,zoomRange:[5,8],visible:r.curOption==1})),nt.createElement(cye,{res:_s().domain([0,1]).range(t)(Br().domain([5,8]).range([0,1]).clamp(!0)(e))}))}let b4=class extends Bn{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new fo({id:"Party",data:e,thicknessRange:[0,1],getFillColor:p=>Qn.party.interpColor(p.properties.DemLead||0),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o}),new fo({id:"White",data:e,thicknessRange:[.4,.65],getFillColor:p=>Qn.poc.interpColor(p.properties.White,!0),getValue:p=>1,raised:!0,visible:l,getElevation:p=>p.hexId in i?5e3:0,getLineWidth:p=>p.hexId in i?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new Gf({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r],getElevation:[s],getLineWidth:[s]},zoomRange:o}),new Sh({id:"Population",data:e,loaders:[qd],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",raised:!0,getColor:p=>[255,255,7,255],getValue:p=>Qn.population.scaleLinear(p.properties.Pop),visible:l,sizeScale:400,opacity:1,updateTriggers:{getTranslation:[r]},zoomRange:o}),new Zd({...this.props,id:"DeagLayer",data:e,deagData:Hd,getFillColor:p=>Qn.party.interpColor(p.properties.pct_dem_lead,!1,!1)})]}};b4.layerName="MultivariableHextileLayer";b4.defaultProps={...Bn.defaultProps,autoHighlight:!0};function cye(t){return nt.createElement(nt.Fragment,null,nt.createElement(hye,{...t}))}function hye({res:t}){const e=Ne.useRef(),n=Ne.useRef();return Ne.useLayoutEffect(()=>{const r=window.innerHeight,i=400,s=mi(e.current).attr("width",i).attr("height",r);s.append("g").call(Aa.simpleLegend().title("Percent Dem").size(250).height(20).scale(Qn.party.colorsStepped).x(i-280).y(r-370)),s.append("g").call(Aa.simpleLegend().title("Percent PoC").size(250).height(20).scale(Qn.poc.colorsStepped).x(i-280).y(r-300)),s.append("g").call(Vm(i-100,r-100,70,"rgba(146, 146, 146, 0.5)")).call(function(l){n.current=[l.append("text").attr("x",i-100).attr("y",r-92).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${Math.round(fc(t,Cr.km2))} km`),l.append("text").attr("x",i-100).attr("y",r-50).attr("text-anchor","middle").style("font-size","11px").text(` ${Math.round(ia(t,Cr.km))} km ;`)]})},[]),Ne.useEffect(()=>{let[r,i]=n.current;r.text(`${Math.round(fc(t,Cr.km2))} km`),i.text(` ${Math.round(ia(t,Cr.km))} km ;`)},[t]),nt.createElement("svg",{className:"legend-area",ref:e})}function fye(){const{current:t}=Ne.useRef(Object.keys(Ld).map(o=>parseInt(o))),[e,n]=Ne.useState(Id.zoom),r=Cv(),i=jf({disabled:r.curOption>1,dataDeag:El,deagKey:"DURgs"}),{getTooltip:s}=A4(r),l={data:Ld,...r,...i};return nt.createElement(nt.Fragment,null,nt.createElement(gc,{controller:!0,effects:[vA],initialViewState:Id,getTooltip:s,onViewStateChange:({viewState:o})=>{n(o.zoom)}},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na}),nt.createElement(Gm,{id:"slide-terrain",...l}),nt.createElement(E4,{id:"slide-waters",...l,zoomRange:[7,9],visible:!0})),nt.createElement(dye,{...l,res:_s().domain([0,1]).range(t)(Br().domain([7,9]).range([0,1]).clamp(!0)(e))}))}const $h=0;class E4 extends Bn{renderLayers(){const{data:e,curOption:n,speedyCounter:r,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new fo({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:p=>Ar.groundwater.interpColor(p.properties.Groundwater[r]),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o}),new fo({id:"DiffRings",data:e,thicknessRange:[.4,.65],getFillColor:p=>n==0?Ar.difference.interpVsup(p.properties.UnmetDemand[dr[$h]][r]-p.properties.UnmetDemandBaseline[r],kd(p.properties.UnmetDemandBaselineVar[r],p.properties.UnmetDemandVar[dr[$h]][r]),!0):Ar.difference.interpColor(p.properties.UnmetDemand[dr[$h]][r]-p.properties.UnmetDemandBaseline[r],!0),getValue:p=>n==0?1:Ar.difference.scaleLinearVar(kd(p.properties.UnmetDemandBaselineVar[r],p.properties.UnmetDemandVar[dr[$h]][r]))*.8+.2,raised:!0,visible:l,getElevation:p=>p.hexId in i?5e3:0,getLineWidth:p=>p.hexId in i?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new Gf({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r],getElevation:[s],getLineWidth:[s]},zoomRange:o}),new Sh({id:"ScenarioUnmet",data:e,loaders:[qd],mesh:"./assets/drop.obj",raised:!0,getColor:p=>[255,130,35,Ar.unmetDemand.scaleLinearVar(p.properties.UnmetDemandVar[dr[$h]][r])*200+55],getValue:p=>Ar.unmetDemand.scaleLinear(p.properties.UnmetDemand[dr[$h]][r]),visible:l,sizeScale:3e3,opacity:1,updateTriggers:{getTranslation:[r]},zoomRange:o}),new Zd({...this.props,id:"DeagLayer",data:e,deagData:El,getFillColor:p=>Ar.unmetDemand.interpColor(p.properties.UnmetDemand[dr[$h]][r],!1,!1),updateTriggers:{getFillColor:[r]}})]}}E4.layerName="MultivariableHextileLayer";E4.defaultProps={...Bn.defaultProps,autoHighlight:!0};function dye({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s,res:l}){return nt.createElement(nt.Fragment,null,nt.createElement(Lv,{counter:n,displayMonth:!1,dataset:"averageDemandBaseline"}),nt.createElement(pye,{res:l}),nt.createElement("div",{className:"styled-input"},nt.createElement("button",{onClick:()=>{s(o=>!o)}},i?"Pause":"Play"),nt.createElement("div",null,nt.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:n,onChange:function(o){r(parseInt(o.target.value))}}),nt.createElement("input",{onChange:function(o){s(!1),r(parseInt(o.target.value))},onInput:function(o){r(parseInt(o.target.value))},value:n,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))))}function pye({res:t}){const e=Ne.useRef(),n=Ne.useRef();return Ne.useLayoutEffect(()=>{mi(e.current).attr("width",400).attr("height",500).call(function(s){s.append("g").call(Aa.simpleLegend().title("Groundwater").size(250).height(20).scale(Ar.groundwater.colorsStepped).x(400-280).y(500-320))}).call(function(s){s.append("g").call(Aa.simpleLegend().title("Difference w/ Baseline").size(250).height(20).scale(Ar.difference.colorsStepped).x(400-280).y(500-250))}).call(function(s){s.append("g").call(Vm(400-100,500-100,70,"rgba(146, 146, 146, 0.5)")).call(function(l){n.current=[l.append("text").attr("x",400-100).attr("y",500-92).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${Math.round(fc(t,Cr.km2))} km`),l.append("text").attr("x",400-100).attr("y",500-50).attr("text-anchor","middle").style("font-size","11px").text(` ${Math.round(ia(t,Cr.km))} km ;`)]})})},[]),Ne.useEffect(()=>{let[r,i]=n.current;r.text(`${Math.round(fc(t,Cr.km2))} km`),i.text(` ${Math.round(ia(t,Cr.km))} km ;`)},[t]),nt.createElement("svg",{className:"legend-area",ref:e})}function gye(){const[t,e]=Ne.useState(1);return{curOption:t,setCurOption:e}}function mye({curOption:t}){const e=Ne.useRef(),n=Ne.useRef(),r=Ne.useRef({});Ne.useEffect(()=>{e.current=document.querySelector("#main-tooltip"),n.current=document.querySelector("#secondary-tooltip")},[]);const i=Ne.useCallback(p=>{e.current.classList.add("active"),n.current.classList.add("active"),n.current.innerHTML=`      <div><b>GEOID</b> ${p.properties.GEOID}</div>
      <div><b>Votes / Km2</b> ${p.properties.votes_per_sqkm}</div>
      <div><b>Percent Dem. Lead</b> ${p.properties.pct_dem_lead}</div>
    `},[]),s=Ne.useCallback(p=>{n.current.classList.remove("active"),e.current.classList.add("active"),p.properties.pct_dem_lead?e.current.innerHTML=`        <div><b>GEOID</b> ${p.properties.GEOID}</div>
        <div><b>Votes / Km2</b> ${p.properties.votes_per_sqkm}</div>
        <div><b>% Dem. Lead</b> ${p.properties.pct_dem_lead}</div>
      `:e.current.innerHTML=`        <div><b>County Subdiv.</b> ${p.properties["county_subdivision_dec_Geographic Area Name"]}</div>
        <div><b>GEOID</b> ${p.properties.GEOID}</div>
        <div><b>% PoC</b> ${100-p.properties["county_subdivision_dec_Percent White"]}</div>
        <div><b>Pop. / Km2</b> ${p.properties["Population per Sqkm"]}</div>
      `},[]),l=Ne.useCallback(p=>{n.current.classList.remove("active"),e.current.classList.add("active"),e.current.innerHTML=`    <div><b>% PoC</b> ${p.properties.PoC}</div>
    <div><b>% PoC Var</b> ${p.properties.PoCVar}</div>
      <div><b>Pop. Den</b> ${p.properties.PopSqKm}</div>
      <div><b>Pop. Den Var</b> ${p.properties.PopSqKmVar}</div>
      <div><b>% Dem. Lead</b> ${p.properties.DemLead}</div>
      <div><b>% Dem. Lead Var</b> ${p.properties.DemLeadVar}</div>
      <div><b>Num. of County Subdivs</b> ${p.properties.CountyRgs.length}</div>
      <div><b>Num. of Precincts</b> ${p.properties.PrecinctRgs.length}</div>
      `},[]);return{getTooltip:Ne.useCallback(({object:p})=>{if(!p){r.current&&(n.current.classList.remove("active"),_h(r.current)&&e.current.classList.remove("active"),r.current=p),t>1&&(n.current.classList.remove("active"),e.current.classList.remove("active"));return}t<=1&&_h(p)?l(p):t<=1&&Um(p)?i(p):s(p),r.current=p},[t])}}class T4 extends Bn{renderLayers(){return[new yh({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:2,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new mh(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}}T4.layerName="BaseTerrainLayer";T4.defaultProps={...Bn.defaultProps};class S4 extends Bn{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new fo({id:"HexParty",data:e,thicknessRange:[0,1],getFillColor:p=>Qn.party.interpVsup(p.properties.DemLead||0,p.properties.DemLeadVar||0),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o}),new fo({id:"HexWhite",data:e,thicknessRange:[.4,.65],getFillColor:p=>Qn.poc.interpColor(p.properties.PoC,!1),getValue:p=>Qn.poc.scaleLinearVar(p.properties.PoCVar)*.7+.3,visible:l,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new Gf({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r],getElevation:[s],getLineWidth:[s]},zoomRange:o}),new Sh({id:"HexPopulation",data:e,loaders:[qd],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",getColor:p=>[255,255,7,Qn.population.scaleLinearVar(p.properties.PopSqKmVar)*200+55],getValue:p=>Qn.population.scaleLinear(p.properties.PopSqKm),visible:l,sizeScale:400,opacity:1,updateTriggers:{getTranslation:[r]},zoomRange:o}),new fo({id:"HexHoveringTiles",data:e,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,visible:l,zoomRange:o})]}}S4.layerName="MultivariableHextileLayer";S4.defaultProps={...Bn.defaultProps,autoHighlight:!0,pickable:!0};const yye={width:1286,height:703,latitude:28.758769832242674,longitude:-101.33351900443955,zoom:5.5,bearing:32.58,pitch:50.85,altitude:1.5,maxZoom:15,minZoom:3,maxPitch:60,minPitch:0,normalize:!0,position:[0,0,0]};class L7 extends Bn{renderLayers(){const{curOption:e,speedyCounter:n=1026}=this.props;return[new Ni({id:"Votes",data:i4,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,extruded:!0,getElevation:r=>Qn.votes.scaleLinear(r.properties.votes_per_sqkm)*3e5,getFillColor:r=>Qn.party.interpColor(r.properties.pct_dem_lead,!1,!1),visible:e==2,pickable:!0,autoHighlight:!0}),new Ni({id:"Demog",data:C2,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,extruded:!0,getElevation:r=>Qn.population.scaleLinear(r.properties["county_subdivision_dec_Total population"]/(r.properties.area/1e6)||0)*3e4,getFillColor:r=>Qn.poc.interpColor(100-(r.properties["county_subdivision_dec_Percent White"]||100),!1,!1),visible:e==3,pickable:!0,autoHighlight:!0})]}}L7.layerName="BasicGeoLayer";L7.defaultProps={...Bn.defaultProps,autoHighlight:!0};class C4 extends Bn{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new Ds({id:"SquareBorders",data:e,getFillColor:[0,0,0,0],getLineColor:[80,80,80,100],stroked:!0,lineWidthUnits:"pixels",getValue:p=>2,visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[0,0]}),new Ds({id:"SquarePoC",data:e,getFillColor:[0,121,42],getValue:p=>Qn.poc.scaleLinear(p.properties.PoC),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[-1,-1]}),new Ds({id:"SquareDem",data:e,getFillColor:[72,30,197],getValue:p=>Qn.party.scaleLinear(p.properties.DemLead>0?p.properties.DemLead*2-100:-100),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[-1,1]}),new Ds({id:"SquareRepub",data:e,getFillColor:[165,0,38],getValue:p=>Qn.party.scaleLinear(p.properties.DemLead<0?-p.properties.DemLead*2-100:-100),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[1,1]}),new Ds({id:"SquarePop",data:e,getFillColor:[156,156,156],getValue:p=>Qn.population.scaleLinear(p.properties.PopSqKm),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[1,-1]}),new Ds({id:"SquareHoveringTiles",data:e,getFillColor:[0,0,0,0],pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,getValue:p=>2,visible:l,zoomRange:o,opacity:1,offset:[0,0]})]}}C4.layerName="MultivariableSquareTileLayer";C4.defaultProps={...Bn.defaultProps,autoHighlight:!0,pickable:!0};function L8(t){return{id:t,...Tl[4][t]}}function D8(t){return{id:t,...hm[4][t]}}function _ye(){return[{type:"click",q:"Click on hex you like",a:L8(Object.keys(Tl[4])[101]),map:"hex"},{type:"text",q:"What is your answer?",a:D8(Object.keys(hm[4])[42]),map:"square"},{type:"text",q:"What is your name?",a:L8(Object.keys(Tl[4])[46]),map:"hex"},{type:"click",q:"Click on square you like",a:D8(Object.keys(hm[4])[32]),map:"square"}]}function vye(){const{current:t}=Ne.useRef(Object.keys(Tl).map(ie=>parseInt(ie))),[e,n]=Ne.useState(5),r=gye();mye(r);const[i,s]=Ne.useState(-1),[l,o]=Ne.useState(""),[p,w]=Ne.useState(),C=_ye();function P(ie){return{id:ie.hexId,...ie.properties}}const I={data:Tl,...r},U=()=>{s(ie=>ie+1),w(Date.now())},W=()=>{const ie={...C[i],user:l,time:Date.now()-p};console.log(ie),s(X=>X+1),o(""),w(Date.now())},H=Ne.useCallback(({object:ie})=>{const X={...C[i],user:P(ie),time:Date.now()-p};console.log(X),s(ee=>ee+1),w(Date.now())},[p,i]);return nt.createElement(nt.Fragment,null,nt.createElement(gc,{controller:!0,effects:[vA],initialViewState:yye,onViewStateChange:({viewState:ie})=>{n(ie.zoom)}},nt.createElement(Fa,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Oo,mapStyle:Na}),nt.createElement(T4,{id:"slide-terrain",...I}),nt.createElement(S4,{pickable:(C[i]||{}).type==="click",autoHighlight:(C[i]||{}).type==="click",id:"slide-hex",data:Tl,...r,zoomRange:[0,1],visible:(C[i]||{}).map=="hex",onClick:H}),nt.createElement(C4,{pickable:(C[i]||{}).type==="click",autoHighlight:(C[i]||{}).type==="click",id:"slide-elec-square",data:hm,...r,zoomRange:[0,1],visible:(C[i]||{}).map=="square",onClick:H})),i<C.length&&nt.createElement("div",{className:"study-area"},i==-1&&nt.createElement(nt.Fragment,null,nt.createElement("p",null,"Press button to start."),nt.createElement("button",{onClick:U},"Next")),i>-1&&nt.createElement(nt.Fragment,null,nt.createElement("p",null,C[i].q),C[i].type=="text"&&nt.createElement(nt.Fragment,null,nt.createElement("input",{type:"text",value:l,onChange:ie=>o(ie.target.value)}),nt.createElement("button",{onClick:W},"Next")))),(C[i]||{}).map=="hex"&&nt.createElement(xye,{res:_s().domain([0,1]).range(t)(Br().domain([5,8]).range([0,1]).clamp(!0)(e))}),(C[i]||{}).map=="square"&&nt.createElement(wye,{res:_s().domain([0,1]).range(t)(Br().domain([5,8]).range([0,1]).clamp(!0)(e))}))}function xye({res:t}){const e=Ne.useRef(),n=Ne.useRef();return Ne.useLayoutEffect(()=>{const r=window.innerHeight,i=window.innerWidth,s=mi(e.current).attr("width",i).attr("height",r);s.append("g").call(Aa.arcmapLegend().vtitle("Groundwater").utitle("Variance").scale(Qn.party.vsup).size(150).x(20).y(r-275));let l=i/2-350,o=r-220;s.append("g").attr("transform",`translate(${l},${o})`).call(t7(Qn.poc)),l=i/2+10,o=r-220,s.append("g").attr("transform",`translate(${l},${o})`).call(e7(Qn.population,"assets/human.png")),s.append("g").attr("transform",`translate(${i-60},${r-170})`).call(Vm(0,0,50,"rgba(146, 146, 146, 0.5)")).call(function(p){n.current=[p.append("text").attr("x",0).attr("y",8).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${yl(".2s")(fc(t,Cr.km2))} km`),p.append("text").attr("x",0).attr("y",55).attr("text-anchor","middle").style("font-size","11px").text(` ${yl(".2s")(ia(t,Cr.km))} km ;`)]})},[]),nt.createElement("svg",{className:"legend-area",ref:e})}function wye({res:t}){}function bye(t){HD(t).render(nt.createElement(NG,null,nt.createElement(LG,null,nt.createElement(ll,{path:"/",element:nt.createElement(Eye,null)}),nt.createElement(ll,{path:"user",element:nt.createElement(vye,null)}),nt.createElement(ll,{path:"water/hex",element:nt.createElement(C1e,null)}),nt.createElement(ll,{path:"water/hex-no-vsup",element:nt.createElement(fye,null)}),nt.createElement(ll,{path:"water/square",element:nt.createElement(O1e,null)}),nt.createElement(ll,{path:"water/mult",element:nt.createElement(nye,null)}),nt.createElement(ll,{path:"election/hex",element:nt.createElement(eye,null)}),nt.createElement(ll,{path:"election/hex-no-vsup",element:nt.createElement(uye,null)}),nt.createElement(ll,{path:"election/square",element:nt.createElement(sye,null)}),nt.createElement(ll,{path:"election/mult",element:nt.createElement(aye,null)}),nt.createElement(ll,{path:"fire",element:nt.createElement(Y1e,null)}))))}function Eye(){return nt.createElement(nt.Fragment,null,nt.createElement(Lu,{className:"toc-link",to:"water/mult"},"Water Small Multiples"),nt.createElement(Lu,{className:"toc-link",to:"water/square"},"Water Square Tiles"),nt.createElement(Lu,{className:"toc-link",to:"water/hex"},"Water HexTiles"),nt.createElement(Lu,{className:"toc-link",to:"water/hex-no-vsup"},"Water HexTiles (No VSUP)"),nt.createElement(Lu,{className:"toc-link",to:"election/mult"},"Election Small Multiples"),nt.createElement(Lu,{className:"toc-link",to:"election/square"},"Election Square Tiles"),nt.createElement(Lu,{className:"toc-link",to:"election/hex"},"Election HexTiles"),nt.createElement(Lu,{className:"toc-link",to:"election/hex-no-vsup"},"Election HexTiles (No VSUP)"),nt.createElement(Lu,{className:"toc-link",to:"fire"},"Wildfire"))}bye(document.getElementById("app"));
