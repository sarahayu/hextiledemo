function $3(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const A of s.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&r(A)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var dN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function G_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function pN(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var D6={exports:{}},cr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cg=Symbol.for("react.element"),gN=Symbol.for("react.portal"),mN=Symbol.for("react.fragment"),yN=Symbol.for("react.strict_mode"),_N=Symbol.for("react.profiler"),vN=Symbol.for("react.provider"),xN=Symbol.for("react.context"),wN=Symbol.for("react.forward_ref"),bN=Symbol.for("react.suspense"),EN=Symbol.for("react.memo"),TN=Symbol.for("react.lazy"),Q4=Symbol.iterator;function SN(t){return t===null||typeof t!="object"?null:(t=Q4&&t[Q4]||t["@@iterator"],typeof t=="function"?t:null)}var R6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B6=Object.assign,z6={};function Y0(t,e,n){this.props=t,this.context=e,this.refs=z6,this.updater=n||R6}Y0.prototype.isReactComponent={};Y0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Y0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function O6(){}O6.prototype=Y0.prototype;function H3(t,e,n){this.props=t,this.context=e,this.refs=z6,this.updater=n||R6}var W3=H3.prototype=new O6;W3.constructor=H3;B6(W3,Y0.prototype);W3.isPureReactComponent=!0;var q4=Array.isArray,F6=Object.prototype.hasOwnProperty,Q3={current:null},N6={key:!0,ref:!0,__self:!0,__source:!0};function U6(t,e,n){var r,i={},s=null,A=null;if(e!=null)for(r in e.ref!==void 0&&(A=e.ref),e.key!==void 0&&(s=""+e.key),e)F6.call(e,r)&&!N6.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var y=Array(a),w=0;w<a;w++)y[w]=arguments[w+2];i.children=y}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Cg,type:t,key:s,ref:A,props:i,_owner:Q3.current}}function MN(t,e){return{$$typeof:Cg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function q3(t){return typeof t=="object"&&t!==null&&t.$$typeof===Cg}function CN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Z4=/\/+/g;function Sv(t,e){return typeof t=="object"&&t!==null&&t.key!=null?CN(""+t.key):e.toString(36)}function S1(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var A=!1;if(t===null)A=!0;else switch(s){case"string":case"number":A=!0;break;case"object":switch(t.$$typeof){case Cg:case gN:A=!0}}if(A)return A=t,i=i(A),t=r===""?"."+Sv(A,0):r,q4(i)?(n="",t!=null&&(n=t.replace(Z4,"$&/")+"/"),S1(i,e,n,"",function(w){return w})):i!=null&&(q3(i)&&(i=MN(i,n+(!i.key||A&&A.key===i.key?"":(""+i.key).replace(Z4,"$&/")+"/")+t)),e.push(i)),1;if(A=0,r=r===""?".":r+":",q4(t))for(var a=0;a<t.length;a++){s=t[a];var y=r+Sv(s,a);A+=S1(s,e,n,y,i)}else if(y=SN(t),typeof y=="function")for(t=y.call(t),a=0;!(s=t.next()).done;)s=s.value,y=r+Sv(s,a++),A+=S1(s,e,n,y,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return A}function xm(t,e,n){if(t==null)return t;var r=[],i=0;return S1(t,r,"","",function(s){return e.call(n,s,i++)}),r}function PN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Co={current:null},M1={transition:null},IN={ReactCurrentDispatcher:Co,ReactCurrentBatchConfig:M1,ReactCurrentOwner:Q3};cr.Children={map:xm,forEach:function(t,e,n){xm(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return xm(t,function(){e++}),e},toArray:function(t){return xm(t,function(e){return e})||[]},only:function(t){if(!q3(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};cr.Component=Y0;cr.Fragment=mN;cr.Profiler=_N;cr.PureComponent=H3;cr.StrictMode=yN;cr.Suspense=bN;cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IN;cr.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=B6({},t.props),i=t.key,s=t.ref,A=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,A=Q3.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(y in e)F6.call(e,y)&&!N6.hasOwnProperty(y)&&(r[y]=e[y]===void 0&&a!==void 0?a[y]:e[y])}var y=arguments.length-2;if(y===1)r.children=n;else if(1<y){a=Array(y);for(var w=0;w<y;w++)a[w]=arguments[w+2];r.children=a}return{$$typeof:Cg,type:t.type,key:i,ref:s,props:r,_owner:A}};cr.createContext=function(t){return t={$$typeof:xN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:vN,_context:t},t.Consumer=t};cr.createElement=U6;cr.createFactory=function(t){var e=U6.bind(null,t);return e.type=t,e};cr.createRef=function(){return{current:null}};cr.forwardRef=function(t){return{$$typeof:wN,render:t}};cr.isValidElement=q3;cr.lazy=function(t){return{$$typeof:TN,_payload:{_status:-1,_result:t},_init:PN}};cr.memo=function(t,e){return{$$typeof:EN,type:t,compare:e===void 0?null:e}};cr.startTransition=function(t){var e=M1.transition;M1.transition={};try{t()}finally{M1.transition=e}};cr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};cr.useCallback=function(t,e){return Co.current.useCallback(t,e)};cr.useContext=function(t){return Co.current.useContext(t)};cr.useDebugValue=function(){};cr.useDeferredValue=function(t){return Co.current.useDeferredValue(t)};cr.useEffect=function(t,e){return Co.current.useEffect(t,e)};cr.useId=function(){return Co.current.useId()};cr.useImperativeHandle=function(t,e,n){return Co.current.useImperativeHandle(t,e,n)};cr.useInsertionEffect=function(t,e){return Co.current.useInsertionEffect(t,e)};cr.useLayoutEffect=function(t,e){return Co.current.useLayoutEffect(t,e)};cr.useMemo=function(t,e){return Co.current.useMemo(t,e)};cr.useReducer=function(t,e,n){return Co.current.useReducer(t,e,n)};cr.useRef=function(t){return Co.current.useRef(t)};cr.useState=function(t){return Co.current.useState(t)};cr.useSyncExternalStore=function(t,e,n){return Co.current.useSyncExternalStore(t,e,n)};cr.useTransition=function(){return Co.current.useTransition()};cr.version="18.2.0";D6.exports=cr;var At=D6.exports;const qn=G_(At),kN=$3({__proto__:null,default:qn},[At]);var V6={exports:{}},Ca={},G6={exports:{}},j6={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(yt,bt){var Kt=yt.length;yt.push(bt);e:for(;0<Kt;){var In=Kt-1>>>1,En=yt[In];if(0<i(En,bt))yt[In]=bt,yt[Kt]=En,Kt=In;else break e}}function n(yt){return yt.length===0?null:yt[0]}function r(yt){if(yt.length===0)return null;var bt=yt[0],Kt=yt.pop();if(Kt!==bt){yt[0]=Kt;e:for(var In=0,En=yt.length,Er=En>>>1;In<Er;){var Jn=2*(In+1)-1,ir=yt[Jn],Ar=Jn+1,Nn=yt[Ar];if(0>i(ir,Kt))Ar<En&&0>i(Nn,ir)?(yt[In]=Nn,yt[Ar]=Kt,In=Ar):(yt[In]=ir,yt[Jn]=Kt,In=Jn);else if(Ar<En&&0>i(Nn,Kt))yt[In]=Nn,yt[Ar]=Kt,In=Ar;else break e}}return bt}function i(yt,bt){var Kt=yt.sortIndex-bt.sortIndex;return Kt!==0?Kt:yt.id-bt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var A=Date,a=A.now();t.unstable_now=function(){return A.now()-a}}var y=[],w=[],P=1,I=null,L=3,U=!1,W=!1,q=!1,ae=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,ne=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ie(yt){for(var bt=n(w);bt!==null;){if(bt.callback===null)r(w);else if(bt.startTime<=yt)r(w),bt.sortIndex=bt.expirationTime,e(y,bt);else break;bt=n(w)}}function fe(yt){if(q=!1,ie(yt),!W)if(n(y)!==null)W=!0,Et(ye);else{var bt=n(w);bt!==null&&fn(fe,bt.startTime-yt)}}function ye(yt,bt){W=!1,q&&(q=!1,K(Qe),Qe=-1),U=!0;var Kt=L;try{for(ie(bt),I=n(y);I!==null&&(!(I.expirationTime>bt)||yt&&!Ne());){var In=I.callback;if(typeof In=="function"){I.callback=null,L=I.priorityLevel;var En=In(I.expirationTime<=bt);bt=t.unstable_now(),typeof En=="function"?I.callback=En:I===n(y)&&r(y),ie(bt)}else r(y);I=n(y)}if(I!==null)var Er=!0;else{var Jn=n(w);Jn!==null&&fn(fe,Jn.startTime-bt),Er=!1}return Er}finally{I=null,L=Kt,U=!1}}var Me=!1,He=null,Qe=-1,Je=5,tt=-1;function Ne(){return!(t.unstable_now()-tt<Je)}function nt(){if(He!==null){var yt=t.unstable_now();tt=yt;var bt=!0;try{bt=He(!0,yt)}finally{bt?qe():(Me=!1,He=null)}}else Me=!1}var qe;if(typeof ne=="function")qe=function(){ne(nt)};else if(typeof MessageChannel<"u"){var mt=new MessageChannel,Xt=mt.port2;mt.port1.onmessage=nt,qe=function(){Xt.postMessage(null)}}else qe=function(){ae(nt,0)};function Et(yt){He=yt,Me||(Me=!0,qe())}function fn(yt,bt){Qe=ae(function(){yt(t.unstable_now())},bt)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(yt){yt.callback=null},t.unstable_continueExecution=function(){W||U||(W=!0,Et(ye))},t.unstable_forceFrameRate=function(yt){0>yt||125<yt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Je=0<yt?Math.floor(1e3/yt):5},t.unstable_getCurrentPriorityLevel=function(){return L},t.unstable_getFirstCallbackNode=function(){return n(y)},t.unstable_next=function(yt){switch(L){case 1:case 2:case 3:var bt=3;break;default:bt=L}var Kt=L;L=bt;try{return yt()}finally{L=Kt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(yt,bt){switch(yt){case 1:case 2:case 3:case 4:case 5:break;default:yt=3}var Kt=L;L=yt;try{return bt()}finally{L=Kt}},t.unstable_scheduleCallback=function(yt,bt,Kt){var In=t.unstable_now();switch(typeof Kt=="object"&&Kt!==null?(Kt=Kt.delay,Kt=typeof Kt=="number"&&0<Kt?In+Kt:In):Kt=In,yt){case 1:var En=-1;break;case 2:En=250;break;case 5:En=1073741823;break;case 4:En=1e4;break;default:En=5e3}return En=Kt+En,yt={id:P++,callback:bt,priorityLevel:yt,startTime:Kt,expirationTime:En,sortIndex:-1},Kt>In?(yt.sortIndex=Kt,e(w,yt),n(y)===null&&yt===n(w)&&(q?(K(Qe),Qe=-1):q=!0,fn(fe,Kt-In))):(yt.sortIndex=En,e(y,yt),W||U||(W=!0,Et(ye))),yt},t.unstable_shouldYield=Ne,t.unstable_wrapCallback=function(yt){var bt=L;return function(){var Kt=L;L=bt;try{return yt.apply(this,arguments)}finally{L=Kt}}}})(j6);G6.exports=j6;var LN=G6.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $6=At,Ma=LN;function Rt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var H6=new Set,Bp={};function Yh(t,e){S0(t,e),S0(t+"Capture",e)}function S0(t,e){for(Bp[t]=e,t=0;t<e.length;t++)H6.add(e[t])}var ku=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vw=Object.prototype.hasOwnProperty,DN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Y4={},X4={};function RN(t){return vw.call(X4,t)?!0:vw.call(Y4,t)?!1:DN.test(t)?X4[t]=!0:(Y4[t]=!0,!1)}function BN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function zN(t,e,n,r){if(e===null||typeof e>"u"||BN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Po(t,e,n,r,i,s,A){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=A}var Ts={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ts[t]=new Po(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ts[e]=new Po(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ts[t]=new Po(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ts[t]=new Po(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ts[t]=new Po(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ts[t]=new Po(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ts[t]=new Po(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ts[t]=new Po(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ts[t]=new Po(t,5,!1,t.toLowerCase(),null,!1,!1)});var Z3=/[\-:]([a-z])/g;function Y3(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Z3,Y3);Ts[e]=new Po(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Z3,Y3);Ts[e]=new Po(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Z3,Y3);Ts[e]=new Po(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ts[t]=new Po(t,1,!1,t.toLowerCase(),null,!1,!1)});Ts.xlinkHref=new Po("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ts[t]=new Po(t,1,!1,t.toLowerCase(),null,!0,!0)});function X3(t,e,n,r){var i=Ts.hasOwnProperty(e)?Ts[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(zN(e,n,i,r)&&(n=null),r||i===null?RN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Hu=$6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wm=Symbol.for("react.element"),Bf=Symbol.for("react.portal"),zf=Symbol.for("react.fragment"),K3=Symbol.for("react.strict_mode"),xw=Symbol.for("react.profiler"),W6=Symbol.for("react.provider"),Q6=Symbol.for("react.context"),J3=Symbol.for("react.forward_ref"),ww=Symbol.for("react.suspense"),bw=Symbol.for("react.suspense_list"),eE=Symbol.for("react.memo"),_c=Symbol.for("react.lazy"),q6=Symbol.for("react.offscreen"),K4=Symbol.iterator;function Td(t){return t===null||typeof t!="object"?null:(t=K4&&t[K4]||t["@@iterator"],typeof t=="function"?t:null)}var di=Object.assign,Mv;function np(t){if(Mv===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Mv=e&&e[1]||""}return`
`+Mv+t}var Cv=!1;function Pv(t,e){if(!t||Cv)return"";Cv=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(w){var r=w}Reflect.construct(t,[],e)}else{try{e.call()}catch(w){r=w}t.call(e.prototype)}else{try{throw Error()}catch(w){r=w}t()}}catch(w){if(w&&r&&typeof w.stack=="string"){for(var i=w.stack.split(`
`),s=r.stack.split(`
`),A=i.length-1,a=s.length-1;1<=A&&0<=a&&i[A]!==s[a];)a--;for(;1<=A&&0<=a;A--,a--)if(i[A]!==s[a]){if(A!==1||a!==1)do if(A--,a--,0>a||i[A]!==s[a]){var y=`
`+i[A].replace(" at new "," at ");return t.displayName&&y.includes("<anonymous>")&&(y=y.replace("<anonymous>",t.displayName)),y}while(1<=A&&0<=a);break}}}finally{Cv=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?np(t):""}function ON(t){switch(t.tag){case 5:return np(t.type);case 16:return np("Lazy");case 13:return np("Suspense");case 19:return np("SuspenseList");case 0:case 2:case 15:return t=Pv(t.type,!1),t;case 11:return t=Pv(t.type.render,!1),t;case 1:return t=Pv(t.type,!0),t;default:return""}}function Ew(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zf:return"Fragment";case Bf:return"Portal";case xw:return"Profiler";case K3:return"StrictMode";case ww:return"Suspense";case bw:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Q6:return(t.displayName||"Context")+".Consumer";case W6:return(t._context.displayName||"Context")+".Provider";case J3:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case eE:return e=t.displayName||null,e!==null?e:Ew(t.type)||"Memo";case _c:e=t._payload,t=t._init;try{return Ew(t(e))}catch{}}return null}function FN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ew(e);case 8:return e===K3?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Hc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Z6(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function NN(t){var e=Z6(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(A){r=""+A,s.call(this,A)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(A){r=""+A},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function bm(t){t._valueTracker||(t._valueTracker=NN(t))}function Y6(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Z6(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function uy(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Tw(t,e){var n=e.checked;return di({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function J4(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Hc(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function X6(t,e){e=e.checked,e!=null&&X3(t,"checked",e,!1)}function Sw(t,e){X6(t,e);var n=Hc(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Mw(t,e.type,n):e.hasOwnProperty("defaultValue")&&Mw(t,e.type,Hc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function eM(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Mw(t,e,n){(e!=="number"||uy(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var rp=Array.isArray;function A0(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Hc(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Cw(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Rt(91));return di({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function tM(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Rt(92));if(rp(n)){if(1<n.length)throw Error(Rt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Hc(n)}}function K6(t,e){var n=Hc(e.value),r=Hc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function nM(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function J6(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pw(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?J6(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Em,e8=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Em=Em||document.createElement("div"),Em.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Em.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var mp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},UN=["Webkit","ms","Moz","O"];Object.keys(mp).forEach(function(t){UN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),mp[e]=mp[t]})});function t8(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||mp.hasOwnProperty(t)&&mp[t]?(""+e).trim():e+"px"}function n8(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=t8(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var VN=di({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Iw(t,e){if(e){if(VN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Rt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Rt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Rt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Rt(62))}}function kw(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lw=null;function tE(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Dw=null,u0=null,c0=null;function rM(t){if(t=kg(t)){if(typeof Dw!="function")throw Error(Rt(280));var e=t.stateNode;e&&(e=Q_(e),Dw(t.stateNode,t.type,e))}}function r8(t){u0?c0?c0.push(t):c0=[t]:u0=t}function i8(){if(u0){var t=u0,e=c0;if(c0=u0=null,rM(t),e)for(t=0;t<e.length;t++)rM(e[t])}}function s8(t,e){return t(e)}function o8(){}var Iv=!1;function a8(t,e,n){if(Iv)return t(e,n);Iv=!0;try{return s8(t,e,n)}finally{Iv=!1,(u0!==null||c0!==null)&&(o8(),i8())}}function Op(t,e){var n=t.stateNode;if(n===null)return null;var r=Q_(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Rt(231,e,typeof n));return n}var Rw=!1;if(ku)try{var Sd={};Object.defineProperty(Sd,"passive",{get:function(){Rw=!0}}),window.addEventListener("test",Sd,Sd),window.removeEventListener("test",Sd,Sd)}catch{Rw=!1}function GN(t,e,n,r,i,s,A,a,y){var w=Array.prototype.slice.call(arguments,3);try{e.apply(n,w)}catch(P){this.onError(P)}}var yp=!1,cy=null,hy=!1,Bw=null,jN={onError:function(t){yp=!0,cy=t}};function $N(t,e,n,r,i,s,A,a,y){yp=!1,cy=null,GN.apply(jN,arguments)}function HN(t,e,n,r,i,s,A,a,y){if($N.apply(this,arguments),yp){if(yp){var w=cy;yp=!1,cy=null}else throw Error(Rt(198));hy||(hy=!0,Bw=w)}}function Xh(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function l8(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function iM(t){if(Xh(t)!==t)throw Error(Rt(188))}function WN(t){var e=t.alternate;if(!e){if(e=Xh(t),e===null)throw Error(Rt(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return iM(i),t;if(s===r)return iM(i),e;s=s.sibling}throw Error(Rt(188))}if(n.return!==r.return)n=i,r=s;else{for(var A=!1,a=i.child;a;){if(a===n){A=!0,n=i,r=s;break}if(a===r){A=!0,r=i,n=s;break}a=a.sibling}if(!A){for(a=s.child;a;){if(a===n){A=!0,n=s,r=i;break}if(a===r){A=!0,r=s,n=i;break}a=a.sibling}if(!A)throw Error(Rt(189))}}if(n.alternate!==r)throw Error(Rt(190))}if(n.tag!==3)throw Error(Rt(188));return n.stateNode.current===n?t:e}function A8(t){return t=WN(t),t!==null?u8(t):null}function u8(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=u8(t);if(e!==null)return e;t=t.sibling}return null}var c8=Ma.unstable_scheduleCallback,sM=Ma.unstable_cancelCallback,QN=Ma.unstable_shouldYield,qN=Ma.unstable_requestPaint,Ii=Ma.unstable_now,ZN=Ma.unstable_getCurrentPriorityLevel,nE=Ma.unstable_ImmediatePriority,h8=Ma.unstable_UserBlockingPriority,fy=Ma.unstable_NormalPriority,YN=Ma.unstable_LowPriority,f8=Ma.unstable_IdlePriority,j_=null,PA=null;function XN(t){if(PA&&typeof PA.onCommitFiberRoot=="function")try{PA.onCommitFiberRoot(j_,t,void 0,(t.current.flags&128)===128)}catch{}}var Hl=Math.clz32?Math.clz32:e9,KN=Math.log,JN=Math.LN2;function e9(t){return t>>>=0,t===0?32:31-(KN(t)/JN|0)|0}var Tm=64,Sm=4194304;function ip(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function dy(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,A=n&268435455;if(A!==0){var a=A&~i;a!==0?r=ip(a):(s&=A,s!==0&&(r=ip(s)))}else A=n&~i,A!==0?r=ip(A):s!==0&&(r=ip(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Hl(e),i=1<<n,r|=t[n],e&=~i;return r}function t9(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function n9(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var A=31-Hl(s),a=1<<A,y=i[A];y===-1?(!(a&n)||a&r)&&(i[A]=t9(a,e)):y<=e&&(t.expiredLanes|=a),s&=~a}}function zw(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function d8(){var t=Tm;return Tm<<=1,!(Tm&4194240)&&(Tm=64),t}function kv(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Pg(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Hl(e),t[e]=n}function r9(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Hl(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function rE(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Hl(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ir=0;function p8(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var g8,iE,m8,y8,_8,Ow=!1,Mm=[],Lc=null,Dc=null,Rc=null,Fp=new Map,Np=new Map,wc=[],i9="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oM(t,e){switch(t){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Dc=null;break;case"mouseover":case"mouseout":Rc=null;break;case"pointerover":case"pointerout":Fp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Np.delete(e.pointerId)}}function Md(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=kg(e),e!==null&&iE(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function s9(t,e,n,r,i){switch(e){case"focusin":return Lc=Md(Lc,t,e,n,r,i),!0;case"dragenter":return Dc=Md(Dc,t,e,n,r,i),!0;case"mouseover":return Rc=Md(Rc,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Fp.set(s,Md(Fp.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Np.set(s,Md(Np.get(s)||null,t,e,n,r,i)),!0}return!1}function v8(t){var e=vh(t.target);if(e!==null){var n=Xh(e);if(n!==null){if(e=n.tag,e===13){if(e=l8(n),e!==null){t.blockedOn=e,_8(t.priority,function(){m8(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function C1(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Fw(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Lw=r,n.target.dispatchEvent(r),Lw=null}else return e=kg(n),e!==null&&iE(e),t.blockedOn=n,!1;e.shift()}return!0}function aM(t,e,n){C1(t)&&n.delete(e)}function o9(){Ow=!1,Lc!==null&&C1(Lc)&&(Lc=null),Dc!==null&&C1(Dc)&&(Dc=null),Rc!==null&&C1(Rc)&&(Rc=null),Fp.forEach(aM),Np.forEach(aM)}function Cd(t,e){t.blockedOn===e&&(t.blockedOn=null,Ow||(Ow=!0,Ma.unstable_scheduleCallback(Ma.unstable_NormalPriority,o9)))}function Up(t){function e(i){return Cd(i,t)}if(0<Mm.length){Cd(Mm[0],t);for(var n=1;n<Mm.length;n++){var r=Mm[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Lc!==null&&Cd(Lc,t),Dc!==null&&Cd(Dc,t),Rc!==null&&Cd(Rc,t),Fp.forEach(e),Np.forEach(e),n=0;n<wc.length;n++)r=wc[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<wc.length&&(n=wc[0],n.blockedOn===null);)v8(n),n.blockedOn===null&&wc.shift()}var h0=Hu.ReactCurrentBatchConfig,py=!0;function a9(t,e,n,r){var i=Ir,s=h0.transition;h0.transition=null;try{Ir=1,sE(t,e,n,r)}finally{Ir=i,h0.transition=s}}function l9(t,e,n,r){var i=Ir,s=h0.transition;h0.transition=null;try{Ir=4,sE(t,e,n,r)}finally{Ir=i,h0.transition=s}}function sE(t,e,n,r){if(py){var i=Fw(t,e,n,r);if(i===null)Vv(t,e,r,gy,n),oM(t,r);else if(s9(i,t,e,n,r))r.stopPropagation();else if(oM(t,r),e&4&&-1<i9.indexOf(t)){for(;i!==null;){var s=kg(i);if(s!==null&&g8(s),s=Fw(t,e,n,r),s===null&&Vv(t,e,r,gy,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Vv(t,e,r,null,n)}}var gy=null;function Fw(t,e,n,r){if(gy=null,t=tE(r),t=vh(t),t!==null)if(e=Xh(t),e===null)t=null;else if(n=e.tag,n===13){if(t=l8(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return gy=t,null}function x8(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ZN()){case nE:return 1;case h8:return 4;case fy:case YN:return 16;case f8:return 536870912;default:return 16}default:return 16}}var Tc=null,oE=null,P1=null;function w8(){if(P1)return P1;var t,e=oE,n=e.length,r,i="value"in Tc?Tc.value:Tc.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var A=n-t;for(r=1;r<=A&&e[n-r]===i[s-r];r++);return P1=i.slice(t,1<r?1-r:void 0)}function I1(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Cm(){return!0}function lM(){return!1}function Pa(t){function e(n,r,i,s,A){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=A,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Cm:lM,this.isPropagationStopped=lM,this}return di(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Cm)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Cm)},persist:function(){},isPersistent:Cm}),e}var X0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},aE=Pa(X0),Ig=di({},X0,{view:0,detail:0}),A9=Pa(Ig),Lv,Dv,Pd,$_=di({},Ig,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lE,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Pd&&(Pd&&t.type==="mousemove"?(Lv=t.screenX-Pd.screenX,Dv=t.screenY-Pd.screenY):Dv=Lv=0,Pd=t),Lv)},movementY:function(t){return"movementY"in t?t.movementY:Dv}}),AM=Pa($_),u9=di({},$_,{dataTransfer:0}),c9=Pa(u9),h9=di({},Ig,{relatedTarget:0}),Rv=Pa(h9),f9=di({},X0,{animationName:0,elapsedTime:0,pseudoElement:0}),d9=Pa(f9),p9=di({},X0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),g9=Pa(p9),m9=di({},X0,{data:0}),uM=Pa(m9),y9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},v9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function x9(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=v9[t])?!!e[t]:!1}function lE(){return x9}var w9=di({},Ig,{key:function(t){if(t.key){var e=y9[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=I1(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?_9[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lE,charCode:function(t){return t.type==="keypress"?I1(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?I1(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),b9=Pa(w9),E9=di({},$_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cM=Pa(E9),T9=di({},Ig,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lE}),S9=Pa(T9),M9=di({},X0,{propertyName:0,elapsedTime:0,pseudoElement:0}),C9=Pa(M9),P9=di({},$_,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),I9=Pa(P9),k9=[9,13,27,32],AE=ku&&"CompositionEvent"in window,_p=null;ku&&"documentMode"in document&&(_p=document.documentMode);var L9=ku&&"TextEvent"in window&&!_p,b8=ku&&(!AE||_p&&8<_p&&11>=_p),hM=String.fromCharCode(32),fM=!1;function E8(t,e){switch(t){case"keyup":return k9.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function T8(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Of=!1;function D9(t,e){switch(t){case"compositionend":return T8(e);case"keypress":return e.which!==32?null:(fM=!0,hM);case"textInput":return t=e.data,t===hM&&fM?null:t;default:return null}}function R9(t,e){if(Of)return t==="compositionend"||!AE&&E8(t,e)?(t=w8(),P1=oE=Tc=null,Of=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return b8&&e.locale!=="ko"?null:e.data;default:return null}}var B9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dM(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!B9[t.type]:e==="textarea"}function S8(t,e,n,r){r8(r),e=my(e,"onChange"),0<e.length&&(n=new aE("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var vp=null,Vp=null;function z9(t){O8(t,0)}function H_(t){var e=Uf(t);if(Y6(e))return t}function O9(t,e){if(t==="change")return e}var M8=!1;if(ku){var Bv;if(ku){var zv="oninput"in document;if(!zv){var pM=document.createElement("div");pM.setAttribute("oninput","return;"),zv=typeof pM.oninput=="function"}Bv=zv}else Bv=!1;M8=Bv&&(!document.documentMode||9<document.documentMode)}function gM(){vp&&(vp.detachEvent("onpropertychange",C8),Vp=vp=null)}function C8(t){if(t.propertyName==="value"&&H_(Vp)){var e=[];S8(e,Vp,t,tE(t)),a8(z9,e)}}function F9(t,e,n){t==="focusin"?(gM(),vp=e,Vp=n,vp.attachEvent("onpropertychange",C8)):t==="focusout"&&gM()}function N9(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return H_(Vp)}function U9(t,e){if(t==="click")return H_(e)}function V9(t,e){if(t==="input"||t==="change")return H_(e)}function G9(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ql=typeof Object.is=="function"?Object.is:G9;function Gp(t,e){if(ql(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!vw.call(e,i)||!ql(t[i],e[i]))return!1}return!0}function mM(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function yM(t,e){var n=mM(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=mM(n)}}function P8(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?P8(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function I8(){for(var t=window,e=uy();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=uy(t.document)}return e}function uE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function j9(t){var e=I8(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&P8(n.ownerDocument.documentElement,n)){if(r!==null&&uE(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=yM(n,s);var A=yM(n,r);i&&A&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==A.node||t.focusOffset!==A.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(A.node,A.offset)):(e.setEnd(A.node,A.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var $9=ku&&"documentMode"in document&&11>=document.documentMode,Ff=null,Nw=null,xp=null,Uw=!1;function _M(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Uw||Ff==null||Ff!==uy(r)||(r=Ff,"selectionStart"in r&&uE(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),xp&&Gp(xp,r)||(xp=r,r=my(Nw,"onSelect"),0<r.length&&(e=new aE("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ff)))}function Pm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Nf={animationend:Pm("Animation","AnimationEnd"),animationiteration:Pm("Animation","AnimationIteration"),animationstart:Pm("Animation","AnimationStart"),transitionend:Pm("Transition","TransitionEnd")},Ov={},k8={};ku&&(k8=document.createElement("div").style,"AnimationEvent"in window||(delete Nf.animationend.animation,delete Nf.animationiteration.animation,delete Nf.animationstart.animation),"TransitionEvent"in window||delete Nf.transitionend.transition);function W_(t){if(Ov[t])return Ov[t];if(!Nf[t])return t;var e=Nf[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in k8)return Ov[t]=e[n];return t}var L8=W_("animationend"),D8=W_("animationiteration"),R8=W_("animationstart"),B8=W_("transitionend"),z8=new Map,vM="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yc(t,e){z8.set(t,e),Yh(e,[t])}for(var Fv=0;Fv<vM.length;Fv++){var Nv=vM[Fv],H9=Nv.toLowerCase(),W9=Nv[0].toUpperCase()+Nv.slice(1);Yc(H9,"on"+W9)}Yc(L8,"onAnimationEnd");Yc(D8,"onAnimationIteration");Yc(R8,"onAnimationStart");Yc("dblclick","onDoubleClick");Yc("focusin","onFocus");Yc("focusout","onBlur");Yc(B8,"onTransitionEnd");S0("onMouseEnter",["mouseout","mouseover"]);S0("onMouseLeave",["mouseout","mouseover"]);S0("onPointerEnter",["pointerout","pointerover"]);S0("onPointerLeave",["pointerout","pointerover"]);Yh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Yh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Yh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Yh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Yh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Yh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Q9=new Set("cancel close invalid load scroll toggle".split(" ").concat(sp));function xM(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,HN(r,e,void 0,t),t.currentTarget=null}function O8(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var A=r.length-1;0<=A;A--){var a=r[A],y=a.instance,w=a.currentTarget;if(a=a.listener,y!==s&&i.isPropagationStopped())break e;xM(i,a,w),s=y}else for(A=0;A<r.length;A++){if(a=r[A],y=a.instance,w=a.currentTarget,a=a.listener,y!==s&&i.isPropagationStopped())break e;xM(i,a,w),s=y}}}if(hy)throw t=Bw,hy=!1,Bw=null,t}function ti(t,e){var n=e[Hw];n===void 0&&(n=e[Hw]=new Set);var r=t+"__bubble";n.has(r)||(F8(e,t,2,!1),n.add(r))}function Uv(t,e,n){var r=0;e&&(r|=4),F8(n,t,r,e)}var Im="_reactListening"+Math.random().toString(36).slice(2);function jp(t){if(!t[Im]){t[Im]=!0,H6.forEach(function(n){n!=="selectionchange"&&(Q9.has(n)||Uv(n,!1,t),Uv(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Im]||(e[Im]=!0,Uv("selectionchange",!1,e))}}function F8(t,e,n,r){switch(x8(e)){case 1:var i=a9;break;case 4:i=l9;break;default:i=sE}n=i.bind(null,e,n,t),i=void 0,!Rw||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Vv(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var A=r.tag;if(A===3||A===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(A===4)for(A=r.return;A!==null;){var y=A.tag;if((y===3||y===4)&&(y=A.stateNode.containerInfo,y===i||y.nodeType===8&&y.parentNode===i))return;A=A.return}for(;a!==null;){if(A=vh(a),A===null)return;if(y=A.tag,y===5||y===6){r=s=A;continue e}a=a.parentNode}}r=r.return}a8(function(){var w=s,P=tE(n),I=[];e:{var L=z8.get(t);if(L!==void 0){var U=aE,W=t;switch(t){case"keypress":if(I1(n)===0)break e;case"keydown":case"keyup":U=b9;break;case"focusin":W="focus",U=Rv;break;case"focusout":W="blur",U=Rv;break;case"beforeblur":case"afterblur":U=Rv;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":U=AM;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":U=c9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":U=S9;break;case L8:case D8:case R8:U=d9;break;case B8:U=C9;break;case"scroll":U=A9;break;case"wheel":U=I9;break;case"copy":case"cut":case"paste":U=g9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":U=cM}var q=(e&4)!==0,ae=!q&&t==="scroll",K=q?L!==null?L+"Capture":null:L;q=[];for(var ne=w,ie;ne!==null;){ie=ne;var fe=ie.stateNode;if(ie.tag===5&&fe!==null&&(ie=fe,K!==null&&(fe=Op(ne,K),fe!=null&&q.push($p(ne,fe,ie)))),ae)break;ne=ne.return}0<q.length&&(L=new U(L,W,null,n,P),I.push({event:L,listeners:q}))}}if(!(e&7)){e:{if(L=t==="mouseover"||t==="pointerover",U=t==="mouseout"||t==="pointerout",L&&n!==Lw&&(W=n.relatedTarget||n.fromElement)&&(vh(W)||W[Lu]))break e;if((U||L)&&(L=P.window===P?P:(L=P.ownerDocument)?L.defaultView||L.parentWindow:window,U?(W=n.relatedTarget||n.toElement,U=w,W=W?vh(W):null,W!==null&&(ae=Xh(W),W!==ae||W.tag!==5&&W.tag!==6)&&(W=null)):(U=null,W=w),U!==W)){if(q=AM,fe="onMouseLeave",K="onMouseEnter",ne="mouse",(t==="pointerout"||t==="pointerover")&&(q=cM,fe="onPointerLeave",K="onPointerEnter",ne="pointer"),ae=U==null?L:Uf(U),ie=W==null?L:Uf(W),L=new q(fe,ne+"leave",U,n,P),L.target=ae,L.relatedTarget=ie,fe=null,vh(P)===w&&(q=new q(K,ne+"enter",W,n,P),q.target=ie,q.relatedTarget=ae,fe=q),ae=fe,U&&W)t:{for(q=U,K=W,ne=0,ie=q;ie;ie=vf(ie))ne++;for(ie=0,fe=K;fe;fe=vf(fe))ie++;for(;0<ne-ie;)q=vf(q),ne--;for(;0<ie-ne;)K=vf(K),ie--;for(;ne--;){if(q===K||K!==null&&q===K.alternate)break t;q=vf(q),K=vf(K)}q=null}else q=null;U!==null&&wM(I,L,U,q,!1),W!==null&&ae!==null&&wM(I,ae,W,q,!0)}}e:{if(L=w?Uf(w):window,U=L.nodeName&&L.nodeName.toLowerCase(),U==="select"||U==="input"&&L.type==="file")var ye=O9;else if(dM(L))if(M8)ye=V9;else{ye=N9;var Me=F9}else(U=L.nodeName)&&U.toLowerCase()==="input"&&(L.type==="checkbox"||L.type==="radio")&&(ye=U9);if(ye&&(ye=ye(t,w))){S8(I,ye,n,P);break e}Me&&Me(t,L,w),t==="focusout"&&(Me=L._wrapperState)&&Me.controlled&&L.type==="number"&&Mw(L,"number",L.value)}switch(Me=w?Uf(w):window,t){case"focusin":(dM(Me)||Me.contentEditable==="true")&&(Ff=Me,Nw=w,xp=null);break;case"focusout":xp=Nw=Ff=null;break;case"mousedown":Uw=!0;break;case"contextmenu":case"mouseup":case"dragend":Uw=!1,_M(I,n,P);break;case"selectionchange":if($9)break;case"keydown":case"keyup":_M(I,n,P)}var He;if(AE)e:{switch(t){case"compositionstart":var Qe="onCompositionStart";break e;case"compositionend":Qe="onCompositionEnd";break e;case"compositionupdate":Qe="onCompositionUpdate";break e}Qe=void 0}else Of?E8(t,n)&&(Qe="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(Qe="onCompositionStart");Qe&&(b8&&n.locale!=="ko"&&(Of||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&Of&&(He=w8()):(Tc=P,oE="value"in Tc?Tc.value:Tc.textContent,Of=!0)),Me=my(w,Qe),0<Me.length&&(Qe=new uM(Qe,t,null,n,P),I.push({event:Qe,listeners:Me}),He?Qe.data=He:(He=T8(n),He!==null&&(Qe.data=He)))),(He=L9?D9(t,n):R9(t,n))&&(w=my(w,"onBeforeInput"),0<w.length&&(P=new uM("onBeforeInput","beforeinput",null,n,P),I.push({event:P,listeners:w}),P.data=He))}O8(I,e)})}function $p(t,e,n){return{instance:t,listener:e,currentTarget:n}}function my(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Op(t,n),s!=null&&r.unshift($p(t,s,i)),s=Op(t,e),s!=null&&r.push($p(t,s,i))),t=t.return}return r}function vf(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function wM(t,e,n,r,i){for(var s=e._reactName,A=[];n!==null&&n!==r;){var a=n,y=a.alternate,w=a.stateNode;if(y!==null&&y===r)break;a.tag===5&&w!==null&&(a=w,i?(y=Op(n,s),y!=null&&A.unshift($p(n,y,a))):i||(y=Op(n,s),y!=null&&A.push($p(n,y,a)))),n=n.return}A.length!==0&&t.push({event:e,listeners:A})}var q9=/\r\n?/g,Z9=/\u0000|\uFFFD/g;function bM(t){return(typeof t=="string"?t:""+t).replace(q9,`
`).replace(Z9,"")}function km(t,e,n){if(e=bM(e),bM(t)!==e&&n)throw Error(Rt(425))}function yy(){}var Vw=null,Gw=null;function jw(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var $w=typeof setTimeout=="function"?setTimeout:void 0,Y9=typeof clearTimeout=="function"?clearTimeout:void 0,EM=typeof Promise=="function"?Promise:void 0,X9=typeof queueMicrotask=="function"?queueMicrotask:typeof EM<"u"?function(t){return EM.resolve(null).then(t).catch(K9)}:$w;function K9(t){setTimeout(function(){throw t})}function Gv(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Up(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Up(e)}function Bc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function TM(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var K0=Math.random().toString(36).slice(2),bA="__reactFiber$"+K0,Hp="__reactProps$"+K0,Lu="__reactContainer$"+K0,Hw="__reactEvents$"+K0,J9="__reactListeners$"+K0,eU="__reactHandles$"+K0;function vh(t){var e=t[bA];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Lu]||n[bA]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=TM(t);t!==null;){if(n=t[bA])return n;t=TM(t)}return e}t=n,n=t.parentNode}return null}function kg(t){return t=t[bA]||t[Lu],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Uf(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Rt(33))}function Q_(t){return t[Hp]||null}var Ww=[],Vf=-1;function Xc(t){return{current:t}}function ni(t){0>Vf||(t.current=Ww[Vf],Ww[Vf]=null,Vf--)}function qr(t,e){Vf++,Ww[Vf]=t.current,t.current=e}var Wc={},io=Xc(Wc),Qo=Xc(!1),Ph=Wc;function M0(t,e){var n=t.type.contextTypes;if(!n)return Wc;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function qo(t){return t=t.childContextTypes,t!=null}function _y(){ni(Qo),ni(io)}function SM(t,e,n){if(io.current!==Wc)throw Error(Rt(168));qr(io,e),qr(Qo,n)}function N8(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Rt(108,FN(t)||"Unknown",i));return di({},n,r)}function vy(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Wc,Ph=io.current,qr(io,t),qr(Qo,Qo.current),!0}function MM(t,e,n){var r=t.stateNode;if(!r)throw Error(Rt(169));n?(t=N8(t,e,Ph),r.__reactInternalMemoizedMergedChildContext=t,ni(Qo),ni(io),qr(io,t)):ni(Qo),qr(Qo,n)}var mu=null,q_=!1,jv=!1;function U8(t){mu===null?mu=[t]:mu.push(t)}function tU(t){q_=!0,U8(t)}function Kc(){if(!jv&&mu!==null){jv=!0;var t=0,e=Ir;try{var n=mu;for(Ir=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}mu=null,q_=!1}catch(i){throw mu!==null&&(mu=mu.slice(t+1)),c8(nE,Kc),i}finally{Ir=e,jv=!1}}return null}var Gf=[],jf=0,xy=null,wy=0,el=[],tl=0,Ih=null,vu=1,xu="";function ph(t,e){Gf[jf++]=wy,Gf[jf++]=xy,xy=t,wy=e}function V8(t,e,n){el[tl++]=vu,el[tl++]=xu,el[tl++]=Ih,Ih=t;var r=vu;t=xu;var i=32-Hl(r)-1;r&=~(1<<i),n+=1;var s=32-Hl(e)+i;if(30<s){var A=i-i%5;s=(r&(1<<A)-1).toString(32),r>>=A,i-=A,vu=1<<32-Hl(e)+i|n<<i|r,xu=s+t}else vu=1<<s|n<<i|r,xu=t}function cE(t){t.return!==null&&(ph(t,1),V8(t,1,0))}function hE(t){for(;t===xy;)xy=Gf[--jf],Gf[jf]=null,wy=Gf[--jf],Gf[jf]=null;for(;t===Ih;)Ih=el[--tl],el[tl]=null,xu=el[--tl],el[tl]=null,vu=el[--tl],el[tl]=null}var Ta=null,ba=null,li=!1,Bl=null;function G8(t,e){var n=nl(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function CM(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ta=t,ba=Bc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ta=t,ba=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ih!==null?{id:vu,overflow:xu}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=nl(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ta=t,ba=null,!0):!1;default:return!1}}function Qw(t){return(t.mode&1)!==0&&(t.flags&128)===0}function qw(t){if(li){var e=ba;if(e){var n=e;if(!CM(t,e)){if(Qw(t))throw Error(Rt(418));e=Bc(n.nextSibling);var r=Ta;e&&CM(t,e)?G8(r,n):(t.flags=t.flags&-4097|2,li=!1,Ta=t)}}else{if(Qw(t))throw Error(Rt(418));t.flags=t.flags&-4097|2,li=!1,Ta=t}}}function PM(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ta=t}function Lm(t){if(t!==Ta)return!1;if(!li)return PM(t),li=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!jw(t.type,t.memoizedProps)),e&&(e=ba)){if(Qw(t))throw j8(),Error(Rt(418));for(;e;)G8(t,e),e=Bc(e.nextSibling)}if(PM(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Rt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ba=Bc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ba=null}}else ba=Ta?Bc(t.stateNode.nextSibling):null;return!0}function j8(){for(var t=ba;t;)t=Bc(t.nextSibling)}function C0(){ba=Ta=null,li=!1}function fE(t){Bl===null?Bl=[t]:Bl.push(t)}var nU=Hu.ReactCurrentBatchConfig;function Dl(t,e){if(t&&t.defaultProps){e=di({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var by=Xc(null),Ey=null,$f=null,dE=null;function pE(){dE=$f=Ey=null}function gE(t){var e=by.current;ni(by),t._currentValue=e}function Zw(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function f0(t,e){Ey=t,dE=$f=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Wo=!0),t.firstContext=null)}function al(t){var e=t._currentValue;if(dE!==t)if(t={context:t,memoizedValue:e,next:null},$f===null){if(Ey===null)throw Error(Rt(308));$f=t,Ey.dependencies={lanes:0,firstContext:t}}else $f=$f.next=t;return e}var xh=null;function mE(t){xh===null?xh=[t]:xh.push(t)}function $8(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,mE(e)):(n.next=i.next,i.next=n),e.interleaved=n,Du(t,r)}function Du(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var vc=!1;function yE(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function H8(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Mu(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zc(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,vr&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Du(t,n)}return i=r.interleaved,i===null?(e.next=e,mE(r)):(e.next=i.next,i.next=e),r.interleaved=e,Du(t,n)}function k1(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rE(t,n)}}function IM(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var A={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=A:s=s.next=A,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ty(t,e,n,r){var i=t.updateQueue;vc=!1;var s=i.firstBaseUpdate,A=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var y=a,w=y.next;y.next=null,A===null?s=w:A.next=w,A=y;var P=t.alternate;P!==null&&(P=P.updateQueue,a=P.lastBaseUpdate,a!==A&&(a===null?P.firstBaseUpdate=w:a.next=w,P.lastBaseUpdate=y))}if(s!==null){var I=i.baseState;A=0,P=w=y=null,a=s;do{var L=a.lane,U=a.eventTime;if((r&L)===L){P!==null&&(P=P.next={eventTime:U,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var W=t,q=a;switch(L=e,U=n,q.tag){case 1:if(W=q.payload,typeof W=="function"){I=W.call(U,I,L);break e}I=W;break e;case 3:W.flags=W.flags&-65537|128;case 0:if(W=q.payload,L=typeof W=="function"?W.call(U,I,L):W,L==null)break e;I=di({},I,L);break e;case 2:vc=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,L=i.effects,L===null?i.effects=[a]:L.push(a))}else U={eventTime:U,lane:L,tag:a.tag,payload:a.payload,callback:a.callback,next:null},P===null?(w=P=U,y=I):P=P.next=U,A|=L;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;L=a,a=L.next,L.next=null,i.lastBaseUpdate=L,i.shared.pending=null}}while(1);if(P===null&&(y=I),i.baseState=y,i.firstBaseUpdate=w,i.lastBaseUpdate=P,e=i.shared.interleaved,e!==null){i=e;do A|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Lh|=A,t.lanes=A,t.memoizedState=I}}function kM(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Rt(191,i));i.call(r)}}}var W8=new $6.Component().refs;function Yw(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:di({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Z_={isMounted:function(t){return(t=t._reactInternals)?Xh(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=So(),i=Fc(t),s=Mu(r,i);s.payload=e,n!=null&&(s.callback=n),e=zc(t,s,i),e!==null&&(Wl(e,t,i,r),k1(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=So(),i=Fc(t),s=Mu(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=zc(t,s,i),e!==null&&(Wl(e,t,i,r),k1(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=So(),r=Fc(t),i=Mu(n,r);i.tag=2,e!=null&&(i.callback=e),e=zc(t,i,r),e!==null&&(Wl(e,t,r,n),k1(e,t,r))}};function LM(t,e,n,r,i,s,A){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,A):e.prototype&&e.prototype.isPureReactComponent?!Gp(n,r)||!Gp(i,s):!0}function Q8(t,e,n){var r=!1,i=Wc,s=e.contextType;return typeof s=="object"&&s!==null?s=al(s):(i=qo(e)?Ph:io.current,r=e.contextTypes,s=(r=r!=null)?M0(t,i):Wc),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Z_,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function DM(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Z_.enqueueReplaceState(e,e.state,null)}function Xw(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=W8,yE(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=al(s):(s=qo(e)?Ph:io.current,i.context=M0(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Yw(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Z_.enqueueReplaceState(i,i.state,null),Ty(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Id(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Rt(309));var r=n.stateNode}if(!r)throw Error(Rt(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(A){var a=i.refs;a===W8&&(a=i.refs={}),A===null?delete a[s]:a[s]=A},e._stringRef=s,e)}if(typeof t!="string")throw Error(Rt(284));if(!n._owner)throw Error(Rt(290,t))}return t}function Dm(t,e){throw t=Object.prototype.toString.call(e),Error(Rt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function RM(t){var e=t._init;return e(t._payload)}function q8(t){function e(K,ne){if(t){var ie=K.deletions;ie===null?(K.deletions=[ne],K.flags|=16):ie.push(ne)}}function n(K,ne){if(!t)return null;for(;ne!==null;)e(K,ne),ne=ne.sibling;return null}function r(K,ne){for(K=new Map;ne!==null;)ne.key!==null?K.set(ne.key,ne):K.set(ne.index,ne),ne=ne.sibling;return K}function i(K,ne){return K=Nc(K,ne),K.index=0,K.sibling=null,K}function s(K,ne,ie){return K.index=ie,t?(ie=K.alternate,ie!==null?(ie=ie.index,ie<ne?(K.flags|=2,ne):ie):(K.flags|=2,ne)):(K.flags|=1048576,ne)}function A(K){return t&&K.alternate===null&&(K.flags|=2),K}function a(K,ne,ie,fe){return ne===null||ne.tag!==6?(ne=Yv(ie,K.mode,fe),ne.return=K,ne):(ne=i(ne,ie),ne.return=K,ne)}function y(K,ne,ie,fe){var ye=ie.type;return ye===zf?P(K,ne,ie.props.children,fe,ie.key):ne!==null&&(ne.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===_c&&RM(ye)===ne.type)?(fe=i(ne,ie.props),fe.ref=Id(K,ne,ie),fe.return=K,fe):(fe=O1(ie.type,ie.key,ie.props,null,K.mode,fe),fe.ref=Id(K,ne,ie),fe.return=K,fe)}function w(K,ne,ie,fe){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==ie.containerInfo||ne.stateNode.implementation!==ie.implementation?(ne=Xv(ie,K.mode,fe),ne.return=K,ne):(ne=i(ne,ie.children||[]),ne.return=K,ne)}function P(K,ne,ie,fe,ye){return ne===null||ne.tag!==7?(ne=Sh(ie,K.mode,fe,ye),ne.return=K,ne):(ne=i(ne,ie),ne.return=K,ne)}function I(K,ne,ie){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return ne=Yv(""+ne,K.mode,ie),ne.return=K,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case wm:return ie=O1(ne.type,ne.key,ne.props,null,K.mode,ie),ie.ref=Id(K,null,ne),ie.return=K,ie;case Bf:return ne=Xv(ne,K.mode,ie),ne.return=K,ne;case _c:var fe=ne._init;return I(K,fe(ne._payload),ie)}if(rp(ne)||Td(ne))return ne=Sh(ne,K.mode,ie,null),ne.return=K,ne;Dm(K,ne)}return null}function L(K,ne,ie,fe){var ye=ne!==null?ne.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number")return ye!==null?null:a(K,ne,""+ie,fe);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case wm:return ie.key===ye?y(K,ne,ie,fe):null;case Bf:return ie.key===ye?w(K,ne,ie,fe):null;case _c:return ye=ie._init,L(K,ne,ye(ie._payload),fe)}if(rp(ie)||Td(ie))return ye!==null?null:P(K,ne,ie,fe,null);Dm(K,ie)}return null}function U(K,ne,ie,fe,ye){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return K=K.get(ie)||null,a(ne,K,""+fe,ye);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case wm:return K=K.get(fe.key===null?ie:fe.key)||null,y(ne,K,fe,ye);case Bf:return K=K.get(fe.key===null?ie:fe.key)||null,w(ne,K,fe,ye);case _c:var Me=fe._init;return U(K,ne,ie,Me(fe._payload),ye)}if(rp(fe)||Td(fe))return K=K.get(ie)||null,P(ne,K,fe,ye,null);Dm(ne,fe)}return null}function W(K,ne,ie,fe){for(var ye=null,Me=null,He=ne,Qe=ne=0,Je=null;He!==null&&Qe<ie.length;Qe++){He.index>Qe?(Je=He,He=null):Je=He.sibling;var tt=L(K,He,ie[Qe],fe);if(tt===null){He===null&&(He=Je);break}t&&He&&tt.alternate===null&&e(K,He),ne=s(tt,ne,Qe),Me===null?ye=tt:Me.sibling=tt,Me=tt,He=Je}if(Qe===ie.length)return n(K,He),li&&ph(K,Qe),ye;if(He===null){for(;Qe<ie.length;Qe++)He=I(K,ie[Qe],fe),He!==null&&(ne=s(He,ne,Qe),Me===null?ye=He:Me.sibling=He,Me=He);return li&&ph(K,Qe),ye}for(He=r(K,He);Qe<ie.length;Qe++)Je=U(He,K,Qe,ie[Qe],fe),Je!==null&&(t&&Je.alternate!==null&&He.delete(Je.key===null?Qe:Je.key),ne=s(Je,ne,Qe),Me===null?ye=Je:Me.sibling=Je,Me=Je);return t&&He.forEach(function(Ne){return e(K,Ne)}),li&&ph(K,Qe),ye}function q(K,ne,ie,fe){var ye=Td(ie);if(typeof ye!="function")throw Error(Rt(150));if(ie=ye.call(ie),ie==null)throw Error(Rt(151));for(var Me=ye=null,He=ne,Qe=ne=0,Je=null,tt=ie.next();He!==null&&!tt.done;Qe++,tt=ie.next()){He.index>Qe?(Je=He,He=null):Je=He.sibling;var Ne=L(K,He,tt.value,fe);if(Ne===null){He===null&&(He=Je);break}t&&He&&Ne.alternate===null&&e(K,He),ne=s(Ne,ne,Qe),Me===null?ye=Ne:Me.sibling=Ne,Me=Ne,He=Je}if(tt.done)return n(K,He),li&&ph(K,Qe),ye;if(He===null){for(;!tt.done;Qe++,tt=ie.next())tt=I(K,tt.value,fe),tt!==null&&(ne=s(tt,ne,Qe),Me===null?ye=tt:Me.sibling=tt,Me=tt);return li&&ph(K,Qe),ye}for(He=r(K,He);!tt.done;Qe++,tt=ie.next())tt=U(He,K,Qe,tt.value,fe),tt!==null&&(t&&tt.alternate!==null&&He.delete(tt.key===null?Qe:tt.key),ne=s(tt,ne,Qe),Me===null?ye=tt:Me.sibling=tt,Me=tt);return t&&He.forEach(function(nt){return e(K,nt)}),li&&ph(K,Qe),ye}function ae(K,ne,ie,fe){if(typeof ie=="object"&&ie!==null&&ie.type===zf&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case wm:e:{for(var ye=ie.key,Me=ne;Me!==null;){if(Me.key===ye){if(ye=ie.type,ye===zf){if(Me.tag===7){n(K,Me.sibling),ne=i(Me,ie.props.children),ne.return=K,K=ne;break e}}else if(Me.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===_c&&RM(ye)===Me.type){n(K,Me.sibling),ne=i(Me,ie.props),ne.ref=Id(K,Me,ie),ne.return=K,K=ne;break e}n(K,Me);break}else e(K,Me);Me=Me.sibling}ie.type===zf?(ne=Sh(ie.props.children,K.mode,fe,ie.key),ne.return=K,K=ne):(fe=O1(ie.type,ie.key,ie.props,null,K.mode,fe),fe.ref=Id(K,ne,ie),fe.return=K,K=fe)}return A(K);case Bf:e:{for(Me=ie.key;ne!==null;){if(ne.key===Me)if(ne.tag===4&&ne.stateNode.containerInfo===ie.containerInfo&&ne.stateNode.implementation===ie.implementation){n(K,ne.sibling),ne=i(ne,ie.children||[]),ne.return=K,K=ne;break e}else{n(K,ne);break}else e(K,ne);ne=ne.sibling}ne=Xv(ie,K.mode,fe),ne.return=K,K=ne}return A(K);case _c:return Me=ie._init,ae(K,ne,Me(ie._payload),fe)}if(rp(ie))return W(K,ne,ie,fe);if(Td(ie))return q(K,ne,ie,fe);Dm(K,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"?(ie=""+ie,ne!==null&&ne.tag===6?(n(K,ne.sibling),ne=i(ne,ie),ne.return=K,K=ne):(n(K,ne),ne=Yv(ie,K.mode,fe),ne.return=K,K=ne),A(K)):n(K,ne)}return ae}var P0=q8(!0),Z8=q8(!1),Lg={},IA=Xc(Lg),Wp=Xc(Lg),Qp=Xc(Lg);function wh(t){if(t===Lg)throw Error(Rt(174));return t}function _E(t,e){switch(qr(Qp,e),qr(Wp,t),qr(IA,Lg),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Pw(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Pw(e,t)}ni(IA),qr(IA,e)}function I0(){ni(IA),ni(Wp),ni(Qp)}function Y8(t){wh(Qp.current);var e=wh(IA.current),n=Pw(e,t.type);e!==n&&(qr(Wp,t),qr(IA,n))}function vE(t){Wp.current===t&&(ni(IA),ni(Wp))}var ci=Xc(0);function Sy(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var $v=[];function xE(){for(var t=0;t<$v.length;t++)$v[t]._workInProgressVersionPrimary=null;$v.length=0}var L1=Hu.ReactCurrentDispatcher,Hv=Hu.ReactCurrentBatchConfig,kh=0,fi=null,Qi=null,us=null,My=!1,wp=!1,qp=0,rU=0;function Gs(){throw Error(Rt(321))}function wE(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ql(t[n],e[n]))return!1;return!0}function bE(t,e,n,r,i,s){if(kh=s,fi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,L1.current=t===null||t.memoizedState===null?aU:lU,t=n(r,i),wp){s=0;do{if(wp=!1,qp=0,25<=s)throw Error(Rt(301));s+=1,us=Qi=null,e.updateQueue=null,L1.current=AU,t=n(r,i)}while(wp)}if(L1.current=Cy,e=Qi!==null&&Qi.next!==null,kh=0,us=Qi=fi=null,My=!1,e)throw Error(Rt(300));return t}function EE(){var t=qp!==0;return qp=0,t}function wA(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return us===null?fi.memoizedState=us=t:us=us.next=t,us}function ll(){if(Qi===null){var t=fi.alternate;t=t!==null?t.memoizedState:null}else t=Qi.next;var e=us===null?fi.memoizedState:us.next;if(e!==null)us=e,Qi=t;else{if(t===null)throw Error(Rt(310));Qi=t,t={memoizedState:Qi.memoizedState,baseState:Qi.baseState,baseQueue:Qi.baseQueue,queue:Qi.queue,next:null},us===null?fi.memoizedState=us=t:us=us.next=t}return us}function Zp(t,e){return typeof e=="function"?e(t):e}function Wv(t){var e=ll(),n=e.queue;if(n===null)throw Error(Rt(311));n.lastRenderedReducer=t;var r=Qi,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var A=i.next;i.next=s.next,s.next=A}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=A=null,y=null,w=s;do{var P=w.lane;if((kh&P)===P)y!==null&&(y=y.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),r=w.hasEagerState?w.eagerState:t(r,w.action);else{var I={lane:P,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};y===null?(a=y=I,A=r):y=y.next=I,fi.lanes|=P,Lh|=P}w=w.next}while(w!==null&&w!==s);y===null?A=r:y.next=a,ql(r,e.memoizedState)||(Wo=!0),e.memoizedState=r,e.baseState=A,e.baseQueue=y,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,fi.lanes|=s,Lh|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Qv(t){var e=ll(),n=e.queue;if(n===null)throw Error(Rt(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var A=i=i.next;do s=t(s,A.action),A=A.next;while(A!==i);ql(s,e.memoizedState)||(Wo=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function X8(){}function K8(t,e){var n=fi,r=ll(),i=e(),s=!ql(r.memoizedState,i);if(s&&(r.memoizedState=i,Wo=!0),r=r.queue,TE(tL.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||us!==null&&us.memoizedState.tag&1){if(n.flags|=2048,Yp(9,eL.bind(null,n,r,i,e),void 0,null),cs===null)throw Error(Rt(349));kh&30||J8(n,e,i)}return i}function J8(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=fi.updateQueue,e===null?(e={lastEffect:null,stores:null},fi.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function eL(t,e,n,r){e.value=n,e.getSnapshot=r,nL(e)&&rL(t)}function tL(t,e,n){return n(function(){nL(e)&&rL(t)})}function nL(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ql(t,n)}catch{return!0}}function rL(t){var e=Du(t,1);e!==null&&Wl(e,t,1,-1)}function BM(t){var e=wA();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zp,lastRenderedState:t},e.queue=t,t=t.dispatch=oU.bind(null,fi,t),[e.memoizedState,t]}function Yp(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=fi.updateQueue,e===null?(e={lastEffect:null,stores:null},fi.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function iL(){return ll().memoizedState}function D1(t,e,n,r){var i=wA();fi.flags|=t,i.memoizedState=Yp(1|e,n,void 0,r===void 0?null:r)}function Y_(t,e,n,r){var i=ll();r=r===void 0?null:r;var s=void 0;if(Qi!==null){var A=Qi.memoizedState;if(s=A.destroy,r!==null&&wE(r,A.deps)){i.memoizedState=Yp(e,n,s,r);return}}fi.flags|=t,i.memoizedState=Yp(1|e,n,s,r)}function zM(t,e){return D1(8390656,8,t,e)}function TE(t,e){return Y_(2048,8,t,e)}function sL(t,e){return Y_(4,2,t,e)}function oL(t,e){return Y_(4,4,t,e)}function aL(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function lL(t,e,n){return n=n!=null?n.concat([t]):null,Y_(4,4,aL.bind(null,e,t),n)}function SE(){}function AL(t,e){var n=ll();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&wE(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function uL(t,e){var n=ll();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&wE(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function cL(t,e,n){return kh&21?(ql(n,e)||(n=d8(),fi.lanes|=n,Lh|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Wo=!0),t.memoizedState=n)}function iU(t,e){var n=Ir;Ir=n!==0&&4>n?n:4,t(!0);var r=Hv.transition;Hv.transition={};try{t(!1),e()}finally{Ir=n,Hv.transition=r}}function hL(){return ll().memoizedState}function sU(t,e,n){var r=Fc(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},fL(t))dL(e,n);else if(n=$8(t,e,n,r),n!==null){var i=So();Wl(n,t,r,i),pL(n,e,r)}}function oU(t,e,n){var r=Fc(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(fL(t))dL(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var A=e.lastRenderedState,a=s(A,n);if(i.hasEagerState=!0,i.eagerState=a,ql(a,A)){var y=e.interleaved;y===null?(i.next=i,mE(e)):(i.next=y.next,y.next=i),e.interleaved=i;return}}catch{}finally{}n=$8(t,e,i,r),n!==null&&(i=So(),Wl(n,t,r,i),pL(n,e,r))}}function fL(t){var e=t.alternate;return t===fi||e!==null&&e===fi}function dL(t,e){wp=My=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function pL(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rE(t,n)}}var Cy={readContext:al,useCallback:Gs,useContext:Gs,useEffect:Gs,useImperativeHandle:Gs,useInsertionEffect:Gs,useLayoutEffect:Gs,useMemo:Gs,useReducer:Gs,useRef:Gs,useState:Gs,useDebugValue:Gs,useDeferredValue:Gs,useTransition:Gs,useMutableSource:Gs,useSyncExternalStore:Gs,useId:Gs,unstable_isNewReconciler:!1},aU={readContext:al,useCallback:function(t,e){return wA().memoizedState=[t,e===void 0?null:e],t},useContext:al,useEffect:zM,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,D1(4194308,4,aL.bind(null,e,t),n)},useLayoutEffect:function(t,e){return D1(4194308,4,t,e)},useInsertionEffect:function(t,e){return D1(4,2,t,e)},useMemo:function(t,e){var n=wA();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=wA();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=sU.bind(null,fi,t),[r.memoizedState,t]},useRef:function(t){var e=wA();return t={current:t},e.memoizedState=t},useState:BM,useDebugValue:SE,useDeferredValue:function(t){return wA().memoizedState=t},useTransition:function(){var t=BM(!1),e=t[0];return t=iU.bind(null,t[1]),wA().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=fi,i=wA();if(li){if(n===void 0)throw Error(Rt(407));n=n()}else{if(n=e(),cs===null)throw Error(Rt(349));kh&30||J8(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,zM(tL.bind(null,r,s,t),[t]),r.flags|=2048,Yp(9,eL.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=wA(),e=cs.identifierPrefix;if(li){var n=xu,r=vu;n=(r&~(1<<32-Hl(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=qp++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=rU++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},lU={readContext:al,useCallback:AL,useContext:al,useEffect:TE,useImperativeHandle:lL,useInsertionEffect:sL,useLayoutEffect:oL,useMemo:uL,useReducer:Wv,useRef:iL,useState:function(){return Wv(Zp)},useDebugValue:SE,useDeferredValue:function(t){var e=ll();return cL(e,Qi.memoizedState,t)},useTransition:function(){var t=Wv(Zp)[0],e=ll().memoizedState;return[t,e]},useMutableSource:X8,useSyncExternalStore:K8,useId:hL,unstable_isNewReconciler:!1},AU={readContext:al,useCallback:AL,useContext:al,useEffect:TE,useImperativeHandle:lL,useInsertionEffect:sL,useLayoutEffect:oL,useMemo:uL,useReducer:Qv,useRef:iL,useState:function(){return Qv(Zp)},useDebugValue:SE,useDeferredValue:function(t){var e=ll();return Qi===null?e.memoizedState=t:cL(e,Qi.memoizedState,t)},useTransition:function(){var t=Qv(Zp)[0],e=ll().memoizedState;return[t,e]},useMutableSource:X8,useSyncExternalStore:K8,useId:hL,unstable_isNewReconciler:!1};function k0(t,e){try{var n="",r=e;do n+=ON(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function qv(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Kw(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var uU=typeof WeakMap=="function"?WeakMap:Map;function gL(t,e,n){n=Mu(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Iy||(Iy=!0,lb=r),Kw(t,e)},n}function mL(t,e,n){n=Mu(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Kw(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Kw(t,e),typeof r!="function"&&(Oc===null?Oc=new Set([this]):Oc.add(this));var A=e.stack;this.componentDidCatch(e.value,{componentStack:A!==null?A:""})}),n}function OM(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new uU;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=EU.bind(null,t,e,n),e.then(t,t))}function FM(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function NM(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Mu(-1,1),e.tag=2,zc(n,e,1))),n.lanes|=1),t)}var cU=Hu.ReactCurrentOwner,Wo=!1;function xo(t,e,n,r){e.child=t===null?Z8(e,null,n,r):P0(e,t.child,n,r)}function UM(t,e,n,r,i){n=n.render;var s=e.ref;return f0(e,i),r=bE(t,e,n,r,s,i),n=EE(),t!==null&&!Wo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ru(t,e,i)):(li&&n&&cE(e),e.flags|=1,xo(t,e,r,i),e.child)}function VM(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!RE(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,yL(t,e,s,r,i)):(t=O1(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var A=s.memoizedProps;if(n=n.compare,n=n!==null?n:Gp,n(A,r)&&t.ref===e.ref)return Ru(t,e,i)}return e.flags|=1,t=Nc(s,r),t.ref=e.ref,t.return=e,e.child=t}function yL(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Gp(s,r)&&t.ref===e.ref)if(Wo=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Wo=!0);else return e.lanes=t.lanes,Ru(t,e,i)}return Jw(t,e,n,r,i)}function _L(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},qr(Wf,va),va|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,qr(Wf,va),va|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,qr(Wf,va),va|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,qr(Wf,va),va|=r;return xo(t,e,i,n),e.child}function vL(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Jw(t,e,n,r,i){var s=qo(n)?Ph:io.current;return s=M0(e,s),f0(e,i),n=bE(t,e,n,r,s,i),r=EE(),t!==null&&!Wo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ru(t,e,i)):(li&&r&&cE(e),e.flags|=1,xo(t,e,n,i),e.child)}function GM(t,e,n,r,i){if(qo(n)){var s=!0;vy(e)}else s=!1;if(f0(e,i),e.stateNode===null)R1(t,e),Q8(e,n,r),Xw(e,n,r,i),r=!0;else if(t===null){var A=e.stateNode,a=e.memoizedProps;A.props=a;var y=A.context,w=n.contextType;typeof w=="object"&&w!==null?w=al(w):(w=qo(n)?Ph:io.current,w=M0(e,w));var P=n.getDerivedStateFromProps,I=typeof P=="function"||typeof A.getSnapshotBeforeUpdate=="function";I||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(a!==r||y!==w)&&DM(e,A,r,w),vc=!1;var L=e.memoizedState;A.state=L,Ty(e,r,A,i),y=e.memoizedState,a!==r||L!==y||Qo.current||vc?(typeof P=="function"&&(Yw(e,n,P,r),y=e.memoizedState),(a=vc||LM(e,n,a,r,L,y,w))?(I||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(e.flags|=4194308)):(typeof A.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=y),A.props=r,A.state=y,A.context=w,r=a):(typeof A.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{A=e.stateNode,H8(t,e),a=e.memoizedProps,w=e.type===e.elementType?a:Dl(e.type,a),A.props=w,I=e.pendingProps,L=A.context,y=n.contextType,typeof y=="object"&&y!==null?y=al(y):(y=qo(n)?Ph:io.current,y=M0(e,y));var U=n.getDerivedStateFromProps;(P=typeof U=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(a!==I||L!==y)&&DM(e,A,r,y),vc=!1,L=e.memoizedState,A.state=L,Ty(e,r,A,i);var W=e.memoizedState;a!==I||L!==W||Qo.current||vc?(typeof U=="function"&&(Yw(e,n,U,r),W=e.memoizedState),(w=vc||LM(e,n,w,r,L,W,y)||!1)?(P||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(r,W,y),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(r,W,y)),typeof A.componentDidUpdate=="function"&&(e.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof A.componentDidUpdate!="function"||a===t.memoizedProps&&L===t.memoizedState||(e.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&L===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=W),A.props=r,A.state=W,A.context=y,r=w):(typeof A.componentDidUpdate!="function"||a===t.memoizedProps&&L===t.memoizedState||(e.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&L===t.memoizedState||(e.flags|=1024),r=!1)}return eb(t,e,n,r,s,i)}function eb(t,e,n,r,i,s){vL(t,e);var A=(e.flags&128)!==0;if(!r&&!A)return i&&MM(e,n,!1),Ru(t,e,s);r=e.stateNode,cU.current=e;var a=A&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&A?(e.child=P0(e,t.child,null,s),e.child=P0(e,null,a,s)):xo(t,e,a,s),e.memoizedState=r.state,i&&MM(e,n,!0),e.child}function xL(t){var e=t.stateNode;e.pendingContext?SM(t,e.pendingContext,e.pendingContext!==e.context):e.context&&SM(t,e.context,!1),_E(t,e.containerInfo)}function jM(t,e,n,r,i){return C0(),fE(i),e.flags|=256,xo(t,e,n,r),e.child}var tb={dehydrated:null,treeContext:null,retryLane:0};function nb(t){return{baseLanes:t,cachePool:null,transitions:null}}function wL(t,e,n){var r=e.pendingProps,i=ci.current,s=!1,A=(e.flags&128)!==0,a;if((a=A)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),qr(ci,i&1),t===null)return qw(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(A=r.children,t=r.fallback,s?(r=e.mode,s=e.child,A={mode:"hidden",children:A},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=A):s=J_(A,r,0,null),t=Sh(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=nb(n),e.memoizedState=tb,t):ME(e,A));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return hU(t,e,A,r,a,i,n);if(s){s=r.fallback,A=e.mode,i=t.child,a=i.sibling;var y={mode:"hidden",children:r.children};return!(A&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=y,e.deletions=null):(r=Nc(i,y),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Nc(a,s):(s=Sh(s,A,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,A=t.child.memoizedState,A=A===null?nb(n):{baseLanes:A.baseLanes|n,cachePool:null,transitions:A.transitions},s.memoizedState=A,s.childLanes=t.childLanes&~n,e.memoizedState=tb,r}return s=t.child,t=s.sibling,r=Nc(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ME(t,e){return e=J_({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Rm(t,e,n,r){return r!==null&&fE(r),P0(e,t.child,null,n),t=ME(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function hU(t,e,n,r,i,s,A){if(n)return e.flags&256?(e.flags&=-257,r=qv(Error(Rt(422))),Rm(t,e,A,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=J_({mode:"visible",children:r.children},i,0,null),s=Sh(s,i,A,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&P0(e,t.child,null,A),e.child.memoizedState=nb(A),e.memoizedState=tb,s);if(!(e.mode&1))return Rm(t,e,A,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Rt(419)),r=qv(s,r,void 0),Rm(t,e,A,r)}if(a=(A&t.childLanes)!==0,Wo||a){if(r=cs,r!==null){switch(A&-A){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|A)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Du(t,i),Wl(r,t,i,-1))}return DE(),r=qv(Error(Rt(421))),Rm(t,e,A,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=TU.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,ba=Bc(i.nextSibling),Ta=e,li=!0,Bl=null,t!==null&&(el[tl++]=vu,el[tl++]=xu,el[tl++]=Ih,vu=t.id,xu=t.overflow,Ih=e),e=ME(e,r.children),e.flags|=4096,e)}function $M(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Zw(t.return,e,n)}function Zv(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function bL(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(xo(t,e,r.children,n),r=ci.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&$M(t,n,e);else if(t.tag===19)$M(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(qr(ci,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Sy(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Zv(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Sy(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Zv(e,!0,n,null,s);break;case"together":Zv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function R1(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ru(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Lh|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Rt(153));if(e.child!==null){for(t=e.child,n=Nc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Nc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function fU(t,e,n){switch(e.tag){case 3:xL(e),C0();break;case 5:Y8(e);break;case 1:qo(e.type)&&vy(e);break;case 4:_E(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;qr(by,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(qr(ci,ci.current&1),e.flags|=128,null):n&e.child.childLanes?wL(t,e,n):(qr(ci,ci.current&1),t=Ru(t,e,n),t!==null?t.sibling:null);qr(ci,ci.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return bL(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),qr(ci,ci.current),r)break;return null;case 22:case 23:return e.lanes=0,_L(t,e,n)}return Ru(t,e,n)}var EL,rb,TL,SL;EL=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};rb=function(){};TL=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,wh(IA.current);var s=null;switch(n){case"input":i=Tw(t,i),r=Tw(t,r),s=[];break;case"select":i=di({},i,{value:void 0}),r=di({},r,{value:void 0}),s=[];break;case"textarea":i=Cw(t,i),r=Cw(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=yy)}Iw(n,r);var A;n=null;for(w in i)if(!r.hasOwnProperty(w)&&i.hasOwnProperty(w)&&i[w]!=null)if(w==="style"){var a=i[w];for(A in a)a.hasOwnProperty(A)&&(n||(n={}),n[A]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(Bp.hasOwnProperty(w)?s||(s=[]):(s=s||[]).push(w,null));for(w in r){var y=r[w];if(a=i?.[w],r.hasOwnProperty(w)&&y!==a&&(y!=null||a!=null))if(w==="style")if(a){for(A in a)!a.hasOwnProperty(A)||y&&y.hasOwnProperty(A)||(n||(n={}),n[A]="");for(A in y)y.hasOwnProperty(A)&&a[A]!==y[A]&&(n||(n={}),n[A]=y[A])}else n||(s||(s=[]),s.push(w,n)),n=y;else w==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,a=a?a.__html:void 0,y!=null&&a!==y&&(s=s||[]).push(w,y)):w==="children"?typeof y!="string"&&typeof y!="number"||(s=s||[]).push(w,""+y):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(Bp.hasOwnProperty(w)?(y!=null&&w==="onScroll"&&ti("scroll",t),s||a===y||(s=[])):(s=s||[]).push(w,y))}n&&(s=s||[]).push("style",n);var w=s;(e.updateQueue=w)&&(e.flags|=4)}};SL=function(t,e,n,r){n!==r&&(e.flags|=4)};function kd(t,e){if(!li)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function js(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function dU(t,e,n){var r=e.pendingProps;switch(hE(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return js(e),null;case 1:return qo(e.type)&&_y(),js(e),null;case 3:return r=e.stateNode,I0(),ni(Qo),ni(io),xE(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Lm(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Bl!==null&&(cb(Bl),Bl=null))),rb(t,e),js(e),null;case 5:vE(e);var i=wh(Qp.current);if(n=e.type,t!==null&&e.stateNode!=null)TL(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Rt(166));return js(e),null}if(t=wh(IA.current),Lm(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[bA]=e,r[Hp]=s,t=(e.mode&1)!==0,n){case"dialog":ti("cancel",r),ti("close",r);break;case"iframe":case"object":case"embed":ti("load",r);break;case"video":case"audio":for(i=0;i<sp.length;i++)ti(sp[i],r);break;case"source":ti("error",r);break;case"img":case"image":case"link":ti("error",r),ti("load",r);break;case"details":ti("toggle",r);break;case"input":J4(r,s),ti("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ti("invalid",r);break;case"textarea":tM(r,s),ti("invalid",r)}Iw(n,s),i=null;for(var A in s)if(s.hasOwnProperty(A)){var a=s[A];A==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&km(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&km(r.textContent,a,t),i=["children",""+a]):Bp.hasOwnProperty(A)&&a!=null&&A==="onScroll"&&ti("scroll",r)}switch(n){case"input":bm(r),eM(r,s,!0);break;case"textarea":bm(r),nM(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=yy)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{A=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=J6(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=A.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=A.createElement(n,{is:r.is}):(t=A.createElement(n),n==="select"&&(A=t,r.multiple?A.multiple=!0:r.size&&(A.size=r.size))):t=A.createElementNS(t,n),t[bA]=e,t[Hp]=r,EL(t,e,!1,!1),e.stateNode=t;e:{switch(A=kw(n,r),n){case"dialog":ti("cancel",t),ti("close",t),i=r;break;case"iframe":case"object":case"embed":ti("load",t),i=r;break;case"video":case"audio":for(i=0;i<sp.length;i++)ti(sp[i],t);i=r;break;case"source":ti("error",t),i=r;break;case"img":case"image":case"link":ti("error",t),ti("load",t),i=r;break;case"details":ti("toggle",t),i=r;break;case"input":J4(t,r),i=Tw(t,r),ti("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=di({},r,{value:void 0}),ti("invalid",t);break;case"textarea":tM(t,r),i=Cw(t,r),ti("invalid",t);break;default:i=r}Iw(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var y=a[s];s==="style"?n8(t,y):s==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,y!=null&&e8(t,y)):s==="children"?typeof y=="string"?(n!=="textarea"||y!=="")&&zp(t,y):typeof y=="number"&&zp(t,""+y):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Bp.hasOwnProperty(s)?y!=null&&s==="onScroll"&&ti("scroll",t):y!=null&&X3(t,s,y,A))}switch(n){case"input":bm(t),eM(t,r,!1);break;case"textarea":bm(t),nM(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Hc(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?A0(t,!!r.multiple,s,!1):r.defaultValue!=null&&A0(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=yy)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return js(e),null;case 6:if(t&&e.stateNode!=null)SL(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Rt(166));if(n=wh(Qp.current),wh(IA.current),Lm(e)){if(r=e.stateNode,n=e.memoizedProps,r[bA]=e,(s=r.nodeValue!==n)&&(t=Ta,t!==null))switch(t.tag){case 3:km(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&km(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[bA]=e,e.stateNode=r}return js(e),null;case 13:if(ni(ci),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(li&&ba!==null&&e.mode&1&&!(e.flags&128))j8(),C0(),e.flags|=98560,s=!1;else if(s=Lm(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Rt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Rt(317));s[bA]=e}else C0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;js(e),s=!1}else Bl!==null&&(cb(Bl),Bl=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ci.current&1?qi===0&&(qi=3):DE())),e.updateQueue!==null&&(e.flags|=4),js(e),null);case 4:return I0(),rb(t,e),t===null&&jp(e.stateNode.containerInfo),js(e),null;case 10:return gE(e.type._context),js(e),null;case 17:return qo(e.type)&&_y(),js(e),null;case 19:if(ni(ci),s=e.memoizedState,s===null)return js(e),null;if(r=(e.flags&128)!==0,A=s.rendering,A===null)if(r)kd(s,!1);else{if(qi!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(A=Sy(t),A!==null){for(e.flags|=128,kd(s,!1),r=A.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,A=s.alternate,A===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=A.childLanes,s.lanes=A.lanes,s.child=A.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=A.memoizedProps,s.memoizedState=A.memoizedState,s.updateQueue=A.updateQueue,s.type=A.type,t=A.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return qr(ci,ci.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ii()>L0&&(e.flags|=128,r=!0,kd(s,!1),e.lanes=4194304)}else{if(!r)if(t=Sy(A),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),kd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!A.alternate&&!li)return js(e),null}else 2*Ii()-s.renderingStartTime>L0&&n!==1073741824&&(e.flags|=128,r=!0,kd(s,!1),e.lanes=4194304);s.isBackwards?(A.sibling=e.child,e.child=A):(n=s.last,n!==null?n.sibling=A:e.child=A,s.last=A)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ii(),e.sibling=null,n=ci.current,qr(ci,r?n&1|2:n&1),e):(js(e),null);case 22:case 23:return LE(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?va&1073741824&&(js(e),e.subtreeFlags&6&&(e.flags|=8192)):js(e),null;case 24:return null;case 25:return null}throw Error(Rt(156,e.tag))}function pU(t,e){switch(hE(e),e.tag){case 1:return qo(e.type)&&_y(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return I0(),ni(Qo),ni(io),xE(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return vE(e),null;case 13:if(ni(ci),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Rt(340));C0()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ni(ci),null;case 4:return I0(),null;case 10:return gE(e.type._context),null;case 22:case 23:return LE(),null;case 24:return null;default:return null}}var Bm=!1,eo=!1,gU=typeof WeakSet=="function"?WeakSet:Set,un=null;function Hf(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){xi(t,e,r)}else n.current=null}function ib(t,e,n){try{n()}catch(r){xi(t,e,r)}}var HM=!1;function mU(t,e){if(Vw=py,t=I8(),uE(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var A=0,a=-1,y=-1,w=0,P=0,I=t,L=null;t:for(;;){for(var U;I!==n||i!==0&&I.nodeType!==3||(a=A+i),I!==s||r!==0&&I.nodeType!==3||(y=A+r),I.nodeType===3&&(A+=I.nodeValue.length),(U=I.firstChild)!==null;)L=I,I=U;for(;;){if(I===t)break t;if(L===n&&++w===i&&(a=A),L===s&&++P===r&&(y=A),(U=I.nextSibling)!==null)break;I=L,L=I.parentNode}I=U}n=a===-1||y===-1?null:{start:a,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(Gw={focusedElem:t,selectionRange:n},py=!1,un=e;un!==null;)if(e=un,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,un=t;else for(;un!==null;){e=un;try{var W=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(W!==null){var q=W.memoizedProps,ae=W.memoizedState,K=e.stateNode,ne=K.getSnapshotBeforeUpdate(e.elementType===e.type?q:Dl(e.type,q),ae);K.__reactInternalSnapshotBeforeUpdate=ne}break;case 3:var ie=e.stateNode.containerInfo;ie.nodeType===1?ie.textContent="":ie.nodeType===9&&ie.documentElement&&ie.removeChild(ie.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Rt(163))}}catch(fe){xi(e,e.return,fe)}if(t=e.sibling,t!==null){t.return=e.return,un=t;break}un=e.return}return W=HM,HM=!1,W}function bp(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&ib(e,n,s)}i=i.next}while(i!==r)}}function X_(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function sb(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ML(t){var e=t.alternate;e!==null&&(t.alternate=null,ML(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[bA],delete e[Hp],delete e[Hw],delete e[J9],delete e[eU])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function CL(t){return t.tag===5||t.tag===3||t.tag===4}function WM(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||CL(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ob(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=yy));else if(r!==4&&(t=t.child,t!==null))for(ob(t,e,n),t=t.sibling;t!==null;)ob(t,e,n),t=t.sibling}function ab(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ab(t,e,n),t=t.sibling;t!==null;)ab(t,e,n),t=t.sibling}var ws=null,Rl=!1;function cc(t,e,n){for(n=n.child;n!==null;)PL(t,e,n),n=n.sibling}function PL(t,e,n){if(PA&&typeof PA.onCommitFiberUnmount=="function")try{PA.onCommitFiberUnmount(j_,n)}catch{}switch(n.tag){case 5:eo||Hf(n,e);case 6:var r=ws,i=Rl;ws=null,cc(t,e,n),ws=r,Rl=i,ws!==null&&(Rl?(t=ws,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ws.removeChild(n.stateNode));break;case 18:ws!==null&&(Rl?(t=ws,n=n.stateNode,t.nodeType===8?Gv(t.parentNode,n):t.nodeType===1&&Gv(t,n),Up(t)):Gv(ws,n.stateNode));break;case 4:r=ws,i=Rl,ws=n.stateNode.containerInfo,Rl=!0,cc(t,e,n),ws=r,Rl=i;break;case 0:case 11:case 14:case 15:if(!eo&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,A=s.destroy;s=s.tag,A!==void 0&&(s&2||s&4)&&ib(n,e,A),i=i.next}while(i!==r)}cc(t,e,n);break;case 1:if(!eo&&(Hf(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){xi(n,e,a)}cc(t,e,n);break;case 21:cc(t,e,n);break;case 22:n.mode&1?(eo=(r=eo)||n.memoizedState!==null,cc(t,e,n),eo=r):cc(t,e,n);break;default:cc(t,e,n)}}function QM(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new gU),e.forEach(function(r){var i=SU.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ll(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,A=e,a=A;e:for(;a!==null;){switch(a.tag){case 5:ws=a.stateNode,Rl=!1;break e;case 3:ws=a.stateNode.containerInfo,Rl=!0;break e;case 4:ws=a.stateNode.containerInfo,Rl=!0;break e}a=a.return}if(ws===null)throw Error(Rt(160));PL(s,A,i),ws=null,Rl=!1;var y=i.alternate;y!==null&&(y.return=null),i.return=null}catch(w){xi(i,e,w)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)IL(e,t),e=e.sibling}function IL(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ll(e,t),pA(t),r&4){try{bp(3,t,t.return),X_(3,t)}catch(q){xi(t,t.return,q)}try{bp(5,t,t.return)}catch(q){xi(t,t.return,q)}}break;case 1:Ll(e,t),pA(t),r&512&&n!==null&&Hf(n,n.return);break;case 5:if(Ll(e,t),pA(t),r&512&&n!==null&&Hf(n,n.return),t.flags&32){var i=t.stateNode;try{zp(i,"")}catch(q){xi(t,t.return,q)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,A=n!==null?n.memoizedProps:s,a=t.type,y=t.updateQueue;if(t.updateQueue=null,y!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&X6(i,s),kw(a,A);var w=kw(a,s);for(A=0;A<y.length;A+=2){var P=y[A],I=y[A+1];P==="style"?n8(i,I):P==="dangerouslySetInnerHTML"?e8(i,I):P==="children"?zp(i,I):X3(i,P,I,w)}switch(a){case"input":Sw(i,s);break;case"textarea":K6(i,s);break;case"select":var L=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var U=s.value;U!=null?A0(i,!!s.multiple,U,!1):L!==!!s.multiple&&(s.defaultValue!=null?A0(i,!!s.multiple,s.defaultValue,!0):A0(i,!!s.multiple,s.multiple?[]:"",!1))}i[Hp]=s}catch(q){xi(t,t.return,q)}}break;case 6:if(Ll(e,t),pA(t),r&4){if(t.stateNode===null)throw Error(Rt(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(q){xi(t,t.return,q)}}break;case 3:if(Ll(e,t),pA(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Up(e.containerInfo)}catch(q){xi(t,t.return,q)}break;case 4:Ll(e,t),pA(t);break;case 13:Ll(e,t),pA(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(IE=Ii())),r&4&&QM(t);break;case 22:if(P=n!==null&&n.memoizedState!==null,t.mode&1?(eo=(w=eo)||P,Ll(e,t),eo=w):Ll(e,t),pA(t),r&8192){if(w=t.memoizedState!==null,(t.stateNode.isHidden=w)&&!P&&t.mode&1)for(un=t,P=t.child;P!==null;){for(I=un=P;un!==null;){switch(L=un,U=L.child,L.tag){case 0:case 11:case 14:case 15:bp(4,L,L.return);break;case 1:Hf(L,L.return);var W=L.stateNode;if(typeof W.componentWillUnmount=="function"){r=L,n=L.return;try{e=r,W.props=e.memoizedProps,W.state=e.memoizedState,W.componentWillUnmount()}catch(q){xi(r,n,q)}}break;case 5:Hf(L,L.return);break;case 22:if(L.memoizedState!==null){ZM(I);continue}}U!==null?(U.return=L,un=U):ZM(I)}P=P.sibling}e:for(P=null,I=t;;){if(I.tag===5){if(P===null){P=I;try{i=I.stateNode,w?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=I.stateNode,y=I.memoizedProps.style,A=y!=null&&y.hasOwnProperty("display")?y.display:null,a.style.display=t8("display",A))}catch(q){xi(t,t.return,q)}}}else if(I.tag===6){if(P===null)try{I.stateNode.nodeValue=w?"":I.memoizedProps}catch(q){xi(t,t.return,q)}}else if((I.tag!==22&&I.tag!==23||I.memoizedState===null||I===t)&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===t)break e;for(;I.sibling===null;){if(I.return===null||I.return===t)break e;P===I&&(P=null),I=I.return}P===I&&(P=null),I.sibling.return=I.return,I=I.sibling}}break;case 19:Ll(e,t),pA(t),r&4&&QM(t);break;case 21:break;default:Ll(e,t),pA(t)}}function pA(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(CL(n)){var r=n;break e}n=n.return}throw Error(Rt(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(zp(i,""),r.flags&=-33);var s=WM(t);ab(t,s,i);break;case 3:case 4:var A=r.stateNode.containerInfo,a=WM(t);ob(t,a,A);break;default:throw Error(Rt(161))}}catch(y){xi(t,t.return,y)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function yU(t,e,n){un=t,kL(t)}function kL(t,e,n){for(var r=(t.mode&1)!==0;un!==null;){var i=un,s=i.child;if(i.tag===22&&r){var A=i.memoizedState!==null||Bm;if(!A){var a=i.alternate,y=a!==null&&a.memoizedState!==null||eo;a=Bm;var w=eo;if(Bm=A,(eo=y)&&!w)for(un=i;un!==null;)A=un,y=A.child,A.tag===22&&A.memoizedState!==null?YM(i):y!==null?(y.return=A,un=y):YM(i);for(;s!==null;)un=s,kL(s),s=s.sibling;un=i,Bm=a,eo=w}qM(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,un=s):qM(t)}}function qM(t){for(;un!==null;){var e=un;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:eo||X_(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!eo)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Dl(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&kM(e,s,r);break;case 3:var A=e.updateQueue;if(A!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}kM(e,A,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var y=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":y.autoFocus&&n.focus();break;case"img":y.src&&(n.src=y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var w=e.alternate;if(w!==null){var P=w.memoizedState;if(P!==null){var I=P.dehydrated;I!==null&&Up(I)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Rt(163))}eo||e.flags&512&&sb(e)}catch(L){xi(e,e.return,L)}}if(e===t){un=null;break}if(n=e.sibling,n!==null){n.return=e.return,un=n;break}un=e.return}}function ZM(t){for(;un!==null;){var e=un;if(e===t){un=null;break}var n=e.sibling;if(n!==null){n.return=e.return,un=n;break}un=e.return}}function YM(t){for(;un!==null;){var e=un;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{X_(4,e)}catch(y){xi(e,n,y)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(y){xi(e,i,y)}}var s=e.return;try{sb(e)}catch(y){xi(e,s,y)}break;case 5:var A=e.return;try{sb(e)}catch(y){xi(e,A,y)}}}catch(y){xi(e,e.return,y)}if(e===t){un=null;break}var a=e.sibling;if(a!==null){a.return=e.return,un=a;break}un=e.return}}var _U=Math.ceil,Py=Hu.ReactCurrentDispatcher,CE=Hu.ReactCurrentOwner,sl=Hu.ReactCurrentBatchConfig,vr=0,cs=null,Vi=null,Es=0,va=0,Wf=Xc(0),qi=0,Xp=null,Lh=0,K_=0,PE=0,Ep=null,Ho=null,IE=0,L0=1/0,gu=null,Iy=!1,lb=null,Oc=null,zm=!1,Sc=null,ky=0,Tp=0,Ab=null,B1=-1,z1=0;function So(){return vr&6?Ii():B1!==-1?B1:B1=Ii()}function Fc(t){return t.mode&1?vr&2&&Es!==0?Es&-Es:nU.transition!==null?(z1===0&&(z1=d8()),z1):(t=Ir,t!==0||(t=window.event,t=t===void 0?16:x8(t.type)),t):1}function Wl(t,e,n,r){if(50<Tp)throw Tp=0,Ab=null,Error(Rt(185));Pg(t,n,r),(!(vr&2)||t!==cs)&&(t===cs&&(!(vr&2)&&(K_|=n),qi===4&&bc(t,Es)),Zo(t,r),n===1&&vr===0&&!(e.mode&1)&&(L0=Ii()+500,q_&&Kc()))}function Zo(t,e){var n=t.callbackNode;n9(t,e);var r=dy(t,t===cs?Es:0);if(r===0)n!==null&&sM(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&sM(n),e===1)t.tag===0?tU(XM.bind(null,t)):U8(XM.bind(null,t)),X9(function(){!(vr&6)&&Kc()}),n=null;else{switch(p8(r)){case 1:n=nE;break;case 4:n=h8;break;case 16:n=fy;break;case 536870912:n=f8;break;default:n=fy}n=NL(n,LL.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function LL(t,e){if(B1=-1,z1=0,vr&6)throw Error(Rt(327));var n=t.callbackNode;if(d0()&&t.callbackNode!==n)return null;var r=dy(t,t===cs?Es:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ly(t,r);else{e=r;var i=vr;vr|=2;var s=RL();(cs!==t||Es!==e)&&(gu=null,L0=Ii()+500,Th(t,e));do try{wU();break}catch(a){DL(t,a)}while(1);pE(),Py.current=s,vr=i,Vi!==null?e=0:(cs=null,Es=0,e=qi)}if(e!==0){if(e===2&&(i=zw(t),i!==0&&(r=i,e=ub(t,i))),e===1)throw n=Xp,Th(t,0),bc(t,r),Zo(t,Ii()),n;if(e===6)bc(t,r);else{if(i=t.current.alternate,!(r&30)&&!vU(i)&&(e=Ly(t,r),e===2&&(s=zw(t),s!==0&&(r=s,e=ub(t,s))),e===1))throw n=Xp,Th(t,0),bc(t,r),Zo(t,Ii()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Rt(345));case 2:gh(t,Ho,gu);break;case 3:if(bc(t,r),(r&130023424)===r&&(e=IE+500-Ii(),10<e)){if(dy(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){So(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=$w(gh.bind(null,t,Ho,gu),e);break}gh(t,Ho,gu);break;case 4:if(bc(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var A=31-Hl(r);s=1<<A,A=e[A],A>i&&(i=A),r&=~s}if(r=i,r=Ii()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_U(r/1960))-r,10<r){t.timeoutHandle=$w(gh.bind(null,t,Ho,gu),r);break}gh(t,Ho,gu);break;case 5:gh(t,Ho,gu);break;default:throw Error(Rt(329))}}}return Zo(t,Ii()),t.callbackNode===n?LL.bind(null,t):null}function ub(t,e){var n=Ep;return t.current.memoizedState.isDehydrated&&(Th(t,e).flags|=256),t=Ly(t,e),t!==2&&(e=Ho,Ho=n,e!==null&&cb(e)),t}function cb(t){Ho===null?Ho=t:Ho.push.apply(Ho,t)}function vU(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ql(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function bc(t,e){for(e&=~PE,e&=~K_,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Hl(e),r=1<<n;t[n]=-1,e&=~r}}function XM(t){if(vr&6)throw Error(Rt(327));d0();var e=dy(t,0);if(!(e&1))return Zo(t,Ii()),null;var n=Ly(t,e);if(t.tag!==0&&n===2){var r=zw(t);r!==0&&(e=r,n=ub(t,r))}if(n===1)throw n=Xp,Th(t,0),bc(t,e),Zo(t,Ii()),n;if(n===6)throw Error(Rt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,gh(t,Ho,gu),Zo(t,Ii()),null}function kE(t,e){var n=vr;vr|=1;try{return t(e)}finally{vr=n,vr===0&&(L0=Ii()+500,q_&&Kc())}}function Dh(t){Sc!==null&&Sc.tag===0&&!(vr&6)&&d0();var e=vr;vr|=1;var n=sl.transition,r=Ir;try{if(sl.transition=null,Ir=1,t)return t()}finally{Ir=r,sl.transition=n,vr=e,!(vr&6)&&Kc()}}function LE(){va=Wf.current,ni(Wf)}function Th(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Y9(n)),Vi!==null)for(n=Vi.return;n!==null;){var r=n;switch(hE(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&_y();break;case 3:I0(),ni(Qo),ni(io),xE();break;case 5:vE(r);break;case 4:I0();break;case 13:ni(ci);break;case 19:ni(ci);break;case 10:gE(r.type._context);break;case 22:case 23:LE()}n=n.return}if(cs=t,Vi=t=Nc(t.current,null),Es=va=e,qi=0,Xp=null,PE=K_=Lh=0,Ho=Ep=null,xh!==null){for(e=0;e<xh.length;e++)if(n=xh[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var A=s.next;s.next=i,r.next=A}n.pending=r}xh=null}return t}function DL(t,e){do{var n=Vi;try{if(pE(),L1.current=Cy,My){for(var r=fi.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}My=!1}if(kh=0,us=Qi=fi=null,wp=!1,qp=0,CE.current=null,n===null||n.return===null){qi=1,Xp=e,Vi=null;break}e:{var s=t,A=n.return,a=n,y=e;if(e=Es,a.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){var w=y,P=a,I=P.tag;if(!(P.mode&1)&&(I===0||I===11||I===15)){var L=P.alternate;L?(P.updateQueue=L.updateQueue,P.memoizedState=L.memoizedState,P.lanes=L.lanes):(P.updateQueue=null,P.memoizedState=null)}var U=FM(A);if(U!==null){U.flags&=-257,NM(U,A,a,s,e),U.mode&1&&OM(s,w,e),e=U,y=w;var W=e.updateQueue;if(W===null){var q=new Set;q.add(y),e.updateQueue=q}else W.add(y);break e}else{if(!(e&1)){OM(s,w,e),DE();break e}y=Error(Rt(426))}}else if(li&&a.mode&1){var ae=FM(A);if(ae!==null){!(ae.flags&65536)&&(ae.flags|=256),NM(ae,A,a,s,e),fE(k0(y,a));break e}}s=y=k0(y,a),qi!==4&&(qi=2),Ep===null?Ep=[s]:Ep.push(s),s=A;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var K=gL(s,y,e);IM(s,K);break e;case 1:a=y;var ne=s.type,ie=s.stateNode;if(!(s.flags&128)&&(typeof ne.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(Oc===null||!Oc.has(ie)))){s.flags|=65536,e&=-e,s.lanes|=e;var fe=mL(s,a,e);IM(s,fe);break e}}s=s.return}while(s!==null)}zL(n)}catch(ye){e=ye,Vi===n&&n!==null&&(Vi=n=n.return);continue}break}while(1)}function RL(){var t=Py.current;return Py.current=Cy,t===null?Cy:t}function DE(){(qi===0||qi===3||qi===2)&&(qi=4),cs===null||!(Lh&268435455)&&!(K_&268435455)||bc(cs,Es)}function Ly(t,e){var n=vr;vr|=2;var r=RL();(cs!==t||Es!==e)&&(gu=null,Th(t,e));do try{xU();break}catch(i){DL(t,i)}while(1);if(pE(),vr=n,Py.current=r,Vi!==null)throw Error(Rt(261));return cs=null,Es=0,qi}function xU(){for(;Vi!==null;)BL(Vi)}function wU(){for(;Vi!==null&&!QN();)BL(Vi)}function BL(t){var e=FL(t.alternate,t,va);t.memoizedProps=t.pendingProps,e===null?zL(t):Vi=e,CE.current=null}function zL(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=pU(n,e),n!==null){n.flags&=32767,Vi=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qi=6,Vi=null;return}}else if(n=dU(n,e,va),n!==null){Vi=n;return}if(e=e.sibling,e!==null){Vi=e;return}Vi=e=t}while(e!==null);qi===0&&(qi=5)}function gh(t,e,n){var r=Ir,i=sl.transition;try{sl.transition=null,Ir=1,bU(t,e,n,r)}finally{sl.transition=i,Ir=r}return null}function bU(t,e,n,r){do d0();while(Sc!==null);if(vr&6)throw Error(Rt(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Rt(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(r9(t,s),t===cs&&(Vi=cs=null,Es=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||zm||(zm=!0,NL(fy,function(){return d0(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=sl.transition,sl.transition=null;var A=Ir;Ir=1;var a=vr;vr|=4,CE.current=null,mU(t,n),IL(n,t),j9(Gw),py=!!Vw,Gw=Vw=null,t.current=n,yU(n),qN(),vr=a,Ir=A,sl.transition=s}else t.current=n;if(zm&&(zm=!1,Sc=t,ky=i),s=t.pendingLanes,s===0&&(Oc=null),XN(n.stateNode),Zo(t,Ii()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Iy)throw Iy=!1,t=lb,lb=null,t;return ky&1&&t.tag!==0&&d0(),s=t.pendingLanes,s&1?t===Ab?Tp++:(Tp=0,Ab=t):Tp=0,Kc(),null}function d0(){if(Sc!==null){var t=p8(ky),e=sl.transition,n=Ir;try{if(sl.transition=null,Ir=16>t?16:t,Sc===null)var r=!1;else{if(t=Sc,Sc=null,ky=0,vr&6)throw Error(Rt(331));var i=vr;for(vr|=4,un=t.current;un!==null;){var s=un,A=s.child;if(un.flags&16){var a=s.deletions;if(a!==null){for(var y=0;y<a.length;y++){var w=a[y];for(un=w;un!==null;){var P=un;switch(P.tag){case 0:case 11:case 15:bp(8,P,s)}var I=P.child;if(I!==null)I.return=P,un=I;else for(;un!==null;){P=un;var L=P.sibling,U=P.return;if(ML(P),P===w){un=null;break}if(L!==null){L.return=U,un=L;break}un=U}}}var W=s.alternate;if(W!==null){var q=W.child;if(q!==null){W.child=null;do{var ae=q.sibling;q.sibling=null,q=ae}while(q!==null)}}un=s}}if(s.subtreeFlags&2064&&A!==null)A.return=s,un=A;else e:for(;un!==null;){if(s=un,s.flags&2048)switch(s.tag){case 0:case 11:case 15:bp(9,s,s.return)}var K=s.sibling;if(K!==null){K.return=s.return,un=K;break e}un=s.return}}var ne=t.current;for(un=ne;un!==null;){A=un;var ie=A.child;if(A.subtreeFlags&2064&&ie!==null)ie.return=A,un=ie;else e:for(A=ne;un!==null;){if(a=un,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:X_(9,a)}}catch(ye){xi(a,a.return,ye)}if(a===A){un=null;break e}var fe=a.sibling;if(fe!==null){fe.return=a.return,un=fe;break e}un=a.return}}if(vr=i,Kc(),PA&&typeof PA.onPostCommitFiberRoot=="function")try{PA.onPostCommitFiberRoot(j_,t)}catch{}r=!0}return r}finally{Ir=n,sl.transition=e}}return!1}function KM(t,e,n){e=k0(n,e),e=gL(t,e,1),t=zc(t,e,1),e=So(),t!==null&&(Pg(t,1,e),Zo(t,e))}function xi(t,e,n){if(t.tag===3)KM(t,t,n);else for(;e!==null;){if(e.tag===3){KM(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Oc===null||!Oc.has(r))){t=k0(n,t),t=mL(e,t,1),e=zc(e,t,1),t=So(),e!==null&&(Pg(e,1,t),Zo(e,t));break}}e=e.return}}function EU(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=So(),t.pingedLanes|=t.suspendedLanes&n,cs===t&&(Es&n)===n&&(qi===4||qi===3&&(Es&130023424)===Es&&500>Ii()-IE?Th(t,0):PE|=n),Zo(t,e)}function OL(t,e){e===0&&(t.mode&1?(e=Sm,Sm<<=1,!(Sm&130023424)&&(Sm=4194304)):e=1);var n=So();t=Du(t,e),t!==null&&(Pg(t,e,n),Zo(t,n))}function TU(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),OL(t,n)}function SU(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Rt(314))}r!==null&&r.delete(e),OL(t,n)}var FL;FL=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Qo.current)Wo=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Wo=!1,fU(t,e,n);Wo=!!(t.flags&131072)}else Wo=!1,li&&e.flags&1048576&&V8(e,wy,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;R1(t,e),t=e.pendingProps;var i=M0(e,io.current);f0(e,n),i=bE(null,e,r,t,i,n);var s=EE();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,qo(r)?(s=!0,vy(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,yE(e),i.updater=Z_,e.stateNode=i,i._reactInternals=e,Xw(e,r,t,n),e=eb(null,e,r,!0,s,n)):(e.tag=0,li&&s&&cE(e),xo(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(R1(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=CU(r),t=Dl(r,t),i){case 0:e=Jw(null,e,r,t,n);break e;case 1:e=GM(null,e,r,t,n);break e;case 11:e=UM(null,e,r,t,n);break e;case 14:e=VM(null,e,r,Dl(r.type,t),n);break e}throw Error(Rt(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Dl(r,i),Jw(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Dl(r,i),GM(t,e,r,i,n);case 3:e:{if(xL(e),t===null)throw Error(Rt(387));r=e.pendingProps,s=e.memoizedState,i=s.element,H8(t,e),Ty(e,r,null,n);var A=e.memoizedState;if(r=A.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=k0(Error(Rt(423)),e),e=jM(t,e,r,n,i);break e}else if(r!==i){i=k0(Error(Rt(424)),e),e=jM(t,e,r,n,i);break e}else for(ba=Bc(e.stateNode.containerInfo.firstChild),Ta=e,li=!0,Bl=null,n=Z8(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(C0(),r===i){e=Ru(t,e,n);break e}xo(t,e,r,n)}e=e.child}return e;case 5:return Y8(e),t===null&&qw(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,A=i.children,jw(r,i)?A=null:s!==null&&jw(r,s)&&(e.flags|=32),vL(t,e),xo(t,e,A,n),e.child;case 6:return t===null&&qw(e),null;case 13:return wL(t,e,n);case 4:return _E(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=P0(e,null,r,n):xo(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Dl(r,i),UM(t,e,r,i,n);case 7:return xo(t,e,e.pendingProps,n),e.child;case 8:return xo(t,e,e.pendingProps.children,n),e.child;case 12:return xo(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,A=i.value,qr(by,r._currentValue),r._currentValue=A,s!==null)if(ql(s.value,A)){if(s.children===i.children&&!Qo.current){e=Ru(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){A=s.child;for(var y=a.firstContext;y!==null;){if(y.context===r){if(s.tag===1){y=Mu(-1,n&-n),y.tag=2;var w=s.updateQueue;if(w!==null){w=w.shared;var P=w.pending;P===null?y.next=y:(y.next=P.next,P.next=y),w.pending=y}}s.lanes|=n,y=s.alternate,y!==null&&(y.lanes|=n),Zw(s.return,n,e),a.lanes|=n;break}y=y.next}}else if(s.tag===10)A=s.type===e.type?null:s.child;else if(s.tag===18){if(A=s.return,A===null)throw Error(Rt(341));A.lanes|=n,a=A.alternate,a!==null&&(a.lanes|=n),Zw(A,n,e),A=s.sibling}else A=s.child;if(A!==null)A.return=s;else for(A=s;A!==null;){if(A===e){A=null;break}if(s=A.sibling,s!==null){s.return=A.return,A=s;break}A=A.return}s=A}xo(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,f0(e,n),i=al(i),r=r(i),e.flags|=1,xo(t,e,r,n),e.child;case 14:return r=e.type,i=Dl(r,e.pendingProps),i=Dl(r.type,i),VM(t,e,r,i,n);case 15:return yL(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Dl(r,i),R1(t,e),e.tag=1,qo(r)?(t=!0,vy(e)):t=!1,f0(e,n),Q8(e,r,i),Xw(e,r,i,n),eb(null,e,r,!0,t,n);case 19:return bL(t,e,n);case 22:return _L(t,e,n)}throw Error(Rt(156,e.tag))};function NL(t,e){return c8(t,e)}function MU(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nl(t,e,n,r){return new MU(t,e,n,r)}function RE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function CU(t){if(typeof t=="function")return RE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===J3)return 11;if(t===eE)return 14}return 2}function Nc(t,e){var n=t.alternate;return n===null?(n=nl(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function O1(t,e,n,r,i,s){var A=2;if(r=t,typeof t=="function")RE(t)&&(A=1);else if(typeof t=="string")A=5;else e:switch(t){case zf:return Sh(n.children,i,s,e);case K3:A=8,i|=8;break;case xw:return t=nl(12,n,e,i|2),t.elementType=xw,t.lanes=s,t;case ww:return t=nl(13,n,e,i),t.elementType=ww,t.lanes=s,t;case bw:return t=nl(19,n,e,i),t.elementType=bw,t.lanes=s,t;case q6:return J_(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case W6:A=10;break e;case Q6:A=9;break e;case J3:A=11;break e;case eE:A=14;break e;case _c:A=16,r=null;break e}throw Error(Rt(130,t==null?t:typeof t,""))}return e=nl(A,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Sh(t,e,n,r){return t=nl(7,t,r,e),t.lanes=n,t}function J_(t,e,n,r){return t=nl(22,t,r,e),t.elementType=q6,t.lanes=n,t.stateNode={isHidden:!1},t}function Yv(t,e,n){return t=nl(6,t,null,e),t.lanes=n,t}function Xv(t,e,n){return e=nl(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function PU(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kv(0),this.expirationTimes=kv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kv(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function BE(t,e,n,r,i,s,A,a,y){return t=new PU(t,e,n,a,y),e===1?(e=1,s===!0&&(e|=8)):e=0,s=nl(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},yE(s),t}function IU(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bf,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function UL(t){if(!t)return Wc;t=t._reactInternals;e:{if(Xh(t)!==t||t.tag!==1)throw Error(Rt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(qo(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Rt(171))}if(t.tag===1){var n=t.type;if(qo(n))return N8(t,n,e)}return e}function VL(t,e,n,r,i,s,A,a,y){return t=BE(n,r,!0,t,i,s,A,a,y),t.context=UL(null),n=t.current,r=So(),i=Fc(n),s=Mu(r,i),s.callback=e??null,zc(n,s,i),t.current.lanes=i,Pg(t,i,r),Zo(t,r),t}function e2(t,e,n,r){var i=e.current,s=So(),A=Fc(i);return n=UL(n),e.context===null?e.context=n:e.pendingContext=n,e=Mu(s,A),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=zc(i,e,A),t!==null&&(Wl(t,i,A,s),k1(t,i,A)),A}function Dy(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function JM(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function zE(t,e){JM(t,e),(t=t.alternate)&&JM(t,e)}function kU(){return null}var GL=typeof reportError=="function"?reportError:function(t){console.error(t)};function OE(t){this._internalRoot=t}t2.prototype.render=OE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Rt(409));e2(t,e,null,null)};t2.prototype.unmount=OE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Dh(function(){e2(null,t,null,null)}),e[Lu]=null}};function t2(t){this._internalRoot=t}t2.prototype.unstable_scheduleHydration=function(t){if(t){var e=y8();t={blockedOn:null,target:t,priority:e};for(var n=0;n<wc.length&&e!==0&&e<wc[n].priority;n++);wc.splice(n,0,t),n===0&&v8(t)}};function FE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function n2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function e5(){}function LU(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var w=Dy(A);s.call(w)}}var A=VL(e,r,t,0,null,!1,!1,"",e5);return t._reactRootContainer=A,t[Lu]=A.current,jp(t.nodeType===8?t.parentNode:t),Dh(),A}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var w=Dy(y);a.call(w)}}var y=BE(t,0,!1,null,null,!1,!1,"",e5);return t._reactRootContainer=y,t[Lu]=y.current,jp(t.nodeType===8?t.parentNode:t),Dh(function(){e2(e,y,n,r)}),y}function r2(t,e,n,r,i){var s=n._reactRootContainer;if(s){var A=s;if(typeof i=="function"){var a=i;i=function(){var y=Dy(A);a.call(y)}}e2(e,A,t,i)}else A=LU(n,e,t,i,r);return Dy(A)}g8=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ip(e.pendingLanes);n!==0&&(rE(e,n|1),Zo(e,Ii()),!(vr&6)&&(L0=Ii()+500,Kc()))}break;case 13:Dh(function(){var r=Du(t,1);if(r!==null){var i=So();Wl(r,t,1,i)}}),zE(t,1)}};iE=function(t){if(t.tag===13){var e=Du(t,134217728);if(e!==null){var n=So();Wl(e,t,134217728,n)}zE(t,134217728)}};m8=function(t){if(t.tag===13){var e=Fc(t),n=Du(t,e);if(n!==null){var r=So();Wl(n,t,e,r)}zE(t,e)}};y8=function(){return Ir};_8=function(t,e){var n=Ir;try{return Ir=t,e()}finally{Ir=n}};Dw=function(t,e,n){switch(e){case"input":if(Sw(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Q_(r);if(!i)throw Error(Rt(90));Y6(r),Sw(r,i)}}}break;case"textarea":K6(t,n);break;case"select":e=n.value,e!=null&&A0(t,!!n.multiple,e,!1)}};s8=kE;o8=Dh;var DU={usingClientEntryPoint:!1,Events:[kg,Uf,Q_,r8,i8,kE]},Ld={findFiberByHostInstance:vh,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},RU={bundleType:Ld.bundleType,version:Ld.version,rendererPackageName:Ld.rendererPackageName,rendererConfig:Ld.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hu.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=A8(t),t===null?null:t.stateNode},findFiberByHostInstance:Ld.findFiberByHostInstance||kU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Om=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Om.isDisabled&&Om.supportsFiber)try{j_=Om.inject(RU),PA=Om}catch{}}Ca.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DU;Ca.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!FE(e))throw Error(Rt(200));return IU(t,e,null,n)};Ca.createRoot=function(t,e){if(!FE(t))throw Error(Rt(299));var n=!1,r="",i=GL;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=BE(t,1,!1,null,null,n,!1,r,i),t[Lu]=e.current,jp(t.nodeType===8?t.parentNode:t),new OE(e)};Ca.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Rt(188)):(t=Object.keys(t).join(","),Error(Rt(268,t)));return t=A8(e),t=t===null?null:t.stateNode,t};Ca.flushSync=function(t){return Dh(t)};Ca.hydrate=function(t,e,n){if(!n2(e))throw Error(Rt(200));return r2(null,t,e,!0,n)};Ca.hydrateRoot=function(t,e,n){if(!FE(t))throw Error(Rt(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",A=GL;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(A=n.onRecoverableError)),e=VL(e,null,t,1,n??null,i,!1,s,A),t[Lu]=e.current,jp(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new t2(e)};Ca.render=function(t,e,n){if(!n2(e))throw Error(Rt(200));return r2(null,t,e,!1,n)};Ca.unmountComponentAtNode=function(t){if(!n2(t))throw Error(Rt(40));return t._reactRootContainer?(Dh(function(){r2(null,null,t,!1,function(){t._reactRootContainer=null,t[Lu]=null})}),!0):!1};Ca.unstable_batchedUpdates=kE;Ca.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!n2(n))throw Error(Rt(200));if(t==null||t._reactInternals===void 0)throw Error(Rt(38));return r2(t,e,n,!1,r)};Ca.version="18.2.0-next-9e3b772b8-20220608";function jL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jL)}catch(t){console.error(t)}}jL(),V6.exports=Ca;var NE=V6.exports,$L,t5=NE;$L=t5.createRoot,t5.hydrateRoot;/**
 * @remix-run/router v1.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ry(){return Ry=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ry.apply(this,arguments)}var Mc;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Mc||(Mc={}));const n5="popstate";function BU(t){t===void 0&&(t={});function e(i,s){let{pathname:A="/",search:a="",hash:y=""}=Dg(i.location.hash.substr(1));return!A.startsWith("/")&&!A.startsWith(".")&&(A="/"+A),hb("",{pathname:A,search:a,hash:y},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){let A=i.document.querySelector("base"),a="";if(A&&A.getAttribute("href")){let y=i.location.href,w=y.indexOf("#");a=w===-1?y:y.slice(0,w)}return a+"#"+(typeof s=="string"?s:HL(s))}function r(i,s){i2(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return OU(e,n,r,t)}function Ko(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function i2(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function zU(){return Math.random().toString(36).substr(2,8)}function r5(t,e){return{usr:t.state,key:t.key,idx:e}}function hb(t,e,n,r){return n===void 0&&(n=null),Ry({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Dg(e):e,{state:n,key:e&&e.key||r||zU()})}function HL(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Dg(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function OU(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,A=i.history,a=Mc.Pop,y=null,w=P();w==null&&(w=0,A.replaceState(Ry({},A.state,{idx:w}),""));function P(){return(A.state||{idx:null}).idx}function I(){a=Mc.Pop;let ae=P(),K=ae==null?null:ae-w;w=ae,y&&y({action:a,location:q.location,delta:K})}function L(ae,K){a=Mc.Push;let ne=hb(q.location,ae,K);n&&n(ne,ae),w=P()+1;let ie=r5(ne,w),fe=q.createHref(ne);try{A.pushState(ie,"",fe)}catch(ye){if(ye instanceof DOMException&&ye.name==="DataCloneError")throw ye;i.location.assign(fe)}s&&y&&y({action:a,location:q.location,delta:1})}function U(ae,K){a=Mc.Replace;let ne=hb(q.location,ae,K);n&&n(ne,ae),w=P();let ie=r5(ne,w),fe=q.createHref(ne);A.replaceState(ie,"",fe),s&&y&&y({action:a,location:q.location,delta:0})}function W(ae){let K=i.location.origin!=="null"?i.location.origin:i.location.href,ne=typeof ae=="string"?ae:HL(ae);return Ko(K,"No window.location.(origin|href) available to create URL for href: "+ne),new URL(ne,K)}let q={get action(){return a},get location(){return t(i,A)},listen(ae){if(y)throw new Error("A history only accepts one active listener");return i.addEventListener(n5,I),y=ae,()=>{i.removeEventListener(n5,I),y=null}},createHref(ae){return e(i,ae)},createURL:W,encodeLocation(ae){let K=W(ae);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:L,replace:U,go(ae){return A.go(ae)}};return q}var i5;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(i5||(i5={}));function FU(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Dg(e):e,i=qL(r.pathname||"/",n);if(i==null)return null;let s=WL(t);NU(s);let A=null;for(let a=0;A==null&&a<s.length;++a)A=qU(s[a],XU(i));return A}function WL(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,A,a)=>{let y={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:A,route:s};y.relativePath.startsWith("/")&&(Ko(y.relativePath.startsWith(r),'Absolute route path "'+y.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),y.relativePath=y.relativePath.slice(r.length));let w=p0([r,y.relativePath]),P=n.concat(y);s.children&&s.children.length>0&&(Ko(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+w+'".')),WL(s.children,e,P,w)),!(s.path==null&&!s.index)&&e.push({path:w,score:WU(w,s.index),routesMeta:P})};return t.forEach((s,A)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,A);else for(let y of QL(s.path))i(s,A,y)}),e}function QL(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let A=QL(r.join("/")),a=[];return a.push(...A.map(y=>y===""?s:[s,y].join("/"))),i&&a.push(...A),a.map(y=>t.startsWith("/")&&y===""?"/":y)}function NU(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:QU(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const UU=/^:[\w-]+$/,VU=3,GU=2,jU=1,$U=10,HU=-2,s5=t=>t==="*";function WU(t,e){let n=t.split("/"),r=n.length;return n.some(s5)&&(r+=HU),e&&(r+=GU),n.filter(i=>!s5(i)).reduce((i,s)=>i+(UU.test(s)?VU:s===""?jU:$U),r)}function QU(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function qU(t,e){let{routesMeta:n}=t,r={},i="/",s=[];for(let A=0;A<n.length;++A){let a=n[A],y=A===n.length-1,w=i==="/"?e:e.slice(i.length)||"/",P=ZU({path:a.relativePath,caseSensitive:a.caseSensitive,end:y},w);if(!P)return null;Object.assign(r,P.params);let I=a.route;s.push({params:r,pathname:p0([i,P.pathname]),pathnameBase:JU(p0([i,P.pathnameBase])),route:I}),P.pathnameBase!=="/"&&(i=p0([i,P.pathnameBase]))}return s}function ZU(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=YU(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],A=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((w,P,I)=>{let{paramName:L,isOptional:U}=P;if(L==="*"){let q=a[I]||"";A=s.slice(0,s.length-q.length).replace(/(.)\/+$/,"$1")}const W=a[I];return U&&!W?w[L]=void 0:w[L]=KU(W||"",L),w},{}),pathname:s,pathnameBase:A,pattern:t}}function YU(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),i2(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(A,a,y)=>(r.push({paramName:a,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function XU(t){try{return decodeURI(t)}catch(e){return i2(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function KU(t,e){try{return decodeURIComponent(t)}catch(n){return i2(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function qL(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const p0=t=>t.join("/").replace(/\/\/+/g,"/"),JU=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/");function eV(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const ZL=["post","put","patch","delete"];new Set(ZL);const tV=["get",...ZL];new Set(tV);/**
 * React Router v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function By(){return By=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},By.apply(this,arguments)}const nV=At.createContext(null),rV=At.createContext(null),YL=At.createContext(null),s2=At.createContext(null),o2=At.createContext({outlet:null,matches:[],isDataRoute:!1}),XL=At.createContext(null);function UE(){return At.useContext(s2)!=null}function iV(){return UE()||Ko(!1),At.useContext(s2).location}function sV(t,e){return oV(t,e)}function oV(t,e,n,r){UE()||Ko(!1);let{navigator:i}=At.useContext(YL),{matches:s}=At.useContext(o2),A=s[s.length-1],a=A?A.params:{};A&&A.pathname;let y=A?A.pathnameBase:"/";A&&A.route;let w=iV(),P;if(e){var I;let ae=typeof e=="string"?Dg(e):e;y==="/"||(I=ae.pathname)!=null&&I.startsWith(y)||Ko(!1),P=ae}else P=w;let L=P.pathname||"/",U=y==="/"?L:L.slice(y.length)||"/",W=FU(t,{pathname:U}),q=cV(W&&W.map(ae=>Object.assign({},ae,{params:Object.assign({},a,ae.params),pathname:p0([y,i.encodeLocation?i.encodeLocation(ae.pathname).pathname:ae.pathname]),pathnameBase:ae.pathnameBase==="/"?y:p0([y,i.encodeLocation?i.encodeLocation(ae.pathnameBase).pathname:ae.pathnameBase])})),s,n,r);return e&&q?At.createElement(s2.Provider,{value:{location:By({pathname:"/",search:"",hash:"",state:null,key:"default"},P),navigationType:Mc.Pop}},q):q}function aV(){let t=pV(),e=eV(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return At.createElement(At.Fragment,null,At.createElement("h2",null,"Unexpected Application Error!"),At.createElement("h3",{style:{fontStyle:"italic"}},e),n?At.createElement("pre",{style:i},n):null,s)}const lV=At.createElement(aV,null);class AV extends At.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?At.createElement(o2.Provider,{value:this.props.routeContext},At.createElement(XL.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function uV(t){let{routeContext:e,match:n,children:r}=t,i=At.useContext(nV);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),At.createElement(o2.Provider,{value:e},r)}function cV(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let A=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let P=A.findIndex(I=>I.route.id&&a?.[I.route.id]);P>=0||Ko(!1),A=A.slice(0,Math.min(A.length,P+1))}let y=!1,w=-1;if(n&&r&&r.v7_partialHydration)for(let P=0;P<A.length;P++){let I=A[P];if((I.route.HydrateFallback||I.route.hydrateFallbackElement)&&(w=P),I.route.id){let{loaderData:L,errors:U}=n,W=I.route.loader&&L[I.route.id]===void 0&&(!U||U[I.route.id]===void 0);if(I.route.lazy||W){y=!0,w>=0?A=A.slice(0,w+1):A=[A[0]];break}}}return A.reduceRight((P,I,L)=>{let U,W=!1,q=null,ae=null;n&&(U=a&&I.route.id?a[I.route.id]:void 0,q=I.route.errorElement||lV,y&&(w<0&&L===0?(gV("route-fallback",!1),W=!0,ae=null):w===L&&(W=!0,ae=I.route.hydrateFallbackElement||null)));let K=e.concat(A.slice(0,L+1)),ne=()=>{let ie;return U?ie=q:W?ie=ae:I.route.Component?ie=At.createElement(I.route.Component,null):I.route.element?ie=I.route.element:ie=P,At.createElement(uV,{match:I,routeContext:{outlet:P,matches:K,isDataRoute:n!=null},children:ie})};return n&&(I.route.ErrorBoundary||I.route.errorElement||L===0)?At.createElement(AV,{location:n.location,revalidation:n.revalidation,component:q,error:U,children:ne(),routeContext:{outlet:null,matches:K,isDataRoute:!0}}):ne()},null)}var fb=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(fb||{});function hV(t){let e=At.useContext(rV);return e||Ko(!1),e}function fV(t){let e=At.useContext(o2);return e||Ko(!1),e}function dV(t){let e=fV(),n=e.matches[e.matches.length-1];return n.route.id||Ko(!1),n.route.id}function pV(){var t;let e=At.useContext(XL),n=hV(fb.UseRouteError),r=dV(fb.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}const o5={};function gV(t,e,n){!e&&!o5[t]&&(o5[t]=!0)}function db(t){Ko(!1)}function mV(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Mc.Pop,navigator:s,static:A=!1,future:a}=t;UE()&&Ko(!1);let y=e.replace(/^\/*/,"/"),w=At.useMemo(()=>({basename:y,navigator:s,static:A,future:By({v7_relativeSplatPath:!1},a)}),[y,a,s,A]);typeof r=="string"&&(r=Dg(r));let{pathname:P="/",search:I="",hash:L="",state:U=null,key:W="default"}=r,q=At.useMemo(()=>{let ae=qL(P,y);return ae==null?null:{location:{pathname:ae,search:I,hash:L,state:U,key:W},navigationType:i}},[y,P,I,L,U,W,i]);return q==null?null:At.createElement(YL.Provider,{value:w},At.createElement(s2.Provider,{children:n,value:q}))}function yV(t){let{children:e,location:n}=t;return sV(pb(e),n)}new Promise(()=>{});function pb(t,e){e===void 0&&(e=[]);let n=[];return At.Children.forEach(t,(r,i)=>{if(!At.isValidElement(r))return;let s=[...e,i];if(r.type===At.Fragment){n.push.apply(n,pb(r.props.children,s));return}r.type!==db&&Ko(!1),!r.props.index||!r.props.children||Ko(!1);let A={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(A.children=pb(r.props.children,s)),n.push(A)}),n}/**
 * React Router DOM v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const _V="6";try{window.__reactRouterVersion=_V}catch{}const vV="startTransition",a5=kN[vV];function xV(t){let{basename:e,children:n,future:r,window:i}=t,s=At.useRef();s.current==null&&(s.current=BU({window:i,v5Compat:!0}));let A=s.current,[a,y]=At.useState({action:A.action,location:A.location}),{v7_startTransition:w}=r||{},P=At.useCallback(I=>{w&&a5?a5(()=>y(I)):y(I)},[y,w]);return At.useLayoutEffect(()=>A.listen(P),[A,P]),At.createElement(mV,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:A,future:r})}var l5;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(l5||(l5={}));var A5;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(A5||(A5={}));function zy(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const VE=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),u5=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);u5&&parseFloat(u5[1]);const wV="3.4.14";function Bu(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const F1=typeof process!="object"||String(process)!=="[object process]"||process.browser,bV=typeof window<"u"&&typeof window.orientation<"u",c5=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);c5&&parseFloat(c5[1]);function Kp(t){"@babel/helpers - typeof";return Kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kp(t)}function EV(t,e){if(Kp(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Kp(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TV(t){var e=EV(t,"string");return Kp(e)==="symbol"?e:String(e)}function se(t,e,n){return e=TV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class SV{constructor(e,n){se(this,"name",void 0),se(this,"workerThread",void 0),se(this,"isRunning",!0),se(this,"result",void 0),se(this,"_resolve",()=>{}),se(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){Bu(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Bu(this.isRunning),this.isRunning=!1,this._reject(e)}}let Kv=class{terminate(){}};const Jv=new Map;function MV(t){Bu(t.source&&!t.url||!t.source&&t.url);let e=Jv.get(t.source||t.url);return e||(t.url&&(e=CV(t.url),Jv.set(t.url,e)),t.source&&(e=KL(t.source),Jv.set(t.source,e))),Bu(e),e}function CV(t){if(!t.startsWith("http"))return t;const e=PV(t);return KL(e)}function KL(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function PV(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function JL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(h5(t))r.add(t);else if(h5(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)JL(t[i],e,r)}}return n===void 0?Array.from(r):[]}function h5(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const ex=()=>{};class gb{static isSupported(){return typeof Worker<"u"&&F1||typeof Kv<"u"&&!F1}constructor(e){se(this,"name",void 0),se(this,"source",void 0),se(this,"url",void 0),se(this,"terminated",!1),se(this,"worker",void 0),se(this,"onMessage",void 0),se(this,"onError",void 0),se(this,"_loadableURL","");const{name:n,source:r,url:i}=e;Bu(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=ex,this.onError=s=>console.log(s),this.worker=F1?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=ex,this.onError=ex,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||JL(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=MV({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Kv(r,{eval:!1})}else if(this.source)e=new Kv(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class IV{static isSupported(){return gb.isSupported()}constructor(e){se(this,"name","unnamed"),se(this,"source",void 0),se(this,"url",void 0),se(this,"maxConcurrency",1),se(this,"maxMobileConcurrency",1),se(this,"onDebug",()=>{}),se(this,"reuseWorkers",!0),se(this,"props",{}),se(this,"jobQueue",[]),se(this,"idleQueue",[]),se(this,"count",0),se(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,A,a)=>s.done(a),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,A)=>s.error(A);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new SV(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new gb({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return bV?this.maxMobileConcurrency:this.maxConcurrency}}const kV={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class yu{static isSupported(){return gb.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return yu._workerFarm=yu._workerFarm||new yu({}),yu._workerFarm.setProps(e),yu._workerFarm}constructor(e){se(this,"props",void 0),se(this,"workerPools",new Map),this.props={...kV},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new IV({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}se(yu,"_workerFarm",void 0);const LV="latest";function DV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=LV);const A=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(A,"/dist/").concat(r)}return Bu(i),i}function RV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wV;Bu(t,"no worker provided");const n=t.version;return!(!e||!n)}function BV(t,e){return!yu.isSupported()||!F1&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&e?.worker}async function zV(t,e,n,r,i){const s=t.id,A=DV(t,n),y=yu.getWorkerFarm(n).getWorkerPool({name:s,url:A});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const w=await y.startJob("process-on-worker",OV.bind(null,i));return w.postMessage("process",{input:e,options:n,context:r}),await(await w.result).result}async function OV(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:A}=r;try{const a=await t(s,A);e.postMessage("done",{id:i,result:a})}catch(a){const y=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:y})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function FV(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function NV(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),i=r.reduce((a,y)=>a+y.byteLength,0),s=new Uint8Array(i);let A=0;for(const a of r)s.set(a,A),A+=a.byteLength;return s.buffer}async function UV(t){const e=[];for await(const n of t)e.push(n);return NV(...e)}function f5(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let d5=class{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=f5(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(f5()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},VV=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof d5?i=e:i=new d5(n,r),this.stats[n]=i),i}};const GV="Queued Requests",jV="Active Requests",$V="Cancelled Requests",HV="Queued Requests Ever",WV="Active Requests Ever",QV={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class qV{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};se(this,"props",void 0),se(this,"stats",void 0),se(this,"activeRequestCount",0),se(this,"requestQueue",[]),se(this,"requestMap",new Map),se(this,"deferredUpdate",null),this.props={...QV,...e},this.stats=new VV({id:this.props.id}),this.stats.get(GV),this.stats.get(jV),this.stats.get($V),this.stats.get(HV),this.stats.get(WV)}scheduleRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:n},i=new Promise(s=>(r.resolve=s,r));return this.requestQueue.push(r),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){const{handle:n,resolve:r}=e;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const r=e[n];this._updateRequest(r)||(e.splice(n,1),this.requestMap.delete(r.handle),n--)}e.sort((n,r)=>n.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let ZV="";const p5={};function YV(t){for(const e in p5)if(t.startsWith(e)){const n=p5[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(ZV).concat(t)),t}function XV(t){return t&&typeof t=="object"&&t.isBuffer}function eD(t){if(XV(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function tD(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function KV(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const JV=t=>typeof t=="boolean",Sp=t=>typeof t=="function",Rg=t=>t!==null&&typeof t=="object",g5=t=>Rg(t)&&t.constructor==={}.constructor,eG=t=>t&&typeof t[Symbol.iterator]=="function",tG=t=>t&&typeof t[Symbol.asyncIterator]=="function",Kh=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Jh=t=>typeof Blob<"u"&&t instanceof Blob,nG=t=>t&&typeof t=="object"&&t.isBuffer,rG=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Rg(t)&&Sp(t.tee)&&Sp(t.cancel)&&Sp(t.getReader),iG=t=>Rg(t)&&Sp(t.read)&&Sp(t.pipe)&&JV(t.readable),nD=t=>rG(t)||iG(t),sG=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,oG=/^([-\w.]+\/[-\w.+]+)/;function aG(t){const e=oG.exec(t);return e?e[1]:t}function m5(t){const e=sG.exec(t);return e?e[1]:""}const rD=/\?.*/;function lG(t){const e=t.match(rD);return e&&e[0]}function GE(t){return t.replace(rD,"")}function a2(t){return Kh(t)?t.url:Jh(t)?t.name||"":typeof t=="string"?t:""}function jE(t){if(Kh(t)){const e=t,n=e.headers.get("content-type")||"",r=GE(e.url);return aG(n)||m5(r)}return Jh(t)?t.type||"":typeof t=="string"?m5(t):""}function AG(t){return Kh(t)?t.headers["content-length"]||-1:Jh(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function iD(t){if(Kh(t))return t;const e={},n=AG(t);n>=0&&(e["content-length"]=String(n));const r=a2(t),i=jE(t);i&&(e["content-type"]=i);const s=await hG(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const A=new Response(t,{headers:e});return Object.defineProperty(A,"url",{value:r}),A}async function uG(t){if(!t.ok){const e=await cG(t);throw new Error(e)}}async function cG(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function hG(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var A;return r(s==null||(A=s.target)===null||A===void 0?void 0:A.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=fG(n);return"data:base64,".concat(r)}return null}function fG(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function y5(t,e){if(typeof t=="string"){t=YV(t);let n=e;return e!=null&&e.fetch&&typeof e?.fetch!="function"&&(n=e.fetch),await fetch(t,n)}return await iD(t)}function dG(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Bg(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||dG()}const Fm=globalThis.window||globalThis.self||globalThis.global,Dd=globalThis.process||{},sD=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Bg();function pG(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let gG=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=pG(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function mG(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function yG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function tx(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,A=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(A/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(A,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(A,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Oy;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Oy||(Oy={}));const _G=10;function _5(t){return typeof t!="string"?t:(t=t.toUpperCase(),Oy[t]||Oy.WHITE)}function vG(t,e,n){if(!Bg&&typeof t=="string"){if(e){const r=_5(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=_5(n);t="\x1B[".concat(r+_G,"m").concat(t,"\x1B[49m")}}return t}function xG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const A=i[s];typeof A=="function"&&(e.find(a=>s===a)||(i[s]=A.bind(t)))}}function Fy(t,e){if(!t)throw new Error(e||"Assertion failed")}function xf(){let t;if(Bg()&&Fm.performance){var e,n;t=Fm==null||(e=Fm.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Dd){var r;const i=Dd==null||(r=Dd.hrtime)===null||r===void 0?void 0:r.call(Dd);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const wf={debug:Bg()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},wG={enabled:!0,level:0};function Za(){}const v5={},x5={once:!0};let $E=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=sD,this._startTs=xf(),this._deltaTs=xf(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new gG("__probe-".concat(this.id,"__"),wG),this.timeStamp("".concat(this.id," started")),xG(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((xf()-this._startTs).toPrecision(10))}getDelta(){return Number((xf()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Fy(e,n)}warn(e){return this._getLogFunction(0,e,wf.warn,arguments,x5)}error(e){return this._getLogFunction(0,e,wf.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,wf.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,wf.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,wf.debug||wf.info,arguments,x5)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Za,r&&[r],{tag:SG(n)}):Za}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:A=1}=e;return this._shouldLog(n||r)?Bg()?TG({image:i,message:s,scale:A}):EG():Za}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Za)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=w5({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Za)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=oD(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=w5({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,Fy(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=xf();const A=s.tag||s.message;if(s.once&&A)if(!v5[A])v5[A]=xf();else return Za;return n=bG(this.id,s.message,s),r.bind(console,n,...s.args)}return Za}};$E.VERSION=sD;function oD(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Fy(Number.isFinite(e)&&e>=0),e}function w5(t){const{logLevel:e,message:n}=t;t.logLevel=oD(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return Fy(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function bG(t,e,n){if(typeof e=="string"){const r=n.time?yG(mG(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=vG(e,n.color,n.background)}return e}function EG(t){return console.warn("removed"),Za}function TG(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const A=tx(s,n,r);console.log(...A)},s.src=e,Za}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...tx(e,n,r)),Za;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...tx(s,n,r)),s.src=e.toDataURL(),Za}return Za}function SG(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const b5=new $E({id:"loaders.gl"});class MG{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class CG{constructor(){se(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const aD={fetch:null,mimeType:void 0,nothrow:!1,log:new CG,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:VE,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},PG={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function lD(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const AD=()=>{const t=lD();return t.globalOptions=t.globalOptions||{...aD},t.globalOptions};function IG(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],kG(t,n),DG(e,t,r)}function kG(t,e){E5(t,null,aD,PG,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};E5(r,n.id,i,s,e)}}function E5(t,e,n,r,i){const s=e||"Top level",A=e?"".concat(e,"."):"";for(const a in t){const y=!e&&Rg(t[a]),w=a==="baseUri"&&!e,P=a==="workerUrl"&&e;if(!(a in n)&&!w&&!P){if(a in r)b5.warn("".concat(s," loader option '").concat(A).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!y){const I=LG(a,i);b5.warn("".concat(s," loader option '").concat(A).concat(a,"' not recognized. ").concat(I))()}}}}function LG(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const A=s.toLowerCase();(n.startsWith(A)||A.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function DG(t,e,n){const i={...t.options||{}};return RG(i,n),i.log===null&&(i.log=new MG),T5(i,AD()),T5(i,e),i}function T5(t,e){for(const n in e)if(n in e){const r=e[n];g5(r)&&g5(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function RG(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function HE(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function WE(t){var e,n;zy(t,"null loader"),zy(HE(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const uD=()=>{const t=lD();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function BG(t){const e=uD();t=Array.isArray(t)?t:[t];for(const n of t){const r=WE(n);e.find(i=>r===i)||e.unshift(r)}}function zG(){return uD()}const OG=new $E({id:"loaders.gl"}),FG=/\.([^.]+)$/;async function NG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!cD(t))return null;let i=S5(t,e,{...n,nothrow:!0},r);if(i)return i;if(Jh(t)&&(t=await t.slice(0,10).arrayBuffer(),i=S5(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(hD(t));return i}function S5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!cD(t))return null;if(e&&!Array.isArray(e))return WE(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...zG()),VG(i);const s=UG(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(hD(t));return s}function UG(t,e,n,r){const i=a2(t),s=jE(t),A=GE(i)||r?.url;let a=null,y="";if(n!=null&&n.mimeType&&(a=nx(e,n?.mimeType),y="match forced by supplied MIME type ".concat(n?.mimeType)),a=a||GG(e,A),y=y||(a?"matched url ".concat(A):""),a=a||nx(e,s),y=y||(a?"matched MIME type ".concat(s):""),a=a||$G(e,t),y=y||(a?"matched initial data ".concat(fD(t)):""),a=a||nx(e,n?.fallbackMimeType),y=y||(a?"matched fallback MIME type ".concat(s):""),y){var w;OG.log(1,"selectLoader selected ".concat((w=a)===null||w===void 0?void 0:w.name,": ").concat(y,"."))}return a}function cD(t){return!(t instanceof Response&&t.status===204)}function hD(t){const e=a2(t),n=jE(t);let r="No valid loader found (";r+=e?"".concat(tD(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?fD(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function VG(t){for(const e of t)WE(e)}function GG(t,e){const n=e&&FG.exec(e),r=n&&n[1];return r?jG(t,r):null}function jG(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function nx(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function $G(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(HG(e,n))return n}else if(ArrayBuffer.isView(e)){if(M5(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&M5(e,0,n))return n;return null}function HG(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function M5(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>WG(t,e,n,i))}function WG(t,e,n,r){if(r instanceof ArrayBuffer)return FV(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=mb(t,e,r.length);return r===i;default:return!1}}function fD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?mb(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?mb(t,0,e):""}function mb(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const QG=256*1024;function*qG(t,e){const n=e?.chunkSize||QG;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),A=t.slice(r,r+s);r+=s,yield i.encode(A)}}const ZG=256*1024;function YG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=ZG}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),A=new Uint8Array(t,r,i);new Uint8Array(s).set(A),r+=i,yield s}}()}const XG=1024*1024;async function*KG(t,e){const n=e?.chunkSize||XG;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function C5(t,e){return VE?JG(t,e):ej(t)}async function*JG(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:A}=await i;if(s)return;yield eD(A)}}catch{n.releaseLock()}}async function*ej(t,e){for await(const n of t)yield eD(n)}function tj(t,e){if(typeof t=="string")return qG(t,e);if(t instanceof ArrayBuffer)return YG(t,e);if(Jh(t))return KG(t,e);if(nD(t))return C5(t,e);if(Kh(t))return C5(t.body,e);throw new Error("makeIterator")}const dD="Cannot convert supplied data type";function nj(t,e,n){if(e.text&&typeof t=="string")return t;if(nG(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(dD)}async function rj(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return nj(t,e);if(Jh(t)&&(t=await iD(t)),Kh(t)){const i=t;return await uG(i),e.binary?await i.arrayBuffer():await i.text()}if(nD(t)&&(t=tj(t,n)),eG(t)||tG(t))return UV(t);throw new Error(dD)}function pD(t,e){const n=AD(),r=t||n;return typeof r.fetch=="function"?r.fetch:Rg(r.fetch)?i=>y5(i,r):e!=null&&e.fetch?e?.fetch:y5}function ij(t,e,n){if(n)return n;const r={fetch:pD(e,t),...t};if(r.url){const i=GE(r.url);r.baseUrl=i,r.queryString=lG(r.url),r.filename=tD(i),r.baseUrl=KV(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function sj(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function QE(t,e,n,r){Bu(!r||typeof r=="object"),e&&!Array.isArray(e)&&!HE(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=a2(t),A=sj(e,r),a=await NG(t,A,n);return a?(n=IG(n,a,A,i),r=ij({url:i,parse:QE,loaders:A},n,r||null),await oj(a,t,n,r)):null}async function oj(t,e,n,r){if(RV(t),Kh(e)){const i=e,{ok:s,redirected:A,status:a,statusText:y,type:w,url:P}=i,I=Object.fromEntries(i.headers.entries());r.response={headers:I,ok:s,redirected:A,status:a,statusText:y,type:w,url:P}}if(e=await rj(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(BV(t,n))return await zV(t,e,n,r,QE);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw Bu(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Ny(t,e,n,r){!Array.isArray(e)&&!HE(e)&&(n=e,e=void 0);const i=pD(n);let s=t;return typeof t=="string"&&(s=await i(t)),Jh(t)&&(s=await i(t)),await QE(s,e,n)}const aj="3.4.14",{_parseImageNode:lj}=globalThis,yb=typeof Image<"u",_b=typeof ImageBitmap<"u",Aj=!!lj,vb=VE?!0:Aj;function uj(t){switch(t){case"auto":return _b||yb||vb;case"imagebitmap":return _b;case"image":return yb;case"data":return vb;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function cj(){if(_b)return"imagebitmap";if(yb)return"image";if(vb)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function hj(t){const e=dj(t);if(!e)throw new Error("Not an image");return e}function fj(t){switch(hj(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function dj(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const pj=/^data:image\/svg\+xml/,gj=/\.svg((\?|#).*)?$/;function qE(t){return t&&(pj.test(t)||gj.test(t))}function mj(t,e){if(qE(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return gD(t,e)}function gD(t,e){if(qE(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function mD(t,e,n){const r=mj(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await yj(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function yj(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const _j={};let P5=!0;async function vj(t,e,n){let r;qE(n)?r=await mD(t,e,n):r=gD(t,n);const i=e&&e.imagebitmap;return await xj(r,i)}async function xj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((wj(e)||!P5)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),P5=!1}return await createImageBitmap(t)}function wj(t){for(const e in t||_j)return!1;return!0}function bj(t){return!Mj(t,"ftyp",4)||!(t[8]&96)?null:Ej(t)}function Ej(t){switch(Tj(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Tj(t,e,n){return String.fromCharCode(...t.slice(e,n))}function Sj(t){return[...t].map(e=>e.charCodeAt(0))}function Mj(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=Sj(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const EA=!1,Mp=!0;function yD(t){const e=zg(t);return Pj(e)||Lj(e)||Ij(e)||kj(e)||Cj(e)}function Cj(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=bj(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function Pj(t){const e=zg(t);return e.byteLength>=24&&e.getUint32(0,EA)===2303741511?{mimeType:"image/png",width:e.getUint32(16,EA),height:e.getUint32(20,EA)}:null}function Ij(t){const e=zg(t);return e.byteLength>=10&&e.getUint32(0,EA)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Mp),height:e.getUint16(8,Mp)}:null}function kj(t){const e=zg(t);return e.byteLength>=14&&e.getUint16(0,EA)===16973&&e.getUint32(2,Mp)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Mp),height:e.getUint32(22,Mp)}:null}function Lj(t){const e=zg(t);if(!(e.byteLength>=3&&e.getUint16(0,EA)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=Dj();let s=2;for(;s+9<e.byteLength;){const A=e.getUint16(s,EA);if(i.has(A))return{mimeType:"image/jpeg",height:e.getUint16(s+5,EA),width:e.getUint16(s+7,EA)};if(!r.has(A))return null;s+=2,s+=e.getUint16(s,EA)}return null}function Dj(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function zg(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function Rj(t,e){const{mimeType:n}=yD(t)||{},r=globalThis._parseImageNode;return zy(r),await r(t,n)}async function Bj(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},A=zj(i);let a;switch(A){case"imagebitmap":a=await vj(t,e,s);break;case"image":a=await mD(t,e,s);break;case"data":a=await Rj(t);break;default:zy(!1)}return i==="data"&&(a=fj(a)),a}function zj(t){switch(t){case"auto":case"data":return cj();default:return uj(t),t}}const Oj=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],Fj=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],Nj={image:{type:"auto",decode:!0}},Uj={id:"image",module:"images",name:"Images",version:aj,mimeTypes:Fj,extensions:Oj,parse:Bj,tests:[t=>!!yD(new DataView(t))],options:Nj};function _D(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function J0(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||_D()}const N1={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Nm=N1.window||N1.self||N1.global,Rd=N1.process||{},vD=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";J0();const rx=globalThis;function Vj(t){if(!t&&!J0())return"Node";if(_D(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":rx.chrome?"Chrome":rx.safari?"Safari":rx.mozInnerScreenX?"Firefox":"Unknown"}function Gj(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let jj=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";se(this,"storage",void 0),se(this,"id",void 0),se(this,"config",void 0),this.storage=Gj(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function $j(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function Hj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function ix(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,A=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(A/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(A,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(A,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Uy;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Uy||(Uy={}));function I5(t){return typeof t=="string"?Uy[t.toUpperCase()]||Uy.WHITE:t}function Wj(t,e,n){return!J0&&typeof t=="string"&&(e&&(e=I5(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=I5(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function Qj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function Vy(t,e){if(!t)throw new Error(e||"Assertion failed")}function bf(){let t;if(J0&&"performance"in Nm){var e,n;t=Nm==null||(e=Nm.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Rd){var r;const i=Rd==null||(r=Rd.hrtime)===null||r===void 0?void 0:r.call(Rd);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Ef={debug:J0&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},qj={enabled:!0,level:0};function Ya(){}const k5={},L5={once:!0};let xD=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};se(this,"id",void 0),se(this,"VERSION",vD),se(this,"_startTs",bf()),se(this,"_deltaTs",bf()),se(this,"_storage",void 0),se(this,"userData",{}),se(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new jj("__probe-".concat(this.id,"__"),qj),this.timeStamp("".concat(this.id," started")),Qj(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((bf()-this._startTs).toPrecision(10))}getDelta(){return Number((bf()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Vy(e,n)}warn(e){return this._getLogFunction(0,e,Ef.warn,arguments,L5)}error(e){return this._getLogFunction(0,e,Ef.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Ef.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Ef.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,Ef.debug||Ef.info,arguments,L5)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Ya,r&&[r],{tag:Kj(n)}):Ya}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:A=1}=e;return this._shouldLog(n||r)?J0?Xj({image:i,message:s,scale:A}):Yj():Ya}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Ya)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=D5({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ya)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=wD(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=D5({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,Vy(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=bf();const A=s.tag||s.message;if(s.once)if(!k5[A])k5[A]=bf();else return Ya;return n=Zj(this.id,s.message,s),r.bind(console,n,...s.args)}return Ya}};se(xD,"VERSION",vD);function wD(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Vy(Number.isFinite(e)&&e>=0),e}function D5(t){const{logLevel:e,message:n}=t;t.logLevel=wD(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return Vy(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function Zj(t,e,n){if(typeof e=="string"){const r=n.time?Hj($j(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=Wj(e,n.color,n.background)}return e}function Yj(t){return console.warn("removed"),Ya}function Xj(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const A=ix(s,n,r);console.log(...A)},s.src=e,Ya}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...ix(e,n,r)),Ya;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...ix(s,n,r)),s.src=e.toDataURL(),Ya}return Ya}function Kj(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const rr=new xD({id:"deck"});let xb={};function Jj(t){xb=t}function Xs(t,e,n,r){rr.level>0&&xb[t]&&xb[t].call(null,e,n,r)}function e$(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const t$={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:e$,parseTextSync:JSON.parse};function n$(){const t="8.9.32",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(rr.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:rr,_registerLoggers:Jj},BG([t$,[Uj,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const r$=n$(),ar={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(ar,"IDENTITY",{get:()=>(rr.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Nl={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Rh={common:0,meters:1,pixels:2},R5={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};function i$(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function ed(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||i$()}const U1={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Um=U1.window||U1.self||U1.global,Bd=U1.process||{},bD=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";ed();function s$(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class o${constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";se(this,"storage",void 0),se(this,"id",void 0),se(this,"config",void 0),this.storage=s$(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function a$(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function l$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function sx(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,A=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(A/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(A,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(A,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Gy;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Gy||(Gy={}));function B5(t){return typeof t=="string"?Gy[t.toUpperCase()]||Gy.WHITE:t}function A$(t,e,n){return!ed&&typeof t=="string"&&(e&&(e=B5(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=B5(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function u$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function jy(t,e){if(!t)throw new Error(e||"Assertion failed")}function Tf(){let t;if(ed&&"performance"in Um){var e,n;t=Um==null||(e=Um.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Bd){var r;const i=Bd==null||(r=Bd.hrtime)===null||r===void 0?void 0:r.call(Bd);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Sf={debug:ed&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},c$={enabled:!0,level:0};function Xa(){}const z5={},O5={once:!0};class ED{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};se(this,"id",void 0),se(this,"VERSION",bD),se(this,"_startTs",Tf()),se(this,"_deltaTs",Tf()),se(this,"_storage",void 0),se(this,"userData",{}),se(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new o$("__probe-".concat(this.id,"__"),c$),this.timeStamp("".concat(this.id," started")),u$(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Tf()-this._startTs).toPrecision(10))}getDelta(){return Number((Tf()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){jy(e,n)}warn(e){return this._getLogFunction(0,e,Sf.warn,arguments,O5)}error(e){return this._getLogFunction(0,e,Sf.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Sf.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Sf.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,Sf.debug||Sf.info,arguments,O5)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Xa,r&&[r],{tag:p$(n)}):Xa}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:A=1}=e;return this._shouldLog(n||r)?ed?d$({image:i,message:s,scale:A}):f$():Xa}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Xa)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=F5({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Xa)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=TD(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=F5({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,jy(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Tf();const A=s.tag||s.message;if(s.once)if(!z5[A])z5[A]=Tf();else return Xa;return n=h$(this.id,s.message,s),r.bind(console,n,...s.args)}return Xa}}se(ED,"VERSION",bD);function TD(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return jy(Number.isFinite(e)&&e>=0),e}function F5(t){const{logLevel:e,message:n}=t;t.logLevel=TD(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return jy(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function h$(t,e,n){if(typeof e=="string"){const r=n.time?l$(a$(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=A$(e,n.color,n.background)}return e}function f$(t){return console.warn("removed"),Xa}function d$(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const A=sx(s,n,r);console.log(...A)},s.src=e,Xa}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...sx(e,n,r)),Xa;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...sx(s,n,r)),s.src=e.toDataURL(),Xa}return Xa}function p$(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const _n=new ED({id:"luma.gl"});function wo(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const g$="Invalid WebGLRenderingContext",m$="Requires WebGL2";function l2(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function lr(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function y$(t){return lr(t)?t:null}function A2(t){return wo(l2(t),g$),t}function to(t){return wo(lr(t),m$),t}const op={};function _$(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function v$(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function x$(t,e){op[t]=!0,e!==void 0&&_$(e)}function w$(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(op[r]=!0);while(r!==0);for(r in op)if(op[r])return delete op[r],parseInt(r,10);return 0}}const Og=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Og.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Og.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const ef=function(e){const n=this;this.gl=e,w$(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const A=n.currentVertexArrayObject;A.maxAttrib=Math.max(A.maxAttrib,s);const a=A.attribs[s];return a.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const A=n.currentVertexArrayObject;A.maxAttrib=Math.max(A.maxAttrib,s);const a=A.attribs[s];return a.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,A){switch(s){case 34962:n.currentArrayBuffer=A;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=A;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,A){const y=n.currentVertexArrayObject.attribs[s];switch(A){case 34975:return y.buffer;case 34338:return y.enabled;case 34339:return y.size;case 34340:return y.stride;case 34341:return y.type;case 34922:return y.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,A,a,y,w,P){const I=n.currentVertexArrayObject;I.maxAttrib=Math.max(I.maxAttrib,s);const L=I.attribs[s];return L.buffer=n.currentArrayBuffer,L.size=A,L.type=a,L.normalized=y,L.stride=w,L.offset=P,L.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{v$("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};ef.prototype.VERTEX_ARRAY_BINDING_OES=34229;ef.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Og(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};ef.prototype.createVertexArrayOES=function(){const e=new Og(this);return this.vertexArrayObjects.push(e),e};ef.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};ef.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Og&&e.hasBeenBound&&e.ext===this)};ef.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){x$(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let A=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let y=0;y<=a;y++){const w=s.attribs[y],P=i?i.attribs[y]:null;if((!i||w.enabled!==P.enabled)&&(w.enabled?r.enableVertexAttribArray.call(n,y):r.disableVertexAttribArray.call(n,y)),w.enabled){let I=!1;(!i||w.buffer!==P.buffer)&&(A!==w.buffer&&(r.bindBuffer.call(n,34962,w.buffer),A=w.buffer),I=!0),(I||w.cached!==P.cached)&&r.vertexAttribPointer.call(n,y,w.size,w.type,w.normalized,w.stride,w.offset)}}this.currentArrayBuffer!==A&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function b$(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new ef(this)),this.__OESVertexArrayObject))}}const N5="OES_element_index",U5="WEBGL_draw_buffers",E$="EXT_disjoint_timer_query",T$="EXT_disjoint_timer_query_webgl2",S$="EXT_texture_filter_anisotropic",V5="WEBGL_debug_renderer_info",M$=35723,C$=4352,P$=36795,I$=34047,k$=37445,L$=37446,Wr=t=>lr(t)?void 0:0,D$={3074:t=>lr(t)?void 0:36064,[M$]:t=>lr(t)?void 0:C$,35977:Wr,32937:Wr,[P$]:(t,e)=>{const n=lr(t)?t.getExtension(T$):t.getExtension(E$);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[k$]:(t,e)=>{const n=t.getExtension(V5);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[L$]:(t,e)=>{const n=t.getExtension(V5);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[I$]:(t,e)=>{const n=t.luma.extensions[S$];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Wr,35071:Wr,37447:Wr,36063:(t,e)=>{if(!lr(t)){const n=t.getExtension(U5);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Wr,35374:Wr,35377:Wr,34852:t=>{if(!lr(t)){const e=t.getExtension(U5);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(N5)?2147483647:65535,33001:t=>t.getExtension(N5)?16777216:65535,33e3:t=>16777216,37157:Wr,35373:Wr,35657:Wr,36183:Wr,37137:Wr,34045:Wr,35978:Wr,35979:Wr,35968:Wr,35376:Wr,35375:Wr,35659:Wr,37154:Wr,35371:Wr,35658:Wr,35076:Wr,35077:Wr,35380:Wr};function R$(t,e,n){const r=D$[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const B$="OES_vertex_array_object",SD="ANGLE_instanced_arrays",z$="WEBGL_draw_buffers",O$="EXT_disjoint_timer_query",F$="EXT_texture_filter_anisotropic",N$="VertexArray requires WebGL2 or OES_vertex_array_object extension";function U$(t,e){return{webgl2:lr(t),ext:t.getExtension(e)}}const MD={[B$]:{meta:{suffix:"OES"},createVertexArray:()=>{wo(!1,N$)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[SD]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){wo(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[z$]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{wo(!1)}},[O$]:{meta:{suffix:"EXT"},createQuery:()=>{wo(!1)},deleteQuery:()=>{wo(!1)},beginQuery:()=>{wo(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},ox={readBuffer:(t,e,n)=>{lr(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=U$(t,SD);let A;switch(r){case 35069:A=i?void 0:!1;break;case 35070:A=!i&&!s?0:void 0;break}return A!==void 0?A:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!lr(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!lr(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[F$];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:R$,hint(t,e,n,r){return e(n,r)}};function V$(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(b$(t),G$(t),$$(t,MD),j$(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=V$;function G$(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function j$(t,e){let{target:n,target2:r}=e;Object.keys(ox).forEach(i=>{if(typeof ox[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},A=ox[i].bind(null,t,s);n[i]=A,r[i]=A}})}function $$(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&H$(t,{extension:n,target:t.luma,target2:t})}function H$(t,e){let{extension:n,target:r,target2:i}=e;const s=MD[n];wo(s);const{meta:A={}}=s,{suffix:a=""}=A,y=t.getExtension(n);for(const w of Object.keys(s)){const P="".concat(w).concat(a);let I=null;w==="meta"||typeof t[w]=="function"||(y&&typeof y[P]=="function"?I=function(){return y[P](...arguments)}:typeof s[w]=="function"&&(I=s[w].bind(r))),I&&(r[w]=I,i[w]=I)}}const ZE={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},hc=(t,e,n)=>e?t.enable(n):t.disable(n),G5=(t,e,n)=>t.hint(n,e),ga=(t,e,n)=>t.pixelStorei(n,e),W$=(t,e)=>{const n=lr(t)?36009:36160;return t.bindFramebuffer(n,e)},Q$=(t,e)=>t.bindFramebuffer(36008,e);function zd(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const q$={3042:hc,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:hc,2885:(t,e)=>t.cullFace(e),2929:hc,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:hc,35723:G5,36006:W$,2886:(t,e)=>t.frontFace(e),33170:G5,2849:(t,e)=>t.lineWidth(e),32823:hc,32824:"polygonOffset",10752:"polygonOffset",35977:hc,32938:"sampleCoverage",32939:"sampleCoverage",3089:hc,3088:(t,e)=>t.scissor(...e),2960:hc,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:ga,3317:ga,37440:ga,37441:ga,37443:ga,3330:ga,3332:ga,3331:ga,36010:Q$,3314:ga,32878:ga,3316:ga,3315:ga,32877:ga,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=zd(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=zd(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=zd(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=zd(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,A,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,A,a)},stencilOp:(t,e)=>{e=zd(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,A,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,A,a)},viewport:(t,e)=>t.viewport(...e)};function _i(t,e,n){return e[t]!==void 0?e[t]:n[t]}const Z$={blendEquation:(t,e,n)=>t.blendEquationSeparate(_i(32777,e,n),_i(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(_i(32969,e,n),_i(32968,e,n),_i(32971,e,n),_i(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(_i(32824,e,n),_i(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(_i(32938,e,n),_i(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,_i(2962,e,n),_i(2967,e,n),_i(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,_i(34816,e,n),_i(36003,e,n),_i(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,_i(2964,e,n),_i(2965,e,n),_i(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,_i(34817,e,n),_i(34818,e,n),_i(34819,e,n))},j5={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},gA=(t,e)=>t.isEnabled(e),$5={3042:gA,2884:gA,2929:gA,3024:gA,32823:gA,32926:gA,32928:gA,3089:gA,2960:gA,35977:gA};function CD(t){for(const e in t)return!1;return!0}function Y$(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function H5(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function X$(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,A=new Array(s),a=0;a<s;a++)A[a]=arguments[a];const{valueChanged:y,oldValue:w}=n(t.state._updateCache,...A);return y&&r(...A),w},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function K$(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class J${constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?tH(e):Object.assign({},ZE),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){wo(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];zu(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){wo(s!==void 0);const A=e[s],a=this.cache[s];Y$(A,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=A)}return{valueChanged:n,oldValue:r}}}function PD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(wo(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new J$(t,{copyState:r}),K$(t);for(const s in j5){const A=j5[s];X$(t,s,A)}H5(t,"getParameter"),H5(t,"isEnabled")}return t.state.enable=n,t}function eH(t){t.state||PD(t,{copyState:!1}),t.state.push()}function W5(t){wo(t.state),t.state.pop()}function zu(t,e){if(wo(l2(t),"setParameters requires a WebGL context"),CD(e))return;const n={};for(const i in e){const s=Number(i),A=q$[i];A&&(typeof A=="string"?n[A]=!0:A(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=Z$[i];s(t,e,r)}}function tH(t,e){if(e=e||ZE,typeof e=="number"){const i=e,s=$5[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=$5[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function nH(t){zu(t,ZE)}function Ql(t,e,n){if(CD(e))return n(t);const{nocatch:r=!0}=e;eH(t),zu(t,e);let i;if(r)i=n(t),W5(t);else try{i=n(t)}finally{W5(t)}return i}function D0(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function ax(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=D0(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return iH(e,r,i,s,n)}function rH(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function iH(t,e,n,r,i){const s=Q5(t[0],e,n);let A=q5(t[1],e,r,i),a=Q5(t[0]+1,e,n);const y=a===n-1?a:a-1;a=q5(t[1]+1,e,r,i);let w;return i?(a=a===0?a:a+1,w=A,A=a):w=a===r-1?a:a-1,{x:s,y:A,width:Math.max(y-s+1,1),height:Math.max(w-A+1,1)}}function Q5(t,e,n){return Math.min(Math.round(t*e),n-1)}function q5(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const YE=ed(),sH=YE&&typeof document<"u",ID={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function kD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};wo(YE,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},ID,t);const{width:e,height:n}=t;function r(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=r;let i;const{canvas:s}=t,A=AH({canvas:s,width:e,height:n,onError:r});return i=lH(A,t),i?(i=XE(i,t),uH(i),i):null}function XE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||cH(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},ID,e);const{manageState:n,debug:r}=e;return n&&PD(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),A=0;A<i;A++)s[A]=arguments[A];return _n.log(1,...s)()}}),YE&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),_n.level=Math.max(_n.level,1)):_n.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function oH(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function aH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=rH(e.useDevicePixels);hH(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function lH(t,e){const{onError:n}=e;let r=null;const i=y=>r=y.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:A=!0}=e;let a=null;return A&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(A&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function AH(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(sH&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function uH(t){const e=lr(t)?"WebGL2":"WebGL1",n=oH(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";_n.info(1,"".concat(e).concat(i," context ").concat(r))()}function cH(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function hH(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(_n.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let A=e;const a=Math.floor(r*A),y=Math.floor(i*A);t.canvas.width=a,t.canvas.height=y,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==y)&&(_n.warn("Device pixel ratio clamped")(),A=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*A),t.canvas.height=Math.floor(i*A)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}function Z5(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let Y5=class{constructor(e,n){se(this,"name",void 0),se(this,"type",void 0),se(this,"sampleSize",1),se(this,"time",void 0),se(this,"count",void 0),se(this,"samples",void 0),se(this,"lastTiming",void 0),se(this,"lastSampleTime",void 0),se(this,"lastSampleCount",void 0),se(this,"_count",0),se(this,"_time",0),se(this,"_samples",0),se(this,"_startTime",0),se(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Z5(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Z5()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},fH=class{constructor(e){se(this,"id",void 0),se(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof Y5?this.stats[n]=e:this.stats[n]=new Y5(n,r)),this.stats[n]}};function LD(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function DD(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||LD()}const lx=globalThis;function dH(t){if(!t&&!DD())return"Node";if(LD(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":lx.chrome?"Chrome":lx.safari?"Safari":lx.mozInnerScreenX?"Firefox":"Unknown"}const Cp="8.5.21",pH="set luma.log.level=1 (or higher) to trace rendering";class gH{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new fH({id:e})),this.stats.get(e)}}const bh=new gH;if(globalThis.luma&&globalThis.luma.VERSION!==Cp)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Cp));globalThis.luma||(DD()&&_n.log(1,"luma.gl ".concat(Cp," - ").concat(pH))(),globalThis.luma=globalThis.luma||{VERSION:Cp,version:Cp,log:_n,stats:bh,globals:{modules:{},nodeIO:{}}});function mH(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function yH(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function tn(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Ax(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return tn(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function Uc(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const ux={};function Qc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";ux[t]=ux[t]||1;const e=ux[t]++;return"".concat(t,"-").concat(e)}function X5(t){return tn(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function R0(t){let e=!0;for(const n in t){e=!1;break}return e}function RD(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(A=>{s.methodName||(s[A]=()=>{throw _n.removed("Calling removed method ".concat(e,".").concat(A,": "),i)(),new Error(A)})})}const Mf="Resource subclass must define virtual methods";let Wu=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};A2(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||Qc(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=Ax(this.gl,e),tn(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=lr(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const a=i.webgl1,y="webgl2"in i?i.webgl2:i.webgl1;return s?y:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=lr(this.gl),A={},a=n||Object.keys(i);for(const y of a){const w=i[y];if(w&&(!("webgl2"in w)||s)&&(!("extension"in w)||this.gl.getExtension(w.extension))){const I=r?Uc(this.gl,y):y;A[I]=this.getParameter(y,e),r&&w.type==="GLenum"&&(A[I]=Uc(this.gl,A[I]))}}return A}setParameter(e,n){e=Ax(this.gl,e),tn(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=lr(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=Ax(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return RD(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(Mf)}_deleteHandle(){throw new Error(Mf)}_bindHandle(e){throw new Error(Mf)}_getOptsFromHandle(){throw new Error(Mf)}_getParameter(e,n){throw new Error(Mf)}_setParameter(e,n){throw new Error(Mf)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=bh.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];bh.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=bh.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=bh.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const _H="Failed to deduce GL constant from typed array";function wb(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(_H)}}function Jp(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function vH(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const A=n*i;s=s||new Uint8Array(A);for(let a=0;a<r/2;++a){const y=a*A,w=(r-a-1)*A;s.set(e.subarray(y,y+A)),e.copyWithin(y,w,w+A),e.set(s,w)}}function xH(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),A=new Uint8Array(i*s*4);for(let a=0;a<s;a++)for(let y=0;y<i;y++)for(let w=0;w<4;w++)A[(a*i+y)*4+w]=e[(a*2*n+y*2)*4+w];return{data:A,width:i,height:s}}function bb(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const w=r[a]?"".concat(t,".").concat(r[a]):"N/A";_n.removed("".concat(t,".").concat(a),w)()}for(const a in i)if(a in e){const y=i[a];_n.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(y))()}let A=null;for(const a in s)if(a in e){const y=s[a];_n.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(y))(),A=A||Object.assign({},e),A[y]=e[a],delete A[a]}return A||e}const wH={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},bH={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class xa{static getBytesPerElement(e){return Jp(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return tn(e.size),Jp(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new xa(wH,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return xa.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return xa.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=bb("Accessor",e,bH),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const K5=10,BD={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},EH={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:BD},TH={removedProps:BD};class Br extends Wu{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/xa.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/xa.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=bb("Buffer",e,EH),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=bb("Buffer",e,TH),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new xa(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;tn(n);const A=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(A,this.handle),i!==0||s!==void 0?(to(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(A,r,n),this.gl.bindBuffer(A,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:A}=this;return to(A),A.bindBuffer(36662,n.handle),A.bindBuffer(36663,this.handle),A.copyBufferSubData(36662,36663,r,i,s),A.bindBuffer(36662,null),A.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};to(this.gl);const s=Jp(this.accessor.type||5126,{clamped:!1}),A=this._getAvailableElementCount(n),a=r;let y,w;e?(w=e.length,y=w-a):(y=Math.min(A,i||A),w=a+y);const P=Math.min(A,y);return i=i||P,tn(i<=P),e=e||new s(w),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(tn(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(K5,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;tn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,K5),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=wb(e);return tn(s),this.setAccessor(new xa(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;tn(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Jp(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new xa(this.accessor,{type:wb(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return _n.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return _n.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return _n.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return _n.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new xa(this.accessor,e),this}}const KE={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},zD={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},OD={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function SH(t,e){const n=KE[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=lr(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function MH(t,e){const n=KE[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const CH=[9729,9728],J5=globalThis.WebGLBuffer||function(){};class Bh extends Wu{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&SH(e,r),s=s&&(!i||MH(e,r))),s}constructor(e,n){const{id:r=Qc("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(ne=>this.initialize(Object.assign({},e,{pixels:ne,data:ne}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:A=0,recreate:a=!1,parameters:y={},pixelStore:w={},textureUnit:P=void 0}=e;n||(n=i);let{width:I,height:L,dataFormat:U,type:W,compressed:q=!1,mipmaps:ae=!0}=e;const{depth:K=0}=e;return{width:I,height:L,compressed:q,dataFormat:U,type:W}=this._deduceParameters({format:s,type:W,dataFormat:U,compressed:q,data:n,width:I,height:L}),this.width=I,this.height=L,this.depth=K,this.format=s,this.type=W,this.dataFormat=U,this.border=A,this.textureUnit=P,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),ae&&this._isNPOT()&&(_n.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),ae=!1,this._updateForNPOT(y)),this.mipmaps=ae,this.setImageData({data:n,width:I,height:L,depth:K,format:s,type:W,dataFormat:U,border:A,mipmaps:ae,parameters:w,compressed:q}),ae&&this.generateMipmap(),this.setParameters(y),a&&(this.data=n),r&&(this._video={video:n,parameters:y,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(_n.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Ql(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:A=this.border,offset:a=0,parameters:y={}}=e;let{data:w=null,type:P=this.type,width:I=this.width,height:L=this.height,dataFormat:U=this.dataFormat,compressed:W=!1}=e;w||(w=r),{type:P,dataFormat:U,compressed:W,width:I,height:L}=this._deduceParameters({format:s,type:P,dataFormat:U,compressed:W,data:w,width:I,height:L});const{gl:q}=this;q.bindTexture(this.target,this.handle);let ae=null;({data:w,dataType:ae}=this._getDataType({data:w,compressed:W}));let K,ne=0;if(Ql(this.gl,y,()=>{switch(ae){case"null":q.texImage2D(n,i,s,I,L,A,U,P,w);break;case"typed-array":q.texImage2D(n,i,s,I,L,A,U,P,w,a);break;case"buffer":K=to(q),K.bindBuffer(35052,w.handle||w),K.texImage2D(n,i,s,I,L,A,U,P,a),K.bindBuffer(35052,null);break;case"browser-object":lr(q)?q.texImage2D(n,i,s,I,L,A,U,P,w):q.texImage2D(n,i,s,U,P,w);break;case"compressed":for(const[ie,fe]of w.entries())q.compressedTexImage2D(n,ie,fe.format,fe.width,fe.height,A,fe.data),ne+=fe.levelSize;break;default:tn(!1,"Unknown image data type")}}),ae==="compressed")this._trackAllocatedMemory(ne,"Texture");else if(w&&w.byteLength)this._trackAllocatedMemory(w.byteLength,"Texture");else{const ie=zD[this.dataFormat]||4,fe=OD[this.type]||1;this._trackAllocatedMemory(this.width*this.height*ie*fe,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:A=0,width:a=this.width,height:y=this.height,level:w=0,format:P=this.format,type:I=this.type,dataFormat:L=this.dataFormat,compressed:U=!1,offset:W=0,border:q=this.border,parameters:ae={}}=e;if({type:I,dataFormat:L,compressed:U,width:a,height:y}=this._deduceParameters({format:P,type:I,dataFormat:L,compressed:U,data:i,width:a,height:y}),tn(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const K=i;i=K.data,a=K.shape[0],y=K.shape[1]}i instanceof Br&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Ql(this.gl,ae,()=>{if(U)this.gl.compressedTexSubImage2D(n,w,s,A,a,y,P,i);else if(i===null)this.gl.texSubImage2D(n,w,s,A,a,y,L,I,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,w,s,A,a,y,L,I,i,W);else if(i instanceof J5){const K=to(this.gl);K.bindBuffer(35052,i),K.texSubImage2D(n,w,s,A,a,y,L,I,W),K.bindBuffer(35052,null)}else lr(this.gl)?to(this.gl).texSubImage2D(n,w,s,A,a,y,L,I,i):this.gl.texSubImage2D(n,w,s,A,L,I,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return _n.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof Br?{data:n.handle,dataType:"buffer"}:n instanceof J5?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:A,type:a,compressed:y}=e;const w=KE[n];return A=A||w&&w.dataFormat,a=a||w&&w.types[0],y=y||w&&w.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:A,type:a,compressed:y,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},tn(i,"Could not deduced texture size"),tn(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),tn(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:tn(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return lr(this.gl)||!this.width||!this.height?!1:!X5(this.width)||!X5(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:CH.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let PH="";function IH(t,e){return tn(typeof t=="string"),t=PH+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class Jo extends Bh{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Bh.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};A2(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:IH(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const Eb=[34069,34070,34071,34072,34073,34074];class FD extends Bh{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};A2(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:A=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:A})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:A=0,format:a=6408,type:y=5121}=e;const{gl:w}=this,P=i||s,I=await Promise.all(Eb.map(L=>{const U=P[L];return Promise.all(Array.isArray(U)?U:[U])}));this.bind(),Eb.forEach((L,U)=>{I[U].length>1&&this.opts.mipmaps!==!1&&_n.warn("".concat(this.id," has mipmap and multiple LODs."))(),I[U].forEach((W,q)=>{n&&r?w.texImage2D(L,q,a,n,r,A,a,y,W):w.texImage2D(L,q,a,a,y,W)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:A,border:a=0,format:y=6408,type:w=5121}=e,{gl:P}=this,I=s||A;return this.bind(),I instanceof Promise?I.then(L=>this.setImageDataForFace(Object.assign({},e,{face:n,data:L,pixels:L}))):this.width||this.height?P.texImage2D(n,0,y,r,i,a,y,w,I):P.texImage2D(n,0,y,y,w,I),this}}FD.FACES=Eb;class kH extends Bh{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return lr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};to(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:A=1,border:a=0,format:y,type:w=5121,offset:P=0,data:I,parameters:L={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Ql(this.gl,L,()=>{ArrayBuffer.isView(I)&&this.gl.texImage3D(this.target,n,r,i,s,A,a,y,w,I),I instanceof Br&&(this.gl.bindBuffer(35052,I.handle),this.gl.texImage3D(this.target,n,r,i,s,A,a,y,w,P))}),I&&I.byteLength)this._trackAllocatedMemory(I.byteLength,"Texture");else{const U=zD[this.dataFormat]||4,W=OD[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*U*W,"Texture")}return this.loaded=!0,this}}const lh="EXT_color_buffer_float",eC={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:lh,bpp:2},33327:{gl2:lh,bpp:4},34842:{gl2:lh,bpp:8},33326:{gl2:lh,bpp:4},33328:{gl2:lh,bpp:8},34836:{gl2:lh,bpp:16},35898:{gl2:lh,bpp:4}};function LH(t,e,n){const r=n[e];if(!r)return!1;const i=lr(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class Qf extends Wu{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||LH(e,n,eC)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return tn(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&lr(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*eC[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const DH=256,RH=1024,BH=16384,tC=6144,nC=6145,rC=6146,iC=34041,ND="clear: bad arguments";function JE(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let A=0;n&&(A|=BH,n!==!0&&(s.clearColor=n)),r&&(A|=DH,r!==!0&&(s.clearDepth=r)),i&&(A|=RH,r!==!0&&(s.clearStencil=r)),tn(A!==0,ND),Ql(t,s,()=>{t.clear(A)})}function zH(t){let{framebuffer:e=null,buffer:n=tC,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};to(t),Ql(t,{framebuffer:e},()=>{switch(n){case tC:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case nC:t.clearBufferfv(nC,0,[i]);break;case rC:t.clearBufferiv(rC,0,[i]);break;case iC:const[s,A]=i;t.clearBufferfi(iC,0,s,A);break;default:tn(!1,ND)}})}function OH(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return tn(!1),0}}function u2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:A=null,sourceWidth:a,sourceHeight:y,sourceType:w}=e;const{framebuffer:P,deleteFramebuffer:I}=UD(t);tn(P);const{gl:L,handle:U,attachments:W}=P;a=a||P.width,y=y||P.height,s===36064&&U===null&&(s=1028),tn(W[s]),w=w||W[s].type,A=NH(A,w,i,a,y),w=w||wb(A);const q=L.bindFramebuffer(36160,U);return L.readPixels(n,r,a,y,i,w,A),L.bindFramebuffer(36160,q||null),I&&P.delete(),A}function sC(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=u2(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=xH({data:r,width:i,height:s}));vH({data:r,width:i,height:s});const A=document.createElement("canvas");A.width=i,A.height=s;const a=A.getContext("2d"),y=a.createImageData(i,s);return y.data.set(r),a.putImageData(y,0,0),A.toDataURL()}function FH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:A=6408}=n;let{targetX:a,targetY:y,targetZ:w,width:P,height:I}=n;const{framebuffer:L,deleteFramebuffer:U}=UD(t);tn(L);const{gl:W,handle:q}=L,ae=typeof a<"u"||typeof y<"u"||typeof w<"u";a=a||0,y=y||0,w=w||0;const K=W.bindFramebuffer(36160,q);tn(e);let ne=null;if(e instanceof Bh&&(ne=e,P=Number.isFinite(P)?P:ne.width,I=Number.isFinite(I)?I:ne.height,ne.bind(0),e=ne.target),!ae)W.copyTexImage2D(e,s,A,r,i,P,I,0);else switch(e){case 3553:case 34067:W.copyTexSubImage2D(e,s,a,y,r,i,P,I);break;case 35866:case 32879:to(W).copyTexSubImage3D(e,s,a,y,w,r,i,P,I);break}return ne&&ne.unbind(),W.bindFramebuffer(36160,K||null),U&&L.delete(),ne}function UD(t){return t instanceof Zi?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:qH(t),deleteFramebuffer:!0}}function NH(t,e,n,r,i){if(t)return t;e=e||5121;const s=Jp(e,{clamped:!1}),A=OH(n);return new s(r*i*A)}const Qr={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function UH(t){const e=new Jo(t,{format:6408,type:5126,dataFormat:6408}),n=new Zi(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const VD={[Qr.WEBGL2]:[!1,!0],[Qr.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Qr.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Qr.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Qr.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Qr.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Qr.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Qr.FLOAT_BLEND]:["EXT_float_blend"],[Qr.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Qr.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Qr.TEXTURE_FLOAT]:["OES_texture_float",!0],[Qr.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Qr.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Qr.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Qr.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Qr.COLOR_ATTACHMENT_RGBA32F]:[UH,"EXT_color_buffer_float"],[Qr.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Qr.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Qr.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Qr.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Qr.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Qr.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},VH=2;function GD(t,e){return eT(t,e)}function eT(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>jD(t,n))}function GH(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in VD)t.luma.caps[e]===void 0&&(t.luma.caps[e]=jD(t,e));return t.luma.caps}function jD(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=jH(t,e)),t.luma.caps[e]||_n.log(VH,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function jH(t,e){const n=VD[e];tn(n,e);let r;const i=lr(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:tn(!1);return r}const oC="Multiple render targets not supported";class Zi extends Wu{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Zi(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=to(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=to(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:A=!0,stencil:a=!1,check:y=!0,readBuffer:w=void 0,drawBuffers:P=void 0}=e;if(tn(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const I in i){const L=i[I];(Array.isArray(L)?L[0]:L).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,A,a,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:w,drawBuffers:P}),i&&y&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:A=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:A});const{gl:a}=this,y=a.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),a.bindFramebuffer(36160,y||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return tn(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&_n.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(A=>{i[A]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const A in i){tn(A!==void 0,"Misspelled framebuffer binding point?");const a=Number(A),y=i[a];let w=y;if(!w)this._unattach(a);else if(w instanceof Qf)this._attachRenderbuffer({attachment:a,renderbuffer:w});else if(Array.isArray(y)){const[P,I=0,L=0]=y;w=P,this._attachTexture({attachment:a,texture:P,layer:I,level:L})}else this._attachTexture({attachment:a,texture:w,layer:0,level:0});r&&w&&w.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(A=>!this.attachments[A]).forEach(A=>{delete this.attachments[A]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(HH(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,A=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&JE(this.gl,{color:n,depth:r,stencil:i}),s.forEach((a,y)=>{zH(this.gl,{drawBuffer:y,value:a})}),this.gl.bindFramebuffer(36160,A||null),this}readPixels(){return _n.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return _n.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return _n.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return _n.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return _n.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return _n.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:A}=e;const a=to(this.gl),y=a.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&A===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,r,i,s,A),a.bindFramebuffer(36008,y),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=Uc(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const A=n?Uc(this.gl,s):s;i[A]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),A=e?Uc(this.gl,s):s;r[A]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(sC(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>_n.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=sC(this,{targetMaxHeight:100});return _n.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let A=null;return e&&(A=A||{},A[36064]=new Jo(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(A[36064])),n&&r?(A=A||{},A[33306]=new Qf(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(A[33306])):n?(A=A||{},A[36096]=new Qf(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(A[36096])):r&&tn(!1),A}_unattach(e){const n=this.attachments[e];n&&(n instanceof Qf?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:A}=this;switch(A.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:to(A).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const y=$H(i);A.framebufferTexture2D(36160,n,y,r.handle,s);break;case 3553:A.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:tn(!1,"Illegal texture type")}A.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=y$(this.gl);n?n.readBuffer(e):tn(e===36064||e===1029,oC),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=to(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):tn(e.length===1&&(e[0]===36064||e[0]===1029),oC)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=GH(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function $H(t){return t<34069?t+34069:t}function HH(t){return(Zi.STATUS||{})[t]||"Framebuffer error ".concat(t)}const WH=[36049,36048,33296,33298,33299,33300,33301,33302,33303];Zi.ATTACHMENT_PARAMETERS=WH;function QH(t,e){tn(t instanceof Jo||t instanceof FD||t instanceof kH);const n=t.constructor,{gl:r,width:i,height:s,format:A,type:a,dataFormat:y,border:w,mipmaps:P}=t,I=Object.assign({width:i,height:s,format:A,type:a,dataFormat:y,border:w,mipmaps:P},e);return new n(r,I)}function qH(t,e){const{gl:n,width:r,height:i,id:s}=t;return new Zi(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{36064:t}}))}function V1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const ZH=35632,YH=35633;function XH(t){switch(t){case ZH:return"fragment";case YH:return"vertex";default:return"unknown type"}}function KH(t,e,n,r){const i=t.split(/\r?\n/),s={},A={},a=r||V1(e)||"(unnamed)",y="".concat(XH(n)," shader ").concat(a);for(let P=0;P<i.length;P++){const I=i[P];if(I.length<=1)continue;const L=I.split(":"),U=L[0],W=parseInt(L[2],10);if(isNaN(W))throw new Error("GLSL compilation error in ".concat(y,": ").concat(t));U!=="WARNING"?s[W]=I:A[W]=I}const w=JH(e);return{shaderName:y,errors:aC(s,w),warnings:aC(A,w)}}function aC(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],A=s.split(":",3),a=A[0],y=parseInt(A[1],10)||0,w=s.substring(A.join(":").length+1).trim();n+=$D("^^^ ".concat(a,": ").concat(w,`

`),y)}}return n}function JH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,A)=>{const a=String(A+e),y=a.length;return $D(a,i-y)+n+s})}function $D(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function HD(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const eW="Shader: GLSL source code must be a JavaScript string";class eg extends Wu{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return tn(!1),"unknown"}}constructor(e,n){A2(e),tn(typeof n.source=="string",eW);const r=V1(n.source,null)||n.id||Qc("unnamed ".concat(eg.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=V1(n,null);r&&(this.id=Qc(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(eg.getTypeName(this.shaderType),":").concat(this.id)}getName(){return V1(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:A}=KH(r,this.source,this.shaderType,this.id);throw _n.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),_n.warn("GLSL compilation warnings in ".concat(i,`
`).concat(A))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class cx extends eg{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class hx extends eg{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const tW={5126:ei.bind(null,"uniform1fv",ma,1,$s),35664:ei.bind(null,"uniform2fv",ma,2,$s),35665:ei.bind(null,"uniform3fv",ma,3,$s),35666:ei.bind(null,"uniform4fv",ma,4,$s),5124:ei.bind(null,"uniform1iv",fc,1,$s),35667:ei.bind(null,"uniform2iv",fc,2,$s),35668:ei.bind(null,"uniform3iv",fc,3,$s),35669:ei.bind(null,"uniform4iv",fc,4,$s),35670:ei.bind(null,"uniform1iv",fc,1,$s),35671:ei.bind(null,"uniform2iv",fc,2,$s),35672:ei.bind(null,"uniform3iv",fc,3,$s),35673:ei.bind(null,"uniform4iv",fc,4,$s),35674:ei.bind(null,"uniformMatrix2fv",ma,4,hu),35675:ei.bind(null,"uniformMatrix3fv",ma,9,hu),35676:ei.bind(null,"uniformMatrix4fv",ma,16,hu),35678:xs,35680:xs,5125:ei.bind(null,"uniform1uiv",Vm,1,$s),36294:ei.bind(null,"uniform2uiv",Vm,2,$s),36295:ei.bind(null,"uniform3uiv",Vm,3,$s),36296:ei.bind(null,"uniform4uiv",Vm,4,$s),35685:ei.bind(null,"uniformMatrix2x3fv",ma,6,hu),35686:ei.bind(null,"uniformMatrix2x4fv",ma,8,hu),35687:ei.bind(null,"uniformMatrix3x2fv",ma,6,hu),35688:ei.bind(null,"uniformMatrix3x4fv",ma,12,hu),35689:ei.bind(null,"uniformMatrix4x2fv",ma,8,hu),35690:ei.bind(null,"uniformMatrix4x3fv",ma,12,hu),35678:xs,35680:xs,35679:xs,35682:xs,36289:xs,36292:xs,36293:xs,36298:xs,36299:xs,36300:xs,36303:xs,36306:xs,36307:xs,36308:xs,36311:xs},nW={},rW={},iW={},lC=[0];function tT(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(lC[0]=t,t=lC);const i=t.length;if(i%e&&_n.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let A=0;A<i;A++)s[A]=t[A];return s}function ma(t,e){return tT(t,e,Float32Array,nW)}function fc(t,e){return tT(t,e,Int32Array,rW)}function Vm(t,e){return tT(t,e,Uint32Array,iW)}function AC(t,e,n){const r=tW[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function sW(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function oW(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!aW(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function aW(t){return Array.isArray(t)||ArrayBuffer.isView(t)?AW(t):isFinite(t)||t===!0||t===!1||t instanceof Bh||t instanceof Qf?!0:t instanceof Zi?!!t.texture:!1}function lW(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function AW(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function xs(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function ei(t,e,n,r){let i=null,s=null;return(A,a,y)=>{const w=e(y,n),P=w.length;let I=!1;if(i===null)i=new Float32Array(P),s=P,I=!0;else{tn(s===P,"Uniform length cannot change.");for(let L=0;L<P;++L)if(w[L]!==i[L]){I=!0;break}}return I&&(r(A,t,a,w),i.set(w)),I}}function $s(t,e,n,r){t[e](n,r)}function hu(t,e,n,r){t[e](n,!1,r)}const uW=5120,cW=5121,hW=5122,fW=5123,uC=0,Gm=1,dW=2,pW=3,jm=4,gW=5,mW=6,Wi=5126,yW=35664,_W=35665,vW=35666,Od=5124,xW=35667,wW=35668,bW=35669,Fd=5125,EW=36294,TW=36295,SW=36296,MW=35670,CW=35671,PW=35672,IW=35673,kW=35674,LW=35675,DW=35676,RW=35685,BW=35686,zW=35687,OW=35688,FW=35689,NW=35690,Tb={[Wi]:[Wi,1,"float"],[yW]:[Wi,2,"vec2"],[_W]:[Wi,3,"vec3"],[vW]:[Wi,4,"vec4"],[Od]:[Od,1,"int"],[xW]:[Od,2,"ivec2"],[wW]:[Od,3,"ivec3"],[bW]:[Od,4,"ivec4"],[Fd]:[Fd,1,"uint"],[EW]:[Fd,2,"uvec2"],[TW]:[Fd,3,"uvec3"],[SW]:[Fd,4,"uvec4"],[MW]:[Wi,1,"bool"],[CW]:[Wi,2,"bvec2"],[PW]:[Wi,3,"bvec3"],[IW]:[Wi,4,"bvec4"],[kW]:[Wi,8,"mat2"],[RW]:[Wi,8,"mat2x3"],[BW]:[Wi,8,"mat2x4"],[LW]:[Wi,12,"mat3"],[zW]:[Wi,12,"mat3x2"],[OW]:[Wi,12,"mat3x4"],[DW]:[Wi,16,"mat4"],[FW]:[Wi,16,"mat4x2"],[NW]:[Wi,16,"mat4x3"]};function UW(t){switch(t){case uC:return uC;case Gm:return Gm;case pW:return Gm;case dW:return Gm;case jm:return jm;case gW:return jm;case mW:return jm;default:return tn(!1),0}}function cC(t){const e=Tb[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function WD(t,e){switch(t){case uW:case cW:case hW:case fW:t=Wi;break}for(const n in Tb){const[r,i,s]=Tb[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class VW{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:A,size:a}=n.getActiveAttrib(e.handle,i),y=n.getAttribLocation(e.handle,s);y>=0&&this._addAttribute(y,s,A,a)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!lr(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:A,size:a}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,A,a)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:A}=cC(r),a={type:s,size:i*A};this._inferProperties(e,n,a);const y={location:e,name:n,accessor:new xa(a)};this.attributeInfos.push(y),this.attributeInfosByLocation[e]=y,this.attributeInfosByName[y.name]=y}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:A}=cC(r),a=new xa({type:s,size:i*A}),y={location:e,name:n,accessor:a};this.varyingInfos.push(y),this.varyingInfosByName[y.name]=y}}const hC=4,GW=35981,jW=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class QD extends Wu{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",jW),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:A=GW}=e;return this.hash=n||"",this.vs=typeof r=="string"?new cx(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new hx(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,tn(this.vs instanceof cx),tn(this.fs instanceof hx),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(to(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,A)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new VW(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:A,end:a,isIndexed:y=!1,indexType:w=5123,instanceCount:P=0,isInstanced:I=P>0,vertexArray:L=null,transformFeedback:U,framebuffer:W,parameters:q={},uniforms:ae,samplers:K}=e;if((ae||K)&&(_n.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(ae||{})),_n.priority>=n){const ne=W?W.id:"default",ie="mode=".concat(Uc(this.gl,r)," verts=").concat(i," ")+"instances=".concat(P," indexType=").concat(Uc(this.gl,w)," ")+"isInstanced=".concat(I," isIndexed=").concat(y," ")+"Framebuffer=".concat(ne);_n.log(n,ie)()}return tn(L),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||I&&P===0?!1:(L.bindForDraw(i,P,()=>{if(W!==void 0&&(q=Object.assign({},q,{framebuffer:W})),U){const ne=UW(r);U.begin(ne)}this._bindTextures(),Ql(this.gl,q,()=>{y&&I?this.gl2.drawElementsInstanced(r,i,w,s,P):y&&lr(this.gl)&&!isNaN(A)&&!isNaN(a)?this.gl2.drawRangeElements(r,A,a,i,w,s):y?this.gl.drawElements(r,i,w,s):I?this.gl2.drawArraysInstanced(r,s,i,P):this.gl.drawArrays(r,s,i)}),U&&U.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_n.priority>=2&&oW(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,A=!1;if(s instanceof Zi&&(s=s.texture),s instanceof Bh)if(A=this.uniforms[n]!==r,A){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:y}=i;a.bind(y),s=y,this._textureUniforms[n]=a}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||A)&&lW(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new cx({handle:i});break;case 35632:r.fs=new hx({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Qc(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),_n.time(hC,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),_n.timeEnd(hC,"linkProgram for ".concat(this._getName()))(),e.debug||_n.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=sW(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=AC(e,s,r),r.size>1)for(let A=0;A<r.size;A++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(A,"]")),this._uniformSetters["".concat(i,"[").concat(A,"]")]=AC(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const $W=34918,HW=34919,WW=35007,QW=36795,qW=35976,ZW=35887,YW=36202;class $y extends Wu{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=lr(e),i=eT(e,Qr.TIMER_QUERY);let s=r||i;for(const A of n)switch(A){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:tn(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(WW)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?YW:ZW)}beginTransformFeedbackQuery(){return this.begin(qW)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,HW);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(QW)}getResult(){return this.gl2.getQueryParameter(this.handle,$W)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return $y.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class qD extends Wu{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return lr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};to(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,R0(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:A}=this._getBufferParams(n);return r<0?(this.unused[e]=i,_n.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,A,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof Br?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let $m=null;function XW(t){return(!$m||$m.byteLength<t)&&($m=new ArrayBuffer(t)),$m}function KW(t,e){const n=XW(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function JW(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,A=i*s;let a=0;for(let y=r;a<s;a++)e[y++]=n[a];for(;a<A;)a<A-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+A-a),a=A);return e}const eQ="elements must be GL.ELEMENT_ARRAY_BUFFER";class _a extends Wu{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?lr(e)||dH()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new _a(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return _a.MAX_ATTRIBUTES=_a.MAX_ATTRIBUTES||e.getParameter(34921),_a.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:_a._setConstantFloatArray(e,n,r);break;case Int32Array:_a._setConstantIntArray(e,n,r);break;case Uint32Array:_a._setConstantUintArray(e,n,r);break;default:tn(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return _a.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return tn(!e||e.target===34963,eQ),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:A,offset:a,normalized:y,integer:w,divisor:P}=r,{gl:I,gl2:L}=this;return e=Number(e),this.bind(()=>{I.bindBuffer(34962,n.handle),w?(tn(lr(I)),L.vertexAttribIPointer(e,i,s,A,a)):I.vertexAttribPointer(e,i,s,y,A,a),I.enableVertexAttribArray(e),L.vertexAttribDivisor(e,P||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!_a.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let A=!this.buffer;if(this.buffer=this.buffer||new Br(this.gl,i),A=A||this.buffer.reallocate(i),A=A||!this._compareConstantArrayValues(r,this.bufferValue),A){const a=KW(n.constructor,s);JW({target:a,source:r,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:tn(!1)}}static _setConstantIntArray(e,n,r){switch(tn(lr(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:tn(!1)}}static _setConstantUintArray(e,n,r){switch(tn(lr(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:tn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return tn(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const tQ="VertexArray: attributes must be Buffers or constants (i.e. typed array)",nQ=/^(.+)__LOCATION_([0-9]+)$/,rQ=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class iQ{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new _a(e),RD(this,"VertexArray","v6.0",rQ),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Br(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Br&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof Br&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:A,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(A)||A<0)return this.unused[e]=n,_n.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const y=this._getAttributeInfo(a||A);if(!y)return s;const w=this.accessors[A]||{},P=xa.resolve(y.accessor,w,r,i),{size:I,type:L}=P;return tn(Number.isFinite(I)&&Number.isFinite(L)),{location:A,accessor:P}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=nQ.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof Br)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof Br){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof Br){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(tQ)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(_a.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){_a.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,A=s>0;if(e.isInstanced=e.isInstanced||A,r instanceof Br){const a=r;if(A){const y=a.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,y)}else{const y=a.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,y)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _n.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function sQ(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let A=0;A<t.length&&A<n;++A)A>0&&(i+=",".concat(A%r===0?" ":"")),i+=tg(t[A],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function tg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return sQ(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function fC(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;tn(n);const s=".*_.*",A=".*Matrix",a=n._uniformSetters,y={},w=Object.keys(a).sort();let P=0;for(const U of w)!U.match(s)&&!U.match(A)&&fx({table:y,header:e,uniforms:r,uniformName:U,undefinedOnly:i})&&P++;for(const U of w)U.match(A)&&fx({table:y,header:e,uniforms:r,uniformName:U,undefinedOnly:i})&&P++;for(const U of w)y[U]||fx({table:y,header:e,uniforms:r,uniformName:U,undefinedOnly:i})&&P++;let I=0;const L={};if(!i)for(const U in r){const W=r[U];y[U]||(I++,L[U]={Type:"NOT USED: ".concat(W),[e]:tg(W)})}return{table:y,count:P,unusedTable:L,unusedCount:I}}function fx(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const A=r[i],a=oQ(A);return!s||!a?(e[i]={[n]:a?tg(A):"N/A","Uniform Type":a?A:"NOT PROVIDED"},!0):!1}function oQ(t){return t!=null}function aQ(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=dC(e,e.elements,null,n));const i=e.values;for(const s in i){const A=e._getAttributeInfo(s);if(A){let a="".concat(s,": ").concat(A.name);const y=e.accessors[A.location];y&&(a="".concat(s,": ").concat(lQ(A.name,y))),r[a]=dC(e,i[s],y,n)}}return r}function dC(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",A=1,a=0,y=0,w,P,I;if(n&&(s=n.type,A=n.size,s=String(s).replace("Array",""),w=s.indexOf("nt")!==-1),e instanceof Br){const L=e,{data:U,changed:W}=L.getDebugData();P=W?"*":"",I=U,y=L.byteLength,a=y/U.BYTES_PER_ELEMENT/A;let q;if(n){const ae=n.divisor>0;q="".concat(ae?"I ":"P "," ").concat(a," (x").concat(A,"=").concat(y," bytes ").concat(Uc(i,s),")")}else w=!0,q="".concat(y," bytes");return{[r]:"".concat(P).concat(tg(I,{size:A,isInteger:w})),"Format ":q}}return I=e,A=e.length,s=String(e.constructor.name).replace("Array",""),w=s.indexOf("nt")!==-1,{[r]:"".concat(tg(I,{size:A,isInteger:w})," (constant)"),"Format ":"".concat(A,"x").concat(s," (constant)")}}function lQ(t,e){const{type:n,size:r}=e,i=WD(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function AQ(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=pC(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=pC(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function pC(t){const{type:e,size:n}=t.accessor,r=WD(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}function uQ(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function cQ(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||uQ()}const gC=cQ()&&typeof document<"u";let hQ=0;class fQ{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=ae=>kD(ae),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:A=()=>{},onError:a,gl:y=null,glOptions:w={},debug:P=!1,createFramebuffer:I=!1,autoResizeViewport:L=!0,autoResizeDrawingBuffer:U=!0,stats:W=bh.get("animation-loop-".concat(hQ++))}=e;let{useDevicePixels:q=!0}=e;"useDevicePixelRatio"in e&&(_n.deprecated("useDevicePixelRatio","useDevicePixels")(),q=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:A,onError:a,gl:y,glOptions:w,debug:P,createFramebuffer:I},this.gl=y,this.needsRedraw=null,this.timeline=null,this.stats=W,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:L,autoResizeDrawingBuffer:U,useDevicePixels:q}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return tn(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=$y.isSupported(this.gl,["timers"])?new $y(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return _n.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=gC?new Promise((e,n)=>{if(gC&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):yH(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):mH(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?XE(this.props.gl,e):this.onCreateContext(e),!l2(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");nH(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&aH(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Zi(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Fg="vs",nT="fs";function Sa(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const dx={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function dQ(t){const e={};for(const n in t){const r=t[n],i=pQ(r);e[n]=i}return e}function pQ(t){let e=mC(t);return e==="object"?t?"type"in t?Object.assign({},t,dx[t.type]):"value"in t?(e=mC(t.value),Object.assign({type:e},t,dx[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},dx[e])}function mC(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const gQ="vs",mQ="fs";class yC{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:A,getUniforms:a,deprecations:y=[],defines:w={},inject:P={},vertexShader:I,fragmentShader:L}=e;Sa(typeof n=="string"),this.name=n,this.vs=r||I,this.fs=i||L,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(y),this.defines=w,this.injections=yQ(P),A&&(this.uniforms=dQ(A))}getModuleSource(e){let n;switch(e){case gQ:n=this.vs||"";break;case mQ:n=this.fs||"";break;default:Sa(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&Sa(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function yQ(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function _Q(t){return vQ(YD(t))}function vQ(t){const e={},n={};return ZD({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function ZD(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&ZD({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function YD(t,e){return t.map(n=>(n instanceof yC||(Sa(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Sa(n.name,"shader module has no name"),n=new yC(n),n.dependencies=YD(n.dependencies)),n))}function xQ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const wQ=7936,bQ=7937,EQ=7938,TQ=35724,rT={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},mh={};Object.keys(rT).forEach(t=>{mh[t]=t});function SQ(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function MQ(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||wQ),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||bQ);return{gpuVendor:CQ(n,r),vendor:n,renderer:r,version:t.getParameter(EQ),shadingLanguageVersion:t.getParameter(TQ)}}function CQ(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const px={};function _C(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=rT[e];if(Sa(r,e),!xQ(n))return!0;if(e in px)return px[e];const i=r[0],s=n.behavior||"enable",A="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,A),t.compileShader(a);const y=t.getShaderParameter(a,35713);return t.deleteShader(a),px[e]=y,y}function PQ(t,e){const n=rT[e];Sa(n,e);const r=SQ(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return Sa(i===!1||i===!0),i}function Hm(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>PQ(t,n))}function IQ(t){switch(MQ(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function kQ(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return Hm(t,mh.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),Hm(t,mh.GLSL_DERIVATIVES)&&_C(t,mh.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),Hm(t,mh.GLSL_FRAG_DATA)&&_C(t,mh.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),Hm(t,mh.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const LQ=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,DQ=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,RQ={[Fg]:LQ,[nT]:DQ},G1="__LUMA_INJECT_DECLARATIONS__",vC=/void\s+main\s*\([^)]*\)\s*\{\n?/,xC=/}\n?[^{}]*$/,gx=[];function wC(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Fg;for(const s in n){const A=n[s];A.sort((y,w)=>y.order-w.order),gx.length=A.length;for(let y=0,w=A.length;y<w;++y)gx[y]=A[y].injection;const a="".concat(gx.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(G1,a));break;case"vs:#main-start":i&&(t=t.replace(vC,y=>y+a));break;case"vs:#main-end":i&&(t=t.replace(xC,y=>a+y));break;case"fs:#decl":i||(t=t.replace(G1,a));break;case"fs:#main-start":i||(t=t.replace(vC,y=>y+a));break;case"fs:#main-end":i||(t=t.replace(xC,y=>a+y));break;default:t=t.replace(s,y=>y+a)}}return t=t.replace(G1,""),r&&(t=t.replace(/\}\s*$/,s=>s+RQ[e])),t}function Sb(t){const e={};return Sa(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function B0(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const XD=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],BQ=[...XD,[B0("attribute"),"in $1"],[B0("varying"),"out $1"]],zQ=[...XD,[B0("varying"),"in $1"]],KD=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],OQ=[...KD,[B0("in"),"attribute $1"],[B0("out"),"varying $1"]],FQ=[...KD,[B0("in"),"varying $1"]],Mb="gl_FragColor",Cb=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,NQ=/void\s+main\s*\([^)]*\)\s*\{\n?/;function UQ(t,e,n){switch(e){case 300:return n?Hy(t,BQ):VQ(t);case 100:return n?Hy(t,OQ):GQ(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Hy(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function VQ(t){t=Hy(t,zQ);const e=t.match(Cb);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(Mb,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(NQ,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(Mb,"\\b"),"g"),n)}return t}function GQ(t){t=Hy(t,FQ);const e=t.match(Cb);if(e){const n=e[1];t=t.replace(Cb,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),Mb)}return t}const jQ=`

`.concat(G1,`

`),JD={[Fg]:"vertex",[nT]:"fragment"},$Q=`precision highp float;

`;function HQ(t,e){const{vs:n,fs:r}=e,i=_Q(e.modules||[]);return{gl:t,vs:bC(t,Object.assign({},e,{source:n,type:Fg,modules:i})),fs:bC(t,Object.assign({},e,{source:r,type:nT,modules:i})),getUniforms:WQ(i)}}function bC(t,e){let{id:n,source:r,type:i,modules:s,defines:A={},hookFunctions:a=[],inject:y={},transpileToGLSL100:w=!1,prologue:P=!0,log:I}=e;Sa(typeof r=="string","shader source must be a string");const L=i===Fg,U=r.split(`
`);let W=100,q="",ae=r;U[0].indexOf("#version ")===0?(W=300,q=U[0],ae=U.slice(1).join(`
`)):q="#version ".concat(W);const K={};s.forEach(He=>{Object.assign(K,He.getDefines())}),Object.assign(K,A);let ne=P?"".concat(q,`
`).concat(qQ({id:n,source:r,type:i}),`
`).concat(QQ({type:i}),`
`).concat(IQ(t),`
`).concat(kQ(t),`
`).concat(ZQ(K),`
`).concat(L?"":$Q,`
`):"".concat(q,`
`);const ie=XQ(a),fe={},ye={},Me={};for(const He in y){const Qe=typeof y[He]=="string"?{injection:y[He],order:0}:y[He],Je=He.match(/^(v|f)s:(#)?([\w-]+)$/);if(Je){const tt=Je[2],Ne=Je[3];tt?Ne==="decl"?ye[He]=[Qe]:Me[He]=[Qe]:fe[He]=[Qe]}else Me[He]=[Qe]}for(const He of s){I&&He.checkDeprecations(ae,I);const Qe=He.getModuleSource(i,W);ne+=Qe;const Je=He.injections[i];for(const tt in Je){const Ne=tt.match(/^(v|f)s:#([\w-]+)$/);if(Ne){const qe=Ne[2]==="decl"?ye:Me;qe[tt]=qe[tt]||[],qe[tt].push(Je[tt])}else fe[tt]=fe[tt]||[],fe[tt].push(Je[tt])}}return ne+=jQ,ne=wC(ne,i,ye),ne+=YQ(ie[i],fe),ne+=ae,ne=wC(ne,i,Me),ne=UQ(ne,w?100:W,L),ne}function WQ(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function QQ(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(JD[e].toUpperCase(),`
`)}function qQ(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(JD[r],`

`):""}function ZQ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function YQ(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((A,a)=>A.order-a.order);for(const A of s)n+="  ".concat(A.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function XQ(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),A=n.replace(/\(.+/,"");e[i][A]=Object.assign(r,{signature:s})}),e}const KQ="void main() {gl_FragColor = vec4(0);}",eR=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,JQ=`#version 300 es
`.concat(eR);function tR(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const A=s.split(";")[0];return{qualifier:r,type:i,name:A}}function nR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?JQ:e>300?"#version ".concat(e,`
`).concat(eR):KQ;const s=nq(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function eq(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Sa(!1),null}}function tq(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Sa(!1),null}}function nq(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Sa(!1),null}}const rq=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,iq={name:"fp32",vs:rq,fs:null};function ng(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const bo={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function sq(t,{precision:e=bo.precision}={}){return t=oq(t),"".concat(parseFloat(t.toPrecision(e)))}function zh(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Cc(t,e,n){return lq(t,r=>Math.max(e,Math.min(n,r)))}function kA(t,e,n){return zh(t)?t.map((r,i)=>kA(r,e[i],n)):n*e+(1-n)*t}function Cu(t,e,n){const r=bo.EPSILON;n&&(bo.EPSILON=n);try{if(t===e)return!0;if(zh(t)&&zh(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Cu(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=bo.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{bo.EPSILON=r}}function oq(t){return Math.round(t/bo.EPSILON)*bo.EPSILON}function aq(t){return t.clone?t.clone():new Array(t.length)}function lq(t,e,n){if(zh(t)){const r=t;n=n||aq(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function Aq(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class iT extends Aq(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:zh(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(bo)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+sq(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Cu(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(bo.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function uq(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ur(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Pp(t,e,n=""){if(bo.debug&&!uq(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class rR extends iT{get x(){return this[0]}set x(e){this[0]=Ur(e)}get y(){return this[1]}set y(e){this[1]=Ur(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return Ur(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Ur(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return ng(e>=0&&e<this.ELEMENTS,"index is out of range"),Ur(this[e])}setComponent(e,n){return ng(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var Ip=1e-6,Zl=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function cq(){var t=new Zl(2);return Zl!=Float32Array&&(t[0]=0,t[1]=0),t}function Pb(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function hq(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function fq(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function dq(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function pq(t,e){return t[0]=-e[0],t[1]=-e[1],t}function iR(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function gq(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function mq(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var yq=hq;(function(){var t=cq();return function(e,n,r,i,s,A){var a,y;for(n||(n=2),r||(r=0),i?y=Math.min(i*n+r,e.length):y=e.length,a=r;a<y;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,A),e[a]=t[0],e[a+1]=t[1];return e}})();function _q(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function sR(t,e,n){const r=e[0],i=e[1],s=e[2],A=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/A,t[1]=(n[1]*r+n[5]*i+n[9]*s)/A,t[2]=(n[2]*r+n[6]*i+n[10]*s)/A,t}function vq(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function xq(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function oR(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*s,t[1]=n[1]*r+n[4]*i+n[7]*s,t[2]=n[2]*r+n[5]*i+n[8]*s,t[3]=e[3],t}function aR(){var t=new Zl(3);return Zl!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function wq(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function EC(t,e,n){var r=new Zl(3);return r[0]=t,r[1]=e,r[2]=n,r}function bq(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Eq(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function Tq(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Sq(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Mq(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function lR(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function j1(t,e,n){var r=e[0],i=e[1],s=e[2],A=n[0],a=n[1],y=n[2];return t[0]=i*y-s*a,t[1]=s*A-r*y,t[2]=r*a-i*A,t}function Cq(t,e,n,r){var i=e[0],s=e[1],A=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=A+r*(n[2]-A),t}function sT(t,e,n){var r=e[0],i=e[1],s=e[2],A=n[3]*r+n[7]*i+n[11]*s+n[15];return A=A||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/A,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/A,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/A,t}function AR(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function uR(t,e,n){var r=n[0],i=n[1],s=n[2],A=n[3],a=e[0],y=e[1],w=e[2],P=i*w-s*y,I=s*a-r*w,L=r*y-i*a,U=i*L-s*I,W=s*P-r*L,q=r*I-i*P,ae=A*2;return P*=ae,I*=ae,L*=ae,U*=2,W*=2,q*=2,t[0]=a+P+U,t[1]=y+I+W,t[2]=w+L+q,t}function Pq(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Iq(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function kq(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Lq(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],A=e[1],a=e[2],y=Math.sqrt(n*n+r*r+i*i),w=Math.sqrt(s*s+A*A+a*a),P=y*w,I=P&&lR(t,e)/P;return Math.acos(Math.min(Math.max(I,-1),1))}var cR=bq,Dq=Eq,hR=wq,mx=Tq;(function(){var t=aR();return function(e,n,r,i,s,A){var a,y;for(n||(n=3),r||(r=0),i?y=Math.min(i*n+r,e.length):y=e.length,a=r;a<y;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,A),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const yx=[0,0,0];let Wm;class ln extends rR{static get ZERO(){return Wm||(Wm=new ln(0,0,0),Object.freeze(Wm)),Wm}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&zh(e)?this.copy(e):(bo.debug&&(Ur(e),Ur(n),Ur(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return bo.debug&&(Ur(e.x),Ur(e.y),Ur(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Ur(e)}angle(e){return Lq(this,e)}cross(e){return j1(this,this,e),this.check()}rotateX({radians:e,origin:n=yx}){return Pq(this,this,n,e),this.check()}rotateY({radians:e,origin:n=yx}){return Iq(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=yx}){return kq(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return sT(this,this,e),this.check()}transformAsVector(e){return sR(this,this,e),this.check()}transformByMatrix3(e){return AR(this,this,e),this.check()}transformByMatrix2(e){return vq(this,this,e),this.check()}transformByQuaternion(e){return uR(this,this,e),this.check()}}let Qm;class oT extends rR{static get ZERO(){return Qm||(Qm=new oT(0,0,0,0),Object.freeze(Qm)),Qm}constructor(e=0,n=0,r=0,i=0){super(-0,-0,-0,-0),zh(e)&&arguments.length===1?this.copy(e):(bo.debug&&(Ur(e),Ur(n),Ur(r),Ur(i)),this[0]=e,this[1]=n,this[2]=r,this[3]=i)}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return bo.debug&&(Ur(e.x),Ur(e.y),Ur(e.z),Ur(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Ur(e)}get w(){return this[3]}set w(e){this[3]=Ur(e)}transform(e){return sT(this,this,e),this.check()}transformByMatrix3(e){return oR(this,this,e),this.check()}transformByMatrix2(e){return xq(this,this,e),this.check()}transformByQuaternion(e){return uR(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class fR extends iT{toString(){let e="[";if(bo.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Ur(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function Rq(){var t=new Zl(9);return Zl!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Bq(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function zq(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],A=e[4],a=e[5],y=e[6],w=e[7],P=e[8],I=P*A-a*w,L=-P*s+a*y,U=w*s-A*y,W=n*I+r*L+i*U;return W?(W=1/W,t[0]=I*W,t[1]=(-P*r+i*w)*W,t[2]=(a*r-i*A)*W,t[3]=L*W,t[4]=(P*n-i*y)*W,t[5]=(-a*n+i*s)*W,t[6]=U*W,t[7]=(-w*n+r*y)*W,t[8]=(A*n-r*s)*W,t):null}function Oq(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],A=t[5],a=t[6],y=t[7],w=t[8];return e*(w*s-A*y)+n*(-w*i+A*a)+r*(y*i-s*a)}function TC(t,e,n){var r=e[0],i=e[1],s=e[2],A=e[3],a=e[4],y=e[5],w=e[6],P=e[7],I=e[8],L=n[0],U=n[1],W=n[2],q=n[3],ae=n[4],K=n[5],ne=n[6],ie=n[7],fe=n[8];return t[0]=L*r+U*A+W*w,t[1]=L*i+U*a+W*P,t[2]=L*s+U*y+W*I,t[3]=q*r+ae*A+K*w,t[4]=q*i+ae*a+K*P,t[5]=q*s+ae*y+K*I,t[6]=ne*r+ie*A+fe*w,t[7]=ne*i+ie*a+fe*P,t[8]=ne*s+ie*y+fe*I,t}function Fq(t,e,n){var r=e[0],i=e[1],s=e[2],A=e[3],a=e[4],y=e[5],w=e[6],P=e[7],I=e[8],L=n[0],U=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=A,t[4]=a,t[5]=y,t[6]=L*r+U*A+w,t[7]=L*i+U*a+P,t[8]=L*s+U*y+I,t}function Nq(t,e,n){var r=e[0],i=e[1],s=e[2],A=e[3],a=e[4],y=e[5],w=e[6],P=e[7],I=e[8],L=Math.sin(n),U=Math.cos(n);return t[0]=U*r+L*A,t[1]=U*i+L*a,t[2]=U*s+L*y,t[3]=U*A-L*r,t[4]=U*a-L*i,t[5]=U*y-L*s,t[6]=w,t[7]=P,t[8]=I,t}function SC(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Uq(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],A=n+n,a=r+r,y=i+i,w=n*A,P=r*A,I=r*a,L=i*A,U=i*a,W=i*y,q=s*A,ae=s*a,K=s*y;return t[0]=1-I-W,t[3]=P-K,t[6]=L+ae,t[1]=P+K,t[4]=1-w-W,t[7]=U-q,t[2]=L-ae,t[5]=U+q,t[8]=1-w-I,t}var Ib;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(Ib||(Ib={}));const Vq=Object.freeze([1,0,0,0,1,0,0,0,1]);class bs extends fR{static get IDENTITY(){return jq()}static get ZERO(){return Gq()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Ib}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(Vq)}fromObject(e){return this.check()}fromQuaternion(e){return Uq(this,e),this.check()}set(e,n,r,i,s,A,a,y,w){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=A,this[6]=a,this[7]=y,this[8]=w,this.check()}setRowMajor(e,n,r,i,s,A,a,y,w){return this[0]=e,this[1]=i,this[2]=a,this[3]=n,this[4]=s,this[5]=y,this[6]=r,this[7]=A,this[8]=w,this.check()}determinant(){return Oq(this)}transpose(){return Bq(this,this),this.check()}invert(){return zq(this,this),this.check()}multiplyLeft(e){return TC(this,e,this),this.check()}multiplyRight(e){return TC(this,this,e),this.check()}rotate(e){return Nq(this,this,e),this.check()}scale(e){return Array.isArray(e)?SC(this,this,e):SC(this,this,[e,e]),this.check()}translate(e){return Fq(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=gq(n||[-0,-0],e,this);break;case 3:r=AR(n||[-0,-0,-0],e,this);break;case 4:r=oR(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Pp(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let qm,Zm;function Gq(){return qm||(qm=new bs([0,0,0,0,0,0,0,0,0]),Object.freeze(qm)),qm}function jq(){return Zm||(Zm=new bs,Object.freeze(Zm)),Zm}function $q(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hq(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],A=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=A,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function kb(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],A=e[4],a=e[5],y=e[6],w=e[7],P=e[8],I=e[9],L=e[10],U=e[11],W=e[12],q=e[13],ae=e[14],K=e[15],ne=n*a-r*A,ie=n*y-i*A,fe=n*w-s*A,ye=r*y-i*a,Me=r*w-s*a,He=i*w-s*y,Qe=P*q-I*W,Je=P*ae-L*W,tt=P*K-U*W,Ne=I*ae-L*q,nt=I*K-U*q,qe=L*K-U*ae,mt=ne*qe-ie*nt+fe*Ne+ye*tt-Me*Je+He*Qe;return mt?(mt=1/mt,t[0]=(a*qe-y*nt+w*Ne)*mt,t[1]=(i*nt-r*qe-s*Ne)*mt,t[2]=(q*He-ae*Me+K*ye)*mt,t[3]=(L*Me-I*He-U*ye)*mt,t[4]=(y*tt-A*qe-w*Je)*mt,t[5]=(n*qe-i*tt+s*Je)*mt,t[6]=(ae*fe-W*He-K*ie)*mt,t[7]=(P*He-L*fe+U*ie)*mt,t[8]=(A*nt-a*tt+w*Qe)*mt,t[9]=(r*tt-n*nt-s*Qe)*mt,t[10]=(W*Me-q*fe+K*ne)*mt,t[11]=(I*fe-P*Me-U*ne)*mt,t[12]=(a*Je-A*Ne-y*Qe)*mt,t[13]=(n*Ne-r*Je+i*Qe)*mt,t[14]=(q*ie-W*ye-ae*ne)*mt,t[15]=(P*ye-I*ie+L*ne)*mt,t):null}function Wq(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],A=t[5],a=t[6],y=t[7],w=t[8],P=t[9],I=t[10],L=t[11],U=t[12],W=t[13],q=t[14],ae=t[15],K=e*A-n*s,ne=e*a-r*s,ie=e*y-i*s,fe=n*a-r*A,ye=n*y-i*A,Me=r*y-i*a,He=w*W-P*U,Qe=w*q-I*U,Je=w*ae-L*U,tt=P*q-I*W,Ne=P*ae-L*W,nt=I*ae-L*q;return K*nt-ne*Ne+ie*tt+fe*Je-ye*Qe+Me*He}function Mh(t,e,n){var r=e[0],i=e[1],s=e[2],A=e[3],a=e[4],y=e[5],w=e[6],P=e[7],I=e[8],L=e[9],U=e[10],W=e[11],q=e[12],ae=e[13],K=e[14],ne=e[15],ie=n[0],fe=n[1],ye=n[2],Me=n[3];return t[0]=ie*r+fe*a+ye*I+Me*q,t[1]=ie*i+fe*y+ye*L+Me*ae,t[2]=ie*s+fe*w+ye*U+Me*K,t[3]=ie*A+fe*P+ye*W+Me*ne,ie=n[4],fe=n[5],ye=n[6],Me=n[7],t[4]=ie*r+fe*a+ye*I+Me*q,t[5]=ie*i+fe*y+ye*L+Me*ae,t[6]=ie*s+fe*w+ye*U+Me*K,t[7]=ie*A+fe*P+ye*W+Me*ne,ie=n[8],fe=n[9],ye=n[10],Me=n[11],t[8]=ie*r+fe*a+ye*I+Me*q,t[9]=ie*i+fe*y+ye*L+Me*ae,t[10]=ie*s+fe*w+ye*U+Me*K,t[11]=ie*A+fe*P+ye*W+Me*ne,ie=n[12],fe=n[13],ye=n[14],Me=n[15],t[12]=ie*r+fe*a+ye*I+Me*q,t[13]=ie*i+fe*y+ye*L+Me*ae,t[14]=ie*s+fe*w+ye*U+Me*K,t[15]=ie*A+fe*P+ye*W+Me*ne,t}function Wy(t,e,n){var r=n[0],i=n[1],s=n[2],A,a,y,w,P,I,L,U,W,q,ae,K;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(A=e[0],a=e[1],y=e[2],w=e[3],P=e[4],I=e[5],L=e[6],U=e[7],W=e[8],q=e[9],ae=e[10],K=e[11],t[0]=A,t[1]=a,t[2]=y,t[3]=w,t[4]=P,t[5]=I,t[6]=L,t[7]=U,t[8]=W,t[9]=q,t[10]=ae,t[11]=K,t[12]=A*r+P*i+W*s+e[12],t[13]=a*r+I*i+q*s+e[13],t[14]=y*r+L*i+ae*s+e[14],t[15]=w*r+U*i+K*s+e[15]),t}function aT(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Qq(t,e,n,r){var i=r[0],s=r[1],A=r[2],a=Math.hypot(i,s,A),y,w,P,I,L,U,W,q,ae,K,ne,ie,fe,ye,Me,He,Qe,Je,tt,Ne,nt,qe,mt,Xt;return a<Ip?null:(a=1/a,i*=a,s*=a,A*=a,y=Math.sin(n),w=Math.cos(n),P=1-w,I=e[0],L=e[1],U=e[2],W=e[3],q=e[4],ae=e[5],K=e[6],ne=e[7],ie=e[8],fe=e[9],ye=e[10],Me=e[11],He=i*i*P+w,Qe=s*i*P+A*y,Je=A*i*P-s*y,tt=i*s*P-A*y,Ne=s*s*P+w,nt=A*s*P+i*y,qe=i*A*P+s*y,mt=s*A*P-i*y,Xt=A*A*P+w,t[0]=I*He+q*Qe+ie*Je,t[1]=L*He+ae*Qe+fe*Je,t[2]=U*He+K*Qe+ye*Je,t[3]=W*He+ne*Qe+Me*Je,t[4]=I*tt+q*Ne+ie*nt,t[5]=L*tt+ae*Ne+fe*nt,t[6]=U*tt+K*Ne+ye*nt,t[7]=W*tt+ne*Ne+Me*nt,t[8]=I*qe+q*mt+ie*Xt,t[9]=L*qe+ae*mt+fe*Xt,t[10]=U*qe+K*mt+ye*Xt,t[11]=W*qe+ne*mt+Me*Xt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function dR(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],A=e[5],a=e[6],y=e[7],w=e[8],P=e[9],I=e[10],L=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+w*r,t[5]=A*i+P*r,t[6]=a*i+I*r,t[7]=y*i+L*r,t[8]=w*i-s*r,t[9]=P*i-A*r,t[10]=I*i-a*r,t[11]=L*i-y*r,t}function qq(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],A=e[1],a=e[2],y=e[3],w=e[8],P=e[9],I=e[10],L=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-w*r,t[1]=A*i-P*r,t[2]=a*i-I*r,t[3]=y*i-L*r,t[8]=s*r+w*i,t[9]=A*r+P*i,t[10]=a*r+I*i,t[11]=y*r+L*i,t}function pR(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],A=e[1],a=e[2],y=e[3],w=e[4],P=e[5],I=e[6],L=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+w*r,t[1]=A*i+P*r,t[2]=a*i+I*r,t[3]=y*i+L*r,t[4]=w*i-s*r,t[5]=P*i-A*r,t[6]=I*i-a*r,t[7]=L*i-y*r,t}function Zq(t,e){var n=e[0],r=e[1],i=e[2],s=e[4],A=e[5],a=e[6],y=e[8],w=e[9],P=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(s,A,a),t[2]=Math.hypot(y,w,P),t}function Yq(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],A=n+n,a=r+r,y=i+i,w=n*A,P=r*A,I=r*a,L=i*A,U=i*a,W=i*y,q=s*A,ae=s*a,K=s*y;return t[0]=1-I-W,t[1]=P+K,t[2]=L-ae,t[3]=0,t[4]=P-K,t[5]=1-w-W,t[6]=U+q,t[7]=0,t[8]=L+ae,t[9]=U-q,t[10]=1-w-I,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Xq(t,e,n,r,i,s,A){var a=1/(n-e),y=1/(i-r),w=1/(s-A);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*y,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*y,t[10]=(A+s)*w,t[11]=-1,t[12]=0,t[13]=0,t[14]=A*s*2*w,t[15]=0,t}function Kq(t,e,n,r,i){var s=1/Math.tan(e/2),A;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(A=1/(r-i),t[10]=(i+r)*A,t[14]=2*i*r*A):(t[10]=-1,t[14]=-2*r),t}var Jq=Kq;function eZ(t,e,n,r,i,s,A){var a=1/(e-n),y=1/(r-i),w=1/(s-A);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*w,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*y,t[14]=(A+s)*w,t[15]=1,t}var tZ=eZ;function nZ(t,e,n,r){var i,s,A,a,y,w,P,I,L,U,W=e[0],q=e[1],ae=e[2],K=r[0],ne=r[1],ie=r[2],fe=n[0],ye=n[1],Me=n[2];return Math.abs(W-fe)<Ip&&Math.abs(q-ye)<Ip&&Math.abs(ae-Me)<Ip?$q(t):(P=W-fe,I=q-ye,L=ae-Me,U=1/Math.hypot(P,I,L),P*=U,I*=U,L*=U,i=ne*L-ie*I,s=ie*P-K*L,A=K*I-ne*P,U=Math.hypot(i,s,A),U?(U=1/U,i*=U,s*=U,A*=U):(i=0,s=0,A=0),a=I*A-L*s,y=L*i-P*A,w=P*s-I*i,U=Math.hypot(a,y,w),U?(U=1/U,a*=U,y*=U,w*=U):(a=0,y=0,w=0),t[0]=i,t[1]=a,t[2]=P,t[3]=0,t[4]=s,t[5]=y,t[6]=I,t[7]=0,t[8]=A,t[9]=w,t[10]=L,t[11]=0,t[12]=-(i*W+s*q+A*ae),t[13]=-(a*W+y*q+w*ae),t[14]=-(P*W+I*q+L*ae),t[15]=1,t)}function rZ(){var t=new Zl(4);return Zl!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function iZ(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function lT(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function sZ(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function oZ(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function aZ(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],A=n*n+r*r+i*i+s*s;return A>0&&(A=1/Math.sqrt(A)),t[0]=n*A,t[1]=r*A,t[2]=i*A,t[3]=s*A,t}function lZ(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function AZ(t,e,n,r){var i=e[0],s=e[1],A=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=A+r*(n[2]-A),t[3]=a+r*(n[3]-a),t}function td(t,e,n){var r=e[0],i=e[1],s=e[2],A=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*A,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*A,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*A,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*A,t}function uZ(t,e,n){var r=e[0],i=e[1],s=e[2],A=n[0],a=n[1],y=n[2],w=n[3],P=w*r+a*s-y*i,I=w*i+y*r-A*s,L=w*s+A*i-a*r,U=-A*r-a*i-y*s;return t[0]=P*w+U*-A+I*-y-L*-a,t[1]=I*w+U*-a+L*-A-P*-y,t[2]=L*w+U*-y+P*-a-I*-A,t[3]=e[3],t}(function(){var t=rZ();return function(e,n,r,i,s,A){var a,y;for(n||(n=4),r||(r=0),i?y=Math.min(i*n+r,e.length):y=e.length,a=r;a<y;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,A),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var Lb;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Lb||(Lb={}));const cZ=45*Math.PI/180,hZ=1,_x=.1,vx=500,fZ=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Yo extends fR{static get IDENTITY(){return pZ()}static get ZERO(){return dZ()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Lb}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,A,a,y,w,P,I,L,U,W,q,ae){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=A,this[6]=a,this[7]=y,this[8]=w,this[9]=P,this[10]=I,this[11]=L,this[12]=U,this[13]=W,this[14]=q,this[15]=ae,this.check()}setRowMajor(e,n,r,i,s,A,a,y,w,P,I,L,U,W,q,ae){return this[0]=e,this[1]=s,this[2]=w,this[3]=U,this[4]=n,this[5]=A,this[6]=P,this[7]=W,this[8]=r,this[9]=a,this[10]=I,this[11]=q,this[12]=i,this[13]=y,this[14]=L,this[15]=ae,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(fZ)}fromObject(e){return this.check()}fromQuaternion(e){return Yq(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:A=_x,far:a=vx}=e;return a===1/0?gZ(this,n,r,i,s,A):Xq(this,n,r,i,s,A,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return nZ(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:A=_x,far:a=vx}=e;return tZ(this,n,r,i,s,A,a),this.check()}orthographic(e){const{fovy:n=cZ,aspect:r=hZ,focalDistance:i=1,near:s=_x,far:A=vx}=e;MC(n);const a=n/2,y=i*Math.tan(a),w=y*r;return this.ortho({left:-w,right:w,bottom:-y,top:y,near:s,far:A})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return MC(n),Jq(this,n,r,i,s),this.check()}determinant(){return Wq(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],A=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*A,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*A,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*A,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],A=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*A,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*A,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*A,e}transpose(){return Hq(this,this),this.check()}invert(){return kb(this,this),this.check()}multiplyLeft(e){return Mh(this,e,this),this.check()}multiplyRight(e){return Mh(this,this,e),this.check()}rotateX(e){return dR(this,this,e),this.check()}rotateY(e){return qq(this,this,e),this.check()}rotateZ(e){return pR(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Qq(this,this,e,n),this.check()}scale(e){return aT(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Wy(this,this,e),this.check()}transform(e,n){return e.length===4?(n=td(n||[-0,-0,-0,-0],e,this),Pp(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=mq(n||[-0,-0],e,this);break;case 3:i=sT(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Pp(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=_q(n||[-0,-0],e,this);break;case 3:r=sR(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Pp(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let Ym,Xm;function dZ(){return Ym||(Ym=new Yo([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Ym)),Ym}function pZ(){return Xm||(Xm=new Yo,Object.freeze(Xm)),Xm}function MC(t){if(t>Math.PI*2)throw Error("expected radians")}function gZ(t,e,n,r,i,s){const A=2*s/(n-e),a=2*s/(i-r),y=(n+e)/(n-e),w=(i+r)/(i-r),P=-1,I=-1,L=-2*s;return t[0]=A,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=y,t[9]=w,t[10]=P,t[11]=I,t[12]=0,t[13]=0,t[14]=L,t[15]=0,t}function CC(){var t=new Zl(4);return Zl!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function mZ(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function gR(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function PC(t,e,n){var r=e[0],i=e[1],s=e[2],A=e[3],a=n[0],y=n[1],w=n[2],P=n[3];return t[0]=r*P+A*a+i*w-s*y,t[1]=i*P+A*y+s*a-r*w,t[2]=s*P+A*w+r*y-i*a,t[3]=A*P-r*a-i*y-s*w,t}function yZ(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],A=e[3],a=Math.sin(n),y=Math.cos(n);return t[0]=r*y+A*a,t[1]=i*y+s*a,t[2]=s*y-i*a,t[3]=A*y-r*a,t}function _Z(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],A=e[3],a=Math.sin(n),y=Math.cos(n);return t[0]=r*y-s*a,t[1]=i*y+A*a,t[2]=s*y+r*a,t[3]=A*y-i*a,t}function vZ(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],A=e[3],a=Math.sin(n),y=Math.cos(n);return t[0]=r*y+i*a,t[1]=i*y-r*a,t[2]=s*y+A*a,t[3]=A*y-s*a,t}function xZ(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function $1(t,e,n,r){var i=e[0],s=e[1],A=e[2],a=e[3],y=n[0],w=n[1],P=n[2],I=n[3],L,U,W,q,ae;return U=i*y+s*w+A*P+a*I,U<0&&(U=-U,y=-y,w=-w,P=-P,I=-I),1-U>Ip?(L=Math.acos(U),W=Math.sin(L),q=Math.sin((1-r)*L)/W,ae=Math.sin(r*L)/W):(q=1-r,ae=r),t[0]=q*i+ae*y,t[1]=q*s+ae*w,t[2]=q*A+ae*P,t[3]=q*a+ae*I,t}function wZ(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],A=n*n+r*r+i*i+s*s,a=A?1/A:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=s*a,t}function bZ(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function mR(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,A=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[s*3+s]-e[A*3+A]+1),t[i]=.5*r,r=.5/r,t[3]=(e[s*3+A]-e[A*3+s])*r,t[s]=(e[s*3+i]+e[i*3+s])*r,t[A]=(e[A*3+i]+e[i*3+A])*r}return t}var EZ=iZ,TZ=lT,SZ=lZ,MZ=AZ,CZ=sZ,PZ=oZ,yR=aZ,IZ=function(){var t=aR(),e=EC(1,0,0),n=EC(0,1,0);return function(r,i,s){var A=lR(i,s);return A<-.999999?(j1(t,e,i),hR(t)<1e-6&&j1(t,n,i),Mq(t,t),gR(r,t,Math.PI),r):A>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(j1(t,i,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+A,yR(r,r))}}();(function(){var t=CC(),e=CC();return function(n,r,i,s,A,a){return $1(t,r,A,a),$1(e,i,s,a),$1(n,t,e,2*a*(1-a)),n}})();(function(){var t=Rq();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],yR(e,mR(e,t))}})();const kZ=[0,0,0,1];class IC extends iT{constructor(e=0,n=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return mR(this,e),this.check()}fromAxisRotation(e,n){return gR(this,e,n),this.check()}identity(){return mZ(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Ur(e)}get y(){return this[1]}set y(e){this[1]=Ur(e)}get z(){return this[2]}set z(e){this[2]=Ur(e)}get w(){return this[3]}set w(e){this[3]=Ur(e)}len(){return CZ(this)}lengthSquared(){return PZ(this)}dot(e){return SZ(this,e)}rotationTo(e,n){return IZ(this,e,n),this.check()}add(e){return EZ(this,this,e),this.check()}calculateW(){return xZ(this,this),this.check()}conjugate(){return bZ(this,this),this.check()}invert(){return wZ(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(MZ(this,e,n,r),this.check())}multiplyRight(e){return PC(this,this,e),this.check()}multiplyLeft(e){return PC(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return yZ(this,this,e),this.check()}rotateY(e){return _Z(this,this,e),this.check()}rotateZ(e){return vZ(this,this,e),this.check()}scale(e){return TZ(this,this,e),this.check()}slerp(e,n,r){let i,s,A;switch(arguments.length){case 1:({start:i=kZ,target:s,ratio:A}=e);break;case 2:i=this,s=e,A=n;break;default:i=e,s=n,A=r}return $1(this,i,s,A),this.check()}transformVector4(e,n=new oT){return uZ(n,e,this),Pp(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const _R={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},kC=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,LZ={lightSources:{}};function xx(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function DZ(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=xx(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,A)=>{i["lighting_uPointLight[".concat(A,"].color")]=xx(s),i["lighting_uPointLight[".concat(A,"].position")]=s.position,i["lighting_uPointLight[".concat(A,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,A)=>{i["lighting_uDirectionalLight[".concat(A,"].color")]=xx(s),i["lighting_uDirectionalLight[".concat(A,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function vR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:LZ;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},DZ({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return vR({lightSources:e})}return{}}const xR={name:"lights",vs:kC,fs:kC,getUniforms:vR,defines:{MAX_LIGHTS:3}},RZ=new Uint8Array([0,255,255,255]),BZ={pickingSelectedColor:null,pickingHighlightColor:RZ,pickingActive:!1,pickingAttribute:!1};function zZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:BZ;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const OZ=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,FZ=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,NZ={name:"picking",vs:OZ,fs:FZ,getUniforms:zZ},wR=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,UZ={};function VZ(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function bR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:UZ;if(!("material"in t))return{};const{material:e}=t;return e?VZ(e):{lighting_uEnabled:!1}}const GZ={name:"gouraud-lighting",dependencies:[xR],vs:wR,defines:{LIGHTING_VERTEX:1},getUniforms:bR},jZ={name:"phong-lighting",dependencies:[xR],fs:wR,defines:{LIGHTING_FRAGMENT:1},getUniforms:bR},$Z=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,HZ={name:"transform",vs:$Z,fs:null};class Ng{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Ng(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:A=[],bufferMode:a=35981,transpileToGLSL100:y=!1}=e,w=this._getModuleList(e.modules),P=this._getHash(n),I=this._getHash(r),L=w.map(ie=>this._getHash(ie.name)).sort(),U=A.map(ie=>this._getHash(ie)),W=Object.keys(i).sort(),q=Object.keys(s).sort(),ae=[],K=[];for(const ie of W)ae.push(this._getHash(ie)),ae.push(this._getHash(i[ie]));for(const ie of q)K.push(this._getHash(ie)),K.push(this._getHash(s[ie]));const ne="".concat(P,"/").concat(I,"D").concat(ae.join("/"),"M").concat(L.join("/"),"I").concat(K.join("/"),"V").concat(U.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(y?"T":"");if(!this._programCache[ne]){const ie=HQ(this.gl,{vs:n,fs:r,modules:w,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:y});this._programCache[ne]=new QD(this.gl,{hash:ne,vs:ie.vs,fs:ie.fs,varyings:A,bufferMode:a}),this._getUniforms[ne]=ie.getUniforms||(fe=>{}),this._useCounts[ne]=0}return this._useCounts[ne]++,this._programCache[ne]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,A=this._defaultModules.length;s<A;++s){const a=this._defaultModules[s],y=a.name;n[i++]=a,r[y]=!0}for(let s=0,A=e.length;s<A;++s){const a=e[s],y=a.name;r[y]||(n[i++]=a,r[y]=!0)}return n.length=i,n}}const WZ={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function QZ(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const A=e.attributes[s],a=qZ(s,n);if(s==="indices")i=A;else if(A.constant)r[a]=A.value;else{const y=A.value,w={...A};delete w.value,r[a]=[new Br(t,y),w],ZZ(s,w)}}if(i){const s=i.value||i;tn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const A={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new Br(t,{data:s,target:34963}),A]}return r}function qZ(t,e){const{attributeMap:n=WZ}=e||{};return n&&n[t]||t}function ZZ(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}tn(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Cf=2,YZ=1e4,XZ="Model needs drawMode and vertexCount",LC=()=>{},KZ={};class Ou{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=Qc("model")}=n;tn(l2(e)),this.id=r,this.gl=e,this.id=n.id||Qc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Ng.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:A,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:P}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:A,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:P},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},tn(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),XZ)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:A,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:P}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:A,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:P},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return tn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return tn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=QZ(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(R0(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return JE(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:A=this.transformFeedback,parameters:a={},vertexArray:y=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let w;_n.priority>=Cf&&(w=this._logDrawCallStart(Cf));const P=this.vertexArray.getDrawParams(),{isIndexed:I=P.isIndexed,indexType:L=P.indexType,indexOffset:U=P.indexOffset,vertexArrayInstanced:W=P.isInstanced}=this.props;W&&!this.isInstanced&&_n.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:q,instanceCount:ae}=this,{onBeforeRender:K=LC,onAfterRender:ne=LC}=this.props;K(),this.program.setUniforms(this.uniforms);const ie=this.program.draw(Object.assign(KZ,e,{logPriority:w,uniforms:null,framebuffer:r,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:y,transformFeedback:A,isIndexed:I,indexType:L,isInstanced:q,instanceCount:ae,offset:I?U:0}));return ne(),_n.priority>=Cf&&this._logDrawCallEnd(w,y,r),ie}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{35977:n})),i.forEach(A=>A.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(A=>A.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return _n.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:A,defines:a,varyings:y,bufferMode:w,transpileToGLSL100:P}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:A,defines:a,varyings:y,bufferMode:w,transpileToGLSL100:P}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}tn(n instanceof QD,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new iQ(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof Br&&n.delete()}}_setAnimationProps(e){this.animated&&tn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(R0(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new qD(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:YZ;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),_n.group(Cf,">>> DRAWING MODEL ".concat(this.id),{collapsed:_n.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=aQ({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:A,unusedTable:a,unusedCount:y}=fC({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:w,count:P}=fC({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});P>0&&_n.log("MISSING UNIFORMS",Object.keys(w))(),y>0&&_n.log("UNUSED UNIFORMS",Object.keys(a))();const I=AQ(this.vertexArray.configuration);_n.table(e,s)(),_n.table(e,A)(),_n.table(e+1,I)(),i&&i.log({logLevel:Cf,message:"Rendered to ".concat(i.id)}),_n.groupEnd(Cf)()}}class JZ{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof Br?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&tn(lr(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const A=n[s],{byteLength:a,usage:y,accessor:w}=A;r[i]=this._createNewBuffer(i,{byteLength:a,usage:y,accessor:w})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new qD(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],tn(r[s]instanceof Br)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new Br(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const eY="transform_uSampler_",Qy="transform_uSize_",DC="transform_position";function tY(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,A=Object.keys(n).length,a=null;const y={};let w=e,P={};if(A>0||r){const I=w.split(`
`),L=I.slice();if(I.forEach((U,W,q)=>{if(A>0){const ae=oY(U,n);if(ae){const{updatedLine:K,inject:ne}=ae;L[W]=K,P=Sb([P,ne]),Object.assign(y,ae.samplerTextureMap),A--}}r&&!a&&(a=sY(U,r))}),r){tn(i);const U="".concat(Qy).concat(r),W="uniform vec2 ".concat(U,`;
`),q="     vec2 ".concat(DC," = transform_getPos(").concat(U,`);
     gl_Position = vec4(`).concat(DC,`, 0, 1.);
`);P=Sb([P,{"vs:#decl":W,"vs:#main-start":q}])}w=L.join(`
`)}return{vs:w,targetTextureType:a,inject:P,samplerTextureMap:y}}function nY(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,A;n&&({width:s,height:A}=r,i["".concat(Qy).concat(n)]=[s,A]);for(const a in e)({width:s,height:A}=e[a]),i["".concat(Qy).concat(a)]=[s,A];return i}function rY(t){return tR(t,["attribute","in"])}function iY(t){const e="".concat(eY).concat(t),n="".concat(Qy).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function sY(t,e){const n=tR(t,["varying","out"]);return n&&n.name===e?n.type:null}function oY(t,e){const n={},r=rY(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const A="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:y,uniformDeclerations:w}=iY(s),P=eq(i),I="  ".concat(i," ").concat(s," = transform_getInput(").concat(a,", ").concat(y,").").concat(P,`;
`);return n[a]=s,{updatedLine:A,inject:{"vs:#decl":w,"vs:#main-start":I},samplerTextureMap:n}}return null}const aY={10241:9728,10240:9728,10242:33071,10243:33071},lY="transform_output";class AY{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],A=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),y=Object.assign({},e.parameters);let w=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){A.transform_elementID=this.elementIDBuffer;for(const I in this.samplerTextureMap){const L=this.samplerTextureMap[I];a[I]=r[L]}this._setSourceTextureParameters();const P=nY({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,P)}return this.hasTargetTexture&&(w=!1,y.viewport=[0,0,i.width,i.height]),{attributes:A,framebuffer:i,uniforms:a,discard:w,parameters:y}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=u2(n);if(!e)return r;const i=r.constructor,s=tq(this.targetTextureType),A=new i(r.length*s/4);let a=0;for(let y=0;y<r.length;y+=4)for(let w=0;w<s;w++)A[a++]=r[y+w];return A}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof Jo)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new Br(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:A,height:a}=s,{framebuffer:y}=e;y?(y.update({attachments:{36064:s},resizeAttachments:!1}),y.resize({width:A,height:a})):e.framebuffer=new Zi(this.gl,{id:"transform-framebuffer",width:A,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(aY)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=QH(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:A,inject:a,samplerTextureMap:y}=tY({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),w=Sb([e.inject||{},a]);this.targetTextureType=A,this.samplerTextureMap=y;const P=e._fs||nR({version:HD(i),input:this.targetTextureVarying,inputType:A,output:lY}),I=this.hasSourceTextures||this.targetTextureVarying?[HZ].concat(e.modules||[]):e.modules;return{vs:i,fs:P,modules:I,uniforms:s,inject:w}}}let AT=class{static isSupported(e){return lr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();tn(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Ou(n,Object.assign({},e,{fs:e.fs||nR({version:HD(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){uY(n)&&(this.bufferTransform=new JZ(e,n)),cY(n)&&(this.textureTransform=new AY(e,n)),tn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}};function uY(t){return!!(!R0(t.feedbackBuffers)||!R0(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function cY(t){return!!(!R0(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const RC={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Pu{static get DRAW_MODE(){return RC}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Qc("geometry"),drawMode:r=RC.TRIANGLES,attributes:i={},indices:s=null,vertexCount:A=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=A||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,tn(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(tn(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:A,size:a,constant:y}=s;!y&&A&&a>=1&&(r=Math.min(r,A.length/a))}return tn(Number.isFinite(r)),r}}let hY=1,fY=1;class ER{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,A=hY++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(A,a),A}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:A}=i;s.setTime(this.getTime(A))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=fY++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const dY=[255,255,255],pY=1;let gY=0;class TR{constructor(e={}){se(this,"id",void 0),se(this,"color",void 0),se(this,"intensity",void 0),se(this,"type","ambient");const{color:n=dY}=e,{intensity:r=pY}=e;this.id=e.id||"ambient-".concat(gY++),this.color=n,this.intensity=r}}const mY=[255,255,255],yY=1,_Y=[0,0,-1];let vY=0;class Db{constructor(e={}){se(this,"id",void 0),se(this,"color",void 0),se(this,"intensity",void 0),se(this,"type","directional"),se(this,"direction",void 0),se(this,"shadow",void 0);const{color:n=mY}=e,{intensity:r=yY}=e,{direction:i=_Y}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(vY++),this.color=n,this.intensity=r,this.type="directional",this.direction=new ln(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class xY{constructor(e,n={id:"pass"}){se(this,"id",void 0),se(this,"gl",void 0),se(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class uT extends xY{constructor(...e){super(...e),se(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return zu(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:A,clearStack:a=!0,clearCanvas:y=!0}=e;e.pass=e.pass||"unknown";const w=this.gl;y&&bY(w,n),a&&(this._lastRenderIndex=-1);const P=[];for(const I of i){const L=s&&s[I.id];A?.(I);const U=this._getDrawLayerParams(I,e),W=I.subViewports||[I];for(const q of W){const ae=this._drawLayersInViewport(w,{target:n,moduleParameters:r,viewport:q,view:L,pass:e.pass,layers:e.layers},U);P.push(ae)}}return P}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:A,effects:a,moduleParameters:y},w=!1){const P=[],I=SR(this._lastRenderIndex+1),L={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:A},U={};for(let W=0;W<n.length;W++){const q=n[W],ae=this._shouldDrawLayer(q,L,s,U),K={shouldDrawLayer:ae};ae&&!w&&(K.layerRenderIndex=I(q,ae),K.moduleParameters=this._getModuleParameters(q,a,r,y),K.layerParameters=this.getLayerParameters(q,W,e)),P[W]=K}return P}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:A,view:a},y){const w=wY(e,{moduleParameters:r,target:s,viewport:A});if(a&&a.props.clear){const I=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;Ql(e,{scissorTest:!0,scissor:w},()=>JE(e,I))}const P={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};zu(e,{viewport:w});for(let I=0;I<n.length;I++){const L=n[I],{shouldDrawLayer:U,layerRenderIndex:W,moduleParameters:q,layerParameters:ae}=y[I];if(U&&L.props.pickable&&P.pickableCount++,L.isComposite)P.compositeCount++;else if(U){P.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,W),q.viewport=A;try{L._drawLayer({moduleParameters:q,uniforms:{layerIndex:W},parameters:ae})}catch(K){L.raiseError(K,"drawing ".concat(L," to ").concat(i))}}}return P}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let A=e.parent;for(;A;){if(!A.props.visible||!A.filterSubLayer(n))return!1;n.layer=A,A=A.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const A=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:D0(this.gl)});if(n)for(const y of n){var a;Object.assign(A,(a=y.getModuleParameters)===null||a===void 0?void 0:a.call(y,e))}return Object.assign(A,this.getModuleParameters(e,n),i)}}function SR(t=0,e={}){const n={},r=(i,s)=>{const A=i.props._offset,a=i.id,y=i.parent&&i.parent.id;let w;if(y&&!(y in e)&&r(i.parent,!1),y in n){const P=n[y]=n[y]||SR(e[y],e);w=P(i,s),n[a]=P}else Number.isFinite(A)?(w=A+(e[y]||0),n[a]=null):w=t;return s&&w>=t&&(t=w+1),e[a]=w,w};return r}function wY(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||D0(t),A=i?n.height:t.drawingBufferHeight,a=r;return[a.x*s,A-(a.y+a.height)*s,a.width*s,a.height*s]}function bY(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;zu(t,{viewport:[0,0,n,r]}),t.clear(16640)}class EY extends uT{constructor(e,n){super(e,n),se(this,"shadowMap",void 0),se(this,"depthBuffer",void 0),se(this,"fbo",void 0),this.shadowMap=new Jo(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Qf(e,{format:33189,width:1,height:1}),this.fbo=new Zi(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;Ql(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=D0(this.gl),s=r.width*i,A=r.height*i;(s!==n.width||A!==n.height)&&n.resize({width:s,height:A}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const MR="#define SMOOTH_EDGE_RADIUS 0.5",TY=`
`.concat(MR,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),SY=`
`.concat(MR,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),MY={name:"geometry",vs:TY,fs:SY},CY=Object.keys(ar).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(ar[t],";")).join(""),PY=Object.keys(Nl).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(Nl[t],";")).join(""),IY=Object.keys(Rh).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Rh[t],";")).join(""),kY="".concat(CY,`
`).concat(PY,`
`).concat(IY,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function LY(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Ug(t){let e={},n;return r=>{for(const i in r)if(!LY(r[i],e[i])){n=t(r),e=r;break}return n}}const BC=[0,0,0,0],DY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],CR=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],RY=[0,0,0],PR=[0,0,0],BY=Ug(FY);function IR(t,e,n=PR){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===ar.LNGLAT_OFFSETS||e===ar.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Nl.WEB_MERCATOR:(e===ar.LNGLAT||e===ar.CARTESIAN)&&(i=[0,0,0],s=!1);break;case Nl.WEB_MERCATOR_AUTO_OFFSET:e===ar.LNGLAT?r=i:e===ar.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case Nl.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case Nl.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function zY(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:A}=t,a=BC,y=BC,w=t.cameraPosition;const{geospatialOrigin:P,shaderCoordinateOrigin:I,offsetMode:L}=IR(t,e,n);return L&&(y=t.projectPosition(P||I),w=[w[0]-y[0],w[1]-y[1],w[2]-y[2]],y[3]=1,a=td([],y,A),s=r||s,A=Mh([],i,s),A=Mh([],A,DY)),{viewMatrix:s,viewProjectionMatrix:A,projectionCenter:a,originCommon:y,cameraPosCommon:w,shaderCoordinateOrigin:I,geospatialOrigin:P}}function OY({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=ar.DEFAULT,coordinateOrigin:i=PR,autoWrapLongitude:s=!1}){r===ar.DEFAULT&&(r=t.isGeospatial?ar.LNGLAT:ar.CARTESIAN);const A=BY({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return A.project_uWrapLongitude=s,A.project_uModelMatrix=n||CR,A}function FY({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:A,cameraPosCommon:a,shaderCoordinateOrigin:y,geospatialOrigin:w}=zY(t,n,r),P=t.getDistanceScales(),I=[t.width*e,t.height*e],L=td([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,U={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:y,project_uCommonOrigin:A.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:I,project_uDevicePixelRatio:e,project_uFocalDistance:L,project_uCommonUnitsPerMeter:P.unitsPerMeter,project_uCommonUnitsPerWorldUnit:P.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:RY,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:CR,project_uCameraPosition:a};if(w){const W=t.getDistanceScales(w);switch(n){case ar.METER_OFFSETS:U.project_uCommonUnitsPerWorldUnit=W.unitsPerMeter,U.project_uCommonUnitsPerWorldUnit2=W.unitsPerMeter2;break;case ar.LNGLAT:case ar.LNGLAT_OFFSETS:t._pseudoMeters||(U.project_uCommonUnitsPerMeter=W.unitsPerMeter),U.project_uCommonUnitsPerWorldUnit=W.unitsPerDegree,U.project_uCommonUnitsPerWorldUnit2=W.unitsPerDegree2;break;case ar.CARTESIAN:U.project_uCommonUnitsPerWorldUnit=[1,1,W.unitsPerMeter[2]],U.project_uCommonUnitsPerWorldUnit2=[0,0,W.unitsPerMeter2[2]];break}}return U}const NY={};function UY(t=NY){return"viewport"in t?OY(t):{}}const cT={name:"project",dependencies:[iq,MY],vs:kY,getUniforms:UY};function VY(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function g0(t,e){const n=td([],e,t);return lT(n,n,1/n[3]),n}function zC(t,e){const n=t%e;return n<0?e+n:n}function GY(t,e,n){return n*e+(1-n)*t}function Rb(t,e,n){return t<e?e:t>n?n:t}function jY(t){return Math.log(t)*Math.LOG2E}const hT=Math.log2||jY;function Fu(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Ul=Math.PI,kR=Ul/4,ol=Ul/180,Bb=180/Ul,z0=512,qy=4003e4,Km=85.051129,$Y=1.5;function OC(t){return Math.pow(2,t)}function LR(t){return hT(t)}function Yl(t){const[e,n]=t;Fu(Number.isFinite(e)),Fu(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*ol,i=n*ol,s=z0*(r+Ul)/(2*Ul),A=z0*(Ul+Math.log(Math.tan(kR+i*.5)))/(2*Ul);return[s,A]}function Oh(t){const[e,n]=t,r=e/z0*(2*Ul)-Ul,i=2*(Math.atan(Math.exp(n/z0*(2*Ul)-Ul))-kR);return[r*Bb,i*Bb]}function HY(t){const{latitude:e}=t;Fu(Number.isFinite(e));const n=Math.cos(e*ol);return LR(qy*n)-9}function H1(t){const e=Math.cos(t*ol);return z0/qy/e}function zb(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;Fu(Number.isFinite(e)&&Number.isFinite(n));const i=z0,s=Math.cos(e*ol),A=i/360,a=A/s,y=i/qy/s,w={unitsPerMeter:[y,y,y],metersPerUnit:[1/y,1/y,1/y],unitsPerDegree:[A,a,y],degreesPerUnit:[1/A,1/a,1/y]};if(r){const P=ol*Math.tan(e*ol)/s,I=A*P/2,L=i/qy*P,U=L/a*y;w.unitsPerDegree2=[0,I,L],w.unitsPerMeter2=[U,0,U]}return w}function DR(t,e){const[n,r,i]=t,[s,A,a]=e,{unitsPerMeter:y,unitsPerMeter2:w}=zb({longitude:n,latitude:r,highPrecision:!0}),P=Yl(t);P[0]+=s*(y[0]+w[0]*A),P[1]+=A*(y[1]+w[1]*A);const I=Oh(P),L=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[I[0],I[1],L]:I}function WY(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:A}=t,a=VY();Wy(a,a,[0,0,-i]),dR(a,a,-n*ol),pR(a,a,r*ol);const y=s/e;return aT(a,a,[y,y,y]),A&&Wy(a,a,Sq([],A)),a}function QY(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:A,scale:a,nearZMultiplier:y=1,farZMultiplier:w=1}=t;let{fovy:P=Zy($Y)}=t;r!==void 0&&(P=Zy(r));const I=P*ol,L=i*ol,U=RR(P);let W=U;A&&(W+=A[2]*a/Math.cos(L)/n);const q=I*(.5+(s?s[1]:0)/n),ae=Math.sin(q)*W/Math.sin(Rb(Math.PI/2-L-q,.01,Math.PI-.01)),K=Math.sin(L)*ae+W,ne=W*10,ie=Math.min(K*w,ne);return{fov:I,aspect:e/n,focalDistance:U,near:y,far:ie}}function Zy(t){return 2*Math.atan(.5/t)*Bb}function RR(t){return .5/Math.tan(.5*t*ol)}function BR(t,e){const[n,r,i=0]=t;return Fu(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),g0(e,[n,r,i,1])}function fT(t,e,n=0){const[r,i,s]=t;if(Fu(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return g0(e,[r,i,s,1]);const A=g0(e,[r,i,0,1]),a=g0(e,[r,i,1,1]),y=A[2],w=a[2],P=y===w?0:((n||0)-y)/(w-y);return iR([],A,a,P)}function qY(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:A=[0,0]}=t,[[a,y],[w,P]]=r,I=ZY(t.padding),L=Yl([a,Rb(P,-Km,Km)]),U=Yl([w,Rb(y,-Km,Km)]),W=[Math.max(Math.abs(U[0]-L[0]),i),Math.max(Math.abs(U[1]-L[1]),i)],q=[e-I.left-I.right-Math.abs(A[0])*2,n-I.top-I.bottom-Math.abs(A[1])*2];Fu(q[0]>0&&q[1]>0);const ae=q[0]/W[0],K=q[1]/W[1],ne=(I.right-I.left)/2/ae,ie=(I.top-I.bottom)/2/K,fe=[(U[0]+L[0])/2+ne,(U[1]+L[1])/2+ie],ye=Oh(fe),Me=Math.min(s,hT(Math.abs(Math.min(ae,K))));return Fu(Number.isFinite(Me)),{longitude:ye[0],latitude:ye[1],zoom:Me}}function ZY(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Fu(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const FC=Math.PI/180;function YY(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},A=i([0,r],s),a=i([n,r],s);let y,w;const P=t.fovy?.5*t.fovy*FC:Math.atan(.5/t.altitude),I=(90-t.pitch)*FC;return P>I-.01?(y=NC(t,0,e),w=NC(t,n,e)):(y=i([0,0],s),w=i([n,0],s)),[A,a,w,y]}function NC(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=g0(r,[e,0,1,1]),s=g0(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),y=iR([],i,s,a),w=Oh(y);return w.push(n),w}const UC=512;function XY(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:A,bearing:a=0}=t;(i<-180||i>180)&&(i=zC(i+180,360)-180),(a<-180||a>180)&&(a=zC(a+180,360)-180);const y=hT(n/UC);if(A<=y)A=y,s=0;else{const w=n/2/Math.pow(2,A),P=Oh([0,w])[1];if(s<P)s=P;else{const I=Oh([0,UC-w])[1];s>I&&(s=I)}}return{width:e,height:n,longitude:i,latitude:s,zoom:A,pitch:r,bearing:a}}const zR=.01,KY=["longitude","latitude","zoom"],OR={curve:1.414,speed:1.2};function JY(t,e,n,r){const{startZoom:i,startCenterXY:s,uDelta:A,w0:a,u1:y,S:w,rho:P,rho2:I,r0:L}=FR(t,e,r);if(y<zR){const fe={};for(const ye of KY){const Me=t[ye],He=e[ye];fe[ye]=GY(Me,He,n)}return fe}const U=n*w,W=Math.cosh(L)/Math.cosh(L+P*U),q=a*((Math.cosh(L)*Math.tanh(L+P*U)-Math.sinh(L))/I)/y,ae=1/W,K=i+LR(ae),ne=fq([],A,q);Pb(ne,ne,s);const ie=Oh(ne);return{longitude:ie[0],latitude:ie[1],zoom:K}}function eX(t,e,n){const r={...OR,...n},{screenSpeed:i,speed:s,maxDuration:A}=r,{S:a,rho:y}=FR(t,e,r),w=1e3*a;let P;return Number.isFinite(i)?P=w/(i/y):P=w/s,Number.isFinite(A)&&P>A?0:P}function FR(t,e,n){n=Object.assign({},OR,n);const r=n.curve,i=t.zoom,s=[t.longitude,t.latitude],A=OC(i),a=e.zoom,y=[e.longitude,e.latitude],w=OC(a-i),P=Yl(s),I=Yl(y),L=yq([],I,P),U=Math.max(t.width,t.height),W=U/w,q=dq(L)*A,ae=Math.max(q,zR),K=r*r,ne=(W*W-U*U+K*K*ae*ae)/(2*U*K*ae),ie=(W*W-U*U-K*K*ae*ae)/(2*W*K*ae),fe=Math.log(Math.sqrt(ne*ne+1)-ne),ye=Math.log(Math.sqrt(ie*ie+1)-ie),Me=(ye-fe)/r;return{startZoom:i,startCenterXY:P,uDelta:L,w0:U,u1:q,S:Me,rho:r,rho2:K,r0:fe,r1:ye}}const tX=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,nX=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,rX=Ug(lX),iX=Ug(AX),sX=[0,0,0,1],oX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function aX(t,e){const[n,r,i]=t,s=fT([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function lX({viewport:t,center:e}){return new Yo(t.viewProjectionMatrix).invert().transform(e)}function AX({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(A=>aX(A,r));for(const A of e){const a=A.clone().translate(new ln(t.center).negate()),y=s.map(P=>a.transform(P)),w=new Yo().ortho({left:Math.min(...y.map(P=>P[0])),right:Math.max(...y.map(P=>P[0])),bottom:Math.min(...y.map(P=>P[1])),top:Math.max(...y.map(P=>P[1])),near:Math.min(...y.map(P=>-P[2])),far:Math.max(...y.map(P=>-P[2]))});n.push(w.multiplyRight(A))}return n}function uX(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||sX,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=rX({viewport:t.viewport,center:e.project_uCenter}),s=[],A=iX({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const y=A[a],w=y.clone().translate(new ln(t.viewport.center).negate());e.project_uCoordinateSystem===ar.LNGLAT&&e.project_uProjectionMode===Nl.WEB_MERCATOR?(A[a]=w,s[a]=i):(A[a]=y.clone().multiplyRight(oX),s[a]=w.transform(i))}for(let a=0;a<A.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=A[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:r["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return r}const wx={name:"shadow",dependencies:[cT],vs:tX,fs:nX,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?uX(t,e):{}},cX={color:[255,255,255],intensity:1},VC=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],hX=[0,0,0,200/255];class dT{constructor(e={}){se(this,"id","lighting-effect"),se(this,"props",void 0),se(this,"shadowColor",hX),se(this,"shadow",void 0),se(this,"ambientLight",void 0),se(this,"directionalLights",void 0),se(this,"pointLights",void 0),se(this,"shadowPasses",[]),se(this,"shadowMaps",[]),se(this,"dummyShadowMap",null),se(this,"programManager",void 0),se(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:A}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Ng.getDefaultProgramManager(e),wx&&this.programManager.addDefaultModule(wx)),this.dummyShadowMap||(this.dummyShadowMap=new Jo(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:A,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(wx),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Yo().lookAt({eye:new ln(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new EY(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new TR(cX),this.directionalLights.push(new Db(VC[0]),new Db(VC[1])))}}class fX{constructor(e={}){se(this,"_pool",[]),se(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:A=!1,initialize:a=!1,maxCount:y}){const w=i||e&&e.constructor||Float32Array,P=n*r+s;if(ArrayBuffer.isView(e)){if(P<=e.length)return e;if(P*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new w(e.buffer,0,P)}let I=1/0;y&&(I=y*r+s);const L=this._allocate(w,P,a,I);return e&&A?L.set(e):a||L.fill(0,0,4),this._release(e),L}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const A=this._pool,a=e.BYTES_PER_ELEMENT*s,y=A.findIndex(w=>w.byteLength>=a);if(y>=0){const w=new e(A.splice(y,1)[0],0,s);return r&&w.fill(0),w}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(A=>A.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const O0=new fX;function ap(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function dX(t){return[t[12],t[13],t[14]]}function pX(t){return{left:Pf(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Pf(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Pf(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Pf(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Pf(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Pf(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const GC=new ln;function Pf(t,e,n,r){GC.set(t,e,n);const i=GC.len();return{distance:r/i,normal:new ln(-t/i,-e/i,-n/i)}}function gX(t){return t-Math.fround(t)}let Nd;function bx(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Nd=O0.allocate(Nd,s,{type:Float32Array,size:n*2});let A=r,a=0;for(;A<i;){for(let y=0;y<n;y++){const w=t[A++];Nd[a+y]=w,Nd[a+y+n]=gX(w)}a+=n*2}return Nd.subarray(0,s*n*2)}function mX(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const yX=Math.PI/180,_X=ap(),jC=[0,0,0],vX={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function xX({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:A,far:a}){const y=t/e,w=n?new Yo().orthographic({fovy:r,aspect:y,focalDistance:i,near:A,far:a}):new Yo().perspective({fovy:r,aspect:y,near:A,far:a});if(s){const{left:P=0,right:I=0,top:L=0,bottom:U=0}=s,W=Cc((P+t-I)/2,0,t)-t/2,q=Cc((L+e-U)/2,0,e)-e/2;w[8]-=W*2/t,w[9]+=q*2/e}return w}class tf{constructor(e={}){se(this,"id",void 0),se(this,"x",void 0),se(this,"y",void 0),se(this,"width",void 0),se(this,"height",void 0),se(this,"padding",void 0),se(this,"isGeospatial",void 0),se(this,"zoom",void 0),se(this,"focalDistance",void 0),se(this,"position",void 0),se(this,"modelMatrix",void 0),se(this,"distanceScales",void 0),se(this,"scale",void 0),se(this,"center",void 0),se(this,"cameraPosition",void 0),se(this,"projectionMatrix",void 0),se(this,"viewMatrix",void 0),se(this,"viewMatrixUncentered",void 0),se(this,"viewMatrixInverse",void 0),se(this,"viewProjectionMatrix",void 0),se(this,"pixelProjectionMatrix",void 0),se(this,"pixelUnprojectionMatrix",void 0),se(this,"resolution",void 0),se(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||vX,this.focalDistance=e.focalDistance||1,this.position=e.position||jC,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Nl.WEB_MERCATOR:Nl.WEB_MERCATOR_AUTO_OFFSET:Nl.IDENTITY}equals(e){return e instanceof tf?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Cu(e.projectionMatrix,this.projectionMatrix)&&Cu(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=BR(r,this.pixelProjectionMatrix),[s,A]=i,a=n?A:this.height-A;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,A]=e,a=n?s:this.height-s,y=r&&r*this.distanceScales.unitsPerMeter[2],w=fT([i,a,A],this.pixelUnprojectionMatrix,y),[P,I,L]=this.unprojectPosition(w);return Number.isFinite(A)?[P,I,L]:Number.isFinite(r)?[P,I,r]:[P,I]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=Yl(e);return n[1]=Cc(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?Oh(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),A=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],A[0]),Math.min(r[1],i[1],s[1],A[1]),Math.max(r[0],i[0],s[0],A[0]),Math.max(r[1],i[1],s[1],A[1])]}getDistanceScales(e){return e?zb({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,pX(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=HY({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||zb({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:A}=e;let a=jC;if(s&&(a=A?new Yo(A).transformAsVector(s,[]):s),this.isGeospatial){const y=this.projectPosition([n,r,0]);this.center=new ln(a).scale(this.distanceScales.unitsPerMeter).add(y)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=_X,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:A=75,near:a=.1,far:y=1e3,padding:w=null,focalDistance:P=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Yo().multiplyRight(n).translate(new ln(this.center).negate()),this.projectionMatrix=r||xX({width:this.width,height:this.height,orthographic:i,fovyRadians:s||A*yX,focalDistance:P,padding:w,near:a,far:y});const I=ap();Mh(I,I,this.projectionMatrix),Mh(I,I,this.viewMatrix),this.viewProjectionMatrix=I,this.viewMatrixInverse=kb([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=dX(this.viewMatrixInverse);const L=ap(),U=ap();aT(L,L,[this.width/2,-this.height/2,1]),Wy(L,L,[1,-1,0]),Mh(U,L,this.viewProjectionMatrix),this.pixelProjectionMatrix=U,this.pixelUnprojectionMatrix=kb(ap(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||rr.warn("Pixel project matrix not invertible")()}}se(tf,"displayName","Viewport");class Nu extends tf{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:A=0,nearZMultiplier:a=.1,farZMultiplier:y=1.01,nearZ:w,farZ:P,orthographic:I=!1,projectionMatrix:L,repeat:U=!1,worldOffset:W=0,position:q,padding:ae,legacyMeterSizes:K=!1}=e;let{width:ne,height:ie,altitude:fe=1.5}=e;const ye=Math.pow(2,i);ne=ne||1,ie=ie||1;let Me,He=null;if(L)fe=L[5]/2,Me=Zy(fe);else{e.fovy?(Me=e.fovy,fe=RR(Me)):Me=Zy(fe);let Je;if(ae){const{top:tt=0,bottom:Ne=0}=ae;Je=[0,Cc((tt+ie-Ne)/2,0,ie)-ie/2]}He=QY({width:ne,height:ie,scale:ye,center:q&&[0,0,q[2]*H1(n)],offset:Je,pitch:s,fovy:Me,nearZMultiplier:a,farZMultiplier:y}),Number.isFinite(w)&&(He.near=w),Number.isFinite(P)&&(He.far=P)}let Qe=WY({height:ie,pitch:s,bearing:A,scale:ye,altitude:fe});W&&(Qe=new Yo().translate([512*W,0,0]).multiplyLeft(Qe)),super({...e,width:ne,height:ie,viewMatrix:Qe,longitude:r,latitude:n,zoom:i,...He,fovy:Me,focalDistance:fe}),se(this,"longitude",void 0),se(this,"latitude",void 0),se(this,"pitch",void 0),se(this,"bearing",void 0),se(this,"altitude",void 0),se(this,"fovy",void 0),se(this,"orthographic",void 0),se(this,"_subViewports",void 0),se(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=A,this.altitude=fe,this.fovy=Me,this.orthographic=I,this._subViewports=U?[]:null,this._pseudoMeters=K,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new Nu({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*H1(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/H1(r);return[n,r,i]}addMetersToLngLat(e,n){return DR(e,n)}panByPosition(e,n){const r=fT(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=Pb([],i,pq([],r)),A=Pb([],this.center,s),[a,y]=this.unprojectFlat(A);return{longitude:a,latitude:y}}getBounds(e={}){const n=YY(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:A,zoom:a}=qY({width:r,height:i,bounds:e,...n});return new Nu({width:r,height:i,longitude:s,latitude:A,zoom:a})}}se(Nu,"displayName","WebMercatorViewport");const $C=[0,0,0];function Ex(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Nu){const[i,s,A=0]=t,a=e.getDistanceScales([i,s]);r[2]=A*a.unitsPerMeter[2]}return r}function wX(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:A}=t;return i===ar.DEFAULT&&(i=e.isGeospatial?ar.LNGLAT:ar.CARTESIAN),s===void 0&&(s=i),A===void 0&&(A=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:A}}function NR(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[A,a,y=0]=t;switch(n&&([A,a,y]=td([],[A,a,y,1],n)),r){case ar.LNGLAT:return Ex([A,a,y],e,s);case ar.LNGLAT_OFFSETS:return Ex([A+i[0],a+i[1],y+(i[2]||0)],e,s);case ar.METER_OFFSETS:return Ex(DR(i,[A,a,y]),e,s);case ar.CARTESIAN:default:return e.isGeospatial?[A+i[0],a+i[1],y+i[2]]:e.projectPosition([A,a,y])}}function bX(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:A,fromCoordinateOrigin:a}=wX(e),{autoOffset:y=!0}=e,{geospatialOrigin:w=$C,shaderCoordinateOrigin:P=$C,offsetMode:I=!1}=y?IR(n,r,i):{},L=NR(t,{viewport:n,modelMatrix:s,coordinateSystem:A,coordinateOrigin:a,offsetMode:I});if(I){const U=n.projectPosition(w||P);cR(L,L,U)}return L}const Fh=Math.PI/180,EX=1e3*60*60*24,TX=2440588,SX=2451545,Yy=Fh*23.4397,MX=357.5291,CX=.98560028,PX=280.147,IX=360.9856235;function kX(t,e,n){const r=Fh*-n,i=Fh*e,s=DX(t),A=VX(s),a=FX(s,r)-A.rightAscension;return{azimuth:zX(a,i,A.declination),altitude:OX(a,i,A.declination)}}function HC(t,e,n){const{azimuth:r,altitude:i}=kX(t,e,n);return[Math.sin(r)*Math.cos(i),Math.cos(r)*Math.cos(i),-Math.sin(i)]}function LX(t){return(typeof t=="number"?t:t.getTime())/EX-.5+TX}function DX(t){return LX(t)-SX}function RX(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(Yy)-Math.tan(e)*Math.sin(Yy),Math.cos(n))}function BX(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(Yy)+Math.cos(e)*Math.sin(Yy)*Math.sin(n))}function zX(t,e,n){const r=t,i=e,s=n;return Math.atan2(Math.sin(r),Math.cos(r)*Math.sin(i)-Math.tan(s)*Math.cos(i))}function OX(t,e,n){const r=t,i=e,s=n;return Math.asin(Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos(r))}function FX(t,e){return Fh*(PX+IX*t)-e}function NX(t){return Fh*(MX+CX*t)}function UX(t){const e=t,n=Fh*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e)),r=Fh*102.9372;return e+n+r+Math.PI}function VX(t){const e=NX(t),n=UX(e);return{declination:BX(n,0),rightAscension:RX(n,0)}}class GX extends Db{constructor(e){super(e),se(this,"timestamp",void 0),this.timestamp=e.timestamp}getProjectedLight({layer:e}){const{viewport:n}=e.context;if(n.resolution&&n.resolution>0){const[i,s,A]=HC(this.timestamp,0,0);this.direction=[i,-A,s]}else{const{latitude:i,longitude:s}=n;this.direction=HC(this.timestamp,i,s)}return this}}const WC={blendFunc:[1,0,32771,0],blendEquation:32774};class UR extends uT{constructor(...e){super(...e),se(this,"pickZ",void 0),se(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:A,deviceRect:{x:a,y,width:w,height:P},cullRect:I,effects:L,pass:U="picking",pickZ:W,moduleParameters:q}){const ae=this.gl;this.pickZ=W;const K=this._resetColorEncoder(W),ne=Ql(ae,{scissorTest:!0,scissor:[a,y,w,P],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...WC,blend:!W},()=>super.render({target:A,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:I,effects:L?.filter(fe=>fe.useInPicking),pass:U,isPicking:!0,moduleParameters:q}));return this._colorEncoderState=null,{decodePickingColor:K&&$X.bind(null,K),stats:ne}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:A}=e.props;return this._colorEncoderState?s&&A.includes("draw")&&(Object.assign(i,WC),i.blend=!0,i.blendColor=jX(this._colorEncoderState,e,r)):i.blend=!1,A.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function jX(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,A=r.get(e);return A?(A.viewports.push(n),s=A.a):(s=r.size+1,s<=255?(A={a:s,layer:e,viewports:[n]},r.set(e,A),i[s]=A):(rr.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function $X(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Rf={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Xy=Symbol.for("component"),Vc=Symbol.for("propTypes"),Tx=Symbol.for("deprecatedProps"),m0=Symbol.for("asyncPropDefaults"),Nh=Symbol.for("asyncPropOriginal"),Pc=Symbol.for("asyncPropResolved");function Uh(t,e=()=>!0){return Array.isArray(t)?VR(t,e,[]):e(t)?[t]:[]}function VR(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?VR(i,e,n):e(i)&&n.push(i)}return n}function HX({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let A=0;for(let a=n;A<i;A++)t[a++]=e[A];for(;A<s;)A<s-A?(t.copyWithin(n+A,n,n+A),A*=2):(t.copyWithin(n+A,n,n+s-A),A=s);return t}function QC(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class qC{constructor(e,n){se(this,"name",void 0),se(this,"type",void 0),se(this,"sampleSize",1),se(this,"time",void 0),se(this,"count",void 0),se(this,"samples",void 0),se(this,"lastTiming",void 0),se(this,"lastSampleTime",void 0),se(this,"lastSampleCount",void 0),se(this,"_count",0),se(this,"_time",0),se(this,"_samples",0),se(this,"_startTime",0),se(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=QC(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(QC()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class GR{constructor(e){se(this,"id",void 0),se(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof qC?this.stats[n]=e:this.stats[n]=new qC(n,r)),this.stats[n]}}class WX{constructor(e,n,r){se(this,"id",void 0),se(this,"context",void 0),se(this,"isLoaded",void 0),se(this,"persistent",void 0),se(this,"_loadCount",0),se(this,"_subscribers",new Set),se(this,"_data",void 0),se(this,"_loader",void 0),se(this,"_error",void 0),se(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=Ny(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class QX{constructor({gl:e,protocol:n}){se(this,"protocol",void 0),se(this,"_context",void 0),se(this,"_resources",void 0),se(this,"_consumers",void 0),se(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new WX(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:A}=this;e.startsWith(A)&&(e=e.replace(A,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,A=s[e]=s[e]||{},a=A[n]||{},y=a.resourceId&&this._resources[a.resourceId];y&&(y.unsubscribe(a),this.prune()),r&&(A[n]=a,a.onChange=i,a.resourceId=r.id,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const qX=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,nf={name:"project32",dependencies:[cT],vs:qX},rf={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...NZ},ZX=[cT],YX=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function XX(t){const e=Ng.getDefaultProgramManager(t);for(const n of ZX)e.addDefaultModule(n);for(const n of YX)e.addShaderHook(n);return e}const KX="layerManager.setLayers",JX="layerManager.activateViewport";class eK{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){se(this,"layers",void 0),se(this,"context",void 0),se(this,"resourceManager",void 0),se(this,"_lastRenderedLayers",[]),se(this,"_needsRedraw",!1),se(this,"_needsUpdate",!1),se(this,"_nextLayers",null),se(this,"_debug",!1),se(this,"activateViewport",A=>{Xs(JX,this,A),A&&(this.context.viewport=A)}),this.layers=[],this.resourceManager=new QX({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&XX(e),stats:r||new GR({id:"deck.gl"}),viewport:i||new tf({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new ER,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Xs(KX,this,n,e),this._lastRenderedLayers=e;const r=Uh(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const A of e)r[A.id]?rr.warn("Multiple old layers with same id ".concat(A.id))():r[A.id]=A;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const A of i)if(A.hasUniformTransition()){s="Uniform transition in ".concat(A);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&rr.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let A=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),A=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}A&&this._updateSublayersRecursively(A,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Rf.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Rf.MATCHED,n!==e&&(e.lifecycle=Rf.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Rf.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Rf.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Vl(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Vl(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!Vl(t[s],e[s],n-1))return!1;return!0}return!1}class tK{constructor(e){se(this,"width",void 0),se(this,"height",void 0),se(this,"views",void 0),se(this,"viewState",void 0),se(this,"controllers",void 0),se(this,"timeline",void 0),se(this,"_viewports",void 0),se(this,"_viewportMap",void 0),se(this,"_isUpdating",void 0),se(this,"_needsRedraw",void 0),se(this,"_needsUpdate",void 0),se(this,"_eventManager",void 0),se(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const A=r[s];if(A.containsPixel(i)){const a=e.slice();return a[0]-=A.x,a[1]-=A.y,A.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Uh(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Vl(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):rr.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var A;return(A=this.getView(e.id))===null||A===void 0?void 0:A.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const A={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,A)),i&&i.setProps(A),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],A=this.getViewState(s),a=s.makeViewport({viewState:A,width:this.width,height:this.height});let y=n[s.id];const w=!!s.controller;w&&!y&&(r=!0),(r||!w)&&y&&(y.finalize(),y=null),this.controllers[s.id]=this._updateController(s,A,a,y),a&&this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const nK=/([0-9]+\.?[0-9]*)(%|px)/;function dc(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=nK.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function pc(t,e){return t.relative?Math.round(t.position*e):t.position}function ki(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class F0{constructor(e){se(this,"id",void 0),se(this,"viewportInstance",void 0),se(this,"_x",void 0),se(this,"_y",void 0),se(this,"_width",void 0),se(this,"_height",void 0),se(this,"_padding",void 0),se(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:A="100%",padding:a=null,viewportInstance:y}=e||{};ki(!y||y instanceof tf),this.viewportInstance=y,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=dc(r),this._y=dc(i),this._width=dc(s),this._height=dc(A),this._padding=a&&{left:dc(a.left||0),right:dc(a.right||0),top:dc(a.top||0),bottom:dc(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&Vl(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:pc(this._x,e),y:pc(this._y,n),width:pc(this._width,e),height:pc(this._height,n)};return this._padding&&(r.padding={left:pc(this._padding.left,e),top:pc(this._padding.top,n),right:pc(this._padding.right,e),bottom:pc(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let Vg=class{constructor(e){se(this,"_inProgress",void 0),se(this,"_handle",void 0),se(this,"_timeline",void 0),se(this,"time",void 0),se(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const ZC=()=>{},Ob={BREAK:1,SNAP_TO_END:2,IGNORE:3},rK=t=>t,iK=Ob.BREAK;class sK{constructor(e){se(this,"getControllerState",void 0),se(this,"props",void 0),se(this,"propsInTransition",void 0),se(this,"transition",void 0),se(this,"onViewStateChange",void 0),se(this,"onStateChange",void 0),se(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:A,duration:a,easing:y}}=n,w=y(r/a),P=i.interpolateProps(s,A,w);this.propsInTransition=this.getControllerState({...this.props,...P}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Vg(e.timeline),this.onViewStateChange=e.onViewStateChange||ZC,this.onStateChange=e.onStateChange||ZC}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:A}=this.transition.settings;i={...r,...s===Ob.SNAP_TO_END?A:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Ob.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,A=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(A===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const y={duration:A,easing:n.transitionEasing||rK,interpolator:s,interruption:n.transitionInterruption||iK,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(y),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(n)}}}class jR{constructor(e){se(this,"_propsToCompare",void 0),se(this,"_propsToExtract",void 0),se(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Cu(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];ki(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const oK=["longitude","latitude","zoom","bearing","pitch"],aK=["longitude","latitude","zoom"];class $R extends jR{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:oK,required:aK},super(r.transitionProps),se(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const A=i(e),a=i(n),y=A.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(y),aroundPosition:y,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=kA(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,kA(e.around,n.around,r)))}return i}}const gc={transitionDuration:0},lK=300,Jm=t=>1-(1-t)*(1-t),If={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Ah={};class AK{constructor(e){se(this,"props",void 0),se(this,"state",{}),se(this,"transitionManager",void 0),se(this,"eventManager",void 0),se(this,"onViewStateChange",void 0),se(this,"onStateChange",void 0),se(this,"makeViewport",void 0),se(this,"_controllerState",void 0),se(this,"_events",{}),se(this,"_interactionState",{isDragging:!1}),se(this,"_customEvents",[]),se(this,"_eventStartBlocked",null),se(this,"_panMove",!1),se(this,"invertPan",!1),se(this,"dragMode","rotate"),se(this,"inertia",0),se(this,"scrollZoom",!0),se(this,"dragPan",!0),se(this,"dragRotate",!0),se(this,"doubleClickZoom",!0),se(this,"touchZoom",!0),se(this,"touchRotate",!1),se(this,"keyboard",!0),this.transitionManager=new sK({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?lK:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:A=!0,touchZoom:a=!0,touchRotate:y=!1,keyboard:w=!0}=e,P=!!this.onViewStateChange;this.toggleEvents(If.WHEEL,P&&r),this.toggleEvents(If.PAN,P),this.toggleEvents(If.PINCH,P&&(a||y)),this.toggleEvents(If.TRIPLE_PAN,P&&y),this.toggleEvents(If.DOUBLE_TAP,P&&A),this.toggleEvents(If.KEYBOARD,P&&w),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=A,this.touchZoom=a,this.touchRotate=y,this.keyboard=w}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const A=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:A})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,gc,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,gc,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Jm},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,gc,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Jm},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let A=2/(1+Math.exp(-Math.abs(s*r)));s<0&&A!==0&&(A=1/A);const a=this.controllerState.zoom({pos:n,scale:A});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,gc,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,gc,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Jm},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Ah._startPinchRotation=e.rotation,Ah._lastPinchEvent=e,this.updateViewport(r,gc,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Ah._startPinchRotation-r})}return this.updateViewport(n,gc,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Ah._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Ah;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const A=Math.log2(e.scale),a=(A-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),y=Math.pow(2,A+a*n/2);s=s.zoom({pos:i,scale:y}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:Jm},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Ah._startPinchRotation=null,Ah._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:A}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let y;const w={};switch(e.srcEvent.code){case"Minus":y=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),w.isZooming=!0;break;case"Equal":y=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),w.isZooming=!0;break;case"ArrowLeft":n?(y=a.rotateLeft(s),w.isRotating=!0):(y=a.moveLeft(i),w.isPanning=!0);break;case"ArrowRight":n?(y=a.rotateRight(s),w.isRotating=!0):(y=a.moveRight(i),w.isPanning=!0);break;case"ArrowUp":n?(y=a.rotateUp(A),w.isRotating=!0):(y=a.moveUp(i),w.isPanning=!0);break;case"ArrowDown":n?(y=a.rotateDown(A),w.isRotating=!0):(y=a.moveDown(i),w.isPanning=!0);break;default:return!1}return this.updateViewport(y,this._getTransitionProps(),w),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?gc:e?{...n,transitionInterpolator:new $R({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class uK{constructor(e,n){se(this,"_viewportProps",void 0),se(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const YC=5,cK=1.2;class hK extends uK{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:A,bearing:a=0,pitch:y=0,altitude:w=1.5,position:P=[0,0,0],maxZoom:I=20,minZoom:L=0,maxPitch:U=60,minPitch:W=0,startPanLngLat:q,startZoomLngLat:ae,startRotatePos:K,startBearing:ne,startPitch:ie,startZoom:fe,normalize:ye=!0}=e;ki(Number.isFinite(s)),ki(Number.isFinite(i)),ki(Number.isFinite(A)),super({width:n,height:r,latitude:i,longitude:s,zoom:A,bearing:a,pitch:y,altitude:w,maxZoom:I,minZoom:L,maxPitch:U,minPitch:W,normalize:ye,position:P},{startPanLngLat:q,startZoomLngLat:ae,startRotatePos:K,startBearing:ne,startPitch:ie,startZoom:fe}),se(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:A}=this.getState();if(!i||s===void 0||A===void 0)return this;let a;return e?a=this._getNewRotation(e,i,A,s):a={bearing:s+n,pitch:A+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:A,minZoom:a}=this.getViewportProps();let y=i+Math.log2(r);y=Cc(y,a,A);const w=this.makeViewport({...this.getViewportProps(),zoom:y});return this._getUpdatedState({zoom:y,...w.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Cc(i,r,n);const{maxPitch:s,minPitch:A,pitch:a}=e;e.pitch=Cc(a,A,s);const{normalize:y=!0}=e;return y&&Object.assign(e,XY(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],A=e[1]-n[1],a=e[1],y=n[1],{width:w,height:P}=this.getViewportProps(),I=s/w;let L=0;A>0?Math.abs(P-y)>YC&&(L=A/(y-P)*cK):A<0&&y>YC&&(L=1-a/y),L=Cc(L,-1,1);const{minPitch:U,maxPitch:W}=this.getViewportProps(),q=i+180*I;let ae=r;return L>0?ae=r+L*(W-r):L<0&&(ae=r-L*(U-r)),{pitch:ae,bearing:q}}}class fK extends AK{constructor(...e){super(...e),se(this,"ControllerState",hK),se(this,"transition",{transitionDuration:300,transitionInterpolator:new $R({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),se(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class pT extends F0{get ViewportType(){return Nu}get ControllerType(){return fK}}se(pT,"displayName","MapView");const dK=new dT;function pK(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,s=(r=e.order)!==null&&r!==void 0?r:1/0;return i-s}class gK{constructor(){se(this,"effects",void 0),se(this,"_resolvedEffects",[]),se(this,"_defaultEffects",[]),se(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>pK(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Vl(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),r.push(s)):(s.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof dT)||this._resolvedEffects.push(dK),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class mK extends uT{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const yK="deckRenderer.renderLayers";class _K{constructor(e){se(this,"gl",void 0),se(this,"layerFilter",void 0),se(this,"drawPickingColors",void 0),se(this,"drawLayersPass",void 0),se(this,"pickLayersPass",void 0),se(this,"renderCount",void 0),se(this,"_needsRedraw",void 0),se(this,"renderBuffers",void 0),se(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new mK(e),this.pickLayersPass=new UR(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||Zi.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,Xs(yK,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new Zi(this.gl),new Zi(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const A=s.postRender(this.gl,i);i.inputBuffer=A,i.swapBuffer=A===r[0]?r[1]:r[0]}}}const vK={pickedColor:null,pickedObjectIndex:-1};function xK({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:A,y:a,width:y,height:w}=s;let P=i*i,I=-1,L=0;for(let U=0;U<w;U++){const W=U+a-r,q=W*W;if(q>P)L+=4*y;else for(let ae=0;ae<y;ae++){if(t[L+3]-1>=0){const ne=ae+A-n,ie=ne*ne+q;ie<=P&&(P=ie,I=L)}L+=4}}if(I>=0){const U=t.slice(I,I+4),W=e(U);if(W){const q=Math.floor(I/4/y),ae=I/4-q*y;return{...W,pickedColor:U,pickedX:A+ae,pickedY:a+q}}rr.error("Picked non-existent layer. Is picking buffer corrupt?")()}return vK}function wK({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),A=s.join(",");if(!n.has(A)){const a=e(s);a?n.set(A,{...a,color:s}):rr.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function HR({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let A=e[0];e.length>1&&(A=EK(t?.pickedViewports||e,{x:r,y:i}));let a;if(A){const y=[r-A.x,i-A.y];s!==void 0&&(y[2]=s),a=A.unproject(y)}return{color:null,layer:null,viewport:A,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function bK(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:A,pickedObjectIndex:a}=e,y=A?[A]:[];if(r==="hover"){const I=n.index,L=n.layerId,U=A?A.props.id:null;if(U!==L||a!==I){if(U!==L){const W=i.find(q=>q.props.id===L);W&&y.unshift(W)}n.layerId=U,n.index=a,n.info=null}}const w=HR(t),P=new Map;return P.set(null,w),y.forEach(I=>{let L={...w};I===A&&(L.color=s,L.index=a,L.picked=!0),L=WR({layer:I,info:L,mode:r});const U=L.layer;I===A&&r==="hover"&&(n.info=L),P.set(U.id,L),r==="hover"&&U.updateAutoHighlight(L)}),P}function WR({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function EK(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class TK{constructor(e){se(this,"gl",void 0),se(this,"pickingFBO",void 0),se(this,"depthFBO",void 0),se(this,"pickLayersPass",void 0),se(this,"layerFilter",void 0),se(this,"lastPickedInfo",void 0),se(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new UR(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const A=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,y=A?r.find(L=>L.id===A):null,w=a&&i.find(L=>L.id===a)||i[0],P=w&&w.unproject([e-w.x,n-w.y]);return{...s,...{x:e,y:n,viewport:w,coordinate:P,layer:y}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new Zi(r),Zi.isSupported(r,{colorBufferFloat:!0}))){const i=new Zi(r);i.attach({36064:new Jo(r,{format:lr(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:A=0,depth:a=1,mode:y="query",unproject3D:w,onViewportActive:P,effects:I}){const L=this._getPickable(e),U=D0(this.gl);if(!L)return{result:[],emptyInfo:HR({viewports:r,x:i,y:s,pixelRatio:U})};this._resizeBuffer();const W=ax(this.gl,[i,s],!0),q=[W.x+Math.floor(W.width/2),W.y+Math.floor(W.height/2)],ae=Math.round(A*U),{width:K,height:ne}=this.pickingFBO,ie=this._getPickingRect({deviceX:q[0],deviceY:q[1],deviceRadius:ae,deviceWidth:K,deviceHeight:ne}),fe={x:i-A,y:s-A,width:A*2+1,height:A*2+1};let ye;const Me=[],He=new Set;for(let Qe=0;Qe<a;Qe++){let Je;if(ie){const Ne=this._drawAndSample({layers:L,views:n,viewports:r,onViewportActive:P,deviceRect:ie,cullRect:fe,effects:I,pass:"picking:".concat(y)});Je=xK({...Ne,deviceX:q[0],deviceY:q[1],deviceRadius:ae,deviceRect:ie})}else Je={pickedColor:null,pickedObjectIndex:-1};let tt;if(Je.pickedLayer&&w&&this.depthFBO){const{pickedColors:Ne}=this._drawAndSample({layers:[Je.pickedLayer],views:n,viewports:r,onViewportActive:P,deviceRect:{x:Je.pickedX,y:Je.pickedY,width:1,height:1},cullRect:fe,effects:I,pass:"picking:".concat(y,":z")},!0);Ne[3]&&(tt=Ne[0])}Je.pickedLayer&&Qe+1<a&&(He.add(Je.pickedLayer),Je.pickedLayer.disablePickingIndex(Je.pickedObjectIndex)),ye=bK({pickInfo:Je,lastPickedInfo:this.lastPickedInfo,mode:y,layers:L,viewports:r,x:i,y:s,z:tt,pixelRatio:U});for(const Ne of ye.values())Ne.layer&&Me.push(Ne);if(!Je.pickedColor)break}for(const Qe of He)Qe.restorePickingColors();return{result:Me,emptyInfo:ye.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:A=1,height:a=1,mode:y="query",maxObjects:w=null,onViewportActive:P,effects:I}){const L=this._getPickable(e);if(!L)return[];this._resizeBuffer();const U=D0(this.gl),W=ax(this.gl,[i,s],!0),q=W.x,ae=W.y+W.height,K=ax(this.gl,[i+A,s+a],!0),ne=K.x+K.width,ie=K.y,fe={x:q,y:ie,width:ne-q,height:ae-ie},ye=this._drawAndSample({layers:L,views:n,viewports:r,onViewportActive:P,deviceRect:fe,cullRect:{x:i,y:s,width:A,height:a},effects:I,pass:"picking:".concat(y)}),Me=wK(ye),He=new Map,Qe=Number.isFinite(w);for(let Je=0;Je<Me.length&&!(Qe&&w&&He.size>=w);Je++){const tt=Me[Je];let Ne={color:tt.pickedColor,layer:null,index:tt.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:U};Ne=WR({layer:tt.pickedLayer,info:Ne,mode:y}),He.has(Ne.object)||He.set(Ne.object,Ne)}return Array.from(He.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:A,effects:a,pass:y},w=!1){const P=w?this.depthFBO:this.pickingFBO,I={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:P,deviceRect:s,cullRect:A,effects:a,pass:y,pickZ:w,preRenderStats:{}};for(const ne of a)ne.useInPicking&&(I.preRenderStats[ne.id]=ne.preRender(this.gl,I));const{decodePickingColor:L}=this.pickLayersPass.render(I),{x:U,y:W,width:q,height:ae}=s,K=new(w?Float32Array:Uint8Array)(q*ae*4);return u2(P,{sourceX:U,sourceY:W,sourceWidth:q,sourceHeight:ae,target:K}),{pickedColors:K,decodePickingColor:L}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const A=Math.max(0,e-r),a=Math.max(0,n-r),y=Math.min(i,e+r+1)-A,w=Math.min(s,n+r+1)-a;return y<=0||w<=0?null:{x:A,y:a,width:y,height:w}}}const SK={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class MK{constructor(e){se(this,"el",null),se(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,SK),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var QR={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],A=n.createElement("div"),a="function",y=Math.round,w=Math.abs,P=Date.now;function I(ge,Ee,Fe){return setTimeout(ie(ge,Fe),Ee)}function L(ge,Ee,Fe){return Array.isArray(ge)?(U(ge,Fe[Ee],Fe),!0):!1}function U(ge,Ee,Fe){var ot;if(ge)if(ge.forEach)ge.forEach(Ee,Fe);else if(ge.length!==i)for(ot=0;ot<ge.length;)Ee.call(Fe,ge[ot],ot,ge),ot++;else for(ot in ge)ge.hasOwnProperty(ot)&&Ee.call(Fe,ge[ot],ot,ge)}function W(ge,Ee,Fe){var ot="DEPRECATED METHOD: "+Ee+`
`+Fe+` AT 
`;return function(){var wt=new Error("get-stack-trace"),Wt=wt&&wt.stack?wt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",kn=e.console&&(e.console.warn||e.console.log);return kn&&kn.call(e.console,ot,Wt),ge.apply(this,arguments)}}var q;typeof Object.assign!="function"?q=function(Ee){if(Ee===i||Ee===null)throw new TypeError("Cannot convert undefined or null to object");for(var Fe=Object(Ee),ot=1;ot<arguments.length;ot++){var wt=arguments[ot];if(wt!==i&&wt!==null)for(var Wt in wt)wt.hasOwnProperty(Wt)&&(Fe[Wt]=wt[Wt])}return Fe}:q=Object.assign;var ae=W(function(Ee,Fe,ot){for(var wt=Object.keys(Fe),Wt=0;Wt<wt.length;)(!ot||ot&&Ee[wt[Wt]]===i)&&(Ee[wt[Wt]]=Fe[wt[Wt]]),Wt++;return Ee},"extend","Use `assign`."),K=W(function(Ee,Fe){return ae(Ee,Fe,!0)},"merge","Use `assign`.");function ne(ge,Ee,Fe){var ot=Ee.prototype,wt;wt=ge.prototype=Object.create(ot),wt.constructor=ge,wt._super=ot,Fe&&q(wt,Fe)}function ie(ge,Ee){return function(){return ge.apply(Ee,arguments)}}function fe(ge,Ee){return typeof ge==a?ge.apply(Ee&&Ee[0]||i,Ee):ge}function ye(ge,Ee){return ge===i?Ee:ge}function Me(ge,Ee,Fe){U(tt(Ee),function(ot){ge.addEventListener(ot,Fe,!1)})}function He(ge,Ee,Fe){U(tt(Ee),function(ot){ge.removeEventListener(ot,Fe,!1)})}function Qe(ge,Ee){for(;ge;){if(ge==Ee)return!0;ge=ge.parentNode}return!1}function Je(ge,Ee){return ge.indexOf(Ee)>-1}function tt(ge){return ge.trim().split(/\s+/g)}function Ne(ge,Ee,Fe){if(ge.indexOf&&!Fe)return ge.indexOf(Ee);for(var ot=0;ot<ge.length;){if(Fe&&ge[ot][Fe]==Ee||!Fe&&ge[ot]===Ee)return ot;ot++}return-1}function nt(ge){return Array.prototype.slice.call(ge,0)}function qe(ge,Ee,Fe){for(var ot=[],wt=[],Wt=0;Wt<ge.length;){var kn=Ee?ge[Wt][Ee]:ge[Wt];Ne(wt,kn)<0&&ot.push(ge[Wt]),wt[Wt]=kn,Wt++}return Fe&&(Ee?ot=ot.sort(function(Jt,Cr){return Jt[Ee]>Cr[Ee]}):ot=ot.sort()),ot}function mt(ge,Ee){for(var Fe,ot,wt=Ee[0].toUpperCase()+Ee.slice(1),Wt=0;Wt<s.length;){if(Fe=s[Wt],ot=Fe?Fe+wt:Ee,ot in ge)return ot;Wt++}return i}var Xt=1;function Et(){return Xt++}function fn(ge){var Ee=ge.ownerDocument||ge;return Ee.defaultView||Ee.parentWindow||e}var yt=/mobile|tablet|ip(ad|hone|od)|android/i,bt="ontouchstart"in e,Kt=mt(e,"PointerEvent")!==i,In=bt&&yt.test(navigator.userAgent),En="touch",Er="pen",Jn="mouse",ir="kinect",Ar=25,Nn=1,xr=2,xt=4,nn=8,Mn=1,vt=2,er=4,$n=8,gr=16,or=vt|er,tr=$n|gr,Zr=or|tr,Un=["x","y"],wi=["clientX","clientY"];function Hn(ge,Ee){var Fe=this;this.manager=ge,this.callback=Ee,this.element=ge.element,this.target=ge.options.inputTarget,this.domHandler=function(ot){fe(ge.options.enable,[ge])&&Fe.handler(ot)},this.init()}Hn.prototype={handler:function(){},init:function(){this.evEl&&Me(this.element,this.evEl,this.domHandler),this.evTarget&&Me(this.target,this.evTarget,this.domHandler),this.evWin&&Me(fn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&He(this.element,this.evEl,this.domHandler),this.evTarget&&He(this.target,this.evTarget,this.domHandler),this.evWin&&He(fn(this.element),this.evWin,this.domHandler)}};function Di(ge){var Ee,Fe=ge.options.inputClass;return Fe?Ee=Fe:Kt?Ee=Ze:In?Ee=zi:bt?Ee=X:Ee=Tn,new Ee(ge,oo)}function oo(ge,Ee,Fe){var ot=Fe.pointers.length,wt=Fe.changedPointers.length,Wt=Ee&Nn&&ot-wt===0,kn=Ee&(xt|nn)&&ot-wt===0;Fe.isFirst=!!Wt,Fe.isFinal=!!kn,Wt&&(ge.session={}),Fe.eventType=Ee,zr(ge,Fe),ge.emit("hammer.input",Fe),ge.recognize(Fe),ge.session.prevInput=Fe}function zr(ge,Ee){var Fe=ge.session,ot=Ee.pointers,wt=ot.length;Fe.firstInput||(Fe.firstInput=Ki(Ee)),wt>1&&!Fe.firstMultiple?Fe.firstMultiple=Ki(Ee):wt===1&&(Fe.firstMultiple=!1);var Wt=Fe.firstInput,kn=Fe.firstMultiple,Sr=kn?kn.center:Wt.center,Jt=Ee.center=ct(ot);Ee.timeStamp=P(),Ee.deltaTime=Ee.timeStamp-Wt.timeStamp,Ee.angle=Rn(Sr,Jt),Ee.distance=pi(Sr,Jt),bi(Fe,Ee),Ee.offsetDirection=Ms(Ee.deltaX,Ee.deltaY);var Cr=It(Ee.deltaTime,Ee.deltaX,Ee.deltaY);Ee.overallVelocityX=Cr.x,Ee.overallVelocityY=Cr.y,Ee.overallVelocity=w(Cr.x)>w(Cr.y)?Cr.x:Cr.y,Ee.scale=kn?Ei(kn.pointers,ot):1,Ee.rotation=kn?Ri(kn.pointers,ot):0,Ee.maxPointers=Fe.prevInput?Ee.pointers.length>Fe.prevInput.maxPointers?Ee.pointers.length:Fe.prevInput.maxPointers:Ee.pointers.length,Io(Fe,Ee);var Vn=ge.element;Qe(Ee.srcEvent.target,Vn)&&(Vn=Ee.srcEvent.target),Ee.target=Vn}function bi(ge,Ee){var Fe=Ee.center,ot=ge.offsetDelta||{},wt=ge.prevDelta||{},Wt=ge.prevInput||{};(Ee.eventType===Nn||Wt.eventType===xt)&&(wt=ge.prevDelta={x:Wt.deltaX||0,y:Wt.deltaY||0},ot=ge.offsetDelta={x:Fe.x,y:Fe.y}),Ee.deltaX=wt.x+(Fe.x-ot.x),Ee.deltaY=wt.y+(Fe.y-ot.y)}function Io(ge,Ee){var Fe=ge.lastInterval||Ee,ot=Ee.timeStamp-Fe.timeStamp,wt,Wt,kn,Sr;if(Ee.eventType!=nn&&(ot>Ar||Fe.velocity===i)){var Jt=Ee.deltaX-Fe.deltaX,Cr=Ee.deltaY-Fe.deltaY,Vn=It(ot,Jt,Cr);Wt=Vn.x,kn=Vn.y,wt=w(Vn.x)>w(Vn.y)?Vn.x:Vn.y,Sr=Ms(Jt,Cr),ge.lastInterval=Ee}else wt=Fe.velocity,Wt=Fe.velocityX,kn=Fe.velocityY,Sr=Fe.direction;Ee.velocity=wt,Ee.velocityX=Wt,Ee.velocityY=kn,Ee.direction=Sr}function Ki(ge){for(var Ee=[],Fe=0;Fe<ge.pointers.length;)Ee[Fe]={clientX:y(ge.pointers[Fe].clientX),clientY:y(ge.pointers[Fe].clientY)},Fe++;return{timeStamp:P(),pointers:Ee,center:ct(Ee),deltaX:ge.deltaX,deltaY:ge.deltaY}}function ct(ge){var Ee=ge.length;if(Ee===1)return{x:y(ge[0].clientX),y:y(ge[0].clientY)};for(var Fe=0,ot=0,wt=0;wt<Ee;)Fe+=ge[wt].clientX,ot+=ge[wt].clientY,wt++;return{x:y(Fe/Ee),y:y(ot/Ee)}}function It(ge,Ee,Fe){return{x:Ee/ge||0,y:Fe/ge||0}}function Ms(ge,Ee){return ge===Ee?Mn:w(ge)>=w(Ee)?ge<0?vt:er:Ee<0?$n:gr}function pi(ge,Ee,Fe){Fe||(Fe=Un);var ot=Ee[Fe[0]]-ge[Fe[0]],wt=Ee[Fe[1]]-ge[Fe[1]];return Math.sqrt(ot*ot+wt*wt)}function Rn(ge,Ee,Fe){Fe||(Fe=Un);var ot=Ee[Fe[0]]-ge[Fe[0]],wt=Ee[Fe[1]]-ge[Fe[1]];return Math.atan2(wt,ot)*180/Math.PI}function Ri(ge,Ee){return Rn(Ee[1],Ee[0],wi)+Rn(ge[1],ge[0],wi)}function Ei(ge,Ee){return pi(Ee[0],Ee[1],wi)/pi(ge[0],ge[1],wi)}var Ti={mousedown:Nn,mousemove:xr,mouseup:xt},Ji="mousedown",kt="mousemove mouseup";function Tn(){this.evEl=Ji,this.evWin=kt,this.pressed=!1,Hn.apply(this,arguments)}ne(Tn,Hn,{handler:function(Ee){var Fe=Ti[Ee.type];Fe&Nn&&Ee.button===0&&(this.pressed=!0),Fe&xr&&Ee.which!==1&&(Fe=xt),this.pressed&&(Fe&xt&&(this.pressed=!1),this.callback(this.manager,Fe,{pointers:[Ee],changedPointers:[Ee],pointerType:Jn,srcEvent:Ee}))}});var wn={pointerdown:Nn,pointermove:xr,pointerup:xt,pointercancel:nn,pointerout:nn},Mr={2:En,3:Er,4:Jn,5:ir},fs="pointerdown",mn="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(fs="MSPointerDown",mn="MSPointerMove MSPointerUp MSPointerCancel");function Ze(){this.evEl=fs,this.evWin=mn,Hn.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ne(Ze,Hn,{handler:function(Ee){var Fe=this.store,ot=!1,wt=Ee.type.toLowerCase().replace("ms",""),Wt=wn[wt],kn=Mr[Ee.pointerType]||Ee.pointerType,Sr=kn==En,Jt=Ne(Fe,Ee.pointerId,"pointerId");Wt&Nn&&(Ee.button===0||Sr)?Jt<0&&(Fe.push(Ee),Jt=Fe.length-1):Wt&(xt|nn)&&(ot=!0),!(Jt<0)&&(Fe[Jt]=Ee,this.callback(this.manager,Wt,{pointers:Fe,changedPointers:[Ee],pointerType:kn,srcEvent:Ee}),ot&&Fe.splice(Jt,1))}});var Vr={touchstart:Nn,touchmove:xr,touchend:xt,touchcancel:nn},Cs="touchstart",kr="touchstart touchmove touchend touchcancel";function ri(){this.evTarget=Cs,this.evWin=kr,this.started=!1,Hn.apply(this,arguments)}ne(ri,Hn,{handler:function(Ee){var Fe=Vr[Ee.type];if(Fe===Nn&&(this.started=!0),!!this.started){var ot=Zn.call(this,Ee,Fe);Fe&(xt|nn)&&ot[0].length-ot[1].length===0&&(this.started=!1),this.callback(this.manager,Fe,{pointers:ot[0],changedPointers:ot[1],pointerType:En,srcEvent:Ee})}}});function Zn(ge,Ee){var Fe=nt(ge.touches),ot=nt(ge.changedTouches);return Ee&(xt|nn)&&(Fe=qe(Fe.concat(ot),"identifier",!0)),[Fe,ot]}var Ps={touchstart:Nn,touchmove:xr,touchend:xt,touchcancel:nn},Bi="touchstart touchmove touchend touchcancel";function zi(){this.evTarget=Bi,this.targetIds={},Hn.apply(this,arguments)}ne(zi,Hn,{handler:function(Ee){var Fe=Ps[Ee.type],ot=Si.call(this,Ee,Fe);ot&&this.callback(this.manager,Fe,{pointers:ot[0],changedPointers:ot[1],pointerType:En,srcEvent:Ee})}});function Si(ge,Ee){var Fe=nt(ge.touches),ot=this.targetIds;if(Ee&(Nn|xr)&&Fe.length===1)return ot[Fe[0].identifier]=!0,[Fe,Fe];var wt,Wt,kn=nt(ge.changedTouches),Sr=[],Jt=this.target;if(Wt=Fe.filter(function(Cr){return Qe(Cr.target,Jt)}),Ee===Nn)for(wt=0;wt<Wt.length;)ot[Wt[wt].identifier]=!0,wt++;for(wt=0;wt<kn.length;)ot[kn[wt].identifier]&&Sr.push(kn[wt]),Ee&(xt|nn)&&delete ot[kn[wt].identifier],wt++;if(Sr.length)return[qe(Wt.concat(Sr),"identifier",!0),Sr]}var es=2500,Lr=25;function X(){Hn.apply(this,arguments);var ge=ie(this.handler,this);this.touch=new zi(this.manager,ge),this.mouse=new Tn(this.manager,ge),this.primaryTouch=null,this.lastTouches=[]}ne(X,Hn,{handler:function(Ee,Fe,ot){var wt=ot.pointerType==En,Wt=ot.pointerType==Jn;if(!(Wt&&ot.sourceCapabilities&&ot.sourceCapabilities.firesTouchEvents)){if(wt)H.call(this,Fe,ot);else if(Wt&&he.call(this,ot))return;this.callback(Ee,Fe,ot)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function H(ge,Ee){ge&Nn?(this.primaryTouch=Ee.changedPointers[0].identifier,ee.call(this,Ee)):ge&(xt|nn)&&ee.call(this,Ee)}function ee(ge){var Ee=ge.changedPointers[0];if(Ee.identifier===this.primaryTouch){var Fe={x:Ee.clientX,y:Ee.clientY};this.lastTouches.push(Fe);var ot=this.lastTouches,wt=function(){var Wt=ot.indexOf(Fe);Wt>-1&&ot.splice(Wt,1)};setTimeout(wt,es)}}function he(ge){for(var Ee=ge.srcEvent.clientX,Fe=ge.srcEvent.clientY,ot=0;ot<this.lastTouches.length;ot++){var wt=this.lastTouches[ot],Wt=Math.abs(Ee-wt.x),kn=Math.abs(Fe-wt.y);if(Wt<=Lr&&kn<=Lr)return!0}return!1}var o=mt(A.style,"touchAction"),G=o!==i,Le="compute",Ie="auto",Pe="manipulation",ke="none",We="pan-x",at="pan-y",$e=Dt();function ft(ge,Ee){this.manager=ge,this.set(Ee)}ft.prototype={set:function(ge){ge==Le&&(ge=this.compute()),G&&this.manager.element.style&&$e[ge]&&(this.manager.element.style[o]=ge),this.actions=ge.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ge=[];return U(this.manager.recognizers,function(Ee){fe(Ee.options.enable,[Ee])&&(ge=ge.concat(Ee.getTouchAction()))}),Lt(ge.join(" "))},preventDefaults:function(ge){var Ee=ge.srcEvent,Fe=ge.offsetDirection;if(this.manager.session.prevented){Ee.preventDefault();return}var ot=this.actions,wt=Je(ot,ke)&&!$e[ke],Wt=Je(ot,at)&&!$e[at],kn=Je(ot,We)&&!$e[We];if(wt){var Sr=ge.pointers.length===1,Jt=ge.distance<2,Cr=ge.deltaTime<250;if(Sr&&Jt&&Cr)return}if(!(kn&&Wt)&&(wt||Wt&&Fe&or||kn&&Fe&tr))return this.preventSrc(Ee)},preventSrc:function(ge){this.manager.session.prevented=!0,ge.preventDefault()}};function Lt(ge){if(Je(ge,ke))return ke;var Ee=Je(ge,We),Fe=Je(ge,at);return Ee&&Fe?ke:Ee||Fe?Ee?We:at:Je(ge,Pe)?Pe:Ie}function Dt(){if(!G)return!1;var ge={},Ee=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Fe){ge[Fe]=Ee?e.CSS.supports("touch-action",Fe):!0}),ge}var rn=1,jt=2,dn=4,Qt=8,on=Qt,vn=16,Ot=32;function Oe(ge){this.options=q({},this.defaults,ge||{}),this.id=Et(),this.manager=null,this.options.enable=ye(this.options.enable,!0),this.state=rn,this.simultaneous={},this.requireFail=[]}Oe.prototype={defaults:{},set:function(ge){return q(this.options,ge),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ge){if(L(ge,"recognizeWith",this))return this;var Ee=this.simultaneous;return ge=An(ge,this),Ee[ge.id]||(Ee[ge.id]=ge,ge.recognizeWith(this)),this},dropRecognizeWith:function(ge){return L(ge,"dropRecognizeWith",this)?this:(ge=An(ge,this),delete this.simultaneous[ge.id],this)},requireFailure:function(ge){if(L(ge,"requireFailure",this))return this;var Ee=this.requireFail;return ge=An(ge,this),Ne(Ee,ge)===-1&&(Ee.push(ge),ge.requireFailure(this)),this},dropRequireFailure:function(ge){if(L(ge,"dropRequireFailure",this))return this;ge=An(ge,this);var Ee=Ne(this.requireFail,ge);return Ee>-1&&this.requireFail.splice(Ee,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ge){return!!this.simultaneous[ge.id]},emit:function(ge){var Ee=this,Fe=this.state;function ot(wt){Ee.manager.emit(wt,ge)}Fe<Qt&&ot(Ee.options.event+Mt(Fe)),ot(Ee.options.event),ge.additionalEvent&&ot(ge.additionalEvent),Fe>=Qt&&ot(Ee.options.event+Mt(Fe))},tryEmit:function(ge){if(this.canEmit())return this.emit(ge);this.state=Ot},canEmit:function(){for(var ge=0;ge<this.requireFail.length;){if(!(this.requireFail[ge].state&(Ot|rn)))return!1;ge++}return!0},recognize:function(ge){var Ee=q({},ge);if(!fe(this.options.enable,[this,Ee])){this.reset(),this.state=Ot;return}this.state&(on|vn|Ot)&&(this.state=rn),this.state=this.process(Ee),this.state&(jt|dn|Qt|vn)&&this.tryEmit(Ee)},process:function(ge){},getTouchAction:function(){},reset:function(){}};function Mt(ge){return ge&vn?"cancel":ge&Qt?"end":ge&dn?"move":ge&jt?"start":""}function Se(ge){return ge==gr?"down":ge==$n?"up":ge==vt?"left":ge==er?"right":""}function An(ge,Ee){var Fe=Ee.manager;return Fe?Fe.get(ge):ge}function ii(){Oe.apply(this,arguments)}ne(ii,Oe,{defaults:{pointers:1},attrTest:function(ge){var Ee=this.options.pointers;return Ee===0||ge.pointers.length===Ee},process:function(ge){var Ee=this.state,Fe=ge.eventType,ot=Ee&(jt|dn),wt=this.attrTest(ge);return ot&&(Fe&nn||!wt)?Ee|vn:ot||wt?Fe&xt?Ee|Qt:Ee&jt?Ee|dn:jt:Ot}});function nr(){ii.apply(this,arguments),this.pX=null,this.pY=null}ne(nr,ii,{defaults:{event:"pan",threshold:10,pointers:1,direction:Zr},getTouchAction:function(){var ge=this.options.direction,Ee=[];return ge&or&&Ee.push(at),ge&tr&&Ee.push(We),Ee},directionTest:function(ge){var Ee=this.options,Fe=!0,ot=ge.distance,wt=ge.direction,Wt=ge.deltaX,kn=ge.deltaY;return wt&Ee.direction||(Ee.direction&or?(wt=Wt===0?Mn:Wt<0?vt:er,Fe=Wt!=this.pX,ot=Math.abs(ge.deltaX)):(wt=kn===0?Mn:kn<0?$n:gr,Fe=kn!=this.pY,ot=Math.abs(ge.deltaY))),ge.direction=wt,Fe&&ot>Ee.threshold&&wt&Ee.direction},attrTest:function(ge){return ii.prototype.attrTest.call(this,ge)&&(this.state&jt||!(this.state&jt)&&this.directionTest(ge))},emit:function(ge){this.pX=ge.deltaX,this.pY=ge.deltaY;var Ee=Se(ge.direction);Ee&&(ge.additionalEvent=this.options.event+Ee),this._super.emit.call(this,ge)}});function ea(){ii.apply(this,arguments)}ne(ea,ii,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ke]},attrTest:function(ge){return this._super.attrTest.call(this,ge)&&(Math.abs(ge.scale-1)>this.options.threshold||this.state&jt)},emit:function(ge){if(ge.scale!==1){var Ee=ge.scale<1?"in":"out";ge.additionalEvent=this.options.event+Ee}this._super.emit.call(this,ge)}});function De(){Oe.apply(this,arguments),this._timer=null,this._input=null}ne(De,Oe,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ie]},process:function(ge){var Ee=this.options,Fe=ge.pointers.length===Ee.pointers,ot=ge.distance<Ee.threshold,wt=ge.deltaTime>Ee.time;if(this._input=ge,!ot||!Fe||ge.eventType&(xt|nn)&&!wt)this.reset();else if(ge.eventType&Nn)this.reset(),this._timer=I(function(){this.state=on,this.tryEmit()},Ee.time,this);else if(ge.eventType&xt)return on;return Ot},reset:function(){clearTimeout(this._timer)},emit:function(ge){this.state===on&&(ge&&ge.eventType&xt?this.manager.emit(this.options.event+"up",ge):(this._input.timeStamp=P(),this.manager.emit(this.options.event,this._input)))}});function Ia(){ii.apply(this,arguments)}ne(Ia,ii,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ke]},attrTest:function(ge){return this._super.attrTest.call(this,ge)&&(Math.abs(ge.rotation)>this.options.threshold||this.state&jt)}});function we(){ii.apply(this,arguments)}ne(we,ii,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:or|tr,pointers:1},getTouchAction:function(){return nr.prototype.getTouchAction.call(this)},attrTest:function(ge){var Ee=this.options.direction,Fe;return Ee&(or|tr)?Fe=ge.overallVelocity:Ee&or?Fe=ge.overallVelocityX:Ee&tr&&(Fe=ge.overallVelocityY),this._super.attrTest.call(this,ge)&&Ee&ge.offsetDirection&&ge.distance>this.options.threshold&&ge.maxPointers==this.options.pointers&&w(Fe)>this.options.velocity&&ge.eventType&xt},emit:function(ge){var Ee=Se(ge.offsetDirection);Ee&&this.manager.emit(this.options.event+Ee,ge),this.manager.emit(this.options.event,ge)}});function ko(){Oe.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ne(ko,Oe,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Pe]},process:function(ge){var Ee=this.options,Fe=ge.pointers.length===Ee.pointers,ot=ge.distance<Ee.threshold,wt=ge.deltaTime<Ee.time;if(this.reset(),ge.eventType&Nn&&this.count===0)return this.failTimeout();if(ot&&wt&&Fe){if(ge.eventType!=xt)return this.failTimeout();var Wt=this.pTime?ge.timeStamp-this.pTime<Ee.interval:!0,kn=!this.pCenter||pi(this.pCenter,ge.center)<Ee.posThreshold;this.pTime=ge.timeStamp,this.pCenter=ge.center,!kn||!Wt?this.count=1:this.count+=1,this._input=ge;var Sr=this.count%Ee.taps;if(Sr===0)return this.hasRequireFailures()?(this._timer=I(function(){this.state=on,this.tryEmit()},Ee.interval,this),jt):on}return Ot},failTimeout:function(){return this._timer=I(function(){this.state=Ot},this.options.interval,this),Ot},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==on&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ds(ge,Ee){return Ee=Ee||{},Ee.recognizers=ye(Ee.recognizers,ds.defaults.preset),new ta(ge,Ee)}ds.VERSION="2.0.7",ds.defaults={domEvents:!1,touchAction:Le,enable:!0,inputTarget:null,inputClass:null,preset:[[Ia,{enable:!1}],[ea,{enable:!1},["rotate"]],[we,{direction:or}],[nr,{direction:or},["swipe"]],[ko],[ko,{event:"doubletap",taps:2},["tap"]],[De]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ka=1,La=2;function ta(ge,Ee){this.options=q({},ds.defaults,Ee||{}),this.options.inputTarget=this.options.inputTarget||ge,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ge,this.input=Di(this),this.touchAction=new ft(this,this.options.touchAction),Al(this,!0),U(this.options.recognizers,function(Fe){var ot=this.add(new Fe[0](Fe[1]));Fe[2]&&ot.recognizeWith(Fe[2]),Fe[3]&&ot.requireFailure(Fe[3])},this)}ta.prototype={set:function(ge){return q(this.options,ge),ge.touchAction&&this.touchAction.update(),ge.inputTarget&&(this.input.destroy(),this.input.target=ge.inputTarget,this.input.init()),this},stop:function(ge){this.session.stopped=ge?La:ka},recognize:function(ge){var Ee=this.session;if(!Ee.stopped){this.touchAction.preventDefaults(ge);var Fe,ot=this.recognizers,wt=Ee.curRecognizer;(!wt||wt&&wt.state&on)&&(wt=Ee.curRecognizer=null);for(var Wt=0;Wt<ot.length;)Fe=ot[Wt],Ee.stopped!==La&&(!wt||Fe==wt||Fe.canRecognizeWith(wt))?Fe.recognize(ge):Fe.reset(),!wt&&Fe.state&(jt|dn|Qt)&&(wt=Ee.curRecognizer=Fe),Wt++}},get:function(ge){if(ge instanceof Oe)return ge;for(var Ee=this.recognizers,Fe=0;Fe<Ee.length;Fe++)if(Ee[Fe].options.event==ge)return Ee[Fe];return null},add:function(ge){if(L(ge,"add",this))return this;var Ee=this.get(ge.options.event);return Ee&&this.remove(Ee),this.recognizers.push(ge),ge.manager=this,this.touchAction.update(),ge},remove:function(ge){if(L(ge,"remove",this))return this;if(ge=this.get(ge),ge){var Ee=this.recognizers,Fe=Ne(Ee,ge);Fe!==-1&&(Ee.splice(Fe,1),this.touchAction.update())}return this},on:function(ge,Ee){if(ge!==i&&Ee!==i){var Fe=this.handlers;return U(tt(ge),function(ot){Fe[ot]=Fe[ot]||[],Fe[ot].push(Ee)}),this}},off:function(ge,Ee){if(ge!==i){var Fe=this.handlers;return U(tt(ge),function(ot){Ee?Fe[ot]&&Fe[ot].splice(Ne(Fe[ot],Ee),1):delete Fe[ot]}),this}},emit:function(ge,Ee){this.options.domEvents&&na(ge,Ee);var Fe=this.handlers[ge]&&this.handlers[ge].slice();if(!(!Fe||!Fe.length)){Ee.type=ge,Ee.preventDefault=function(){Ee.srcEvent.preventDefault()};for(var ot=0;ot<Fe.length;)Fe[ot](Ee),ot++}},destroy:function(){this.element&&Al(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Al(ge,Ee){var Fe=ge.element;if(Fe.style){var ot;U(ge.options.cssProps,function(wt,Wt){ot=mt(Fe.style,Wt),Ee?(ge.oldCssProps[ot]=Fe.style[ot],Fe.style[ot]=wt):Fe.style[ot]=ge.oldCssProps[ot]||""}),Ee||(ge.oldCssProps={})}}function na(ge,Ee){var Fe=n.createEvent("Event");Fe.initEvent(ge,!0,!0),Fe.gesture=Ee,Ee.target.dispatchEvent(Fe)}q(ds,{INPUT_START:Nn,INPUT_MOVE:xr,INPUT_END:xt,INPUT_CANCEL:nn,STATE_POSSIBLE:rn,STATE_BEGAN:jt,STATE_CHANGED:dn,STATE_ENDED:Qt,STATE_RECOGNIZED:on,STATE_CANCELLED:vn,STATE_FAILED:Ot,DIRECTION_NONE:Mn,DIRECTION_LEFT:vt,DIRECTION_RIGHT:er,DIRECTION_UP:$n,DIRECTION_DOWN:gr,DIRECTION_HORIZONTAL:or,DIRECTION_VERTICAL:tr,DIRECTION_ALL:Zr,Manager:ta,Input:Hn,TouchAction:ft,TouchInput:zi,MouseInput:Tn,PointerEventInput:Ze,TouchMouseInput:X,SingleTouchInput:ri,Recognizer:Oe,AttrRecognizer:ii,Tap:ko,Pan:nr,Swipe:we,Pinch:ea,Rotate:Ia,Press:De,on:Me,off:He,each:U,merge:K,extend:ae,assign:q,inherit:ne,bindFn:ie,prefixed:mt});var Yr=typeof e<"u"?e:typeof self<"u"?self:{};Yr.Hammer=ds,typeof i=="function"&&i.amd?i(function(){return ds}):t.exports?t.exports=ds:e[r]=ds})(window,document,"Hammer")})(QR);var Gg=QR.exports;const CK=G_(Gg),mA=$3({__proto__:null,default:CK},[Gg]),qR=1,ZR=2,Fb=4,PK={mousedown:qR,mousemove:ZR,mouseup:Fb};function IK(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function kK(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(IK(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function LK(t){t.prototype.handler=function(n){let r=PK[n.type];r&qR&&n.button>=0&&(this.pressed=!0),r&ZR&&n.which===0&&(r=Fb),this.pressed&&(r&Fb&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}kK(Gg.PointerEventInput);LK(Gg.MouseInput);const DK=Gg.Manager;class c2{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const RK=mA?[[mA.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[mA.Rotate,{enable:!1}],[mA.Pinch,{enable:!1}],[mA.Swipe,{enable:!1}],[mA.Pan,{threshold:0,enable:!1}],[mA.Press,{enable:!1}],[mA.Tap,{event:"doubletap",taps:2,enable:!1}],[mA.Tap,{event:"anytap",enable:!1}],[mA.Tap,{enable:!1}]]:null,XC={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},BK={doubletap:["tap"]},zK={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},gT={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},OK={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},KC={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},FK=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",qf=typeof window<"u"?window:global;let Nb=!1;try{const t={get passive(){return Nb=!0,!0}};qf.addEventListener("test",null,t),qf.removeEventListener("test",null)}catch{Nb=!1}const NK=FK.indexOf("firefox")!==-1,{WHEEL_EVENTS:UK}=gT,JC="wheel",eP=4.000244140625,VK=40,GK=.25;class jK extends c2{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;qf.WheelEvent&&(NK&&i.deltaMode===qf.WheelEvent.DOM_DELTA_PIXEL&&(s/=qf.devicePixelRatio),i.deltaMode===qf.WheelEvent.DOM_DELTA_LINE&&(s*=VK)),s!==0&&s%eP===0&&(s=Math.floor(s/eP)),i.shiftKey&&s&&(s=s*GK),this.callback({type:JC,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(UK),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,Nb?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===JC&&(this.options.enable=n)}}const{MOUSE_EVENTS:$K}=gT,tP="pointermove",nP="pointerover",rP="pointerout",iP="pointerenter",sP="pointerleave";class HK extends c2{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat($K),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===tP&&(this.enableMoveEvent=n),e===nP&&(this.enableOverEvent=n),e===rP&&(this.enableOutEvent=n),e===iP&&(this.enableEnterEvent=n),e===sP&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(nP,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(rP,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(iP,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(sP,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(tP,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:WK}=gT,oP="keydown",aP="keyup";class QK extends c2{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:oP,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:aP,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(WK),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===oP&&(this.enableDownEvent=n),e===aP&&(this.enableUpEvent=n)}}const lP="contextmenu";class qK extends c2{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:lP,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===lP&&(this.options.enable=n)}}const Ub=1,Ky=2,Vb=4,ZK={pointerdown:Ub,pointermove:Ky,pointerup:Vb,mousedown:Ub,mousemove:Ky,mouseup:Vb},YK=1,XK=2,KK=3,JK=0,eJ=1,tJ=2,nJ=1,rJ=2,iJ=4;function sJ(t){const e=ZK[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,A=!1,a=!1;return e===Vb||e===Ky&&!Number.isFinite(n)?(s=i===YK,A=i===XK,a=i===KK):e===Ky?(s=!!(n&nJ),A=!!(n&iJ),a=!!(n&rJ)):e===Ub&&(s=r===JK,A=r===eJ,a=r===tJ),{leftButton:s,middleButton:A,rightButton:a}}function oJ(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,A={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:A}}const Sx={srcElement:"root",priority:0};class aJ{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:A,handlersByElement:a}=this;let y=Sx;typeof r=="string"||r&&r.addEventListener?y={...Sx,srcElement:r}:r&&(y={...Sx,...r});let w=a.get(y.srcElement);w||(w=[],a.set(y.srcElement,w));const P={type:e,handler:n,srcElement:y.srcElement,priority:y.priority};i&&(P.once=!0),s&&(P.passive=!0),A.push(P),this._active=this._active||!P.passive;let I=w.length-1;for(;I>=0&&!(w[I].priority>=P.priority);)I--;w.splice(I+1,0,P)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const A=r[s];if(A.type===e&&A.handler===n){r.splice(s,1);const a=i.get(A.srcElement);a.splice(a.indexOf(A),1),a.length===0&&i.delete(A.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},A=()=>{e.handled=!0,i=!0},a=[];for(let y=0;y<r.length;y++){const{type:w,handler:P,once:I}=r[y];if(P({...e,type:w,stopPropagation:s,stopImmediatePropagation:A}),I&&a.push(r[y]),i)break}for(let y=0;y<a.length;y++){const{type:w,handler:P}=a[y];this.remove(w,P)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...sJ(e),...oJ(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const lJ={events:null,recognizers:null,recognizerOptions:{},Manager:DK,touchAction:"none",tabIndex:0};class AJ{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,A=zK[s.type];A&&this.manager.emit(A,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...lJ,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||RK}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(XC).forEach(i=>{const s=this.manager.get(i);s&&XC[i].forEach(A=>{s.recognizeWith(A)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const A=n.recognizerOptions[i];delete A.enable,s.set(A)}}this.wheelInput=new jK(e,this._onOtherEvent,{enable:!1}),this.moveInput=new HK(e,this._onOtherEvent,{enable:!1}),this.keyInput=new QK(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new qK(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=BK[e];s&&!this.options.recognizers&&s.forEach(A=>{const a=r.get(A);n?(a.requireFailure(e),i.dropRequireFailure(A)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const P in e)this._addEventHandler(P,e[P],r,i,s);return}const{manager:A,events:a}=this,y=KC[e]||e;let w=a.get(y);w||(w=new aJ(this),a.set(y,w),w.recognizerName=OK[y]||y,A&&A.on(y,w.handleEvent)),w.add(e,n,r,i,s),w.isEmpty()||this._toggleRecognizer(w.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const A in e)this._removeEventHandler(A,e[A]);return}const{events:r}=this,i=KC[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:A}=s;let a=!1;for(const y of r.values())if(y.recognizerName===A&&!y.isEmpty()){a=!0;break}a||this._toggleRecognizer(A,!1)}}}function uh(){}const uJ=({isDragging:t})=>t?"grabbing":"grab",YR={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:uh,onResize:uh,onViewStateChange:uh,onInteractionStateChange:uh,onBeforeRender:uh,onAfterRender:uh,onLoad:uh,onError:t=>rr.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:uJ,getTooltip:null,debug:!1,drawPickingColors:!1};class Vh{constructor(e){se(this,"props",void 0),se(this,"width",0),se(this,"height",0),se(this,"userData",{}),se(this,"canvas",null),se(this,"viewManager",null),se(this,"layerManager",null),se(this,"effectManager",null),se(this,"deckRenderer",null),se(this,"deckPicker",null),se(this,"eventManager",null),se(this,"tooltip",null),se(this,"metrics",void 0),se(this,"animationLoop",void 0),se(this,"stats",void 0),se(this,"viewState",void 0),se(this,"cursorState",void 0),se(this,"_needsRedraw",void 0),se(this,"_pickRequest",void 0),se(this,"_lastPointerDownInfo",null),se(this,"_metricsCounter",void 0),se(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),se(this,"_onEvent",n=>{const r=R5[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),A=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:a}=A,y=a&&(a[r.handler]||a.props[r.handler]),w=this.props[r.handler];let P=!1;y&&(P=y.call(a,A,n)),!P&&w&&w(A,n)}),se(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...YR,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&rr.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),Vj()==="IE"&&rr.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new GR({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&O0.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,A,a,y;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(A=this.deckPicker)===null||A===void 0||A.finalize(),this.deckPicker=null,(a=this.eventManager)===null||a===void 0||a.destroy(),this.eventManager=null,(y=this.tooltip)===null||y===void 0||y.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var w;(w=this.canvas.parentElement)===null||w===void 0||w.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&rr.removed("onLayerHover","onHover")(),"onLayerClick"in e&&rr.removed("onLayerClick","onClick")(),e.initialViewState&&!Vl(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),A=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||A,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return ki(this.viewManager),this.viewManager.views}getViewports(e){return ki(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){ki(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),ki(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,s=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||s!==this.height){var A,a;this.width=i,this.height=s,(A=this.viewManager)===null||A===void 0||A.setProps({width:i,height:s}),(a=this.layerManager)===null||a===void 0||a.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:A,onError:a,onBeforeRender:y,onAfterRender:w,useDevicePixels:P}=e;return new fQ({width:n,height:r,useDevicePixels:P,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:I=>kD({...s,...I,canvas:this.canvas,debug:A,onContextLost:()=>this._onContextLost()}),onInitialize:I=>this._setGLContext(I.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:y,onAfterRender:w,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new pT({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,A=!1;for(const a of r){var n;s=a,A=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||A}if(!A&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,XE(e,{enable:!0,copyState:!0})),this.tooltip=new MK(this.canvas),zu(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new ER;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new AJ(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in R5)this.eventManager.on(i,this._onEvent);this.viewManager=new tK({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new eK(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new gK,this.deckRenderer=new _K(e),this.deckPicker=new TK(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;zu(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),rr.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=bh.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}se(Vh,"defaultProps",YR);se(Vh,"VERSION",r$);class Mx{constructor(e,n){se(this,"opts",void 0),se(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const A=n.elementOffset||0;for(let a=0;a<i;++a)s[a]=r[A+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function cJ(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function W1(t){return t.stride||t.size*t.bytesPerElement}function XR(t,e){e.offset&&rr.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=W1(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function hJ(t,e){const n=XR(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class fJ{constructor(e,n,r){se(this,"gl",void 0),se(this,"id",void 0),se(this,"size",void 0),se(this,"settings",void 0),se(this,"value",void 0),se(this,"doublePrecision",void 0),se(this,"_buffer",void 0),se(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:A}=n;A=Number.isFinite(A)?[A]:A||new Array(this.size).fill(0);let a;s?a=5126:!i&&n.isIndexed?a=e&&GD(e,Qr.ELEMENT_INDEX_UINT32)?5125:5123:a=i||5126;let y=cJ(i||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(y=Float32Array),this.value=null,this.settings={...n,defaultType:y,defaultValue:A,logicalType:i,type:a,size:this.size,bytesPerElement:y.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new Br(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*W1(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),O0.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=hJ(this.getAccessor(),n||{});return r[e]=new Mx(this,s.high),r["".concat(e,"64Low")]=i?new Mx(this,s.low):new Float32Array(this.size),r}if(n){const r=XR(this.getAccessor(),n);return{[e]:new Mx(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const A=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let y=0;y<s;)for(let w=0;w<i;w++){const P=n[y++];P<A[w]&&(A[w]=P),P>a[w]&&(a[w]=P)}e=[A,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof Br?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const A=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(A?2:1),i.stride=W1(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=W1(i);const{buffer:A,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=bx(s,i));const y=s.byteLength+a+i.stride*2;A.byteLength<y&&A.reallocate(y),A.setAccessor(null),A.subData({data:s,offset:a}),i.type=r.type||A.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?bx(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=O0.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:A,byteOffset:a}=this;return A.byteLength<s.byteLength+a&&(A.reallocate(s.byteLength+a),n&&i&&A.subData({data:i instanceof Float64Array?bx(i,this):i,offset:a})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&rr.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let A=s;for(;--A>=0;)n[r+A]=i[A];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let A=s;for(;--A>=0;)n[r+A]=Number.isFinite(e[A])?e[A]:i[A]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const AP=[],uP=[];function nd(t,e=0,n=1/0){let r=AP;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(uP.length=t.length,r=uP):r=AP,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function KR(t){return t&&t[Symbol.asyncIterator]}function JR(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:A}=e,a=t.BYTES_PER_ELEMENT,y=r?r/a:n,w=i?i/a:0,P=Math.floor((t.length-w)/y);return(I,{index:L,target:U})=>{if(!s){const K=L*y+w;for(let ne=0;ne<n;ne++)U[ne]=t[K+ne];return U}const W=s[L],q=s[L+1]||P;let ae;if(A){ae=new Array(q-W);for(let K=W;K<q;K++){const ne=K*y+w;U=new Array(n);for(let ie=0;ie<n;ie++)U[ie]=t[ne+ie];ae[K-W]=U}}else if(y===n)ae=t.subarray(W*n+w,q*n+w);else{ae=new t.constructor((q-W)*n);let K=0;for(let ne=W;ne<q;ne++){const ie=ne*y+w;for(let fe=0;fe<n;fe++)ae[K++]=t[ie+fe]}}return ae}}const dJ=[],Q1=[[0,1/0]];function pJ(t,e){if(t===Q1||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const A=t[s];A[1]<e[0]?(n.push(A),i=s+1):A[0]>e[1]?n.push(A):e=[Math.min(A[0],e[0]),Math.max(A[1],e[1])]}return n.splice(i,0,e),n}function Cx(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,A=t.end||n.length,a=e.length,y=A-r;if(a>y){n.set(e.subarray(0,y),r);return}if(n.set(e,r),!s)return;let w=a;for(;w<y;){const P=s(w,e);for(let I=0;I<i;I++)n[r+w]=P[I]||0,w++}}function gJ({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return Cx({source:t,target:e,size:n,getData:r}),e;let A=0,a=0;const y=r&&((P,I)=>r(P+a,I)),w=Math.min(i.length,s.length);for(let P=1;P<w;P++){const I=i[P]*n,L=s[P]*n;Cx({source:t.subarray(A,I),target:e,start:a,end:L,size:n,getData:y}),A=I,a=L}return a<e.length&&Cx({source:[],target:e,start:a,size:n,getData:y}),e}const mJ={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function eB(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...mJ[n],...e,...t,type:n}}function tB(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function nB(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function rB(t){t.push(t.shift())}function mT(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,A=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*A}function iB({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=A=>A}){const A=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*A,y=n.byteOffset,w=n.startIndices,P=i&&w,I=mT(n,e),L=n.isConstant;if(!P&&r>=I)return;const U=L?n.value:n.getBuffer().getData({srcByteOffset:y});if(n.settings.normalized&&!L){const K=s;s=(ne,ie)=>n.normalizeConstant(K(ne,ie))}const W=L?(K,ne)=>s(U,ne):(K,ne)=>s(U.subarray(K,K+a),ne),q=t.getData({length:r}),ae=new Float32Array(I);gJ({source:q,target:ae,sourceStartIndices:i,targetStartIndices:w,size:a,getData:W}),t.byteLength<ae.byteLength+y&&t.reallocate(ae.byteLength+y),t.subData({data:ae,offset:y})}class yT extends fJ{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Q1}),se(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return eB(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=pJ(this.state.updateRanges,[r,i])}else this.state.updateRanges=Q1}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=dJ}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==Q1),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:A,noAlloc:a}}=this;let y=!0;if(A){for(const[w,P]of s)A.call(i,this,{data:n,startRow:w,endRow:P,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[w,P]of s){const I=Number.isFinite(w)?this.getVertexOffset(w):0,L=Number.isFinite(P)?this.getVertexOffset(P):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:I,endOffset:L})}this._checkAttributeArray()}else y=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),y}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const A=e;ki(ArrayBuffer.isView(A.value),"invalid ".concat(i.accessor));const a=!!A.size&&A.size!==this.size;return r.binaryAccessor=JR(A.value,{size:A.size||this.size,stride:A.stride,offset:A.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:A}){if(e.constant)return;const{settings:a,state:y,value:w,size:P,startIndices:I}=e,{accessor:L,transform:U}=a,W=y.binaryAccessor||(typeof L=="function"?L:s[L]);ki(typeof W=="function",'accessor "'.concat(L,'" is not a function'));let q=e.getVertexOffset(r);const{iterable:ae,objectInfo:K}=nd(n,r,i);for(const ne of ae){K.index++;let ie=W(ne,K);if(U&&(ie=U.call(this,ie)),I){const fe=(K.index<I.length-1?I[K.index+1]:A)-I[K.index];if(ie&&Array.isArray(ie[0])){let ye=q;for(const Me of ie)e._normalizeValue(Me,w,ye),ye+=P}else ie&&ie.length>P?w.set(ie,q):(e._normalizeValue(ie,K.target,0),HX({target:w,source:K.target,start:q,count:fe}));q+=fe*P}else e._normalizeValue(ie,w,q),q+=P}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class yJ{constructor({gl:e,attribute:n,timeline:r}){se(this,"gl",void 0),se(this,"type","interpolation"),se(this,"attributeInTransition",void 0),se(this,"settings",void 0),se(this,"attribute",void 0),se(this,"transition",void 0),se(this,"currentStartIndices",void 0),se(this,"currentLength",void 0),se(this,"transform",void 0),se(this,"buffers",void 0),this.gl=e,this.transition=new Vg(r),this.attribute=n,this.attributeInTransition=new yT(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=vJ(e,n);const i={byteLength:0,usage:35050};this.buffers=[new Br(e,i),new Br(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;rB(i);const A={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)iB({buffer:a,...A});this.currentStartIndices=s.startIndices,this.currentLength=mT(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:tB(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const _J=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function vJ(t,e){const n=nB(e.size);return new AT(t,{vs:_J,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class xJ{constructor({gl:e,attribute:n,timeline:r}){se(this,"gl",void 0),se(this,"type","spring"),se(this,"attributeInTransition",void 0),se(this,"settings",void 0),se(this,"attribute",void 0),se(this,"transition",void 0),se(this,"currentStartIndices",void 0),se(this,"currentLength",void 0),se(this,"texture",void 0),se(this,"framebuffer",void 0),se(this,"transform",void 0),se(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Vg(r),this.attribute=n,this.attributeInTransition=new yT(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=bJ(e),this.framebuffer=EJ(e,this.texture),this.transform=wJ(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new Br(e,i),new Br(e,i),new Br(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,A={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)iB({buffer:a,...A});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=mT(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:tB(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const A=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:A.stiffness,damping:A.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),rB(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),u2(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function wJ(t,e,n){const r=nB(e.size);return new AT(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function bJ(t){return new Jo(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function EJ(t,e){return new Zi(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const TJ={interpolation:yJ,spring:xJ};class SJ{constructor(e,{id:n,timeline:r}){se(this,"id",void 0),se(this,"isSupported",void 0),se(this,"gl",void 0),se(this,"timeline",void 0),se(this,"transitions",void 0),se(this,"needsRedraw",void 0),se(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=AT.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],A=s.getTransitionSetting(n);A&&this._updateAttribute(i,s,A)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){rr.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const A=TJ[r.type];A?this.transitions[e]=new A({attribute:n,timeline:this.timeline,gl:this.gl}):(rr.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const cP="attributeManager.invalidate",MJ="attributeManager.updateStart",CJ="attributeManager.updateEnd",PJ="attribute.updateStart",IJ="attribute.allocate",kJ="attribute.updateEnd";class LJ{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){se(this,"id",void 0),se(this,"gl",void 0),se(this,"attributes",void 0),se(this,"updateTriggers",void 0),se(this,"needsRedraw",void 0),se(this,"userData",void 0),se(this,"stats",void 0),se(this,"attributeTransitionManager",void 0),se(this,"mergeBoundsMemoized",Ug(mX)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new SJ(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);Xs(cP,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Xs(cP,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:A={},context:a={}}){let y=!1;Xs(MJ,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const w in this.attributes){const P=this.attributes[w],I=P.settings.accessor;P.startIndices=r,P.numInstances=n,s[w]&&rr.removed("props.".concat(w),"data.attributes.".concat(w))(),P.setExternalBuffer(A[w])||P.setBinaryValue(typeof I=="string"?A[I]:void 0,e.startIndices)||typeof I=="string"&&!A[I]&&P.setConstantValue(s[I])||P.needsUpdate()&&(y=!0,this._updateAttribute({attribute:P,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||P.needsRedraw()}y&&Xs(CJ,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const A=n[s];A.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=A)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new yT(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(A=>{const a=r[A];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(Xs(PJ,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&Xs(IJ,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,Xs(kJ,n,r))}}class DJ extends Vg{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,A=s(e/i);this._value=kA(n,r,A)}}const hP=1e-5;function fP(t,e,n,r,i){const s=e-t,a=(n-e)*i,y=-s*r;return a+y+s+e}function RJ(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let A=0;A<n.length;A++)s[A]=fP(t[A],e[A],n[A],r,i);return s}return fP(t,e,n,r,i)}function dP(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class BJ extends Vg{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:A=e}=this;let a=RJ(s,A,n,r,i);const y=dP(a,n),w=dP(a,A);y<hP&&w<hP&&(a=n,this.end()),this._prevValue=A,this._currValue=a}}const zJ={interpolation:DJ,spring:BJ};class OJ{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const y=s.get(e),{value:w=y.settings.fromValue}=y;n=w,this.remove(e)}if(i=eB(i),!i)return;const A=zJ[i.type];if(!A){rr.error("unsupported transition type '".concat(i.type,"'"))();return}const a=new A(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function FJ(t){const e=t[Vc];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function NJ(t,e){const n=sB({newProps:t,oldProps:e,propTypes:t[Vc],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=VJ(t,e);let i=!1;return r||(i=GJ(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:jJ(t,e),transitionsChanged:UJ(t,e)}}function UJ(t,e){if(!t.transitions)return!1;const n={},r=t[Vc];let i=!1;for(const s in t.transitions){const A=r[s],a=A&&A.type;(a==="number"||a==="color"||a==="array")&&Gb(t[s],e[s],A)&&(n[s]=!0,i=!0)}return i?n:!1}function sB({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const A=Gb(t[s],e[s],r[s]);if(A)return"".concat(i,".").concat(s," ").concat(A)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const A=Gb(t[s],e[s],r[s]);if(A)return"".concat(i,".").concat(s," ").concat(A)}}return!1}function Gb(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function VJ(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function GJ(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&pP(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&pP(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function jJ(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function pP(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},sB({oldProps:i,newProps:r,triggerName:n})}const $J="count(): argument not an object",HJ="count(): argument not a container";function WJ(t){if(!qJ(t))throw new Error($J);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(QJ(t))return Object.keys(t).length;throw new Error(HJ)}function QJ(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function qJ(t){return t!==null&&typeof t=="object"}function jb(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const ZJ={10241:9987,10240:9729,10242:33071,10243:33071},$b={};function YJ(t,e,n,r){if(n instanceof Jo)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const s=new Jo(e,{...n,parameters:{...ZJ,...i,...r}});return $b[s.id]=t,s}function XJ(t,e){!e||!(e instanceof Jo)||$b[e.id]===t&&(e.delete(),delete $b[e.id])}const KJ={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Hb(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Vl(t,e,1)}},accessor:{validate(t,e){const n=Jy(t);return n==="function"||n===Jy(e.value)},equal(t,e,n){return typeof e=="function"?!0:Vl(t,e,1)}},array:{validate(t,e){return e.optional&&!t||Hb(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Vl(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Vl(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:YJ(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{XJ(n.id,t)}}};function JJ(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const A=s?.deprecatedFor;if(A)r[i]=Array.isArray(A)?A:[A];else{const a=eee(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function eee(t,e){switch(Jy(e)){case"object":return Ud(t,e);case"array":return Ud(t,{type:"array",value:e,compare:!1});case"boolean":return Ud(t,{type:"boolean",value:e});case"number":return Ud(t,{type:"number",value:e});case"function":return Ud(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Ud(t,e){return"type"in e?{name:t,...KJ[e.type],...e}:"value"in e?{name:t,type:Jy(e.value),...e}:{name:t,type:"object",value:e}}function Hb(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Jy(t){return Hb(t)?"array":t===null?"null":typeof t}function tee(t,e){let n;for(let s=e.length-1;s>=0;s--){const A=e[s];"extensions"in A&&(n=A.extensions)}const r=Wb(t.constructor,n),i=Object.create(r);i[Xy]=t,i[Nh]={},i[Pc]={};for(let s=0;s<e.length;++s){const A=e[s];for(const a in A)i[a]=A[a]}return Object.freeze(i),i}const nee="_mergedDefaultProps";function Wb(t,e){let n=nee;if(e)for(const i of e){const s=i.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const r=oB(t,n);return r||(t[n]=ree(t,e||[]))}function ree(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=Wb(r),s=oB(t,"defaultProps")||{},A=JJ(s),a=Object.assign(Object.create(null),i,A.defaultProps),y=Object.assign(Object.create(null),i?.[Vc],A.propTypes),w=Object.assign(Object.create(null),i?.[Tx],A.deprecatedProps);for(const P of e){const I=Wb(P.constructor);I&&(Object.assign(a,I),Object.assign(y,I[Vc]),Object.assign(w,I[Tx]))}return iee(a,t),oee(a,y),see(a,w),a[Vc]=y,a[Tx]=w,e.length===0&&!_T(t,"_propTypes")&&(t._propTypes=y),a}function iee(t,e){const n=lee(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function see(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])_T(this,s)||(this[s]=r);rr.deprecated(i,e[n].join("/"))()}})}function oee(t,e){const n={},r={};for(const i in e){const s=e[i],{name:A,value:a}=s;s.async&&(n[A]=a,r[A]=aee(A))}t[m0]=n,t[Nh]={},Object.defineProperties(t,r)}function aee(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||KR(e)?this[Nh][t]=e:this[Pc][t]=e},get(){if(this[Pc]){if(t in this[Pc])return this[Pc][t]||this[m0][t];if(t in this[Nh]){const e=this[Xy]&&this[Xy].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[m0][t]}}return this[m0][t]}}}function _T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function oB(t,e){return _T(t,e)&&t[e]}function lee(t){const e=t.componentName;return e||rr.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let Aee=0;class vT{constructor(...e){se(this,"id",void 0),se(this,"props",void 0),se(this,"count",void 0),this.props=tee(this,e),this.id=this.props.id,this.count=Aee++}clone(e){const{props:n}=this,r={};for(const i in n[m0])i in n[Pc]?r[i]=n[Pc][i]:i in n[Nh]&&(r[i]=n[Nh][i]);return new this.constructor({...n,...r,...e})}}se(vT,"componentName","Component");se(vT,"defaultProps",{});const uee=Object.freeze({});class cee{constructor(e){se(this,"component",void 0),se(this,"onAsyncPropUpdated",void 0),se(this,"asyncProps",void 0),se(this,"oldProps",void 0),se(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||uee}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[Xy]||this.component;const n=e[Pc]||{},r=e[Nh]||e,i=e[m0]||{};for(const s in n){const A=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,A),n[s]=this.getAsyncProp(s)}for(const s in r){const A=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,A)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(KR(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],A=0;for await(const a of n){if(!this.component)return;const{dataTransform:y}=this.component.props;y?s=y(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:A,endRow:s.length}]}),A=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Vc];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class hee extends cee{constructor({attributeManager:e,layer:n}){super(n),se(this,"attributeManager",void 0),se(this,"needsRedraw",void 0),se(this,"needsUpdate",void 0),se(this,"subLayers",void 0),se(this,"usesPickingColorCache",void 0),se(this,"hasPickingBuffer",void 0),se(this,"changeFlags",void 0),se(this,"viewport",void 0),se(this,"uniformTransitions",void 0),se(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r?.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const fee="layer.changeFlag",dee="layer.initialize",pee="layer.update",gee="layer.finalize",mee="layer.matched",gP=2**24-1,yee=Object.freeze([]),_ee=Ug(({oldViewport:t,viewport:e})=>t.equals(e));let yA=new Uint8ClampedArray(0);const vee={data:{type:"data",value:yee,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:A}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var a;i={...i,fetch:{...(a=i)===null||a===void 0?void 0:a.fetch,signal:s}}}let y=A.contains(t);return!y&&!i&&(A.add({resourceId:t,data:Ny(t,r),persistent:!1}),y=!0),y?A.subscribe({resourceId:t,onChange:w=>{var P;return(P=n.internalState)===null||P===void 0?void 0:P.reloadAsyncProp(e,w)},consumerId:n.id,requestId:e}):Ny(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:ar.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Kl extends vT{constructor(...e){super(...e),se(this,"internalState",null),se(this,"lifecycle",Rf.NO_STATE),se(this,"context",void 0),se(this,"state",void 0),se(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){ki(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=NR(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,A]=BR(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,A]}unproject(e){return ki(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){ki(this.internalState);const r=this.internalState.viewport||this.context.viewport;return bX(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===ar.DEFAULT||e===ar.LNGLAT||e===ar.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){ki(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:WJ(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=jb(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,A=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==A){this.internalState.hasPickingBuffer=A;const{pickingColors:a,instancePickingColors:y}=n.attributes,w=a||y;w&&(A&&w.constant&&(w.constant=!1,n.invalidate(w.id)),!w.value&&!A&&(w.constant=!0,w.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,A;(s=this.context)===null||s===void 0||(A=s.onError)===null||A===void 0||A.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!_ee({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(yA.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>gP&&rr.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),yA=O0.allocate(yA,n,{size:3,copy:!0,maxCount:Math.max(n,gP)});const i=Math.floor(yA.length/3),s=[];for(let A=r;A<i;A++)this.encodePickingColor(A,s),yA[A*3+0]=s[0],yA[A*3+1]=s[1],yA[A*3+2]=s[2]}e.value=yA.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,A=s&&n.attributes&&n.attributes[s.id];if(A&&A.value){const a=A.value,y=this.encodePickingColor(e);for(let w=0;w<n.length;w++){const P=s.getVertexOffset(w);a[P]===y[0]&&a[P+1]===y[1]&&a[P+2]===y[2]&&this._disablePickingIndex(w)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),A=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(A-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==yA.buffer&&(r.value=yA.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){ki(!this.internalState),ki(Number.isFinite(this.props.coordinateSystem)),Xs(dee,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new hee({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(rr.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new OJ(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Xs(mee,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Xs(pee,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,A=this._updateUniformTransition();i.propsInTransition=A,r.viewport=i.viewport||s,this.props=A;try{const a=this._getUpdateParams(),y=this.getModels();if(r.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const P of this.props.extensions)P.updateState.call(this,a,P);const w=this.getModels()[0]!==y[0];this._postUpdate(a,w)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Xs(gee,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const A=this.props.opacity;n.opacity=Math.pow(A,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,y=a&&a(n)||[0,0];zu(s.gl,{polygonOffset:y}),Ql(s.gl,r,()=>{const w={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const P of this.props.extensions)P.draw.call(this,w,P);this.draw(w)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const A=e[i],a=n[i];A&&Array.isArray(a)&&(n.dataChanged=Array.isArray(A)?a.concat(A):A,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&Xs(fee,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=NJ(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){FJ(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new LJ(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s?.setInstanceCount(this.getNumInstances());const{autoHighlight:A,highlightedObjectIndex:a,highlightColor:y}=r;if(n||i.autoHighlight!==A||i.highlightedObjectIndex!==a||i.highlightColor!==y){const w={};A||(w.pickingSelectedColor=null),Array.isArray(y)&&(w.pickingHighlightColor=y),(n||a!==i.highlightedObjectIndex)&&(w.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(w)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}se(Kl,"defaultProps",vee);se(Kl,"layerName","Layer");const xee="compositeLayer.renderLayers";class Li extends Kl{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:A,getPolygonOffset:a,highlightedObjectIndex:y,autoHighlight:w,highlightColor:P,coordinateSystem:I,coordinateOrigin:L,wrapLongitude:U,positionFormat:W,modelMatrix:q,extensions:ae,fetch:K,operation:ne,_subLayerProps:ie}=this.props,fe={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:A,getPolygonOffset:a,highlightedObjectIndex:y,autoHighlight:w,highlightColor:P,coordinateSystem:I,coordinateOrigin:L,wrapLongitude:U,positionFormat:W,modelMatrix:q,extensions:ae,fetch:K,operation:ne},ye=ie&&e.id&&ie[e.id],Me=ye&&ye.updateTriggers,He=e.id||"sublayer";if(ye){const Qe=this.props[Vc],Je=e.type?e.type._propTypes:{};for(const tt in ye){const Ne=Je[tt]||Qe[tt];Ne&&Ne.type==="accessor"&&(ye[tt]=this.getSubLayerAccessor(ye[tt]))}}Object.assign(fe,e,ye),fe.id="".concat(this.props.id,"-").concat(He),fe.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...Me};for(const Qe of ae){const Je=Qe.getSubLayerProps.call(this,Qe);Je&&Object.assign(fe,Je,{updateTriggers:Object.assign(fe.updateTriggers,Je.updateTriggers)})}return fe}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=Uh(s,Boolean),this.internalState.subLayers=r}Xs(xee,this,i,r);for(const s of r)s.parent=this}}se(Li,"layerName","CompositeLayer");const e1=Math.PI/180,mP=180/Math.PI,q1=6370972,Zf=256;function wee(){const t=Zf/q1,e=Math.PI/180*Zf;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class bee extends tf{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,nearZMultiplier:s=.1,farZMultiplier:A=2,resolution:a=10}=e;let{height:y,altitude:w=1.5}=e;y=y||1,w=Math.max(.75,w);const P=new Yo().lookAt({eye:[0,-w,0],up:[0,0,1]}),I=Math.pow(2,i);P.rotateX(n*e1),P.rotateZ(-r*e1),P.scale(I/y);const L=Math.atan(.5/w),U=Zf*2*I/y;super({...e,height:y,viewMatrix:P,longitude:r,latitude:n,zoom:i,distanceScales:wee(),fovyRadians:L*2,focalDistance:w,near:s,far:Math.min(2,1/U+1)*w*A}),se(this,"longitude",void 0),se(this,"latitude",void 0),se(this,"resolution",void 0),this.latitude=n,this.longitude=r,this.resolution=a}get projectionMode(){return Nl.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,this.height/2],n),i=this.unproject([this.width/2,0],n),s=this.unproject([this.width,this.height/2],n),A=this.unproject([this.width/2,this.height],n);return s[0]<this.longitude&&(s[0]+=360),r[0]>this.longitude&&(r[0]-=360),[Math.min(r[0],s[0],i[0],A[0]),Math.min(r[1],s[1],i[1],A[1]),Math.max(r[0],s[0],i[0],A[0]),Math.max(r[1],s[1],i[1],A[1])]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,A]=e,a=n?s:this.height-s,{pixelUnprojectionMatrix:y}=this;let w;if(Number.isFinite(A))w=Px(y,[i,a,A,1]);else{const U=Px(y,[i,a,-1,1]),W=Px(y,[i,a,1,1]),q=((r||0)/q1+1)*Zf,ae=mx(cR([],U,W)),K=mx(U),ne=mx(W),fe=4*((4*K*ne-(ae-K-ne)**2)/16)/ae,ye=Math.sqrt(K-fe),Me=Math.sqrt(Math.max(0,q*q-fe)),He=(ye-Me)/Math.sqrt(ae);w=Cq([],U,W,He)}const[P,I,L]=this.unprojectPosition(w);return Number.isFinite(A)?[P,I,L]:Number.isFinite(r)?[P,I,r]:[P,I]}projectPosition(e){const[n,r,i=0]=e,s=n*e1,A=r*e1,a=Math.cos(A),y=(i/q1+1)*Zf;return[Math.sin(s)*a*y,-Math.cos(s)*a*y,Math.sin(A)*y]}unprojectPosition(e){const[n,r,i]=e,s=hR(e),A=Math.asin(i/s),y=Math.atan2(n,-r)*mP,w=A*mP,P=(s/Zf-1)*q1;return[y,w,P]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const r=this.unproject(n);return{longitude:e[0]-r[0]+this.longitude,latitude:e[1]-r[1]+this.latitude}}}function Px(t,e){const n=td([],e,t);return lT(n,n,1/n[3]),n}class xT{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){se(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&Vl(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,r={updateTriggers:{}};for(const i in n)if(i in this.props){const s=n[i],A=this.props[i];r[i]=A,s&&s.type==="accessor"&&(r.updateTriggers[i]=this.props.updateTriggers[i],typeof A=="function"&&(r[i]=this.getSubLayerAccessor(A)))}return r}initializeState(e,n){}updateState(e,n){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,n){}finalizeState(e,n){}}se(xT,"defaultProps",{});se(xT,"extensionName","LayerExtension");const Ix={bearing:0,pitch:0,position:[0,0,0]},Eee={speed:1.2,curve:1.414};class rd extends jR{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),se(this,"opts",void 0),this.opts={...Eee,...e}}interpolateProps(e,n,r){const i=JY(e,n,r,this.opts);for(const s in Ix)i[s]=kA(e[s]||Ix[s],n[s]||Ix[s],r);return i}getDuration(e,n){let{transitionDuration:r}=n;return r==="auto"&&(r=eX(e,n,this.opts)),r}}class aB{constructor(e){se(this,"opts",void 0),se(this,"typedArrayManager",void 0),se(this,"indexStarts",[0]),se(this,"vertexStarts",[0]),se(this,"vertexCount",0),se(this,"instanceCount",0),se(this,"attributes",void 0),se(this,"_attributeDefs",void 0),se(this,"data",void 0),se(this,"getGeometry",void 0),se(this,"geometryBuffer",void 0),se(this,"buffers",void 0),se(this,"positionSize",void 0),se(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=O0,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:A,dataChanged:a,normalize:y=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(A==="XY"?2:3),this.buffers=r,this.normalize=y,s&&(ki(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),y||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(a))for(const w of a)this._rebuildGeometry(w);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?JR(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:A}=this;for(const a in s)if(a in i)A.release(r[a]),r[a]=null;else{const y=s[a];y.copy=n,r[a]=A.allocate(r[a],e,y)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:A,objectInfo:a}=nd(i,n,r);for(const y of A){a.index++;const w=s?s(y,a):null;e(w,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:A}=this,{startRow:a=0,endRow:y=1/0}=e||{},w={};if(e||(n=[0],r=[0]),this.normalize||!A)this._forEachGeometry((I,L)=>{const U=I&&this.normalizeGeometry(I);w[L]=U,r[L+1]=r[L]+(U?this.getGeometrySize(U):0)},a,y),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(A))i=i||A.length/this.positionSize;else if(A instanceof Br){const I=A.accessor.stride||this.positionSize*4;i=i||A.byteLength/I}else if(A.buffer){const I=A.stride||this.positionSize*4;i=i||A.buffer.byteLength/I}else if(A.value){const I=A.value,L=A.stride/I.BYTES_PER_ELEMENT||this.positionSize;i=i||I.length/L}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const P={};this._forEachGeometry((I,L)=>{const U=w[L]||I;P.vertexStart=r[L],P.indexStart=n[L];const W=L<r.length-1?r[L+1]:i;P.geometrySize=W-r[L],P.geometryIndex=L,this.updateGeometryAttributes(U,P)},a,y),this.vertexCount=n[n.length-1]}}const Tee=typeof window<"u"?At.useLayoutEffect:At.useEffect,See=Tee;function e_(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const Mee={position:"absolute",zIndex:-1};function lB(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>lB(n,e));if(h2(t)){if(Cee(t))return e.style=Mee,At.cloneElement(t,e);if(Pee(t))return At.cloneElement(t,e)}return t}function h2(t){return t&&typeof t=="object"&&"type"in t||!1}function Cee(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function Pee(t){const e=t.type;return e&&e.deckGLViewProps}function Qb(t){if(typeof t=="function")return At.createElement(F0,{},t);if(Array.isArray(t))return t.map(Qb);if(h2(t)){if(t.type===At.Fragment)return Qb(t.props.children);if(e_(t.type,F0))return t}return t}function Iee({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return At.Children.forEach(Qb(t),A=>{if(h2(A)){const a=A.type;if(e_(a,Kl)){const y=kee(a,A.props);i.push(y)}else r.push(A);if(e_(a,F0)&&a!==F0&&A.props.id){const y=new a(A.props);s[y.id]=y}}else A&&r.push(A)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(A=>{s[A.id]=A}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function kee(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function Lee({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const A of t){let a=s,y=A;h2(A)&&e_(A.type,F0)&&(a=A.props.id||s,y=A.props.children);const w=r.getViewport(a),P=r.getViewState(a);if(w){P.padding=w.padding;const{x:I,y:L,width:U,height:W}=w;y=lB(y,{x:I,y:L,width:U,height:W,viewport:w,viewState:P}),i[a]||(i[a]={viewport:w,children:[]}),i[a].children.push(y)}}return Object.keys(i).map(A=>{const{viewport:a,children:y}=i[A],{x:w,y:P,width:I,height:L}=a,U={position:"absolute",left:w,top:P,width:I,height:L},W="view-".concat(A),q=At.createElement("div",{key:W,id:W,style:U},...y);if(n){const ae={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:K=>{K.viewId=A,e._onViewStateChange(K)}};return At.createElement(n,{key:W,value:ae},q)}return q})}const Dee={mixBlendMode:null};function Ree({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in Dee?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function Bee(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function AB(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function zee(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():AB(t)}});return r}const uB=At.forwardRef((t,e)=>{const[n,r]=At.useState(0),s=At.useRef({control:null,version:n,forceUpdate:()=>r(ye=>ye+1)}).current,A=At.useRef(null),a=At.useRef(null),y=At.useMemo(()=>Iee(t),[t.layers,t.views,t.children]);let w=!0;const P=ye=>{var Me;return w&&t.viewState?(s.viewStateUpdateRequested=ye,null):(s.viewStateUpdateRequested=null,(Me=t.onViewStateChange)===null||Me===void 0?void 0:Me.call(t,ye))},I=ye=>{if(w)s.interactionStateUpdateRequested=ye;else{var Me;s.interactionStateUpdateRequested=null,(Me=t.onInteractionStateChange)===null||Me===void 0||Me.call(t,ye)}},L=At.useMemo(()=>{const ye={...t,style:null,width:"100%",height:"100%",parent:A.current,canvas:a.current,layers:y.layers,views:y.views,onViewStateChange:P,onInteractionStateChange:I};return delete ye._customRender,s.deck&&s.deck.setProps(ye),ye},[t]);At.useEffect(()=>{const ye=t.Deck||Vh;return s.deck=zee(s,ye,{...L,parent:A.current,canvas:a.current}),()=>{var Me;return(Me=s.deck)===null||Me===void 0?void 0:Me.finalize()}},[]),See(()=>{AB(s);const{viewStateUpdateRequested:ye,interactionStateUpdateRequested:Me}=s;ye&&P(ye),Me&&I(Me)}),At.useImperativeHandle(e,()=>Bee(s),[]);const U=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:W,width:q,height:ae,id:K,style:ne}=t,{containerStyle:ie,canvasStyle:fe}=At.useMemo(()=>Ree({width:q,height:ae,style:ne}),[q,ae,ne]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===U||s.version!==n){s.lastRenderedViewports=U,s.version=n;const ye=Lee({children:y.children,deck:s.deck,ContextProvider:W}),Me=At.createElement("canvas",{key:"canvas",id:K||"deckgl-overlay",ref:a,style:fe});s.control=At.createElement("div",{id:"".concat(K||"deckgl","-wrapper"),ref:A,style:ie},[Me,ye])}return w=!1,s.control});uB.defaultProps=Vh.defaultProps;const Oee=uB;var cB={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(dN,function(){var n,r,i;function s(a,y){if(!n)n=y;else if(!r)r=y;else{var w="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",P={};n(P),i=y(P),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}s(["exports"],function(a){var y=w;function w(f,u,p,T){this.cx=3*f,this.bx=3*(p-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(T-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=u,this.p2x=p,this.p2y=T}function P(f,u,p,T){const D=new y(f,u,p,T);return function(z){return D.solve(z)}}w.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,u){if(u===void 0&&(u=1e-6),f<0)return 0;if(f>1)return 1;for(var p=f,T=0;T<8;T++){var D=this.sampleCurveX(p)-f;if(Math.abs(D)<u)return p;var z=this.sampleCurveDerivativeX(p);if(Math.abs(z)<1e-6)break;p-=D/z}var F=0,j=1;for(p=f,T=0;T<20&&(D=this.sampleCurveX(p),!(Math.abs(D-f)<u));T++)f>D?F=p:j=p,p=.5*(j-F)+F;return p},solve:function(f,u){return this.sampleCurveY(this.solveCurveX(f,u))}};const I=P(.25,.1,.25,1);function L(f,u,p){return Math.min(p,Math.max(u,f))}function U(f,u,p){const T=p-u,D=((f-u)%T+T)%T+u;return D===u?p:D}function W(f,...u){for(const p of u)for(const T in p)f[T]=p[T];return f}let q=1;function ae(f,u){f.forEach(p=>{u[p]&&(u[p]=u[p].bind(u))})}function K(f,u,p){const T={};for(const D in f)T[D]=u.call(p||this,f[D],D,f);return T}function ne(f,u,p){const T={};for(const D in f)u.call(p||this,f[D],D,f)&&(T[D]=f[D]);return T}function ie(f){return Array.isArray(f)?f.map(ie):typeof f=="object"&&f?K(f,ie):f}const fe={};function ye(f){fe[f]||(typeof console<"u"&&console.warn(f),fe[f]=!0)}function Me(f,u,p){return(p.y-f.y)*(u.x-f.x)>(u.y-f.y)*(p.x-f.x)}function He(f){let u=0;for(let p,T,D=0,z=f.length,F=z-1;D<z;F=D++)p=f[D],T=f[F],u+=(T.x-p.x)*(p.y+T.y);return u}function Qe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Je(f){const u={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(p,T,D,z)=>{const F=D||z;return u[T]=!F||F.toLowerCase(),""}),u["max-age"]){const p=parseInt(u["max-age"],10);isNaN(p)?delete u["max-age"]:u["max-age"]=p}return u}let tt,Ne,nt=null;function qe(f){if(nt==null){const u=f.navigator?f.navigator.userAgent:null;nt=!!f.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return nt}function mt(f){return typeof ImageBitmap<"u"&&f instanceof ImageBitmap}const Xt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f){const u=requestAnimationFrame(f);return{cancel:()=>cancelAnimationFrame(u)}},getImageData(f,u=0){const p=window.document.createElement("canvas"),T=p.getContext("2d");if(!T)throw new Error("failed to create canvas 2d context");return p.width=f.width,p.height=f.height,T.drawImage(f,0,0,f.width,f.height),T.getImageData(-u,-u,f.width+2*u,f.height+2*u)},resolveURL:f=>(tt||(tt=document.createElement("a")),tt.href=f,tt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ne==null&&(Ne=matchMedia("(prefers-reduced-motion: reduce)")),Ne.matches)}};var Et=fn;function fn(f,u){this.x=f,this.y=u}fn.prototype={clone:function(){return new fn(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,u){return this.clone()._rotateAround(f,u)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var u=f.x-this.x,p=f.y-this.y;return u*u+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,u){return Math.atan2(this.x*u-this.y*f,this.x*f+this.y*u)},_matMult:function(f){var u=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=u,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var u=Math.cos(f),p=Math.sin(f),T=p*this.x+u*this.y;return this.x=u*this.x-p*this.y,this.y=T,this},_rotateAround:function(f,u){var p=Math.cos(f),T=Math.sin(f),D=u.y+T*(this.x-u.x)+p*(this.y-u.y);return this.x=u.x+p*(this.x-u.x)-T*(this.y-u.y),this.y=D,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},fn.convert=function(f){return f instanceof fn?f:Array.isArray(f)?new fn(f[0],f[1]):f};const yt={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},bt="mapbox-tiles";let Kt,In,En=500,Er=50;function Jn(){typeof caches>"u"||Kt||(Kt=caches.open(bt))}let ir=1/0;const Ar={supported:!1,testSupport:function(f){!xt&&xr&&(nn?Mn(f):Nn=f)}};let Nn,xr,xt=!1,nn=!1;function Mn(f){const u=f.createTexture();f.bindTexture(f.TEXTURE_2D,u);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,xr),f.isContextLost())return;Ar.supported=!0}catch{}f.deleteTexture(u),xt=!0}typeof document<"u"&&(xr=document.createElement("img"),xr.onload=function(){Nn&&Mn(Nn),Nn=null,nn=!0},xr.onerror=function(){xt=!0,Nn=null},xr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const vt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(vt);class er extends Error{constructor(u,p,T,D){super(`AJAXError: ${p} (${u}): ${T}`),this.status=u,this.statusText=p,this.url=T,this.body=D}}const $n=Qe()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function gr(f,u){const p=new AbortController,T=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:$n(),signal:p.signal});let D=!1,z=!1;return f.type==="json"&&T.headers.set("Accept","application/json"),((F,j,Z)=>{if(z)return;const re=Date.now();fetch(T).then(Ae=>Ae.ok?((ce,pe,me)=>{(f.type==="arrayBuffer"?ce.arrayBuffer():f.type==="json"?ce.json():ce.text()).then(_e=>{z||(pe&&me&&function(Ue,ze,et){if(Jn(),!Kt)return;const lt={status:ze.status,statusText:ze.statusText,headers:new Headers};ze.headers.forEach((st,gt)=>lt.headers.set(gt,st));const Ke=Je(ze.headers.get("Cache-Control")||"");Ke["no-store"]||(Ke["max-age"]&&lt.headers.set("Expires",new Date(et+1e3*Ke["max-age"]).toUTCString()),new Date(lt.headers.get("Expires")).getTime()-et<42e4||function(st,gt){if(In===void 0)try{new Response(new ReadableStream),In=!0}catch{In=!1}In?gt(st.body):st.blob().then(gt)}(ze,st=>{const gt=new Response(st,lt);Jn(),Kt&&Kt.then(pt=>pt.put(function(qt){const en=qt.indexOf("?");return en<0?qt:qt.slice(0,en)}(Ue.url),gt)).catch(pt=>ye(pt.message))}))}(T,pe,me),D=!0,u(null,_e,ce.headers.get("Cache-Control"),ce.headers.get("Expires")))}).catch(_e=>{z||u(new Error(_e.message))})})(Ae,null,re):Ae.blob().then(ce=>u(new er(Ae.status,Ae.statusText,f.url,ce)))).catch(Ae=>{Ae.code!==20&&u(new Error(Ae.message))})})(),{cancel:()=>{z=!0,D||p.abort()}}}const or=function(f,u){if(/:\/\//.test(f.url)&&!/^https?:|^file:/.test(f.url)){if(Qe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u);if(!Qe()){const T=f.url.substring(0,f.url.indexOf("://"));return(yt.REGISTERED_PROTOCOLS[T]||gr)(f,u)}}if(!(/^file:/.test(p=f.url)||/^file:/.test($n())&&!/^\w+:/.test(p))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return gr(f,u);if(Qe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u,void 0,!0)}var p;return function(T,D){const z=new XMLHttpRequest;z.open(T.method||"GET",T.url,!0),T.type==="arrayBuffer"&&(z.responseType="arraybuffer");for(const F in T.headers)z.setRequestHeader(F,T.headers[F]);return T.type==="json"&&(z.responseType="text",z.setRequestHeader("Accept","application/json")),z.withCredentials=T.credentials==="include",z.onerror=()=>{D(new Error(z.statusText))},z.onload=()=>{if((z.status>=200&&z.status<300||z.status===0)&&z.response!==null){let F=z.response;if(T.type==="json")try{F=JSON.parse(z.response)}catch(j){return D(j)}D(null,F,z.getResponseHeader("Cache-Control"),z.getResponseHeader("Expires"))}else{const F=new Blob([z.response],{type:z.getResponseHeader("Content-Type")});D(new er(z.status,z.statusText,T.url,F))}},z.send(T.body),{cancel:()=>z.abort()}}(f,u)},tr=function(f,u){return or(W(f,{type:"arrayBuffer"}),u)};function Zr(f){const u=window.document.createElement("a");return u.href=f,u.protocol===window.document.location.protocol&&u.host===window.document.location.host}const Un="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let wi,Hn;wi=[],Hn=0;const Di=function(f,u){if(Ar.supported&&(f.headers||(f.headers={}),f.headers.accept="image/webp,*/*"),Hn>=yt.MAX_PARALLEL_IMAGE_REQUESTS){const z={requestParameters:f,callback:u,cancelled:!1,cancel(){this.cancelled=!0}};return wi.push(z),z}Hn++;let p=!1;const T=()=>{if(!p)for(p=!0,Hn--;wi.length&&Hn<yt.MAX_PARALLEL_IMAGE_REQUESTS;){const z=wi.shift(),{requestParameters:F,callback:j,cancelled:Z}=z;Z||(z.cancel=Di(F,j).cancel)}},D=tr(f,(z,F,j,Z)=>{T(),z?u(z):F&&function(re,Ae){typeof createImageBitmap=="function"?function(ce,pe){const me=new Blob([new Uint8Array(ce)],{type:"image/png"});createImageBitmap(me).then(_e=>{pe(null,_e)}).catch(_e=>{pe(new Error(`Could not load image because of ${_e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(re,Ae):function(ce,pe){const me=new Image;me.onload=()=>{pe(null,me),URL.revokeObjectURL(me.src),me.onload=null,window.requestAnimationFrame(()=>{me.src=Un})},me.onerror=()=>pe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _e=new Blob([new Uint8Array(ce)],{type:"image/png"});me.src=ce.byteLength?URL.createObjectURL(_e):Un}(re,Ae)}(F,(re,Ae)=>{re!=null?u(re):Ae!=null&&u(null,Ae,{cacheControl:j,expires:Z})})});return{cancel:()=>{D.cancel(),T()}}};function oo(f,u,p){p[f]&&p[f].indexOf(u)!==-1||(p[f]=p[f]||[],p[f].push(u))}function zr(f,u,p){if(p&&p[f]){const T=p[f].indexOf(u);T!==-1&&p[f].splice(T,1)}}class bi{constructor(u,p={}){W(this,p),this.type=u}}class Io extends bi{constructor(u,p={}){super("error",W({error:u},p))}}class Ki{on(u,p){return this._listeners=this._listeners||{},oo(u,p,this._listeners),this}off(u,p){return zr(u,p,this._listeners),zr(u,p,this._oneTimeListeners),this}once(u,p){return this._oneTimeListeners=this._oneTimeListeners||{},oo(u,p,this._oneTimeListeners),this}fire(u,p){typeof u=="string"&&(u=new bi(u,p||{}));const T=u.type;if(this.listens(T)){u.target=this;const D=this._listeners&&this._listeners[T]?this._listeners[T].slice():[];for(const j of D)j.call(this,u);const z=this._oneTimeListeners&&this._oneTimeListeners[T]?this._oneTimeListeners[T].slice():[];for(const j of z)zr(T,j,this._oneTimeListeners),j.call(this,u);const F=this._eventedParent;F&&(W(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),F.fire(u))}else u instanceof Io&&console.error(u.error);return this}listens(u){return this._listeners&&this._listeners[u]&&this._listeners[u].length>0||this._oneTimeListeners&&this._oneTimeListeners[u]&&this._oneTimeListeners[u].length>0||this._eventedParent&&this._eventedParent.listens(u)}setEventedParent(u,p){return this._eventedParent=u,this._eventedParentData=p,this}}var ct={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class It{constructor(u,p,T,D){this.message=(u?`${u}: `:"")+T,D&&(this.identifier=D),p!=null&&p.__line__&&(this.line=p.__line__)}}function Ms(f){const u=f.value;return u?[new It(f.key,u,"constants have been deprecated as of v8")]:[]}function pi(f,...u){for(const p of u)for(const T in p)f[T]=p[T];return f}function Rn(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function Ri(f){if(Array.isArray(f))return f.map(Ri);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const u={};for(const p in f)u[p]=Ri(f[p]);return u}return Rn(f)}class Ei extends Error{constructor(u,p){super(p),this.message=p,this.key=u}}class Ti{constructor(u,p=[]){this.parent=u,this.bindings={};for(const[T,D]of p)this.bindings[T]=D}concat(u){return new Ti(this,u)}get(u){if(this.bindings[u])return this.bindings[u];if(this.parent)return this.parent.get(u);throw new Error(`${u} not found in scope.`)}has(u){return!!this.bindings[u]||!!this.parent&&this.parent.has(u)}}const Ji={kind:"null"},kt={kind:"number"},Tn={kind:"string"},wn={kind:"boolean"},Mr={kind:"color"},fs={kind:"object"},mn={kind:"value"},Ze={kind:"collator"},Vr={kind:"formatted"},Cs={kind:"padding"},kr={kind:"resolvedImage"};function ri(f,u){return{kind:"array",itemType:f,N:u}}function Zn(f){if(f.kind==="array"){const u=Zn(f.itemType);return typeof f.N=="number"?`array<${u}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${u}>`}return f.kind}const Ps=[Ji,kt,Tn,wn,Mr,Vr,fs,ri(mn),Cs,kr];function Bi(f,u){if(u.kind==="error")return null;if(f.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!Bi(f.itemType,u.itemType))&&(typeof f.N!="number"||f.N===u.N))return null}else{if(f.kind===u.kind)return null;if(f.kind==="value"){for(const p of Ps)if(!Bi(p,u))return null}}return`Expected ${Zn(f)} but found ${Zn(u)} instead.`}function zi(f,u){return u.some(p=>p.kind===f.kind)}function Si(f,u){return u.some(p=>p==="null"?f===null:p==="array"?Array.isArray(f):p==="object"?f&&!Array.isArray(f)&&typeof f=="object":p===typeof f)}var es,Lr={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function X(f){return(f=Math.round(f))<0?0:f>255?255:f}function H(f){return X(f[f.length-1]==="%"?parseFloat(f)/100*255:parseInt(f))}function ee(f){return(u=f[f.length-1]==="%"?parseFloat(f)/100:parseFloat(f))<0?0:u>1?1:u;var u}function he(f,u,p){return p<0?p+=1:p>1&&(p-=1),6*p<1?f+(u-f)*p*6:2*p<1?u:3*p<2?f+(u-f)*(2/3-p)*6:f}try{es={}.parseCSSColor=function(f){var u,p=f.replace(/ /g,"").toLowerCase();if(p in Lr)return Lr[p].slice();if(p[0]==="#")return p.length===4?(u=parseInt(p.substr(1),16))>=0&&u<=4095?[(3840&u)>>4|(3840&u)>>8,240&u|(240&u)>>4,15&u|(15&u)<<4,1]:null:p.length===7&&(u=parseInt(p.substr(1),16))>=0&&u<=16777215?[(16711680&u)>>16,(65280&u)>>8,255&u,1]:null;var T=p.indexOf("("),D=p.indexOf(")");if(T!==-1&&D+1===p.length){var z=p.substr(0,T),F=p.substr(T+1,D-(T+1)).split(","),j=1;switch(z){case"rgba":if(F.length!==4)return null;j=ee(F.pop());case"rgb":return F.length!==3?null:[H(F[0]),H(F[1]),H(F[2]),j];case"hsla":if(F.length!==4)return null;j=ee(F.pop());case"hsl":if(F.length!==3)return null;var Z=(parseFloat(F[0])%360+360)%360/360,re=ee(F[1]),Ae=ee(F[2]),ce=Ae<=.5?Ae*(re+1):Ae+re-Ae*re,pe=2*Ae-ce;return[X(255*he(pe,ce,Z+1/3)),X(255*he(pe,ce,Z)),X(255*he(pe,ce,Z-1/3)),j];default:return null}}return null}}catch{}class o{constructor(u,p,T,D=1){this.r=u,this.g=p,this.b=T,this.a=D}static parse(u){if(!u)return;if(u instanceof o)return u;if(typeof u!="string")return;const p=es(u);return p?new o(p[0]/255*p[3],p[1]/255*p[3],p[2]/255*p[3],p[3]):void 0}toString(){const[u,p,T,D]=this.toArray();return`rgba(${Math.round(u)},${Math.round(p)},${Math.round(T)},${D})`}toArray(){const{r:u,g:p,b:T,a:D}=this;return D===0?[0,0,0,0]:[255*u/D,255*p/D,255*T/D,D]}}o.black=new o(0,0,0,1),o.white=new o(1,1,1,1),o.transparent=new o(0,0,0,0),o.red=new o(1,0,0,1);class G{constructor(u,p,T){this.sensitivity=u?p?"variant":"case":p?"accent":"base",this.locale=T,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(u,p){return this.collator.compare(u,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Le{constructor(u,p,T,D,z){this.text=u,this.image=p,this.scale=T,this.fontStack=D,this.textColor=z}}class Ie{constructor(u){this.sections=u}static fromString(u){return new Ie([new Le(u,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(u=>u.text.length!==0||u.image&&u.image.name.length!==0)}static factory(u){return u instanceof Ie?u:Ie.fromString(u)}toString(){return this.sections.length===0?"":this.sections.map(u=>u.text).join("")}}class Pe{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Pe)return u;if(typeof u=="number")return new Pe([u,u,u,u]);if(Array.isArray(u)&&!(u.length<1||u.length>4)){for(const p of u)if(typeof p!="number")return;switch(u.length){case 1:u=[u[0],u[0],u[0],u[0]];break;case 2:u=[u[0],u[1],u[0],u[1]];break;case 3:u=[u[0],u[1],u[2],u[1]]}return new Pe(u)}}toString(){return JSON.stringify(this.values)}}class ke{constructor(u){this.name=u.name,this.available=u.available}toString(){return this.name}static fromString(u){return u?new ke({name:u,available:!1}):null}}function We(f,u,p,T){return typeof f=="number"&&f>=0&&f<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof p=="number"&&p>=0&&p<=255?T===void 0||typeof T=="number"&&T>=0&&T<=1?null:`Invalid rgba value [${[f,u,p,T].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof T=="number"?[f,u,p,T]:[f,u,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function at(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof o||f instanceof G||f instanceof Ie||f instanceof Pe||f instanceof ke)return!0;if(Array.isArray(f)){for(const u of f)if(!at(u))return!1;return!0}if(typeof f=="object"){for(const u in f)if(!at(f[u]))return!1;return!0}return!1}function $e(f){if(f===null)return Ji;if(typeof f=="string")return Tn;if(typeof f=="boolean")return wn;if(typeof f=="number")return kt;if(f instanceof o)return Mr;if(f instanceof G)return Ze;if(f instanceof Ie)return Vr;if(f instanceof Pe)return Cs;if(f instanceof ke)return kr;if(Array.isArray(f)){const u=f.length;let p;for(const T of f){const D=$e(T);if(p){if(p===D)continue;p=mn;break}p=D}return ri(p||mn,u)}return fs}function ft(f){const u=typeof f;return f===null?"":u==="string"||u==="number"||u==="boolean"?String(f):f instanceof o||f instanceof Ie||f instanceof Pe||f instanceof ke?f.toString():JSON.stringify(f)}class Lt{constructor(u,p){this.type=u,this.value=p}static parse(u,p){if(u.length!==2)return p.error(`'literal' expression requires exactly one argument, but found ${u.length-1} instead.`);if(!at(u[1]))return p.error("invalid value");const T=u[1];let D=$e(T);const z=p.expectedType;return D.kind!=="array"||D.N!==0||!z||z.kind!=="array"||typeof z.N=="number"&&z.N!==0||(D=z),new Lt(D,T)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Dt{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}}const rn={string:Tn,number:kt,boolean:wn,object:fs};class jt{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");let T,D=1;const z=u[0];if(z==="array"){let j,Z;if(u.length>2){const re=u[1];if(typeof re!="string"||!(re in rn)||re==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);j=rn[re],D++}else j=mn;if(u.length>3){if(u[2]!==null&&(typeof u[2]!="number"||u[2]<0||u[2]!==Math.floor(u[2])))return p.error('The length argument to "array" must be a positive integer literal',2);Z=u[2],D++}T=ri(j,Z)}else{if(!rn[z])throw new Error(`Types doesn't contain name = ${z}`);T=rn[z]}const F=[];for(;D<u.length;D++){const j=p.parse(u[D],D,mn);if(!j)return null;F.push(j)}return new jt(T,F)}evaluate(u){for(let p=0;p<this.args.length;p++){const T=this.args[p].evaluate(u);if(!Bi(this.type,$e(T)))return T;if(p===this.args.length-1)throw new Dt(`Expected value to be of type ${Zn(this.type)}, but found ${Zn($e(T))} instead.`)}throw new Error}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const dn={"to-boolean":wn,"to-color":Mr,"to-number":kt,"to-string":Tn};class Qt{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const T=u[0];if(!dn[T])throw new Error(`Can't parse ${T} as it is not part of the known types`);if((T==="to-boolean"||T==="to-string")&&u.length!==2)return p.error("Expected one argument.");const D=dn[T],z=[];for(let F=1;F<u.length;F++){const j=p.parse(u[F],F,mn);if(!j)return null;z.push(j)}return new Qt(D,z)}evaluate(u){if(this.type.kind==="boolean")return!!this.args[0].evaluate(u);if(this.type.kind==="color"){let p,T;for(const D of this.args){if(p=D.evaluate(u),T=null,p instanceof o)return p;if(typeof p=="string"){const z=u.parseColor(p);if(z)return z}else if(Array.isArray(p)&&(T=p.length<3||p.length>4?`Invalid rbga value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:We(p[0],p[1],p[2],p[3]),!T))return new o(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new Dt(T||`Could not parse color from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}if(this.type.kind==="padding"){let p;for(const T of this.args){p=T.evaluate(u);const D=Pe.parse(p);if(D)return D}throw new Dt(`Could not parse padding from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}if(this.type.kind==="number"){let p=null;for(const T of this.args){if(p=T.evaluate(u),p===null)return 0;const D=Number(p);if(!isNaN(D))return D}throw new Dt(`Could not convert ${JSON.stringify(p)} to number.`)}return this.type.kind==="formatted"?Ie.fromString(ft(this.args[0].evaluate(u))):this.type.kind==="resolvedImage"?ke.fromString(ft(this.args[0].evaluate(u))):ft(this.args[0].evaluate(u))}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const on=["Unknown","Point","LineString","Polygon"];class vn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?on[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(u){let p=this._parseColorCache[u];return p||(p=this._parseColorCache[u]=o.parse(u)),p}}class Ot{constructor(u,p,T,D){this.name=u,this.type=p,this._evaluate=T,this.args=D}evaluate(u){return this._evaluate(u,this.args)}eachChild(u){this.args.forEach(u)}outputDefined(){return!1}static parse(u,p){const T=u[0],D=Ot.definitions[T];if(!D)return p.error(`Unknown expression "${T}". If you wanted a literal array, use ["literal", [...]].`,0);const z=Array.isArray(D)?D[0]:D.type,F=Array.isArray(D)?[[D[1],D[2]]]:D.overloads,j=F.filter(([re])=>!Array.isArray(re)||re.length===u.length-1);let Z=null;for(const[re,Ae]of j){Z=new wt(p.registry,p.path,null,p.scope);const ce=[];let pe=!1;for(let me=1;me<u.length;me++){const _e=u[me],Ue=Array.isArray(re)?re[me-1]:re.type,ze=Z.parse(_e,1+ce.length,Ue);if(!ze){pe=!0;break}ce.push(ze)}if(!pe)if(Array.isArray(re)&&re.length!==ce.length)Z.error(`Expected ${re.length} arguments, but found ${ce.length} instead.`);else{for(let me=0;me<ce.length;me++){const _e=Array.isArray(re)?re[me]:re.type,Ue=ce[me];Z.concat(me+1).checkSubtype(_e,Ue.type)}if(Z.errors.length===0)return new Ot(T,z,Ae,ce)}}if(j.length===1)p.errors.push(...Z.errors);else{const re=(j.length?j:F).map(([ce])=>{return pe=ce,Array.isArray(pe)?`(${pe.map(Zn).join(", ")})`:`(${Zn(pe.type)}...)`;var pe}).join(" | "),Ae=[];for(let ce=1;ce<u.length;ce++){const pe=p.parse(u[ce],1+Ae.length);if(!pe)return null;Ae.push(Zn(pe.type))}p.error(`Expected arguments of type ${re}, but found (${Ae.join(", ")}) instead.`)}return null}static register(u,p){Ot.definitions=p;for(const T in p)u[T]=Ot}}class Oe{constructor(u,p,T){this.type=Ze,this.locale=T,this.caseSensitive=u,this.diacriticSensitive=p}static parse(u,p){if(u.length!==2)return p.error("Expected one argument.");const T=u[1];if(typeof T!="object"||Array.isArray(T))return p.error("Collator options argument must be an object.");const D=p.parse(T["case-sensitive"]!==void 0&&T["case-sensitive"],1,wn);if(!D)return null;const z=p.parse(T["diacritic-sensitive"]!==void 0&&T["diacritic-sensitive"],1,wn);if(!z)return null;let F=null;return T.locale&&(F=p.parse(T.locale,1,Tn),!F)?null:new Oe(D,z,F)}evaluate(u){return new G(this.caseSensitive.evaluate(u),this.diacriticSensitive.evaluate(u),this.locale?this.locale.evaluate(u):null)}eachChild(u){u(this.caseSensitive),u(this.diacriticSensitive),this.locale&&u(this.locale)}outputDefined(){return!1}}const Mt=8192;function Se(f,u){f[0]=Math.min(f[0],u[0]),f[1]=Math.min(f[1],u[1]),f[2]=Math.max(f[2],u[0]),f[3]=Math.max(f[3],u[1])}function An(f,u){return!(f[0]<=u[0]||f[2]>=u[2]||f[1]<=u[1]||f[3]>=u[3])}function ii(f,u){const p=(180+f[0])/360,T=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,D=Math.pow(2,u.z);return[Math.round(p*D*Mt),Math.round(T*D*Mt)]}function nr(f,u,p){const T=f[0]-u[0],D=f[1]-u[1],z=f[0]-p[0],F=f[1]-p[1];return T*F-z*D==0&&T*z<=0&&D*F<=0}function ea(f,u){let p=!1;for(let F=0,j=u.length;F<j;F++){const Z=u[F];for(let re=0,Ae=Z.length;re<Ae-1;re++){if(nr(f,Z[re],Z[re+1]))return!1;(D=Z[re])[1]>(T=f)[1]!=(z=Z[re+1])[1]>T[1]&&T[0]<(z[0]-D[0])*(T[1]-D[1])/(z[1]-D[1])+D[0]&&(p=!p)}}var T,D,z;return p}function De(f,u){for(let p=0;p<u.length;p++)if(ea(f,u[p]))return!0;return!1}function Ia(f,u,p,T){const D=T[0]-p[0],z=T[1]-p[1],F=(f[0]-p[0])*z-D*(f[1]-p[1]),j=(u[0]-p[0])*z-D*(u[1]-p[1]);return F>0&&j<0||F<0&&j>0}function we(f,u,p){for(const re of p)for(let Ae=0;Ae<re.length-1;++Ae)if((j=[(F=re[Ae+1])[0]-(z=re[Ae])[0],F[1]-z[1]])[0]*(Z=[(D=u)[0]-(T=f)[0],D[1]-T[1]])[1]-j[1]*Z[0]!=0&&Ia(T,D,z,F)&&Ia(z,F,T,D))return!0;var T,D,z,F,j,Z;return!1}function ko(f,u){for(let p=0;p<f.length;++p)if(!ea(f[p],u))return!1;for(let p=0;p<f.length-1;++p)if(we(f[p],f[p+1],u))return!1;return!0}function ds(f,u){for(let p=0;p<u.length;p++)if(ko(f,u[p]))return!0;return!1}function ka(f,u,p){const T=[];for(let D=0;D<f.length;D++){const z=[];for(let F=0;F<f[D].length;F++){const j=ii(f[D][F],p);Se(u,j),z.push(j)}T.push(z)}return T}function La(f,u,p){const T=[];for(let D=0;D<f.length;D++){const z=ka(f[D],u,p);T.push(z)}return T}function ta(f,u,p,T){if(f[0]<p[0]||f[0]>p[2]){const D=.5*T;let z=f[0]-p[0]>D?-T:p[0]-f[0]>D?T:0;z===0&&(z=f[0]-p[2]>D?-T:p[2]-f[0]>D?T:0),f[0]+=z}Se(u,f)}function Al(f,u,p,T){const D=Math.pow(2,T.z)*Mt,z=[T.x*Mt,T.y*Mt],F=[];for(const j of f)for(const Z of j){const re=[Z.x+z[0],Z.y+z[1]];ta(re,u,p,D),F.push(re)}return F}function na(f,u,p,T){const D=Math.pow(2,T.z)*Mt,z=[T.x*Mt,T.y*Mt],F=[];for(const Z of f){const re=[];for(const Ae of Z){const ce=[Ae.x+z[0],Ae.y+z[1]];Se(u,ce),re.push(ce)}F.push(re)}if(u[2]-u[0]<=D/2){(j=u)[0]=j[1]=1/0,j[2]=j[3]=-1/0;for(const Z of F)for(const re of Z)ta(re,u,p,D)}var j;return F}class Yr{constructor(u,p){this.type=wn,this.geojson=u,this.geometries=p}static parse(u,p){if(u.length!==2)return p.error(`'within' expression requires exactly one argument, but found ${u.length-1} instead.`);if(at(u[1])){const T=u[1];if(T.type==="FeatureCollection")for(let D=0;D<T.features.length;++D){const z=T.features[D].geometry.type;if(z==="Polygon"||z==="MultiPolygon")return new Yr(T,T.features[D].geometry)}else if(T.type==="Feature"){const D=T.geometry.type;if(D==="Polygon"||D==="MultiPolygon")return new Yr(T,T.geometry)}else if(T.type==="Polygon"||T.type==="MultiPolygon")return new Yr(T,T)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(p,T){const D=[1/0,1/0,-1/0,-1/0],z=[1/0,1/0,-1/0,-1/0],F=p.canonicalID();if(T.type==="Polygon"){const j=ka(T.coordinates,z,F),Z=Al(p.geometry(),D,z,F);if(!An(D,z))return!1;for(const re of Z)if(!ea(re,j))return!1}if(T.type==="MultiPolygon"){const j=La(T.coordinates,z,F),Z=Al(p.geometry(),D,z,F);if(!An(D,z))return!1;for(const re of Z)if(!De(re,j))return!1}return!0}(u,this.geometries);if(u.geometryType()==="LineString")return function(p,T){const D=[1/0,1/0,-1/0,-1/0],z=[1/0,1/0,-1/0,-1/0],F=p.canonicalID();if(T.type==="Polygon"){const j=ka(T.coordinates,z,F),Z=na(p.geometry(),D,z,F);if(!An(D,z))return!1;for(const re of Z)if(!ko(re,j))return!1}if(T.type==="MultiPolygon"){const j=La(T.coordinates,z,F),Z=na(p.geometry(),D,z,F);if(!An(D,z))return!1;for(const re of Z)if(!ds(re,j))return!1}return!0}(u,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function ge(f){if(f instanceof Ot&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof Yr)return!1;let u=!0;return f.eachChild(p=>{u&&!ge(p)&&(u=!1)}),u}function Ee(f){if(f instanceof Ot&&f.name==="feature-state")return!1;let u=!0;return f.eachChild(p=>{u&&!Ee(p)&&(u=!1)}),u}function Fe(f,u){if(f instanceof Ot&&u.indexOf(f.name)>=0)return!1;let p=!0;return f.eachChild(T=>{p&&!Fe(T,u)&&(p=!1)}),p}class ot{constructor(u,p){this.type=p.type,this.name=u,this.boundExpression=p}static parse(u,p){if(u.length!==2||typeof u[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");const T=u[1];return p.scope.has(T)?new ot(T,p.scope.get(T)):p.error(`Unknown variable "${T}". Make sure "${T}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(u){return this.boundExpression.evaluate(u)}eachChild(){}outputDefined(){return!1}}class wt{constructor(u,p=[],T,D=new Ti,z=[]){this.registry=u,this.path=p,this.key=p.map(F=>`[${F}]`).join(""),this.scope=D,this.errors=z,this.expectedType=T}parse(u,p,T,D,z={}){return p?this.concat(p,T,D)._parse(u,z):this._parse(u,z)}_parse(u,p){function T(D,z,F){return F==="assert"?new jt(z,[D]):F==="coerce"?new Qt(z,[D]):D}if(u!==null&&typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"||(u=["literal",u]),Array.isArray(u)){if(u.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const D=u[0];if(typeof D!="string")return this.error(`Expression name must be a string, but found ${typeof D} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const z=this.registry[D];if(z){let F=z.parse(u,this);if(!F)return null;if(this.expectedType){const j=this.expectedType,Z=F.type;if(j.kind!=="string"&&j.kind!=="number"&&j.kind!=="boolean"&&j.kind!=="object"&&j.kind!=="array"||Z.kind!=="value")if(j.kind!=="color"&&j.kind!=="formatted"&&j.kind!=="resolvedImage"||Z.kind!=="value"&&Z.kind!=="string")if(j.kind!=="padding"||Z.kind!=="value"&&Z.kind!=="number"&&Z.kind!=="array"){if(this.checkSubtype(j,Z))return null}else F=T(F,j,p.typeAnnotation||"coerce");else F=T(F,j,p.typeAnnotation||"coerce");else F=T(F,j,p.typeAnnotation||"assert")}if(!(F instanceof Lt)&&F.type.kind!=="resolvedImage"&&Wt(F)){const j=new vn;try{F=new Lt(F.type,F.evaluate(j))}catch(Z){return this.error(Z.message),null}}return F}return this.error(`Unknown expression "${D}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(u===void 0?"'undefined' value invalid. Use null instead.":typeof u=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof u} instead.`)}concat(u,p,T){const D=typeof u=="number"?this.path.concat(u):this.path,z=T?this.scope.concat(T):this.scope;return new wt(this.registry,D,p||null,z,this.errors)}error(u,...p){const T=`${this.key}${p.map(D=>`[${D}]`).join("")}`;this.errors.push(new Ei(T,u))}checkSubtype(u,p){const T=Bi(u,p);return T&&this.error(T),T}}function Wt(f){if(f instanceof ot)return Wt(f.boundExpression);if(f instanceof Ot&&f.name==="error"||f instanceof Oe||f instanceof Yr)return!1;const u=f instanceof Qt||f instanceof jt;let p=!0;return f.eachChild(T=>{p=u?p&&Wt(T):p&&T instanceof Lt}),!!p&&ge(f)&&Fe(f,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function kn(f,u){const p=f.length-1;let T,D,z=0,F=p,j=0;for(;z<=F;)if(j=Math.floor((z+F)/2),T=f[j],D=f[j+1],T<=u){if(j===p||u<D)return j;z=j+1}else{if(!(T>u))throw new Dt("Input is not a number.");F=j-1}return 0}class Sr{constructor(u,p,T){this.type=u,this.input=p,this.labels=[],this.outputs=[];for(const[D,z]of T)this.labels.push(D),this.outputs.push(z)}static parse(u,p){if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");const T=p.parse(u[1],1,kt);if(!T)return null;const D=[];let z=null;p.expectedType&&p.expectedType.kind!=="value"&&(z=p.expectedType);for(let F=1;F<u.length;F+=2){const j=F===1?-1/0:u[F],Z=u[F+1],re=F,Ae=F+1;if(typeof j!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',re);if(D.length&&D[D.length-1][0]>=j)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',re);const ce=p.parse(Z,Ae,z);if(!ce)return null;z=z||ce.type,D.push([j,ce])}return new Sr(z,T,D)}evaluate(u){const p=this.labels,T=this.outputs;if(p.length===1)return T[0].evaluate(u);const D=this.input.evaluate(u);if(D<=p[0])return T[0].evaluate(u);const z=p.length;return D>=p[z-1]?T[z-1].evaluate(u):T[kn(p,D)].evaluate(u)}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function Jt(f,u,p){return f*(1-p)+u*p}var Cr=Object.freeze({__proto__:null,number:Jt,color:function(f,u,p){return new o(Jt(f.r,u.r,p),Jt(f.g,u.g,p),Jt(f.b,u.b,p),Jt(f.a,u.a,p))},array:function(f,u,p){return f.map((T,D)=>Jt(T,u[D],p))},padding:function(f,u,p){const T=f.values,D=u.values;return new Pe([Jt(T[0],D[0],p),Jt(T[1],D[1],p),Jt(T[2],D[2],p),Jt(T[3],D[3],p)])}});const Vn=.95047,nA=1.08883,rA=4/29,iA=6/29,FA=3*iA*iA,NA=Math.PI/180,sA=180/Math.PI;function ul(f){return f>.008856451679035631?Math.pow(f,1/3):f/FA+rA}function cl(f){return f>iA?f*f*f:FA*(f-rA)}function oA(f){return 255*(f<=.0031308?12.92*f:1.055*Math.pow(f,1/2.4)-.055)}function aA(f){return(f/=255)<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function Yn(f){const u=aA(f.r),p=aA(f.g),T=aA(f.b),D=ul((.4124564*u+.3575761*p+.1804375*T)/Vn),z=ul((.2126729*u+.7151522*p+.072175*T)/1);return{l:116*z-16,a:500*(D-z),b:200*(z-ul((.0193339*u+.119192*p+.9503041*T)/nA)),alpha:f.a}}function UA(f){let u=(f.l+16)/116,p=isNaN(f.a)?u:u+f.a/500,T=isNaN(f.b)?u:u-f.b/200;return u=1*cl(u),p=Vn*cl(p),T=nA*cl(T),new o(oA(3.2404542*p-1.5371385*u-.4985314*T),oA(-.969266*p+1.8760108*u+.041556*T),oA(.0556434*p-.2040259*u+1.0572252*T),f.alpha)}function qu(f,u,p){const T=u-f;return f+p*(T>180||T<-180?T-360*Math.round(T/360):T)}const hl={forward:Yn,reverse:UA,interpolate:function(f,u,p){return{l:Jt(f.l,u.l,p),a:Jt(f.a,u.a,p),b:Jt(f.b,u.b,p),alpha:Jt(f.alpha,u.alpha,p)}}},Gr={forward:function(f){const{l:u,a:p,b:T}=Yn(f),D=Math.atan2(T,p)*sA;return{h:D<0?D+360:D,c:Math.sqrt(p*p+T*T),l:u,alpha:f.a}},reverse:function(f){const u=f.h*NA,p=f.c;return UA({l:f.l,a:Math.cos(u)*p,b:Math.sin(u)*p,alpha:f.alpha})},interpolate:function(f,u,p){return{h:qu(f.h,u.h,p),c:Jt(f.c,u.c,p),l:Jt(f.l,u.l,p),alpha:Jt(f.alpha,u.alpha,p)}}};var Lo=Object.freeze({__proto__:null,lab:hl,hcl:Gr});class Bn{constructor(u,p,T,D,z){this.type=u,this.operator=p,this.interpolation=T,this.input=D,this.labels=[],this.outputs=[];for(const[F,j]of z)this.labels.push(F),this.outputs.push(j)}static interpolationFactor(u,p,T,D){let z=0;if(u.name==="exponential")z=ps(p,u.base,T,D);else if(u.name==="linear")z=ps(p,1,T,D);else if(u.name==="cubic-bezier"){const F=u.controlPoints;z=new y(F[0],F[1],F[2],F[3]).solve(ps(p,1,T,D))}return z}static parse(u,p){let[T,D,z,...F]=u;if(!Array.isArray(D)||D.length===0)return p.error("Expected an interpolation type expression.",1);if(D[0]==="linear")D={name:"linear"};else if(D[0]==="exponential"){const re=D[1];if(typeof re!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);D={name:"exponential",base:re}}else{if(D[0]!=="cubic-bezier")return p.error(`Unknown interpolation type ${String(D[0])}`,1,0);{const re=D.slice(1);if(re.length!==4||re.some(Ae=>typeof Ae!="number"||Ae<0||Ae>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);D={name:"cubic-bezier",controlPoints:re}}}if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");if(z=p.parse(z,2,kt),!z)return null;const j=[];let Z=null;T==="interpolate-hcl"||T==="interpolate-lab"?Z=Mr:p.expectedType&&p.expectedType.kind!=="value"&&(Z=p.expectedType);for(let re=0;re<F.length;re+=2){const Ae=F[re],ce=F[re+1],pe=re+3,me=re+4;if(typeof Ae!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',pe);if(j.length&&j[j.length-1][0]>=Ae)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',pe);const _e=p.parse(ce,me,Z);if(!_e)return null;Z=Z||_e.type,j.push([Ae,_e])}return Z.kind==="number"||Z.kind==="color"||Z.kind==="padding"||Z.kind==="array"&&Z.itemType.kind==="number"&&typeof Z.N=="number"?new Bn(Z,T,D,z,j):p.error(`Type ${Zn(Z)} is not interpolatable.`)}evaluate(u){const p=this.labels,T=this.outputs;if(p.length===1)return T[0].evaluate(u);const D=this.input.evaluate(u);if(D<=p[0])return T[0].evaluate(u);const z=p.length;if(D>=p[z-1])return T[z-1].evaluate(u);const F=kn(p,D),j=Bn.interpolationFactor(this.interpolation,D,p[F],p[F+1]),Z=T[F].evaluate(u),re=T[F+1].evaluate(u);return this.operator==="interpolate"?Cr[this.type.kind.toLowerCase()](Z,re,j):this.operator==="interpolate-hcl"?Gr.reverse(Gr.interpolate(Gr.forward(Z),Gr.forward(re),j)):hl.reverse(hl.interpolate(hl.forward(Z),hl.forward(re),j))}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function ps(f,u,p,T){const D=T-p,z=f-p;return D===0?0:u===1?z/D:(Math.pow(u,z)-1)/(Math.pow(u,D)-1)}class Xr{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expectected at least one argument.");let T=null;const D=p.expectedType;D&&D.kind!=="value"&&(T=D);const z=[];for(const j of u.slice(1)){const Z=p.parse(j,1+z.length,T,void 0,{typeAnnotation:"omit"});if(!Z)return null;T=T||Z.type,z.push(Z)}if(!T)throw new Error("No output type");const F=D&&z.some(j=>Bi(D,j.type));return new Xr(F?mn:T,z)}evaluate(u){let p,T=null,D=0;for(const z of this.args)if(D++,T=z.evaluate(u),T&&T instanceof ke&&!T.available&&(p||(p=T.name),T=null,D===this.args.length&&(T=p)),T!==null)break;return T}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}class ao{constructor(u,p){this.type=p.type,this.bindings=[].concat(u),this.result=p}evaluate(u){return this.result.evaluate(u)}eachChild(u){for(const p of this.bindings)u(p[1]);u(this.result)}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found ${u.length-1} instead.`);const T=[];for(let z=1;z<u.length-1;z+=2){const F=u[z];if(typeof F!="string")return p.error(`Expected string, but found ${typeof F} instead.`,z);if(/[^a-zA-Z0-9_]/.test(F))return p.error("Variable names must contain only alphanumeric characters or '_'.",z);const j=p.parse(u[z+1],z+1);if(!j)return null;T.push([F,j])}const D=p.parse(u[u.length-1],u.length-1,p.expectedType,T);return D?new ao(T,D):null}outputDefined(){return this.result.outputDefined()}}class fl{constructor(u,p,T){this.type=u,this.index=p,this.input=T}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const T=p.parse(u[1],1,kt),D=p.parse(u[2],2,ri(p.expectedType||mn));return T&&D?new fl(D.type.itemType,T,D):null}evaluate(u){const p=this.index.evaluate(u),T=this.input.evaluate(u);if(p<0)throw new Dt(`Array index out of bounds: ${p} < 0.`);if(p>=T.length)throw new Dt(`Array index out of bounds: ${p} > ${T.length-1}.`);if(p!==Math.floor(p))throw new Dt(`Array index must be an integer, but found ${p} instead.`);return T[p]}eachChild(u){u(this.index),u(this.input)}outputDefined(){return!1}}class Do{constructor(u,p){this.type=wn,this.needle=u,this.haystack=p}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const T=p.parse(u[1],1,mn),D=p.parse(u[2],2,mn);return T&&D?zi(T.type,[wn,Tn,kt,Ji,mn])?new Do(T,D):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(T.type)} instead`):null}evaluate(u){const p=this.needle.evaluate(u),T=this.haystack.evaluate(u);if(!T)return!1;if(!Si(p,["boolean","string","number","null"]))throw new Dt(`Expected first argument to be of type boolean, string, number or null, but found ${Zn($e(p))} instead.`);if(!Si(T,["string","array"]))throw new Dt(`Expected second argument to be of type array or string, but found ${Zn($e(T))} instead.`);return T.indexOf(p)>=0}eachChild(u){u(this.needle),u(this.haystack)}outputDefined(){return!0}}class ra{constructor(u,p,T){this.type=kt,this.needle=u,this.haystack=p,this.fromIndex=T}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const T=p.parse(u[1],1,mn),D=p.parse(u[2],2,mn);if(!T||!D)return null;if(!zi(T.type,[wn,Tn,kt,Ji,mn]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(T.type)} instead`);if(u.length===4){const z=p.parse(u[3],3,kt);return z?new ra(T,D,z):null}return new ra(T,D)}evaluate(u){const p=this.needle.evaluate(u),T=this.haystack.evaluate(u);if(!Si(p,["boolean","string","number","null"]))throw new Dt(`Expected first argument to be of type boolean, string, number or null, but found ${Zn($e(p))} instead.`);if(!Si(T,["string","array"]))throw new Dt(`Expected second argument to be of type array or string, but found ${Zn($e(T))} instead.`);if(this.fromIndex){const D=this.fromIndex.evaluate(u);return T.indexOf(p,D)}return T.indexOf(p)}eachChild(u){u(this.needle),u(this.haystack),this.fromIndex&&u(this.fromIndex)}outputDefined(){return!1}}class lo{constructor(u,p,T,D,z,F){this.inputType=u,this.type=p,this.input=T,this.cases=D,this.outputs=z,this.otherwise=F}static parse(u,p){if(u.length<5)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if(u.length%2!=1)return p.error("Expected an even number of arguments.");let T,D;p.expectedType&&p.expectedType.kind!=="value"&&(D=p.expectedType);const z={},F=[];for(let re=2;re<u.length-1;re+=2){let Ae=u[re];const ce=u[re+1];Array.isArray(Ae)||(Ae=[Ae]);const pe=p.concat(re);if(Ae.length===0)return pe.error("Expected at least one branch label.");for(const _e of Ae){if(typeof _e!="number"&&typeof _e!="string")return pe.error("Branch labels must be numbers or strings.");if(typeof _e=="number"&&Math.abs(_e)>Number.MAX_SAFE_INTEGER)return pe.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof _e=="number"&&Math.floor(_e)!==_e)return pe.error("Numeric branch labels must be integer values.");if(T){if(pe.checkSubtype(T,$e(_e)))return null}else T=$e(_e);if(z[String(_e)]!==void 0)return pe.error("Branch labels must be unique.");z[String(_e)]=F.length}const me=p.parse(ce,re,D);if(!me)return null;D=D||me.type,F.push(me)}const j=p.parse(u[1],1,mn);if(!j)return null;const Z=p.parse(u[u.length-1],u.length-1,D);return Z?j.type.kind!=="value"&&p.concat(1).checkSubtype(T,j.type)?null:new lo(T,D,j,z,F,Z):null}evaluate(u){const p=this.input.evaluate(u);return($e(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(u)}eachChild(u){u(this.input),this.outputs.forEach(u),u(this.otherwise)}outputDefined(){return this.outputs.every(u=>u.outputDefined())&&this.otherwise.outputDefined()}}class lA{constructor(u,p,T){this.type=u,this.branches=p,this.otherwise=T}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found only ${u.length-1}.`);if(u.length%2!=0)return p.error("Expected an odd number of arguments.");let T;p.expectedType&&p.expectedType.kind!=="value"&&(T=p.expectedType);const D=[];for(let F=1;F<u.length-1;F+=2){const j=p.parse(u[F],F,wn);if(!j)return null;const Z=p.parse(u[F+1],F+1,T);if(!Z)return null;D.push([j,Z]),T=T||Z.type}const z=p.parse(u[u.length-1],u.length-1,T);if(!z)return null;if(!T)throw new Error("Can't infer output type");return new lA(T,D,z)}evaluate(u){for(const[p,T]of this.branches)if(p.evaluate(u))return T.evaluate(u);return this.otherwise.evaluate(u)}eachChild(u){for(const[p,T]of this.branches)u(p),u(T);u(this.otherwise)}outputDefined(){return this.branches.every(([u,p])=>p.outputDefined())&&this.otherwise.outputDefined()}}class Da{constructor(u,p,T,D){this.type=u,this.input=p,this.beginIndex=T,this.endIndex=D}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const T=p.parse(u[1],1,mn),D=p.parse(u[2],2,kt);if(!T||!D)return null;if(!zi(T.type,[ri(mn),Tn,mn]))return p.error(`Expected first argument to be of type array or string, but found ${Zn(T.type)} instead`);if(u.length===4){const z=p.parse(u[3],3,kt);return z?new Da(T.type,T,D,z):null}return new Da(T.type,T,D)}evaluate(u){const p=this.input.evaluate(u),T=this.beginIndex.evaluate(u);if(!Si(p,["string","array"]))throw new Dt(`Expected first argument to be of type array or string, but found ${Zn($e(p))} instead.`);if(this.endIndex){const D=this.endIndex.evaluate(u);return p.slice(T,D)}return p.slice(T)}eachChild(u){u(this.input),u(this.beginIndex),this.endIndex&&u(this.endIndex)}outputDefined(){return!1}}function Ro(f,u){return f==="=="||f==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function Oi(f,u,p,T){return T.compare(u,p)===0}function Fi(f,u,p){const T=f!=="=="&&f!=="!=";return class hB{constructor(z,F,j){this.type=wn,this.lhs=z,this.rhs=F,this.collator=j,this.hasUntypedArgument=z.type.kind==="value"||F.type.kind==="value"}static parse(z,F){if(z.length!==3&&z.length!==4)return F.error("Expected two or three arguments.");const j=z[0];let Z=F.parse(z[1],1,mn);if(!Z)return null;if(!Ro(j,Z.type))return F.concat(1).error(`"${j}" comparisons are not supported for type '${Zn(Z.type)}'.`);let re=F.parse(z[2],2,mn);if(!re)return null;if(!Ro(j,re.type))return F.concat(2).error(`"${j}" comparisons are not supported for type '${Zn(re.type)}'.`);if(Z.type.kind!==re.type.kind&&Z.type.kind!=="value"&&re.type.kind!=="value")return F.error(`Cannot compare types '${Zn(Z.type)}' and '${Zn(re.type)}'.`);T&&(Z.type.kind==="value"&&re.type.kind!=="value"?Z=new jt(re.type,[Z]):Z.type.kind!=="value"&&re.type.kind==="value"&&(re=new jt(Z.type,[re])));let Ae=null;if(z.length===4){if(Z.type.kind!=="string"&&re.type.kind!=="string"&&Z.type.kind!=="value"&&re.type.kind!=="value")return F.error("Cannot use collator to compare non-string types.");if(Ae=F.parse(z[3],3,Ze),!Ae)return null}return new hB(Z,re,Ae)}evaluate(z){const F=this.lhs.evaluate(z),j=this.rhs.evaluate(z);if(T&&this.hasUntypedArgument){const Z=$e(F),re=$e(j);if(Z.kind!==re.kind||Z.kind!=="string"&&Z.kind!=="number")throw new Dt(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${Z.kind}, ${re.kind}) instead.`)}if(this.collator&&!T&&this.hasUntypedArgument){const Z=$e(F),re=$e(j);if(Z.kind!=="string"||re.kind!=="string")return u(z,F,j)}return this.collator?p(z,F,j,this.collator.evaluate(z)):u(z,F,j)}eachChild(z){z(this.lhs),z(this.rhs),this.collator&&z(this.collator)}outputDefined(){return!0}}}const VA=Fi("==",function(f,u,p){return u===p},Oi),dl=Fi("!=",function(f,u,p){return u!==p},function(f,u,p,T){return!Oi(0,u,p,T)}),Ao=Fi("<",function(f,u,p){return u<p},function(f,u,p,T){return T.compare(u,p)<0}),Bo=Fi(">",function(f,u,p){return u>p},function(f,u,p,T){return T.compare(u,p)>0}),Zu=Fi("<=",function(f,u,p){return u<=p},function(f,u,p,T){return T.compare(u,p)<=0}),GA=Fi(">=",function(f,u,p){return u>=p},function(f,u,p,T){return T.compare(u,p)>=0});class pl{constructor(u,p,T,D,z){this.type=Tn,this.number=u,this.locale=p,this.currency=T,this.minFractionDigits=D,this.maxFractionDigits=z}static parse(u,p){if(u.length!==3)return p.error("Expected two arguments.");const T=p.parse(u[1],1,kt);if(!T)return null;const D=u[2];if(typeof D!="object"||Array.isArray(D))return p.error("NumberFormat options argument must be an object.");let z=null;if(D.locale&&(z=p.parse(D.locale,1,Tn),!z))return null;let F=null;if(D.currency&&(F=p.parse(D.currency,1,Tn),!F))return null;let j=null;if(D["min-fraction-digits"]&&(j=p.parse(D["min-fraction-digits"],1,kt),!j))return null;let Z=null;return D["max-fraction-digits"]&&(Z=p.parse(D["max-fraction-digits"],1,kt),!Z)?null:new pl(T,z,F,j,Z)}evaluate(u){return new Intl.NumberFormat(this.locale?this.locale.evaluate(u):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(u):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(u):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(u):void 0}).format(this.number.evaluate(u))}eachChild(u){u(this.number),this.locale&&u(this.locale),this.currency&&u(this.currency),this.minFractionDigits&&u(this.minFractionDigits),this.maxFractionDigits&&u(this.maxFractionDigits)}outputDefined(){return!1}}class AA{constructor(u){this.type=Vr,this.sections=u}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const T=u[1];if(!Array.isArray(T)&&typeof T=="object")return p.error("First argument must be an image or text section.");const D=[];let z=!1;for(let F=1;F<=u.length-1;++F){const j=u[F];if(z&&typeof j=="object"&&!Array.isArray(j)){z=!1;let Z=null;if(j["font-scale"]&&(Z=p.parse(j["font-scale"],1,kt),!Z))return null;let re=null;if(j["text-font"]&&(re=p.parse(j["text-font"],1,ri(Tn)),!re))return null;let Ae=null;if(j["text-color"]&&(Ae=p.parse(j["text-color"],1,Mr),!Ae))return null;const ce=D[D.length-1];ce.scale=Z,ce.font=re,ce.textColor=Ae}else{const Z=p.parse(u[F],1,mn);if(!Z)return null;const re=Z.type.kind;if(re!=="string"&&re!=="value"&&re!=="null"&&re!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");z=!0,D.push({content:Z,scale:null,font:null,textColor:null})}}return new AA(D)}evaluate(u){return new Ie(this.sections.map(p=>{const T=p.content.evaluate(u);return $e(T)===kr?new Le("",T,null,null,null):new Le(ft(T),null,p.scale?p.scale.evaluate(u):null,p.font?p.font.evaluate(u).join(","):null,p.textColor?p.textColor.evaluate(u):null)}))}eachChild(u){for(const p of this.sections)u(p.content),p.scale&&u(p.scale),p.font&&u(p.font),p.textColor&&u(p.textColor)}outputDefined(){return!1}}class jA{constructor(u){this.type=kr,this.input=u}static parse(u,p){if(u.length!==2)return p.error("Expected two arguments.");const T=p.parse(u[1],1,Tn);return T?new jA(T):p.error("No image name provided.")}evaluate(u){const p=this.input.evaluate(u),T=ke.fromString(p);return T&&u.availableImages&&(T.available=u.availableImages.indexOf(p)>-1),T}eachChild(u){u(this.input)}outputDefined(){return!1}}class zo{constructor(u){this.type=kt,this.input=u}static parse(u,p){if(u.length!==2)return p.error(`Expected 1 argument, but found ${u.length-1} instead.`);const T=p.parse(u[1],1);return T?T.type.kind!=="array"&&T.type.kind!=="string"&&T.type.kind!=="value"?p.error(`Expected argument of type string or array, but found ${Zn(T.type)} instead.`):new zo(T):null}evaluate(u){const p=this.input.evaluate(u);if(typeof p=="string"||Array.isArray(p))return p.length;throw new Dt(`Expected value to be of type string or array, but found ${Zn($e(p))} instead.`)}eachChild(u){u(this.input)}outputDefined(){return!1}}const Ra={"==":VA,"!=":dl,">":Bo,"<":Ao,">=":GA,"<=":Zu,array:jt,at:fl,boolean:jt,case:lA,coalesce:Xr,collator:Oe,format:AA,image:jA,in:Do,"index-of":ra,interpolate:Bn,"interpolate-hcl":Bn,"interpolate-lab":Bn,length:zo,let:ao,literal:Lt,match:lo,number:jt,"number-format":pl,object:jt,slice:Da,step:Sr,string:jt,"to-boolean":Qt,"to-color":Qt,"to-number":Qt,"to-string":Qt,var:ot,within:Yr};function $A(f,[u,p,T,D]){u=u.evaluate(f),p=p.evaluate(f),T=T.evaluate(f);const z=D?D.evaluate(f):1,F=We(u,p,T,z);if(F)throw new Dt(F);return new o(u/255*z,p/255*z,T/255*z,z)}function HA(f,u){return f in u}function uo(f,u){const p=u[f];return p===void 0?null:p}function ia(f){return{type:f}}function WA(f){return{result:"success",value:f}}function sa(f){return{result:"error",value:f}}function ur(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function Is(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function Gn(f){return!!f.expression&&f.expression.interpolated}function Wn(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function yr(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function hr(f){return f}function gl(f,u){const p=u.type==="color",T=f.stops&&typeof f.stops[0][0]=="object",D=T||!(T||f.property!==void 0),z=f.type||(Gn(u)?"exponential":"interval");if(p||u.type==="padding"){const re=p?o.parse:Pe.parse;(f=pi({},f)).stops&&(f.stops=f.stops.map(Ae=>[Ae[0],re(Ae[1])])),f.default=re(f.default?f.default:u.default)}if(f.colorSpace&&f.colorSpace!=="rgb"&&!Lo[f.colorSpace])throw new Error(`Unknown color space: ${f.colorSpace}`);let F,j,Z;if(z==="exponential")F=Xu;else if(z==="interval")F=Ba;else if(z==="categorical"){F=Yu,j=Object.create(null);for(const re of f.stops)j[re[0]]=re[1];Z=typeof f.stops[0][0]}else{if(z!=="identity")throw new Error(`Unknown function type "${z}"`);F=QA}if(T){const re={},Ae=[];for(let me=0;me<f.stops.length;me++){const _e=f.stops[me],Ue=_e[0].zoom;re[Ue]===void 0&&(re[Ue]={zoom:Ue,type:f.type,property:f.property,default:f.default,stops:[]},Ae.push(Ue)),re[Ue].stops.push([_e[0].value,_e[1]])}const ce=[];for(const me of Ae)ce.push([re[me].zoom,gl(re[me],u)]);const pe={name:"linear"};return{kind:"composite",interpolationType:pe,interpolationFactor:Bn.interpolationFactor.bind(void 0,pe),zoomStops:ce.map(me=>me[0]),evaluate:({zoom:me},_e)=>Xu({stops:ce,base:f.base},u,me).evaluate(me,_e)}}if(D){const re=z==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:re,interpolationFactor:Bn.interpolationFactor.bind(void 0,re),zoomStops:f.stops.map(Ae=>Ae[0]),evaluate:({zoom:Ae})=>F(f,u,Ae,j,Z)}}return{kind:"source",evaluate(re,Ae){const ce=Ae&&Ae.properties?Ae.properties[f.property]:void 0;return ce===void 0?Oo(f.default,u.default):F(f,u,ce,j,Z)}}}function Oo(f,u,p){return f!==void 0?f:u!==void 0?u:p!==void 0?p:void 0}function Yu(f,u,p,T,D){return Oo(typeof p===D?T[p]:void 0,f.default,u.default)}function Ba(f,u,p){if(Wn(p)!=="number")return Oo(f.default,u.default);const T=f.stops.length;if(T===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[T-1][0])return f.stops[T-1][1];const D=kn(f.stops.map(z=>z[0]),p);return f.stops[D][1]}function Xu(f,u,p){const T=f.base!==void 0?f.base:1;if(Wn(p)!=="number")return Oo(f.default,u.default);const D=f.stops.length;if(D===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[D-1][0])return f.stops[D-1][1];const z=kn(f.stops.map(Ae=>Ae[0]),p),F=function(Ae,ce,pe,me){const _e=me-pe,Ue=Ae-pe;return _e===0?0:ce===1?Ue/_e:(Math.pow(ce,Ue)-1)/(Math.pow(ce,_e)-1)}(p,T,f.stops[z][0],f.stops[z+1][0]),j=f.stops[z][1],Z=f.stops[z+1][1];let re=Cr[u.type]||hr;if(f.colorSpace&&f.colorSpace!=="rgb"){const Ae=Lo[f.colorSpace];re=(ce,pe)=>Ae.reverse(Ae.interpolate(Ae.forward(ce),Ae.forward(pe),F))}return typeof j.evaluate=="function"?{evaluate(...Ae){const ce=j.evaluate.apply(void 0,Ae),pe=Z.evaluate.apply(void 0,Ae);if(ce!==void 0&&pe!==void 0)return re(ce,pe,F)}}:re(j,Z,F)}function QA(f,u,p){switch(u.type){case"color":p=o.parse(p);break;case"formatted":p=Ie.fromString(p.toString());break;case"resolvedImage":p=ke.fromString(p.toString());break;case"padding":p=Pe.parse(p);break;default:Wn(p)===u.type||u.type==="enum"&&u.values[p]||(p=void 0)}return Oo(p,f.default,u.default)}Ot.register(Ra,{error:[{kind:"error"},[Tn],(f,[u])=>{throw new Dt(u.evaluate(f))}],typeof:[Tn,[mn],(f,[u])=>Zn($e(u.evaluate(f)))],"to-rgba":[ri(kt,4),[Mr],(f,[u])=>u.evaluate(f).toArray()],rgb:[Mr,[kt,kt,kt],$A],rgba:[Mr,[kt,kt,kt,kt],$A],has:{type:wn,overloads:[[[Tn],(f,[u])=>HA(u.evaluate(f),f.properties())],[[Tn,fs],(f,[u,p])=>HA(u.evaluate(f),p.evaluate(f))]]},get:{type:mn,overloads:[[[Tn],(f,[u])=>uo(u.evaluate(f),f.properties())],[[Tn,fs],(f,[u,p])=>uo(u.evaluate(f),p.evaluate(f))]]},"feature-state":[mn,[Tn],(f,[u])=>uo(u.evaluate(f),f.featureState||{})],properties:[fs,[],f=>f.properties()],"geometry-type":[Tn,[],f=>f.geometryType()],id:[mn,[],f=>f.id()],zoom:[kt,[],f=>f.globals.zoom],"heatmap-density":[kt,[],f=>f.globals.heatmapDensity||0],"line-progress":[kt,[],f=>f.globals.lineProgress||0],accumulated:[mn,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[kt,ia(kt),(f,u)=>{let p=0;for(const T of u)p+=T.evaluate(f);return p}],"*":[kt,ia(kt),(f,u)=>{let p=1;for(const T of u)p*=T.evaluate(f);return p}],"-":{type:kt,overloads:[[[kt,kt],(f,[u,p])=>u.evaluate(f)-p.evaluate(f)],[[kt],(f,[u])=>-u.evaluate(f)]]},"/":[kt,[kt,kt],(f,[u,p])=>u.evaluate(f)/p.evaluate(f)],"%":[kt,[kt,kt],(f,[u,p])=>u.evaluate(f)%p.evaluate(f)],ln2:[kt,[],()=>Math.LN2],pi:[kt,[],()=>Math.PI],e:[kt,[],()=>Math.E],"^":[kt,[kt,kt],(f,[u,p])=>Math.pow(u.evaluate(f),p.evaluate(f))],sqrt:[kt,[kt],(f,[u])=>Math.sqrt(u.evaluate(f))],log10:[kt,[kt],(f,[u])=>Math.log(u.evaluate(f))/Math.LN10],ln:[kt,[kt],(f,[u])=>Math.log(u.evaluate(f))],log2:[kt,[kt],(f,[u])=>Math.log(u.evaluate(f))/Math.LN2],sin:[kt,[kt],(f,[u])=>Math.sin(u.evaluate(f))],cos:[kt,[kt],(f,[u])=>Math.cos(u.evaluate(f))],tan:[kt,[kt],(f,[u])=>Math.tan(u.evaluate(f))],asin:[kt,[kt],(f,[u])=>Math.asin(u.evaluate(f))],acos:[kt,[kt],(f,[u])=>Math.acos(u.evaluate(f))],atan:[kt,[kt],(f,[u])=>Math.atan(u.evaluate(f))],min:[kt,ia(kt),(f,u)=>Math.min(...u.map(p=>p.evaluate(f)))],max:[kt,ia(kt),(f,u)=>Math.max(...u.map(p=>p.evaluate(f)))],abs:[kt,[kt],(f,[u])=>Math.abs(u.evaluate(f))],round:[kt,[kt],(f,[u])=>{const p=u.evaluate(f);return p<0?-Math.round(-p):Math.round(p)}],floor:[kt,[kt],(f,[u])=>Math.floor(u.evaluate(f))],ceil:[kt,[kt],(f,[u])=>Math.ceil(u.evaluate(f))],"filter-==":[wn,[Tn,mn],(f,[u,p])=>f.properties()[u.value]===p.value],"filter-id-==":[wn,[mn],(f,[u])=>f.id()===u.value],"filter-type-==":[wn,[Tn],(f,[u])=>f.geometryType()===u.value],"filter-<":[wn,[Tn,mn],(f,[u,p])=>{const T=f.properties()[u.value],D=p.value;return typeof T==typeof D&&T<D}],"filter-id-<":[wn,[mn],(f,[u])=>{const p=f.id(),T=u.value;return typeof p==typeof T&&p<T}],"filter->":[wn,[Tn,mn],(f,[u,p])=>{const T=f.properties()[u.value],D=p.value;return typeof T==typeof D&&T>D}],"filter-id->":[wn,[mn],(f,[u])=>{const p=f.id(),T=u.value;return typeof p==typeof T&&p>T}],"filter-<=":[wn,[Tn,mn],(f,[u,p])=>{const T=f.properties()[u.value],D=p.value;return typeof T==typeof D&&T<=D}],"filter-id-<=":[wn,[mn],(f,[u])=>{const p=f.id(),T=u.value;return typeof p==typeof T&&p<=T}],"filter->=":[wn,[Tn,mn],(f,[u,p])=>{const T=f.properties()[u.value],D=p.value;return typeof T==typeof D&&T>=D}],"filter-id->=":[wn,[mn],(f,[u])=>{const p=f.id(),T=u.value;return typeof p==typeof T&&p>=T}],"filter-has":[wn,[mn],(f,[u])=>u.value in f.properties()],"filter-has-id":[wn,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[wn,[ri(Tn)],(f,[u])=>u.value.indexOf(f.geometryType())>=0],"filter-id-in":[wn,[ri(mn)],(f,[u])=>u.value.indexOf(f.id())>=0],"filter-in-small":[wn,[Tn,ri(mn)],(f,[u,p])=>p.value.indexOf(f.properties()[u.value])>=0],"filter-in-large":[wn,[Tn,ri(mn)],(f,[u,p])=>function(T,D,z,F){for(;z<=F;){const j=z+F>>1;if(D[j]===T)return!0;D[j]>T?F=j-1:z=j+1}return!1}(f.properties()[u.value],p.value,0,p.value.length-1)],all:{type:wn,overloads:[[[wn,wn],(f,[u,p])=>u.evaluate(f)&&p.evaluate(f)],[ia(wn),(f,u)=>{for(const p of u)if(!p.evaluate(f))return!1;return!0}]]},any:{type:wn,overloads:[[[wn,wn],(f,[u,p])=>u.evaluate(f)||p.evaluate(f)],[ia(wn),(f,u)=>{for(const p of u)if(p.evaluate(f))return!0;return!1}]]},"!":[wn,[wn],(f,[u])=>!u.evaluate(f)],"is-supported-script":[wn,[Tn],(f,[u])=>{const p=f.globals&&f.globals.isSupportedScript;return!p||p(u.evaluate(f))}],upcase:[Tn,[Tn],(f,[u])=>u.evaluate(f).toUpperCase()],downcase:[Tn,[Tn],(f,[u])=>u.evaluate(f).toLowerCase()],concat:[Tn,ia(mn),(f,u)=>u.map(p=>ft(p.evaluate(f))).join("")],"resolved-locale":[Tn,[Ze],(f,[u])=>u.evaluate(f).resolvedLocale()]});class ks{constructor(u,p){this.expression=u,this._warningHistory={},this._evaluator=new vn,this._defaultValue=p?function(T){return T.type==="color"&&yr(T.default)?new o(0,0,0,0):T.type==="color"?o.parse(T.default)||null:T.type==="padding"?Pe.parse(T.default)||null:T.default===void 0?null:T.default}(p):null,this._enumValues=p&&p.type==="enum"?p.values:null}evaluateWithoutErrorHandling(u,p,T,D,z,F){return this._evaluator.globals=u,this._evaluator.feature=p,this._evaluator.featureState=T,this._evaluator.canonical=D,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=F,this.expression.evaluate(this._evaluator)}evaluate(u,p,T,D,z,F){this._evaluator.globals=u,this._evaluator.feature=p||null,this._evaluator.featureState=T||null,this._evaluator.canonical=D,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=F||null;try{const j=this.expression.evaluate(this._evaluator);if(j==null||typeof j=="number"&&j!=j)return this._defaultValue;if(this._enumValues&&!(j in this._enumValues))throw new Dt(`Expected value to be one of ${Object.keys(this._enumValues).map(Z=>JSON.stringify(Z)).join(", ")}, but found ${JSON.stringify(j)} instead.`);return j}catch(j){return this._warningHistory[j.message]||(this._warningHistory[j.message]=!0,typeof console<"u"&&console.warn(j.message)),this._defaultValue}}}function ml(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in Ra}function za(f,u){const p=new wt(Ra,[],u?function(D){const z={color:Mr,string:Tn,number:kt,enum:Tn,boolean:wn,formatted:Vr,padding:Cs,resolvedImage:kr};return D.type==="array"?ri(z[D.value]||mn,D.length):z[D.type]}(u):void 0),T=p.parse(f,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return T?WA(new ks(T,u)):sa(p.errors)}class oa{constructor(u,p){this.kind=u,this._styleExpression=p,this.isStateDependent=u!=="constant"&&!Ee(p.expression)}evaluateWithoutErrorHandling(u,p,T,D,z,F){return this._styleExpression.evaluateWithoutErrorHandling(u,p,T,D,z,F)}evaluate(u,p,T,D,z,F){return this._styleExpression.evaluate(u,p,T,D,z,F)}}class yl{constructor(u,p,T,D){this.kind=u,this.zoomStops=T,this._styleExpression=p,this.isStateDependent=u!=="camera"&&!Ee(p.expression),this.interpolationType=D}evaluateWithoutErrorHandling(u,p,T,D,z,F){return this._styleExpression.evaluateWithoutErrorHandling(u,p,T,D,z,F)}evaluate(u,p,T,D,z,F){return this._styleExpression.evaluate(u,p,T,D,z,F)}interpolationFactor(u,p,T){return this.interpolationType?Bn.interpolationFactor(this.interpolationType,u,p,T):0}}function _l(f,u){const p=za(f,u);if(p.result==="error")return p;const T=p.value.expression,D=ge(T);if(!D&&!ur(u))return sa([new Ei("","data expressions not supported")]);const z=Fe(T,["zoom"]);if(!z&&!Is(u))return sa([new Ei("","zoom expressions not supported")]);const F=uA(T);return F||z?F instanceof Ei?sa([F]):F instanceof Bn&&!Gn(u)?sa([new Ei("",'"interpolate" expressions cannot be used with this property')]):WA(F?new yl(D?"camera":"composite",p.value,F.labels,F instanceof Bn?F.interpolation:void 0):new oa(D?"constant":"source",p.value)):sa([new Ei("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class fr{constructor(u,p){this._parameters=u,this._specification=p,pi(this,gl(this._parameters,this._specification))}static deserialize(u){return new fr(u._parameters,u._specification)}static serialize(u){return{_parameters:u._parameters,_specification:u._specification}}}function uA(f){let u=null;if(f instanceof ao)u=uA(f.result);else if(f instanceof Xr){for(const p of f.args)if(u=uA(p),u)break}else(f instanceof Sr||f instanceof Bn)&&f.input instanceof Ot&&f.input.name==="zoom"&&(u=f);return u instanceof Ei||f.eachChild(p=>{const T=uA(p);T instanceof Ei?u=T:!u&&T?u=new Ei("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):u&&T&&u!==T&&(u=new Ei("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),u}function ts(f){const u=f.key,p=f.value,T=f.valueSpec||{},D=f.objectElementValidators||{},z=f.style,F=f.styleSpec;let j=[];const Z=Wn(p);if(Z!=="object")return[new It(u,p,`object expected, ${Z} found`)];for(const re in p){const Ae=re.split(".")[0],ce=T[Ae]||T["*"];let pe;if(D[Ae])pe=D[Ae];else if(T[Ae])pe=ji;else if(D["*"])pe=D["*"];else{if(!T["*"]){j.push(new It(u,p[re],`unknown property "${re}"`));continue}pe=ji}j=j.concat(pe({key:(u&&`${u}.`)+re,value:p[re],valueSpec:ce,style:z,styleSpec:F,object:p,objectKey:re},p))}for(const re in T)D[re]||T[re].required&&T[re].default===void 0&&p[re]===void 0&&j.push(new It(u,p,`missing required property "${re}"`));return j}function qA(f){const u=f.value,p=f.valueSpec,T=f.style,D=f.styleSpec,z=f.key,F=f.arrayElementValidator||ji;if(Wn(u)!=="array")return[new It(z,u,`array expected, ${Wn(u)} found`)];if(p.length&&u.length!==p.length)return[new It(z,u,`array length ${p.length} expected, length ${u.length} found`)];if(p["min-length"]&&u.length<p["min-length"])return[new It(z,u,`array length at least ${p["min-length"]} expected, length ${u.length} found`)];let j={type:p.value,values:p.values};D.$version<7&&(j.function=p.function),Wn(p.value)==="object"&&(j=p.value);let Z=[];for(let re=0;re<u.length;re++)Z=Z.concat(F({array:u,arrayIndex:re,value:u[re],valueSpec:j,style:T,styleSpec:D,key:`${z}[${re}]`}));return Z}function vl(f){const u=f.key,p=f.value,T=f.valueSpec;let D=Wn(p);return D==="number"&&p!=p&&(D="NaN"),D!=="number"?[new It(u,p,`number expected, ${D} found`)]:"minimum"in T&&p<T.minimum?[new It(u,p,`${p} is less than the minimum value ${T.minimum}`)]:"maximum"in T&&p>T.maximum?[new It(u,p,`${p} is greater than the maximum value ${T.maximum}`)]:[]}function Ku(f){const u=f.valueSpec,p=Rn(f.value.type);let T,D,z,F={};const j=p!=="categorical"&&f.value.property===void 0,Z=!j,re=Wn(f.value.stops)==="array"&&Wn(f.value.stops[0])==="array"&&Wn(f.value.stops[0][0])==="object",Ae=ts({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(me){if(p==="identity")return[new It(me.key,me.value,'identity function may not have a "stops" property')];let _e=[];const Ue=me.value;return _e=_e.concat(qA({key:me.key,value:Ue,valueSpec:me.valueSpec,style:me.style,styleSpec:me.styleSpec,arrayElementValidator:ce})),Wn(Ue)==="array"&&Ue.length===0&&_e.push(new It(me.key,Ue,"array must have at least one stop")),_e},default:function(me){return ji({key:me.key,value:me.value,valueSpec:u,style:me.style,styleSpec:me.styleSpec})}}});return p==="identity"&&j&&Ae.push(new It(f.key,f.value,'missing required property "property"')),p==="identity"||f.value.stops||Ae.push(new It(f.key,f.value,'missing required property "stops"')),p==="exponential"&&f.valueSpec.expression&&!Gn(f.valueSpec)&&Ae.push(new It(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(Z&&!ur(f.valueSpec)?Ae.push(new It(f.key,f.value,"property functions not supported")):j&&!Is(f.valueSpec)&&Ae.push(new It(f.key,f.value,"zoom functions not supported"))),p!=="categorical"&&!re||f.value.property!==void 0||Ae.push(new It(f.key,f.value,'"property" property is required')),Ae;function ce(me){let _e=[];const Ue=me.value,ze=me.key;if(Wn(Ue)!=="array")return[new It(ze,Ue,`array expected, ${Wn(Ue)} found`)];if(Ue.length!==2)return[new It(ze,Ue,`array length 2 expected, length ${Ue.length} found`)];if(re){if(Wn(Ue[0])!=="object")return[new It(ze,Ue,`object expected, ${Wn(Ue[0])} found`)];if(Ue[0].zoom===void 0)return[new It(ze,Ue,"object stop key must have zoom")];if(Ue[0].value===void 0)return[new It(ze,Ue,"object stop key must have value")];if(z&&z>Rn(Ue[0].zoom))return[new It(ze,Ue[0].zoom,"stop zoom values must appear in ascending order")];Rn(Ue[0].zoom)!==z&&(z=Rn(Ue[0].zoom),D=void 0,F={}),_e=_e.concat(ts({key:`${ze}[0]`,value:Ue[0],valueSpec:{zoom:{}},style:me.style,styleSpec:me.styleSpec,objectElementValidators:{zoom:vl,value:pe}}))}else _e=_e.concat(pe({key:`${ze}[0]`,value:Ue[0],valueSpec:{},style:me.style,styleSpec:me.styleSpec},Ue));return ml(Ri(Ue[1]))?_e.concat([new It(`${ze}[1]`,Ue[1],"expressions are not allowed in function stops.")]):_e.concat(ji({key:`${ze}[1]`,value:Ue[1],valueSpec:u,style:me.style,styleSpec:me.styleSpec}))}function pe(me,_e){const Ue=Wn(me.value),ze=Rn(me.value),et=me.value!==null?me.value:_e;if(T){if(Ue!==T)return[new It(me.key,et,`${Ue} stop domain type must match previous stop domain type ${T}`)]}else T=Ue;if(Ue!=="number"&&Ue!=="string"&&Ue!=="boolean")return[new It(me.key,et,"stop domain value must be a number, string, or boolean")];if(Ue!=="number"&&p!=="categorical"){let lt=`number expected, ${Ue} found`;return ur(u)&&p===void 0&&(lt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new It(me.key,et,lt)]}return p!=="categorical"||Ue!=="number"||isFinite(ze)&&Math.floor(ze)===ze?p!=="categorical"&&Ue==="number"&&D!==void 0&&ze<D?[new It(me.key,et,"stop domain values must appear in ascending order")]:(D=ze,p==="categorical"&&ze in F?[new It(me.key,et,"stop domain values must be unique")]:(F[ze]=!0,[])):[new It(me.key,et,`integer expected, found ${ze}`)]}}function jr(f){const u=(f.expressionContext==="property"?_l:za)(Ri(f.value),f.valueSpec);if(u.result==="error")return u.value.map(T=>new It(`${f.key}${T.key}`,f.value,T.message));const p=u.value.expression||u.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!p.outputDefined())return[new It(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!Ee(p))return[new It(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!Ee(p))return[new It(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!Fe(p,["zoom","feature-state"]))return[new It(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!ge(p))return[new It(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Pr(f){const u=f.key,p=f.value,T=f.valueSpec,D=[];return Array.isArray(T.values)?T.values.indexOf(Rn(p))===-1&&D.push(new It(u,p,`expected one of [${T.values.join(", ")}], ${JSON.stringify(p)} found`)):Object.keys(T.values).indexOf(Rn(p))===-1&&D.push(new It(u,p,`expected one of [${Object.keys(T.values).join(", ")}], ${JSON.stringify(p)} found`)),D}function Kr(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const u of f.slice(1))if(!Kr(u)&&typeof u!="boolean")return!1;return!0;default:return!0}}const ZA={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ls(f){if(f==null)return{filter:()=>!0,needGeometry:!1};Kr(f)||(f=si(f));const u=za(f,ZA);if(u.result==="error")throw new Error(u.value.map(p=>`${p.key}: ${p.message}`).join(", "));return{filter:(p,T,D)=>u.value.evaluate(p,T,{},D),needGeometry:cA(f)}}function Ju(f,u){return f<u?-1:f>u?1:0}function cA(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(let u=1;u<f.length;u++)if(cA(f[u]))return!0;return!1}function si(f){if(!f)return!0;const u=f[0];return f.length<=1?u!=="any":u==="=="?gi(f[1],f[2],"=="):u==="!="?Gi(gi(f[1],f[2],"==")):u==="<"||u===">"||u==="<="||u===">="?gi(f[1],f[2],u):u==="any"?(p=f.slice(1),["any"].concat(p.map(si))):u==="all"?["all"].concat(f.slice(1).map(si)):u==="none"?["all"].concat(f.slice(1).map(si).map(Gi)):u==="in"?ns(f[1],f.slice(2)):u==="!in"?Gi(ns(f[1],f.slice(2))):u==="has"?aa(f[1]):u==="!has"?Gi(aa(f[1])):u!=="within"||f;var p}function gi(f,u,p){switch(f){case"$type":return[`filter-type-${p}`,u];case"$id":return[`filter-id-${p}`,u];default:return[`filter-${p}`,f,u]}}function ns(f,u){if(u.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(p=>typeof p!=typeof u[0])?["filter-in-large",f,["literal",u.sort(Ju)]]:["filter-in-small",f,["literal",u]]}}function aa(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function Gi(f){return["!",f]}function co(f){return Kr(Ri(f.value))?jr(pi({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ai(f)}function Ai(f){const u=f.value,p=f.key;if(Wn(u)!=="array")return[new It(p,u,`array expected, ${Wn(u)} found`)];const T=f.styleSpec;let D,z=[];if(u.length<1)return[new It(p,u,"filter array must have at least 1 element")];switch(z=z.concat(Pr({key:`${p}[0]`,value:u[0],valueSpec:T.filter_operator,style:f.style,styleSpec:f.styleSpec})),Rn(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Rn(u[1])==="$type"&&z.push(new It(p,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&z.push(new It(p,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(D=Wn(u[1]),D!=="string"&&z.push(new It(`${p}[1]`,u[1],`string expected, ${D} found`)));for(let F=2;F<u.length;F++)D=Wn(u[F]),Rn(u[1])==="$type"?z=z.concat(Pr({key:`${p}[${F}]`,value:u[F],valueSpec:T.geometry_type,style:f.style,styleSpec:f.styleSpec})):D!=="string"&&D!=="number"&&D!=="boolean"&&z.push(new It(`${p}[${F}]`,u[F],`string, number, or boolean expected, ${D} found`));break;case"any":case"all":case"none":for(let F=1;F<u.length;F++)z=z.concat(Ai({key:`${p}[${F}]`,value:u[F],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":D=Wn(u[1]),u.length!==2?z.push(new It(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):D!=="string"&&z.push(new It(`${p}[1]`,u[1],`string expected, ${D} found`));break;case"within":D=Wn(u[1]),u.length!==2?z.push(new It(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):D!=="object"&&z.push(new It(`${p}[1]`,u[1],`object expected, ${D} found`))}return z}function Oa(f,u){const p=f.key,T=f.style,D=f.styleSpec,z=f.value,F=f.objectKey,j=D[`${u}_${f.layerType}`];if(!j)return[];const Z=F.match(/^(.*)-transition$/);if(u==="paint"&&Z&&j[Z[1]]&&j[Z[1]].transition)return ji({key:p,value:z,valueSpec:D.transition,style:T,styleSpec:D});const re=f.valueSpec||j[F];if(!re)return[new It(p,z,`unknown property "${F}"`)];let Ae;if(Wn(z)==="string"&&ur(re)&&!re.tokens&&(Ae=/^{([^}]+)}$/.exec(z)))return[new It(p,z,`"${F}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Ae[1])} }\`.`)];const ce=[];return f.layerType==="symbol"&&(F==="text-field"&&T&&!T.glyphs&&ce.push(new It(p,z,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&yr(Ri(z))&&Rn(z.type)==="identity"&&ce.push(new It(p,z,'"text-font" does not support identity functions'))),ce.concat(ji({key:f.key,value:z,valueSpec:re,style:T,styleSpec:D,expressionContext:"property",propertyType:u,propertyKey:F}))}function xl(f){return Oa(f,"paint")}function Fa(f){return Oa(f,"layout")}function Ds(f){let u=[];const p=f.value,T=f.key,D=f.style,z=f.styleSpec;p.type||p.ref||u.push(new It(T,p,'either "type" or "ref" is required'));let F=Rn(p.type);const j=Rn(p.ref);if(p.id){const Z=Rn(p.id);for(let re=0;re<f.arrayIndex;re++){const Ae=D.layers[re];Rn(Ae.id)===Z&&u.push(new It(T,p.id,`duplicate layer id "${p.id}", previously used at line ${Ae.id.__line__}`))}}if("ref"in p){let Z;["type","source","source-layer","filter","layout"].forEach(re=>{re in p&&u.push(new It(T,p[re],`"${re}" is prohibited for ref layers`))}),D.layers.forEach(re=>{Rn(re.id)===j&&(Z=re)}),Z?Z.ref?u.push(new It(T,p.ref,"ref cannot reference another ref layer")):F=Rn(Z.type):u.push(new It(T,p.ref,`ref layer "${j}" not found`))}else if(F!=="background")if(p.source){const Z=D.sources&&D.sources[p.source],re=Z&&Rn(Z.type);Z?re==="vector"&&F==="raster"?u.push(new It(T,p.source,`layer "${p.id}" requires a raster source`)):re==="raster"&&F!=="raster"?u.push(new It(T,p.source,`layer "${p.id}" requires a vector source`)):re!=="vector"||p["source-layer"]?re==="raster-dem"&&F!=="hillshade"?u.push(new It(T,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):F!=="line"||!p.paint||!p.paint["line-gradient"]||re==="geojson"&&Z.lineMetrics||u.push(new It(T,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new It(T,p,`layer "${p.id}" must specify a "source-layer"`)):u.push(new It(T,p.source,`source "${p.source}" not found`))}else u.push(new It(T,p,'missing required property "source"'));return u=u.concat(ts({key:T,value:p,valueSpec:z.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ji({key:`${T}.type`,value:p.type,valueSpec:z.layer.type,style:f.style,styleSpec:f.styleSpec,object:p,objectKey:"type"}),filter:co,layout:Z=>ts({layer:p,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":re=>Fa(pi({layerType:F},re))}}),paint:Z=>ts({layer:p,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":re=>xl(pi({layerType:F},re))}})}})),u}function rs(f){const u=f.value,p=f.key,T=Wn(u);return T!=="string"?[new It(p,u,`string expected, ${T} found`)]:[]}const ec={promoteId:function({key:f,value:u}){if(Wn(u)==="string")return rs({key:f,value:u});{const p=[];for(const T in u)p.push(...rs({key:`${f}.${T}`,value:u[T]}));return p}}};function la(f){const u=f.value,p=f.key,T=f.styleSpec,D=f.style;if(!u.type)return[new It(p,u,'"type" is required')];const z=Rn(u.type);let F;switch(z){case"vector":case"raster":case"raster-dem":return F=ts({key:p,value:u,valueSpec:T[`source_${z.replace("-","_")}`],style:f.style,styleSpec:T,objectElementValidators:ec}),F;case"geojson":if(F=ts({key:p,value:u,valueSpec:T.source_geojson,style:D,styleSpec:T,objectElementValidators:ec}),u.cluster)for(const j in u.clusterProperties){const[Z,re]=u.clusterProperties[j],Ae=typeof Z=="string"?[Z,["accumulated"],["get",j]]:Z;F.push(...jr({key:`${p}.${j}.map`,value:re,expressionContext:"cluster-map"})),F.push(...jr({key:`${p}.${j}.reduce`,value:Ae,expressionContext:"cluster-reduce"}))}return F;case"video":return ts({key:p,value:u,valueSpec:T.source_video,style:D,styleSpec:T});case"image":return ts({key:p,value:u,valueSpec:T.source_image,style:D,styleSpec:T});case"canvas":return[new It(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Pr({key:`${p}.type`,value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:D,styleSpec:T})}}function Na(f){const u=f.value,p=f.styleSpec,T=p.light,D=f.style;let z=[];const F=Wn(u);if(u===void 0)return z;if(F!=="object")return z=z.concat([new It("light",u,`object expected, ${F} found`)]),z;for(const j in u){const Z=j.match(/^(.*)-transition$/);z=z.concat(Z&&T[Z[1]]&&T[Z[1]].transition?ji({key:j,value:u[j],valueSpec:p.transition,style:D,styleSpec:p}):T[j]?ji({key:j,value:u[j],valueSpec:T[j],style:D,styleSpec:p}):[new It(j,u[j],`unknown property "${j}"`)])}return z}function Jr(f){const u=f.value,p=f.styleSpec,T=p.terrain,D=f.style;let z=[];const F=Wn(u);if(u===void 0)return z;if(F!=="object")return z=z.concat([new It("terrain",u,`object expected, ${F} found`)]),z;for(const j in u)z=z.concat(T[j]?ji({key:j,value:u[j],valueSpec:T[j],style:D,styleSpec:p}):[new It(j,u[j],`unknown property "${j}"`)]);return z}const gs={"*":()=>[],array:qA,boolean:function(f){const u=f.value,p=f.key,T=Wn(u);return T!=="boolean"?[new It(p,u,`boolean expected, ${T} found`)]:[]},number:vl,color:function(f){const u=f.key,p=f.value,T=Wn(p);return T!=="string"?[new It(u,p,`color expected, ${T} found`)]:es(p)===null?[new It(u,p,`color expected, "${p}" found`)]:[]},constants:Ms,enum:Pr,filter:co,function:Ku,layer:Ds,object:ts,source:la,light:Na,terrain:Jr,string:rs,formatted:function(f){return rs(f).length===0?[]:jr(f)},resolvedImage:function(f){return rs(f).length===0?[]:jr(f)},padding:function(f){const u=f.key,p=f.value;if(Wn(p)==="array"){if(p.length<1||p.length>4)return[new It(u,p,`padding requires 1 to 4 values; ${p.length} values found`)];const T={type:"number"};let D=[];for(let z=0;z<p.length;z++)D=D.concat(ji({key:`${u}[${z}]`,value:p[z],valueSpec:T}));return D}return vl({key:u,value:p,valueSpec:{}})}};function ji(f){const u=f.value,p=f.valueSpec,T=f.styleSpec;return p.expression&&yr(Rn(u))?Ku(f):p.expression&&ml(Ri(u))?jr(f):p.type&&gs[p.type]?gs[p.type](f):ts(pi({},f,{valueSpec:p.type?T[p.type]:p}))}function wl(f){const u=f.value,p=f.key,T=rs(f);return T.length||(u.indexOf("{fontstack}")===-1&&T.push(new It(p,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&T.push(new It(p,u,'"glyphs" url must include a "{range}" token'))),T}function Fo(f,u=ct){let p=[];return p=p.concat(ji({key:"",value:f,valueSpec:u.$root,styleSpec:u,style:f,objectElementValidators:{glyphs:wl,"*":()=>[]}})),f.constants&&(p=p.concat(Ms({key:"constants",value:f.constants,style:f,styleSpec:u}))),tc(p)}function tc(f){return[].concat(f).sort((u,p)=>u.line-p.line)}function ho(f){return function(...u){return tc(f.apply(this,u))}}Fo.source=ho(la),Fo.light=ho(Na),Fo.terrain=ho(Jr),Fo.layer=ho(Ds),Fo.filter=ho(co),Fo.paintProperty=ho(xl),Fo.layoutProperty=ho(Fa);const bl=Fo,Ua=bl.light,Jc=bl.paintProperty,eh=bl.layoutProperty;function Va(f,u){let p=!1;if(u&&u.length)for(const T of u)f.fire(new Io(new Error(T.message))),p=!0;return p}class Aa{constructor(u,p,T){const D=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;const F=new Int32Array(this.arrayBuffer);u=F[0],this.d=(p=F[1])+2*(T=F[2]);for(let Z=0;Z<this.d*this.d;Z++){const re=F[3+Z],Ae=F[3+Z+1];D.push(re===Ae?null:F.subarray(re,Ae))}const j=F[3+D.length+1];this.keys=F.subarray(F[3+D.length],j),this.bboxes=F.subarray(j),this.insert=this._insertReadonly}else{this.d=p+2*T;for(let F=0;F<this.d*this.d;F++)D.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=u,this.padding=T,this.scale=p/u,this.uid=0;const z=T/p*u;this.min=-z,this.max=u+z}insert(u,p,T,D,z){this._forEachCell(p,T,D,z,this._insertCell,this.uid++,void 0,void 0),this.keys.push(u),this.bboxes.push(p),this.bboxes.push(T),this.bboxes.push(D),this.bboxes.push(z)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(u,p,T,D,z,F){this.cells[z].push(F)}query(u,p,T,D,z){const F=this.min,j=this.max;if(u<=F&&p<=F&&j<=T&&j<=D&&!z)return Array.prototype.slice.call(this.keys);{const Z=[];return this._forEachCell(u,p,T,D,this._queryCell,Z,{},z),Z}}_queryCell(u,p,T,D,z,F,j,Z){const re=this.cells[z];if(re!==null){const Ae=this.keys,ce=this.bboxes;for(let pe=0;pe<re.length;pe++){const me=re[pe];if(j[me]===void 0){const _e=4*me;(Z?Z(ce[_e+0],ce[_e+1],ce[_e+2],ce[_e+3]):u<=ce[_e+2]&&p<=ce[_e+3]&&T>=ce[_e+0]&&D>=ce[_e+1])?(j[me]=!0,F.push(Ae[me])):j[me]=!1}}}}_forEachCell(u,p,T,D,z,F,j,Z){const re=this._convertToCellCoord(u),Ae=this._convertToCellCoord(p),ce=this._convertToCellCoord(T),pe=this._convertToCellCoord(D);for(let me=re;me<=ce;me++)for(let _e=Ae;_e<=pe;_e++){const Ue=this.d*_e+me;if((!Z||Z(this._convertFromCellCoord(me),this._convertFromCellCoord(_e),this._convertFromCellCoord(me+1),this._convertFromCellCoord(_e+1)))&&z.call(this,u,p,T,D,Ue,F,j,Z))return}}_convertFromCellCoord(u){return(u-this.padding)/this.scale}_convertToCellCoord(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const u=this.cells,p=3+this.cells.length+1+1;let T=0;for(let F=0;F<this.cells.length;F++)T+=this.cells[F].length;const D=new Int32Array(p+T+this.keys.length+this.bboxes.length);D[0]=this.extent,D[1]=this.n,D[2]=this.padding;let z=p;for(let F=0;F<u.length;F++){const j=u[F];D[3+F]=z,D.set(j,z),z+=j.length}return D[3+u.length]=z,D.set(this.keys,z),z+=this.keys.length,D[3+u.length+1]=z,D.set(this.bboxes,z),z+=this.bboxes.length,D.buffer}static serialize(u,p){const T=u.toArrayBuffer();return p&&p.push(T),{buffer:T}}static deserialize(u){return new Aa(u.buffer)}}const is={};function Ft(f,u,p={}){if(is[f])throw new Error(`${f} is already registered.`);Object.defineProperty(u,"_classRegistryKey",{value:f,writeable:!1}),is[f]={klass:u,omit:p.omit||[],shallow:p.shallow||[]}}Ft("Object",Object),Ft("TransferableGridIndex",Aa),Ft("Color",o),Ft("Error",Error),Ft("AJAXError",er),Ft("ResolvedImage",ke),Ft("StylePropertyFunction",fr),Ft("StyleExpression",ks,{omit:["_evaluator"]}),Ft("ZoomDependentExpression",yl),Ft("ZoomConstantExpression",oa),Ft("CompoundExpression",Ot,{omit:["_evaluate"]});for(const f in Ra)Ra[f]._classRegistryKey||Ft(`Expression_${f}`,Ra[f]);function YA(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function ua(f,u){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob)return f;if(YA(f)||mt(f))return u&&u.push(f),f;if(ArrayBuffer.isView(f)){const p=f;return u&&u.push(p.buffer),p}if(f instanceof ImageData)return u&&u.push(f.data.buffer),f;if(Array.isArray(f)){const p=[];for(const T of f)p.push(ua(T,u));return p}if(typeof f=="object"){const p=f.constructor,T=p._classRegistryKey;if(!T)throw new Error("can't serialize object of unregistered class");if(!is[T])throw new Error(`${T} is not registered.`);const D=p.serialize?p.serialize(f,u):{};if(p.serialize){if(u&&D===u[u.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const z in f){if(!f.hasOwnProperty(z)||is[T].omit.indexOf(z)>=0)continue;const F=f[z];D[z]=is[T].shallow.indexOf(z)>=0?F:ua(F,u)}f instanceof Error&&(D.message=f.message)}if(D.$name)throw new Error("$name property is reserved for worker serialization logic.");return T!=="Object"&&(D.$name=T),D}throw new Error("can't serialize object of type "+typeof f)}function No(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob||YA(f)||mt(f)||ArrayBuffer.isView(f)||f instanceof ImageData)return f;if(Array.isArray(f))return f.map(No);if(typeof f=="object"){const u=f.$name||"Object";if(!is[u])throw new Error(`can't deserialize unregistered class ${u}`);const{klass:p}=is[u];if(!p)throw new Error(`can't deserialize unregistered class ${u}`);if(p.deserialize)return p.deserialize(f);const T=Object.create(p.prototype);for(const D of Object.keys(f)){if(D==="$name")continue;const z=f[D];T[D]=is[u].shallow.indexOf(D)>=0?z:No(z)}return T}throw new Error("can't deserialize object of type "+typeof f)}class XA{constructor(){this.first=!0}update(u,p){const T=Math.floor(u);return this.first?(this.first=!1,this.lastIntegerZoom=T,this.lastIntegerZoomTime=0,this.lastZoom=u,this.lastFloorZoom=T,!0):(this.lastFloorZoom>T?(this.lastIntegerZoom=T+1,this.lastIntegerZoomTime=p):this.lastFloorZoom<T&&(this.lastIntegerZoom=T,this.lastIntegerZoomTime=p),u!==this.lastZoom&&(this.lastZoom=u,this.lastFloorZoom=T,!0))}}const Ut={"Latin-1 Supplement":f=>f>=128&&f<=255,Arabic:f=>f>=1536&&f<=1791,"Arabic Supplement":f=>f>=1872&&f<=1919,"Arabic Extended-A":f=>f>=2208&&f<=2303,"Hangul Jamo":f=>f>=4352&&f<=4607,"Unified Canadian Aboriginal Syllabics":f=>f>=5120&&f<=5759,Khmer:f=>f>=6016&&f<=6143,"Unified Canadian Aboriginal Syllabics Extended":f=>f>=6320&&f<=6399,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"CJK Radicals Supplement":f=>f>=11904&&f<=12031,"Kangxi Radicals":f=>f>=12032&&f<=12255,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Bopomofo:f=>f>=12544&&f<=12591,"Hangul Compatibility Jamo":f=>f>=12592&&f<=12687,Kanbun:f=>f>=12688&&f<=12703,"Bopomofo Extended":f=>f>=12704&&f<=12735,"CJK Strokes":f=>f>=12736&&f<=12783,"Katakana Phonetic Extensions":f=>f>=12784&&f<=12799,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"CJK Unified Ideographs Extension A":f=>f>=13312&&f<=19903,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Yi Syllables":f=>f>=40960&&f<=42127,"Yi Radicals":f=>f>=42128&&f<=42191,"Hangul Jamo Extended-A":f=>f>=43360&&f<=43391,"Hangul Syllables":f=>f>=44032&&f<=55215,"Hangul Jamo Extended-B":f=>f>=55216&&f<=55295,"Private Use Area":f=>f>=57344&&f<=63743,"CJK Compatibility Ideographs":f=>f>=63744&&f<=64255,"Arabic Presentation Forms-A":f=>f>=64336&&f<=65023,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Arabic Presentation Forms-B":f=>f>=65136&&f<=65279,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519};function hA(f){for(const u of f)if(Ga(u.charCodeAt(0)))return!0;return!1}function El(f){for(const u of f)if(!fA(u.charCodeAt(0)))return!1;return!0}function fA(f){return!(Ut.Arabic(f)||Ut["Arabic Supplement"](f)||Ut["Arabic Extended-A"](f)||Ut["Arabic Presentation Forms-A"](f)||Ut["Arabic Presentation Forms-B"](f))}function Ga(f){return!(f!==746&&f!==747&&(f<4352||!(Ut["Bopomofo Extended"](f)||Ut.Bopomofo(f)||Ut["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Ut["CJK Compatibility Ideographs"](f)||Ut["CJK Compatibility"](f)||Ut["CJK Radicals Supplement"](f)||Ut["CJK Strokes"](f)||!(!Ut["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Ut["CJK Unified Ideographs Extension A"](f)||Ut["CJK Unified Ideographs"](f)||Ut["Enclosed CJK Letters and Months"](f)||Ut["Hangul Compatibility Jamo"](f)||Ut["Hangul Jamo Extended-A"](f)||Ut["Hangul Jamo Extended-B"](f)||Ut["Hangul Jamo"](f)||Ut["Hangul Syllables"](f)||Ut.Hiragana(f)||Ut["Ideographic Description Characters"](f)||Ut.Kanbun(f)||Ut["Kangxi Radicals"](f)||Ut["Katakana Phonetic Extensions"](f)||Ut.Katakana(f)&&f!==12540||!(!Ut["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Ut["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Ut["Unified Canadian Aboriginal Syllabics"](f)||Ut["Unified Canadian Aboriginal Syllabics Extended"](f)||Ut["Vertical Forms"](f)||Ut["Yijing Hexagram Symbols"](f)||Ut["Yi Syllables"](f)||Ut["Yi Radicals"](f))))}function Rs(f){return!(Ga(f)||function(u){return!!(Ut["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||Ut["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||Ut["Letterlike Symbols"](u)||Ut["Number Forms"](u)||Ut["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||Ut["Control Pictures"](u)&&u!==9251||Ut["Optical Character Recognition"](u)||Ut["Enclosed Alphanumerics"](u)||Ut["Geometric Shapes"](u)||Ut["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||Ut["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||Ut["CJK Symbols and Punctuation"](u)||Ut.Katakana(u)||Ut["Private Use Area"](u)||Ut["CJK Compatibility Forms"](u)||Ut["Small Form Variants"](u)||Ut["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(f))}function KA(f){return f>=1424&&f<=2303||Ut["Arabic Presentation Forms-A"](f)||Ut["Arabic Presentation Forms-B"](f)}function th(f,u){return!(!u&&KA(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Ut.Khmer(f))}function nc(f){for(const u of f)if(KA(u.charCodeAt(0)))return!0;return!1}const JA="deferred",eu="loading",tu="loaded";let Bs=null,Mi="unavailable",fo=null;const nu=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(Mi="error"),Bs&&Bs(f)};function ca(){Dr.fire(new bi("pluginStateChange",{pluginStatus:Mi,pluginURL:fo}))}const Dr=new Ki,Tl=function(){return Mi},rc=function(){if(Mi!==JA||!fo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Mi=eu,ca(),fo&&tr({url:fo},f=>{f?nu(f):(Mi=tu,ca())})},ss={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Mi===tu||ss.applyArabicShaping!=null,isLoading:()=>Mi===eu,setState(f){if(!Qe())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Mi=f.pluginStatus,fo=f.pluginURL},isParsed(){if(!Qe())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ss.applyArabicShaping!=null&&ss.processBidirectionalText!=null&&ss.processStyledBidirectionalText!=null},getPluginURL(){if(!Qe())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return fo}};class wr{constructor(u,p){this.zoom=u,p?(this.now=p.now,this.fadeDuration=p.fadeDuration,this.zoomHistory=p.zoomHistory,this.transition=p.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new XA,this.transition={})}isSupportedScript(u){return function(p,T){for(const D of p)if(!th(D.charCodeAt(0),T))return!1;return!0}(u,ss.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const u=this.zoom,p=u-Math.floor(u),T=this.crossFadingFactor();return u>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:p+(1-p)*T}:{fromScale:.5,toScale:1,t:1-(1-T)*p}}}class ja{constructor(u,p){this.property=u,this.value=p,this.expression=function(T,D){if(yr(T))return new fr(T,D);if(ml(T)){const z=_l(T,D);if(z.result==="error")throw new Error(z.value.map(F=>`${F.key}: ${F.message}`).join(", "));return z.value}{let z=T;return D.type==="color"&&typeof T=="string"?z=o.parse(T):D.type!=="padding"||typeof T!="number"&&!Array.isArray(T)||(z=Pe.parse(T)),{kind:"constant",evaluate:()=>z}}}(p===void 0?u.specification.default:p,u.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(u,p,T){return this.property.possiblyEvaluate(this,u,p,T)}}class Sl{constructor(u){this.property=u,this.value=new ja(u,void 0)}transitioned(u,p){return new ic(this.property,this.value,p,W({},u.transition,this.transition),u.now)}untransitioned(){return new ic(this.property,this.value,null,{},0)}}class ru{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitionablePropertyValues)}getValue(u){return ie(this._values[u].value.value)}setValue(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Sl(this._values[u].property)),this._values[u].value=new ja(this._values[u].property,p===null?void 0:ie(p))}getTransition(u){return ie(this._values[u].transition)}setTransition(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Sl(this._values[u].property)),this._values[u].transition=ie(p)||void 0}serialize(){const u={};for(const p of Object.keys(this._values)){const T=this.getValue(p);T!==void 0&&(u[p]=T);const D=this.getTransition(p);D!==void 0&&(u[`${p}-transition`]=D)}return u}transitioned(u,p){const T=new iu(this._properties);for(const D of Object.keys(this._values))T._values[D]=this._values[D].transitioned(u,p._values[D]);return T}untransitioned(){const u=new iu(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].untransitioned();return u}}class ic{constructor(u,p,T,D,z){this.property=u,this.value=p,this.begin=z+D.delay||0,this.end=this.begin+D.duration||0,u.specification.transition&&(D.delay||D.duration)&&(this.prior=T)}possiblyEvaluate(u,p,T){const D=u.now||0,z=this.value.possiblyEvaluate(u,p,T),F=this.prior;if(F){if(D>this.end)return this.prior=null,z;if(this.value.isDataDriven())return this.prior=null,z;if(D<this.begin)return F.possiblyEvaluate(u,p,T);{const j=(D-this.begin)/(this.end-this.begin);return this.property.interpolate(F.possiblyEvaluate(u,p,T),z,function(Z){if(Z<=0)return 0;if(Z>=1)return 1;const re=Z*Z,Ae=re*Z;return 4*(Z<.5?Ae:3*(Z-re)+Ae-.75)}(j))}}return z}}class iu{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitioningPropertyValues)}possiblyEvaluate(u,p,T){const D=new Ml(this._properties);for(const z of Object.keys(this._values))D._values[z]=this._values[z].possiblyEvaluate(u,p,T);return D}hasTransition(){for(const u of Object.keys(this._values))if(this._values[u].prior)return!0;return!1}}class sc{constructor(u){this._properties=u,this._values=Object.create(u.defaultPropertyValues)}getValue(u){return ie(this._values[u].value)}setValue(u,p){this._values[u]=new ja(this._values[u].property,p===null?void 0:ie(p))}serialize(){const u={};for(const p of Object.keys(this._values)){const T=this.getValue(p);T!==void 0&&(u[p]=T)}return u}possiblyEvaluate(u,p,T){const D=new Ml(this._properties);for(const z of Object.keys(this._values))D._values[z]=this._values[z].possiblyEvaluate(u,p,T);return D}}class dr{constructor(u,p,T){this.property=u,this.value=p,this.parameters=T}isConstant(){return this.value.kind==="constant"}constantOr(u){return this.value.kind==="constant"?this.value.value:u}evaluate(u,p,T,D){return this.property.evaluate(this.value,this.parameters,u,p,T,D)}}class Ml{constructor(u){this._properties=u,this._values=Object.create(u.defaultPossiblyEvaluatedValues)}get(u){return this._values[u]}}class Zt{constructor(u){this.specification=u}possiblyEvaluate(u,p){if(u.isDataDriven())throw new Error("Value should not be data driven");return u.expression.evaluate(p)}interpolate(u,p,T){const D=Cr[this.specification.type];return D?D(u,p,T):u}}class Yt{constructor(u,p){this.specification=u,this.overrides=p}possiblyEvaluate(u,p,T,D){return new dr(this,u.expression.kind==="constant"||u.expression.kind==="camera"?{kind:"constant",value:u.expression.evaluate(p,null,{},T,D)}:u.expression,p)}interpolate(u,p,T){if(u.value.kind!=="constant"||p.value.kind!=="constant")return u;if(u.value.value===void 0||p.value.value===void 0)return new dr(this,{kind:"constant",value:void 0},u.parameters);const D=Cr[this.specification.type];return D?new dr(this,{kind:"constant",value:D(u.value.value,p.value.value,T)},u.parameters):u}evaluate(u,p,T,D,z,F){return u.kind==="constant"?u.value:u.evaluate(p,T,D,z,F)}}class cn extends Yt{possiblyEvaluate(u,p,T,D){if(u.value===void 0)return new dr(this,{kind:"constant",value:void 0},p);if(u.expression.kind==="constant"){const z=u.expression.evaluate(p,null,{},T,D),F=u.property.specification.type==="resolvedImage"&&typeof z!="string"?z.name:z,j=this._calculate(F,F,F,p);return new dr(this,{kind:"constant",value:j},p)}if(u.expression.kind==="camera"){const z=this._calculate(u.expression.evaluate({zoom:p.zoom-1}),u.expression.evaluate({zoom:p.zoom}),u.expression.evaluate({zoom:p.zoom+1}),p);return new dr(this,{kind:"constant",value:z},p)}return new dr(this,u.expression,p)}evaluate(u,p,T,D,z,F){if(u.kind==="source"){const j=u.evaluate(p,T,D,z,F);return this._calculate(j,j,j,p)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(p.zoom)-1},T,D),u.evaluate({zoom:Math.floor(p.zoom)},T,D),u.evaluate({zoom:Math.floor(p.zoom)+1},T,D),p):u.value}_calculate(u,p,T,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:T,to:p}}interpolate(u){return u}}class $i{constructor(u){this.specification=u}possiblyEvaluate(u,p,T,D){if(u.value!==void 0){if(u.expression.kind==="constant"){const z=u.expression.evaluate(p,null,{},T,D);return this._calculate(z,z,z,p)}return this._calculate(u.expression.evaluate(new wr(Math.floor(p.zoom-1),p)),u.expression.evaluate(new wr(Math.floor(p.zoom),p)),u.expression.evaluate(new wr(Math.floor(p.zoom+1),p)),p)}}_calculate(u,p,T,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:T,to:p}}interpolate(u){return u}}class Uo{constructor(u){this.specification=u}possiblyEvaluate(u,p,T,D){return!!u.expression.evaluate(p,null,{},T,D)}interpolate(){return!1}}class Or{constructor(u){this.properties=u,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const p in u){const T=u[p];T.specification.overridable&&this.overridableProperties.push(p);const D=this.defaultPropertyValues[p]=new ja(T,void 0),z=this.defaultTransitionablePropertyValues[p]=new Sl(T);this.defaultTransitioningPropertyValues[p]=z.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=D.possiblyEvaluate({})}}}Ft("DataDrivenProperty",Yt),Ft("DataConstantProperty",Zt),Ft("CrossFadedDataDrivenProperty",cn),Ft("CrossFadedProperty",$i),Ft("ColorRampProperty",Uo);const zs="-transition";class ms extends Ki{constructor(u,p){if(super(),this.id=u.id,this.type=u.type,this._featureFilter={filter:()=>!0,needGeometry:!1},u.type!=="custom"&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),p.layout&&(this._unevaluatedLayout=new sc(p.layout)),p.paint)){this._transitionablePaint=new ru(p.paint);for(const T in u.paint)this.setPaintProperty(T,u.paint[T],{validate:!1});for(const T in u.layout)this.setLayoutProperty(T,u.layout[T],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ml(p.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)}setLayoutProperty(u,p,T={}){p!=null&&this._validate(eh,`layers.${this.id}.layout.${u}`,u,p,T)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,p):this.visibility=p)}getPaintProperty(u){return u.endsWith(zs)?this._transitionablePaint.getTransition(u.slice(0,-zs.length)):this._transitionablePaint.getValue(u)}setPaintProperty(u,p,T={}){if(p!=null&&this._validate(Jc,`layers.${this.id}.paint.${u}`,u,p,T))return!1;if(u.endsWith(zs))return this._transitionablePaint.setTransition(u.slice(0,-zs.length),p||void 0),!1;{const D=this._transitionablePaint._values[u],z=D.property.specification["property-type"]==="cross-faded-data-driven",F=D.value.isDataDriven(),j=D.value;this._transitionablePaint.setValue(u,p),this._handleSpecialPaintPropertyUpdate(u);const Z=this._transitionablePaint._values[u].value;return Z.isDataDriven()||F||z||this._handleOverridablePaintPropertyUpdate(u,j,Z)}}_handleSpecialPaintPropertyUpdate(u){}_handleOverridablePaintPropertyUpdate(u,p,T){return!1}isHidden(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"}updateTransitions(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(u,p){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,p)}serialize(){const u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),ne(u,(p,T)=>!(p===void 0||T==="layout"&&!Object.keys(p).length||T==="paint"&&!Object.keys(p).length))}_validate(u,p,T,D,z={}){return(!z||z.validate!==!1)&&Va(this,u.call(bl,{key:p,layerType:this.type,objectKey:T,value:D,styleSpec:ct,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const u in this.paint._values){const p=this.paint.get(u);if(p instanceof dr&&ur(p.property.specification)&&(p.value.kind==="source"||p.value.kind==="composite")&&p.value.isStateDependent)return!0}return!1}}const Os={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class St{constructor(u,p){this._structArray=u,this._pos1=p*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ct{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(u,p){return u._trim(),p&&(u.isTransferred=!0,p.push(u.arrayBuffer)),{length:u.length,arrayBuffer:u.arrayBuffer}}static deserialize(u){const p=Object.create(this.prototype);return p.arrayBuffer=u.arrayBuffer,p.length=u.length,p.capacity=u.arrayBuffer.byteLength/p.bytesPerElement,p._refreshViews(),p}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(u){this.reserve(u),this.length=u}reserve(u){if(u>this.capacity){this.capacity=Math.max(u,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const p=this.uint8;this._refreshViews(),p&&this.uint8.set(p)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Fr(f,u=1){let p=0,T=0;return{members:f.map(D=>{const z=Os[D.type].BYTES_PER_ELEMENT,F=p=$a(p,Math.max(u,z)),j=D.components||1;return T=Math.max(T,z),p+=z*j,{name:D.name,type:D.type,components:j,offset:F}}),size:$a(p,Math.max(T,u)),alignment:u}}function $a(f,u){return Math.ceil(f/u)*u}class Fs extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p){const T=this.length;return this.resize(T+1),this.emplace(T,u,p)}emplace(u,p,T){const D=2*u;return this.int16[D+0]=p,this.int16[D+1]=T,u}}Fs.prototype.bytesPerElement=4,Ft("StructArrayLayout2i4",Fs);class k extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,p,T,D)}emplace(u,p,T,D,z){const F=4*u;return this.int16[F+0]=p,this.int16[F+1]=T,this.int16[F+2]=D,this.int16[F+3]=z,u}}k.prototype.bytesPerElement=8,Ft("StructArrayLayout4i8",k);class c extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F){const j=this.length;return this.resize(j+1),this.emplace(j,u,p,T,D,z,F)}emplace(u,p,T,D,z,F,j){const Z=6*u;return this.int16[Z+0]=p,this.int16[Z+1]=T,this.int16[Z+2]=D,this.int16[Z+3]=z,this.int16[Z+4]=F,this.int16[Z+5]=j,u}}c.prototype.bytesPerElement=12,Ft("StructArrayLayout2i4i12",c);class _ extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F){const j=this.length;return this.resize(j+1),this.emplace(j,u,p,T,D,z,F)}emplace(u,p,T,D,z,F,j){const Z=4*u,re=8*u;return this.int16[Z+0]=p,this.int16[Z+1]=T,this.uint8[re+4]=D,this.uint8[re+5]=z,this.uint8[re+6]=F,this.uint8[re+7]=j,u}}_.prototype.bytesPerElement=8,Ft("StructArrayLayout2i4ub8",_);class l extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p){const T=this.length;return this.resize(T+1),this.emplace(T,u,p)}emplace(u,p,T){const D=2*u;return this.float32[D+0]=p,this.float32[D+1]=T,u}}l.prototype.bytesPerElement=8,Ft("StructArrayLayout2f8",l);class h extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F,j,Z,re,Ae){const ce=this.length;return this.resize(ce+1),this.emplace(ce,u,p,T,D,z,F,j,Z,re,Ae)}emplace(u,p,T,D,z,F,j,Z,re,Ae,ce){const pe=10*u;return this.uint16[pe+0]=p,this.uint16[pe+1]=T,this.uint16[pe+2]=D,this.uint16[pe+3]=z,this.uint16[pe+4]=F,this.uint16[pe+5]=j,this.uint16[pe+6]=Z,this.uint16[pe+7]=re,this.uint16[pe+8]=Ae,this.uint16[pe+9]=ce,u}}h.prototype.bytesPerElement=20,Ft("StructArrayLayout10ui20",h);class d extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F,j,Z,re,Ae,ce,pe){const me=this.length;return this.resize(me+1),this.emplace(me,u,p,T,D,z,F,j,Z,re,Ae,ce,pe)}emplace(u,p,T,D,z,F,j,Z,re,Ae,ce,pe,me){const _e=12*u;return this.int16[_e+0]=p,this.int16[_e+1]=T,this.int16[_e+2]=D,this.int16[_e+3]=z,this.uint16[_e+4]=F,this.uint16[_e+5]=j,this.uint16[_e+6]=Z,this.uint16[_e+7]=re,this.int16[_e+8]=Ae,this.int16[_e+9]=ce,this.int16[_e+10]=pe,this.int16[_e+11]=me,u}}d.prototype.bytesPerElement=24,Ft("StructArrayLayout4i4ui4i24",d);class x extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,p,T)}emplace(u,p,T,D){const z=3*u;return this.float32[z+0]=p,this.float32[z+1]=T,this.float32[z+2]=D,u}}x.prototype.bytesPerElement=12,Ft("StructArrayLayout3f12",x);class b extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint32[1*u+0]=p,u}}b.prototype.bytesPerElement=4,Ft("StructArrayLayout1ul4",b);class S extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F,j,Z,re){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,u,p,T,D,z,F,j,Z,re)}emplace(u,p,T,D,z,F,j,Z,re,Ae){const ce=10*u,pe=5*u;return this.int16[ce+0]=p,this.int16[ce+1]=T,this.int16[ce+2]=D,this.int16[ce+3]=z,this.int16[ce+4]=F,this.int16[ce+5]=j,this.uint32[pe+3]=Z,this.uint16[ce+8]=re,this.uint16[ce+9]=Ae,u}}S.prototype.bytesPerElement=20,Ft("StructArrayLayout6i1ul2ui20",S);class M extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F){const j=this.length;return this.resize(j+1),this.emplace(j,u,p,T,D,z,F)}emplace(u,p,T,D,z,F,j){const Z=6*u;return this.int16[Z+0]=p,this.int16[Z+1]=T,this.int16[Z+2]=D,this.int16[Z+3]=z,this.int16[Z+4]=F,this.int16[Z+5]=j,u}}M.prototype.bytesPerElement=12,Ft("StructArrayLayout2i2i2i12",M);class B extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z){const F=this.length;return this.resize(F+1),this.emplace(F,u,p,T,D,z)}emplace(u,p,T,D,z,F){const j=4*u,Z=8*u;return this.float32[j+0]=p,this.float32[j+1]=T,this.float32[j+2]=D,this.int16[Z+6]=z,this.int16[Z+7]=F,u}}B.prototype.bytesPerElement=16,Ft("StructArrayLayout2f1f2i16",B);class V extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,p,T,D)}emplace(u,p,T,D,z){const F=12*u,j=3*u;return this.uint8[F+0]=p,this.uint8[F+1]=T,this.float32[j+1]=D,this.float32[j+2]=z,u}}V.prototype.bytesPerElement=12,Ft("StructArrayLayout2ub2f12",V);class $ extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,p,T)}emplace(u,p,T,D){const z=3*u;return this.uint16[z+0]=p,this.uint16[z+1]=T,this.uint16[z+2]=D,u}}$.prototype.bytesPerElement=6,Ft("StructArrayLayout3ui6",$);class Y extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F,j,Z,re,Ae,ce,pe,me,_e,Ue,ze,et){const lt=this.length;return this.resize(lt+1),this.emplace(lt,u,p,T,D,z,F,j,Z,re,Ae,ce,pe,me,_e,Ue,ze,et)}emplace(u,p,T,D,z,F,j,Z,re,Ae,ce,pe,me,_e,Ue,ze,et,lt){const Ke=24*u,st=12*u,gt=48*u;return this.int16[Ke+0]=p,this.int16[Ke+1]=T,this.uint16[Ke+2]=D,this.uint16[Ke+3]=z,this.uint32[st+2]=F,this.uint32[st+3]=j,this.uint32[st+4]=Z,this.uint16[Ke+10]=re,this.uint16[Ke+11]=Ae,this.uint16[Ke+12]=ce,this.float32[st+7]=pe,this.float32[st+8]=me,this.uint8[gt+36]=_e,this.uint8[gt+37]=Ue,this.uint8[gt+38]=ze,this.uint32[st+10]=et,this.int16[Ke+22]=lt,u}}Y.prototype.bytesPerElement=48,Ft("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Y);class oe extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F,j,Z,re,Ae,ce,pe,me,_e,Ue,ze,et,lt,Ke,st,gt,pt,qt,en,$t,Nt,zt,Ht){const Gt=this.length;return this.resize(Gt+1),this.emplace(Gt,u,p,T,D,z,F,j,Z,re,Ae,ce,pe,me,_e,Ue,ze,et,lt,Ke,st,gt,pt,qt,en,$t,Nt,zt,Ht)}emplace(u,p,T,D,z,F,j,Z,re,Ae,ce,pe,me,_e,Ue,ze,et,lt,Ke,st,gt,pt,qt,en,$t,Nt,zt,Ht,Gt){const Tt=34*u,pn=17*u;return this.int16[Tt+0]=p,this.int16[Tt+1]=T,this.int16[Tt+2]=D,this.int16[Tt+3]=z,this.int16[Tt+4]=F,this.int16[Tt+5]=j,this.int16[Tt+6]=Z,this.int16[Tt+7]=re,this.uint16[Tt+8]=Ae,this.uint16[Tt+9]=ce,this.uint16[Tt+10]=pe,this.uint16[Tt+11]=me,this.uint16[Tt+12]=_e,this.uint16[Tt+13]=Ue,this.uint16[Tt+14]=ze,this.uint16[Tt+15]=et,this.uint16[Tt+16]=lt,this.uint16[Tt+17]=Ke,this.uint16[Tt+18]=st,this.uint16[Tt+19]=gt,this.uint16[Tt+20]=pt,this.uint16[Tt+21]=qt,this.uint16[Tt+22]=en,this.uint32[pn+12]=$t,this.float32[pn+13]=Nt,this.float32[pn+14]=zt,this.float32[pn+15]=Ht,this.float32[pn+16]=Gt,u}}oe.prototype.bytesPerElement=68,Ft("StructArrayLayout8i15ui1ul4f68",oe);class te extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.float32[1*u+0]=p,u}}te.prototype.bytesPerElement=4,Ft("StructArrayLayout1f4",te);class ue extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,p,T)}emplace(u,p,T,D){const z=3*u;return this.int16[z+0]=p,this.int16[z+1]=T,this.int16[z+2]=D,u}}ue.prototype.bytesPerElement=6,Ft("StructArrayLayout3i6",ue);class be extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,p,T)}emplace(u,p,T,D){const z=4*u;return this.uint32[2*u+0]=p,this.uint16[z+2]=T,this.uint16[z+3]=D,u}}be.prototype.bytesPerElement=8,Ft("StructArrayLayout1ul2ui8",be);class Ce extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p){const T=this.length;return this.resize(T+1),this.emplace(T,u,p)}emplace(u,p,T){const D=2*u;return this.uint16[D+0]=p,this.uint16[D+1]=T,u}}Ce.prototype.bytesPerElement=4,Ft("StructArrayLayout2ui4",Ce);class ve extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint16[1*u+0]=p,u}}ve.prototype.bytesPerElement=2,Ft("StructArrayLayout1ui2",ve);class Ge extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,p,T,D)}emplace(u,p,T,D,z){const F=4*u;return this.float32[F+0]=p,this.float32[F+1]=T,this.float32[F+2]=D,this.float32[F+3]=z,u}}Ge.prototype.bytesPerElement=16,Ft("StructArrayLayout4f16",Ge);class Te extends St{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Et(this.anchorPointX,this.anchorPointY)}}Te.prototype.size=20;class Ve extends S{get(u){return new Te(this,u)}}Ft("CollisionBoxArray",Ve);class xe extends St{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(u){this._structArray.uint8[this._pos1+37]=u}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(u){this._structArray.uint8[this._pos1+38]=u}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(u){this._structArray.uint32[this._pos4+10]=u}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}xe.prototype.size=48;class m extends Y{get(u){return new xe(this,u)}}Ft("PlacedSymbolArray",m);class g extends St{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(u){this._structArray.uint32[this._pos4+12]=u}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}g.prototype.size=68;class v extends oe{get(u){return new g(this,u)}}Ft("SymbolInstanceArray",v);class E extends te{getoffsetX(u){return this.float32[1*u+0]}}Ft("GlyphOffsetArray",E);class C extends ue{getx(u){return this.int16[3*u+0]}gety(u){return this.int16[3*u+1]}gettileUnitDistanceFromAnchor(u){return this.int16[3*u+2]}}Ft("SymbolLineVertexArray",C);class R extends St{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}R.prototype.size=8;class O extends be{get(u){return new R(this,u)}}Ft("FeatureIndexArray",O);class N extends Fs{}class Q extends Fs{}class J extends Fs{}class le extends c{}class de extends _{}class Re extends l{}class je extends h{}class Be extends d{}class Ye extends x{}class ht extends b{}class ut extends M{}class rt extends V{}class it extends ${}class Xe extends Ce{}const Vt=Fr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Bt}=Vt;class dt{constructor(u=[]){this.segments=u}prepareSegment(u,p,T,D){let z=this.segments[this.segments.length-1];return u>dt.MAX_VERTEX_ARRAY_LENGTH&&ye(`Max vertices per segment is ${dt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${u}`),(!z||z.vertexLength+u>dt.MAX_VERTEX_ARRAY_LENGTH||z.sortKey!==D)&&(z={vertexOffset:p.length,primitiveOffset:T.length,vertexLength:0,primitiveLength:0},D!==void 0&&(z.sortKey=D),this.segments.push(z)),z}get(){return this.segments}destroy(){for(const u of this.segments)for(const p in u.vaos)u.vaos[p].destroy()}static simpleSegment(u,p,T,D){return new dt([{vertexOffset:u,primitiveOffset:p,vertexLength:T,primitiveLength:D,vaos:{},sortKey:0}])}}function _t(f,u){return 256*(f=L(Math.floor(f),0,255))+L(Math.floor(u),0,255)}dt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ft("SegmentVector",dt);const Cn=Fr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var xn={exports:{}},gn={exports:{}};gn.exports=function(f,u){var p,T,D,z,F,j,Z,re;for(T=f.length-(p=3&f.length),D=u,F=3432918353,j=461845907,re=0;re<T;)Z=255&f.charCodeAt(re)|(255&f.charCodeAt(++re))<<8|(255&f.charCodeAt(++re))<<16|(255&f.charCodeAt(++re))<<24,++re,D=27492+(65535&(z=5*(65535&(D=(D^=Z=(65535&(Z=(Z=(65535&Z)*F+(((Z>>>16)*F&65535)<<16)&4294967295)<<15|Z>>>17))*j+(((Z>>>16)*j&65535)<<16)&4294967295)<<13|D>>>19))+((5*(D>>>16)&65535)<<16)&4294967295))+((58964+(z>>>16)&65535)<<16);switch(Z=0,p){case 3:Z^=(255&f.charCodeAt(re+2))<<16;case 2:Z^=(255&f.charCodeAt(re+1))<<8;case 1:D^=Z=(65535&(Z=(Z=(65535&(Z^=255&f.charCodeAt(re)))*F+(((Z>>>16)*F&65535)<<16)&4294967295)<<15|Z>>>17))*j+(((Z>>>16)*j&65535)<<16)&4294967295}return D^=f.length,D=2246822507*(65535&(D^=D>>>16))+((2246822507*(D>>>16)&65535)<<16)&4294967295,D=3266489909*(65535&(D^=D>>>13))+((3266489909*(D>>>16)&65535)<<16)&4294967295,(D^=D>>>16)>>>0};var yn={exports:{}};yn.exports=function(f,u){for(var p,T=f.length,D=u^T,z=0;T>=4;)p=1540483477*(65535&(p=255&f.charCodeAt(z)|(255&f.charCodeAt(++z))<<8|(255&f.charCodeAt(++z))<<16|(255&f.charCodeAt(++z))<<24))+((1540483477*(p>>>16)&65535)<<16),D=1540483477*(65535&D)+((1540483477*(D>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),T-=4,++z;switch(T){case 3:D^=(255&f.charCodeAt(z+2))<<16;case 2:D^=(255&f.charCodeAt(z+1))<<8;case 1:D=1540483477*(65535&(D^=255&f.charCodeAt(z)))+((1540483477*(D>>>16)&65535)<<16)}return D=1540483477*(65535&(D^=D>>>13))+((1540483477*(D>>>16)&65535)<<16),(D^=D>>>15)>>>0};var bn=gn.exports,Ln=yn.exports;xn.exports=bn,xn.exports.murmur3=bn,xn.exports.murmur2=Ln;class sr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(u,p,T,D){this.ids.push(Pn(u)),this.positions.push(p,T,D)}getPositions(u){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const p=Pn(u);let T=0,D=this.ids.length-1;for(;T<D;){const F=T+D>>1;this.ids[F]>=p?D=F:T=F+1}const z=[];for(;this.ids[T]===p;)z.push({index:this.positions[3*T],start:this.positions[3*T+1],end:this.positions[3*T+2]}),T++;return z}static serialize(u,p){const T=new Float64Array(u.ids),D=new Uint32Array(u.positions);return _r(T,D,0,T.length-1),p&&p.push(T.buffer,D.buffer),{ids:T,positions:D}}static deserialize(u){const p=new sr;return p.ids=u.ids,p.positions=u.positions,p.indexed=!0,p}}function Pn(f){const u=+f;return!isNaN(u)&&u<=Number.MAX_SAFE_INTEGER?u:xn.exports(String(f))}function _r(f,u,p,T){for(;p<T;){const D=f[p+T>>1];let z=p-1,F=T+1;for(;;){do z++;while(f[z]<D);do F--;while(f[F]>D);if(z>=F)break;$r(f,z,F),$r(u,3*z,3*F),$r(u,3*z+1,3*F+1),$r(u,3*z+2,3*F+2)}F-p<T-F?(_r(f,u,p,F),p=F+1):(_r(f,u,F+1,T),T=F)}}function $r(f,u,p){const T=f[u];f[u]=f[p],f[p]=T}Ft("FeaturePositionMap",sr);class Ha{constructor(u,p){this.gl=u.gl,this.location=p}}class su extends Ha{constructor(u,p){super(u,p),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class uf extends Ha{constructor(u,p){super(u,p),this.current=[0,0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))}}class TS extends Ha{constructor(u,p){super(u,p),this.current=o.transparent}set(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))}}const SF=new Float32Array(16);function G2(f){return[_t(255*f.r,255*f.g),_t(255*f.b,255*f.a)]}class ld{constructor(u,p,T){this.value=u,this.uniformNames=p.map(D=>`u_${D}`),this.type=T}setUniform(u,p,T){u.set(T.constantOr(this.value))}getBinding(u,p,T){return this.type==="color"?new TS(u,p):new su(u,p)}}class cf{constructor(u,p){this.uniformNames=p.map(T=>`u_${T}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(u,p){this.pixelRatioFrom=p.pixelRatio,this.pixelRatioTo=u.pixelRatio,this.patternFrom=p.tlbr,this.patternTo=u.tlbr}setUniform(u,p,T,D){const z=D==="u_pattern_to"?this.patternTo:D==="u_pattern_from"?this.patternFrom:D==="u_pixel_ratio_to"?this.pixelRatioTo:D==="u_pixel_ratio_from"?this.pixelRatioFrom:null;z&&u.set(z)}getBinding(u,p,T){return T.substr(0,9)==="u_pattern"?new uf(u,p):new su(u,p)}}class ou{constructor(u,p,T,D){this.expression=u,this.type=T,this.maxValue=0,this.paintVertexAttributes=p.map(z=>({name:`a_${z}`,type:"Float32",components:T==="color"?2:1,offset:0})),this.paintVertexArray=new D}populatePaintArray(u,p,T,D,z){const F=this.paintVertexArray.length,j=this.expression.evaluate(new wr(0),p,{},D,[],z);this.paintVertexArray.resize(u),this._setPaintValue(F,u,j)}updatePaintArray(u,p,T,D){const z=this.expression.evaluate({zoom:0},T,D);this._setPaintValue(u,p,z)}_setPaintValue(u,p,T){if(this.type==="color"){const D=G2(T);for(let z=u;z<p;z++)this.paintVertexArray.emplace(z,D[0],D[1])}else{for(let D=u;D<p;D++)this.paintVertexArray.emplace(D,T);this.maxValue=Math.max(this.maxValue,Math.abs(T))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Cl{constructor(u,p,T,D,z,F){this.expression=u,this.uniformNames=p.map(j=>`u_${j}_t`),this.type=T,this.useIntegerZoom=D,this.zoom=z,this.maxValue=0,this.paintVertexAttributes=p.map(j=>({name:`a_${j}`,type:"Float32",components:T==="color"?4:2,offset:0})),this.paintVertexArray=new F}populatePaintArray(u,p,T,D,z){const F=this.expression.evaluate(new wr(this.zoom),p,{},D,[],z),j=this.expression.evaluate(new wr(this.zoom+1),p,{},D,[],z),Z=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValue(Z,u,F,j)}updatePaintArray(u,p,T,D){const z=this.expression.evaluate({zoom:this.zoom},T,D),F=this.expression.evaluate({zoom:this.zoom+1},T,D);this._setPaintValue(u,p,z,F)}_setPaintValue(u,p,T,D){if(this.type==="color"){const z=G2(T),F=G2(D);for(let j=u;j<p;j++)this.paintVertexArray.emplace(j,z[0],z[1],F[0],F[1])}else{for(let z=u;z<p;z++)this.paintVertexArray.emplace(z,T,D);this.maxValue=Math.max(this.maxValue,Math.abs(T),Math.abs(D))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(u,p){const T=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,D=L(this.expression.interpolationFactor(T,this.zoom,this.zoom+1),0,1);u.set(D)}getBinding(u,p,T){return new su(u,p)}}class oc{constructor(u,p,T,D,z,F){this.expression=u,this.type=p,this.useIntegerZoom=T,this.zoom=D,this.layerId=F,this.zoomInPaintVertexArray=new z,this.zoomOutPaintVertexArray=new z}populatePaintArray(u,p,T){const D=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(u),this.zoomOutPaintVertexArray.resize(u),this._setPaintValues(D,u,p.patterns&&p.patterns[this.layerId],T)}updatePaintArray(u,p,T,D,z){this._setPaintValues(u,p,T.patterns&&T.patterns[this.layerId],z)}_setPaintValues(u,p,T,D){if(!D||!T)return;const{min:z,mid:F,max:j}=T,Z=D[z],re=D[F],Ae=D[j];if(Z&&re&&Ae)for(let ce=u;ce<p;ce++)this.zoomInPaintVertexArray.emplace(ce,re.tl[0],re.tl[1],re.br[0],re.br[1],Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],re.pixelRatio,Z.pixelRatio),this.zoomOutPaintVertexArray.emplace(ce,re.tl[0],re.tl[1],re.br[0],re.br[1],Ae.tl[0],Ae.tl[1],Ae.br[0],Ae.br[1],re.pixelRatio,Ae.pixelRatio)}upload(u){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=u.createVertexBuffer(this.zoomInPaintVertexArray,Cn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=u.createVertexBuffer(this.zoomOutPaintVertexArray,Cn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class SS{constructor(u,p,T){this.binders={},this._buffers=[];const D=[];for(const z in u.paint._values){if(!T(z))continue;const F=u.paint.get(z);if(!(F instanceof dr&&ur(F.property.specification)))continue;const j=MF(z,u.type),Z=F.value,re=F.property.specification.type,Ae=F.property.useIntegerZoom,ce=F.property.specification["property-type"],pe=ce==="cross-faded"||ce==="cross-faded-data-driven";if(Z.kind==="constant")this.binders[z]=pe?new cf(Z.value,j):new ld(Z.value,j,re),D.push(`/u_${z}`);else if(Z.kind==="source"||pe){const me=MS(z,re,"source");this.binders[z]=pe?new oc(Z,re,Ae,p,me,u.id):new ou(Z,j,re,me),D.push(`/a_${z}`)}else{const me=MS(z,re,"composite");this.binders[z]=new Cl(Z,j,re,Ae,p,me),D.push(`/z_${z}`)}}this.cacheKey=D.sort().join("")}getMaxValue(u){const p=this.binders[u];return p instanceof ou||p instanceof Cl?p.maxValue:0}populatePaintArrays(u,p,T,D,z){for(const F in this.binders){const j=this.binders[F];(j instanceof ou||j instanceof Cl||j instanceof oc)&&j.populatePaintArray(u,p,T,D,z)}}setConstantPatternPositions(u,p){for(const T in this.binders){const D=this.binders[T];D instanceof cf&&D.setConstantPatternPositions(u,p)}}updatePaintArrays(u,p,T,D,z){let F=!1;for(const j in u){const Z=p.getPositions(j);for(const re of Z){const Ae=T.feature(re.index);for(const ce in this.binders){const pe=this.binders[ce];if((pe instanceof ou||pe instanceof Cl||pe instanceof oc)&&pe.expression.isStateDependent===!0){const me=D.paint.get(ce);pe.expression=me.value,pe.updatePaintArray(re.start,re.end,Ae,u[j],z),F=!0}}}}return F}defines(){const u=[];for(const p in this.binders){const T=this.binders[p];(T instanceof ld||T instanceof cf)&&u.push(...T.uniformNames.map(D=>`#define HAS_UNIFORM_${D}`))}return u}getBinderAttributes(){const u=[];for(const p in this.binders){const T=this.binders[p];if(T instanceof ou||T instanceof Cl)for(let D=0;D<T.paintVertexAttributes.length;D++)u.push(T.paintVertexAttributes[D].name);else if(T instanceof oc)for(let D=0;D<Cn.members.length;D++)u.push(Cn.members[D].name)}return u}getBinderUniforms(){const u=[];for(const p in this.binders){const T=this.binders[p];if(T instanceof ld||T instanceof cf||T instanceof Cl)for(const D of T.uniformNames)u.push(D)}return u}getPaintVertexBuffers(){return this._buffers}getUniforms(u,p){const T=[];for(const D in this.binders){const z=this.binders[D];if(z instanceof ld||z instanceof cf||z instanceof Cl){for(const F of z.uniformNames)if(p[F]){const j=z.getBinding(u,p[F],F);T.push({name:F,property:D,binding:j})}}}return T}setUniforms(u,p,T,D){for(const{name:z,property:F,binding:j}of p)this.binders[F].setUniform(j,D,T.get(F),z)}updatePaintBuffers(u){this._buffers=[];for(const p in this.binders){const T=this.binders[p];if(u&&T instanceof oc){const D=u.fromScale===2?T.zoomInPaintVertexBuffer:T.zoomOutPaintVertexBuffer;D&&this._buffers.push(D)}else(T instanceof ou||T instanceof Cl)&&T.paintVertexBuffer&&this._buffers.push(T.paintVertexBuffer)}}upload(u){for(const p in this.binders){const T=this.binders[p];(T instanceof ou||T instanceof Cl||T instanceof oc)&&T.upload(u)}this.updatePaintBuffers()}destroy(){for(const u in this.binders){const p=this.binders[u];(p instanceof ou||p instanceof Cl||p instanceof oc)&&p.destroy()}}}class nh{constructor(u,p,T=()=>!0){this.programConfigurations={};for(const D of u)this.programConfigurations[D.id]=new SS(D,p,T);this.needsUpload=!1,this._featureMap=new sr,this._bufferOffset=0}populatePaintArrays(u,p,T,D,z,F){for(const j in this.programConfigurations)this.programConfigurations[j].populatePaintArrays(u,p,D,z,F);p.id!==void 0&&this._featureMap.add(p.id,T,this._bufferOffset,u),this._bufferOffset=u,this.needsUpload=!0}updatePaintArrays(u,p,T,D){for(const z of T)this.needsUpload=this.programConfigurations[z.id].updatePaintArrays(u,this._featureMap,p,z,D)||this.needsUpload}get(u){return this.programConfigurations[u]}upload(u){if(this.needsUpload){for(const p in this.programConfigurations)this.programConfigurations[p].upload(u);this.needsUpload=!1}}destroy(){for(const u in this.programConfigurations)this.programConfigurations[u].destroy()}}function MF(f,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(`${u}-`,"").replace(/-/g,"_")]}function MS(f,u,p){const T={color:{source:l,composite:Ge},number:{source:te,composite:l}},D=function(z){return{"line-pattern":{source:je,composite:je},"fill-pattern":{source:je,composite:je},"fill-extrusion-pattern":{source:je,composite:je}}[z]}(f);return D&&D[p]||T[u][p]}Ft("ConstantBinder",ld),Ft("CrossFadedConstantBinder",cf),Ft("SourceExpressionBinder",ou),Ft("CrossFadedCompositeBinder",oc),Ft("CompositeExpressionBinder",Cl),Ft("ProgramConfiguration",SS,{omit:["_buffers"]}),Ft("ProgramConfigurationSet",nh);var Ci=8192;const j2=Math.pow(2,14)-1,CS=-j2-1;function rh(f){const u=Ci/f.extent,p=f.loadGeometry();for(let T=0;T<p.length;T++){const D=p[T];for(let z=0;z<D.length;z++){const F=D[z],j=Math.round(F.x*u),Z=Math.round(F.y*u);F.x=L(j,CS,j2),F.y=L(Z,CS,j2),(j<F.x||j>F.x+1||Z<F.y||Z>F.y+1)&&ye("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return p}function ih(f,u){return{type:f.type,id:f.id,properties:f.properties,geometry:u?rh(f):[]}}function Jg(f,u,p,T,D){f.emplaceBack(2*u+(T+1)/2,2*p+(D+1)/2)}class $2{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new Q,this.indexArray=new it,this.segments=new dt,this.programConfigurations=new nh(u.layers,u.zoom),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,T){const D=this.layers[0],z=[];let F=null,j=!1;D.type==="circle"&&(F=D.layout.get("circle-sort-key"),j=!F.isConstant());for(const{feature:Z,id:re,index:Ae,sourceLayerIndex:ce}of u){const pe=this.layers[0]._featureFilter.needGeometry,me=ih(Z,pe);if(!this.layers[0]._featureFilter.filter(new wr(this.zoom),me,T))continue;const _e=j?F.evaluate(me,{},T):void 0,Ue={id:re,properties:Z.properties,type:Z.type,sourceLayerIndex:ce,index:Ae,geometry:pe?me.geometry:rh(Z),patterns:{},sortKey:_e};z.push(Ue)}j&&z.sort((Z,re)=>Z.sortKey-re.sortKey);for(const Z of z){const{geometry:re,index:Ae,sourceLayerIndex:ce}=Z,pe=u[Ae].feature;this.addFeature(Z,re,Ae,T),p.featureIndex.insert(pe,re,Ae,ce,this.index)}}update(u,p,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,Bt),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(u,p,T,D){for(const z of p)for(const F of z){const j=F.x,Z=F.y;if(j<0||j>=Ci||Z<0||Z>=Ci)continue;const re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,u.sortKey),Ae=re.vertexLength;Jg(this.layoutVertexArray,j,Z,-1,-1),Jg(this.layoutVertexArray,j,Z,1,-1),Jg(this.layoutVertexArray,j,Z,1,1),Jg(this.layoutVertexArray,j,Z,-1,1),this.indexArray.emplaceBack(Ae,Ae+1,Ae+2),this.indexArray.emplaceBack(Ae,Ae+3,Ae+2),re.vertexLength+=4,re.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,{},D)}}function PS(f,u){for(let p=0;p<f.length;p++)if(hf(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(hf(f,u[p]))return!0;return!!H2(f,u)}function CF(f,u,p){return!!hf(f,u)||!!W2(u,f,p)}function IS(f,u){if(f.length===1)return LS(u,f[0]);for(let p=0;p<u.length;p++){const T=u[p];for(let D=0;D<T.length;D++)if(hf(f,T[D]))return!0}for(let p=0;p<f.length;p++)if(LS(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(H2(f,u[p]))return!0;return!1}function PF(f,u,p){if(f.length>1){if(H2(f,u))return!0;for(let T=0;T<u.length;T++)if(W2(u[T],f,p))return!0}for(let T=0;T<f.length;T++)if(W2(f[T],u,p))return!0;return!1}function H2(f,u){if(f.length===0||u.length===0)return!1;for(let p=0;p<f.length-1;p++){const T=f[p],D=f[p+1];for(let z=0;z<u.length-1;z++)if(IF(T,D,u[z],u[z+1]))return!0}return!1}function IF(f,u,p,T){return Me(f,p,T)!==Me(u,p,T)&&Me(f,u,p)!==Me(f,u,T)}function W2(f,u,p){const T=p*p;if(u.length===1)return f.distSqr(u[0])<T;for(let D=1;D<u.length;D++)if(kS(f,u[D-1],u[D])<T)return!0;return!1}function kS(f,u,p){const T=u.distSqr(p);if(T===0)return f.distSqr(u);const D=((f.x-u.x)*(p.x-u.x)+(f.y-u.y)*(p.y-u.y))/T;return f.distSqr(D<0?u:D>1?p:p.sub(u)._mult(D)._add(u))}function LS(f,u){let p,T,D,z=!1;for(let F=0;F<f.length;F++){p=f[F];for(let j=0,Z=p.length-1;j<p.length;Z=j++)T=p[j],D=p[Z],T.y>u.y!=D.y>u.y&&u.x<(D.x-T.x)*(u.y-T.y)/(D.y-T.y)+T.x&&(z=!z)}return z}function hf(f,u){let p=!1;for(let T=0,D=f.length-1;T<f.length;D=T++){const z=f[T],F=f[D];z.y>u.y!=F.y>u.y&&u.x<(F.x-z.x)*(u.y-z.y)/(F.y-z.y)+z.x&&(p=!p)}return p}function kF(f,u,p){const T=p[0],D=p[2];if(f.x<T.x&&u.x<T.x||f.x>D.x&&u.x>D.x||f.y<T.y&&u.y<T.y||f.y>D.y&&u.y>D.y)return!1;const z=Me(f,u,p[0]);return z!==Me(f,u,p[1])||z!==Me(f,u,p[2])||z!==Me(f,u,p[3])}function Ad(f,u,p){const T=u.paint.get(f).value;return T.kind==="constant"?T.value:p.programConfigurations.get(u.id).getMaxValue(f)}function em(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function tm(f,u,p,T,D){if(!u[0]&&!u[1])return f;const z=Et.convert(u)._mult(D);p==="viewport"&&z._rotate(-T);const F=[];for(let j=0;j<f.length;j++)F.push(f[j].sub(z));return F}Ft("CircleBucket",$2,{omit:["layers"]});const LF=new Or({"circle-sort-key":new Yt(ct.layout_circle["circle-sort-key"])});var DF={paint:new Or({"circle-radius":new Yt(ct.paint_circle["circle-radius"]),"circle-color":new Yt(ct.paint_circle["circle-color"]),"circle-blur":new Yt(ct.paint_circle["circle-blur"]),"circle-opacity":new Yt(ct.paint_circle["circle-opacity"]),"circle-translate":new Zt(ct.paint_circle["circle-translate"]),"circle-translate-anchor":new Zt(ct.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Zt(ct.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Zt(ct.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Yt(ct.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Yt(ct.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Yt(ct.paint_circle["circle-stroke-opacity"])}),layout:LF},Ns=1e-6,Us=typeof Float32Array<"u"?Float32Array:Array;function DS(){var f=new Us(9);return Us!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[5]=0,f[6]=0,f[7]=0),f[0]=1,f[4]=1,f[8]=1,f}function Q2(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function RS(f,u,p){var T=u[0],D=u[1],z=u[2],F=u[3],j=u[4],Z=u[5],re=u[6],Ae=u[7],ce=u[8],pe=u[9],me=u[10],_e=u[11],Ue=u[12],ze=u[13],et=u[14],lt=u[15],Ke=p[0],st=p[1],gt=p[2],pt=p[3];return f[0]=Ke*T+st*j+gt*ce+pt*Ue,f[1]=Ke*D+st*Z+gt*pe+pt*ze,f[2]=Ke*z+st*re+gt*me+pt*et,f[3]=Ke*F+st*Ae+gt*_e+pt*lt,f[4]=(Ke=p[4])*T+(st=p[5])*j+(gt=p[6])*ce+(pt=p[7])*Ue,f[5]=Ke*D+st*Z+gt*pe+pt*ze,f[6]=Ke*z+st*re+gt*me+pt*et,f[7]=Ke*F+st*Ae+gt*_e+pt*lt,f[8]=(Ke=p[8])*T+(st=p[9])*j+(gt=p[10])*ce+(pt=p[11])*Ue,f[9]=Ke*D+st*Z+gt*pe+pt*ze,f[10]=Ke*z+st*re+gt*me+pt*et,f[11]=Ke*F+st*Ae+gt*_e+pt*lt,f[12]=(Ke=p[12])*T+(st=p[13])*j+(gt=p[14])*ce+(pt=p[15])*Ue,f[13]=Ke*D+st*Z+gt*pe+pt*ze,f[14]=Ke*z+st*re+gt*me+pt*et,f[15]=Ke*F+st*Ae+gt*_e+pt*lt,f}Math.hypot||(Math.hypot=function(){for(var f=0,u=arguments.length;u--;)f+=arguments[u]*arguments[u];return Math.sqrt(f)});var ud,RF=RS;function BS(){var f=new Us(3);return Us!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f}function zS(f,u,p){var T=new Us(3);return T[0]=f,T[1]=u,T[2]=p,T}function nm(f,u,p){var T=u[0],D=u[1],z=u[2],F=u[3];return f[0]=p[0]*T+p[4]*D+p[8]*z+p[12]*F,f[1]=p[1]*T+p[5]*D+p[9]*z+p[13]*F,f[2]=p[2]*T+p[6]*D+p[10]*z+p[14]*F,f[3]=p[3]*T+p[7]*D+p[11]*z+p[15]*F,f}function OS(){var f=new Us(4);return Us!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f[3]=1,f}function FS(f,u){const p=nm([],[f.x,f.y,0,1],u);return new Et(p[0]/p[3],p[1]/p[3])}BS(),ud=new Us(4),Us!=Float32Array&&(ud[0]=0,ud[1]=0,ud[2]=0,ud[3]=0),BS(),zS(1,0,0),zS(0,1,0),OS(),OS(),DS(),function(){var f;f=new Us(2),Us!=Float32Array&&(f[0]=0,f[1]=0)}();class NS extends $2{}Ft("HeatmapBucket",NS,{omit:["layers"]});var BF={paint:new Or({"heatmap-radius":new Yt(ct.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Yt(ct.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Zt(ct.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Uo(ct.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Zt(ct.paint_heatmap["heatmap-opacity"])})};function q2(f,{width:u,height:p},T,D){if(D){if(D instanceof Uint8ClampedArray)D=new Uint8Array(D.buffer);else if(D.length!==u*p*T)throw new RangeError(`mismatched image size. expected: ${D.length} but got: ${u*p*T}`)}else D=new Uint8Array(u*p*T);return f.width=u,f.height=p,f.data=D,f}function US(f,{width:u,height:p},T){if(u===f.width&&p===f.height)return;const D=q2({},{width:u,height:p},T);Z2(f,D,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,u),height:Math.min(f.height,p)},T),f.width=u,f.height=p,f.data=D.data}function Z2(f,u,p,T,D,z){if(D.width===0||D.height===0)return u;if(D.width>f.width||D.height>f.height||p.x>f.width-D.width||p.y>f.height-D.height)throw new RangeError("out of range source coordinates for image copy");if(D.width>u.width||D.height>u.height||T.x>u.width-D.width||T.y>u.height-D.height)throw new RangeError("out of range destination coordinates for image copy");const F=f.data,j=u.data;if(F===j)throw new Error("srcData equals dstData, so image is already copied");for(let Z=0;Z<D.height;Z++){const re=((p.y+Z)*f.width+p.x)*z,Ae=((T.y+Z)*u.width+T.x)*z;for(let ce=0;ce<D.width*z;ce++)j[Ae+ce]=F[re+ce]}return u}class cd{constructor(u,p){q2(this,u,1,p)}resize(u){US(this,u,1)}clone(){return new cd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,T,D,z){Z2(u,p,T,D,z,1)}}class ha{constructor(u,p){q2(this,u,4,p)}resize(u){US(this,u,4)}replace(u,p){p?this.data.set(u):this.data=u instanceof Uint8ClampedArray?new Uint8Array(u.buffer):u}clone(){return new ha({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,T,D,z){Z2(u,p,T,D,z,4)}}function VS(f){const u={},p=f.resolution||256,T=f.clips?f.clips.length:1,D=f.image||new ha({width:p,height:T});if(Math.log(p)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${p}`);const z=(F,j,Z)=>{u[f.evaluationKey]=Z;const re=f.expression.evaluate(u);D.data[F+j+0]=Math.floor(255*re.r/re.a),D.data[F+j+1]=Math.floor(255*re.g/re.a),D.data[F+j+2]=Math.floor(255*re.b/re.a),D.data[F+j+3]=Math.floor(255*re.a)};if(f.clips)for(let F=0,j=0;F<T;++F,j+=4*p)for(let Z=0,re=0;Z<p;Z++,re+=4){const Ae=Z/(p-1),{start:ce,end:pe}=f.clips[F];z(j,re,ce*(1-Ae)+pe*Ae)}else for(let F=0,j=0;F<p;F++,j+=4)z(0,j,F/(p-1));return D}Ft("AlphaImage",cd),Ft("RGBAImage",ha);var zF={paint:new Or({"hillshade-illumination-direction":new Zt(ct.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Zt(ct.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Zt(ct.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Zt(ct.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Zt(ct.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Zt(ct.paint_hillshade["hillshade-accent-color"])})};const OF=Fr([{name:"a_pos",components:2,type:"Int16"}],4),{members:FF}=OF;var rm={exports:{}};function im(f,u,p){p=p||2;var T,D,z,F,j,Z,re,Ae=u&&u.length,ce=Ae?u[0]*p:f.length,pe=GS(f,0,ce,p,!0),me=[];if(!pe||pe.next===pe.prev)return me;if(Ae&&(pe=function(Ue,ze,et,lt){var Ke,st,gt,pt=[];for(Ke=0,st=ze.length;Ke<st;Ke++)(gt=GS(Ue,ze[Ke]*lt,Ke<st-1?ze[Ke+1]*lt:Ue.length,lt,!1))===gt.next&&(gt.steiner=!0),pt.push(WF(gt));for(pt.sort(jF),Ke=0;Ke<pt.length;Ke++)et=$F(pt[Ke],et);return et}(f,u,pe,p)),f.length>80*p){T=z=f[0],D=F=f[1];for(var _e=p;_e<ce;_e+=p)(j=f[_e])<T&&(T=j),(Z=f[_e+1])<D&&(D=Z),j>z&&(z=j),Z>F&&(F=Z);re=(re=Math.max(z-T,F-D))!==0?32767/re:0}return hd(pe,me,p,T,D,re,0),me}function GS(f,u,p,T,D){var z,F;if(D===K2(f,u,p,T)>0)for(z=u;z<p;z+=T)F=HS(z,f[z],f[z+1],F);else for(z=p-T;z>=u;z-=T)F=HS(z,f[z],f[z+1],F);return F&&sm(F,F.next)&&(dd(F),F=F.next),F}function sh(f,u){if(!f)return f;u||(u=f);var p,T=f;do if(p=!1,T.steiner||!sm(T,T.next)&&ui(T.prev,T,T.next)!==0)T=T.next;else{if(dd(T),(T=u=T.prev)===T.next)break;p=!0}while(p||T!==u);return u}function hd(f,u,p,T,D,z,F){if(f){!F&&z&&function(Ae,ce,pe,me){var _e=Ae;do _e.z===0&&(_e.z=Y2(_e.x,_e.y,ce,pe,me)),_e.prevZ=_e.prev,_e.nextZ=_e.next,_e=_e.next;while(_e!==Ae);_e.prevZ.nextZ=null,_e.prevZ=null,function(Ue){var ze,et,lt,Ke,st,gt,pt,qt,en=1;do{for(et=Ue,Ue=null,st=null,gt=0;et;){for(gt++,lt=et,pt=0,ze=0;ze<en&&(pt++,lt=lt.nextZ);ze++);for(qt=en;pt>0||qt>0&&lt;)pt!==0&&(qt===0||!lt||et.z<=lt.z)?(Ke=et,et=et.nextZ,pt--):(Ke=lt,lt=lt.nextZ,qt--),st?st.nextZ=Ke:Ue=Ke,Ke.prevZ=st,st=Ke;et=lt}st.nextZ=null,en*=2}while(gt>1)}(_e)}(f,T,D,z);for(var j,Z,re=f;f.prev!==f.next;)if(j=f.prev,Z=f.next,z?UF(f,T,D,z):NF(f))u.push(j.i/p|0),u.push(f.i/p|0),u.push(Z.i/p|0),dd(f),f=Z.next,re=Z.next;else if((f=Z)===re){F?F===1?hd(f=VF(sh(f),u,p),u,p,T,D,z,2):F===2&&GF(f,u,p,T,D,z):hd(sh(f),u,p,T,D,z,1);break}}}function NF(f){var u=f.prev,p=f,T=f.next;if(ui(u,p,T)>=0)return!1;for(var D=u.x,z=p.x,F=T.x,j=u.y,Z=p.y,re=T.y,Ae=D<z?D<F?D:F:z<F?z:F,ce=j<Z?j<re?j:re:Z<re?Z:re,pe=D>z?D>F?D:F:z>F?z:F,me=j>Z?j>re?j:re:Z>re?Z:re,_e=T.next;_e!==u;){if(_e.x>=Ae&&_e.x<=pe&&_e.y>=ce&&_e.y<=me&&ff(D,j,z,Z,F,re,_e.x,_e.y)&&ui(_e.prev,_e,_e.next)>=0)return!1;_e=_e.next}return!0}function UF(f,u,p,T){var D=f.prev,z=f,F=f.next;if(ui(D,z,F)>=0)return!1;for(var j=D.x,Z=z.x,re=F.x,Ae=D.y,ce=z.y,pe=F.y,me=j<Z?j<re?j:re:Z<re?Z:re,_e=Ae<ce?Ae<pe?Ae:pe:ce<pe?ce:pe,Ue=j>Z?j>re?j:re:Z>re?Z:re,ze=Ae>ce?Ae>pe?Ae:pe:ce>pe?ce:pe,et=Y2(me,_e,u,p,T),lt=Y2(Ue,ze,u,p,T),Ke=f.prevZ,st=f.nextZ;Ke&&Ke.z>=et&&st&&st.z<=lt;){if(Ke.x>=me&&Ke.x<=Ue&&Ke.y>=_e&&Ke.y<=ze&&Ke!==D&&Ke!==F&&ff(j,Ae,Z,ce,re,pe,Ke.x,Ke.y)&&ui(Ke.prev,Ke,Ke.next)>=0||(Ke=Ke.prevZ,st.x>=me&&st.x<=Ue&&st.y>=_e&&st.y<=ze&&st!==D&&st!==F&&ff(j,Ae,Z,ce,re,pe,st.x,st.y)&&ui(st.prev,st,st.next)>=0))return!1;st=st.nextZ}for(;Ke&&Ke.z>=et;){if(Ke.x>=me&&Ke.x<=Ue&&Ke.y>=_e&&Ke.y<=ze&&Ke!==D&&Ke!==F&&ff(j,Ae,Z,ce,re,pe,Ke.x,Ke.y)&&ui(Ke.prev,Ke,Ke.next)>=0)return!1;Ke=Ke.prevZ}for(;st&&st.z<=lt;){if(st.x>=me&&st.x<=Ue&&st.y>=_e&&st.y<=ze&&st!==D&&st!==F&&ff(j,Ae,Z,ce,re,pe,st.x,st.y)&&ui(st.prev,st,st.next)>=0)return!1;st=st.nextZ}return!0}function VF(f,u,p){var T=f;do{var D=T.prev,z=T.next.next;!sm(D,z)&&jS(D,T,T.next,z)&&fd(D,z)&&fd(z,D)&&(u.push(D.i/p|0),u.push(T.i/p|0),u.push(z.i/p|0),dd(T),dd(T.next),T=f=z),T=T.next}while(T!==f);return sh(T)}function GF(f,u,p,T,D,z){var F=f;do{for(var j=F.next.next;j!==F.prev;){if(F.i!==j.i&&QF(F,j)){var Z=$S(F,j);return F=sh(F,F.next),Z=sh(Z,Z.next),hd(F,u,p,T,D,z,0),void hd(Z,u,p,T,D,z,0)}j=j.next}F=F.next}while(F!==f)}function jF(f,u){return f.x-u.x}function $F(f,u){var p=function(D,z){var F,j=z,Z=D.x,re=D.y,Ae=-1/0;do{if(re<=j.y&&re>=j.next.y&&j.next.y!==j.y){var ce=j.x+(re-j.y)*(j.next.x-j.x)/(j.next.y-j.y);if(ce<=Z&&ce>Ae&&(Ae=ce,F=j.x<j.next.x?j:j.next,ce===Z))return F}j=j.next}while(j!==z);if(!F)return null;var pe,me=F,_e=F.x,Ue=F.y,ze=1/0;j=F;do Z>=j.x&&j.x>=_e&&Z!==j.x&&ff(re<Ue?Z:Ae,re,_e,Ue,re<Ue?Ae:Z,re,j.x,j.y)&&(pe=Math.abs(re-j.y)/(Z-j.x),fd(j,D)&&(pe<ze||pe===ze&&(j.x>F.x||j.x===F.x&&HF(F,j)))&&(F=j,ze=pe)),j=j.next;while(j!==me);return F}(f,u);if(!p)return u;var T=$S(p,f);return sh(T,T.next),sh(p,p.next)}function HF(f,u){return ui(f.prev,f,u.prev)<0&&ui(u.next,f,f.next)<0}function Y2(f,u,p,T,D){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-p)*D|0)|f<<8))|f<<4))|f<<2))|f<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-T)*D|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function WF(f){var u=f,p=f;do(u.x<p.x||u.x===p.x&&u.y<p.y)&&(p=u),u=u.next;while(u!==f);return p}function ff(f,u,p,T,D,z,F,j){return(D-F)*(u-j)>=(f-F)*(z-j)&&(f-F)*(T-j)>=(p-F)*(u-j)&&(p-F)*(z-j)>=(D-F)*(T-j)}function QF(f,u){return f.next.i!==u.i&&f.prev.i!==u.i&&!function(p,T){var D=p;do{if(D.i!==p.i&&D.next.i!==p.i&&D.i!==T.i&&D.next.i!==T.i&&jS(D,D.next,p,T))return!0;D=D.next}while(D!==p);return!1}(f,u)&&(fd(f,u)&&fd(u,f)&&function(p,T){var D=p,z=!1,F=(p.x+T.x)/2,j=(p.y+T.y)/2;do D.y>j!=D.next.y>j&&D.next.y!==D.y&&F<(D.next.x-D.x)*(j-D.y)/(D.next.y-D.y)+D.x&&(z=!z),D=D.next;while(D!==p);return z}(f,u)&&(ui(f.prev,f,u.prev)||ui(f,u.prev,u))||sm(f,u)&&ui(f.prev,f,f.next)>0&&ui(u.prev,u,u.next)>0)}function ui(f,u,p){return(u.y-f.y)*(p.x-u.x)-(u.x-f.x)*(p.y-u.y)}function sm(f,u){return f.x===u.x&&f.y===u.y}function jS(f,u,p,T){var D=am(ui(f,u,p)),z=am(ui(f,u,T)),F=am(ui(p,T,f)),j=am(ui(p,T,u));return D!==z&&F!==j||!(D!==0||!om(f,p,u))||!(z!==0||!om(f,T,u))||!(F!==0||!om(p,f,T))||!(j!==0||!om(p,u,T))}function om(f,u,p){return u.x<=Math.max(f.x,p.x)&&u.x>=Math.min(f.x,p.x)&&u.y<=Math.max(f.y,p.y)&&u.y>=Math.min(f.y,p.y)}function am(f){return f>0?1:f<0?-1:0}function fd(f,u){return ui(f.prev,f,f.next)<0?ui(f,u,f.next)>=0&&ui(f,f.prev,u)>=0:ui(f,u,f.prev)<0||ui(f,f.next,u)<0}function $S(f,u){var p=new X2(f.i,f.x,f.y),T=new X2(u.i,u.x,u.y),D=f.next,z=u.prev;return f.next=u,u.prev=f,p.next=D,D.prev=p,T.next=p,p.prev=T,z.next=T,T.prev=z,T}function HS(f,u,p,T){var D=new X2(f,u,p);return T?(D.next=T.next,D.prev=T,T.next.prev=D,T.next=D):(D.prev=D,D.next=D),D}function dd(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function X2(f,u,p){this.i=f,this.x=u,this.y=p,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function K2(f,u,p,T){for(var D=0,z=u,F=p-T;z<p;z+=T)D+=(f[F]-f[z])*(f[z+1]+f[F+1]),F=z;return D}function qF(f,u,p,T,D){WS(f,u,p||0,T||f.length-1,D||ZF)}function WS(f,u,p,T,D){for(;T>p;){if(T-p>600){var z=T-p+1,F=u-p+1,j=Math.log(z),Z=.5*Math.exp(2*j/3),re=.5*Math.sqrt(j*Z*(z-Z)/z)*(F-z/2<0?-1:1);WS(f,u,Math.max(p,Math.floor(u-F*Z/z+re)),Math.min(T,Math.floor(u+(z-F)*Z/z+re)),D)}var Ae=f[u],ce=p,pe=T;for(pd(f,p,u),D(f[T],Ae)>0&&pd(f,p,T);ce<pe;){for(pd(f,ce,pe),ce++,pe--;D(f[ce],Ae)<0;)ce++;for(;D(f[pe],Ae)>0;)pe--}D(f[p],Ae)===0?pd(f,p,pe):pd(f,++pe,T),pe<=u&&(p=pe+1),u<=pe&&(T=pe-1)}}function pd(f,u,p){var T=f[u];f[u]=f[p],f[p]=T}function ZF(f,u){return f<u?-1:f>u?1:0}function J2(f,u){const p=f.length;if(p<=1)return[f];const T=[];let D,z;for(let F=0;F<p;F++){const j=He(f[F]);j!==0&&(f[F].area=Math.abs(j),z===void 0&&(z=j<0),z===j<0?(D&&T.push(D),D=[f[F]]):D.push(f[F]))}if(D&&T.push(D),u>1)for(let F=0;F<T.length;F++)T[F].length<=u||(qF(T[F],u,1,T[F].length-1,YF),T[F]=T[F].slice(0,u));return T}function YF(f,u){return u.area-f.area}function ev(f,u,p){const T=p.patternDependencies;let D=!1;for(const z of u){const F=z.paint.get(`${f}-pattern`);F.isConstant()||(D=!0);const j=F.constantOr(null);j&&(D=!0,T[j.to]=!0,T[j.from]=!0)}return D}function tv(f,u,p,T,D){const z=D.patternDependencies;for(const F of u){const j=F.paint.get(`${f}-pattern`).value;if(j.kind!=="constant"){let Z=j.evaluate({zoom:T-1},p,{},D.availableImages),re=j.evaluate({zoom:T},p,{},D.availableImages),Ae=j.evaluate({zoom:T+1},p,{},D.availableImages);Z=Z&&Z.name?Z.name:Z,re=re&&re.name?re.name:re,Ae=Ae&&Ae.name?Ae.name:Ae,z[Z]=!0,z[re]=!0,z[Ae]=!0,p.patterns[F.id]={min:Z,mid:re,max:Ae}}}return p}rm.exports=im,rm.exports.default=im,im.deviation=function(f,u,p,T){var D=u&&u.length,z=Math.abs(K2(f,0,D?u[0]*p:f.length,p));if(D)for(var F=0,j=u.length;F<j;F++)z-=Math.abs(K2(f,u[F]*p,F<j-1?u[F+1]*p:f.length,p));var Z=0;for(F=0;F<T.length;F+=3){var re=T[F]*p,Ae=T[F+1]*p,ce=T[F+2]*p;Z+=Math.abs((f[re]-f[ce])*(f[Ae+1]-f[re+1])-(f[re]-f[Ae])*(f[ce+1]-f[re+1]))}return z===0&&Z===0?0:Math.abs((Z-z)/z)},im.flatten=function(f){for(var u=f[0][0].length,p={vertices:[],holes:[],dimensions:u},T=0,D=0;D<f.length;D++){for(var z=0;z<f[D].length;z++)for(var F=0;F<u;F++)p.vertices.push(f[D][z][F]);D>0&&p.holes.push(T+=f[D-1].length)}return p};class nv{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new J,this.indexArray=new it,this.indexArray2=new Xe,this.programConfigurations=new nh(u.layers,u.zoom),this.segments=new dt,this.segments2=new dt,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,T){this.hasPattern=ev("fill",this.layers,p);const D=this.layers[0].layout.get("fill-sort-key"),z=!D.isConstant(),F=[];for(const{feature:j,id:Z,index:re,sourceLayerIndex:Ae}of u){const ce=this.layers[0]._featureFilter.needGeometry,pe=ih(j,ce);if(!this.layers[0]._featureFilter.filter(new wr(this.zoom),pe,T))continue;const me=z?D.evaluate(pe,{},T,p.availableImages):void 0,_e={id:Z,properties:j.properties,type:j.type,sourceLayerIndex:Ae,index:re,geometry:ce?pe.geometry:rh(j),patterns:{},sortKey:me};F.push(_e)}z&&F.sort((j,Z)=>j.sortKey-Z.sortKey);for(const j of F){const{geometry:Z,index:re,sourceLayerIndex:Ae}=j;if(this.hasPattern){const ce=tv("fill",this.layers,j,this.zoom,p);this.patternFeatures.push(ce)}else this.addFeature(j,Z,re,T,{});p.featureIndex.insert(u[re].feature,Z,re,Ae,this.index)}}update(u,p,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,T)}addFeatures(u,p,T){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,p,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,FF),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.indexBuffer2=u.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(u,p,T,D,z){for(const F of J2(p,500)){let j=0;for(const me of F)j+=me.length;const Z=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray),re=Z.vertexLength,Ae=[],ce=[];for(const me of F){if(me.length===0)continue;me!==F[0]&&ce.push(Ae.length/2);const _e=this.segments2.prepareSegment(me.length,this.layoutVertexArray,this.indexArray2),Ue=_e.vertexLength;this.layoutVertexArray.emplaceBack(me[0].x,me[0].y),this.indexArray2.emplaceBack(Ue+me.length-1,Ue),Ae.push(me[0].x),Ae.push(me[0].y);for(let ze=1;ze<me.length;ze++)this.layoutVertexArray.emplaceBack(me[ze].x,me[ze].y),this.indexArray2.emplaceBack(Ue+ze-1,Ue+ze),Ae.push(me[ze].x),Ae.push(me[ze].y);_e.vertexLength+=me.length,_e.primitiveLength+=me.length}const pe=rm.exports(Ae,ce);for(let me=0;me<pe.length;me+=3)this.indexArray.emplaceBack(re+pe[me],re+pe[me+1],re+pe[me+2]);Z.vertexLength+=j,Z.primitiveLength+=pe.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}}Ft("FillBucket",nv,{omit:["layers","patternFeatures"]});const XF=new Or({"fill-sort-key":new Yt(ct.layout_fill["fill-sort-key"])});var KF={paint:new Or({"fill-antialias":new Zt(ct.paint_fill["fill-antialias"]),"fill-opacity":new Yt(ct.paint_fill["fill-opacity"]),"fill-color":new Yt(ct.paint_fill["fill-color"]),"fill-outline-color":new Yt(ct.paint_fill["fill-outline-color"]),"fill-translate":new Zt(ct.paint_fill["fill-translate"]),"fill-translate-anchor":new Zt(ct.paint_fill["fill-translate-anchor"]),"fill-pattern":new cn(ct.paint_fill["fill-pattern"])}),layout:XF};const JF=Fr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),e7=Fr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:t7}=JF;var ac={},n7=Et,QS=df;function df(f,u,p,T,D){this.properties={},this.extent=p,this.type=0,this._pbf=f,this._geometry=-1,this._keys=T,this._values=D,f.readFields(r7,this,u)}function r7(f,u,p){f==1?u.id=p.readVarint():f==2?function(T,D){for(var z=T.readVarint()+T.pos;T.pos<z;){var F=D._keys[T.readVarint()],j=D._values[T.readVarint()];D.properties[F]=j}}(p,u):f==3?u.type=p.readVarint():f==4&&(u._geometry=p.pos)}function i7(f){for(var u,p,T=0,D=0,z=f.length,F=z-1;D<z;F=D++)T+=((p=f[F]).x-(u=f[D]).x)*(u.y+p.y);return T}df.types=["Unknown","Point","LineString","Polygon"],df.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var u,p=f.readVarint()+f.pos,T=1,D=0,z=0,F=0,j=[];f.pos<p;){if(D<=0){var Z=f.readVarint();T=7&Z,D=Z>>3}if(D--,T===1||T===2)z+=f.readSVarint(),F+=f.readSVarint(),T===1&&(u&&j.push(u),u=[]),u.push(new n7(z,F));else{if(T!==7)throw new Error("unknown command "+T);u&&u.push(u[0].clone())}}return u&&j.push(u),j},df.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var u=f.readVarint()+f.pos,p=1,T=0,D=0,z=0,F=1/0,j=-1/0,Z=1/0,re=-1/0;f.pos<u;){if(T<=0){var Ae=f.readVarint();p=7&Ae,T=Ae>>3}if(T--,p===1||p===2)(D+=f.readSVarint())<F&&(F=D),D>j&&(j=D),(z+=f.readSVarint())<Z&&(Z=z),z>re&&(re=z);else if(p!==7)throw new Error("unknown command "+p)}return[F,Z,j,re]},df.prototype.toGeoJSON=function(f,u,p){var T,D,z=this.extent*Math.pow(2,p),F=this.extent*f,j=this.extent*u,Z=this.loadGeometry(),re=df.types[this.type];function Ae(me){for(var _e=0;_e<me.length;_e++){var Ue=me[_e];me[_e]=[360*(Ue.x+F)/z-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ue.y+j)/z)*Math.PI/180))-90]}}switch(this.type){case 1:var ce=[];for(T=0;T<Z.length;T++)ce[T]=Z[T][0];Ae(Z=ce);break;case 2:for(T=0;T<Z.length;T++)Ae(Z[T]);break;case 3:for(Z=function(me){var _e=me.length;if(_e<=1)return[me];for(var Ue,ze,et=[],lt=0;lt<_e;lt++){var Ke=i7(me[lt]);Ke!==0&&(ze===void 0&&(ze=Ke<0),ze===Ke<0?(Ue&&et.push(Ue),Ue=[me[lt]]):Ue.push(me[lt]))}return Ue&&et.push(Ue),et}(Z),T=0;T<Z.length;T++)for(D=0;D<Z[T].length;D++)Ae(Z[T][D])}Z.length===1?Z=Z[0]:re="Multi"+re;var pe={type:"Feature",geometry:{type:re,coordinates:Z},properties:this.properties};return"id"in this&&(pe.id=this.id),pe};var s7=QS,qS=ZS;function ZS(f,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(o7,this,u),this.length=this._features.length}function o7(f,u,p){f===15?u.version=p.readVarint():f===1?u.name=p.readString():f===5?u.extent=p.readVarint():f===2?u._features.push(p.pos):f===3?u._keys.push(p.readString()):f===4&&u._values.push(function(T){for(var D=null,z=T.readVarint()+T.pos;T.pos<z;){var F=T.readVarint()>>3;D=F===1?T.readString():F===2?T.readFloat():F===3?T.readDouble():F===4?T.readVarint64():F===5?T.readVarint():F===6?T.readSVarint():F===7?T.readBoolean():null}return D}(p))}ZS.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var u=this._pbf.readVarint()+this._pbf.pos;return new s7(this._pbf,u,this.extent,this._keys,this._values)};var a7=qS;function l7(f,u,p){if(f===3){var T=new a7(p,p.readVarint()+p.pos);T.length&&(u[T.name]=T)}}ac.VectorTile=function(f,u){this.layers=f.readFields(l7,{},u)},ac.VectorTileFeature=QS,ac.VectorTileLayer=qS;const A7=ac.VectorTileFeature.types,rv=Math.pow(2,13);function gd(f,u,p,T,D,z,F,j){f.emplaceBack(u,p,2*Math.floor(T*rv)+F,D*rv*2,z*rv*2,Math.round(j))}class iv{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new le,this.centroidVertexArray=new N,this.indexArray=new it,this.programConfigurations=new nh(u.layers,u.zoom),this.segments=new dt,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,T){this.features=[],this.hasPattern=ev("fill-extrusion",this.layers,p);for(const{feature:D,id:z,index:F,sourceLayerIndex:j}of u){const Z=this.layers[0]._featureFilter.needGeometry,re=ih(D,Z);if(!this.layers[0]._featureFilter.filter(new wr(this.zoom),re,T))continue;const Ae={id:z,sourceLayerIndex:j,index:F,geometry:Z?re.geometry:rh(D),properties:D.properties,type:D.type,patterns:{}};this.hasPattern?this.features.push(tv("fill-extrusion",this.layers,Ae,this.zoom,p)):this.addFeature(Ae,Ae.geometry,F,T,{}),p.featureIndex.insert(D,Ae.geometry,F,j,this.index,!0)}}addFeatures(u,p,T){for(const D of this.features){const{geometry:z}=D;this.addFeature(D,z,D.index,p,T)}}update(u,p,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,T)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,t7),this.centroidVertexBuffer=u.createVertexBuffer(this.centroidVertexArray,e7.members,!0),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(u,p,T,D,z){const F={x:0,y:0,vertexCount:0};for(const j of J2(p,500)){let Z=0;for(const _e of j)Z+=_e.length;let re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const _e of j){if(_e.length===0||c7(_e))continue;let Ue=0;for(let ze=0;ze<_e.length;ze++){const et=_e[ze];if(ze>=1){const lt=_e[ze-1];if(!u7(et,lt)){re.vertexLength+4>dt.MAX_VERTEX_ARRAY_LENGTH&&(re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ke=et.sub(lt)._perp()._unit(),st=lt.dist(et);Ue+st>32768&&(Ue=0),gd(this.layoutVertexArray,et.x,et.y,Ke.x,Ke.y,0,0,Ue),gd(this.layoutVertexArray,et.x,et.y,Ke.x,Ke.y,0,1,Ue),F.x+=2*et.x,F.y+=2*et.y,F.vertexCount+=2,Ue+=st,gd(this.layoutVertexArray,lt.x,lt.y,Ke.x,Ke.y,0,0,Ue),gd(this.layoutVertexArray,lt.x,lt.y,Ke.x,Ke.y,0,1,Ue),F.x+=2*lt.x,F.y+=2*lt.y,F.vertexCount+=2;const gt=re.vertexLength;this.indexArray.emplaceBack(gt,gt+2,gt+1),this.indexArray.emplaceBack(gt+1,gt+2,gt+3),re.vertexLength+=4,re.primitiveLength+=2}}}}if(re.vertexLength+Z>dt.MAX_VERTEX_ARRAY_LENGTH&&(re=this.segments.prepareSegment(Z,this.layoutVertexArray,this.indexArray)),A7[u.type]!=="Polygon")continue;const Ae=[],ce=[],pe=re.vertexLength;for(const _e of j)if(_e.length!==0){_e!==j[0]&&ce.push(Ae.length/2);for(let Ue=0;Ue<_e.length;Ue++){const ze=_e[Ue];gd(this.layoutVertexArray,ze.x,ze.y,0,0,1,1,0),F.x+=ze.x,F.y+=ze.y,F.vertexCount+=1,Ae.push(ze.x),Ae.push(ze.y)}}const me=rm.exports(Ae,ce);for(let _e=0;_e<me.length;_e+=3)this.indexArray.emplaceBack(pe+me[_e],pe+me[_e+2],pe+me[_e+1]);re.primitiveLength+=me.length/3,re.vertexLength+=Z}for(let j=0;j<F.vertexCount;j++)this.centroidVertexArray.emplaceBack(Math.floor(F.x/F.vertexCount),Math.floor(F.y/F.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}}function u7(f,u){return f.x===u.x&&(f.x<0||f.x>Ci)||f.y===u.y&&(f.y<0||f.y>Ci)}function c7(f){return f.every(u=>u.x<0)||f.every(u=>u.x>Ci)||f.every(u=>u.y<0)||f.every(u=>u.y>Ci)}Ft("FillExtrusionBucket",iv,{omit:["layers","features"]});var h7={paint:new Or({"fill-extrusion-opacity":new Zt(ct["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Yt(ct["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Zt(ct["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Zt(ct["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new cn(ct["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Yt(ct["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Yt(ct["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Zt(ct["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function md(f,u){return f.x*u.x+f.y*u.y}function YS(f,u){if(f.length===1){let p=0;const T=u[p++];let D;for(;!D||T.equals(D);)if(D=u[p++],!D)return 1/0;for(;p<u.length;p++){const z=u[p],F=f[0],j=D.sub(T),Z=z.sub(T),re=F.sub(T),Ae=md(j,j),ce=md(j,Z),pe=md(Z,Z),me=md(re,j),_e=md(re,Z),Ue=Ae*pe-ce*ce,ze=(pe*me-ce*_e)/Ue,et=(Ae*_e-ce*me)/Ue,lt=T.z*(1-ze-et)+D.z*ze+z.z*et;if(isFinite(lt))return lt}return 1/0}{let p=1/0;for(const T of u)p=Math.min(p,T.z);return p}}const f7=Fr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:d7}=f7,p7=Fr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:g7}=p7,m7=ac.VectorTileFeature.types,y7=Math.cos(Math.PI/180*37.5),XS=Math.pow(2,14)/.5;class sv{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(p=>{this.gradients[p.id]={}}),this.layoutVertexArray=new de,this.layoutVertexArray2=new Re,this.indexArray=new it,this.programConfigurations=new nh(u.layers,u.zoom),this.segments=new dt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,T){this.hasPattern=ev("line",this.layers,p);const D=this.layers[0].layout.get("line-sort-key"),z=!D.isConstant(),F=[];for(const{feature:j,id:Z,index:re,sourceLayerIndex:Ae}of u){const ce=this.layers[0]._featureFilter.needGeometry,pe=ih(j,ce);if(!this.layers[0]._featureFilter.filter(new wr(this.zoom),pe,T))continue;const me=z?D.evaluate(pe,{},T):void 0,_e={id:Z,properties:j.properties,type:j.type,sourceLayerIndex:Ae,index:re,geometry:ce?pe.geometry:rh(j),patterns:{},sortKey:me};F.push(_e)}z&&F.sort((j,Z)=>j.sortKey-Z.sortKey);for(const j of F){const{geometry:Z,index:re,sourceLayerIndex:Ae}=j;if(this.hasPattern){const ce=tv("line",this.layers,j,this.zoom,p);this.patternFeatures.push(ce)}else this.addFeature(j,Z,re,T,{});p.featureIndex.insert(u[re].feature,Z,re,Ae,this.index)}}update(u,p,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,T)}addFeatures(u,p,T){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,p,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=u.createVertexBuffer(this.layoutVertexArray2,g7)),this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,d7),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(u){if(u.properties&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_end"))return{start:+u.properties.mapbox_clip_start,end:+u.properties.mapbox_clip_end}}addFeature(u,p,T,D,z){const F=this.layers[0].layout,j=F.get("line-join").evaluate(u,{}),Z=F.get("line-cap"),re=F.get("line-miter-limit"),Ae=F.get("line-round-limit");this.lineClips=this.lineFeatureClips(u);for(const ce of p)this.addLine(ce,u,j,Z,re,Ae);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}addLine(u,p,T,D,z,F){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let et=0;et<u.length-1;et++)this.totalDistance+=u[et].dist(u[et+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const j=m7[p.type]==="Polygon";let Z=u.length;for(;Z>=2&&u[Z-1].equals(u[Z-2]);)Z--;let re=0;for(;re<Z-1&&u[re].equals(u[re+1]);)re++;if(Z<(j?3:2))return;T==="bevel"&&(z=1.05);const Ae=this.overscaling<=16?122880/(512*this.overscaling):0,ce=this.segments.prepareSegment(10*Z,this.layoutVertexArray,this.indexArray);let pe,me,_e,Ue,ze;this.e1=this.e2=-1,j&&(pe=u[Z-2],ze=u[re].sub(pe)._unit()._perp());for(let et=re;et<Z;et++){if(_e=et===Z-1?j?u[re+1]:void 0:u[et+1],_e&&u[et].equals(_e))continue;ze&&(Ue=ze),pe&&(me=pe),pe=u[et],ze=_e?_e.sub(pe)._unit()._perp():Ue,Ue=Ue||ze;let lt=Ue.add(ze);lt.x===0&&lt.y===0||lt._unit();const Ke=Ue.x*ze.x+Ue.y*ze.y,st=lt.x*ze.x+lt.y*ze.y,gt=st!==0?1/st:1/0,pt=2*Math.sqrt(2-2*st),qt=st<y7&&me&&_e,en=Ue.x*ze.y-Ue.y*ze.x>0;if(qt&&et>re){const zt=pe.dist(me);if(zt>2*Ae){const Ht=pe.sub(pe.sub(me)._mult(Ae/zt)._round());this.updateDistance(me,Ht),this.addCurrentVertex(Ht,Ue,0,0,ce),me=Ht}}const $t=me&&_e;let Nt=$t?T:j?"butt":D;if($t&&Nt==="round"&&(gt<F?Nt="miter":gt<=2&&(Nt="fakeround")),Nt==="miter"&&gt>z&&(Nt="bevel"),Nt==="bevel"&&(gt>2&&(Nt="flipbevel"),gt<z&&(Nt="miter")),me&&this.updateDistance(me,pe),Nt==="miter")lt._mult(gt),this.addCurrentVertex(pe,lt,0,0,ce);else if(Nt==="flipbevel"){if(gt>100)lt=ze.mult(-1);else{const zt=gt*Ue.add(ze).mag()/Ue.sub(ze).mag();lt._perp()._mult(zt*(en?-1:1))}this.addCurrentVertex(pe,lt,0,0,ce),this.addCurrentVertex(pe,lt.mult(-1),0,0,ce)}else if(Nt==="bevel"||Nt==="fakeround"){const zt=-Math.sqrt(gt*gt-1),Ht=en?zt:0,Gt=en?0:zt;if(me&&this.addCurrentVertex(pe,Ue,Ht,Gt,ce),Nt==="fakeround"){const Tt=Math.round(180*pt/Math.PI/20);for(let pn=1;pn<Tt;pn++){let an=pn/Tt;if(an!==.5){const Rr=an-.5;an+=an*Rr*(an-1)*((1.0904+Ke*(Ke*(3.55645-1.43519*Ke)-3.2452))*Rr*Rr+(.848013+Ke*(.215638*Ke-1.06021)))}const jn=ze.sub(Ue)._mult(an)._add(Ue)._unit()._mult(en?-1:1);this.addHalfVertex(pe,jn.x,jn.y,!1,en,0,ce)}}_e&&this.addCurrentVertex(pe,ze,-Ht,-Gt,ce)}else if(Nt==="butt")this.addCurrentVertex(pe,lt,0,0,ce);else if(Nt==="square"){const zt=me?1:-1;this.addCurrentVertex(pe,lt,zt,zt,ce)}else Nt==="round"&&(me&&(this.addCurrentVertex(pe,Ue,0,0,ce),this.addCurrentVertex(pe,Ue,1,1,ce,!0)),_e&&(this.addCurrentVertex(pe,ze,-1,-1,ce,!0),this.addCurrentVertex(pe,ze,0,0,ce)));if(qt&&et<Z-1){const zt=pe.dist(_e);if(zt>2*Ae){const Ht=pe.add(_e.sub(pe)._mult(Ae/zt)._round());this.updateDistance(pe,Ht),this.addCurrentVertex(Ht,ze,0,0,ce),pe=Ht}}}}addCurrentVertex(u,p,T,D,z,F=!1){const j=p.y*D-p.x,Z=-p.y-p.x*D;this.addHalfVertex(u,p.x+p.y*T,p.y-p.x*T,F,!1,T,z),this.addHalfVertex(u,j,Z,F,!0,-D,z),this.distance>XS/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(u,p,T,D,z,F))}addHalfVertex({x:u,y:p},T,D,z,F,j,Z){const re=.5*(this.lineClips?this.scaledDistance*(XS-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((u<<1)+(z?1:0),(p<<1)+(F?1:0),Math.round(63*T)+128,Math.round(63*D)+128,1+(j===0?0:j<0?-1:1)|(63&re)<<2,re>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Ae=Z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Ae),Z.primitiveLength++),F?this.e2=Ae:this.e1=Ae}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(u,p){this.distance+=u.dist(p),this.updateScaledDistance()}}Ft("LineBucket",sv,{omit:["layers","patternFeatures"]});const _7=new Or({"line-cap":new Zt(ct.layout_line["line-cap"]),"line-join":new Yt(ct.layout_line["line-join"]),"line-miter-limit":new Zt(ct.layout_line["line-miter-limit"]),"line-round-limit":new Zt(ct.layout_line["line-round-limit"]),"line-sort-key":new Yt(ct.layout_line["line-sort-key"])});var KS={paint:new Or({"line-opacity":new Yt(ct.paint_line["line-opacity"]),"line-color":new Yt(ct.paint_line["line-color"]),"line-translate":new Zt(ct.paint_line["line-translate"]),"line-translate-anchor":new Zt(ct.paint_line["line-translate-anchor"]),"line-width":new Yt(ct.paint_line["line-width"]),"line-gap-width":new Yt(ct.paint_line["line-gap-width"]),"line-offset":new Yt(ct.paint_line["line-offset"]),"line-blur":new Yt(ct.paint_line["line-blur"]),"line-dasharray":new $i(ct.paint_line["line-dasharray"]),"line-pattern":new cn(ct.paint_line["line-pattern"]),"line-gradient":new Uo(ct.paint_line["line-gradient"])}),layout:_7};const JS=new class extends Yt{possiblyEvaluate(f,u){return u=new wr(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(f,u)}evaluate(f,u,p,T){return u=W({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(f,u,p,T)}}(KS.paint.properties["line-width"].specification);function e4(f,u){return u>0?u+2*f:f}JS.useIntegerZoom=!0;const v7=Fr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),x7=Fr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Fr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const w7=Fr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Fr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const t4=Fr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),b7=Fr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function E7(f,u,p){return f.sections.forEach(T=>{T.text=function(D,z,F){const j=z.layout.get("text-transform").evaluate(F,{});return j==="uppercase"?D=D.toLocaleUpperCase():j==="lowercase"&&(D=D.toLocaleLowerCase()),ss.applyArabicShaping&&(D=ss.applyArabicShaping(D)),D}(T.text,u,p)}),f}Fr([{name:"triangle",components:3,type:"Uint16"}]),Fr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Fr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Fr([{type:"Float32",name:"offsetX"}]),Fr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const yd={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Hi=24,ov=Tr,n4=function(f,u,p,T,D){var z,F,j=8*D-T-1,Z=(1<<j)-1,re=Z>>1,Ae=-7,ce=p?D-1:0,pe=p?-1:1,me=f[u+ce];for(ce+=pe,z=me&(1<<-Ae)-1,me>>=-Ae,Ae+=j;Ae>0;z=256*z+f[u+ce],ce+=pe,Ae-=8);for(F=z&(1<<-Ae)-1,z>>=-Ae,Ae+=T;Ae>0;F=256*F+f[u+ce],ce+=pe,Ae-=8);if(z===0)z=1-re;else{if(z===Z)return F?NaN:1/0*(me?-1:1);F+=Math.pow(2,T),z-=re}return(me?-1:1)*F*Math.pow(2,z-T)},r4=function(f,u,p,T,D,z){var F,j,Z,re=8*z-D-1,Ae=(1<<re)-1,ce=Ae>>1,pe=D===23?Math.pow(2,-24)-Math.pow(2,-77):0,me=T?0:z-1,_e=T?1:-1,Ue=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(j=isNaN(u)?1:0,F=Ae):(F=Math.floor(Math.log(u)/Math.LN2),u*(Z=Math.pow(2,-F))<1&&(F--,Z*=2),(u+=F+ce>=1?pe/Z:pe*Math.pow(2,1-ce))*Z>=2&&(F++,Z/=2),F+ce>=Ae?(j=0,F=Ae):F+ce>=1?(j=(u*Z-1)*Math.pow(2,D),F+=ce):(j=u*Math.pow(2,ce-1)*Math.pow(2,D),F=0));D>=8;f[p+me]=255&j,me+=_e,j/=256,D-=8);for(F=F<<D|j,re+=D;re>0;f[p+me]=255&F,me+=_e,F/=256,re-=8);f[p+me-_e]|=128*Ue};function Tr(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}Tr.Varint=0,Tr.Fixed64=1,Tr.Bytes=2,Tr.Fixed32=5;var lc,av=4294967296,i4=1/av,s4=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function au(f){return f.type===Tr.Bytes?f.readVarint()+f.pos:f.pos+1}function pf(f,u,p){return p?4294967296*u+(f>>>0):4294967296*(u>>>0)+(f>>>0)}function o4(f,u,p){var T=u<=16383?1:u<=2097151?2:u<=268435455?3:Math.floor(Math.log(u)/(7*Math.LN2));p.realloc(T);for(var D=p.pos-1;D>=f;D--)p.buf[D+T]=p.buf[D]}function T7(f,u){for(var p=0;p<f.length;p++)u.writeVarint(f[p])}function S7(f,u){for(var p=0;p<f.length;p++)u.writeSVarint(f[p])}function M7(f,u){for(var p=0;p<f.length;p++)u.writeFloat(f[p])}function C7(f,u){for(var p=0;p<f.length;p++)u.writeDouble(f[p])}function P7(f,u){for(var p=0;p<f.length;p++)u.writeBoolean(f[p])}function I7(f,u){for(var p=0;p<f.length;p++)u.writeFixed32(f[p])}function k7(f,u){for(var p=0;p<f.length;p++)u.writeSFixed32(f[p])}function L7(f,u){for(var p=0;p<f.length;p++)u.writeFixed64(f[p])}function D7(f,u){for(var p=0;p<f.length;p++)u.writeSFixed64(f[p])}function lm(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+16777216*f[u+3]}function gf(f,u,p){f[p]=u,f[p+1]=u>>>8,f[p+2]=u>>>16,f[p+3]=u>>>24}function a4(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+(f[u+3]<<24)}function R7(f,u,p){f===1&&p.readMessage(B7,u)}function B7(f,u,p){if(f===3){const{id:T,bitmap:D,width:z,height:F,left:j,top:Z,advance:re}=p.readMessage(z7,{});u.push({id:T,bitmap:new cd({width:z+6,height:F+6},D),metrics:{width:z,height:F,left:j,top:Z,advance:re}})}}function z7(f,u,p){f===1?u.id=p.readVarint():f===2?u.bitmap=p.readBytes():f===3?u.width=p.readVarint():f===4?u.height=p.readVarint():f===5?u.left=p.readSVarint():f===6?u.top=p.readSVarint():f===7&&(u.advance=p.readVarint())}function l4(f){let u=0,p=0;for(const F of f)u+=F.w*F.h,p=Math.max(p,F.w);f.sort((F,j)=>j.h-F.h);const T=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),p),h:1/0}];let D=0,z=0;for(const F of f)for(let j=T.length-1;j>=0;j--){const Z=T[j];if(!(F.w>Z.w||F.h>Z.h)){if(F.x=Z.x,F.y=Z.y,z=Math.max(z,F.y+F.h),D=Math.max(D,F.x+F.w),F.w===Z.w&&F.h===Z.h){const re=T.pop();j<T.length&&(T[j]=re)}else F.h===Z.h?(Z.x+=F.w,Z.w-=F.w):F.w===Z.w?(Z.y+=F.h,Z.h-=F.h):(T.push({x:Z.x+F.w,y:Z.y,w:Z.w-F.w,h:F.h}),Z.y+=F.h,Z.h-=F.h);break}}return{w:D,h:z,fill:u/(D*z)||0}}Tr.prototype={destroy:function(){this.buf=null},readFields:function(f,u,p){for(p=p||this.length;this.pos<p;){var T=this.readVarint(),D=T>>3,z=this.pos;this.type=7&T,f(D,u,this),this.pos===z&&this.skip(T)}return u},readMessage:function(f,u){return this.readFields(f,u,this.readVarint()+this.pos)},readFixed32:function(){var f=lm(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=a4(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=lm(this.buf,this.pos)+lm(this.buf,this.pos+4)*av;return this.pos+=8,f},readSFixed64:function(){var f=lm(this.buf,this.pos)+a4(this.buf,this.pos+4)*av;return this.pos+=8,f},readFloat:function(){var f=n4(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=n4(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var u,p,T=this.buf;return u=127&(p=T[this.pos++]),p<128?u:(u|=(127&(p=T[this.pos++]))<<7,p<128?u:(u|=(127&(p=T[this.pos++]))<<14,p<128?u:(u|=(127&(p=T[this.pos++]))<<21,p<128?u:function(D,z,F){var j,Z,re=F.buf;if(j=(112&(Z=re[F.pos++]))>>4,Z<128||(j|=(127&(Z=re[F.pos++]))<<3,Z<128)||(j|=(127&(Z=re[F.pos++]))<<10,Z<128)||(j|=(127&(Z=re[F.pos++]))<<17,Z<128)||(j|=(127&(Z=re[F.pos++]))<<24,Z<128)||(j|=(1&(Z=re[F.pos++]))<<31,Z<128))return pf(D,j,z);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(p=T[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var f=this.readVarint()+this.pos,u=this.pos;return this.pos=f,f-u>=12&&s4?function(p,T,D){return s4.decode(p.subarray(T,D))}(this.buf,u,f):function(p,T,D){for(var z="",F=T;F<D;){var j,Z,re,Ae=p[F],ce=null,pe=Ae>239?4:Ae>223?3:Ae>191?2:1;if(F+pe>D)break;pe===1?Ae<128&&(ce=Ae):pe===2?(192&(j=p[F+1]))==128&&(ce=(31&Ae)<<6|63&j)<=127&&(ce=null):pe===3?(Z=p[F+2],(192&(j=p[F+1]))==128&&(192&Z)==128&&((ce=(15&Ae)<<12|(63&j)<<6|63&Z)<=2047||ce>=55296&&ce<=57343)&&(ce=null)):pe===4&&(Z=p[F+2],re=p[F+3],(192&(j=p[F+1]))==128&&(192&Z)==128&&(192&re)==128&&((ce=(15&Ae)<<18|(63&j)<<12|(63&Z)<<6|63&re)<=65535||ce>=1114112)&&(ce=null)),ce===null?(ce=65533,pe=1):ce>65535&&(ce-=65536,z+=String.fromCharCode(ce>>>10&1023|55296),ce=56320|1023&ce),z+=String.fromCharCode(ce),F+=pe}return z}(this.buf,u,f)},readBytes:function(){var f=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,f);return this.pos=f,u},readPackedVarint:function(f,u){if(this.type!==Tr.Bytes)return f.push(this.readVarint(u));var p=au(this);for(f=f||[];this.pos<p;)f.push(this.readVarint(u));return f},readPackedSVarint:function(f){if(this.type!==Tr.Bytes)return f.push(this.readSVarint());var u=au(this);for(f=f||[];this.pos<u;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==Tr.Bytes)return f.push(this.readBoolean());var u=au(this);for(f=f||[];this.pos<u;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==Tr.Bytes)return f.push(this.readFloat());var u=au(this);for(f=f||[];this.pos<u;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==Tr.Bytes)return f.push(this.readDouble());var u=au(this);for(f=f||[];this.pos<u;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==Tr.Bytes)return f.push(this.readFixed32());var u=au(this);for(f=f||[];this.pos<u;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==Tr.Bytes)return f.push(this.readSFixed32());var u=au(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==Tr.Bytes)return f.push(this.readFixed64());var u=au(this);for(f=f||[];this.pos<u;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==Tr.Bytes)return f.push(this.readSFixed64());var u=au(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed64());return f},skip:function(f){var u=7&f;if(u===Tr.Varint)for(;this.buf[this.pos++]>127;);else if(u===Tr.Bytes)this.pos=this.readVarint()+this.pos;else if(u===Tr.Fixed32)this.pos+=4;else{if(u!==Tr.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(f,u){this.writeVarint(f<<3|u)},realloc:function(f){for(var u=this.length||16;u<this.pos+f;)u*=2;if(u!==this.length){var p=new Uint8Array(u);p.set(this.buf),this.buf=p,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),gf(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),gf(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),gf(this.buf,-1&f,this.pos),gf(this.buf,Math.floor(f*i4),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),gf(this.buf,-1&f,this.pos),gf(this.buf,Math.floor(f*i4),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(u,p){var T,D;if(u>=0?(T=u%4294967296|0,D=u/4294967296|0):(D=~(-u/4294967296),4294967295^(T=~(-u%4294967296))?T=T+1|0:(T=0,D=D+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),function(z,F,j){j.buf[j.pos++]=127&z|128,z>>>=7,j.buf[j.pos++]=127&z|128,z>>>=7,j.buf[j.pos++]=127&z|128,z>>>=7,j.buf[j.pos++]=127&z|128,j.buf[j.pos]=127&(z>>>=7)}(T,0,p),function(z,F){var j=(7&z)<<4;F.buf[F.pos++]|=j|((z>>>=3)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z)))))}(D,p)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(!!f)},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var u=this.pos;this.pos=function(T,D,z){for(var F,j,Z=0;Z<D.length;Z++){if((F=D.charCodeAt(Z))>55295&&F<57344){if(!j){F>56319||Z+1===D.length?(T[z++]=239,T[z++]=191,T[z++]=189):j=F;continue}if(F<56320){T[z++]=239,T[z++]=191,T[z++]=189,j=F;continue}F=j-55296<<10|F-56320|65536,j=null}else j&&(T[z++]=239,T[z++]=191,T[z++]=189,j=null);F<128?T[z++]=F:(F<2048?T[z++]=F>>6|192:(F<65536?T[z++]=F>>12|224:(T[z++]=F>>18|240,T[z++]=F>>12&63|128),T[z++]=F>>6&63|128),T[z++]=63&F|128)}return z}(this.buf,f,this.pos);var p=this.pos-u;p>=128&&o4(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeFloat:function(f){this.realloc(4),r4(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),r4(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var u=f.length;this.writeVarint(u),this.realloc(u);for(var p=0;p<u;p++)this.buf[this.pos++]=f[p]},writeRawMessage:function(f,u){this.pos++;var p=this.pos;f(u,this);var T=this.pos-p;T>=128&&o4(p,T,this),this.pos=p-1,this.writeVarint(T),this.pos+=T},writeMessage:function(f,u,p){this.writeTag(f,Tr.Bytes),this.writeRawMessage(u,p)},writePackedVarint:function(f,u){u.length&&this.writeMessage(f,T7,u)},writePackedSVarint:function(f,u){u.length&&this.writeMessage(f,S7,u)},writePackedBoolean:function(f,u){u.length&&this.writeMessage(f,P7,u)},writePackedFloat:function(f,u){u.length&&this.writeMessage(f,M7,u)},writePackedDouble:function(f,u){u.length&&this.writeMessage(f,C7,u)},writePackedFixed32:function(f,u){u.length&&this.writeMessage(f,I7,u)},writePackedSFixed32:function(f,u){u.length&&this.writeMessage(f,k7,u)},writePackedFixed64:function(f,u){u.length&&this.writeMessage(f,L7,u)},writePackedSFixed64:function(f,u){u.length&&this.writeMessage(f,D7,u)},writeBytesField:function(f,u){this.writeTag(f,Tr.Bytes),this.writeBytes(u)},writeFixed32Field:function(f,u){this.writeTag(f,Tr.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(f,u){this.writeTag(f,Tr.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(f,u){this.writeTag(f,Tr.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(f,u){this.writeTag(f,Tr.Fixed64),this.writeSFixed64(u)},writeVarintField:function(f,u){this.writeTag(f,Tr.Varint),this.writeVarint(u)},writeSVarintField:function(f,u){this.writeTag(f,Tr.Varint),this.writeSVarint(u)},writeStringField:function(f,u){this.writeTag(f,Tr.Bytes),this.writeString(u)},writeFloatField:function(f,u){this.writeTag(f,Tr.Fixed32),this.writeFloat(u)},writeDoubleField:function(f,u){this.writeTag(f,Tr.Fixed64),this.writeDouble(u)},writeBooleanField:function(f,u){this.writeVarintField(f,!!u)}};class lv{constructor(u,{pixelRatio:p,version:T,stretchX:D,stretchY:z,content:F}){this.paddedRect=u,this.pixelRatio=p,this.stretchX=D,this.stretchY=z,this.content=F,this.version=T}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class A4{constructor(u,p){const T={},D={};this.haveRenderCallbacks=[];const z=[];this.addImages(u,T,z),this.addImages(p,D,z);const{w:F,h:j}=l4(z),Z=new ha({width:F||1,height:j||1});for(const re in u){const Ae=u[re],ce=T[re].paddedRect;ha.copy(Ae.data,Z,{x:0,y:0},{x:ce.x+1,y:ce.y+1},Ae.data)}for(const re in p){const Ae=p[re],ce=D[re].paddedRect,pe=ce.x+1,me=ce.y+1,_e=Ae.data.width,Ue=Ae.data.height;ha.copy(Ae.data,Z,{x:0,y:0},{x:pe,y:me},Ae.data),ha.copy(Ae.data,Z,{x:0,y:Ue-1},{x:pe,y:me-1},{width:_e,height:1}),ha.copy(Ae.data,Z,{x:0,y:0},{x:pe,y:me+Ue},{width:_e,height:1}),ha.copy(Ae.data,Z,{x:_e-1,y:0},{x:pe-1,y:me},{width:1,height:Ue}),ha.copy(Ae.data,Z,{x:0,y:0},{x:pe+_e,y:me},{width:1,height:Ue})}this.image=Z,this.iconPositions=T,this.patternPositions=D}addImages(u,p,T){for(const D in u){const z=u[D],F={x:0,y:0,w:z.data.width+2,h:z.data.height+2};T.push(F),p[D]=new lv(F,z),z.hasRenderCallback&&this.haveRenderCallbacks.push(D)}}patchUpdatedImages(u,p){u.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const T in u.updatedImages)this.patchUpdatedImage(this.iconPositions[T],u.getImage(T),p),this.patchUpdatedImage(this.patternPositions[T],u.getImage(T),p)}patchUpdatedImage(u,p,T){if(!u||!p||u.version===p.version)return;u.version=p.version;const[D,z]=u.tl;T.update(p.data,void 0,{x:D,y:z})}}Ft("ImagePosition",lv),Ft("ImageAtlas",A4),a.WritingMode=void 0,(lc=a.WritingMode||(a.WritingMode={}))[lc.none=0]="none",lc[lc.horizontal=1]="horizontal",lc[lc.vertical=2]="vertical",lc[lc.horizontalOnly=3]="horizontalOnly";const Am=-17;class _d{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(u,p){const T=new _d;return T.scale=u||1,T.fontStack=p,T}static forImage(u){const p=new _d;return p.imageName=u,p}}class mf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(u,p){const T=new mf;for(let D=0;D<u.sections.length;D++){const z=u.sections[D];z.image?T.addImageSection(z):T.addTextSection(z,p)}return T}length(){return this.text.length}getSection(u){return this.sections[this.sectionIndex[u]]}getSectionIndex(u){return this.sectionIndex[u]}getCharCode(u){return this.text.charCodeAt(u)}verticalizePunctuation(){this.text=function(u){let p="";for(let T=0;T<u.length;T++){const D=u.charCodeAt(T+1)||null,z=u.charCodeAt(T-1)||null;p+=D&&Rs(D)&&!yd[u[T+1]]||z&&Rs(z)&&!yd[u[T-1]]||!yd[u[T]]?u[T]:yd[u[T]]}return p}(this.text)}trim(){let u=0;for(let T=0;T<this.text.length&&cm[this.text.charCodeAt(T)];T++)u++;let p=this.text.length;for(let T=this.text.length-1;T>=0&&T>=u&&cm[this.text.charCodeAt(T)];T--)p--;this.text=this.text.substring(u,p),this.sectionIndex=this.sectionIndex.slice(u,p)}substring(u,p){const T=new mf;return T.text=this.text.substring(u,p),T.sectionIndex=this.sectionIndex.slice(u,p),T.sections=this.sections,T}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((u,p)=>Math.max(u,this.sections[p].scale),0)}addTextSection(u,p){this.text+=u.text,this.sections.push(_d.forText(u.scale,u.fontStack||p));const T=this.sections.length-1;for(let D=0;D<u.text.length;++D)this.sectionIndex.push(T)}addImageSection(u){const p=u.image?u.image.name:"";if(p.length===0)return void ye("Can't add FormattedSection with an empty image.");const T=this.getNextImageSectionCharCode();T?(this.text+=String.fromCharCode(T),this.sections.push(_d.forImage(p)),this.sectionIndex.push(this.sections.length-1)):ye("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function um(f,u,p,T,D,z,F,j,Z,re,Ae,ce,pe,me,_e,Ue){const ze=mf.fromFeature(f,D);let et;ce===a.WritingMode.vertical&&ze.verticalizePunctuation();const{processBidirectionalText:lt,processStyledBidirectionalText:Ke}=ss;if(lt&&ze.sections.length===1){et=[];const pt=lt(ze.toString(),Av(ze,re,z,u,T,me,_e));for(const qt of pt){const en=new mf;en.text=qt,en.sections=ze.sections;for(let $t=0;$t<qt.length;$t++)en.sectionIndex.push(0);et.push(en)}}else if(Ke){et=[];const pt=Ke(ze.text,ze.sectionIndex,Av(ze,re,z,u,T,me,_e));for(const qt of pt){const en=new mf;en.text=qt[0],en.sectionIndex=qt[1],en.sections=ze.sections,et.push(en)}}else et=function(pt,qt){const en=[],$t=pt.text;let Nt=0;for(const zt of qt)en.push(pt.substring(Nt,zt)),Nt=zt;return Nt<$t.length&&en.push(pt.substring(Nt,$t.length)),en}(ze,Av(ze,re,z,u,T,me,_e));const st=[],gt={positionedLines:st,text:ze.toString(),top:Ae[1],bottom:Ae[1],left:Ae[0],right:Ae[0],writingMode:ce,iconsInText:!1,verticalizable:!1};return function(pt,qt,en,$t,Nt,zt,Ht,Gt,Tt,pn,an,jn){let Rr=0,Nr=Am,Pi=0,da=0;const os=Gt==="right"?1:Gt==="left"?0:.5;let mi=0;for(const yi of Nt){yi.trim();const ls=yi.getMaxScale(),_s=(ls-1)*Hi,Vs={positionedGlyphs:[],lineOffset:0};pt.positionedLines[mi]=Vs;const go=Vs.positionedGlyphs;let mo=0;if(!yi.length()){Nr+=zt,++mi;continue}for(let Ui=0;Ui<yi.length();Ui++){const Xn=yi.getSection(Ui),Vo=yi.getSectionIndex(Ui),As=yi.getCharCode(Ui);let vs=0,Wa=null,Pl=null,Il=null,Au=Hi;const Qa=!(Tt===a.WritingMode.horizontal||!an&&!Ga(As)||an&&(cm[As]||(Ni=As,Ut.Arabic(Ni)||Ut["Arabic Supplement"](Ni)||Ut["Arabic Extended-A"](Ni)||Ut["Arabic Presentation Forms-A"](Ni)||Ut["Arabic Presentation Forms-B"](Ni))));if(Xn.imageName){const pa=$t[Xn.imageName];if(!pa)continue;Il=Xn.imageName,pt.iconsInText=pt.iconsInText||!0,Pl=pa.paddedRect;const yo=pa.displaySize;Xn.scale=Xn.scale*Hi/jn,Wa={width:yo[0],height:yo[1],left:1,top:-3,advance:Qa?yo[1]:yo[0]},vs=_s+(Hi-yo[1]*Xn.scale),Au=Wa.advance;const uu=Qa?yo[0]*Xn.scale-Hi*ls:yo[1]*Xn.scale-Hi*ls;uu>0&&uu>mo&&(mo=uu)}else{const pa=en[Xn.fontStack],yo=pa&&pa[As];if(yo&&yo.rect)Pl=yo.rect,Wa=yo.metrics;else{const uu=qt[Xn.fontStack],wd=uu&&uu[As];if(!wd)continue;Wa=wd.metrics}vs=(ls-Xn.scale)*Hi}Qa?(pt.verticalizable=!0,go.push({glyph:As,imageName:Il,x:Rr,y:Nr+vs,vertical:Qa,scale:Xn.scale,fontStack:Xn.fontStack,sectionIndex:Vo,metrics:Wa,rect:Pl}),Rr+=Au*Xn.scale+pn):(go.push({glyph:As,imageName:Il,x:Rr,y:Nr+vs,vertical:Qa,scale:Xn.scale,fontStack:Xn.fontStack,sectionIndex:Vo,metrics:Wa,rect:Pl}),Rr+=Wa.advance*Xn.scale+pn)}go.length!==0&&(Pi=Math.max(Rr-pn,Pi),N7(go,0,go.length-1,os,mo)),Rr=0;const Hr=zt*ls+mo;Vs.lineOffset=Math.max(mo,_s),Nr+=Hr,da=Math.max(Hr,da),++mi}var Ni;const as=Nr-Am,{horizontalAlign:ys,verticalAlign:po}=uv(Ht);(function(yi,ls,_s,Vs,go,mo,Hr,Ui,Xn){const Vo=(ls-_s)*go;let As=0;As=mo!==Hr?-Ui*Vs-Am:(-Vs*Xn+.5)*Hr;for(const vs of yi)for(const Wa of vs.positionedGlyphs)Wa.x+=Vo,Wa.y+=As})(pt.positionedLines,os,ys,po,Pi,da,zt,as,Nt.length),pt.top+=-po*as,pt.bottom=pt.top+as,pt.left+=-ys*Pi,pt.right=pt.left+Pi}(gt,u,p,T,et,F,j,Z,ce,re,pe,Ue),!function(pt){for(const qt of pt)if(qt.positionedGlyphs.length!==0)return!1;return!0}(st)&&gt}const cm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},O7={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function u4(f,u,p,T,D,z){if(u.imageName){const F=T[u.imageName];return F?F.displaySize[0]*u.scale*Hi/z+D:0}{const F=p[u.fontStack],j=F&&F[f];return j?j.metrics.advance*u.scale+D:0}}function c4(f,u,p,T){const D=Math.pow(f-u,2);return T?f<u?D/2:2*D:D+Math.abs(p)*p}function F7(f,u,p){let T=0;return f===10&&(T-=1e4),p&&(T+=150),f!==40&&f!==65288||(T+=50),u!==41&&u!==65289||(T+=50),T}function h4(f,u,p,T,D,z){let F=null,j=c4(u,p,D,z);for(const Z of T){const re=c4(u-Z.x,p,D,z)+Z.badness;re<=j&&(F=Z,j=re)}return{index:f,x:u,priorBreak:F,badness:j}}function f4(f){return f?f4(f.priorBreak).concat(f.index):[]}function Av(f,u,p,T,D,z,F){if(z!=="point")return[];if(!f)return[];const j=[],Z=function(pe,me,_e,Ue,ze,et){let lt=0;for(let Ke=0;Ke<pe.length();Ke++){const st=pe.getSection(Ke);lt+=u4(pe.getCharCode(Ke),st,Ue,ze,me,et)}return lt/Math.max(1,Math.ceil(lt/_e))}(f,u,p,T,D,F),re=f.text.indexOf("")>=0;let Ae=0;for(let pe=0;pe<f.length();pe++){const me=f.getSection(pe),_e=f.getCharCode(pe);if(cm[_e]||(Ae+=u4(_e,me,T,D,u,F)),pe<f.length()-1){const Ue=!((ce=_e)<11904||!(Ut["Bopomofo Extended"](ce)||Ut.Bopomofo(ce)||Ut["CJK Compatibility Forms"](ce)||Ut["CJK Compatibility Ideographs"](ce)||Ut["CJK Compatibility"](ce)||Ut["CJK Radicals Supplement"](ce)||Ut["CJK Strokes"](ce)||Ut["CJK Symbols and Punctuation"](ce)||Ut["CJK Unified Ideographs Extension A"](ce)||Ut["CJK Unified Ideographs"](ce)||Ut["Enclosed CJK Letters and Months"](ce)||Ut["Halfwidth and Fullwidth Forms"](ce)||Ut.Hiragana(ce)||Ut["Ideographic Description Characters"](ce)||Ut["Kangxi Radicals"](ce)||Ut["Katakana Phonetic Extensions"](ce)||Ut.Katakana(ce)||Ut["Vertical Forms"](ce)||Ut["Yi Radicals"](ce)||Ut["Yi Syllables"](ce)));(O7[_e]||Ue||me.imageName)&&j.push(h4(pe+1,Ae,Z,j,F7(_e,f.getCharCode(pe+1),Ue&&re),!1))}}var ce;return f4(h4(f.length(),Ae,Z,j,0,!0))}function uv(f){let u=.5,p=.5;switch(f){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":p=1;break;case"top":case"top-right":case"top-left":p=0}return{horizontalAlign:u,verticalAlign:p}}function N7(f,u,p,T,D){if(!T&&!D)return;const z=f[p],F=(f[p].x+z.metrics.advance*z.scale)*T;for(let j=u;j<=p;j++)f[j].x-=F,f[j].y+=D}function U7(f,u,p){const{horizontalAlign:T,verticalAlign:D}=uv(p),z=u[0]-f.displaySize[0]*T,F=u[1]-f.displaySize[1]*D;return{image:f,top:F,bottom:F+f.displaySize[1],left:z,right:z+f.displaySize[0]}}function d4(f,u,p,T,D,z){const F=f.image;let j;if(F.content){const ze=F.content,et=F.pixelRatio||1;j=[ze[0]/et,ze[1]/et,F.displaySize[0]-ze[2]/et,F.displaySize[1]-ze[3]/et]}const Z=u.left*z,re=u.right*z;let Ae,ce,pe,me;p==="width"||p==="both"?(me=D[0]+Z-T[3],ce=D[0]+re+T[1]):(me=D[0]+(Z+re-F.displaySize[0])/2,ce=me+F.displaySize[0]);const _e=u.top*z,Ue=u.bottom*z;return p==="height"||p==="both"?(Ae=D[1]+_e-T[0],pe=D[1]+Ue+T[2]):(Ae=D[1]+(_e+Ue-F.displaySize[1])/2,pe=Ae+F.displaySize[1]),{image:F,top:Ae,right:ce,bottom:pe,left:me,collisionPadding:j}}const lu=128;function p4(f,u){const{expression:p}=u;if(p.kind==="constant")return{kind:"constant",layoutSize:p.evaluate(new wr(f+1))};if(p.kind==="source")return{kind:"source"};{const{zoomStops:T,interpolationType:D}=p;let z=0;for(;z<T.length&&T[z]<=f;)z++;z=Math.max(0,z-1);let F=z;for(;F<T.length&&T[F]<f+1;)F++;F=Math.min(T.length-1,F);const j=T[z],Z=T[F];return p.kind==="composite"?{kind:"composite",minZoom:j,maxZoom:Z,interpolationType:D}:{kind:"camera",minZoom:j,maxZoom:Z,minSize:p.evaluate(new wr(j)),maxSize:p.evaluate(new wr(Z)),interpolationType:D}}}class Ac extends Et{constructor(u,p,T,D){super(u,p),this.angle=T,D!==void 0&&(this.segment=D)}clone(){return new Ac(this.x,this.y,this.angle,this.segment)}}function g4(f,u,p,T,D){if(u.segment===void 0)return!0;let z=u,F=u.segment+1,j=0;for(;j>-p/2;){if(F--,F<0)return!1;j-=f[F].dist(z),z=f[F]}j+=f[F].dist(f[F+1]),F++;const Z=[];let re=0;for(;j<p/2;){const Ae=f[F],ce=f[F+1];if(!ce)return!1;let pe=f[F-1].angleTo(Ae)-Ae.angleTo(ce);for(pe=Math.abs((pe+3*Math.PI)%(2*Math.PI)-Math.PI),Z.push({distance:j,angleDelta:pe}),re+=pe;j-Z[0].distance>T;)re-=Z.shift().angleDelta;if(re>D)return!1;F++,j+=Ae.dist(ce)}return!0}function m4(f){let u=0;for(let p=0;p<f.length-1;p++)u+=f[p].dist(f[p+1]);return u}function y4(f,u,p){return f?.6*u*p:0}function _4(f,u){return Math.max(f?f.right-f.left:0,u?u.right-u.left:0)}function V7(f,u,p,T,D,z){const F=y4(p,D,z),j=_4(p,T)*z;let Z=0;const re=m4(f)/2;for(let Ae=0;Ae<f.length-1;Ae++){const ce=f[Ae],pe=f[Ae+1],me=ce.dist(pe);if(Z+me>re){const _e=(re-Z)/me,Ue=Jt(ce.x,pe.x,_e),ze=Jt(ce.y,pe.y,_e),et=new Ac(Ue,ze,pe.angleTo(ce),Ae);return et._round(),!F||g4(f,et,j,F,u)?et:void 0}Z+=me}}function G7(f,u,p,T,D,z,F,j,Z){const re=y4(T,z,F),Ae=_4(T,D),ce=Ae*F,pe=f[0].x===0||f[0].x===Z||f[0].y===0||f[0].y===Z;return u-ce<u/4&&(u=ce+u/4),v4(f,pe?u/2*j%u:(Ae/2+2*z)*F*j%u,u,re,p,ce,pe,!1,Z)}function v4(f,u,p,T,D,z,F,j,Z){const re=z/2,Ae=m4(f);let ce=0,pe=u-p,me=[];for(let _e=0;_e<f.length-1;_e++){const Ue=f[_e],ze=f[_e+1],et=Ue.dist(ze),lt=ze.angleTo(Ue);for(;pe+p<ce+et;){pe+=p;const Ke=(pe-ce)/et,st=Jt(Ue.x,ze.x,Ke),gt=Jt(Ue.y,ze.y,Ke);if(st>=0&&st<Z&&gt>=0&&gt<Z&&pe-re>=0&&pe+re<=Ae){const pt=new Ac(st,gt,lt,_e);pt._round(),T&&!g4(f,pt,z,T,D)||me.push(pt)}}ce+=et}return j||me.length||F||(me=v4(f,ce/2,p,T,D,z,F,!0,Z)),me}function x4(f,u,p,T,D){const z=[];for(let F=0;F<f.length;F++){const j=f[F];let Z;for(let re=0;re<j.length-1;re++){let Ae=j[re],ce=j[re+1];Ae.x<u&&ce.x<u||(Ae.x<u?Ae=new Et(u,Ae.y+(u-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round():ce.x<u&&(ce=new Et(u,Ae.y+(u-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round()),Ae.y<p&&ce.y<p||(Ae.y<p?Ae=new Et(Ae.x+(p-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),p)._round():ce.y<p&&(ce=new Et(Ae.x+(p-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),p)._round()),Ae.x>=T&&ce.x>=T||(Ae.x>=T?Ae=new Et(T,Ae.y+(T-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round():ce.x>=T&&(ce=new Et(T,Ae.y+(T-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round()),Ae.y>=D&&ce.y>=D||(Ae.y>=D?Ae=new Et(Ae.x+(D-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),D)._round():ce.y>=D&&(ce=new Et(Ae.x+(D-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),D)._round()),Z&&Ae.equals(Z[Z.length-1])||(Z=[Ae],z.push(Z)),Z.push(ce)))))}}return z}function w4(f,u,p,T){const D=[],z=f.image,F=z.pixelRatio,j=z.paddedRect.w-2,Z=z.paddedRect.h-2,re=f.right-f.left,Ae=f.bottom-f.top,ce=z.stretchX||[[0,j]],pe=z.stretchY||[[0,Z]],me=(zt,Ht)=>zt+Ht[1]-Ht[0],_e=ce.reduce(me,0),Ue=pe.reduce(me,0),ze=j-_e,et=Z-Ue;let lt=0,Ke=_e,st=0,gt=Ue,pt=0,qt=ze,en=0,$t=et;if(z.content&&T){const zt=z.content;lt=hm(ce,0,zt[0]),st=hm(pe,0,zt[1]),Ke=hm(ce,zt[0],zt[2]),gt=hm(pe,zt[1],zt[3]),pt=zt[0]-lt,en=zt[1]-st,qt=zt[2]-zt[0]-Ke,$t=zt[3]-zt[1]-gt}const Nt=(zt,Ht,Gt,Tt)=>{const pn=fm(zt.stretch-lt,Ke,re,f.left),an=dm(zt.fixed-pt,qt,zt.stretch,_e),jn=fm(Ht.stretch-st,gt,Ae,f.top),Rr=dm(Ht.fixed-en,$t,Ht.stretch,Ue),Nr=fm(Gt.stretch-lt,Ke,re,f.left),Pi=dm(Gt.fixed-pt,qt,Gt.stretch,_e),da=fm(Tt.stretch-st,gt,Ae,f.top),os=dm(Tt.fixed-en,$t,Tt.stretch,Ue),mi=new Et(pn,jn),Ni=new Et(Nr,jn),as=new Et(Nr,da),ys=new Et(pn,da),po=new Et(an/F,Rr/F),yi=new Et(Pi/F,os/F),ls=u*Math.PI/180;if(ls){const go=Math.sin(ls),mo=Math.cos(ls),Hr=[mo,-go,go,mo];mi._matMult(Hr),Ni._matMult(Hr),ys._matMult(Hr),as._matMult(Hr)}const _s=zt.stretch+zt.fixed,Vs=Ht.stretch+Ht.fixed;return{tl:mi,tr:Ni,bl:ys,br:as,tex:{x:z.paddedRect.x+1+_s,y:z.paddedRect.y+1+Vs,w:Gt.stretch+Gt.fixed-_s,h:Tt.stretch+Tt.fixed-Vs},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:po,pixelOffsetBR:yi,minFontScaleX:qt/F/re,minFontScaleY:$t/F/Ae,isSDF:p}};if(T&&(z.stretchX||z.stretchY)){const zt=b4(ce,ze,_e),Ht=b4(pe,et,Ue);for(let Gt=0;Gt<zt.length-1;Gt++){const Tt=zt[Gt],pn=zt[Gt+1];for(let an=0;an<Ht.length-1;an++)D.push(Nt(Tt,Ht[an],pn,Ht[an+1]))}}else D.push(Nt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:j+1},{fixed:0,stretch:Z+1}));return D}function hm(f,u,p){let T=0;for(const D of f)T+=Math.max(u,Math.min(p,D[1]))-Math.max(u,Math.min(p,D[0]));return T}function b4(f,u,p){const T=[{fixed:-1,stretch:0}];for(const[D,z]of f){const F=T[T.length-1];T.push({fixed:D-F.stretch,stretch:F.stretch}),T.push({fixed:D-F.stretch,stretch:F.stretch+(z-D)})}return T.push({fixed:u+1,stretch:p}),T}function fm(f,u,p,T){return f/u*p+T}function dm(f,u,p,T){return f-u*p/T}Ft("Anchor",Ac);class pm{constructor(u,p,T,D,z,F,j,Z,re,Ae){if(this.boxStartIndex=u.length,re){let ce=F.top,pe=F.bottom;const me=F.collisionPadding;me&&(ce-=me[1],pe+=me[3]);let _e=pe-ce;_e>0&&(_e=Math.max(10,_e),this.circleDiameter=_e)}else{let ce=F.top*j-Z[0],pe=F.bottom*j+Z[2],me=F.left*j-Z[3],_e=F.right*j+Z[1];const Ue=F.collisionPadding;if(Ue&&(me-=Ue[0]*j,ce-=Ue[1]*j,_e+=Ue[2]*j,pe+=Ue[3]*j),Ae){const ze=new Et(me,ce),et=new Et(_e,ce),lt=new Et(me,pe),Ke=new Et(_e,pe),st=Ae*Math.PI/180;ze._rotate(st),et._rotate(st),lt._rotate(st),Ke._rotate(st),me=Math.min(ze.x,et.x,lt.x,Ke.x),_e=Math.max(ze.x,et.x,lt.x,Ke.x),ce=Math.min(ze.y,et.y,lt.y,Ke.y),pe=Math.max(ze.y,et.y,lt.y,Ke.y)}u.emplaceBack(p.x,p.y,me,ce,_e,pe,T,D,z)}this.boxEndIndex=u.length}}class j7{constructor(u=[],p=$7){if(this.data=u,this.length=this.data.length,this.compare=p,this.length>0)for(let T=(this.length>>1)-1;T>=0;T--)this._down(T)}push(u){this.data.push(u),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const u=this.data[0],p=this.data.pop();return this.length--,this.length>0&&(this.data[0]=p,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:p,compare:T}=this,D=p[u];for(;u>0;){const z=u-1>>1,F=p[z];if(T(D,F)>=0)break;p[u]=F,u=z}p[u]=D}_down(u){const{data:p,compare:T}=this,D=this.length>>1,z=p[u];for(;u<D;){let F=1+(u<<1),j=p[F];const Z=F+1;if(Z<this.length&&T(p[Z],j)<0&&(F=Z,j=p[Z]),T(j,z)>=0)break;p[u]=j,u=F}p[u]=z}}function $7(f,u){return f<u?-1:f>u?1:0}function H7(f,u=1,p=!1){let T=1/0,D=1/0,z=-1/0,F=-1/0;const j=f[0];for(let me=0;me<j.length;me++){const _e=j[me];(!me||_e.x<T)&&(T=_e.x),(!me||_e.y<D)&&(D=_e.y),(!me||_e.x>z)&&(z=_e.x),(!me||_e.y>F)&&(F=_e.y)}const Z=Math.min(z-T,F-D);let re=Z/2;const Ae=new j7([],W7);if(Z===0)return new Et(T,D);for(let me=T;me<z;me+=Z)for(let _e=D;_e<F;_e+=Z)Ae.push(new yf(me+re,_e+re,re,f));let ce=function(me){let _e=0,Ue=0,ze=0;const et=me[0];for(let lt=0,Ke=et.length,st=Ke-1;lt<Ke;st=lt++){const gt=et[lt],pt=et[st],qt=gt.x*pt.y-pt.x*gt.y;Ue+=(gt.x+pt.x)*qt,ze+=(gt.y+pt.y)*qt,_e+=3*qt}return new yf(Ue/_e,ze/_e,0,me)}(f),pe=Ae.length;for(;Ae.length;){const me=Ae.pop();(me.d>ce.d||!ce.d)&&(ce=me,p&&console.log("found best %d after %d probes",Math.round(1e4*me.d)/1e4,pe)),me.max-ce.d<=u||(re=me.h/2,Ae.push(new yf(me.p.x-re,me.p.y-re,re,f)),Ae.push(new yf(me.p.x+re,me.p.y-re,re,f)),Ae.push(new yf(me.p.x-re,me.p.y+re,re,f)),Ae.push(new yf(me.p.x+re,me.p.y+re,re,f)),pe+=4)}return p&&(console.log(`num probes: ${pe}`),console.log(`best distance: ${ce.d}`)),ce.p}function W7(f,u){return u.max-f.max}function yf(f,u,p,T){this.p=new Et(f,u),this.h=p,this.d=function(D,z){let F=!1,j=1/0;for(let Z=0;Z<z.length;Z++){const re=z[Z];for(let Ae=0,ce=re.length,pe=ce-1;Ae<ce;pe=Ae++){const me=re[Ae],_e=re[pe];me.y>D.y!=_e.y>D.y&&D.x<(_e.x-me.x)*(D.y-me.y)/(_e.y-me.y)+me.x&&(F=!F),j=Math.min(j,kS(D,me,_e))}}return(F?1:-1)*Math.sqrt(j)}(this.p,T),this.max=this.d+this.h*Math.SQRT2}const cv=Number.POSITIVE_INFINITY;function E4(f,u){return u[1]!==cv?function(p,T,D){let z=0,F=0;switch(T=Math.abs(T),D=Math.abs(D),p){case"top-right":case"top-left":case"top":F=D-7;break;case"bottom-right":case"bottom-left":case"bottom":F=7-D}switch(p){case"top-right":case"bottom-right":case"right":z=-T;break;case"top-left":case"bottom-left":case"left":z=T}return[z,F]}(f,u[0],u[1]):function(p,T){let D=0,z=0;T<0&&(T=0);const F=T/Math.sqrt(2);switch(p){case"top-right":case"top-left":z=F-7;break;case"bottom-right":case"bottom-left":z=7-F;break;case"bottom":z=7-T;break;case"top":z=T-7}switch(p){case"top-right":case"bottom-right":D=-F;break;case"top-left":case"bottom-left":D=F;break;case"left":D=T;break;case"right":D=-T}return[D,z]}(f,u[0])}function hv(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Q7(f,u,p,T,D,z,F,j,Z,re,Ae){let ce=z.textMaxSize.evaluate(u,{});ce===void 0&&(ce=F);const pe=f.layers[0].layout,me=pe.get("icon-offset").evaluate(u,{},Ae),_e=S4(p.horizontal),Ue=F/24,ze=f.tilePixelRatio*Ue,et=f.tilePixelRatio*ce/24,lt=f.tilePixelRatio*j,Ke=f.tilePixelRatio*pe.get("symbol-spacing"),st=pe.get("text-padding")*f.tilePixelRatio,gt=function(Tt,pn,an,jn=1){const Rr=Tt.get("icon-padding").evaluate(pn,{},an),Nr=Rr&&Rr.values;return[Nr[0]*jn,Nr[1]*jn,Nr[2]*jn,Nr[3]*jn]}(pe,u,Ae,f.tilePixelRatio),pt=pe.get("text-max-angle")/180*Math.PI,qt=pe.get("text-rotation-alignment")!=="viewport"&&pe.get("symbol-placement")!=="point",en=pe.get("icon-rotation-alignment")==="map"&&pe.get("symbol-placement")!=="point",$t=pe.get("symbol-placement"),Nt=Ke/2,zt=pe.get("icon-text-fit");let Ht;T&&zt!=="none"&&(f.allowVerticalPlacement&&p.vertical&&(Ht=d4(T,p.vertical,zt,pe.get("icon-text-fit-padding"),me,Ue)),_e&&(T=d4(T,_e,zt,pe.get("icon-text-fit-padding"),me,Ue)));const Gt=(Tt,pn)=>{pn.x<0||pn.x>=Ci||pn.y<0||pn.y>=Ci||function(an,jn,Rr,Nr,Pi,da,os,mi,Ni,as,ys,po,yi,ls,_s,Vs,go,mo,Hr,Ui,Xn,Vo,As,vs,Wa){const Pl=an.addToLineVertexArray(jn,Rr);let Il,Au,Qa,pa,yo=0,uu=0,wd=0,G4=0,wv=-1,bv=-1;const cu={};let j4=xn.exports(""),Ev=0,Tv=0;if(mi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Ev,Tv]=mi.layout.get("text-offset").evaluate(Xn,{},vs).map(_o=>_o*Hi):(Ev=mi.layout.get("text-radial-offset").evaluate(Xn,{},vs)*Hi,Tv=cv),an.allowVerticalPlacement&&Nr.vertical){const _o=mi.layout.get("text-rotate").evaluate(Xn,{},vs)+90;Qa=new pm(Ni,jn,as,ys,po,Nr.vertical,yi,ls,_s,_o),os&&(pa=new pm(Ni,jn,as,ys,po,os,go,mo,_s,_o))}if(Pi){const _o=mi.layout.get("icon-rotate").evaluate(Xn,{}),dA=mi.layout.get("icon-text-fit")!=="none",bd=w4(Pi,_o,As,dA),Ed=os?w4(os,_o,As,dA):void 0;Au=new pm(Ni,jn,as,ys,po,Pi,go,mo,!1,_o),yo=4*bd.length;const W4=an.iconSizeData;let ah=null;W4.kind==="source"?(ah=[lu*mi.layout.get("icon-size").evaluate(Xn,{})],ah[0]>uc&&ye(`${an.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):W4.kind==="composite"&&(ah=[lu*Vo.compositeIconSizes[0].evaluate(Xn,{},vs),lu*Vo.compositeIconSizes[1].evaluate(Xn,{},vs)],(ah[0]>uc||ah[1]>uc)&&ye(`${an.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),an.addSymbols(an.icon,bd,ah,Ui,Hr,Xn,a.WritingMode.none,jn,Pl.lineStartIndex,Pl.lineLength,-1,vs),wv=an.icon.placedSymbolArray.length-1,Ed&&(uu=4*Ed.length,an.addSymbols(an.icon,Ed,ah,Ui,Hr,Xn,a.WritingMode.vertical,jn,Pl.lineStartIndex,Pl.lineLength,-1,vs),bv=an.icon.placedSymbolArray.length-1)}const $4=Object.keys(Nr.horizontal);for(const _o of $4){const dA=Nr.horizontal[_o];if(!Il){j4=xn.exports(dA.text);const Ed=mi.layout.get("text-rotate").evaluate(Xn,{},vs);Il=new pm(Ni,jn,as,ys,po,dA,yi,ls,_s,Ed)}const bd=dA.positionedLines.length===1;if(wd+=T4(an,jn,dA,da,mi,_s,Xn,Vs,Pl,Nr.vertical?a.WritingMode.horizontal:a.WritingMode.horizontalOnly,bd?$4:[_o],cu,wv,Vo,vs),bd)break}Nr.vertical&&(G4+=T4(an,jn,Nr.vertical,da,mi,_s,Xn,Vs,Pl,a.WritingMode.vertical,["vertical"],cu,bv,Vo,vs));const oN=Il?Il.boxStartIndex:an.collisionBoxArray.length,aN=Il?Il.boxEndIndex:an.collisionBoxArray.length,lN=Qa?Qa.boxStartIndex:an.collisionBoxArray.length,AN=Qa?Qa.boxEndIndex:an.collisionBoxArray.length,uN=Au?Au.boxStartIndex:an.collisionBoxArray.length,cN=Au?Au.boxEndIndex:an.collisionBoxArray.length,hN=pa?pa.boxStartIndex:an.collisionBoxArray.length,fN=pa?pa.boxEndIndex:an.collisionBoxArray.length;let kl=-1;const vm=(_o,dA)=>_o&&_o.circleDiameter?Math.max(_o.circleDiameter,dA):dA;kl=vm(Il,kl),kl=vm(Qa,kl),kl=vm(Au,kl),kl=vm(pa,kl);const H4=kl>-1?1:0;H4&&(kl*=Wa/Hi),an.glyphOffsetArray.length>=_f.MAX_GLYPHS&&ye("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Xn.sortKey!==void 0&&an.addToSortKeyRanges(an.symbolInstances.length,Xn.sortKey),an.symbolInstances.emplaceBack(jn.x,jn.y,cu.right>=0?cu.right:-1,cu.center>=0?cu.center:-1,cu.left>=0?cu.left:-1,cu.vertical||-1,wv,bv,j4,oN,aN,lN,AN,uN,cN,hN,fN,as,wd,G4,yo,uu,H4,0,yi,Ev,Tv,kl)}(f,pn,Tt,p,T,D,Ht,f.layers[0],f.collisionBoxArray,u.index,u.sourceLayerIndex,f.index,ze,[st,st,st,st],qt,Z,lt,gt,en,me,u,z,re,Ae,F)};if($t==="line")for(const Tt of x4(u.geometry,0,0,Ci,Ci)){const pn=G7(Tt,Ke,pt,p.vertical||_e,T,24,et,f.overscaling,Ci);for(const an of pn){const jn=_e;jn&&q7(f,jn.text,Nt,an)||Gt(Tt,an)}}else if($t==="line-center"){for(const Tt of u.geometry)if(Tt.length>1){const pn=V7(Tt,pt,p.vertical||_e,T,24,et);pn&&Gt(Tt,pn)}}else if(u.type==="Polygon")for(const Tt of J2(u.geometry,0)){const pn=H7(Tt,16);Gt(Tt[0],new Ac(pn.x,pn.y,0))}else if(u.type==="LineString")for(const Tt of u.geometry)Gt(Tt,new Ac(Tt[0].x,Tt[0].y,0));else if(u.type==="Point")for(const Tt of u.geometry)for(const pn of Tt)Gt([pn],new Ac(pn.x,pn.y,0))}const uc=32640;function T4(f,u,p,T,D,z,F,j,Z,re,Ae,ce,pe,me,_e){const Ue=function(lt,Ke,st,gt,pt,qt,en,$t){const Nt=gt.layout.get("text-rotate").evaluate(qt,{})*Math.PI/180,zt=[];for(const Ht of Ke.positionedLines)for(const Gt of Ht.positionedGlyphs){if(!Gt.rect)continue;const Tt=Gt.rect||{};let pn=4,an=!0,jn=1,Rr=0;const Nr=(pt||$t)&&Gt.vertical,Pi=Gt.metrics.advance*Gt.scale/2;if($t&&Ke.verticalizable){const Hr=(Gt.scale-1)*Hi,Ui=(Hi-Gt.metrics.width*Gt.scale)/2;Rr=Ht.lineOffset/2-(Gt.imageName?-Ui:Hr)}if(Gt.imageName){const Hr=en[Gt.imageName];an=Hr.sdf,jn=Hr.pixelRatio,pn=1/jn}const da=pt?[Gt.x+Pi,Gt.y]:[0,0];let os=pt?[0,0]:[Gt.x+Pi+st[0],Gt.y+st[1]-Rr],mi=[0,0];Nr&&(mi=os,os=[0,0]);const Ni=(Gt.metrics.left-pn)*Gt.scale-Pi+os[0],as=(-Gt.metrics.top-pn)*Gt.scale+os[1],ys=Ni+Tt.w*Gt.scale/jn,po=as+Tt.h*Gt.scale/jn,yi=new Et(Ni,as),ls=new Et(ys,as),_s=new Et(Ni,po),Vs=new Et(ys,po);if(Nr){const Hr=new Et(-Pi,Pi-Am),Ui=-Math.PI/2,Xn=12-Pi,Vo=new Et(22-Xn,-(Gt.imageName?Xn:0)),As=new Et(...mi);yi._rotateAround(Ui,Hr)._add(Vo)._add(As),ls._rotateAround(Ui,Hr)._add(Vo)._add(As),_s._rotateAround(Ui,Hr)._add(Vo)._add(As),Vs._rotateAround(Ui,Hr)._add(Vo)._add(As)}if(Nt){const Hr=Math.sin(Nt),Ui=Math.cos(Nt),Xn=[Ui,-Hr,Hr,Ui];yi._matMult(Xn),ls._matMult(Xn),_s._matMult(Xn),Vs._matMult(Xn)}const go=new Et(0,0),mo=new Et(0,0);zt.push({tl:yi,tr:ls,bl:_s,br:Vs,tex:Tt,writingMode:Ke.writingMode,glyphOffset:da,sectionIndex:Gt.sectionIndex,isSDF:an,pixelOffsetTL:go,pixelOffsetBR:mo,minFontScaleX:0,minFontScaleY:0})}return zt}(0,p,j,D,z,F,T,f.allowVerticalPlacement),ze=f.textSizeData;let et=null;ze.kind==="source"?(et=[lu*D.layout.get("text-size").evaluate(F,{})],et[0]>uc&&ye(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ze.kind==="composite"&&(et=[lu*me.compositeTextSizes[0].evaluate(F,{},_e),lu*me.compositeTextSizes[1].evaluate(F,{},_e)],(et[0]>uc||et[1]>uc)&&ye(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),f.addSymbols(f.text,Ue,et,j,z,F,re,u,Z.lineStartIndex,Z.lineLength,pe,_e);for(const lt of Ae)ce[lt]=f.text.placedSymbolArray.length-1;return 4*Ue.length}function S4(f){for(const u in f)return f[u];return null}function q7(f,u,p,T){const D=f.compareText;if(u in D){const z=D[u];for(let F=z.length-1;F>=0;F--)if(T.dist(z[F])<p)return!0}else D[u]=[];return D[u].push(T),!1}const Z7=ac.VectorTileFeature.types,Y7=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function gm(f,u,p,T,D,z,F,j,Z,re,Ae,ce,pe){const me=j?Math.min(uc,Math.round(j[0])):0,_e=j?Math.min(uc,Math.round(j[1])):0;f.emplaceBack(u,p,Math.round(32*T),Math.round(32*D),z,F,(me<<1)+(Z?1:0),_e,16*re,16*Ae,256*ce,256*pe)}function fv(f,u,p){f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p)}function X7(f){for(const u of f.sections)if(nc(u.text))return!0;return!1}class dv{constructor(u){this.layoutVertexArray=new Be,this.indexArray=new it,this.programConfigurations=u,this.segments=new dt,this.dynamicLayoutVertexArray=new Ye,this.opacityVertexArray=new ht,this.placedSymbolArray=new m}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(u,p,T,D){this.isEmpty()||(T&&(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,v7.members),this.indexBuffer=u.createIndexBuffer(this.indexArray,p),this.dynamicLayoutVertexBuffer=u.createVertexBuffer(this.dynamicLayoutVertexArray,x7.members,!0),this.opacityVertexBuffer=u.createVertexBuffer(this.opacityVertexArray,Y7,!0),this.opacityVertexBuffer.itemSize=1),(T||D)&&this.programConfigurations.upload(u))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ft("SymbolBuffers",dv);class pv{constructor(u,p,T){this.layoutVertexArray=new u,this.layoutAttributes=p,this.indexArray=new T,this.segments=new dt,this.collisionVertexArray=new rt}upload(u){this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=u.createVertexBuffer(this.collisionVertexArray,w7.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ft("CollisionBuffers",pv);class _f{constructor(u){this.collisionBoxArray=u.collisionBoxArray,this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(F=>F.id),this.index=u.index,this.pixelRatio=u.pixelRatio,this.sourceLayerIndex=u.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Q2([]),this.placementViewportMatrix=Q2([]);const p=this.layers[0]._unevaluatedLayout._values;this.textSizeData=p4(this.zoom,p["text-size"]),this.iconSizeData=p4(this.zoom,p["icon-size"]);const T=this.layers[0].layout,D=T.get("symbol-sort-key"),z=T.get("symbol-z-order");this.canOverlap=mv(T,"text-overlap","text-allow-overlap")!=="never"||mv(T,"icon-overlap","icon-allow-overlap")!=="never"||T.get("text-ignore-placement")||T.get("icon-ignore-placement"),this.sortFeaturesByKey=z!=="viewport-y"&&!D.isConstant(),this.sortFeaturesByY=(z==="viewport-y"||z==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,T.get("symbol-placement")==="point"&&(this.writingModes=T.get("text-writing-mode").map(F=>a.WritingMode[F])),this.stateDependentLayerIds=this.layers.filter(F=>F.isStateDependent()).map(F=>F.id),this.sourceID=u.sourceID}createArrays(){this.text=new dv(new nh(this.layers,this.zoom,u=>/^text/.test(u))),this.icon=new dv(new nh(this.layers,this.zoom,u=>/^icon/.test(u))),this.glyphOffsetArray=new E,this.lineVertexArray=new C,this.symbolInstances=new v}calculateGlyphDependencies(u,p,T,D,z){for(let F=0;F<u.length;F++)if(p[u.charCodeAt(F)]=!0,(T||D)&&z){const j=yd[u.charAt(F)];j&&(p[j.charCodeAt(0)]=!0)}}populate(u,p,T){const D=this.layers[0],z=D.layout,F=z.get("text-font"),j=z.get("text-field"),Z=z.get("icon-image"),re=(j.value.kind!=="constant"||j.value.value instanceof Ie&&!j.value.value.isEmpty()||j.value.value.toString().length>0)&&(F.value.kind!=="constant"||F.value.value.length>0),Ae=Z.value.kind!=="constant"||!!Z.value.value||Object.keys(Z.parameters).length>0,ce=z.get("symbol-sort-key");if(this.features=[],!re&&!Ae)return;const pe=p.iconDependencies,me=p.glyphDependencies,_e=p.availableImages,Ue=new wr(this.zoom);for(const{feature:ze,id:et,index:lt,sourceLayerIndex:Ke}of u){const st=D._featureFilter.needGeometry,gt=ih(ze,st);if(!D._featureFilter.filter(Ue,gt,T))continue;let pt,qt;if(st||(gt.geometry=rh(ze)),re){const $t=D.getValueAndResolveTokens("text-field",gt,T,_e),Nt=Ie.factory($t);X7(Nt)&&(this.hasRTLText=!0),(!this.hasRTLText||Tl()==="unavailable"||this.hasRTLText&&ss.isParsed())&&(pt=E7(Nt,D,gt))}if(Ae){const $t=D.getValueAndResolveTokens("icon-image",gt,T,_e);qt=$t instanceof ke?$t:ke.fromString($t)}if(!pt&&!qt)continue;const en=this.sortFeaturesByKey?ce.evaluate(gt,{},T):void 0;if(this.features.push({id:et,text:pt,icon:qt,index:lt,sourceLayerIndex:Ke,geometry:gt.geometry,properties:ze.properties,type:Z7[ze.type],sortKey:en}),qt&&(pe[qt.name]=!0),pt){const $t=F.evaluate(gt,{},T).join(","),Nt=z.get("text-rotation-alignment")!=="viewport"&&z.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.WritingMode.vertical)>=0;for(const zt of pt.sections)if(zt.image)pe[zt.image.name]=!0;else{const Ht=hA(pt.toString()),Gt=zt.fontStack||$t,Tt=me[Gt]=me[Gt]||{};this.calculateGlyphDependencies(zt.text,Tt,Nt,this.allowVerticalPlacement,Ht)}}}z.get("symbol-placement")==="line"&&(this.features=function(ze){const et={},lt={},Ke=[];let st=0;function gt($t){Ke.push(ze[$t]),st++}function pt($t,Nt,zt){const Ht=lt[$t];return delete lt[$t],lt[Nt]=Ht,Ke[Ht].geometry[0].pop(),Ke[Ht].geometry[0]=Ke[Ht].geometry[0].concat(zt[0]),Ht}function qt($t,Nt,zt){const Ht=et[Nt];return delete et[Nt],et[$t]=Ht,Ke[Ht].geometry[0].shift(),Ke[Ht].geometry[0]=zt[0].concat(Ke[Ht].geometry[0]),Ht}function en($t,Nt,zt){const Ht=zt?Nt[0][Nt[0].length-1]:Nt[0][0];return`${$t}:${Ht.x}:${Ht.y}`}for(let $t=0;$t<ze.length;$t++){const Nt=ze[$t],zt=Nt.geometry,Ht=Nt.text?Nt.text.toString():null;if(!Ht){gt($t);continue}const Gt=en(Ht,zt),Tt=en(Ht,zt,!0);if(Gt in lt&&Tt in et&&lt[Gt]!==et[Tt]){const pn=qt(Gt,Tt,zt),an=pt(Gt,Tt,Ke[pn].geometry);delete et[Gt],delete lt[Tt],lt[en(Ht,Ke[an].geometry,!0)]=an,Ke[pn].geometry=null}else Gt in lt?pt(Gt,Tt,zt):Tt in et?qt(Gt,Tt,zt):(gt($t),et[Gt]=st-1,lt[Tt]=st-1)}return Ke.filter($t=>$t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ze,et)=>ze.sortKey-et.sortKey)}update(u,p,T){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(u,p,this.layers,T),this.icon.programConfigurations.updatePaintArrays(u,p,this.layers,T))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(u){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(u),this.iconCollisionBox.upload(u)),this.text.upload(u,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(u,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(u,p){const T=this.lineVertexArray.length;if(u.segment!==void 0){let D=u.dist(p[u.segment+1]),z=u.dist(p[u.segment]);const F={};for(let j=u.segment+1;j<p.length;j++)F[j]={x:p[j].x,y:p[j].y,tileUnitDistanceFromAnchor:D},j<p.length-1&&(D+=p[j+1].dist(p[j]));for(let j=u.segment||0;j>=0;j--)F[j]={x:p[j].x,y:p[j].y,tileUnitDistanceFromAnchor:z},j>0&&(z+=p[j-1].dist(p[j]));for(let j=0;j<p.length;j++){const Z=F[j];this.lineVertexArray.emplaceBack(Z.x,Z.y,Z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:T,lineLength:this.lineVertexArray.length-T}}addSymbols(u,p,T,D,z,F,j,Z,re,Ae,ce,pe){const me=u.indexArray,_e=u.layoutVertexArray,Ue=u.segments.prepareSegment(4*p.length,_e,me,this.canOverlap?F.sortKey:void 0),ze=this.glyphOffsetArray.length,et=Ue.vertexLength,lt=this.allowVerticalPlacement&&j===a.WritingMode.vertical?Math.PI/2:0,Ke=F.text&&F.text.sections;for(let st=0;st<p.length;st++){const{tl:gt,tr:pt,bl:qt,br:en,tex:$t,pixelOffsetTL:Nt,pixelOffsetBR:zt,minFontScaleX:Ht,minFontScaleY:Gt,glyphOffset:Tt,isSDF:pn,sectionIndex:an}=p[st],jn=Ue.vertexLength,Rr=Tt[1];gm(_e,Z.x,Z.y,gt.x,Rr+gt.y,$t.x,$t.y,T,pn,Nt.x,Nt.y,Ht,Gt),gm(_e,Z.x,Z.y,pt.x,Rr+pt.y,$t.x+$t.w,$t.y,T,pn,zt.x,Nt.y,Ht,Gt),gm(_e,Z.x,Z.y,qt.x,Rr+qt.y,$t.x,$t.y+$t.h,T,pn,Nt.x,zt.y,Ht,Gt),gm(_e,Z.x,Z.y,en.x,Rr+en.y,$t.x+$t.w,$t.y+$t.h,T,pn,zt.x,zt.y,Ht,Gt),fv(u.dynamicLayoutVertexArray,Z,lt),me.emplaceBack(jn,jn+1,jn+2),me.emplaceBack(jn+1,jn+2,jn+3),Ue.vertexLength+=4,Ue.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Tt[0]),st!==p.length-1&&an===p[st+1].sectionIndex||u.programConfigurations.populatePaintArrays(_e.length,F,F.index,{},pe,Ke&&Ke[an])}u.placedSymbolArray.emplaceBack(Z.x,Z.y,ze,this.glyphOffsetArray.length-ze,et,re,Ae,Z.segment,T?T[0]:0,T?T[1]:0,D[0],D[1],j,0,!1,0,ce)}_addCollisionDebugVertex(u,p,T,D,z,F){return p.emplaceBack(0,0),u.emplaceBack(T.x,T.y,D,z,Math.round(F.x),Math.round(F.y))}addCollisionDebugVertices(u,p,T,D,z,F,j){const Z=z.segments.prepareSegment(4,z.layoutVertexArray,z.indexArray),re=Z.vertexLength,Ae=z.layoutVertexArray,ce=z.collisionVertexArray,pe=j.anchorX,me=j.anchorY;this._addCollisionDebugVertex(Ae,ce,F,pe,me,new Et(u,p)),this._addCollisionDebugVertex(Ae,ce,F,pe,me,new Et(T,p)),this._addCollisionDebugVertex(Ae,ce,F,pe,me,new Et(T,D)),this._addCollisionDebugVertex(Ae,ce,F,pe,me,new Et(u,D)),Z.vertexLength+=4;const _e=z.indexArray;_e.emplaceBack(re,re+1),_e.emplaceBack(re+1,re+2),_e.emplaceBack(re+2,re+3),_e.emplaceBack(re+3,re),Z.primitiveLength+=4}addDebugCollisionBoxes(u,p,T,D){for(let z=u;z<p;z++){const F=this.collisionBoxArray.get(z);this.addCollisionDebugVertices(F.x1,F.y1,F.x2,F.y2,D?this.textCollisionBox:this.iconCollisionBox,F.anchorPoint,T)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pv(ut,t4.members,Xe),this.iconCollisionBox=new pv(ut,t4.members,Xe);for(let u=0;u<this.symbolInstances.length;u++){const p=this.symbolInstances.get(u);this.addDebugCollisionBoxes(p.textBoxStartIndex,p.textBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.iconBoxStartIndex,p.iconBoxEndIndex,p,!1),this.addDebugCollisionBoxes(p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p,!1)}}_deserializeCollisionBoxesForSymbol(u,p,T,D,z,F,j,Z,re){const Ae={};for(let ce=p;ce<T;ce++){const pe=u.get(ce);Ae.textBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.textFeatureIndex=pe.featureIndex;break}for(let ce=D;ce<z;ce++){const pe=u.get(ce);Ae.verticalTextBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.verticalTextFeatureIndex=pe.featureIndex;break}for(let ce=F;ce<j;ce++){const pe=u.get(ce);Ae.iconBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.iconFeatureIndex=pe.featureIndex;break}for(let ce=Z;ce<re;ce++){const pe=u.get(ce);Ae.verticalIconBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.verticalIconFeatureIndex=pe.featureIndex;break}return Ae}deserializeCollisionBoxes(u){this.collisionArrays=[];for(let p=0;p<this.symbolInstances.length;p++){const T=this.symbolInstances.get(p);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(u,T.textBoxStartIndex,T.textBoxEndIndex,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T.iconBoxStartIndex,T.iconBoxEndIndex,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(u,p){const T=u.placedSymbolArray.get(p),D=T.vertexStartIndex+4*T.numGlyphs;for(let z=T.vertexStartIndex;z<D;z+=4)u.indexArray.emplaceBack(z,z+1,z+2),u.indexArray.emplaceBack(z+1,z+2,z+3)}getSortedSymbolIndexes(u){if(this.sortedAngle===u&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const p=Math.sin(u),T=Math.cos(u),D=[],z=[],F=[];for(let j=0;j<this.symbolInstances.length;++j){F.push(j);const Z=this.symbolInstances.get(j);D.push(0|Math.round(p*Z.anchorX+T*Z.anchorY)),z.push(Z.featureIndex)}return F.sort((j,Z)=>D[j]-D[Z]||z[Z]-z[j]),F}addToSortKeyRanges(u,p){const T=this.sortKeyRanges[this.sortKeyRanges.length-1];T&&T.sortKey===p?T.symbolInstanceEnd=u+1:this.sortKeyRanges.push({sortKey:p,symbolInstanceStart:u,symbolInstanceEnd:u+1})}sortFeatures(u){if(this.sortFeaturesByY&&this.sortedAngle!==u&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(u),this.sortedAngle=u,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const p of this.symbolInstanceIndexes){const T=this.symbolInstances.get(p);this.featureSortOrder.push(T.featureIndex),[T.rightJustifiedTextSymbolIndex,T.centerJustifiedTextSymbolIndex,T.leftJustifiedTextSymbolIndex].forEach((D,z,F)=>{D>=0&&F.indexOf(D)===z&&this.addIndicesForPlacedSymbol(this.text,D)}),T.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,T.verticalPlacedTextSymbolIndex),T.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.placedIconSymbolIndex),T.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ft("SymbolBucket",_f,{omit:["layers","collisionBoxArray","features","compareText"]}),_f.MAX_GLYPHS=65535,_f.addDynamicAttributes=fv;const K7=new Or({"symbol-placement":new Zt(ct.layout_symbol["symbol-placement"]),"symbol-spacing":new Zt(ct.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Zt(ct.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Yt(ct.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Zt(ct.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Zt(ct.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Zt(ct.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Zt(ct.layout_symbol["icon-ignore-placement"]),"icon-optional":new Zt(ct.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Zt(ct.layout_symbol["icon-rotation-alignment"]),"icon-size":new Yt(ct.layout_symbol["icon-size"]),"icon-text-fit":new Zt(ct.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Zt(ct.layout_symbol["icon-text-fit-padding"]),"icon-image":new Yt(ct.layout_symbol["icon-image"]),"icon-rotate":new Yt(ct.layout_symbol["icon-rotate"]),"icon-padding":new Yt(ct.layout_symbol["icon-padding"]),"icon-keep-upright":new Zt(ct.layout_symbol["icon-keep-upright"]),"icon-offset":new Yt(ct.layout_symbol["icon-offset"]),"icon-anchor":new Yt(ct.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Zt(ct.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Zt(ct.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Zt(ct.layout_symbol["text-rotation-alignment"]),"text-field":new Yt(ct.layout_symbol["text-field"]),"text-font":new Yt(ct.layout_symbol["text-font"]),"text-size":new Yt(ct.layout_symbol["text-size"]),"text-max-width":new Yt(ct.layout_symbol["text-max-width"]),"text-line-height":new Zt(ct.layout_symbol["text-line-height"]),"text-letter-spacing":new Yt(ct.layout_symbol["text-letter-spacing"]),"text-justify":new Yt(ct.layout_symbol["text-justify"]),"text-radial-offset":new Yt(ct.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Zt(ct.layout_symbol["text-variable-anchor"]),"text-anchor":new Yt(ct.layout_symbol["text-anchor"]),"text-max-angle":new Zt(ct.layout_symbol["text-max-angle"]),"text-writing-mode":new Zt(ct.layout_symbol["text-writing-mode"]),"text-rotate":new Yt(ct.layout_symbol["text-rotate"]),"text-padding":new Zt(ct.layout_symbol["text-padding"]),"text-keep-upright":new Zt(ct.layout_symbol["text-keep-upright"]),"text-transform":new Yt(ct.layout_symbol["text-transform"]),"text-offset":new Yt(ct.layout_symbol["text-offset"]),"text-allow-overlap":new Zt(ct.layout_symbol["text-allow-overlap"]),"text-overlap":new Zt(ct.layout_symbol["text-overlap"]),"text-ignore-placement":new Zt(ct.layout_symbol["text-ignore-placement"]),"text-optional":new Zt(ct.layout_symbol["text-optional"])});var gv={paint:new Or({"icon-opacity":new Yt(ct.paint_symbol["icon-opacity"]),"icon-color":new Yt(ct.paint_symbol["icon-color"]),"icon-halo-color":new Yt(ct.paint_symbol["icon-halo-color"]),"icon-halo-width":new Yt(ct.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Yt(ct.paint_symbol["icon-halo-blur"]),"icon-translate":new Zt(ct.paint_symbol["icon-translate"]),"icon-translate-anchor":new Zt(ct.paint_symbol["icon-translate-anchor"]),"text-opacity":new Yt(ct.paint_symbol["text-opacity"]),"text-color":new Yt(ct.paint_symbol["text-color"],{runtimeType:Mr,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new Yt(ct.paint_symbol["text-halo-color"]),"text-halo-width":new Yt(ct.paint_symbol["text-halo-width"]),"text-halo-blur":new Yt(ct.paint_symbol["text-halo-blur"]),"text-translate":new Zt(ct.paint_symbol["text-translate"]),"text-translate-anchor":new Zt(ct.paint_symbol["text-translate-anchor"])}),layout:K7};class M4{constructor(u){if(u.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=u.property.overrides?u.property.overrides.runtimeType:Ji,this.defaultValue=u}evaluate(u){if(u.formattedSection){const p=this.defaultValue.property.overrides;if(p&&p.hasOverride(u.formattedSection))return p.getOverride(u.formattedSection)}return u.feature&&u.featureState?this.defaultValue.evaluate(u.feature,u.featureState):this.defaultValue.property.specification.default}eachChild(u){this.defaultValue.isConstant()||u(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ft("FormatSectionOverride",M4,{omit:["defaultValue"]});class mm extends ms{constructor(u){super(u,gv)}recalculate(u,p){if(super.recalculate(u,p),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const T=this.layout.get("text-writing-mode");if(T){const D=[];for(const z of T)D.indexOf(z)<0&&D.push(z);this.layout._values["text-writing-mode"]=D}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(u,p,T,D){const z=this.layout.get(u).evaluate(p,{},T,D),F=this._unevaluatedLayout._values[u];return F.isDataDriven()||ml(F.value)||!z?z:function(j,Z){return Z.replace(/{([^{}]+)}/g,(re,Ae)=>Ae in j?String(j[Ae]):"")}(p.properties,z)}createBucket(u){return new _f(u)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const u of gv.paint.overridableProperties){if(!mm.hasPaintOverride(this.layout,u))continue;const p=this.paint.get(u),T=new M4(p),D=new ks(T,p.property.specification);let z=null;z=p.value.kind==="constant"||p.value.kind==="source"?new oa("source",D):new yl("composite",D,p.value.zoomStops),this.paint._values[u]=new dr(p.property,z,p.parameters)}}_handleOverridablePaintPropertyUpdate(u,p,T){return!(!this.layout||p.isDataDriven()||T.isDataDriven())&&mm.hasPaintOverride(this.layout,u)}static hasPaintOverride(u,p){const T=u.get("text-field"),D=gv.paint.properties[p];let z=!1;const F=j=>{for(const Z of j)if(D.overrides&&D.overrides.hasOverride(Z))return void(z=!0)};if(T.value.kind==="constant"&&T.value.value instanceof Ie)F(T.value.value.sections);else if(T.value.kind==="source"){const j=re=>{z||(re instanceof Lt&&$e(re.value)===Vr?F(re.value.sections):re instanceof AA?F(re.sections):re.eachChild(j))},Z=T.value;Z._styleExpression&&j(Z._styleExpression.expression)}return z}}function mv(f,u,p){let T="never";const D=f.get(u);return D?T=D:f.get(p)&&(T="always"),T}var J7={paint:new Or({"background-color":new Zt(ct.paint_background["background-color"]),"background-pattern":new $i(ct.paint_background["background-pattern"]),"background-opacity":new Zt(ct.paint_background["background-opacity"])})},eN={paint:new Or({"raster-opacity":new Zt(ct.paint_raster["raster-opacity"]),"raster-hue-rotate":new Zt(ct.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Zt(ct.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Zt(ct.paint_raster["raster-brightness-max"]),"raster-saturation":new Zt(ct.paint_raster["raster-saturation"]),"raster-contrast":new Zt(ct.paint_raster["raster-contrast"]),"raster-resampling":new Zt(ct.paint_raster["raster-resampling"]),"raster-fade-duration":new Zt(ct.paint_raster["raster-fade-duration"])})};class tN extends ms{constructor(u){super(u,{}),this.onAdd=p=>{this.implementation.onAdd&&this.implementation.onAdd(p,p.painter.context.gl)},this.onRemove=p=>{this.implementation.onRemove&&this.implementation.onRemove(p,p.painter.context.gl)},this.implementation=u}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const nN={circle:class extends ms{constructor(f){super(f,DF)}createBucket(f){return new $2(f)}queryRadius(f){const u=f;return Ad("circle-radius",this,u)+Ad("circle-stroke-width",this,u)+em(this.paint.get("circle-translate"))}queryIntersectsFeature(f,u,p,T,D,z,F,j){const Z=tm(f,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),z.angle,F),re=this.paint.get("circle-radius").evaluate(u,p)+this.paint.get("circle-stroke-width").evaluate(u,p),Ae=this.paint.get("circle-pitch-alignment")==="map",ce=Ae?Z:function(me,_e){return me.map(Ue=>FS(Ue,_e))}(Z,j),pe=Ae?re*F:re;for(const me of T)for(const _e of me){const Ue=Ae?_e:FS(_e,j);let ze=pe;const et=nm([],[_e.x,_e.y,0,1],j);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ze*=et[3]/z.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ze*=z.cameraToCenterDistance/et[3]),CF(ce,Ue,ze))return!0}return!1}},heatmap:class extends ms{constructor(f){super(f,BF),this._updateColorRamp()}createBucket(f){return new NS(f)}_handleSpecialPaintPropertyUpdate(f){f==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=VS({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends ms{constructor(f){super(f,zF)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends ms{constructor(f){super(f,KF)}recalculate(f,u){super.recalculate(f,u);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(f){return new nv(f)}queryRadius(){return em(this.paint.get("fill-translate"))}queryIntersectsFeature(f,u,p,T,D,z,F){return IS(tm(f,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),z.angle,F),T)}isTileClipped(){return!0}},"fill-extrusion":class extends ms{constructor(f){super(f,h7)}createBucket(f){return new iv(f)}queryRadius(){return em(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(f,u,p,T,D,z,F,j){const Z=tm(f,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),z.angle,F),re=this.paint.get("fill-extrusion-height").evaluate(u,p),Ae=this.paint.get("fill-extrusion-base").evaluate(u,p),ce=function(me,_e,Ue,ze){const et=[];for(const lt of me){const Ke=[lt.x,lt.y,0,1];nm(Ke,Ke,_e),et.push(new Et(Ke[0]/Ke[3],Ke[1]/Ke[3]))}return et}(Z,j),pe=function(me,_e,Ue,ze){const et=[],lt=[],Ke=ze[8]*_e,st=ze[9]*_e,gt=ze[10]*_e,pt=ze[11]*_e,qt=ze[8]*Ue,en=ze[9]*Ue,$t=ze[10]*Ue,Nt=ze[11]*Ue;for(const zt of me){const Ht=[],Gt=[];for(const Tt of zt){const pn=Tt.x,an=Tt.y,jn=ze[0]*pn+ze[4]*an+ze[12],Rr=ze[1]*pn+ze[5]*an+ze[13],Nr=ze[2]*pn+ze[6]*an+ze[14],Pi=ze[3]*pn+ze[7]*an+ze[15],da=Nr+gt,os=Pi+pt,mi=jn+qt,Ni=Rr+en,as=Nr+$t,ys=Pi+Nt,po=new Et((jn+Ke)/os,(Rr+st)/os);po.z=da/os,Ht.push(po);const yi=new Et(mi/ys,Ni/ys);yi.z=as/ys,Gt.push(yi)}et.push(Ht),lt.push(Gt)}return[et,lt]}(T,Ae,re,j);return function(me,_e,Ue){let ze=1/0;IS(Ue,_e)&&(ze=YS(Ue,_e[0]));for(let et=0;et<_e.length;et++){const lt=_e[et],Ke=me[et];for(let st=0;st<lt.length-1;st++){const gt=lt[st],pt=[gt,lt[st+1],Ke[st+1],Ke[st],gt];PS(Ue,pt)&&(ze=Math.min(ze,YS(Ue,pt)))}}return ze!==1/0&&ze}(pe[0],pe[1],ce)}},line:class extends ms{constructor(f){super(f,KS),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(f){f==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Sr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(f,u){super.recalculate(f,u),this.paint._values["line-floorwidth"]=JS.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,f)}createBucket(f){return new sv(f)}queryRadius(f){const u=f,p=e4(Ad("line-width",this,u),Ad("line-gap-width",this,u)),T=Ad("line-offset",this,u);return p/2+Math.abs(T)+em(this.paint.get("line-translate"))}queryIntersectsFeature(f,u,p,T,D,z,F){const j=tm(f,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),z.angle,F),Z=F/2*e4(this.paint.get("line-width").evaluate(u,p),this.paint.get("line-gap-width").evaluate(u,p)),re=this.paint.get("line-offset").evaluate(u,p);return re&&(T=function(Ae,ce){const pe=[];for(let me=0;me<Ae.length;me++){const _e=Ae[me],Ue=[];for(let ze=0;ze<_e.length;ze++){const et=_e[ze-1],lt=_e[ze],Ke=_e[ze+1],st=ze===0?new Et(0,0):lt.sub(et)._unit()._perp(),gt=ze===_e.length-1?new Et(0,0):Ke.sub(lt)._unit()._perp(),pt=st._add(gt)._unit(),qt=pt.x*gt.x+pt.y*gt.y;qt!==0&&pt._mult(1/qt),Ue.push(pt._mult(ce)._add(lt))}pe.push(Ue)}return pe}(T,re*F)),function(Ae,ce,pe){for(let me=0;me<ce.length;me++){const _e=ce[me];if(Ae.length>=3){for(let Ue=0;Ue<_e.length;Ue++)if(hf(Ae,_e[Ue]))return!0}if(PF(Ae,_e,pe))return!0}return!1}(j,T,Z)}isTileClipped(){return!0}},symbol:mm,background:class extends ms{constructor(f){super(f,J7)}},raster:class extends ms{constructor(f){super(f,eN)}}};class rN{constructor(u){this._callback=u,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const C4=63710088e-1;class oi{constructor(u,p){if(isNaN(u)||isNaN(p))throw new Error(`Invalid LngLat object: (${u}, ${p})`);if(this.lng=+u,this.lat=+p,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new oi(U(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(u){const p=Math.PI/180,T=this.lat*p,D=u.lat*p,z=Math.sin(T)*Math.sin(D)+Math.cos(T)*Math.cos(D)*Math.cos((u.lng-this.lng)*p);return C4*Math.acos(Math.min(z,1))}toBounds(u=0){const p=360*u/40075017,T=p/Math.cos(Math.PI/180*this.lat);return new oh(new oi(this.lng-T,this.lat-p),new oi(this.lng+T,this.lat+p))}static convert(u){if(u instanceof oi)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new oi(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&typeof u=="object"&&u!==null)return new oi(Number("lng"in u?u.lng:u.lon),Number(u.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class oh{constructor(u,p){u&&(p?this.setSouthWest(u).setNorthEast(p):u.length===4?this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]]):this.setSouthWest(u[0]).setNorthEast(u[1]))}setNorthEast(u){return this._ne=u instanceof oi?new oi(u.lng,u.lat):oi.convert(u),this}setSouthWest(u){return this._sw=u instanceof oi?new oi(u.lng,u.lat):oi.convert(u),this}extend(u){const p=this._sw,T=this._ne;let D,z;if(u instanceof oi)D=u,z=u;else{if(!(u instanceof oh))return Array.isArray(u)?u.length===4||u.every(Array.isArray)?this.extend(oh.convert(u)):this.extend(oi.convert(u)):this;if(D=u._sw,z=u._ne,!D||!z)return this}return p||T?(p.lng=Math.min(D.lng,p.lng),p.lat=Math.min(D.lat,p.lat),T.lng=Math.max(z.lng,T.lng),T.lat=Math.max(z.lat,T.lat)):(this._sw=new oi(D.lng,D.lat),this._ne=new oi(z.lng,z.lat)),this}getCenter(){return new oi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new oi(this.getWest(),this.getNorth())}getSouthEast(){return new oi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(u){const{lng:p,lat:T}=oi.convert(u);let D=this._sw.lng<=p&&p<=this._ne.lng;return this._sw.lng>this._ne.lng&&(D=this._sw.lng>=p&&p>=this._ne.lng),this._sw.lat<=T&&T<=this._ne.lat&&D}static convert(u){return u instanceof oh?u:u&&new oh(u)}}const P4=2*Math.PI*C4;function I4(f){return P4*Math.cos(f*Math.PI/180)}function k4(f){return(180+f)/360}function L4(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function D4(f,u){return f/I4(u)}function yv(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}class ym{constructor(u,p,T=0){this.x=+u,this.y=+p,this.z=+T}static fromLngLat(u,p=0){const T=oi.convert(u);return new ym(k4(T.lng),L4(T.lat),D4(p,T.lat))}toLngLat(){return new oi(360*this.x-180,yv(this.y))}toAltitude(){return this.z*I4(yv(this.y))}meterInMercatorCoordinateUnits(){return 1/P4*(u=yv(this.y),1/Math.cos(u*Math.PI/180));var u}}function R4(f,u,p){var T=2*Math.PI*6378137/256/Math.pow(2,p);return[f*T-2*Math.PI*6378137/2,u*T-2*Math.PI*6378137/2]}class _v{constructor(u,p,T){if(u<0||u>25||T<0||T>=Math.pow(2,u)||p<0||p>=Math.pow(2,u))throw new Error(`x=${p}, y=${T}, z=${u} outside of bounds. 0<=x<${Math.pow(2,u)}, 0<=y<${Math.pow(2,u)} 0<=z<=25 `);this.z=u,this.x=p,this.y=T,this.key=vd(0,u,u,p,T)}equals(u){return this.z===u.z&&this.x===u.x&&this.y===u.y}url(u,p,T){const D=(F=this.y,j=this.z,Z=R4(256*(z=this.x),256*(F=Math.pow(2,j)-F-1),j),re=R4(256*(z+1),256*(F+1),j),Z[0]+","+Z[1]+","+re[0]+","+re[1]);var z,F,j,Z,re;const Ae=function(ce,pe,me){let _e,Ue="";for(let ze=ce;ze>0;ze--)_e=1<<ze-1,Ue+=(pe&_e?1:0)+(me&_e?2:0);return Ue}(this.z,this.x,this.y);return u[(this.x+this.y)%u.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(T==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,p>1?"@2x":"").replace(/{quadkey}/g,Ae).replace(/{bbox-epsg-3857}/g,D)}isChildOf(u){const p=this.z-u.z;return p>0&&u.x===this.x>>p&&u.y===this.y>>p}getTilePoint(u){const p=Math.pow(2,this.z);return new Et((u.x*p-this.x)*Ci,(u.y*p-this.y)*Ci)}toString(){return`${this.z}/${this.x}/${this.y}`}}class B4{constructor(u,p){this.wrap=u,this.canonical=p,this.key=vd(u,p.z,p.z,p.x,p.y)}}class fa{constructor(u,p,T,D,z){if(u<T)throw new Error(`overscaledZ should be >= z; overscaledZ = ${u}; z = ${T}`);this.overscaledZ=u,this.wrap=p,this.canonical=new _v(T,+D,+z),this.key=vd(p,u,T,D,z)}clone(){return new fa(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(u){return this.overscaledZ===u.overscaledZ&&this.wrap===u.wrap&&this.canonical.equals(u.canonical)}scaledTo(u){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-u;return u>this.canonical.z?new fa(u,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fa(u,this.wrap,u,this.canonical.x>>p,this.canonical.y>>p)}calculateScaledKey(u,p){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const T=this.canonical.z-u;return u>this.canonical.z?vd(this.wrap*+p,u,this.canonical.z,this.canonical.x,this.canonical.y):vd(this.wrap*+p,u,u,this.canonical.x>>T,this.canonical.y>>T)}isChildOf(u){if(u.wrap!==this.wrap)return!1;const p=this.canonical.z-u.canonical.z;return u.overscaledZ===0||u.overscaledZ<this.overscaledZ&&u.canonical.x===this.canonical.x>>p&&u.canonical.y===this.canonical.y>>p}children(u){if(this.overscaledZ>=u)return[new fa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const p=this.canonical.z+1,T=2*this.canonical.x,D=2*this.canonical.y;return[new fa(p,this.wrap,p,T,D),new fa(p,this.wrap,p,T+1,D),new fa(p,this.wrap,p,T,D+1),new fa(p,this.wrap,p,T+1,D+1)]}isLessThan(u){return this.wrap<u.wrap||!(this.wrap>u.wrap)&&(this.overscaledZ<u.overscaledZ||!(this.overscaledZ>u.overscaledZ)&&(this.canonical.x<u.canonical.x||!(this.canonical.x>u.canonical.x)&&this.canonical.y<u.canonical.y))}wrapped(){return new fa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(u){return new fa(this.overscaledZ,u,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new B4(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(u){return this.canonical.getTilePoint(new ym(u.x-this.wrap,u.y))}}function vd(f,u,p,T,D){(f*=2)<0&&(f=-1*f-1);const z=1<<p;return(z*z*f+z*D+T).toString(36)+p.toString(36)+u.toString(36)}Ft("CanonicalTileID",_v),Ft("OverscaledTileID",fa,{omit:["posMatrix"]});class z4{constructor(u,p,T){if(this.uid=u,p.height!==p.width)throw new RangeError("DEM tiles must be square");if(T&&T!=="mapbox"&&T!=="terrarium")return void ye(`"${T}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=p.height;const D=this.dim=p.height-2;this.data=new Uint32Array(p.data.buffer),this.encoding=T||"mapbox";for(let z=0;z<D;z++)this.data[this._idx(-1,z)]=this.data[this._idx(0,z)],this.data[this._idx(D,z)]=this.data[this._idx(D-1,z)],this.data[this._idx(z,-1)]=this.data[this._idx(z,0)],this.data[this._idx(z,D)]=this.data[this._idx(z,D-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(D,-1)]=this.data[this._idx(D-1,0)],this.data[this._idx(-1,D)]=this.data[this._idx(0,D-1)],this.data[this._idx(D,D)]=this.data[this._idx(D-1,D-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let z=0;z<D;z++)for(let F=0;F<D;F++){const j=this.get(z,F);j>this.max&&(this.max=j),j<this.min&&(this.min=j)}}get(u,p){const T=new Uint8Array(this.data.buffer),D=4*this._idx(u,p);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(T[D],T[D+1],T[D+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(u,p){if(u<-1||u>=this.dim+1||p<-1||p>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(p+1)*this.stride+(u+1)}_unpackMapbox(u,p,T){return(256*u*256+256*p+T)/10-1e4}_unpackTerrarium(u,p,T){return 256*u+p+T/256-32768}getPixels(){return new ha({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(u,p,T){if(this.dim!==u.dim)throw new Error("dem dimension mismatch");let D=p*this.dim,z=p*this.dim+this.dim,F=T*this.dim,j=T*this.dim+this.dim;switch(p){case-1:D=z-1;break;case 1:z=D+1}switch(T){case-1:F=j-1;break;case 1:j=F+1}const Z=-p*this.dim,re=-T*this.dim;for(let Ae=F;Ae<j;Ae++)for(let ce=D;ce<z;ce++)this.data[this._idx(ce,Ae)]=u.data[this._idx(ce+Z,Ae+re)]}}Ft("DEMData",z4);class O4{constructor(u){this._stringToNumber={},this._numberToString=[];for(let p=0;p<u.length;p++){const T=u[p];this._stringToNumber[T]=p,this._numberToString[p]=T}}encode(u){return this._stringToNumber[u]}decode(u){if(u>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${u} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[u]}}class F4{constructor(u,p,T,D,z){this.type="Feature",this._vectorTileFeature=u,u._z=p,u._x=T,u._y=D,this.properties=u.properties,this.id=z}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(u){this._geometry=u}toJSON(){const u={geometry:this.geometry};for(const p in this)p!=="_geometry"&&p!=="_vectorTileFeature"&&(u[p]=this[p]);return u}}class N4{constructor(u,p){this.tileID=u,this.x=u.canonical.x,this.y=u.canonical.y,this.z=u.canonical.z,this.grid=new Aa(Ci,16,0),this.grid3D=new Aa(Ci,16,0),this.featureIndexArray=new O,this.promoteId=p}insert(u,p,T,D,z,F){const j=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(T,D,z);const Z=F?this.grid3D:this.grid;for(let re=0;re<p.length;re++){const Ae=p[re],ce=[1/0,1/0,-1/0,-1/0];for(let pe=0;pe<Ae.length;pe++){const me=Ae[pe];ce[0]=Math.min(ce[0],me.x),ce[1]=Math.min(ce[1],me.y),ce[2]=Math.max(ce[2],me.x),ce[3]=Math.max(ce[3],me.y)}ce[0]<Ci&&ce[1]<Ci&&ce[2]>=0&&ce[3]>=0&&Z.insert(j,ce[0],ce[1],ce[2],ce[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ac.VectorTile(new ov(this.rawTileData)).layers,this.sourceLayerCoder=new O4(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(u,p,T,D){this.loadVTLayers();const z=u.params||{},F=Ci/u.tileSize/u.scale,j=Ls(z.filter),Z=u.queryGeometry,re=u.queryPadding*F,Ae=V4(Z),ce=this.grid.query(Ae.minX-re,Ae.minY-re,Ae.maxX+re,Ae.maxY+re),pe=V4(u.cameraQueryGeometry),me=this.grid3D.query(pe.minX-re,pe.minY-re,pe.maxX+re,pe.maxY+re,(ze,et,lt,Ke)=>function(st,gt,pt,qt,en){for(const Nt of st)if(gt<=Nt.x&&pt<=Nt.y&&qt>=Nt.x&&en>=Nt.y)return!0;const $t=[new Et(gt,pt),new Et(gt,en),new Et(qt,en),new Et(qt,pt)];if(st.length>2){for(const Nt of $t)if(hf(st,Nt))return!0}for(let Nt=0;Nt<st.length-1;Nt++)if(kF(st[Nt],st[Nt+1],$t))return!0;return!1}(u.cameraQueryGeometry,ze-re,et-re,lt+re,Ke+re));for(const ze of me)ce.push(ze);ce.sort(iN);const _e={};let Ue;for(let ze=0;ze<ce.length;ze++){const et=ce[ze];if(et===Ue)continue;Ue=et;const lt=this.featureIndexArray.get(et);let Ke=null;this.loadMatchingFeature(_e,lt.bucketIndex,lt.sourceLayerIndex,lt.featureIndex,j,z.layers,z.availableImages,p,T,D,(st,gt,pt)=>(Ke||(Ke=rh(st)),gt.queryIntersectsFeature(Z,st,pt,Ke,this.z,u.transform,F,u.pixelPosMatrix)))}return _e}loadMatchingFeature(u,p,T,D,z,F,j,Z,re,Ae,ce){const pe=this.bucketLayerIDs[p];if(F&&!function(ze,et){for(let lt=0;lt<ze.length;lt++)if(et.indexOf(ze[lt])>=0)return!0;return!1}(F,pe))return;const me=this.sourceLayerCoder.decode(T),_e=this.vtLayers[me].feature(D);if(z.needGeometry){const ze=ih(_e,!0);if(!z.filter(new wr(this.tileID.overscaledZ),ze,this.tileID.canonical))return}else if(!z.filter(new wr(this.tileID.overscaledZ),_e))return;const Ue=this.getId(_e,me);for(let ze=0;ze<pe.length;ze++){const et=pe[ze];if(F&&F.indexOf(et)<0)continue;const lt=Z[et];if(!lt)continue;let Ke={};Ue&&Ae&&(Ke=Ae.getState(lt.sourceLayer||"_geojsonTileLayer",Ue));const st=W({},re[et]);st.paint=U4(st.paint,lt.paint,_e,Ke,j),st.layout=U4(st.layout,lt.layout,_e,Ke,j);const gt=!ce||ce(_e,lt,Ke);if(!gt)continue;const pt=new F4(_e,this.z,this.x,this.y,Ue);pt.layer=st;let qt=u[et];qt===void 0&&(qt=u[et]=[]),qt.push({featureIndex:D,feature:pt,intersectionZ:gt})}}lookupSymbolFeatures(u,p,T,D,z,F,j,Z){const re={};this.loadVTLayers();const Ae=Ls(z);for(const ce of u)this.loadMatchingFeature(re,T,D,ce,Ae,F,j,Z,p);return re}hasLayer(u){for(const p of this.bucketLayerIDs)for(const T of p)if(u===T)return!0;return!1}getId(u,p){let T=u.id;return this.promoteId&&(T=u.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[p]],typeof T=="boolean"&&(T=Number(T))),T}}function U4(f,u,p,T,D){return K(f,(z,F)=>{const j=u instanceof Ml?u.get(F):null;return j&&j.evaluate?j.evaluate(p,T,D):j})}function V4(f){let u=1/0,p=1/0,T=-1/0,D=-1/0;for(const z of f)u=Math.min(u,z.x),p=Math.min(p,z.y),T=Math.max(T,z.x),D=Math.max(D,z.y);return{minX:u,minY:p,maxX:T,maxY:D}}function iN(f,u){return u-f}var vv;Ft("FeatureIndex",N4,{omit:["rawTileData","sourceLayerCoder"]}),a.PerformanceMarkers=void 0,(vv=a.PerformanceMarkers||(a.PerformanceMarkers={})).create="create",vv.load="load",vv.fullLoad="fullLoad";let _m=null,xd=[];const xv=1e3/30,sN={mark(f){performance.mark(f)},frame(f){const u=f;_m!=null&&xd.push(u-_m),_m=u},clearMetrics(){_m=null,xd=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const f in a.PerformanceMarkers)performance.clearMarks(a.PerformanceMarkers[f])},getPerformanceMetrics(){performance.measure("loadTime",a.PerformanceMarkers.create,a.PerformanceMarkers.load),performance.measure("fullLoadTime",a.PerformanceMarkers.create,a.PerformanceMarkers.fullLoad);const f=performance.getEntriesByName("loadTime")[0].duration,u=performance.getEntriesByName("fullLoadTime")[0].duration,p=xd.length,T=1/(xd.reduce((z,F)=>z+F,0)/p/1e3),D=xd.filter(z=>z>xv).reduce((z,F)=>z+(F-xv)/xv,0);return{loadTime:f,fullLoadTime:u,fps:T,percentDroppedFrames:D/(p+D)*100}}};a.AJAXError=er,a.ARRAY_TYPE=Us,a.Actor=class{constructor(f,u,p){this.target=f,this.parent=u,this.mapId=p,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ae(["receive","process"],this),this.invoker=new rN(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Qe()?f:window}send(f,u,p,T,D=!1){const z=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(this.callbacks[z]=p);const F=qe(this.globalScope)?void 0:[];return this.target.postMessage({id:z,type:f,hasCallback:!!p,targetMapId:T,mustQueue:D,sourceMapId:this.mapId,data:ua(u,F)},F),{cancel:()=>{p&&delete this.callbacks[z],this.target.postMessage({id:z,type:"<cancel>",targetMapId:T,sourceMapId:this.mapId})}}}receive(f){const u=f.data,p=u.id;if(p&&(!u.targetMapId||this.mapId===u.targetMapId))if(u.type==="<cancel>"){delete this.tasks[p];const T=this.cancelCallbacks[p];delete this.cancelCallbacks[p],T&&T()}else Qe()||u.mustQueue?(this.tasks[p]=u,this.taskQueue.push(p),this.invoker.trigger()):this.processTask(p,u)}process(){if(!this.taskQueue.length)return;const f=this.taskQueue.shift(),u=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),u&&this.processTask(f,u)}processTask(f,u){if(u.type==="<response>"){const p=this.callbacks[f];delete this.callbacks[f],p&&(u.error?p(No(u.error)):p(null,No(u.data)))}else{let p=!1;const T=qe(this.globalScope)?void 0:[],D=u.hasCallback?(j,Z)=>{p=!0,delete this.cancelCallbacks[f],this.target.postMessage({id:f,type:"<response>",sourceMapId:this.mapId,error:j?ua(j):null,data:ua(Z,T)},T)}:j=>{p=!0};let z=null;const F=No(u.data);if(this.parent[u.type])z=this.parent[u.type](u.sourceMapId,F,D);else if(this.parent.getWorkerSource){const j=u.type.split(".");z=this.parent.getWorkerSource(u.sourceMapId,j[0],F.source)[j[1]](F,D)}else D(new Error(`Could not find function ${u.type}`));!p&&z&&z.cancel&&(this.cancelCallbacks[f]=z.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.AlphaImage=cd,a.CanonicalTileID=_v,a.CollisionBoxArray=Ve,a.CollisionCircleLayoutArray=class extends B{},a.Color=o,a.DEMData=z4,a.DataConstantProperty=Zt,a.DictionaryCoder=O4,a.EXTENT=Ci,a.ErrorEvent=Io,a.EvaluationParameters=wr,a.Event=bi,a.Evented=Ki,a.FeatureIndex=N4,a.FillBucket=nv,a.FillExtrusionBucket=iv,a.GeoJSONFeature=F4,a.ImageAtlas=A4,a.ImagePosition=lv,a.LineBucket=sv,a.LineStripIndexArray=class extends ve{},a.LngLat=oi,a.LngLatBounds=oh,a.MercatorCoordinate=ym,a.ONE_EM=Hi,a.OverscaledTileID=fa,a.PerformanceUtils=sN,a.PosArray=N,a.Properties=Or,a.QuadTriangleArray=class extends ${},a.RGBAImage=ha,a.RasterBoundsArray=class extends k{},a.RequestPerformance=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return f.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),f}},a.ResourceType=vt,a.SegmentVector=dt,a.SymbolBucket=_f,a.Transitionable=ru,a.TriangleIndexArray=it,a.Uniform1f=su,a.Uniform1i=class extends Ha{constructor(f,u){super(f,u),this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},a.Uniform2f=class extends Ha{constructor(f,u){super(f,u),this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}},a.Uniform3f=class extends Ha{constructor(f,u){super(f,u),this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}},a.Uniform4f=uf,a.UniformColor=TS,a.UniformMatrix4f=class extends Ha{constructor(f,u){super(f,u),this.current=SF}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let u=1;u<16;u++)if(f[u]!==this.current[u]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}},a.UnwrappedTileID=B4,a.ValidationError=It,a.ZoomHistory=XA,a.add=function(f,u,p){return f[0]=u[0]+p[0],f[1]=u[1]+p[1],f[2]=u[2]+p[2],f},a.addDynamicAttributes=fv,a.asyncAll=function(f,u,p){if(!f.length)return p(null,[]);let T=f.length;const D=new Array(f.length);let z=null;f.forEach((F,j)=>{u(F,(Z,re)=>{Z&&(z=Z),D[j]=re,--T==0&&p(z,D)})})},a.bezier=P,a.bindAll=ae,a.cacheEntryPossiblyAdded=function(f){ir++,ir>Er&&(f.getActor().send("enforceCacheSizeLimit",En),ir=0)},a.clamp=L,a.clearTileCache=function(f){const u=caches.delete(bt);f&&u.catch(f).then(()=>f())},a.clipLine=x4,a.clone=function(f){var u=new Us(16);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5],u[6]=f[6],u[7]=f[7],u[8]=f[8],u[9]=f[9],u[10]=f[10],u[11]=f[11],u[12]=f[12],u[13]=f[13],u[14]=f[14],u[15]=f[15],u},a.clone$1=ie,a.clone$2=function(f){var u=new Us(3);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u},a.collisionCircleLayout=b7,a.config=yt,a.copy=function(f,u){return f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[4]=u[4],f[5]=u[5],f[6]=u[6],f[7]=u[7],f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},a.create=function(){var f=new Us(16);return Us!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},a.create$1=DS,a.createExpression=za,a.createFilter=Ls,a.createLayout=Fr,a.createStyleLayer=function(f){return f.type==="custom"?new tN(f):new nN[f.type](f)},a.cross=function(f,u,p){var T=u[0],D=u[1],z=u[2],F=p[0],j=p[1],Z=p[2];return f[0]=D*Z-z*j,f[1]=z*F-T*Z,f[2]=T*j-D*F,f},a.dot=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]},a.dot$1=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]+f[3]*u[3]},a.ease=I,a.emitValidationErrors=Va,a.enforceCacheSizeLimit=function(f){Jn(),Kt&&Kt.then(u=>{u.keys().then(p=>{for(let T=0;T<p.length-f;T++)u.delete(p[T])})})},a.equals=function(f,u){var p=f[0],T=f[1],D=f[2],z=f[3],F=f[4],j=f[5],Z=f[6],re=f[7],Ae=f[8],ce=f[9],pe=f[10],me=f[11],_e=f[12],Ue=f[13],ze=f[14],et=f[15],lt=u[0],Ke=u[1],st=u[2],gt=u[3],pt=u[4],qt=u[5],en=u[6],$t=u[7],Nt=u[8],zt=u[9],Ht=u[10],Gt=u[11],Tt=u[12],pn=u[13],an=u[14],jn=u[15];return Math.abs(p-lt)<=Ns*Math.max(1,Math.abs(p),Math.abs(lt))&&Math.abs(T-Ke)<=Ns*Math.max(1,Math.abs(T),Math.abs(Ke))&&Math.abs(D-st)<=Ns*Math.max(1,Math.abs(D),Math.abs(st))&&Math.abs(z-gt)<=Ns*Math.max(1,Math.abs(z),Math.abs(gt))&&Math.abs(F-pt)<=Ns*Math.max(1,Math.abs(F),Math.abs(pt))&&Math.abs(j-qt)<=Ns*Math.max(1,Math.abs(j),Math.abs(qt))&&Math.abs(Z-en)<=Ns*Math.max(1,Math.abs(Z),Math.abs(en))&&Math.abs(re-$t)<=Ns*Math.max(1,Math.abs(re),Math.abs($t))&&Math.abs(Ae-Nt)<=Ns*Math.max(1,Math.abs(Ae),Math.abs(Nt))&&Math.abs(ce-zt)<=Ns*Math.max(1,Math.abs(ce),Math.abs(zt))&&Math.abs(pe-Ht)<=Ns*Math.max(1,Math.abs(pe),Math.abs(Ht))&&Math.abs(me-Gt)<=Ns*Math.max(1,Math.abs(me),Math.abs(Gt))&&Math.abs(_e-Tt)<=Ns*Math.max(1,Math.abs(_e),Math.abs(Tt))&&Math.abs(Ue-pn)<=Ns*Math.max(1,Math.abs(Ue),Math.abs(pn))&&Math.abs(ze-an)<=Ns*Math.max(1,Math.abs(ze),Math.abs(an))&&Math.abs(et-jn)<=Ns*Math.max(1,Math.abs(et),Math.abs(jn))},a.evaluateSizeForFeature=function(f,{uSize:u,uSizeT:p},{lowerSize:T,upperSize:D}){return f.kind==="source"?T/lu:f.kind==="composite"?Jt(T/lu,D/lu,p):u},a.evaluateSizeForZoom=function(f,u){let p=0,T=0;if(f.kind==="constant")T=f.layoutSize;else if(f.kind!=="source"){const{interpolationType:D,minZoom:z,maxZoom:F}=f,j=D?L(Bn.interpolationFactor(D,u,z,F),0,1):0;f.kind==="camera"?T=Jt(f.minSize,f.maxSize,j):p=j}return{uSizeT:p,uSize:T}},a.evaluateVariableOffset=E4,a.evented=Dr,a.exported=Xt,a.exported$1=Ar,a.extend=W,a.filterObject=ne,a.fromRotation=function(f,u){var p=Math.sin(u),T=Math.cos(u);return f[0]=T,f[1]=p,f[2]=0,f[3]=-p,f[4]=T,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},a.fromScaling=function(f,u){return f[0]=u[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=u[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=u[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},a.getAnchorAlignment=uv,a.getAnchorJustification=hv,a.getArrayBuffer=tr,a.getImage=Di,a.getJSON=function(f,u){return or(W(f,{type:"json"}),u)},a.getOverlapMode=mv,a.getRTLTextPluginStatus=Tl,a.getReferrer=$n,a.getVideo=function(f,u){const p=window.document.createElement("video");p.muted=!0,p.onloadstart=function(){u(null,p)};for(let T=0;T<f.length;T++){const D=window.document.createElement("source");Zr(f[T])||(p.crossOrigin="Anonymous"),D.src=f[T],p.appendChild(D)}return{cancel:()=>{}}},a.identity=Q2,a.invert=function(f,u){var p=u[0],T=u[1],D=u[2],z=u[3],F=u[4],j=u[5],Z=u[6],re=u[7],Ae=u[8],ce=u[9],pe=u[10],me=u[11],_e=u[12],Ue=u[13],ze=u[14],et=u[15],lt=p*j-T*F,Ke=p*Z-D*F,st=p*re-z*F,gt=T*Z-D*j,pt=T*re-z*j,qt=D*re-z*Z,en=Ae*Ue-ce*_e,$t=Ae*ze-pe*_e,Nt=Ae*et-me*_e,zt=ce*ze-pe*Ue,Ht=ce*et-me*Ue,Gt=pe*et-me*ze,Tt=lt*Gt-Ke*Ht+st*zt+gt*Nt-pt*$t+qt*en;return Tt?(f[0]=(j*Gt-Z*Ht+re*zt)*(Tt=1/Tt),f[1]=(D*Ht-T*Gt-z*zt)*Tt,f[2]=(Ue*qt-ze*pt+et*gt)*Tt,f[3]=(pe*pt-ce*qt-me*gt)*Tt,f[4]=(Z*Nt-F*Gt-re*$t)*Tt,f[5]=(p*Gt-D*Nt+z*$t)*Tt,f[6]=(ze*st-_e*qt-et*Ke)*Tt,f[7]=(Ae*qt-pe*st+me*Ke)*Tt,f[8]=(F*Ht-j*Nt+re*en)*Tt,f[9]=(T*Nt-p*Ht-z*en)*Tt,f[10]=(_e*pt-Ue*st+et*lt)*Tt,f[11]=(ce*st-Ae*pt-me*lt)*Tt,f[12]=(j*$t-F*zt-Z*en)*Tt,f[13]=(p*zt-T*$t+D*en)*Tt,f[14]=(Ue*Ke-_e*gt-ze*lt)*Tt,f[15]=(Ae*gt-ce*Ke+pe*lt)*Tt,f):null},a.isImageBitmap=mt,a.isSafari=qe,a.isWorker=Qe,a.keysDifference=function(f,u){const p=[];for(const T in f)T in u||p.push(T);return p},a.lazyLoadRTLTextPlugin=function(){ss.isLoading()||ss.isLoaded()||Tl()!=="deferred"||rc()},a.makeRequest=or,a.mapObject=K,a.mercatorXfromLng=k4,a.mercatorYfromLat=L4,a.mercatorZfromAltitude=D4,a.mul=RF,a.mul$1=function(f,u,p){return f[0]=u[0]*p[0],f[1]=u[1]*p[1],f[2]=u[2]*p[2],f[3]=u[3]*p[3],f},a.multiply=RS,a.nextPowerOfTwo=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},a.normalize=function(f,u){var p=u[0],T=u[1],D=u[2],z=p*p+T*T+D*D;return z>0&&(z=1/Math.sqrt(z)),f[0]=u[0]*z,f[1]=u[1]*z,f[2]=u[2]*z,f},a.number=Jt,a.ortho=function(f,u,p,T,D,z,F){var j=1/(u-p),Z=1/(T-D),re=1/(z-F);return f[0]=-2*j,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*Z,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*re,f[11]=0,f[12]=(u+p)*j,f[13]=(D+T)*Z,f[14]=(F+z)*re,f[15]=1,f},a.parseCacheControl=Je,a.parseGlyphPbf=function(f){return new ov(f).readFields(R7,[])},a.pbf=ov,a.performSymbolLayout=function(f){f.bucket.createArrays(),f.bucket.tilePixelRatio=Ci/(512*f.bucket.overscaling),f.bucket.compareText={},f.bucket.iconsNeedLinear=!1;const u=f.bucket.layers[0].layout,p=f.bucket.layers[0]._unevaluatedLayout._values,T={layoutIconSize:p["icon-size"].possiblyEvaluate(new wr(f.bucket.zoom+1),f.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new wr(f.bucket.zoom+1),f.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new wr(18))};if(f.bucket.textSizeData.kind==="composite"){const{minZoom:Z,maxZoom:re}=f.bucket.textSizeData;T.compositeTextSizes=[p["text-size"].possiblyEvaluate(new wr(Z),f.canonical),p["text-size"].possiblyEvaluate(new wr(re),f.canonical)]}if(f.bucket.iconSizeData.kind==="composite"){const{minZoom:Z,maxZoom:re}=f.bucket.iconSizeData;T.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new wr(Z),f.canonical),p["icon-size"].possiblyEvaluate(new wr(re),f.canonical)]}const D=u.get("text-line-height")*Hi,z=u.get("text-rotation-alignment")!=="viewport"&&u.get("symbol-placement")!=="point",F=u.get("text-keep-upright"),j=u.get("text-size");for(const Z of f.bucket.features){const re=u.get("text-font").evaluate(Z,{},f.canonical).join(","),Ae=j.evaluate(Z,{},f.canonical),ce=T.layoutTextSize.evaluate(Z,{},f.canonical),pe=T.layoutIconSize.evaluate(Z,{},f.canonical),me={horizontal:{},vertical:void 0},_e=Z.text;let Ue,ze=[0,0];if(_e){const Ke=_e.toString(),st=u.get("text-letter-spacing").evaluate(Z,{},f.canonical)*Hi,gt=El(Ke)?st:0,pt=u.get("text-anchor").evaluate(Z,{},f.canonical),qt=u.get("text-variable-anchor");if(!qt){const Ht=u.get("text-radial-offset").evaluate(Z,{},f.canonical);ze=Ht?E4(pt,[Ht*Hi,cv]):u.get("text-offset").evaluate(Z,{},f.canonical).map(Gt=>Gt*Hi)}let en=z?"center":u.get("text-justify").evaluate(Z,{},f.canonical);const $t=u.get("symbol-placement"),Nt=$t==="point"?u.get("text-max-width").evaluate(Z,{},f.canonical)*Hi:0,zt=()=>{f.bucket.allowVerticalPlacement&&hA(Ke)&&(me.vertical=um(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Nt,D,pt,"left",gt,ze,a.WritingMode.vertical,!0,$t,ce,Ae))};if(!z&&qt){const Ht=en==="auto"?qt.map(Tt=>hv(Tt)):[en];let Gt=!1;for(let Tt=0;Tt<Ht.length;Tt++){const pn=Ht[Tt];if(!me.horizontal[pn])if(Gt)me.horizontal[pn]=me.horizontal[0];else{const an=um(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Nt,D,"center",pn,gt,ze,a.WritingMode.horizontal,!1,$t,ce,Ae);an&&(me.horizontal[pn]=an,Gt=an.positionedLines.length===1)}}zt()}else{en==="auto"&&(en=hv(pt));const Ht=um(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Nt,D,pt,en,gt,ze,a.WritingMode.horizontal,!1,$t,ce,Ae);Ht&&(me.horizontal[en]=Ht),zt(),hA(Ke)&&z&&F&&(me.vertical=um(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Nt,D,pt,en,gt,ze,a.WritingMode.vertical,!1,$t,ce,Ae))}}let et=!1;if(Z.icon&&Z.icon.name){const Ke=f.imageMap[Z.icon.name];Ke&&(Ue=U7(f.imagePositions[Z.icon.name],u.get("icon-offset").evaluate(Z,{},f.canonical),u.get("icon-anchor").evaluate(Z,{},f.canonical)),et=!!Ke.sdf,f.bucket.sdfIcons===void 0?f.bucket.sdfIcons=et:f.bucket.sdfIcons!==et&&ye("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ke.pixelRatio!==f.bucket.pixelRatio||u.get("icon-rotate").constantOr(1)!==0)&&(f.bucket.iconsNeedLinear=!0))}const lt=S4(me.horizontal)||me.vertical;f.bucket.iconsInText=!!lt&&lt.iconsInText,(lt||Ue)&&Q7(f.bucket,Z,me,Ue,f.imageMap,T,ce,pe,ze,et,f.canonical)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()},a.perspective=function(f,u,p,T,D){var z,F=1/Math.tan(u/2);return f[0]=F/p,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=F,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,D!=null&&D!==1/0?(f[10]=(D+T)*(z=1/(T-D)),f[14]=2*D*T*z):(f[10]=-1,f[14]=-2*T),f},a.pick=function(f,u){const p={};for(let T=0;T<u.length;T++){const D=u[T];D in f&&(p[D]=f[D])}return p},a.plugin=ss,a.pointGeometry=Et,a.polygonIntersectsPolygon=PS,a.potpack=l4,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=Ft,a.registerForPluginStateChange=function(f){return f({pluginStatus:Mi,pluginURL:fo}),Dr.on("pluginStateChange",f),f},a.renderColorRamp=VS,a.rotateX=function(f,u,p){var T=Math.sin(p),D=Math.cos(p),z=u[4],F=u[5],j=u[6],Z=u[7],re=u[8],Ae=u[9],ce=u[10],pe=u[11];return u!==f&&(f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[4]=z*D+re*T,f[5]=F*D+Ae*T,f[6]=j*D+ce*T,f[7]=Z*D+pe*T,f[8]=re*D-z*T,f[9]=Ae*D-F*T,f[10]=ce*D-j*T,f[11]=pe*D-Z*T,f},a.rotateZ=function(f,u,p){var T=Math.sin(p),D=Math.cos(p),z=u[0],F=u[1],j=u[2],Z=u[3],re=u[4],Ae=u[5],ce=u[6],pe=u[7];return u!==f&&(f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[0]=z*D+re*T,f[1]=F*D+Ae*T,f[2]=j*D+ce*T,f[3]=Z*D+pe*T,f[4]=re*D-z*T,f[5]=Ae*D-F*T,f[6]=ce*D-j*T,f[7]=pe*D-Z*T,f},a.scale=function(f,u,p){var T=p[0],D=p[1],z=p[2];return f[0]=u[0]*T,f[1]=u[1]*T,f[2]=u[2]*T,f[3]=u[3]*T,f[4]=u[4]*D,f[5]=u[5]*D,f[6]=u[6]*D,f[7]=u[7]*D,f[8]=u[8]*z,f[9]=u[9]*z,f[10]=u[10]*z,f[11]=u[11]*z,f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},a.scale$1=function(f,u,p){return f[0]=u[0]*p,f[1]=u[1]*p,f[2]=u[2]*p,f},a.setCacheLimits=function(f,u){En=f,Er=u},a.setRTLTextPlugin=function(f,u,p=!1){if(Mi===JA||Mi===eu||Mi===tu)throw new Error("setRTLTextPlugin cannot be called multiple times.");fo=Xt.resolveURL(f),Mi=JA,Bs=u,ca(),p||rc()},a.spec=ct,a.sphericalToCartesian=function([f,u,p]){return u+=90,u*=Math.PI/180,p*=Math.PI/180,{x:f*Math.cos(u)*Math.sin(p),y:f*Math.sin(u)*Math.sin(p),z:f*Math.cos(p)}},a.sqrLen=function(f){var u=f[0],p=f[1];return u*u+p*p},a.sub=function(f,u,p){return f[0]=u[0]-p[0],f[1]=u[1]-p[1],f[2]=u[2]-p[2],f},a.toEvaluationFeature=ih,a.transformMat3=function(f,u,p){var T=u[0],D=u[1],z=u[2];return f[0]=T*p[0]+D*p[3]+z*p[6],f[1]=T*p[1]+D*p[4]+z*p[7],f[2]=T*p[2]+D*p[5]+z*p[8],f},a.transformMat4=nm,a.transformMat4$1=function(f,u,p){var T=u[0],D=u[1];return f[0]=p[0]*T+p[4]*D+p[12],f[1]=p[1]*T+p[5]*D+p[13],f},a.translate=function(f,u,p){var T,D,z,F,j,Z,re,Ae,ce,pe,me,_e,Ue=p[0],ze=p[1],et=p[2];return u===f?(f[12]=u[0]*Ue+u[4]*ze+u[8]*et+u[12],f[13]=u[1]*Ue+u[5]*ze+u[9]*et+u[13],f[14]=u[2]*Ue+u[6]*ze+u[10]*et+u[14],f[15]=u[3]*Ue+u[7]*ze+u[11]*et+u[15]):(D=u[1],z=u[2],F=u[3],j=u[4],Z=u[5],re=u[6],Ae=u[7],ce=u[8],pe=u[9],me=u[10],_e=u[11],f[0]=T=u[0],f[1]=D,f[2]=z,f[3]=F,f[4]=j,f[5]=Z,f[6]=re,f[7]=Ae,f[8]=ce,f[9]=pe,f[10]=me,f[11]=_e,f[12]=T*Ue+j*ze+ce*et+u[12],f[13]=D*Ue+Z*ze+pe*et+u[13],f[14]=z*Ue+re*ze+me*et+u[14],f[15]=F*Ue+Ae*ze+_e*et+u[15]),f},a.triggerPluginCompletionEvent=nu,a.unicodeBlockLookup=Ut,a.uniqueId=function(){return q++},a.validateCustomStyleLayer=function(f){const u=[],p=f.id;return p===void 0&&u.push({message:`layers.${p}: missing required property "id"`}),f.render===void 0&&u.push({message:`layers.${p}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&u.push({message:`layers.${p}: property "renderingMode" must be either "2d" or "3d"`}),u},a.validateLight=Ua,a.validateStyle=bl,a.vectorTile=ac,a.warnOnce=ye,a.wrap=U}),s(["./shared"],function(a){function y(X){const H=typeof X;if(H==="number"||H==="boolean"||H==="string"||X==null)return JSON.stringify(X);if(Array.isArray(X)){let o="[";for(const G of X)o+=`${y(G)},`;return`${o}]`}const ee=Object.keys(X).sort();let he="{";for(let o=0;o<ee.length;o++)he+=`${JSON.stringify(ee[o])}:${y(X[ee[o]])},`;return`${he}}`}function w(X){let H="";for(const ee of a.refProperties)H+=`/${y(X[ee])}`;return H}class P{constructor(H){this.keyCache={},H&&this.replace(H)}replace(H){this._layerConfigs={},this._layers={},this.update(H,[])}update(H,ee){for(const o of H){this._layerConfigs[o.id]=o;const G=this._layers[o.id]=a.createStyleLayer(o);G._featureFilter=a.createFilter(G.filter),this.keyCache[o.id]&&delete this.keyCache[o.id]}for(const o of ee)delete this.keyCache[o],delete this._layerConfigs[o],delete this._layers[o];this.familiesBySource={};const he=function(o,G){const Le={};for(let Pe=0;Pe<o.length;Pe++){const ke=G&&G[o[Pe].id]||w(o[Pe]);G&&(G[o[Pe].id]=ke);let We=Le[ke];We||(We=Le[ke]=[]),We.push(o[Pe])}const Ie=[];for(const Pe in Le)Ie.push(Le[Pe]);return Ie}(Object.values(this._layerConfigs),this.keyCache);for(const o of he){const G=o.map(at=>this._layers[at.id]),Le=G[0];if(Le.visibility==="none")continue;const Ie=Le.source||"";let Pe=this.familiesBySource[Ie];Pe||(Pe=this.familiesBySource[Ie]={});const ke=Le.sourceLayer||"_geojsonTileLayer";let We=Pe[ke];We||(We=Pe[ke]=[]),We.push(G)}}}class I{constructor(H){const ee={},he=[];for(const Ie in H){const Pe=H[Ie],ke=ee[Ie]={};for(const We in Pe){const at=Pe[+We];if(!at||at.bitmap.width===0||at.bitmap.height===0)continue;const $e={x:0,y:0,w:at.bitmap.width+2,h:at.bitmap.height+2};he.push($e),ke[We]={rect:$e,metrics:at.metrics}}}const{w:o,h:G}=a.potpack(he),Le=new a.AlphaImage({width:o||1,height:G||1});for(const Ie in H){const Pe=H[Ie];for(const ke in Pe){const We=Pe[+ke];if(!We||We.bitmap.width===0||We.bitmap.height===0)continue;const at=ee[Ie][ke].rect;a.AlphaImage.copy(We.bitmap,Le,{x:0,y:0},{x:at.x+1,y:at.y+1},We.bitmap)}}this.image=Le,this.positions=ee}}a.register("GlyphAtlas",I);class L{constructor(H){this.tileID=new a.OverscaledTileID(H.tileID.overscaledZ,H.tileID.wrap,H.tileID.canonical.z,H.tileID.canonical.x,H.tileID.canonical.y),this.uid=H.uid,this.zoom=H.zoom,this.pixelRatio=H.pixelRatio,this.tileSize=H.tileSize,this.source=H.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=H.showCollisionBoxes,this.collectResourceTiming=!!H.collectResourceTiming,this.returnDependencies=!!H.returnDependencies,this.promoteId=H.promoteId}parse(H,ee,he,o,G){this.status="parsing",this.data=H,this.collisionBoxArray=new a.CollisionBoxArray;const Le=new a.DictionaryCoder(Object.keys(H.layers).sort()),Ie=new a.FeatureIndex(this.tileID,this.promoteId);Ie.bucketLayerIDs=[];const Pe={},ke={featureIndex:Ie,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:he},We=ee.familiesBySource[this.source];for(const Qt in We){const on=H.layers[Qt];if(!on)continue;on.version===1&&a.warnOnce(`Vector tile source "${this.source}" layer "${Qt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const vn=Le.encode(Qt),Ot=[];for(let Oe=0;Oe<on.length;Oe++){const Mt=on.feature(Oe),Se=Ie.getId(Mt,Qt);Ot.push({feature:Mt,id:Se,index:Oe,sourceLayerIndex:vn})}for(const Oe of We[Qt]){const Mt=Oe[0];Mt.source!==this.source&&a.warnOnce(`layer.source = ${Mt.source} does not equal this.source = ${this.source}`),Mt.minzoom&&this.zoom<Math.floor(Mt.minzoom)||Mt.maxzoom&&this.zoom>=Mt.maxzoom||Mt.visibility!=="none"&&(U(Oe,this.zoom,he),(Pe[Mt.id]=Mt.createBucket({index:Ie.bucketLayerIDs.length,layers:Oe,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:vn,sourceID:this.source})).populate(Ot,ke,this.tileID.canonical),Ie.bucketLayerIDs.push(Oe.map(Se=>Se.id)))}}let at,$e,ft,Lt;const Dt=a.mapObject(ke.glyphDependencies,Qt=>Object.keys(Qt).map(Number));Object.keys(Dt).length?o.send("getGlyphs",{uid:this.uid,stacks:Dt},(Qt,on)=>{at||(at=Qt,$e=on,dn.call(this))}):$e={};const rn=Object.keys(ke.iconDependencies);rn.length?o.send("getImages",{icons:rn,source:this.source,tileID:this.tileID,type:"icons"},(Qt,on)=>{at||(at=Qt,ft=on,dn.call(this))}):ft={};const jt=Object.keys(ke.patternDependencies);function dn(){if(at)return G(at);if($e&&ft&&Lt){const Qt=new I($e),on=new a.ImageAtlas(ft,Lt);for(const vn in Pe){const Ot=Pe[vn];Ot instanceof a.SymbolBucket?(U(Ot.layers,this.zoom,he),a.performSymbolLayout({bucket:Ot,glyphMap:$e,glyphPositions:Qt.positions,imageMap:ft,imagePositions:on.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ot.hasPattern&&(Ot instanceof a.LineBucket||Ot instanceof a.FillBucket||Ot instanceof a.FillExtrusionBucket)&&(U(Ot.layers,this.zoom,he),Ot.addFeatures(ke,this.tileID.canonical,on.patternPositions))}this.status="done",G(null,{buckets:Object.values(Pe).filter(vn=>!vn.isEmpty()),featureIndex:Ie,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Qt.image,imageAtlas:on,glyphMap:this.returnDependencies?$e:null,iconMap:this.returnDependencies?ft:null,glyphPositions:this.returnDependencies?Qt.positions:null})}}jt.length?o.send("getImages",{icons:jt,source:this.source,tileID:this.tileID,type:"patterns"},(Qt,on)=>{at||(at=Qt,Lt=on,dn.call(this))}):Lt={},dn.call(this)}}function U(X,H,ee){const he=new a.EvaluationParameters(H);for(const o of X)o.recalculate(he,ee)}function W(X,H){const ee=a.getArrayBuffer(X.request,(he,o,G,Le)=>{he?H(he):o&&H(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(o)),rawData:o,cacheControl:G,expires:Le})});return()=>{ee.cancel(),H()}}class q{constructor(H,ee,he,o){this.actor=H,this.layerIndex=ee,this.availableImages=he,this.loadVectorData=o||W,this.loading={},this.loaded={}}loadTile(H,ee){const he=H.uid;this.loading||(this.loading={});const o=!!(H&&H.request&&H.request.collectResourceTiming)&&new a.RequestPerformance(H.request),G=this.loading[he]=new L(H);G.abort=this.loadVectorData(H,(Le,Ie)=>{if(delete this.loading[he],Le||!Ie)return G.status="done",this.loaded[he]=G,ee(Le);const Pe=Ie.rawData,ke={};Ie.expires&&(ke.expires=Ie.expires),Ie.cacheControl&&(ke.cacheControl=Ie.cacheControl);const We={};if(o){const at=o.finish();at&&(We.resourceTiming=JSON.parse(JSON.stringify(at)))}G.vectorTile=Ie.vectorTile,G.parse(Ie.vectorTile,this.layerIndex,this.availableImages,this.actor,(at,$e)=>{if(at||!$e)return ee(at);ee(null,a.extend({rawTileData:Pe.slice(0)},$e,ke,We))}),this.loaded=this.loaded||{},this.loaded[he]=G})}reloadTile(H,ee){const he=this.loaded,o=H.uid,G=this;if(he&&he[o]){const Le=he[o];Le.showCollisionBoxes=H.showCollisionBoxes;const Ie=(Pe,ke)=>{const We=Le.reloadCallback;We&&(delete Le.reloadCallback,Le.parse(Le.vectorTile,G.layerIndex,this.availableImages,G.actor,We)),ee(Pe,ke)};Le.status==="parsing"?Le.reloadCallback=Ie:Le.status==="done"&&(Le.vectorTile?Le.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.actor,Ie):Ie())}}abortTile(H,ee){const he=this.loading,o=H.uid;he&&he[o]&&he[o].abort&&(he[o].abort(),delete he[o]),ee()}removeTile(H,ee){const he=this.loaded,o=H.uid;he&&he[o]&&delete he[o],ee()}}class ae{constructor(){this.loaded={}}loadTile(H,ee){const{uid:he,encoding:o,rawImageData:G}=H,Le=a.isImageBitmap(G)?this.getImageData(G):G,Ie=new a.DEMData(he,Le,o);this.loaded=this.loaded||{},this.loaded[he]=Ie,ee(null,Ie)}getImageData(H){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(H.width,H.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=H.width,this.offscreenCanvas.height=H.height,this.offscreenCanvasContext.drawImage(H,0,0,H.width,H.height);const ee=this.offscreenCanvasContext.getImageData(-1,-1,H.width+2,H.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:ee.width,height:ee.height},ee.data)}removeTile(H){const ee=this.loaded,he=H.uid;ee&&ee[he]&&delete ee[he]}}var K=function X(H,ee){var he,o=H&&H.type;if(o==="FeatureCollection")for(he=0;he<H.features.length;he++)X(H.features[he],ee);else if(o==="GeometryCollection")for(he=0;he<H.geometries.length;he++)X(H.geometries[he],ee);else if(o==="Feature")X(H.geometry,ee);else if(o==="Polygon")ne(H.coordinates,ee);else if(o==="MultiPolygon")for(he=0;he<H.coordinates.length;he++)ne(H.coordinates[he],ee);return H};function ne(X,H){if(X.length!==0){ie(X[0],H);for(var ee=1;ee<X.length;ee++)ie(X[ee],!H)}}function ie(X,H){for(var ee=0,he=0,o=0,G=X.length,Le=G-1;o<G;Le=o++){var Ie=(X[o][0]-X[Le][0])*(X[Le][1]+X[o][1]),Pe=ee+Ie;he+=Math.abs(ee)>=Math.abs(Ie)?ee-Pe+Ie:Ie-Pe+ee,ee=Pe}ee+he>=0!=!!H&&X.reverse()}const fe=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ye{constructor(H){this._feature=H,this.extent=a.EXTENT,this.type=H.type,this.properties=H.tags,"id"in H&&!isNaN(H.id)&&(this.id=parseInt(H.id,10))}loadGeometry(){if(this._feature.type===1){const H=[];for(const ee of this._feature.geometry)H.push([new a.pointGeometry(ee[0],ee[1])]);return H}{const H=[];for(const ee of this._feature.geometry){const he=[];for(const o of ee)he.push(new a.pointGeometry(o[0],o[1]));H.push(he)}return H}}toGeoJSON(H,ee,he){return fe.call(this,H,ee,he)}}class Me{constructor(H){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=H.length,this._features=H}feature(H){return new ye(this._features[H])}}var He={exports:{}},Qe=a.pointGeometry,Je=a.vectorTile.VectorTileFeature,tt=Ne;function Ne(X,H){this.options=H||{},this.features=X,this.length=X.length}function nt(X,H){this.id=typeof X.id=="number"?X.id:void 0,this.type=X.type,this.rawGeometry=X.type===1?[X.geometry]:X.geometry,this.properties=X.tags,this.extent=H||4096}Ne.prototype.feature=function(X){return new nt(this.features[X],this.options.extent)},nt.prototype.loadGeometry=function(){var X=this.rawGeometry;this.geometry=[];for(var H=0;H<X.length;H++){for(var ee=X[H],he=[],o=0;o<ee.length;o++)he.push(new Qe(ee[o][0],ee[o][1]));this.geometry.push(he)}return this.geometry},nt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var X=this.geometry,H=1/0,ee=-1/0,he=1/0,o=-1/0,G=0;G<X.length;G++)for(var Le=X[G],Ie=0;Ie<Le.length;Ie++){var Pe=Le[Ie];H=Math.min(H,Pe.x),ee=Math.max(ee,Pe.x),he=Math.min(he,Pe.y),o=Math.max(o,Pe.y)}return[H,he,ee,o]},nt.prototype.toGeoJSON=Je.prototype.toGeoJSON;var qe=a.pbf,mt=tt;function Xt(X){var H=new qe;return function(ee,he){for(var o in ee.layers)he.writeMessage(3,Et,ee.layers[o])}(X,H),H.finish()}function Et(X,H){var ee;H.writeVarintField(15,X.version||1),H.writeStringField(1,X.name||""),H.writeVarintField(5,X.extent||4096);var he={keys:[],values:[],keycache:{},valuecache:{}};for(ee=0;ee<X.length;ee++)he.feature=X.feature(ee),H.writeMessage(2,fn,he);var o=he.keys;for(ee=0;ee<o.length;ee++)H.writeStringField(3,o[ee]);var G=he.values;for(ee=0;ee<G.length;ee++)H.writeMessage(4,En,G[ee])}function fn(X,H){var ee=X.feature;ee.id!==void 0&&H.writeVarintField(1,ee.id),H.writeMessage(2,yt,X),H.writeVarintField(3,ee.type),H.writeMessage(4,In,ee)}function yt(X,H){var ee=X.feature,he=X.keys,o=X.values,G=X.keycache,Le=X.valuecache;for(var Ie in ee.properties){var Pe=ee.properties[Ie],ke=G[Ie];if(Pe!==null){ke===void 0&&(he.push(Ie),G[Ie]=ke=he.length-1),H.writeVarint(ke);var We=typeof Pe;We!=="string"&&We!=="boolean"&&We!=="number"&&(Pe=JSON.stringify(Pe));var at=We+":"+Pe,$e=Le[at];$e===void 0&&(o.push(Pe),Le[at]=$e=o.length-1),H.writeVarint($e)}}}function bt(X,H){return(H<<3)+(7&X)}function Kt(X){return X<<1^X>>31}function In(X,H){for(var ee=X.loadGeometry(),he=X.type,o=0,G=0,Le=ee.length,Ie=0;Ie<Le;Ie++){var Pe=ee[Ie],ke=1;he===1&&(ke=Pe.length),H.writeVarint(bt(1,ke));for(var We=he===3?Pe.length-1:Pe.length,at=0;at<We;at++){at===1&&he!==1&&H.writeVarint(bt(2,We-1));var $e=Pe[at].x-o,ft=Pe[at].y-G;H.writeVarint(Kt($e)),H.writeVarint(Kt(ft)),o+=$e,G+=ft}he===3&&H.writeVarint(bt(7,1))}}function En(X,H){var ee=typeof X;ee==="string"?H.writeStringField(1,X):ee==="boolean"?H.writeBooleanField(7,X):ee==="number"&&(X%1!=0?H.writeDoubleField(3,X):X<0?H.writeSVarintField(6,X):H.writeVarintField(5,X))}function Er(X,H,ee,he,o,G){if(o-he<=ee)return;const Le=he+o>>1;Jn(X,H,Le,he,o,G%2),Er(X,H,ee,he,Le-1,G+1),Er(X,H,ee,Le+1,o,G+1)}function Jn(X,H,ee,he,o,G){for(;o>he;){if(o-he>600){const ke=o-he+1,We=ee-he+1,at=Math.log(ke),$e=.5*Math.exp(2*at/3),ft=.5*Math.sqrt(at*$e*(ke-$e)/ke)*(We-ke/2<0?-1:1);Jn(X,H,ee,Math.max(he,Math.floor(ee-We*$e/ke+ft)),Math.min(o,Math.floor(ee+(ke-We)*$e/ke+ft)),G)}const Le=H[2*ee+G];let Ie=he,Pe=o;for(ir(X,H,he,ee),H[2*o+G]>Le&&ir(X,H,he,o);Ie<Pe;){for(ir(X,H,Ie,Pe),Ie++,Pe--;H[2*Ie+G]<Le;)Ie++;for(;H[2*Pe+G]>Le;)Pe--}H[2*he+G]===Le?ir(X,H,he,Pe):(Pe++,ir(X,H,Pe,o)),Pe<=ee&&(he=Pe+1),ee<=Pe&&(o=Pe-1)}}function ir(X,H,ee,he){Ar(X,ee,he),Ar(H,2*ee,2*he),Ar(H,2*ee+1,2*he+1)}function Ar(X,H,ee){const he=X[H];X[H]=X[ee],X[ee]=he}function Nn(X,H,ee,he){const o=X-ee,G=H-he;return o*o+G*G}He.exports=Xt,He.exports.fromVectorTileJs=Xt,He.exports.fromGeojsonVt=function(X,H){H=H||{};var ee={};for(var he in X)ee[he]=new mt(X[he].features,H),ee[he].name=he,ee[he].version=H.version,ee[he].extent=H.extent;return Xt({layers:ee})},He.exports.GeoJSONWrapper=mt;const xr=X=>X[0],xt=X=>X[1];class nn{constructor(H,ee=xr,he=xt,o=64,G=Float64Array){this.nodeSize=o,this.points=H;const Le=H.length<65536?Uint16Array:Uint32Array,Ie=this.ids=new Le(H.length),Pe=this.coords=new G(2*H.length);for(let ke=0;ke<H.length;ke++)Ie[ke]=ke,Pe[2*ke]=ee(H[ke]),Pe[2*ke+1]=he(H[ke]);Er(Ie,Pe,o,0,Ie.length-1,0)}range(H,ee,he,o){return function(G,Le,Ie,Pe,ke,We,at){const $e=[0,G.length-1,0],ft=[];let Lt,Dt;for(;$e.length;){const rn=$e.pop(),jt=$e.pop(),dn=$e.pop();if(jt-dn<=at){for(let vn=dn;vn<=jt;vn++)Lt=Le[2*vn],Dt=Le[2*vn+1],Lt>=Ie&&Lt<=ke&&Dt>=Pe&&Dt<=We&&ft.push(G[vn]);continue}const Qt=Math.floor((dn+jt)/2);Lt=Le[2*Qt],Dt=Le[2*Qt+1],Lt>=Ie&&Lt<=ke&&Dt>=Pe&&Dt<=We&&ft.push(G[Qt]);const on=(rn+1)%2;(rn===0?Ie<=Lt:Pe<=Dt)&&($e.push(dn),$e.push(Qt-1),$e.push(on)),(rn===0?ke>=Lt:We>=Dt)&&($e.push(Qt+1),$e.push(jt),$e.push(on))}return ft}(this.ids,this.coords,H,ee,he,o,this.nodeSize)}within(H,ee,he){return function(o,G,Le,Ie,Pe,ke){const We=[0,o.length-1,0],at=[],$e=Pe*Pe;for(;We.length;){const ft=We.pop(),Lt=We.pop(),Dt=We.pop();if(Lt-Dt<=ke){for(let on=Dt;on<=Lt;on++)Nn(G[2*on],G[2*on+1],Le,Ie)<=$e&&at.push(o[on]);continue}const rn=Math.floor((Dt+Lt)/2),jt=G[2*rn],dn=G[2*rn+1];Nn(jt,dn,Le,Ie)<=$e&&at.push(o[rn]);const Qt=(ft+1)%2;(ft===0?Le-Pe<=jt:Ie-Pe<=dn)&&(We.push(Dt),We.push(rn-1),We.push(Qt)),(ft===0?Le+Pe>=jt:Ie+Pe>=dn)&&(We.push(rn+1),We.push(Lt),We.push(Qt))}return at}(this.ids,this.coords,H,ee,he,this.nodeSize)}}const Mn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:X=>X},vt=Math.fround||(er=new Float32Array(1),X=>(er[0]=+X,er[0]));var er;class $n{constructor(H){this.options=Di(Object.create(Mn),H),this.trees=new Array(this.options.maxZoom+1)}load(H){const{log:ee,minZoom:he,maxZoom:o,nodeSize:G}=this.options;ee&&console.time("total time");const Le=`prepare ${H.length} points`;ee&&console.time(Le),this.points=H;let Ie=[];for(let Pe=0;Pe<H.length;Pe++)H[Pe].geometry&&Ie.push(or(H[Pe],Pe));this.trees[o+1]=new nn(Ie,oo,zr,G,Float32Array),ee&&console.timeEnd(Le);for(let Pe=o;Pe>=he;Pe--){const ke=+Date.now();Ie=this._cluster(Ie,Pe),this.trees[Pe]=new nn(Ie,oo,zr,G,Float32Array),ee&&console.log("z%d: %d clusters in %dms",Pe,Ie.length,+Date.now()-ke)}return ee&&console.timeEnd("total time"),this}getClusters(H,ee){let he=((H[0]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,H[1]));let G=H[2]===180?180:((H[2]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,H[3]));if(H[2]-H[0]>=360)he=-180,G=180;else if(he>G){const We=this.getClusters([he,o,180,Le],ee),at=this.getClusters([-180,o,G,Le],ee);return We.concat(at)}const Ie=this.trees[this._limitZoom(ee)],Pe=Ie.range(Un(he),wi(Le),Un(G),wi(o)),ke=[];for(const We of Pe){const at=Ie.points[We];ke.push(at.numPoints?tr(at):this.points[at.index])}return ke}getChildren(H){const ee=this._getOriginId(H),he=this._getOriginZoom(H),o="No cluster with the specified id.",G=this.trees[he];if(!G)throw new Error(o);const Le=G.points[ee];if(!Le)throw new Error(o);const Ie=this.options.radius/(this.options.extent*Math.pow(2,he-1)),Pe=G.within(Le.x,Le.y,Ie),ke=[];for(const We of Pe){const at=G.points[We];at.parentId===H&&ke.push(at.numPoints?tr(at):this.points[at.index])}if(ke.length===0)throw new Error(o);return ke}getLeaves(H,ee,he){const o=[];return this._appendLeaves(o,H,ee=ee||10,he=he||0,0),o}getTile(H,ee,he){const o=this.trees[this._limitZoom(H)],G=Math.pow(2,H),{extent:Le,radius:Ie}=this.options,Pe=Ie/Le,ke=(he-Pe)/G,We=(he+1+Pe)/G,at={features:[]};return this._addTileFeatures(o.range((ee-Pe)/G,ke,(ee+1+Pe)/G,We),o.points,ee,he,G,at),ee===0&&this._addTileFeatures(o.range(1-Pe/G,ke,1,We),o.points,G,he,G,at),ee===G-1&&this._addTileFeatures(o.range(0,ke,Pe/G,We),o.points,-1,he,G,at),at.features.length?at:null}getClusterExpansionZoom(H){let ee=this._getOriginZoom(H)-1;for(;ee<=this.options.maxZoom;){const he=this.getChildren(H);if(ee++,he.length!==1)break;H=he[0].properties.cluster_id}return ee}_appendLeaves(H,ee,he,o,G){const Le=this.getChildren(ee);for(const Ie of Le){const Pe=Ie.properties;if(Pe&&Pe.cluster?G+Pe.point_count<=o?G+=Pe.point_count:G=this._appendLeaves(H,Pe.cluster_id,he,o,G):G<o?G++:H.push(Ie),H.length===he)break}return G}_addTileFeatures(H,ee,he,o,G,Le){for(const Ie of H){const Pe=ee[Ie],ke=Pe.numPoints;let We,at,$e;if(ke)We=Zr(Pe),at=Pe.x,$e=Pe.y;else{const Dt=this.points[Pe.index];We=Dt.properties,at=Un(Dt.geometry.coordinates[0]),$e=wi(Dt.geometry.coordinates[1])}const ft={type:1,geometry:[[Math.round(this.options.extent*(at*G-he)),Math.round(this.options.extent*($e*G-o))]],tags:We};let Lt;ke?Lt=Pe.id:this.options.generateId?Lt=Pe.index:this.points[Pe.index].id&&(Lt=this.points[Pe.index].id),Lt!==void 0&&(ft.id=Lt),Le.features.push(ft)}}_limitZoom(H){return Math.max(this.options.minZoom,Math.min(Math.floor(+H),this.options.maxZoom+1))}_cluster(H,ee){const he=[],{radius:o,extent:G,reduce:Le,minPoints:Ie}=this.options,Pe=o/(G*Math.pow(2,ee));for(let ke=0;ke<H.length;ke++){const We=H[ke];if(We.zoom<=ee)continue;We.zoom=ee;const at=this.trees[ee+1],$e=at.within(We.x,We.y,Pe),ft=We.numPoints||1;let Lt=ft;for(const Dt of $e){const rn=at.points[Dt];rn.zoom>ee&&(Lt+=rn.numPoints||1)}if(Lt>ft&&Lt>=Ie){let Dt=We.x*ft,rn=We.y*ft,jt=Le&&ft>1?this._map(We,!0):null;const dn=(ke<<5)+(ee+1)+this.points.length;for(const Qt of $e){const on=at.points[Qt];if(on.zoom<=ee)continue;on.zoom=ee;const vn=on.numPoints||1;Dt+=on.x*vn,rn+=on.y*vn,on.parentId=dn,Le&&(jt||(jt=this._map(We,!0)),Le(jt,this._map(on)))}We.parentId=dn,he.push(gr(Dt/Lt,rn/Lt,dn,Lt,jt))}else if(he.push(We),Lt>1)for(const Dt of $e){const rn=at.points[Dt];rn.zoom<=ee||(rn.zoom=ee,he.push(rn))}}return he}_getOriginId(H){return H-this.points.length>>5}_getOriginZoom(H){return(H-this.points.length)%32}_map(H,ee){if(H.numPoints)return ee?Di({},H.properties):H.properties;const he=this.points[H.index].properties,o=this.options.map(he);return ee&&o===he?Di({},o):o}}function gr(X,H,ee,he,o){return{x:vt(X),y:vt(H),zoom:1/0,id:ee,parentId:-1,numPoints:he,properties:o}}function or(X,H){const[ee,he]=X.geometry.coordinates;return{x:vt(Un(ee)),y:vt(wi(he)),zoom:1/0,index:H,parentId:-1}}function tr(X){return{type:"Feature",id:X.id,properties:Zr(X),geometry:{type:"Point",coordinates:[(H=X.x,360*(H-.5)),Hn(X.y)]}};var H}function Zr(X){const H=X.numPoints,ee=H>=1e4?`${Math.round(H/1e3)}k`:H>=1e3?Math.round(H/100)/10+"k":H;return Di(Di({},X.properties),{cluster:!0,cluster_id:X.id,point_count:H,point_count_abbreviated:ee})}function Un(X){return X/360+.5}function wi(X){const H=Math.sin(X*Math.PI/180),ee=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return ee<0?0:ee>1?1:ee}function Hn(X){const H=(180-360*X)*Math.PI/180;return 360*Math.atan(Math.exp(H))/Math.PI-90}function Di(X,H){for(const ee in H)X[ee]=H[ee];return X}function oo(X){return X.x}function zr(X){return X.y}function bi(X,H,ee,he){for(var o,G=he,Le=ee-H>>1,Ie=ee-H,Pe=X[H],ke=X[H+1],We=X[ee],at=X[ee+1],$e=H+3;$e<ee;$e+=3){var ft=Io(X[$e],X[$e+1],Pe,ke,We,at);if(ft>G)o=$e,G=ft;else if(ft===G){var Lt=Math.abs($e-Le);Lt<Ie&&(o=$e,Ie=Lt)}}G>he&&(o-H>3&&bi(X,H,o,he),X[o+2]=G,ee-o>3&&bi(X,o,ee,he))}function Io(X,H,ee,he,o,G){var Le=o-ee,Ie=G-he;if(Le!==0||Ie!==0){var Pe=((X-ee)*Le+(H-he)*Ie)/(Le*Le+Ie*Ie);Pe>1?(ee=o,he=G):Pe>0&&(ee+=Le*Pe,he+=Ie*Pe)}return(Le=X-ee)*Le+(Ie=H-he)*Ie}function Ki(X,H,ee,he){var o={id:X===void 0?null:X,type:H,geometry:ee,tags:he,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(G){var Le=G.geometry,Ie=G.type;if(Ie==="Point"||Ie==="MultiPoint"||Ie==="LineString")ct(G,Le);else if(Ie==="Polygon"||Ie==="MultiLineString")for(var Pe=0;Pe<Le.length;Pe++)ct(G,Le[Pe]);else if(Ie==="MultiPolygon")for(Pe=0;Pe<Le.length;Pe++)for(var ke=0;ke<Le[Pe].length;ke++)ct(G,Le[Pe][ke])}(o),o}function ct(X,H){for(var ee=0;ee<H.length;ee+=3)X.minX=Math.min(X.minX,H[ee]),X.minY=Math.min(X.minY,H[ee+1]),X.maxX=Math.max(X.maxX,H[ee]),X.maxY=Math.max(X.maxY,H[ee+1])}function It(X,H,ee,he){if(H.geometry){var o=H.geometry.coordinates,G=H.geometry.type,Le=Math.pow(ee.tolerance/((1<<ee.maxZoom)*ee.extent),2),Ie=[],Pe=H.id;if(ee.promoteId?Pe=H.properties[ee.promoteId]:ee.generateId&&(Pe=he||0),G==="Point")Ms(o,Ie);else if(G==="MultiPoint")for(var ke=0;ke<o.length;ke++)Ms(o[ke],Ie);else if(G==="LineString")pi(o,Ie,Le,!1);else if(G==="MultiLineString"){if(ee.lineMetrics){for(ke=0;ke<o.length;ke++)pi(o[ke],Ie=[],Le,!1),X.push(Ki(Pe,"LineString",Ie,H.properties));return}Rn(o,Ie,Le,!1)}else if(G==="Polygon")Rn(o,Ie,Le,!0);else{if(G!=="MultiPolygon"){if(G==="GeometryCollection"){for(ke=0;ke<H.geometry.geometries.length;ke++)It(X,{id:Pe,geometry:H.geometry.geometries[ke],properties:H.properties},ee,he);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ke=0;ke<o.length;ke++){var We=[];Rn(o[ke],We,Le,!0),Ie.push(We)}}X.push(Ki(Pe,G,Ie,H.properties))}}function Ms(X,H){H.push(Ri(X[0])),H.push(Ei(X[1])),H.push(0)}function pi(X,H,ee,he){for(var o,G,Le=0,Ie=0;Ie<X.length;Ie++){var Pe=Ri(X[Ie][0]),ke=Ei(X[Ie][1]);H.push(Pe),H.push(ke),H.push(0),Ie>0&&(Le+=he?(o*ke-Pe*G)/2:Math.sqrt(Math.pow(Pe-o,2)+Math.pow(ke-G,2))),o=Pe,G=ke}var We=H.length-3;H[2]=1,bi(H,0,We,ee),H[We+2]=1,H.size=Math.abs(Le),H.start=0,H.end=H.size}function Rn(X,H,ee,he){for(var o=0;o<X.length;o++){var G=[];pi(X[o],G,ee,he),H.push(G)}}function Ri(X){return X/360+.5}function Ei(X){var H=Math.sin(X*Math.PI/180),ee=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return ee<0?0:ee>1?1:ee}function Ti(X,H,ee,he,o,G,Le,Ie){if(he/=H,G>=(ee/=H)&&Le<he)return X;if(Le<ee||G>=he)return null;for(var Pe=[],ke=0;ke<X.length;ke++){var We=X[ke],at=We.geometry,$e=We.type,ft=o===0?We.minX:We.minY,Lt=o===0?We.maxX:We.maxY;if(ft>=ee&&Lt<he)Pe.push(We);else if(!(Lt<ee||ft>=he)){var Dt=[];if($e==="Point"||$e==="MultiPoint")Ji(at,Dt,ee,he,o);else if($e==="LineString")kt(at,Dt,ee,he,o,!1,Ie.lineMetrics);else if($e==="MultiLineString")wn(at,Dt,ee,he,o,!1);else if($e==="Polygon")wn(at,Dt,ee,he,o,!0);else if($e==="MultiPolygon")for(var rn=0;rn<at.length;rn++){var jt=[];wn(at[rn],jt,ee,he,o,!0),jt.length&&Dt.push(jt)}if(Dt.length){if(Ie.lineMetrics&&$e==="LineString"){for(rn=0;rn<Dt.length;rn++)Pe.push(Ki(We.id,$e,Dt[rn],We.tags));continue}$e!=="LineString"&&$e!=="MultiLineString"||(Dt.length===1?($e="LineString",Dt=Dt[0]):$e="MultiLineString"),$e!=="Point"&&$e!=="MultiPoint"||($e=Dt.length===3?"Point":"MultiPoint"),Pe.push(Ki(We.id,$e,Dt,We.tags))}}}return Pe.length?Pe:null}function Ji(X,H,ee,he,o){for(var G=0;G<X.length;G+=3){var Le=X[G+o];Le>=ee&&Le<=he&&(H.push(X[G]),H.push(X[G+1]),H.push(X[G+2]))}}function kt(X,H,ee,he,o,G,Le){for(var Ie,Pe,ke=Tn(X),We=o===0?fs:mn,at=X.start,$e=0;$e<X.length-3;$e+=3){var ft=X[$e],Lt=X[$e+1],Dt=X[$e+2],rn=X[$e+3],jt=X[$e+4],dn=o===0?ft:Lt,Qt=o===0?rn:jt,on=!1;Le&&(Ie=Math.sqrt(Math.pow(ft-rn,2)+Math.pow(Lt-jt,2))),dn<ee?Qt>ee&&(Pe=We(ke,ft,Lt,rn,jt,ee),Le&&(ke.start=at+Ie*Pe)):dn>he?Qt<he&&(Pe=We(ke,ft,Lt,rn,jt,he),Le&&(ke.start=at+Ie*Pe)):Mr(ke,ft,Lt,Dt),Qt<ee&&dn>=ee&&(Pe=We(ke,ft,Lt,rn,jt,ee),on=!0),Qt>he&&dn<=he&&(Pe=We(ke,ft,Lt,rn,jt,he),on=!0),!G&&on&&(Le&&(ke.end=at+Ie*Pe),H.push(ke),ke=Tn(X)),Le&&(at+=Ie)}var vn=X.length-3;ft=X[vn],Lt=X[vn+1],Dt=X[vn+2],(dn=o===0?ft:Lt)>=ee&&dn<=he&&Mr(ke,ft,Lt,Dt),vn=ke.length-3,G&&vn>=3&&(ke[vn]!==ke[0]||ke[vn+1]!==ke[1])&&Mr(ke,ke[0],ke[1],ke[2]),ke.length&&H.push(ke)}function Tn(X){var H=[];return H.size=X.size,H.start=X.start,H.end=X.end,H}function wn(X,H,ee,he,o,G){for(var Le=0;Le<X.length;Le++)kt(X[Le],H,ee,he,o,G,!1)}function Mr(X,H,ee,he){X.push(H),X.push(ee),X.push(he)}function fs(X,H,ee,he,o,G){var Le=(G-H)/(he-H);return X.push(G),X.push(ee+(o-ee)*Le),X.push(1),Le}function mn(X,H,ee,he,o,G){var Le=(G-ee)/(o-ee);return X.push(H+(he-H)*Le),X.push(G),X.push(1),Le}function Ze(X,H){for(var ee=[],he=0;he<X.length;he++){var o,G=X[he],Le=G.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")o=Vr(G.geometry,H);else if(Le==="MultiLineString"||Le==="Polygon"){o=[];for(var Ie=0;Ie<G.geometry.length;Ie++)o.push(Vr(G.geometry[Ie],H))}else if(Le==="MultiPolygon")for(o=[],Ie=0;Ie<G.geometry.length;Ie++){for(var Pe=[],ke=0;ke<G.geometry[Ie].length;ke++)Pe.push(Vr(G.geometry[Ie][ke],H));o.push(Pe)}ee.push(Ki(G.id,Le,o,G.tags))}return ee}function Vr(X,H){var ee=[];ee.size=X.size,X.start!==void 0&&(ee.start=X.start,ee.end=X.end);for(var he=0;he<X.length;he+=3)ee.push(X[he]+H,X[he+1],X[he+2]);return ee}function Cs(X,H){if(X.transformed)return X;var ee,he,o,G=1<<X.z,Le=X.x,Ie=X.y;for(ee=0;ee<X.features.length;ee++){var Pe=X.features[ee],ke=Pe.geometry,We=Pe.type;if(Pe.geometry=[],We===1)for(he=0;he<ke.length;he+=2)Pe.geometry.push(kr(ke[he],ke[he+1],H,G,Le,Ie));else for(he=0;he<ke.length;he++){var at=[];for(o=0;o<ke[he].length;o+=2)at.push(kr(ke[he][o],ke[he][o+1],H,G,Le,Ie));Pe.geometry.push(at)}}return X.transformed=!0,X}function kr(X,H,ee,he,o,G){return[Math.round(ee*(X*he-o)),Math.round(ee*(H*he-G))]}function ri(X,H,ee,he,o){for(var G=H===o.maxZoom?0:o.tolerance/((1<<H)*o.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ee,y:he,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ie=0;Ie<X.length;Ie++){Le.numFeatures++,Zn(Le,X[Ie],G,o);var Pe=X[Ie].minX,ke=X[Ie].minY,We=X[Ie].maxX,at=X[Ie].maxY;Pe<Le.minX&&(Le.minX=Pe),ke<Le.minY&&(Le.minY=ke),We>Le.maxX&&(Le.maxX=We),at>Le.maxY&&(Le.maxY=at)}return Le}function Zn(X,H,ee,he){var o=H.geometry,G=H.type,Le=[];if(G==="Point"||G==="MultiPoint")for(var Ie=0;Ie<o.length;Ie+=3)Le.push(o[Ie]),Le.push(o[Ie+1]),X.numPoints++,X.numSimplified++;else if(G==="LineString")Ps(Le,o,X,ee,!1,!1);else if(G==="MultiLineString"||G==="Polygon")for(Ie=0;Ie<o.length;Ie++)Ps(Le,o[Ie],X,ee,G==="Polygon",Ie===0);else if(G==="MultiPolygon")for(var Pe=0;Pe<o.length;Pe++){var ke=o[Pe];for(Ie=0;Ie<ke.length;Ie++)Ps(Le,ke[Ie],X,ee,!0,Ie===0)}if(Le.length){var We=H.tags||null;if(G==="LineString"&&he.lineMetrics){for(var at in We={},H.tags)We[at]=H.tags[at];We.mapbox_clip_start=o.start/o.size,We.mapbox_clip_end=o.end/o.size}var $e={geometry:Le,type:G==="Polygon"||G==="MultiPolygon"?3:G==="LineString"||G==="MultiLineString"?2:1,tags:We};H.id!==null&&($e.id=H.id),X.features.push($e)}}function Ps(X,H,ee,he,o,G){var Le=he*he;if(he>0&&H.size<(o?Le:he))ee.numPoints+=H.length/3;else{for(var Ie=[],Pe=0;Pe<H.length;Pe+=3)(he===0||H[Pe+2]>Le)&&(ee.numSimplified++,Ie.push(H[Pe]),Ie.push(H[Pe+1])),ee.numPoints++;o&&function(ke,We){for(var at=0,$e=0,ft=ke.length,Lt=ft-2;$e<ft;Lt=$e,$e+=2)at+=(ke[$e]-ke[Lt])*(ke[$e+1]+ke[Lt+1]);if(at>0===We)for($e=0,ft=ke.length;$e<ft/2;$e+=2){var Dt=ke[$e],rn=ke[$e+1];ke[$e]=ke[ft-2-$e],ke[$e+1]=ke[ft-1-$e],ke[ft-2-$e]=Dt,ke[ft-1-$e]=rn}}(Ie,G),X.push(Ie)}}function Bi(X,H){var ee=(H=this.options=function(o,G){for(var Le in G)o[Le]=G[Le];return o}(Object.create(this.options),H)).debug;if(ee&&console.time("preprocess data"),H.maxZoom<0||H.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(H.promoteId&&H.generateId)throw new Error("promoteId and generateId cannot be used together.");var he=function(o,G){var Le=[];if(o.type==="FeatureCollection")for(var Ie=0;Ie<o.features.length;Ie++)It(Le,o.features[Ie],G,Ie);else It(Le,o.type==="Feature"?o:{geometry:o},G);return Le}(X,H);this.tiles={},this.tileCoords=[],ee&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",H.indexMaxZoom,H.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),he=function(o,G){var Le=G.buffer/G.extent,Ie=o,Pe=Ti(o,1,-1-Le,Le,0,-1,2,G),ke=Ti(o,1,1-Le,2+Le,0,-1,2,G);return(Pe||ke)&&(Ie=Ti(o,1,-Le,1+Le,0,-1,2,G)||[],Pe&&(Ie=Ze(Pe,1).concat(Ie)),ke&&(Ie=Ie.concat(Ze(ke,-1)))),Ie}(he,H),he.length&&this.splitTile(he,0,0,0),ee&&(he.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function zi(X,H,ee){return 32*((1<<X)*ee+H)+X}function Si(X,H){const ee=X.tileID.canonical;if(!this._geoJSONIndex)return H(null,null);const he=this._geoJSONIndex.getTile(ee.z,ee.x,ee.y);if(!he)return H(null,null);const o=new Me(he.features);let G=He.exports(o);G.byteOffset===0&&G.byteLength===G.buffer.byteLength||(G=new Uint8Array(G)),H(null,{vectorTile:o,rawData:G.buffer})}Bi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Bi.prototype.splitTile=function(X,H,ee,he,o,G,Le){for(var Ie=[X,H,ee,he],Pe=this.options,ke=Pe.debug;Ie.length;){he=Ie.pop(),ee=Ie.pop(),H=Ie.pop(),X=Ie.pop();var We=1<<H,at=zi(H,ee,he),$e=this.tiles[at];if(!$e&&(ke>1&&console.time("creation"),$e=this.tiles[at]=ri(X,H,ee,he,Pe),this.tileCoords.push({z:H,x:ee,y:he}),ke)){ke>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",H,ee,he,$e.numFeatures,$e.numPoints,$e.numSimplified),console.timeEnd("creation"));var ft="z"+H;this.stats[ft]=(this.stats[ft]||0)+1,this.total++}if($e.source=X,o){if(H===Pe.maxZoom||H===o)continue;var Lt=1<<o-H;if(ee!==Math.floor(G/Lt)||he!==Math.floor(Le/Lt))continue}else if(H===Pe.indexMaxZoom||$e.numPoints<=Pe.indexMaxPoints)continue;if($e.source=null,X.length!==0){ke>1&&console.time("clipping");var Dt,rn,jt,dn,Qt,on,vn=.5*Pe.buffer/Pe.extent,Ot=.5-vn,Oe=.5+vn,Mt=1+vn;Dt=rn=jt=dn=null,Qt=Ti(X,We,ee-vn,ee+Oe,0,$e.minX,$e.maxX,Pe),on=Ti(X,We,ee+Ot,ee+Mt,0,$e.minX,$e.maxX,Pe),X=null,Qt&&(Dt=Ti(Qt,We,he-vn,he+Oe,1,$e.minY,$e.maxY,Pe),rn=Ti(Qt,We,he+Ot,he+Mt,1,$e.minY,$e.maxY,Pe),Qt=null),on&&(jt=Ti(on,We,he-vn,he+Oe,1,$e.minY,$e.maxY,Pe),dn=Ti(on,We,he+Ot,he+Mt,1,$e.minY,$e.maxY,Pe),on=null),ke>1&&console.timeEnd("clipping"),Ie.push(Dt||[],H+1,2*ee,2*he),Ie.push(rn||[],H+1,2*ee,2*he+1),Ie.push(jt||[],H+1,2*ee+1,2*he),Ie.push(dn||[],H+1,2*ee+1,2*he+1)}}},Bi.prototype.getTile=function(X,H,ee){var he=this.options,o=he.extent,G=he.debug;if(X<0||X>24)return null;var Le=1<<X,Ie=zi(X,H=(H%Le+Le)%Le,ee);if(this.tiles[Ie])return Cs(this.tiles[Ie],o);G>1&&console.log("drilling down to z%d-%d-%d",X,H,ee);for(var Pe,ke=X,We=H,at=ee;!Pe&&ke>0;)ke--,We=Math.floor(We/2),at=Math.floor(at/2),Pe=this.tiles[zi(ke,We,at)];return Pe&&Pe.source?(G>1&&console.log("found parent tile z%d-%d-%d",ke,We,at),G>1&&console.time("drilling down"),this.splitTile(Pe.source,ke,We,at,X,H,ee),G>1&&console.timeEnd("drilling down"),this.tiles[Ie]?Cs(this.tiles[Ie],o):null):null};class es extends q{constructor(H,ee,he,o){super(H,ee,he,Si),o&&(this.loadGeoJSON=o)}loadData(H,ee){var he;(he=this._pendingRequest)===null||he===void 0||he.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const o=!!(H&&H.request&&H.request.collectResourceTiming)&&new a.RequestPerformance(H.request);this._pendingCallback=ee,this._pendingRequest=this.loadGeoJSON(H,(G,Le)=>{if(delete this._pendingCallback,delete this._pendingRequest,G||!Le)return ee(G);if(typeof Le!="object")return ee(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`));{K(Le,!0);try{if(H.filter){const Pe=a.createExpression(H.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Pe.result==="error")throw new Error(Pe.value.map(We=>`${We.key}: ${We.message}`).join(", "));Le={type:"FeatureCollection",features:Le.features.filter(We=>Pe.value.evaluate({zoom:0},We))}}this._geoJSONIndex=H.cluster?new $n(function({superclusterOptions:Pe,clusterProperties:ke}){if(!ke||!Pe)return Pe;const We={},at={},$e={accumulated:null,zoom:0},ft={properties:null},Lt=Object.keys(ke);for(const Dt of Lt){const[rn,jt]=ke[Dt],dn=a.createExpression(jt),Qt=a.createExpression(typeof rn=="string"?[rn,["accumulated"],["get",Dt]]:rn);We[Dt]=dn.value,at[Dt]=Qt.value}return Pe.map=Dt=>{ft.properties=Dt;const rn={};for(const jt of Lt)rn[jt]=We[jt].evaluate($e,ft);return rn},Pe.reduce=(Dt,rn)=>{ft.properties=rn;for(const jt of Lt)$e.accumulated=Dt[jt],Dt[jt]=at[jt].evaluate($e,ft)},Pe}(H)).load(Le.features):function(Pe,ke){return new Bi(Pe,ke)}(Le,H.geojsonVtOptions)}catch(Pe){return ee(Pe)}this.loaded={};const Ie={};if(o){const Pe=o.finish();Pe&&(Ie.resourceTiming={},Ie.resourceTiming[H.source]=JSON.parse(JSON.stringify(Pe)))}ee(null,Ie)}})}reloadTile(H,ee){const he=this.loaded;return he&&he[H.uid]?super.reloadTile(H,ee):this.loadTile(H,ee)}loadGeoJSON(H,ee){if(H.request)return a.getJSON(H.request,ee);if(typeof H.data=="string")try{ee(null,JSON.parse(H.data))}catch{ee(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`))}else ee(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(H,ee){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ee()}getClusterExpansionZoom(H,ee){try{ee(null,this._geoJSONIndex.getClusterExpansionZoom(H.clusterId))}catch(he){ee(he)}}getClusterChildren(H,ee){try{ee(null,this._geoJSONIndex.getChildren(H.clusterId))}catch(he){ee(he)}}getClusterLeaves(H,ee){try{ee(null,this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset))}catch(he){ee(he)}}}class Lr{constructor(H){this.self=H,this.actor=new a.Actor(H,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:q,geojson:es},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ee,he)=>{if(this.workerSourceTypes[ee])throw new Error(`Worker source with name "${ee}" already registered.`);this.workerSourceTypes[ee]=he},this.self.registerRTLTextPlugin=ee=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=ee.applyArabicShaping,a.plugin.processBidirectionalText=ee.processBidirectionalText,a.plugin.processStyledBidirectionalText=ee.processStyledBidirectionalText}}setReferrer(H,ee){this.referrer=ee}setImages(H,ee,he){this.availableImages[H]=ee;for(const o in this.workerSources[H]){const G=this.workerSources[H][o];for(const Le in G)G[Le].availableImages=ee}he()}setLayers(H,ee,he){this.getLayerIndex(H).replace(ee),he()}updateLayers(H,ee,he){this.getLayerIndex(H).update(ee.layers,ee.removedIds),he()}loadTile(H,ee,he){this.getWorkerSource(H,ee.type,ee.source).loadTile(ee,he)}loadDEMTile(H,ee,he){this.getDEMWorkerSource(H,ee.source).loadTile(ee,he)}reloadTile(H,ee,he){this.getWorkerSource(H,ee.type,ee.source).reloadTile(ee,he)}abortTile(H,ee,he){this.getWorkerSource(H,ee.type,ee.source).abortTile(ee,he)}removeTile(H,ee,he){this.getWorkerSource(H,ee.type,ee.source).removeTile(ee,he)}removeDEMTile(H,ee){this.getDEMWorkerSource(H,ee.source).removeTile(ee)}removeSource(H,ee,he){if(!this.workerSources[H]||!this.workerSources[H][ee.type]||!this.workerSources[H][ee.type][ee.source])return;const o=this.workerSources[H][ee.type][ee.source];delete this.workerSources[H][ee.type][ee.source],o.removeSource!==void 0?o.removeSource(ee,he):he()}loadWorkerSource(H,ee,he){try{this.self.importScripts(ee.url),he()}catch(o){he(o.toString())}}syncRTLPluginState(H,ee,he){try{a.plugin.setState(ee);const o=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&o!=null){this.self.importScripts(o);const G=a.plugin.isParsed();he(G?void 0:new Error(`RTL Text Plugin failed to import scripts from ${o}`),G)}}catch(o){he(o.toString())}}getAvailableImages(H){let ee=this.availableImages[H];return ee||(ee=[]),ee}getLayerIndex(H){let ee=this.layerIndexes[H];return ee||(ee=this.layerIndexes[H]=new P),ee}getWorkerSource(H,ee,he){if(this.workerSources[H]||(this.workerSources[H]={}),this.workerSources[H][ee]||(this.workerSources[H][ee]={}),!this.workerSources[H][ee][he]){const o={send:(G,Le,Ie)=>{this.actor.send(G,Le,Ie,H)}};this.workerSources[H][ee][he]=new this.workerSourceTypes[ee](o,this.getLayerIndex(H),this.getAvailableImages(H))}return this.workerSources[H][ee][he]}getDEMWorkerSource(H,ee){return this.demWorkerSources[H]||(this.demWorkerSources[H]={}),this.demWorkerSources[H][ee]||(this.demWorkerSources[H][ee]=new ae),this.demWorkerSources[H][ee]}enforceCacheSizeLimit(H,ee){a.enforceCacheSizeLimit(ee)}}return a.isWorker()&&(self.worker=new Lr(self)),Lr}),s(["./shared"],function(a){var y=w;function w(k){return!function(c){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var l,h,d=new Blob([""],{type:"text/javascript"}),x=URL.createObjectURL(d);try{h=new Worker(x),l=!0}catch{l=!1}return h&&h.terminate(),URL.revokeObjectURL(x),l}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var l=document.createElement("canvas");l.width=l.height=1;var h=l.getContext("2d");if(!h)return!1;var d=h.getImageData(0,0,1,1);return d&&d.width===l.width}()?(P[_=c&&c.failIfMajorPerformanceCaveat]===void 0&&(P[_]=function(l){var h,d=function(x){var b=document.createElement("canvas"),S=Object.create(w.webGLContextAttributes);return S.failIfMajorPerformanceCaveat=x,b.getContext("webgl",S)||b.getContext("experimental-webgl",S)}(l);if(!d)return!1;try{h=d.createShader(d.VERTEX_SHADER)}catch{return!1}return!(!h||d.isContextLost())&&(d.shaderSource(h,"void main() {}"),d.compileShader(h),d.getShaderParameter(h,d.COMPILE_STATUS)===!0)}(_)),P[_]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var _}(k)}var P={};function I(k,c){if(Array.isArray(k)){if(!Array.isArray(c)||k.length!==c.length)return!1;for(let _=0;_<k.length;_++)if(!I(k[_],c[_]))return!1;return!0}if(typeof k=="object"&&k!==null&&c!==null){if(typeof c!="object"||Object.keys(k).length!==Object.keys(c).length)return!1;for(const _ in k)if(!I(k[_],c[_]))return!1;return!0}return k===c}w.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class L{static testProp(c){if(!L.docStyle)return c[0];for(let _=0;_<c.length;_++)if(c[_]in L.docStyle)return c[_];return c[0]}static create(c,_,l){const h=window.document.createElement(c);return _!==void 0&&(h.className=_),l&&l.appendChild(h),h}static createNS(c,_){return window.document.createElementNS(c,_)}static disableDrag(){L.docStyle&&L.selectProp&&(L.userSelect=L.docStyle[L.selectProp],L.docStyle[L.selectProp]="none")}static enableDrag(){L.docStyle&&L.selectProp&&(L.docStyle[L.selectProp]=L.userSelect)}static setTransform(c,_){c.style[L.transformProp]=_}static addEventListener(c,_,l,h={}){c.addEventListener(_,l,"passive"in h?h:h.capture)}static removeEventListener(c,_,l,h={}){c.removeEventListener(_,l,"passive"in h?h:h.capture)}static suppressClickInternal(c){c.preventDefault(),c.stopPropagation(),window.removeEventListener("click",L.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",L.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",L.suppressClickInternal,!0)},0)}static mousePos(c,_){const l=c.getBoundingClientRect();return new a.pointGeometry(_.clientX-l.left-c.clientLeft,_.clientY-l.top-c.clientTop)}static touchPos(c,_){const l=c.getBoundingClientRect(),h=[];for(let d=0;d<_.length;d++)h.push(new a.pointGeometry(_[d].clientX-l.left-c.clientLeft,_[d].clientY-l.top-c.clientTop));return h}static mouseButton(c){return c.button}static remove(c){c.parentNode&&c.parentNode.removeChild(c)}}L.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,L.selectProp=L.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),L.transformProp=L.testProp(["transform","WebkitTransform"]);class U{constructor(c){this._transformRequestFn=c}transformRequest(c,_){return this._transformRequestFn&&this._transformRequestFn(c,_)||{url:c}}normalizeSpriteURL(c,_,l){const h=function(d){const x=d.match(W);if(!x)throw new Error(`Unable to parse URL "${d}"`);return{protocol:x[1],authority:x[2],path:x[3]||"/",params:x[4]?x[4].split("&"):[]}}(c);return h.path+=`${_}${l}`,function(d){const x=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${x}`}(h)}setTransformRequest(c){this._transformRequestFn=c}}const W=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class q{constructor(c,_,l,h){this.context=c,this.format=l,this.texture=c.gl.createTexture(),this.update(_,h)}update(c,_,l){const{width:h,height:d}=c,x=!(this.size&&this.size[0]===h&&this.size[1]===d||l),{context:b}=this,{gl:S}=b;if(this.useMipmap=!!(_&&_.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!_||_.premultiply!==!1)),x)this.size=[h,d],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||a.isImageBitmap(c)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,c):S.texImage2D(S.TEXTURE_2D,0,this.format,h,d,0,this.format,S.UNSIGNED_BYTE,c.data);else{const{x:M,y:B}=l||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||a.isImageBitmap(c)?S.texSubImage2D(S.TEXTURE_2D,0,M,B,S.RGBA,S.UNSIGNED_BYTE,c):S.texSubImage2D(S.TEXTURE_2D,0,M,B,h,d,S.RGBA,S.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)}bind(c,_,l){const{context:h}=this,{gl:d}=h;d.bindTexture(d.TEXTURE_2D,this.texture),l!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=d.LINEAR),c!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,c),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,l||c),this.filter=c),_!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,_),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,_),this.wrap=_)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}function ae(k){const{userImage:c}=k;return!!(c&&c.render&&c.render())&&(k.data.replace(new Uint8Array(c.data.buffer)),!0)}class K extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:_,callback:l}of this.requestors)this._notify(_,l);this.requestors=[]}}getImage(c){return this.images[c]}addImage(c,_){if(this.images[c])throw new Error(`Image id ${c} already exist, use updateImage instead`);this._validate(c,_)&&(this.images[c]=_)}_validate(c,_){let l=!0;return this._validateStretch(_.stretchX,_.data&&_.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),l=!1),this._validateStretch(_.stretchY,_.data&&_.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),l=!1),this._validateContent(_.content,_)||(this.fire(new a.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),l=!1),l}_validateStretch(c,_){if(!c)return!0;let l=0;for(const h of c){if(h[0]<l||h[1]<h[0]||_<h[1])return!1;l=h[1]}return!0}_validateContent(c,_){return!(c&&(c.length!==4||c[0]<0||_.data.width<c[0]||c[1]<0||_.data.height<c[1]||c[2]<0||_.data.width<c[2]||c[3]<0||_.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,_){const l=this.images[c];if(l.data.width!==_.data.width||l.data.height!==_.data.height)throw new Error(`size mismatch between old image (${l.data.width}x${l.data.height}) and new image (${_.data.width}x${_.data.height}).`);_.version=l.version+1,this.images[c]=_,this.updatedImages[c]=!0}removeImage(c){const _=this.images[c];delete this.images[c],delete this.patterns[c],_.userImage&&_.userImage.onRemove&&_.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,_){let l=!0;if(!this.isLoaded())for(const h of c)this.images[h]||(l=!1);this.isLoaded()||l?this._notify(c,_):this.requestors.push({ids:c,callback:_})}_notify(c,_){const l={};for(const h of c){this.images[h]||this.fire(new a.Event("styleimagemissing",{id:h}));const d=this.images[h];d?l[h]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:a.warnOnce(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}_(null,l)}getPixelSize(){const{width:c,height:_}=this.atlasImage;return{width:c,height:_}}getPattern(c){const _=this.patterns[c],l=this.getImage(c);if(!l)return null;if(_&&_.position.version===l.version)return _.position;if(_)_.position.version=l.version;else{const h={w:l.data.width+2,h:l.data.height+2,x:0,y:0},d=new a.ImagePosition(h,l);this.patterns[c]={bin:h,position:d}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const _=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new q(c,this.atlasImage,_.RGBA),this.atlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const d in this.patterns)c.push(this.patterns[d].bin);const{w:_,h:l}=a.potpack(c),h=this.atlasImage;h.resize({width:_||1,height:l||1});for(const d in this.patterns){const{bin:x}=this.patterns[d],b=x.x+1,S=x.y+1,M=this.images[d].data,B=M.width,V=M.height;a.RGBAImage.copy(M,h,{x:0,y:0},{x:b,y:S},{width:B,height:V}),a.RGBAImage.copy(M,h,{x:0,y:V-1},{x:b,y:S-1},{width:B,height:1}),a.RGBAImage.copy(M,h,{x:0,y:0},{x:b,y:S+V},{width:B,height:1}),a.RGBAImage.copy(M,h,{x:B-1,y:0},{x:b-1,y:S},{width:1,height:V}),a.RGBAImage.copy(M,h,{x:0,y:0},{x:b+B,y:S},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const _ of c){if(this.callbackDispatchedThisFrame[_])continue;this.callbackDispatchedThisFrame[_]=!0;const l=this.images[_];l||a.warnOnce(`Image with ID: "${_}" was not found`),ae(l)&&this.updateImage(_,l)}}}const ne=1e20;function ie(k,c,_,l,h,d,x,b,S){for(let M=c;M<c+l;M++)fe(k,_*d+M,d,h,x,b,S);for(let M=_;M<_+h;M++)fe(k,M*d+c,1,l,x,b,S)}function fe(k,c,_,l,h,d,x){d[0]=0,x[0]=-ne,x[1]=ne,h[0]=k[c];for(let b=1,S=0,M=0;b<l;b++){h[b]=k[c+b*_];const B=b*b;do{const V=d[S];M=(h[b]-h[V]+B-V*V)/(b-V)/2}while(M<=x[S]&&--S>-1);S++,d[S]=b,x[S]=M,x[S+1]=ne}for(let b=0,S=0;b<l;b++){for(;x[S+1]<b;)S++;const M=d[S],B=b-M;k[c+b*_]=h[M]+B*B}}class ye{constructor(c,_){this.requestManager=c,this.localIdeographFontFamily=_,this.entries={}}setURL(c){this.url=c}getGlyphs(c,_){const l=[];for(const h in c)for(const d of c[h])l.push({stack:h,id:d});a.asyncAll(l,({stack:h,id:d},x)=>{let b=this.entries[h];b||(b=this.entries[h]={glyphs:{},requests:{},ranges:{}});let S=b.glyphs[d];if(S!==void 0)return void x(null,{stack:h,id:d,glyph:S});if(S=this._tinySDF(b,h,d),S)return b.glyphs[d]=S,void x(null,{stack:h,id:d,glyph:S});const M=Math.floor(d/256);if(256*M>65535)return void x(new Error("glyphs > 65535 not supported"));if(b.ranges[M])return void x(null,{stack:h,id:d,glyph:S});let B=b.requests[M];B||(B=b.requests[M]=[],ye.loadGlyphRange(h,M,this.url,this.requestManager,(V,$)=>{if($){for(const Y in $)this._doesCharSupportLocalGlyph(+Y)||(b.glyphs[+Y]=$[+Y]);b.ranges[M]=!0}for(const Y of B)Y(V,$);delete b.requests[M]})),B.push((V,$)=>{V?x(V):$&&x(null,{stack:h,id:d,glyph:$[d]||null})})},(h,d)=>{if(h)_(h);else if(d){const x={};for(const{stack:b,id:S,glyph:M}of d)(x[b]||(x[b]={}))[S]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};_(null,x)}})}_doesCharSupportLocalGlyph(c){return!!this.localIdeographFontFamily&&(a.unicodeBlockLookup["CJK Unified Ideographs"](c)||a.unicodeBlockLookup["Hangul Syllables"](c)||a.unicodeBlockLookup.Hiragana(c)||a.unicodeBlockLookup.Katakana(c))}_tinySDF(c,_,l){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let d=c.tinySDF;if(!d){let b="400";/bold/i.test(_)?b="900":/medium/i.test(_)?b="500":/light/i.test(_)&&(b="200"),d=c.tinySDF=new ye.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:h,fontWeight:b})}const x=d.draw(String.fromCharCode(l));return{id:l,bitmap:new a.AlphaImage({width:x.width||30,height:x.height||30},x.data),metrics:{width:x.glyphWidth||24,height:x.glyphHeight||24,left:x.glyphLeft||0,top:x.glyphTop-27||-8,advance:x.glyphAdvance||24}}}}ye.loadGlyphRange=function(k,c,_,l,h){const d=256*c,x=d+255,b=l.transformRequest(_.replace("{fontstack}",k).replace("{range}",`${d}-${x}`),a.ResourceType.Glyphs);a.getArrayBuffer(b,(S,M)=>{if(S)h(S);else if(M){const B={};for(const V of a.parseGlyphPbf(M))B[V.id]=V;h(null,B)}})},ye.TinySDF=class{constructor({fontSize:k=24,buffer:c=3,radius:_=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:d="normal",fontStyle:x="normal"}={}){this.buffer=c,this.cutoff=l,this.radius=_;const b=this.size=k+4*c,S=this._createCanvas(b),M=this.ctx=S.getContext("2d",{willReadFrequently:!0});M.font=`${x} ${d} ${k}px ${h}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(k){const c=document.createElement("canvas");return c.width=c.height=k,c}draw(k){const{width:c,actualBoundingBoxAscent:_,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:d}=this.ctx.measureText(k),x=Math.ceil(_),b=Math.min(this.size-this.buffer,Math.ceil(d-h)),S=Math.min(this.size-this.buffer,x+Math.ceil(l)),M=b+2*this.buffer,B=S+2*this.buffer,V=Math.max(M*B,0),$=new Uint8ClampedArray(V),Y={data:$,width:M,height:B,glyphWidth:b,glyphHeight:S,glyphTop:x,glyphLeft:0,glyphAdvance:c};if(b===0||S===0)return Y;const{ctx:oe,buffer:te,gridInner:ue,gridOuter:be}=this;oe.clearRect(te,te,b,S),oe.fillText(k,te,te+x);const Ce=oe.getImageData(te,te,b,S);be.fill(ne,0,V),ue.fill(0,0,V);for(let ve=0;ve<S;ve++)for(let Ge=0;Ge<b;Ge++){const Te=Ce.data[4*(ve*b+Ge)+3]/255;if(Te===0)continue;const Ve=(ve+te)*M+Ge+te;if(Te===1)be[Ve]=0,ue[Ve]=ne;else{const xe=.5-Te;be[Ve]=xe>0?xe*xe:0,ue[Ve]=xe<0?xe*xe:0}}ie(be,0,0,M,B,M,this.f,this.v,this.z),ie(ue,te,te,b,S,M,this.f,this.v,this.z);for(let ve=0;ve<V;ve++){const Ge=Math.sqrt(be[ve])-Math.sqrt(ue[ve]);$[ve]=Math.round(255-255*(Ge/this.radius+this.cutoff))}return Y}};const Me=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(k,c){return a.sphericalToCartesian(k.expression.evaluate(c))}interpolate(k,c,_){return{x:a.number(k.x,c.x,_),y:a.number(k.y,c.y,_),z:a.number(k.z,c.z,_)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),He="-transition";class Qe extends a.Evented{constructor(c){super(),this._transitionable=new a.Transitionable(Me),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,_={}){if(!this._validate(a.validateLight,c,_))for(const l in c){const h=c[l];l.endsWith(He)?this._transitionable.setTransition(l.slice(0,-He.length),h):this._transitionable.setValue(l,h)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,_,l){return(!l||l.validate!==!1)&&a.emitValidationErrors(this,c.call(a.validateStyle,a.extend({value:_,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class Je{constructor(c,_){this.width=c,this.height=_,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(c,_){const l=c.join(",")+String(_);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(c,_)),this.dashEntry[l]}getDashRanges(c,_,l){const h=[];let d=c.length%2==1?-c[c.length-1]*l:0,x=c[0]*l,b=!0;h.push({left:d,right:x,isDash:b,zeroLength:c[0]===0});let S=c[0];for(let M=1;M<c.length;M++){b=!b;const B=c[M];d=S*l,S+=B,x=S*l,h.push({left:d,right:x,isDash:b,zeroLength:B===0})}return h}addRoundDash(c,_,l){const h=_/2;for(let d=-l;d<=l;d++){const x=this.width*(this.nextRow+l+d);let b=0,S=c[b];for(let M=0;M<this.width;M++){M/S.right>1&&(S=c[++b]);const B=Math.abs(M-S.left),V=Math.abs(M-S.right),$=Math.min(B,V);let Y;const oe=d/l*(h+1);if(S.isDash){const te=h-Math.abs(oe);Y=Math.sqrt($*$+te*te)}else Y=h-Math.sqrt($*$+oe*oe);this.data[x+M]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(c){for(let b=c.length-1;b>=0;--b){const S=c[b],M=c[b+1];S.zeroLength?c.splice(b,1):M&&M.isDash===S.isDash&&(M.left=S.left,c.splice(b,1))}const _=c[0],l=c[c.length-1];_.isDash===l.isDash&&(_.left=l.left-this.width,l.right=_.right+this.width);const h=this.width*this.nextRow;let d=0,x=c[d];for(let b=0;b<this.width;b++){b/x.right>1&&(x=c[++d]);const S=Math.abs(b-x.left),M=Math.abs(b-x.right),B=Math.min(S,M);this.data[h+b]=Math.max(0,Math.min(255,(x.isDash?B:-B)+128))}}addDash(c,_){const l=_?7:0,h=2*l+1;if(this.nextRow+h>this.height)return a.warnOnce("LineAtlas out of space"),null;let d=0;for(let b=0;b<c.length;b++)d+=c[b];if(d!==0){const b=this.width/d,S=this.getDashRanges(c,this.width,b);_?this.addRoundDash(S,b,l):this.addRegularDash(S)}const x={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:d};return this.nextRow+=h,this.dirty=!0,x}bind(c){const _=c.gl;this.texture?(_.bindTexture(_.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,_.texSubImage2D(_.TEXTURE_2D,0,0,0,this.width,this.height,_.ALPHA,_.UNSIGNED_BYTE,this.data))):(this.texture=_.createTexture(),_.bindTexture(_.TEXTURE_2D,this.texture),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.REPEAT),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.REPEAT),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texImage2D(_.TEXTURE_2D,0,_.ALPHA,this.width,this.height,0,_.ALPHA,_.UNSIGNED_BYTE,this.data))}}class tt{constructor(c,_){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const l=this.workerPool.acquire(this.id);for(let h=0;h<l.length;h++){const d=new tt.Actor(l[h],_,this.id);d.name=`Worker ${h}`,this.actors.push(d)}if(!this.actors.length)throw new Error("No actors found")}broadcast(c,_,l){a.asyncAll(this.actors,(h,d)=>{h.send(c,_,d)},l=l||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ne(k,c,_){const l=function(h,d){if(h)return _(h);if(d){const x=a.pick(a.extend(d,k),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);d.vector_layers&&(x.vectorLayers=d.vector_layers,x.vectorLayerIds=x.vectorLayers.map(b=>b.id)),_(null,x)}};return k.url?a.getJSON(c.transformRequest(k.url,a.ResourceType.Source),l):a.exported.frame(()=>l(null,k))}tt.Actor=a.Actor;class nt{constructor(c,_,l){this.bounds=a.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=_||0,this.maxzoom=l||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const _=Math.pow(2,c.z),l=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*_),h=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*_),d=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*_),x=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*_);return c.x>=l&&c.x<d&&c.y>=h&&c.y<x}}class qe extends a.Evented{constructor(c,_,l,h){if(super(),this.id=c,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(_,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},_),this._collectResourceTiming=_.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ne(this._options,this.map._requestManager,(c,_)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),c?this.fire(new a.ErrorEvent(c)):_&&(a.extend(this,_),_.bounds&&(this.tileBounds=new nt(_.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}setSourceProperty(c){this._tileJSONRequest&&this._tileJSONRequest.cancel(),c(),this.load()}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}setUrl(c){return this.setSourceProperty(()=>{this.url=c,this._options.url=c}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(c,_){const l=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h={request:this.map._requestManager.transformRequest(l,a.ResourceType.Tile),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function d(x,b){return delete c.request,c.aborted?_(null):x&&x.status!==404?_(x):(b&&b.resourceTiming&&(c.resourceTiming=b.resourceTiming),this.map._refreshExpiredTiles&&b&&c.setExpiryData(b),c.loadVectorData(b,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),_(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}h.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired"?c.state==="loading"?c.reloadCallback=_:c.request=c.actor.send("reloadTile",h,d.bind(this)):(c.actor=this.dispatcher.getActor(),c.request=c.actor.send("loadTile",h,d.bind(this)))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id},void 0)}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class mt extends a.Evented{constructor(c,_,l,h){super(),this.id=c,this.dispatcher=l,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},_),a.extend(this,a.pick(_,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ne(this._options,this.map._requestManager,(c,_)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new a.ErrorEvent(c)):_&&(a.extend(this,_),_.bounds&&(this.tileBounds=new nt(_.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,_){const l=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);c.request=a.getImage(this.map._requestManager.transformRequest(l,a.ResourceType.Tile),(h,d,x)=>{if(delete c.request,c.aborted)c.state="unloaded",_(null);else if(h)c.state="errored",_(h);else if(d){this.map._refreshExpiredTiles&&c.setExpiryData(x);const b=this.map.painter.context,S=b.gl;c.texture=this.map.painter.getTileTexture(d.width),c.texture?c.texture.update(d,{useMipmap:!0}):(c.texture=new q(b,d,S.RGBA,{useMipmap:!0}),c.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),b.extTextureFilterAnisotropic&&S.texParameterf(S.TEXTURE_2D,b.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,b.extTextureFilterAnisotropicMax)),c.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),_(null)}})}abortTile(c,_){c.request&&(c.request.cancel(),delete c.request),_()}unloadTile(c,_){c.texture&&this.map.painter.saveTileTexture(c.texture),_()}hasTransition(){return!1}}let Xt;class Et extends mt{constructor(c,_,l,h){super(c,_,l,h),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},_),this.encoding=_.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(c,_){const l=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function h(d,x){d&&(c.state="errored",_(d)),x&&(c.dem=x,c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0,c.state="loaded",_(null))}c.request=a.getImage(this.map._requestManager.transformRequest(l,a.ResourceType.Tile),function(d,x){if(delete c.request,c.aborted)c.state="unloaded",_(null);else if(d)c.state="errored",_(d);else if(x){this.map._refreshExpiredTiles&&c.setExpiryData(x),delete x.cacheControl,delete x.expires;const b=a.isImageBitmap(x)&&(Xt==null&&(Xt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Xt)?x:a.exported.getImageData(x,1),S={uid:c.uid,coord:c.tileID,source:this.id,rawImageData:b,encoding:this.encoding};c.actor&&c.state!=="expired"||(c.actor=this.dispatcher.getActor(),c.actor.send("loadDEMTile",S,h.bind(this)))}}.bind(this)),c.neighboringTiles=this._getNeighboringTiles(c.tileID)}_getNeighboringTiles(c){const _=c.canonical,l=Math.pow(2,_.z),h=(_.x-1+l)%l,d=_.x===0?c.wrap-1:c.wrap,x=(_.x+1+l)%l,b=_.x+1===l?c.wrap+1:c.wrap,S={};return S[new a.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y).key]={backfilled:!1},S[new a.OverscaledTileID(c.overscaledZ,b,_.z,x,_.y).key]={backfilled:!1},_.y>0&&(S[new a.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y-1).key]={backfilled:!1},S[new a.OverscaledTileID(c.overscaledZ,c.wrap,_.z,_.x,_.y-1).key]={backfilled:!1},S[new a.OverscaledTileID(c.overscaledZ,b,_.z,x,_.y-1).key]={backfilled:!1}),_.y+1<l&&(S[new a.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y+1).key]={backfilled:!1},S[new a.OverscaledTileID(c.overscaledZ,c.wrap,_.z,_.x,_.y+1).key]={backfilled:!1},S[new a.OverscaledTileID(c.overscaledZ,b,_.z,x,_.y+1).key]={backfilled:!1}),S}unloadTile(c){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&c.actor.send("removeDEMTile",{uid:c.uid,source:this.id})}}class fn extends a.Evented{constructor(c,_,l,h){super(),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(h),this._data=_.data,this._options=a.extend({},_),this._collectResourceTiming=_.collectResourceTiming,_.maxzoom!==void 0&&(this.maxzoom=_.maxzoom),_.type&&(this.type=_.type),_.attribution&&(this.attribution=_.attribution),this.promoteId=_.promoteId;const d=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:_.cluster||!1,geojsonVtOptions:{buffer:(_.buffer!==void 0?_.buffer:128)*d,tolerance:(_.tolerance!==void 0?_.tolerance:.375)*d,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:_.lineMetrics||!1,generateId:_.generateId||!1},superclusterOptions:{maxZoom:_.clusterMaxZoom!==void 0?_.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,_.clusterMinPoints||2),extent:a.EXTENT,radius:(_.clusterRadius||50)*d,log:!1,generateId:_.generateId||!1},clusterProperties:_.clusterProperties,filter:_.filter},_.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(c){this.map=c,this.load()}setData(c){return this._data=c,this._updateWorkerData("content"),this}getClusterExpansionZoom(c,_){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:c,source:this.id},_),this}getClusterChildren(c,_){return this.actor.send("geojson.getClusterChildren",{clusterId:c,source:this.id},_),this}getClusterLeaves(c,_,l,h){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:c,limit:_,offset:l},h),this}_updateWorkerData(c){const _=a.extend({},this.workerOptions),l=this._data;typeof l=="string"?(_.request=this.map._requestManager.transformRequest(a.exported.resolveURL(l),a.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(l),this._pendingLoads++,this.fire(new a.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,_,(h,d)=>{if(this._pendingLoads--,this._removed||d&&d.abandoned)return void this.fire(new a.Event("dataabort",{dataType:"source",sourceDataType:c}));let x=null;if(d&&d.resourceTiming&&d.resourceTiming[this.id]&&(x=d.resourceTiming[this.id].slice(0)),h)return void this.fire(new a.ErrorEvent(h));const b={dataType:"source",sourceDataType:c};this._collectResourceTiming&&x&&x.length>0&&a.extend(b,{resourceTiming:x}),this.fire(new a.Event("data",b))})}loaded(){return this._pendingLoads===0}loadTile(c,_){const l=c.actor?"reloadTile":"loadTile";c.actor=this.actor;const h={type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};c.request=this.actor.send(l,h,(d,x)=>(delete c.request,c.unloadVectorData(),c.aborted?_(null):d?_(d):(c.loadVectorData(x,this.map.painter,l==="reloadTile"),_(null))))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.aborted=!0}unloadTile(c){c.unloadVectorData(),this.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var yt=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class bt extends a.Evented{constructor(c,_,l,h){super(),this.id=c,this.dispatcher=l,this.coordinates=_.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=_}load(c,_){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(l,h)=>{this._loaded=!0,l?this.fire(new a.ErrorEvent(l)):h&&(this.image=h,c&&(this.coordinates=c),_&&_(),this._finishLoading())})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this.options.url=c.url,this.load(c.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}setCoordinates(c){this.coordinates=c;const _=c.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(h){let d=1/0,x=1/0,b=-1/0,S=-1/0;for(const $ of h)d=Math.min(d,$.x),x=Math.min(x,$.y),b=Math.max(b,$.x),S=Math.max(S,$.y);const M=Math.max(b-d,S-x),B=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),V=Math.pow(2,B);return new a.CanonicalTileID(B,Math.floor((d+b)/2*V),Math.floor((x+S)/2*V))}(_),this.minzoom=this.maxzoom=this.tileID.z;const l=_.map(h=>this.tileID.getTilePoint(h)._round());return this._boundsArray=new a.RasterBoundsArray,this._boundsArray.emplaceBack(l[0].x,l[0].y,0,0),this._boundsArray.emplaceBack(l[1].x,l[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(l[3].x,l[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(l[2].x,l[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,_=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,yt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new q(c,this.image,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE));for(const l in this.tiles){const h=this.tiles[l];h.state!=="loaded"&&(h.state="loaded",h.texture=this.texture)}}loadTile(c,_){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},_(null)):(c.state="errored",_(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Kt extends bt{constructor(c,_,l,h){super(c,_,l,h),this.roundZoom=!0,this.type="video",this.options=_}load(){this._loaded=!1;const c=this.options;this.urls=[];for(const _ of c.urls)this.urls.push(this.map._requestManager.transformRequest(_,a.ResourceType.Source).url);a.getVideo(this.urls,(_,l)=>{this._loaded=!0,_?this.fire(new a.ErrorEvent(_)):l&&(this.video=l,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(c){if(this.video){const _=this.video.seekable;c<_.start(0)||c>_.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${_.start(0)} and ${_.end(0)}-second mark.`))):this.video.currentTime=c}}getVideo(){return this.video}onAdd(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const c=this.map.painter.context,_=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,yt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE),_.texSubImage2D(_.TEXTURE_2D,0,0,0,_.RGBA,_.UNSIGNED_BYTE,this.video)):(this.texture=new q(c,this.video,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE));for(const l in this.tiles){const h=this.tiles[l];h.state!=="loaded"&&(h.state="loaded",h.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class In extends bt{constructor(c,_,l,h){super(c,_,l,h),_.coordinates?Array.isArray(_.coordinates)&&_.coordinates.length===4&&!_.coordinates.some(d=>!Array.isArray(d)||d.length!==2||d.some(x=>typeof x!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${c}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${c}`,null,'missing required property "coordinates"'))),_.animate&&typeof _.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${c}`,null,'optional "animate" property must be a boolean value'))),_.canvas?typeof _.canvas=="string"||_.canvas instanceof HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${c}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${c}`,null,'missing required property "canvas"'))),this.options=_,this.animate=_.animate===void 0||_.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const _=this.map.painter.context,l=_.gl;this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,yt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(c||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new q(_,this.canvas,l.RGBA,{premultiply:!0});for(const h in this.tiles){const d=this.tiles[h];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const c of[this.canvas.width,this.canvas.height])if(isNaN(c)||c<=0)return!0;return!1}}const En={vector:qe,raster:mt,"raster-dem":Et,geojson:fn,video:Kt,image:bt,canvas:In};function Er(k,c){const _=a.create();return a.translate(_,_,[1,1,0]),a.scale(_,_,[.5*k.width,.5*k.height,1]),a.multiply(_,_,k.calculatePosMatrix(c.toUnwrapped()))}function Jn(k,c,_,l,h,d){const x=function(V,$,Y){if(V)for(const oe of V){const te=$[oe];if(te&&te.source===Y&&te.type==="fill-extrusion")return!0}else for(const oe in $){const te=$[oe];if(te.source===Y&&te.type==="fill-extrusion")return!0}return!1}(h&&h.layers,c,k.id),b=d.maxPitchScaleFactor(),S=k.tilesIn(l,b,x);S.sort(ir);const M=[];for(const V of S)M.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(c,_,k._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,h,d,b,Er(k.transform,V.tileID))});const B=function(V){const $={},Y={};for(const oe of V){const te=oe.queryResults,ue=oe.wrappedTileID,be=Y[ue]=Y[ue]||{};for(const Ce in te){const ve=te[Ce],Ge=be[Ce]=be[Ce]||{},Te=$[Ce]=$[Ce]||[];for(const Ve of ve)Ge[Ve.featureIndex]||(Ge[Ve.featureIndex]=!0,Te.push(Ve))}}return $}(M);for(const V in B)B[V].forEach($=>{const Y=$.feature,oe=k.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=oe});return B}function ir(k,c){const _=k.tileID,l=c.tileID;return _.overscaledZ-l.overscaledZ||_.canonical.y-l.canonical.y||_.wrap-l.wrap||_.canonical.x-l.canonical.x}class Ar{constructor(c,_){this.tileID=c,this.uid=a.uniqueId(),this.uses=0,this.tileSize=_,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(c){const _=c+this.timeAdded;_<a.exported.now()||this.fadeEndTime&&_<this.fadeEndTime||(this.fadeEndTime=_)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(c){this.demTexture&&c.saveTileTexture(this.demTexture),this.textures.forEach(_=>c.saveTileTexture(_)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(c,_,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(h,d){const x={};if(!d)return x;for(const b of h){const S=b.layerIds.map(M=>d.getLayer(M)).filter(Boolean);if(S.length!==0){b.layers=S,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(M=>S.filter(B=>B.id===M)[0]));for(const M of S)x[M.id]=b}}return x}(c.buckets,_.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const d=this.buckets[h];if(d instanceof a.SymbolBucket){if(this.hasSymbolBuckets=!0,!l)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const d=this.buckets[h];if(d instanceof a.SymbolBucket&&d.hasRTLText){this.hasRTLText=!0,a.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const h in this.buckets){const d=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,_.style.getLayer(h).queryRadius(d))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new a.CollisionBoxArray}unloadVectorData(){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(c){return this.buckets[c.id]}upload(c){for(const l in this.buckets){const h=this.buckets[l];h.uploadPending()&&h.upload(c)}const _=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new q(c,this.imageAtlas.image,_.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new q(c,this.glyphAtlasImage,_.ALPHA),this.glyphAtlasImage=null)}prepare(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)}queryRenderedFeatures(c,_,l,h,d,x,b,S,M,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:d,scale:x,tileSize:this.tileSize,pixelPosMatrix:B,transform:S,params:b,queryPadding:this.queryPadding*M},c,_,l):{}}querySourceFeatures(c,_){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const h=l.loadVTLayers(),d=_?_.sourceLayer:"",x=h._geojsonTileLayer||h[d];if(!x)return;const b=a.createFilter(_&&_.filter),{z:S,x:M,y:B}=this.tileID.canonical,V={z:S,x:M,y:B};for(let $=0;$<x.length;$++){const Y=x.feature($);if(b.needGeometry){const ue=a.toEvaluationFeature(Y,!0);if(!b.filter(new a.EvaluationParameters(this.tileID.overscaledZ),ue,this.tileID.canonical))continue}else if(!b.filter(new a.EvaluationParameters(this.tileID.overscaledZ),Y))continue;const oe=l.getId(Y,d),te=new a.GeoJSONFeature(Y,S,M,B,oe);te.tile=V,c.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(c){const _=this.expirationTime;if(c.cacheControl){const l=a.parseCacheControl(c.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){const l=Date.now();let h=!1;if(this.expirationTime>l)h=!1;else if(_)if(this.expirationTime<_)h=!0;else{const d=this.expirationTime-_;d?this.expirationTime=l+Math.max(d,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(c,_){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(c).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!_.style.hasLayer(h))continue;const d=this.buckets[h],x=d.layers[0].sourceLayer||"_geojsonTileLayer",b=l[x],S=c[x];if(!b||!S||Object.keys(S).length===0)continue;d.update(S,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});const M=_&&_.style&&_.style.getLayer(h);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(c){this.symbolFadeHoldUntil=a.exported.now()+c}setDependencies(c,_){const l={};for(const h of _)l[h]=!0;this.dependencies[c]=l}hasDependency(c,_){for(const l of c){const h=this.dependencies[l];if(h){for(const d of _)if(h[d])return!0}}return!1}}class Nn{constructor(c,_){this.max=c,this.onRemove=_,this.reset()}reset(){for(const c in this.data)for(const _ of this.data[c])_.timeout&&clearTimeout(_.timeout),this.onRemove(_.value);return this.data={},this.order=[],this}add(c,_,l){const h=c.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const d={value:_,timeout:void 0};if(l!==void 0&&(d.timeout=setTimeout(()=>{this.remove(c,d)},l)),this.data[h].push(d),this.order.push(h),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(c){return c.wrapped().key in this.data}getAndRemove(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null}_getAndRemoveByKey(c){const _=this.data[c].shift();return _.timeout&&clearTimeout(_.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),_.value}getByKey(c){const _=this.data[c];return _?_[0].value:null}get(c){return this.has(c)?this.data[c.wrapped().key][0].value:null}remove(c,_){if(!this.has(c))return this;const l=c.wrapped().key,h=_===void 0?0:this.data[l].indexOf(_),d=this.data[l][h];return this.data[l].splice(h,1),d.timeout&&clearTimeout(d.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(d.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(c){for(this.max=c;this.order.length>this.max;){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}filter(c){const _=[];for(const l in this.data)for(const h of this.data[l])c(h.value)||_.push(h);for(const l of _)this.remove(l.value.tileID,l)}}class xr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,_,l){const h=String(_);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][h]=this.stateChanges[c][h]||{},a.extend(this.stateChanges[c][h],l),this.deletedStates[c]===null){this.deletedStates[c]={};for(const d in this.state[c])d!==h&&(this.deletedStates[c][d]=null)}else if(this.deletedStates[c]&&this.deletedStates[c][h]===null){this.deletedStates[c][h]={};for(const d in this.state[c][h])l[d]||(this.deletedStates[c][h][d]=null)}else for(const d in l)this.deletedStates[c]&&this.deletedStates[c][h]&&this.deletedStates[c][h][d]===null&&delete this.deletedStates[c][h][d]}removeFeatureState(c,_,l){if(this.deletedStates[c]===null)return;const h=String(_);if(this.deletedStates[c]=this.deletedStates[c]||{},l&&_!==void 0)this.deletedStates[c][h]!==null&&(this.deletedStates[c][h]=this.deletedStates[c][h]||{},this.deletedStates[c][h][l]=null);else if(_!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][h])for(l in this.deletedStates[c][h]={},this.stateChanges[c][h])this.deletedStates[c][h][l]=null;else this.deletedStates[c][h]=null;else this.deletedStates[c]=null}getState(c,_){const l=String(_),h=a.extend({},(this.state[c]||{})[l],(this.stateChanges[c]||{})[l]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){const d=this.deletedStates[c][_];if(d===null)return{};for(const x in d)delete h[x]}return h}initializeTileState(c,_){c.setFeatureState(this.state,_)}coalesceChanges(c,_){const l={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const d={};for(const x in this.stateChanges[h])this.state[h][x]||(this.state[h][x]={}),a.extend(this.state[h][x],this.stateChanges[h][x]),d[x]=this.state[h][x];l[h]=d}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const d={};if(this.deletedStates[h]===null)for(const x in this.state[h])d[x]={},this.state[h][x]={};else for(const x in this.deletedStates[h]){if(this.deletedStates[h][x]===null)this.state[h][x]={};else for(const b of Object.keys(this.deletedStates[h][x]))delete this.state[h][x][b];d[x]=this.state[h][x]}l[h]=l[h]||{},a.extend(l[h],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const h in c)c[h].setFeatureState(l,_)}}class xt extends a.Evented{constructor(c,_,l){super(),this.id=c,this.dispatcher=l,this.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(h,d,x,b){const S=new En[d.type](h,d,x,b);if(S.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${S.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],S),S}(c,_,l,this),this._tiles={},this._cache=new Nn(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new xr}onAdd(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(c)}onRemove(c){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(c)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const c in this._tiles){const _=this._tiles[c];if(_.state!=="loaded"&&_.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(c,_){return this._source.loadTile(c,_)}_unloadTile(c){if(this._source.unloadTile)return this._source.unloadTile(c,()=>{})}_abortTile(c){this._source.abortTile&&this._source.abortTile(c,()=>{}),this._source.fire(new a.Event("dataabort",{tile:c,coord:c.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(c){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const _ in this._tiles){const l=this._tiles[_];l.upload(c),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(c=>c.tileID).sort(nn).map(c=>c.key)}getRenderableIds(c){const _=[];for(const l in this._tiles)this._isIdRenderable(l,c)&&_.push(this._tiles[l]);return c?_.sort((l,h)=>{const d=l.tileID,x=h.tileID,b=new a.pointGeometry(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),S=new a.pointGeometry(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-x.overscaledZ||S.y-b.y||S.x-b.x}).map(l=>l.tileID.key):_.map(l=>l.tileID).sort(nn).map(l=>l.key)}hasRenderableParent(c){const _=this.findLoadedParent(c,0);return!!_&&this._isIdRenderable(_.tileID.key)}_isIdRenderable(c,_){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(_||!this._tiles[c].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)this._tiles[c].state!=="errored"&&this._reloadTile(c,"reloading")}}_reloadTile(c,_){const l=this._tiles[c];l&&(l.state!=="loading"&&(l.state=_),this._loadTile(l,this._tileLoaded.bind(this,l,c,_)))}_tileLoaded(c,_,l,h){if(h)return c.state="errored",void(h.status!==404?this._source.fire(new a.ErrorEvent(h,{tile:c})):this.update(this.transform,this.terrain));c.timeAdded=a.exported.now(),l==="expired"&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(_,c),this.getSource().type==="raster-dem"&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),c.aborted||this._source.fire(new a.Event("data",{dataType:"source",tile:c,coord:c.tileID}))}_backfillDEM(c){const _=this.getRenderableIds();for(let h=0;h<_.length;h++){const d=_[h];if(c.neighboringTiles&&c.neighboringTiles[d]){const x=this.getTileByID(d);l(c,x),l(x,c)}}function l(h,d){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let x=d.tileID.canonical.x-h.tileID.canonical.x;const b=d.tileID.canonical.y-h.tileID.canonical.y,S=Math.pow(2,h.tileID.canonical.z),M=d.tileID.key;x===0&&b===0||Math.abs(b)>1||(Math.abs(x)>1&&(Math.abs(x+S)===1?x+=S:Math.abs(x-S)===1&&(x-=S)),d.dem&&h.dem&&(h.dem.backfillBorder(d.dem,x,b),h.neighboringTiles&&h.neighboringTiles[M]&&(h.neighboringTiles[M].backfilled=!0)))}}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._tiles[c]}_retainLoadedChildren(c,_,l,h){for(const d in this._tiles){let x=this._tiles[d];if(h[d]||!x.hasData()||x.tileID.overscaledZ<=_||x.tileID.overscaledZ>l)continue;let b=x.tileID;for(;x&&x.tileID.overscaledZ>_+1;){const M=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[M.key],x&&x.hasData()&&(b=M)}let S=b;for(;S.overscaledZ>_;)if(S=S.scaledTo(S.overscaledZ-1),c[S.key]){h[b.key]=b;break}}}findLoadedParent(c,_){if(c.key in this._loadedParentTiles){const l=this._loadedParentTiles[c.key];return l&&l.tileID.overscaledZ>=_?l:null}for(let l=c.overscaledZ-1;l>=_;l--){const h=c.scaledTo(l),d=this._getLoadedTile(h);if(d)return d}}_getLoadedTile(c){const _=this._tiles[c.key];return _&&_.hasData()?_:this._cache.getByKey(c.wrapped().key)}updateCacheSize(c){const _=Math.ceil(c.width/this._source.tileSize)+1,l=Math.ceil(c.height/this._source.tileSize)+1,h=Math.floor(_*l*5),d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(d)}handleWrapJump(c){const _=Math.round((c-(this._prevLng===void 0?c:this._prevLng))/360);if(this._prevLng=c,_){const l={};for(const h in this._tiles){const d=this._tiles[h];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+_),l[d.tileID.key]=d}this._tiles=l;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}update(c,_){if(this.transform=c,this.terrain=_,!this._sourceLoaded||this._paused)return;let l;this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new a.OverscaledTileID(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(l=c.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:_}),this._source.hasTile&&(l=l.filter(M=>this._source.hasTile(M)))):l=[];const h=c.coveringZoomLevel(this._source),d=Math.max(h-xt.maxOverzooming,this._source.minzoom),x=Math.max(h+xt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const M={};for(const B of l)if(B.canonical.z>this._source.minzoom){const V=B.scaledTo(B.canonical.z-1);M[V.key]=V;const $=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));M[$.key]=$}l=l.concat(Object.values(M))}const b=this._updateRetainedTiles(l,h);if(Mn(this._source.type)){const M={},B={},V=Object.keys(b);for(const $ of V){const Y=b[$],oe=this._tiles[$];if(!oe||oe.fadeEndTime&&oe.fadeEndTime<=a.exported.now())continue;const te=this.findLoadedParent(Y,d);te&&(this._addTile(te.tileID),M[te.tileID.key]=te.tileID),B[$]=Y}this._retainLoadedChildren(B,h,x,b);for(const $ in M)b[$]||(this._coveredTiles[$]=!0,b[$]=M[$]);if(_){const $={},Y={};for(const oe of l)this._tiles[oe.key].hasData()?$[oe.key]=oe:Y[oe.key]=oe;for(const oe in Y){const te=Y[oe].children(this._source.maxzoom);this._tiles[te[0].key]&&this._tiles[te[1].key]&&this._tiles[te[2].key]&&this._tiles[te[3].key]&&($[te[0].key]=b[te[0].key]=te[0],$[te[1].key]=b[te[1].key]=te[1],$[te[2].key]=b[te[2].key]=te[2],$[te[3].key]=b[te[3].key]=te[3],delete Y[oe])}for(const oe in Y){const te=this.findLoadedParent(Y[oe],this._source.minzoom);if(te){$[te.tileID.key]=b[te.tileID.key]=te.tileID;for(const ue in $)$[ue].isChildOf(te.tileID)&&delete $[ue]}}for(const oe in this._tiles)$[oe]||(this._coveredTiles[oe]=!0)}}for(const M in b)this._tiles[M].clearFadeHold();const S=a.keysDifference(this._tiles,b);for(const M of S){const B=this._tiles[M];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(M)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(c)}_updateRetainedTiles(c,_){const l={},h={},d=Math.max(_-xt.maxOverzooming,this._source.minzoom),x=Math.max(_+xt.maxUnderzooming,this._source.minzoom),b={};for(const S of c){const M=this._addTile(S);l[S.key]=S,M.hasData()||_<this._source.maxzoom&&(b[S.key]=S)}this._retainLoadedChildren(b,_,x,l);for(const S of c){let M=this._tiles[S.key];if(M.hasData())continue;if(_+1>this._source.maxzoom){const V=S.children(this._source.maxzoom)[0],$=this.getTile(V);if($&&$.hasData()){l[V.key]=V;continue}}else{const V=S.children(this._source.maxzoom);if(l[V[0].key]&&l[V[1].key]&&l[V[2].key]&&l[V[3].key])continue}let B=M.wasRequested();for(let V=S.overscaledZ-1;V>=d;--V){const $=S.scaledTo(V);if(h[$.key]||(h[$.key]=!0,M=this.getTile($),!M&&B&&(M=this._addTile($)),M&&(l[$.key]=$,B=M.wasRequested(),M.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const c in this._tiles){const _=[];let l,h=this._tiles[c].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}_.push(h.key);const d=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(d),l)break;h=d}for(const d of _)this._loadedParentTiles[d]=l}}_addTile(c){let _=this._tiles[c.key];if(_)return _;_=this._cache.getAndRemove(c),_&&(this._setTileReloadTimer(c.key,_),_.tileID=c,this._state.initializeTileState(_,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,_)));const l=_;return _||(_=new Ar(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(_,this._tileLoaded.bind(this,_,c.key,_.state))),_.uses++,this._tiles[c.key]=_,l||this._source.fire(new a.Event("dataloading",{tile:_,coord:_.tileID,dataType:"source"})),_}_setTileReloadTimer(c,_){c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);const l=_.getExpiryTimeout();l&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},l))}_removeTile(c){const _=this._tiles[c];_&&(_.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),_.uses>0||(_.hasData()&&_.state!=="reloading"?this._cache.add(_.tileID,_,_.getExpiryTimeout()):(_.aborted=!0,this._abortTile(_),this._unloadTile(_))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const c in this._tiles)this._removeTile(c);this._cache.reset()}tilesIn(c,_,l){const h=[],d=this.transform;if(!d)return h;const x=l?d.getCameraQueryGeometry(c):c,b=c.map(oe=>d.pointCoordinate(oe,this.terrain)),S=x.map(oe=>d.pointCoordinate(oe,this.terrain)),M=this.getIds();let B=1/0,V=1/0,$=-1/0,Y=-1/0;for(const oe of S)B=Math.min(B,oe.x),V=Math.min(V,oe.y),$=Math.max($,oe.x),Y=Math.max(Y,oe.y);for(let oe=0;oe<M.length;oe++){const te=this._tiles[M[oe]];if(te.holdingForFade())continue;const ue=te.tileID,be=Math.pow(2,d.zoom-te.tileID.overscaledZ),Ce=_*te.queryPadding*a.EXTENT/te.tileSize/be,ve=[ue.getTilePoint(new a.MercatorCoordinate(B,V)),ue.getTilePoint(new a.MercatorCoordinate($,Y))];if(ve[0].x-Ce<a.EXTENT&&ve[0].y-Ce<a.EXTENT&&ve[1].x+Ce>=0&&ve[1].y+Ce>=0){const Ge=b.map(Ve=>ue.getTilePoint(Ve)),Te=S.map(Ve=>ue.getTilePoint(Ve));h.push({tile:te,tileID:ue,queryGeometry:Ge,cameraQueryGeometry:Te,scale:be})}}return h}getVisibleCoordinates(c){const _=this.getRenderableIds(c).map(l=>this._tiles[l].tileID);for(const l of _)l.posMatrix=this.transform.calculatePosMatrix(l.toUnwrapped());return _}hasTransition(){if(this._source.hasTransition())return!0;if(Mn(this._source.type))for(const c in this._tiles){const _=this._tiles[c];if(_.fadeEndTime!==void 0&&_.fadeEndTime>=a.exported.now())return!0}return!1}setFeatureState(c,_,l){this._state.updateState(c=c||"_geojsonTileLayer",_,l)}removeFeatureState(c,_,l){this._state.removeFeatureState(c=c||"_geojsonTileLayer",_,l)}getFeatureState(c,_){return this._state.getState(c=c||"_geojsonTileLayer",_)}setDependencies(c,_,l){const h=this._tiles[c];h&&h.setDependencies(_,l)}reloadTilesForDependencies(c,_){for(const l in this._tiles)this._tiles[l].hasDependency(c,_)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(c,_))}}function nn(k,c){const _=Math.abs(2*k.wrap)-+(k.wrap<0),l=Math.abs(2*c.wrap)-+(c.wrap<0);return k.overscaledZ-c.overscaledZ||l-_||c.canonical.y-k.canonical.y||c.canonical.x-k.canonical.x}function Mn(k){return k==="raster"||k==="image"||k==="video"}xt.maxOverzooming=10,xt.maxUnderzooming=3;const vt="mapboxgl_preloaded_worker_pool";class er{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<er.workerCount;)this.workers.push(new Worker(Fs.workerUrl));return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(_=>{_.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[vt]}numActive(){return Object.keys(this.active).length}}const $n=Math.floor(a.exported.hardwareConcurrency/2);let gr;function or(){return gr||(gr=new er),gr}function tr(k,c){const _={};for(const l in k)l!=="ref"&&(_[l]=k[l]);return a.refProperties.forEach(l=>{l in c&&(_[l]=c[l])}),_}function Zr(k){k=k.slice();const c=Object.create(null);for(let _=0;_<k.length;_++)c[k[_].id]=k[_];for(let _=0;_<k.length;_++)"ref"in k[_]&&(k[_]=tr(k[_],c[k[_].ref]));return k}er.workerCount=Math.max(Math.min($n,6),1);const Un={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function wi(k,c,_){_.push({command:Un.addSource,args:[k,c[k]]})}function Hn(k,c,_){c.push({command:Un.removeSource,args:[k]}),_[k]=!0}function Di(k,c,_,l){Hn(k,_,l),wi(k,c,_)}function oo(k,c,_){let l;for(l in k[_])if(Object.prototype.hasOwnProperty.call(k[_],l)&&l!=="data"&&!I(k[_][l],c[_][l]))return!1;for(l in c[_])if(Object.prototype.hasOwnProperty.call(c[_],l)&&l!=="data"&&!I(k[_][l],c[_][l]))return!1;return!0}function zr(k,c,_,l,h,d){let x;for(x in c=c||{},k=k||{})Object.prototype.hasOwnProperty.call(k,x)&&(I(k[x],c[x])||_.push({command:d,args:[l,x,c[x],h]}));for(x in c)Object.prototype.hasOwnProperty.call(c,x)&&!Object.prototype.hasOwnProperty.call(k,x)&&(I(k[x],c[x])||_.push({command:d,args:[l,x,c[x],h]}))}function bi(k){return k.id}function Io(k,c){return k[c.id]=c,k}class Ki{constructor(c,_){this.reset(c,_)}reset(c,_){this.points=c||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(_||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=a.clamp(c,0,1);let _=1,l=this._distances[_];const h=c*this.paddedLength+this.padding;for(;l<h&&_<this._distances.length;)l=this._distances[++_];const d=_-1,x=this._distances[d],b=l-x,S=b>0?(h-x)/b:0;return this.points[d].mult(1-S).add(this.points[_].mult(S))}}function ct(k,c){let _=!0;return k==="always"||k!=="never"&&c!=="never"||(_=!1),_}class It{constructor(c,_,l){const h=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(c/l),this.yCellCount=Math.ceil(_/l);for(let x=0;x<this.xCellCount*this.yCellCount;x++)h.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=_,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/_,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,_,l,h,d){this._forEachCell(_,l,h,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(_),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(d)}insertCircle(c,_,l,h){this._forEachCell(_-h,l-h,_+h,l+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(_),this.circles.push(l),this.circles.push(h)}_insertBoxCell(c,_,l,h,d,x){this.boxCells[d].push(x)}_insertCircleCell(c,_,l,h,d,x){this.circleCells[d].push(x)}_query(c,_,l,h,d,x,b){if(l<0||c>this.width||h<0||_>this.height)return[];const S=[];if(c<=0&&_<=0&&this.width<=l&&this.height<=h){if(d)return[{key:null,x1:c,y1:_,x2:l,y2:h}];for(let M=0;M<this.boxKeys.length;M++)S.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const B=this.circles[3*M],V=this.circles[3*M+1],$=this.circles[3*M+2];S.push({key:this.circleKeys[M],x1:B-$,y1:V-$,x2:B+$,y2:V+$})}}else this._forEachCell(c,_,l,h,this._queryCell,S,{hitTest:d,overlapMode:x,seenUids:{box:{},circle:{}}},b);return S}query(c,_,l,h){return this._query(c,_,l,h,!1,null)}hitTest(c,_,l,h,d,x){return this._query(c,_,l,h,!0,d,x).length>0}hitTestCircle(c,_,l,h,d){const x=c-l,b=c+l,S=_-l,M=_+l;if(b<0||x>this.width||M<0||S>this.height)return!1;const B=[];return this._forEachCell(x,S,b,M,this._queryCellCircle,B,{hitTest:!0,overlapMode:h,circle:{x:c,y:_,radius:l},seenUids:{box:{},circle:{}}},d),B.length>0}_queryCell(c,_,l,h,d,x,b,S){const{seenUids:M,hitTest:B,overlapMode:V}=b,$=this.boxCells[d];if($!==null){const oe=this.bboxes;for(const te of $)if(!M.box[te]){M.box[te]=!0;const ue=4*te,be=this.boxKeys[te];if(c<=oe[ue+2]&&_<=oe[ue+3]&&l>=oe[ue+0]&&h>=oe[ue+1]&&(!S||S(be))&&(!B||!ct(V,be.overlapMode))&&(x.push({key:be,x1:oe[ue],y1:oe[ue+1],x2:oe[ue+2],y2:oe[ue+3]}),B))return!0}}const Y=this.circleCells[d];if(Y!==null){const oe=this.circles;for(const te of Y)if(!M.circle[te]){M.circle[te]=!0;const ue=3*te,be=this.circleKeys[te];if(this._circleAndRectCollide(oe[ue],oe[ue+1],oe[ue+2],c,_,l,h)&&(!S||S(be))&&(!B||!ct(V,be.overlapMode))){const Ce=oe[ue],ve=oe[ue+1],Ge=oe[ue+2];if(x.push({key:be,x1:Ce-Ge,y1:ve-Ge,x2:Ce+Ge,y2:ve+Ge}),B)return!0}}}return!1}_queryCellCircle(c,_,l,h,d,x,b,S){const{circle:M,seenUids:B,overlapMode:V}=b,$=this.boxCells[d];if($!==null){const oe=this.bboxes;for(const te of $)if(!B.box[te]){B.box[te]=!0;const ue=4*te,be=this.boxKeys[te];if(this._circleAndRectCollide(M.x,M.y,M.radius,oe[ue+0],oe[ue+1],oe[ue+2],oe[ue+3])&&(!S||S(be))&&!ct(V,be.overlapMode))return x.push(!0),!0}}const Y=this.circleCells[d];if(Y!==null){const oe=this.circles;for(const te of Y)if(!B.circle[te]){B.circle[te]=!0;const ue=3*te,be=this.circleKeys[te];if(this._circlesCollide(oe[ue],oe[ue+1],oe[ue+2],M.x,M.y,M.radius)&&(!S||S(be))&&!ct(V,be.overlapMode))return x.push(!0),!0}}}_forEachCell(c,_,l,h,d,x,b,S){const M=this._convertToXCellCoord(c),B=this._convertToYCellCoord(_),V=this._convertToXCellCoord(l),$=this._convertToYCellCoord(h);for(let Y=M;Y<=V;Y++)for(let oe=B;oe<=$;oe++)if(d.call(this,c,_,l,h,this.xCellCount*oe+Y,x,b,S))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,_,l,h,d,x){const b=h-c,S=d-_,M=l+x;return M*M>b*b+S*S}_circleAndRectCollide(c,_,l,h,d,x,b){const S=(x-h)/2,M=Math.abs(c-(h+S));if(M>S+l)return!1;const B=(b-d)/2,V=Math.abs(_-(d+B));if(V>B+l)return!1;if(M<=S||V<=B)return!0;const $=M-S,Y=V-B;return $*$+Y*Y<=l*l}}function Ms(k,c,_,l,h){const d=a.create();return c?(a.scale(d,d,[1/h,1/h,1]),_||a.rotateZ(d,d,l.angle)):a.multiply(d,l.labelPlaneMatrix,k),d}function pi(k,c,_,l,h){if(c){const d=a.clone(k);return a.scale(d,d,[h,h,1]),_||a.rotateZ(d,d,-l.angle),d}return l.glCoordMatrix}function Rn(k,c,_){let l;_?(l=[k.x,k.y,_(k.x,k.y),1],a.transformMat4(l,l,c)):(l=[k.x,k.y,0,1],Ze(l,l,c));const h=l[3];return{point:new a.pointGeometry(l[0]/h,l[1]/h),signedDistanceFromCamera:h}}function Ri(k,c){return .5+k/c*.5}function Ei(k,c){const _=k[0]/k[3],l=k[1]/k[3];return _>=-c[0]&&_<=c[0]&&l>=-c[1]&&l<=c[1]}function Ti(k,c,_,l,h,d,x,b,S,M){const B=l?k.textSizeData:k.iconSizeData,V=a.evaluateSizeForZoom(B,_.transform.zoom),$=[256/_.width*2+1,256/_.height*2+1],Y=l?k.text.dynamicLayoutVertexArray:k.icon.dynamicLayoutVertexArray;Y.clear();const oe=k.lineVertexArray,te=l?k.text.placedSymbolArray:k.icon.placedSymbolArray,ue=_.transform.width/_.transform.height;let be=!1;for(let Ce=0;Ce<te.length;Ce++){const ve=te.get(Ce);if(ve.hidden||ve.writingMode===a.WritingMode.vertical&&!be){mn(ve.numGlyphs,Y);continue}let Ge;if(be=!1,M?(Ge=[ve.anchorX,ve.anchorY,M(ve.anchorX,ve.anchorY),1],a.transformMat4(Ge,Ge,c)):(Ge=[ve.anchorX,ve.anchorY,0,1],Ze(Ge,Ge,c)),!Ei(Ge,$)){mn(ve.numGlyphs,Y);continue}const Te=Ri(_.transform.cameraToCenterDistance,Ge[3]),Ve=a.evaluateSizeForFeature(B,V,ve),xe=x?Ve/Te:Ve*Te,m=new a.pointGeometry(ve.anchorX,ve.anchorY),g=Rn(m,h,M).point,v={},E=Tn(ve,xe,!1,b,c,h,d,k.glyphOffsetArray,oe,Y,g,m,v,ue,S,M);be=E.useVertical,(E.notEnoughRoom||be||E.needsFlipping&&Tn(ve,xe,!0,b,c,h,d,k.glyphOffsetArray,oe,Y,g,m,v,ue,S,M).notEnoughRoom)&&mn(ve.numGlyphs,Y)}l?k.text.dynamicLayoutVertexBuffer.updateData(Y):k.icon.dynamicLayoutVertexBuffer.updateData(Y)}function Ji(k,c,_,l,h,d,x,b,S,M,B,V,$){const Y=b.glyphStartIndex+b.numGlyphs,oe=b.lineStartIndex,te=b.lineStartIndex+b.lineLength,ue=c.getoffsetX(b.glyphStartIndex),be=c.getoffsetX(Y-1),Ce=Mr(k*ue,_,l,h,d,x,b.segment,oe,te,S,M,B,V,$);if(!Ce)return null;const ve=Mr(k*be,_,l,h,d,x,b.segment,oe,te,S,M,B,V,$);return ve?{first:Ce,last:ve}:null}function kt(k,c,_,l){return k===a.WritingMode.horizontal&&Math.abs(_.y-c.y)>Math.abs(_.x-c.x)*l?{useVertical:!0}:(k===a.WritingMode.vertical?c.y<_.y:c.x>_.x)?{needsFlipping:!0}:null}function Tn(k,c,_,l,h,d,x,b,S,M,B,V,$,Y,oe,te){const ue=c/24,be=k.lineOffsetX*ue,Ce=k.lineOffsetY*ue;let ve;if(k.numGlyphs>1){const Ge=k.glyphStartIndex+k.numGlyphs,Te=k.lineStartIndex,Ve=k.lineStartIndex+k.lineLength,xe=Ji(ue,b,be,Ce,_,B,V,k,S,d,$,oe,te);if(!xe)return{notEnoughRoom:!0};const m=Rn(xe.first.point,x,te).point,g=Rn(xe.last.point,x,te).point;if(l&&!_){const v=kt(k.writingMode,m,g,Y);if(v)return v}ve=[xe.first];for(let v=k.glyphStartIndex+1;v<Ge-1;v++)ve.push(Mr(ue*b.getoffsetX(v),be,Ce,_,B,V,k.segment,Te,Ve,S,d,$,oe,te));ve.push(xe.last)}else{if(l&&!_){const Te=Rn(V,h,te).point,Ve=k.lineStartIndex+k.segment+1,xe=new a.pointGeometry(S.getx(Ve),S.gety(Ve)),m=Rn(xe,h,te),g=m.signedDistanceFromCamera>0?m.point:wn(V,xe,Te,1,h,te),v=kt(k.writingMode,Te,g,Y);if(v)return v}const Ge=Mr(ue*b.getoffsetX(k.glyphStartIndex),be,Ce,_,B,V,k.segment,k.lineStartIndex,k.lineStartIndex+k.lineLength,S,d,$,oe,te);if(!Ge)return{notEnoughRoom:!0};ve=[Ge]}for(const Ge of ve)a.addDynamicAttributes(M,Ge.point,Ge.angle);return{}}function wn(k,c,_,l,h,d){const x=Rn(k.add(k.sub(c)._unit()),h,d).point,b=_.sub(x);return _.add(b._mult(l/b.mag()))}function Mr(k,c,_,l,h,d,x,b,S,M,B,V,$,Y){const oe=l?k-c:k+c;let te=oe>0?1:-1,ue=0;l&&(te*=-1,ue=Math.PI),te<0&&(ue+=Math.PI);let be=te>0?b+x:b+x+1,Ce=h,ve=h,Ge=0,Te=0;const Ve=Math.abs(oe),xe=[];for(;Ge+Te<=Ve;){if(be+=te,be<b||be>=S)return null;if(ve=Ce,xe.push(Ce),Ce=V[be],Ce===void 0){const C=new a.pointGeometry(M.getx(be),M.gety(be)),R=Rn(C,B,Y);if(R.signedDistanceFromCamera>0)Ce=V[be]=R.point;else{const O=be-te;Ce=wn(Ge===0?d:new a.pointGeometry(M.getx(O),M.gety(O)),C,ve,Ve-Ge+1,B,Y)}}Ge+=Te,Te=ve.dist(Ce)}const m=(Ve-Ge)/Te,g=Ce.sub(ve),v=g.mult(m)._add(ve);v._add(g._unit()._perp()._mult(_*te));const E=ue+Math.atan2(Ce.y-ve.y,Ce.x-ve.x);return xe.push(v),{point:v,angle:$?E:0,path:xe}}const fs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function mn(k,c){for(let _=0;_<k;_++){const l=c.length;c.resize(l+4),c.float32.set(fs,3*l)}}function Ze(k,c,_){const l=c[0],h=c[1];return k[0]=_[0]*l+_[4]*h+_[12],k[1]=_[1]*l+_[5]*h+_[13],k[3]=_[3]*l+_[7]*h+_[15],k}const Vr=100;class Cs{constructor(c,_=new It(c.width+200,c.height+200,25),l=new It(c.width+200,c.height+200,25)){this.transform=c,this.grid=_,this.ignoredGrid=l,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Vr,this.screenBottomBoundary=c.height+Vr,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(c,_,l,h,d,x){const b=this.projectAndGetPerspectiveRatio(h,c.anchorPointX,c.anchorPointY,x),S=l*b.perspectiveRatio,M=c.x1*S+b.point.x,B=c.y1*S+b.point.y,V=c.x2*S+b.point.x,$=c.y2*S+b.point.y;return!this.isInsideGrid(M,B,V,$)||_!=="always"&&this.grid.hitTest(M,B,V,$,_,d)||b.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[M,B,V,$],offscreen:this.isOffscreen(M,B,V,$)}}placeCollisionCircles(c,_,l,h,d,x,b,S,M,B,V,$,Y,oe){const te=[],ue=new a.pointGeometry(_.anchorX,_.anchorY),be=Rn(ue,x,oe),Ce=Ri(this.transform.cameraToCenterDistance,be.signedDistanceFromCamera),ve=(B?d/Ce:d*Ce)/a.ONE_EM,Ge=Rn(ue,b,oe).point,Te=Ji(ve,h,_.lineOffsetX*ve,_.lineOffsetY*ve,!1,Ge,ue,_,l,b,{},!1,oe);let Ve=!1,xe=!1,m=!0;if(Te){const g=.5*$*Ce+Y,v=new a.pointGeometry(-100,-100),E=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),C=new Ki,R=Te.first,O=Te.last;let N=[];for(let le=R.path.length-1;le>=1;le--)N.push(R.path[le]);for(let le=1;le<O.path.length;le++)N.push(O.path[le]);const Q=2.5*g;if(S){const le=N.map(de=>Rn(de,S,oe));N=le.some(de=>de.signedDistanceFromCamera<=0)?[]:le.map(de=>de.point)}let J=[];if(N.length>0){const le=N[0].clone(),de=N[0].clone();for(let Re=1;Re<N.length;Re++)le.x=Math.min(le.x,N[Re].x),le.y=Math.min(le.y,N[Re].y),de.x=Math.max(de.x,N[Re].x),de.y=Math.max(de.y,N[Re].y);J=le.x>=v.x&&de.x<=E.x&&le.y>=v.y&&de.y<=E.y?[N]:de.x<v.x||le.x>E.x||de.y<v.y||le.y>E.y?[]:a.clipLine([N],v.x,v.y,E.x,E.y)}for(const le of J){C.reset(le,.25*g);let de=0;de=C.length<=.5*g?1:Math.ceil(C.paddedLength/Q)+1;for(let Re=0;Re<de;Re++){const je=Re/Math.max(de-1,1),Be=C.lerp(je),Ye=Be.x+Vr,ht=Be.y+Vr;te.push(Ye,ht,g,0);const ut=Ye-g,rt=ht-g,it=Ye+g,Xe=ht+g;if(m=m&&this.isOffscreen(ut,rt,it,Xe),xe=xe||this.isInsideGrid(ut,rt,it,Xe),c!=="always"&&this.grid.hitTestCircle(Ye,ht,g,c,V)&&(Ve=!0,!M))return{circles:[],offscreen:!1,collisionDetected:Ve}}}}return{circles:!M&&Ve||!xe||Ce<this.perspectiveRatioCutoff?[]:te,offscreen:m,collisionDetected:Ve}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const _=[];let l=1/0,h=1/0,d=-1/0,x=-1/0;for(const B of c){const V=new a.pointGeometry(B.x+Vr,B.y+Vr);l=Math.min(l,V.x),h=Math.min(h,V.y),d=Math.max(d,V.x),x=Math.max(x,V.y),_.push(V)}const b=this.grid.query(l,h,d,x).concat(this.ignoredGrid.query(l,h,d,x)),S={},M={};for(const B of b){const V=B.key;if(S[V.bucketInstanceId]===void 0&&(S[V.bucketInstanceId]={}),S[V.bucketInstanceId][V.featureIndex])continue;const $=[new a.pointGeometry(B.x1,B.y1),new a.pointGeometry(B.x2,B.y1),new a.pointGeometry(B.x2,B.y2),new a.pointGeometry(B.x1,B.y2)];a.polygonIntersectsPolygon(_,$)&&(S[V.bucketInstanceId][V.featureIndex]=!0,M[V.bucketInstanceId]===void 0&&(M[V.bucketInstanceId]=[]),M[V.bucketInstanceId].push(V.featureIndex))}return M}insertCollisionBox(c,_,l,h,d,x){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:d,collisionGroupID:x,overlapMode:_},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,_,l,h,d,x){const b=l?this.ignoredGrid:this.grid,S={bucketInstanceId:h,featureIndex:d,collisionGroupID:x,overlapMode:_};for(let M=0;M<c.length;M+=4)b.insertCircle(S,c[M],c[M+1],c[M+2])}projectAndGetPerspectiveRatio(c,_,l,h){let d;return h?(d=[_,l,h(_,l),1],a.transformMat4(d,d,c)):(d=[_,l,0,1],Ze(d,d,c)),{point:new a.pointGeometry((d[0]/d[3]+1)/2*this.transform.width+Vr,(-d[1]/d[3]+1)/2*this.transform.height+Vr),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}}isOffscreen(c,_,l,h){return l<Vr||c>=this.screenRightBoundary||h<Vr||_>this.screenBottomBoundary}isInsideGrid(c,_,l,h){return l>=0&&c<this.gridRightBoundary&&h>=0&&_<this.gridBottomBoundary}getViewportMatrix(){const c=a.identity([]);return a.translate(c,c,[-100,-100,0]),c}}function kr(k,c,_){return c*(a.EXTENT/(k.tileSize*Math.pow(2,_-k.tileID.overscaledZ)))}class ri{constructor(c,_,l,h){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?_:-_))):h&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class Zn{constructor(c,_,l,h,d){this.text=new ri(c?c.text:null,_,l,d),this.icon=new ri(c?c.icon:null,_,h,d)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ps{constructor(c,_,l){this.text=c,this.icon=_,this.skipFade=l}}class Bi{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class zi{constructor(c,_,l,h,d){this.bucketInstanceId=c,this.featureIndex=_,this.sourceLayerIndex=l,this.bucketIndex=h,this.tileID=d}}class Si{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const _=++this.maxGroupID;this.collisionGroups[c]={ID:_,predicate:l=>l.collisionGroupID===_}}return this.collisionGroups[c]}}function es(k,c,_,l,h){const{horizontalAlign:d,verticalAlign:x}=a.getAnchorAlignment(k),b=-(d-.5)*c,S=-(x-.5)*_,M=a.evaluateVariableOffset(k,l);return new a.pointGeometry(b+M[0]*h,S+M[1]*h)}function Lr(k,c,_,l,h,d){const{x1:x,x2:b,y1:S,y2:M,anchorPointX:B,anchorPointY:V}=k,$=new a.pointGeometry(c,_);return l&&$._rotate(h?d:-d),{x1:x+$.x,y1:S+$.y,x2:b+$.x,y2:M+$.y,anchorPointX:B,anchorPointY:V}}class X{constructor(c,_,l,h,d){this.transform=c.clone(),this.terrain=_,this.collisionIndex=new Cs(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Si(h),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,_,l,h){const d=l.getBucket(_),x=l.latestFeatureIndex;if(!d||!x||_.id!==d.layerIds[0])return;const b=l.collisionBoxArray,S=d.layers[0].layout,M=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),B=l.tileSize/a.EXTENT,V=this.transform.calculatePosMatrix(l.tileID.toUnwrapped()),$=S.get("text-pitch-alignment")==="map",Y=S.get("text-rotation-alignment")==="map",oe=kr(l,1,this.transform.zoom),te=Ms(V,$,Y,this.transform,oe);let ue=null;if($){const Ce=pi(V,$,Y,this.transform,oe);ue=a.multiply([],this.transform.labelPlaneMatrix,Ce)}this.retainedQueryData[d.bucketInstanceId]=new zi(d.bucketInstanceId,x,d.sourceLayerIndex,d.index,l.tileID);const be={bucket:d,layout:S,posMatrix:V,textLabelPlaneMatrix:te,labelToScreenMatrix:ue,scale:M,textPixelRatio:B,holdingForFade:l.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(h)for(const Ce of d.sortKeyRanges){const{sortKey:ve,symbolInstanceStart:Ge,symbolInstanceEnd:Te}=Ce;c.push({sortKey:ve,symbolInstanceStart:Ge,symbolInstanceEnd:Te,parameters:be})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:be})}attemptAnchorPlacement(c,_,l,h,d,x,b,S,M,B,V,$,Y,oe,te,ue){const be=[$.textOffset0,$.textOffset1],Ce=es(c,l,h,be,d),ve=this.collisionIndex.placeCollisionBox(Lr(_,Ce.x,Ce.y,x,b,this.transform.angle),V,S,M,B.predicate,ue);if((!te||this.collisionIndex.placeCollisionBox(Lr(te,Ce.x,Ce.y,x,b,this.transform.angle),V,S,M,B.predicate,ue).box.length!==0)&&ve.box.length>0){let Ge;if(this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&(Ge=this.prevPlacement.variableOffsets[$.crossTileID].anchor),$.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[$.crossTileID]={textOffset:be,width:l,height:h,anchor:c,textBoxScale:d,prevAnchor:Ge},this.markUsedJustification(Y,c,$,oe),Y.allowVerticalPlacement&&(this.markUsedOrientation(Y,oe,$),this.placedOrientations[$.crossTileID]=oe),{shift:Ce,placedGlyphBoxes:ve}}}placeLayerBucketPart(c,_,l){const{bucket:h,layout:d,posMatrix:x,textLabelPlaneMatrix:b,labelToScreenMatrix:S,textPixelRatio:M,holdingForFade:B,collisionBoxArray:V,partiallyEvaluatedTextSize:$,collisionGroup:Y}=c.parameters,oe=d.get("text-optional"),te=d.get("icon-optional"),ue=a.getOverlapMode(d,"text-overlap","text-allow-overlap"),be=ue==="always",Ce=a.getOverlapMode(d,"icon-overlap","icon-allow-overlap"),ve=Ce==="always",Ge=d.get("text-rotation-alignment")==="map",Te=d.get("text-pitch-alignment")==="map",Ve=d.get("icon-text-fit")!=="none",xe=d.get("symbol-z-order")==="viewport-y",m=be&&(ve||!h.hasIconData()||te),g=ve&&(be||!h.hasTextData()||oe);!h.collisionArrays&&V&&h.deserializeCollisionBoxes(V);const v=(E,C)=>{if(_[E.crossTileID])return;if(B)return void(this.placements[E.crossTileID]=new Ps(!1,!1,!1));let R=!1,O=!1,N=!0,Q=null,J={box:null,offscreen:null},le={box:null,offscreen:null},de=null,Re=null,je=null,Be=0,Ye=0,ht=0;C.textFeatureIndex?Be=C.textFeatureIndex:E.useRuntimeCollisionCircles&&(Be=E.featureIndex),C.verticalTextFeatureIndex&&(Ye=C.verticalTextFeatureIndex);const ut=this.retainedQueryData[h.bucketInstanceId].tileID,rt=this.terrain?(Bt,dt)=>this.terrain.getElevation(ut,Bt,dt):null;for(const Bt of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const dt=C[Bt];dt&&(dt.elevation=rt?rt(dt.anchorPointX,dt.anchorPointY):0)}const it=C.textBox;if(it){const Bt=_t=>{let Cn=a.WritingMode.horizontal;if(h.allowVerticalPlacement&&!_t&&this.prevPlacement){const xn=this.prevPlacement.placedOrientations[E.crossTileID];xn&&(this.placedOrientations[E.crossTileID]=xn,Cn=xn,this.markUsedOrientation(h,Cn,E))}return Cn},dt=(_t,Cn)=>{if(h.allowVerticalPlacement&&E.numVerticalGlyphVertices>0&&C.verticalTextBox){for(const xn of h.writingModes)if(xn===a.WritingMode.vertical?(J=Cn(),le=J):J=_t(),J&&J.box&&J.box.length)break}else J=_t()};if(d.get("text-variable-anchor")){let _t=d.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[E.crossTileID]){const gn=this.prevPlacement.variableOffsets[E.crossTileID];_t.indexOf(gn.anchor)>0&&(_t=_t.filter(yn=>yn!==gn.anchor),_t.unshift(gn.anchor))}const Cn=(gn,yn,bn)=>{const Ln=gn.x2-gn.x1,sr=gn.y2-gn.y1,Pn=E.textBoxScale,_r=Ve&&Ce==="never"?yn:null;let $r={box:[],offscreen:!1};const Ha=ue!=="never"?2*_t.length:_t.length;for(let su=0;su<Ha;++su){const uf=this.attemptAnchorPlacement(_t[su%_t.length],gn,Ln,sr,Pn,Ge,Te,M,x,Y,su>=_t.length?ue:"never",E,h,bn,_r,rt);if(uf&&($r=uf.placedGlyphBoxes,$r&&$r.box&&$r.box.length)){R=!0,Q=uf.shift;break}}return $r};dt(()=>Cn(it,C.iconBox,a.WritingMode.horizontal),()=>{const gn=C.verticalTextBox;return h.allowVerticalPlacement&&!(J&&J.box&&J.box.length)&&E.numVerticalGlyphVertices>0&&gn?Cn(gn,C.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),J&&(R=J.box,N=J.offscreen);const xn=Bt(J&&J.box);if(!R&&this.prevPlacement){const gn=this.prevPlacement.variableOffsets[E.crossTileID];gn&&(this.variableOffsets[E.crossTileID]=gn,this.markUsedJustification(h,gn.anchor,E,xn))}}else{const _t=(Cn,xn)=>{const gn=this.collisionIndex.placeCollisionBox(Cn,ue,M,x,Y.predicate,rt);return gn&&gn.box&&gn.box.length&&(this.markUsedOrientation(h,xn,E),this.placedOrientations[E.crossTileID]=xn),gn};dt(()=>_t(it,a.WritingMode.horizontal),()=>{const Cn=C.verticalTextBox;return h.allowVerticalPlacement&&E.numVerticalGlyphVertices>0&&Cn?_t(Cn,a.WritingMode.vertical):{box:null,offscreen:null}}),Bt(J&&J.box&&J.box.length)}}if(de=J,R=de&&de.box&&de.box.length>0,N=de&&de.offscreen,E.useRuntimeCollisionCircles){const Bt=h.text.placedSymbolArray.get(E.centerJustifiedTextSymbolIndex),dt=a.evaluateSizeForFeature(h.textSizeData,$,Bt),_t=d.get("text-padding");Re=this.collisionIndex.placeCollisionCircles(ue,Bt,h.lineVertexArray,h.glyphOffsetArray,dt,x,b,S,l,Te,Y.predicate,E.collisionCircleDiameter,_t,rt),Re.circles.length&&Re.collisionDetected&&!l&&a.warnOnce("Collisions detected, but collision boxes are not shown"),R=be||Re.circles.length>0&&!Re.collisionDetected,N=N&&Re.offscreen}if(C.iconFeatureIndex&&(ht=C.iconFeatureIndex),C.iconBox){const Bt=dt=>{const _t=Ve&&Q?Lr(dt,Q.x,Q.y,Ge,Te,this.transform.angle):dt;return this.collisionIndex.placeCollisionBox(_t,Ce,M,x,Y.predicate,rt)};le&&le.box&&le.box.length&&C.verticalIconBox?(je=Bt(C.verticalIconBox),O=je.box.length>0):(je=Bt(C.iconBox),O=je.box.length>0),N=N&&je.offscreen}const Xe=oe||E.numHorizontalGlyphVertices===0&&E.numVerticalGlyphVertices===0,Vt=te||E.numIconVertices===0;if(Xe||Vt?Vt?Xe||(O=O&&R):R=O&&R:O=R=O&&R,R&&de&&de.box&&this.collisionIndex.insertCollisionBox(de.box,ue,d.get("text-ignore-placement"),h.bucketInstanceId,le&&le.box&&Ye?Ye:Be,Y.ID),O&&je&&this.collisionIndex.insertCollisionBox(je.box,Ce,d.get("icon-ignore-placement"),h.bucketInstanceId,ht,Y.ID),Re&&(R&&this.collisionIndex.insertCollisionCircles(Re.circles,ue,d.get("text-ignore-placement"),h.bucketInstanceId,Be,Y.ID),l)){const Bt=h.bucketInstanceId;let dt=this.collisionCircleArrays[Bt];dt===void 0&&(dt=this.collisionCircleArrays[Bt]=new Bi);for(let _t=0;_t<Re.circles.length;_t+=4)dt.circles.push(Re.circles[_t+0]),dt.circles.push(Re.circles[_t+1]),dt.circles.push(Re.circles[_t+2]),dt.circles.push(Re.collisionDetected?1:0)}if(E.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[E.crossTileID]=new Ps(R||m,O||g,N||h.justReloaded),_[E.crossTileID]=!0};if(xe){if(c.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const E=h.getSortedSymbolIndexes(this.transform.angle);for(let C=E.length-1;C>=0;--C){const R=E[C];v(h.symbolInstances.get(R),h.collisionArrays[R])}}else for(let E=c.symbolInstanceStart;E<c.symbolInstanceEnd;E++)v(h.symbolInstances.get(E),h.collisionArrays[E]);if(l&&h.bucketInstanceId in this.collisionCircleArrays){const E=this.collisionCircleArrays[h.bucketInstanceId];a.invert(E.invProjMatrix,x),E.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}markUsedJustification(c,_,l,h){let d;d=h===a.WritingMode.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(_)];const x=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const b of x)b>=0&&(c.text.placedSymbolArray.get(b).crossTileID=d>=0&&b!==d?0:l.crossTileID)}markUsedOrientation(c,_,l){const h=_===a.WritingMode.horizontal||_===a.WritingMode.horizontalOnly?_:0,d=_===a.WritingMode.vertical?_:0,x=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const b of x)c.text.placedSymbolArray.get(b).placedOrientation=h;l.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=d)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const _=this.prevPlacement;let l=!1;this.prevZoomAdjustment=_?_.zoomAdjustment(this.transform.zoom):0;const h=_?_.symbolFadeChange(c):1,d=_?_.opacities:{},x=_?_.variableOffsets:{},b=_?_.placedOrientations:{};for(const S in this.placements){const M=this.placements[S],B=d[S];B?(this.opacities[S]=new Zn(B,h,M.text,M.icon),l=l||M.text!==B.text.placed||M.icon!==B.icon.placed):(this.opacities[S]=new Zn(null,h,M.text,M.icon,M.skipFade),l=l||M.text||M.icon)}for(const S in d){const M=d[S];if(!this.opacities[S]){const B=new Zn(M,h,!1,!1);B.isHidden()||(this.opacities[S]=B,l=l||M.text.placed||M.icon.placed)}}for(const S in x)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=x[S]);for(const S in b)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=b[S]);if(_&&_.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=_?_.lastPlacementChangeTime:c)}updateLayerOpacities(c,_){const l={};for(const h of _){const d=h.getBucket(c);d&&h.latestFeatureIndex&&c.id===d.layerIds[0]&&this.updateBucketOpacities(d,l,h.collisionBoxArray)}}updateBucketOpacities(c,_,l){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const h=c.layers[0].layout,d=new Zn(null,0,!1,!1,!0),x=h.get("text-allow-overlap"),b=h.get("icon-allow-overlap"),S=h.get("text-variable-anchor"),M=h.get("text-rotation-alignment")==="map",B=h.get("text-pitch-alignment")==="map",V=h.get("icon-text-fit")!=="none",$=new Zn(null,0,x&&(b||!c.hasIconData()||h.get("icon-optional")),b&&(x||!c.hasTextData()||h.get("text-optional")),!0);!c.collisionArrays&&l&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(l);const Y=(oe,te,ue)=>{for(let be=0;be<te/4;be++)oe.opacityVertexArray.emplaceBack(ue)};for(let oe=0;oe<c.symbolInstances.length;oe++){const te=c.symbolInstances.get(oe),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:be,crossTileID:Ce}=te;let ve=this.opacities[Ce];_[Ce]?ve=d:ve||(ve=$,this.opacities[Ce]=ve),_[Ce]=!0;const Ge=te.numIconVertices>0,Te=this.placedOrientations[te.crossTileID],Ve=Te===a.WritingMode.vertical,xe=Te===a.WritingMode.horizontal||Te===a.WritingMode.horizontalOnly;if(ue>0||be>0){const m=ke(ve.text);Y(c.text,ue,Ve?We:m),Y(c.text,be,xe?We:m);const g=ve.text.isHidden();[te.rightJustifiedTextSymbolIndex,te.centerJustifiedTextSymbolIndex,te.leftJustifiedTextSymbolIndex].forEach(C=>{C>=0&&(c.text.placedSymbolArray.get(C).hidden=g||Ve?1:0)}),te.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(te.verticalPlacedTextSymbolIndex).hidden=g||xe?1:0);const v=this.variableOffsets[te.crossTileID];v&&this.markUsedJustification(c,v.anchor,te,Te);const E=this.placedOrientations[te.crossTileID];E&&(this.markUsedJustification(c,"left",te,E),this.markUsedOrientation(c,E,te))}if(Ge){const m=ke(ve.icon),g=!(V&&te.verticalPlacedIconSymbolIndex&&Ve);te.placedIconSymbolIndex>=0&&(Y(c.icon,te.numIconVertices,g?m:We),c.icon.placedSymbolArray.get(te.placedIconSymbolIndex).hidden=ve.icon.isHidden()),te.verticalPlacedIconSymbolIndex>=0&&(Y(c.icon,te.numVerticalIconVertices,g?We:m),c.icon.placedSymbolArray.get(te.verticalPlacedIconSymbolIndex).hidden=ve.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const m=c.collisionArrays[oe];if(m){let g=new a.pointGeometry(0,0);if(m.textBox||m.verticalTextBox){let E=!0;if(S){const C=this.variableOffsets[Ce];C?(g=es(C.anchor,C.width,C.height,C.textOffset,C.textBoxScale),M&&g._rotate(B?this.transform.angle:-this.transform.angle)):E=!1}m.textBox&&H(c.textCollisionBox.collisionVertexArray,ve.text.placed,!E||Ve,g.x,g.y),m.verticalTextBox&&H(c.textCollisionBox.collisionVertexArray,ve.text.placed,!E||xe,g.x,g.y)}const v=!!(!xe&&m.verticalIconBox);m.iconBox&&H(c.iconCollisionBox.collisionVertexArray,ve.icon.placed,v,V?g.x:0,V?g.y:0),m.verticalIconBox&&H(c.iconCollisionBox.collisionVertexArray,ve.icon.placed,!v,V?g.x:0,V?g.y:0)}}}if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.text.opacityVertexArray.length!==c.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${c.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${c.text.layoutVertexArray.length}) / 4`);if(c.icon.opacityVertexArray.length!==c.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${c.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${c.icon.layoutVertexArray.length}) / 4`);if(c.bucketInstanceId in this.collisionCircleArrays){const oe=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=oe.invProjMatrix,c.placementViewportMatrix=oe.viewportMatrix,c.collisionCircleArray=oe.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,_){const l=this.zoomAtLastRecencyCheck===_?1-this.zoomAdjustment(_):1;return this.zoomAtLastRecencyCheck=_,this.commitTime+this.fadeDuration*l>c}setStale(){this.stale=!0}}function H(k,c,_,l,h){k.emplaceBack(c?1:0,_?1:0,l||0,h||0),k.emplaceBack(c?1:0,_?1:0,l||0,h||0),k.emplaceBack(c?1:0,_?1:0,l||0,h||0),k.emplaceBack(c?1:0,_?1:0,l||0,h||0)}const ee=Math.pow(2,25),he=Math.pow(2,24),o=Math.pow(2,17),G=Math.pow(2,16),Le=Math.pow(2,9),Ie=Math.pow(2,8),Pe=Math.pow(2,1);function ke(k){if(k.opacity===0&&!k.placed)return 0;if(k.opacity===1&&k.placed)return 4294967295;const c=k.placed?1:0,_=Math.floor(127*k.opacity);return _*ee+c*he+_*o+c*G+_*Le+c*Ie+_*Pe+c}const We=0;class at{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&!c.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,_,l,h,d){const x=this._bucketParts;for(;this._currentTileIndex<c.length;)if(_.getBucketParts(x,h,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((b,S)=>b.sortKey-S.sortKey));this._currentPartIndex<x.length;)if(_.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,d())return!0;return!1}}class $e{constructor(c,_,l,h,d,x,b,S){this.placement=new X(c,_,x,b,S),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=d,this._done=!1}isDone(){return this._done}continuePlacement(c,_,l){const h=a.exported.now(),d=()=>{const x=a.exported.now()-h;return!this._forceFullPlacement&&x>2};for(;this._currentPlacementIndex>=0;){const x=_[c[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=b)&&(!x.maxzoom||x.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new at(x)),this._inProgressLayer.continuePlacement(l[x.source],this.placement,this._showCollisionBoxes,x,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const ft=512/a.EXTENT/2;class Lt{constructor(c,_,l){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(let h=0;h<_.length;h++){const d=_.get(h),x=d.key;this.indexedSymbolInstances[x]||(this.indexedSymbolInstances[x]=[]),this.indexedSymbolInstances[x].push({crossTileID:d.crossTileID,coord:this.getScaledCoordinates(d,c)})}}getScaledCoordinates(c,_){const l=ft/Math.pow(2,_.canonical.z-this.tileID.canonical.z);return{x:Math.floor((_.canonical.x*a.EXTENT+c.anchorX)*l),y:Math.floor((_.canonical.y*a.EXTENT+c.anchorY)*l)}}findMatches(c,_,l){const h=this.tileID.canonical.z<_.canonical.z?1:Math.pow(2,this.tileID.canonical.z-_.canonical.z);for(let d=0;d<c.length;d++){const x=c.get(d);if(x.crossTileID)continue;const b=this.indexedSymbolInstances[x.key];if(!b)continue;const S=this.getScaledCoordinates(x,_);for(const M of b)if(Math.abs(M.coord.x-S.x)<=h&&Math.abs(M.coord.y-S.y)<=h&&!l[M.crossTileID]){l[M.crossTileID]=!0,x.crossTileID=M.crossTileID;break}}}}class Dt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class rn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const _=Math.round((c-this.lng)/360);if(_!==0)for(const l in this.indexes){const h=this.indexes[l],d={};for(const x in h){const b=h[x];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+_),d[b.tileID.key]=b}this.indexes[l]=d}this.lng=c}addBucket(c,_,l){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===_.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let d=0;d<_.symbolInstances.length;d++)_.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const h=this.usedCrossTileIDs[c.overscaledZ];for(const d in this.indexes){const x=this.indexes[d];if(Number(d)>c.overscaledZ)for(const b in x){const S=x[b];S.tileID.isChildOf(c)&&S.findMatches(_.symbolInstances,c,h)}else{const b=x[c.scaledTo(Number(d)).key];b&&b.findMatches(_.symbolInstances,c,h)}}for(let d=0;d<_.symbolInstances.length;d++){const x=_.symbolInstances.get(d);x.crossTileID||(x.crossTileID=l.generate(),h[x.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Lt(c,_.symbolInstances,_.bucketInstanceId),!0}removeBucketCrossTileIDs(c,_){for(const l in _.indexedSymbolInstances)for(const h of _.indexedSymbolInstances[l])delete this.usedCrossTileIDs[c][h.crossTileID]}removeStaleBuckets(c){let _=!1;for(const l in this.indexes){const h=this.indexes[l];for(const d in h)c[h[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,h[d]),delete h[d],_=!0)}return _}}class jt{constructor(){this.layerIndexes={},this.crossTileIDs=new Dt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,_,l){let h=this.layerIndexes[c.id];h===void 0&&(h=this.layerIndexes[c.id]=new rn);let d=!1;const x={};h.handleWrapJump(l);for(const b of _){const S=b.getBucket(c);S&&c.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(b.tileID,S,this.crossTileIDs)&&(d=!0),x[S.bucketInstanceId]=!0)}return h.removeStaleBuckets(x)&&(d=!0),d}pruneUnusedLayers(c){const _={};c.forEach(l=>{_[l]=!0});for(const l in this.layerIndexes)_[l]||delete this.layerIndexes[l]}}var dn=a.createLayout([{name:"a_pos",type:"Int16",components:2}]);class Qt extends a.Evented{constructor(c){super(),this.sourceCache=c,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=c._cache.max,c.usedForTerrain=!0,c.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const c in this._tiles){const _=this._tiles[c];_.textures.forEach(l=>l.destroy()),_.textures=[]}}update(c,_){this.sourceCache.update(c,_),this._renderableTilesKeys=[];for(const l of c.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:_}))this._renderableTilesKeys.push(l.key),this._tiles[l.key]||(l.posMatrix=new Float64Array(16),a.ortho(l.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),this._tiles[l.key]=new Ar(l,this.tileSize))}removeOutdated(c){const _={};this.renderHistory=this.renderHistory.filter((l,h)=>this.renderHistory.indexOf(l)===h).slice(0,this.renderHistorySize);for(const l of this._renderableTilesKeys)_[l]=!0;for(const l of this.renderHistory)_[l]=!0;for(const l in this._tiles)_[l]||(this._tiles[l].clearTextures(c),delete this._tiles[l])}getRenderableTiles(){return this._renderableTilesKeys.map(c=>this.getTileByID(c))}getTileByID(c){return this._tiles[c]}getTerrainCoords(c){const _={};for(const l of this._renderableTilesKeys){const h=this._tiles[l].tileID;if(h.canonical.equals(c.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16),a.ortho(d.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),_[l]=d}else if(h.canonical.isChildOf(c.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16);const x=h.canonical.z-c.canonical.z,b=h.canonical.x-(h.canonical.x>>x<<x),S=h.canonical.y-(h.canonical.y>>x<<x),M=a.EXTENT>>x;a.ortho(d.posMatrix,0,M,0,M,0,1),a.translate(d.posMatrix,d.posMatrix,[-b*M,-S*M,0]),_[l]=d}else if(c.canonical.isChildOf(h.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16);const x=c.canonical.z-h.canonical.z,b=c.canonical.x-(c.canonical.x>>x<<x),S=c.canonical.y-(c.canonical.y>>x<<x),M=a.EXTENT>>x;a.ortho(d.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),a.translate(d.posMatrix,d.posMatrix,[b*M,S*M,0]),a.scale(d.posMatrix,d.posMatrix,[1/2**x,1/2**x,0]),_[l]=d}}return _}getSourceTile(c,_){const l=this.sourceCache._source;let h=c.overscaledZ-this.deltaZoom;if(h>l.maxzoom&&(h=l.maxzoom),h<l.minzoom)return null;this._sourceTileCache[c.key]||(this._sourceTileCache[c.key]=c.scaledTo(h).key);let d=this.sourceCache.getTileByID(this._sourceTileCache[c.key]);if((!d||!d.dem)&&_)for(;h>=l.minzoom&&(!d||!d.dem);)d=this.sourceCache.getTileByID(c.scaledTo(h--).key);return d}tilesAfterTime(c=Date.now()){return Object.values(this._tiles).filter(_=>_.timeLoaded>=c)}}class on{constructor(c,_,l){this.style=c,this.sourceCache=new Qt(_),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.elevationOffset=typeof l.elevationOffset=="number"?l.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(c,_,l,h=a.EXTENT){if(!(_>=0&&_<h&&l>=0&&l<h))return this.elevationOffset;let d=0;const x=this.getTerrainData(c);if(x.tile&&x.tile.dem){const b=a.transformMat4$1([],[_/h*a.EXTENT,l/h*a.EXTENT],x.u_terrain_matrix),S=[b[0]*x.tile.dem.dim,b[1]*x.tile.dem.dim],M=[Math.floor(S[0]),Math.floor(S[1])],B=x.tile.dem.get(M[0],M[1]),V=x.tile.dem.get(M[0],M[1]+1),$=x.tile.dem.get(M[0]+1,M[1]),Y=x.tile.dem.get(M[0]+1,M[1]+1);d=a.number(a.number(B,V,S[0]-M[0]),a.number($,Y,S[0]-M[0]),S[1]-M[1])}return d}rememberForRerender(c,_){for(const l in this.sourceCache._tiles){const h=this.sourceCache._tiles[l];(h.tileID.equals(_)||h.tileID.isChildOf(_))&&(c===this.sourceCache.sourceCache.id&&(h.timeLoaded=Date.now()),this._rerender[c]=this._rerender[c]||{},this._rerender[c][h.tileID.key]=!0)}}needsRerender(c,_){return this._rerender[c]&&this._rerender[c][_.key]}clearRerenderCache(){this._rerender={}}getElevation(c,_,l,h=a.EXTENT){return(this.getDEMElevation(c,_,l,h)+this.elevationOffset)*this.exaggeration}getTerrainData(c){if(!this._emptyDemTexture){const h=this.style.map.painter.context,d=new a.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new q(h,d,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new q(h,new a.RGBAImage({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.identity([])}const _=this.sourceCache.getSourceTile(c,!0);if(_&&_.dem&&(!_.demTexture||_.needsTerrainPrepare)){const h=this.style.map.painter.context;_.demTexture=this.style.map.painter.getTileTexture(_.dem.stride),_.demTexture?_.demTexture.update(_.dem.getPixels(),{premultiply:!1}):_.demTexture=new q(h,_.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),_.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),_.needsTerrainPrepare=!1}const l=_&&_+_.tileID.key+c.key;if(l&&!this._demMatrixCache[l]){const h=this.sourceCache.sourceCache._source.maxzoom;let d=c.canonical.z-_.tileID.canonical.z;c.overscaledZ>c.canonical.z&&(c.canonical.z>=h?d=c.canonical.z-h:a.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=c.canonical.x-(c.canonical.x>>d<<d),b=c.canonical.y-(c.canonical.y>>d<<d),S=a.fromScaling(new Float64Array(16),[1/(a.EXTENT<<d),1/(a.EXTENT<<d),0]);a.translate(S,S,[x*a.EXTENT,b*a.EXTENT,0]),this._demMatrixCache[c.key]={matrix:S,coord:c}}return{u_depth:2,u_terrain:3,u_terrain_dim:_&&_.dem&&_.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[c.key].matrix:this._emptyDemMatrix,u_terrain_unpack:_&&_.dem&&_.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(_&&_.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:_}}getRTTFramebuffer(){const c=this.style.map.painter;if(!this._rttFramebuffer){const _=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=c.context.createFramebuffer(_,_,!0),this._rttFramebuffer.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,_,_))}return this._rttFramebuffer}getFramebuffer(c){const _=this.style.map.painter,l=_.width/devicePixelRatio,h=_.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new q(_.context,{width:l,height:h,data:null},_.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(_.context.gl.NEAREST,_.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new q(_.context,{width:l,height:h,data:null},_.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(_.context.gl.NEAREST,_.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=_.context.createFramebuffer(l,h,!0),this._fbo.depthAttachment.set(_.context.createRenderbuffer(_.context.gl.DEPTH_COMPONENT16,l,h))),this._fbo.colorAttachment.set(c==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const c=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const _=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let d=0,x=0;d<this._coordsTextureSize;d++)for(let b=0;b<this._coordsTextureSize;b++,x+=4)_[x+0]=255&b,_[x+1]=255&d,_[x+2]=b>>8<<4|d>>8,_[x+3]=0;const l=new a.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(_.buffer)),h=new q(c,l,c.gl.RGBA,{premultiply:!1});return h.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(c){const _=new Uint8Array(4),l=this.style.map.painter,h=l.context,d=h.gl;h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(c.x,l.height/devicePixelRatio-c.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,_),h.bindFramebuffer.set(null);const x=_[0]+(_[2]>>4<<8),b=_[1]+((15&_[2])<<8),S=this.coordsIndex[255-_[3]],M=S&&this.sourceCache.getTileByID(S);if(!M)return null;const B=this._coordsTextureSize,V=(1<<M.tileID.canonical.z)*B;return new a.MercatorCoordinate((M.tileID.canonical.x*B+x)/V,(M.tileID.canonical.y*B+b)/V,this.getElevation(M.tileID,x,b,B))}getTerrainMesh(){if(this._mesh)return this._mesh;const c=this.style.map.painter.context,_=new a.PosArray,l=new a.TriangleIndexArray,h=this.meshSize,d=a.EXTENT/h,x=h*h;for(let b=0;b<=h;b++)for(let S=0;S<=h;S++)_.emplaceBack(S*d,b*d);for(let b=0;b<x;b+=h+1)for(let S=0;S<h;S++)l.emplaceBack(S+b,h+S+b+1,h+S+b+2),l.emplaceBack(S+b,h+S+b+2,S+b+1);return this._mesh={indexBuffer:c.createIndexBuffer(l),vertexBuffer:c.createVertexBuffer(_,dn.members),segments:a.SegmentVector.simpleSegment(0,0,_.length,l.length)},this._mesh}getMinMaxElevation(c){const _=this.getTerrainData(c).tile,l={minElevation:null,maxElevation:null};return _&&_.dem&&(l.minElevation=(_.dem.min+this.elevationOffset)*this.exaggeration,l.maxElevation=(_.dem.max+this.elevationOffset)*this.exaggeration),l}}const vn=(k,c)=>a.emitValidationErrors(k,c&&c.filter(_=>_.identifier!=="source.canvas")),Ot=a.pick(Un,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Oe=a.pick(Un,["setCenter","setZoom","setBearing","setPitch"]),Mt=function(){const k={},c=a.spec.$version;for(const _ in a.spec.$root){const l=a.spec.$root[_];if(l.required){let h=null;h=_==="version"?c:l.type==="array"?[]:{},h!=null&&(k[_]=h)}}return k}();class Se extends a.Evented{constructor(c,_={}){super(),this.map=c,this.dispatcher=new tt(or(),this),this.imageManager=new K,this.imageManager.setEventedParent(this),this.glyphManager=new ye(c._requestManager,_.localIdeographFontFamily),this.lineAtlas=new Je(256,512),this.crossTileSymbolIndex=new jt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const l=this;this._rtlTextPluginCallback=Se.registerForPluginStateChange(h=>{l.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:h.pluginStatus,pluginURL:h.pluginURL},(d,x)=>{if(a.triggerPluginCompletionEvent(d),x&&x.every(b=>b))for(const b in l.sourceCaches)l.sourceCaches[b].reload()})}),this.on("data",h=>{if(h.dataType!=="source"||h.sourceDataType!=="metadata")return;const d=this.sourceCaches[h.sourceId];if(!d)return;const x=d.getSource();if(x&&x.vectorLayerIds)for(const b in this._layers){const S=this._layers[b];S.source===x.id&&this._validateLayer(S)}})}loadURL(c,_={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const l=typeof _.validate!="boolean"||_.validate,h=this.map._requestManager.transformRequest(c,a.ResourceType.Style);this._request=a.getJSON(h,(d,x)=>{this._request=null,d?this.fire(new a.ErrorEvent(d)):x&&this._load(x,l)})}loadJSON(c,_={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(c,_.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Mt,!1)}_load(c,_){if(_&&vn(this,a.validateStyle(c)))return;this._loaded=!0,this.stylesheet=c;for(const h in c.sources)this.addSource(h,c.sources[h],{validate:!1});c.sprite?this._loadSprite(c.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(c.glyphs);const l=Zr(this.stylesheet.layers);this._order=l.map(h=>h.id),this._layers={},this._serializedLayers={};for(let h of l)h=a.createStyleLayer(h),h.setEventedParent(this,{layer:{id:h.id}}),this._layers[h.id]=h,this._serializedLayers[h.id]=h.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Qe(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}_loadSprite(c){this._spriteRequest=function(_,l,h,d){let x,b,S;const M=h>1?"@2x":"";let B=a.getJSON(l.transformRequest(l.normalizeSpriteURL(_,M,".json"),a.ResourceType.SpriteJSON),(Y,oe)=>{B=null,S||(S=Y,x=oe,$())}),V=a.getImage(l.transformRequest(l.normalizeSpriteURL(_,M,".png"),a.ResourceType.SpriteImage),(Y,oe)=>{V=null,S||(S=Y,b=oe,$())});function $(){if(S)d(S);else if(x&&b){const Y=a.exported.getImageData(b),oe={};for(const te in x){const{width:ue,height:be,x:Ce,y:ve,sdf:Ge,pixelRatio:Te,stretchX:Ve,stretchY:xe,content:m}=x[te],g=new a.RGBAImage({width:ue,height:be});a.RGBAImage.copy(Y,g,{x:Ce,y:ve},{x:0,y:0},{width:ue,height:be}),oe[te]={data:g,pixelRatio:Te,sdf:Ge,stretchX:Ve,stretchY:xe,content:m}}d(null,oe)}}return{cancel(){B&&(B.cancel(),B=null),V&&(V.cancel(),V=null)}}}(c,this.map._requestManager,this.map.getPixelRatio(),(_,l)=>{if(this._spriteRequest=null,_)this.fire(new a.ErrorEvent(_));else if(l)for(const h in l)this.imageManager.addImage(h,l[h]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(c){const _=this.sourceCaches[c.source];if(!_)return;const l=c.sourceLayer;if(!l)return;const h=_.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(l)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${l}" does not exist on source "${h.id}" as specified by style layer "${c.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this.sourceCaches)if(!this.sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const _=[];for(const l of c){const h=this._layers[l];h.type!=="custom"&&_.push(h.serialize())}return _}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(c){if(!this._loaded)return;const _=this._changed;if(this._changed){const h=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);(h.length||d.length)&&this._updateWorkerLayers(h,d);for(const x in this._updatedSources){const b=this._updatedSources[x];if(b==="reload")this._reloadSource(x);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(x)}}this._updateTilesForChangedImages();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(c);this.light.updateTransitions(c),this._resetUpdates()}const l={};for(const h in this.sourceCaches){const d=this.sourceCaches[h];l[h]=d.used,d.used=!1}for(const h of this._order){const d=this._layers[h];d.recalculate(c,this._availableImages),!d.isHidden(c.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(const h in l){const d=this.sourceCaches[h];l[h]!==d.used&&d.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(c),this.z=c.zoom,_&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const _ in this.sourceCaches)this.sourceCaches[_].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,_){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:_})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(c){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),c){const _=this.sourceCaches[c.source];if(!_)throw new Error(`cannot load terrain, because there exists no source with ID: ${c.source}`);this.terrain=new on(this,_,c),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=l=>{l.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=l=>{l.tile&&(l.sourceId===c.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(l.sourceId,l.tile.tileID)):l.source.type==="geojson"&&this.terrain.rememberForRerender(l.sourceId,l.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new a.Event("terrain",{terrain:c}))}setState(c){if(this._checkLoaded(),vn(this,a.validateStyle(c)))return!1;(c=a.clone$1(c)).layers=Zr(c.layers);const _=function(h,d){if(!h)return[{command:Un.setStyle,args:[d]}];let x=[];try{if(!I(h.version,d.version))return[{command:Un.setStyle,args:[d]}];I(h.center,d.center)||x.push({command:Un.setCenter,args:[d.center]}),I(h.zoom,d.zoom)||x.push({command:Un.setZoom,args:[d.zoom]}),I(h.bearing,d.bearing)||x.push({command:Un.setBearing,args:[d.bearing]}),I(h.pitch,d.pitch)||x.push({command:Un.setPitch,args:[d.pitch]}),I(h.sprite,d.sprite)||x.push({command:Un.setSprite,args:[d.sprite]}),I(h.glyphs,d.glyphs)||x.push({command:Un.setGlyphs,args:[d.glyphs]}),I(h.transition,d.transition)||x.push({command:Un.setTransition,args:[d.transition]}),I(h.light,d.light)||x.push({command:Un.setLight,args:[d.light]});const b={},S=[];(function(B,V,$,Y){let oe;for(oe in V=V||{},B=B||{})Object.prototype.hasOwnProperty.call(B,oe)&&(Object.prototype.hasOwnProperty.call(V,oe)||Hn(oe,$,Y));for(oe in V)Object.prototype.hasOwnProperty.call(V,oe)&&(Object.prototype.hasOwnProperty.call(B,oe)?I(B[oe],V[oe])||(B[oe].type==="geojson"&&V[oe].type==="geojson"&&oo(B,V,oe)?$.push({command:Un.setGeoJSONSourceData,args:[oe,V[oe].data]}):Di(oe,V,$,Y)):wi(oe,V,$))})(h.sources,d.sources,S,b);const M=[];h.layers&&h.layers.forEach(B=>{b[B.source]?x.push({command:Un.removeLayer,args:[B.id]}):M.push(B)}),x=x.concat(S),function(B,V,$){V=V||[];const Y=(B=B||[]).map(bi),oe=V.map(bi),te=B.reduce(Io,{}),ue=V.reduce(Io,{}),be=Y.slice(),Ce=Object.create(null);let ve,Ge,Te,Ve,xe,m,g;for(ve=0,Ge=0;ve<Y.length;ve++)Te=Y[ve],Object.prototype.hasOwnProperty.call(ue,Te)?Ge++:($.push({command:Un.removeLayer,args:[Te]}),be.splice(be.indexOf(Te,Ge),1));for(ve=0,Ge=0;ve<oe.length;ve++)Te=oe[oe.length-1-ve],be[be.length-1-ve]!==Te&&(Object.prototype.hasOwnProperty.call(te,Te)?($.push({command:Un.removeLayer,args:[Te]}),be.splice(be.lastIndexOf(Te,be.length-Ge),1)):Ge++,m=be[be.length-ve],$.push({command:Un.addLayer,args:[ue[Te],m]}),be.splice(be.length-ve,0,Te),Ce[Te]=!0);for(ve=0;ve<oe.length;ve++)if(Te=oe[ve],Ve=te[Te],xe=ue[Te],!Ce[Te]&&!I(Ve,xe))if(I(Ve.source,xe.source)&&I(Ve["source-layer"],xe["source-layer"])&&I(Ve.type,xe.type)){for(g in zr(Ve.layout,xe.layout,$,Te,null,Un.setLayoutProperty),zr(Ve.paint,xe.paint,$,Te,null,Un.setPaintProperty),I(Ve.filter,xe.filter)||$.push({command:Un.setFilter,args:[Te,xe.filter]}),I(Ve.minzoom,xe.minzoom)&&I(Ve.maxzoom,xe.maxzoom)||$.push({command:Un.setLayerZoomRange,args:[Te,xe.minzoom,xe.maxzoom]}),Ve)Object.prototype.hasOwnProperty.call(Ve,g)&&g!=="layout"&&g!=="paint"&&g!=="filter"&&g!=="metadata"&&g!=="minzoom"&&g!=="maxzoom"&&(g.indexOf("paint.")===0?zr(Ve[g],xe[g],$,Te,g.slice(6),Un.setPaintProperty):I(Ve[g],xe[g])||$.push({command:Un.setLayerProperty,args:[Te,g,xe[g]]}));for(g in xe)Object.prototype.hasOwnProperty.call(xe,g)&&!Object.prototype.hasOwnProperty.call(Ve,g)&&g!=="layout"&&g!=="paint"&&g!=="filter"&&g!=="metadata"&&g!=="minzoom"&&g!=="maxzoom"&&(g.indexOf("paint.")===0?zr(Ve[g],xe[g],$,Te,g.slice(6),Un.setPaintProperty):I(Ve[g],xe[g])||$.push({command:Un.setLayerProperty,args:[Te,g,xe[g]]}))}else $.push({command:Un.removeLayer,args:[Te]}),m=be[be.lastIndexOf(Te)+1],$.push({command:Un.addLayer,args:[xe,m]})}(M,d.layers,x)}catch(b){console.warn("Unable to compute style diff:",b),x=[{command:Un.setStyle,args:[d]}]}return x}(this.serialize(),c).filter(h=>!(h.command in Oe));if(_.length===0)return!1;const l=_.filter(h=>!(h.command in Ot));if(l.length>0)throw new Error(`Unimplemented: ${l.map(h=>h.command).join(", ")}.`);return _.forEach(h=>{h.command!=="setTransition"&&this[h.command].apply(this,h.args)}),this.stylesheet=c,!0}addImage(c,_){if(this.getImage(c))return this.fire(new a.ErrorEvent(new Error(`An image named "${c}" already exists.`)));this.imageManager.addImage(c,_),this._afterImageUpdated(c)}updateImage(c,_){this.imageManager.updateImage(c,_)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){if(!this.getImage(c))return this.fire(new a.ErrorEvent(new Error(`An image named "${c}" does not exist.`)));this.imageManager.removeImage(c),this._afterImageUpdated(c)}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(c,_,l={}){if(this._checkLoaded(),this.sourceCaches[c]!==void 0)throw new Error(`Source "${c}" already exists.`);if(!_.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(_).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(_.type)>=0&&this._validate(a.validateStyle.source,`sources.${c}`,_,null,l))return;this.map&&this.map._collectResourceTiming&&(_.collectResourceTiming=!0);const h=this.sourceCaches[c]=new xt(c,_,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:h.serialize(),sourceId:c})),h.onAdd(this.map),this._changed=!0}removeSource(c){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===c)return this.fire(new a.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${l}" is using it.`)));const _=this.sourceCaches[c];delete this.sourceCaches[c],delete this._updatedSources[c],_.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),_.setEventedParent(null),_.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(c,_){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error(`There is no source with this ID=${c}`);const l=this.sourceCaches[c].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(_),this._changed=!0}getSource(c){return this.sourceCaches[c]&&this.sourceCaches[c].getSource()}addLayer(c,_,l={}){this._checkLoaded();const h=c.id;if(this.getLayer(h))return void this.fire(new a.ErrorEvent(new Error(`Layer "${h}" already exists on this map.`)));let d;if(c.type==="custom"){if(vn(this,a.validateCustomStyleLayer(c)))return;d=a.createStyleLayer(c)}else{if(typeof c.source=="object"&&(this.addSource(h,c.source),c=a.clone$1(c),c=a.extend(c,{source:h})),this._validate(a.validateStyle.layer,`layers.${h}`,c,{arrayIndex:-1},l))return;d=a.createStyleLayer(c),this._validateLayer(d),d.setEventedParent(this,{layer:{id:h}}),this._serializedLayers[d.id]=d.serialize()}const x=_?this._order.indexOf(_):this._order.length;if(_&&x===-1)this.fire(new a.ErrorEvent(new Error(`Cannot add layer "${h}" before non-existing layer "${_}".`)));else{if(this._order.splice(x,0,h),this._layerOrderChanged=!0,this._layers[h]=d,this._removedLayers[h]&&d.source&&d.type!=="custom"){const b=this._removedLayers[h];delete this._removedLayers[h],b.type!==d.type?this._updatedSources[d.source]="clear":(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map)}}moveLayer(c,_){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new a.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===_)return;const l=this._order.indexOf(c);this._order.splice(l,1);const h=_?this._order.indexOf(_):this._order.length;_&&h===-1?this.fire(new a.ErrorEvent(new Error(`Cannot move layer "${c}" before non-existing layer "${_}".`))):(this._order.splice(h,0,c),this._layerOrderChanged=!0)}removeLayer(c){this._checkLoaded();const _=this._layers[c];if(!_)return void this.fire(new a.ErrorEvent(new Error(`Cannot remove non-existing layer "${c}".`)));_.setEventedParent(null);const l=this._order.indexOf(c);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=_,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],_.onRemove&&_.onRemove(this.map)}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}setLayerZoomRange(c,_,l){this._checkLoaded();const h=this.getLayer(c);h?h.minzoom===_&&h.maxzoom===l||(_!=null&&(h.minzoom=_),l!=null&&(h.maxzoom=l),this._updateLayer(h)):this.fire(new a.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${c}".`)))}setFilter(c,_,l={}){this._checkLoaded();const h=this.getLayer(c);if(h){if(!I(h.filter,_))return _==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(a.validateStyle.filter,`layers.${h.id}.filter`,_,null,l)||(h.filter=a.clone$1(_),this._updateLayer(h)))}else this.fire(new a.ErrorEvent(new Error(`Cannot filter non-existing layer "${c}".`)))}getFilter(c){return a.clone$1(this.getLayer(c).filter)}setLayoutProperty(c,_,l,h={}){this._checkLoaded();const d=this.getLayer(c);d?I(d.getLayoutProperty(_),l)||(d.setLayoutProperty(_,l,h),this._updateLayer(d)):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getLayoutProperty(c,_){const l=this.getLayer(c);if(l)return l.getLayoutProperty(_);this.fire(new a.ErrorEvent(new Error(`Cannot get style of non-existing layer "${c}".`)))}setPaintProperty(c,_,l,h={}){this._checkLoaded();const d=this.getLayer(c);d?I(d.getPaintProperty(_),l)||(d.setPaintProperty(_,l,h)&&this._updateLayer(d),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getPaintProperty(c,_){return this.getLayer(c).getPaintProperty(_)}setFeatureState(c,_){this._checkLoaded();const l=c.source,h=c.sourceLayer,d=this.sourceCaches[l];if(d===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${l}' does not exist in the map's style.`)));const x=d.getSource().type;x==="geojson"&&h?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||h?(c.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),d.setFeatureState(h,c.id,_)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(c,_){this._checkLoaded();const l=c.source,h=this.sourceCaches[l];if(h===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${l}' does not exist in the map's style.`)));const d=h.getSource().type,x=d==="vector"?c.sourceLayer:void 0;d!=="vector"||x?_&&typeof c.id!="string"&&typeof c.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(x,c.id,_):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(c){this._checkLoaded();const _=c.source,l=c.sourceLayer,h=this.sourceCaches[_];if(h!==void 0)return h.getSource().type!=="vector"||l?(c.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),h.getFeatureState(l,c.id)):void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,c=>c.serialize()),layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&this.sourceCaches[c.source].getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(c){const _=x=>this._layers[x].type==="fill-extrusion",l={},h=[];for(let x=this._order.length-1;x>=0;x--){const b=this._order[x];if(_(b)){l[b]=x;for(const S of c){const M=S[b];if(M)for(const B of M)h.push(B)}}}h.sort((x,b)=>b.intersectionZ-x.intersectionZ);const d=[];for(let x=this._order.length-1;x>=0;x--){const b=this._order[x];if(_(b))for(let S=h.length-1;S>=0;S--){const M=h[S].feature;if(l[M.layer.id]<x)break;d.push(M),h.pop()}else for(const S of c){const M=S[b];if(M)for(const B of M)d.push(B.feature)}}return d}queryRenderedFeatures(c,_,l){_&&_.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",_.filter,null,_);const h={};if(_&&_.layers){if(!Array.isArray(_.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const x of _.layers){const b=this._layers[x];if(!b)return this.fire(new a.ErrorEvent(new Error(`The layer '${x}' does not exist in the map's style and cannot be queried for features.`))),[];h[b.source]=!0}}const d=[];_.availableImages=this._availableImages;for(const x in this.sourceCaches)_.layers&&!h[x]||d.push(Jn(this.sourceCaches[x],this._layers,this._serializedLayers,c,_,l));return this.placement&&d.push(function(x,b,S,M,B,V,$){const Y={},oe=V.queryRenderedSymbols(M),te=[];for(const ue of Object.keys(oe).map(Number))te.push($[ue]);te.sort(ir);for(const ue of te){const be=ue.featureIndex.lookupSymbolFeatures(oe[ue.bucketInstanceId],b,ue.bucketIndex,ue.sourceLayerIndex,B.filter,B.layers,B.availableImages,x);for(const Ce in be){const ve=Y[Ce]=Y[Ce]||[],Ge=be[Ce];Ge.sort((Te,Ve)=>{const xe=ue.featureSortOrder;if(xe){const m=xe.indexOf(Te.featureIndex);return xe.indexOf(Ve.featureIndex)-m}return Ve.featureIndex-Te.featureIndex});for(const Te of Ge)ve.push(Te)}}for(const ue in Y)Y[ue].forEach(be=>{const Ce=be.feature,ve=S[x[ue].source].getFeatureState(Ce.layer["source-layer"],Ce.id);Ce.source=Ce.layer.source,Ce.layer["source-layer"]&&(Ce.sourceLayer=Ce.layer["source-layer"]),Ce.state=ve});return Y}(this._layers,this._serializedLayers,this.sourceCaches,c,_,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(c,_){_&&_.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",_.filter,null,_);const l=this.sourceCaches[c];return l?function(h,d){const x=h.getRenderableIds().map(M=>h.getTileByID(M)),b=[],S={};for(let M=0;M<x.length;M++){const B=x[M],V=B.tileID.canonical.key;S[V]||(S[V]=!0,B.querySourceFeatures(b,d))}return b}(l,_):[]}addSourceType(c,_,l){return Se.getSourceType(c)?l(new Error(`A source type called "${c}" already exists.`)):(Se.setSourceType(c,_),_.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:_.workerSourceURL},l):l(null,null))}getLight(){return this.light.getLight()}setLight(c,_={}){this._checkLoaded();const l=this.light.getLight();let h=!1;for(const x in c)if(!I(c[x],l[x])){h=!0;break}if(!h)return;const d={now:a.exported.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,_),this.light.updateTransitions(d)}_validate(c,_,l,h,d={}){return(!d||d.validate!==!1)&&vn(this,c.call(a.validateStyle,a.extend({key:_,style:this.serialize(),value:l,styleSpec:a.spec},h)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this.sourceCaches){const _=this.sourceCaches[c];_.setEventedParent(null),_.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){this.sourceCaches[c].clearTiles()}_reloadSource(c){this.sourceCaches[c].resume(),this.sourceCaches[c].reload()}_updateSources(c){for(const _ in this.sourceCaches)this.sourceCaches[_].update(c,this.terrain)}_generateCollisionBoxes(){for(const c in this.sourceCaches)this._reloadSource(c)}_updatePlacement(c,_,l,h,d=!1){let x=!1,b=!1;const S={};for(const M of this._order){const B=this._layers[M];if(B.type!=="symbol")continue;if(!S[B.source]){const $=this.sourceCaches[B.source];S[B.source]=$.getRenderableIds(!0).map(Y=>$.getTileByID(Y)).sort((Y,oe)=>oe.tileID.overscaledZ-Y.tileID.overscaledZ||(Y.tileID.isLessThan(oe.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(B,S[B.source],c.center.lng);x=x||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((d=d||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),c.zoom))&&(this.pauseablePlacement=new $e(c,this.terrain,this._order,d,_,l,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),b=!0),x&&this.pauseablePlacement.placement.setStale()),b||x)for(const M of this._order){const B=this._layers[M];B.type==="symbol"&&this.placement.updateLayerOpacities(B,S[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const c in this.sourceCaches)this.sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,_,l){this.imageManager.getImages(_.icons,l),this._updateTilesForChangedImages();const h=this.sourceCaches[_.source];h&&h.setDependencies(_.tileID.key,_.type,_.icons)}getGlyphs(c,_,l){this.glyphManager.getGlyphs(_.stacks,l)}getResource(c,_,l){return a.makeRequest(_,l)}}Se.getSourceType=function(k){return En[k]},Se.setSourceType=function(k,c){En[k]=c},Se.registerForPluginStateChange=a.registerForPluginStateChange;var An="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const ii={prelude:nr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:nr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:nr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:nr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:nr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:nr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:nr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:nr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:nr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:nr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:nr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:nr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:nr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:nr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:nr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:nr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:nr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:nr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:nr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:nr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:nr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:nr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:nr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:nr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:nr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:nr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:nr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",An),terrainDepth:nr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",An),terrainCoords:nr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",An)};function nr(k,c){const _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=c.match(/attribute ([\w]+) ([\w]+)/g),h=k.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=d?d.concat(h):h,b={};return{fragmentSource:k=k.replace(_,(S,M,B,V,$)=>(b[$]=!0,M==="define"?`
#ifndef HAS_UNIFORM_u_${$}
varying ${B} ${V} ${$};
#else
uniform ${B} ${V} u_${$};
#endif
`:`
#ifdef HAS_UNIFORM_u_${$}
    ${B} ${V} ${$} = u_${$};
#endif
`)),vertexSource:c=c.replace(_,(S,M,B,V,$)=>{const Y=V==="float"?"vec2":"vec4",oe=$.match(/color/)?"color":Y;return b[$]?M==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${B} ${Y} a_${$};
varying ${B} ${V} ${$};
#else
uniform ${B} ${V} u_${$};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = a_${$};
#else
    ${B} ${V} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = unpack_mix_${oe}(a_${$}, u_${$}_t);
#else
    ${B} ${V} ${$} = u_${$};
#endif
`:M==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${B} ${Y} a_${$};
#else
uniform ${B} ${V} u_${$};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${B} ${V} ${$} = a_${$};
#else
    ${B} ${V} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${B} ${V} ${$} = unpack_mix_${oe}(a_${$}, u_${$}_t);
#else
    ${B} ${V} ${$} = u_${$};
#endif
`}),staticAttributes:l,staticUniforms:x}}class ea{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(c,_,l,h,d,x,b,S,M){this.context=c;let B=this.boundPaintVertexBuffers.length!==h.length;for(let V=0;!B&&V<h.length;V++)this.boundPaintVertexBuffers[V]!==h[V]&&(B=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===_&&this.boundLayoutVertexBuffer===l&&!B&&this.boundIndexBuffer===d&&this.boundVertexOffset===x&&this.boundDynamicVertexBuffer===b&&this.boundDynamicVertexBuffer2===S&&this.boundDynamicVertexBuffer3===M?(c.bindVertexArrayOES.set(this.vao),b&&b.bind(),d&&d.dynamicDraw&&d.bind(),S&&S.bind(),M&&M.bind()):this.freshBind(_,l,h,d,x,b,S,M)}freshBind(c,_,l,h,d,x,b,S){let M;const B=c.numAttributes,V=this.context,$=V.gl;if(V.extVertexArrayObject)this.vao&&this.destroy(),this.vao=V.extVertexArrayObject.createVertexArrayOES(),V.bindVertexArrayOES.set(this.vao),M=0,this.boundProgram=c,this.boundLayoutVertexBuffer=_,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=h,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=S;else{M=V.currentNumAttributes||0;for(let Y=B;Y<M;Y++)$.disableVertexAttribArray(Y)}_.enableAttributes($,c);for(const Y of l)Y.enableAttributes($,c);x&&x.enableAttributes($,c),b&&b.enableAttributes($,c),S&&S.enableAttributes($,c),_.bind(),_.setVertexAttribPointers($,c,d);for(const Y of l)Y.bind(),Y.setVertexAttribPointers($,c,d);x&&(x.bind(),x.setVertexAttribPointers($,c,d)),h&&h.bind(),b&&(b.bind(),b.setVertexAttribPointers($,c,d)),S&&(S.bind(),S.setVertexAttribPointers($,c,d)),V.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function De(k){const c=[];for(let _=0;_<k.length;_++){if(k[_]===null)continue;const l=k[_].split(" ");c.push(l.pop())}return c}class Ia{constructor(c,_,l,h,d,x,b){const S=c.gl;this.program=S.createProgram();const M=De(l.staticAttributes),B=h?h.getBinderAttributes():[],V=M.concat(B),$=ii.prelude.staticUniforms?De(ii.prelude.staticUniforms):[],Y=l.staticUniforms?De(l.staticUniforms):[],oe=h?h.getBinderUniforms():[],te=$.concat(Y).concat(oe),ue=[];for(const xe of te)ue.indexOf(xe)<0&&ue.push(xe);const be=h?h.defines():[];x&&be.push("#define OVERDRAW_INSPECTOR;"),b&&be.push("#define TERRAIN3D;");const Ce=be.concat(ii.prelude.fragmentSource,l.fragmentSource).join(`
`),ve=be.concat(ii.prelude.vertexSource,l.vertexSource).join(`
`),Ge=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(Ge,Ce),S.compileShader(Ge),S.attachShader(this.program,Ge);const Te=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(Te,ve),S.compileShader(Te),S.attachShader(this.program,Te),this.attributes={};const Ve={};this.numAttributes=V.length;for(let xe=0;xe<this.numAttributes;xe++)V[xe]&&(S.bindAttribLocation(this.program,xe,V[xe]),this.attributes[V[xe]]=xe);S.linkProgram(this.program),S.deleteShader(Te),S.deleteShader(Ge);for(let xe=0;xe<ue.length;xe++){const m=ue[xe];if(m&&!Ve[m]){const g=S.getUniformLocation(this.program,m);g&&(Ve[m]=g)}}this.fixedUniforms=d(c,Ve),this.terrainUniforms=((xe,m)=>({u_depth:new a.Uniform1i(xe,m.u_depth),u_terrain:new a.Uniform1i(xe,m.u_terrain),u_terrain_dim:new a.Uniform1f(xe,m.u_terrain_dim),u_terrain_matrix:new a.UniformMatrix4f(xe,m.u_terrain_matrix),u_terrain_unpack:new a.Uniform4f(xe,m.u_terrain_unpack),u_terrain_offset:new a.Uniform1f(xe,m.u_terrain_offset),u_terrain_exaggeration:new a.Uniform1f(xe,m.u_terrain_exaggeration)}))(c,Ve),this.binderUniforms=h?h.getUniforms(c,Ve):[]}draw(c,_,l,h,d,x,b,S,M,B,V,$,Y,oe,te,ue,be,Ce){const ve=c.gl;if(this.failedToCreate)return;if(c.program.set(this.program),c.setDepthMode(l),c.setStencilMode(h),c.setColorMode(d),c.setCullFace(x),S){c.activeTexture.set(ve.TEXTURE2),ve.bindTexture(ve.TEXTURE_2D,S.depthTexture),c.activeTexture.set(ve.TEXTURE3),ve.bindTexture(ve.TEXTURE_2D,S.texture);for(const Te in this.terrainUniforms)this.terrainUniforms[Te].set(S[Te])}for(const Te in this.fixedUniforms)this.fixedUniforms[Te].set(b[Te]);te&&te.setUniforms(c,this.binderUniforms,Y,{zoom:oe});let Ge=0;switch(_){case ve.LINES:Ge=2;break;case ve.TRIANGLES:Ge=3;break;case ve.LINE_STRIP:Ge=1}for(const Te of $.get()){const Ve=Te.vaos||(Te.vaos={});(Ve[M]||(Ve[M]=new ea)).bind(c,this,B,te?te.getPaintVertexBuffers():[],V,Te.vertexOffset,ue,be,Ce),ve.drawElements(_,Te.primitiveLength*Ge,ve.UNSIGNED_SHORT,Te.primitiveOffset*Ge*2)}}}function we(k,c,_){const l=1/kr(_,1,c.transform.tileZoom),h=Math.pow(2,_.tileID.overscaledZ),d=_.tileSize*Math.pow(2,c.transform.tileZoom)/h,x=d*(_.tileID.canonical.x+_.tileID.wrap*h),b=d*_.tileID.canonical.y;return{u_image:0,u_texsize:_.imageAtlasTexture.size,u_scale:[l,k.fromScale,k.toScale],u_fade:k.t,u_pixel_coord_upper:[x>>16,b>>16],u_pixel_coord_lower:[65535&x,65535&b]}}const ko=(k,c,_,l)=>{const h=c.style.light,d=h.properties.get("position"),x=[d.x,d.y,d.z],b=a.create$1();h.properties.get("anchor")==="viewport"&&a.fromRotation(b,-c.transform.angle),a.transformMat3(x,x,b);const S=h.properties.get("color");return{u_matrix:k,u_lightpos:x,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[S.r,S.g,S.b],u_vertical_gradient:+_,u_opacity:l}},ds=(k,c,_,l,h,d,x)=>a.extend(ko(k,c,_,l),we(d,c,x),{u_height_factor:-Math.pow(2,h.overscaledZ)/x.tileSize/8}),ka=k=>({u_matrix:k}),La=(k,c,_,l)=>a.extend(ka(k),we(_,c,l)),ta=(k,c)=>({u_matrix:k,u_world:c}),Al=(k,c,_,l,h)=>a.extend(La(k,c,_,l),{u_world:h}),na=(k,c,_,l)=>{const h=k.transform;let d,x;if(l.paint.get("circle-pitch-alignment")==="map"){const b=kr(_,1,h.zoom);d=!0,x=[b,b]}else d=!1,x=h.pixelsToGLUnits;return{u_camera_to_center_distance:h.cameraToCenterDistance,u_scale_with_map:+(l.paint.get("circle-pitch-scale")==="map"),u_matrix:k.translatePosMatrix(c.posMatrix,_,l.paint.get("circle-translate"),l.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:k.pixelRatio,u_extrude_scale:x}},Yr=(k,c,_)=>{const l=kr(_,1,c.zoom),h=Math.pow(2,c.zoom-_.tileID.overscaledZ),d=_.tileID.overscaleFactor();return{u_matrix:k,u_camera_to_center_distance:c.cameraToCenterDistance,u_pixels_to_tile_units:l,u_extrude_scale:[c.pixelsToGLUnits[0]/(l*h),c.pixelsToGLUnits[1]/(l*h)],u_overscale_factor:d}},ge=(k,c,_=1)=>({u_matrix:k,u_color:c,u_overlay:0,u_overlay_scale:_}),Ee=k=>({u_matrix:k}),Fe=(k,c,_,l)=>({u_matrix:k,u_extrude_scale:kr(c,1,_),u_intensity:l});function ot(k,c){const _=Math.pow(2,c.canonical.z),l=c.canonical.y;return[new a.MercatorCoordinate(0,l/_).toLngLat().lat,new a.MercatorCoordinate(0,(l+1)/_).toLngLat().lat]}const wt=(k,c,_,l)=>{const h=k.transform;return{u_matrix:Cr(k,c,_,l),u_ratio:1/kr(c,1,h.zoom),u_device_pixel_ratio:k.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Wt=(k,c,_,l,h)=>a.extend(wt(k,c,_,h),{u_image:0,u_image_height:l}),kn=(k,c,_,l,h)=>{const d=k.transform,x=Jt(c,d);return{u_matrix:Cr(k,c,_,h),u_texsize:c.imageAtlasTexture.size,u_ratio:1/kr(c,1,d.zoom),u_device_pixel_ratio:k.pixelRatio,u_image:0,u_scale:[x,l.fromScale,l.toScale],u_fade:l.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Sr=(k,c,_,l,h,d)=>{const x=k.lineAtlas,b=Jt(c,k.transform),S=_.layout.get("line-cap")==="round",M=x.getDash(l.from,S),B=x.getDash(l.to,S),V=M.width*h.fromScale,$=B.width*h.toScale;return a.extend(wt(k,c,_,d),{u_patternscale_a:[b/V,-M.height/2],u_patternscale_b:[b/$,-B.height/2],u_sdfgamma:x.width/(256*Math.min(V,$)*k.pixelRatio)/2,u_image:0,u_tex_y_a:M.y,u_tex_y_b:B.y,u_mix:h.t})};function Jt(k,c){return 1/kr(k,1,c.tileZoom)}function Cr(k,c,_,l){return k.translatePosMatrix(l?l.posMatrix:c.tileID.posMatrix,c,_.paint.get("line-translate"),_.paint.get("line-translate-anchor"))}const Vn=(k,c,_,l,h)=>{return{u_matrix:k,u_tl_parent:c,u_scale_parent:_,u_buffer_scale:1,u_fade_t:l.mix,u_opacity:l.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(x=h.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(d=h.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:nA(h.paint.get("raster-hue-rotate"))};var d,x};function nA(k){k*=Math.PI/180;const c=Math.sin(k),_=Math.cos(k);return[(2*_+1)/3,(-Math.sqrt(3)*c-_+1)/3,(Math.sqrt(3)*c-_+1)/3]}const rA=(k,c,_,l,h,d,x,b,S,M)=>{const B=h.transform;return{u_is_size_zoom_constant:+(k==="constant"||k==="source"),u_is_size_feature_constant:+(k==="constant"||k==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:B.cameraToCenterDistance,u_pitch:B.pitch/360*2*Math.PI,u_rotate_symbol:+_,u_aspect_ratio:B.width/B.height,u_fade_change:h.options.fadeDuration?h.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:x,u_coord_matrix:b,u_is_text:+S,u_pitch_with_map:+l,u_texsize:M,u_texture:0}},iA=(k,c,_,l,h,d,x,b,S,M,B)=>{const V=h.transform;return a.extend(rA(k,c,_,l,h,d,x,b,S,M),{u_gamma_scale:l?Math.cos(V._pitch)*V.cameraToCenterDistance:1,u_device_pixel_ratio:h.pixelRatio,u_is_halo:+B})},FA=(k,c,_,l,h,d,x,b,S,M)=>a.extend(iA(k,c,_,l,h,d,x,b,!0,S,!0),{u_texsize_icon:M,u_texture_icon:1}),NA=(k,c,_)=>({u_matrix:k,u_opacity:c,u_color:_}),sA=(k,c,_,l,h,d)=>a.extend(function(x,b,S,M){const B=S.imageManager.getPattern(x.from.toString()),V=S.imageManager.getPattern(x.to.toString()),{width:$,height:Y}=S.imageManager.getPixelSize(),oe=Math.pow(2,M.tileID.overscaledZ),te=M.tileSize*Math.pow(2,S.transform.tileZoom)/oe,ue=te*(M.tileID.canonical.x+M.tileID.wrap*oe),be=te*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[$,Y],u_mix:b.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/kr(M,1,S.transform.tileZoom),u_pixel_coord_upper:[ue>>16,be>>16],u_pixel_coord_lower:[65535&ue,65535&be]}}(l,d,_,h),{u_matrix:k,u_opacity:c}),ul={fillExtrusion:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_lightpos:new a.Uniform3f(k,c.u_lightpos),u_lightintensity:new a.Uniform1f(k,c.u_lightintensity),u_lightcolor:new a.Uniform3f(k,c.u_lightcolor),u_vertical_gradient:new a.Uniform1f(k,c.u_vertical_gradient),u_opacity:new a.Uniform1f(k,c.u_opacity)}),fillExtrusionPattern:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_lightpos:new a.Uniform3f(k,c.u_lightpos),u_lightintensity:new a.Uniform1f(k,c.u_lightintensity),u_lightcolor:new a.Uniform3f(k,c.u_lightcolor),u_vertical_gradient:new a.Uniform1f(k,c.u_vertical_gradient),u_height_factor:new a.Uniform1f(k,c.u_height_factor),u_image:new a.Uniform1i(k,c.u_image),u_texsize:new a.Uniform2f(k,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(k,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(k,c.u_pixel_coord_lower),u_scale:new a.Uniform3f(k,c.u_scale),u_fade:new a.Uniform1f(k,c.u_fade),u_opacity:new a.Uniform1f(k,c.u_opacity)}),fill:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix)}),fillPattern:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_image:new a.Uniform1i(k,c.u_image),u_texsize:new a.Uniform2f(k,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(k,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(k,c.u_pixel_coord_lower),u_scale:new a.Uniform3f(k,c.u_scale),u_fade:new a.Uniform1f(k,c.u_fade)}),fillOutline:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_world:new a.Uniform2f(k,c.u_world)}),fillOutlinePattern:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_world:new a.Uniform2f(k,c.u_world),u_image:new a.Uniform1i(k,c.u_image),u_texsize:new a.Uniform2f(k,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(k,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(k,c.u_pixel_coord_lower),u_scale:new a.Uniform3f(k,c.u_scale),u_fade:new a.Uniform1f(k,c.u_fade)}),circle:(k,c)=>({u_camera_to_center_distance:new a.Uniform1f(k,c.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(k,c.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(k,c.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(k,c.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(k,c.u_matrix)}),collisionBox:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_camera_to_center_distance:new a.Uniform1f(k,c.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(k,c.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(k,c.u_extrude_scale),u_overscale_factor:new a.Uniform1f(k,c.u_overscale_factor)}),collisionCircle:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_inv_matrix:new a.UniformMatrix4f(k,c.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(k,c.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(k,c.u_viewport_size)}),debug:(k,c)=>({u_color:new a.UniformColor(k,c.u_color),u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_overlay:new a.Uniform1i(k,c.u_overlay),u_overlay_scale:new a.Uniform1f(k,c.u_overlay_scale)}),clippingMask:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix)}),heatmap:(k,c)=>({u_extrude_scale:new a.Uniform1f(k,c.u_extrude_scale),u_intensity:new a.Uniform1f(k,c.u_intensity),u_matrix:new a.UniformMatrix4f(k,c.u_matrix)}),heatmapTexture:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_world:new a.Uniform2f(k,c.u_world),u_image:new a.Uniform1i(k,c.u_image),u_color_ramp:new a.Uniform1i(k,c.u_color_ramp),u_opacity:new a.Uniform1f(k,c.u_opacity)}),hillshade:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_image:new a.Uniform1i(k,c.u_image),u_latrange:new a.Uniform2f(k,c.u_latrange),u_light:new a.Uniform2f(k,c.u_light),u_shadow:new a.UniformColor(k,c.u_shadow),u_highlight:new a.UniformColor(k,c.u_highlight),u_accent:new a.UniformColor(k,c.u_accent)}),hillshadePrepare:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_image:new a.Uniform1i(k,c.u_image),u_dimension:new a.Uniform2f(k,c.u_dimension),u_zoom:new a.Uniform1f(k,c.u_zoom),u_unpack:new a.Uniform4f(k,c.u_unpack)}),line:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_ratio:new a.Uniform1f(k,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(k,c.u_units_to_pixels)}),lineGradient:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_ratio:new a.Uniform1f(k,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(k,c.u_units_to_pixels),u_image:new a.Uniform1i(k,c.u_image),u_image_height:new a.Uniform1f(k,c.u_image_height)}),linePattern:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_texsize:new a.Uniform2f(k,c.u_texsize),u_ratio:new a.Uniform1f(k,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_image:new a.Uniform1i(k,c.u_image),u_units_to_pixels:new a.Uniform2f(k,c.u_units_to_pixels),u_scale:new a.Uniform3f(k,c.u_scale),u_fade:new a.Uniform1f(k,c.u_fade)}),lineSDF:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_ratio:new a.Uniform1f(k,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(k,c.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(k,c.u_patternscale_a),u_patternscale_b:new a.Uniform2f(k,c.u_patternscale_b),u_sdfgamma:new a.Uniform1f(k,c.u_sdfgamma),u_image:new a.Uniform1i(k,c.u_image),u_tex_y_a:new a.Uniform1f(k,c.u_tex_y_a),u_tex_y_b:new a.Uniform1f(k,c.u_tex_y_b),u_mix:new a.Uniform1f(k,c.u_mix)}),raster:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_tl_parent:new a.Uniform2f(k,c.u_tl_parent),u_scale_parent:new a.Uniform1f(k,c.u_scale_parent),u_buffer_scale:new a.Uniform1f(k,c.u_buffer_scale),u_fade_t:new a.Uniform1f(k,c.u_fade_t),u_opacity:new a.Uniform1f(k,c.u_opacity),u_image0:new a.Uniform1i(k,c.u_image0),u_image1:new a.Uniform1i(k,c.u_image1),u_brightness_low:new a.Uniform1f(k,c.u_brightness_low),u_brightness_high:new a.Uniform1f(k,c.u_brightness_high),u_saturation_factor:new a.Uniform1f(k,c.u_saturation_factor),u_contrast_factor:new a.Uniform1f(k,c.u_contrast_factor),u_spin_weights:new a.Uniform3f(k,c.u_spin_weights)}),symbolIcon:(k,c)=>({u_is_size_zoom_constant:new a.Uniform1i(k,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(k,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(k,c.u_size_t),u_size:new a.Uniform1f(k,c.u_size),u_camera_to_center_distance:new a.Uniform1f(k,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(k,c.u_pitch),u_rotate_symbol:new a.Uniform1i(k,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(k,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(k,c.u_fade_change),u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(k,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(k,c.u_coord_matrix),u_is_text:new a.Uniform1i(k,c.u_is_text),u_pitch_with_map:new a.Uniform1i(k,c.u_pitch_with_map),u_texsize:new a.Uniform2f(k,c.u_texsize),u_texture:new a.Uniform1i(k,c.u_texture)}),symbolSDF:(k,c)=>({u_is_size_zoom_constant:new a.Uniform1i(k,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(k,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(k,c.u_size_t),u_size:new a.Uniform1f(k,c.u_size),u_camera_to_center_distance:new a.Uniform1f(k,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(k,c.u_pitch),u_rotate_symbol:new a.Uniform1i(k,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(k,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(k,c.u_fade_change),u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(k,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(k,c.u_coord_matrix),u_is_text:new a.Uniform1i(k,c.u_is_text),u_pitch_with_map:new a.Uniform1i(k,c.u_pitch_with_map),u_texsize:new a.Uniform2f(k,c.u_texsize),u_texture:new a.Uniform1i(k,c.u_texture),u_gamma_scale:new a.Uniform1f(k,c.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(k,c.u_is_halo)}),symbolTextAndIcon:(k,c)=>({u_is_size_zoom_constant:new a.Uniform1i(k,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(k,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(k,c.u_size_t),u_size:new a.Uniform1f(k,c.u_size),u_camera_to_center_distance:new a.Uniform1f(k,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(k,c.u_pitch),u_rotate_symbol:new a.Uniform1i(k,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(k,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(k,c.u_fade_change),u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(k,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(k,c.u_coord_matrix),u_is_text:new a.Uniform1i(k,c.u_is_text),u_pitch_with_map:new a.Uniform1i(k,c.u_pitch_with_map),u_texsize:new a.Uniform2f(k,c.u_texsize),u_texsize_icon:new a.Uniform2f(k,c.u_texsize_icon),u_texture:new a.Uniform1i(k,c.u_texture),u_texture_icon:new a.Uniform1i(k,c.u_texture_icon),u_gamma_scale:new a.Uniform1f(k,c.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(k,c.u_is_halo)}),background:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_opacity:new a.Uniform1f(k,c.u_opacity),u_color:new a.UniformColor(k,c.u_color)}),backgroundPattern:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_opacity:new a.Uniform1f(k,c.u_opacity),u_image:new a.Uniform1i(k,c.u_image),u_pattern_tl_a:new a.Uniform2f(k,c.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(k,c.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(k,c.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(k,c.u_pattern_br_b),u_texsize:new a.Uniform2f(k,c.u_texsize),u_mix:new a.Uniform1f(k,c.u_mix),u_pattern_size_a:new a.Uniform2f(k,c.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(k,c.u_pattern_size_b),u_scale_a:new a.Uniform1f(k,c.u_scale_a),u_scale_b:new a.Uniform1f(k,c.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(k,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(k,c.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(k,c.u_tile_units_to_pixels)}),terrain:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_texture:new a.Uniform1i(k,c.u_texture)}),terrainDepth:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix)}),terrainCoords:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_texture:new a.Uniform1i(k,c.u_texture),u_terrain_coords_id:new a.Uniform1f(k,c.u_terrain_coords_id)})};class cl{constructor(c,_,l){this.context=c;const h=c.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete _.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const _=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),_.bufferSubData(_.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const oA={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class aA{constructor(c,_,l,h){this.length=_.length,this.attributes=l,this.itemSize=_.bytesPerElement,this.dynamicDraw=h,this.context=c;const d=c.gl;this.buffer=d.createBuffer(),c.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete _.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){if(c.length!==this.length)throw new Error(`Length of new data is ${c.length}, which doesn't match current length of ${this.length}`);const _=this.context.gl;this.bind(),_.bufferSubData(_.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,_){for(let l=0;l<this.attributes.length;l++){const h=_.attributes[this.attributes[l].name];h!==void 0&&c.enableVertexAttribArray(h)}}setVertexAttribPointers(c,_,l){for(let h=0;h<this.attributes.length;h++){const d=this.attributes[h],x=_.attributes[d.name];x!==void 0&&c.vertexAttribPointer(x,d.components,c[oA[d.type]],!1,this.itemSize,d.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Yn{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class UA extends Yn{getDefault(){return a.Color.transparent}set(c){const _=this.current;(c.r!==_.r||c.g!==_.g||c.b!==_.b||c.a!==_.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class qu extends Yn{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class hl extends Yn{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class Gr extends Yn{getDefault(){return[!0,!0,!0,!0]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||c[3]!==_[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Lo extends Yn{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class Bn extends Yn{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class ps extends Yn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const _=this.current;(c.func!==_.func||c.ref!==_.ref||c.mask!==_.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class Xr extends Yn{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class ao extends Yn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.STENCIL_TEST):_.disable(_.STENCIL_TEST),this.current=c,this.dirty=!1}}class fl extends Yn{getDefault(){return[0,1]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class Do extends Yn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.DEPTH_TEST):_.disable(_.DEPTH_TEST),this.current=c,this.dirty=!1}}class ra extends Yn{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class lo extends Yn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.BLEND):_.disable(_.BLEND),this.current=c,this.dirty=!1}}class lA extends Yn{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class Da extends Yn{getDefault(){return a.Color.transparent}set(c){const _=this.current;(c.r!==_.r||c.g!==_.g||c.b!==_.b||c.a!==_.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Ro extends Yn{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class Oi extends Yn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.CULL_FACE):_.disable(_.CULL_FACE),this.current=c,this.dirty=!1}}class Fi extends Yn{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class VA extends Yn{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class dl extends Yn{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class Ao extends Yn{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class Bo extends Yn{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||c[3]!==_[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Zu extends Yn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindFramebuffer(_.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class GA extends Yn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindRenderbuffer(_.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class pl extends Yn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindTexture(_.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class AA extends Yn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindBuffer(_.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class jA extends Yn{getDefault(){return null}set(c){const _=this.gl;_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class zo extends Yn{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class Ra extends Yn{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class $A extends Yn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class HA extends Yn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class uo extends Yn{constructor(c,_){super(c),this.context=c,this.parent=_}getDefault(){return null}}class ia extends uo{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class WA extends uo{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class sa{constructor(c,_,l,h){this.context=c,this.width=_,this.height=l;const d=c.gl,x=this.framebuffer=d.createFramebuffer();if(this.colorAttachment=new ia(c,x),h&&(this.depthAttachment=new WA(c,x)),d.checkFramebufferStatus(d.FRAMEBUFFER)!==d.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const c=this.context.gl,_=this.colorAttachment.get();if(_&&c.deleteTexture(_),this.depthAttachment){const l=this.depthAttachment.get();l&&c.deleteRenderbuffer(l)}c.deleteFramebuffer(this.framebuffer)}}class ur{constructor(c,_,l){this.blendFunction=c,this.blendColor=_,this.mask=l}}ur.Replace=[1,0],ur.disabled=new ur(ur.Replace,a.Color.transparent,[!1,!1,!1,!1]),ur.unblended=new ur(ur.Replace,a.Color.transparent,[!0,!0,!0,!0]),ur.alphaBlended=new ur([1,771],a.Color.transparent,[!0,!0,!0,!0]);class Is{constructor(c){this.gl=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new UA(this),this.clearDepth=new qu(this),this.clearStencil=new hl(this),this.colorMask=new Gr(this),this.depthMask=new Lo(this),this.stencilMask=new Bn(this),this.stencilFunc=new ps(this),this.stencilOp=new Xr(this),this.stencilTest=new ao(this),this.depthRange=new fl(this),this.depthTest=new Do(this),this.depthFunc=new ra(this),this.blend=new lo(this),this.blendFunc=new lA(this),this.blendColor=new Da(this),this.blendEquation=new Ro(this),this.cullFace=new Oi(this),this.cullFaceSide=new Fi(this),this.frontFace=new VA(this),this.program=new dl(this),this.activeTexture=new Ao(this),this.viewport=new Bo(this),this.bindFramebuffer=new Zu(this),this.bindRenderbuffer=new GA(this),this.bindTexture=new pl(this),this.bindVertexBuffer=new AA(this),this.bindElementBuffer=new jA(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new zo(this),this.pixelStoreUnpack=new Ra(this),this.pixelStoreUnpackPremultiplyAlpha=new $A(this),this.pixelStoreUnpackFlipY=new HA(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=c.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(c.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,_){return new cl(this,c,_)}createVertexBuffer(c,_,l){return new aA(this,c,_,l)}createRenderbuffer(c,_,l){const h=this.gl,d=h.createRenderbuffer();return this.bindRenderbuffer.set(d),h.renderbufferStorage(h.RENDERBUFFER,c,_,l),this.bindRenderbuffer.set(null),d}createFramebuffer(c,_,l){return new sa(this,c,_,l)}clear({color:c,depth:_}){const l=this.gl;let h=0;c&&(h|=l.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),_!==void 0&&(h|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(_),this.depthMask.set(!0)),l.clear(h)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){I(c.blendFunction,ur.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Gn{constructor(c,_,l){this.func=c,this.mask=_,this.range=l}}Gn.ReadOnly=!1,Gn.ReadWrite=!0,Gn.disabled=new Gn(519,Gn.ReadOnly,[0,1]);const Wn=7680;class yr{constructor(c,_,l,h,d,x){this.test=c,this.ref=_,this.mask=l,this.fail=h,this.depthFail=d,this.pass=x}}yr.disabled=new yr({func:519,mask:0},0,0,Wn,Wn,Wn);class hr{constructor(c,_,l){this.enable=c,this.mode=_,this.frontFace=l}}let gl;function Oo(k,c,_,l,h,d,x){const b=k.context,S=b.gl,M=k.useProgram("collisionBox"),B=[];let V=0,$=0;for(let ve=0;ve<l.length;ve++){const Ge=l[ve],Te=c.getTile(Ge),Ve=Te.getBucket(_);if(!Ve)continue;let xe=Ge.posMatrix;h[0]===0&&h[1]===0||(xe=k.translatePosMatrix(Ge.posMatrix,Te,h,d));const m=x?Ve.textCollisionBox:Ve.iconCollisionBox,g=Ve.collisionCircleArray;if(g.length>0){const v=a.create(),E=xe;a.mul(v,Ve.placementInvProjMatrix,k.transform.glCoordMatrix),a.mul(v,v,Ve.placementViewportMatrix),B.push({circleArray:g,circleOffset:$,transform:E,invTransform:v,coord:Ge}),V+=g.length/4,$=V}m&&M.draw(b,S.LINES,Gn.disabled,yr.disabled,k.colorModeForRenderPass(),hr.disabled,Yr(xe,k.transform,Te),k.style.terrain&&k.style.terrain.getTerrainData(Ge),_.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,k.transform.zoom,null,null,m.collisionVertexBuffer)}if(!x||!B.length)return;const Y=k.useProgram("collisionCircle"),oe=new a.CollisionCircleLayoutArray;oe.resize(4*V),oe._trim();let te=0;for(const ve of B)for(let Ge=0;Ge<ve.circleArray.length/4;Ge++){const Te=4*Ge,Ve=ve.circleArray[Te+0],xe=ve.circleArray[Te+1],m=ve.circleArray[Te+2],g=ve.circleArray[Te+3];oe.emplace(te++,Ve,xe,m,g,0),oe.emplace(te++,Ve,xe,m,g,1),oe.emplace(te++,Ve,xe,m,g,2),oe.emplace(te++,Ve,xe,m,g,3)}(!gl||gl.length<2*V)&&(gl=function(ve){const Ge=2*ve,Te=new a.QuadTriangleArray;Te.resize(Ge),Te._trim();for(let Ve=0;Ve<Ge;Ve++){const xe=6*Ve;Te.uint16[xe+0]=4*Ve+0,Te.uint16[xe+1]=4*Ve+1,Te.uint16[xe+2]=4*Ve+2,Te.uint16[xe+3]=4*Ve+2,Te.uint16[xe+4]=4*Ve+3,Te.uint16[xe+5]=4*Ve+0}return Te}(V));const ue=b.createIndexBuffer(gl,!0),be=b.createVertexBuffer(oe,a.collisionCircleLayout.members,!0);for(const ve of B){const Ge={u_matrix:ve.transform,u_inv_matrix:ve.invTransform,u_camera_to_center_distance:(Ce=k.transform).cameraToCenterDistance,u_viewport_size:[Ce.width,Ce.height]};Y.draw(b,S.TRIANGLES,Gn.disabled,yr.disabled,k.colorModeForRenderPass(),hr.disabled,Ge,k.style.terrain&&k.style.terrain.getTerrainData(ve.coord),_.id,be,ue,a.SegmentVector.simpleSegment(0,2*ve.circleOffset,ve.circleArray.length,ve.circleArray.length/2),null,k.transform.zoom,null,null,null)}var Ce;be.destroy(),ue.destroy()}hr.disabled=new hr(!1,1029,2305),hr.backCCW=new hr(!0,1029,2305);const Yu=a.identity(new Float32Array(16));function Ba(k,c,_,l,h,d){const{horizontalAlign:x,verticalAlign:b}=a.getAnchorAlignment(k),S=-(x-.5)*c,M=-(b-.5)*_,B=a.evaluateVariableOffset(k,l);return new a.pointGeometry((S/h+B[0])*d,(M/h+B[1])*d)}function Xu(k,c,_,l,h,d,x,b,S,M,B){const V=k.text.placedSymbolArray,$=k.text.dynamicLayoutVertexArray,Y=k.icon.dynamicLayoutVertexArray,oe={};$.clear();for(let te=0;te<V.length;te++){const ue=V.get(te),be=k.allowVerticalPlacement&&!ue.placedOrientation,Ce=ue.hidden||!ue.crossTileID||be?null:l[ue.crossTileID];if(Ce){const ve=new a.pointGeometry(ue.anchorX,ue.anchorY),Ge=Rn(ve,_?x:d,B),Te=Ri(h.cameraToCenterDistance,Ge.signedDistanceFromCamera);let Ve=a.evaluateSizeForFeature(k.textSizeData,S,ue)*Te/a.ONE_EM;_&&(Ve*=k.tilePixelRatio/b);const{width:xe,height:m,anchor:g,textOffset:v,textBoxScale:E}=Ce,C=Ba(g,xe,m,v,E,Ve),R=_?Rn(ve.add(C),d,B).point:Ge.point.add(c?C.rotate(-h.angle):C),O=k.allowVerticalPlacement&&ue.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let N=0;N<ue.numGlyphs;N++)a.addDynamicAttributes($,R,O);M&&ue.associatedIconIndex>=0&&(oe[ue.associatedIconIndex]={shiftedAnchor:R,angle:O})}else mn(ue.numGlyphs,$)}if(M){Y.clear();const te=k.icon.placedSymbolArray;for(let ue=0;ue<te.length;ue++){const be=te.get(ue);if(be.hidden)mn(be.numGlyphs,Y);else{const Ce=oe[ue];if(Ce)for(let ve=0;ve<be.numGlyphs;ve++)a.addDynamicAttributes(Y,Ce.shiftedAnchor,Ce.angle);else mn(be.numGlyphs,Y)}}k.icon.dynamicLayoutVertexBuffer.updateData(Y)}k.text.dynamicLayoutVertexBuffer.updateData($)}function QA(k,c,_){return _.iconsInText&&c?"symbolTextAndIcon":k?"symbolSDF":"symbolIcon"}function ks(k,c,_,l,h,d,x,b,S,M,B,V){const $=k.context,Y=$.gl,oe=k.transform,te=b==="map",ue=S==="map",be=b!=="viewport"&&_.layout.get("symbol-placement")!=="point",Ce=te&&!ue&&!be,ve=!_.layout.get("symbol-sort-key").isConstant();let Ge=!1;const Te=k.depthModeForSublayer(0,Gn.ReadOnly),Ve=_.layout.get("text-variable-anchor"),xe=[];for(const m of l){const g=c.getTile(m),v=g.getBucket(_);if(!v)continue;const E=h?v.text:v.icon;if(!E||!E.segments.get().length)continue;const C=E.programConfigurations.get(_.id),R=h||v.sdfIcons,O=h?v.textSizeData:v.iconSizeData,N=ue||oe.pitch!==0,Q=k.useProgram(QA(R,h,v),C),J=a.evaluateSizeForZoom(O,oe.zoom),le=k.style.terrain&&k.style.terrain.getTerrainData(m);let de,Re,je,Be,Ye=[0,0],ht=null;if(h){if(Re=g.glyphAtlasTexture,je=Y.LINEAR,de=g.glyphAtlasTexture.size,v.iconsInText){Ye=g.imageAtlasTexture.size,ht=g.imageAtlasTexture;const yn=O.kind==="composite"||O.kind==="camera";Be=N||k.options.rotating||k.options.zooming||yn?Y.LINEAR:Y.NEAREST}}else{const yn=_.layout.get("icon-size").constantOr(0)!==1||v.iconsNeedLinear;Re=g.imageAtlasTexture,je=R||k.options.rotating||k.options.zooming||yn||N?Y.LINEAR:Y.NEAREST,de=g.imageAtlasTexture.size}const ut=kr(g,1,k.transform.zoom),rt=Ms(m.posMatrix,ue,te,k.transform,ut),it=pi(m.posMatrix,ue,te,k.transform,ut),Xe=Ve&&v.hasTextData(),Vt=_.layout.get("icon-text-fit")!=="none"&&Xe&&v.hasIconData();if(be){const yn=k.style.terrain?(Ln,sr)=>k.style.terrain.getElevation(m,Ln,sr):null,bn=_.layout.get("text-rotation-alignment")==="map";Ti(v,m.posMatrix,k,h,rt,it,ue,M,bn,yn)}const Bt=k.translatePosMatrix(m.posMatrix,g,d,x),dt=be||h&&Ve||Vt?Yu:rt,_t=k.translatePosMatrix(it,g,d,x,!0),Cn=R&&_.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let xn;xn=R?v.iconsInText?FA(O.kind,J,Ce,ue,k,Bt,dt,_t,de,Ye):iA(O.kind,J,Ce,ue,k,Bt,dt,_t,h,de,!0):rA(O.kind,J,Ce,ue,k,Bt,dt,_t,h,de);const gn={program:Q,buffers:E,uniformValues:xn,atlasTexture:Re,atlasTextureIcon:ht,atlasInterpolation:je,atlasInterpolationIcon:Be,isSDF:R,hasHalo:Cn};if(ve&&v.canOverlap){Ge=!0;const yn=E.segments.get();for(const bn of yn)xe.push({segments:new a.SegmentVector([bn]),sortKey:bn.sortKey,state:gn,terrainData:le})}else xe.push({segments:E.segments,sortKey:0,state:gn,terrainData:le})}Ge&&xe.sort((m,g)=>m.sortKey-g.sortKey);for(const m of xe){const g=m.state;if($.activeTexture.set(Y.TEXTURE0),g.atlasTexture.bind(g.atlasInterpolation,Y.CLAMP_TO_EDGE),g.atlasTextureIcon&&($.activeTexture.set(Y.TEXTURE1),g.atlasTextureIcon&&g.atlasTextureIcon.bind(g.atlasInterpolationIcon,Y.CLAMP_TO_EDGE)),g.isSDF){const v=g.uniformValues;g.hasHalo&&(v.u_is_halo=1,ml(g.buffers,m.segments,_,k,g.program,Te,B,V,v,m.terrainData)),v.u_is_halo=0}ml(g.buffers,m.segments,_,k,g.program,Te,B,V,g.uniformValues,m.terrainData)}}function ml(k,c,_,l,h,d,x,b,S,M){const B=l.context;h.draw(B,B.gl.TRIANGLES,d,x,b,hr.disabled,S,M,_.id,k.layoutVertexBuffer,k.indexBuffer,c,_.paint,l.transform.zoom,k.programConfigurations.get(_.id),k.dynamicLayoutVertexBuffer,k.opacityVertexBuffer)}function za(k,c,_,l,h,d,x){const b=k.context.gl,S=_.paint.get("fill-pattern"),M=S&&S.constantOr(1),B=_.getCrossfadeParameters();let V,$,Y,oe,te;x?($=M&&!_.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=b.LINES):($=M?"fillPattern":"fill",V=b.TRIANGLES);for(const ue of l){const be=c.getTile(ue);if(M&&!be.patternsLoaded())continue;const Ce=be.getBucket(_);if(!Ce)continue;const ve=Ce.programConfigurations.get(_.id),Ge=k.useProgram($,ve),Te=k.style.terrain&&k.style.terrain.getTerrainData(ue);M&&(k.context.activeTexture.set(b.TEXTURE0),be.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),ve.updatePaintBuffers(B));const Ve=S.constantOr(null);if(Ve&&be.imageAtlas){const g=be.imageAtlas,v=g.patternPositions[Ve.to.toString()],E=g.patternPositions[Ve.from.toString()];v&&E&&ve.setConstantPatternPositions(v,E)}const xe=Te?ue:null,m=k.translatePosMatrix(xe?xe.posMatrix:ue.posMatrix,be,_.paint.get("fill-translate"),_.paint.get("fill-translate-anchor"));if(x){oe=Ce.indexBuffer2,te=Ce.segments2;const g=[b.drawingBufferWidth,b.drawingBufferHeight];Y=$==="fillOutlinePattern"&&M?Al(m,k,B,be,g):ta(m,g)}else oe=Ce.indexBuffer,te=Ce.segments,Y=M?La(m,k,B,be):ka(m);Ge.draw(k.context,V,h,k.stencilModeForClipping(ue),d,hr.disabled,Y,Te,_.id,Ce.layoutVertexBuffer,oe,te,_.paint,k.transform.zoom,ve)}}function oa(k,c,_,l,h,d,x){const b=k.context,S=b.gl,M=_.paint.get("fill-extrusion-pattern"),B=M.constantOr(1),V=_.getCrossfadeParameters(),$=_.paint.get("fill-extrusion-opacity");for(const Y of l){const oe=c.getTile(Y),te=oe.getBucket(_);if(!te)continue;const ue=k.style.terrain&&k.style.terrain.getTerrainData(Y),be=te.programConfigurations.get(_.id),Ce=k.useProgram(B?"fillExtrusionPattern":"fillExtrusion",be);B&&(k.context.activeTexture.set(S.TEXTURE0),oe.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),be.updatePaintBuffers(V));const ve=M.constantOr(null);if(ve&&oe.imageAtlas){const xe=oe.imageAtlas,m=xe.patternPositions[ve.to.toString()],g=xe.patternPositions[ve.from.toString()];m&&g&&be.setConstantPatternPositions(m,g)}const Ge=k.translatePosMatrix(Y.posMatrix,oe,_.paint.get("fill-extrusion-translate"),_.paint.get("fill-extrusion-translate-anchor")),Te=_.paint.get("fill-extrusion-vertical-gradient"),Ve=B?ds(Ge,k,Te,$,Y,V,oe):ko(Ge,k,Te,$);Ce.draw(b,b.gl.TRIANGLES,h,d,x,hr.backCCW,Ve,ue,_.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,_.paint,k.transform.zoom,be,k.style.terrain&&te.centroidVertexBuffer)}}function yl(k,c,_,l,h,d,x){const b=k.context,S=b.gl,M=_.fbo;if(!M)return;const B=k.useProgram("hillshade"),V=k.style.terrain&&k.style.terrain.getTerrainData(c);b.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,M.colorAttachment.get()),B.draw(b,S.TRIANGLES,h,d,x,hr.disabled,(($,Y,oe,te)=>{const ue=oe.paint.get("hillshade-shadow-color"),be=oe.paint.get("hillshade-highlight-color"),Ce=oe.paint.get("hillshade-accent-color");let ve=oe.paint.get("hillshade-illumination-direction")*(Math.PI/180);oe.paint.get("hillshade-illumination-anchor")==="viewport"&&(ve-=$.transform.angle);const Ge=!$.options.moving;return{u_matrix:te?te.posMatrix:$.transform.calculatePosMatrix(Y.tileID.toUnwrapped(),Ge),u_image:0,u_latrange:ot(0,Y.tileID),u_light:[oe.paint.get("hillshade-exaggeration"),ve],u_shadow:ue,u_highlight:be,u_accent:Ce}})(k,_,l,V?c:null),V,l.id,k.rasterBoundsBuffer,k.quadTriangleIndexBuffer,k.rasterBoundsSegments)}function _l(k,c,_,l,h,d){const x=k.context,b=x.gl,S=c.dem;if(S&&S.data){const M=S.dim,B=S.stride,V=S.getPixels();if(x.activeTexture.set(b.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||k.getTileTexture(B),c.demTexture){const Y=c.demTexture;Y.update(V,{premultiply:!1}),Y.bind(b.NEAREST,b.CLAMP_TO_EDGE)}else c.demTexture=new q(x,V,b.RGBA,{premultiply:!1}),c.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);x.activeTexture.set(b.TEXTURE0);let $=c.fbo;if(!$){const Y=new q(x,{width:M,height:M,data:null},b.RGBA);Y.bind(b.LINEAR,b.CLAMP_TO_EDGE),$=c.fbo=x.createFramebuffer(M,M,!0),$.colorAttachment.set(Y.texture)}x.bindFramebuffer.set($.framebuffer),x.viewport.set([0,0,M,M]),k.useProgram("hillshadePrepare").draw(x,b.TRIANGLES,l,h,d,hr.disabled,((Y,oe)=>{const te=oe.stride,ue=a.create();return a.ortho(ue,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(ue,ue,[0,-a.EXTENT,0]),{u_matrix:ue,u_image:1,u_dimension:[te,te],u_zoom:Y.overscaledZ,u_unpack:oe.getUnpackVector()}})(c.tileID,S),null,_.id,k.rasterBoundsBuffer,k.quadTriangleIndexBuffer,k.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function fr(k,c,_,l,h,d){const x=l.paint.get("raster-fade-duration");if(!d&&x>0){const b=a.exported.now(),S=(b-k.timeAdded)/x,M=c?(b-c.timeAdded)/x:-1,B=_.getSource(),V=h.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),$=!c||Math.abs(c.tileID.overscaledZ-V)>Math.abs(k.tileID.overscaledZ-V),Y=$&&k.refreshedUponExpiration?1:a.clamp($?S:1-M,0,1);return k.refreshedUponExpiration&&S>=1&&(k.refreshedUponExpiration=!1),c?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}const uA=new a.Color(1,0,0,1),ts=new a.Color(0,1,0,1),qA=new a.Color(0,0,1,1),vl=new a.Color(1,0,1,1),Ku=new a.Color(0,1,1,1);function jr(k,c,_,l){Kr(k,0,c+_/2,k.transform.width,_,l)}function Pr(k,c,_,l){Kr(k,c-_/2,0,_,k.transform.height,l)}function Kr(k,c,_,l,h,d){const x=k.context,b=x.gl;b.enable(b.SCISSOR_TEST),b.scissor(c*k.pixelRatio,_*k.pixelRatio,l*k.pixelRatio,h*k.pixelRatio),x.clear({color:d}),b.disable(b.SCISSOR_TEST)}function ZA(k,c,_){const l=k.context,h=l.gl,d=_.posMatrix,x=k.useProgram("debug"),b=Gn.disabled,S=yr.disabled,M=k.colorModeForRenderPass(),B="$debug",V=k.style.terrain&&k.style.terrain.getTerrainData(_);l.activeTexture.set(h.TEXTURE0),k.emptyTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE);const $=c.getTileByID(_.key).latestRawTileData,Y=Math.floor(($&&$.byteLength||0)/1024),oe=c.getTile(_).tileSize,te=512/Math.min(oe,512)*(_.overscaledZ/k.transform.zoom)*.5;let ue=_.canonical.toString();_.overscaledZ!==_.canonical.z&&(ue+=` => ${_.overscaledZ}`),function(be,Ce){be.initDebugOverlayCanvas();const ve=be.debugOverlayCanvas,Ge=be.context.gl,Te=be.debugOverlayCanvas.getContext("2d");Te.clearRect(0,0,ve.width,ve.height),Te.shadowColor="white",Te.shadowBlur=2,Te.lineWidth=1.5,Te.strokeStyle="white",Te.textBaseline="top",Te.font="bold 36px Open Sans, sans-serif",Te.fillText(Ce,5,5),Te.strokeText(Ce,5,5),be.debugOverlayTexture.update(ve),be.debugOverlayTexture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE)}(k,`${ue} ${Y}kB`),x.draw(l,h.TRIANGLES,b,S,ur.alphaBlended,hr.disabled,ge(d,a.Color.transparent,te),null,B,k.debugBuffer,k.quadTriangleIndexBuffer,k.debugSegments),x.draw(l,h.LINE_STRIP,b,S,M,hr.disabled,ge(d,a.Color.red),V,B,k.debugBuffer,k.tileBorderIndexBuffer,k.debugSegments)}function Ls(k,c,_){const l=k.context,h=l.gl,d=k.colorModeForRenderPass(),x=new Gn(h.LEQUAL,Gn.ReadWrite,k.depthRangeFor3D),b=k.useProgram("terrain"),S=c.getTerrainMesh(),M=c.getTerrainData(_.tileID);l.bindFramebuffer.set(null),l.viewport.set([0,0,k.width,k.height]),l.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,c.getRTTFramebuffer().colorAttachment.get());const B=k.transform.calculatePosMatrix(_.tileID.toUnwrapped());b.draw(l,h.TRIANGLES,x,yr.disabled,d,hr.backCCW,{u_matrix:B,u_texture:0},M,"terrain",S.vertexBuffer,S.indexBuffer,S.segments)}function Ju(k,c,_,l){const h=k.context,d=_.tileSize*c.qualityFactor;_.textures[l]||(_.textures[l]=k.getTileTexture(d)||new q(h,{width:d,height:d,data:null},h.gl.RGBA),_.textures[l].bind(h.gl.LINEAR,h.gl.CLAMP_TO_EDGE),l===0&&c.sourceCache.renderHistory.unshift(_.tileID.key));const x=c.getRTTFramebuffer();x.colorAttachment.set(_.textures[l].texture),h.bindFramebuffer.set(x.framebuffer),h.viewport.set([0,0,d,d])}class cA{constructor(c){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=c,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=c.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const c=this.painter.style,_=c.terrain;for(const l in c.sourceCaches){this._coordsDescendingInv[l]={};const h=c.sourceCaches[l].getVisibleCoordinates();for(const d of h){const x=_.sourceCache.getTerrainCoords(d);for(const b in x)this._coordsDescendingInv[l][b]||(this._coordsDescendingInv[l][b]=[]),this._coordsDescendingInv[l][b].push(x[b])}}for(const l of c._order){const h=c._layers[l],d=h.source;if(this._renderToTexture[h.type]&&!this._coordsDescendingInvStr[d]){this._coordsDescendingInvStr[d]={};for(const x in this._coordsDescendingInv[d])this._coordsDescendingInvStr[d][x]=this._coordsDescendingInv[d][x].map(b=>b.key).sort().join()}}return this._renderableTiles.forEach(l=>{for(const h in this._coordsDescendingInvStr){const d=this._coordsDescendingInvStr[h][l.tileID.key];d&&d!==l.textureCoords[h]&&l.clearTextures(this.painter),_.needsRerender(h,l.tileID)&&l.clearTextures(this.painter)}this._rerender[l.tileID.key]=!l.textures.length}),_.clearRerenderCache(),_.sourceCache.removeOutdated(this.painter),this}renderLayer(c){const _=c.type,l=this.painter,h=l.style._order,d=l.currentLayer,x=d+1===h.length;if(this._renderToTexture[_]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=_,this._stacks[this._stacks.length-1].push(h[d]),!x))return!0;if(this._renderToTexture[this._prevType]||_==="hillshade"||this._renderToTexture[_]&&x){this._prevType=_;const b=this._stacks.length-1,S=this._stacks[b]||[];for(const M of this._renderableTiles){if(Ju(l,l.style.terrain,M,b),this._rerender[M.tileID.key]){l.context.clear({color:a.Color.transparent});for(let B=0;B<S.length;B++){const V=l.style._layers[S[B]],$=V.source?this._coordsDescendingInv[V.source][M.tileID.key]:[M.tileID];l._renderTileClippingMasks(V,$),l.renderLayer(l,l.style.sourceCaches[V.source],V,$),V.source&&(M.textureCoords[V.source]=this._coordsDescendingInvStr[V.source][M.tileID.key])}}Ls(l,l.style.terrain,M)}if(_==="hillshade"){this._stacks.push([h[d]]);for(const M of this._renderableTiles){const B=this._coordsDescendingInv[c.source][M.tileID.key];Ju(l,l.style.terrain,M,this._stacks.length-1),l.context.clear({color:a.Color.transparent}),l._renderTileClippingMasks(c,B),l.renderLayer(l,l.style.sourceCaches[c.source],c,B),Ls(l,l.style.terrain,M)}return!0}return this._renderToTexture[_]}return!1}}const si={symbol:function(k,c,_,l,h){if(k.renderPass!=="translucent")return;const d=yr.disabled,x=k.colorModeForRenderPass();_.layout.get("text-variable-anchor")&&function(b,S,M,B,V,$,Y){const oe=S.transform,te=V==="map",ue=$==="map";for(const be of b){const Ce=B.getTile(be),ve=Ce.getBucket(M);if(!ve||!ve.text||!ve.text.segments.get().length)continue;const Ge=a.evaluateSizeForZoom(ve.textSizeData,oe.zoom),Te=kr(Ce,1,S.transform.zoom),Ve=Ms(be.posMatrix,ue,te,S.transform,Te),xe=M.layout.get("icon-text-fit")!=="none"&&ve.hasIconData();if(Ge){const m=Math.pow(2,oe.zoom-Ce.tileID.overscaledZ);Xu(ve,te,ue,Y,oe,Ve,be.posMatrix,m,Ge,xe,S.style.terrain?(g,v)=>S.style.terrain.getElevation(be,g,v):null)}}}(l,k,_,c,_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),h),_.paint.get("icon-opacity").constantOr(1)!==0&&ks(k,c,_,l,!1,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),_.layout.get("icon-rotation-alignment"),_.layout.get("icon-pitch-alignment"),_.layout.get("icon-keep-upright"),d,x),_.paint.get("text-opacity").constantOr(1)!==0&&ks(k,c,_,l,!0,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),_.layout.get("text-keep-upright"),d,x),c.map.showCollisionBoxes&&(Oo(k,c,_,l,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),!0),Oo(k,c,_,l,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),!1))},circle:function(k,c,_,l){if(k.renderPass!=="translucent")return;const h=_.paint.get("circle-opacity"),d=_.paint.get("circle-stroke-width"),x=_.paint.get("circle-stroke-opacity"),b=!_.layout.get("circle-sort-key").isConstant();if(h.constantOr(1)===0&&(d.constantOr(1)===0||x.constantOr(1)===0))return;const S=k.context,M=S.gl,B=k.depthModeForSublayer(0,Gn.ReadOnly),V=yr.disabled,$=k.colorModeForRenderPass(),Y=[];for(let oe=0;oe<l.length;oe++){const te=l[oe],ue=c.getTile(te),be=ue.getBucket(_);if(!be)continue;const Ce=be.programConfigurations.get(_.id),ve=k.useProgram("circle",Ce),Ge=be.layoutVertexBuffer,Te=be.indexBuffer,Ve=k.style.terrain&&k.style.terrain.getTerrainData(te),xe={programConfiguration:Ce,program:ve,layoutVertexBuffer:Ge,indexBuffer:Te,uniformValues:na(k,te,ue,_),terrainData:Ve};if(b){const m=be.segments.get();for(const g of m)Y.push({segments:new a.SegmentVector([g]),sortKey:g.sortKey,state:xe})}else Y.push({segments:be.segments,sortKey:0,state:xe})}b&&Y.sort((oe,te)=>oe.sortKey-te.sortKey);for(const oe of Y){const{programConfiguration:te,program:ue,layoutVertexBuffer:be,indexBuffer:Ce,uniformValues:ve,terrainData:Ge}=oe.state;ue.draw(S,M.TRIANGLES,B,V,$,hr.disabled,ve,Ge,_.id,be,Ce,oe.segments,_.paint,k.transform.zoom,te)}},heatmap:function(k,c,_,l){if(_.paint.get("heatmap-opacity")!==0)if(k.renderPass==="offscreen"){const h=k.context,d=h.gl,x=yr.disabled,b=new ur([d.ONE,d.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(S,M,B){const V=S.gl;S.activeTexture.set(V.TEXTURE1),S.viewport.set([0,0,M.width/4,M.height/4]);let $=B.heatmapFbo;if($)V.bindTexture(V.TEXTURE_2D,$.colorAttachment.get()),S.bindFramebuffer.set($.framebuffer);else{const Y=V.createTexture();V.bindTexture(V.TEXTURE_2D,Y),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.LINEAR),$=B.heatmapFbo=S.createFramebuffer(M.width/4,M.height/4,!1),function(oe,te,ue,be){const Ce=oe.gl;Ce.texImage2D(Ce.TEXTURE_2D,0,Ce.RGBA,te.width/4,te.height/4,0,Ce.RGBA,oe.extRenderToTextureHalfFloat?oe.extTextureHalfFloat.HALF_FLOAT_OES:Ce.UNSIGNED_BYTE,null),be.colorAttachment.set(ue)}(S,M,Y,$)}})(h,k,_),h.clear({color:a.Color.transparent});for(let S=0;S<l.length;S++){const M=l[S];if(c.hasRenderableParent(M))continue;const B=c.getTile(M),V=B.getBucket(_);if(!V)continue;const $=V.programConfigurations.get(_.id),Y=k.useProgram("heatmap",$),{zoom:oe}=k.transform;Y.draw(h,d.TRIANGLES,Gn.disabled,x,b,hr.disabled,Fe(M.posMatrix,B,oe,_.paint.get("heatmap-intensity")),null,_.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,_.paint,k.transform.zoom,$)}h.viewport.set([0,0,k.width,k.height])}else k.renderPass==="translucent"&&(k.context.setColorMode(k.colorModeForRenderPass()),function(h,d){const x=h.context,b=x.gl,S=d.heatmapFbo;if(!S)return;x.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,S.colorAttachment.get()),x.activeTexture.set(b.TEXTURE1);let M=d.colorRampTexture;M||(M=d.colorRampTexture=new q(x,d.colorRamp,b.RGBA)),M.bind(b.LINEAR,b.CLAMP_TO_EDGE),h.useProgram("heatmapTexture").draw(x,b.TRIANGLES,Gn.disabled,yr.disabled,h.colorModeForRenderPass(),hr.disabled,((B,V,$,Y)=>{const oe=a.create();a.ortho(oe,0,B.width,B.height,0,0,1);const te=B.context.gl;return{u_matrix:oe,u_world:[te.drawingBufferWidth,te.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:V.paint.get("heatmap-opacity")}})(h,d),null,d.id,h.viewportBuffer,h.quadTriangleIndexBuffer,h.viewportSegments,d.paint,h.transform.zoom)}(k,_))},line:function(k,c,_,l){if(k.renderPass!=="translucent")return;const h=_.paint.get("line-opacity"),d=_.paint.get("line-width");if(h.constantOr(1)===0||d.constantOr(1)===0)return;const x=k.depthModeForSublayer(0,Gn.ReadOnly),b=k.colorModeForRenderPass(),S=_.paint.get("line-dasharray"),M=_.paint.get("line-pattern"),B=M.constantOr(1),V=_.paint.get("line-gradient"),$=_.getCrossfadeParameters(),Y=B?"linePattern":S?"lineSDF":V?"lineGradient":"line",oe=k.context,te=oe.gl;let ue=!0;for(const be of l){const Ce=c.getTile(be);if(B&&!Ce.patternsLoaded())continue;const ve=Ce.getBucket(_);if(!ve)continue;const Ge=ve.programConfigurations.get(_.id),Te=k.context.program.get(),Ve=k.useProgram(Y,Ge),xe=ue||Ve.program!==Te,m=k.style.terrain&&k.style.terrain.getTerrainData(be),g=M.constantOr(null);if(g&&Ce.imageAtlas){const C=Ce.imageAtlas,R=C.patternPositions[g.to.toString()],O=C.patternPositions[g.from.toString()];R&&O&&Ge.setConstantPatternPositions(R,O)}const v=m?be:null,E=B?kn(k,Ce,_,$,v):S?Sr(k,Ce,_,S,$,v):V?Wt(k,Ce,_,ve.lineClipsArray.length,v):wt(k,Ce,_,v);if(B)oe.activeTexture.set(te.TEXTURE0),Ce.imageAtlasTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),Ge.updatePaintBuffers($);else if(S&&(xe||k.lineAtlas.dirty))oe.activeTexture.set(te.TEXTURE0),k.lineAtlas.bind(oe);else if(V){const C=ve.gradients[_.id];let R=C.texture;if(_.gradientVersion!==C.version){let O=256;if(_.stepInterpolant){const N=c.getSource().maxzoom,Q=be.canonical.z===N?Math.ceil(1<<k.transform.maxZoom-be.canonical.z):1;O=a.clamp(a.nextPowerOfTwo(ve.maxLineLength/a.EXTENT*1024*Q),256,oe.maxTextureSize)}C.gradient=a.renderColorRamp({expression:_.gradientExpression(),evaluationKey:"lineProgress",resolution:O,image:C.gradient||void 0,clips:ve.lineClipsArray}),C.texture?C.texture.update(C.gradient):C.texture=new q(oe,C.gradient,te.RGBA),C.version=_.gradientVersion,R=C.texture}oe.activeTexture.set(te.TEXTURE0),R.bind(_.stepInterpolant?te.NEAREST:te.LINEAR,te.CLAMP_TO_EDGE)}Ve.draw(oe,te.TRIANGLES,x,k.stencilModeForClipping(be),b,hr.disabled,E,m,_.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,_.paint,k.transform.zoom,Ge,ve.layoutVertexBuffer2),ue=!1}},fill:function(k,c,_,l){const h=_.paint.get("fill-color"),d=_.paint.get("fill-opacity");if(d.constantOr(1)===0)return;const x=k.colorModeForRenderPass(),b=_.paint.get("fill-pattern"),S=k.opaquePassEnabledForLayer()&&!b.constantOr(1)&&h.constantOr(a.Color.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(k.renderPass===S){const M=k.depthModeForSublayer(1,k.renderPass==="opaque"?Gn.ReadWrite:Gn.ReadOnly);za(k,c,_,l,M,x,!1)}if(k.renderPass==="translucent"&&_.paint.get("fill-antialias")){const M=k.depthModeForSublayer(_.getPaintProperty("fill-outline-color")?2:0,Gn.ReadOnly);za(k,c,_,l,M,x,!0)}},"fill-extrusion":function(k,c,_,l){const h=_.paint.get("fill-extrusion-opacity");if(h!==0&&k.renderPass==="translucent"){const d=new Gn(k.context.gl.LEQUAL,Gn.ReadWrite,k.depthRangeFor3D);if(h!==1||_.paint.get("fill-extrusion-pattern").constantOr(1))oa(k,c,_,l,d,yr.disabled,ur.disabled),oa(k,c,_,l,d,k.stencilModeFor3D(),k.colorModeForRenderPass());else{const x=k.colorModeForRenderPass();oa(k,c,_,l,d,yr.disabled,x)}}},hillshade:function(k,c,_,l){if(k.renderPass!=="offscreen"&&k.renderPass!=="translucent")return;const h=k.context,d=k.depthModeForSublayer(0,Gn.ReadOnly),x=k.colorModeForRenderPass(),[b,S]=k.renderPass==="translucent"?k.stencilConfigForOverlap(l):[{},l];for(const M of S){const B=c.getTile(M);B.needsHillshadePrepare!==void 0&&B.needsHillshadePrepare&&k.renderPass==="offscreen"?_l(k,B,_,d,yr.disabled,x):k.renderPass==="translucent"&&yl(k,M,B,_,d,b[M.overscaledZ],x)}h.viewport.set([0,0,k.width,k.height])},raster:function(k,c,_,l){if(k.renderPass!=="translucent"||_.paint.get("raster-opacity")===0||!l.length)return;const h=k.context,d=h.gl,x=c.getSource(),b=k.useProgram("raster"),S=k.colorModeForRenderPass(),[M,B]=x instanceof bt?[{},l]:k.stencilConfigForOverlap(l),V=B[B.length-1].overscaledZ,$=!k.options.moving;for(const Y of B){const oe=k.depthModeForSublayer(Y.overscaledZ-V,_.paint.get("raster-opacity")===1?Gn.ReadWrite:Gn.ReadOnly,d.LESS),te=c.getTile(Y);te.registerFadeDuration(_.paint.get("raster-fade-duration"));const ue=c.findLoadedParent(Y,0),be=fr(te,ue,c,_,k.transform,k.style.terrain);let Ce,ve;const Ge=_.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;h.activeTexture.set(d.TEXTURE0),te.texture.bind(Ge,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(d.TEXTURE1),ue?(ue.texture.bind(Ge,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),Ce=Math.pow(2,ue.tileID.overscaledZ-te.tileID.overscaledZ),ve=[te.tileID.canonical.x*Ce%1,te.tileID.canonical.y*Ce%1]):te.texture.bind(Ge,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);const Te=k.style.terrain&&k.style.terrain.getTerrainData(Y),Ve=Te?Y:null,xe=Ve?Ve.posMatrix:k.transform.calculatePosMatrix(Y.toUnwrapped(),$),m=Vn(xe,ve||[0,0],Ce||1,be,_);x instanceof bt?b.draw(h,d.TRIANGLES,oe,yr.disabled,S,hr.disabled,m,Te,_.id,x.boundsBuffer,k.quadTriangleIndexBuffer,x.boundsSegments):b.draw(h,d.TRIANGLES,oe,M[Y.overscaledZ],S,hr.disabled,m,Te,_.id,k.rasterBoundsBuffer,k.quadTriangleIndexBuffer,k.rasterBoundsSegments)}},background:function(k,c,_,l){const h=_.paint.get("background-color"),d=_.paint.get("background-opacity");if(d===0)return;const x=k.context,b=x.gl,S=k.transform,M=S.tileSize,B=_.paint.get("background-pattern");if(k.isPatternMissing(B))return;const V=!B&&h.a===1&&d===1&&k.opaquePassEnabledForLayer()?"opaque":"translucent";if(k.renderPass!==V)return;const $=yr.disabled,Y=k.depthModeForSublayer(0,V==="opaque"?Gn.ReadWrite:Gn.ReadOnly),oe=k.colorModeForRenderPass(),te=k.useProgram(B?"backgroundPattern":"background"),ue=l||S.coveringTiles({tileSize:M,terrain:k.style.terrain});B&&(x.activeTexture.set(b.TEXTURE0),k.imageManager.bind(k.context));const be=_.getCrossfadeParameters();for(const Ce of ue){const ve=l?Ce.posMatrix:k.transform.calculatePosMatrix(Ce.toUnwrapped()),Ge=B?sA(ve,d,k,B,{tileID:Ce,tileSize:M},be):NA(ve,d,h),Te=k.style.terrain&&k.style.terrain.getTerrainData(Ce);te.draw(x,b.TRIANGLES,Y,$,oe,hr.disabled,Ge,Te,_.id,k.tileExtentBuffer,k.quadTriangleIndexBuffer,k.tileExtentSegments)}},debug:function(k,c,_){for(let l=0;l<_.length;l++)ZA(k,c,_[l])},custom:function(k,c,_){const l=k.context,h=_.implementation;if(k.renderPass==="offscreen"){const d=h.prerender;d&&(k.setCustomLayerDefaults(),l.setColorMode(k.colorModeForRenderPass()),d.call(h,l.gl,k.transform.customLayerMatrix()),l.setDirty(),k.setBaseState())}else if(k.renderPass==="translucent"){k.setCustomLayerDefaults(),l.setColorMode(k.colorModeForRenderPass()),l.setStencilMode(yr.disabled);const d=h.renderingMode==="3d"?new Gn(k.context.gl.LEQUAL,Gn.ReadWrite,k.depthRangeFor3D):k.depthModeForSublayer(0,Gn.ReadOnly);l.setDepthMode(d),h.render(l.gl,k.transform.customLayerMatrix()),l.setDirty(),k.setBaseState(),l.bindFramebuffer.set(null)}}};class gi{constructor(c,_){this.context=new Is(c),this.transform=_,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.create(),renderTime:0},this.setup(),this.numSublayers=xt.maxUnderzooming+xt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new jt,this.gpuTimers={}}resize(c,_,l){if(this.width=c*l,this.height=_*l,this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const c=this.context,_=new a.PosArray;_.emplaceBack(0,0),_.emplaceBack(a.EXTENT,0),_.emplaceBack(0,a.EXTENT),_.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(_,dn.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const l=new a.PosArray;l.emplaceBack(0,0),l.emplaceBack(a.EXTENT,0),l.emplaceBack(0,a.EXTENT),l.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=c.createVertexBuffer(l,dn.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const h=new a.RasterBoundsArray;h.emplaceBack(0,0,0,0),h.emplaceBack(a.EXTENT,0,a.EXTENT,0),h.emplaceBack(0,a.EXTENT,0,a.EXTENT),h.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(h,yt.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const d=new a.PosArray;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(d,dn.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const x=new a.LineStripIndexArray;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(x);const b=new a.TriangleIndexArray;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(b),this.emptyTexture=new q(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA);const S=this.context.gl;this.stencilClearMode=new yr({func:S.ALWAYS,mask:0},0,255,S.ZERO,S.ZERO,S.ZERO)}clearStencil(){const c=this.context,_=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=a.create();a.ortho(l,0,this.width,this.height,0,0,1),a.scale(l,l,[_.drawingBufferWidth,_.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,_.TRIANGLES,Gn.disabled,this.stencilClearMode,ur.disabled,hr.disabled,Ee(l),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(c,_){if(this.currentStencilSource===c.source||!c.isTileClipped()||!_||!_.length)return;this.currentStencilSource=c.source;const l=this.context,h=l.gl;this.nextStencilID+_.length>256&&this.clearStencil(),l.setColorMode(ur.disabled),l.setDepthMode(Gn.disabled);const d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of _){const b=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,S=this.style.terrain&&this.style.terrain.getTerrainData(x);d.draw(l,h.TRIANGLES,Gn.disabled,new yr({func:h.ALWAYS,mask:0},b,255,h.KEEP,h.KEEP,h.REPLACE),ur.disabled,hr.disabled,Ee(x.posMatrix),S,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,_=this.context.gl;return new yr({func:_.NOTEQUAL,mask:255},c,255,_.KEEP,_.KEEP,_.REPLACE)}stencilModeForClipping(c){const _=this.context.gl;return new yr({func:_.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,_.KEEP,_.KEEP,_.REPLACE)}stencilConfigForOverlap(c){const _=this.context.gl,l=c.sort((x,b)=>b.overscaledZ-x.overscaledZ),h=l[l.length-1].overscaledZ,d=l[0].overscaledZ-h+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const x={};for(let b=0;b<d;b++)x[b+h]=new yr({func:_.GEQUAL,mask:255},b+this.nextStencilID,255,_.KEEP,_.KEEP,_.REPLACE);return this.nextStencilID+=d,[x,l]}return[{[h]:yr.disabled},l]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new ur([c.CONSTANT_COLOR,c.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ur.unblended:ur.alphaBlended}depthModeForSublayer(c,_,l){if(!this.opaquePassEnabledForLayer())return Gn.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new Gn(l||this.context.gl.LEQUAL,_,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,_){this.style=c,this.options=_,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const l=this.style._order,h=this.style.sourceCaches,d=this.style.terrain&&new cA(this);for(const M in h){const B=h[M];B.used&&B.prepare(this.context)}const x={},b={},S={};for(const M in h){const B=h[M];x[M]=B.getVisibleCoordinates(),b[M]=x[M].slice().reverse(),S[M]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<l.length;M++)if(this.style._layers[l[M]].is3D()){this.opaquePassCutoff=M;break}if(d){this.opaquePassCutoff=0;const M=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||M.length)&&(a.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,V){const $=B.context,Y=$.gl,oe=ur.unblended,te=new Gn(Y.LEQUAL,Gn.ReadWrite,[0,1]),ue=V.getTerrainMesh(),be=V.sourceCache.getRenderableTiles(),Ce=B.useProgram("terrainDepth");$.bindFramebuffer.set(V.getFramebuffer("depth").framebuffer),$.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),$.clear({color:a.Color.transparent,depth:1});for(const ve of be){const Ge=V.getTerrainData(ve.tileID),Te=B.transform.calculatePosMatrix(ve.tileID.toUnwrapped());Ce.draw($,Y.TRIANGLES,te,yr.disabled,oe,hr.backCCW,{u_matrix:Te},Ge,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments)}$.bindFramebuffer.set(null),$.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain),function(B,V){const $=B.context,Y=$.gl,oe=ur.unblended,te=new Gn(Y.LEQUAL,Gn.ReadWrite,[0,1]),ue=V.getTerrainMesh(),be=V.getCoordsTexture(),Ce=V.sourceCache.getRenderableTiles(),ve=B.useProgram("terrainCoords");$.bindFramebuffer.set(V.getFramebuffer("coords").framebuffer),$.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),$.clear({color:a.Color.transparent,depth:1}),V.coordsIndex=[];for(const Ge of Ce){const Te=V.getTerrainData(Ge.tileID);$.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,be.texture);const Ve=B.transform.calculatePosMatrix(Ge.tileID.toUnwrapped());ve.draw($,Y.TRIANGLES,te,yr.disabled,oe,hr.backCCW,{u_matrix:Ve,u_terrain_coords_id:(255-V.coordsIndex.length)/255,u_texture:0},Te,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments),V.coordsIndex.push(Ge.tileID.key)}$.bindFramebuffer.set(null),$.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const M of l){const B=this.style._layers[M];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const V=b[B.source];(B.type==="custom"||V.length)&&this.renderLayer(this,h[B.source],B,V)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:_.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=_.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],!d)for(this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[l[this.currentLayer]],B=h[M.source],V=x[M.source];this._renderTileClippingMasks(M,V),this.renderLayer(this,B,M,V)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){const M=this.style._layers[l[this.currentLayer]],B=h[M.source];if(d&&d.renderLayer(M))continue;const V=(M.type==="symbol"?S:b)[M.source];this._renderTileClippingMasks(M,x[M.source]),this.renderLayer(this,B,M,V)}if(this.options.showTileBoundaries){let M,B;Object.values(this.style._layers).forEach(V=>{V.source&&!V.isHidden(this.transform.zoom)&&(V.source!==(B&&B.id)&&(B=this.style.sourceCaches[V.source]),(!M||M.getSource().maxzoom<B.getSource().maxzoom)&&(M=B))}),M&&si.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const B=M.transform.padding;jr(M,M.transform.height-(B.top||0),3,uA),jr(M,B.bottom||0,3,ts),Pr(M,B.left||0,3,qA),Pr(M,M.transform.width-(B.right||0),3,vl);const V=M.transform.centerPoint;(function($,Y,oe,te){Kr($,Y-1,oe-10,2,20,te),Kr($,Y-10,oe-1,20,2,te)})(M,V.x,M.transform.height-V.y,Ku)}(this),this.context.setDefault()}renderLayer(c,_,l,h){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(h||[]).length)&&(this.id=l.id,this.gpuTimingStart(l),si[l.type](c,_,l,h,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const _=this.context.extTimerQuery;let l=this.gpuTimers[c.id];l||(l=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:_.createQueryEXT()}),l.calls++,_.beginQueryEXT(_.TIME_ELAPSED_EXT,l.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}queryGpuTimers(c){const _={};for(const l in c){const h=c[l],d=this.context.extTimerQuery,x=d.getQueryObjectEXT(h.query,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(h.query),_[l]=x}return _}translatePosMatrix(c,_,l,h,d){if(!l[0]&&!l[1])return c;const x=d?h==="map"?this.transform.angle:0:h==="viewport"?-this.transform.angle:0;if(x){const M=Math.sin(x),B=Math.cos(x);l=[l[0]*B-l[1]*M,l[0]*M+l[1]*B]}const b=[d?l[0]:kr(_,l[0],this.transform.zoom),d?l[1]:kr(_,l[1],this.transform.zoom),0],S=new Float32Array(16);return a.translate(S,c,b),S}saveTileTexture(c){const _=this._tileTextures[c.size[0]];_?_.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const _=this._tileTextures[c];return _&&_.length>0?_.pop():null}isPatternMissing(c){if(!c)return!1;if(!c.from||!c.to)return!0;const _=this.imageManager.getPattern(c.from.toString()),l=this.imageManager.getPattern(c.to.toString());return!_||!l}useProgram(c,_){this.cache=this.cache||{};const l=c+(_?_.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[l]||(this.cache[l]=new Ia(this.context,c,ii[c],_,ul[c],this._showOverdrawInspector,this.style.terrain)),this.cache[l]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new q(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class ns{constructor(c,_){this.points=c,this.planes=_}static fromInvProjectionMatrix(c,_,l){const h=Math.pow(2,l),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const S=1/(b=a.transformMat4([],b,c))[3]/_*h;return a.mul$1(b,b,[S,S,1/b[3],S])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const S=a.sub([],d[b[0]],d[b[1]]),M=a.sub([],d[b[2]],d[b[1]]),B=a.normalize([],a.cross([],S,M)),V=-a.dot(B,d[b[1]]);return B.concat(V)});return new ns(d,x)}}class aa{constructor(c,_){this.min=c,this.max=_,this.center=a.scale$1([],a.add([],this.min,this.max),.5)}quadrant(c){const _=[c%2==0,c<2],l=a.clone$2(this.min),h=a.clone$2(this.max);for(let d=0;d<_.length;d++)l[d]=_[d]?this.min[d]:this.center[d],h[d]=_[d]?this.center[d]:this.max[d];return h[2]=this.max[2],new aa(l,h)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}intersects(c){const _=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let l=!0;for(let h=0;h<c.planes.length;h++){const d=c.planes[h];let x=0;for(let b=0;b<_.length;b++)a.dot$1(d,_[b])>=0&&x++;if(x===0)return 0;x!==_.length&&(l=!1)}if(l)return 2;for(let h=0;h<3;h++){let d=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let b=0;b<c.points.length;b++){const S=c.points[b][h]-this.min[h];d=Math.min(d,S),x=Math.max(x,S)}if(x<0||d>this.max[h]-this.min[h])return 0}return 1}}class Gi{constructor(c=0,_=0,l=0,h=0){if(isNaN(c)||c<0||isNaN(_)||_<0||isNaN(l)||l<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=_,this.left=l,this.right=h}interpolate(c,_,l){return _.top!=null&&c.top!=null&&(this.top=a.number(c.top,_.top,l)),_.bottom!=null&&c.bottom!=null&&(this.bottom=a.number(c.bottom,_.bottom,l)),_.left!=null&&c.left!=null&&(this.left=a.number(c.left,_.left,l)),_.right!=null&&c.right!=null&&(this.right=a.number(c.right,_.right,l)),this}getCenter(c,_){const l=a.clamp((this.left+c-this.right)/2,0,c),h=a.clamp((this.top+_-this.bottom)/2,0,_);return new a.pointGeometry(l,h)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Gi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class co{constructor(c,_,l,h,d){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=d===void 0||!!d,this._minZoom=c||0,this._maxZoom=_||22,this._minPitch=l??0,this._maxPitch=h??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Gi,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const c=new co(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c._center=this._center,c._elevation=this._elevation,c.zoom=this.zoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(c){const _=-a.wrap(c,-180,180)*Math.PI/180;var l;this.angle!==_&&(this._unmodified=!1,this.angle=_,this._calcMatrices(),this.rotationMatrix=(l=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(l[1]=0,l[2]=0),l[0]=1,l[3]=1,l),function(h,d,x){var b=d[0],S=d[1],M=d[2],B=d[3],V=Math.sin(x),$=Math.cos(x);h[0]=b*$+M*V,h[1]=S*$+B*V,h[2]=b*-V+M*$,h[3]=S*-V+B*$}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const _=a.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==_&&(this._unmodified=!1,this._pitch=_,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(c){const _=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==_&&(this._unmodified=!1,this._zoom=_,this.scale=this.zoomScale(_),this.tileZoom=Math.floor(_),this.zoomFraction=_-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(c){c!==this._elevation&&(this._elevation=c,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,_,l){this._unmodified=!1,this._edgeInsets.interpolate(c,_,l),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const _=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,_)}getVisibleUnwrappedCoordinates(c){const _=[new a.UnwrappedTileID(0,c)];if(this._renderWorldCopies){const l=this.pointCoordinate(new a.pointGeometry(0,0)),h=this.pointCoordinate(new a.pointGeometry(this.width,0)),d=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),x=this.pointCoordinate(new a.pointGeometry(0,this.height)),b=Math.floor(Math.min(l.x,h.x,d.x,x.x)),S=Math.floor(Math.max(l.x,h.x,d.x,x.x)),M=1;for(let B=b-M;B<=S+M;B++)B!==0&&_.push(new a.UnwrappedTileID(B,c))}return _}coveringTiles(c){var _,l;let h=this.coveringZoomLevel(c);const d=h;if(c.minzoom!==void 0&&h<c.minzoom)return[];c.maxzoom!==void 0&&h>c.maxzoom&&(h=c.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),b=a.MercatorCoordinate.fromLngLat(this.center),S=Math.pow(2,h),M=[S*x.x,S*x.y,0],B=[S*b.x,S*b.y,0],V=ns.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h);let $=c.minzoom||0;!c.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&($=h);const Y=c.terrain?2/Math.min(this.tileSize,c.tileSize)*this.tileSize:3,oe=ve=>({aabb:new aa([ve*S,0,0],[(ve+1)*S,S,0]),zoom:0,x:0,y:0,wrap:ve,fullyVisible:!1}),te=[],ue=[],be=h,Ce=c.reparseOverscaled?d:h;if(this._renderWorldCopies)for(let ve=1;ve<=3;ve++)te.push(oe(-ve)),te.push(oe(ve));for(te.push(oe(0));te.length>0;){const ve=te.pop(),Ge=ve.x,Te=ve.y;let Ve=ve.fullyVisible;if(!Ve){const C=ve.aabb.intersects(V);if(C===0)continue;Ve=C===2}const xe=c.terrain?M:B,m=ve.aabb.distanceX(xe),g=ve.aabb.distanceY(xe),v=Math.max(Math.abs(m),Math.abs(g)),E=Y+(1<<be-ve.zoom)-2;if(ve.zoom===be||v>E&&ve.zoom>=$){const C=be-ve.zoom,R=M[0]-.5-(Ge<<C),O=M[1]-.5-(Te<<C);ue.push({tileID:new a.OverscaledTileID(ve.zoom===be?Ce:ve.zoom,ve.wrap,ve.zoom,Ge,Te),distanceSq:a.sqrLen([B[0]-.5-Ge,B[1]-.5-Te]),tileDistanceToCamera:Math.sqrt(R*R+O*O)})}else for(let C=0;C<4;C++){const R=(Ge<<1)+C%2,O=(Te<<1)+(C>>1),N=ve.zoom+1;let Q=ve.aabb.quadrant(C);if(c.terrain){const J=new a.OverscaledTileID(N,ve.wrap,N,R,O),le=c.terrain.getMinMaxElevation(J),de=(_=le.minElevation)!==null&&_!==void 0?_:this.elevation,Re=(l=le.maxElevation)!==null&&l!==void 0?l:this.elevation;Q=new aa([Q.min[0],Q.min[1],de],[Q.max[0],Q.max[1],Re])}te.push({aabb:Q,zoom:N,x:R,y:O,wrap:ve.wrap,fullyVisible:Ve})}}return ue.sort((ve,Ge)=>ve.distanceSq-Ge.distanceSq).map(ve=>ve.tileID)}resize(c,_){this.width=c,this.height=_,this.pixelsToGLUnits=[2/c,-2/_],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const _=a.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.pointGeometry(a.mercatorXfromLng(c.lng)*this.worldSize,a.mercatorYfromLat(_)*this.worldSize)}unproject(c){return new a.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(c){this.freezeElevation||(this.elevation=c?this.getElevation(this._center,c):0)}getElevation(c,_){const l=a.MercatorCoordinate.fromLngLat(c),h=(1<<this.tileZoom)*a.EXTENT,d=l.x*h,x=l.y*h,b=Math.floor(d/a.EXTENT),S=Math.floor(x/a.EXTENT),M=new a.OverscaledTileID(this.tileZoom,0,this.tileZoom,b,S);return _.getElevation(M,d%a.EXTENT,x%a.EXTENT,a.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(c){const _=this.pointLocation(this.centerPoint,c),l=this.getElevation(_,c);if(!(this.elevation-l))return;const h=this.getCameraPosition(),d=a.MercatorCoordinate.fromLngLat(h.lngLat,h.altitude),x=a.MercatorCoordinate.fromLngLat(_,l),b=d.x-x.x,S=d.y-x.y,M=d.z-x.z,B=Math.sqrt(b*b+S*S+M*M),V=this.scaleZoom(this.cameraToCenterDistance/B/this.tileSize);this._elevation=l,this._center=_,this.zoom=V}setLocationAtPoint(c,_){const l=this.pointCoordinate(_),h=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(c),x=new a.MercatorCoordinate(d.x-(l.x-h.x),d.y-(l.y-h.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(c,_){return _?this.coordinatePoint(this.locationCoordinate(c),this.getElevation(c,_),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(c))}pointLocation(c,_){return this.coordinateLocation(this.pointCoordinate(c,_))}locationCoordinate(c){return a.MercatorCoordinate.fromLngLat(c)}coordinateLocation(c){return c&&c.toLngLat()}pointCoordinate(c,_){if(_){const $=_.pointCoordinate(c);if($!=null)return $}const l=[c.x,c.y,0,1],h=[c.x,c.y,1,1];a.transformMat4(l,l,this.pixelMatrixInverse),a.transformMat4(h,h,this.pixelMatrixInverse);const d=l[3],x=h[3],b=l[1]/d,S=h[1]/x,M=l[2]/d,B=h[2]/x,V=M===B?0:(0-M)/(B-M);return new a.MercatorCoordinate(a.number(l[0]/d,h[0]/x,V)/this.worldSize,a.number(b,S,V)/this.worldSize)}coordinatePoint(c,_=0,l=this.pixelMatrix){const h=[c.x*this.worldSize,c.y*this.worldSize,_,1];return a.transformMat4(h,h,l),new a.pointGeometry(h[0]/h[3],h[1]/h[3])}getBounds(){const c=Math.max(0,this.height/2-this.getHorizon());return new a.LngLatBounds().extend(this.pointLocation(new a.pointGeometry(0,c))).extend(this.pointLocation(new a.pointGeometry(this.width,c))).extend(this.pointLocation(new a.pointGeometry(this.width,this.height))).extend(this.pointLocation(new a.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(c,_=!1){const l=c.key,h=_?this._alignedPosMatrixCache:this._posMatrixCache;if(h[l])return h[l];const d=c.canonical,x=this.worldSize/this.zoomScale(d.z),b=d.x+Math.pow(2,d.z)*c.wrap,S=a.identity(new Float64Array(16));return a.translate(S,S,[b*x,d.y*x,0]),a.scale(S,S,[x/a.EXTENT,x/a.EXTENT,1]),a.multiply(S,_?this.alignedProjMatrix:this.projMatrix,S),h[l]=new Float32Array(S),h[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let c,_,l,h,d=-90,x=90,b=-180,S=180;const M=this.size,B=this._unmodified;if(this.latRange){const Y=this.latRange;d=a.mercatorYfromLat(Y[1])*this.worldSize,x=a.mercatorYfromLat(Y[0])*this.worldSize,c=x-d<M.y?M.y/(x-d):0}if(this.lngRange){const Y=this.lngRange;b=a.wrap(a.mercatorXfromLng(Y[0])*this.worldSize,0,this.worldSize),S=a.wrap(a.mercatorXfromLng(Y[1])*this.worldSize,0,this.worldSize),S<b&&(S+=this.worldSize),_=S-b<M.x?M.x/(S-b):0}const V=this.point,$=Math.max(_||0,c||0);if($)return this.center=this.unproject(new a.pointGeometry(_?(S+b)/2:V.x,c?(x+d)/2:V.y)),this.zoom+=this.scaleZoom($),this._unmodified=B,void(this._constraining=!1);if(this.latRange){const Y=V.y,oe=M.y/2;Y-oe<d&&(h=d+oe),Y+oe>x&&(h=x-oe)}if(this.lngRange){const Y=(b+S)/2,oe=a.wrap(V.x,Y-this.worldSize/2,Y+this.worldSize/2),te=M.x/2;oe-te<b&&(l=b+te),oe+te>S&&(l=S-te)}l===void 0&&h===void 0||(this.center=this.unproject(new a.pointGeometry(l!==void 0?l:V.x,h!==void 0?h:V.y)).wrap()),this._unmodified=B,this._constraining=!1}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,_=this.point.x,l=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let h=a.identity(new Float64Array(16));a.scale(h,h,[this.width/2,-this.height/2,1]),a.translate(h,h,[1,-1,0]),this.labelPlaneMatrix=h,h=a.identity(new Float64Array(16)),a.scale(h,h,[1,-1,1]),a.translate(h,h,[-1,-1,0]),a.scale(h,h,[2/this.width,2/this.height,1]),this.glCoordMatrix=h,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const d=Math.PI/2+this._pitch,x=this._fov*(.5+c.y/this.height),b=Math.sin(x)*this.cameraToSeaLevelDistance/Math.sin(a.clamp(Math.PI-d-x,.01,Math.PI-.01)),S=this.getHorizon(),M=2*Math.atan(S/this.cameraToCenterDistance)*(.5+c.y/(2*S)),B=Math.sin(M)*this.cameraToSeaLevelDistance/Math.sin(a.clamp(Math.PI-d-M,.01,Math.PI-.01)),V=Math.cos(Math.PI/2-this._pitch)*b+this.cameraToSeaLevelDistance,$=Math.cos(Math.PI/2-this._pitch)*B+this.cameraToSeaLevelDistance,Y=1.01*Math.min(V,$),oe=this.height/50;h=new Float64Array(16),a.perspective(h,this._fov,this.width/this.height,oe,Y),h[8]=2*-c.x/this.width,h[9]=2*c.y/this.height,a.scale(h,h,[1,-1,1]),a.translate(h,h,[0,0,-this.cameraToCenterDistance]),a.rotateX(h,h,this._pitch),a.rotateZ(h,h,this.angle),a.translate(h,h,[-_,-l,0]),this.mercatorMatrix=a.scale([],h,[this.worldSize,this.worldSize,this.worldSize]),a.scale(h,h,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,h),a.translate(h,h,[0,0,-this.elevation]),this.projMatrix=h,this.invProjMatrix=a.invert([],h),this.pixelMatrix3D=a.multiply(new Float64Array(16),this.labelPlaneMatrix,h);const te=this.width%2/2,ue=this.height%2/2,be=Math.cos(this.angle),Ce=Math.sin(this.angle),ve=_-Math.round(_)+be*te+Ce*ue,Ge=l-Math.round(l)+be*ue+Ce*te,Te=new Float64Array(h);if(a.translate(Te,Te,[ve>.5?ve-1:ve,Ge>.5?Ge-1:Ge,0]),this.alignedProjMatrix=Te,h=a.invert(new Float64Array(16),this.pixelMatrix),!h)throw new Error("failed to invert matrix");this.pixelMatrixInverse=h,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const c=this.pointCoordinate(new a.pointGeometry(0,0)),_=[c.x*this.worldSize,c.y*this.worldSize,0,1];return a.transformMat4(_,_,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,c))}getCameraQueryGeometry(c){const _=this.getCameraPoint();if(c.length===1)return[c[0],_];{let l=_.x,h=_.y,d=_.x,x=_.y;for(const b of c)l=Math.min(l,b.x),h=Math.min(h,b.y),d=Math.max(d,b.x),x=Math.max(x,b.y);return[new a.pointGeometry(l,h),new a.pointGeometry(d,h),new a.pointGeometry(d,x),new a.pointGeometry(l,x),new a.pointGeometry(l,h)]}}}class Ai{constructor(c){this._hashName=c&&encodeURIComponent(c),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(_,l){let h=!1,d=null;const x=()=>{d=null,h&&(_(),d=setTimeout(x,300),h=!1)};return()=>(h=!0,d||x(),d)}(this._updateHashUnthrottled.bind(this))}addTo(c){return this._map=c,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(c){const _=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,h=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,h),x=Math.round(_.lng*d)/d,b=Math.round(_.lat*d)/d,S=this._map.getBearing(),M=this._map.getPitch();let B="";if(B+=c?`/${x}/${b}/${l}`:`${l}/${b}/${x}`,(S||M)&&(B+="/"+Math.round(10*S)/10),M&&(B+=`/${Math.round(M)}`),this._hashName){const V=this._hashName;let $=!1;const Y=window.location.hash.slice(1).split("&").map(oe=>{const te=oe.split("=")[0];return te===V?($=!0,`${te}=${B}`):oe}).filter(oe=>oe);return $||Y.push(`${V}=${B}`),`#${Y.join("&")}`}return`#${B}`}_getCurrentHash(){const c=window.location.hash.replace("#","");if(this._hashName){let _;return c.split("&").map(l=>l.split("=")).forEach(l=>{l[0]===this._hashName&&(_=l)}),(_&&_[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._getCurrentHash();if(c.length>=3&&!c.some(_=>isNaN(_))){const _=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:_,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,c)}catch{}}}const Oa={linearity:.3,easing:a.bezier(0,0,.3,1)},xl=a.extend({deceleration:2500,maxSpeed:1400},Oa),Fa=a.extend({deceleration:20,maxSpeed:1400},Oa),Ds=a.extend({deceleration:1e3,maxSpeed:360},Oa),rs=a.extend({deceleration:1e3,maxSpeed:90},Oa);class ec{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,_=a.exported.now();for(;c.length>0&&_-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const _={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)_.zoom+=d.zoomDelta||0,_.bearing+=d.bearingDelta||0,_.pitch+=d.pitchDelta||0,d.panDelta&&_.pan._add(d.panDelta),d.around&&(_.around=d.around),d.pinchAround&&(_.pinchAround=d.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(_.pan.mag()){const d=Na(_.pan.mag(),l,a.extend({},xl,c||{}));h.offset=_.pan.mult(d.amount/_.pan.mag()),h.center=this._map.transform.center,la(h,d)}if(_.zoom){const d=Na(_.zoom,l,Fa);h.zoom=this._map.transform.zoom+d.amount,la(h,d)}if(_.bearing){const d=Na(_.bearing,l,Ds);h.bearing=this._map.transform.bearing+a.clamp(d.amount,-179,179),la(h,d)}if(_.pitch){const d=Na(_.pitch,l,rs);h.pitch=this._map.transform.pitch+d.amount,la(h,d)}if(h.zoom||h.bearing){const d=_.pinchAround===void 0?_.around:_.pinchAround;h.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),a.extend(h,{noMoveStart:!0})}}function la(k,c){(!k.duration||k.duration<c.duration)&&(k.duration=c.duration,k.easing=c.easing)}function Na(k,c,_){const{maxSpeed:l,linearity:h,deceleration:d}=_,x=a.clamp(k*h/(c/1e3),-l,l),b=Math.abs(x)/(d*h);return{easing:_.easing,duration:1e3*b,amount:x*(b/2)}}class Jr extends a.Event{constructor(c,_,l,h={}){const d=L.mousePos(_.getCanvasContainer(),l),x=_.unproject(d);super(c,a.extend({point:d,lngLat:x,originalEvent:l},h)),this._defaultPrevented=!1,this.target=_}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class gs extends a.Event{constructor(c,_,l){const h=c==="touchend"?l.changedTouches:l.touches,d=L.touchPos(_.getCanvasContainer(),h),x=d.map(S=>_.unproject(S)),b=d.reduce((S,M,B,V)=>S.add(M.div(V.length)),new a.pointGeometry(0,0));super(c,{points:d,point:b,lngLats:x,lngLat:_.unproject(b),originalEvent:l}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class ji extends a.Event{constructor(c,_,l){super(c,{originalEvent:l}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class wl{constructor(c,_){this._map=c,this._clickTolerance=_.clickTolerance}reset(){delete this._mousedownPos}wheel(c){return this._firePreventable(new ji(c.type,this._map,c))}mousedown(c,_){return this._mousedownPos=_,this._firePreventable(new Jr(c.type,this._map,c))}mouseup(c){this._map.fire(new Jr(c.type,this._map,c))}click(c,_){this._mousedownPos&&this._mousedownPos.dist(_)>=this._clickTolerance||this._map.fire(new Jr(c.type,this._map,c))}dblclick(c){return this._firePreventable(new Jr(c.type,this._map,c))}mouseover(c){this._map.fire(new Jr(c.type,this._map,c))}mouseout(c){this._map.fire(new Jr(c.type,this._map,c))}touchstart(c){return this._firePreventable(new gs(c.type,this._map,c))}touchmove(c){this._map.fire(new gs(c.type,this._map,c))}touchend(c){this._map.fire(new gs(c.type,this._map,c))}touchcancel(c){this._map.fire(new gs(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fo{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(c){this._map.fire(new Jr(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Jr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._ignoreContextMenu||this._map.fire(new Jr(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class tc{constructor(c,_){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=_.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,_){this.isEnabled()&&c.shiftKey&&c.button===0&&(L.disableDrag(),this._startPos=this._lastPos=_,this._active=!0)}mousemoveWindow(c,_){if(!this._active)return;const l=_;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=l,this._box||(this._box=L.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const d=Math.min(h.x,l.x),x=Math.max(h.x,l.x),b=Math.min(h.y,l.y),S=Math.max(h.y,l.y);L.setTransform(this._box,`translate(${d}px,${b}px)`),this._box.style.width=x-d+"px",this._box.style.height=S-b+"px"}mouseupWindow(c,_){if(!this._active||c.button!==0)return;const l=this._startPos,h=_;if(this.reset(),L.suppressClick(),l.x!==h.x||l.y!==h.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:d=>d.fitScreenCoordinates(l,h,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",c)}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(L.remove(this._box),this._box=null),L.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(c,_){return this._map.fire(new a.Event(c,{originalEvent:_}))}}function ho(k,c){if(k.length!==c.length)throw new Error(`The number of touches and points are not equal - touches ${k.length}, points ${c.length}`);const _={};for(let l=0;l<k.length;l++)_[k[l].identifier]=c[l];return _}class bl{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(c,_,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),l.length===this.numTouches&&(this.centroid=function(h){const d=new a.pointGeometry(0,0);for(const x of h)d._add(x);return d.div(h.length)}(_),this.touches=ho(l,_)))}touchmove(c,_,l){if(this.aborted||!this.centroid)return;const h=ho(l,_);for(const d in this.touches){const x=this.touches[d],b=h[d];(!b||b.dist(x)>30)&&(this.aborted=!0)}}touchend(c,_,l){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class Ua{constructor(c){this.singleTap=new bl(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(c,_,l){this.singleTap.touchstart(c,_,l)}touchmove(c,_,l){this.singleTap.touchmove(c,_,l)}touchend(c,_,l){const h=this.singleTap.touchend(c,_,l);if(h){const d=c.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(h)<30;if(d&&x||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class Jc{constructor(){this._zoomIn=new Ua({numTouches:1,numTaps:2}),this._zoomOut=new Ua({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,_,l){this._zoomIn.touchstart(c,_,l),this._zoomOut.touchstart(c,_,l)}touchmove(c,_,l){this._zoomIn.touchmove(c,_,l),this._zoomOut.touchmove(c,_,l)}touchend(c,_,l){const h=this._zoomIn.touchend(c,_,l),d=this._zoomOut.touchend(c,_,l);return h?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()+1,around:x.unproject(h)},{originalEvent:c})}):d?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()-1,around:x.unproject(d)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const eh={0:1,2:2};class Va{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(c,_){return!1}_move(c,_){return{}}mousedown(c,_){if(this._lastPoint)return;const l=L.mouseButton(c);this._correctButton(c,l)&&(this._lastPoint=_,this._eventButton=l)}mousemoveWindow(c,_){const l=this._lastPoint;if(l){if(c.preventDefault(),function(h,d){const x=eh[d];return h.buttons===void 0||(h.buttons&x)!==x}(c,this._eventButton))this.reset();else if(this._moved||!(_.dist(l)<this._clickTolerance))return this._moved=!0,this._lastPoint=_,this._move(l,_)}}mouseupWindow(c){this._lastPoint&&L.mouseButton(c)===this._eventButton&&(this._moved&&L.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Aa extends Va{mousedown(c,_){super.mousedown(c,_),this._lastPoint&&(this._active=!0)}_correctButton(c,_){return _===0&&!c.ctrlKey}_move(c,_){return{around:_,panDelta:_.sub(c)}}}class is extends Va{_correctButton(c,_){return _===0&&c.ctrlKey||_===2}_move(c,_){const l=.8*(_.x-c.x);if(l)return this._active=!0,{bearingDelta:l}}contextmenu(c){c.preventDefault()}}class Ft extends Va{_correctButton(c,_){return _===0&&c.ctrlKey||_===2}_move(c,_){const l=-.5*(_.y-c.y);if(l)return this._active=!0,{pitchDelta:l}}contextmenu(c){c.preventDefault()}}class YA{constructor(c,_){this._minTouches=c.cooperativeGestures?2:1,this._clickTolerance=c.clickTolerance||1,this._map=_,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(c,_,l){return this._calculateTransform(c,_,l)}touchmove(c,_,l){if(this._map._cooperativeGestures&&(this._minTouches===2&&l.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(c,!1,l.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(l.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,_,l)}touchend(c,_,l){this._calculateTransform(c,_,l),this._active&&l.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,_,l){l.length>0&&(this._active=!0);const h=ho(l,_),d=new a.pointGeometry(0,0),x=new a.pointGeometry(0,0);let b=0;for(const M in h){const B=h[M],V=this._touches[M];V&&(d._add(B),x._add(B.sub(V)),b++,h[M]=B)}if(this._touches=h,b<this._minTouches||!x.mag())return;const S=x.div(b);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(b),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ua{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(c){}_move(c,_,l){return{}}touchstart(c,_,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([_[0],_[1]]))}touchmove(c,_,l){if(!this._firstTwoTouches)return;c.preventDefault();const[h,d]=this._firstTwoTouches,x=No(l,_,h),b=No(l,_,d);if(!x||!b)return;const S=this._aroundCenter?null:x.add(b).div(2);return this._move([x,b],S,c)}touchend(c,_,l){if(!this._firstTwoTouches)return;const[h,d]=this._firstTwoTouches,x=No(l,_,h),b=No(l,_,d);x&&b||(this._active&&L.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function No(k,c,_){for(let l=0;l<k.length;l++)if(k[l].identifier===_)return c[l]}function XA(k,c){return Math.log(k/c)/Math.LN2}class Ut extends ua{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,_){const l=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(XA(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:XA(this._distance,l),pinchAround:_}}}function hA(k,c){return 180*k.angleWith(c)/Math.PI}class El extends ua{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,_){const l=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:hA(this._vector,l),pinchAround:_}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const _=25/(Math.PI*this._minDiameter)*360,l=hA(c,this._startVector);return Math.abs(l)<_}}function fA(k){return Math.abs(k.y)>Math.abs(k.x)}class Ga extends ua{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(c,_,l){super.touchstart(c,_,l),this._currentTouchCount=l.length}_start(c){this._lastPoints=c,fA(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,_,l){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const h=c[0].sub(this._lastPoints[0]),d=c[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,d,l.timeStamp),this._valid?(this._lastPoints=c,this._active=!0,{pitchDelta:(h.y+d.y)/2*-.5}):void 0}gestureBeginsVertically(c,_,l){if(this._valid!==void 0)return this._valid;const h=c.mag()>=2,d=_.mag()>=2;if(!h&&!d)return;if(!h||!d)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const x=c.y>0==_.y>0;return fA(c)&&fA(_)&&x}}const Rs={panStep:100,bearingStep:15,pitchStep:10};class KA{constructor(){const c=Rs;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let _=0,l=0,h=0,d=0,x=0;switch(c.keyCode){case 61:case 107:case 171:case 187:_=1;break;case 189:case 109:case 173:_=-1;break;case 37:c.shiftKey?l=-1:(c.preventDefault(),d=-1);break;case 39:c.shiftKey?l=1:(c.preventDefault(),d=1);break;case 38:c.shiftKey?h=1:(c.preventDefault(),x=-1);break;case 40:c.shiftKey?h=-1:(c.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(l=0,h=0),{cameraAnimation:b=>{const S=b.getZoom();b.easeTo({duration:300,easeId:"keyboardHandler",easing:th,zoom:_?Math.round(S)+_*(c.shiftKey?2:1):S,bearing:b.getBearing()+l*this._bearingStep,pitch:b.getPitch()+h*this._pitchStep,offset:[-d*this._panStep,-x*this._panStep],center:b.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function th(k){return k*(2-k)}const nc=4.000244140625;class JA{constructor(c,_){this._map=c,this._el=c.getCanvasContainer(),this._handler=_,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&c.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;c.preventDefault()}let _=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const l=a.exported.now(),h=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,_!==0&&_%nc==0?this._type="wheel":_!==0&&Math.abs(_)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=_,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(h*_)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,_+=this._lastValue)),c.shiftKey&&_&&(_/=4),this._type&&(this._lastWheelEvent=c,this._delta-=_,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const _=L.mousePos(this._el,c);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(_)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>nc?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&S!==0&&(S=1/S);const M=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(M*S))),this._type==="wheel"&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const _=typeof this._targetZoom=="number"?this._targetZoom:c.zoom,l=this._startZoom,h=this._easing;let d,x=!1;if(this._type==="wheel"&&l&&h){const b=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),S=h(b);d=a.number(l,_,S),b<1?this._frameId||(this._frameId=!0):x=!0}else d=_,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:d-c.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let _=a.ease;if(this._prevEase){const l=this._prevEase,h=(a.exported.now()-l.start)/l.duration,d=l.easing(h+.01)-l.easing(h),x=.27/Math.sqrt(d*d+1e-4)*.01,b=Math.sqrt(.0729-x*x);_=a.bezier(x,b,.25,1)}return this._prevEase={start:a.exported.now(),duration:c,easing:_},_}reset(){this._active=!1}}class eu{constructor(c,_){this._clickZoom=c,this._tapZoom=_}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class tu{constructor(){this.reset()}reset(){this._active=!1}dblclick(c,_){return c.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:l.getZoom()+(c.shiftKey?-1:1),around:l.unproject(_)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bs{constructor(){this._tap=new Ua({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(c,_,l){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?l.length>0&&(this._swipePoint=_[0],this._swipeTouch=l[0].identifier):this._tap.touchstart(c,_,l))}touchmove(c,_,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const h=_[0],d=h.y-this._swipePoint.y;return this._swipePoint=h,c.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(c,_,l)}touchend(c,_,l){this._tapTime?this._swipePoint&&l.length===0&&this.reset():this._tap.touchend(c,_,l)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Mi{constructor(c,_,l){this._el=c,this._mousePan=_,this._touchPan=l}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class fo{constructor(c,_,l){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=_,this._mousePitch=l}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class nu{constructor(c,_,l,h){this._el=c,this._touchZoom=_,this._touchRotate=l,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ca=k=>k.zoom||k.drag||k.pitch||k.rotate;class Dr extends a.Event{}function Tl(k){return k.panDelta&&k.panDelta.mag()||k.zoomDelta||k.bearingDelta||k.pitchDelta}class rc{constructor(c,_){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ec(c),this._bearingSnap=_.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(_),a.bindAll(["handleEvent","handleWindowEvent"],this);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,d,x]of this._listeners)L.addEventListener(h,d,h===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[c,_,l]of this._listeners)L.removeEventListener(c,_,c===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(c){const _=this._map,l=_.getCanvasContainer();this._add("mapEvent",new wl(_,c));const h=_.boxZoom=new tc(_,c);this._add("boxZoom",h);const d=new Jc,x=new tu;_.doubleClickZoom=new eu(x,d),this._add("tapZoom",d),this._add("clickZoom",x);const b=new Bs;this._add("tapDragZoom",b);const S=_.touchPitch=new Ga(_);this._add("touchPitch",S);const M=new is(c),B=new Ft(c);_.dragRotate=new fo(c,M,B),this._add("mouseRotate",M,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]);const V=new Aa(c),$=new YA(c,_);_.dragPan=new Mi(l,V,$),this._add("mousePan",V),this._add("touchPan",$,["touchZoom","touchRotate"]);const Y=new El,oe=new Ut;_.touchZoomRotate=new nu(l,oe,Y,b),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",oe,["touchPan","touchRotate"]);const te=_.scrollZoom=new JA(_,this);this._add("scrollZoom",te,["mousePan"]);const ue=_.keyboard=new KA;this._add("keyboard",ue),this._add("blockableMapEvent",new Fo(_));for(const be of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[be]&&_[be].enable(c[be])}_add(c,_,l){this._handlers.push({handlerName:c,handler:_,allowed:l}),this._handlersById[c]=_}stop(c){if(!this._updatingCamera){for(const{handler:_}of this._handlers)_.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ca(this._eventsInProgress)||this.isZooming()}_blockedByActive(c,_,l){for(const h in c)if(h!==l&&(!_||_.indexOf(h)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const _=[];for(const l of c)this._el.contains(l.target)&&_.push(l);return _}handleEvent(c,_){if(c.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const l=c.type==="renderFrame"?void 0:c,h={needsRenderFrame:!1},d={},x={},b=c.touches,S=b?this._getMapTouches(b):void 0,M=S?L.touchPos(this._el,S):L.mousePos(this._el,c);for(const{handlerName:$,handler:Y,allowed:oe}of this._handlers){if(!Y.isEnabled())continue;let te;this._blockedByActive(x,oe,$)?Y.reset():Y[_||c.type]&&(te=Y[_||c.type](c,M,S),this.mergeHandlerResult(h,d,te,$,l),te&&te.needsRenderFrame&&this._triggerRenderFrame()),(te||Y.isActive())&&(x[$]=Y)}const B={};for(const $ in this._previousActiveHandlers)x[$]||(B[$]=l);this._previousActiveHandlers=x,(Object.keys(B).length||Tl(h))&&(this._changes.push([h,d,B]),this._triggerRenderFrame()),(Object.keys(x).length||Tl(h))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=h;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))}mergeHandlerResult(c,_,l,h,d){if(!l)return;a.extend(c,l);const x={handlerName:h,originalEvent:l.originalEvent||d};l.zoomDelta!==void 0&&(_.zoom=x),l.panDelta!==void 0&&(_.drag=x),l.pitchDelta!==void 0&&(_.pitch=x),l.bearingDelta!==void 0&&(_.rotate=x)}_applyChanges(){const c={},_={},l={};for(const[h,d,x]of this._changes)h.panDelta&&(c.panDelta=(c.panDelta||new a.pointGeometry(0,0))._add(h.panDelta)),h.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+h.pitchDelta),h.around!==void 0&&(c.around=h.around),h.pinchAround!==void 0&&(c.pinchAround=h.pinchAround),h.noInertia&&(c.noInertia=h.noInertia),a.extend(_,d),a.extend(l,x);this._updateMapTransform(c,_,l),this._changes=[]}_updateMapTransform(c,_,l){const h=this._map,d=h.transform,x=h.style&&h.style.terrain;if(!(Tl(c)||x&&this._drag))return this._fireEvents(_,l,!0);let{panDelta:b,zoomDelta:S,bearingDelta:M,pitchDelta:B,around:V,pinchAround:$}=c;$!==void 0&&(V=$),h._stop(!0),V=V||h.transform.centerPoint;const Y=d.pointLocation(b?V.sub(b):V);M&&(d.bearing+=M),B&&(d.pitch+=B),S&&(d.zoom+=S),x?_.drag&&!this._drag?(this._drag={center:d.centerPoint,lngLat:d.pointLocation(V),point:V,handlerName:_.drag.handlerName},h.fire(new a.Event("freezeElevation",{freeze:!0}))):this._drag&&l[this._drag.handlerName]?(h.fire(new a.Event("freezeElevation",{freeze:!1})),this._drag=null):_.drag&&this._drag&&(d.center=d.pointLocation(d.centerPoint.sub(b))):d.setLocationAtPoint(Y,V),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(_,l,!0)}_fireEvents(c,_,l){const h=ca(this._eventsInProgress),d=ca(c),x={};for(const B in c){const{originalEvent:V}=c[B];this._eventsInProgress[B]||(x[`${B}start`]=V),this._eventsInProgress[B]=c[B]}!h&&d&&this._fireEvent("movestart",d.originalEvent);for(const B in x)this._fireEvent(B,x[B]);d&&this._fireEvent("move",d.originalEvent);for(const B in c){const{originalEvent:V}=c[B];this._fireEvent(B,V)}const b={};let S;for(const B in this._eventsInProgress){const{handlerName:V,originalEvent:$}=this._eventsInProgress[B];this._handlersById[V].isActive()||(delete this._eventsInProgress[B],S=_[V]||$,b[`${B}end`]=S)}for(const B in b)this._fireEvent(B,b[B]);const M=ca(this._eventsInProgress);if(l&&(h||d)&&!M){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;B?(V(B.bearing||this._map.getBearing())&&(B.bearing=0),this._map.easeTo(B,{originalEvent:S})):(this._map.fire(new a.Event("moveend",{originalEvent:S})),V(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,_){this._map.fire(new a.Event(c,_?{originalEvent:_}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{delete this._frameId,this.handleEvent(new Dr("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ss={extend:(k,...c)=>a.extend(k,...c),run(k){k()},logToElement(k,c=!1,_="log"){const l=window.document.getElementById(_);l&&(c&&(l.innerHTML=""),l.innerHTML+=`<br>${k}`)}};class wr extends a.Evented{constructor(c,_){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=_.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,_){return this.jumpTo({center:c},_)}panBy(c,_,l){return c=a.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,a.extend({offset:c},_),l)}panTo(c,_,l){return this.easeTo(a.extend({center:c},_),l)}getZoom(){return this.transform.zoom}setZoom(c,_){return this.jumpTo({zoom:c},_),this}zoomTo(c,_,l){return this.easeTo(a.extend({zoom:c},_),l)}zoomIn(c,_){return this.zoomTo(this.getZoom()+1,c,_),this}zoomOut(c,_){return this.zoomTo(this.getZoom()-1,c,_),this}getBearing(){return this.transform.bearing}setBearing(c,_){return this.jumpTo({bearing:c},_),this}getPadding(){return this.transform.padding}setPadding(c,_){return this.jumpTo({padding:c},_),this}rotateTo(c,_,l){return this.easeTo(a.extend({bearing:c},_),l)}resetNorth(c,_){return this.rotateTo(0,a.extend({duration:1e3},c),_),this}resetNorthPitch(c,_){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},c),_),this}snapToNorth(c,_){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,_):this}getPitch(){return this.transform.pitch}setPitch(c,_){return this.jumpTo({pitch:c},_),this}cameraForBounds(c,_){c=a.LngLatBounds.convert(c);const l=_&&_.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),l,_)}_cameraForBoxAndBearing(c,_,l,h){const d={top:0,bottom:0,right:0,left:0};if(typeof(h=a.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const Te=h.padding;h.padding={top:Te,bottom:Te,right:Te,left:Te}}h.padding=a.extend(d,h.padding);const x=this.transform,b=x.padding,S=x.project(a.LngLat.convert(c)),M=x.project(a.LngLat.convert(_)),B=S.rotate(-l*Math.PI/180),V=M.rotate(-l*Math.PI/180),$=new a.pointGeometry(Math.max(B.x,V.x),Math.max(B.y,V.y)),Y=new a.pointGeometry(Math.min(B.x,V.x),Math.min(B.y,V.y)),oe=$.sub(Y),te=(x.width-(b.left+b.right+h.padding.left+h.padding.right))/oe.x,ue=(x.height-(b.top+b.bottom+h.padding.top+h.padding.bottom))/oe.y;if(ue<0||te<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const be=Math.min(x.scaleZoom(x.scale*Math.min(te,ue)),h.maxZoom),Ce=a.pointGeometry.convert(h.offset),ve=new a.pointGeometry((h.padding.left-h.padding.right)/2,(h.padding.top-h.padding.bottom)/2).rotate(l*Math.PI/180),Ge=Ce.add(ve).mult(x.scale/x.zoomScale(be));return{center:x.unproject(S.add(M).div(2).sub(Ge)),zoom:be,bearing:l}}fitBounds(c,_,l){return this._fitInternal(this.cameraForBounds(c,_),_,l)}fitScreenCoordinates(c,_,l,h,d){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.pointGeometry.convert(c)),this.transform.pointLocation(a.pointGeometry.convert(_)),l,h),h,d)}_fitInternal(c,_,l){return c?(delete(_=a.extend(c,_)).padding,_.linear?this.easeTo(_,l):this.flyTo(_,l)):this}jumpTo(c,_){this.stop();const l=this.transform;let h=!1,d=!1,x=!1;return"zoom"in c&&l.zoom!==+c.zoom&&(h=!0,l.zoom=+c.zoom),c.center!==void 0&&(l.center=a.LngLat.convert(c.center)),"bearing"in c&&l.bearing!==+c.bearing&&(d=!0,l.bearing=+c.bearing),"pitch"in c&&l.pitch!==+c.pitch&&(x=!0,l.pitch=+c.pitch),c.padding==null||l.isPaddingEqual(c.padding)||(l.padding=c.padding),this.fire(new a.Event("movestart",_)).fire(new a.Event("move",_)),h&&this.fire(new a.Event("zoomstart",_)).fire(new a.Event("zoom",_)).fire(new a.Event("zoomend",_)),d&&this.fire(new a.Event("rotatestart",_)).fire(new a.Event("rotate",_)).fire(new a.Event("rotateend",_)),x&&this.fire(new a.Event("pitchstart",_)).fire(new a.Event("pitch",_)).fire(new a.Event("pitchend",_)),this.fire(new a.Event("moveend",_))}calculateCameraOptionsFromTo(c,_,l,h=0){const d=a.MercatorCoordinate.fromLngLat(c,_),x=a.MercatorCoordinate.fromLngLat(l,h),b=x.x-d.x,S=x.y-d.y,M=x.z-d.z,B=Math.hypot(b,S,M);if(B===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(b,S),$=this.transform.scaleZoom(this.transform.cameraToCenterDistance/B/this.transform.tileSize),Y=180*Math.atan2(b,-S)/Math.PI;let oe=180*Math.acos(V/B)/Math.PI;return oe=M<0?90-oe:90+oe,{center:x.toLngLat(),zoom:$,pitch:oe,bearing:Y}}easeTo(c,_){this._stop(!1,c.easeId),((c=a.extend({offset:[0,0],duration:500,easing:a.ease},c)).animate===!1||!c.essential&&a.exported.prefersReducedMotion)&&(c.duration=0);const l=this.transform,h=this.getZoom(),d=this.getBearing(),x=this.getPitch(),b=this.getPadding(),S="zoom"in c?+c.zoom:h,M="bearing"in c?this._normalizeBearing(c.bearing,d):d,B="pitch"in c?+c.pitch:x,V="padding"in c?c.padding:l.padding,$=a.pointGeometry.convert(c.offset);let Y=l.centerPoint.add($);const oe=l.pointLocation(Y),te=a.LngLat.convert(c.center||oe);this._normalizeCenter(te);const ue=l.project(oe),be=l.project(te).sub(ue),Ce=l.zoomScale(S-h);let ve,Ge;c.around&&(ve=a.LngLat.convert(c.around),Ge=l.locationPoint(ve));const Te={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||S!==h,this._rotating=this._rotating||d!==M,this._pitching=this._pitching||B!==x,this._padding=!l.isPaddingEqual(V),this._easeId=c.easeId,this._prepareEase(_,c.noMoveStart,Te),this._ease(Ve=>{if(this._zooming&&(l.zoom=a.number(h,S,Ve)),this._rotating&&(l.bearing=a.number(d,M,Ve)),this._pitching&&(l.pitch=a.number(x,B,Ve)),this._padding&&(l.interpolatePadding(b,V,Ve),Y=l.centerPoint.add($)),ve)l.setLocationAtPoint(ve,Ge);else{const xe=l.zoomScale(l.zoom-h),m=S>h?Math.min(2,Ce):Math.max(.5,Ce),g=Math.pow(m,1-Ve),v=l.unproject(ue.add(be.mult(Ve*g)).mult(xe));l.setLocationAtPoint(l.renderWorldCopies?v.wrap():v,Y)}this._fireMoveEvents(_)},Ve=>{this._afterEase(_,Ve)},c),this}_prepareEase(c,_,l={}){this._moving=!0,this.fire(new a.Event("freezeElevation",{freeze:!0})),_||l.moving||this.fire(new a.Event("movestart",c)),this._zooming&&!l.zooming&&this.fire(new a.Event("zoomstart",c)),this._rotating&&!l.rotating&&this.fire(new a.Event("rotatestart",c)),this._pitching&&!l.pitching&&this.fire(new a.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new a.Event("move",c)),this._zooming&&this.fire(new a.Event("zoom",c)),this._rotating&&this.fire(new a.Event("rotate",c)),this._pitching&&this.fire(new a.Event("pitch",c))}_afterEase(c,_){if(this._easeId&&_&&this._easeId===_)return;delete this._easeId,this.fire(new a.Event("freezeElevation",{freeze:!1}));const l=this._zooming,h=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,l&&this.fire(new a.Event("zoomend",c)),h&&this.fire(new a.Event("rotateend",c)),d&&this.fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))}flyTo(c,_){if(!c.essential&&a.exported.prefersReducedMotion){const N=a.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(N,_)}this.stop(),c=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},c);const l=this.transform,h=this.getZoom(),d=this.getBearing(),x=this.getPitch(),b=this.getPadding(),S="zoom"in c?a.clamp(+c.zoom,l.minZoom,l.maxZoom):h,M="bearing"in c?this._normalizeBearing(c.bearing,d):d,B="pitch"in c?+c.pitch:x,V="padding"in c?c.padding:l.padding,$=l.zoomScale(S-h),Y=a.pointGeometry.convert(c.offset);let oe=l.centerPoint.add(Y);const te=l.pointLocation(oe),ue=a.LngLat.convert(c.center||te);this._normalizeCenter(ue);const be=l.project(te),Ce=l.project(ue).sub(be);let ve=c.curve;const Ge=Math.max(l.width,l.height),Te=Ge/$,Ve=Ce.mag();if("minZoom"in c){const N=a.clamp(Math.min(c.minZoom,h,S),l.minZoom,l.maxZoom),Q=Ge/l.zoomScale(N-h);ve=Math.sqrt(Q/Ve*2)}const xe=ve*ve;function m(N){const Q=(Te*Te-Ge*Ge+(N?-1:1)*xe*xe*Ve*Ve)/(2*(N?Te:Ge)*xe*Ve);return Math.log(Math.sqrt(Q*Q+1)-Q)}function g(N){return(Math.exp(N)-Math.exp(-N))/2}function v(N){return(Math.exp(N)+Math.exp(-N))/2}const E=m(0);let C=function(N){return v(E)/v(E+ve*N)},R=function(N){return Ge*((v(E)*(g(Q=E+ve*N)/v(Q))-g(E))/xe)/Ve;var Q},O=(m(1)-E)/ve;if(Math.abs(Ve)<1e-6||!isFinite(O)){if(Math.abs(Ge-Te)<1e-6)return this.easeTo(c,_);const N=Te<Ge?-1:1;O=Math.abs(Math.log(Te/Ge))/ve,R=function(){return 0},C=function(Q){return Math.exp(N*ve*Q)}}return c.duration="duration"in c?+c.duration:1e3*O/("screenSpeed"in c?+c.screenSpeed/ve:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=d!==M,this._pitching=B!==x,this._padding=!l.isPaddingEqual(V),this._prepareEase(_,!1),this._ease(N=>{const Q=N*O,J=1/C(Q);l.zoom=N===1?S:h+l.scaleZoom(J),this._rotating&&(l.bearing=a.number(d,M,N)),this._pitching&&(l.pitch=a.number(x,B,N)),this._padding&&(l.interpolatePadding(b,V,N),oe=l.centerPoint.add(Y));const le=N===1?ue:l.unproject(be.add(Ce.mult(R(Q))).mult(J));l.setLocationAtPoint(l.renderWorldCopies?le.wrap():le,oe),this._fireMoveEvents(_)},()=>this._afterEase(_),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,_){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const l=this._onEaseEnd;delete this._onEaseEnd,l.call(this,_)}if(!c){const l=this.handlers;l&&l.stop(!1)}return this}_ease(c,_,l){l.animate===!1||l.duration===0?(c(1),_()):(this._easeStart=a.exported.now(),this._easeOptions=l,this._onEaseFrame=c,this._onEaseEnd=_,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,_){c=a.wrap(c,-180,180);const l=Math.abs(c-_);return Math.abs(c-360-_)<l&&(c-=360),Math.abs(c+360-_)<l&&(c+=360),c}_normalizeCenter(c){const _=this.transform;if(!_.renderWorldCopies||_.lngRange)return;const l=c.lng-_.center.lng;c.lng+=l>180?-360:l<-180?360:0}}class ja{constructor(c={}){this.options=c,a.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){return this._map=c,this._compact=this.options&&this.options.compact,this._container=L.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){L.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(c,_){const l=this._map._getUIString(`AttributionControl.${_}`);c.title=l,c.setAttribute("aria-label",l)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const _=this._map.style.sourceCaches;for(const h in _){const d=_[h];if(d.used||d.usedForTerrain){const x=d.getSource();x.attribution&&c.indexOf(x.attribution)<0&&c.push(x.attribution)}}c=c.filter(h=>String(h).trim()),c.sort((h,d)=>h.length-d.length),c=c.filter((h,d)=>{for(let x=d+1;x<c.length;x++)if(c[x].indexOf(h)>=0)return!1;return!0});const l=c.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,c.length?(this._innerContainer.innerHTML=l,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Sl{constructor(c={}){this.options=c,a.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(c){this._map=c,this._compact=this.options&&this.options.compact,this._container=L.create("div","maplibregl-ctrl mapboxgl-ctrl");const _=L.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return _.target="_blank",_.rel="noopener nofollow",_.href="https://maplibre.org/",_.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),_.setAttribute("rel","noopener nofollow"),this._container.appendChild(_),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){L.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const c=this._container.children;if(c.length){const _=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&_.classList.add("maplibregl-compact","mapboxgl-compact"):_.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class ru{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const _=++this._id;return this._queue.push({callback:c,id:_,cancelled:!1}),_}remove(c){const _=this._currentlyRunning,l=_?this._queue.concat(_):this._queue;for(const h of l)if(h.id===c)return void(h.cancelled=!0)}run(c=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const _=this._currentlyRunning=this._queue;this._queue=[];for(const l of _)if(!l.cancelled&&(l.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const ic={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},iu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},sc={showCompass:!0,showZoom:!0,visualizePitch:!1};class dr{constructor(c,_,l=!1){this._clickTolerance=10,this.element=_,this.mouseRotate=new is({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,l&&(this.mousePitch=new Ft({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),L.addEventListener(_,"mousedown",this.mousedown),L.addEventListener(_,"touchstart",this.touchstart,{passive:!1}),L.addEventListener(_,"touchmove",this.touchmove),L.addEventListener(_,"touchend",this.touchend),L.addEventListener(_,"touchcancel",this.reset)}down(c,_){this.mouseRotate.mousedown(c,_),this.mousePitch&&this.mousePitch.mousedown(c,_),L.disableDrag()}move(c,_){const l=this.map,h=this.mouseRotate.mousemoveWindow(c,_);if(h&&h.bearingDelta&&l.setBearing(l.getBearing()+h.bearingDelta),this.mousePitch){const d=this.mousePitch.mousemoveWindow(c,_);d&&d.pitchDelta&&l.setPitch(l.getPitch()+d.pitchDelta)}}off(){const c=this.element;L.removeEventListener(c,"mousedown",this.mousedown),L.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),L.removeEventListener(c,"touchmove",this.touchmove),L.removeEventListener(c,"touchend",this.touchend),L.removeEventListener(c,"touchcancel",this.reset),this.offTemp()}offTemp(){L.enableDrag(),L.removeEventListener(window,"mousemove",this.mousemove),L.removeEventListener(window,"mouseup",this.mouseup)}mousedown(c){this.down(a.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),L.mousePos(this.element,c)),L.addEventListener(window,"mousemove",this.mousemove),L.addEventListener(window,"mouseup",this.mouseup)}mousemove(c){this.move(c,L.mousePos(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=L.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){c.targetTouches.length!==1?this.reset():(this._lastPos=L.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Ml(k,c,_){if(k=new a.LngLat(k.lng,k.lat),c){const l=new a.LngLat(k.lng-360,k.lat),h=new a.LngLat(k.lng+360,k.lat),d=_.locationPoint(k).distSqr(c);_.locationPoint(l).distSqr(c)<d?k=l:_.locationPoint(h).distSqr(c)<d&&(k=h)}for(;Math.abs(k.lng-_.center.lng)>180;){const l=_.locationPoint(k);if(l.x>=0&&l.y>=0&&l.x<=_.width&&l.y<=_.height)break;k.lng>_.center.lng?k.lng-=360:k.lng+=360}return k}const Zt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Yt(k,c,_){const l=k.classList;for(const h in Zt)l.remove(`maplibregl-${_}-anchor-${h}`,`mapboxgl-${_}-anchor-${h}`);l.add(`maplibregl-${_}-anchor-${c}`,`mapboxgl-${_}-anchor-${c}`)}class cn extends a.Evented{constructor(c,_){if(super(),(c instanceof HTMLElement||_)&&(c=a.extend({element:c},_)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment!=="auto"?c.pitchAlignment:this._rotationAlignment,c&&c.element)this._element=c.element,this._offset=a.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=L.create("div"),this._element.setAttribute("aria-label","Map marker");const l=L.createNS("http://www.w3.org/2000/svg","svg"),h=41,d=27;l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height",`${h}px`),l.setAttributeNS(null,"width",`${d}px`),l.setAttributeNS(null,"viewBox",`0 0 ${d} ${h}`);const x=L.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const b=L.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const S=L.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ce of M){const ve=L.createNS("http://www.w3.org/2000/svg","ellipse");ve.setAttributeNS(null,"opacity","0.04"),ve.setAttributeNS(null,"cx","10.5"),ve.setAttributeNS(null,"cy","5.80029008"),ve.setAttributeNS(null,"rx",Ce.rx),ve.setAttributeNS(null,"ry",Ce.ry),S.appendChild(ve)}const B=L.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const V=L.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(V);const $=L.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");const Y=L.createNS("http://www.w3.org/2000/svg","path");Y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(Y);const oe=L.createNS("http://www.w3.org/2000/svg","g");oe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),oe.setAttributeNS(null,"fill","#FFFFFF");const te=L.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ue=L.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#000000"),ue.setAttributeNS(null,"opacity","0.25"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962");const be=L.createNS("http://www.w3.org/2000/svg","circle");be.setAttributeNS(null,"fill","#FFFFFF"),be.setAttributeNS(null,"cx","5.5"),be.setAttributeNS(null,"cy","5.5"),be.setAttributeNS(null,"r","5.4999962"),te.appendChild(ue),te.appendChild(be),b.appendChild(S),b.appendChild(B),b.appendChild($),b.appendChild(oe),b.appendChild(te),l.appendChild(b),l.setAttributeNS(null,"height",h*this._scale+"px"),l.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(l),this._offset=a.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",l=>{l.preventDefault()}),this._element.addEventListener("mousedown",l=>{l.preventDefault()}),Yt(this._element,this._anchor,"marker"),this._popup=null}addTo(c){return this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),L.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=a.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const h=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(c){const _=c.code,l=c.charCode||c.keyCode;_!=="Space"&&_!=="Enter"&&l!==32&&l!==13||this.togglePopup()}_onMapClick(c){const _=c.originalEvent.target,l=this._element;this._popup&&(_===l||l.contains(_))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?c.remove():c.addTo(this._map),this):this}_update(c){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Ml(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let l="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?l="rotateX(0deg)":this._pitchAlignment==="map"&&(l=`rotateX(${this._map.getPitch()}deg)`),c&&c.type!=="moveend"||(this._pos=this._pos.round()),L.setTransform(this._element,`${Zt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${l} ${_}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const h=this._map.unproject(this._pos),d=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=h.distanceTo(this._lngLat)>20*d?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(c){return this._offset=a.pointGeometry.convert(c),this._update(),this}_onMove(c){if(!this._isDragging){const _=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=_}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(c){this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c&&c!=="auto"?c:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const $i={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Uo,Or=0,zs=!1;const ms={maxWidth:100,unit:"metric"};function Os(k,c,_){const l=_&&_.maxWidth||100,h=k._container.clientHeight/2,d=k.unproject([0,h]),x=k.unproject([l,h]),b=d.distanceTo(x);if(_&&_.unit==="imperial"){const S=3.2808*b;S>5280?St(c,l,S/5280,k._getUIString("ScaleControl.Miles")):St(c,l,S,k._getUIString("ScaleControl.Feet"))}else _&&_.unit==="nautical"?St(c,l,b/1852,k._getUIString("ScaleControl.NauticalMiles")):b>=1e3?St(c,l,b/1e3,k._getUIString("ScaleControl.Kilometers")):St(c,l,b,k._getUIString("ScaleControl.Meters"))}function St(k,c,_,l){const h=function(d){const x=Math.pow(10,`${Math.floor(d)}`.length-1);let b=d/x;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(S){const M=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*M)/M}(b),x*b}(_);k.style.width=c*(h/_)+"px",k.innerHTML=`${h}&nbsp;${l}`}const Ct={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Fr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function $a(k){if(k){if(typeof k=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(k,2)));return{center:new a.pointGeometry(0,0),top:new a.pointGeometry(0,k),"top-left":new a.pointGeometry(c,c),"top-right":new a.pointGeometry(-c,c),bottom:new a.pointGeometry(0,-k),"bottom-left":new a.pointGeometry(c,-c),"bottom-right":new a.pointGeometry(-c,-c),left:new a.pointGeometry(k,0),right:new a.pointGeometry(-k,0)}}if(k instanceof a.pointGeometry||Array.isArray(k)){const c=a.pointGeometry.convert(k);return{center:c,top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}return{center:a.pointGeometry.convert(k.center||[0,0]),top:a.pointGeometry.convert(k.top||[0,0]),"top-left":a.pointGeometry.convert(k["top-left"]||[0,0]),"top-right":a.pointGeometry.convert(k["top-right"]||[0,0]),bottom:a.pointGeometry.convert(k.bottom||[0,0]),"bottom-left":a.pointGeometry.convert(k["bottom-left"]||[0,0]),"bottom-right":a.pointGeometry.convert(k["bottom-right"]||[0,0]),left:a.pointGeometry.convert(k.left||[0,0]),right:a.pointGeometry.convert(k.right||[0,0])}}return $a(new a.pointGeometry(0,0))}const Fs={supported:y,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends wr{constructor(k){var c;if(a.PerformanceUtils.mark(a.PerformanceMarkers.create),(k=a.extend({},iu,k)).minZoom!=null&&k.maxZoom!=null&&k.minZoom>k.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(k.minPitch!=null&&k.maxPitch!=null&&k.minPitch>k.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(k.minPitch!=null&&k.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(k.maxPitch!=null&&k.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new co(k.minZoom,k.maxZoom,k.minPitch,k.maxPitch,k.renderWorldCopies),{bearingSnap:k.bearingSnap}),this._interactive=k.interactive,this._cooperativeGestures=k.cooperativeGestures,this._maxTileCacheSize=k.maxTileCacheSize,this._failIfMajorPerformanceCaveat=k.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=k.preserveDrawingBuffer,this._antialias=k.antialias,this._trackResize=k.trackResize,this._bearingSnap=k.bearingSnap,this._refreshExpiredTiles=k.refreshExpiredTiles,this._fadeDuration=k.fadeDuration,this._crossSourceCollisions=k.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=k.collectResourceTiming,this._renderTaskQueue=new ru,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},ic,k.locale),this._clickTolerance=k.clickTolerance,this._pixelRatio=(c=k.pixelRatio)!==null&&c!==void 0?c:devicePixelRatio,this._requestManager=new U(k.transformRequest),typeof k.container=="string"){if(this._container=document.getElementById(k.container),!this._container)throw new Error(`Container '${k.container}' not found.`)}else{if(!(k.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=k.container}if(k.maxBounds&&this.setMaxBounds(k.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new rc(this,k),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=k.hash&&new Ai(typeof k.hash=="string"&&k.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:k.center,zoom:k.zoom,bearing:k.bearing,pitch:k.pitch}),k.bounds&&(this.resize(),this.fitBounds(k.bounds,a.extend({},k.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=k.localIdeographFontFamily,k.style&&this.setStyle(k.style,{localIdeographFontFamily:k.localIdeographFontFamily}),k.attributionControl&&this.addControl(new ja({customAttribution:k.customAttribution})),k.maplibreLogo&&this.addControl(new Sl,k.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",_=>{this._update(_.dataType==="style"),this.fire(new a.Event(`${_.dataType}data`,_))}),this.on("dataloading",_=>{this.fire(new a.Event(`${_.dataType}dataloading`,_))}),this.on("dataabort",_=>{this.fire(new a.Event("sourcedataabort",_))})}_getMapId(){return this._mapId}addControl(k,c){if(c===void 0&&(c=k.getDefaultPosition?k.getDefaultPosition():"top-right"),!k||!k.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const _=k.onAdd(this);this._controls.push(k);const l=this._controlPositions[c];return c.indexOf("bottom")!==-1?l.insertBefore(_,l.firstChild):l.appendChild(_),this}removeControl(k){if(!k||!k.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(k);return c>-1&&this._controls.splice(c,1),k.onRemove(this),this}hasControl(k){return this._controls.indexOf(k)>-1}calculateCameraOptionsFromTo(k,c,_,l){return l==null&&this.style.terrain&&(l=this.transform.getElevation(_,this.style.terrain)),super.calculateCameraOptionsFromTo(k,c,_,l)}resize(k){const c=this._containerDimensions(),_=c[0],l=c[1];this._resizeCanvas(_,l,this.getPixelRatio()),this.transform.resize(_,l),this.painter.resize(_,l,this.getPixelRatio());const h=!this._moving;return h&&(this.stop(),this.fire(new a.Event("movestart",k)).fire(new a.Event("move",k))),this.fire(new a.Event("resize",k)),h&&this.fire(new a.Event("moveend",k)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(k){const[c,_]=this._containerDimensions();this._pixelRatio=k,this._resizeCanvas(c,_,k),this.painter.resize(c,_,k)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(k){return this.transform.setMaxBounds(a.LngLatBounds.convert(k)),this._update()}setMinZoom(k){if((k=k??-2)>=-2&&k<=this.transform.maxZoom)return this.transform.minZoom=k,this._update(),this.getZoom()<k&&this.setZoom(k),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(k){if((k=k??22)>=this.transform.minZoom)return this.transform.maxZoom=k,this._update(),this.getZoom()>k&&this.setZoom(k),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(k){if((k=k??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(k>=0&&k<=this.transform.maxPitch)return this.transform.minPitch=k,this._update(),this.getPitch()<k&&this.setPitch(k),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(k){if((k=k??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(k>=this.transform.minPitch)return this.transform.maxPitch=k,this._update(),this.getPitch()>k&&this.setPitch(k),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(k){return this.transform.renderWorldCopies=k,this._update()}project(k){return this.transform.locationPoint(a.LngLat.convert(k),this.style&&this.style.terrain)}unproject(k){return this.transform.pointLocation(a.pointGeometry.convert(k),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(k,c,_){if(k==="mouseenter"||k==="mouseover"){let l=!1;return{layer:c,listener:_,delegates:{mousemove:d=>{const x=this.getLayer(c)?this.queryRenderedFeatures(d.point,{layers:[c]}):[];x.length?l||(l=!0,_.call(this,new Jr(k,this,d.originalEvent,{features:x}))):l=!1},mouseout:()=>{l=!1}}}}if(k==="mouseleave"||k==="mouseout"){let l=!1;return{layer:c,listener:_,delegates:{mousemove:x=>{(this.getLayer(c)?this.queryRenderedFeatures(x.point,{layers:[c]}):[]).length?l=!0:l&&(l=!1,_.call(this,new Jr(k,this,x.originalEvent)))},mouseout:x=>{l&&(l=!1,_.call(this,new Jr(k,this,x.originalEvent)))}}}}{const l=h=>{const d=this.getLayer(c)?this.queryRenderedFeatures(h.point,{layers:[c]}):[];d.length&&(h.features=d,_.call(this,h),delete h.features)};return{layer:c,listener:_,delegates:{[k]:l}}}}on(k,c,_){if(_===void 0)return super.on(k,c);const l=this._createDelegatedListener(k,c,_);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[k]=this._delegatedListeners[k]||[],this._delegatedListeners[k].push(l);for(const h in l.delegates)this.on(h,l.delegates[h]);return this}once(k,c,_){if(_===void 0)return super.once(k,c);const l=this._createDelegatedListener(k,c,_);for(const h in l.delegates)this.once(h,l.delegates[h]);return this}off(k,c,_){return _===void 0?super.off(k,c):(this._delegatedListeners&&this._delegatedListeners[k]&&(l=>{const h=this._delegatedListeners[k];for(let d=0;d<h.length;d++){const x=h[d];if(x.layer===c&&x.listener===_){for(const b in x.delegates)this.off(b,x.delegates[b]);return h.splice(d,1),this}}})(),this)}queryRenderedFeatures(k,c){if(!this.style)return[];let _;if(c!==void 0||k===void 0||k instanceof a.pointGeometry||Array.isArray(k)||(c=k,k=void 0),c=c||{},(k=k||[[0,0],[this.transform.width,this.transform.height]])instanceof a.pointGeometry||typeof k[0]=="number")_=[a.pointGeometry.convert(k)];else{const l=a.pointGeometry.convert(k[0]),h=a.pointGeometry.convert(k[1]);_=[l,new a.pointGeometry(h.x,l.y),h,new a.pointGeometry(l.x,h.y),l]}return this.style.queryRenderedFeatures(_,c,this.transform)}querySourceFeatures(k,c){return this.style.querySourceFeatures(k,c)}setStyle(k,c){return(c=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&k?(this._diffStyle(k,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._updateStyle(k,c))}setTransformRequest(k){return this._requestManager.setTransformRequest(k),this}_getUIString(k){const c=this._locale[k];if(c==null)throw new Error(`Missing UI string '${k}'`);return c}_updateStyle(k,c){return this.style&&(this.style.setEventedParent(null),this.style._remove()),k?(this.style=new Se(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof k=="string"?this.style.loadURL(k):this.style.loadJSON(k),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Se(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(k,c){if(typeof k=="string"){const _=this._requestManager.transformRequest(k,a.ResourceType.Style);a.getJSON(_,(l,h)=>{l?this.fire(new a.ErrorEvent(l)):h&&this._updateDiff(h,c)})}else typeof k=="object"&&this._updateDiff(k,c)}_updateDiff(k,c){try{this.style.setState(k)&&this._update(!0)}catch(_){a.warnOnce(`Unable to perform style diff: ${_.message||_.error||_}.  Rebuilding the style from scratch.`),this._updateStyle(k,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")}addSource(k,c){return this._lazyInitEmptyStyle(),this.style.addSource(k,c),this._update(!0)}isSourceLoaded(k){const c=this.style&&this.style.sourceCaches[k];if(c!==void 0)return c.loaded();this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${k}'`)))}setTerrain(k){return this.style.setTerrain(k),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const k=this.style&&this.style.sourceCaches;for(const c in k){const _=k[c]._tiles;for(const l in _){const h=_[l];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}addSourceType(k,c,_){return this._lazyInitEmptyStyle(),this.style.addSourceType(k,c,_)}removeSource(k){return this.style.removeSource(k),this._update(!0)}getSource(k){return this.style.getSource(k)}addImage(k,c,{pixelRatio:_=1,sdf:l=!1,stretchX:h,stretchY:d,content:x}={}){if(this._lazyInitEmptyStyle(),c instanceof HTMLImageElement||a.isImageBitmap(c)){const{width:b,height:S,data:M}=a.exported.getImageData(c);this.style.addImage(k,{data:new a.RGBAImage({width:b,height:S},M),pixelRatio:_,stretchX:h,stretchY:d,content:x,sdf:l,version:0})}else{if(c.width===void 0||c.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:b,height:S,data:M}=c,B=c;this.style.addImage(k,{data:new a.RGBAImage({width:b,height:S},new Uint8Array(M)),pixelRatio:_,stretchX:h,stretchY:d,content:x,sdf:l,version:0,userImage:B}),B.onAdd&&B.onAdd(this,k)}}}updateImage(k,c){const _=this.style.getImage(k);if(!_)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=c instanceof HTMLImageElement||a.isImageBitmap(c)?a.exported.getImageData(c):c,{width:h,height:d,data:x}=l;if(h===void 0||d===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==_.data.width||d!==_.data.height)return this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(c instanceof HTMLImageElement||a.isImageBitmap(c));_.data.replace(x,b),this.style.updateImage(k,_)}hasImage(k){return k?!!this.style.getImage(k):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(k){this.style.removeImage(k)}loadImage(k,c){a.getImage(this._requestManager.transformRequest(k,a.ResourceType.Image),c)}listImages(){return this.style.listImages()}addLayer(k,c){return this._lazyInitEmptyStyle(),this.style.addLayer(k,c),this._update(!0)}moveLayer(k,c){return this.style.moveLayer(k,c),this._update(!0)}removeLayer(k){return this.style.removeLayer(k),this._update(!0)}getLayer(k){return this.style.getLayer(k)}setLayerZoomRange(k,c,_){return this.style.setLayerZoomRange(k,c,_),this._update(!0)}setFilter(k,c,_={}){return this.style.setFilter(k,c,_),this._update(!0)}getFilter(k){return this.style.getFilter(k)}setPaintProperty(k,c,_,l={}){return this.style.setPaintProperty(k,c,_,l),this._update(!0)}getPaintProperty(k,c){return this.style.getPaintProperty(k,c)}setLayoutProperty(k,c,_,l={}){return this.style.setLayoutProperty(k,c,_,l),this._update(!0)}getLayoutProperty(k,c){return this.style.getLayoutProperty(k,c)}setLight(k,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(k,c),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(k,c){return this.style.setFeatureState(k,c),this._update()}removeFeatureState(k,c){return this.style.removeFeatureState(k,c),this._update()}getFeatureState(k){return this.style.getFeatureState(k)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let k=0,c=0;return this._container&&(k=this._container.clientWidth||400,c=this._container.clientHeight||300),[k,c]}_setupContainer(){const k=this._container;k.classList.add("maplibregl-map","mapboxgl-map");const c=this._canvasContainer=L.create("div","maplibregl-canvas-container mapboxgl-canvas-container",k);this._interactive&&c.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=L.create("canvas","maplibregl-canvas mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const _=this._containerDimensions();this._resizeCanvas(_[0],_[1],this.getPixelRatio());const l=this._controlContainer=L.create("div","maplibregl-control-container mapboxgl-control-container",k),h=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(d=>{h[d]=L.create("div",`maplibregl-ctrl-${d} mapboxgl-ctrl-${d}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const k=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=L.create("div","maplibregl-cooperative-gesture-screen",k);let c="Control",_=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(_=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map",c="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${_}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",l=>{l.key===c&&(this._metaPress=!0)}),document.addEventListener("keyup",l=>{l.key===c&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",l=>{this._onCooperativeGesture(l,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(k,c,_){this._canvas.width=_*k,this._canvas.height=_*c,this._canvas.style.width=`${k}px`,this._canvas.style.height=`${c}px`}_setupPainter(){const k=a.extend({},y.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._canvas.getContext("webgl",k)||this._canvas.getContext("experimental-webgl",k);c?(this.painter=new gi(c,this.transform),a.exported$1.testSupport(c)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(k){k.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:k}))}_contextRestored(k){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:k}))}_onMapScroll(k){if(k.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(k,c,_){return!c&&_<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(k){return this.style?(this._styleDirty=this._styleDirty||k,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(k){return this._update(),this._renderTaskQueue.add(k)}_cancelRenderFrame(k){this._renderTaskQueue.remove(k)}_render(k){let c,_=0;const l=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(c=l.createQueryEXT(),l.beginQueryEXT(l.TIME_ELAPSED_EXT,c),_=a.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(k),this._removed)return;let h=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const x=this.transform.zoom,b=a.exported.now();this.style.zoomHistory.update(x,b);const S=new a.EvaluationParameters(x,{now:b,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),M=S.crossFadingFactor();M===1&&M===this._crossFadingFactor||(h=!0,this._crossFadingFactor=M),this.style.update(S)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.load),this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||h)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const x=a.exported.now()-_;l.endQueryEXT(l.TIME_ELAPSED_EXT,c),setTimeout(()=>{const b=l.getQueryObjectEXT(c,l.QUERY_RESULT_EXT)/1e6;l.deleteQueryEXT(c),this.fire(new a.Event("gpu-timing-frame",{cpuTime:x,gpuTime:b}))},50)}if(this.listens("gpu-timing-layer")){const x=this.painter.collectGpuTimers();setTimeout(()=>{const b=this.painter.queryGpuTimers(x);this.fire(new a.Event("gpu-timing-layer",{layerTimes:b}))},50)}const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const k=this.painter.context.gl.getExtension("WEBGL_lose_context");k&&k.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),L.remove(this._canvasContainer),L.remove(this._controlContainer),this._cooperativeGestures&&L.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),a.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=a.exported.frame(k=>{a.PerformanceUtils.frame(k),this._frame=null,this._render(k)}))}_onWindowOnline(){this._update()}_onWindowResize(k){this._trackResize&&this.resize({originalEvent:k})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(k){this._showTileBoundaries!==k&&(this._showTileBoundaries=k,this._update())}get showPadding(){return!!this._showPadding}set showPadding(k){this._showPadding!==k&&(this._showPadding=k,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(k){this._showCollisionBoxes!==k&&(this._showCollisionBoxes=k,k?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(k){this._showOverdrawInspector!==k&&(this._showOverdrawInspector=k,this._update())}get repaint(){return!!this._repaint}set repaint(k){this._repaint!==k&&(this._repaint=k,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(k){this._vertices=k,this._update()}_setCacheLimits(k,c){a.setCacheLimits(k,c)}get version(){return"2.4.0"}},NavigationControl:class{constructor(k){this.options=a.extend({},sc,k),this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",c=>this._map.zoomIn({},{originalEvent:c})),L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",c=>this._map.zoomOut({},{originalEvent:c})),L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",c=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:c}):this._map.resetNorth({},{originalEvent:c})}),this._compassIcon=L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const k=this._map.getZoom(),c=k===this._map.getMaxZoom(),_=k===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const k=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=k}onAdd(k){return this._map=k,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new dr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){L.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(k,c){const _=L.create("button",k,this._container);return _.type="button",_.addEventListener("click",c),_}_setButtonTitle(k,c){const _=this._map._getUIString(`NavigationControl.${c}`);k.title=_,k.setAttribute("aria-label",_)}},GeolocateControl:class extends a.Evented{constructor(k){super(),this.options=a.extend({},$i,k),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(k){var c;return this._map=k,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,Uo!==void 0?c(Uo):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(_=>{Uo=_.state!=="denied",c(Uo)}):(Uo=!!window.navigator.geolocation,c(Uo)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),L.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Or=0,zs=!1}_isOutOfMapMaxBounds(k){const c=this._map.getMaxBounds(),_=k.coords;return c&&(_.longitude<c.getWest()||_.longitude>c.getEast()||_.latitude<c.getSouth()||_.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(k){if(this._map){if(this._isOutOfMapMaxBounds(k))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",k)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=k,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(k),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(k),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",k)),this._finish()}}_updateCamera(k){const c=new a.LngLat(k.coords.longitude,k.coords.latitude),_=k.coords.accuracy,l=this._map.getBearing(),h=a.extend({bearing:l},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(_),h,{geolocateSource:!0})}_updateMarker(k){if(k){const c=new a.LngLat(k.coords.longitude,k.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=k.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const k=this._map._container.clientHeight/2,c=this._map.unproject([0,k]),_=this._map.unproject([1,k]),l=c.distanceTo(_),h=Math.ceil(2*this._accuracy/l);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(k){if(this._map){if(this.options.trackUserLocation)if(k.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(k.code===3&&zs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",k)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(k){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=L.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",k===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new cn(this._dotElement),this._circleElement=L.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new cn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Or--,zs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let k;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Or++,Or>1?(k={maximumAge:6e5,timeout:0},zs=!0):(k=this.options.positionOptions,zs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,k)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ja,LogoControl:Sl,ScaleControl:class{constructor(k){this.options=a.extend({},ms,k),a.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Os(this._map,this._container,this.options)}onAdd(k){return this._map=k,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",k.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){L.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(k){this.options.unit=k,Os(this._map,this._container,this.options)}},FullscreenControl:class{constructor(k){this._fullscreen=!1,k&&k.container&&(k.container instanceof HTMLElement?this._container=k.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(k){return this._map=k,this._container||(this._container=this._map.getContainer()),this._controlContainer=L.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){L.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const k=this._fullscreenButton=L.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",k).setAttribute("aria-hidden","true"),k.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const k=this._getTitle();this._fullscreenButton.setAttribute("aria-label",k),this._fullscreenButton.title=k}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(k){this.options=k,a.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(k){return this._map=k,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=L.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){L.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends a.Evented{constructor(k){super(),this.options=a.extend(Object.create(Ct),k),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(k){return this._map&&this.remove(),this._map=k,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&L.remove(this._content),this._container&&(L.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(k){return this._lngLat=a.LngLat.convert(k),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(k){return this.setDOMContent(document.createTextNode(k))}setHTML(k){const c=document.createDocumentFragment(),_=document.createElement("body");let l;for(_.innerHTML=k;l=_.firstChild,l;)c.appendChild(l);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(k){return this.options.maxWidth=k,this._update(),this}setDOMContent(k){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=L.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(k),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(k){this._container&&this._container.classList.add(k)}removeClassName(k){this._container&&this._container.classList.remove(k)}setOffset(k){return this.options.offset=k,this._update(),this}toggleClassName(k){if(this._container)return this._container.classList.toggle(k)}_createCloseButton(){this.options.closeButton&&(this._closeButton=L.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(k){this._update(k.point)}_onMouseMove(k){this._update(k.point)}_onDrag(k){this._update(k.point)}_update(k){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=L.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=L.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(d=>this._container.classList.add(d)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ml(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!k))return;const c=this._pos=this._trackPointer&&k?k:this._map.project(this._lngLat);let _=this.options.anchor;const l=$a(this.options.offset);if(!_){const d=this._container.offsetWidth,x=this._container.offsetHeight;let b;b=c.y+l.bottom.y<x?["top"]:c.y>this._map.transform.height-x?["bottom"]:[],c.x<d/2?b.push("left"):c.x>this._map.transform.width-d/2&&b.push("right"),_=b.length===0?"bottom":b.join("-")}const h=c.add(l[_]).round();L.setTransform(this._container,`${Zt[_]} translate(${h.x}px,${h.y}px)`),Yt(this._container,_,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const k=this._container.querySelector(Fr);k&&k.focus()}_onClose(){this.remove()}},Marker:cn,Style:Se,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,AJAXError:a.AJAXError,config:a.config,CanvasSource:In,GeoJSONSource:fn,ImageSource:bt,RasterDEMTileSource:Et,RasterTileSource:mt,VectorTileSource:qe,VideoSource:Kt,prewarm:function(){or().acquire(vt)},clearPrewarmedResources:function(){const k=gr;k&&(k.isPreloaded()&&k.numActive()===1?(k.release(vt),gr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return er.workerCount},set workerCount(k){er.workerCount=k},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(k){a.config.MAX_PARALLEL_IMAGE_REQUESTS=k},clearStorage(k){a.clearTileCache(k)},workerUrl:"",addProtocol(k,c){a.config.REGISTERED_PROTOCOLS[k]=c},removeProtocol(k){delete a.config.REGISTERED_PROTOCOLS[k]}};return ss.extend(Fs,{isSafari:a.isSafari,getPerformanceMetrics:a.PerformanceUtils.getPerformanceMetrics}),Fs});var A=i;return A})})(cB);var fB=cB.exports;const wT=G_(fB),Fee=$3({__proto__:null,default:wT},[fB]),Nee="modulepreload",Uee=function(t){return"/"+t},yP={},dB=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=Uee(s),s in yP)return;yP[s]=!0;const A=s.endsWith(".css"),a=A?'[rel="stylesheet"]':"";if(!!r)for(let P=i.length-1;P>=0;P--){const I=i[P];if(I.href===s&&(!A||I.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const w=document.createElement("link");if(w.rel=A?"stylesheet":Nee,A||(w.as="script",w.crossOrigin=""),w.href=s,document.head.appendChild(w),A)return new Promise((P,I)=>{w.addEventListener("load",P),w.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const A=new Event("vite:preloadError",{cancelable:!0});if(A.payload=s,window.dispatchEvent(A),!A.defaultPrevented)throw s})},pB=At.createContext(null);function Vee(){var t;const e=(t=At.useContext(pB))===null||t===void 0?void 0:t.maps,n=At.useContext(jg);return At.useMemo(()=>({...e,current:n?.map}),[e,n])}function Gee(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function _u(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!_u(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!_u(t[i],e[i]))return!1;return!0}return!1}function jee(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function _P(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();_u(n,r)||e.setProjection(n)}function vP(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function xP(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const $ee=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function wP(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const A of $ee)A in s&&(i[A]=s[A])}return i||r});return{...t,layers:n}}const bP={version:8,sources:{},layers:[]},EP={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},kx={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},TP={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Hee=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Wee=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class N0{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[TP[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[EP[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[kx[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=N0.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const A=i._resizeObserver;A&&(A.disconnect(),A.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:a}=e;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):r._updateViewState(a,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=bP}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||Qee()||null,container:e,style:wP(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const P=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=P,n.gl)}const A=new this._MapClass(i);s.padding&&A.setPadding(s.padding),n.cursor&&(A.getCanvas().style.cursor=n.cursor),this._createShadowTransform(A);const a=A._render;A._render=P=>{this._inRender=!0,a.call(A,P),this._inRender=!1};const y=A._renderTaskQueue.run;A._renderTaskQueue.run=P=>{y.call(A._renderTaskQueue,P),this._onBeforeRepaint()},A.on("render",()=>this._onAfterRepaint());const w=A.fire;A.fire=this._fireEvent.bind(this,w),A.on("resize",()=>{this._renderTransform.resize(A.transform.width,A.transform.height)}),A.on("styledata",()=>{this._updateStyleComponents(this.props,{}),_P(A.transform,this._renderTransform)}),A.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const P in EP)A.on(P,this._onPointerEvent);for(const P in kx)A.on(P,this._onCameraEvent);for(const P in TP)A.on(P,this._onEvent);this._map=A}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n?.remove(),N0.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=jee(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:A,bearing:a}=i,y=r.isMoving();y&&(i.cameraElevationReference="sea");const w=xP(i,{...vP(r.transform),...e});if(y&&(i.cameraElevationReference="ground"),w&&n){const P=this._deferredEvents;P.move=!0,P.zoom||(P.zoom=s!==i.zoom),P.rotate||(P.rotate=a!==i.bearing),P.pitch||(P.pitch=A!==i.pitch)}return y||xP(r.transform,e),w}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of Hee)if(s in e&&!_u(e[s],n[s])){i=!0;const A=r[`set${s[0].toUpperCase()}${s.slice(1)}`];A?.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=bP,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(wP(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!_u(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!_u(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!_u(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let A=!1;for(const a of Wee){const y=(r=e[a])!==null&&r!==void 0?r:!0,w=(i=n[a])!==null&&i!==void 0?i:!0;_u(y,w)||(A=!0,y?s[a].enable(y):s[a].disable())}return A}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,A=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),y=a.length>0;!y&&A&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,y&&!A&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,A=typeof n=="string"?n:n.type;return A==="move"&&this._updateViewState(this.props,!1),A in kx&&(typeof n=="object"&&(n.viewState=vP(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{_P(this._renderTransform,n),e.transform=n}}}N0.savedMaps=[];function Qee(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const qee=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Zee(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const A=e.queryTerrainElevation(r,i);return e.transform=s,A},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const A=e.queryRenderedFeatures(r,i);return e.transform=s,A}};for(const r of Yee(e))!(r in n)&&!qee.includes(r)&&(n[r]=e[r].bind(e));return n}function Yee(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const Xee=typeof document<"u"?At.useLayoutEffect:At.useEffect,Kee=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function Jee(t,e){for(const r of Kee)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!1)}const jg=At.createContext(null);function gB(t,e,n){const r=At.useContext(pB),[i,s]=At.useState(null),A=At.useRef(),{current:a}=At.useRef({mapLib:null,map:null});At.useEffect(()=>{const P=t.mapLib;let I=!0,L;return Promise.resolve(P||n).then(U=>{if(!I)return;if(!U)throw new Error("Invalid mapLib");const W="Map"in U?U:U.default;if(!W.Map)throw new Error("Invalid mapLib");if(Jee(W,t),!W.supported||W.supported(t))t.reuseMaps&&(L=N0.reuse(t,A.current)),L||(L=new N0(W.Map,t,A.current)),a.map=Zee(L),a.mapLib=W,s(L),r?.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(U=>{const{onError:W}=t;W?W({type:"error",target:null,originalEvent:null,error:U}):console.error(U)}),()=>{I=!1,L&&(r?.onMapUnmount(t.id),t.reuseMaps?L.recycle():L.destroy())}},[]),Xee(()=>{i&&i.setProps(t)}),At.useImperativeHandle(e,()=>a.map,[i]);const y=At.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),w={height:"100%"};return At.createElement("div",{id:t.id,ref:A,style:y},i&&At.createElement(jg.Provider,{value:a},At.createElement("div",{"mapboxgl-children":"",style:w},t.children)))}const ete=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function sf(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!ete.test(r)?n[r]=`${i}px`:n[r]=i}}function tte(t,e){const{map:n,mapLib:r}=At.useContext(jg),i=At.useRef({props:t});i.current.props=t;const s=At.useMemo(()=>{let q=!1;At.Children.forEach(t.children,ne=>{ne&&(q=!0)});const ae={...t,element:q?document.createElement("div"):null},K=new r.Marker(ae);return K.setLngLat([t.longitude,t.latitude]),K.getElement().addEventListener("click",ne=>{var ie,fe;(fe=(ie=i.current.props).onClick)===null||fe===void 0||fe.call(ie,{type:"click",target:K,originalEvent:ne})}),K.on("dragstart",ne=>{var ie,fe;const ye=ne;ye.lngLat=s.getLngLat(),(fe=(ie=i.current.props).onDragStart)===null||fe===void 0||fe.call(ie,ye)}),K.on("drag",ne=>{var ie,fe;const ye=ne;ye.lngLat=s.getLngLat(),(fe=(ie=i.current.props).onDrag)===null||fe===void 0||fe.call(ie,ye)}),K.on("dragend",ne=>{var ie,fe;const ye=ne;ye.lngLat=s.getLngLat(),(fe=(ie=i.current.props).onDragEnd)===null||fe===void 0||fe.call(ie,ye)}),K},[]);At.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:A,latitude:a,offset:y,style:w,draggable:P=!1,popup:I=null,rotation:L=0,rotationAlignment:U="auto",pitchAlignment:W="auto"}=t;return At.useEffect(()=>{sf(s.getElement(),w)},[w]),At.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==A||s.getLngLat().lat!==a)&&s.setLngLat([A,a]),y&&!Gee(s.getOffset(),y)&&s.setOffset(y),s.isDraggable()!==P&&s.setDraggable(P),s.getRotation()!==L&&s.setRotation(L),s.getRotationAlignment()!==U&&s.setRotationAlignment(U),s.getPitchAlignment()!==W&&s.setPitchAlignment(W),s.getPopup()!==I&&s.setPopup(I),NE.createPortal(t.children,s.getElement())}At.memo(At.forwardRef(tte));function SP(t){return new Set(t?t.trim().split(/\s+/):[])}function nte(t,e){const{map:n,mapLib:r}=At.useContext(jg),i=At.useMemo(()=>document.createElement("div"),[]),s=At.useRef({props:t});s.current.props=t;const A=At.useMemo(()=>{const a={...t},y=new r.Popup(a);return y.setLngLat([t.longitude,t.latitude]),y.once("open",w=>{var P,I;(I=(P=s.current.props).onOpen)===null||I===void 0||I.call(P,w)}),y},[]);if(At.useEffect(()=>{const a=y=>{var w,P;(P=(w=s.current.props).onClose)===null||P===void 0||P.call(w,y)};return A.on("close",a),A.setDOMContent(i).addTo(n.getMap()),()=>{A.off("close",a),A.isOpen()&&A.remove()}},[]),At.useEffect(()=>{sf(A.getElement(),t.style)},[t.style]),At.useImperativeHandle(e,()=>A,[]),A.isOpen()&&((A.getLngLat().lng!==t.longitude||A.getLngLat().lat!==t.latitude)&&A.setLngLat([t.longitude,t.latitude]),t.offset&&!_u(A.options.offset,t.offset)&&A.setOffset(t.offset),(A.options.anchor!==t.anchor||A.options.maxWidth!==t.maxWidth)&&(A.options.anchor=t.anchor,A.setMaxWidth(t.maxWidth)),A.options.className!==t.className)){const a=SP(A.options.className),y=SP(t.className);for(const w of a)y.has(w)||A.removeClassName(w);for(const w of y)a.has(w)||A.addClassName(w);A.options.className=t.className}return NE.createPortal(t.children,i)}At.memo(At.forwardRef(nte));function $g(t,e,n,r){const i=At.useContext(jg),s=At.useMemo(()=>t(i),[]);return At.useEffect(()=>{const A=r||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,y=typeof n=="function"?n:typeof e=="function"?e:null,{map:w}=i;return w.hasControl(s)||(w.addControl(s,A?.position),a&&a(i)),()=>{y&&y(i),w.hasControl(s)&&w.removeControl(s)}},[]),s}function rte(t){const e=$g(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return At.useEffect(()=>{sf(e._container,t.style)},[t.style]),null}At.memo(rte);function ite(t){const e=$g(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return At.useEffect(()=>{sf(e._controlContainer,t.style)},[t.style]),null}At.memo(ite);function ste(t,e){const n=At.useRef({props:t}),r=$g(({mapLib:i})=>{const s=new i.GeolocateControl(t),A=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||A(a)},s.on("geolocate",a=>{var y,w;(w=(y=n.current.props).onGeolocate)===null||w===void 0||w.call(y,a)}),s.on("error",a=>{var y,w;(w=(y=n.current.props).onError)===null||w===void 0||w.call(y,a)}),s.on("outofmaxbounds",a=>{var y,w;(w=(y=n.current.props).onOutOfMaxBounds)===null||w===void 0||w.call(y,a)}),s.on("trackuserlocationstart",a=>{var y,w;(w=(y=n.current.props).onTrackUserLocationStart)===null||w===void 0||w.call(y,a)}),s.on("trackuserlocationend",a=>{var y,w;(w=(y=n.current.props).onTrackUserLocationEnd)===null||w===void 0||w.call(y,a)}),s},{position:t.position});return n.current.props=t,At.useImperativeHandle(e,()=>r,[]),At.useEffect(()=>{sf(r._container,t.style)},[t.style]),null}At.memo(At.forwardRef(ste));function ote(t){const e=$g(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return At.useEffect(()=>{sf(e._container,t.style)},[t.style]),null}At.memo(ote);function ate(t){const e=$g(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=At.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),At.useEffect(()=>{sf(e._container,i)},[i]),null}At.memo(ate);function lte(){return Vee()}const Ate=dB(()=>import("./__vite-optional-peer-dep_mapbox-gl_react-map-gl-b25bb000.js"),[]),ute=(()=>At.forwardRef(function(e,n){return gB(e,n,Ate)}))(),cte=8,hte="Positron",fte={},dte={carto:{type:"vector",url:"https://tiles.basemaps.cartocdn.com/vector/carto.streets/v1/tiles.json"}},pte="https://tiles.basemaps.cartocdn.com/gl/positron-gl-style/sprite",gte="https://tiles.basemaps.cartocdn.com/fonts/{fontstack}/{range}.pbf",mte=[{id:"waterway_label",type:"symbol",source:"carto","source-layer":"waterway",filter:["all",["has","name"],["==","class","river"]],layout:{"text-field":"{name_en}","text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-placement":"line","symbol-spacing":100,"symbol-avoid-edges":!1,"text-size":27,"text-padding":2,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-offset":[0,-.2],"text-letter-spacing":0,"text-keep-upright":!0},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"watername_ocean",type:"symbol",source:"carto","source-layer":"water_name",minzoom:0,maxzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","ocean"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":27,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":0}},{id:"watername_sea",type:"symbol",source:"carto","source-layer":"water_name",minzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","sea"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":27,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":0}},{id:"watername_lake",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","Point"],["==","class","lake"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"point","text-size":27,"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto"},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":1}},{id:"watername_lake_line",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","LineString"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"line","text-size":27,"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-spacing":350,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-line-height":1.2},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":1}},{id:"place_city_r6",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",6]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,12],[9,13],[10,14],[13,17],[14,20]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_r5",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",0],["<=","rank",5]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,14],[10,16],[13,19],[14,22]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",["!has","capital"],["!in","class","country","state"],[">=","rank",0],["<=","rank",7]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2]},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_capital_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",[">","capital",0]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"poi_stadium",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["in","class","stadium","cemetery","attraction"],["<=","rank",3]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"poi_park",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["==","class","park"]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"roadname_minor",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:16,filter:["all",["in","class","minor","service"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":9,"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_sec",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:15,filter:["all",["in","class","secondary","tertiary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,9],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_pri",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:14,filter:["all",["in","class","primary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[14,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_major",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:13,filter:["all",["in","class","trunk","motorway"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[13,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}}],yte="voyager",_te="Carto",vte={version:cte,name:hte,metadata:fte,sources:dte,sprite:pte,glyphs:gte,layers:mte,id:yte,owner:_te};function Z1(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function xte(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function bT(t){let e,n,r;t.length!==2?(e=Z1,n=(a,y)=>Z1(t(a),y),r=(a,y)=>t(a)-y):(e=t===Z1||t===xte?t:wte,n=t,r=t);function i(a,y,w=0,P=a.length){if(w<P){if(e(y,y)!==0)return P;do{const I=w+P>>>1;n(a[I],y)<0?w=I+1:P=I}while(w<P)}return w}function s(a,y,w=0,P=a.length){if(w<P){if(e(y,y)!==0)return P;do{const I=w+P>>>1;n(a[I],y)<=0?w=I+1:P=I}while(w<P)}return w}function A(a,y,w=0,P=a.length){const I=i(a,y,w,P-1);return I>w&&r(a[I-1],y)>-r(a[I],y)?I-1:I}return{left:i,center:A,right:s}}function wte(){return 0}function bte(t){return t===null?NaN:+t}const Ete=bT(Z1),Tte=Ete.right;bT(bte).center;const mB=Tte;function MP(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of t)(s=e(s,++i,t))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}const Ste=Math.sqrt(50),Mte=Math.sqrt(10),Cte=Math.sqrt(2);function t_(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),A=s>=Ste?10:s>=Mte?5:s>=Cte?2:1;let a,y,w;return i<0?(w=Math.pow(10,-i)/A,a=Math.round(t*w),y=Math.round(e*w),a/w<t&&++a,y/w>e&&--y,w=-w):(w=Math.pow(10,i)*A,a=Math.round(t/w),y=Math.round(e/w),a*w<t&&++a,y*w>e&&--y),y<a&&.5<=n&&n<2?t_(t,e,n*2):[a,y,w]}function qb(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,A]=r?t_(e,t,n):t_(t,e,n);if(!(s>=i))return[];const a=s-i+1,y=new Array(a);if(r)if(A<0)for(let w=0;w<a;++w)y[w]=(s-w)/-A;else for(let w=0;w<a;++w)y[w]=(s-w)*A;else if(A<0)for(let w=0;w<a;++w)y[w]=(i+w)/-A;else for(let w=0;w<a;++w)y[w]=(i+w)*A;return y}function Zb(t,e,n){return e=+e,t=+t,n=+n,t_(t,e,n)[2]}function Yb(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Zb(e,t,n):Zb(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function Pte(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Ite(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var kte={value:()=>{}};function yB(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Y1(n)}function Y1(t){this._=t}function Lte(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Y1.prototype=yB.prototype={constructor:Y1,on:function(t,e){var n=this._,r=Lte(t+"",n),i,s=-1,A=r.length;if(arguments.length<2){for(;++s<A;)if((i=(t=r[s]).type)&&(i=Dte(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<A;)if(i=(t=r[s]).type)n[i]=CP(n[i],t.name,e);else if(e==null)for(i in n)n[i]=CP(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Y1(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function Dte(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function CP(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=kte,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Xb="http://www.w3.org/1999/xhtml";const PP={svg:"http://www.w3.org/2000/svg",xhtml:Xb,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function f2(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),PP.hasOwnProperty(e)?{space:PP[e],local:t}:t}function Rte(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Xb&&e.documentElement.namespaceURI===Xb?e.createElement(t):e.createElementNS(n,t)}}function Bte(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function _B(t){var e=f2(t);return(e.local?Bte:Rte)(e)}function zte(){}function ET(t){return t==null?zte:function(){return this.querySelector(t)}}function Ote(t){typeof t!="function"&&(t=ET(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],A=s.length,a=r[i]=new Array(A),y,w,P=0;P<A;++P)(y=s[P])&&(w=t.call(y,y.__data__,P,s))&&("__data__"in y&&(w.__data__=y.__data__),a[P]=w);return new Mo(r,this._parents)}function vB(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Fte(){return[]}function xB(t){return t==null?Fte:function(){return this.querySelectorAll(t)}}function Nte(t){return function(){return vB(t.apply(this,arguments))}}function Ute(t){typeof t=="function"?t=Nte(t):t=xB(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var A=e[s],a=A.length,y,w=0;w<a;++w)(y=A[w])&&(r.push(t.call(y,y.__data__,w,A)),i.push(y));return new Mo(r,i)}function wB(t){return function(){return this.matches(t)}}function bB(t){return function(e){return e.matches(t)}}var Vte=Array.prototype.find;function Gte(t){return function(){return Vte.call(this.children,t)}}function jte(){return this.firstElementChild}function $te(t){return this.select(t==null?jte:Gte(typeof t=="function"?t:bB(t)))}var Hte=Array.prototype.filter;function Wte(){return Array.from(this.children)}function Qte(t){return function(){return Hte.call(this.children,t)}}function qte(t){return this.selectAll(t==null?Wte:Qte(typeof t=="function"?t:bB(t)))}function Zte(t){typeof t!="function"&&(t=wB(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],A=s.length,a=r[i]=[],y,w=0;w<A;++w)(y=s[w])&&t.call(y,y.__data__,w,s)&&a.push(y);return new Mo(r,this._parents)}function EB(t){return new Array(t.length)}function Yte(){return new Mo(this._enter||this._groups.map(EB),this._parents)}function n_(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}n_.prototype={constructor:n_,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Xte(t){return function(){return t}}function Kte(t,e,n,r,i,s){for(var A=0,a,y=e.length,w=s.length;A<w;++A)(a=e[A])?(a.__data__=s[A],r[A]=a):n[A]=new n_(t,s[A]);for(;A<y;++A)(a=e[A])&&(i[A]=a)}function Jte(t,e,n,r,i,s,A){var a,y,w=new Map,P=e.length,I=s.length,L=new Array(P),U;for(a=0;a<P;++a)(y=e[a])&&(L[a]=U=A.call(y,y.__data__,a,e)+"",w.has(U)?i[a]=y:w.set(U,y));for(a=0;a<I;++a)U=A.call(t,s[a],a,s)+"",(y=w.get(U))?(r[a]=y,y.__data__=s[a],w.delete(U)):n[a]=new n_(t,s[a]);for(a=0;a<P;++a)(y=e[a])&&w.get(L[a])===y&&(i[a]=y)}function ene(t){return t.__data__}function tne(t,e){if(!arguments.length)return Array.from(this,ene);var n=e?Jte:Kte,r=this._parents,i=this._groups;typeof t!="function"&&(t=Xte(t));for(var s=i.length,A=new Array(s),a=new Array(s),y=new Array(s),w=0;w<s;++w){var P=r[w],I=i[w],L=I.length,U=nne(t.call(P,P&&P.__data__,w,r)),W=U.length,q=a[w]=new Array(W),ae=A[w]=new Array(W),K=y[w]=new Array(L);n(P,I,q,ae,K,U,e);for(var ne=0,ie=0,fe,ye;ne<W;++ne)if(fe=q[ne]){for(ne>=ie&&(ie=ne+1);!(ye=ae[ie])&&++ie<W;);fe._next=ye||null}}return A=new Mo(A,r),A._enter=a,A._exit=y,A}function nne(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function rne(){return new Mo(this._exit||this._groups.map(EB),this._parents)}function ine(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function sne(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,A=Math.min(i,s),a=new Array(i),y=0;y<A;++y)for(var w=n[y],P=r[y],I=w.length,L=a[y]=new Array(I),U,W=0;W<I;++W)(U=w[W]||P[W])&&(L[W]=U);for(;y<i;++y)a[y]=n[y];return new Mo(a,this._parents)}function one(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],A;--i>=0;)(A=r[i])&&(s&&A.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(A,s),s=A);return this}function ane(t){t||(t=lne);function e(I,L){return I&&L?t(I.__data__,L.__data__):!I-!L}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var A=n[s],a=A.length,y=i[s]=new Array(a),w,P=0;P<a;++P)(w=A[P])&&(y[P]=w);y.sort(e)}return new Mo(i,this._parents).order()}function lne(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ane(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function une(){return Array.from(this)}function cne(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var A=r[i];if(A)return A}return null}function hne(){let t=0;for(const e of this)++t;return t}function fne(){return!this.node()}function dne(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,A=i.length,a;s<A;++s)(a=i[s])&&t.call(a,a.__data__,s,i);return this}function pne(t){return function(){this.removeAttribute(t)}}function gne(t){return function(){this.removeAttributeNS(t.space,t.local)}}function mne(t,e){return function(){this.setAttribute(t,e)}}function yne(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function _ne(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function vne(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function xne(t,e){var n=f2(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?gne:pne:typeof e=="function"?n.local?vne:_ne:n.local?yne:mne)(n,e))}function TB(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function wne(t){return function(){this.style.removeProperty(t)}}function bne(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Ene(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Tne(t,e,n){return arguments.length>1?this.each((e==null?wne:typeof e=="function"?Ene:bne)(t,e,n??"")):U0(this.node(),t)}function U0(t,e){return t.style.getPropertyValue(e)||TB(t).getComputedStyle(t,null).getPropertyValue(e)}function Sne(t){return function(){delete this[t]}}function Mne(t,e){return function(){this[t]=e}}function Cne(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Pne(t,e){return arguments.length>1?this.each((e==null?Sne:typeof e=="function"?Cne:Mne)(t,e)):this.node()[t]}function SB(t){return t.trim().split(/^|\s+/)}function TT(t){return t.classList||new MB(t)}function MB(t){this._node=t,this._names=SB(t.getAttribute("class")||"")}MB.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function CB(t,e){for(var n=TT(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function PB(t,e){for(var n=TT(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Ine(t){return function(){CB(this,t)}}function kne(t){return function(){PB(this,t)}}function Lne(t,e){return function(){(e.apply(this,arguments)?CB:PB)(this,t)}}function Dne(t,e){var n=SB(t+"");if(arguments.length<2){for(var r=TT(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Lne:e?Ine:kne)(n,e))}function Rne(){this.textContent=""}function Bne(t){return function(){this.textContent=t}}function zne(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function One(t){return arguments.length?this.each(t==null?Rne:(typeof t=="function"?zne:Bne)(t)):this.node().textContent}function Fne(){this.innerHTML=""}function Nne(t){return function(){this.innerHTML=t}}function Une(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Vne(t){return arguments.length?this.each(t==null?Fne:(typeof t=="function"?Une:Nne)(t)):this.node().innerHTML}function Gne(){this.nextSibling&&this.parentNode.appendChild(this)}function jne(){return this.each(Gne)}function $ne(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Hne(){return this.each($ne)}function Wne(t){var e=typeof t=="function"?t:_B(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Qne(){return null}function qne(t,e){var n=typeof t=="function"?t:_B(t),r=e==null?Qne:typeof e=="function"?e:ET(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Zne(){var t=this.parentNode;t&&t.removeChild(this)}function Yne(){return this.each(Zne)}function Xne(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Kne(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Jne(t){return this.select(t?Kne:Xne)}function ere(t){return arguments.length?this.property("__data__",t):this.node().__data__}function tre(t){return function(e){t.call(this,e,this.__data__)}}function nre(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function rre(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function ire(t,e,n){return function(){var r=this.__on,i,s=tre(e);if(r){for(var A=0,a=r.length;A<a;++A)if((i=r[A]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function sre(t,e,n){var r=nre(t+""),i,s=r.length,A;if(arguments.length<2){var a=this.node().__on;if(a){for(var y=0,w=a.length,P;y<w;++y)for(i=0,P=a[y];i<s;++i)if((A=r[i]).type===P.type&&A.name===P.name)return P.value}return}for(a=e?ire:rre,i=0;i<s;++i)this.each(a(r[i],e,n));return this}function IB(t,e,n){var r=TB(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ore(t,e){return function(){return IB(this,t,e)}}function are(t,e){return function(){return IB(this,t,e.apply(this,arguments))}}function lre(t,e){return this.each((typeof e=="function"?are:ore)(t,e))}function*Are(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,A;i<s;++i)(A=r[i])&&(yield A)}var ST=[null];function Mo(t,e){this._groups=t,this._parents=e}function Hg(){return new Mo([[document.documentElement]],ST)}function ure(){return this}Mo.prototype=Hg.prototype={constructor:Mo,select:Ote,selectAll:Ute,selectChild:$te,selectChildren:qte,filter:Zte,data:tne,enter:Yte,exit:rne,join:ine,merge:sne,selection:ure,order:one,sort:ane,call:Ane,nodes:une,node:cne,size:hne,empty:fne,each:dne,attr:xne,style:Tne,property:Pne,classed:Dne,text:One,html:Vne,raise:jne,lower:Hne,append:Wne,insert:qne,remove:Yne,clone:Jne,datum:ere,on:sre,dispatch:lre,[Symbol.iterator]:Are};function ya(t){return typeof t=="string"?new Mo([[document.querySelector(t)]],[document.documentElement]):new Mo([[t]],ST)}function cre(t){return typeof t=="string"?new Mo([document.querySelectorAll(t)],[document.documentElement]):new Mo([vB(t)],ST)}function Wg(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function d2(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function of(){}var rg=.7,r_=1/rg,y0="\\s*([+-]?\\d+)\\s*",ig="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",LA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hre=/^#([0-9a-f]{3,8})$/,fre=new RegExp(`^rgb\\(${y0},${y0},${y0}\\)$`),dre=new RegExp(`^rgb\\(${LA},${LA},${LA}\\)$`),pre=new RegExp(`^rgba\\(${y0},${y0},${y0},${ig}\\)$`),gre=new RegExp(`^rgba\\(${LA},${LA},${LA},${ig}\\)$`),mre=new RegExp(`^hsl\\(${ig},${LA},${LA}\\)$`),yre=new RegExp(`^hsla\\(${ig},${LA},${LA},${ig}\\)$`),IP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Wg(of,Gh,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:kP,formatHex:kP,formatHex8:_re,formatHsl:vre,formatRgb:LP,toString:LP});function kP(){return this.rgb().formatHex()}function _re(){return this.rgb().formatHex8()}function vre(){return LB(this).formatHsl()}function LP(){return this.rgb().formatRgb()}function Gh(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=hre.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?DP(e):n===3?new no(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?t1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?t1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=fre.exec(t))?new no(e[1],e[2],e[3],1):(e=dre.exec(t))?new no(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=pre.exec(t))?t1(e[1],e[2],e[3],e[4]):(e=gre.exec(t))?t1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=mre.exec(t))?zP(e[1],e[2]/100,e[3]/100,1):(e=yre.exec(t))?zP(e[1],e[2]/100,e[3]/100,e[4]):IP.hasOwnProperty(t)?DP(IP[t]):t==="transparent"?new no(NaN,NaN,NaN,0):null}function DP(t){return new no(t>>16&255,t>>8&255,t&255,1)}function t1(t,e,n,r){return r<=0&&(t=e=n=NaN),new no(t,e,n,r)}function kB(t){return t instanceof of||(t=Gh(t)),t?(t=t.rgb(),new no(t.r,t.g,t.b,t.opacity)):new no}function sg(t,e,n,r){return arguments.length===1?kB(t):new no(t,e,n,r??1)}function no(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Wg(no,sg,d2(of,{brighter(t){return t=t==null?r_:Math.pow(r_,t),new no(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?rg:Math.pow(rg,t),new no(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new no(Ch(this.r),Ch(this.g),Ch(this.b),i_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:RP,formatHex:RP,formatHex8:xre,formatRgb:BP,toString:BP}));function RP(){return`#${Eh(this.r)}${Eh(this.g)}${Eh(this.b)}`}function xre(){return`#${Eh(this.r)}${Eh(this.g)}${Eh(this.b)}${Eh((isNaN(this.opacity)?1:this.opacity)*255)}`}function BP(){const t=i_(this.opacity);return`${t===1?"rgb(":"rgba("}${Ch(this.r)}, ${Ch(this.g)}, ${Ch(this.b)}${t===1?")":`, ${t})`}`}function i_(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ch(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Eh(t){return t=Ch(t),(t<16?"0":"")+t.toString(16)}function zP(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Fl(t,e,n,r)}function LB(t){if(t instanceof Fl)return new Fl(t.h,t.s,t.l,t.opacity);if(t instanceof of||(t=Gh(t)),!t)return new Fl;if(t instanceof Fl)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),A=NaN,a=s-i,y=(s+i)/2;return a?(e===s?A=(n-r)/a+(n<r)*6:n===s?A=(r-e)/a+2:A=(e-n)/a+4,a/=y<.5?s+i:2-s-i,A*=60):a=y>0&&y<1?0:A,new Fl(A,a,y,t.opacity)}function wre(t,e,n,r){return arguments.length===1?LB(t):new Fl(t,e,n,r??1)}function Fl(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Wg(Fl,wre,d2(of,{brighter(t){return t=t==null?r_:Math.pow(r_,t),new Fl(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?rg:Math.pow(rg,t),new Fl(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new no(Lx(t>=240?t-240:t+120,i,r),Lx(t,i,r),Lx(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Fl(OP(this.h),n1(this.s),n1(this.l),i_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=i_(this.opacity);return`${t===1?"hsl(":"hsla("}${OP(this.h)}, ${n1(this.s)*100}%, ${n1(this.l)*100}%${t===1?")":`, ${t})`}`}}));function OP(t){return t=(t||0)%360,t<0?t+360:t}function n1(t){return Math.max(0,Math.min(1,t||0))}function Lx(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const bre=Math.PI/180,Ere=180/Math.PI,s_=18,DB=.96422,RB=1,BB=.82521,zB=4/29,_0=6/29,OB=3*_0*_0,Tre=_0*_0*_0;function FB(t){if(t instanceof DA)return new DA(t.l,t.a,t.b,t.opacity);if(t instanceof MA)return UB(t);t instanceof no||(t=kB(t));var e=zx(t.r),n=zx(t.g),r=zx(t.b),i=Dx((.2225045*e+.7168786*n+.0606169*r)/RB),s,A;return e===n&&n===r?s=A=i:(s=Dx((.4360747*e+.3850649*n+.1430804*r)/DB),A=Dx((.0139322*e+.0971045*n+.7141733*r)/BB)),new DA(116*i-16,500*(s-i),200*(i-A),t.opacity)}function Sre(t,e,n,r){return arguments.length===1?FB(t):new DA(t,e,n,r??1)}function DA(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}Wg(DA,Sre,d2(of,{brighter(t){return new DA(this.l+s_*(t??1),this.a,this.b,this.opacity)},darker(t){return new DA(this.l-s_*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=DB*Rx(e),t=RB*Rx(t),n=BB*Rx(n),new no(Bx(3.1338561*e-1.6168667*t-.4906146*n),Bx(-.9787684*e+1.9161415*t+.033454*n),Bx(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function Dx(t){return t>Tre?Math.pow(t,1/3):t/OB+zB}function Rx(t){return t>_0?t*t*t:OB*(t-zB)}function Bx(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function zx(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function NB(t){if(t instanceof MA)return new MA(t.h,t.c,t.l,t.opacity);if(t instanceof DA||(t=FB(t)),t.a===0&&t.b===0)return new MA(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Ere;return new MA(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function FP(t,e,n,r){return arguments.length===1?NB(t):new MA(n,e,t,r??1)}function Mre(t,e,n,r){return arguments.length===1?NB(t):new MA(t,e,n,r??1)}function MA(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function UB(t){if(isNaN(t.h))return new DA(t.l,0,0,t.opacity);var e=t.h*bre;return new DA(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Wg(MA,Mre,d2(of,{brighter(t){return new MA(this.h,this.c,this.l+s_*(t??1),this.opacity)},darker(t){return new MA(this.h,this.c,this.l-s_*(t??1),this.opacity)},rgb(){return UB(this).rgb()}}));function Cre(t,e,n,r,i){var s=t*t,A=s*t;return((1-3*t+3*s-A)*e+(4-6*s+3*A)*n+(1+3*t+3*s-3*A)*r+A*i)/6}function Pre(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],s=t[r+1],A=r>0?t[r-1]:2*i-s,a=r<e-1?t[r+2]:2*s-i;return Cre((n-r/e)*e,A,i,s,a)}}const MT=t=>()=>t;function Ire(t,e){return function(n){return t+n*e}}function kre(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Lre(t){return(t=+t)==1?VB:function(e,n){return n-e?kre(e,n,t):MT(isNaN(e)?n:e)}}function VB(t,e){var n=e-t;return n?Ire(t,n):MT(isNaN(t)?e:t)}const o_=function t(e){var n=Lre(e);function r(i,s){var A=n((i=sg(i)).r,(s=sg(s)).r),a=n(i.g,s.g),y=n(i.b,s.b),w=VB(i.opacity,s.opacity);return function(P){return i.r=A(P),i.g=a(P),i.b=y(P),i.opacity=w(P),i+""}}return r.gamma=t,r}(1);function Dre(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),s=new Array(n),A,a;for(A=0;A<n;++A)a=sg(e[A]),r[A]=a.r||0,i[A]=a.g||0,s[A]=a.b||0;return r=t(r),i=t(i),s=t(s),a.opacity=1,function(y){return a.r=r(y),a.g=i(y),a.b=s(y),a+""}}}var Rre=Dre(Pre);function Bre(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function zre(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Ore(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),A;for(A=0;A<r;++A)i[A]=CT(t[A],e[A]);for(;A<n;++A)s[A]=e[A];return function(a){for(A=0;A<r;++A)s[A]=i[A](a);return s}}function Fre(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function zl(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Nre(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=CT(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var Kb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ox=new RegExp(Kb.source,"g");function Ure(t){return function(){return t}}function Vre(t){return function(e){return t(e)+""}}function GB(t,e){var n=Kb.lastIndex=Ox.lastIndex=0,r,i,s,A=-1,a=[],y=[];for(t=t+"",e=e+"";(r=Kb.exec(t))&&(i=Ox.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[A]?a[A]+=s:a[++A]=s),(r=r[0])===(i=i[0])?a[A]?a[A]+=i:a[++A]=i:(a[++A]=null,y.push({i:A,x:zl(r,i)})),n=Ox.lastIndex;return n<e.length&&(s=e.slice(n),a[A]?a[A]+=s:a[++A]=s),a.length<2?y[0]?Vre(y[0].x):Ure(e):(e=y.length,function(w){for(var P=0,I;P<e;++P)a[(I=y[P]).i]=I.x(w);return a.join("")})}function CT(t,e){var n=typeof e,r;return e==null||n==="boolean"?MT(e):(n==="number"?zl:n==="string"?(r=Gh(e))?(e=r,o_):GB:e instanceof Gh?o_:e instanceof Date?Fre:zre(e)?Bre:Array.isArray(e)?Ore:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Nre:zl)(t,e)}function Gre(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var NP=180/Math.PI,Jb={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function jB(t,e,n,r,i,s){var A,a,y;return(A=Math.sqrt(t*t+e*e))&&(t/=A,e/=A),(y=t*n+e*r)&&(n-=t*y,r-=e*y),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,y/=a),t*r<e*n&&(t=-t,e=-e,y=-y,A=-A),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*NP,skewX:Math.atan(y)*NP,scaleX:A,scaleY:a}}var r1;function jre(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Jb:jB(e.a,e.b,e.c,e.d,e.e,e.f)}function $re(t){return t==null||(r1||(r1=document.createElementNS("http://www.w3.org/2000/svg","g")),r1.setAttribute("transform",t),!(t=r1.transform.baseVal.consolidate()))?Jb:(t=t.matrix,jB(t.a,t.b,t.c,t.d,t.e,t.f))}function $B(t,e,n,r){function i(w){return w.length?w.pop()+" ":""}function s(w,P,I,L,U,W){if(w!==I||P!==L){var q=U.push("translate(",null,e,null,n);W.push({i:q-4,x:zl(w,I)},{i:q-2,x:zl(P,L)})}else(I||L)&&U.push("translate("+I+e+L+n)}function A(w,P,I,L){w!==P?(w-P>180?P+=360:P-w>180&&(w+=360),L.push({i:I.push(i(I)+"rotate(",null,r)-2,x:zl(w,P)})):P&&I.push(i(I)+"rotate("+P+r)}function a(w,P,I,L){w!==P?L.push({i:I.push(i(I)+"skewX(",null,r)-2,x:zl(w,P)}):P&&I.push(i(I)+"skewX("+P+r)}function y(w,P,I,L,U,W){if(w!==I||P!==L){var q=U.push(i(U)+"scale(",null,",",null,")");W.push({i:q-4,x:zl(w,I)},{i:q-2,x:zl(P,L)})}else(I!==1||L!==1)&&U.push(i(U)+"scale("+I+","+L+")")}return function(w,P){var I=[],L=[];return w=t(w),P=t(P),s(w.translateX,w.translateY,P.translateX,P.translateY,I,L),A(w.rotate,P.rotate,I,L),a(w.skewX,P.skewX,I,L),y(w.scaleX,w.scaleY,P.scaleX,P.scaleY,I,L),w=P=null,function(U){for(var W=-1,q=L.length,ae;++W<q;)I[(ae=L[W]).i]=ae.x(U);return I.join("")}}}var Hre=$B(jre,"px, ","px)","deg)"),Wre=$B($re,", ",")",")");function UP(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}var V0=0,lp=0,Vd=0,HB=1e3,a_,Ap,l_=0,jh=0,p2=0,og=typeof performance=="object"&&performance.now?performance:Date,WB=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function PT(){return jh||(WB(Qre),jh=og.now()+p2)}function Qre(){jh=0}function A_(){this._call=this._time=this._next=null}A_.prototype=QB.prototype={constructor:A_,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?PT():+n)+(e==null?0:+e),!this._next&&Ap!==this&&(Ap?Ap._next=this:a_=this,Ap=this),this._call=t,this._time=n,e3()},stop:function(){this._call&&(this._call=null,this._time=1/0,e3())}};function QB(t,e,n){var r=new A_;return r.restart(t,e,n),r}function qre(){PT(),++V0;for(var t=a_,e;t;)(e=jh-t._time)>=0&&t._call.call(void 0,e),t=t._next;--V0}function VP(){jh=(l_=og.now())+p2,V0=lp=0;try{qre()}finally{V0=0,Yre(),jh=0}}function Zre(){var t=og.now(),e=t-l_;e>HB&&(p2-=e,l_=t)}function Yre(){for(var t,e=a_,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:a_=n);Ap=t,e3(r)}function e3(t){if(!V0){lp&&(lp=clearTimeout(lp));var e=t-jh;e>24?(t<1/0&&(lp=setTimeout(VP,t-og.now()-p2)),Vd&&(Vd=clearInterval(Vd))):(Vd||(l_=og.now(),Vd=setInterval(Zre,HB)),V0=1,WB(VP))}}function GP(t,e,n){var r=new A_;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Xre=yB("start","end","cancel","interrupt"),Kre=[],qB=0,jP=1,t3=2,X1=3,$P=4,n3=5,K1=6;function g2(t,e,n,r,i,s){var A=t.__transition;if(!A)t.__transition={};else if(n in A)return;Jre(t,n,{name:e,index:r,group:i,on:Xre,tween:Kre,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:qB})}function IT(t,e){var n=Jl(t,e);if(n.state>qB)throw new Error("too late; already scheduled");return n}function OA(t,e){var n=Jl(t,e);if(n.state>X1)throw new Error("too late; already running");return n}function Jl(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Jre(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=QB(s,0,n.time);function s(w){n.state=jP,n.timer.restart(A,n.delay,n.time),n.delay<=w&&A(w-n.delay)}function A(w){var P,I,L,U;if(n.state!==jP)return y();for(P in r)if(U=r[P],U.name===n.name){if(U.state===X1)return GP(A);U.state===$P?(U.state=K1,U.timer.stop(),U.on.call("interrupt",t,t.__data__,U.index,U.group),delete r[P]):+P<e&&(U.state=K1,U.timer.stop(),U.on.call("cancel",t,t.__data__,U.index,U.group),delete r[P])}if(GP(function(){n.state===X1&&(n.state=$P,n.timer.restart(a,n.delay,n.time),a(w))}),n.state=t3,n.on.call("start",t,t.__data__,n.index,n.group),n.state===t3){for(n.state=X1,i=new Array(L=n.tween.length),P=0,I=-1;P<L;++P)(U=n.tween[P].value.call(t,t.__data__,n.index,n.group))&&(i[++I]=U);i.length=I+1}}function a(w){for(var P=w<n.duration?n.ease.call(null,w/n.duration):(n.timer.restart(y),n.state=n3,1),I=-1,L=i.length;++I<L;)i[I].call(t,P);n.state===n3&&(n.on.call("end",t,t.__data__,n.index,n.group),y())}function y(){n.state=K1,n.timer.stop(),delete r[e];for(var w in r)return;delete t.__transition}}function eie(t,e){var n=t.__transition,r,i,s=!0,A;if(n){e=e==null?null:e+"";for(A in n){if((r=n[A]).name!==e){s=!1;continue}i=r.state>t3&&r.state<n3,r.state=K1,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[A]}s&&delete t.__transition}}function tie(t){return this.each(function(){eie(this,t)})}function nie(t,e){var n,r;return function(){var i=OA(this,t),s=i.tween;if(s!==n){r=n=s;for(var A=0,a=r.length;A<a;++A)if(r[A].name===e){r=r.slice(),r.splice(A,1);break}}i.tween=r}}function rie(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=OA(this,t),A=s.tween;if(A!==r){i=(r=A).slice();for(var a={name:e,value:n},y=0,w=i.length;y<w;++y)if(i[y].name===e){i[y]=a;break}y===w&&i.push(a)}s.tween=i}}function iie(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Jl(this.node(),n).tween,i=0,s=r.length,A;i<s;++i)if((A=r[i]).name===t)return A.value;return null}return this.each((e==null?nie:rie)(n,t,e))}function kT(t,e,n){var r=t._id;return t.each(function(){var i=OA(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Jl(i,r).value[e]}}function ZB(t,e){var n;return(typeof e=="number"?zl:e instanceof Gh?o_:(n=Gh(e))?(e=n,o_):GB)(t,e)}function sie(t){return function(){this.removeAttribute(t)}}function oie(t){return function(){this.removeAttributeNS(t.space,t.local)}}function aie(t,e,n){var r,i=n+"",s;return function(){var A=this.getAttribute(t);return A===i?null:A===r?s:s=e(r=A,n)}}function lie(t,e,n){var r,i=n+"",s;return function(){var A=this.getAttributeNS(t.space,t.local);return A===i?null:A===r?s:s=e(r=A,n)}}function Aie(t,e,n){var r,i,s;return function(){var A,a=n(this),y;return a==null?void this.removeAttribute(t):(A=this.getAttribute(t),y=a+"",A===y?null:A===r&&y===i?s:(i=y,s=e(r=A,a)))}}function uie(t,e,n){var r,i,s;return function(){var A,a=n(this),y;return a==null?void this.removeAttributeNS(t.space,t.local):(A=this.getAttributeNS(t.space,t.local),y=a+"",A===y?null:A===r&&y===i?s:(i=y,s=e(r=A,a)))}}function cie(t,e){var n=f2(t),r=n==="transform"?Wre:ZB;return this.attrTween(t,typeof e=="function"?(n.local?uie:Aie)(n,r,kT(this,"attr."+t,e)):e==null?(n.local?oie:sie)(n):(n.local?lie:aie)(n,r,e))}function hie(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function fie(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function die(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&fie(t,s)),n}return i._value=e,i}function pie(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&hie(t,s)),n}return i._value=e,i}function gie(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=f2(t);return this.tween(n,(r.local?die:pie)(r,e))}function mie(t,e){return function(){IT(this,t).delay=+e.apply(this,arguments)}}function yie(t,e){return e=+e,function(){IT(this,t).delay=e}}function _ie(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?mie:yie)(e,t)):Jl(this.node(),e).delay}function vie(t,e){return function(){OA(this,t).duration=+e.apply(this,arguments)}}function xie(t,e){return e=+e,function(){OA(this,t).duration=e}}function wie(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?vie:xie)(e,t)):Jl(this.node(),e).duration}function bie(t,e){if(typeof e!="function")throw new Error;return function(){OA(this,t).ease=e}}function Eie(t){var e=this._id;return arguments.length?this.each(bie(e,t)):Jl(this.node(),e).ease}function Tie(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;OA(this,t).ease=n}}function Sie(t){if(typeof t!="function")throw new Error;return this.each(Tie(this._id,t))}function Mie(t){typeof t!="function"&&(t=wB(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],A=s.length,a=r[i]=[],y,w=0;w<A;++w)(y=s[w])&&t.call(y,y.__data__,w,s)&&a.push(y);return new Uu(r,this._parents,this._name,this._id)}function Cie(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),A=new Array(r),a=0;a<s;++a)for(var y=e[a],w=n[a],P=y.length,I=A[a]=new Array(P),L,U=0;U<P;++U)(L=y[U]||w[U])&&(I[U]=L);for(;a<r;++a)A[a]=e[a];return new Uu(A,this._parents,this._name,this._id)}function Pie(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Iie(t,e,n){var r,i,s=Pie(e)?IT:OA;return function(){var A=s(this,t),a=A.on;a!==r&&(i=(r=a).copy()).on(e,n),A.on=i}}function kie(t,e){var n=this._id;return arguments.length<2?Jl(this.node(),n).on.on(t):this.each(Iie(n,t,e))}function Lie(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Die(){return this.on("end.remove",Lie(this._id))}function Rie(t){var e=this._name,n=this._id;typeof t!="function"&&(t=ET(t));for(var r=this._groups,i=r.length,s=new Array(i),A=0;A<i;++A)for(var a=r[A],y=a.length,w=s[A]=new Array(y),P,I,L=0;L<y;++L)(P=a[L])&&(I=t.call(P,P.__data__,L,a))&&("__data__"in P&&(I.__data__=P.__data__),w[L]=I,g2(w[L],e,n,L,w,Jl(P,n)));return new Uu(s,this._parents,e,n)}function Bie(t){var e=this._name,n=this._id;typeof t!="function"&&(t=xB(t));for(var r=this._groups,i=r.length,s=[],A=[],a=0;a<i;++a)for(var y=r[a],w=y.length,P,I=0;I<w;++I)if(P=y[I]){for(var L=t.call(P,P.__data__,I,y),U,W=Jl(P,n),q=0,ae=L.length;q<ae;++q)(U=L[q])&&g2(U,e,n,q,L,W);s.push(L),A.push(P)}return new Uu(s,A,e,n)}var zie=Hg.prototype.constructor;function Oie(){return new zie(this._groups,this._parents)}function Fie(t,e){var n,r,i;return function(){var s=U0(this,t),A=(this.style.removeProperty(t),U0(this,t));return s===A?null:s===n&&A===r?i:i=e(n=s,r=A)}}function YB(t){return function(){this.style.removeProperty(t)}}function Nie(t,e,n){var r,i=n+"",s;return function(){var A=U0(this,t);return A===i?null:A===r?s:s=e(r=A,n)}}function Uie(t,e,n){var r,i,s;return function(){var A=U0(this,t),a=n(this),y=a+"";return a==null&&(y=a=(this.style.removeProperty(t),U0(this,t))),A===y?null:A===r&&y===i?s:(i=y,s=e(r=A,a))}}function Vie(t,e){var n,r,i,s="style."+e,A="end."+s,a;return function(){var y=OA(this,t),w=y.on,P=y.value[s]==null?a||(a=YB(e)):void 0;(w!==n||i!==P)&&(r=(n=w).copy()).on(A,i=P),y.on=r}}function Gie(t,e,n){var r=(t+="")=="transform"?Hre:ZB;return e==null?this.styleTween(t,Fie(t,r)).on("end.style."+t,YB(t)):typeof e=="function"?this.styleTween(t,Uie(t,r,kT(this,"style."+t,e))).each(Vie(this._id,t)):this.styleTween(t,Nie(t,r,e),n).on("end.style."+t,null)}function jie(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function $ie(t,e,n){var r,i;function s(){var A=e.apply(this,arguments);return A!==i&&(r=(i=A)&&jie(t,A,n)),r}return s._value=e,s}function Hie(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,$ie(t,e,n??""))}function Wie(t){return function(){this.textContent=t}}function Qie(t){return function(){var e=t(this);this.textContent=e??""}}function qie(t){return this.tween("text",typeof t=="function"?Qie(kT(this,"text",t)):Wie(t==null?"":t+""))}function Zie(t){return function(e){this.textContent=t.call(this,e)}}function Yie(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Zie(i)),e}return r._value=t,r}function Xie(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Yie(t))}function Kie(){for(var t=this._name,e=this._id,n=XB(),r=this._groups,i=r.length,s=0;s<i;++s)for(var A=r[s],a=A.length,y,w=0;w<a;++w)if(y=A[w]){var P=Jl(y,e);g2(y,t,n,w,A,{time:P.time+P.delay+P.duration,delay:0,duration:P.duration,ease:P.ease})}return new Uu(r,this._parents,t,n)}function Jie(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,A){var a={value:A},y={value:function(){--i===0&&s()}};n.each(function(){var w=OA(this,r),P=w.on;P!==t&&(e=(t=P).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(y)),w.on=e}),i===0&&s()})}var ese=0;function Uu(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function XB(){return++ese}var fu=Hg.prototype;Uu.prototype={constructor:Uu,select:Rie,selectAll:Bie,selectChild:fu.selectChild,selectChildren:fu.selectChildren,filter:Mie,merge:Cie,selection:Oie,transition:Kie,call:fu.call,nodes:fu.nodes,node:fu.node,size:fu.size,empty:fu.empty,each:fu.each,on:kie,attr:cie,attrTween:gie,style:Gie,styleTween:Hie,text:qie,textTween:Xie,remove:Die,tween:iie,delay:_ie,duration:wie,ease:Eie,easeVarying:Sie,end:Jie,[Symbol.iterator]:fu[Symbol.iterator]};function tse(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var nse={time:null,delay:0,duration:250,ease:tse};function rse(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function ise(t){var e,n;t instanceof Uu?(e=t._id,t=t._name):(e=XB(),(n=nse).time=PT(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var A=r[s],a=A.length,y,w=0;w<a;++w)(y=A[w])&&g2(y,t,e,w,A,n||rse(y,e));return new Uu(r,this._parents,t,e)}Hg.prototype.interrupt=tie;Hg.prototype.transition=ise;const r3=Math.PI,i3=2*r3,yh=1e-6,sse=i3-yh;function KB(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function ose(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return KB;const n=10**e;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let ase=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?KB:ose(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,s,A){this._append`C${+e},${+n},${+r},${+i},${this._x1=+s},${this._y1=+A}`}arcTo(e,n,r,i,s){if(e=+e,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let A=this._x1,a=this._y1,y=r-e,w=i-n,P=A-e,I=a-n,L=P*P+I*I;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(L>yh)if(!(Math.abs(I*y-w*P)>yh)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let U=r-A,W=i-a,q=y*y+w*w,ae=U*U+W*W,K=Math.sqrt(q),ne=Math.sqrt(L),ie=s*Math.tan((r3-Math.acos((q+L-ae)/(2*K*ne)))/2),fe=ie/ne,ye=ie/K;Math.abs(fe-1)>yh&&this._append`L${e+fe*P},${n+fe*I}`,this._append`A${s},${s},0,0,${+(I*U>P*W)},${this._x1=e+ye*y},${this._y1=n+ye*w}`}}arc(e,n,r,i,s,A){if(e=+e,n=+n,r=+r,A=!!A,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),y=r*Math.sin(i),w=e+a,P=n+y,I=1^A,L=A?i-s:s-i;this._x1===null?this._append`M${w},${P}`:(Math.abs(this._x1-w)>yh||Math.abs(this._y1-P)>yh)&&this._append`L${w},${P}`,r&&(L<0&&(L=L%i3+i3),L>sse?this._append`A${r},${r},0,1,${I},${e-a},${n-y}A${r},${r},0,1,${I},${this._x1=w},${this._y1=P}`:L>yh&&this._append`A${r},${r},0,${+(L>=r3)},${I},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};const Iu=11102230246251565e-32,Hs=134217729,lse=(3+8*Iu)*Iu;function Fx(t,e,n,r,i){let s,A,a,y,w=e[0],P=r[0],I=0,L=0;P>w==P>-w?(s=w,w=e[++I]):(s=P,P=r[++L]);let U=0;if(I<t&&L<n)for(P>w==P>-w?(A=w+s,a=s-(A-w),w=e[++I]):(A=P+s,a=s-(A-P),P=r[++L]),s=A,a!==0&&(i[U++]=a);I<t&&L<n;)P>w==P>-w?(A=s+w,y=A-s,a=s-(A-y)+(w-y),w=e[++I]):(A=s+P,y=A-s,a=s-(A-y)+(P-y),P=r[++L]),s=A,a!==0&&(i[U++]=a);for(;I<t;)A=s+w,y=A-s,a=s-(A-y)+(w-y),w=e[++I],s=A,a!==0&&(i[U++]=a);for(;L<n;)A=s+P,y=A-s,a=s-(A-y)+(P-y),P=r[++L],s=A,a!==0&&(i[U++]=a);return(s!==0||U===0)&&(i[U++]=s),U}function Ase(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}function Qg(t){return new Float64Array(t)}const use=(3+16*Iu)*Iu,cse=(2+12*Iu)*Iu,hse=(9+64*Iu)*Iu*Iu,kf=Qg(4),HP=Qg(8),WP=Qg(12),QP=Qg(16),vo=Qg(4);function fse(t,e,n,r,i,s,A){let a,y,w,P,I,L,U,W,q,ae,K,ne,ie,fe,ye,Me,He,Qe;const Je=t-i,tt=n-i,Ne=e-s,nt=r-s;fe=Je*nt,L=Hs*Je,U=L-(L-Je),W=Je-U,L=Hs*nt,q=L-(L-nt),ae=nt-q,ye=W*ae-(fe-U*q-W*q-U*ae),Me=Ne*tt,L=Hs*Ne,U=L-(L-Ne),W=Ne-U,L=Hs*tt,q=L-(L-tt),ae=tt-q,He=W*ae-(Me-U*q-W*q-U*ae),K=ye-He,I=ye-K,kf[0]=ye-(K+I)+(I-He),ne=fe+K,I=ne-fe,ie=fe-(ne-I)+(K-I),K=ie-Me,I=ie-K,kf[1]=ie-(K+I)+(I-Me),Qe=ne+K,I=Qe-ne,kf[2]=ne-(Qe-I)+(K-I),kf[3]=Qe;let qe=Ase(4,kf),mt=cse*A;if(qe>=mt||-qe>=mt||(I=t-Je,a=t-(Je+I)+(I-i),I=n-tt,w=n-(tt+I)+(I-i),I=e-Ne,y=e-(Ne+I)+(I-s),I=r-nt,P=r-(nt+I)+(I-s),a===0&&y===0&&w===0&&P===0)||(mt=hse*A+lse*Math.abs(qe),qe+=Je*P+nt*a-(Ne*w+tt*y),qe>=mt||-qe>=mt))return qe;fe=a*nt,L=Hs*a,U=L-(L-a),W=a-U,L=Hs*nt,q=L-(L-nt),ae=nt-q,ye=W*ae-(fe-U*q-W*q-U*ae),Me=y*tt,L=Hs*y,U=L-(L-y),W=y-U,L=Hs*tt,q=L-(L-tt),ae=tt-q,He=W*ae-(Me-U*q-W*q-U*ae),K=ye-He,I=ye-K,vo[0]=ye-(K+I)+(I-He),ne=fe+K,I=ne-fe,ie=fe-(ne-I)+(K-I),K=ie-Me,I=ie-K,vo[1]=ie-(K+I)+(I-Me),Qe=ne+K,I=Qe-ne,vo[2]=ne-(Qe-I)+(K-I),vo[3]=Qe;const Xt=Fx(4,kf,4,vo,HP);fe=Je*P,L=Hs*Je,U=L-(L-Je),W=Je-U,L=Hs*P,q=L-(L-P),ae=P-q,ye=W*ae-(fe-U*q-W*q-U*ae),Me=Ne*w,L=Hs*Ne,U=L-(L-Ne),W=Ne-U,L=Hs*w,q=L-(L-w),ae=w-q,He=W*ae-(Me-U*q-W*q-U*ae),K=ye-He,I=ye-K,vo[0]=ye-(K+I)+(I-He),ne=fe+K,I=ne-fe,ie=fe-(ne-I)+(K-I),K=ie-Me,I=ie-K,vo[1]=ie-(K+I)+(I-Me),Qe=ne+K,I=Qe-ne,vo[2]=ne-(Qe-I)+(K-I),vo[3]=Qe;const Et=Fx(Xt,HP,4,vo,WP);fe=a*P,L=Hs*a,U=L-(L-a),W=a-U,L=Hs*P,q=L-(L-P),ae=P-q,ye=W*ae-(fe-U*q-W*q-U*ae),Me=y*w,L=Hs*y,U=L-(L-y),W=y-U,L=Hs*w,q=L-(L-w),ae=w-q,He=W*ae-(Me-U*q-W*q-U*ae),K=ye-He,I=ye-K,vo[0]=ye-(K+I)+(I-He),ne=fe+K,I=ne-fe,ie=fe-(ne-I)+(K-I),K=ie-Me,I=ie-K,vo[1]=ie-(K+I)+(I-Me),Qe=ne+K,I=Qe-ne,vo[2]=ne-(Qe-I)+(K-I),vo[3]=Qe;const fn=Fx(Et,WP,4,vo,QP);return QP[fn-1]}function dse(t,e,n,r,i,s){const A=(e-s)*(n-i),a=(t-i)*(r-s),y=A-a,w=Math.abs(A+a);return Math.abs(y)>=use*w?y:-fse(t,e,n,r,i,s,w)}function pse(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function u_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function G0(t){return t=u_(Math.abs(t)),t?t[1]:NaN}function gse(t,e){return function(n,r){for(var i=n.length,s=[],A=0,a=t[0],y=0;i>0&&a>0&&(y+a+1>r&&(a=Math.max(1,r-y)),s.push(n.substring(i-=a,i+a)),!((y+=a+1)>r));)a=t[A=(A+1)%t.length];return s.reverse().join(e)}}function mse(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var yse=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function c_(t){if(!(e=yse.exec(t)))throw new Error("invalid format: "+t);var e;return new LT({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}c_.prototype=LT.prototype;function LT(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}LT.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function _se(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var JB;function vse(t,e){var n=u_(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(JB=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,A=r.length;return s===A?r:s>A?r+new Array(s-A+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+u_(t,Math.max(0,e+s-1))[0]}function qP(t,e){var n=u_(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const ZP={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:pse,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>qP(t*100,e),r:qP,s:vse,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function YP(t){return t}var XP=Array.prototype.map,KP=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function xse(t){var e=t.grouping===void 0||t.thousands===void 0?YP:gse(XP.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?YP:mse(XP.call(t.numerals,String)),A=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"":t.minus+"",y=t.nan===void 0?"NaN":t.nan+"";function w(I){I=c_(I);var L=I.fill,U=I.align,W=I.sign,q=I.symbol,ae=I.zero,K=I.width,ne=I.comma,ie=I.precision,fe=I.trim,ye=I.type;ye==="n"?(ne=!0,ye="g"):ZP[ye]||(ie===void 0&&(ie=12),fe=!0,ye="g"),(ae||L==="0"&&U==="=")&&(ae=!0,L="0",U="=");var Me=q==="$"?n:q==="#"&&/[boxX]/.test(ye)?"0"+ye.toLowerCase():"",He=q==="$"?r:/[%p]/.test(ye)?A:"",Qe=ZP[ye],Je=/[defgprs%]/.test(ye);ie=ie===void 0?6:/[gprs]/.test(ye)?Math.max(1,Math.min(21,ie)):Math.max(0,Math.min(20,ie));function tt(Ne){var nt=Me,qe=He,mt,Xt,Et;if(ye==="c")qe=Qe(Ne)+qe,Ne="";else{Ne=+Ne;var fn=Ne<0||1/Ne<0;if(Ne=isNaN(Ne)?y:Qe(Math.abs(Ne),ie),fe&&(Ne=_se(Ne)),fn&&+Ne==0&&W!=="+"&&(fn=!1),nt=(fn?W==="("?W:a:W==="-"||W==="("?"":W)+nt,qe=(ye==="s"?KP[8+JB/3]:"")+qe+(fn&&W==="("?")":""),Je){for(mt=-1,Xt=Ne.length;++mt<Xt;)if(Et=Ne.charCodeAt(mt),48>Et||Et>57){qe=(Et===46?i+Ne.slice(mt+1):Ne.slice(mt))+qe,Ne=Ne.slice(0,mt);break}}}ne&&!ae&&(Ne=e(Ne,1/0));var yt=nt.length+Ne.length+qe.length,bt=yt<K?new Array(K-yt+1).join(L):"";switch(ne&&ae&&(Ne=e(bt+Ne,bt.length?K-qe.length:1/0),bt=""),U){case"<":Ne=nt+Ne+qe+bt;break;case"=":Ne=nt+bt+Ne+qe;break;case"^":Ne=bt.slice(0,yt=bt.length>>1)+nt+Ne+qe+bt.slice(yt);break;default:Ne=bt+nt+Ne+qe;break}return s(Ne)}return tt.toString=function(){return I+""},tt}function P(I,L){var U=w((I=c_(I),I.type="f",I)),W=Math.max(-8,Math.min(8,Math.floor(G0(L)/3)))*3,q=Math.pow(10,-W),ae=KP[8+W/3];return function(K){return U(q*K)+ae}}return{format:w,formatPrefix:P}}var i1,ez,tz;wse({thousands:",",grouping:[3],currency:["$",""]});function wse(t){return i1=xse(t),ez=i1.format,tz=i1.formatPrefix,i1}function bse(t){return Math.max(0,-G0(Math.abs(t)))}function Ese(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(G0(e)/3)))*3-G0(Math.abs(t)))}function Tse(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,G0(e)-G0(t))+1}function DT(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Sse(t){return function(){return t}}function Mse(t){return+t}var JP=[0,1];function Yf(t){return t}function s3(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Sse(isNaN(e)?NaN:.5)}function Cse(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function Pse(t,e,n){var r=t[0],i=t[1],s=e[0],A=e[1];return i<r?(r=s3(i,r),s=n(A,s)):(r=s3(r,i),s=n(s,A)),function(a){return s(r(a))}}function Ise(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),A=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++A<r;)i[A]=s3(t[A],t[A+1]),s[A]=n(e[A],e[A+1]);return function(a){var y=mB(t,a,1,r)-1;return s[y](i[y](a))}}function nz(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function kse(){var t=JP,e=JP,n=CT,r,i,s,A=Yf,a,y,w;function P(){var L=Math.min(t.length,e.length);return A!==Yf&&(A=Cse(t[0],t[L-1])),a=L>2?Ise:Pse,y=w=null,I}function I(L){return L==null||isNaN(L=+L)?s:(y||(y=a(t.map(r),e,n)))(r(A(L)))}return I.invert=function(L){return A(i((w||(w=a(e,t.map(r),zl)))(L)))},I.domain=function(L){return arguments.length?(t=Array.from(L,Mse),P()):t.slice()},I.range=function(L){return arguments.length?(e=Array.from(L),P()):e.slice()},I.rangeRound=function(L){return e=Array.from(L),n=Gre,P()},I.clamp=function(L){return arguments.length?(A=L?!0:Yf,P()):A!==Yf},I.interpolate=function(L){return arguments.length?(n=L,P()):n},I.unknown=function(L){return arguments.length?(s=L,I):s},function(L,U){return r=L,i=U,P()}}function rz(){return kse()(Yf,Yf)}function Lse(t,e,n,r){var i=Yb(t,e,n),s;switch(r=c_(r??",f"),r.type){case"s":{var A=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=Ese(i,A))&&(r.precision=s),tz(r,A)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=Tse(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=bse(i))&&(r.precision=s-(r.type==="%")*2);break}}return ez(r)}function iz(t){var e=t.domain;return t.ticks=function(n){var r=e();return qb(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return Lse(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,A=r[i],a=r[s],y,w,P=10;for(a<A&&(w=A,A=a,a=w,w=i,i=s,s=w);P-- >0;){if(w=Zb(A,a,n),w===y)return r[i]=A,r[s]=a,e(r);if(w>0)A=Math.floor(A/w)*w,a=Math.ceil(a/w)*w;else if(w<0)A=Math.ceil(A*w)/w,a=Math.floor(a*w)/w;else break;y=w}return t},t}function rl(){var t=rz();return t.copy=function(){return nz(t,rl())},DT.apply(t,arguments),iz(t)}function Dse(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],s=t[r],A;return s<i&&(A=n,n=r,r=A,A=i,i=s,s=A),t[n]=e.floor(i),t[r]=e.ceil(s),t}function CA(){var t=0,e=1,n=1,r=[.5],i=[0,1],s;function A(y){return y!=null&&y<=y?i[mB(r,y,0,n)]:s}function a(){var y=-1;for(r=new Array(n);++y<n;)r[y]=((y+1)*e-(y-n)*t)/(n+1);return A}return A.domain=function(y){return arguments.length?([t,e]=y,t=+t,e=+e,a()):[t,e]},A.range=function(y){return arguments.length?(n=(i=Array.from(y)).length-1,a()):i.slice()},A.invertExtent=function(y){var w=i.indexOf(y);return w<0?[NaN,NaN]:w<1?[t,r[0]]:w>=n?[r[n-1],e]:[r[w-1],r[w]]},A.unknown=function(y){return arguments.length&&(s=y),A},A.thresholds=function(){return r.slice()},A.copy=function(){return CA().domain([t,e]).range(i).unknown(s)},DT.apply(iz(A),arguments)}const Nx=new Date,Ux=new Date;function Xi(t,e,n,r){function i(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(t(s=new Date(+s)),s),i.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),i.round=s=>{const A=i(s),a=i.ceil(s);return s-A<a-s?A:a},i.offset=(s,A)=>(e(s=new Date(+s),A==null?1:Math.floor(A)),s),i.range=(s,A,a)=>{const y=[];if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<A)||!(a>0))return y;let w;do y.push(w=new Date(+s)),e(s,a),t(s);while(w<s&&s<A);return y},i.filter=s=>Xi(A=>{if(A>=A)for(;t(A),!s(A);)A.setTime(A-1)},(A,a)=>{if(A>=A)if(a<0)for(;++a<=0;)for(;e(A,-1),!s(A););else for(;--a>=0;)for(;e(A,1),!s(A););}),n&&(i.count=(s,A)=>(Nx.setTime(+s),Ux.setTime(+A),t(Nx),t(Ux),Math.floor(n(Nx,Ux))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?A=>r(A)%s===0:A=>i.count(0,A)%s===0):i)),i}const h_=Xi(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);h_.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Xi(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):h_);h_.range;const wu=1e3,il=wu*60,bu=il*60,Vu=bu*24,RT=Vu*7,eI=Vu*30,Vx=Vu*365,Xf=Xi(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*wu)},(t,e)=>(e-t)/wu,t=>t.getUTCSeconds());Xf.range;const BT=Xi(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*wu)},(t,e)=>{t.setTime(+t+e*il)},(t,e)=>(e-t)/il,t=>t.getMinutes());BT.range;const Rse=Xi(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*il)},(t,e)=>(e-t)/il,t=>t.getUTCMinutes());Rse.range;const zT=Xi(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*wu-t.getMinutes()*il)},(t,e)=>{t.setTime(+t+e*bu)},(t,e)=>(e-t)/bu,t=>t.getHours());zT.range;const Bse=Xi(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*bu)},(t,e)=>(e-t)/bu,t=>t.getUTCHours());Bse.range;const qg=Xi(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*il)/Vu,t=>t.getDate()-1);qg.range;const OT=Xi(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Vu,t=>t.getUTCDate()-1);OT.range;const zse=Xi(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Vu,t=>Math.floor(t/Vu));zse.range;function af(t){return Xi(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*il)/RT)}const m2=af(0),f_=af(1),Ose=af(2),Fse=af(3),j0=af(4),Nse=af(5),Use=af(6);m2.range;f_.range;Ose.range;Fse.range;j0.range;Nse.range;Use.range;function lf(t){return Xi(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/RT)}const sz=lf(0),d_=lf(1),Vse=lf(2),Gse=lf(3),$0=lf(4),jse=lf(5),$se=lf(6);sz.range;d_.range;Vse.range;Gse.range;$0.range;jse.range;$se.range;const FT=Xi(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());FT.range;const Hse=Xi(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Hse.range;const Gu=Xi(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Gu.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Xi(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});Gu.range;const $h=Xi(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());$h.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Xi(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});$h.range;function Wse(t,e,n,r,i,s){const A=[[Xf,1,wu],[Xf,5,5*wu],[Xf,15,15*wu],[Xf,30,30*wu],[s,1,il],[s,5,5*il],[s,15,15*il],[s,30,30*il],[i,1,bu],[i,3,3*bu],[i,6,6*bu],[i,12,12*bu],[r,1,Vu],[r,2,2*Vu],[n,1,RT],[e,1,eI],[e,3,3*eI],[t,1,Vx]];function a(w,P,I){const L=P<w;L&&([w,P]=[P,w]);const U=I&&typeof I.range=="function"?I:y(w,P,I),W=U?U.range(w,+P+1):[];return L?W.reverse():W}function y(w,P,I){const L=Math.abs(P-w)/I,U=bT(([,,ae])=>ae).right(A,L);if(U===A.length)return t.every(Yb(w/Vx,P/Vx,I));if(U===0)return h_.every(Math.max(Yb(w,P,I),1));const[W,q]=A[L/A[U-1][2]<A[U][2]/L?U-1:U];return W.every(q)}return[a,y]}const[Qse,qse]=Wse(Gu,FT,m2,qg,zT,BT);function Gx(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function jx(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Gd(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Zse(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,s=t.days,A=t.shortDays,a=t.months,y=t.shortMonths,w=jd(i),P=$d(i),I=jd(s),L=$d(s),U=jd(A),W=$d(A),q=jd(a),ae=$d(a),K=jd(y),ne=$d(y),ie={a:fn,A:yt,b:bt,B:Kt,c:null,d:oI,e:oI,f:yoe,g:Coe,G:Ioe,H:poe,I:goe,j:moe,L:oz,m:_oe,M:voe,p:In,q:En,Q:AI,s:uI,S:xoe,u:woe,U:boe,V:Eoe,w:Toe,W:Soe,x:null,X:null,y:Moe,Y:Poe,Z:koe,"%":lI},fe={a:Er,A:Jn,b:ir,B:Ar,c:null,d:aI,e:aI,f:Boe,g:Hoe,G:Qoe,H:Loe,I:Doe,j:Roe,L:lz,m:zoe,M:Ooe,p:Nn,q:xr,Q:AI,s:uI,S:Foe,u:Noe,U:Uoe,V:Voe,w:Goe,W:joe,x:null,X:null,y:$oe,Y:Woe,Z:qoe,"%":lI},ye={a:tt,A:Ne,b:nt,B:qe,c:mt,d:iI,e:iI,f:coe,g:rI,G:nI,H:sI,I:sI,j:aoe,L:uoe,m:ooe,M:loe,p:Je,q:soe,Q:foe,s:doe,S:Aoe,u:eoe,U:toe,V:noe,w:Jse,W:roe,x:Xt,X:Et,y:rI,Y:nI,Z:ioe,"%":hoe};ie.x=Me(n,ie),ie.X=Me(r,ie),ie.c=Me(e,ie),fe.x=Me(n,fe),fe.X=Me(r,fe),fe.c=Me(e,fe);function Me(xt,nn){return function(Mn){var vt=[],er=-1,$n=0,gr=xt.length,or,tr,Zr;for(Mn instanceof Date||(Mn=new Date(+Mn));++er<gr;)xt.charCodeAt(er)===37&&(vt.push(xt.slice($n,er)),(tr=tI[or=xt.charAt(++er)])!=null?or=xt.charAt(++er):tr=or==="e"?" ":"0",(Zr=nn[or])&&(or=Zr(Mn,tr)),vt.push(or),$n=er+1);return vt.push(xt.slice($n,er)),vt.join("")}}function He(xt,nn){return function(Mn){var vt=Gd(1900,void 0,1),er=Qe(vt,xt,Mn+="",0),$n,gr;if(er!=Mn.length)return null;if("Q"in vt)return new Date(vt.Q);if("s"in vt)return new Date(vt.s*1e3+("L"in vt?vt.L:0));if(nn&&!("Z"in vt)&&(vt.Z=0),"p"in vt&&(vt.H=vt.H%12+vt.p*12),vt.m===void 0&&(vt.m="q"in vt?vt.q:0),"V"in vt){if(vt.V<1||vt.V>53)return null;"w"in vt||(vt.w=1),"Z"in vt?($n=jx(Gd(vt.y,0,1)),gr=$n.getUTCDay(),$n=gr>4||gr===0?d_.ceil($n):d_($n),$n=OT.offset($n,(vt.V-1)*7),vt.y=$n.getUTCFullYear(),vt.m=$n.getUTCMonth(),vt.d=$n.getUTCDate()+(vt.w+6)%7):($n=Gx(Gd(vt.y,0,1)),gr=$n.getDay(),$n=gr>4||gr===0?f_.ceil($n):f_($n),$n=qg.offset($n,(vt.V-1)*7),vt.y=$n.getFullYear(),vt.m=$n.getMonth(),vt.d=$n.getDate()+(vt.w+6)%7)}else("W"in vt||"U"in vt)&&("w"in vt||(vt.w="u"in vt?vt.u%7:"W"in vt?1:0),gr="Z"in vt?jx(Gd(vt.y,0,1)).getUTCDay():Gx(Gd(vt.y,0,1)).getDay(),vt.m=0,vt.d="W"in vt?(vt.w+6)%7+vt.W*7-(gr+5)%7:vt.w+vt.U*7-(gr+6)%7);return"Z"in vt?(vt.H+=vt.Z/100|0,vt.M+=vt.Z%100,jx(vt)):Gx(vt)}}function Qe(xt,nn,Mn,vt){for(var er=0,$n=nn.length,gr=Mn.length,or,tr;er<$n;){if(vt>=gr)return-1;if(or=nn.charCodeAt(er++),or===37){if(or=nn.charAt(er++),tr=ye[or in tI?nn.charAt(er++):or],!tr||(vt=tr(xt,Mn,vt))<0)return-1}else if(or!=Mn.charCodeAt(vt++))return-1}return vt}function Je(xt,nn,Mn){var vt=w.exec(nn.slice(Mn));return vt?(xt.p=P.get(vt[0].toLowerCase()),Mn+vt[0].length):-1}function tt(xt,nn,Mn){var vt=U.exec(nn.slice(Mn));return vt?(xt.w=W.get(vt[0].toLowerCase()),Mn+vt[0].length):-1}function Ne(xt,nn,Mn){var vt=I.exec(nn.slice(Mn));return vt?(xt.w=L.get(vt[0].toLowerCase()),Mn+vt[0].length):-1}function nt(xt,nn,Mn){var vt=K.exec(nn.slice(Mn));return vt?(xt.m=ne.get(vt[0].toLowerCase()),Mn+vt[0].length):-1}function qe(xt,nn,Mn){var vt=q.exec(nn.slice(Mn));return vt?(xt.m=ae.get(vt[0].toLowerCase()),Mn+vt[0].length):-1}function mt(xt,nn,Mn){return Qe(xt,e,nn,Mn)}function Xt(xt,nn,Mn){return Qe(xt,n,nn,Mn)}function Et(xt,nn,Mn){return Qe(xt,r,nn,Mn)}function fn(xt){return A[xt.getDay()]}function yt(xt){return s[xt.getDay()]}function bt(xt){return y[xt.getMonth()]}function Kt(xt){return a[xt.getMonth()]}function In(xt){return i[+(xt.getHours()>=12)]}function En(xt){return 1+~~(xt.getMonth()/3)}function Er(xt){return A[xt.getUTCDay()]}function Jn(xt){return s[xt.getUTCDay()]}function ir(xt){return y[xt.getUTCMonth()]}function Ar(xt){return a[xt.getUTCMonth()]}function Nn(xt){return i[+(xt.getUTCHours()>=12)]}function xr(xt){return 1+~~(xt.getUTCMonth()/3)}return{format:function(xt){var nn=Me(xt+="",ie);return nn.toString=function(){return xt},nn},parse:function(xt){var nn=He(xt+="",!1);return nn.toString=function(){return xt},nn},utcFormat:function(xt){var nn=Me(xt+="",fe);return nn.toString=function(){return xt},nn},utcParse:function(xt){var nn=He(xt+="",!0);return nn.toString=function(){return xt},nn}}}var tI={"-":"",_:" ",0:"0"},hs=/^\s*\d+/,Yse=/^%/,Xse=/[\\^$*+?|[\]().{}]/g;function br(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(e)+i:i)}function Kse(t){return t.replace(Xse,"\\$&")}function jd(t){return new RegExp("^(?:"+t.map(Kse).join("|")+")","i")}function $d(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Jse(t,e,n){var r=hs.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function eoe(t,e,n){var r=hs.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function toe(t,e,n){var r=hs.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function noe(t,e,n){var r=hs.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function roe(t,e,n){var r=hs.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function nI(t,e,n){var r=hs.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function rI(t,e,n){var r=hs.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function ioe(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function soe(t,e,n){var r=hs.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function ooe(t,e,n){var r=hs.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function iI(t,e,n){var r=hs.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function aoe(t,e,n){var r=hs.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function sI(t,e,n){var r=hs.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function loe(t,e,n){var r=hs.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Aoe(t,e,n){var r=hs.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function uoe(t,e,n){var r=hs.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function coe(t,e,n){var r=hs.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function hoe(t,e,n){var r=Yse.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function foe(t,e,n){var r=hs.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function doe(t,e,n){var r=hs.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function oI(t,e){return br(t.getDate(),e,2)}function poe(t,e){return br(t.getHours(),e,2)}function goe(t,e){return br(t.getHours()%12||12,e,2)}function moe(t,e){return br(1+qg.count(Gu(t),t),e,3)}function oz(t,e){return br(t.getMilliseconds(),e,3)}function yoe(t,e){return oz(t,e)+"000"}function _oe(t,e){return br(t.getMonth()+1,e,2)}function voe(t,e){return br(t.getMinutes(),e,2)}function xoe(t,e){return br(t.getSeconds(),e,2)}function woe(t){var e=t.getDay();return e===0?7:e}function boe(t,e){return br(m2.count(Gu(t)-1,t),e,2)}function az(t){var e=t.getDay();return e>=4||e===0?j0(t):j0.ceil(t)}function Eoe(t,e){return t=az(t),br(j0.count(Gu(t),t)+(Gu(t).getDay()===4),e,2)}function Toe(t){return t.getDay()}function Soe(t,e){return br(f_.count(Gu(t)-1,t),e,2)}function Moe(t,e){return br(t.getFullYear()%100,e,2)}function Coe(t,e){return t=az(t),br(t.getFullYear()%100,e,2)}function Poe(t,e){return br(t.getFullYear()%1e4,e,4)}function Ioe(t,e){var n=t.getDay();return t=n>=4||n===0?j0(t):j0.ceil(t),br(t.getFullYear()%1e4,e,4)}function koe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+br(e/60|0,"0",2)+br(e%60,"0",2)}function aI(t,e){return br(t.getUTCDate(),e,2)}function Loe(t,e){return br(t.getUTCHours(),e,2)}function Doe(t,e){return br(t.getUTCHours()%12||12,e,2)}function Roe(t,e){return br(1+OT.count($h(t),t),e,3)}function lz(t,e){return br(t.getUTCMilliseconds(),e,3)}function Boe(t,e){return lz(t,e)+"000"}function zoe(t,e){return br(t.getUTCMonth()+1,e,2)}function Ooe(t,e){return br(t.getUTCMinutes(),e,2)}function Foe(t,e){return br(t.getUTCSeconds(),e,2)}function Noe(t){var e=t.getUTCDay();return e===0?7:e}function Uoe(t,e){return br(sz.count($h(t)-1,t),e,2)}function Az(t){var e=t.getUTCDay();return e>=4||e===0?$0(t):$0.ceil(t)}function Voe(t,e){return t=Az(t),br($0.count($h(t),t)+($h(t).getUTCDay()===4),e,2)}function Goe(t){return t.getUTCDay()}function joe(t,e){return br(d_.count($h(t)-1,t),e,2)}function $oe(t,e){return br(t.getUTCFullYear()%100,e,2)}function Hoe(t,e){return t=Az(t),br(t.getUTCFullYear()%100,e,2)}function Woe(t,e){return br(t.getUTCFullYear()%1e4,e,4)}function Qoe(t,e){var n=t.getUTCDay();return t=n>=4||n===0?$0(t):$0.ceil(t),br(t.getUTCFullYear()%1e4,e,4)}function qoe(){return"+0000"}function lI(){return"%"}function AI(t){return+t}function uI(t){return Math.floor(+t/1e3)}var Lf,uz;Zoe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Zoe(t){return Lf=Zse(t),uz=Lf.format,Lf.parse,Lf.utcFormat,Lf.utcParse,Lf}function Yoe(t){return new Date(t)}function Xoe(t){return t instanceof Date?+t:+new Date(+t)}function cz(t,e,n,r,i,s,A,a,y,w){var P=rz(),I=P.invert,L=P.domain,U=w(".%L"),W=w(":%S"),q=w("%I:%M"),ae=w("%I %p"),K=w("%a %d"),ne=w("%b %d"),ie=w("%B"),fe=w("%Y");function ye(Me){return(y(Me)<Me?U:a(Me)<Me?W:A(Me)<Me?q:s(Me)<Me?ae:r(Me)<Me?i(Me)<Me?K:ne:n(Me)<Me?ie:fe)(Me)}return P.invert=function(Me){return new Date(I(Me))},P.domain=function(Me){return arguments.length?L(Array.from(Me,Xoe)):L().map(Yoe)},P.ticks=function(Me){var He=L();return t(He[0],He[He.length-1],Me??10)},P.tickFormat=function(Me,He){return He==null?ye:w(He)},P.nice=function(Me){var He=L();return(!Me||typeof Me.range!="function")&&(Me=e(He[0],He[He.length-1],Me??10)),Me?L(Dse(He,Me)):P},P.copy=function(){return nz(P,cz(t,e,n,r,i,s,A,a,y,w))},P}function Koe(){return DT.apply(cz(Qse,qse,Gu,FT,m2,qg,zT,BT,Xf,uz).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function y2(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const _2=t=>Rre(t[t.length-1]);var Joe=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(y2);const eae=_2(Joe);var tae=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(y2);const nae=_2(tae);var rae=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(y2);const cI=_2(rae);var iae=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(y2);const hI=_2(iae);function $o(t){return function(){return t}}const fI=Math.abs,Ws=Math.atan2,ch=Math.cos,sae=Math.max,$x=Math.min,_A=Math.sin,Kf=Math.sqrt,Zs=1e-12,ag=Math.PI,p_=ag/2,oae=2*ag;function aae(t){return t>1?0:t<-1?ag:Math.acos(t)}function dI(t){return t>=1?p_:t<=-1?-p_:Math.asin(t)}function hz(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new ase(e)}function lae(t){return t.innerRadius}function Aae(t){return t.outerRadius}function uae(t){return t.startAngle}function cae(t){return t.endAngle}function hae(t){return t&&t.padAngle}function fae(t,e,n,r,i,s,A,a){var y=n-t,w=r-e,P=A-i,I=a-s,L=I*y-P*w;if(!(L*L<Zs))return L=(P*(e-s)-I*(t-i))/L,[t+L*y,e+L*w]}function s1(t,e,n,r,i,s,A){var a=t-n,y=e-r,w=(A?s:-s)/Kf(a*a+y*y),P=w*y,I=-w*a,L=t+P,U=e+I,W=n+P,q=r+I,ae=(L+W)/2,K=(U+q)/2,ne=W-L,ie=q-U,fe=ne*ne+ie*ie,ye=i-s,Me=L*q-W*U,He=(ie<0?-1:1)*Kf(sae(0,ye*ye*fe-Me*Me)),Qe=(Me*ie-ne*He)/fe,Je=(-Me*ne-ie*He)/fe,tt=(Me*ie+ne*He)/fe,Ne=(-Me*ne+ie*He)/fe,nt=Qe-ae,qe=Je-K,mt=tt-ae,Xt=Ne-K;return nt*nt+qe*qe>mt*mt+Xt*Xt&&(Qe=tt,Je=Ne),{cx:Qe,cy:Je,x01:-P,y01:-I,x11:Qe*(i/ye-1),y11:Je*(i/ye-1)}}function pI(){var t=lae,e=Aae,n=$o(0),r=null,i=uae,s=cae,A=hae,a=null,y=hz(w);function w(){var P,I,L=+t.apply(this,arguments),U=+e.apply(this,arguments),W=i.apply(this,arguments)-p_,q=s.apply(this,arguments)-p_,ae=fI(q-W),K=q>W;if(a||(a=P=y()),U<L&&(I=U,U=L,L=I),!(U>Zs))a.moveTo(0,0);else if(ae>oae-Zs)a.moveTo(U*ch(W),U*_A(W)),a.arc(0,0,U,W,q,!K),L>Zs&&(a.moveTo(L*ch(q),L*_A(q)),a.arc(0,0,L,q,W,K));else{var ne=W,ie=q,fe=W,ye=q,Me=ae,He=ae,Qe=A.apply(this,arguments)/2,Je=Qe>Zs&&(r?+r.apply(this,arguments):Kf(L*L+U*U)),tt=$x(fI(U-L)/2,+n.apply(this,arguments)),Ne=tt,nt=tt,qe,mt;if(Je>Zs){var Xt=dI(Je/L*_A(Qe)),Et=dI(Je/U*_A(Qe));(Me-=Xt*2)>Zs?(Xt*=K?1:-1,fe+=Xt,ye-=Xt):(Me=0,fe=ye=(W+q)/2),(He-=Et*2)>Zs?(Et*=K?1:-1,ne+=Et,ie-=Et):(He=0,ne=ie=(W+q)/2)}var fn=U*ch(ne),yt=U*_A(ne),bt=L*ch(ye),Kt=L*_A(ye);if(tt>Zs){var In=U*ch(ie),En=U*_A(ie),Er=L*ch(fe),Jn=L*_A(fe),ir;if(ae<ag)if(ir=fae(fn,yt,Er,Jn,In,En,bt,Kt)){var Ar=fn-ir[0],Nn=yt-ir[1],xr=In-ir[0],xt=En-ir[1],nn=1/_A(aae((Ar*xr+Nn*xt)/(Kf(Ar*Ar+Nn*Nn)*Kf(xr*xr+xt*xt)))/2),Mn=Kf(ir[0]*ir[0]+ir[1]*ir[1]);Ne=$x(tt,(L-Mn)/(nn-1)),nt=$x(tt,(U-Mn)/(nn+1))}else Ne=nt=0}He>Zs?nt>Zs?(qe=s1(Er,Jn,fn,yt,U,nt,K),mt=s1(In,En,bt,Kt,U,nt,K),a.moveTo(qe.cx+qe.x01,qe.cy+qe.y01),nt<tt?a.arc(qe.cx,qe.cy,nt,Ws(qe.y01,qe.x01),Ws(mt.y01,mt.x01),!K):(a.arc(qe.cx,qe.cy,nt,Ws(qe.y01,qe.x01),Ws(qe.y11,qe.x11),!K),a.arc(0,0,U,Ws(qe.cy+qe.y11,qe.cx+qe.x11),Ws(mt.cy+mt.y11,mt.cx+mt.x11),!K),a.arc(mt.cx,mt.cy,nt,Ws(mt.y11,mt.x11),Ws(mt.y01,mt.x01),!K))):(a.moveTo(fn,yt),a.arc(0,0,U,ne,ie,!K)):a.moveTo(fn,yt),!(L>Zs)||!(Me>Zs)?a.lineTo(bt,Kt):Ne>Zs?(qe=s1(bt,Kt,In,En,L,-Ne,K),mt=s1(fn,yt,Er,Jn,L,-Ne,K),a.lineTo(qe.cx+qe.x01,qe.cy+qe.y01),Ne<tt?a.arc(qe.cx,qe.cy,Ne,Ws(qe.y01,qe.x01),Ws(mt.y01,mt.x01),!K):(a.arc(qe.cx,qe.cy,Ne,Ws(qe.y01,qe.x01),Ws(qe.y11,qe.x11),!K),a.arc(0,0,L,Ws(qe.cy+qe.y11,qe.cx+qe.x11),Ws(mt.cy+mt.y11,mt.cx+mt.x11),K),a.arc(mt.cx,mt.cy,Ne,Ws(mt.y11,mt.x11),Ws(mt.y01,mt.x01),!K))):a.arc(0,0,L,ye,fe,K)}if(a.closePath(),P)return a=null,P+""||null}return w.centroid=function(){var P=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,I=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-ag/2;return[ch(I)*P,_A(I)*P]},w.innerRadius=function(P){return arguments.length?(t=typeof P=="function"?P:$o(+P),w):t},w.outerRadius=function(P){return arguments.length?(e=typeof P=="function"?P:$o(+P),w):e},w.cornerRadius=function(P){return arguments.length?(n=typeof P=="function"?P:$o(+P),w):n},w.padRadius=function(P){return arguments.length?(r=P==null?null:typeof P=="function"?P:$o(+P),w):r},w.startAngle=function(P){return arguments.length?(i=typeof P=="function"?P:$o(+P),w):i},w.endAngle=function(P){return arguments.length?(s=typeof P=="function"?P:$o(+P),w):s},w.padAngle=function(P){return arguments.length?(A=typeof P=="function"?P:$o(+P),w):A},w.context=function(P){return arguments.length?(a=P??null,w):a},w}function dae(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function fz(t){this._context=t}fz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function dz(t){return new fz(t)}function pae(t){return t[0]}function gae(t){return t[1]}function mae(t,e){var n=$o(!0),r=null,i=dz,s=null,A=hz(a);t=typeof t=="function"?t:t===void 0?pae:$o(t),e=typeof e=="function"?e:e===void 0?gae:$o(e);function a(y){var w,P=(y=dae(y)).length,I,L=!1,U;for(r==null&&(s=i(U=A())),w=0;w<=P;++w)!(w<P&&n(I=y[w],w,y))===L&&((L=!L)?s.lineStart():s.lineEnd()),L&&s.point(+t(I,w,y),+e(I,w,y));if(U)return s=null,U+""||null}return a.x=function(y){return arguments.length?(t=typeof y=="function"?y:$o(+y),a):t},a.y=function(y){return arguments.length?(e=typeof y=="function"?y:$o(+y),a):e},a.defined=function(y){return arguments.length?(n=typeof y=="function"?y:$o(!!y),a):n},a.curve=function(y){return arguments.length?(i=y,r!=null&&(s=i(r)),a):i},a.context=function(y){return arguments.length?(y==null?r=s=null:s=i(r=y),a):r},a}var yae=gz(dz);function pz(t){this._curve=t}pz.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};function gz(t){function e(n){return new pz(t(n))}return e._curve=t,e}function _ae(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(n){return arguments.length?e(gz(n)):e()._curve},t}function gI(){return _ae(mae().curve(yae))}function mI(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function NT(t,e){this._context=t,this._k=(1-e)/6}NT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:mI(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:mI(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(r){return new NT(r,e)}return n.tension=function(r){return t(+r)},n})(0);function vae(t,e,n){var r=t._x1,i=t._y1,s=t._x2,A=t._y2;if(t._l01_a>Zs){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,y=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/y,i=(i*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/y}if(t._l23_a>Zs){var w=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,P=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*w+t._x1*t._l23_2a-e*t._l12_2a)/P,A=(A*w+t._y1*t._l23_2a-n*t._l12_2a)/P}t._context.bezierCurveTo(r,i,s,A,t._x2,t._y2)}function mz(t,e){this._context=t,this._alpha=e}mz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:vae(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const yI=function t(e){function n(r){return e?new mz(r,e):new NT(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function up(t,e,n){this.k=t,this.x=e,this.y=n}up.prototype={constructor:up,scale:function(t){return t===1?this:new up(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new up(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};up.prototype;const xae=new Uint16Array([0,2,1,0,3,2]),wae=new Float32Array([0,1,0,0,1,0,1,1]);function bae(t,e){if(!e)return Eae(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,s=Math.ceil(r/e)+1,A=(i-1)*(s-1)*6,a=new Uint32Array(A),y=new Float32Array(i*s*2),w=new Float64Array(i*s*3);let P=0,I=0;for(let L=0;L<i;L++){const U=L/(i-1);for(let W=0;W<s;W++){const q=W/(s-1),ae=Tae(t,U,q);w[P*3+0]=ae[0],w[P*3+1]=ae[1],w[P*3+2]=ae[2]||0,y[P*2+0]=U,y[P*2+1]=1-q,L>0&&W>0&&(a[I++]=P-s,a[I++]=P-s-1,a[I++]=P-1,a[I++]=P-s,a[I++]=P-1,a[I++]=P),P++}}return{vertexCount:A,positions:w,indices:a,texCoords:y}}function Eae(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:xae,texCoords:wae}}function Tae(t,e,n){return kA(kA(t[0],t[1],n),kA(t[3],t[2],n),e)}const Sae=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,Mae=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,Cae=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(Mae,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive && !picking_uAttribute) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),Pae={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:ar.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class lg extends Kl{constructor(...e){super(...e),se(this,"state",void 0)}getShaders(){return super.getShaders({vs:Sae,fs:Cae,modules:[nf,rf]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:r=>r.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:r=>r.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:r=>r.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:r}){const i=this.getAttributeManager();if(r.extensionsChanged){var s;const{gl:A}=this.context;(s=this.state.model)===null||s===void 0||s.delete(),this.state.model=this._getModel(A),i.invalidateAll()}if(e.bounds!==n.bounds){const A=this.state.mesh,a=this._createMesh();this.state.model.setVertexCount(a.vertexCount);for(const y in a)A&&A[y]!==a[y]&&i.invalidate(y);this.setState({mesh:a,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,r=e.info;if(!r.color||!n)return r.bitmap=null,r;const{width:i,height:s}=n;r.index=0;const A=Iae(r.color),a=[Math.floor(A[0]*i),Math.floor(A[1]*s)];return r.bitmap={size:{width:i,height:s},uv:A,pixel:a},r}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return _I(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),bae(n,this.context.viewport.resolution)}_getModel(e){return e?new Ou(e,{...this.getShaders(),id:this.props.id,geometry:new Pu({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:r}=e,{model:i,coordinateConversion:s,bounds:A,disablePicking:a}=this.state,{image:y,desaturate:w,transparentColor:P,tintColor:I}=this.props;r.pickingActive&&a||y&&i&&i.setUniforms(n).setUniforms({bitmapTexture:y,desaturate:w,transparentColor:P.map(L=>L/255),tintColor:I.slice(0,3).map(L=>L/255),coordinateConversion:s,bounds:A}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:r}=ar;let{_imageCoordinateSystem:i}=this.props;if(i!==r){const{bounds:s}=this.props;if(!_I(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const A=this.context.viewport.resolution?e:n;if(i=i===e?e:n,i===e&&A===n)return{coordinateConversion:-1,bounds:s};if(i===n&&A===e){const a=Yl([s[0],s[1]]),y=Yl([s[2],s[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],y[0],y[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}se(lg,"layerName","BitmapLayer");se(lg,"defaultProps",Pae);function Iae(t){const[e,n,r]=t,i=(r&240)/256,s=(r&15)/16;return[(e+s)/256,(n+i)/256]}function _I(t){return Number.isFinite(t[0])}const kae=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,Lae=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Dae=1024,Rae=4,vI=()=>{},xI={10241:9987,10240:9729,10242:33071,10243:33071};function Bae(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function zae(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),A=Math.floor(e.height*i);return i===1?{data:e,width:s,height:A}:(t.canvas.height=A,t.canvas.width=s,t.clearRect(0,0,s,A),t.drawImage(e,0,0,e.width,e.height,0,0,s,A),{data:t.canvas,width:s,height:A})}function Ag(t){return t&&(t.id||t.url)}function Oae(t,e,n,r){const i=t.width,s=t.height,A=new Jo(t.gl,{width:e,height:n,parameters:r});return FH(t,A,{targetY:0,width:i,height:s}),t.delete(),A}function wI(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],A=Ag(i);t[A]={...i,x:s,y:n}}}function Fae({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:A}){let a=[];for(let y=0;y<t.length;y++){const w=t[y],P=Ag(w);if(!n[P]){const{height:I,width:L}=w;r+L+e>A&&(wI(n,a,i),r=0,i=s+i+e,s=0,a=[]),a.push({icon:w,xOffset:r}),r=r+L+e,s=Math.max(s,I)}}return a.length>0&&wI(n,a,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:A,canvasHeight:Bae(s+i+e)}}function Nae(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=nd(t);for(const A of i){s.index++;const a=e(A,s),y=Ag(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[y]&&(!n[y]||a.url!==n[y].url)&&(r[y]={...a,source:A,sourceIndex:s.index})}return r}class Uae{constructor(e,{onUpdate:n=vI,onError:r=vI}){se(this,"gl",void 0),se(this,"onUpdate",void 0),se(this,"onError",void 0),se(this,"_loadOptions",null),se(this,"_texture",null),se(this,"_externalTexture",null),se(this,"_mapping",{}),se(this,"_textureParameters",null),se(this,"_pendingCount",0),se(this,"_autoPacking",!1),se(this,"_xOffset",0),se(this,"_yOffset",0),se(this,"_rowHeight",0),se(this,"_buffer",Rae),se(this,"_canvasWidth",Dae),se(this,"_canvasHeight",0),se(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Ag(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var A;(A=this._texture)===null||A===void 0||A.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(Nae(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:A,rowHeight:a,canvasHeight:y}=Fae({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=i,this._xOffset=s,this._yOffset=A,this._canvasHeight=y,this._texture||(this._texture=new Jo(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||xI})),this._texture.height!==this._canvasHeight&&(this._texture=Oae(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||xI)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,Ny(r.url,this._loadOptions).then(i=>{const s=Ag(r),A=this._mapping[s],{x:a,y,width:w,height:P}=A,{data:I,width:L,height:U}=zae(n,i,w,P);this._texture.setSubImageData({data:I,x:a+(w-L)/2,y:y+(P-U)/2,width:L,height:U}),A.width=L,A.height=U,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const yz=[0,0,0,255],Vae={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:yz},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class v2 extends Kl{constructor(...e){super(...e),se(this,"state",void 0)}getShaders(){return super.getShaders({vs:kae,fs:Lae,modules:[nf,rf]})}initializeState(){this.state={iconManager:new Uae(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:yz},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:A,iconMapping:a,data:y,getIcon:w,textureParameters:P}=n,{iconManager:I}=this.state,L=A||this.internalState.isAsyncPropLoading("iconAtlas");if(I.setProps({loadOptions:n.loadOptions,autoPacking:!L,iconAtlas:A,iconMapping:L?a:null,textureParameters:P}),L?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&I.packIcons(y,w),i.extensionsChanged){var U;const{gl:W}=this.context;(U=this.state.model)===null||U===void 0||U.delete(),this.state.model=this._getModel(W),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:A,alphaCutoff:a}=this.props,{iconManager:y}=this.state,w=y.getTexture();w&&this.state.model.setUniforms(e).setUniforms({iconsTexture:w,iconsTextureDim:[w.width,w.height],sizeUnits:Rh[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:A,alphaCutoff:a}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new Ou(e,{...this.getShaders(),id:this.props.id,geometry:new Pu({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):rr.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}se(v2,"defaultProps",Vae);se(v2,"layerName","IconLayer");const Gae=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,jae=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,bI=[0,0,0,255],$ae={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:bI},getLineColor:{type:"accessor",value:bI},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class UT extends Kl{getShaders(){return super.getShaders({vs:Gae,fs:jae,modules:[nf,rf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:A,filled:a,billboard:y,antialiasing:w,lineWidthUnits:P,lineWidthScale:I,lineWidthMinPixels:L,lineWidthMaxPixels:U}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:A?1:0,filled:a,billboard:y,antialiasing:w,radiusUnits:Rh[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:Rh[P],lineWidthScale:I,lineWidthMinPixels:L,lineWidthMaxPixels:U}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new Ou(e,{...this.getShaders(),id:this.props.id,geometry:new Pu({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}se(UT,"defaultProps",$ae);se(UT,"layerName","ScatterplotLayer");const _z={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function vz(t,e,n={}){return Hae(t,n)!==e?(Qae(t,n),!0):!1}function Hae(t,e={}){return Math.sign(Wae(t,e))}function Wae(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let A=n,a=r-i;A<r;A+=i)s+=(t[A]-t[a])*(t[A+1]+t[a+1]),a=A;return s/2}function Qae(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,A=Math.floor(s/2);for(let a=0;a<A;++a){const y=n+a*i,w=n+(s-1-a)*i;for(let P=0;P<i;++P){const I=t[y+P];t[y+P]=t[w+P],t[w+P]=I}}}function Gl(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function o3(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function ug(t,e,n,r,i=[]){const s=r+e*n;for(let A=0;A<n;A++)i[A]=t[s+A];return i}function a3(t,e,n,r,i=[]){let s,A;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),A=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),A=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),A=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),A=0;else return null;for(let a=0;a<t.length;a++)i[a]=(A&1)===a?r[A]:s*(e[a]-t[a])+t[a];return i}function J1(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function xz(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:A=0,endIndex:a=t.length}=e||{},y=(a-A)/n;let w=[];const P=[w],I=ug(t,0,n,A);let L,U;const W=bz(I,i,s,[]),q=[];Gl(w,I);for(let ae=1;ae<y;ae++){for(L=ug(t,ae,n,A,L),U=J1(L,W);U;){a3(I,L,U,W,q);const K=J1(q,W);K&&(a3(I,q,K,W,q),U=K),Gl(w,q),o3(I,q),Zae(W,i,U),r&&w.length>n&&(w=[],P.push(w),Gl(w,I)),U=J1(L,W)}Gl(w,L),o3(I,L)}return r?P:P[0]}const EI=0,qae=1;function o1(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function wz(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:A=!1}=n||{},a=[],y=[{pos:t,types:A?new Array(t.length/r).fill(qae):null,holes:e||[]}],w=[[],[]];let P=[];for(;y.length;){const{pos:I,types:L,holes:U}=y.shift();Yae(I,r,U[0]||I.length,w),P=bz(w[0],i,s,P);const W=J1(w[1],P);if(W){let q=TI(I,L,r,0,U[0]||I.length,P,W);const ae={pos:q[0].pos,types:q[0].types,holes:[]},K={pos:q[1].pos,types:q[1].types,holes:[]};y.push(ae,K);for(let ne=0;ne<U.length;ne++)q=TI(I,L,r,U[ne],U[ne+1]||I.length,P,W),q[0]&&(ae.holes.push(ae.pos.length),ae.pos=o1(ae.pos,q[0].pos),A&&(ae.types=o1(ae.types,q[0].types))),q[1]&&(K.holes.push(K.pos.length),K.pos=o1(K.pos,q[1].pos),A&&(K.types=o1(K.types,q[1].types)))}else{const q={positions:I};A&&(q.edgeTypes=L),U.length&&(q.holeIndices=U),a.push(q)}}return a}function TI(t,e,n,r,i,s,A){const a=(i-r)/n,y=[],w=[],P=[],I=[],L=[];let U,W,q;const ae=ug(t,a-1,n,r);let K=Math.sign(A&8?ae[1]-s[3]:ae[0]-s[2]),ne=e&&e[a-1],ie=0,fe=0;for(let ye=0;ye<a;ye++)U=ug(t,ye,n,r,U),W=Math.sign(A&8?U[1]-s[3]:U[0]-s[2]),q=e&&e[r/n+ye],W&&K&&K!==W&&(a3(ae,U,A,s,L),Gl(y,L)&&P.push(ne),Gl(w,L)&&I.push(ne)),W<=0?(Gl(y,U)&&P.push(q),ie-=W):P.length&&(P[P.length-1]=EI),W>=0?(Gl(w,U)&&I.push(q),fe+=W):I.length&&(I[I.length-1]=EI),o3(ae,U),K=W,ne=q;return[ie?{pos:y,types:e&&P}:null,fe?{pos:w,types:e&&I}:null]}function bz(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function Zae(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function Yae(t,e,n,r){let i=1/0,s=-1/0,A=1/0,a=-1/0;for(let y=0;y<n;y+=e){const w=t[y],P=t[y+1];i=w<i?w:i,s=w>s?w:s,A=P<A?P:A,a=P>a?P:a}return r[0][0]=i,r[0][1]=A,r[1][0]=s,r[1][1]=a,r}const Xae=85.051129;function Kae(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},A=t.slice(r,i);Ez(A,n,0,i-r);const a=xz(A,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const y of a)Tz(y,n);return a}function Jae(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const A=[],a=[];let y=0,w=0;for(let I=0;I<=e.length;I++){const L=e[I]||t.length,U=w,W=ele(t,r,y,L);for(let q=W;q<L;q++)A[w++]=t[q];for(let q=y;q<W;q++)A[w++]=t[q];Ez(A,r,U,w),tle(A,r,U,w,n?.maxLatitude),y=L,a[I]=w}a.pop();const P=wz(A,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const I of P)Tz(I.positions,r);return P}function ele(t,e,n,r){let i=-1,s=-1;for(let A=n+1;A<r;A+=e){const a=Math.abs(t[A]);a>i&&(i=a,s=A-1)}return s}function tle(t,e,n,r,i=Xae){const s=t[n],A=t[r-e];if(Math.abs(s-A)>180){const a=ug(t,0,e,n);a[0]+=Math.round((A-s)/360)*360,Gl(t,a),a[1]=Math.sign(a[1])*i,Gl(t,a),a[0]=s,Gl(t,a)}}function Ez(t,e,n,r){let i=t[0],s;for(let A=n;A<r;A+=e){s=t[A];const a=s-i;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[A]=i=s}}function Tz(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}function nle(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let A=0;A<t.length;A++)for(let a=0;a<e;a++)i[A*e+a]=t[A][a]||0}else i=t;return n?xz(i,{size:e,gridResolution:n}):r?Kae(i,{size:e}):i}const rle=1,ile=2,Hx=4;class sle extends aB{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?nle(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(SI(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&SI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:A}=n;r.fill(0,s,s+A),i?(r[s]=Hx,r[s+A-2]=Hx):(r[s]+=rle,r[s+A-2]+=ile),r[s+A-1]=Hx}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,A=new Array(3);for(let a=i,y=0;y<s;a++,y++)this.getPointOnPath(e,y,A),r[a*3]=A[0],r[a*3+1]=A[1],r[a*3+2]=A[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function SI(t){return Array.isArray(t[0])}const ole=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,ale=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Sz=[0,0,0,255],lle={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:Sz},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Wx={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class x2 extends Kl{constructor(...e){super(...e),se(this,"state",void 0)}getShaders(){return super.getShaders({vs:ole,fs:ale,modules:[nf,rf]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Wx,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Wx,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Wx,defaultValue:Sz},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new sle({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,y=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:y.getPath,buffers:y,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var A;const{gl:a}=this.context;(A=this.state.model)===null||A===void 0||A.delete(),this.state.model=this._getModel(a),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:A,widthScale:a,widthMinPixels:y,widthMaxPixels:w}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:Rh[A],widthScale:a,miterLimit:s,widthMinPixels:y,widthMaxPixels:w}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Ou(e,{...this.getShaders(),id:this.props.id,geometry:new Pu({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}se(x2,"defaultProps",lle);se(x2,"layerName","PathLayer");var VT={exports:{}};VT.exports=w2;VT.exports.default=w2;function w2(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=Mz(t,0,i,n,!0),A=[];if(!s||s.next===s.prev)return A;var a,y,w,P,I,L,U;if(r&&(s=fle(t,e,s,n)),t.length>80*n){a=w=t[0],y=P=t[1];for(var W=n;W<i;W+=n)I=t[W],L=t[W+1],I<a&&(a=I),L<y&&(y=L),I>w&&(w=I),L>P&&(P=L);U=Math.max(w-a,P-y),U=U!==0?32767/U:0}return cg(s,A,n,a,y,U,0),A}function Mz(t,e,n,r,i){var s,A;if(i===u3(t,e,n,r)>0)for(s=e;s<n;s+=r)A=MI(s,t[s],t[s+1],A);else for(s=n-r;s>=e;s-=r)A=MI(s,t[s],t[s+1],A);return A&&b2(A,A.next)&&(fg(A),A=A.next),A}function Hh(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(b2(n,n.next)||hi(n.prev,n,n.next)===0)){if(fg(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function cg(t,e,n,r,i,s,A){if(t){!A&&s&&yle(t,r,i,s);for(var a=t,y,w;t.prev!==t.next;){if(y=t.prev,w=t.next,s?ule(t,r,i,s):Ale(t)){e.push(y.i/n|0),e.push(t.i/n|0),e.push(w.i/n|0),fg(t),t=w.next,a=w.next;continue}if(t=w,t===a){A?A===1?(t=cle(Hh(t),e,n),cg(t,e,n,r,i,s,2)):A===2&&hle(t,e,n,r,i,s):cg(Hh(t),e,n,r,i,s,1);break}}}}function Ale(t){var e=t.prev,n=t,r=t.next;if(hi(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,A=r.x,a=e.y,y=n.y,w=r.y,P=i<s?i<A?i:A:s<A?s:A,I=a<y?a<w?a:w:y<w?y:w,L=i>s?i>A?i:A:s>A?s:A,U=a>y?a>w?a:w:y>w?y:w,W=r.next;W!==e;){if(W.x>=P&&W.x<=L&&W.y>=I&&W.y<=U&&Jf(i,a,s,y,A,w,W.x,W.y)&&hi(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function ule(t,e,n,r){var i=t.prev,s=t,A=t.next;if(hi(i,s,A)>=0)return!1;for(var a=i.x,y=s.x,w=A.x,P=i.y,I=s.y,L=A.y,U=a<y?a<w?a:w:y<w?y:w,W=P<I?P<L?P:L:I<L?I:L,q=a>y?a>w?a:w:y>w?y:w,ae=P>I?P>L?P:L:I>L?I:L,K=l3(U,W,e,n,r),ne=l3(q,ae,e,n,r),ie=t.prevZ,fe=t.nextZ;ie&&ie.z>=K&&fe&&fe.z<=ne;){if(ie.x>=U&&ie.x<=q&&ie.y>=W&&ie.y<=ae&&ie!==i&&ie!==A&&Jf(a,P,y,I,w,L,ie.x,ie.y)&&hi(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,fe.x>=U&&fe.x<=q&&fe.y>=W&&fe.y<=ae&&fe!==i&&fe!==A&&Jf(a,P,y,I,w,L,fe.x,fe.y)&&hi(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;ie&&ie.z>=K;){if(ie.x>=U&&ie.x<=q&&ie.y>=W&&ie.y<=ae&&ie!==i&&ie!==A&&Jf(a,P,y,I,w,L,ie.x,ie.y)&&hi(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;fe&&fe.z<=ne;){if(fe.x>=U&&fe.x<=q&&fe.y>=W&&fe.y<=ae&&fe!==i&&fe!==A&&Jf(a,P,y,I,w,L,fe.x,fe.y)&&hi(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function cle(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!b2(i,s)&&Cz(i,r,r.next,s)&&hg(i,s)&&hg(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),fg(r),fg(r.next),r=t=s),r=r.next}while(r!==t);return Hh(r)}function hle(t,e,n,r,i,s){var A=t;do{for(var a=A.next.next;a!==A.prev;){if(A.i!==a.i&&xle(A,a)){var y=Pz(A,a);A=Hh(A,A.next),y=Hh(y,y.next),cg(A,e,n,r,i,s,0),cg(y,e,n,r,i,s,0);return}a=a.next}A=A.next}while(A!==t)}function fle(t,e,n,r){var i=[],s,A,a,y,w;for(s=0,A=e.length;s<A;s++)a=e[s]*r,y=s<A-1?e[s+1]*r:t.length,w=Mz(t,a,y,r,!1),w===w.next&&(w.steiner=!0),i.push(vle(w));for(i.sort(dle),s=0;s<i.length;s++)n=ple(i[s],n);return n}function dle(t,e){return t.x-e.x}function ple(t,e){var n=gle(t,e);if(!n)return e;var r=Pz(n,t);return Hh(r,r.next),Hh(n,n.next)}function gle(t,e){var n=e,r=t.x,i=t.y,s=-1/0,A;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s&&(s=a,A=n.x<n.next.x?n:n.next,a===r))return A}n=n.next}while(n!==e);if(!A)return null;var y=A,w=A.x,P=A.y,I=1/0,L;n=A;do r>=n.x&&n.x>=w&&r!==n.x&&Jf(i<P?r:s,i,w,P,i<P?s:r,i,n.x,n.y)&&(L=Math.abs(i-n.y)/(r-n.x),hg(n,t)&&(L<I||L===I&&(n.x>A.x||n.x===A.x&&mle(A,n)))&&(A=n,I=L)),n=n.next;while(n!==y);return A}function mle(t,e){return hi(t.prev,t,e.prev)<0&&hi(e.next,t,t.next)<0}function yle(t,e,n,r){var i=t;do i.z===0&&(i.z=l3(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,_le(i)}function _le(t){var e,n,r,i,s,A,a,y,w=1;do{for(n=t,t=null,s=null,A=0;n;){for(A++,r=n,a=0,e=0;e<w&&(a++,r=r.nextZ,!!r);e++);for(y=w;a>0||y>0&&r;)a!==0&&(y===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,y--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,w*=2}while(A>1);return t}function l3(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function vle(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Jf(t,e,n,r,i,s,A,a){return(i-A)*(e-a)>=(t-A)*(s-a)&&(t-A)*(r-a)>=(n-A)*(e-a)&&(n-A)*(s-a)>=(i-A)*(r-a)}function xle(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!wle(t,e)&&(hg(t,e)&&hg(e,t)&&ble(t,e)&&(hi(t.prev,t,e.prev)||hi(t,e.prev,e))||b2(t,e)&&hi(t.prev,t,t.next)>0&&hi(e.prev,e,e.next)>0)}function hi(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b2(t,e){return t.x===e.x&&t.y===e.y}function Cz(t,e,n,r){var i=l1(hi(t,e,n)),s=l1(hi(t,e,r)),A=l1(hi(n,r,t)),a=l1(hi(n,r,e));return!!(i!==s&&A!==a||i===0&&a1(t,n,e)||s===0&&a1(t,r,e)||A===0&&a1(n,t,r)||a===0&&a1(n,e,r))}function a1(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function l1(t){return t>0?1:t<0?-1:0}function wle(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Cz(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function hg(t,e){return hi(t.prev,t,t.next)<0?hi(t,e,t.next)>=0&&hi(t,t.prev,e)>=0:hi(t,e,t.prev)<0||hi(t,t.next,e)<0}function ble(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function Pz(t,e){var n=new A3(t.i,t.x,t.y),r=new A3(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function MI(t,e,n,r){var i=new A3(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function fg(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function A3(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}w2.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,A=Math.abs(u3(t,0,s,n));if(i)for(var a=0,y=e.length;a<y;a++){var w=e[a]*n,P=a<y-1?e[a+1]*n:t.length;A-=Math.abs(u3(t,w,P,n))}var I=0;for(a=0;a<r.length;a+=3){var L=r[a]*n,U=r[a+1]*n,W=r[a+2]*n;I+=Math.abs((t[L]-t[W])*(t[U+1]-t[L+1])-(t[L]-t[U])*(t[W+1]-t[L+1]))}return A===0&&I===0?0:Math.abs((I-A)/A)};function u3(t,e,n,r){for(var i=0,s=e,A=n-r;s<n;s+=r)i+=(t[A]-t[s])*(t[s+1]+t[A+1]),A=s;return i}w2.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var A=0;A<e;A++)n.vertices.push(t[i][s][A]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var Ele=VT.exports;const Tle=G_(Ele),A1=_z.CLOCKWISE,CI=_z.COUNTER_CLOCKWISE,Ic={isClosed:!0};function Sle(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function cp(t){return"positions"in t?t.positions:t}function ey(t){return"holeIndices"in t?t.holeIndices:null}function Mle(t){return Array.isArray(t[0])}function Cle(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function Ple(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function Ile(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function PI(t,e,n,r,i){let s=e;const A=n.length;for(let a=0;a<A;a++)for(let y=0;y<r;y++)t[s++]=n[a][y]||0;if(!Ple(n))for(let a=0;a<r;a++)t[s++]=n[0][a]||0;return Ic.start=e,Ic.end=s,Ic.size=r,vz(t,i,Ic),s}function II(t,e,n,r,i=0,s,A){s=s||n.length;const a=s-i;if(a<=0)return e;let y=e;for(let w=0;w<a;w++)t[y++]=n[i+w];if(!Ile(n,r,i,s))for(let w=0;w<r;w++)t[y++]=n[i+w];return Ic.start=e,Ic.end=y,Ic.size=r,vz(t,A,Ic),y}function Iz(t,e){Sle(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let A=0;for(let a=0;a<=s.length;a++)A=II(n,A,i,e,s[a-1],s[a],a===0?A1:CI),r.push(A);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!Mle(t))return II(n,0,t,e,0,n.length,A1),n;if(!Cle(t)){let i=0;for(const[s,A]of t.entries())i=PI(n,i,A,e,s===0?A1:CI),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return PI(n,0,t,e,A1),n}function Qx(t,e,n){const r=t.length/3;let i=0;for(let s=0;s<r;s++){const A=(s+1)%r;i+=t[s*3+e]*t[A*3+n],i-=t[A*3+e]*t[s*3+n]}return Math.abs(i/2)}function kI(t,e,n,r){const i=t.length/3;for(let s=0;s<i;s++){const A=s*3,a=t[A+0],y=t[A+1],w=t[A+2];t[A+e]=a,t[A+n]=y,t[A+r]=w}}function kle(t,e,n,r){let i=ey(t);i&&(i=i.map(a=>a/e));let s=cp(t);const A=r&&e===3;if(n){const a=s.length;s=s.slice();const y=[];for(let w=0;w<a;w+=e){y[0]=s[w],y[1]=s[w+1],A&&(y[2]=s[w+2]);const P=n(y);s[w]=P[0],s[w+1]=P[1],A&&(s[w+2]=P[2])}}if(A){const a=Qx(s,0,1),y=Qx(s,0,2),w=Qx(s,1,2);if(!a&&!y&&!w)return[];a>y&&a>w||(y>w?(n||(s=s.slice()),kI(s,0,2,1)):(n||(s=s.slice()),kI(s,2,0,1)))}return Tle(s,i,e)}class Lle extends aB{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=Iz(e,this.positionSize);return this.opts.resolution?wz(cp(n),ey(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?Jae(cp(n),ey(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(LI(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return cp(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&LI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:A,typedArrayManager:a}=this;let y=s.indices;if(!y||!e)return;let w=i;const P=kle(e,this.positionSize,this.opts.preproject,this.opts.full3d);y=a.allocate(y,i+P.length,{copy:!0});for(let I=0;I<P.length;I++)y[w++]=P[I]+r;A[n+1]=i+P.length,s.indices=y}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const A=cp(e);for(let a=n,y=0;y<r;a++,y++){const w=A[y*s],P=A[y*s+1],I=s>2?A[y*s+2]:0;i[a*3]=w,i[a*3+1]=P,i[a*3+2]=I}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,A=e&&ey(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),A)for(let a=0;a<A.length;a++)s[n+A[a]/i-1]=0;s[n+r-1]=0}}function LI(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const kz=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Dle=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(kz,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),Rle=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(kz,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),Ble=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,g_=[0,0,0,255],zle={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:g_},getLineColor:{type:"accessor",value:g_},material:!0},u1={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class E2 extends Kl{constructor(...e){super(...e),se(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?Dle:Rle,fs:Ble,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[nf,GZ,rf]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===ar.DEFAULT&&(r=ar.LNGLAT);let s;r===ar.LNGLAT&&(i?s=n.projectPosition.bind(n):s=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new Lle({preproject:s,fp64:this.use64bitPositions(),IndexType:!e||eT(e,Qr.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const A=this.getAttributeManager(),a=!0;A.remove(["instancePickingColors"]),A.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:a},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:u1,accessor:"getPolygon",update:this.calculatePositions,noAlloc:a,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:a},elevations:{size:1,transition:u1,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:u1,accessor:"getFillColor",defaultValue:g_,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:u1,accessor:"getLineColor",defaultValue:g_,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(y,{index:w,target:P})=>this.encodePickingColor(y&&y.__source?y.__source.index:w,P),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:A,sideModel:a,polygonTesselator:y}=this.state,w={...e,extruded:!!n,elevationScale:s};a&&(a.setInstanceCount(y.instanceCount-1),a.setUniforms(w),i&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),r&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),A&&(A.setVertexCount(y.vertexCount),A.setUniforms(w).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var a;(a=this.state.models)===null||a===void 0||a.forEach(y=>y.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,A=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:A.getPolygon,buffers:A,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let s,A;if(r){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1,s=new Ou(e,{...a,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(A=new Ou(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Pu({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),A.userData.excludeAttributes={indices:!0}),{models:[A,s].filter(Boolean),topModel:s,sideModel:A}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}se(E2,"defaultProps",zle);se(E2,"layerName","SolidPolygonLayer");function Lz({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,A=t.length;let a=A,y=A;for(let L=0;L<A;L++){const U=e(t[L]);if(a>L&&U>=i&&(a=L),U>=s){y=L;break}}let w=a;const I=y-a!==r.length?t.slice(y):void 0;for(let L=0;L<r.length;L++)t[w++]=r[L];if(I){for(let L=0;L<I.length;L++)t[w++]=I[L];t.length=w}return{startRow:a,endRow:a+r.length}}const Dz=[0,0,0,255],Ole=[0,0,0,255],Fle={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:Ole},getLineColor:{type:"accessor",value:Dz},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class Zg extends Li{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&rr.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(s=>Lz({data:r,getIndex:A=>A.__source.index,dataRange:s,replace:this._getPaths(s)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:s}=this.props,A=[],a=i==="XY"?2:3,{startRow:y,endRow:w}=e,{iterable:P,objectInfo:I}=nd(n,y,w);for(const L of P){I.index++;let U=r(L,I);s&&(U=Iz(U,a));const{holeIndices:W}=U,q=U.positions||U;if(W)for(let ae=0;ae<=W.length;ae++){const K=q.slice(W[ae-1]||0,W[ae]||q.length);A.push(this.getSubLayerRow({path:K},L,I.index))}else A.push(this.getSubLayerRow({path:q},L,I.index))}return A}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:s,wireframe:A,_normalize:a,_windingOrder:y,elevationScale:w,transitions:P,positionFormat:I}=this.props,{lineWidthUnits:L,lineWidthScale:U,lineWidthMinPixels:W,lineWidthMaxPixels:q,lineJointRounded:ae,lineMiterLimit:K,lineDashJustified:ne}=this.props,{getFillColor:ie,getLineColor:fe,getLineWidth:ye,getLineDashArray:Me,getElevation:He,getPolygon:Qe,updateTriggers:Je,material:tt}=this.props,{paths:Ne,pathsDiff:nt}=this.state,qe=this.getSubLayerClass("fill",E2),mt=this.getSubLayerClass("stroke",x2),Xt=this.shouldRenderSubLayer("fill",Ne)&&new qe({_dataDiff:n,extruded:s,elevationScale:w,filled:i,wireframe:A,_normalize:a,_windingOrder:y,getElevation:He,getFillColor:ie,getLineColor:s&&A?fe:Dz,material:tt,transitions:P},this.getSubLayerProps({id:"fill",updateTriggers:Je&&{getPolygon:Je.getPolygon,getElevation:Je.getElevation,getFillColor:Je.getFillColor,lineColors:s&&A,getLineColor:Je.getLineColor}}),{data:e,positionFormat:I,getPolygon:Qe}),Et=!s&&r&&this.shouldRenderSubLayer("stroke",Ne)&&new mt({_dataDiff:nt&&(()=>nt),widthUnits:L,widthScale:U,widthMinPixels:W,widthMaxPixels:q,jointRounded:ae,miterLimit:K,dashJustified:ne,_pathType:"loop",transitions:P&&{getWidth:P.getLineWidth,getColor:P.getLineColor,getPath:P.getPolygon},getColor:this.getSubLayerAccessor(fe),getWidth:this.getSubLayerAccessor(ye),getDashArray:this.getSubLayerAccessor(Me)},this.getSubLayerProps({id:"stroke",updateTriggers:Je&&{getWidth:Je.getLineWidth,getColor:Je.getLineColor,getDashArray:Je.getLineDashArray}}),{data:Ne,positionFormat:I,getPath:fn=>fn.path});return[!s&&Xt,Et,s&&Xt]}}se(Zg,"layerName","PolygonLayer");se(Zg,"defaultProps",Fle);function Nle(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?Ule(t,r,n):null}function Ule(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function Vle(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let A=0;A<i.length;A++)e(i[A],s),n[r][A*3+0]=s[0],n[r][A*3+1]=s[1],n[r][A*3+2]=s[2]}return n}const Gle=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,qx=192/256,DI=[],jle={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class GT extends v2{constructor(...e){super(...e),se(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:Gle}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&rr.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,A=i?Math.max(r,qx*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:qx,outlineBuffer:A,gamma:r,sdf:!!n,outlineColor:s},super.draw(e),n&&i){const{iconManager:a}=this.state;a.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:qx}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):DI}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):DI}}se(GT,"defaultProps",jle);se(GT,"layerName","MultiIconLayer");const kp=1e20;class $le{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:A="normal",fontStyle:a="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const y=this.size=e+n*4,w=this._createCanvas(y),P=this.ctx=w.getContext("2d",{willReadFrequently:!0});P.font=`${a} ${A} ${e}px ${s}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:A}=this.ctx.measureText(e),a=Math.ceil(r),y=0,w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(A-s))),P=Math.min(this.size-this.buffer,a+Math.ceil(i)),I=w+2*this.buffer,L=P+2*this.buffer,U=Math.max(I*L,0),W=new Uint8ClampedArray(U),q={data:W,width:I,height:L,glyphWidth:w,glyphHeight:P,glyphTop:a,glyphLeft:y,glyphAdvance:n};if(w===0||P===0)return q;const{ctx:ae,buffer:K,gridInner:ne,gridOuter:ie}=this;ae.clearRect(K,K,w,P),ae.fillText(e,K,K+a);const fe=ae.getImageData(K,K,w,P);ie.fill(kp,0,U),ne.fill(0,0,U);for(let ye=0;ye<P;ye++)for(let Me=0;Me<w;Me++){const He=fe.data[4*(ye*w+Me)+3]/255;if(He===0)continue;const Qe=(ye+K)*I+Me+K;if(He===1)ie[Qe]=0,ne[Qe]=kp;else{const Je=.5-He;ie[Qe]=Je>0?Je*Je:0,ne[Qe]=Je<0?Je*Je:0}}RI(ie,0,0,I,L,I,this.f,this.v,this.z),RI(ne,K,K,w,P,I,this.f,this.v,this.z);for(let ye=0;ye<U;ye++){const Me=Math.sqrt(ie[ye])-Math.sqrt(ne[ye]);W[ye]=Math.round(255-255*(Me/this.radius+this.cutoff))}return q}}function RI(t,e,n,r,i,s,A,a,y){for(let w=e;w<e+r;w++)BI(t,n*s+w,s,i,A,a,y);for(let w=n;w<n+i;w++)BI(t,w*s+e,1,r,A,a,y)}function BI(t,e,n,r,i,s,A){s[0]=0,A[0]=-kp,A[1]=kp,i[0]=t[e];for(let a=1,y=0,w=0;a<r;a++){i[a]=t[e+a*n];const P=a*a;do{const I=s[y];w=(i[a]-i[I]+P-I*I)/(a-I)/2}while(w<=A[y]&&--y>-1);y++,s[y]=a,A[y]=w,A[y+1]=kp}for(let a=0,y=0;a<r;a++){for(;A[y+1]<a;)y++;const w=s[y],P=a-w;t[e+a*n]=i[w]+P*P}}const Hle=32,Wle=[];function Qle(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function qle({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:A=0,yOffset:a=0}){let y=0,w=A;const P=n+r*2;for(const I of t)if(!s[I]){const L=e(I);w+L+r*2>i&&(w=0,y++),s[I]={x:w+r,y:a+y*P+r,width:L,height:P,layoutWidth:L,layoutHeight:n},w+=L+r*2}return{mapping:s,xOffset:w,yOffset:a+y*P,canvasHeight:Qle(a+(y+1)*P)}}function Rz(t,e,n,r){let i=0;for(let A=e;A<n;A++){var s;const a=t[A];i+=((s=r[a])===null||s===void 0?void 0:s.layoutWidth)||0}return i}function Bz(t,e,n,r,i,s){let A=e,a=0;for(let y=e;y<n;y++){const w=Rz(t,y,y+1,i);a+w>r&&(A<y&&s.push(y),A=y,a=0),a+=w}return a}function Zle(t,e,n,r,i,s){let A=e,a=e,y=e,w=0;for(let P=e;P<n;P++)if((t[P]===" "||t[P+1]===" "||P+1===n)&&(y=P+1),y>a){let I=Rz(t,a,y,i);w+I>r&&(A<a&&(s.push(a),A=a,w=0),I>r&&(I=Bz(t,a,y,r,i,s),A=s[s.length-1])),a=y,w+=I}return w}function Yle(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const A=[];return e==="break-all"?Bz(t,i,s,n,r,A):Zle(t,i,s,n,r,A),A}function Xle(t,e,n,r,i,s){let A=0,a=0;for(let y=e;y<n;y++){const w=t[y],P=r[w];P?(a||(a=P.layoutHeight),i[y]=A+P.layoutWidth/2,A+=P.layoutWidth):(rr.warn("Missing character: ".concat(w," (").concat(w.codePointAt(0),")"))(),i[y]=A,A+=Hle)}s[0]=A,s[1]=a}function Kle(t,e,n,r,i){const s=Array.from(t),A=s.length,a=new Array(A),y=new Array(A),w=new Array(A),P=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,I=[0,0],L=[0,0];let U=0,W=0,q=0;for(let K=0;K<=A;K++){const ne=s[K];if((ne===`
`||K===A)&&(q=K),q>W){const ie=P?Yle(s,n,r,i,W,q):Wle;for(let fe=0;fe<=ie.length;fe++){const ye=fe===0?W:ie[fe-1],Me=fe<ie.length?ie[fe]:q;Xle(s,ye,Me,i,a,L);for(let He=ye;He<Me;He++){var ae;const Qe=s[He],Je=((ae=i[Qe])===null||ae===void 0?void 0:ae.layoutOffsetY)||0;y[He]=U+L[1]/2+Je,w[He]=L[0]}U=U+L[1]*e,I[0]=Math.max(I[0],L[0])}W=q}ne===`
`&&(a[W]=0,y[W]=0,w[W]=0,W++)}return I[1]=U,{x:a,y,rowWidth:w,size:I}}function Jle({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const A=t.BYTES_PER_ELEMENT,a=n?n/A:1,y=r?r/A:0,w=i[e]||Math.ceil((t.length-y)/a),P=s&&new Set,I=new Array(e);let L=t;if(a>1||y>0){const U=t.constructor;L=new U(w);for(let W=0;W<w;W++)L[W]=t[W*a+y]}for(let U=0;U<e;U++){const W=i[U],q=i[U+1]||w,ae=L.subarray(W,q);I[U]=String.fromCodePoint.apply(null,ae),P&&ae.forEach(P.add,P)}if(P)for(const U of P)s.add(String.fromCodePoint(U));return{texts:I,characterCount:w}}class zz{constructor(e=5){se(this,"limit",void 0),se(this,"_cache",{}),se(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function eAe(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const v0={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:eAe(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},zI=1024,OI=.9,FI=1.2,Oz=3;let m_=new zz(Oz);function tAe(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=m_.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function nAe(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function NI(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function rAe(t){rr.assert(Number.isFinite(t)&&t>=Oz,"Invalid cache limit"),m_=new zz(t)}class iAe{constructor(){se(this,"props",{...v0}),se(this,"_key",void 0),se(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*FI+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=tAe(this._key,this.props.characterSet),r=m_.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,m_.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:A,sdf:a,radius:y,cutoff:w}=this.props;let P=n&&n.data;P||(P=document.createElement("canvas"),P.width=zI);const I=P.getContext("2d",{willReadFrequently:!0});NI(I,r,s,i);const{mapping:L,canvasHeight:U,xOffset:W,yOffset:q}=qle({getFontWidth:ae=>I.measureText(ae).width,fontHeight:s*FI,buffer:A,characterSet:e,maxCanvasWidth:zI,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(P.height!==U){const ae=I.getImageData(0,0,P.width,P.height);P.height=U,I.putImageData(ae,0,0)}if(NI(I,r,s,i),a){const ae=new $le({fontSize:s,buffer:A,radius:y,cutoff:w,fontFamily:r,fontWeight:"".concat(i)});for(const K of e){const{data:ne,width:ie,height:fe,glyphTop:ye}=ae.draw(K);L[K].width=ie,L[K].layoutOffsetY=s*OI-ye;const Me=I.createImageData(ie,fe);nAe(ne,Me),I.putImageData(Me,L[K].x,L[K].y)}}else for(const ae of e)I.fillText(ae,L[ae].x,L[ae].y+A+s*OI);return{xOffset:W,yOffset:q,mapping:L,data:P,width:P.width,height:P.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:A,cutoff:a}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(A," ").concat(a):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const sAe=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,oAe=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,aAe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class jT extends Kl{constructor(...e){super(...e),se(this,"state",void 0)}getShaders(){return super.getShaders({vs:sAe,fs:oAe,modules:[nf,rf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:A,getLineWidth:a}=this.props;let{padding:y}=this.props;y.length<4&&(y=[y[0],y[1],y[0],y[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!a,padding:y,sizeUnits:Rh[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:A}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new Ou(e,{...this.getShaders(),id:this.props.id,geometry:new Pu({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}se(jT,"defaultProps",aAe);se(jT,"layerName","TextBackgroundLayer");const UI={start:1,middle:0,end:-1},VI={top:1,center:0,bottom:-1},Zx=[0,0,0,255],lAe=1,AAe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Zx},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:v0.characterSet},fontFamily:v0.fontFamily,fontWeight:v0.fontWeight,lineHeight:lAe,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Zx},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Zx},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class $T extends Li{constructor(...e){super(...e),se(this,"state",void 0),se(this,"getBoundingRect",(n,r)=>{let{size:[i,s]}=this.transformParagraph(n,r);const{fontSize:A}=this.state.fontAtlasManager.props;i/=A,s/=A;const{getTextAnchor:a,getAlignmentBaseline:y}=this.props,w=UI[typeof a=="function"?a(n,r):a],P=VI[typeof y=="function"?y(n,r):y];return[(w-1)*i/2,(P-1)*s/2,i,s]}),se(this,"getIconOffsets",(n,r)=>{const{getTextAnchor:i,getAlignmentBaseline:s}=this.props,{x:A,y:a,rowWidth:y,size:[w,P]}=this.transformParagraph(n,r),I=UI[typeof i=="function"?i(n,r):i],L=VI[typeof s=="function"?s(n,r):s],U=A.length,W=new Array(U*2);let q=0;for(let ae=0;ae<U;ae++){const K=(1-I)*(w-y[ae])/2;W[q++]=(I-1)*w/2+K+A[ae],W[q++]=(L-1)*P/2+a[ae]}return W})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new iAe},this.props.maxWidth>0&&rr.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,A={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(A),!0;for(const a in A)if(A[a]!==i.props[a])return i.setProps(A),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,A=n.startIndices,a;const y=r==="auto"&&new Set;if(i&&A){const{texts:w,characterCount:P}=Jle({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:A,characterSet:y});a=P,s=(I,{index:L})=>w[L]}else{const{iterable:w,objectInfo:P}=nd(n);A=[0],a=0;for(const I of w){P.index++;const L=Array.from(s(I,P)||"");y&&L.forEach(y.add,y),a+=L.length,A.push(a)}}this.setState({getText:s,startIndices:A,numInstances:a,characterSet:y||r})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:A,lineHeight:a,maxWidth:y}=this.props,w=s(e,n)||"";return Kle(w,a,A,y*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:A},styleVersion:a}=this.state,{data:y,_dataDiff:w,getPosition:P,getColor:I,getSize:L,getAngle:U,getPixelOffset:W,getBackgroundColor:q,getBorderColor:ae,getBorderWidth:K,backgroundPadding:ne,background:ie,billboard:fe,fontSettings:ye,outlineWidth:Me,outlineColor:He,sizeScale:Qe,sizeUnits:Je,sizeMinPixels:tt,sizeMaxPixels:Ne,transitions:nt,updateTriggers:qe}=this.props,mt=this.getSubLayerClass("characters",GT),Xt=this.getSubLayerClass("background",jT);return[ie&&new Xt({getFillColor:q,getLineColor:ae,getLineWidth:K,padding:ne,getPosition:P,getSize:L,getAngle:U,getPixelOffset:W,billboard:fe,sizeScale:Qe,sizeUnits:Je,sizeMinPixels:tt,sizeMaxPixels:Ne,transitions:nt&&{getPosition:nt.getPosition,getAngle:nt.getAngle,getSize:nt.getSize,getFillColor:nt.getBackgroundColor,getLineColor:nt.getBorderColor,getLineWidth:nt.getBorderWidth,getPixelOffset:nt.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:qe.getPosition,getAngle:qe.getAngle,getSize:qe.getSize,getFillColor:qe.getBackgroundColor,getLineColor:qe.getBorderColor,getLineWidth:qe.getBorderWidth,getPixelOffset:qe.getPixelOffset,getBoundingRect:{getText:qe.getText,getTextAnchor:qe.getTextAnchor,getAlignmentBaseline:qe.getAlignmentBaseline,styleVersion:a}}}),{data:y.attributes&&y.attributes.background?{length:y.length,attributes:y.attributes.background}:y,_dataDiff:w,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new mt({sdf:ye.sdf,smoothing:Number.isFinite(ye.smoothing)?ye.smoothing:v0.smoothing,outlineWidth:Me/(ye.radius||v0.radius),outlineColor:He,iconAtlas:s,iconMapping:A,getPosition:P,getColor:I,getSize:L,getAngle:U,getPixelOffset:W,billboard:fe,sizeScale:Qe*i,sizeUnits:Je,sizeMinPixels:tt*i,sizeMaxPixels:Ne*i,transitions:nt&&{getPosition:nt.getPosition,getAngle:nt.getAngle,getColor:nt.getColor,getSize:nt.getSize,getPixelOffset:nt.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:qe.getText,getPosition:qe.getPosition,getAngle:qe.getAngle,getColor:qe.getColor,getSize:qe.getSize,getPixelOffset:qe.getPixelOffset,getIconOffsets:{getTextAnchor:qe.getTextAnchor,getAlignmentBaseline:qe.getAlignmentBaseline,styleVersion:a}}}),{data:y,_dataDiff:w,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){rAe(e)}}se($T,"defaultProps",AAe);se($T,"layerName","TextLayer");const ty={circle:{type:UT,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:v2,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:$T,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},ny={type:x2,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},c3={type:E2,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Hd({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function Yx(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const A=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[A]=r[s],n&&(i.transitions[A]=n[s])),i[A]=a}return i}function uAe(t){if(Array.isArray(t))return t;switch(rr.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return rr.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function GI(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let A=i;A<s;A++){const a=t[A],{geometry:y}=a;if(y)if(y.type==="GeometryCollection"){rr.assert(Array.isArray(y.geometries),"GeoJSON does not have geometries array");const{geometries:w}=y;for(let P=0;P<w.length;P++){const I=w[P];jI(I,r,e,a,A)}}else jI(y,r,e,a,A)}return r}function jI(t,e,n,r,i){const{type:s,coordinates:A}=t,{pointFeatures:a,lineFeatures:y,polygonFeatures:w,polygonOutlineFeatures:P}=e;if(!hAe(s,A)){rr.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":a.push(n({geometry:t},r,i));break;case"MultiPoint":A.forEach(I=>{a.push(n({geometry:{type:"Point",coordinates:I}},r,i))});break;case"LineString":y.push(n({geometry:t},r,i));break;case"MultiLineString":A.forEach(I=>{y.push(n({geometry:{type:"LineString",coordinates:I}},r,i))});break;case"Polygon":w.push(n({geometry:t},r,i)),A.forEach(I=>{P.push(n({geometry:{type:"LineString",coordinates:I}},r,i))});break;case"MultiPolygon":A.forEach(I=>{w.push(n({geometry:{type:"Polygon",coordinates:I}},r,i)),I.forEach(L=>{P.push(n({geometry:{type:"LineString",coordinates:L}},r,i))})});break}}const cAe={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function hAe(t,e){let n=cAe[t];for(rr.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function Fz(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function c1(t){return t.geometry.coordinates}function fAe(t,e){const n=Fz(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:A}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=c1,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=c1,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=c1,n.polygonsOutline.data=A,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=c1,n}function dAe(t,e){const n=Fz(),{points:r,lines:i,polygons:s}=t,A=Vle(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:A.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:A.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:A.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:A.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const pAe=["points","linestrings","polygons"],gAe={...Hd(ty.circle),...Hd(ty.icon),...Hd(ty.text),...Hd(ny),...Hd(c3),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class Gc extends Li{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=dAe(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=uAe(e.data),i=this.getSubLayerRow.bind(this);let s={};const A={};if(Array.isArray(n.dataChanged)){const y=this.state.features;for(const w in y)s[w]=y[w].slice(),A[w]=[];for(const w of n.dataChanged){const P=GI(r,i,w);for(const I in y)A[I].push(Lz({data:s[I],getIndex:L=>L.__source.index,dataRange:w,replace:P[I]}))}}else s=GI(r,i);const a=fAe(s,A);this.setState({features:s,featuresDiff:A,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=pAe.find(s=>i.id.startsWith("".concat(this.id,"-").concat(s,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,c3.type);if(s){const A=Yx(this,c3.props),a=e&&n;return a||delete A.getLineColor,A.updateTriggers.lineColors=a,new s(A,this.getSubLayerProps({id:i,updateTriggers:A.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",A=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,ny.type),a=this.shouldRenderSubLayer(s,r.lines.data)&&this.getSubLayerClass(s,ny.type);if(A||a){const y=Yx(this,ny.props);return[A&&new A(y,this.getSubLayerProps({id:i,updateTriggers:y.updateTriggers}),r.polygonsOutline),a&&new a(y,this.getSubLayerProps({id:s,updateTriggers:y.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(a=>a.__source.index===i));const s=new Set(e.split("+")),A=[];for(const a of s){const y="points-".concat(a),w=ty[a],P=w&&this.shouldRenderSubLayer(y,n.points.data)&&this.getSubLayerClass(y,w.type);if(P){const I=Yx(this,w.props);let L=n.points;if(a==="text"&&r){const{instancePickingColors:U,...W}=L.data.attributes;L={...L,data:{...L.data,attributes:W}}}A.push(new P(I,this.getSubLayerProps({id:y,updateTriggers:I.updateTriggers,highlightedObjectIndex:i}),L))}}return A}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:A}=i,a=Nle(s,A);return e(a,i)}}}se(Gc,"layerName","GeoJsonLayer");se(Gc,"defaultProps",gAe);class mAe{constructor(e){se(this,"index",void 0),se(this,"isVisible",void 0),se(this,"isSelected",void 0),se(this,"parent",void 0),se(this,"children",void 0),se(this,"content",void 0),se(this,"state",void 0),se(this,"layers",void 0),se(this,"id",void 0),se(this,"zoom",void 0),se(this,"userData",void 0),se(this,"boundingBox",void 0),se(this,"_abortController",void 0),se(this,"_loader",void 0),se(this,"_loaderId",void 0),se(this,"_isLoaded",void 0),se(this,"_isCancelled",void 0),se(this,"_needsReload",void 0),se(this,"_bbox",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:n,onLoad:r,onError:i}){const{index:s,id:A,bbox:a,userData:y,zoom:w}=this,P=this._loaderId;this._abortController=new AbortController;const{signal:I}=this._abortController,L=await n.scheduleRequest(this,q=>q.isSelected?1:-1);if(!L){this._isCancelled=!0;return}if(this._isCancelled){L.done();return}let U=null,W;try{U=await e({index:s,id:A,bbox:a,userData:y,zoom:w,signal:I})}catch(q){W=q||!0}finally{L.done()}if(P===this._loaderId){if(this._loader=void 0,this.content=U,this._isCancelled&&!U){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,W?i(W,this):r(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const Ks={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},$I=new ln,yAe=new ln;class HT{constructor(e=[0,0,0],n=[0,0,0],r){se(this,"center",void 0),se(this,"halfDiagonal",void 0),se(this,"minimum",void 0),se(this,"maximum",void 0),r=r||$I.copy(e).add(n).scale(.5),this.center=new ln(r),this.halfDiagonal=new ln(n).subtract(this.center),this.minimum=new ln(e),this.maximum=new ln(n)}clone(){return new HT(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,r=yAe.from(e.normal),i=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),s=this.center.dot(r)+e.distance;return s-i>0?Ks.INSIDE:s+i<0?Ks.OUTSIDE:Ks.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=$I.from(e).subtract(this.center),{halfDiagonal:r}=this;let i=0,s;return s=Math.abs(n.x)-r.x,s>0&&(i+=s*s),s=Math.abs(n.y)-r.y,s>0&&(i+=s*s),s=Math.abs(n.z)-r.z,s>0&&(i+=s*s),i}}const Wd=new ln,HI=new ln;class WT{constructor(e=[0,0,0],n=0){se(this,"center",void 0),se(this,"radius",void 0),this.radius=-0,this.center=new ln,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=Wd.from(n),this.center=new ln().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new WT(this.center,this.radius)}union(e){const n=this.center,r=this.radius,i=e.center,s=e.radius,A=Wd.copy(i).subtract(n),a=A.magnitude();if(r>=a+s)return this.clone();if(s>=a+r)return e.clone();const y=(r+a+s)*.5;return HI.copy(A).scale((-r+y)/a).add(n),this.center.copy(HI),this.radius=y,this}expand(e){const r=Wd.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=Zq(Wd,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=Wd.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,s=e.normal.dot(n)+e.distance;return s<-r?Ks.OUTSIDE:s<r?Ks.INTERSECTING:Ks.INSIDE}}const _Ae=new ln,vAe=new ln,h1=new ln,f1=new ln,d1=new ln,xAe=new ln,wAe=new ln,du={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class QT{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){se(this,"center",void 0),se(this,"halfAxes",void 0),this.center=new ln().from(e),this.halfAxes=new bs(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new ln(e).len(),new ln(n).len(),new ln(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),i=new ln(e).normalize(),s=new ln(n).normalize(),A=new ln(r).normalize();return new IC().fromMatrix3(new bs([...i,...s,...A]))}fromCenterHalfSizeQuaternion(e,n,r){const i=new IC(r),s=new bs().fromQuaternion(i);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new ln().from(e),this.halfAxes=s,this}clone(){return new QT(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new WT){const n=this.halfAxes,r=n.getColumn(0,h1),i=n.getColumn(1,f1),s=n.getColumn(2,d1),A=_Ae.copy(r).add(i).add(s);return e.center.copy(this.center),e.radius=A.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,i=this.halfAxes,s=r.x,A=r.y,a=r.z,y=Math.abs(s*i[du.COLUMN0ROW0]+A*i[du.COLUMN0ROW1]+a*i[du.COLUMN0ROW2])+Math.abs(s*i[du.COLUMN1ROW0]+A*i[du.COLUMN1ROW1]+a*i[du.COLUMN1ROW2])+Math.abs(s*i[du.COLUMN2ROW0]+A*i[du.COLUMN2ROW1]+a*i[du.COLUMN2ROW2]),w=r.dot(n)+e.distance;return w<=-y?Ks.OUTSIDE:w>=y?Ks.INSIDE:Ks.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=vAe.from(e).subtract(this.center),r=this.halfAxes,i=r.getColumn(0,h1),s=r.getColumn(1,f1),A=r.getColumn(2,d1),a=i.magnitude(),y=s.magnitude(),w=A.magnitude();i.normalize(),s.normalize(),A.normalize();let P=0,I;return I=Math.abs(n.dot(i))-a,I>0&&(P+=I*I),I=Math.abs(n.dot(s))-y,I>0&&(P+=I*I),I=Math.abs(n.dot(A))-w,I>0&&(P+=I*I),P}computePlaneDistances(e,n,r=[-0,-0]){let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const A=this.center,a=this.halfAxes,y=a.getColumn(0,h1),w=a.getColumn(1,f1),P=a.getColumn(2,d1),I=xAe.copy(y).add(w).add(P).add(A),L=wAe.copy(I).subtract(e);let U=n.dot(L);return i=Math.min(U,i),s=Math.max(U,s),I.copy(A).add(y).add(w).subtract(P),L.copy(I).subtract(e),U=n.dot(L),i=Math.min(U,i),s=Math.max(U,s),I.copy(A).add(y).subtract(w).add(P),L.copy(I).subtract(e),U=n.dot(L),i=Math.min(U,i),s=Math.max(U,s),I.copy(A).add(y).subtract(w).subtract(P),L.copy(I).subtract(e),U=n.dot(L),i=Math.min(U,i),s=Math.max(U,s),A.copy(I).subtract(y).add(w).add(P),L.copy(I).subtract(e),U=n.dot(L),i=Math.min(U,i),s=Math.max(U,s),A.copy(I).subtract(y).add(w).subtract(P),L.copy(I).subtract(e),U=n.dot(L),i=Math.min(U,i),s=Math.max(U,s),A.copy(I).subtract(y).subtract(w).add(P),L.copy(I).subtract(e),U=n.dot(L),i=Math.min(U,i),s=Math.max(U,s),A.copy(I).subtract(y).subtract(w).subtract(P),L.copy(I).subtract(e),U=n.dot(L),i=Math.min(U,i),s=Math.max(U,s),r[0]=i,r[1]=s,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,h1);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,f1);r.transformAsPoint(e);const i=this.halfAxes.getColumn(2,d1);return i.transformAsPoint(e),this.halfAxes=new bs([...n,...r,...i]),this}getTransform(){throw new Error("not implemented")}}const WI=new ln,QI=new ln;class H0{constructor(e=[0,0,1],n=0){se(this,"normal",void 0),se(this,"distance",void 0),this.normal=new ln,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return ng(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=WI.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,i){return this.normal.set(e,n,r),ng(Cu(this.normal.len(),1)),this.distance=i,this}clone(){return new H0(this.normal,this.distance)}equals(e){return Cu(this.distance,e.distance)&&Cu(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=QI.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){e=WI.from(e);const r=this.getPointDistance(e),i=QI.copy(this.normal).scale(r);return e.subtract(i).to(n)}}const qI=[new ln([1,0,0]),new ln([0,1,0]),new ln([0,0,1])],ZI=new ln,bAe=new ln;new H0(new ln(1,0,0),0);class Eu{constructor(e=[]){se(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*qI.length;const n=e.center,r=e.radius;let i=0;for(const s of qI){let A=this.planes[i],a=this.planes[i+1];A||(A=this.planes[i]=new H0),a||(a=this.planes[i+1]=new H0);const y=ZI.copy(s).scale(-r).add(n);-s.dot(y),A.fromPointNormal(y,s);const w=ZI.copy(s).scale(r).add(n),P=bAe.copy(s).negate();-P.dot(w),a.fromPointNormal(w,P),i+=2}return this}computeVisibility(e){let n=Ks.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case Ks.OUTSIDE:return Ks.OUTSIDE;case Ks.INTERSECTING:n=Ks.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(ng(Number.isFinite(n),"parentPlaneMask is required."),n===Eu.MASK_OUTSIDE||n===Eu.MASK_INSIDE)return n;let r=Eu.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const A=s<31?1<<s:0;if(s<31&&!(n&A))continue;const a=i[s],y=e.intersectPlane(a);if(y===Ks.OUTSIDE)return Eu.MASK_OUTSIDE;y===Ks.INTERSECTING&&(r|=A)}return r}}se(Eu,"MASK_OUTSIDE",4294967295);se(Eu,"MASK_INSIDE",0);se(Eu,"MASK_INDETERMINATE",2147483647);new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;const xA=new bs,EAe=new bs,TAe=new bs,p1=new bs,YI=new bs;function SAe(t,e={}){const n=_R.EPSILON20,r=10;let i=0,s=0;const A=EAe,a=TAe;A.identity(),a.copy(t);const y=n*MAe(a);for(;s<r&&CAe(a)>y;)PAe(a,p1),YI.copy(p1).transpose(),a.multiplyRight(p1),a.multiplyLeft(YI),A.multiplyRight(p1),++i>2&&(++s,i=0);return e.unitary=A.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function MAe(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const h3=[1,0,0],f3=[2,2,1];function CAe(t){let e=0;for(let n=0;n<3;++n){const r=t[xA.getElementIndex(f3[n],h3[n])];e+=2*r*r}return Math.sqrt(e)}function PAe(t,e){const n=_R.EPSILON15;let r=0,i=1;for(let w=0;w<3;++w){const P=Math.abs(t[xA.getElementIndex(f3[w],h3[w])]);P>r&&(i=w,r=P)}const s=h3[i],A=f3[i];let a=1,y=0;if(Math.abs(t[xA.getElementIndex(A,s)])>n){const w=t[xA.getElementIndex(A,A)],P=t[xA.getElementIndex(s,s)],I=t[xA.getElementIndex(A,s)],L=(w-P)/2/I;let U;L<0?U=-1/(-L+Math.sqrt(1+L*L)):U=1/(L+Math.sqrt(1+L*L)),a=1/Math.sqrt(1+U*U),y=U*a}return bs.IDENTITY.to(e),e[xA.getElementIndex(s,s)]=e[xA.getElementIndex(A,A)]=a,e[xA.getElementIndex(A,s)]=y,e[xA.getElementIndex(s,A)]=-y,e}const mc=new ln,IAe=new ln,kAe=new ln,LAe=new ln,DAe=new ln,RAe=new bs,BAe={diagonal:new bs,unitary:new bs};function zAe(t,e=new QT){if(!t||t.length===0)return e.halfAxes=new bs([0,0,0,0,0,0,0,0,0]),e.center=new ln,e;const n=t.length,r=new ln(0,0,0);for(const Je of t)r.add(Je);const i=1/n;r.multiplyByScalar(i);let s=0,A=0,a=0,y=0,w=0,P=0;for(const Je of t){const tt=mc.copy(Je).subtract(r);s+=tt.x*tt.x,A+=tt.x*tt.y,a+=tt.x*tt.z,y+=tt.y*tt.y,w+=tt.y*tt.z,P+=tt.z*tt.z}s*=i,A*=i,a*=i,y*=i,w*=i,P*=i;const I=RAe;I[0]=s,I[1]=A,I[2]=a,I[3]=A,I[4]=y,I[5]=w,I[6]=a,I[7]=w,I[8]=P;const{unitary:L}=SAe(I,BAe),U=e.halfAxes.copy(L);let W=U.getColumn(0,kAe),q=U.getColumn(1,LAe),ae=U.getColumn(2,DAe),K=-Number.MAX_VALUE,ne=-Number.MAX_VALUE,ie=-Number.MAX_VALUE,fe=Number.MAX_VALUE,ye=Number.MAX_VALUE,Me=Number.MAX_VALUE;for(const Je of t)mc.copy(Je),K=Math.max(mc.dot(W),K),ne=Math.max(mc.dot(q),ne),ie=Math.max(mc.dot(ae),ie),fe=Math.min(mc.dot(W),fe),ye=Math.min(mc.dot(q),ye),Me=Math.min(mc.dot(ae),Me);W=W.multiplyByScalar(.5*(fe+K)),q=q.multiplyByScalar(.5*(ye+ne)),ae=ae.multiplyByScalar(.5*(Me+ie)),e.center.copy(W).add(q).add(ae);const He=IAe.set(K-fe,ne-ye,ie-Me).multiplyByScalar(.5),Qe=new bs([He[0],0,0,0,He[1],0,0,0,He[2]]);return e.halfAxes.multiplyRight(Qe),e}const e0=512,XI=3,Nz=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],Uz=Nz.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),OAe=Uz.concat([[.25,.5],[.75,.5]]);class t0{constructor(e,n,r){se(this,"x",void 0),se(this,"y",void 0),se(this,"z",void 0),se(this,"childVisible",void 0),se(this,"selected",void 0),se(this,"_children",void 0),this.x=e,this.y=n,this.z=r}get children(){if(!this._children){const e=this.x*2,n=this.y*2,r=this.z+1;this._children=[new t0(e,n,r),new t0(e,n+1,r),new t0(e+1,n,r),new t0(e+1,n+1,r)]}return this._children}update(e){const{viewport:n,cullingVolume:r,elevationBounds:i,minZ:s,maxZ:A,bounds:a,offset:y,project:w}=e,P=this.getBoundingVolume(i,y,w);if(a&&!this.insideBounds(a)||r.computeVisibility(P)<0)return!1;if(!this.childVisible){let{z:L}=this;if(L<A&&L>=s){const U=P.distanceTo(n.cameraPosition)*n.scale/n.height;L+=Math.floor(Math.log2(U))}if(L>=A)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const L of this.children)L.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,r,i]){const s=Math.pow(2,this.z),A=e0/s;return this.x*A<r&&this.y*A<i&&(this.x+1)*A>e&&(this.y+1)*A>n}getBoundingVolume(e,n,r){if(r){const y=this.z<1?OAe:this.z<2?Uz:Nz,w=[];for(const P of y){const I=p3(this.x+P[0],this.y+P[1],this.z);I[2]=e[0],w.push(r(I)),e[0]!==e[1]&&(I[2]=e[1],w.push(r(I)))}return zAe(w)}const i=Math.pow(2,this.z),s=e0/i,A=this.x*s+n*e0,a=e0-(this.y+1)*s;return new HT([A,a,e[0]],[A+s,a+s,e[1]])}}function FAe(t,e,n,r){const i=t instanceof bee&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map(({normal:U,distance:W})=>new H0(U.clone().negate(),W)),A=new Eu(s),a=t.distanceScales.unitsPerMeter[2],y=n&&n[0]*a||0,w=n&&n[1]*a||0,P=t instanceof Nu&&t.pitch<=60?e:0;if(r){const[U,W,q,ae]=r,K=Yl([U,ae]),ne=Yl([q,W]);r=[K[0],e0-K[1],ne[0],e0-ne[1]]}const I=new t0(0,0,0),L={viewport:t,project:i,cullingVolume:A,elevationBounds:[y,w],minZ:P,maxZ:e,bounds:r,offset:0};if(I.update(L),t instanceof Nu&&t.subViewports&&t.subViewports.length>1){for(L.offset=-1;I.update(L)&&!(--L.offset<-XI););for(L.offset=1;I.update(L)&&!(++L.offset>XI););}return I.getSelected()}const ju=512,NAe=[-1/0,-1/0,1/0,1/0],UAe={type:"object",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function Vz(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(i=>i[0])),Math.min(...n.map(i=>i[1])),Math.max(...n.map(i=>i[0])),Math.max(...n.map(i=>i[1]))]}function VAe(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function GAe(t,e){if(!t||!t.length)return null;const{index:n,id:r}=e;if(Array.isArray(t)){const s=VAe(r)%t.length;t=t[s]}let i=t;for(const s of Object.keys(n)){const A=new RegExp("{".concat(s,"}"),"g");i=i.replace(A,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function jAe(t,e,n){let r;if(e&&e.length===2){const[i,s]=e,A=t.getBounds({z:i}),a=t.getBounds({z:s});r=[Math.min(A[0],a[0]),Math.min(A[1],a[1]),Math.max(A[2],a[2]),Math.max(A[3],a[3])]}else r=t.getBounds();return t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}function $Ae({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map(i=>d3(i,e,n))}function d3(t,e,n){if(!Array.isArray(e)){const s=n.x-t.x,A=n.y-t.y,{width:a,height:y}=n,w={targetZ:e},P=t.unproject([s,A],w),I=t.unproject([s+a,A],w),L=t.unproject([s,A+y],w),U=t.unproject([s+a,A+y],w);return[Math.min(P[0],I[0],L[0],U[0]),Math.min(P[1],I[1],L[1],U[1]),Math.max(P[0],I[0],L[0],U[0]),Math.max(P[1],I[1],L[1],U[1])]}const r=d3(t,e[0],n),i=d3(t,e[1],n);return[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[2],i[2]),Math.max(r[3],i[3])]}function HAe(t,e,n){return n?Vz(t,n).map(i=>i*e/ju):t.map(r=>r*e/ju)}function qT(t,e){return Math.pow(2,t)*ju/e}function p3(t,e,n){const r=qT(n,ju),i=t/r*360-180,s=Math.PI-2*Math.PI*e/r,A=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[i,A]}function KI(t,e,n,r){const i=qT(n,r);return[t/i*ju,e/i*ju]}function WAe(t,e,n,r,i=ju){if(t.isGeospatial){const[w,P]=p3(e,n,r),[I,L]=p3(e+1,n+1,r);return{west:w,north:P,east:I,south:L}}const[s,A]=KI(e,n,r,i),[a,y]=KI(e+1,n+1,r,i);return{left:s,top:A,right:a,bottom:y}}function QAe(t,e,n,r,i){const s=jAe(t,null,r),A=qT(e,n),[a,y,w,P]=HAe(s,A,i),I=[];for(let L=Math.floor(a);L<w;L++)for(let U=Math.floor(y);U<P;U++)I.push({x:L,y:U,z:e});return I}function qAe({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:s=ju,modelMatrix:A,modelMatrixInverse:a,zoomOffset:y=0}){let w=t.isGeospatial?Math.round(t.zoom+Math.log2(ju/s))+y:Math.ceil(t.zoom)+y;if(typeof n=="number"&&Number.isFinite(n)&&w<n){if(!i)return[];w=n}typeof e=="number"&&Number.isFinite(e)&&w>e&&(w=e);let P=i;return A&&a&&i&&!t.isGeospatial&&(P=Vz(i,A)),t.isGeospatial?FAe(t,w,r,i):QAe(t,w,s,P||NAe,a)}function ZAe(t){let e={},n;return r=>{for(const i in r)if(!YAe(r[i],e[i])){n=t(r),e=r;break}return n}}function YAe(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}const JI=1,T2=2,XAe="never",KAe="no-overlap",ZT="best-available",JAe=5,eue={[ZT]:rue,[KAe]:iue,[XAe]:()=>{}},tue={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class nue{constructor(e){se(this,"opts",void 0),se(this,"_requestScheduler",void 0),se(this,"_cache",void 0),se(this,"_dirty",void 0),se(this,"_tiles",void 0),se(this,"_cacheByteSize",void 0),se(this,"_viewport",void 0),se(this,"_zRange",void 0),se(this,"_selectedTiles",void 0),se(this,"_frameNumber",void 0),se(this,"_modelMatrix",void 0),se(this,"_modelMatrixInverse",void 0),se(this,"_maxZoom",void 0),se(this,"_minZoom",void 0),se(this,"onTileLoad",void 0),se(this,"_getCullBounds",ZAe($Ae)),this.opts={...tue,...e},this.onTileLoad=n=>{var r,i;(r=(i=this.opts).onTileLoad)===null||r===void 0||r.call(i,n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new qV({maxRequests:e.maxRequests,throttleRequests:!!(e.maxRequests&&e.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new Yo,this._modelMatrixInverse=new Yo,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:r}={}){const i=new Yo(r),s=!i.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!Cu(this._zRange,n)||s){s&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=e,this._zRange=n;const a=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(y=>this._getTile(y,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));const A=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),A&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const r=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:i}=e;for(const[s,A,a,y]of r){let w;if("west"in i)w=i.west<a&&i.east>s&&i.south<y&&i.north>A;else{const P=Math.min(i.top,i.bottom),I=Math.max(i.top,i.bottom);w=i.left<a&&i.right>s&&P<y&&I>A}if(w)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:r,zRange:i,modelMatrix:s,modelMatrixInverse:A}){const{tileSize:a,extent:y,zoomOffset:w}=this.opts;return qAe({viewport:e,maxZoom:n,minZoom:r,zRange:i,tileSize:a,extent:y,modelMatrix:s,modelMatrixInverse:A,zoomOffset:w})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:WAe(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),r=Math.floor(e.y/2),i=e.z-1;return{x:n,y:r,z:i}}updateTileStates(){const e=this.opts.refinementStrategy||ZT,n=new Array(this._cache.size);let r=0;for(const i of this._cache.values())n[r++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(const i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof e=="function"?e:eue[e])(Array.from(this._cache.values())),r=0;for(const i of this._cache.values())if(n[r++]!==i.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,n=[];let r=0;for(const i of this._cache.values())i.isLoading&&(r++,!i.isSelected&&!i.isVisible&&n.push(i));for(;e>0&&r>e&&n.length>0;)n.shift().abort(),r--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const r=this._getNearestAncestor(n);n.parent=r,r!=null&&r.children&&r.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,r=n.maxCacheSize||(n.maxCacheByteSize?1/0:JAe*this.selectedTiles.length),i=n.maxCacheByteSize||1/0;if(e.size>r||this._cacheByteSize>i){for(const[y,w]of e){if(!w.isVisible&&!w.isSelected){var A,a;this._cacheByteSize-=n.maxCacheByteSize?w.byteLength:0,e.delete(y),(A=(a=this.opts).onTileUnload)===null||A===void 0||A.call(a,w)}if(e.size<=r&&this._cacheByteSize<=i)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((y,w)=>y.zoom-w.zoom),this._dirty=!1)}_getTile(e,n){const r=this.getTileId(e);let i=this._cache.get(r),s=!1;return!i&&n?(i=new mAe(e),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:r,zoom:this.getTileZoom(i.index)}),s=!0,this._cache.set(r,i),this._dirty=!0):i&&i.needsReload&&(s=!0),i&&s&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(e){const{_minZoom:n=0}=this;let r=e.index;for(;this.getTileZoom(r)>n;){r=this.getParentIndex(r);const i=this._getTile(r);if(i)return i}return null}}function rue(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!Gz(e)&&YT(e);for(const e of t)e.isVisible=!!(e.state&T2)}function iue(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&Gz(n);const e=Array.from(t).sort((n,r)=>n.zoom-r.zoom);for(const n of e)if(n.isVisible=!!(n.state&T2),n.children&&(n.isVisible||n.state&JI))for(const r of n.children)r.state=JI;else n.isSelected&&YT(n)}function Gz(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=T2,!0;e=e.parent}return!1}function YT(t){for(const e of t.children)e.isLoaded||e.content?e.state|=T2:YT(e)}const sue={TilesetClass:nue,data:{type:"data",value:[]},dataComparator:UAe.equal,renderSubLayers:{type:"function",value:t=>new Gc(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:ZT,zRange:null,maxRequests:6,zoomOffset:0};class dg extends Li{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n,r;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||(r=n.selectedTiles)===null||r===void 0?void 0:r.every(i=>i.isLoaded&&i.layers&&i.layers.every(s=>s.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:s,maxZoom:A,minZoom:a,maxRequests:y,zoomOffset:w}=this.props;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:A,minZoom:a,tileSize:e,refinementStrategy:i,extent:s,maxRequests:y,zoomOffset:w,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:r}=this.props,i=e.update(this.context.viewport,{zRange:n,modelMatrix:r}),{isLoaded:s}=e,A=this.state.isLoaded!==s,a=this.state.frameNumber!==i;s&&(A||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:i}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:r,fetch:i}=this.props,{signal:s}=e;return e.url=typeof n=="string"||Array.isArray(n)?GAe(n,e):null,r?r(e):i&&e.url?i(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){const r=n.props.tile;return e.picked&&(e.tile=r),e.sourceTile=r,e}_updateAutoHighlight(e){const n=e.sourceTile;if(n&&n.layers)for(const r of n.layers)r.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(r=>e.layers[0].props[r]!==n[r])&&(e.layers=e.layers.map(r=>r.clone(n)));else{const r=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=Uh(r,Boolean).map(i=>i.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:r}=e.props;return this.state.tileset.isTileVisible(r,n)}}se(dg,"defaultProps",sue);se(dg,"layerName","TileLayer");const Xx=Math.PI/180,g1=new Float32Array(16),ek=new Float32Array(12);function tk(t,e,n){const r=e[0]*Xx,i=e[1]*Xx,s=e[2]*Xx,A=Math.sin(s),a=Math.sin(r),y=Math.sin(i),w=Math.cos(s),P=Math.cos(r),I=Math.cos(i),L=n[0],U=n[1],W=n[2];t[0]=L*I*P,t[1]=L*y*P,t[2]=L*-a,t[3]=U*(-y*w+I*a*A),t[4]=U*(I*w+y*a*A),t[5]=U*P*A,t[6]=W*(y*A+I*a*w),t[7]=W*(-I*A+y*a*w),t[8]=W*P*w}function nk(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const oue={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:i,getScale:s,getTranslation:A,getTransformMatrix:a}=this.props,y=Array.isArray(a),w=y&&a.length===16,P=Array.isArray(s),I=Array.isArray(i),L=Array.isArray(A),U=w||!y&&!!a(r[0]);U?t.constant=w:t.constant=I&&P&&L;const W=t.value;if(t.constant){let q;U?(g1.set(a),q=nk(g1)):(q=ek,tk(q,i,s),q.set(A,9)),t.value=new Float32Array(q)}else{let q=e*t.size;const{iterable:ae,objectInfo:K}=nd(r,e,n);for(const ne of ae){K.index++;let ie;if(U)g1.set(w?a:a(ne,K)),ie=nk(g1);else{ie=ek;const fe=I?i:i(ne,K),ye=P?s:s(ne,K);tk(ie,fe,ye),ie.set(L?A:A(ne,K),9)}W[q++]=ie[0],W[q++]=ie[1],W[q++]=ie[2],W[q++]=ie[3],W[q++]=ie[4],W[q++]=ie[5],W[q++]=ie[6],W[q++]=ie[7],W[q++]=ie[8],W[q++]=ie[9],W[q++]=ie[10],W[q++]=ie[11]}}}};function aue(t,e){return e===ar.CARTESIAN||e===ar.METER_OFFSETS||e===ar.DEFAULT&&!t.isGeospatial}const lue=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Aue=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function jz(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,A=-1/0;const a=t.POSITION?t.POSITION.value:[],y=a&&a.length;for(let w=0;w<y;w+=3){const P=a[w],I=a[w+1],L=a[w+2];e=P<e?P:e,n=I<n?I:n,r=L<r?L:r,i=P>i?P:i,s=I>s?I:s,A=L>A?L:A}return[[e,n,r],[i,s,A]]}function uue(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class n0{constructor(e,n){se(this,"fields",void 0),se(this,"metadata",void 0),uue(Array.isArray(e)),cue(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(const A of r)e[A]=!0;const s=this.fields.filter(A=>e[A.name]);return new n0(s,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=n.map(s=>this.fields[s]).filter(Boolean);return new n0(i,this.metadata)}assign(e){let n,r=this.metadata;if(e instanceof n0){const A=e;n=A.fields,r=rk(rk(new Map,this.metadata),A.metadata)}else n=e;const i=Object.create(null);for(const A of this.fields)i[A.name]=A;for(const A of n)i[A.name]=A;const s=Object.values(i);return new n0(s,r)}}function cue(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function rk(t,e){return new Map([...t||new Map,...e||new Map])}class Lp{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;se(this,"name",void 0),se(this,"type",void 0),se(this,"nullable",void 0),se(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new Lp(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let vi=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({}),$z,Hz,Wz;class XT{static isNull(e){return e&&e.typeId===vi.Null}static isInt(e){return e&&e.typeId===vi.Int}static isFloat(e){return e&&e.typeId===vi.Float}static isBinary(e){return e&&e.typeId===vi.Binary}static isUtf8(e){return e&&e.typeId===vi.Utf8}static isBool(e){return e&&e.typeId===vi.Bool}static isDecimal(e){return e&&e.typeId===vi.Decimal}static isDate(e){return e&&e.typeId===vi.Date}static isTime(e){return e&&e.typeId===vi.Time}static isTimestamp(e){return e&&e.typeId===vi.Timestamp}static isInterval(e){return e&&e.typeId===vi.Interval}static isList(e){return e&&e.typeId===vi.List}static isStruct(e){return e&&e.typeId===vi.Struct}static isUnion(e){return e&&e.typeId===vi.Union}static isFixedSizeBinary(e){return e&&e.typeId===vi.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===vi.FixedSizeList}static isMap(e){return e&&e.typeId===vi.Map}static isDictionary(e){return e&&e.typeId===vi.Dictionary}get typeId(){return vi.NONE}compareTo(e){return this===e}}$z=Symbol.toStringTag;class id extends XT{constructor(e,n){super(),se(this,"isSigned",void 0),se(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return vi.Int}get[$z](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class hue extends id{constructor(){super(!0,8)}}class fue extends id{constructor(){super(!0,16)}}class due extends id{constructor(){super(!0,32)}}class pue extends id{constructor(){super(!1,8)}}class gue extends id{constructor(){super(!1,16)}}class mue extends id{constructor(){super(!1,32)}}const Qz={HALF:16,SINGLE:32,DOUBLE:64};Hz=Symbol.toStringTag;class qz extends XT{constructor(e){super(),se(this,"precision",void 0),this.precision=e}get typeId(){return vi.Float}get[Hz](){return"Float"}toString(){return"Float".concat(this.precision)}}class yue extends qz{constructor(){super(Qz.SINGLE)}}class _ue extends qz{constructor(){super(Qz.DOUBLE)}}Wz=Symbol.toStringTag;class vue extends XT{constructor(e,n){super(),se(this,"listSize",void 0),se(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return vi.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[Wz](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function xue(t){switch(t.constructor){case Int8Array:return new hue;case Uint8Array:return new pue;case Int16Array:return new fue;case Uint16Array:return new gue;case Int32Array:return new due;case Uint32Array:return new mue;case Float32Array:return new yue;case Float64Array:return new _ue;default:throw new Error("array type not supported")}}function ik(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),rr.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function sk(t,e){if(t.attributes)return ik(t.attributes,e),t instanceof Pu?t:new Pu(t);if(t.positions||t.POSITION)return ik(t,e),new Pu({attributes:t});throw Error("Invalid mesh")}const wue=[0,0,0,255],bue={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:wue},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class S2 extends Kl{constructor(...e){super(...e),se(this,"state",void 0)}getShaders(){const e=!lr(this.context.gl),n={};return GD(this.context.gl,Qr.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:lue,fs:Aue,modules:[nf,jZ,rf],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:r}=this.props;if(!r)return null;if(n=(e=r.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:i}=sk(r,this.props._useMeshColors);i.POSITION=i.POSITION||i.positions,n=jz(i)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:oue}),this.setState({emptyTexture:new Jo(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e;if(n.mesh!==r.mesh||i.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const A=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(A.NORMAL||A.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:r,coordinateSystem:i,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:r,composeModelMatrix:!s||aue(n,i),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new Ou(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:sk(e,this.props._useMeshColors),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:i}=this.state;return n.setUniforms({sampler:r||i,hasTexture:!!r}),n}setTexture(e){const{emptyTexture:n,model:r}=this.state;r&&r.setUniforms({sampler:e||n,hasTexture:!!e})}}se(S2,"defaultProps",bue);se(S2,"layerName","SimpleMeshLayer");const Eue={inject:{"vs:#decl":`
attribute vec2 instanceDashArrays;
attribute float instanceDashOffsets;
varying vec2 vDashArray;
varying float vDashOffset;
`,"vs:#main-end":`
vDashArray = instanceDashArrays;
vDashOffset = instanceDashOffsets / width.x;
`,"fs:#decl":`
uniform float dashAlignMode;
uniform float capType;
uniform bool dashGapPickable;
varying vec2 vDashArray;
varying float vDashOffset;

float round(float x) {
  return floor(x + 0.5);
}
`,"fs:#main-start":`
  float solidLength = vDashArray.x;
  float gapLength = vDashArray.y;
  float unitLength = solidLength + gapLength;

  float offset;

  if (unitLength > 0.0) {
    if (dashAlignMode == 0.0) {
      offset = vDashOffset;
    } else {
      unitLength = vPathLength / round(vPathLength / unitLength);
      offset = solidLength / 2.0;
    }

    float unitOffset = mod(vPathPosition.y + offset, unitLength);

    if (gapLength > 0.0 && unitOffset > solidLength) {
      if (capType <= 0.5) {
        if (!(dashGapPickable && picking_uActive)) {
          discard;
        }
      } else {
        float distToEnd = length(vec2(
          min(unitOffset - solidLength, unitLength - unitOffset),
          vPathPosition.x
        ));
        if (distToEnd > 1.0) {
          if (!(dashGapPickable && picking_uActive)) {
            discard;
          }
        }
      }
    }
  }
`}},Tue={inject:{"vs:#decl":`
attribute float instanceOffsets;
`,"vs:DECKGL_FILTER_SIZE":`
  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
  size *= offsetWidth;
`,"vs:#main-end":`
  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
  float offsetDir = sign(instanceOffsets);
  vPathPosition.x = (vPathPosition.x + offsetDir) * offsetWidth - offsetDir;
  vPathPosition.y *= offsetWidth;
  vPathLength *= offsetWidth;
`,"fs:#main-start":`
  float isInside;
  isInside = step(-1.0, vPathPosition.x) * step(vPathPosition.x, 1.0);
  if (isInside == 0.0) {
    discard;
  }
`}},Sue={getDashArray:{type:"accessor",value:[0,0]},getOffset:{type:"accessor",value:0},dashJustified:!1,dashGapPickable:!1};class KT extends xT{constructor({dash:e=!1,offset:n=!1,highPrecisionDash:r=!1}={}){super({dash:e||r,offset:n,highPrecisionDash:r})}isEnabled(e){return"pathTesselator"in e.state}getShaders(e){if(!e.isEnabled(this))return null;let n={};return e.opts.dash&&(n=jb(n,Eue)),e.opts.offset&&(n=jb(n,Tue)),n}initializeState(e,n){const r=this.getAttributeManager();!r||!n.isEnabled(this)||(n.opts.dash&&r.addInstanced({instanceDashArrays:{size:2,accessor:"getDashArray"}}),n.opts.highPrecisionDash&&r.addInstanced({instanceDashOffsets:{size:1,accessor:"getPath",transform:n.getDashOffsets.bind(this)}}),n.opts.offset&&r.addInstanced({instanceOffsets:{size:1,accessor:"getOffset"}}))}updateState(e,n){if(!n.isEnabled(this))return;const r={};n.opts.dash&&(r.dashAlignMode=this.props.dashJustified?1:0,r.dashGapPickable=!!this.props.dashGapPickable),this.state.model.setUniforms(r)}getDashOffsets(e){const n=[0],r=this.props.positionFormat==="XY"?2:3,i=Array.isArray(e[0]),s=i?e.length:e.length/r;let A,a;for(let y=0;y<s-1;y++)A=i?e[y]:e.slice(y*r,y*r+r),A=this.projectPosition(A),y>0&&(n[y]=n[y-1]+Dq(a,A)),a=A;return n}}se(KT,"defaultProps",Sue);se(KT,"extensionName","PathStyleExtension");function Zz(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Mue(t){return t.length===1&&(t=Cue(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}function Cue(t){return function(e,n){return Zz(t(e),n)}}Mue(Zz);function pg(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var Kx=Array.prototype.slice;function Pue(t){return t}var ry=1,iy=2,g3=3,m1=4,ok=1e-6;function Iue(t){return"translate("+(t+.5)+",0)"}function kue(t){return"translate(0,"+(t+.5)+")"}function Lue(t){return function(e){return+t(e)}}function Due(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function Rue(){return!this.__axis}function JT(t,e){var n=[],r=null,i=null,s=6,A=6,a=3,y=t===ry||t===m1?-1:1,w=t===m1||t===iy?"x":"y",P=t===ry||t===g3?Iue:kue;function I(L){var U=r??(e.ticks?e.ticks.apply(e,n):e.domain()),W=i??(e.tickFormat?e.tickFormat.apply(e,n):Pue),q=Math.max(s,0)+a,ae=e.range(),K=+ae[0]+.5,ne=+ae[ae.length-1]+.5,ie=(e.bandwidth?Due:Lue)(e.copy()),fe=L.selection?L.selection():L,ye=fe.selectAll(".domain").data([null]),Me=fe.selectAll(".tick").data(U,e).order(),He=Me.exit(),Qe=Me.enter().append("g").attr("class","tick"),Je=Me.select("line"),tt=Me.select("text");ye=ye.merge(ye.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Me=Me.merge(Qe),Je=Je.merge(Qe.append("line").attr("stroke","currentColor").attr(w+"2",y*s)),tt=tt.merge(Qe.append("text").attr("fill","currentColor").attr(w,y*q).attr("dy",t===ry?"0em":t===g3?"0.71em":"0.32em")),L!==fe&&(ye=ye.transition(L),Me=Me.transition(L),Je=Je.transition(L),tt=tt.transition(L),He=He.transition(L).attr("opacity",ok).attr("transform",function(Ne){return isFinite(Ne=ie(Ne))?P(Ne):this.getAttribute("transform")}),Qe.attr("opacity",ok).attr("transform",function(Ne){var nt=this.parentNode.__axis;return P(nt&&isFinite(nt=nt(Ne))?nt:ie(Ne))})),He.remove(),ye.attr("d",t===m1||t==iy?A?"M"+y*A+","+K+"H0.5V"+ne+"H"+y*A:"M0.5,"+K+"V"+ne:A?"M"+K+","+y*A+"V0.5H"+ne+"V"+y*A:"M"+K+",0.5H"+ne),Me.attr("opacity",1).attr("transform",function(Ne){return P(ie(Ne))}),Je.attr(w+"2",y*s),tt.attr(w,y*q).text(W),fe.filter(Rue).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===iy?"start":t===m1?"end":"middle"),fe.each(function(){this.__axis=ie})}return I.scale=function(L){return arguments.length?(e=L,I):e},I.ticks=function(){return n=Kx.call(arguments),I},I.tickArguments=function(L){return arguments.length?(n=L==null?[]:Kx.call(L),I):n.slice()},I.tickValues=function(L){return arguments.length?(r=L==null?null:Kx.call(L),I):r&&r.slice()},I.tickFormat=function(L){return arguments.length?(i=L,I):i},I.tickSize=function(L){return arguments.length?(s=A=+L,I):s},I.tickSizeInner=function(L){return arguments.length?(s=+L,I):s},I.tickSizeOuter=function(L){return arguments.length?(A=+L,I):A},I.tickPadding=function(L){return arguments.length?(a=+L,I):a},I}function Bue(t){return JT(ry,t)}function Yz(t){return JT(iy,t)}function zue(t){return JT(g3,t)}var Oue={value:function(){}};function Xz(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new sy(n)}function sy(t){this._=t}function Fue(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}sy.prototype=Xz.prototype={constructor:sy,on:function(t,e){var n=this._,r=Fue(t+"",n),i,s=-1,A=r.length;if(arguments.length<2){for(;++s<A;)if((i=(t=r[s]).type)&&(i=Nue(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<A;)if(i=(t=r[s]).type)n[i]=ak(n[i],t.name,e);else if(e==null)for(i in n)n[i]=ak(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new sy(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function Nue(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function ak(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Oue,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var m3="http://www.w3.org/1999/xhtml";const lk={svg:"http://www.w3.org/2000/svg",xhtml:m3,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function M2(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),lk.hasOwnProperty(e)?{space:lk[e],local:t}:t}function Uue(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===m3&&e.documentElement.namespaceURI===m3?e.createElement(t):e.createElementNS(n,t)}}function Vue(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Kz(t){var e=M2(t);return(e.local?Vue:Uue)(e)}function Gue(){}function eS(t){return t==null?Gue:function(){return this.querySelector(t)}}function jue(t){typeof t!="function"&&(t=eS(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],A=s.length,a=r[i]=new Array(A),y,w,P=0;P<A;++P)(y=s[P])&&(w=t.call(y,y.__data__,P,s))&&("__data__"in y&&(w.__data__=y.__data__),a[P]=w);return new Xl(r,this._parents)}function $ue(){return[]}function Jz(t){return t==null?$ue:function(){return this.querySelectorAll(t)}}function Hue(t){typeof t!="function"&&(t=Jz(t));for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var A=e[s],a=A.length,y,w=0;w<a;++w)(y=A[w])&&(r.push(t.call(y,y.__data__,w,A)),i.push(y));return new Xl(r,i)}function eO(t){return function(){return this.matches(t)}}function Wue(t){typeof t!="function"&&(t=eO(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],A=s.length,a=r[i]=[],y,w=0;w<A;++w)(y=s[w])&&t.call(y,y.__data__,w,s)&&a.push(y);return new Xl(r,this._parents)}function tO(t){return new Array(t.length)}function Que(){return new Xl(this._enter||this._groups.map(tO),this._parents)}function y_(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}y_.prototype={constructor:y_,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function que(t){return function(){return t}}var Ak="$";function Zue(t,e,n,r,i,s){for(var A=0,a,y=e.length,w=s.length;A<w;++A)(a=e[A])?(a.__data__=s[A],r[A]=a):n[A]=new y_(t,s[A]);for(;A<y;++A)(a=e[A])&&(i[A]=a)}function Yue(t,e,n,r,i,s,A){var a,y,w={},P=e.length,I=s.length,L=new Array(P),U;for(a=0;a<P;++a)(y=e[a])&&(L[a]=U=Ak+A.call(y,y.__data__,a,e),U in w?i[a]=y:w[U]=y);for(a=0;a<I;++a)U=Ak+A.call(t,s[a],a,s),(y=w[U])?(r[a]=y,y.__data__=s[a],w[U]=null):n[a]=new y_(t,s[a]);for(a=0;a<P;++a)(y=e[a])&&w[L[a]]===y&&(i[a]=y)}function Xue(t,e){if(!t)return U=new Array(this.size()),w=-1,this.each(function(Me){U[++w]=Me}),U;var n=e?Yue:Zue,r=this._parents,i=this._groups;typeof t!="function"&&(t=que(t));for(var s=i.length,A=new Array(s),a=new Array(s),y=new Array(s),w=0;w<s;++w){var P=r[w],I=i[w],L=I.length,U=t.call(P,P&&P.__data__,w,r),W=U.length,q=a[w]=new Array(W),ae=A[w]=new Array(W),K=y[w]=new Array(L);n(P,I,q,ae,K,U,e);for(var ne=0,ie=0,fe,ye;ne<W;++ne)if(fe=q[ne]){for(ne>=ie&&(ie=ne+1);!(ye=ae[ie])&&++ie<W;);fe._next=ye||null}}return A=new Xl(A,r),A._enter=a,A._exit=y,A}function Kue(){return new Xl(this._exit||this._groups.map(tO),this._parents)}function Jue(t,e,n){var r=this.enter(),i=this,s=this.exit();return r=typeof t=="function"?t(r):r.append(t+""),e!=null&&(i=e(i)),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function ece(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),A=new Array(r),a=0;a<s;++a)for(var y=e[a],w=n[a],P=y.length,I=A[a]=new Array(P),L,U=0;U<P;++U)(L=y[U]||w[U])&&(I[U]=L);for(;a<r;++a)A[a]=e[a];return new Xl(A,this._parents)}function tce(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],A;--i>=0;)(A=r[i])&&(s&&A.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(A,s),s=A);return this}function nce(t){t||(t=rce);function e(I,L){return I&&L?t(I.__data__,L.__data__):!I-!L}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var A=n[s],a=A.length,y=i[s]=new Array(a),w,P=0;P<a;++P)(w=A[P])&&(y[P]=w);y.sort(e)}return new Xl(i,this._parents).order()}function rce(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ice(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function sce(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function oce(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var A=r[i];if(A)return A}return null}function ace(){var t=0;return this.each(function(){++t}),t}function lce(){return!this.node()}function Ace(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,A=i.length,a;s<A;++s)(a=i[s])&&t.call(a,a.__data__,s,i);return this}function uce(t){return function(){this.removeAttribute(t)}}function cce(t){return function(){this.removeAttributeNS(t.space,t.local)}}function hce(t,e){return function(){this.setAttribute(t,e)}}function fce(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function dce(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function pce(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function gce(t,e){var n=M2(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?cce:uce:typeof e=="function"?n.local?pce:dce:n.local?fce:hce)(n,e))}function nO(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function mce(t){return function(){this.style.removeProperty(t)}}function yce(t,e,n){return function(){this.style.setProperty(t,e,n)}}function _ce(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function vce(t,e,n){return arguments.length>1?this.each((e==null?mce:typeof e=="function"?_ce:yce)(t,e,n??"")):W0(this.node(),t)}function W0(t,e){return t.style.getPropertyValue(e)||nO(t).getComputedStyle(t,null).getPropertyValue(e)}function xce(t){return function(){delete this[t]}}function wce(t,e){return function(){this[t]=e}}function bce(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Ece(t,e){return arguments.length>1?this.each((e==null?xce:typeof e=="function"?bce:wce)(t,e)):this.node()[t]}function rO(t){return t.trim().split(/^|\s+/)}function tS(t){return t.classList||new iO(t)}function iO(t){this._node=t,this._names=rO(t.getAttribute("class")||"")}iO.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function sO(t,e){for(var n=tS(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function oO(t,e){for(var n=tS(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Tce(t){return function(){sO(this,t)}}function Sce(t){return function(){oO(this,t)}}function Mce(t,e){return function(){(e.apply(this,arguments)?sO:oO)(this,t)}}function Cce(t,e){var n=rO(t+"");if(arguments.length<2){for(var r=tS(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Mce:e?Tce:Sce)(n,e))}function Pce(){this.textContent=""}function Ice(t){return function(){this.textContent=t}}function kce(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Lce(t){return arguments.length?this.each(t==null?Pce:(typeof t=="function"?kce:Ice)(t)):this.node().textContent}function Dce(){this.innerHTML=""}function Rce(t){return function(){this.innerHTML=t}}function Bce(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function zce(t){return arguments.length?this.each(t==null?Dce:(typeof t=="function"?Bce:Rce)(t)):this.node().innerHTML}function Oce(){this.nextSibling&&this.parentNode.appendChild(this)}function Fce(){return this.each(Oce)}function Nce(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Uce(){return this.each(Nce)}function Vce(t){var e=typeof t=="function"?t:Kz(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Gce(){return null}function jce(t,e){var n=typeof t=="function"?t:Kz(t),r=e==null?Gce:typeof e=="function"?e:eS(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function $ce(){var t=this.parentNode;t&&t.removeChild(this)}function Hce(){return this.each($ce)}function Wce(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Qce(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function qce(t){return this.select(t?Qce:Wce)}function Zce(t){return arguments.length?this.property("__data__",t):this.node().__data__}var aO={};if(typeof document<"u"){var Yce=document.documentElement;"onmouseenter"in Yce||(aO={mouseenter:"mouseover",mouseleave:"mouseout"})}function Xce(t,e,n){return t=lO(t,e,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&t.call(this,r)}}function lO(t,e,n){return function(r){try{t.call(this,this.__data__,e,n)}finally{}}}function Kce(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Jce(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.capture):e[++r]=s;++r?e.length=r:delete this.__on}}}function ehe(t,e,n){var r=aO.hasOwnProperty(t.type)?Xce:lO;return function(i,s,A){var a=this.__on,y,w=r(e,s,A);if(a){for(var P=0,I=a.length;P<I;++P)if((y=a[P]).type===t.type&&y.name===t.name){this.removeEventListener(y.type,y.listener,y.capture),this.addEventListener(y.type,y.listener=w,y.capture=n),y.value=e;return}}this.addEventListener(t.type,w,n),y={type:t.type,name:t.name,value:e,listener:w,capture:n},a?a.push(y):this.__on=[y]}}function the(t,e,n){var r=Kce(t+""),i,s=r.length,A;if(arguments.length<2){var a=this.node().__on;if(a){for(var y=0,w=a.length,P;y<w;++y)for(i=0,P=a[y];i<s;++i)if((A=r[i]).type===P.type&&A.name===P.name)return P.value}return}for(a=e?ehe:Jce,n==null&&(n=!1),i=0;i<s;++i)this.each(a(r[i],e,n));return this}function AO(t,e,n){var r=nO(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function nhe(t,e){return function(){return AO(this,t,e)}}function rhe(t,e){return function(){return AO(this,t,e.apply(this,arguments))}}function ihe(t,e){return this.each((typeof e=="function"?rhe:nhe)(t,e))}var she=[null];function Xl(t,e){this._groups=t,this._parents=e}function Yg(){return new Xl([[document.documentElement]],she)}Xl.prototype=Yg.prototype={constructor:Xl,select:jue,selectAll:Hue,filter:Wue,data:Xue,enter:Que,exit:Kue,join:Jue,merge:ece,order:tce,sort:nce,call:ice,nodes:sce,node:oce,size:ace,empty:lce,each:Ace,attr:gce,style:vce,property:Ece,classed:Cce,text:Lce,html:zce,raise:Fce,lower:Uce,append:Vce,insert:jce,remove:Hce,clone:qce,datum:Zce,on:the,dispatch:ihe};function Xg(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function C2(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Af(){}var gg=.7,__=1/gg,x0="\\s*([+-]?\\d+)\\s*",mg="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",RA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ohe=/^#([0-9a-f]{3,8})$/,ahe=new RegExp("^rgb\\("+[x0,x0,x0]+"\\)$"),lhe=new RegExp("^rgb\\("+[RA,RA,RA]+"\\)$"),Ahe=new RegExp("^rgba\\("+[x0,x0,x0,mg]+"\\)$"),uhe=new RegExp("^rgba\\("+[RA,RA,RA,mg]+"\\)$"),che=new RegExp("^hsl\\("+[mg,RA,RA]+"\\)$"),hhe=new RegExp("^hsla\\("+[mg,RA,RA,mg]+"\\)$"),uk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Xg(Af,Wh,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:ck,formatHex:ck,formatHsl:fhe,formatRgb:hk,toString:hk});function ck(){return this.rgb().formatHex()}function fhe(){return cO(this).formatHsl()}function hk(){return this.rgb().formatRgb()}function Wh(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ohe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?fk(e):n===3?new Eo(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?y1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?y1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ahe.exec(t))?new Eo(e[1],e[2],e[3],1):(e=lhe.exec(t))?new Eo(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Ahe.exec(t))?y1(e[1],e[2],e[3],e[4]):(e=uhe.exec(t))?y1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=che.exec(t))?gk(e[1],e[2]/100,e[3]/100,1):(e=hhe.exec(t))?gk(e[1],e[2]/100,e[3]/100,e[4]):uk.hasOwnProperty(t)?fk(uk[t]):t==="transparent"?new Eo(NaN,NaN,NaN,0):null}function fk(t){return new Eo(t>>16&255,t>>8&255,t&255,1)}function y1(t,e,n,r){return r<=0&&(t=e=n=NaN),new Eo(t,e,n,r)}function uO(t){return t instanceof Af||(t=Wh(t)),t?(t=t.rgb(),new Eo(t.r,t.g,t.b,t.opacity)):new Eo}function y3(t,e,n,r){return arguments.length===1?uO(t):new Eo(t,e,n,r??1)}function Eo(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Xg(Eo,y3,C2(Af,{brighter:function(t){return t=t==null?__:Math.pow(__,t),new Eo(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?gg:Math.pow(gg,t),new Eo(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:dk,formatHex:dk,formatRgb:pk,toString:pk}));function dk(){return"#"+Jx(this.r)+Jx(this.g)+Jx(this.b)}function pk(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function Jx(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function gk(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new TA(t,e,n,r)}function cO(t){if(t instanceof TA)return new TA(t.h,t.s,t.l,t.opacity);if(t instanceof Af||(t=Wh(t)),!t)return new TA;if(t instanceof TA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),A=NaN,a=s-i,y=(s+i)/2;return a?(e===s?A=(n-r)/a+(n<r)*6:n===s?A=(r-e)/a+2:A=(e-n)/a+4,a/=y<.5?s+i:2-s-i,A*=60):a=y>0&&y<1?0:A,new TA(A,a,y,t.opacity)}function _3(t,e,n,r){return arguments.length===1?cO(t):new TA(t,e,n,r??1)}function TA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Xg(TA,_3,C2(Af,{brighter:function(t){return t=t==null?__:Math.pow(__,t),new TA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?gg:Math.pow(gg,t),new TA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Eo(ew(t>=240?t-240:t+120,i,r),ew(t,i,r),ew(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function ew(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}var dhe=Math.PI/180,phe=180/Math.PI,v_=18,hO=.96422,fO=1,dO=.82521,pO=4/29,w0=6/29,gO=3*w0*w0,ghe=w0*w0*w0;function mO(t){if(t instanceof BA)return new BA(t.l,t.a,t.b,t.opacity);if(t instanceof Tu)return yO(t);t instanceof Eo||(t=uO(t));var e=iw(t.r),n=iw(t.g),r=iw(t.b),i=tw((.2225045*e+.7168786*n+.0606169*r)/fO),s,A;return e===n&&n===r?s=A=i:(s=tw((.4360747*e+.3850649*n+.1430804*r)/hO),A=tw((.0139322*e+.0971045*n+.7141733*r)/dO)),new BA(116*i-16,500*(s-i),200*(i-A),t.opacity)}function yg(t,e,n,r){return arguments.length===1?mO(t):new BA(t,e,n,r??1)}function BA(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}Xg(BA,yg,C2(Af,{brighter:function(t){return new BA(this.l+v_*(t??1),this.a,this.b,this.opacity)},darker:function(t){return new BA(this.l-v_*(t??1),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=hO*nw(e),t=fO*nw(t),n=dO*nw(n),new Eo(rw(3.1338561*e-1.6168667*t-.4906146*n),rw(-.9787684*e+1.9161415*t+.033454*n),rw(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function tw(t){return t>ghe?Math.pow(t,1/3):t/gO+pO}function nw(t){return t>w0?t*t*t:gO*(t-pO)}function rw(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function iw(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function mhe(t){if(t instanceof Tu)return new Tu(t.h,t.c,t.l,t.opacity);if(t instanceof BA||(t=mO(t)),t.a===0&&t.b===0)return new Tu(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*phe;return new Tu(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function yhe(t,e,n,r){return arguments.length===1?mhe(t):new Tu(t,e,n,r??1)}function Tu(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function yO(t){if(isNaN(t.h))return new BA(t.l,0,0,t.opacity);var e=t.h*dhe;return new BA(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Xg(Tu,yhe,C2(Af,{brighter:function(t){return new Tu(this.h,this.c,this.l+v_*(t??1),this.opacity)},darker:function(t){return new Tu(this.h,this.c,this.l-v_*(t??1),this.opacity)},rgb:function(){return yO(this).rgb()}}));function _O(t){return function(){return t}}function _he(t,e){return function(n){return t+n*e}}function vhe(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function xhe(t){return(t=+t)==1?r0:function(e,n){return n-e?vhe(e,n,t):_O(isNaN(e)?n:e)}}function r0(t,e){var n=e-t;return n?_he(t,n):_O(isNaN(t)?e:t)}const mk=function t(e){var n=xhe(e);function r(i,s){var A=n((i=y3(i)).r,(s=y3(s)).r),a=n(i.g,s.g),y=n(i.b,s.b),w=r0(i.opacity,s.opacity);return function(P){return i.r=A(P),i.g=a(P),i.b=y(P),i.opacity=w(P),i+""}}return r.gamma=t,r}(1);function xc(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var v3=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sw=new RegExp(v3.source,"g");function whe(t){return function(){return t}}function bhe(t){return function(e){return t(e)+""}}function Ehe(t,e){var n=v3.lastIndex=sw.lastIndex=0,r,i,s,A=-1,a=[],y=[];for(t=t+"",e=e+"";(r=v3.exec(t))&&(i=sw.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[A]?a[A]+=s:a[++A]=s),(r=r[0])===(i=i[0])?a[A]?a[A]+=i:a[++A]=i:(a[++A]=null,y.push({i:A,x:xc(r,i)})),n=sw.lastIndex;return n<e.length&&(s=e.slice(n),a[A]?a[A]+=s:a[++A]=s),a.length<2?y[0]?bhe(y[0].x):whe(e):(e=y.length,function(w){for(var P=0,I;P<e;++P)a[(I=y[P]).i]=I.x(w);return a.join("")})}var yk=180/Math.PI,x3={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function vO(t,e,n,r,i,s){var A,a,y;return(A=Math.sqrt(t*t+e*e))&&(t/=A,e/=A),(y=t*n+e*r)&&(n-=t*y,r-=e*y),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,y/=a),t*r<e*n&&(t=-t,e=-e,y=-y,A=-A),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*yk,skewX:Math.atan(y)*yk,scaleX:A,scaleY:a}}var Qd,ow,_k,_1;function The(t){return t==="none"?x3:(Qd||(Qd=document.createElement("DIV"),ow=document.documentElement,_k=document.defaultView),Qd.style.transform=t,t=_k.getComputedStyle(ow.appendChild(Qd),null).getPropertyValue("transform"),ow.removeChild(Qd),t=t.slice(7,-1).split(","),vO(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function She(t){return t==null||(_1||(_1=document.createElementNS("http://www.w3.org/2000/svg","g")),_1.setAttribute("transform",t),!(t=_1.transform.baseVal.consolidate()))?x3:(t=t.matrix,vO(t.a,t.b,t.c,t.d,t.e,t.f))}function xO(t,e,n,r){function i(w){return w.length?w.pop()+" ":""}function s(w,P,I,L,U,W){if(w!==I||P!==L){var q=U.push("translate(",null,e,null,n);W.push({i:q-4,x:xc(w,I)},{i:q-2,x:xc(P,L)})}else(I||L)&&U.push("translate("+I+e+L+n)}function A(w,P,I,L){w!==P?(w-P>180?P+=360:P-w>180&&(w+=360),L.push({i:I.push(i(I)+"rotate(",null,r)-2,x:xc(w,P)})):P&&I.push(i(I)+"rotate("+P+r)}function a(w,P,I,L){w!==P?L.push({i:I.push(i(I)+"skewX(",null,r)-2,x:xc(w,P)}):P&&I.push(i(I)+"skewX("+P+r)}function y(w,P,I,L,U,W){if(w!==I||P!==L){var q=U.push(i(U)+"scale(",null,",",null,")");W.push({i:q-4,x:xc(w,I)},{i:q-2,x:xc(P,L)})}else(I!==1||L!==1)&&U.push(i(U)+"scale("+I+","+L+")")}return function(w,P){var I=[],L=[];return w=t(w),P=t(P),s(w.translateX,w.translateY,P.translateX,P.translateY,I,L),A(w.rotate,P.rotate,I,L),a(w.skewX,P.skewX,I,L),y(w.scaleX,w.scaleY,P.scaleX,P.scaleY,I,L),w=P=null,function(U){for(var W=-1,q=L.length,ae;++W<q;)I[(ae=L[W]).i]=ae.x(U);return I.join("")}}}var Mhe=xO(The,"px, ","px)","deg)"),Che=xO(She,", ",")",")");function Phe(t,e){var n=r0((t=yg(t)).l,(e=yg(e)).l),r=r0(t.a,e.a),i=r0(t.b,e.b),s=r0(t.opacity,e.opacity);return function(A){return t.l=n(A),t.a=r(A),t.b=i(A),t.opacity=s(A),t+""}}var Q0=0,hp=0,qd=0,wO=1e3,x_,fp,w_=0,Qh=0,P2=0,_g=typeof performance=="object"&&performance.now?performance:Date,bO=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function I2(){return Qh||(bO(Ihe),Qh=_g.now()+P2)}function Ihe(){Qh=0}function b_(){this._call=this._time=this._next=null}b_.prototype=EO.prototype={constructor:b_,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?I2():+n)+(e==null?0:+e),!this._next&&fp!==this&&(fp?fp._next=this:x_=this,fp=this),this._call=t,this._time=n,w3()},stop:function(){this._call&&(this._call=null,this._time=1/0,w3())}};function EO(t,e,n){var r=new b_;return r.restart(t,e,n),r}function khe(){I2(),++Q0;for(var t=x_,e;t;)(e=Qh-t._time)>=0&&t._call.call(null,e),t=t._next;--Q0}function vk(){Qh=(w_=_g.now())+P2,Q0=hp=0;try{khe()}finally{Q0=0,Dhe(),Qh=0}}function Lhe(){var t=_g.now(),e=t-w_;e>wO&&(P2-=e,w_=t)}function Dhe(){for(var t,e=x_,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:x_=n);fp=t,w3(r)}function w3(t){if(!Q0){hp&&(hp=clearTimeout(hp));var e=t-Qh;e>24?(t<1/0&&(hp=setTimeout(vk,t-_g.now()-P2)),qd&&(qd=clearInterval(qd))):(qd||(w_=_g.now(),qd=setInterval(Lhe,wO)),Q0=1,bO(vk))}}function xk(t,e,n){var r=new b_;return e=e==null?0:+e,r.restart(function(i){r.stop(),t(i+e)},e,n),r}var Rhe=Xz("start","end","cancel","interrupt"),Bhe=[],TO=0,wk=1,b3=2,oy=3,bk=4,E3=5,ay=6;function k2(t,e,n,r,i,s){var A=t.__transition;if(!A)t.__transition={};else if(n in A)return;zhe(t,n,{name:e,index:r,group:i,on:Rhe,tween:Bhe,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:TO})}function nS(t,e){var n=eA(t,e);if(n.state>TO)throw new Error("too late; already scheduled");return n}function Qu(t,e){var n=eA(t,e);if(n.state>oy)throw new Error("too late; already running");return n}function eA(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function zhe(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=EO(s,0,n.time);function s(w){n.state=wk,n.timer.restart(A,n.delay,n.time),n.delay<=w&&A(w-n.delay)}function A(w){var P,I,L,U;if(n.state!==wk)return y();for(P in r)if(U=r[P],U.name===n.name){if(U.state===oy)return xk(A);U.state===bk?(U.state=ay,U.timer.stop(),U.on.call("interrupt",t,t.__data__,U.index,U.group),delete r[P]):+P<e&&(U.state=ay,U.timer.stop(),U.on.call("cancel",t,t.__data__,U.index,U.group),delete r[P])}if(xk(function(){n.state===oy&&(n.state=bk,n.timer.restart(a,n.delay,n.time),a(w))}),n.state=b3,n.on.call("start",t,t.__data__,n.index,n.group),n.state===b3){for(n.state=oy,i=new Array(L=n.tween.length),P=0,I=-1;P<L;++P)(U=n.tween[P].value.call(t,t.__data__,n.index,n.group))&&(i[++I]=U);i.length=I+1}}function a(w){for(var P=w<n.duration?n.ease.call(null,w/n.duration):(n.timer.restart(y),n.state=E3,1),I=-1,L=i.length;++I<L;)i[I].call(t,P);n.state===E3&&(n.on.call("end",t,t.__data__,n.index,n.group),y())}function y(){n.state=ay,n.timer.stop(),delete r[e];for(var w in r)return;delete t.__transition}}function Ohe(t,e){var n=t.__transition,r,i,s=!0,A;if(n){e=e==null?null:e+"";for(A in n){if((r=n[A]).name!==e){s=!1;continue}i=r.state>b3&&r.state<E3,r.state=ay,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[A]}s&&delete t.__transition}}function Fhe(t){return this.each(function(){Ohe(this,t)})}function Nhe(t,e){var n,r;return function(){var i=Qu(this,t),s=i.tween;if(s!==n){r=n=s;for(var A=0,a=r.length;A<a;++A)if(r[A].name===e){r=r.slice(),r.splice(A,1);break}}i.tween=r}}function Uhe(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=Qu(this,t),A=s.tween;if(A!==r){i=(r=A).slice();for(var a={name:e,value:n},y=0,w=i.length;y<w;++y)if(i[y].name===e){i[y]=a;break}y===w&&i.push(a)}s.tween=i}}function Vhe(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=eA(this.node(),n).tween,i=0,s=r.length,A;i<s;++i)if((A=r[i]).name===t)return A.value;return null}return this.each((e==null?Nhe:Uhe)(n,t,e))}function rS(t,e,n){var r=t._id;return t.each(function(){var i=Qu(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return eA(i,r).value[e]}}function SO(t,e){var n;return(typeof e=="number"?xc:e instanceof Wh?mk:(n=Wh(e))?(e=n,mk):Ehe)(t,e)}function Ghe(t){return function(){this.removeAttribute(t)}}function jhe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function $he(t,e,n){var r,i=n+"",s;return function(){var A=this.getAttribute(t);return A===i?null:A===r?s:s=e(r=A,n)}}function Hhe(t,e,n){var r,i=n+"",s;return function(){var A=this.getAttributeNS(t.space,t.local);return A===i?null:A===r?s:s=e(r=A,n)}}function Whe(t,e,n){var r,i,s;return function(){var A,a=n(this),y;return a==null?void this.removeAttribute(t):(A=this.getAttribute(t),y=a+"",A===y?null:A===r&&y===i?s:(i=y,s=e(r=A,a)))}}function Qhe(t,e,n){var r,i,s;return function(){var A,a=n(this),y;return a==null?void this.removeAttributeNS(t.space,t.local):(A=this.getAttributeNS(t.space,t.local),y=a+"",A===y?null:A===r&&y===i?s:(i=y,s=e(r=A,a)))}}function qhe(t,e){var n=M2(t),r=n==="transform"?Che:SO;return this.attrTween(t,typeof e=="function"?(n.local?Qhe:Whe)(n,r,rS(this,"attr."+t,e)):e==null?(n.local?jhe:Ghe)(n):(n.local?Hhe:$he)(n,r,e))}function Zhe(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Yhe(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Xhe(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&Yhe(t,s)),n}return i._value=e,i}function Khe(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&Zhe(t,s)),n}return i._value=e,i}function Jhe(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=M2(t);return this.tween(n,(r.local?Xhe:Khe)(r,e))}function efe(t,e){return function(){nS(this,t).delay=+e.apply(this,arguments)}}function tfe(t,e){return e=+e,function(){nS(this,t).delay=e}}function nfe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?efe:tfe)(e,t)):eA(this.node(),e).delay}function rfe(t,e){return function(){Qu(this,t).duration=+e.apply(this,arguments)}}function ife(t,e){return e=+e,function(){Qu(this,t).duration=e}}function sfe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?rfe:ife)(e,t)):eA(this.node(),e).duration}function ofe(t,e){if(typeof e!="function")throw new Error;return function(){Qu(this,t).ease=e}}function afe(t){var e=this._id;return arguments.length?this.each(ofe(e,t)):eA(this.node(),e).ease}function lfe(t){typeof t!="function"&&(t=eO(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],A=s.length,a=r[i]=[],y,w=0;w<A;++w)(y=s[w])&&t.call(y,y.__data__,w,s)&&a.push(y);return new $u(r,this._parents,this._name,this._id)}function Afe(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),A=new Array(r),a=0;a<s;++a)for(var y=e[a],w=n[a],P=y.length,I=A[a]=new Array(P),L,U=0;U<P;++U)(L=y[U]||w[U])&&(I[U]=L);for(;a<r;++a)A[a]=e[a];return new $u(A,this._parents,this._name,this._id)}function ufe(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function cfe(t,e,n){var r,i,s=ufe(e)?nS:Qu;return function(){var A=s(this,t),a=A.on;a!==r&&(i=(r=a).copy()).on(e,n),A.on=i}}function hfe(t,e){var n=this._id;return arguments.length<2?eA(this.node(),n).on.on(t):this.each(cfe(n,t,e))}function ffe(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function dfe(){return this.on("end.remove",ffe(this._id))}function pfe(t){var e=this._name,n=this._id;typeof t!="function"&&(t=eS(t));for(var r=this._groups,i=r.length,s=new Array(i),A=0;A<i;++A)for(var a=r[A],y=a.length,w=s[A]=new Array(y),P,I,L=0;L<y;++L)(P=a[L])&&(I=t.call(P,P.__data__,L,a))&&("__data__"in P&&(I.__data__=P.__data__),w[L]=I,k2(w[L],e,n,L,w,eA(P,n)));return new $u(s,this._parents,e,n)}function gfe(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Jz(t));for(var r=this._groups,i=r.length,s=[],A=[],a=0;a<i;++a)for(var y=r[a],w=y.length,P,I=0;I<w;++I)if(P=y[I]){for(var L=t.call(P,P.__data__,I,y),U,W=eA(P,n),q=0,ae=L.length;q<ae;++q)(U=L[q])&&k2(U,e,n,q,L,W);s.push(L),A.push(P)}return new $u(s,A,e,n)}var mfe=Yg.prototype.constructor;function yfe(){return new mfe(this._groups,this._parents)}function _fe(t,e){var n,r,i;return function(){var s=W0(this,t),A=(this.style.removeProperty(t),W0(this,t));return s===A?null:s===n&&A===r?i:i=e(n=s,r=A)}}function MO(t){return function(){this.style.removeProperty(t)}}function vfe(t,e,n){var r,i=n+"",s;return function(){var A=W0(this,t);return A===i?null:A===r?s:s=e(r=A,n)}}function xfe(t,e,n){var r,i,s;return function(){var A=W0(this,t),a=n(this),y=a+"";return a==null&&(y=a=(this.style.removeProperty(t),W0(this,t))),A===y?null:A===r&&y===i?s:(i=y,s=e(r=A,a))}}function wfe(t,e){var n,r,i,s="style."+e,A="end."+s,a;return function(){var y=Qu(this,t),w=y.on,P=y.value[s]==null?a||(a=MO(e)):void 0;(w!==n||i!==P)&&(r=(n=w).copy()).on(A,i=P),y.on=r}}function bfe(t,e,n){var r=(t+="")=="transform"?Mhe:SO;return e==null?this.styleTween(t,_fe(t,r)).on("end.style."+t,MO(t)):typeof e=="function"?this.styleTween(t,xfe(t,r,rS(this,"style."+t,e))).each(wfe(this._id,t)):this.styleTween(t,vfe(t,r,e),n).on("end.style."+t,null)}function Efe(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Tfe(t,e,n){var r,i;function s(){var A=e.apply(this,arguments);return A!==i&&(r=(i=A)&&Efe(t,A,n)),r}return s._value=e,s}function Sfe(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Tfe(t,e,n??""))}function Mfe(t){return function(){this.textContent=t}}function Cfe(t){return function(){var e=t(this);this.textContent=e??""}}function Pfe(t){return this.tween("text",typeof t=="function"?Cfe(rS(this,"text",t)):Mfe(t==null?"":t+""))}function Ife(t){return function(e){this.textContent=t.call(this,e)}}function kfe(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Ife(i)),e}return r._value=t,r}function Lfe(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,kfe(t))}function Dfe(){for(var t=this._name,e=this._id,n=CO(),r=this._groups,i=r.length,s=0;s<i;++s)for(var A=r[s],a=A.length,y,w=0;w<a;++w)if(y=A[w]){var P=eA(y,e);k2(y,t,n,w,A,{time:P.time+P.delay+P.duration,delay:0,duration:P.duration,ease:P.ease})}return new $u(r,this._parents,t,n)}function Rfe(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,A){var a={value:A},y={value:function(){--i===0&&s()}};n.each(function(){var w=Qu(this,r),P=w.on;P!==t&&(e=(t=P).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(y)),w.on=e})})}var Bfe=0;function $u(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function CO(){return++Bfe}var Df=Yg.prototype;$u.prototype={constructor:$u,select:pfe,selectAll:gfe,filter:lfe,merge:Afe,selection:yfe,transition:Dfe,call:Df.call,nodes:Df.nodes,node:Df.node,size:Df.size,empty:Df.empty,each:Df.each,on:hfe,attr:qhe,attrTween:Jhe,style:bfe,styleTween:Sfe,text:Pfe,textTween:Lfe,remove:dfe,tween:Vhe,delay:nfe,duration:sfe,ease:afe,end:Rfe};function zfe(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var T3={time:null,delay:0,duration:250,ease:zfe};function Ofe(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return T3.time=I2(),T3;return n}function Ffe(t){var e,n;t instanceof $u?(e=t._id,t=t._name):(e=CO(),(n=T3).time=I2(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var A=r[s],a=A.length,y,w=0;w<a;++w)(y=A[w])&&k2(y,t,e,w,A,n||Ofe(y,e));return new $u(r,this._parents,t,e)}Yg.prototype.interrupt=Fhe;Yg.prototype.transition=Ffe;var S3=Math.PI,M3=2*S3,_h=1e-6,Nfe=M3-_h;function C3(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function PO(){return new C3}C3.prototype=PO.prototype={constructor:C3,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var s=this._x1,A=this._y1,a=n-t,y=r-e,w=s-t,P=A-e,I=w*w+P*P;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(I>_h)if(!(Math.abs(P*a-y*w)>_h)||!i)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var L=n-s,U=r-A,W=a*a+y*y,q=L*L+U*U,ae=Math.sqrt(W),K=Math.sqrt(I),ne=i*Math.tan((S3-Math.acos((W+I-q)/(2*ae*K)))/2),ie=ne/K,fe=ne/ae;Math.abs(ie-1)>_h&&(this._+="L"+(t+ie*w)+","+(e+ie*P)),this._+="A"+i+","+i+",0,0,"+ +(P*L>w*U)+","+(this._x1=t+fe*a)+","+(this._y1=e+fe*y)}},arc:function(t,e,n,r,i,s){t=+t,e=+e,n=+n,s=!!s;var A=n*Math.cos(r),a=n*Math.sin(r),y=t+A,w=e+a,P=1^s,I=s?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+y+","+w:(Math.abs(this._x1-y)>_h||Math.abs(this._y1-w)>_h)&&(this._+="L"+y+","+w),n&&(I<0&&(I=I%M3+M3),I>Nfe?this._+="A"+n+","+n+",0,1,"+P+","+(t-A)+","+(e-a)+"A"+n+","+n+",0,1,"+P+","+(this._x1=y)+","+(this._y1=w):I>_h&&(this._+="A"+n+","+n+",0,"+ +(I>=S3)+","+P+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var qa="$";function E_(){}E_.prototype=T_.prototype={constructor:E_,has:function(t){return qa+t in this},get:function(t){return this[qa+t]},set:function(t,e){return this[qa+t]=e,this},remove:function(t){var e=qa+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===qa&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===qa&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===qa&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===qa&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===qa&&++t;return t},empty:function(){for(var t in this)if(t[0]===qa)return!1;return!0},each:function(t){for(var e in this)e[0]===qa&&t(this[e],e.slice(1),this)}};function T_(t,e){var n=new E_;if(t instanceof E_)t.each(function(a,y){n.set(y,a)});else if(Array.isArray(t)){var r=-1,i=t.length,s;if(e==null)for(;++r<i;)n.set(r,t[r]);else for(;++r<i;)n.set(e(s=t[r],r,t),s)}else if(t)for(var A in t)n.set(A,t[A]);return n}function Ek(){}var hh=T_.prototype;Ek.prototype={constructor:Ek,has:hh.has,add:function(t){return t+="",this[qa+t]=t,this},remove:hh.remove,clear:hh.clear,values:hh.keys,size:hh.size,empty:hh.empty,each:hh.each};function Ufe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function S_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Vfe(t){return t=S_(Math.abs(t)),t?t[1]:NaN}function Gfe(t,e){return function(n,r){for(var i=n.length,s=[],A=0,a=t[0],y=0;i>0&&a>0&&(y+a+1>r&&(a=Math.max(1,r-y)),s.push(n.substring(i-=a,i+a)),!((y+=a+1)>r));)a=t[A=(A+1)%t.length];return s.reverse().join(e)}}function jfe(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var $fe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function P3(t){if(!(e=$fe.exec(t)))throw new Error("invalid format: "+t);var e;return new iS({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}P3.prototype=iS.prototype;function iS(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}iS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Hfe(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var IO;function Wfe(t,e){var n=S_(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(IO=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,A=r.length;return s===A?r:s>A?r+new Array(s-A+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+S_(t,Math.max(0,e+s-1))[0]}function Tk(t,e){var n=S_(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Sk={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:Ufe,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Tk(t*100,e)},r:Tk,s:Wfe,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function Mk(t){return t}var Ck=Array.prototype.map,Pk=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Qfe(t){var e=t.grouping===void 0||t.thousands===void 0?Mk:Gfe(Ck.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?Mk:jfe(Ck.call(t.numerals,String)),A=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"-":t.minus+"",y=t.nan===void 0?"NaN":t.nan+"";function w(I){I=P3(I);var L=I.fill,U=I.align,W=I.sign,q=I.symbol,ae=I.zero,K=I.width,ne=I.comma,ie=I.precision,fe=I.trim,ye=I.type;ye==="n"?(ne=!0,ye="g"):Sk[ye]||(ie===void 0&&(ie=12),fe=!0,ye="g"),(ae||L==="0"&&U==="=")&&(ae=!0,L="0",U="=");var Me=q==="$"?n:q==="#"&&/[boxX]/.test(ye)?"0"+ye.toLowerCase():"",He=q==="$"?r:/[%p]/.test(ye)?A:"",Qe=Sk[ye],Je=/[defgprs%]/.test(ye);ie=ie===void 0?6:/[gprs]/.test(ye)?Math.max(1,Math.min(21,ie)):Math.max(0,Math.min(20,ie));function tt(Ne){var nt=Me,qe=He,mt,Xt,Et;if(ye==="c")qe=Qe(Ne)+qe,Ne="";else{Ne=+Ne;var fn=Ne<0||1/Ne<0;if(Ne=isNaN(Ne)?y:Qe(Math.abs(Ne),ie),fe&&(Ne=Hfe(Ne)),fn&&+Ne==0&&W!=="+"&&(fn=!1),nt=(fn?W==="("?W:a:W==="-"||W==="("?"":W)+nt,qe=(ye==="s"?Pk[8+IO/3]:"")+qe+(fn&&W==="("?")":""),Je){for(mt=-1,Xt=Ne.length;++mt<Xt;)if(Et=Ne.charCodeAt(mt),48>Et||Et>57){qe=(Et===46?i+Ne.slice(mt+1):Ne.slice(mt))+qe,Ne=Ne.slice(0,mt);break}}}ne&&!ae&&(Ne=e(Ne,1/0));var yt=nt.length+Ne.length+qe.length,bt=yt<K?new Array(K-yt+1).join(L):"";switch(ne&&ae&&(Ne=e(bt+Ne,bt.length?K-qe.length:1/0),bt=""),U){case"<":Ne=nt+Ne+qe+bt;break;case"=":Ne=nt+bt+Ne+qe;break;case"^":Ne=bt.slice(0,yt=bt.length>>1)+nt+Ne+qe+bt.slice(yt);break;default:Ne=bt+nt+Ne+qe;break}return s(Ne)}return tt.toString=function(){return I+""},tt}function P(I,L){var U=w((I=P3(I),I.type="f",I)),W=Math.max(-8,Math.min(8,Math.floor(Vfe(L)/3)))*3,q=Math.pow(10,-W),ae=Pk[8+W/3];return function(K){return U(q*K)+ae}}return{format:w,formatPrefix:P}}var v1,q0;qfe({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function qfe(t){return v1=Qfe(t),q0=v1.format,v1.formatPrefix,v1}function sd(){return Math.random()}(function t(e){function n(r,i){return r=r==null?0:+r,i=i==null?1:+i,arguments.length===1?(i=r,r=0):i-=r,function(){return e()*i+r}}return n.source=t,n})(sd);const Zfe=function t(e){function n(r,i){var s,A;return r=r==null?0:+r,i=i==null?1:+i,function(){var a;if(s!=null)a=s,s=null;else do s=e()*2-1,a=e()*2-1,A=s*s+a*a;while(!A||A>1);return r+i*a*Math.sqrt(-2*Math.log(A)/A)}}return n.source=t,n}(sd);(function t(e){function n(){var r=Zfe.source(e).apply(this,arguments);return function(){return Math.exp(r())}}return n.source=t,n})(sd);const Yfe=function t(e){function n(r){return function(){for(var i=0,s=0;s<r;++s)i+=e();return i}}return n.source=t,n}(sd);(function t(e){function n(r){var i=Yfe.source(e)(r);return function(){return i()/r}}return n.source=t,n})(sd);(function t(e){function n(r){return function(){return-Math.log(1-e())/r}}return n.source=t,n})(sd);function kO(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Xfe(t){return t.length===1&&(t=Kfe(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}function Kfe(t){return function(e,n){return kO(t(e),n)}}var Jfe=Xfe(kO),e0e=Jfe.right;function t0e(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var I3=Math.sqrt(50),k3=Math.sqrt(10),L3=Math.sqrt(2);function n0e(t,e,n){var r,i=-1,s,A,a;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(s=t,t=e,e=s),(a=ly(t,e,n))===0||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),A=new Array(s=Math.ceil(e-t+1));++i<s;)A[i]=(t+i)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),A=new Array(s=Math.ceil(t-e+1));++i<s;)A[i]=(t-i)/a;return r&&A.reverse(),A}function ly(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,i);return i>=0?(s>=I3?10:s>=k3?5:s>=L3?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=I3?10:s>=k3?5:s>=L3?2:1)}function r0e(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=I3?i*=10:s>=k3?i*=5:s>=L3&&(i*=2),e<t?-i:i}function sS(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var LO=Array.prototype,i0e=LO.map,D3=LO.slice,Ik={name:"implicit"};function DO(){var t=T_(),e=[],n=[],r=Ik;function i(s){var A=s+"",a=t.get(A);if(!a){if(r!==Ik)return r;t.set(A,a=e.push(s))}return n[(a-1)%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=T_();for(var A=-1,a=s.length,y,w;++A<a;)t.has(w=(y=s[A])+"")||t.set(w,e.push(y));return i},i.range=function(s){return arguments.length?(n=D3.call(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return DO(e,n).unknown(r)},sS.apply(i,arguments),i}function RO(){var t=DO().unknown(void 0),e=t.domain,n=t.range,r=[0,1],i,s,A=!1,a=0,y=0,w=.5;delete t.unknown;function P(){var I=e().length,L=r[1]<r[0],U=r[L-0],W=r[1-L];i=(W-U)/Math.max(1,I-a+y*2),A&&(i=Math.floor(i)),U+=(W-U-i*(I-a))*w,s=i*(1-a),A&&(U=Math.round(U),s=Math.round(s));var q=t0e(I).map(function(ae){return U+i*ae});return n(L?q.reverse():q)}return t.domain=function(I){return arguments.length?(e(I),P()):e()},t.range=function(I){return arguments.length?(r=[+I[0],+I[1]],P()):r.slice()},t.rangeRound=function(I){return r=[+I[0],+I[1]],A=!0,P()},t.bandwidth=function(){return s},t.step=function(){return i},t.round=function(I){return arguments.length?(A=!!I,P()):A},t.padding=function(I){return arguments.length?(a=Math.min(1,y=+I),P()):a},t.paddingInner=function(I){return arguments.length?(a=Math.min(1,I),P()):a},t.paddingOuter=function(I){return arguments.length?(y=+I,P()):y},t.align=function(I){return arguments.length?(w=Math.max(0,Math.min(1,I)),P()):w},t.copy=function(){return RO(e(),r).round(A).paddingInner(a).paddingOuter(y).align(w)},sS.apply(P(),arguments)}function BO(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return BO(e())},t}function M_(){return BO(RO.apply(null,arguments).paddingInner(1))}function oS(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function zO(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Kg(){}var vg=.7,C_=1/vg,b0="\\s*([+-]?\\d+)\\s*",xg="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",zA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",s0e=/^#([0-9a-f]{3,8})$/,o0e=new RegExp("^rgb\\("+[b0,b0,b0]+"\\)$"),a0e=new RegExp("^rgb\\("+[zA,zA,zA]+"\\)$"),l0e=new RegExp("^rgba\\("+[b0,b0,b0,xg]+"\\)$"),A0e=new RegExp("^rgba\\("+[zA,zA,zA,xg]+"\\)$"),u0e=new RegExp("^hsl\\("+[xg,zA,zA]+"\\)$"),c0e=new RegExp("^hsla\\("+[xg,zA,zA,xg]+"\\)$"),kk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};oS(Kg,wg,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Lk,formatHex:Lk,formatHsl:h0e,formatRgb:Dk,toString:Dk});function Lk(){return this.rgb().formatHex()}function h0e(){return OO(this).formatHsl()}function Dk(){return this.rgb().formatRgb()}function wg(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=s0e.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Rk(e):n===3?new Ea(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?x1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?x1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=o0e.exec(t))?new Ea(e[1],e[2],e[3],1):(e=a0e.exec(t))?new Ea(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=l0e.exec(t))?x1(e[1],e[2],e[3],e[4]):(e=A0e.exec(t))?x1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=u0e.exec(t))?Ok(e[1],e[2]/100,e[3]/100,1):(e=c0e.exec(t))?Ok(e[1],e[2]/100,e[3]/100,e[4]):kk.hasOwnProperty(t)?Rk(kk[t]):t==="transparent"?new Ea(NaN,NaN,NaN,0):null}function Rk(t){return new Ea(t>>16&255,t>>8&255,t&255,1)}function x1(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ea(t,e,n,r)}function f0e(t){return t instanceof Kg||(t=wg(t)),t?(t=t.rgb(),new Ea(t.r,t.g,t.b,t.opacity)):new Ea}function R3(t,e,n,r){return arguments.length===1?f0e(t):new Ea(t,e,n,r??1)}function Ea(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}oS(Ea,R3,zO(Kg,{brighter:function(t){return t=t==null?C_:Math.pow(C_,t),new Ea(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?vg:Math.pow(vg,t),new Ea(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Bk,formatHex:Bk,formatRgb:zk,toString:zk}));function Bk(){return"#"+aw(this.r)+aw(this.g)+aw(this.b)}function zk(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function aw(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function Ok(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new SA(t,e,n,r)}function OO(t){if(t instanceof SA)return new SA(t.h,t.s,t.l,t.opacity);if(t instanceof Kg||(t=wg(t)),!t)return new SA;if(t instanceof SA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),A=NaN,a=s-i,y=(s+i)/2;return a?(e===s?A=(n-r)/a+(n<r)*6:n===s?A=(r-e)/a+2:A=(e-n)/a+4,a/=y<.5?s+i:2-s-i,A*=60):a=y>0&&y<1?0:A,new SA(A,a,y,t.opacity)}function d0e(t,e,n,r){return arguments.length===1?OO(t):new SA(t,e,n,r??1)}function SA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}oS(SA,d0e,zO(Kg,{brighter:function(t){return t=t==null?C_:Math.pow(C_,t),new SA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?vg:Math.pow(vg,t),new SA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ea(lw(t>=240?t-240:t+120,i,r),lw(t,i,r),lw(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function lw(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function aS(t){return function(){return t}}function p0e(t,e){return function(n){return t+n*e}}function g0e(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function m0e(t){return(t=+t)==1?FO:function(e,n){return n-e?g0e(e,n,t):aS(isNaN(e)?n:e)}}function FO(t,e){var n=e-t;return n?p0e(t,n):aS(isNaN(t)?e:t)}const Fk=function t(e){var n=m0e(e);function r(i,s){var A=n((i=R3(i)).r,(s=R3(s)).r),a=n(i.g,s.g),y=n(i.b,s.b),w=FO(i.opacity,s.opacity);return function(P){return i.r=A(P),i.g=a(P),i.b=y(P),i.opacity=w(P),i+""}}return r.gamma=t,r}(1);function y0e(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function _0e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function v0e(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),A;for(A=0;A<r;++A)i[A]=lS(t[A],e[A]);for(;A<n;++A)s[A]=e[A];return function(a){for(A=0;A<r;++A)s[A]=i[A](a);return s}}function x0e(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function P_(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function w0e(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=lS(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var B3=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Aw=new RegExp(B3.source,"g");function b0e(t){return function(){return t}}function E0e(t){return function(e){return t(e)+""}}function T0e(t,e){var n=B3.lastIndex=Aw.lastIndex=0,r,i,s,A=-1,a=[],y=[];for(t=t+"",e=e+"";(r=B3.exec(t))&&(i=Aw.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[A]?a[A]+=s:a[++A]=s),(r=r[0])===(i=i[0])?a[A]?a[A]+=i:a[++A]=i:(a[++A]=null,y.push({i:A,x:P_(r,i)})),n=Aw.lastIndex;return n<e.length&&(s=e.slice(n),a[A]?a[A]+=s:a[++A]=s),a.length<2?y[0]?E0e(y[0].x):b0e(e):(e=y.length,function(w){for(var P=0,I;P<e;++P)a[(I=y[P]).i]=I.x(w);return a.join("")})}function lS(t,e){var n=typeof e,r;return e==null||n==="boolean"?aS(e):(n==="number"?P_:n==="string"?(r=wg(e))?(e=r,Fk):T0e:e instanceof wg?Fk:e instanceof Date?x0e:_0e(e)?y0e:Array.isArray(e)?v0e:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?w0e:P_)(t,e)}function S0e(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function M0e(t){return function(){return t}}function C0e(t){return+t}var Nk=[0,1];function i0(t){return t}function z3(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:M0e(isNaN(e)?NaN:.5)}function Uk(t){var e=t[0],n=t[t.length-1],r;return e>n&&(r=e,e=n,n=r),function(i){return Math.max(e,Math.min(n,i))}}function P0e(t,e,n){var r=t[0],i=t[1],s=e[0],A=e[1];return i<r?(r=z3(i,r),s=n(A,s)):(r=z3(r,i),s=n(s,A)),function(a){return s(r(a))}}function I0e(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),A=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++A<r;)i[A]=z3(t[A],t[A+1]),s[A]=n(e[A],e[A+1]);return function(a){var y=e0e(t,a,1,r)-1;return s[y](i[y](a))}}function k0e(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function L0e(){var t=Nk,e=Nk,n=lS,r,i,s,A=i0,a,y,w;function P(){return a=Math.min(t.length,e.length)>2?I0e:P0e,y=w=null,I}function I(L){return isNaN(L=+L)?s:(y||(y=a(t.map(r),e,n)))(r(A(L)))}return I.invert=function(L){return A(i((w||(w=a(e,t.map(r),P_)))(L)))},I.domain=function(L){return arguments.length?(t=i0e.call(L,C0e),A===i0||(A=Uk(t)),P()):t.slice()},I.range=function(L){return arguments.length?(e=D3.call(L),P()):e.slice()},I.rangeRound=function(L){return e=D3.call(L),n=S0e,P()},I.clamp=function(L){return arguments.length?(A=L?Uk(t):i0,I):A!==i0},I.interpolate=function(L){return arguments.length?(n=L,P()):n},I.unknown=function(L){return arguments.length?(s=L,I):s},function(L,U){return r=L,i=U,P()}}function D0e(t,e){return L0e()(t,e)}function R0e(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function I_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Z0(t){return t=I_(Math.abs(t)),t?t[1]:NaN}function B0e(t,e){return function(n,r){for(var i=n.length,s=[],A=0,a=t[0],y=0;i>0&&a>0&&(y+a+1>r&&(a=Math.max(1,r-y)),s.push(n.substring(i-=a,i+a)),!((y+=a+1)>r));)a=t[A=(A+1)%t.length];return s.reverse().join(e)}}function z0e(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var O0e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function k_(t){if(!(e=O0e.exec(t)))throw new Error("invalid format: "+t);var e;return new AS({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}k_.prototype=AS.prototype;function AS(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}AS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function F0e(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var NO;function N0e(t,e){var n=I_(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(NO=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,A=r.length;return s===A?r:s>A?r+new Array(s-A+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+I_(t,Math.max(0,e+s-1))[0]}function Vk(t,e){var n=I_(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Gk={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:R0e,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Vk(t*100,e)},r:Vk,s:N0e,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function jk(t){return t}var $k=Array.prototype.map,Hk=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function U0e(t){var e=t.grouping===void 0||t.thousands===void 0?jk:B0e($k.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?jk:z0e($k.call(t.numerals,String)),A=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"-":t.minus+"",y=t.nan===void 0?"NaN":t.nan+"";function w(I){I=k_(I);var L=I.fill,U=I.align,W=I.sign,q=I.symbol,ae=I.zero,K=I.width,ne=I.comma,ie=I.precision,fe=I.trim,ye=I.type;ye==="n"?(ne=!0,ye="g"):Gk[ye]||(ie===void 0&&(ie=12),fe=!0,ye="g"),(ae||L==="0"&&U==="=")&&(ae=!0,L="0",U="=");var Me=q==="$"?n:q==="#"&&/[boxX]/.test(ye)?"0"+ye.toLowerCase():"",He=q==="$"?r:/[%p]/.test(ye)?A:"",Qe=Gk[ye],Je=/[defgprs%]/.test(ye);ie=ie===void 0?6:/[gprs]/.test(ye)?Math.max(1,Math.min(21,ie)):Math.max(0,Math.min(20,ie));function tt(Ne){var nt=Me,qe=He,mt,Xt,Et;if(ye==="c")qe=Qe(Ne)+qe,Ne="";else{Ne=+Ne;var fn=Ne<0||1/Ne<0;if(Ne=isNaN(Ne)?y:Qe(Math.abs(Ne),ie),fe&&(Ne=F0e(Ne)),fn&&+Ne==0&&W!=="+"&&(fn=!1),nt=(fn?W==="("?W:a:W==="-"||W==="("?"":W)+nt,qe=(ye==="s"?Hk[8+NO/3]:"")+qe+(fn&&W==="("?")":""),Je){for(mt=-1,Xt=Ne.length;++mt<Xt;)if(Et=Ne.charCodeAt(mt),48>Et||Et>57){qe=(Et===46?i+Ne.slice(mt+1):Ne.slice(mt))+qe,Ne=Ne.slice(0,mt);break}}}ne&&!ae&&(Ne=e(Ne,1/0));var yt=nt.length+Ne.length+qe.length,bt=yt<K?new Array(K-yt+1).join(L):"";switch(ne&&ae&&(Ne=e(bt+Ne,bt.length?K-qe.length:1/0),bt=""),U){case"<":Ne=nt+Ne+qe+bt;break;case"=":Ne=nt+bt+Ne+qe;break;case"^":Ne=bt.slice(0,yt=bt.length>>1)+nt+Ne+qe+bt.slice(yt);break;default:Ne=bt+nt+Ne+qe;break}return s(Ne)}return tt.toString=function(){return I+""},tt}function P(I,L){var U=w((I=k_(I),I.type="f",I)),W=Math.max(-8,Math.min(8,Math.floor(Z0(L)/3)))*3,q=Math.pow(10,-W),ae=Hk[8+W/3];return function(K){return U(q*K)+ae}}return{format:w,formatPrefix:P}}var w1,UO,VO;V0e({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function V0e(t){return w1=U0e(t),UO=w1.format,VO=w1.formatPrefix,w1}function G0e(t){return Math.max(0,-Z0(Math.abs(t)))}function j0e(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Z0(e)/3)))*3-Z0(Math.abs(t)))}function $0e(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Z0(e)-Z0(t))+1}function H0e(t,e,n,r){var i=r0e(t,e,n),s;switch(r=k_(r??",f"),r.type){case"s":{var A=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=j0e(i,A))&&(r.precision=s),VO(r,A)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=$0e(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=G0e(i))&&(r.precision=s-(r.type==="%")*2);break}}return UO(r)}function W0e(t){var e=t.domain;return t.ticks=function(n){var r=e();return n0e(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return H0e(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,A=r[i],a=r[s],y;return a<A&&(y=A,A=a,a=y,y=i,i=s,s=y),y=ly(A,a,n),y>0?(A=Math.floor(A/y)*y,a=Math.ceil(a/y)*y,y=ly(A,a,n)):y<0&&(A=Math.ceil(A*y)/y,a=Math.floor(a*y)/y,y=ly(A,a,n)),y>0?(r[i]=Math.floor(A/y)*y,r[s]=Math.ceil(a/y)*y,e(r)):y<0&&(r[i]=Math.ceil(A*y)/y,r[s]=Math.floor(a*y)/y,e(r)),t},t}function jl(){var t=D0e(i0,i0);return t.copy=function(){return k0e(t,jl())},sS.apply(t,arguments),W0e(t)}function L2(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}function D2(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const Q0e=D2(L2("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));D2(L2("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));D2(L2("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));D2(L2("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function yc(t){return function(){return t}}var Wk=Math.abs,Qs=Math.atan2,fh=Math.cos,q0e=Math.max,uw=Math.min,vA=Math.sin,s0=Math.sqrt,jo=1e-12,bg=Math.PI,L_=bg/2,Z0e=2*bg;function Y0e(t){return t>1?0:t<-1?bg:Math.acos(t)}function Qk(t){return t>=1?L_:t<=-1?-L_:Math.asin(t)}function X0e(t){return t.innerRadius}function K0e(t){return t.outerRadius}function J0e(t){return t.startAngle}function ede(t){return t.endAngle}function tde(t){return t&&t.padAngle}function nde(t,e,n,r,i,s,A,a){var y=n-t,w=r-e,P=A-i,I=a-s,L=I*y-P*w;if(!(L*L<jo))return L=(P*(e-s)-I*(t-i))/L,[t+L*y,e+L*w]}function b1(t,e,n,r,i,s,A){var a=t-n,y=e-r,w=(A?s:-s)/s0(a*a+y*y),P=w*y,I=-w*a,L=t+P,U=e+I,W=n+P,q=r+I,ae=(L+W)/2,K=(U+q)/2,ne=W-L,ie=q-U,fe=ne*ne+ie*ie,ye=i-s,Me=L*q-W*U,He=(ie<0?-1:1)*s0(q0e(0,ye*ye*fe-Me*Me)),Qe=(Me*ie-ne*He)/fe,Je=(-Me*ne-ie*He)/fe,tt=(Me*ie+ne*He)/fe,Ne=(-Me*ne+ie*He)/fe,nt=Qe-ae,qe=Je-K,mt=tt-ae,Xt=Ne-K;return nt*nt+qe*qe>mt*mt+Xt*Xt&&(Qe=tt,Je=Ne),{cx:Qe,cy:Je,x01:-P,y01:-I,x11:Qe*(i/ye-1),y11:Je*(i/ye-1)}}function GO(){var t=X0e,e=K0e,n=yc(0),r=null,i=J0e,s=ede,A=tde,a=null;function y(){var w,P,I=+t.apply(this,arguments),L=+e.apply(this,arguments),U=i.apply(this,arguments)-L_,W=s.apply(this,arguments)-L_,q=Wk(W-U),ae=W>U;if(a||(a=w=PO()),L<I&&(P=L,L=I,I=P),!(L>jo))a.moveTo(0,0);else if(q>Z0e-jo)a.moveTo(L*fh(U),L*vA(U)),a.arc(0,0,L,U,W,!ae),I>jo&&(a.moveTo(I*fh(W),I*vA(W)),a.arc(0,0,I,W,U,ae));else{var K=U,ne=W,ie=U,fe=W,ye=q,Me=q,He=A.apply(this,arguments)/2,Qe=He>jo&&(r?+r.apply(this,arguments):s0(I*I+L*L)),Je=uw(Wk(L-I)/2,+n.apply(this,arguments)),tt=Je,Ne=Je,nt,qe;if(Qe>jo){var mt=Qk(Qe/I*vA(He)),Xt=Qk(Qe/L*vA(He));(ye-=mt*2)>jo?(mt*=ae?1:-1,ie+=mt,fe-=mt):(ye=0,ie=fe=(U+W)/2),(Me-=Xt*2)>jo?(Xt*=ae?1:-1,K+=Xt,ne-=Xt):(Me=0,K=ne=(U+W)/2)}var Et=L*fh(K),fn=L*vA(K),yt=I*fh(fe),bt=I*vA(fe);if(Je>jo){var Kt=L*fh(ne),In=L*vA(ne),En=I*fh(ie),Er=I*vA(ie),Jn;if(q<bg&&(Jn=nde(Et,fn,En,Er,Kt,In,yt,bt))){var ir=Et-Jn[0],Ar=fn-Jn[1],Nn=Kt-Jn[0],xr=In-Jn[1],xt=1/vA(Y0e((ir*Nn+Ar*xr)/(s0(ir*ir+Ar*Ar)*s0(Nn*Nn+xr*xr)))/2),nn=s0(Jn[0]*Jn[0]+Jn[1]*Jn[1]);tt=uw(Je,(I-nn)/(xt-1)),Ne=uw(Je,(L-nn)/(xt+1))}}Me>jo?Ne>jo?(nt=b1(En,Er,Et,fn,L,Ne,ae),qe=b1(Kt,In,yt,bt,L,Ne,ae),a.moveTo(nt.cx+nt.x01,nt.cy+nt.y01),Ne<Je?a.arc(nt.cx,nt.cy,Ne,Qs(nt.y01,nt.x01),Qs(qe.y01,qe.x01),!ae):(a.arc(nt.cx,nt.cy,Ne,Qs(nt.y01,nt.x01),Qs(nt.y11,nt.x11),!ae),a.arc(0,0,L,Qs(nt.cy+nt.y11,nt.cx+nt.x11),Qs(qe.cy+qe.y11,qe.cx+qe.x11),!ae),a.arc(qe.cx,qe.cy,Ne,Qs(qe.y11,qe.x11),Qs(qe.y01,qe.x01),!ae))):(a.moveTo(Et,fn),a.arc(0,0,L,K,ne,!ae)):a.moveTo(Et,fn),!(I>jo)||!(ye>jo)?a.lineTo(yt,bt):tt>jo?(nt=b1(yt,bt,Kt,In,I,-tt,ae),qe=b1(Et,fn,En,Er,I,-tt,ae),a.lineTo(nt.cx+nt.x01,nt.cy+nt.y01),tt<Je?a.arc(nt.cx,nt.cy,tt,Qs(nt.y01,nt.x01),Qs(qe.y01,qe.x01),!ae):(a.arc(nt.cx,nt.cy,tt,Qs(nt.y01,nt.x01),Qs(nt.y11,nt.x11),!ae),a.arc(0,0,I,Qs(nt.cy+nt.y11,nt.cx+nt.x11),Qs(qe.cy+qe.y11,qe.cx+qe.x11),ae),a.arc(qe.cx,qe.cy,tt,Qs(qe.y11,qe.x11),Qs(qe.y01,qe.x01),!ae))):a.arc(0,0,I,fe,ie,ae)}if(a.closePath(),w)return a=null,w+""||null}return y.centroid=function(){var w=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,P=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-bg/2;return[fh(P)*w,vA(P)*w]},y.innerRadius=function(w){return arguments.length?(t=typeof w=="function"?w:yc(+w),y):t},y.outerRadius=function(w){return arguments.length?(e=typeof w=="function"?w:yc(+w),y):e},y.cornerRadius=function(w){return arguments.length?(n=typeof w=="function"?w:yc(+w),y):n},y.padRadius=function(w){return arguments.length?(r=w==null?null:typeof w=="function"?w:yc(+w),y):r},y.startAngle=function(w){return arguments.length?(i=typeof w=="function"?w:yc(+w),y):i},y.endAngle=function(w){return arguments.length?(s=typeof w=="function"?w:yc(+w),y):s},y.padAngle=function(w){return arguments.length?(A=typeof w=="function"?w:yc(+w),y):A},y.context=function(w){return arguments.length?(a=w??null,y):a},y}function D_(){this._=null}function R2(t){t.U=t.C=t.L=t.R=t.P=t.N=null}D_.prototype={constructor:D_,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=qk(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(Zd(this,n),t=n,n=t.U),n.C=!1,r.C=!0,Yd(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(Yd(this,n),t=n,n=t.U),n.C=!1,r.C=!0,Zd(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e=t.U,n,r=t.L,i=t.R,s,A;if(r?i?s=qk(i):s=r:s=i,e?e.L===t?e.L=s:e.R=s:this._=s,r&&i?(A=s.C,s.C=t.C,s.L=r,r.U=s,s!==i?(e=s.U,s.U=t.U,t=s.R,e.L=t,s.R=i,i.U=s):(s.U=e,e=s,t=s.R)):(A=t.C,t=s),t&&(t.U=e),!A){if(t&&t.C){t.C=!1;return}do{if(t===this._)break;if(t===e.L){if(n=e.R,n.C&&(n.C=!1,e.C=!0,Zd(this,e),n=e.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,Yd(this,n),n=e.R),n.C=e.C,e.C=n.R.C=!1,Zd(this,e),t=this._;break}}else if(n=e.L,n.C&&(n.C=!1,e.C=!0,Yd(this,e),n=e.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,Zd(this,n),n=e.L),n.C=e.C,e.C=n.L.C=!1,Yd(this,e),t=this._;break}n.C=!0,t=e,e=e.U}while(!t.C);t&&(t.C=!1)}}};function Zd(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Yd(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function qk(t){for(;t.L;)t=t.L;return t}function dp(t,e,n,r){var i=[null,null],s=Ys.push(i)-1;return i.left=t,i.right=e,n&&R_(i,t,e,n),r&&R_(i,e,t,r),wa[t.index].halfedges.push(s),wa[e.index].halfedges.push(s),i}function Xd(t,e,n){var r=[e,n];return r.left=t,r}function R_(t,e,n,r){!t[0]&&!t[1]?(t[0]=r,t.left=e,t.right=n):t.left===n?t[1]=r:t[0]=r}function rde(t,e,n,r,i){var s=t[0],A=t[1],a=s[0],y=s[1],w=A[0],P=A[1],I=0,L=1,U=w-a,W=P-y,q;if(q=e-a,!(!U&&q>0)){if(q/=U,U<0){if(q<I)return;q<L&&(L=q)}else if(U>0){if(q>L)return;q>I&&(I=q)}if(q=r-a,!(!U&&q<0)){if(q/=U,U<0){if(q>L)return;q>I&&(I=q)}else if(U>0){if(q<I)return;q<L&&(L=q)}if(q=n-y,!(!W&&q>0)){if(q/=W,W<0){if(q<I)return;q<L&&(L=q)}else if(W>0){if(q>L)return;q>I&&(I=q)}if(q=i-y,!(!W&&q<0)){if(q/=W,W<0){if(q>L)return;q>I&&(I=q)}else if(W>0){if(q<I)return;q<L&&(L=q)}return!(I>0)&&!(L<1)||(I>0&&(t[0]=[a+I*U,y+I*W]),L<1&&(t[1]=[a+L*U,y+L*W])),!0}}}}}function ide(t,e,n,r,i){var s=t[1];if(s)return!0;var A=t[0],a=t.left,y=t.right,w=a[0],P=a[1],I=y[0],L=y[1],U=(w+I)/2,W=(P+L)/2,q,ae;if(L===P){if(U<e||U>=r)return;if(w>I){if(!A)A=[U,n];else if(A[1]>=i)return;s=[U,i]}else{if(!A)A=[U,i];else if(A[1]<n)return;s=[U,n]}}else if(q=(w-I)/(L-P),ae=W-q*U,q<-1||q>1)if(w>I){if(!A)A=[(n-ae)/q,n];else if(A[1]>=i)return;s=[(i-ae)/q,i]}else{if(!A)A=[(i-ae)/q,i];else if(A[1]<n)return;s=[(n-ae)/q,n]}else if(P<L){if(!A)A=[e,q*e+ae];else if(A[0]>=r)return;s=[r,q*r+ae]}else{if(!A)A=[r,q*r+ae];else if(A[0]<e)return;s=[e,q*e+ae]}return t[0]=A,t[1]=s,!0}function sde(t,e,n,r){for(var i=Ys.length,s;i--;)(!ide(s=Ys[i],t,e,n,r)||!rde(s,t,e,n,r)||!(Math.abs(s[0][0]-s[1][0])>ai||Math.abs(s[0][1]-s[1][1])>ai))&&delete Ys[i]}function ode(t){return wa[t.index]={site:t,halfedges:[]}}function ade(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function jO(t,e){return e[+(e.left!==t.site)]}function lde(t,e){return e[+(e.left===t.site)]}function Ade(){for(var t=0,e=wa.length,n,r,i,s;t<e;++t)if((n=wa[t])&&(s=(r=n.halfedges).length)){var A=new Array(s),a=new Array(s);for(i=0;i<s;++i)A[i]=i,a[i]=ade(n,Ys[r[i]]);for(A.sort(function(y,w){return a[w]-a[y]}),i=0;i<s;++i)a[i]=r[A[i]];for(i=0;i<s;++i)r[i]=a[i]}}function ude(t,e,n,r){var i=wa.length,s,A,a,y,w,P,I,L,U,W,q,ae,K=!0;for(s=0;s<i;++s)if(A=wa[s]){for(a=A.site,w=A.halfedges,y=w.length;y--;)Ys[w[y]]||w.splice(y,1);for(y=0,P=w.length;y<P;)W=lde(A,Ys[w[y]]),q=W[0],ae=W[1],I=jO(A,Ys[w[++y%P]]),L=I[0],U=I[1],(Math.abs(q-L)>ai||Math.abs(ae-U)>ai)&&(w.splice(y,0,Ys.push(Xd(a,W,Math.abs(q-t)<ai&&r-ae>ai?[t,Math.abs(L-t)<ai?U:r]:Math.abs(ae-r)<ai&&n-q>ai?[Math.abs(U-r)<ai?L:n,r]:Math.abs(q-n)<ai&&ae-e>ai?[n,Math.abs(L-n)<ai?U:e]:Math.abs(ae-e)<ai&&q-t>ai?[Math.abs(U-e)<ai?L:t,e]:null))-1),++P);P&&(K=!1)}if(K){var ne,ie,fe,ye=1/0;for(s=0,K=null;s<i;++s)(A=wa[s])&&(a=A.site,ne=a[0]-t,ie=a[1]-e,fe=ne*ne+ie*ie,fe<ye&&(ye=fe,K=A));if(K){var Me=[t,e],He=[t,r],Qe=[n,r],Je=[n,e];K.halfedges.push(Ys.push(Xd(a=K.site,Me,He))-1,Ys.push(Xd(a,He,Qe))-1,Ys.push(Xd(a,Qe,Je))-1,Ys.push(Xd(a,Je,Me))-1)}}for(s=0;s<i;++s)(A=wa[s])&&(A.halfedges.length||delete wa[s])}var $O=[],uS;function cde(){R2(this),this.x=this.y=this.arc=this.site=this.cy=null}function o0(t){var e=t.P,n=t.N;if(!(!e||!n)){var r=e.site,i=t.site,s=n.site;if(r!==s){var A=i[0],a=i[1],y=r[0]-A,w=r[1]-a,P=s[0]-A,I=s[1]-a,L=2*(y*I-w*P);if(!(L>=-gde)){var U=y*y+w*w,W=P*P+I*I,q=(I*U-w*W)/L,ae=(y*W-P*U)/L,K=$O.pop()||new cde;K.arc=t,K.site=i,K.x=q+A,K.y=(K.cy=ae+a)+Math.sqrt(q*q+ae*ae),t.circle=K;for(var ne=null,ie=Eg._;ie;)if(K.y<ie.y||K.y===ie.y&&K.x<=ie.x)if(ie.L)ie=ie.L;else{ne=ie.P;break}else if(ie.R)ie=ie.R;else{ne=ie;break}Eg.insert(ne,K),ne||(uS=K)}}}}function E0(t){var e=t.circle;e&&(e.P||(uS=e.N),Eg.remove(e),$O.push(e),R2(e),t.circle=null)}var HO=[];function hde(){R2(this),this.edge=this.site=this.circle=null}function Zk(t){var e=HO.pop()||new hde;return e.site=t,e}function cw(t){E0(t),T0.remove(t),HO.push(t),R2(t)}function fde(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],s=t.P,A=t.N,a=[t];cw(t);for(var y=s;y.circle&&Math.abs(n-y.circle.x)<ai&&Math.abs(r-y.circle.cy)<ai;)s=y.P,a.unshift(y),cw(y),y=s;a.unshift(y),E0(y);for(var w=A;w.circle&&Math.abs(n-w.circle.x)<ai&&Math.abs(r-w.circle.cy)<ai;)A=w.N,a.push(w),cw(w),w=A;a.push(w),E0(w);var P=a.length,I;for(I=1;I<P;++I)w=a[I],y=a[I-1],R_(w.edge,y.site,w.site,i);y=a[0],w=a[P-1],w.edge=dp(y.site,w.site,null,i),o0(y),o0(w)}function dde(t){for(var e=t[0],n=t[1],r,i,s,A,a=T0._;a;)if(s=WO(a,n)-e,s>ai)a=a.L;else if(A=e-pde(a,n),A>ai){if(!a.R){r=a;break}a=a.R}else{s>-ai?(r=a.P,i=a):A>-ai?(r=a,i=a.N):r=i=a;break}ode(t);var y=Zk(t);if(T0.insert(r,y),!(!r&&!i)){if(r===i){E0(r),i=Zk(r.site),T0.insert(y,i),y.edge=i.edge=dp(r.site,y.site),o0(r),o0(i);return}if(!i){y.edge=dp(r.site,y.site);return}E0(r),E0(i);var w=r.site,P=w[0],I=w[1],L=t[0]-P,U=t[1]-I,W=i.site,q=W[0]-P,ae=W[1]-I,K=2*(L*ae-U*q),ne=L*L+U*U,ie=q*q+ae*ae,fe=[(ae*ne-U*ie)/K+P,(L*ie-q*ne)/K+I];R_(i.edge,w,W,fe),y.edge=dp(w,t,null,fe),i.edge=dp(t,W,null,fe),o0(r),o0(i)}}function WO(t,e){var n=t.site,r=n[0],i=n[1],s=i-e;if(!s)return r;var A=t.P;if(!A)return-1/0;n=A.site;var a=n[0],y=n[1],w=y-e;if(!w)return a;var P=a-r,I=1/s-1/w,L=P/w;return I?(-L+Math.sqrt(L*L-2*I*(P*P/(-2*w)-y+w/2+i-s/2)))/I+r:(r+a)/2}function pde(t,e){var n=t.N;if(n)return WO(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var ai=1e-6,gde=1e-12,T0,wa,Eg,Ys;function mde(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function yde(t,e){return e[1]-t[1]||e[0]-t[0]}function Yk(t,e){var n=t.sort(yde).pop(),r,i,s;for(Ys=[],wa=new Array(t.length),T0=new D_,Eg=new D_;;)if(s=uS,n&&(!s||n[1]<s.y||n[1]===s.y&&n[0]<s.x))(n[0]!==r||n[1]!==i)&&(dde(n),r=n[0],i=n[1]),n=t.pop();else if(s)fde(s.arc);else break;if(Ade(),e){var A=+e[0][0],a=+e[0][1],y=+e[1][0],w=+e[1][1];sde(A,a,y,w),ude(A,a,y,w)}this.edges=Ys,this.cells=wa,T0=Eg=Ys=wa=null}Yk.prototype={constructor:Yk,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(r){return jO(e,t[r])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,r){if(a=(s=n.halfedges).length)for(var i=n.site,s,A=-1,a,y,w=e[s[a-1]],P=w.left===i?w.right:w.left;++A<a;)y=P,w=e[s[A]],P=w.left===i?w.right:w.left,y&&P&&r<y.index&&r<P.index&&mde(i,y,P)<0&&t.push([i.data,y.data,P.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var r=this,i,s=r._found||0,A=r.cells.length,a;!(a=r.cells[s]);)if(++s>=A)return null;var y=t-a.site[0],w=e-a.site[1],P=y*y+w*w;do a=r.cells[i=s],s=null,a.halfedges.forEach(function(I){var L=r.edges[I],U=L.left;if(!((U===a.site||!U)&&!(U=L.right))){var W=t-U[0],q=e-U[1],ae=W*W+q*q;ae<P&&(P=ae,s=U.index)}});while(s!==null);return r._found=i,n==null||P<=n*n?a.site:null}};function pp(t,e,n){this.k=t,this.x=e,this.y=n}pp.prototype={constructor:pp,scale:function(t){return t===1?this:new pp(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new pp(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};pp.prototype;function QO(t,e,n,r,i,s){var A=i||0,a=s||0,y=n||0,w=e||function(){return"#fff"},P=r,I;function L(U){L.el=U,L.setProperties()}return L.setProperties=function(){this.el&&(L.svgGroup||(L.svgGroup=L.el.append("g")),L.svgGroup.attr("transform","translate("+A+","+a+")"),L.svgGroup.selectAll("g").data(t).enter().append("g").selectAll("rect").data(function(U,W){return U.map(function(q){return{r:W,v:q}})}).enter().append("rect").datum(function(U,W){return U.c=W,U}),L.svgGroup.selectAll("g").selectAll("rect").attr("x",function(U){return y/t[U.r].length*U.c}).attr("y",function(U){return U.r*I}).attr("width",function(U){return y/t[U.r].length}).attr("height",I).attr("fill",function(U){return w(U.v)}),P&&L.svgGroup.attr("id",P))},L.data=function(U){return arguments.length?(t=U,I=y/t.length,L.setProperties(),L):t},L.x=function(U){return arguments.length?(A=U,L.setProperties(),L):A},L.y=function(U){return arguments.length?(a=U,L.setProperties(),L):a},L.size=function(U){return arguments.length?(y=U,t&&(I=y/t.length,L.setProperties()),L):y},L.scale=function(U){return arguments.length?(w=U,t&&L.setProperties(),L):w},L.id=function(U){return arguments.length?(P=U,L.setProperties(),L):P},L}function _de(t,e,n,r,i,s){var A=QO(t,e,n,r,i,s);function a(y,w,P,I){var L=jl().domain([0,I]).range([-Math.PI/6,Math.PI/6]),U=jl().domain([0,P]).range([w,0]),W=GO().innerRadius(U(y.r+1)).outerRadius(U(y.r)).startAngle(L(y.c)).endAngle(L(y.c+1));return W()}return A.setProperties=function(){var y=A.data(),w=A.size(),P=A.scale(),I=A.id(),L=A.x(),U=A.y();A.el&&(A.svgGroup||(A.svgGroup=A.el.append("g")),A.svgGroup.attr("transform","translate("+L+","+U+")"),A.svgGroup.selectAll("g").data(y).enter().append("g").selectAll("path").data(function(W,q){return W.map(function(ae){return{r:q,v:ae}})}).enter().append("path").datum(function(W,q){return W.c=q,W}),A.svgGroup.selectAll("g").selectAll("path").attr("transform","translate("+w/2+","+w+")").attr("d",function(W){return a(W,w,y.length,y[W.r].length)}).attr("fill",function(W){return P(W.v)}),I&&A.svgGroup.attr("id",I))},A}var vde=1e-9;function xde(t,e){var n=t||2,r=e||2,i=jl(),s=jl(),A=y();function a(w,P){for(var I=P??w.u,L=P!=null?w:w.v,U=0;U<A.length-1&&i(I)<1-(U+1)/r-vde;)U++;for(var W=A[U].length>1?(A[U][1].v-A[U][0].v)/2:0,q=0;q<A[U].length-1&&L>A[U][q].v+W;)q++;return A[U][q]}function y(){var w=[],P;s.nice(Math.pow(n,r-1)),i.nice(r),w[0]=[],w[0].push({u:i.invert((r-1)/r),v:s.invert(.5)});for(var I=1;I<r;I++){w[I]=[],P=2*Math.pow(n,I);for(var L=1;L<P;L+=2)w[I].push({u:i.invert(1-(I+1)/r),v:s.invert(L/P)})}return w}return a.range=function(){return[].concat.apply([],A)},a.tree=function(){return A},a.data=a.tree,a.branching=function(w){return arguments.length?(n=Math.max(1,w),A=y(),a):n},a.layers=function(w){return arguments.length?(r=Math.max(1,w),A=y(),a):r},a.uncertaintyDomain=function(w){return arguments.length?(i.domain(w),A=y(),a):i.domain()},a.valueDomain=function(w){return arguments.length?(s.domain(w),A=y(),a):s.domain()},a}function wde(t,e,n){var r=e||Q0e,i=n||function(y,w){var P=w!=null?{v:y,u:w}:{v:y.v,u:y.u};return P},s=t;function A(y,w){var P=yg(Wh(y)),I=yg(Wh(w));return Math.sqrt(Math.pow(P.l-I.l,2)+Math.pow(P.a-I.a,2)+Math.pow(P.b-I.b,2))}function a(y,w){var P=i(y,w),I=[0,1],L=[0,1];i.uncertaintyDomain&&(I=i.uncertaintyDomain()),i.valueDomain&&(L=i.valueDomain());var U=jl().domain(I).range([0,1]),W=jl().domain(L).range([0,1]),q=r(W(P.v));switch(s){case"usl":default:q=Phe(q,"#fff")(U(P.u));break;case"us":q=_3(q);var ae=jl().domain([0,1]).range([q.s,0]);q.s=ae(U(P.u));break;case"ul":q=_3(q);var K=jl().domain([0,1]).range([q.l,1]);q.l=K(U(P.u));break}return q}return a.colorList=function(){return this.quantize().range().map(function(y){return a(y)})},a.colorDists=function(){for(var y=this.colorList(),w=new Array(y.length),P,I=new Array(2),L,U=0;U<w.length;U++){w[U]=new Array(y.length);for(var W=0;W<w[U].length;W++)L=A(y[U],y[W]),w[U][W]=L,U!=W&&(U==0&&W==1||L<P)&&(P=L,I=[y[U],y[W]])}return w.minDist=P,w.minPair=I,w},a.mode=function(y){return arguments.length?(s=y,a):s},a.range=function(y){return arguments.length?(r=y,a):r},a.quantize=function(y){return arguments.length?(i=y,a):i},a}function bde(t,e,n,r,i,s,A){var a=null,y=i,w=t||null,P=e||200,I=n||30,L=r||null,U=s||0,W=A||0;function q(ae){a=ae,q.setProperties()}return q.setProperties=function(){if(a){var ae=w.domain?w.domain():[0,1],K=P/w.range().length,ne=(ae[1]-ae[0])/w.range().length,ie=pg(ae[0],ae[1]+ne,ne),fe=M_().range([0,P]).domain(ie).round(!0);a.attr("class","legend").attr("transform","translate("+U+","+W+")");var ye=a.selectAll("rect").data(w.range());ye.enter().append("rect").merge(ye).attr("x",function(Qe,Je){return Je*K}).attr("y",0).attr("height",I).attr("width",K).attr("fill",function(Qe){return Qe});var Me=a.select("g.legend > g");Me.empty()&&(Me=a.append("g")),Me.attr("transform","translate(0, "+I+")").call(zue(fe).tickFormat(q0(L||"")));var He=a.select("g.legend > text");He.empty()&&(He=a.append("text")),He.style("text-anchor","middle").style("font-size",13).attr("transform","translate("+P/2+", "+(I+30)+")").text(y)}},q.title=function(ae){return arguments.length?(y=ae,q.setProperties(),q):y},q.scale=function(ae){return arguments.length?(w=ae,q.setProperties(),q):w},q.size=function(ae){return arguments.length?(P=ae,q.setProperties(),q):P},q.height=function(ae){return arguments.length?(I=ae,q.setProperties(),q):I},q.format=function(ae){return arguments.length?(L=ae,q.setProperties(),q):L},q.x=function(ae){return arguments.length?(U=ae,q.setProperties(),q):U},q.y=function(ae){return arguments.length?(W=ae,q.setProperties(),q):W},q}function Ede(t,e,n,r,i,s,A){var a=null,y=r||"Uncertainty",w=i||"Value",P=t||null,I=e||200,L=n||null,U=s||0,W=A||0,q=null,ae=QO(),K=function(ne){a=ne,K.setProperties(),a.call(ae)};return K.setProperties=function(){if(a){var ne=q;ne||(ne=P.quantize().data());for(var ie=[],fe=0;fe<ne.length;fe++)ie[fe]=ne[ne.length-fe-1];ae.y(1),ae.data(ie),ae.scale(P),ae.size(I),a.attr("class","legend").attr("transform","translate("+U+","+W+")");var ye=P&&P.quantize?P.quantize().uncertaintyDomain():[0,1],Me=(ye[1]-ye[0])/ie.length,He=pg(ye[0],ye[1]+Me,Me),Qe=P&&P.quantize?P.quantize().valueDomain():[0,1],Je=(Qe[1]-Qe[0])/ie.length,tt=pg(Qe[0],Qe[1]+Je,Je),Ne=M_().range([0,I]).domain(tt);a.append("g").call(Bue(Ne).tickFormat(q0(L||""))),a.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+I/2+", -25)").text(w);var nt=M_().range([0,I]).domain(He);a.append("g").attr("transform","translate("+I+", 0)").call(Yz(nt).tickFormat(q0(L||""))),a.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(I+40)+", "+I/2+")rotate(90)").text(y)}},K.data=function(ne){return arguments.length?(q=ne,K.setProperties(),K):q},K.scale=function(ne){return arguments.length?(P=ne,K.setProperties(),K):P},K.size=function(ne){return arguments.length?(I=ne,K.setProperties(),K):I},K.format=function(ne){return arguments.length?(L=ne,K.setProperties(),K):L},K.x=function(ne){return arguments.length?(U=ne,K.setProperties(),K):U},K.y=function(ne){return arguments.length?(W=ne,K.setProperties(),K):W},K.utitle=function(ne){return arguments.length?(y=ne,K.setProperties(),K):y},K.vtitle=function(ne){return arguments.length?(w=ne,K.setProperties(),K):w},K}function Tde(t,e,n,r,i,s,A){var a=null,y=r||"Uncertainty",w=i||"Value",P=t||null,I=e||200,L=n||null,U=s||0,W=A||0,q=null,ae=_de(),K=function(ne){a=ne,K.setProperties(),a.call(ae)};return K.setProperties=function(){if(a){var ne=q;ne||(ne=P.quantize().data());for(var ie=[],fe=0;fe<ne.length;fe++)ie[fe]=ne[ne.length-fe-1];ae.data(ie),ae.scale(P),ae.size(I),a.attr("class","legend").attr("transform","translate("+U+","+W+")");var ye=P&&P.quantize?P.quantize().uncertaintyDomain():[0,1],Me=(ye[1]-ye[0])/ie.length,He=pg(ye[0],ye[1]+Me,Me),Qe=M_().range([0,I]).domain(He),Je=I/180;a.append("g").attr("transform","translate("+(I+6*Je)+","+28*Je+")rotate(30)").call(Yz(Qe).tickFormat(q0(L||""))),a.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(I+10*Je)+","+(40*Je+I/2)+")rotate(-60)").text(y);var tt=P&&P.quantize?P.quantize().valueDomain():[0,1],Ne=(tt[1]-tt[0])/ie[0].length,nt=pg(tt[0],tt[1]+Ne,Ne),qe=jl().range([0,I]).domain(tt),mt=L?q0(L):qe.tickFormat(nt.length),Xt=jl().domain(tt).range([-30,30]),Et=3*Je,fn=GO().innerRadius(I+Et).outerRadius(I+Et+1).startAngle(-Math.PI/6).endAngle(Math.PI/6),yt=a.append("g").attr("transform","translate("+I/2+","+(I-Et)+")");yt.append("path").attr("fill","black").attr("stroke","transparent").attr("d",fn);var bt=yt.selectAll(".arc-label").data(nt).enter().append("g").attr("class","arc-label").attr("transform",function(Kt){return"rotate("+Xt(Kt)+")translate(0,"+(-I-Et)+")"});bt.append("text").style("font-size","11").style("text-anchor","middle").attr("y",-10).text(mt),bt.append("line").attr("x1",.5).attr("x2",.5).attr("y1",-6).attr("y2",0).attr("stroke","#000"),a.append("text").style("text-anchor","middle").style("font-size",13).attr("x",I/2).attr("y",-30).text(w)}},K.data=function(ne){return arguments.length?(q=ne,K.setProperties(),K):q},K.scale=function(ne){return arguments.length?(P=ne,K.setProperties(),K):P},K.size=function(ne){return arguments.length?(I=ne,K.setProperties(),K):I},K.format=function(ne){return arguments.length?(L=ne,K.setProperties(),K):L},K.x=function(ne){return arguments.length?(U=ne,K.setProperties(),K):U},K.y=function(ne){return arguments.length?(W=ne,K.setProperties(),K):W},K.utitle=function(ne){return arguments.length?(y=ne,K.setProperties(),K):y},K.vtitle=function(ne){return arguments.length?(w=ne,K.setProperties(),K):w},K}const Sde=Object.freeze(Object.defineProperty({__proto__:null,arcmapLegend:Tde,heatmapLegend:Ede,simpleLegend:bde},Symbol.toStringTag,{value:"Module"}));var Xk=Sde;function O3(t,e){return t+e}function Su(t,e=1,n=1){if(typeof t=="function")return A=>Su(t(A),e,n);Array.isArray(t)&&(t=sg(...t).toString());const{l:r,c:i,h:s}=FP(t);return FP(r+18*n,i+18*e,s).toString()}function Mde(t,e,n){let r={};return n||(n=[]),Object.keys(t).forEach(i=>{if(n.includes(i))return;let s=t[i],A={};Object.keys(s).forEach(a=>{e(s[a])&&(A[a]=s[a])}),r[i]=A}),r}function Cde(t,e){return t.reduce(function(n,r){return n[e(r)]=r,n},{})}const qO=t=>!!(t.properties||{}).id,Kk=t=>!qO(t),Jk=t=>t.toLocaleString("default",{month:"long"})+" "+t.toLocaleString("default",{year:"numeric"}),hw=t=>Lde[t.properties.LandUse.constructor===Array?t.properties.LandUse[0]:t.properties.LandUse],fw=t=>t.replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),gp=10,dw=(t,e=0)=>Math.abs(t-e)<1/gp?0:1,ZO=(t,e)=>{const n=Object.keys(t);for(const r of n){const i=t[r],s=i.value.range||[0,1],A=i.variance.range||[1,0],a=i.value.color||cI,y=i.variance.color||cI;if(typeof i.value.domain=="function"){const I=Object.values(e).slice(-1)[0];i.value.domain=MP(Object.values(I).map(i.value.domain))}if(typeof i.value.domain=="string"){const I=Object.values(e).slice(-1)[0];i.value.domain=MP(Object.values(I).map(L=>L[i.value.domain]))}const w=rl().domain(i.value.domain).range(s),P=rl().domain(i.variance.domain).range(A);i.scaleLinear=w.copy().clamp(!0),i.scaleStepped=CA().domain(i.value.domain).range(qb(s[0],s[1],gp)),i.scaleLinearVar=P.copy().clamp(!0),i.scaleSteppedVar=CA().domain(i.variance.domain).range(qb(A[0],A[1],gp)),i.colorsLinear=I=>a(w(I)),i.colorsStepped=CA().domain(i.value.domain).range(UP(I=>a(rl([0,1]).range(s)(I)),gp)),i.colorsLinearVar=I=>y(P(I)),i.colorsSteppedVar=CA().domain(i.variance.domain).range(UP(I=>y(rl([0,1]).range(A)(I)),gp)),i.vsup=wde().quantize(xde().branching(2).layers(4).valueDomain(i.value.domain).uncertaintyDomain(i.variance.domain)).range(a),i.interpColor=(I,L=!1,U=!0)=>[...fw((U?i.colorsStepped:i.colorsLinear)(I)),...L?[dw(i.scaleStepped(I),i.value.zero||0)*255]:[]],i.interpColorVar=(I,L=!1,U=!0)=>[...fw((U?i.colorsSteppedVar:i.colorsLinearVar)(I)),...L?[dw(i.scaleSteppedVar(I),i.variance.zero||0)*255]:[]],i.interpVsup=(I,L,U=!1)=>[...fw(i.vsup(I,L)),...U?[dw(i.scaleStepped(I),i.value.zero||0)*255]:[]]}return t},B_=[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,0],[-.67,0,0],[.67,0,0],[-.33,.58,0],[.33,.58,0],[-.33,-.58,0],[.33,-.58,0]]],Pde={longitude:-121.046040643251,latitude:37.53320315272563,zoom:7.3252675985610685,minZoom:7,maxZoom:15,pitch:50.85,bearing:32.58};new rd;new rd;new rd;new rd;new rd;new rd;const Ide=new TR({color:[255,255,255],intensity:1.7}),kde=new GX({timestamp:Date.UTC(2019,6,1,22),color:[255,255,255],intensity:.8}),Lde={0:"Settlement",1:"Exchange",2:"Project",3:"Non-Project"},Js={0:"bl_h000",1:"CS3_ALT3_2022med_L2020ADV",2:"LTO_BA_EXP1_2022MED"},e6={0:"Scenario 1",1:"Scenario 2",2:"Scenario 3"},cS=new dT({ambientLight:Ide,dirLight:kde}),Dde={longitude:-119.99582643167989,latitude:37.88453894208306,zoom:10.364947995424346,pitch:49.903969287830776,bearing:28.126875},Rde={power:{value:{domain:[0,300]},variance:{domain:[0,100],range:[0,1]}},personnel:{value:{domain:[0,100]},variance:{domain:[0,1]}}},Bde={groundwater:{value:{domain:[-300,700],color:Su(t=>nae(rl([.75,1])(t)),-.5,.5)},variance:{domain:[0,1e4]}},demand:{value:{domain:[0,150],color:Su(hI,1,1)},variance:{domain:[0,650]}},unmetDemand:{value:{domain:[-150,0],range:[1,0],color:Su(hI,0,0)},variance:{domain:[0,650]}},difference:{value:{domain:[-30,30],color:Su(eae,0,0),zero:.5},variance:{domain:[0,650]}}},YO=Mde(await(await fetch("./assets/hex_5_6.json")).json(),t=>t.DemandBaseline),pw=await(await fetch("./assets/averages.json")).json(),z_=await(await fetch("./assets/demand_geo.json")).json(),zde=await(await fetch("./assets/groundwater_geo.json")).json(),Ode=await(await fetch("./assets/fire_hex_7_9.json")).json();function XO(){const[t,e]=At.useState(1027),[n,r]=At.useState(!1),[i,s]=At.useState(1);return At.useEffect(()=>{if(n){let A=setTimeout(()=>e(a=>a%1199+1),33.333333333333336);return function(){clearTimeout(A)}}},[t,n]),{speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r,curOption:i,setCurOption:s}}function Fde(t,e){var n,r,i,s,A,a,y,w,P,I,L=0,U=t.type==="FeatureCollection",W=t.type==="Feature",q=U?t.features.length:1;for(n=0;n<q;n++){for(a=U?t.features[n].geometry:W?t.geometry:t,w=U?t.features[n].properties:W?t.properties:{},P=U?t.features[n].bbox:W?t.bbox:void 0,I=U?t.features[n].id:W?t.id:void 0,y=a?a.type==="GeometryCollection":!1,A=y?a.geometries.length:1,i=0;i<A;i++){if(s=y?a.geometries[i]:a,s===null){if(e(null,L,w,P,I)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,L,w,P,I)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(e(s.geometries[r],L,w,P,I)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}L++}}function Nde(t,e,n){var r=n;return Fde(t,function(i,s,A,a,y){s===0&&n===void 0?r=i:r=e(r,i,s,A,a,y)}),r}var t6=6378137;function n6(t){return Nde(t,function(e,n){return e+Ude(n)},0)}function Ude(t){var e=0,n;switch(t.type){case"Polygon":return r6(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)e+=r6(t.coordinates[n]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function r6(t){var e=0;if(t&&t.length>0){e+=Math.abs(i6(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(i6(t[n]))}return e}function i6(t){var e,n,r,i,s,A,a,y=0,w=t.length;if(w>2){for(a=0;a<w;a++)a===w-2?(i=w-2,s=w-1,A=0):a===w-1?(i=w-1,s=0,A=1):(i=a,s=a+1,A=a+2),e=t[i],n=t[s],r=t[A],y+=(gw(r[0])-gw(e[0]))*Math.sin(gw(n[1]));y=y*t6*t6/2}return y}function gw(t){return t*Math.PI/180}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Vde(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,A;return A={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function a(w){return function(P){return y([w,P])}}function y(w){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=w[0]&2?i.return:w[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,w[1])).done)return s;switch(i=0,s&&(w=[w[0]&2,s.value]),w[0]){case 0:case 1:s=w;break;case 4:return n.label++,{value:w[1],done:!1};case 5:n.label++,i=w[1],w=[0];continue;case 7:w=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(w[0]===6||w[0]===2)){n=0;continue}if(w[0]===3&&(!s||w[1]>s[0]&&w[1]<s[3])){n.label=w[1];break}if(w[0]===6&&n.label<s[1]){n.label=s[1],s=w;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(w);break}s[2]&&n.ops.pop(),n.trys.pop();continue}w=e.call(t,n)}catch(P){w=[6,P],i=0}finally{r=s=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}}var qc=function(){function t(e,n){this.next=null,this.key=e,this.data=n,this.left=null,this.right=null}return t}();function Gde(t,e){return t>e?1:t<e?-1:0}function Ec(t,e,n){for(var r=new qc(null,null),i=r,s=r;;){var A=n(t,e.key);if(A<0){if(e.left===null)break;if(n(t,e.left.key)<0){var a=e.left;if(e.left=a.right,a.right=e,e=a,e.left===null)break}s.left=e,s=e,e=e.left}else if(A>0){if(e.right===null)break;if(n(t,e.right.key)>0){var a=e.right;if(e.right=a.left,a.left=e,e=a,e.right===null)break}i.right=e,i=e,e=e.right}else break}return i.right=e.left,s.left=e.right,e.left=r.right,e.right=r.left,e}function mw(t,e,n,r){var i=new qc(t,e);if(n===null)return i.left=i.right=null,i;n=Ec(t,n,r);var s=r(t,n.key);return s<0?(i.left=n.left,i.right=n,n.left=null):s>=0&&(i.right=n.right,i.left=n,n.right=null),i}function s6(t,e,n){var r=null,i=null;if(e){e=Ec(t,e,n);var s=n(e.key,t);s===0?(r=e.left,i=e.right):s<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function jde(t,e,n){return e===null?t:(t===null||(e=Ec(t.key,e,n),e.left=t),e)}function F3(t,e,n,r,i){if(t){r(""+e+(n?" ":" ")+i(t)+`
`);var s=e+(n?"    ":"   ");t.left&&F3(t.left,s,!1,r,i),t.right&&F3(t.right,s,!0,r,i)}}var hS=function(){function t(e){e===void 0&&(e=Gde),this._root=null,this._size=0,this._comparator=e}return t.prototype.insert=function(e,n){return this._size++,this._root=mw(e,n,this._root,this._comparator)},t.prototype.add=function(e,n){var r=new qc(e,n);this._root===null&&(r.left=r.right=null,this._size++,this._root=r);var i=this._comparator,s=Ec(e,this._root,i),A=i(e,s.key);return A===0?this._root=s:(A<0?(r.left=s.left,r.right=s,s.left=null):A>0&&(r.right=s.right,r.left=s,s.right=null),this._size++,this._root=r),this._root},t.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},t.prototype._remove=function(e,n,r){var i;if(n===null)return null;n=Ec(e,n,r);var s=r(e,n.key);return s===0?(n.left===null?i=n.right:(i=Ec(e,n.left,r),i.right=n.right),this._size--,i):n},t.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=Ec(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},t.prototype.findStatic=function(e){for(var n=this._root,r=this._comparator;n;){var i=r(e,n.key);if(i===0)return n;i<0?n=n.left:n=n.right}return null},t.prototype.find=function(e){return this._root&&(this._root=Ec(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},t.prototype.contains=function(e){for(var n=this._root,r=this._comparator;n;){var i=r(e,n.key);if(i===0)return!0;i<0?n=n.left:n=n.right}return!1},t.prototype.forEach=function(e,n){for(var r=this._root,i=[],s=!1;!s;)r!==null?(i.push(r),r=r.left):i.length!==0?(r=i.pop(),e.call(n,r),r=r.right):s=!0;return this},t.prototype.range=function(e,n,r,i){for(var s=[],A=this._comparator,a=this._root,y;s.length!==0||a;)if(a)s.push(a),a=a.left;else{if(a=s.pop(),y=A(a.key,n),y>0)break;if(A(a.key,e)>=0&&r.call(i,a))return this;a=a.right}return this},t.prototype.keys=function(){var e=[];return this.forEach(function(n){var r=n.key;return e.push(r)}),e},t.prototype.values=function(){var e=[];return this.forEach(function(n){var r=n.data;return e.push(r)}),e},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},t.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},t.prototype.at=function(e){for(var n=this._root,r=!1,i=0,s=[];!r;)if(n)s.push(n),n=n.left;else if(s.length>0){if(n=s.pop(),i===e)return n;i++,n=n.right}else r=!0;return null},t.prototype.next=function(e){var n=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var i=this._comparator;n;){var s=i(e.key,n.key);if(s===0)break;s<0?(r=n,n=n.left):n=n.right}return r},t.prototype.prev=function(e){var n=this._root,r=null;if(e.left!==null){for(r=e.left;r.right;)r=r.right;return r}for(var i=this._comparator;n;){var s=i(e.key,n.key);if(s===0)break;s<0?n=n.left:(r=n,n=n.right)}return r},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return Hde(this._root)},t.prototype.load=function(e,n,r){n===void 0&&(n=[]),r===void 0&&(r=!1);var i=e.length,s=this._comparator;if(r&&V3(e,n,0,i-1,s),this._root===null)this._root=N3(e,n,0,i),this._size=i;else{var A=Wde(this.toList(),$de(e,n),s);i=this._size+i,this._root=U3({head:A},0,i)}return this},t.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){e===void 0&&(e=function(r){return String(r.key)});var n=[];return F3(this._root,"",!0,function(r){return n.push(r)},e),n.join("")},t.prototype.update=function(e,n,r){var i=this._comparator,s=s6(e,this._root,i),A=s.left,a=s.right;i(e,n)<0?a=mw(n,r,a,i):A=mw(n,r,A,i),this._root=jde(A,a,i)},t.prototype.split=function(e){return s6(e,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var e,n,r;return Vde(this,function(i){switch(i.label){case 0:e=this._root,n=[],r=!1,i.label=1;case 1:return r?[3,6]:e===null?[3,2]:(n.push(e),e=e.left,[3,5]);case 2:return n.length===0?[3,4]:(e=n.pop(),[4,e]);case 3:return i.sent(),e=e.right,[3,5];case 4:r=!0,i.label=5;case 5:return[3,1];case 6:return[2]}})},t}();function N3(t,e,n,r){var i=r-n;if(i>0){var s=n+Math.floor(i/2),A=t[s],a=e[s],y=new qc(A,a);return y.left=N3(t,e,n,s),y.right=N3(t,e,s+1,r),y}return null}function $de(t,e){for(var n=new qc(null,null),r=n,i=0;i<t.length;i++)r=r.next=new qc(t[i],e[i]);return r.next=null,n.next}function Hde(t){for(var e=t,n=[],r=!1,i=new qc(null,null),s=i;!r;)e?(n.push(e),e=e.left):n.length>0?(e=s=s.next=n.pop(),e=e.right):r=!0;return s.next=null,i.next}function U3(t,e,n){var r=n-e;if(r>0){var i=e+Math.floor(r/2),s=U3(t,e,i),A=t.head;return A.left=s,t.head=t.head.next,A.right=U3(t,i+1,n),A}return null}function Wde(t,e,n){for(var r=new qc(null,null),i=r,s=t,A=e;s!==null&&A!==null;)n(s.key,A.key)<0?(i.next=s,s=s.next):(i.next=A,A=A.next),i=i.next;return s!==null?i.next=s:A!==null&&(i.next=A),r.next}function V3(t,e,n,r,i){if(!(n>=r)){for(var s=t[n+r>>1],A=n-1,a=r+1;;){do A++;while(i(t[A],s)<0);do a--;while(i(t[a],s)>0);if(A>=a)break;var y=t[A];t[A]=t[a],t[a]=y,y=e[A],e[A]=e[a],e[a]=y}V3(t,e,n,a,i),V3(t,e,a+1,r,i)}}const Kd=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,G3=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;const n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x,i=t.ll.y<e.ll.y?e.ll.y:t.ll.y,s=t.ur.y<e.ur.y?t.ur.y:e.ur.y;return{ll:{x:n,y:i},ur:{x:r,y:s}}};let kc=Number.EPSILON;kc===void 0&&(kc=Math.pow(2,-52));const Qde=kc*kc,o6=(t,e)=>{if(-kc<t&&t<kc&&-kc<e&&e<kc)return 0;const n=t-e;return n*n<Qde*t*e?0:t<e?-1:1};class qde{constructor(){this.reset()}reset(){this.xRounder=new a6,this.yRounder=new a6}round(e,n){return{x:this.xRounder.round(e),y:this.yRounder.round(n)}}}class a6{constructor(){this.tree=new hS,this.round(0)}round(e){const n=this.tree.add(e),r=this.tree.prev(n);if(r!==null&&o6(n.key,r.key)===0)return this.tree.remove(e),r.key;const i=this.tree.next(n);return i!==null&&o6(n.key,i.key)===0?(this.tree.remove(e),i.key):e}}const Tg=new qde,Ay=(t,e)=>t.x*e.y-t.y*e.x,KO=(t,e)=>t.x*e.x+t.y*e.y,l6=(t,e,n)=>{const r=dse(t.x,t.y,e.x,e.y,n.x,n.y);return r>0?-1:r<0?1:0},O_=t=>Math.sqrt(KO(t,t)),Zde=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return Ay(i,r)/O_(i)/O_(r)},Yde=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return KO(i,r)/O_(i)/O_(r)},A6=(t,e,n)=>e.y===0?null:{x:t.x+e.x/e.y*(n-t.y),y:n},u6=(t,e,n)=>e.x===0?null:{x:n,y:t.y+e.y/e.x*(n-t.x)},Xde=(t,e,n,r)=>{if(e.x===0)return u6(n,r,t.x);if(r.x===0)return u6(t,e,n.x);if(e.y===0)return A6(n,r,t.y);if(r.y===0)return A6(t,e,n.y);const i=Ay(e,r);if(i==0)return null;const s={x:n.x-t.x,y:n.y-t.y},A=Ay(s,e)/i,a=Ay(s,r)/i,y=t.x+a*e.x,w=n.x+A*r.x,P=t.y+a*e.y,I=n.y+A*r.y,L=(y+w)/2,U=(P+I)/2;return{x:L,y:U}};class Ka{static compare(e,n){const r=Ka.comparePoints(e.point,n.point);return r!==0?r:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:jc.compare(e.segment,n.segment))}static comparePoints(e,n){return e.x<n.x?-1:e.x>n.x?1:e.y<n.y?-1:e.y>n.y?1:0}constructor(e,n){e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const n=e.point.events;for(let r=0,i=n.length;r<i;r++){const s=n[r];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let n=0;n<e;n++){const r=this.point.events[n];if(r.segment.consumedBy===void 0)for(let i=n+1;i<e;i++){const s=this.point.events[i];s.consumedBy===void 0&&r.otherSE.point.events===s.otherSE.point.events&&r.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const e=[];for(let n=0,r=this.point.events.length;n<r;n++){const i=this.point.events[n];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&e.push(i)}return e}getLeftmostComparator(e){const n=new Map,r=i=>{const s=i.otherSE;n.set(i,{sine:Zde(this.point,e.point,s.point),cosine:Yde(this.point,e.point,s.point)})};return(i,s)=>{n.has(i)||r(i),n.has(s)||r(s);const{sine:A,cosine:a}=n.get(i),{sine:y,cosine:w}=n.get(s);return A>=0&&y>=0?a<w?1:a>w?-1:0:A<0&&y<0?a<w?-1:a>w?1:0:y<A?-1:y>A?1:0}}}let Kde=0;class jc{static compare(e,n){const r=e.leftSE.point.x,i=n.leftSE.point.x,s=e.rightSE.point.x,A=n.rightSE.point.x;if(A<r)return 1;if(s<i)return-1;const a=e.leftSE.point.y,y=n.leftSE.point.y,w=e.rightSE.point.y,P=n.rightSE.point.y;if(r<i){if(y<a&&y<w)return 1;if(y>a&&y>w)return-1;const I=e.comparePoint(n.leftSE.point);if(I<0)return 1;if(I>0)return-1;const L=n.comparePoint(e.rightSE.point);return L!==0?L:-1}if(r>i){if(a<y&&a<P)return-1;if(a>y&&a>P)return 1;const I=n.comparePoint(e.leftSE.point);if(I!==0)return I;const L=e.comparePoint(n.rightSE.point);return L<0?1:L>0?-1:1}if(a<y)return-1;if(a>y)return 1;if(s<A){const I=n.comparePoint(e.rightSE.point);if(I!==0)return I}if(s>A){const I=e.comparePoint(n.rightSE.point);if(I<0)return 1;if(I>0)return-1}if(s!==A){const I=w-a,L=s-r,U=P-y,W=A-i;if(I>L&&U<W)return 1;if(I<L&&U>W)return-1}return s>A?1:s<A||w<P?-1:w>P?1:e.id<n.id?-1:e.id>n.id?1:0}constructor(e,n,r,i){this.id=++Kde,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=r,this.windings=i}static fromRing(e,n,r){let i,s,A;const a=Ka.comparePoints(e,n);if(a<0)i=e,s=n,A=1;else if(a>0)i=n,s=e,A=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const y=new Ka(i,!0),w=new Ka(s,!1);return new jc(y,w,[r],[A])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<n?e:n},ur:{x:this.rightSE.point.x,y:e>n?e:n}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}comparePoint(e){if(this.isAnEndpoint(e))return 0;const n=this.leftSE.point,r=this.rightSE.point,i=this.vector();if(n.x===r.x)return e.x===n.x?0:e.x<n.x?1:-1;const s=(e.y-n.y)/i.y,A=n.x+s*i.x;if(e.x===A)return 0;const a=(e.x-n.x)/i.x,y=n.y+a*i.y;return e.y===y?0:e.y<y?-1:1}getIntersection(e){const n=this.bbox(),r=e.bbox(),i=G3(n,r);if(i===null)return null;const s=this.leftSE.point,A=this.rightSE.point,a=e.leftSE.point,y=e.rightSE.point,w=Kd(n,a)&&this.comparePoint(a)===0,P=Kd(r,s)&&e.comparePoint(s)===0,I=Kd(n,y)&&this.comparePoint(y)===0,L=Kd(r,A)&&e.comparePoint(A)===0;if(P&&w)return L&&!I?A:!L&&I?y:null;if(P)return I&&s.x===y.x&&s.y===y.y?null:s;if(w)return L&&A.x===a.x&&A.y===a.y?null:a;if(L&&I)return null;if(L)return A;if(I)return y;const U=Xde(s,this.vector(),a,e.vector());return U===null||!Kd(i,U)?null:Tg.round(U.x,U.y)}split(e){const n=[],r=e.events!==void 0,i=new Ka(e,!0),s=new Ka(e,!1),A=this.rightSE;this.replaceRightSE(s),n.push(s),n.push(i);const a=new jc(i,A,this.rings.slice(),this.windings.slice());return Ka.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),Ka.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),s.checkForConsuming()),n}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,r=this.windings.length;n<r;n++)this.windings[n]*=-1}consume(e){let n=this,r=e;for(;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;const i=jc.compare(n,r);if(i!==0){if(i>0){const s=n;n=r,r=s}if(n.prev===r){const s=n;n=r,r=s}for(let s=0,A=r.rings.length;s<A;s++){const a=r.rings[s],y=r.windings[s],w=n.rings.indexOf(a);w===-1?(n.rings.push(a),n.windings.push(y)):n.windings[w]+=y}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,r=this._afterState.windings,i=this._afterState.multiPolys;for(let a=0,y=this.rings.length;a<y;a++){const w=this.rings[a],P=this.windings[a],I=n.indexOf(w);I===-1?(n.push(w),r.push(P)):r[I]+=P}const s=[],A=[];for(let a=0,y=n.length;a<y;a++){if(r[a]===0)continue;const w=n[a],P=w.poly;if(A.indexOf(P)===-1)if(w.isExterior)s.push(P);else{A.indexOf(P)===-1&&A.push(P);const I=s.indexOf(w.poly);I!==-1&&s.splice(I,1)}}for(let a=0,y=s.length;a<y;a++){const w=s[a].multiPoly;i.indexOf(w)===-1&&i.push(w)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch($l.type){case"union":{const r=e.length===0,i=n.length===0;this._isInResult=r!==i;break}case"intersection":{let r,i;e.length<n.length?(r=e.length,i=n.length):(r=n.length,i=e.length),this._isInResult=i===$l.numMultiPolys&&r<i;break}case"xor":{const r=Math.abs(e.length-n.length);this._isInResult=r%2===1;break}case"difference":{const r=i=>i.length===1&&i[0].isSubject;this._isInResult=r(e)!==r(n);break}default:throw new Error(`Unrecognized operation type found ${$l.type}`)}return this._isInResult}}class c6{constructor(e,n,r){if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=Tg.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let s=i;for(let A=1,a=e.length;A<a;A++){if(typeof e[A][0]!="number"||typeof e[A][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let y=Tg.round(e[A][0],e[A][1]);y.x===s.x&&y.y===s.y||(this.segments.push(jc.fromRing(s,y,this)),y.x<this.bbox.ll.x&&(this.bbox.ll.x=y.x),y.y<this.bbox.ll.y&&(this.bbox.ll.y=y.y),y.x>this.bbox.ur.x&&(this.bbox.ur.x=y.x),y.y>this.bbox.ur.y&&(this.bbox.ur.y=y.y),s=y)}(i.x!==s.x||i.y!==s.y)&&this.segments.push(jc.fromRing(s,i,this))}getSweepEvents(){const e=[];for(let n=0,r=this.segments.length;n<r;n++){const i=this.segments[n];e.push(i.leftSE),e.push(i.rightSE)}return e}}class Jde{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new c6(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let r=1,i=e.length;r<i;r++){const s=new c6(e[r],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,r=this.interiorRings.length;n<r;n++){const i=this.interiorRings[n].getSweepEvents();for(let s=0,A=i.length;s<A;s++)e.push(i[s])}return e}}class h6{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let r=0,i=e.length;r<i;r++){const s=new Jde(e[r],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,r=this.polys.length;n<r;n++){const i=this.polys[n].getSweepEvents();for(let s=0,A=i.length;s<A;s++)e.push(i[s])}return e}}class F_{static factory(e){const n=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s.isInResult()||s.ringOut)continue;let A=null,a=s.leftSE,y=s.rightSE;const w=[a],P=a.point,I=[];for(;A=a,a=y,w.push(a),a.point!==P;)for(;;){const L=a.getAvailableLinkedEvents();if(L.length===0){const q=w[0].point,ae=w[w.length-1].point;throw new Error(`Unable to complete output ring starting at [${q.x}, ${q.y}]. Last matching segment found ends at [${ae.x}, ${ae.y}].`)}if(L.length===1){y=L[0].otherSE;break}let U=null;for(let q=0,ae=I.length;q<ae;q++)if(I[q].point===a.point){U=q;break}if(U!==null){const q=I.splice(U)[0],ae=w.splice(q.index);ae.unshift(ae[0].otherSE),n.push(new F_(ae.reverse()));continue}I.push({index:w.length,point:a.point});const W=a.getLeftmostComparator(A);y=L.sort(W)[0].otherSE;break}n.push(new F_(w))}return n}constructor(e){this.events=e;for(let n=0,r=e.length;n<r;n++)e[n].segment.ringOut=this;this.poly=null}getGeom(){let e=this.events[0].point;const n=[e];for(let w=1,P=this.events.length-1;w<P;w++){const I=this.events[w].point,L=this.events[w+1].point;l6(I,e,L)!==0&&(n.push(I),e=I)}if(n.length===1)return null;const r=n[0],i=n[1];l6(r,e,i)===0&&n.shift(),n.push(n[0]);const s=this.isExteriorRing()?1:-1,A=this.isExteriorRing()?0:n.length-1,a=this.isExteriorRing()?n.length:-1,y=[];for(let w=A;w!=a;w+=s)y.push([n[w].x,n[w].y]);return y}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let e=this.events[0];for(let i=1,s=this.events.length;i<s;i++){const A=this.events[i];Ka.compare(e,A)>0&&(e=A)}let n=e.segment.prevInResult(),r=n?n.prevInResult():null;for(;;){if(!n)return null;if(!r)return n.ringOut;if(r.ringOut!==n.ringOut)return r.ringOut.enclosingRing()!==n.ringOut?n.ringOut:n.ringOut.enclosingRing();n=r.prevInResult(),r=n?n.prevInResult():null}}}class f6{constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(let n=0,r=this.interiorRings.length;n<r;n++){const i=this.interiorRings[n].getGeom();i!==null&&e.push(i)}return e}}class epe{constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,r=this.polys.length;n<r;n++){const i=this.polys[n].getGeom();i!==null&&e.push(i)}return e}_composePolys(e){const n=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s.poly)if(s.isExteriorRing())n.push(new f6(s));else{const A=s.enclosingRing();A.poly||n.push(new f6(A)),A.poly.addInterior(s)}}return n}}class tpe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jc.compare;this.queue=e,this.tree=new hS(n),this.segments=[]}process(e){const n=e.segment,r=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(n),r;const i=e.isLeft?this.tree.add(n):this.tree.find(n);if(!i)throw new Error(`Unable to find segment #${n.id} [${n.leftSE.point.x}, ${n.leftSE.point.y}] -> [${n.rightSE.point.x}, ${n.rightSE.point.y}] in SweepLine tree.`);let s=i,A=i,a,y;for(;a===void 0;)s=this.tree.prev(s),s===null?a=null:s.key.consumedBy===void 0&&(a=s.key);for(;y===void 0;)A=this.tree.next(A),A===null?y=null:A.key.consumedBy===void 0&&(y=A.key);if(e.isLeft){let w=null;if(a){const I=a.getIntersection(n);if(I!==null&&(n.isAnEndpoint(I)||(w=I),!a.isAnEndpoint(I))){const L=this._splitSafely(a,I);for(let U=0,W=L.length;U<W;U++)r.push(L[U])}}let P=null;if(y){const I=y.getIntersection(n);if(I!==null&&(n.isAnEndpoint(I)||(P=I),!y.isAnEndpoint(I))){const L=this._splitSafely(y,I);for(let U=0,W=L.length;U<W;U++)r.push(L[U])}}if(w!==null||P!==null){let I=null;w===null?I=P:P===null?I=w:I=Ka.comparePoints(w,P)<=0?w:P,this.queue.remove(n.rightSE),r.push(n.rightSE);const L=n.split(I);for(let U=0,W=L.length;U<W;U++)r.push(L[U])}r.length>0?(this.tree.remove(n),r.push(e)):(this.segments.push(n),n.prev=a)}else{if(a&&y){const w=a.getIntersection(y);if(w!==null){if(!a.isAnEndpoint(w)){const P=this._splitSafely(a,w);for(let I=0,L=P.length;I<L;I++)r.push(P[I])}if(!y.isAnEndpoint(w)){const P=this._splitSafely(y,w);for(let I=0,L=P.length;I<L;I++)r.push(P[I])}}}this.tree.remove(n)}return r}_splitSafely(e,n){this.tree.remove(e);const r=e.rightSE;this.queue.remove(r);const i=e.split(n);return i.push(r),e.consumedBy===void 0&&this.tree.add(e),i}}const d6=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,npe=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class rpe{run(e,n,r){$l.type=e,Tg.reset();const i=[new h6(n,!0)];for(let I=0,L=r.length;I<L;I++)i.push(new h6(r[I],!1));if($l.numMultiPolys=i.length,$l.type==="difference"){const I=i[0];let L=1;for(;L<i.length;)G3(i[L].bbox,I.bbox)!==null?L++:i.splice(L,1)}if($l.type==="intersection")for(let I=0,L=i.length;I<L;I++){const U=i[I];for(let W=I+1,q=i.length;W<q;W++)if(G3(U.bbox,i[W].bbox)===null)return[]}const s=new hS(Ka.compare);for(let I=0,L=i.length;I<L;I++){const U=i[I].getSweepEvents();for(let W=0,q=U.length;W<q;W++)if(s.insert(U[W]),s.size>d6)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const A=new tpe(s);let a=s.size,y=s.pop();for(;y;){const I=y.key;if(s.size===a){const U=I.segment;throw new Error(`Unable to pop() ${I.isLeft?"left":"right"} SweepEvent [${I.point.x}, ${I.point.y}] from segment #${U.id} [${U.leftSE.point.x}, ${U.leftSE.point.y}] -> [${U.rightSE.point.x}, ${U.rightSE.point.y}] from queue.`)}if(s.size>d6)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(A.segments.length>npe)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const L=A.process(I);for(let U=0,W=L.length;U<W;U++){const q=L[U];q.consumedBy===void 0&&s.insert(q)}a=s.size,y=s.pop()}Tg.reset();const w=F_.factory(A.segments);return new epe(w).getGeom()}}const $l=new rpe,ipe=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return $l.run("union",t,n)},spe=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return $l.run("intersection",t,n)},ope=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return $l.run("xor",t,n)},ape=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return $l.run("difference",t,n)};var lpe={union:ipe,intersection:spe,xor:ope,difference:ape};function JO(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function Ape(t,e,n){n===void 0&&(n={});for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var A=0;A<s[s.length-1].length;A++)if(s[s.length-1][A]!==s[0][A])throw new Error("First and last Position are not equivalent.")}var a={type:"Polygon",coordinates:t};return JO(a,e,n)}function upe(t,e,n){n===void 0&&(n={});var r={type:"MultiPolygon",coordinates:t};return JO(r,e,n)}function p6(t){return t.type==="Feature"?t.geometry:t}function g6(t,e,n){n===void 0&&(n={});var r=p6(t),i=p6(e),s=lpe.intersection(r.coordinates,i.coordinates);return s.length===0?null:s.length===1?Ape(s[0],n.properties):upe(s,n.properties)}var Pt=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(X){return e.locateFile?e.locateFile(X,i):i+X}var A;document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",A=function(H,ee,he){var o=new XMLHttpRequest;o.open("GET",H,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){ee(o.response);return}var Le=Mr(H);if(Le){ee(Le.buffer);return}he()},o.onerror=he,o.send(null)};var a=e.print||console.log.bind(console),y=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var w=0,P=function(X){w=X},I=function(){return w},L=8;function U(X,H,ee,he){switch(ee=ee||"i8",ee.charAt(ee.length-1)==="*"&&(ee="i32"),ee){case"i1":nt[X>>0]=H;break;case"i8":nt[X>>0]=H;break;case"i16":mt[X>>1]=H;break;case"i32":Xt[X>>2]=H;break;case"i64":bi=[H>>>0,(zr=H,+er(zr)>=1?zr>0?(or(+gr(zr/4294967296),4294967295)|0)>>>0:~~+$n((zr-+(~~zr>>>0))/4294967296)>>>0:0)],Xt[X>>2]=bi[0],Xt[X+4>>2]=bi[1];break;case"float":Et[X>>2]=H;break;case"double":fn[X>>3]=H;break;default:Lr("invalid type for setValue: "+ee)}}function W(X,H,ee){switch(H=H||"i8",H.charAt(H.length-1)==="*"&&(H="i32"),H){case"i1":return nt[X>>0];case"i8":return nt[X>>0];case"i16":return mt[X>>1];case"i32":return Xt[X>>2];case"i64":return Xt[X>>2];case"float":return Et[X>>2];case"double":return fn[X>>3];default:Lr("invalid type for getValue: "+H)}return null}var q=!1;function ae(X,H){X||Lr("Assertion failed: "+H)}function K(X){var H=e["_"+X];return ae(H,"Cannot call unknown function "+X+", make sure it is exported"),H}function ne(X,H,ee,he,o){var G={string:function(ft){var Lt=0;if(ft!=null&&ft!==0){var Dt=(ft.length<<2)+1;Lt=Cs(Dt),Qe(ft,Lt,Dt)}return Lt},array:function(ft){var Lt=Cs(ft.length);return Je(ft,Lt),Lt}};function Le(ft){return H==="string"?Me(ft):H==="boolean"?!!ft:ft}var Ie=K(X),Pe=[],ke=0;if(he)for(var We=0;We<he.length;We++){var at=G[ee[We]];at?(ke===0&&(ke=ri()),Pe[We]=at(he[We])):Pe[We]=he[We]}var $e=Ie.apply(null,Pe);return $e=Le($e),ke!==0&&kr(ke),$e}function ie(X,H,ee,he){ee=ee||[];var o=ee.every(function(Le){return Le==="number"}),G=H!=="string";return G&&o&&!he?K(X):function(){return ne(X,H,ee,arguments)}}var fe=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function ye(X,H,ee){for(var he=H+ee,o=H;X[o]&&!(o>=he);)++o;if(o-H>16&&X.subarray&&fe)return fe.decode(X.subarray(H,o));for(var G="";H<o;){var Le=X[H++];if(!(Le&128)){G+=String.fromCharCode(Le);continue}var Ie=X[H++]&63;if((Le&224)==192){G+=String.fromCharCode((Le&31)<<6|Ie);continue}var Pe=X[H++]&63;if((Le&240)==224?Le=(Le&15)<<12|Ie<<6|Pe:Le=(Le&7)<<18|Ie<<12|Pe<<6|X[H++]&63,Le<65536)G+=String.fromCharCode(Le);else{var ke=Le-65536;G+=String.fromCharCode(55296|ke>>10,56320|ke&1023)}}return G}function Me(X,H){return X?ye(qe,X,H):""}function He(X,H,ee,he){if(!(he>0))return 0;for(var o=ee,G=ee+he-1,Le=0;Le<X.length;++Le){var Ie=X.charCodeAt(Le);if(Ie>=55296&&Ie<=57343){var Pe=X.charCodeAt(++Le);Ie=65536+((Ie&1023)<<10)|Pe&1023}if(Ie<=127){if(ee>=G)break;H[ee++]=Ie}else if(Ie<=2047){if(ee+1>=G)break;H[ee++]=192|Ie>>6,H[ee++]=128|Ie&63}else if(Ie<=65535){if(ee+2>=G)break;H[ee++]=224|Ie>>12,H[ee++]=128|Ie>>6&63,H[ee++]=128|Ie&63}else{if(ee+3>=G)break;H[ee++]=240|Ie>>18,H[ee++]=128|Ie>>12&63,H[ee++]=128|Ie>>6&63,H[ee++]=128|Ie&63}}return H[ee]=0,ee-o}function Qe(X,H,ee){return He(X,qe,H,ee)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Je(X,H){nt.set(X,H)}function tt(X,H){return X%H>0&&(X+=H-X%H),X}var Ne,nt,qe,mt,Xt,Et,fn;function yt(X){Ne=X,e.HEAP8=nt=new Int8Array(X),e.HEAP16=mt=new Int16Array(X),e.HEAP32=Xt=new Int32Array(X),e.HEAPU8=qe=new Uint8Array(X),e.HEAPU16=new Uint16Array(X),e.HEAPU32=new Uint32Array(X),e.HEAPF32=Et=new Float32Array(X),e.HEAPF64=fn=new Float64Array(X)}var bt=5266928,Kt=24016,In=e.TOTAL_MEMORY||33554432;e.buffer?Ne=e.buffer:Ne=new ArrayBuffer(In),In=Ne.byteLength,yt(Ne),Xt[Kt>>2]=bt;function En(X){for(;X.length>0;){var H=X.shift();if(typeof H=="function"){H();continue}var ee=H.func;typeof ee=="number"?H.arg===void 0?e.dynCall_v(ee):e.dynCall_vi(ee,H.arg):ee(H.arg===void 0?null:H.arg)}}var Er=[],Jn=[],ir=[],Ar=[];function Nn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Mn(e.preRun.shift());En(Er)}function xr(){En(Jn)}function xt(){En(ir)}function nn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)vt(e.postRun.shift());En(Ar)}function Mn(X){Er.unshift(X)}function vt(X){Ar.unshift(X)}var er=Math.abs,$n=Math.ceil,gr=Math.floor,or=Math.min,tr=0,Zr=null;function Un(X){tr++,e.monitorRunDependencies&&e.monitorRunDependencies(tr)}function wi(X){if(tr--,e.monitorRunDependencies&&e.monitorRunDependencies(tr),tr==0&&Zr){var H=Zr;Zr=null,H()}}e.preloadedImages={},e.preloadedAudios={};var Hn=null,Di="data:application/octet-stream;base64,";function oo(X){return String.prototype.startsWith?X.startsWith(Di):X.indexOf(Di)===0}var zr,bi;Hn="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var Io=24032;function Ki(X){return X}function ct(X){var H=/\b__Z[\w\d_]+/g;return X.replace(H,function(ee){var he=ee;return ee===he?ee:he+" ["+ee+"]"})}function It(){var X=new Error;if(!X.stack){try{throw new Error(0)}catch(H){X=H}if(!X.stack)return"(no stack trace available)"}return X.stack.toString()}function Ms(){var X=It();return e.extraStackTrace&&(X+=`
`+e.extraStackTrace()),ct(X)}function pi(X,H,ee,he){Lr("Assertion failed: "+Me(X)+", at: "+[H?Me(H):"unknown filename",ee,he?Me(he):"unknown function"])}function Rn(){return nt.length}function Ri(X,H,ee){qe.set(qe.subarray(H,H+ee),X)}function Ei(X){return e.___errno_location&&(Xt[e.___errno_location()>>2]=X),X}function Ti(X){Lr("OOM")}function Ji(X){try{var H=new ArrayBuffer(X);return H.byteLength!=X?void 0:(new Int8Array(H).set(nt),Vr(H),yt(H),1)}catch{}}function kt(X){var H=Rn(),ee=16777216,he=2147483648-ee;if(X>he)return!1;for(var o=16777216,G=Math.max(H,o);G<X;)G<=536870912?G=tt(2*G,ee):G=Math.min(tt((3*G+2147483648)/4,ee),he);var Le=Ji(G);return!!Le}var Tn=typeof atob=="function"?atob:function(X){var H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ee="",he,o,G,Le,Ie,Pe,ke,We=0;X=X.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Le=H.indexOf(X.charAt(We++)),Ie=H.indexOf(X.charAt(We++)),Pe=H.indexOf(X.charAt(We++)),ke=H.indexOf(X.charAt(We++)),he=Le<<2|Ie>>4,o=(Ie&15)<<4|Pe>>2,G=(Pe&3)<<6|ke,ee=ee+String.fromCharCode(he),Pe!==64&&(ee=ee+String.fromCharCode(o)),ke!==64&&(ee=ee+String.fromCharCode(G));while(We<X.length);return ee};function wn(X){try{for(var H=Tn(X),ee=new Uint8Array(H.length),he=0;he<H.length;++he)ee[he]=H.charCodeAt(he);return ee}catch{throw new Error("Converting base64 string to bytes failed.")}}function Mr(X){if(oo(X))return wn(X.slice(Di.length))}var fs={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},mn={a:Lr,b:P,c:I,d:pi,e:Ei,f:Rn,g:Ri,h:kt,i:Ti,j:Ki,k:ct,l:Ji,m:It,n:Ms,o:Io,p:Kt},Ze=function(X,H,ee){"almost asm";var he=new X.Int8Array(ee),o=new X.Int32Array(ee);new X.Uint8Array(ee),new X.Float32Array(ee);var G=new X.Float64Array(ee),Le=H.p|0,Ie=X.Math.floor,Pe=X.Math.abs,ke=X.Math.sqrt,We=X.Math.pow,at=X.Math.cos,$e=X.Math.sin,ft=X.Math.tan,Lt=X.Math.acos,Dt=X.Math.asin,rn=X.Math.atan,jt=X.Math.atan2,dn=X.Math.ceil,Qt=X.Math.imul,on=X.Math.min,vn=X.Math.clz32,Ot=H.b,Oe=H.c,Mt=H.d,Se=H.e,An=H.f,ii=H.g,nr=H.h,ea=H.i,De=24048;function Ia(l){return he=new Int8Array(l),o=new Int32Array(l),G=new Float64Array(l),ee=l,!0}function we(l){l=l|0;var h=0;return h=De,De=De+l|0,De=De+15&-16,h|0}function ko(){return De|0}function ds(l){l=l|0,De=l}function ka(l,h){l=l|0,De=l}function La(l){return l=l|0,(Qt(l*3|0,l+1|0)|0)+1|0}function ta(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0;na(l,h,d,x,0)|0&&(S=(Qt(d*3|0,d+1|0)|0)+1|0,k(x|0,0,S<<3|0)|0,b=$i(S,4)|0,b&&(Yr(l,h,d,x,b,S,0),cn(b)))}function Al(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0;if(na(l,h,d,x,b)|0){if(S=(Qt(d*3|0,d+1|0)|0)+1|0,k(x|0,0,S<<3|0)|0,b|0){k(b|0,0,S<<2|0)|0,Yr(l,h,d,x,b,S,0);return}b=$i(S,4)|0,b&&(Yr(l,h,d,x,b,S,0),cn(b))}}function na(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0;if(ue=De,De=De+16|0,te=ue,S=x,o[S>>2]=l,o[S+4>>2]=h,S=(b|0)!=0,S&&(o[b>>2]=0),Pr(l,h)|0)return te=1,De=ue,te|0;o[te>>2]=0;e:do if((d|0)>=1)if(S)for($=0,Y=1,oe=1,M=0,S=l;;){if(!(M|$)){if(S=ge(S,h,4,te)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(Pr(S,h)|0){S=1;break e}}if(S=ge(S,h,o[16+($<<2)>>2]|0,te)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(l=x+(oe<<3)|0,o[l>>2]=S,o[l+4>>2]=h,o[b+(oe<<2)>>2]=Y,M=M+1|0,l=(M|0)==(Y|0),B=$+1|0,V=(B|0)==6,Pr(S,h)|0){S=1;break e}if(Y=Y+(V&l&1)|0,(Y|0)>(d|0)){S=0;break}else $=l?V?0:B:$,oe=oe+1|0,M=l?0:M}else for($=0,Y=1,oe=1,M=0,S=l;;){if(!(M|$)){if(S=ge(S,h,4,te)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(Pr(S,h)|0){S=1;break e}}if(S=ge(S,h,o[16+($<<2)>>2]|0,te)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(l=x+(oe<<3)|0,o[l>>2]=S,o[l+4>>2]=h,M=M+1|0,l=(M|0)==(Y|0),B=$+1|0,V=(B|0)==6,Pr(S,h)|0){S=1;break e}if(Y=Y+(V&l&1)|0,(Y|0)>(d|0)){S=0;break}else $=l?V?0:B:$,oe=oe+1|0,M=l?0:M}else S=0;while(0);return te=S,De=ue,te|0}function Yr(l,h,d,x,b,S,M){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0,S=S|0,M=M|0;var B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0;if(oe=De,De=De+16|0,Y=oe,(l|0)==0&(h|0)==0){De=oe;return}if(B=Os(l|0,h|0,S|0,((S|0)<0)<<31>>31|0)|0,Oe()|0,V=x+(B<<3)|0,te=V,ue=o[te>>2]|0,te=o[te+4>>2]|0,$=(ue|0)==(l|0)&(te|0)==(h|0),!((ue|0)==0&(te|0)==0|$))do B=(B+1|0)%(S|0)|0,V=x+(B<<3)|0,ue=V,te=o[ue>>2]|0,ue=o[ue+4>>2]|0,$=(te|0)==(l|0)&(ue|0)==(h|0);while(!((te|0)==0&(ue|0)==0|$));if(B=b+(B<<2)|0,$&&(o[B>>2]|0)<=(M|0)){De=oe;return}if(ue=V,o[ue>>2]=l,o[ue+4>>2]=h,o[B>>2]=M,(M|0)>=(d|0)){De=oe;return}ue=M+1|0,o[Y>>2]=0,te=ge(l,h,2,Y)|0,Yr(te,Oe()|0,d,x,b,S,ue),o[Y>>2]=0,te=ge(l,h,3,Y)|0,Yr(te,Oe()|0,d,x,b,S,ue),o[Y>>2]=0,te=ge(l,h,1,Y)|0,Yr(te,Oe()|0,d,x,b,S,ue),o[Y>>2]=0,te=ge(l,h,5,Y)|0,Yr(te,Oe()|0,d,x,b,S,ue),o[Y>>2]=0,te=ge(l,h,4,Y)|0,Yr(te,Oe()|0,d,x,b,S,ue),o[Y>>2]=0,te=ge(l,h,6,Y)|0,Yr(te,Oe()|0,d,x,b,S,ue),De=oe}function ge(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0;if((o[x>>2]|0)>0){b=0;do d=Oi(d)|0,b=b+1|0;while((b|0)<(o[x>>2]|0))}B=St(l|0,h|0,45)|0,Oe()|0,V=B&127,S=si(l,h)|0,b=St(l|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!b)M=6;else for(;;){if(oe=(15-b|0)*3|0,te=St(l|0,h|0,oe|0)|0,Oe()|0,te=te&7,ue=(Ai(b)|0)==0,b=b+-1|0,Y=Ct(7,0,oe|0)|0,h=h&~(Oe()|0),oe=Ct(o[(ue?464:48)+(te*28|0)+(d<<2)>>2]|0,0,oe|0)|0,$=Oe()|0,d=o[(ue?672:256)+(te*28|0)+(d<<2)>>2]|0,l=oe|l&~Y,h=$|h,!d){d=0;break e}if(!b){M=6;break}}while(0);(M|0)==6&&(ue=o[880+(V*28|0)+(d<<2)>>2]|0,te=Ct(ue|0,0,45)|0,l=te|l,h=Oe()|0|h&-1040385,d=o[4304+(V*28|0)+(d<<2)>>2]|0,(ue&127|0)==127&&(ue=Ct(o[880+(V*28|0)+20>>2]|0,0,45)|0,h=Oe()|0|h&-1040385,d=o[4304+(V*28|0)+20>>2]|0,l=ns(ue|l,h)|0,h=Oe()|0,o[x>>2]=(o[x>>2]|0)+1)),M=St(l|0,h|0,45)|0,Oe()|0,M=M&127;e:do if(Jt(M)|0){t:do if((si(l,h)|0)==1){if((V|0)!=(M|0))if(FA(M,o[7728+(V*28|0)>>2]|0)|0){l=Gi(l,h)|0,S=1,h=Oe()|0;break}else{l=ns(l,h)|0,S=1,h=Oe()|0;break}switch(S|0){case 5:{l=Gi(l,h)|0,h=Oe()|0,o[x>>2]=(o[x>>2]|0)+5,S=0;break t}case 3:{l=ns(l,h)|0,h=Oe()|0,o[x>>2]=(o[x>>2]|0)+1,S=0;break t}default:return te=0,ue=0,Ot(te|0),ue|0}}else S=0;while(0);if((d|0)>0){b=0;do l=gi(l,h)|0,h=Oe()|0,b=b+1|0;while((b|0)!=(d|0))}if((V|0)!=(M|0)){if(!(Cr(M)|0)){if((S|0)!=0|(si(l,h)|0)!=5)break;o[x>>2]=(o[x>>2]|0)+1;break}switch(B&127){case 8:case 118:break e}(si(l,h)|0)!=3&&(o[x>>2]=(o[x>>2]|0)+1)}}else if((d|0)>0){b=0;do l=ns(l,h)|0,h=Oe()|0,b=b+1|0;while((b|0)!=(d|0))}while(0);return o[x>>2]=((o[x>>2]|0)+d|0)%6|0,te=h,ue=l,Ot(te|0),ue|0}function Ee(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0;if(oe=De,De=De+16|0,Y=oe,!d)return Y=x,o[Y>>2]=l,o[Y+4>>2]=h,Y=0,De=oe,Y|0;o[Y>>2]=0;e:do if(Pr(l,h)|0)l=1;else{if(S=(d|0)>0,S){b=0,$=l;do{if($=ge($,h,4,Y)|0,h=Oe()|0,($|0)==0&(h|0)==0){l=2;break e}if(b=b+1|0,Pr($,h)|0){l=1;break e}}while((b|0)<(d|0));if(V=x,o[V>>2]=$,o[V+4>>2]=h,V=d+-1|0,S){S=0,M=1,b=$,l=h;do{if(b=ge(b,l,2,Y)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(B=x+(M<<3)|0,o[B>>2]=b,o[B+4>>2]=l,M=M+1|0,Pr(b,l)|0){l=1;break e}S=S+1|0}while((S|0)<(d|0));B=0,S=M;do{if(b=ge(b,l,3,Y)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(M=x+(S<<3)|0,o[M>>2]=b,o[M+4>>2]=l,S=S+1|0,Pr(b,l)|0){l=1;break e}B=B+1|0}while((B|0)<(d|0));M=0;do{if(b=ge(b,l,1,Y)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(B=x+(S<<3)|0,o[B>>2]=b,o[B+4>>2]=l,S=S+1|0,Pr(b,l)|0){l=1;break e}M=M+1|0}while((M|0)<(d|0));M=0;do{if(b=ge(b,l,5,Y)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(B=x+(S<<3)|0,o[B>>2]=b,o[B+4>>2]=l,S=S+1|0,Pr(b,l)|0){l=1;break e}M=M+1|0}while((M|0)<(d|0));M=0;do{if(b=ge(b,l,4,Y)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(B=x+(S<<3)|0,o[B>>2]=b,o[B+4>>2]=l,S=S+1|0,Pr(b,l)|0){l=1;break e}M=M+1|0}while((M|0)<(d|0));for(M=0;;){if(b=ge(b,l,6,Y)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if((M|0)!=(V|0))if(B=x+(S<<3)|0,o[B>>2]=b,o[B+4>>2]=l,!(Pr(b,l)|0))S=S+1|0;else{l=1;break e}if(M=M+1|0,(M|0)>=(d|0)){M=$,S=h;break}}}else M=$,b=$,S=h,l=h}else M=x,o[M>>2]=l,o[M+4>>2]=h,M=l,b=l,S=h,l=h;l=((M|0)!=(b|0)|(S|0)!=(l|0))&1}while(0);return Y=l,De=oe,Y|0}function Fe(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;if(S=De,De=De+48|0,b=S+8|0,x=S,B=l,M=o[B+4>>2]|0,d=x,o[d>>2]=o[B>>2],o[d+4>>2]=M,Ga(x,b),b=Yn(b,h)|0,h=o[x>>2]|0,x=o[l+8>>2]|0,(x|0)<=0)return B=h,M=(b|0)<(B|0),B=M?B:b,B=B+12|0,De=S,B|0;d=o[l+12>>2]|0,l=0;do h=(o[d+(l<<3)>>2]|0)+h|0,l=l+1|0;while((l|0)<(x|0));return B=(b|0)<(h|0),B=B?h:b,B=B+12|0,De=S,B|0}function ot(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0;if(B=De,De=De+48|0,x=B+8|0,b=B,!(wt(l,h,d)|0)){De=B;return}if(V=l,S=o[V+4>>2]|0,M=b,o[M>>2]=o[V>>2],o[M+4>>2]=S,Ga(b,x),M=Yn(x,h)|0,h=o[b>>2]|0,S=o[l+8>>2]|0,(S|0)>0){b=o[l+12>>2]|0,x=0;do h=(o[b+(x<<3)>>2]|0)+h|0,x=x+1|0;while((x|0)!=(S|0))}if(h=(M|0)<(h|0)?h:M,(h|0)<=-12){De=B;return}V=h+11|0,k(d|0,0,(((V|0)>0?V:0)<<3)+8|0)|0,De=B}function wt(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,m=0,g=0,v=0,E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0;if(de=De,De=De+112|0,N=de+80|0,V=de+72|0,Q=de,J=de+56|0,$=l+8|0,le=Yt((o[$>>2]<<5)+32|0)|0,le||Mt(22848,22448,800,22456),Rs(l,le),S=l,x=o[S+4>>2]|0,B=V,o[B>>2]=o[S>>2],o[B+4>>2]=x,Ga(V,N),B=Yn(N,h)|0,x=o[V>>2]|0,S=o[$>>2]|0,(S|0)>0){M=o[l+12>>2]|0,b=0;do x=(o[M+(b<<3)>>2]|0)+x|0,b=b+1|0;while((b|0)!=(S|0))}if(B=(B|0)<(x|0)?x:B,O=B+12|0,b=$i(O,8)|0,Y=$i(O,8)|0,o[N>>2]=0,C=l,R=o[C+4>>2]|0,x=V,o[x>>2]=o[C>>2],o[x+4>>2]=R,x=Wt(V,O,h,N,b,Y)|0,x|0)return cn(b),cn(Y),cn(le),le=x,De=de,le|0;e:do if((o[$>>2]|0)>0){for(S=l+12|0,x=0;M=Wt((o[S>>2]|0)+(x<<3)|0,O,h,N,b,Y)|0,x=x+1|0,!(M|0);)if((x|0)>=(o[$>>2]|0))break e;return cn(b),cn(Y),cn(le),le=M,De=de,le|0}while(0);(B|0)>-12&&k(Y|0,0,((O|0)>1?O:1)<<3|0)|0;e:do if((o[N>>2]|0)>0){R=((O|0)<0)<<31>>31,xe=b,m=Y,g=b,v=b,E=Y,C=b,x=b,ve=b,Ge=Y,Te=Y,Ve=Y,b=Y;t:for(;;){for(Ce=o[N>>2]|0,ue=0,be=0,S=0;;){M=Q,B=M+56|0;do o[M>>2]=0,M=M+4|0;while((M|0)<(B|0));if(h=xe+(ue<<3)|0,V=o[h>>2]|0,h=o[h+4>>2]|0,na(V,h,1,Q,0)|0){M=Q,B=M+56|0;do o[M>>2]=0,M=M+4|0;while((M|0)<(B|0));M=$i(7,4)|0,M|0&&(Yr(V,h,1,Q,M,7,0),cn(M))}te=0;do{oe=Q+(te<<3)|0,Y=o[oe>>2]|0,oe=o[oe+4>>2]|0;n:do if(!((Y|0)==0&(oe|0)==0)){if(V=Os(Y|0,oe|0,O|0,R|0)|0,Oe()|0,M=d+(V<<3)|0,B=M,h=o[B>>2]|0,B=o[B+4>>2]|0,!((h|0)==0&(B|0)==0))for($=0;;){if(($|0)>(O|0))break t;if((h|0)==(Y|0)&(B|0)==(oe|0))break n;if(V=(V+1|0)%(O|0)|0,M=d+(V<<3)|0,B=M,h=o[B>>2]|0,B=o[B+4>>2]|0,(h|0)==0&(B|0)==0)break;$=$+1|0}(Y|0)==0&(oe|0)==0||(Ds(Y,oe,J),KA(l,le,J)|0&&($=M,o[$>>2]=Y,o[$+4>>2]=oe,$=m+(S<<3)|0,o[$>>2]=Y,o[$+4>>2]=oe,S=S+1|0))}while(0);te=te+1|0}while(te>>>0<7);if(be=be+1|0,(be|0)>=(Ce|0))break;ue=ue+1|0}if((Ce|0)>0&&k(g|0,0,Ce<<3|0)|0,o[N>>2]=S,(S|0)>0)Y=b,oe=Ve,te=C,ue=Te,be=Ge,Ce=m,b=ve,Ve=x,Te=v,Ge=g,ve=Y,x=oe,C=E,E=te,v=ue,g=be,m=xe,xe=Ce;else break e}return cn(v),cn(E),cn(le),le=-1,De=de,le|0}else x=Y;while(0);return cn(le),cn(b),cn(x),le=0,De=de,le|0}function Wt(l,h,d,x,b,S){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0,S=S|0;var M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,m=0,g=0,v=0,E=0,C=0,R=0,O=0,N=0;if(R=De,De=De+48|0,g=R+32|0,v=R+16|0,E=R,M=o[l>>2]|0,(M|0)<=0)return C=0,De=R,C|0;Ge=l+4|0,Te=g+8|0,Ve=v+8|0,xe=E+8|0,m=((h|0)<0)<<31>>31,ve=0;e:for(;;){B=o[Ge>>2]|0,be=B+(ve<<4)|0,o[g>>2]=o[be>>2],o[g+4>>2]=o[be+4>>2],o[g+8>>2]=o[be+8>>2],o[g+12>>2]=o[be+12>>2],(ve|0)==(M+-1|0)?(o[v>>2]=o[B>>2],o[v+4>>2]=o[B+4>>2],o[v+8>>2]=o[B+8>>2],o[v+12>>2]=o[B+12>>2]):(be=B+(ve+1<<4)|0,o[v>>2]=o[be>>2],o[v+4>>2]=o[be+4>>2],o[v+8>>2]=o[be+8>>2],o[v+12>>2]=o[be+12>>2]),be=UA(g,v,d)|0;t:do if((be|0)>0){Ce=+(be|0),ue=0;n:for(;;){N=+(be-ue|0),O=+(ue|0),G[E>>3]=+G[g>>3]*N/Ce+ +G[v>>3]*O/Ce,G[xe>>3]=+G[Te>>3]*N/Ce+ +G[Ve>>3]*O/Ce,oe=Oa(E,d)|0,te=Oe()|0,B=Os(oe|0,te|0,h|0,m|0)|0,Oe()|0,M=S+(B<<3)|0,V=M,$=o[V>>2]|0,V=o[V+4>>2]|0;r:do if(($|0)==0&(V|0)==0)C=14;else for(Y=0;;){if((Y|0)>(h|0)){M=1;break r}if(($|0)==(oe|0)&(V|0)==(te|0)){M=7;break r}if(B=(B+1|0)%(h|0)|0,M=S+(B<<3)|0,V=M,$=o[V>>2]|0,V=o[V+4>>2]|0,($|0)==0&(V|0)==0){C=14;break}else Y=Y+1|0}while(0);switch((C|0)==14&&(C=0,(oe|0)==0&(te|0)==0?M=7:(o[M>>2]=oe,o[M+4>>2]=te,M=o[x>>2]|0,Y=b+(M<<3)|0,o[Y>>2]=oe,o[Y+4>>2]=te,o[x>>2]=M+1,M=0)),M&7){case 7:case 0:break;default:break n}if(ue=ue+1|0,(be|0)<=(ue|0)){C=8;break t}}if(M|0){M=-1,C=20;break e}}else C=8;while(0);if((C|0)==8&&(C=0),ve=ve+1|0,M=o[l>>2]|0,(ve|0)>=(M|0)){M=0,C=20;break}}return(C|0)==20?(De=R,M|0):0}function kn(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0;if($=De,De=De+176|0,V=$,(h|0)<1){wr(d,0,0),De=$;return}M=l,M=St(o[M>>2]|0,o[M+4>>2]|0,52)|0,Oe()|0,wr(d,(h|0)>6?h:6,M&15),M=0;do{if(x=l+(M<<3)|0,rs(o[x>>2]|0,o[x+4>>2]|0,V),x=o[V>>2]|0,(x|0)>0){B=0;do S=V+8+(B<<4)|0,B=B+1|0,x=V+8+(((B|0)%(x|0)|0)<<4)|0,b=iu(d,x,S)|0,b?ru(d,b)|0:ic(d,S,x)|0,x=o[V>>2]|0;while((B|0)<(x|0))}M=M+1|0}while((M|0)!=(h|0));De=$}function Sr(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if(S=De,De=De+32|0,x=S,b=S+16|0,kn(l,h,b),o[d>>2]=0,o[d+4>>2]=0,o[d+8>>2]=0,l=Sl(b)|0,!l){Aa(d)|0,ja(b),De=S;return}do{h=Jc(d)|0;do eh(h,l)|0,M=l+16|0,o[x>>2]=o[M>>2],o[x+4>>2]=o[M+4>>2],o[x+8>>2]=o[M+8>>2],o[x+12>>2]=o[M+12>>2],ru(b,l)|0,l=sc(b,x)|0;while(l|0);l=Sl(b)|0}while(l|0);Aa(d)|0,ja(b),De=S}function Jt(l){return l=l|0,o[7728+(l*28|0)+16>>2]|0}function Cr(l){return l=l|0,(l|0)==4|(l|0)==117|0}function Vn(l){return l=l|0,o[11152+((o[l>>2]|0)*216|0)+((o[l+4>>2]|0)*72|0)+((o[l+8>>2]|0)*24|0)+(o[l+12>>2]<<3)>>2]|0}function nA(l){return l=l|0,o[11152+((o[l>>2]|0)*216|0)+((o[l+4>>2]|0)*72|0)+((o[l+8>>2]|0)*24|0)+(o[l+12>>2]<<3)+4>>2]|0}function rA(l,h){l=l|0,h=h|0,l=7728+(l*28|0)|0,o[h>>2]=o[l>>2],o[h+4>>2]=o[l+4>>2],o[h+8>>2]=o[l+8>>2],o[h+12>>2]=o[l+12>>2]}function iA(l,h){l=l|0,h=h|0;var d=0,x=0;if(h>>>0>20)return h=-1,h|0;do if((o[11152+(h*216|0)>>2]|0)!=(l|0))if((o[11152+(h*216|0)+8>>2]|0)!=(l|0))if((o[11152+(h*216|0)+16>>2]|0)!=(l|0))if((o[11152+(h*216|0)+24>>2]|0)!=(l|0))if((o[11152+(h*216|0)+32>>2]|0)!=(l|0))if((o[11152+(h*216|0)+40>>2]|0)!=(l|0))if((o[11152+(h*216|0)+48>>2]|0)!=(l|0))if((o[11152+(h*216|0)+56>>2]|0)!=(l|0))if((o[11152+(h*216|0)+64>>2]|0)!=(l|0))if((o[11152+(h*216|0)+72>>2]|0)!=(l|0))if((o[11152+(h*216|0)+80>>2]|0)!=(l|0))if((o[11152+(h*216|0)+88>>2]|0)!=(l|0))if((o[11152+(h*216|0)+96>>2]|0)!=(l|0))if((o[11152+(h*216|0)+104>>2]|0)!=(l|0))if((o[11152+(h*216|0)+112>>2]|0)!=(l|0))if((o[11152+(h*216|0)+120>>2]|0)!=(l|0))if((o[11152+(h*216|0)+128>>2]|0)!=(l|0))if((o[11152+(h*216|0)+136>>2]|0)==(l|0))l=2,d=1,x=2;else{if((o[11152+(h*216|0)+144>>2]|0)==(l|0)){l=0,d=2,x=0;break}if((o[11152+(h*216|0)+152>>2]|0)==(l|0)){l=0,d=2,x=1;break}if((o[11152+(h*216|0)+160>>2]|0)==(l|0)){l=0,d=2,x=2;break}if((o[11152+(h*216|0)+168>>2]|0)==(l|0)){l=1,d=2,x=0;break}if((o[11152+(h*216|0)+176>>2]|0)==(l|0)){l=1,d=2,x=1;break}if((o[11152+(h*216|0)+184>>2]|0)==(l|0)){l=1,d=2,x=2;break}if((o[11152+(h*216|0)+192>>2]|0)==(l|0)){l=2,d=2,x=0;break}if((o[11152+(h*216|0)+200>>2]|0)==(l|0)){l=2,d=2,x=1;break}if((o[11152+(h*216|0)+208>>2]|0)==(l|0)){l=2,d=2,x=2;break}else l=-1;return l|0}else l=2,d=1,x=1;else l=2,d=1,x=0;else l=1,d=1,x=2;else l=1,d=1,x=1;else l=1,d=1,x=0;else l=0,d=1,x=2;else l=0,d=1,x=1;else l=0,d=1,x=0;else l=2,d=0,x=2;else l=2,d=0,x=1;else l=2,d=0,x=0;else l=1,d=0,x=2;else l=1,d=0,x=1;else l=1,d=0,x=0;else l=0,d=0,x=2;else l=0,d=0,x=1;else l=0,d=0,x=0;while(0);return h=o[11152+(h*216|0)+(d*72|0)+(l*24|0)+(x<<3)+4>>2]|0,h|0}function FA(l,h){return l=l|0,h=h|0,(o[7728+(l*28|0)+20>>2]|0)==(h|0)?(h=1,h|0):(h=(o[7728+(l*28|0)+24>>2]|0)==(h|0),h|0)}function NA(l,h){return l=l|0,h=h|0,o[880+(l*28|0)+(h<<2)>>2]|0}function sA(l,h){return l=l|0,h=h|0,(o[880+(l*28|0)>>2]|0)==(h|0)?(h=0,h|0):(o[880+(l*28|0)+4>>2]|0)==(h|0)?(h=1,h|0):(o[880+(l*28|0)+8>>2]|0)==(h|0)?(h=2,h|0):(o[880+(l*28|0)+12>>2]|0)==(h|0)?(h=3,h|0):(o[880+(l*28|0)+16>>2]|0)==(h|0)?(h=4,h|0):(o[880+(l*28|0)+20>>2]|0)==(h|0)?(h=5,h|0):((o[880+(l*28|0)+24>>2]|0)==(h|0)?6:7)|0}function ul(){return 122}function cl(l){l=l|0;var h=0,d=0,x=0;h=0;do Ct(h|0,0,45)|0,x=Oe()|0|134225919,d=l+(h<<3)|0,o[d>>2]=-1,o[d+4>>2]=x,h=h+1|0;while((h|0)!=122)}function oA(l){return l=l|0,+G[l+16>>3]<+G[l+24>>3]|0}function aA(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;return d=+G[h>>3],!(d>=+G[l+8>>3])||!(d<=+G[l>>3])?(h=0,h|0):(x=+G[l+16>>3],d=+G[l+24>>3],b=+G[h+8>>3],h=b>=d,l=b<=x&1,x<d?h&&(l=1):h||(l=0),h=(l|0)!=0,h|0)}function Yn(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0;M=De,De=De+288|0,d=M+264|0,x=M+96|0,b=M,S=b,B=S+96|0;do o[S>>2]=0,S=S+4|0;while((S|0)<(B|0));return Jr(h,b),S=b,B=o[S>>2]|0,S=o[S+4>>2]|0,Ds(B,S,d),rs(B,S,x),V=+Wn(d,x+8|0),G[d>>3]=+G[l>>3],S=d+8|0,G[S>>3]=+G[l+16>>3],G[x>>3]=+G[l+8>>3],B=x+8|0,G[B>>3]=+G[l+24>>3],$=+Wn(d,x),B=~~+dn(+($*$/+Fr(+ +Pe(+((+G[S>>3]-+G[B>>3])/(+G[d>>3]-+G[x>>3]))),3)/(V*(V*2.59807621135)*.8))),De=M,(B|0?B:1)|0}function UA(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0;B=De,De=De+288|0,x=B+264|0,b=B+96|0,S=B,M=S,V=M+96|0;do o[M>>2]=0,M=M+4|0;while((M|0)<(V|0));return Jr(d,S),V=S,M=o[V>>2]|0,V=o[V+4>>2]|0,Ds(M,V,x),rs(M,V,b),$=+Wn(x,b+8|0),V=~~+dn(+(+Wn(l,h)/($*2))),De=B,(V|0?V:1)|0}function qu(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0,o[l>>2]=h,o[l+4>>2]=d,o[l+8>>2]=x}function hl(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0;oe=h+8|0,o[oe>>2]=0,V=+G[l>>3],M=+Pe(+V),$=+G[l+8>>3],B=+Pe(+$)/.8660254037844386,M=M+B*.5,d=~~M,l=~~B,M=M-+(d|0),B=B-+(l|0);do if(M<.5)if(M<.3333333333333333)if(o[h>>2]=d,B<(M+1)*.5){o[h+4>>2]=l;break}else{l=l+1|0,o[h+4>>2]=l;break}else if(te=1-M,l=(!(B<te)&1)+l|0,o[h+4>>2]=l,te<=B&B<M*2){d=d+1|0,o[h>>2]=d;break}else{o[h>>2]=d;break}else{if(!(M<.6666666666666666))if(d=d+1|0,o[h>>2]=d,B<M*.5){o[h+4>>2]=l;break}else{l=l+1|0,o[h+4>>2]=l;break}if(B<1-M){if(o[h+4>>2]=l,M*2+-1<B){o[h>>2]=d;break}}else l=l+1|0,o[h+4>>2]=l;d=d+1|0,o[h>>2]=d}while(0);do if(V<0)if(l&1){Y=(l+1|0)/2|0,Y=Or(d|0,((d|0)<0)<<31>>31|0,Y|0,((Y|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-((+(Y>>>0)+4294967296*+(Oe()|0))*2+1)),o[h>>2]=d;break}else{Y=(l|0)/2|0,Y=Or(d|0,((d|0)<0)<<31>>31|0,Y|0,((Y|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-(+(Y>>>0)+4294967296*+(Oe()|0))*2),o[h>>2]=d;break}while(0);Y=h+4|0,$<0&&(d=d-((l<<1|1|0)/2|0)|0,o[h>>2]=d,l=0-l|0,o[Y>>2]=l),x=l-d|0,(d|0)<0?(b=0-d|0,o[Y>>2]=x,o[oe>>2]=b,o[h>>2]=0,l=x,d=0):b=0,(l|0)<0&&(d=d-l|0,o[h>>2]=d,b=b-l|0,o[oe>>2]=b,o[Y>>2]=0,l=0),S=d-b|0,x=l-b|0,(b|0)<0&&(o[h>>2]=S,o[Y>>2]=x,o[oe>>2]=0,l=x,d=S,b=0),x=(l|0)<(d|0)?l:d,x=(b|0)<(x|0)?b:x,!((x|0)<=0)&&(o[h>>2]=d-x,o[Y>>2]=l-x,o[oe>>2]=b-x)}function Gr(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0;h=o[l>>2]|0,M=l+4|0,d=o[M>>2]|0,(h|0)<0&&(d=d-h|0,o[M>>2]=d,S=l+8|0,o[S>>2]=(o[S>>2]|0)-h,o[l>>2]=0,h=0),(d|0)<0?(h=h-d|0,o[l>>2]=h,S=l+8|0,b=(o[S>>2]|0)-d|0,o[S>>2]=b,o[M>>2]=0,d=0):(b=l+8|0,S=b,b=o[b>>2]|0),(b|0)<0&&(h=h-b|0,o[l>>2]=h,d=d-b|0,o[M>>2]=d,o[S>>2]=0,b=0),x=(d|0)<(h|0)?d:h,x=(b|0)<(x|0)?b:x,!((x|0)<=0)&&(o[l>>2]=h-x,o[M>>2]=d-x,o[S>>2]=b-x)}function Lo(l,h){l=l|0,h=h|0;var d=0,x=0;x=o[l+8>>2]|0,d=+((o[l+4>>2]|0)-x|0),G[h>>3]=+((o[l>>2]|0)-x|0)-d*.5,G[h+8>>3]=d*.8660254037844386}function Bn(l,h,d){l=l|0,h=h|0,d=d|0,o[d>>2]=(o[h>>2]|0)+(o[l>>2]|0),o[d+4>>2]=(o[h+4>>2]|0)+(o[l+4>>2]|0),o[d+8>>2]=(o[h+8>>2]|0)+(o[l+8>>2]|0)}function ps(l,h,d){l=l|0,h=h|0,d=d|0,o[d>>2]=(o[l>>2]|0)-(o[h>>2]|0),o[d+4>>2]=(o[l+4>>2]|0)-(o[h+4>>2]|0),o[d+8>>2]=(o[l+8>>2]|0)-(o[h+8>>2]|0)}function Xr(l,h){l=l|0,h=h|0;var d=0,x=0;d=Qt(o[l>>2]|0,h)|0,o[l>>2]=d,d=l+4|0,x=Qt(o[d>>2]|0,h)|0,o[d>>2]=x,l=l+8|0,h=Qt(o[l>>2]|0,h)|0,o[l>>2]=h}function ao(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;M=o[l>>2]|0,B=(M|0)<0,x=(o[l+4>>2]|0)-(B?M:0)|0,S=(x|0)<0,b=(S?0-x|0:0)+((o[l+8>>2]|0)-(B?M:0))|0,d=(b|0)<0,l=d?0:b,h=(S?0:x)-(d?b:0)|0,b=(B?0:M)-(S?x:0)-(d?b:0)|0,d=(h|0)<(b|0)?h:b,d=(l|0)<(d|0)?l:d,x=(d|0)>0,l=l-(x?d:0)|0,h=h-(x?d:0)|0;e:do switch(b-(x?d:0)|0){case 0:switch(h|0){case 0:return B=l|0?(l|0)==1?1:7:0,B|0;case 1:return B=l|0?(l|0)==1?3:7:2,B|0;default:break e}case 1:switch(h|0){case 0:return B=l|0?(l|0)==1?5:7:4,B|0;case 1:{if(!l)l=6;else break e;return l|0}default:break e}}while(0);return B=7,B|0}function fl(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;M=l+8|0,d=o[M>>2]|0,h=(o[l>>2]|0)-d|0,B=l+4|0,d=(o[B>>2]|0)-d|0,x=Zt(+((h*3|0)-d|0)/7)|0,o[l>>2]=x,h=Zt(+((d<<1)+h|0)/7)|0,o[B>>2]=h,o[M>>2]=0,d=h-x|0,(x|0)<0?(S=0-x|0,o[B>>2]=d,o[M>>2]=S,o[l>>2]=0,h=d,x=0,d=S):d=0,(h|0)<0&&(x=x-h|0,o[l>>2]=x,d=d-h|0,o[M>>2]=d,o[B>>2]=0,h=0),S=x-d|0,b=h-d|0,(d|0)<0?(o[l>>2]=S,o[B>>2]=b,o[M>>2]=0,h=b,b=S,d=0):b=x,x=(h|0)<(b|0)?h:b,x=(d|0)<(x|0)?d:x,!((x|0)<=0)&&(o[l>>2]=b-x,o[B>>2]=h-x,o[M>>2]=d-x)}function Do(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;M=l+8|0,d=o[M>>2]|0,h=(o[l>>2]|0)-d|0,B=l+4|0,d=(o[B>>2]|0)-d|0,x=Zt(+((h<<1)+d|0)/7)|0,o[l>>2]=x,h=Zt(+((d*3|0)-h|0)/7)|0,o[B>>2]=h,o[M>>2]=0,d=h-x|0,(x|0)<0?(S=0-x|0,o[B>>2]=d,o[M>>2]=S,o[l>>2]=0,h=d,x=0,d=S):d=0,(h|0)<0&&(x=x-h|0,o[l>>2]=x,d=d-h|0,o[M>>2]=d,o[B>>2]=0,h=0),S=x-d|0,b=h-d|0,(d|0)<0?(o[l>>2]=S,o[B>>2]=b,o[M>>2]=0,h=b,b=S,d=0):b=x,x=(h|0)<(b|0)?h:b,x=(d|0)<(x|0)?d:x,!((x|0)<=0)&&(o[l>>2]=b-x,o[B>>2]=h-x,o[M>>2]=d-x)}function ra(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;h=o[l>>2]|0,M=l+4|0,d=o[M>>2]|0,B=l+8|0,x=o[B>>2]|0,b=d+(h*3|0)|0,o[l>>2]=b,d=x+(d*3|0)|0,o[M>>2]=d,h=(x*3|0)+h|0,o[B>>2]=h,x=d-b|0,(b|0)<0?(h=h-b|0,o[M>>2]=x,o[B>>2]=h,o[l>>2]=0,d=x,x=0):x=b,(d|0)<0&&(x=x-d|0,o[l>>2]=x,h=h-d|0,o[B>>2]=h,o[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(o[l>>2]=S,o[M>>2]=b,o[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=x-d,o[M>>2]=b-d,o[B>>2]=h-d)}function lo(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=o[l>>2]|0,M=l+4|0,h=o[M>>2]|0,B=l+8|0,d=o[B>>2]|0,x=(h*3|0)+b|0,b=d+(b*3|0)|0,o[l>>2]=b,o[M>>2]=x,h=(d*3|0)+h|0,o[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,o[M>>2]=d,o[B>>2]=h,o[l>>2]=0,b=0):d=x,(d|0)<0&&(b=b-d|0,o[l>>2]=b,h=h-d|0,o[B>>2]=h,o[M>>2]=0,d=0),S=b-h|0,x=d-h|0,(h|0)<0?(o[l>>2]=S,o[M>>2]=x,o[B>>2]=0,b=S,h=0):x=d,d=(x|0)<(b|0)?x:b,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=b-d,o[M>>2]=x-d,o[B>>2]=h-d)}function lA(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;(h+-1|0)>>>0>=6||(b=(o[15472+(h*12|0)>>2]|0)+(o[l>>2]|0)|0,o[l>>2]=b,B=l+4|0,x=(o[15472+(h*12|0)+4>>2]|0)+(o[B>>2]|0)|0,o[B>>2]=x,M=l+8|0,h=(o[15472+(h*12|0)+8>>2]|0)+(o[M>>2]|0)|0,o[M>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,o[B>>2]=d,o[M>>2]=h,o[l>>2]=0,x=0):(d=x,x=b),(d|0)<0&&(x=x-d|0,o[l>>2]=x,h=h-d|0,o[M>>2]=h,o[B>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(o[l>>2]=S,o[B>>2]=b,o[M>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=x-d,o[B>>2]=b-d,o[M>>2]=h-d))}function Da(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=o[l>>2]|0,M=l+4|0,h=o[M>>2]|0,B=l+8|0,d=o[B>>2]|0,x=h+b|0,b=d+b|0,o[l>>2]=b,o[M>>2]=x,h=d+h|0,o[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,o[M>>2]=d,o[B>>2]=h,o[l>>2]=0,x=0):(d=x,x=b),(d|0)<0&&(x=x-d|0,o[l>>2]=x,h=h-d|0,o[B>>2]=h,o[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(o[l>>2]=S,o[M>>2]=b,o[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=x-d,o[M>>2]=b-d,o[B>>2]=h-d)}function Ro(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;h=o[l>>2]|0,M=l+4|0,x=o[M>>2]|0,B=l+8|0,d=o[B>>2]|0,b=x+h|0,o[l>>2]=b,x=d+x|0,o[M>>2]=x,h=d+h|0,o[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,o[M>>2]=d,o[B>>2]=h,o[l>>2]=0,x=0):(d=x,x=b),(d|0)<0&&(x=x-d|0,o[l>>2]=x,h=h-d|0,o[B>>2]=h,o[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(o[l>>2]=S,o[M>>2]=b,o[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=x-d,o[M>>2]=b-d,o[B>>2]=h-d)}function Oi(l){switch(l=l|0,l|0){case 1:{l=5;break}case 5:{l=4;break}case 4:{l=6;break}case 6:{l=2;break}case 2:{l=3;break}case 3:{l=1;break}}return l|0}function Fi(l){switch(l=l|0,l|0){case 1:{l=3;break}case 3:{l=2;break}case 2:{l=6;break}case 6:{l=4;break}case 4:{l=5;break}case 5:{l=1;break}}return l|0}function VA(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;h=o[l>>2]|0,M=l+4|0,d=o[M>>2]|0,B=l+8|0,x=o[B>>2]|0,b=d+(h<<1)|0,o[l>>2]=b,d=x+(d<<1)|0,o[M>>2]=d,h=(x<<1)+h|0,o[B>>2]=h,x=d-b|0,(b|0)<0?(h=h-b|0,o[M>>2]=x,o[B>>2]=h,o[l>>2]=0,d=x,x=0):x=b,(d|0)<0&&(x=x-d|0,o[l>>2]=x,h=h-d|0,o[B>>2]=h,o[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(o[l>>2]=S,o[M>>2]=b,o[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=x-d,o[M>>2]=b-d,o[B>>2]=h-d)}function dl(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=o[l>>2]|0,M=l+4|0,h=o[M>>2]|0,B=l+8|0,d=o[B>>2]|0,x=(h<<1)+b|0,b=d+(b<<1)|0,o[l>>2]=b,o[M>>2]=x,h=(d<<1)+h|0,o[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,o[M>>2]=d,o[B>>2]=h,o[l>>2]=0,b=0):d=x,(d|0)<0&&(b=b-d|0,o[l>>2]=b,h=h-d|0,o[B>>2]=h,o[M>>2]=0,d=0),S=b-h|0,x=d-h|0,(h|0)<0?(o[l>>2]=S,o[M>>2]=x,o[B>>2]=0,b=S,h=0):x=d,d=(x|0)<(b|0)?x:b,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=b-d,o[M>>2]=x-d,o[B>>2]=h-d)}function Ao(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;return M=(o[l>>2]|0)-(o[h>>2]|0)|0,B=(M|0)<0,x=(o[l+4>>2]|0)-(o[h+4>>2]|0)-(B?M:0)|0,S=(x|0)<0,b=(B?0-M|0:0)+(o[l+8>>2]|0)-(o[h+8>>2]|0)+(S?0-x|0:0)|0,l=(b|0)<0,h=l?0:b,d=(S?0:x)-(l?b:0)|0,b=(B?0:M)-(S?x:0)-(l?b:0)|0,l=(d|0)<(b|0)?d:b,l=(h|0)<(l|0)?h:l,x=(l|0)>0,h=h-(x?l:0)|0,d=d-(x?l:0)|0,l=b-(x?l:0)|0,l=(l|0)>-1?l:0-l|0,d=(d|0)>-1?d:0-d|0,h=(h|0)>-1?h:0-h|0,h=(d|0)>(h|0)?d:h,((l|0)>(h|0)?l:h)|0}function Bo(l,h){l=l|0,h=h|0;var d=0;d=o[l+8>>2]|0,o[h>>2]=(o[l>>2]|0)-d,o[h+4>>2]=(o[l+4>>2]|0)-d}function Zu(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;x=o[l>>2]|0,o[h>>2]=x,l=o[l+4>>2]|0,M=h+4|0,o[M>>2]=l,B=h+8|0,o[B>>2]=0,d=l-x|0,(x|0)<0?(l=0-x|0,o[M>>2]=d,o[B>>2]=l,o[h>>2]=0,x=0):(d=l,l=0),(d|0)<0&&(x=x-d|0,o[h>>2]=x,l=l-d|0,o[B>>2]=l,o[M>>2]=0,d=0),S=x-l|0,b=d-l|0,(l|0)<0?(o[h>>2]=S,o[M>>2]=b,o[B>>2]=0,d=b,b=S,l=0):b=x,x=(d|0)<(b|0)?d:b,x=(l|0)<(x|0)?l:x,!((x|0)<=0)&&(o[h>>2]=b-x,o[M>>2]=d-x,o[B>>2]=l-x)}function GA(l){l=l|0;var h=0,d=0,x=0,b=0;h=l+8|0,b=o[h>>2]|0,d=b-(o[l>>2]|0)|0,o[l>>2]=d,x=l+4|0,l=(o[x>>2]|0)-b|0,o[x>>2]=l,o[h>>2]=0-(l+d)}function pl(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;d=o[l>>2]|0,h=0-d|0,o[l>>2]=h,M=l+8|0,o[M>>2]=0,B=l+4|0,x=o[B>>2]|0,b=x+d|0,(d|0)>0?(o[B>>2]=b,o[M>>2]=d,o[l>>2]=0,h=0,x=b):d=0,(x|0)<0?(S=h-x|0,o[l>>2]=S,d=d-x|0,o[M>>2]=d,o[B>>2]=0,b=S-d|0,h=0-d|0,(d|0)<0?(o[l>>2]=b,o[B>>2]=h,o[M>>2]=0,x=h,d=0):(x=0,b=S)):b=h,h=(x|0)<(b|0)?x:b,h=(d|0)<(h|0)?d:h,!((h|0)<=0)&&(o[l>>2]=b-h,o[B>>2]=x-h,o[M>>2]=d-h)}function AA(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;x=De,De=De+16|0,b=x,jA(l,h,d,b),hl(b,d+4|0),De=x}function jA(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0;if(V=De,De=De+32|0,S=V,Tl(l,S),o[d>>2]=0,b=+Dr(15888,S),M=+Dr(15912,S),M<b&&(o[d>>2]=1,b=M),M=+Dr(15936,S),M<b&&(o[d>>2]=2,b=M),M=+Dr(15960,S),M<b&&(o[d>>2]=3,b=M),M=+Dr(15984,S),M<b&&(o[d>>2]=4,b=M),M=+Dr(16008,S),M<b&&(o[d>>2]=5,b=M),M=+Dr(16032,S),M<b&&(o[d>>2]=6,b=M),M=+Dr(16056,S),M<b&&(o[d>>2]=7,b=M),M=+Dr(16080,S),M<b&&(o[d>>2]=8,b=M),M=+Dr(16104,S),M<b&&(o[d>>2]=9,b=M),M=+Dr(16128,S),M<b&&(o[d>>2]=10,b=M),M=+Dr(16152,S),M<b&&(o[d>>2]=11,b=M),M=+Dr(16176,S),M<b&&(o[d>>2]=12,b=M),M=+Dr(16200,S),M<b&&(o[d>>2]=13,b=M),M=+Dr(16224,S),M<b&&(o[d>>2]=14,b=M),M=+Dr(16248,S),M<b&&(o[d>>2]=15,b=M),M=+Dr(16272,S),M<b&&(o[d>>2]=16,b=M),M=+Dr(16296,S),M<b&&(o[d>>2]=17,b=M),M=+Dr(16320,S),M<b&&(o[d>>2]=18,b=M),M=+Dr(16344,S),M<b&&(o[d>>2]=19,b=M),M=+Lt(+(1-b*.5)),M<1e-16){o[x>>2]=0,o[x+4>>2]=0,o[x+8>>2]=0,o[x+12>>2]=0,De=V;return}if(d=o[d>>2]|0,b=+G[16368+(d*24|0)>>3],b=+ur(b-+ur(+hr(15568+(d<<4)|0,l))),Ai(h)|0?B=+ur(b+-.3334731722518321):B=b,b=+ft(+M)/.381966011250105,(h|0)>0){S=0;do b=b*2.6457513110645907,S=S+1|0;while((S|0)!=(h|0))}M=+at(+B)*b,G[x>>3]=M,B=+$e(+B)*b,G[x+8>>3]=B,De=V}function zo(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0;if(S=+fo(l),S<1e-16){h=15568+(h<<4)|0,o[b>>2]=o[h>>2],o[b+4>>2]=o[h+4>>2],o[b+8>>2]=o[h+8>>2],o[b+12>>2]=o[h+12>>2];return}if(M=+jt(+ +G[l+8>>3],+ +G[l>>3]),(d|0)>0){l=0;do S=S/2.6457513110645907,l=l+1|0;while((l|0)!=(d|0))}x?(S=S/3,d=(Ai(d)|0)==0,S=+rn(+((d?S:S/2.6457513110645907)*.381966011250105))):(S=+rn(+(S*.381966011250105)),Ai(d)|0&&(M=+ur(M+.3334731722518321))),gl(15568+(h<<4)|0,+ur(+G[16368+(h*24|0)>>3]-M),S,b)}function Ra(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;x=De,De=De+16|0,b=x,Lo(l+4|0,b),zo(b,o[l>>2]|0,h,0,d),De=x}function $A(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,m=0,g=0,v=0,E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0;if(J=De,De=De+272|0,S=J+256|0,Te=J+240|0,O=J,N=J+224|0,Q=J+208|0,Ve=J+176|0,xe=J+160|0,m=J+192|0,g=J+144|0,v=J+128|0,E=J+112|0,C=J+96|0,R=J+80|0,o[S>>2]=h,o[Te>>2]=o[l>>2],o[Te+4>>2]=o[l+4>>2],o[Te+8>>2]=o[l+8>>2],o[Te+12>>2]=o[l+12>>2],HA(Te,S,O),o[b>>2]=0,Te=x+d+((x|0)==5&1)|0,(Te|0)<=(d|0)){De=J;return}V=o[S>>2]|0,$=N+4|0,Y=Ve+4|0,oe=d+5|0,te=16848+(V<<2)|0,ue=16928+(V<<2)|0,be=v+8|0,Ce=E+8|0,ve=C+8|0,Ge=Q+4|0,B=d;e:for(;;){M=O+(((B|0)%5|0)<<4)|0,o[Q>>2]=o[M>>2],o[Q+4>>2]=o[M+4>>2],o[Q+8>>2]=o[M+8>>2],o[Q+12>>2]=o[M+12>>2];do;while((uo(Q,V,0,1)|0)==2);if((B|0)>(d|0)&(Ai(h)|0)!=0){if(o[Ve>>2]=o[Q>>2],o[Ve+4>>2]=o[Q+4>>2],o[Ve+8>>2]=o[Q+8>>2],o[Ve+12>>2]=o[Q+12>>2],Lo($,xe),x=o[Ve>>2]|0,S=o[17008+(x*80|0)+(o[N>>2]<<2)>>2]|0,o[Ve>>2]=o[18608+(x*80|0)+(S*20|0)>>2],M=o[18608+(x*80|0)+(S*20|0)+16>>2]|0,(M|0)>0){l=0;do Da(Y),l=l+1|0;while((l|0)<(M|0))}switch(M=18608+(x*80|0)+(S*20|0)+4|0,o[m>>2]=o[M>>2],o[m+4>>2]=o[M+4>>2],o[m+8>>2]=o[M+8>>2],Xr(m,(o[te>>2]|0)*3|0),Bn(Y,m,Y),Gr(Y),Lo(Y,g),le=+(o[ue>>2]|0),G[v>>3]=le*3,G[be>>3]=0,de=le*-1.5,G[E>>3]=de,G[Ce>>3]=le*2.598076211353316,G[C>>3]=de,G[ve>>3]=le*-2.598076211353316,o[17008+((o[Ve>>2]|0)*80|0)+(o[Q>>2]<<2)>>2]|0){case 1:{l=E,x=v;break}case 3:{l=C,x=E;break}case 2:{l=v,x=C;break}default:{l=12;break e}}nu(xe,g,x,l,R),zo(R,o[Ve>>2]|0,V,1,b+8+(o[b>>2]<<4)|0),o[b>>2]=(o[b>>2]|0)+1}if((B|0)<(oe|0)&&(Lo(Ge,Ve),zo(Ve,o[Q>>2]|0,V,1,b+8+(o[b>>2]<<4)|0),o[b>>2]=(o[b>>2]|0)+1),o[N>>2]=o[Q>>2],o[N+4>>2]=o[Q+4>>2],o[N+8>>2]=o[Q+8>>2],o[N+12>>2]=o[Q+12>>2],B=B+1|0,(B|0)>=(Te|0)){l=3;break}}if((l|0)==3){De=J;return}else(l|0)==12&&Mt(22474,22521,581,22531)}function HA(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0;V=De,De=De+128|0,x=V+64|0,b=V,S=x,M=20208,B=S+60|0;do o[S>>2]=o[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));S=b,M=20272,B=S+60|0;do o[S>>2]=o[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));B=(Ai(o[h>>2]|0)|0)==0,x=B?x:b,b=l+4|0,VA(b),dl(b),Ai(o[h>>2]|0)|0&&(lo(b),o[h>>2]=(o[h>>2]|0)+1),o[d>>2]=o[l>>2],h=d+4|0,Bn(b,x,h),Gr(h),o[d+16>>2]=o[l>>2],h=d+20|0,Bn(b,x+12|0,h),Gr(h),o[d+32>>2]=o[l>>2],h=d+36|0,Bn(b,x+24|0,h),Gr(h),o[d+48>>2]=o[l>>2],h=d+52|0,Bn(b,x+36|0,h),Gr(h),o[d+64>>2]=o[l>>2],d=d+68|0,Bn(b,x+48|0,d),Gr(d),De=V}function uo(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0;if(be=De,De=De+32|0,te=be+12|0,B=be,ue=l+4|0,oe=o[16928+(h<<2)>>2]|0,Y=(x|0)!=0,oe=Y?oe*3|0:oe,b=o[ue>>2]|0,$=l+8|0,M=o[$>>2]|0,Y){if(S=l+12|0,x=o[S>>2]|0,b=M+b+x|0,(b|0)==(oe|0))return ue=1,De=be,ue|0;V=S}else V=l+12|0,x=o[V>>2]|0,b=M+b+x|0;if((b|0)<=(oe|0))return ue=0,De=be,ue|0;do if((x|0)>0){if(x=o[l>>2]|0,(M|0)>0){S=18608+(x*80|0)+60|0,x=l;break}x=18608+(x*80|0)+40|0,d?(qu(te,oe,0,0),ps(ue,te,B),Ro(B),Bn(B,te,ue),S=x,x=l):(S=x,x=l)}else S=18608+((o[l>>2]|0)*80|0)+20|0,x=l;while(0);if(o[x>>2]=o[S>>2],b=S+16|0,(o[b>>2]|0)>0){x=0;do Da(ue),x=x+1|0;while((x|0)<(o[b>>2]|0))}return l=S+4|0,o[te>>2]=o[l>>2],o[te+4>>2]=o[l+4>>2],o[te+8>>2]=o[l+8>>2],h=o[16848+(h<<2)>>2]|0,Xr(te,Y?h*3|0:h),Bn(ue,te,ue),Gr(ue),Y?x=((o[$>>2]|0)+(o[ue>>2]|0)+(o[V>>2]|0)|0)==(oe|0)?1:2:x=2,ue=x,De=be,ue|0}function ia(l,h){l=l|0,h=h|0;var d=0;do d=uo(l,h,0,1)|0;while((d|0)==2);return d|0}function WA(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,m=0,g=0,v=0,E=0,C=0,R=0,O=0;if(C=De,De=De+240|0,S=C+224|0,m=C+208|0,g=C,v=C+192|0,E=C+176|0,ve=C+160|0,Ge=C+144|0,Te=C+128|0,Ve=C+112|0,xe=C+96|0,o[S>>2]=h,o[m>>2]=o[l>>2],o[m+4>>2]=o[l+4>>2],o[m+8>>2]=o[l+8>>2],o[m+12>>2]=o[l+12>>2],sa(m,S,g),o[b>>2]=0,Ce=x+d+((x|0)==6&1)|0,(Ce|0)<=(d|0)){De=C;return}V=o[S>>2]|0,$=d+6|0,Y=16928+(V<<2)|0,oe=Ge+8|0,te=Te+8|0,ue=Ve+8|0,be=v+4|0,M=0,B=d,x=-1;e:for(;;){if(S=(B|0)%6|0,l=g+(S<<4)|0,o[v>>2]=o[l>>2],o[v+4>>2]=o[l+4>>2],o[v+8>>2]=o[l+8>>2],o[v+12>>2]=o[l+12>>2],l=M,M=uo(v,V,0,1)|0,(B|0)>(d|0)&(Ai(h)|0)!=0&&(l|0)!=1&&(o[v>>2]|0)!=(x|0)){switch(Lo(g+(((S+5|0)%6|0)<<4)+4|0,E),Lo(g+(S<<4)+4|0,ve),R=+(o[Y>>2]|0),G[Ge>>3]=R*3,G[oe>>3]=0,O=R*-1.5,G[Te>>3]=O,G[te>>3]=R*2.598076211353316,G[Ve>>3]=O,G[ue>>3]=R*-2.598076211353316,S=o[m>>2]|0,o[17008+(S*80|0)+(((x|0)==(S|0)?o[v>>2]|0:x)<<2)>>2]|0){case 1:{l=Te,x=Ge;break}case 3:{l=Ve,x=Te;break}case 2:{l=Ge,x=Ve;break}default:{l=8;break e}}nu(E,ve,x,l,xe),!(ca(E,xe)|0)&&!(ca(ve,xe)|0)&&(zo(xe,o[m>>2]|0,V,1,b+8+(o[b>>2]<<4)|0),o[b>>2]=(o[b>>2]|0)+1)}if((B|0)<($|0)&&(Lo(be,E),zo(E,o[v>>2]|0,V,1,b+8+(o[b>>2]<<4)|0),o[b>>2]=(o[b>>2]|0)+1),B=B+1|0,(B|0)>=(Ce|0)){l=3;break}else x=o[v>>2]|0}if((l|0)==3){De=C;return}else(l|0)==8&&Mt(22557,22521,746,22602)}function sa(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0;V=De,De=De+160|0,x=V+80|0,b=V,S=x,M=20336,B=S+72|0;do o[S>>2]=o[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));S=b,M=20416,B=S+72|0;do o[S>>2]=o[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));B=(Ai(o[h>>2]|0)|0)==0,x=B?x:b,b=l+4|0,VA(b),dl(b),Ai(o[h>>2]|0)|0&&(lo(b),o[h>>2]=(o[h>>2]|0)+1),o[d>>2]=o[l>>2],h=d+4|0,Bn(b,x,h),Gr(h),o[d+16>>2]=o[l>>2],h=d+20|0,Bn(b,x+12|0,h),Gr(h),o[d+32>>2]=o[l>>2],h=d+36|0,Bn(b,x+24|0,h),Gr(h),o[d+48>>2]=o[l>>2],h=d+52|0,Bn(b,x+36|0,h),Gr(h),o[d+64>>2]=o[l>>2],h=d+68|0,Bn(b,x+48|0,h),Gr(h),o[d+80>>2]=o[l>>2],d=d+84|0,Bn(b,x+60|0,d),Gr(d),De=V}function ur(l){l=+l;var h=0;return h=l<0?l+6.283185307179586:l,+(l>=6.283185307179586?h+-6.283185307179586:h)}function Is(l,h){return l=l|0,h=h|0,+Pe(+(+G[l>>3]-+G[h>>3]))<17453292519943298e-27?(h=+Pe(+(+G[l+8>>3]-+G[h+8>>3]))<17453292519943298e-27,h|0):(h=0,h|0)}function Gn(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0;return b=+G[h>>3],x=+G[l>>3],S=+$e(+((b-x)*.5)),d=+$e(+((+G[h+8>>3]-+G[l+8>>3])*.5)),d=S*S+d*(+at(+b)*+at(+x)*d),+(+jt(+ +ke(+d),+ +ke(+(1-d)))*2)}function Wn(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0;return b=+G[h>>3],x=+G[l>>3],S=+$e(+((b-x)*.5)),d=+$e(+((+G[h+8>>3]-+G[l+8>>3])*.5)),d=S*S+d*(+at(+b)*+at(+x)*d),+(+jt(+ +ke(+d),+ +ke(+(1-d)))*2*6371.007180918475)}function yr(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0;return b=+G[h>>3],x=+G[l>>3],S=+$e(+((b-x)*.5)),d=+$e(+((+G[h+8>>3]-+G[l+8>>3])*.5)),d=S*S+d*(+at(+b)*+at(+x)*d),+(+jt(+ +ke(+d),+ +ke(+(1-d)))*2*6371.007180918475*1e3)}function hr(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;return S=+G[h>>3],x=+at(+S),b=+G[h+8>>3]-+G[l+8>>3],M=x*+$e(+b),d=+G[l>>3],+ +jt(+M,+(+$e(+S)*+at(+d)-+at(+b)*(x*+$e(+d))))}function gl(l,h,d,x){l=l|0,h=+h,d=+d,x=x|0;var b=0,S=0,M=0,B=0;if(d<1e-16){o[x>>2]=o[l>>2],o[x+4>>2]=o[l+4>>2],o[x+8>>2]=o[l+8>>2],o[x+12>>2]=o[l+12>>2];return}S=h<0?h+6.283185307179586:h,S=h>=6.283185307179586?S+-6.283185307179586:S;do if(S<1e-16)h=+G[l>>3]+d,G[x>>3]=h,b=x;else{if(b=+Pe(+(S+-3.141592653589793))<1e-16,h=+G[l>>3],b){h=h-d,G[x>>3]=h,b=x;break}if(M=+at(+d),d=+$e(+d),h=M*+$e(+h)+ +at(+S)*(d*+at(+h)),h=h>1?1:h,h=+Dt(+(h<-1?-1:h)),G[x>>3]=h,+Pe(+(h+-1.5707963267948966))<1e-16){G[x>>3]=1.5707963267948966,G[x+8>>3]=0;return}if(+Pe(+(h+1.5707963267948966))<1e-16){G[x>>3]=-1.5707963267948966,G[x+8>>3]=0;return}if(B=+at(+h),S=d*+$e(+S)/B,d=+G[l>>3],h=(M-+$e(+h)*+$e(+d))/+at(+d)/B,M=S>1?1:S,h=h>1?1:h,h=+G[l+8>>3]+ +jt(+(M<-1?-1:M),+(h<-1?-1:h)),h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);G[x+8>>3]=h;return}while(0);if(+Pe(+(h+-1.5707963267948966))<1e-16){G[b>>3]=1.5707963267948966,G[x+8>>3]=0;return}if(+Pe(+(h+1.5707963267948966))<1e-16){G[b>>3]=-1.5707963267948966,G[x+8>>3]=0;return}if(h=+G[l+8>>3],h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);G[x+8>>3]=h}function Oo(l){return l=l|0,+ +G[20496+(l<<3)>>3]}function Yu(l){return l=l|0,+ +G[20624+(l<<3)>>3]}function Ba(l){return l=l|0,+ +G[20752+(l<<3)>>3]}function Xu(l){return l=l|0,+ +G[20880+(l<<3)>>3]}function QA(l){l=l|0;var h=0;return h=21008+(l<<3)|0,l=o[h>>2]|0,Ot(o[h+4>>2]|0),l|0}function ks(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0;return te=+G[h>>3],Y=+G[l>>3],V=+$e(+((te-Y)*.5)),S=+G[h+8>>3],$=+G[l+8>>3],M=+$e(+((S-$)*.5)),B=+at(+Y),oe=+at(+te),M=V*V+M*(oe*B*M),M=+jt(+ +ke(+M),+ +ke(+(1-M)))*2,V=+G[d>>3],te=+$e(+((V-te)*.5)),x=+G[d+8>>3],S=+$e(+((x-S)*.5)),b=+at(+V),S=te*te+S*(oe*b*S),S=+jt(+ +ke(+S),+ +ke(+(1-S)))*2,V=+$e(+((Y-V)*.5)),x=+$e(+(($-x)*.5)),x=V*V+x*(B*b*x),x=+jt(+ +ke(+x),+ +ke(+(1-x)))*2,b=(M+S+x)*.5,+(+rn(+ +ke(+(+ft(+(b*.5))*+ft(+((b-M)*.5))*+ft(+((b-S)*.5))*+ft(+((b-x)*.5)))))*4)}function ml(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(S=De,De=De+192|0,x=S+168|0,b=S,Ds(l,h,x),rs(l,h,b),h=o[b>>2]|0,(h|0)<=0)return d=0,De=S,+d;if(d=+ks(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,x)+0,(h|0)==1)return De=S,+d;l=1;do M=l,l=l+1|0,d=d+ +ks(b+8+(M<<4)|0,b+8+(((l|0)%(h|0)|0)<<4)|0,x);while((l|0)<(h|0));return De=S,+d}function za(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(S=De,De=De+192|0,x=S+168|0,b=S,Ds(l,h,x),rs(l,h,b),h=o[b>>2]|0,(h|0)>0){if(d=+ks(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,x)+0,(h|0)!=1){l=1;do M=l,l=l+1|0,d=d+ +ks(b+8+(M<<4)|0,b+8+(((l|0)%(h|0)|0)<<4)|0,x);while((l|0)<(h|0))}}else d=0;return De=S,+(d*6371.007180918475*6371.007180918475)}function oa(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(S=De,De=De+192|0,x=S+168|0,b=S,Ds(l,h,x),rs(l,h,b),h=o[b>>2]|0,(h|0)>0){if(d=+ks(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,x)+0,(h|0)!=1){l=1;do M=l,l=l+1|0,d=d+ +ks(b+8+(M<<4)|0,b+8+(((l|0)%(h|0)|0)<<4)|0,x);while((l|0)<(h|0))}}else d=0;return De=S,+(d*6371.007180918475*6371.007180918475*1e3*1e3)}function yl(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0;if(M=De,De=De+176|0,S=M,Ua(l,h,S),l=o[S>>2]|0,(l|0)<=1)return b=0,De=M,+b;h=l+-1|0,l=0,d=0,x=+G[S+8>>3],b=+G[S+16>>3];do l=l+1|0,V=x,x=+G[S+8+(l<<4)>>3],$=+$e(+((x-V)*.5)),B=b,b=+G[S+8+(l<<4)+8>>3],B=+$e(+((b-B)*.5)),B=$*$+B*(+at(+x)*+at(+V)*B),d=d+ +jt(+ +ke(+B),+ +ke(+(1-B)))*2;while((l|0)<(h|0));return De=M,+d}function _l(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0;if(M=De,De=De+176|0,S=M,Ua(l,h,S),l=o[S>>2]|0,(l|0)<=1)return b=0,De=M,+b;h=l+-1|0,l=0,d=0,x=+G[S+8>>3],b=+G[S+16>>3];do l=l+1|0,V=x,x=+G[S+8+(l<<4)>>3],$=+$e(+((x-V)*.5)),B=b,b=+G[S+8+(l<<4)+8>>3],B=+$e(+((b-B)*.5)),B=$*$+B*(+at(+V)*+at(+x)*B),d=d+ +jt(+ +ke(+B),+ +ke(+(1-B)))*2;while((l|0)!=(h|0));return $=d*6371.007180918475,De=M,+$}function fr(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0;if(M=De,De=De+176|0,S=M,Ua(l,h,S),l=o[S>>2]|0,(l|0)<=1)return b=0,De=M,+b;h=l+-1|0,l=0,d=0,x=+G[S+8>>3],b=+G[S+16>>3];do l=l+1|0,V=x,x=+G[S+8+(l<<4)>>3],$=+$e(+((x-V)*.5)),B=b,b=+G[S+8+(l<<4)+8>>3],B=+$e(+((b-B)*.5)),B=$*$+B*(+at(+V)*+at(+x)*B),d=d+ +jt(+ +ke(+B),+ +ke(+(1-B)))*2;while((l|0)!=(h|0));return $=d*6371.007180918475*1e3,De=M,+$}function uA(l,h){return l=l|0,h=h|0,h=St(l|0,h|0,52)|0,Oe()|0,h&15|0}function ts(l,h){return l=l|0,h=h|0,h=St(l|0,h|0,45)|0,Oe()|0,h&127|0}function qA(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;if(!(!0&(h&-16777216|0)==134217728)||(M=St(l|0,h|0,45)|0,Oe()|0,M=M&127,M>>>0>121))return h=0,h|0;d=St(l|0,h|0,52)|0,Oe()|0,d=d&15;do if(d|0){for(b=1,x=0;;){if(S=St(l|0,h|0,(15-b|0)*3|0)|0,Oe()|0,S=S&7,(S|0)!=0&(x^1))if((S|0)==1&(Jt(M)|0)!=0){B=0,x=13;break}else x=1;if((S|0)==7){B=0,x=13;break}if(b>>>0<d>>>0)b=b+1|0;else{x=9;break}}if((x|0)==9){if((d|0)==15)B=1;else break;return B|0}else if((x|0)==13)return B|0}while(0);for(;;){if(B=St(l|0,h|0,(14-d|0)*3|0)|0,Oe()|0,!((B&7|0)==7&!0)){B=0,x=13;break}if(d>>>0<14)d=d+1|0;else{B=1,x=13;break}}return(x|0)==13?B|0:0}function vl(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,(x|0)>=(d|0)){if((x|0)!=(d|0))if(d>>>0<=15){if(b=Ct(d|0,0,52)|0,l=b|l,h=Oe()|0|h&-15728641,(x|0)>(d|0))do b=Ct(7,0,(14-d|0)*3|0)|0,d=d+1|0,l=b|l,h=Oe()|0|h;while((d|0)<(x|0))}else h=0,l=0}else h=0,l=0;return Ot(h|0),l|0}function Ku(l,h,d){return l=l|0,h=h|0,d=d|0,l=St(l|0,h|0,52)|0,Oe()|0,l=l&15,(d|0)<16&(l|0)<=(d|0)?(d=El(7,d-l|0)|0,d|0):(d=0,d|0)}function jr(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0,Y=0;if(M=St(l|0,h|0,52)|0,Oe()|0,M=M&15,!!((d|0)<16&(M|0)<=(d|0))){if((M|0)==(d|0)){d=x,o[d>>2]=l,o[d+4>>2]=h;return}if(V=El(7,d-M|0)|0,$=(V|0)/7|0,B=St(l|0,h|0,45)|0,Oe()|0,!(Jt(B&127)|0))S=0;else{e:do if(!M)b=0;else for(S=1;;){if(b=St(l|0,h|0,(15-S|0)*3|0)|0,Oe()|0,b=b&7,b|0)break e;if(S>>>0<M>>>0)S=S+1|0;else{b=0;break}}while(0);S=(b|0)==0}if(Y=Ct(M+1|0,0,52)|0,b=Oe()|0|h&-15728641,B=(14-M|0)*3|0,h=Ct(7,0,B|0)|0,h=(Y|l)&~h,M=b&~(Oe()|0),jr(h,M,d,x),b=x+($<<3)|0,!S){Y=Ct(1,0,B|0)|0,jr(Y|h,Oe()|0|M,d,b),Y=b+($<<3)|0,V=Ct(2,0,B|0)|0,jr(V|h,Oe()|0|M,d,Y),Y=Y+($<<3)|0,V=Ct(3,0,B|0)|0,jr(V|h,Oe()|0|M,d,Y),Y=Y+($<<3)|0,V=Ct(4,0,B|0)|0,jr(V|h,Oe()|0|M,d,Y),Y=Y+($<<3)|0,V=Ct(5,0,B|0)|0,jr(V|h,Oe()|0|M,d,Y),V=Ct(6,0,B|0)|0,jr(V|h,Oe()|0|M,d,Y+($<<3)|0);return}S=b+($<<3)|0,(V|0)>6&&(V=b+8|0,Y=(S>>>0>V>>>0?S:V)+-1+(0-b)|0,k(b|0,0,Y+8&-8|0)|0,b=V+(Y>>>3<<3)|0),Y=Ct(2,0,B|0)|0,jr(Y|h,Oe()|0|M,d,b),Y=b+($<<3)|0,V=Ct(3,0,B|0)|0,jr(V|h,Oe()|0|M,d,Y),Y=Y+($<<3)|0,V=Ct(4,0,B|0)|0,jr(V|h,Oe()|0|M,d,Y),Y=Y+($<<3)|0,V=Ct(5,0,B|0)|0,jr(V|h,Oe()|0|M,d,Y),V=Ct(6,0,B|0)|0,jr(V|h,Oe()|0|M,d,Y+($<<3)|0)}}function Pr(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;if(b=St(l|0,h|0,45)|0,Oe()|0,!(Jt(b&127)|0))return b=0,b|0;b=St(l|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!b)d=0;else for(x=1;;){if(d=St(l|0,h|0,(15-x|0)*3|0)|0,Oe()|0,d=d&7,d|0)break e;if(x>>>0<b>>>0)x=x+1|0;else{d=0;break}}while(0);return b=(d|0)==0&1,b|0}function Kr(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,(d|0)<16&(x|0)<=(d|0)){if((x|0)!=(d|0)&&(b=Ct(d|0,0,52)|0,l=b|l,h=Oe()|0|h&-15728641,(x|0)<(d|0)))do b=Ct(7,0,(14-x|0)*3|0)|0,x=x+1|0,l=l&~b,h=h&~(Oe()|0);while((x|0)<(d|0))}else h=0,l=0;return Ot(h|0),l|0}function ZA(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,m=0,g=0,v=0,E=0;if(!d)return v=0,v|0;if(b=l,x=o[b>>2]|0,b=o[b+4>>2]|0,!0&(b&15728640|0)==0){if((d|0)<=0||(v=h,o[v>>2]=x,o[v+4>>2]=b,(d|0)==1))return v=0,v|0;x=1;do m=l+(x<<3)|0,g=o[m+4>>2]|0,v=h+(x<<3)|0,o[v>>2]=o[m>>2],o[v+4>>2]=g,x=x+1|0;while((x|0)!=(d|0));return x=0,x|0}if(m=d<<3,g=Yt(m)|0,!g)return v=-3,v|0;if(Fs(g|0,l|0,m|0)|0,xe=$i(d,8)|0,!xe)return cn(g),v=-3,v|0;x=d;e:for(;;){M=g,Y=o[M>>2]|0,M=o[M+4>>2]|0,Te=St(Y|0,M|0,52)|0,Oe()|0,Te=Te&15,Ve=Te+-1|0,Ge=(x|0)>0;t:do if(Ge){if(ve=((x|0)<0)<<31>>31,be=Ct(Ve|0,0,52)|0,Ce=Oe()|0,Ve>>>0>15)for(b=0,l=Y,d=M;;){if(!((l|0)==0&(d|0)==0)){if(S=St(l|0,d|0,52)|0,Oe()|0,S=S&15,B=(S|0)<(Ve|0),S=(S|0)==(Ve|0),$=B?0:S?l:0,l=B?0:S?d:0,d=Os($|0,l|0,x|0,ve|0)|0,Oe()|0,S=xe+(d<<3)|0,B=S,V=o[B>>2]|0,B=o[B+4>>2]|0,(V|0)==0&(B|0)==0)d=$;else for(be=0,ue=d,te=B,d=$;;){if((be|0)>(x|0)){v=41;break e}if((V|0)==(d|0)&(te&-117440513|0)==(l|0)){$=St(V|0,te|0,56)|0,Oe()|0,$=$&7,oe=$+1|0,Ce=St(V|0,te|0,45)|0,Oe()|0;n:do if(!(Jt(Ce&127)|0))B=7;else{if(V=St(V|0,te|0,52)|0,Oe()|0,V=V&15,!V){B=6;break}for(B=1;;){if(Ce=Ct(7,0,(15-B|0)*3|0)|0,!((Ce&d|0)==0&((Oe()|0)&l|0)==0)){B=7;break n}if(B>>>0<V>>>0)B=B+1|0;else{B=6;break}}}while(0);if(($+2|0)>>>0>B>>>0){v=51;break e}Ce=Ct(oe|0,0,56)|0,l=Oe()|0|l&-117440513,B=S,o[B>>2]=0,o[B+4>>2]=0,B=ue,d=Ce|d}else B=(ue+1|0)%(x|0)|0;if(S=xe+(B<<3)|0,te=S,V=o[te>>2]|0,te=o[te+4>>2]|0,(V|0)==0&(te|0)==0)break;be=be+1|0,ue=B}Ce=S,o[Ce>>2]=d,o[Ce+4>>2]=l}if(b=b+1|0,(b|0)>=(x|0))break t;d=g+(b<<3)|0,l=o[d>>2]|0,d=o[d+4>>2]|0}for(b=0,l=Y,d=M;;){if(!((l|0)==0&(d|0)==0)){if(B=St(l|0,d|0,52)|0,Oe()|0,B=B&15,(B|0)>=(Ve|0)){if((B|0)!=(Ve|0)&&(l=l|be,d=d&-15728641|Ce,B>>>0>=Te>>>0)){S=Ve;do ue=Ct(7,0,(14-S|0)*3|0)|0,S=S+1|0,l=ue|l,d=Oe()|0|d;while(S>>>0<B>>>0)}}else l=0,d=0;if(B=Os(l|0,d|0,x|0,ve|0)|0,Oe()|0,S=xe+(B<<3)|0,V=S,$=o[V>>2]|0,V=o[V+4>>2]|0,!(($|0)==0&(V|0)==0))for(ue=0;;){if((ue|0)>(x|0)){v=41;break e}if(($|0)==(l|0)&(V&-117440513|0)==(d|0)){oe=St($|0,V|0,56)|0,Oe()|0,oe=oe&7,te=oe+1|0,E=St($|0,V|0,45)|0,Oe()|0;n:do if(!(Jt(E&127)|0))V=7;else{if($=St($|0,V|0,52)|0,Oe()|0,$=$&15,!$){V=6;break}for(V=1;;){if(E=Ct(7,0,(15-V|0)*3|0)|0,!((E&l|0)==0&((Oe()|0)&d|0)==0)){V=7;break n}if(V>>>0<$>>>0)V=V+1|0;else{V=6;break}}}while(0);if((oe+2|0)>>>0>V>>>0){v=51;break e}E=Ct(te|0,0,56)|0,d=Oe()|0|d&-117440513,te=S,o[te>>2]=0,o[te+4>>2]=0,l=E|l}else B=(B+1|0)%(x|0)|0;if(S=xe+(B<<3)|0,V=S,$=o[V>>2]|0,V=o[V+4>>2]|0,($|0)==0&(V|0)==0)break;ue=ue+1|0}E=S,o[E>>2]=l,o[E+4>>2]=d}if(b=b+1|0,(b|0)>=(x|0))break t;d=g+(b<<3)|0,l=o[d>>2]|0,d=o[d+4>>2]|0}}while(0);if((x+5|0)>>>0<11){v=99;break}if(Ce=$i((x|0)/6|0,8)|0,!Ce){v=58;break}t:do if(Ge){ue=0,te=0;do{if(B=xe+(ue<<3)|0,l=B,b=o[l>>2]|0,l=o[l+4>>2]|0,!((b|0)==0&(l|0)==0)){V=St(b|0,l|0,56)|0,Oe()|0,V=V&7,d=V+1|0,$=l&-117440513,E=St(b|0,l|0,45)|0,Oe()|0;n:do if(Jt(E&127)|0){if(oe=St(b|0,l|0,52)|0,Oe()|0,oe=oe&15,oe|0)for(S=1;;){if(E=Ct(7,0,(15-S|0)*3|0)|0,!((b&E|0)==0&($&(Oe()|0)|0)==0))break n;if(S>>>0<oe>>>0)S=S+1|0;else break}l=Ct(d|0,0,56)|0,b=l|b,l=Oe()|0|$,d=B,o[d>>2]=b,o[d+4>>2]=l,d=V+2|0}while(0);(d|0)==7&&(E=Ce+(te<<3)|0,o[E>>2]=b,o[E+4>>2]=l&-117440513,te=te+1|0)}ue=ue+1|0}while((ue|0)!=(x|0));if(Ge){if(be=((x|0)<0)<<31>>31,oe=Ct(Ve|0,0,52)|0,ue=Oe()|0,Ve>>>0>15)for(l=0,b=0;;){do if(!((Y|0)==0&(M|0)==0)){for(V=St(Y|0,M|0,52)|0,Oe()|0,V=V&15,S=(V|0)<(Ve|0),V=(V|0)==(Ve|0),B=S?0:V?Y:0,V=S?0:V?M:0,S=Os(B|0,V|0,x|0,be|0)|0,Oe()|0,d=0;;){if((d|0)>(x|0)){v=98;break e}if(E=xe+(S<<3)|0,$=o[E+4>>2]|0,($&-117440513|0)==(V|0)&&(o[E>>2]|0)==(B|0)){v=70;break}if(S=(S+1|0)%(x|0)|0,E=xe+(S<<3)|0,(o[E>>2]|0)==(B|0)&&(o[E+4>>2]|0)==(V|0))break;d=d+1|0}if((v|0)==70&&(v=0,!0&($&117440512|0)==100663296))break;E=h+(b<<3)|0,o[E>>2]=Y,o[E+4>>2]=M,b=b+1|0}while(0);if(l=l+1|0,(l|0)>=(x|0)){x=te;break t}M=g+(l<<3)|0,Y=o[M>>2]|0,M=o[M+4>>2]|0}for(l=0,b=0;;){do if(!((Y|0)==0&(M|0)==0)){if(V=St(Y|0,M|0,52)|0,Oe()|0,V=V&15,(V|0)>=(Ve|0))if((V|0)!=(Ve|0))if(d=Y|oe,S=M&-15728641|ue,V>>>0<Te>>>0)V=S;else{B=Ve;do E=Ct(7,0,(14-B|0)*3|0)|0,B=B+1|0,d=E|d,S=Oe()|0|S;while(B>>>0<V>>>0);V=S}else d=Y,V=M;else d=0,V=0;for(B=Os(d|0,V|0,x|0,be|0)|0,Oe()|0,S=0;;){if((S|0)>(x|0)){v=98;break e}if(E=xe+(B<<3)|0,$=o[E+4>>2]|0,($&-117440513|0)==(V|0)&&(o[E>>2]|0)==(d|0)){v=93;break}if(B=(B+1|0)%(x|0)|0,E=xe+(B<<3)|0,(o[E>>2]|0)==(d|0)&&(o[E+4>>2]|0)==(V|0))break;S=S+1|0}if((v|0)==93&&(v=0,!0&($&117440512|0)==100663296))break;E=h+(b<<3)|0,o[E>>2]=Y,o[E+4>>2]=M,b=b+1|0}while(0);if(l=l+1|0,(l|0)>=(x|0)){x=te;break t}M=g+(l<<3)|0,Y=o[M>>2]|0,M=o[M+4>>2]|0}}else b=0,x=te}else b=0,x=0;while(0);if(k(xe|0,0,m|0)|0,Fs(g|0,Ce|0,x<<3|0)|0,cn(Ce),x)h=h+(b<<3)|0;else break}return(v|0)==41?(cn(g),cn(xe),E=-1,E|0):(v|0)==51?(cn(g),cn(xe),E=-2,E|0):(v|0)==58?(cn(g),cn(xe),E=-3,E|0):(v|0)==98?(cn(Ce),cn(g),cn(xe),E=-1,E|0):((v|0)==99&&Fs(h|0,g|0,x<<3|0)|0,cn(g),cn(xe),E=0,E|0)}function Ls(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,Y=0;if((h|0)<=0)return b=0,b|0;if((b|0)>=16){for(S=0;;){if(Y=l+(S<<3)|0,!((o[Y>>2]|0)==0&(o[Y+4>>2]|0)==0)){S=14;break}if(S=S+1|0,(S|0)>=(h|0)){M=0,S=16;break}}if((S|0)==14)return((x|0)>0?-2:-1)|0;if((S|0)==16)return M|0}S=0,Y=0;e:for(;;){$=l+(Y<<3)|0,B=$,M=o[B>>2]|0,B=o[B+4>>2]|0;do if(!((M|0)==0&(B|0)==0)){if((S|0)>=(x|0)){M=-1,S=16;break e}if(V=St(M|0,B|0,52)|0,Oe()|0,V=V&15,(V|0)>(b|0)){M=-2,S=16;break e}if((V|0)==(b|0)){$=d+(S<<3)|0,o[$>>2]=M,o[$+4>>2]=B,S=S+1|0;break}if(M=(El(7,b-V|0)|0)+S|0,(M|0)>(x|0)){M=-1,S=16;break e}jr(o[$>>2]|0,o[$+4>>2]|0,b,d+(S<<3)|0),S=M}while(0);if(Y=Y+1|0,(Y|0)>=(h|0)){M=0,S=16;break}}return(S|0)==16?M|0:0}function Ju(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if((h|0)<=0)return d=0,d|0;if((d|0)>=16){for(x=0;;){if(M=l+(x<<3)|0,!((o[M>>2]|0)==0&(o[M+4>>2]|0)==0)){x=-1,b=13;break}if(x=x+1|0,(x|0)>=(h|0)){x=0,b=13;break}}if((b|0)==13)return x|0}x=0,M=0;e:for(;;){b=l+(M<<3)|0,S=o[b>>2]|0,b=o[b+4>>2]|0;do if(!((S|0)==0&(b|0)==0)){if(b=St(S|0,b|0,52)|0,Oe()|0,b=b&15,(b|0)>(d|0)){x=-1,b=13;break e}if((b|0)==(d|0)){x=x+1|0;break}else{x=(El(7,d-b|0)|0)+x|0;break}}while(0);if(M=M+1|0,(M|0)>=(h|0)){b=13;break}}return(b|0)==13?x|0:0}function cA(l,h){return l=l|0,h=h|0,h=St(l|0,h|0,52)|0,Oe()|0,h&1|0}function si(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;if(b=St(l|0,h|0,52)|0,Oe()|0,b=b&15,!b)return b=0,b|0;for(x=1;;){if(d=St(l|0,h|0,(15-x|0)*3|0)|0,Oe()|0,d=d&7,d|0){x=5;break}if(x>>>0<b>>>0)x=x+1|0;else{d=0,x=5;break}}return(x|0)==5?d|0:0}function gi(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(V=St(l|0,h|0,52)|0,Oe()|0,V=V&15,!V)return B=h,V=l,Ot(B|0),V|0;for(B=1,d=0;;){S=(15-B|0)*3|0,x=Ct(7,0,S|0)|0,b=Oe()|0,M=St(l|0,h|0,S|0)|0,Oe()|0,S=Ct(Oi(M&7)|0,0,S|0)|0,M=Oe()|0,l=S|l&~x,h=M|h&~b;e:do if(!d)if((S&x|0)==0&(M&b|0)==0)d=0;else if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)d=1;else{d=1;t:for(;;){switch(M=St(l|0,h|0,(15-d|0)*3|0)|0,Oe()|0,M&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<x>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(M=(15-d|0)*3|0,b=St(l|0,h|0,M|0)|0,Oe()|0,S=Ct(7,0,M|0)|0,h=h&~(Oe()|0),M=Ct(Oi(b&7)|0,0,M|0)|0,l=l&~S|M,h=h|(Oe()|0),d>>>0<x>>>0)d=d+1|0;else{d=1;break}}while(0);if(B>>>0<V>>>0)B=B+1|0;else break}return Ot(h|0),l|0}function ns(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)return d=h,x=l,Ot(d|0),x|0;for(d=1;S=(15-d|0)*3|0,M=St(l|0,h|0,S|0)|0,Oe()|0,b=Ct(7,0,S|0)|0,h=h&~(Oe()|0),S=Ct(Oi(M&7)|0,0,S|0)|0,l=S|l&~b,h=Oe()|0|h,d>>>0<x>>>0;)d=d+1|0;return Ot(h|0),l|0}function aa(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(V=St(l|0,h|0,52)|0,Oe()|0,V=V&15,!V)return B=h,V=l,Ot(B|0),V|0;for(B=1,d=0;;){S=(15-B|0)*3|0,x=Ct(7,0,S|0)|0,b=Oe()|0,M=St(l|0,h|0,S|0)|0,Oe()|0,S=Ct(Fi(M&7)|0,0,S|0)|0,M=Oe()|0,l=S|l&~x,h=M|h&~b;e:do if(!d)if((S&x|0)==0&(M&b|0)==0)d=0;else if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)d=1;else{d=1;t:for(;;){switch(M=St(l|0,h|0,(15-d|0)*3|0)|0,Oe()|0,M&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<x>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(b=(15-d|0)*3|0,S=Ct(7,0,b|0)|0,M=h&~(Oe()|0),h=St(l|0,h|0,b|0)|0,Oe()|0,h=Ct(Fi(h&7)|0,0,b|0)|0,l=l&~S|h,h=M|(Oe()|0),d>>>0<x>>>0)d=d+1|0;else{d=1;break}}while(0);if(B>>>0<V>>>0)B=B+1|0;else break}return Ot(h|0),l|0}function Gi(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)return d=h,x=l,Ot(d|0),x|0;for(d=1;M=(15-d|0)*3|0,S=Ct(7,0,M|0)|0,b=h&~(Oe()|0),h=St(l|0,h|0,M|0)|0,Oe()|0,h=Ct(Fi(h&7)|0,0,M|0)|0,l=h|l&~S,h=Oe()|0|b,d>>>0<x>>>0;)d=d+1|0;return Ot(h|0),l|0}function co(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0;if(V=De,De=De+64|0,B=V+40|0,x=V+24|0,b=V+12|0,S=V,Ct(h|0,0,52)|0,d=Oe()|0|134225919,!h)return(o[l+4>>2]|0)>2||(o[l+8>>2]|0)>2||(o[l+12>>2]|0)>2?(M=0,B=0,Ot(M|0),De=V,B|0):(Ct(Vn(l)|0,0,45)|0,M=Oe()|0|d,B=-1,Ot(M|0),De=V,B|0);if(o[B>>2]=o[l>>2],o[B+4>>2]=o[l+4>>2],o[B+8>>2]=o[l+8>>2],o[B+12>>2]=o[l+12>>2],M=B+4|0,(h|0)>0)for(l=-1;o[x>>2]=o[M>>2],o[x+4>>2]=o[M+4>>2],o[x+8>>2]=o[M+8>>2],h&1?(fl(M),o[b>>2]=o[M>>2],o[b+4>>2]=o[M+4>>2],o[b+8>>2]=o[M+8>>2],ra(b)):(Do(M),o[b>>2]=o[M>>2],o[b+4>>2]=o[M+4>>2],o[b+8>>2]=o[M+8>>2],lo(b)),ps(x,b,S),Gr(S),Y=(15-h|0)*3|0,$=Ct(7,0,Y|0)|0,d=d&~(Oe()|0),Y=Ct(ao(S)|0,0,Y|0)|0,l=Y|l&~$,d=Oe()|0|d,(h|0)>1;)h=h+-1|0;else l=-1;e:do if((o[M>>2]|0)<=2&&(o[B+8>>2]|0)<=2&&(o[B+12>>2]|0)<=2){if(x=Vn(B)|0,h=Ct(x|0,0,45)|0,h=h|l,l=Oe()|0|d&-1040385,S=nA(B)|0,!(Jt(x)|0)){if((S|0)<=0)break;for(b=0;;){if(x=St(h|0,l|0,52)|0,Oe()|0,x=x&15,x)for(d=1;Y=(15-d|0)*3|0,B=St(h|0,l|0,Y|0)|0,Oe()|0,$=Ct(7,0,Y|0)|0,l=l&~(Oe()|0),Y=Ct(Oi(B&7)|0,0,Y|0)|0,h=h&~$|Y,l=l|(Oe()|0),d>>>0<x>>>0;)d=d+1|0;if(b=b+1|0,(b|0)==(S|0))break e}}b=St(h|0,l|0,52)|0,Oe()|0,b=b&15;t:do if(b){d=1;n:for(;;){switch(Y=St(h|0,l|0,(15-d|0)*3|0)|0,Oe()|0,Y&7){case 1:break n;case 0:break;default:break t}if(d>>>0<b>>>0)d=d+1|0;else break t}if(FA(x,o[B>>2]|0)|0)for(d=1;B=(15-d|0)*3|0,$=Ct(7,0,B|0)|0,Y=l&~(Oe()|0),l=St(h|0,l|0,B|0)|0,Oe()|0,l=Ct(Fi(l&7)|0,0,B|0)|0,h=h&~$|l,l=Y|(Oe()|0),d>>>0<b>>>0;)d=d+1|0;else for(d=1;Y=(15-d|0)*3|0,B=St(h|0,l|0,Y|0)|0,Oe()|0,$=Ct(7,0,Y|0)|0,l=l&~(Oe()|0),Y=Ct(Oi(B&7)|0,0,Y|0)|0,h=h&~$|Y,l=l|(Oe()|0),d>>>0<b>>>0;)d=d+1|0}while(0);if((S|0)>0){d=0;do h=gi(h,l)|0,l=Oe()|0,d=d+1|0;while((d|0)!=(S|0))}}else h=0,l=0;while(0);return $=l,Y=h,Ot($|0),De=V,Y|0}function Ai(l){return l=l|0,(l|0)%2|0|0}function Oa(l,h){l=l|0,h=h|0;var d=0,x=0;return x=De,De=De+16|0,d=x,h>>>0<=15&&(o[l+4>>2]&2146435072|0)!=2146435072&&(o[l+8+4>>2]&2146435072|0)!=2146435072?(AA(l,h,d),h=co(d,h)|0,l=Oe()|0):(l=0,h=0),Ot(l|0),De=x,h|0}function xl(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if(b=d+4|0,S=St(l|0,h|0,52)|0,Oe()|0,S=S&15,M=St(l|0,h|0,45)|0,Oe()|0,x=(S|0)==0,Jt(M&127)|0){if(x)return M=1,M|0;x=1}else{if(x)return M=0,M|0;!(o[b>>2]|0)&&!(o[d+8>>2]|0)?x=(o[d+12>>2]|0)!=0&1:x=1}for(d=1;d&1?ra(b):lo(b),M=St(l|0,h|0,(15-d|0)*3|0)|0,Oe()|0,lA(b,M&7),d>>>0<S>>>0;)d=d+1|0;return x|0}function Fa(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0;Y=De,De=De+16|0,V=Y,$=St(l|0,h|0,45)|0,Oe()|0,$=$&127;e:do if(Jt($)|0&&(S=St(l|0,h|0,52)|0,Oe()|0,S=S&15,(S|0)!=0)){x=1;t:for(;;){switch(B=St(l|0,h|0,(15-x|0)*3|0)|0,Oe()|0,B&7){case 5:break t;case 0:break;default:{x=h;break e}}if(x>>>0<S>>>0)x=x+1|0;else{x=h;break e}}for(b=1,x=h;h=(15-b|0)*3|0,M=Ct(7,0,h|0)|0,B=x&~(Oe()|0),x=St(l|0,x|0,h|0)|0,Oe()|0,x=Ct(Fi(x&7)|0,0,h|0)|0,l=l&~M|x,x=B|(Oe()|0),b>>>0<S>>>0;)b=b+1|0}else x=h;while(0);if(B=7728+($*28|0)|0,o[d>>2]=o[B>>2],o[d+4>>2]=o[B+4>>2],o[d+8>>2]=o[B+8>>2],o[d+12>>2]=o[B+12>>2],!(xl(l,x,d)|0)){De=Y;return}if(M=d+4|0,o[V>>2]=o[M>>2],o[V+4>>2]=o[M+4>>2],o[V+8>>2]=o[M+8>>2],S=St(l|0,x|0,52)|0,Oe()|0,B=S&15,S&1?(lo(M),S=B+1|0):S=B,!(Jt($)|0))x=0;else{e:do if(!B)x=0;else for(h=1;;){if(b=St(l|0,x|0,(15-h|0)*3|0)|0,Oe()|0,b=b&7,b|0){x=b;break e}if(h>>>0<B>>>0)h=h+1|0;else{x=0;break}}while(0);x=(x|0)==4&1}if(!(uo(d,S,x,0)|0))(S|0)!=(B|0)&&(o[M>>2]=o[V>>2],o[M+4>>2]=o[V+4>>2],o[M+8>>2]=o[V+8>>2]);else{if(Jt($)|0)do;while(uo(d,S,0,0)|0);(S|0)!=(B|0)&&Do(M)}De=Y}function Ds(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;x=De,De=De+16|0,b=x,Fa(l,h,b),h=St(l|0,h|0,52)|0,Oe()|0,Ra(b,h&15,d),De=x}function rs(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0;M=De,De=De+16|0,S=M,Fa(l,h,S),x=St(l|0,h|0,45)|0,Oe()|0,x=(Jt(x&127)|0)==0,b=St(l|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!x){if(b|0)for(x=1;;){if(B=Ct(7,0,(15-x|0)*3|0)|0,!((B&l|0)==0&((Oe()|0)&h|0)==0))break e;if(x>>>0<b>>>0)x=x+1|0;else break}$A(S,b,0,5,d),De=M;return}while(0);WA(S,b,0,6,d),De=M}function ec(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;if(x=St(l|0,h|0,45)|0,Oe()|0,!(Jt(x&127)|0))return x=2,x|0;if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)return x=5,x|0;for(d=1;;){if(b=Ct(7,0,(15-d|0)*3|0)|0,!((b&l|0)==0&((Oe()|0)&h|0)==0)){d=2,l=6;break}if(d>>>0<x>>>0)d=d+1|0;else{d=5,l=6;break}}return(l|0)==6?d|0:0}function la(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0;oe=De,De=De+128|0,$=oe+112|0,S=oe+96|0,Y=oe,b=St(l|0,h|0,52)|0,Oe()|0,B=b&15,o[$>>2]=B,M=St(l|0,h|0,45)|0,Oe()|0,M=M&127;e:do if(Jt(M)|0){if(B|0)for(x=1;;){if(V=Ct(7,0,(15-x|0)*3|0)|0,!((V&l|0)==0&((Oe()|0)&h|0)==0)){b=0;break e}if(x>>>0<B>>>0)x=x+1|0;else break}if(b&1)b=1;else{V=Ct(B+1|0,0,52)|0,Y=Oe()|0|h&-15728641,$=Ct(7,0,(14-B|0)*3|0)|0,la((V|l)&~$,Y&~(Oe()|0),d),De=oe;return}}else b=0;while(0);Fa(l,h,S),b?(HA(S,$,Y),V=5):(sa(S,$,Y),V=6);e:do if(Jt(M)|0)if(!B)x=20;else for(x=1;;){if(M=Ct(7,0,(15-x|0)*3|0)|0,!((M&l|0)==0&((Oe()|0)&h|0)==0)){x=8;break e}if(x>>>0<B>>>0)x=x+1|0;else{x=20;break}}else x=8;while(0);if(k(d|0,-1,x|0)|0,b){b=0;do{for(S=Y+(b<<4)|0,ia(S,o[$>>2]|0)|0,S=o[S>>2]|0,x=0;M=d+(x<<2)|0,B=o[M>>2]|0,!((B|0)==-1|(B|0)==(S|0));)x=x+1|0;o[M>>2]=S,b=b+1|0}while((b|0)!=(V|0))}else{b=0;do{for(S=Y+(b<<4)|0,uo(S,o[$>>2]|0,0,1)|0,S=o[S>>2]|0,x=0;M=d+(x<<2)|0,B=o[M>>2]|0,!((B|0)==-1|(B|0)==(S|0));)x=x+1|0;o[M>>2]=S,b=b+1|0}while((b|0)!=(V|0))}De=oe}function Na(){return 12}function Jr(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(Ct(l|0,0,52)|0,B=Oe()|0|134225919,(l|0)<1){x=0,d=0;do Jt(x)|0&&(Ct(x|0,0,45)|0,M=B|(Oe()|0),l=h+(d<<3)|0,o[l>>2]=-1,o[l+4>>2]=M,d=d+1|0),x=x+1|0;while((x|0)!=122);return}M=0,d=0;do{if(Jt(M)|0){for(Ct(M|0,0,45)|0,x=1,b=-1,S=B|(Oe()|0);V=Ct(7,0,(15-x|0)*3|0)|0,b=b&~V,S=S&~(Oe()|0),(x|0)!=(l|0);)x=x+1|0;V=h+(d<<3)|0,o[V>>2]=b,o[V+4>>2]=S,d=d+1|0}M=M+1|0}while((M|0)!=122)}function gs(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0;if(B=De,De=De+64|0,M=B,(l|0)==(d|0)&(h|0)==(x|0)|(!1|(h&2013265920|0)!=134217728|(!1|(x&2013265920|0)!=134217728))||(b=St(l|0,h|0,52)|0,Oe()|0,b=b&15,S=St(d|0,x|0,52)|0,Oe()|0,(b|0)!=(S&15|0)))return M=0,De=B,M|0;if(S=b+-1|0,b>>>0>1&&($=vl(l,h,S)|0,V=Oe()|0,S=vl(d,x,S)|0,($|0)==(S|0)&(V|0)==(Oe()|0))&&(S=(b^15)*3|0,b=St(l|0,h|0,S|0)|0,Oe()|0,b=b&7,S=St(d|0,x|0,S|0)|0,Oe()|0,S=S&7,(b|0)==0|(S|0)==0||(o[21136+(b<<2)>>2]|0)==(S|0)||(o[21168+(b<<2)>>2]|0)==(S|0)))return $=1,De=B,$|0;b=M,S=b+56|0;do o[b>>2]=0,b=b+4|0;while((b|0)<(S|0));return ta(l,h,1,M),$=M,!((o[$>>2]|0)==(d|0)&&(o[$+4>>2]|0)==(x|0))&&($=M+8|0,!((o[$>>2]|0)==(d|0)&&(o[$+4>>2]|0)==(x|0)))&&($=M+16|0,!((o[$>>2]|0)==(d|0)&&(o[$+4>>2]|0)==(x|0)))&&($=M+24|0,!((o[$>>2]|0)==(d|0)&&(o[$+4>>2]|0)==(x|0)))&&($=M+32|0,!((o[$>>2]|0)==(d|0)&&(o[$+4>>2]|0)==(x|0)))&&($=M+40|0,!((o[$>>2]|0)==(d|0)&&(o[$+4>>2]|0)==(x|0)))?(b=M+48|0,b=((o[b>>2]|0)==(d|0)?(o[b+4>>2]|0)==(x|0):0)&1):b=1,$=b,De=B,$|0}function ji(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0,Y=0;if($=De,De=De+16|0,M=$,!(gs(l,h,d,x)|0))return B=0,V=0,Ot(B|0),De=$,V|0;for(B=h&-2130706433,b=(Pr(l,h)|0)==0,b=b?1:2;o[M>>2]=0,Y=ge(l,h,b,M)|0,S=b+1|0,!((Y|0)==(d|0)&(Oe()|0)==(x|0));)if(S>>>0<7)b=S;else{b=0,l=0,V=6;break}return(V|0)==6?(Ot(b|0),De=$,l|0):(Y=Ct(b|0,0,56)|0,V=B|(Oe()|0)|268435456,Y=l|Y,Ot(V|0),De=$,Y|0)}function wl(l,h){l=l|0,h=h|0;var d=0;return d=!0&(h&2013265920|0)==268435456,Ot((d?h&-2130706433|134217728:0)|0),(d?l:0)|0}function Fo(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;return x=De,De=De+16|0,d=x,!0&(h&2013265920|0)==268435456?(b=St(l|0,h|0,56)|0,Oe()|0,o[d>>2]=0,d=ge(l,h&-2130706433|134217728,b&7,d)|0,h=Oe()|0,Ot(h|0),De=x,d|0):(h=0,d=0,Ot(h|0),De=x,d|0)}function tc(l,h){l=l|0,h=h|0;var d=0;if(!(!0&(h&2013265920|0)==268435456))return d=0,d|0;switch(d=St(l|0,h|0,56)|0,Oe()|0,d&7){case 0:case 7:return d=0,d|0}return d=h&-2130706433|134217728,!0&(h&117440512|0)==16777216&(Pr(l,d)|0)!=0?(d=0,d|0):(d=qA(l,d)|0,d|0)}function ho(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0;S=De,De=De+16|0,x=S,M=!0&(h&2013265920|0)==268435456,b=h&-2130706433|134217728,B=d,o[B>>2]=M?l:0,o[B+4>>2]=M?b:0,M?(h=St(l|0,h|0,56)|0,Oe()|0,o[x>>2]=0,l=ge(l,b,h&7,x)|0,h=Oe()|0):(l=0,h=0),B=d+8|0,o[B>>2]=l,o[B+4>>2]=h,De=S}function bl(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;b=(Pr(l,h)|0)==0,h=h&-2130706433,x=d,o[x>>2]=b?l:0,o[x+4>>2]=b?h|285212672:0,x=d+8|0,o[x>>2]=l,o[x+4>>2]=h|301989888,x=d+16|0,o[x>>2]=l,o[x+4>>2]=h|318767104,x=d+24|0,o[x>>2]=l,o[x+4>>2]=h|335544320,x=d+32|0,o[x>>2]=l,o[x+4>>2]=h|352321536,d=d+40|0,o[d>>2]=l,o[d+4>>2]=h|369098752}function Ua(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0;if(M=De,De=De+16|0,S=M,x=St(l|0,h|0,56)|0,Oe()|0,B=!0&(h&2013265920|0)==268435456,b=B?l:0,l=B?h&-2130706433|134217728:0,h=ss(b,l,x&7)|0,(h|0)==-1){o[d>>2]=0,De=M;return}Fa(b,l,S),x=St(b|0,l|0,52)|0,Oe()|0,x=x&15,Pr(b,l)|0?$A(S,x,h,2,d):WA(S,x,h,2,d),De=M}function Jc(l){l=l|0;var h=0,d=0,x=0;return h=$i(1,12)|0,h||Mt(22691,22646,49,22704),d=l+4|0,x=o[d>>2]|0,x|0?(x=x+8|0,o[x>>2]=h,o[d>>2]=h,h|0):(o[l>>2]|0&&Mt(22721,22646,61,22744),x=l,o[x>>2]=h,o[d>>2]=h,h|0)}function eh(l,h){l=l|0,h=h|0;var d=0,x=0;return x=Yt(24)|0,x||Mt(22758,22646,78,22772),o[x>>2]=o[h>>2],o[x+4>>2]=o[h+4>>2],o[x+8>>2]=o[h+8>>2],o[x+12>>2]=o[h+12>>2],o[x+16>>2]=0,h=l+4|0,d=o[h>>2]|0,d|0?(o[d+16>>2]=x,o[h>>2]=x,x|0):(o[l>>2]|0&&Mt(22787,22646,82,22772),o[l>>2]=x,o[h>>2]=x,x|0)}function Va(l){l=l|0;var h=0,d=0,x=0,b=0;if(l)for(x=1;;){if(h=o[l>>2]|0,h|0)do{if(d=o[h>>2]|0,d|0)do b=d,d=o[d+16>>2]|0,cn(b);while(d|0);b=h,h=o[h+8>>2]|0,cn(b)}while(h|0);if(h=l,l=o[l+8>>2]|0,x||cn(h),l)x=0;else break}}function Aa(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,m=0,g=0,v=0,E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0;if(b=l+8|0,o[b>>2]|0)return de=1,de|0;if(x=o[l>>2]|0,!x)return de=0,de|0;h=x,d=0;do d=d+1|0,h=o[h+8>>2]|0;while(h|0);if(d>>>0<2)return de=0,de|0;J=Yt(d<<2)|0,J||Mt(22807,22646,317,22826),Q=Yt(d<<5)|0,Q||Mt(22848,22646,321,22826),o[l>>2]=0,g=l+4|0,o[g>>2]=0,o[b>>2]=0,d=0,N=0,m=0,oe=0;e:for(;;){if(Y=o[x>>2]|0,Y){S=0,M=Y;do{if(V=+G[M+8>>3],h=M,M=o[M+16>>2]|0,$=(M|0)==0,b=$?Y:M,B=+G[b+8>>3],+Pe(+(V-B))>3.141592653589793){de=14;break}S=S+(B-V)*(+G[h>>3]+ +G[b>>3])}while(!$);if((de|0)==14){de=0,S=0,h=Y;do xe=+G[h+8>>3],O=h+16|0,R=o[O>>2]|0,R=R|0?R:Y,Ve=+G[R+8>>3],S=S+(+G[h>>3]+ +G[R>>3])*((Ve<0?Ve+6.283185307179586:Ve)-(xe<0?xe+6.283185307179586:xe)),h=o[(h|0?O:x)>>2]|0;while(h|0)}S>0?(o[J+(N<<2)>>2]=x,N=N+1|0,b=m,h=oe):de=19}else de=19;if((de|0)==19){de=0;do if(d){if(h=d+8|0,o[h>>2]|0){de=21;break e}if(d=$i(1,12)|0,!d){de=23;break e}o[h>>2]=d,b=d+4|0,M=d,h=oe}else if(oe){b=g,M=oe+8|0,h=x,d=l;break}else if(o[l>>2]|0){de=27;break e}else{b=g,M=l,h=x,d=l;break}while(0);if(o[M>>2]=x,o[b>>2]=x,M=Q+(m<<5)|0,$=o[x>>2]|0,$){for(Y=Q+(m<<5)+8|0,G[Y>>3]=17976931348623157e292,oe=Q+(m<<5)+24|0,G[oe>>3]=17976931348623157e292,G[M>>3]=-17976931348623157e292,te=Q+(m<<5)+16|0,G[te>>3]=-17976931348623157e292,Ge=17976931348623157e292,Te=-17976931348623157e292,b=0,ue=$,V=17976931348623157e292,Ce=17976931348623157e292,ve=-17976931348623157e292,B=-17976931348623157e292;S=+G[ue>>3],xe=+G[ue+8>>3],ue=o[ue+16>>2]|0,be=(ue|0)==0,Ve=+G[(be?$:ue)+8>>3],S<V&&(G[Y>>3]=S,V=S),xe<Ce&&(G[oe>>3]=xe,Ce=xe),S>ve?G[M>>3]=S:S=ve,xe>B&&(G[te>>3]=xe,B=xe),Ge=xe>0&xe<Ge?xe:Ge,Te=xe<0&xe>Te?xe:Te,b=b|+Pe(+(xe-Ve))>3.141592653589793,!be;)ve=S;b&&(G[te>>3]=Te,G[oe>>3]=Ge)}else o[M>>2]=0,o[M+4>>2]=0,o[M+8>>2]=0,o[M+12>>2]=0,o[M+16>>2]=0,o[M+20>>2]=0,o[M+24>>2]=0,o[M+28>>2]=0;b=m+1|0}if(O=x+8|0,x=o[O>>2]|0,o[O>>2]=0,x)m=b,oe=h;else{de=45;break}}if((de|0)==21)Mt(22624,22646,35,22658);else if((de|0)==23)Mt(22678,22646,37,22658);else if((de|0)==27)Mt(22721,22646,61,22744);else if((de|0)==45){e:do if((N|0)>0){for(O=(b|0)==0,C=b<<2,R=(l|0)==0,E=0,h=0;;){if(v=o[J+(E<<2)>>2]|0,O)de=73;else{if(m=Yt(C)|0,!m){de=50;break}if(g=Yt(C)|0,!g){de=52;break}t:do if(R)d=0;else{for(b=0,d=0,M=l;x=Q+(b<<5)|0,is(o[M>>2]|0,x,o[v>>2]|0)|0?(o[m+(d<<2)>>2]=M,o[g+(d<<2)>>2]=x,be=d+1|0):be=d,M=o[M+8>>2]|0,M;)b=b+1|0,d=be;if((be|0)>0)if(x=o[m>>2]|0,(be|0)==1)d=x;else for(te=0,ue=-1,d=x,oe=x;;){for($=o[oe>>2]|0,x=0,M=0;b=o[o[m+(M<<2)>>2]>>2]|0,(b|0)==($|0)?Y=x:Y=x+((is(b,o[g+(M<<2)>>2]|0,o[$>>2]|0)|0)&1)|0,M=M+1|0,(M|0)!=(be|0);)x=Y;if(b=(Y|0)>(ue|0),d=b?oe:d,x=te+1|0,(x|0)==(be|0))break t;te=x,ue=b?Y:ue,oe=o[m+(x<<2)>>2]|0}else d=0}while(0);if(cn(m),cn(g),d){if(b=d+4|0,x=o[b>>2]|0,x)d=x+8|0;else if(o[d>>2]|0){de=70;break}o[d>>2]=v,o[b>>2]=v}else de=73}if((de|0)==73){if(de=0,h=o[v>>2]|0,h|0)do g=h,h=o[h+16>>2]|0,cn(g);while(h|0);cn(v),h=2}if(E=E+1|0,(E|0)>=(N|0)){le=h;break e}}(de|0)==50?Mt(22863,22646,249,22882):(de|0)==52?Mt(22901,22646,252,22882):(de|0)==70&&Mt(22721,22646,61,22744)}else le=0;while(0);return cn(J),cn(Q),de=le,de|0}return 0}function is(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0;if(!(aA(h,d)|0)||(h=oA(h)|0,$=+G[d>>3],x=+G[d+8>>3],x=h&x<0?x+6.283185307179586:x,l=o[l>>2]|0,!l))return l=0,l|0;if(h){h=0,d=l;e:for(;;){for(;M=+G[d>>3],V=+G[d+8>>3],d=d+16|0,Y=o[d>>2]|0,Y=Y|0?Y:l,S=+G[Y>>3],b=+G[Y+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!($<S|$>B);)if(d=o[d>>2]|0,!d){d=22;break e}if(V=b<0?b+6.283185307179586:b,M=M<0?M+6.283185307179586:M,x=M==x|V==x?x+-2220446049250313e-31:x,V=V+($-S)/(B-S)*(M-V),(V<0?V+6.283185307179586:V)>x&&(h=h^1),d=o[d>>2]|0,!d){d=22;break}}if((d|0)==22)return h|0}else{h=0,d=l;e:for(;;){for(;M=+G[d>>3],V=+G[d+8>>3],d=d+16|0,Y=o[d>>2]|0,Y=Y|0?Y:l,S=+G[Y>>3],b=+G[Y+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!($<S|$>B);)if(d=o[d>>2]|0,!d){d=22;break e}if(x=M==x|b==x?x+-2220446049250313e-31:x,b+($-S)/(B-S)*(M-b)>x&&(h=h^1),d=o[d>>2]|0,!d){d=22;break}}if((d|0)==22)return h|0}return 0}function Ft(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0;if(Te=De,De=De+32|0,Ge=Te+16|0,ve=Te,S=St(l|0,h|0,52)|0,Oe()|0,S=S&15,ue=St(d|0,x|0,52)|0,Oe()|0,(S|0)!=(ue&15|0))return Ge=1,De=Te,Ge|0;if($=St(l|0,h|0,45)|0,Oe()|0,$=$&127,Y=St(d|0,x|0,45)|0,Oe()|0,Y=Y&127,ue=($|0)!=(Y|0),ue){if(B=sA($,Y)|0,(B|0)==7)return Ge=2,De=Te,Ge|0;V=sA(Y,$)|0,(V|0)==7?Mt(22925,22949,151,22959):(be=B,M=V)}else be=0,M=0;oe=Jt($)|0,te=Jt(Y)|0,o[Ge>>2]=0,o[Ge+4>>2]=0,o[Ge+8>>2]=0,o[Ge+12>>2]=0;do if(be){if(Y=o[4304+($*28|0)+(be<<2)>>2]|0,B=(Y|0)>0,te)if(B){$=0,V=d,B=x;do V=aa(V,B)|0,B=Oe()|0,M=Fi(M)|0,(M|0)==1&&(M=Fi(1)|0),$=$+1|0;while(($|0)!=(Y|0));Y=M,$=V,V=B}else Y=M,$=d,V=x;else if(B){$=0,V=d,B=x;do V=Gi(V,B)|0,B=Oe()|0,M=Fi(M)|0,$=$+1|0;while(($|0)!=(Y|0));Y=M,$=V,V=B}else Y=M,$=d,V=x;if(xl($,V,Ge)|0,ue||Mt(22972,22949,181,22959),B=(oe|0)!=0,M=(te|0)!=0,B&M&&Mt(22999,22949,182,22959),B){if(M=si(l,h)|0,he[22032+(M*7|0)+be>>0]|0){S=3;break}V=o[21200+(M*28|0)+(be<<2)>>2]|0,$=V,Ce=26}else if(M){if(M=si($,V)|0,he[22032+(M*7|0)+Y>>0]|0){S=4;break}$=0,V=o[21200+(Y*28|0)+(M<<2)>>2]|0,Ce=26}else M=0;if((Ce|0)==26)if((V|0)<=-1&&Mt(23030,22949,212,22959),($|0)<=-1&&Mt(23053,22949,213,22959),(V|0)>0){B=Ge+4|0,M=0;do Ro(B),M=M+1|0;while((M|0)!=(V|0));M=$}else M=$;if(o[ve>>2]=0,o[ve+4>>2]=0,o[ve+8>>2]=0,lA(ve,be),S|0)for(;Ai(S)|0?ra(ve):lo(ve),(S|0)>1;)S=S+-1|0;if((M|0)>0){S=0;do Ro(ve),S=S+1|0;while((S|0)!=(M|0))}Ce=Ge+4|0,Bn(Ce,ve,Ce),Gr(Ce),Ce=50}else if(xl(d,x,Ge)|0,(oe|0)!=0&(te|0)!=0)if((Y|0)!=($|0)&&Mt(23077,22949,243,22959),M=si(l,h)|0,S=si(d,x)|0,he[22032+(M*7|0)+S>>0]|0)S=5;else if(M=o[21200+(M*28|0)+(S<<2)>>2]|0,(M|0)>0){B=Ge+4|0,S=0;do Ro(B),S=S+1|0;while((S|0)!=(M|0));Ce=50}else Ce=50;else Ce=50;while(0);return(Ce|0)==50&&(S=Ge+4|0,o[b>>2]=o[S>>2],o[b+4>>2]=o[S+4>>2],o[b+8>>2]=o[S+8>>2],S=0),Ge=S,De=Te,Ge|0}function YA(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0;if(be=De,De=De+48|0,M=be+36|0,B=be+24|0,V=be+12|0,$=be,S=St(l|0,h|0,52)|0,Oe()|0,S=S&15,te=St(l|0,h|0,45)|0,Oe()|0,te=te&127,Y=Jt(te)|0,Ct(S|0,0,52)|0,ve=Oe()|0|134225919,Ce=x,o[Ce>>2]=-1,o[Ce+4>>2]=ve,!S)return(o[d>>2]|0)>1||(o[d+4>>2]|0)>1||(o[d+8>>2]|0)>1||(b=NA(te,ao(d)|0)|0,(b|0)==127)?(ve=1,De=be,ve|0):(ue=Ct(b|0,0,45)|0,Ce=Oe()|0,te=x,Ce=o[te+4>>2]&-1040385|Ce,ve=x,o[ve>>2]=o[te>>2]|ue,o[ve+4>>2]=Ce,ve=0,De=be,ve|0);for(o[M>>2]=o[d>>2],o[M+4>>2]=o[d+4>>2],o[M+8>>2]=o[d+8>>2];o[B>>2]=o[M>>2],o[B+4>>2]=o[M+4>>2],o[B+8>>2]=o[M+8>>2],Ai(S)|0?(fl(M),o[V>>2]=o[M>>2],o[V+4>>2]=o[M+4>>2],o[V+8>>2]=o[M+8>>2],ra(V)):(Do(M),o[V>>2]=o[M>>2],o[V+4>>2]=o[M+4>>2],o[V+8>>2]=o[M+8>>2],lo(V)),ps(B,V,$),Gr($),Ce=x,Ge=o[Ce>>2]|0,Ce=o[Ce+4>>2]|0,Te=(15-S|0)*3|0,d=Ct(7,0,Te|0)|0,Ce=Ce&~(Oe()|0),Te=Ct(ao($)|0,0,Te|0)|0,Ce=Oe()|0|Ce,ve=x,o[ve>>2]=Te|Ge&~d,o[ve+4>>2]=Ce,(S|0)>1;)S=S+-1|0;e:do if((o[M>>2]|0)<=1&&(o[M+4>>2]|0)<=1&&(o[M+8>>2]|0)<=1){S=ao(M)|0,B=NA(te,S)|0,(B|0)==127?$=0:$=Jt(B)|0;t:do if(S){if(Y){if(M=21408+((si(l,h)|0)*28|0)+(S<<2)|0,M=o[M>>2]|0,(M|0)>0){d=0;do S=Oi(S)|0,d=d+1|0;while((d|0)!=(M|0))}if((S|0)==1){b=3;break e}d=NA(te,S)|0,(d|0)==127&&Mt(23104,22949,376,23134),Jt(d)|0?Mt(23147,22949,377,23134):(ue=M,oe=S,b=d)}else ue=0,oe=S,b=B;if(V=o[4304+(te*28|0)+(oe<<2)>>2]|0,(V|0)<=-1&&Mt(23178,22949,384,23134),!$){if((ue|0)<=-1&&Mt(23030,22949,417,23134),ue|0){M=x,S=0,d=o[M>>2]|0,M=o[M+4>>2]|0;do d=ns(d,M)|0,M=Oe()|0,Te=x,o[Te>>2]=d,o[Te+4>>2]=M,S=S+1|0;while((S|0)<(ue|0))}if((V|0)<=0){S=54;break}for(M=x,S=0,d=o[M>>2]|0,M=o[M+4>>2]|0;;)if(d=ns(d,M)|0,M=Oe()|0,Te=x,o[Te>>2]=d,o[Te+4>>2]=M,S=S+1|0,(S|0)==(V|0)){S=54;break t}}if(B=sA(b,te)|0,(B|0)==7&&Mt(22925,22949,393,23134),S=x,d=o[S>>2]|0,S=o[S+4>>2]|0,(V|0)>0){M=0;do d=ns(d,S)|0,S=Oe()|0,Te=x,o[Te>>2]=d,o[Te+4>>2]=S,M=M+1|0;while((M|0)!=(V|0))}if(d=si(d,S)|0,Te=Cr(b)|0,d=o[(Te?21824:21616)+(B*28|0)+(d<<2)>>2]|0,(d|0)<=-1&&Mt(23030,22949,412,23134),!d)S=54;else{B=x,S=0,M=o[B>>2]|0,B=o[B+4>>2]|0;do M=gi(M,B)|0,B=Oe()|0,Te=x,o[Te>>2]=M,o[Te+4>>2]=B,S=S+1|0;while((S|0)<(d|0));S=54}}else if((Y|0)!=0&($|0)!=0)if(Te=si(l,h)|0,S=x,S=21408+(Te*28|0)+((si(o[S>>2]|0,o[S+4>>2]|0)|0)<<2)|0,S=o[S>>2]|0,(S|0)<=-1&&Mt(23201,22949,433,23134),!S)b=B,S=55;else{M=x,b=0,d=o[M>>2]|0,M=o[M+4>>2]|0;do d=ns(d,M)|0,M=Oe()|0,Te=x,o[Te>>2]=d,o[Te+4>>2]=M,b=b+1|0;while((b|0)<(S|0));b=B,S=54}else b=B,S=54;while(0);if((S|0)==54&&$&&(S=55),(S|0)==55&&(Te=x,(si(o[Te>>2]|0,o[Te+4>>2]|0)|0)==1)){b=4;break}Te=x,ve=o[Te>>2]|0,Te=o[Te+4>>2]&-1040385,Ge=Ct(b|0,0,45)|0,Te=Te|(Oe()|0),b=x,o[b>>2]=ve|Ge,o[b+4>>2]=Te,b=0}else b=2;while(0);return Te=b,De=be,Te|0}function ua(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0;return M=De,De=De+16|0,S=M,l=Ft(l,h,d,x,S)|0,l||(Bo(S,b),l=0),De=M,l|0}function No(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0;return b=De,De=De+16|0,S=b,Zu(d,S),x=YA(l,h,S,x)|0,De=b,x|0}function XA(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0;return M=De,De=De+32|0,b=M+12|0,S=M,!(Ft(l,h,l,h,b)|0)&&!(Ft(l,h,d,x,S)|0)?l=Ao(b,S)|0:l=-1,De=M,l|0}function Ut(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0;return M=De,De=De+32|0,b=M+12|0,S=M,!(Ft(l,h,l,h,b)|0)&&!(Ft(l,h,d,x,S)|0)?l=Ao(b,S)|0:l=-1,De=M,(l>>>31^1)+l|0}function hA(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,m=0,g=0;if(m=De,De=De+48|0,S=m+24|0,M=m+12|0,xe=m,!(Ft(l,h,l,h,S)|0)&&!(Ft(l,h,d,x,M)|0)){if(Ve=Ao(S,M)|0,(Ve|0)<0)return xe=Ve,De=m,xe|0;for(o[S>>2]=0,o[S+4>>2]=0,o[S+8>>2]=0,o[M>>2]=0,o[M+4>>2]=0,o[M+8>>2]=0,Ft(l,h,l,h,S)|0,Ft(l,h,d,x,M)|0,GA(S),GA(M),Ve?(Y=o[S>>2]|0,ue=+(Ve|0),ve=S+4|0,oe=o[ve>>2]|0,Ge=S+8|0,te=o[Ge>>2]|0,Te=S,d=Y,x=oe,S=te,be=+((o[M>>2]|0)-Y|0)/ue,Ce=+((o[M+4>>2]|0)-oe|0)/ue,ue=+((o[M+8>>2]|0)-te|0)/ue):(x=S+4|0,te=S+8|0,ve=x,Ge=te,Te=S,d=o[S>>2]|0,x=o[x>>2]|0,S=o[te>>2]|0,be=0,Ce=0,ue=0),o[xe>>2]=d,te=xe+4|0,o[te>>2]=x,oe=xe+8|0,o[oe>>2]=S,Y=0;;){V=+(Y|0),g=be*V+ +(d|0),B=Ce*V+ +(o[ve>>2]|0),V=ue*V+ +(o[Ge>>2]|0),x=~~+$a(+g),M=~~+$a(+B),d=~~+$a(+V),g=+Pe(+(+(x|0)-g)),B=+Pe(+(+(M|0)-B)),V=+Pe(+(+(d|0)-V));do if(g>B&g>V)x=0-(M+d)|0,S=M;else if($=0-x|0,B>V){S=$-d|0;break}else{S=M,d=$-M|0;break}while(0);if(o[xe>>2]=x,o[te>>2]=S,o[oe>>2]=d,pl(xe),YA(l,h,xe,b+(Y<<3)|0)|0,(Y|0)==(Ve|0))break;Y=Y+1|0,d=o[Te>>2]|0}return xe=0,De=m,xe|0}return xe=-1,De=m,xe|0}function El(l,h){l=l|0,h=h|0;var d=0;if(!h)return d=1,d|0;d=l,l=1;do l=Qt(h&1|0?d:1,l)|0,h=h>>1,d=Qt(d,d)|0;while(h|0);return l|0}function fA(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0;if(!(aA(h,d)|0)||(h=oA(h)|0,te=+G[d>>3],x=+G[d+8>>3],x=h&x<0?x+6.283185307179586:x,oe=o[l>>2]|0,(oe|0)<=0))return oe=0,oe|0;if(Y=o[l+4>>2]|0,h){h=0,d=-1,l=0;e:for(;;){for($=l;M=+G[Y+($<<4)>>3],V=+G[Y+($<<4)+8>>3],l=(d+2|0)%(oe|0)|0,S=+G[Y+(l<<4)>>3],b=+G[Y+(l<<4)+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!(te<S|te>B);)if(d=$+1|0,(d|0)<(oe|0))l=$,$=d,d=l;else{d=22;break e}if(V=b<0?b+6.283185307179586:b,M=M<0?M+6.283185307179586:M,x=M==x|V==x?x+-2220446049250313e-31:x,V=V+(te-S)/(B-S)*(M-V),(V<0?V+6.283185307179586:V)>x&&(h=h^1),l=$+1|0,(l|0)>=(oe|0)){d=22;break}else d=$}if((d|0)==22)return h|0}else{h=0,d=-1,l=0;e:for(;;){for($=l;M=+G[Y+($<<4)>>3],V=+G[Y+($<<4)+8>>3],l=(d+2|0)%(oe|0)|0,S=+G[Y+(l<<4)>>3],b=+G[Y+(l<<4)+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!(te<S|te>B);)if(d=$+1|0,(d|0)<(oe|0))l=$,$=d,d=l;else{d=22;break e}if(x=M==x|b==x?x+-2220446049250313e-31:x,b+(te-S)/(B-S)*(M-b)>x&&(h=h^1),l=$+1|0,(l|0)>=(oe|0)){d=22;break}else d=$}if((d|0)==22)return h|0}return 0}function Ga(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0;if(be=o[l>>2]|0,!be){o[h>>2]=0,o[h+4>>2]=0,o[h+8>>2]=0,o[h+12>>2]=0,o[h+16>>2]=0,o[h+20>>2]=0,o[h+24>>2]=0,o[h+28>>2]=0;return}if(Ce=h+8|0,G[Ce>>3]=17976931348623157e292,ve=h+24|0,G[ve>>3]=17976931348623157e292,G[h>>3]=-17976931348623157e292,Ge=h+16|0,G[Ge>>3]=-17976931348623157e292,!((be|0)<=0)){for(te=o[l+4>>2]|0,$=17976931348623157e292,Y=-17976931348623157e292,oe=0,l=-1,S=17976931348623157e292,M=17976931348623157e292,V=-17976931348623157e292,x=-17976931348623157e292,ue=0;d=+G[te+(ue<<4)>>3],B=+G[te+(ue<<4)+8>>3],l=l+2|0,b=+G[te+(((l|0)==(be|0)?0:l)<<4)+8>>3],d<S&&(G[Ce>>3]=d,S=d),B<M&&(G[ve>>3]=B,M=B),d>V?G[h>>3]=d:d=V,B>x&&(G[Ge>>3]=B,x=B),$=B>0&B<$?B:$,Y=B<0&B>Y?B:Y,oe=oe|+Pe(+(B-b))>3.141592653589793,l=ue+1|0,(l|0)!=(be|0);)Te=ue,V=d,ue=l,l=Te;oe&&(G[Ge>>3]=Y,G[ve>>3]=$)}}function Rs(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,m=0,g=0,v=0;if(be=o[l>>2]|0,be){if(Ce=h+8|0,G[Ce>>3]=17976931348623157e292,ve=h+24|0,G[ve>>3]=17976931348623157e292,G[h>>3]=-17976931348623157e292,Ge=h+16|0,G[Ge>>3]=-17976931348623157e292,(be|0)>0){for(b=o[l+4>>2]|0,te=17976931348623157e292,ue=-17976931348623157e292,x=0,d=-1,V=17976931348623157e292,$=17976931348623157e292,oe=-17976931348623157e292,M=-17976931348623157e292,Te=0;S=+G[b+(Te<<4)>>3],Y=+G[b+(Te<<4)+8>>3],g=d+2|0,B=+G[b+(((g|0)==(be|0)?0:g)<<4)+8>>3],S<V&&(G[Ce>>3]=S,V=S),Y<$&&(G[ve>>3]=Y,$=Y),S>oe?G[h>>3]=S:S=oe,Y>M&&(G[Ge>>3]=Y,M=Y),te=Y>0&Y<te?Y:te,ue=Y<0&Y>ue?Y:ue,x=x|+Pe(+(Y-B))>3.141592653589793,d=Te+1|0,(d|0)!=(be|0);)g=Te,oe=S,Te=d,d=g;x&&(G[Ge>>3]=ue,G[ve>>3]=te)}}else o[h>>2]=0,o[h+4>>2]=0,o[h+8>>2]=0,o[h+12>>2]=0,o[h+16>>2]=0,o[h+20>>2]=0,o[h+24>>2]=0,o[h+28>>2]=0;if(g=l+8|0,d=o[g>>2]|0,!((d|0)<=0)){m=l+12|0,xe=0;do if(b=o[m>>2]|0,x=xe,xe=xe+1|0,ve=h+(xe<<5)|0,Ge=o[b+(x<<3)>>2]|0,Ge){if(Te=h+(xe<<5)+8|0,G[Te>>3]=17976931348623157e292,l=h+(xe<<5)+24|0,G[l>>3]=17976931348623157e292,G[ve>>3]=-17976931348623157e292,Ve=h+(xe<<5)+16|0,G[Ve>>3]=-17976931348623157e292,(Ge|0)>0){for(be=o[b+(x<<3)+4>>2]|0,te=17976931348623157e292,ue=-17976931348623157e292,b=0,x=-1,Ce=0,V=17976931348623157e292,$=17976931348623157e292,Y=-17976931348623157e292,M=-17976931348623157e292;S=+G[be+(Ce<<4)>>3],oe=+G[be+(Ce<<4)+8>>3],x=x+2|0,B=+G[be+(((x|0)==(Ge|0)?0:x)<<4)+8>>3],S<V&&(G[Te>>3]=S,V=S),oe<$&&(G[l>>3]=oe,$=oe),S>Y?G[ve>>3]=S:S=Y,oe>M&&(G[Ve>>3]=oe,M=oe),te=oe>0&oe<te?oe:te,ue=oe<0&oe>ue?oe:ue,b=b|+Pe(+(oe-B))>3.141592653589793,x=Ce+1|0,(x|0)!=(Ge|0);)v=Ce,Ce=x,Y=S,x=v;b&&(G[Ve>>3]=ue,G[l>>3]=te)}}else o[ve>>2]=0,o[ve+4>>2]=0,o[ve+8>>2]=0,o[ve+12>>2]=0,o[ve+16>>2]=0,o[ve+20>>2]=0,o[ve+24>>2]=0,o[ve+28>>2]=0,d=o[g>>2]|0;while((xe|0)<(d|0))}}function KA(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0;if(!(fA(l,h,d)|0))return b=0,b|0;if(b=l+8|0,(o[b>>2]|0)<=0)return b=1,b|0;for(x=l+12|0,l=0;;){if(S=l,l=l+1|0,fA((o[x>>2]|0)+(S<<3)|0,h+(l<<5)|0,d)|0){l=0,x=6;break}if((l|0)>=(o[b>>2]|0)){l=1,x=6;break}}return(x|0)==6?l|0:0}function th(){return 8}function nc(){return 16}function JA(){return 168}function eu(){return 8}function tu(){return 16}function Bs(){return 12}function Mi(){return 8}function fo(l){l=l|0;var h=0,d=0;return d=+G[l>>3],h=+G[l+8>>3],+ +ke(+(d*d+h*h))}function nu(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0;$=+G[l>>3],V=+G[h>>3]-$,B=+G[l+8>>3],M=+G[h+8>>3]-B,oe=+G[d>>3],S=+G[x>>3]-oe,te=+G[d+8>>3],Y=+G[x+8>>3]-te,S=(S*(B-te)-($-oe)*Y)/(V*Y-M*S),G[b>>3]=$+V*S,G[b+8>>3]=B+M*S}function ca(l,h){return l=l|0,h=h|0,+G[l>>3]!=+G[h>>3]?(h=0,h|0):(h=+G[l+8>>3]==+G[h+8>>3],h|0)}function Dr(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;return b=+G[l>>3]-+G[h>>3],x=+G[l+8>>3]-+G[h+8>>3],d=+G[l+16>>3]-+G[h+16>>3],+(b*b+x*x+d*d)}function Tl(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;d=+G[l>>3],x=+at(+d),d=+$e(+d),G[h+16>>3]=d,d=+G[l+8>>3],b=x*+at(+d),G[h>>3]=b,d=x*+$e(+d),G[h+8>>3]=d}function rc(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0;if($=De,De=De+32|0,b=$+16|0,S=$,Fa(l,h,b),M=ts(l,h)|0,V=si(l,h)|0,rA(M,S),h=iA(M,o[b>>2]|0)|0,!(Jt(M)|0))return V=h,De=$,V|0;do switch(M|0){case 4:{l=0,d=14;break}case 14:{l=1,d=14;break}case 24:{l=2,d=14;break}case 38:{l=3,d=14;break}case 49:{l=4,d=14;break}case 58:{l=5,d=14;break}case 63:{l=6,d=14;break}case 72:{l=7,d=14;break}case 83:{l=8,d=14;break}case 97:{l=9,d=14;break}case 107:{l=10,d=14;break}case 117:{l=11,d=14;break}default:B=0,x=0}while(0);return(d|0)==14&&(B=o[22096+(l*24|0)+8>>2]|0,x=o[22096+(l*24|0)+16>>2]|0),l=o[b>>2]|0,(l|0)!=(o[S>>2]|0)&&(M=Cr(M)|0,l=o[b>>2]|0,M|(l|0)==(x|0)&&(h=(h+1|0)%6|0)),(V|0)==3&(l|0)==(x|0)?(V=(h+5|0)%6|0,De=$,V|0):(V|0)==5&(l|0)==(B|0)?(V=(h+1|0)%6|0,De=$,V|0):(V=h,De=$,V|0)}function ss(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;return x=Pr(l,h)|0,(d+-1|0)>>>0>5||(b=(x|0)!=0,(d|0)==1&b)?(d=-1,d|0):(x=rc(l,h)|0,b?(d=(5-x+(o[22384+(d<<2)>>2]|0)|0)%5|0,d|0):(d=(6-x+(o[22416+(d<<2)>>2]|0)|0)%6|0,d|0))}function wr(l,h,d){l=l|0,h=h|0,d=d|0;var x=0;(h|0)>0?(x=$i(h,4)|0,o[l>>2]=x,x||Mt(23230,23253,40,23267)):o[l>>2]=0,o[l+4>>2]=h,o[l+8>>2]=0,o[l+12>>2]=d}function ja(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=l+4|0,S=l+12|0,M=l+8|0;e:for(;;){for(d=o[b>>2]|0,h=0;;){if((h|0)>=(d|0))break e;if(x=o[l>>2]|0,B=o[x+(h<<2)>>2]|0,!B)h=h+1|0;else break}h=x+(~~(+Pe(+(+We(10,+ +(15-(o[S>>2]|0)|0))*(+G[B>>3]+ +G[B+8>>3])))%+(d|0))>>>0<<2)|0,d=o[h>>2]|0;t:do if(d|0){if(x=B+32|0,(d|0)==(B|0))o[h>>2]=o[x>>2];else{if(d=d+32|0,h=o[d>>2]|0,!h)break;for(;(h|0)!=(B|0);)if(d=h+32|0,h=o[d>>2]|0,!h)break t;o[d>>2]=o[x>>2]}cn(B),o[M>>2]=(o[M>>2]|0)+-1}while(0)}cn(o[l>>2]|0)}function Sl(l){l=l|0;var h=0,d=0,x=0;for(x=o[l+4>>2]|0,d=0;;){if((d|0)>=(x|0)){h=0,d=4;break}if(h=o[(o[l>>2]|0)+(d<<2)>>2]|0,!h)d=d+1|0;else{d=4;break}}return(d|0)==4?h|0:0}function ru(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0;if(d=~~(+Pe(+(+We(10,+ +(15-(o[l+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(o[l+4>>2]|0))>>>0,d=(o[l>>2]|0)+(d<<2)|0,x=o[d>>2]|0,!x)return S=1,S|0;S=h+32|0;do if((x|0)!=(h|0)){if(d=o[x+32>>2]|0,!d)return S=1,S|0;for(b=d;;){if((b|0)==(h|0)){b=8;break}if(d=o[b+32>>2]|0,d)x=b,b=d;else{d=1,b=10;break}}if((b|0)==8){o[x+32>>2]=o[S>>2];break}else if((b|0)==10)return d|0}else o[d>>2]=o[S>>2];while(0);return cn(h),S=l+8|0,o[S>>2]=(o[S>>2]|0)+-1,S=0,S|0}function ic(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;S=Yt(40)|0,S||Mt(23283,23253,98,23296),o[S>>2]=o[h>>2],o[S+4>>2]=o[h+4>>2],o[S+8>>2]=o[h+8>>2],o[S+12>>2]=o[h+12>>2],b=S+16|0,o[b>>2]=o[d>>2],o[b+4>>2]=o[d+4>>2],o[b+8>>2]=o[d+8>>2],o[b+12>>2]=o[d+12>>2],o[S+32>>2]=0,b=~~(+Pe(+(+We(10,+ +(15-(o[l+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(o[l+4>>2]|0))>>>0,b=(o[l>>2]|0)+(b<<2)|0,x=o[b>>2]|0;do if(!x)o[b>>2]=S;else{for(;!(Is(x,h)|0&&Is(x+16|0,d)|0);)if(b=o[x+32>>2]|0,x=b|0?b:x,!(o[x+32>>2]|0)){M=10;break}if((M|0)==10){o[x+32>>2]=S;break}return cn(S),M=x,M|0}while(0);return M=l+8|0,o[M>>2]=(o[M>>2]|0)+1,M=S,M|0}function iu(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;if(b=~~(+Pe(+(+We(10,+ +(15-(o[l+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(o[l+4>>2]|0))>>>0,b=o[(o[l>>2]|0)+(b<<2)>>2]|0,!b)return d=0,d|0;if(!d){for(l=b;;){if(Is(l,h)|0){x=10;break}if(l=o[l+32>>2]|0,!l){l=0,x=10;break}}if((x|0)==10)return l|0}for(l=b;;){if(Is(l,h)|0&&Is(l+16|0,d)|0){x=10;break}if(l=o[l+32>>2]|0,!l){l=0,x=10;break}}return(x|0)==10?l|0:0}function sc(l,h){l=l|0,h=h|0;var d=0;if(d=~~(+Pe(+(+We(10,+ +(15-(o[l+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(o[l+4>>2]|0))>>>0,l=o[(o[l>>2]|0)+(d<<2)>>2]|0,!l)return d=0,d|0;for(;;){if(Is(l,h)|0){h=5;break}if(l=o[l+32>>2]|0,!l){l=0,h=5;break}}return(h|0)==5?l|0:0}function dr(){return 23312}function Ml(l){return l=+l,+ +c(+l)}function Zt(l){return l=+l,~~+Ml(l)|0}function Yt(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,m=0;m=De,De=De+16|0,te=m;do if(l>>>0<245){if($=l>>>0<11?16:l+11&-8,l=$>>>3,oe=o[5829]|0,d=oe>>>l,d&3|0)return h=(d&1^1)+l|0,l=23356+(h<<1<<2)|0,d=l+8|0,x=o[d>>2]|0,b=x+8|0,S=o[b>>2]|0,(S|0)==(l|0)?o[5829]=oe&~(1<<h):(o[S+12>>2]=l,o[d>>2]=S),xe=h<<3,o[x+4>>2]=xe|3,xe=x+xe+4|0,o[xe>>2]=o[xe>>2]|1,xe=b,De=m,xe|0;if(Y=o[5831]|0,$>>>0>Y>>>0){if(d|0)return h=2<<l,h=d<<l&(h|0-h),h=(h&0-h)+-1|0,B=h>>>12&16,h=h>>>B,d=h>>>5&8,h=h>>>d,S=h>>>2&4,h=h>>>S,l=h>>>1&2,h=h>>>l,x=h>>>1&1,x=(d|B|S|l|x)+(h>>>x)|0,h=23356+(x<<1<<2)|0,l=h+8|0,S=o[l>>2]|0,B=S+8|0,d=o[B>>2]|0,(d|0)==(h|0)?(l=oe&~(1<<x),o[5829]=l):(o[d+12>>2]=h,o[l>>2]=d,l=oe),xe=x<<3,M=xe-$|0,o[S+4>>2]=$|3,b=S+$|0,o[b+4>>2]=M|1,o[S+xe>>2]=M,Y|0&&(x=o[5834]|0,h=Y>>>3,d=23356+(h<<1<<2)|0,h=1<<h,l&h?(l=d+8|0,h=o[l>>2]|0):(o[5829]=l|h,h=d,l=d+8|0),o[l>>2]=x,o[h+12>>2]=x,o[x+8>>2]=h,o[x+12>>2]=d),o[5831]=M,o[5834]=b,xe=B,De=m,xe|0;if(S=o[5830]|0,S){for(d=(S&0-S)+-1|0,b=d>>>12&16,d=d>>>b,x=d>>>5&8,d=d>>>x,M=d>>>2&4,d=d>>>M,B=d>>>1&2,d=d>>>B,V=d>>>1&1,V=o[23620+((x|b|M|B|V)+(d>>>V)<<2)>>2]|0,d=V,B=V,V=(o[V+4>>2]&-8)-$|0;l=o[d+16>>2]|0,!(!l&&(l=o[d+20>>2]|0,!l));)M=(o[l+4>>2]&-8)-$|0,b=M>>>0<V>>>0,d=l,B=b?l:B,V=b?M:V;if(M=B+$|0,M>>>0>B>>>0){b=o[B+24>>2]|0,h=o[B+12>>2]|0;do if((h|0)==(B|0)){if(l=B+20|0,h=o[l>>2]|0,!h&&(l=B+16|0,h=o[l>>2]|0,!h)){d=0;break}for(;;)if(x=h+20|0,d=o[x>>2]|0,d)h=d,l=x;else if(x=h+16|0,d=o[x>>2]|0,d)h=d,l=x;else break;o[l>>2]=0,d=h}else d=o[B+8>>2]|0,o[d+12>>2]=h,o[h+8>>2]=d,d=h;while(0);do if(b|0){if(h=o[B+28>>2]|0,l=23620+(h<<2)|0,(B|0)==(o[l>>2]|0)){if(o[l>>2]=d,!d){o[5830]=S&~(1<<h);break}}else if(xe=b+16|0,o[((o[xe>>2]|0)==(B|0)?xe:b+20|0)>>2]=d,!d)break;o[d+24>>2]=b,h=o[B+16>>2]|0,h|0&&(o[d+16>>2]=h,o[h+24>>2]=d),h=o[B+20>>2]|0,h|0&&(o[d+20>>2]=h,o[h+24>>2]=d)}while(0);return V>>>0<16?(xe=V+$|0,o[B+4>>2]=xe|3,xe=B+xe+4|0,o[xe>>2]=o[xe>>2]|1):(o[B+4>>2]=$|3,o[M+4>>2]=V|1,o[M+V>>2]=V,Y|0&&(x=o[5834]|0,h=Y>>>3,d=23356+(h<<1<<2)|0,h=1<<h,h&oe?(l=d+8|0,h=o[l>>2]|0):(o[5829]=h|oe,h=d,l=d+8|0),o[l>>2]=x,o[h+12>>2]=x,o[x+8>>2]=h,o[x+12>>2]=d),o[5831]=V,o[5834]=M),xe=B+8|0,De=m,xe|0}else oe=$}else oe=$}else oe=$}else if(l>>>0<=4294967231)if(l=l+11|0,$=l&-8,x=o[5830]|0,x){b=0-$|0,l=l>>>8,l?$>>>0>16777215?V=31:(oe=(l+1048320|0)>>>16&8,Ce=l<<oe,B=(Ce+520192|0)>>>16&4,Ce=Ce<<B,V=(Ce+245760|0)>>>16&2,V=14-(B|oe|V)+(Ce<<V>>>15)|0,V=$>>>(V+7|0)&1|V<<1):V=0,d=o[23620+(V<<2)>>2]|0;e:do if(!d)d=0,l=0,Ce=61;else for(l=0,B=$<<((V|0)==31?0:25-(V>>>1)|0),S=0;;){if(M=(o[d+4>>2]&-8)-$|0,M>>>0<b>>>0)if(M)l=d,b=M;else{l=d,b=0,Ce=65;break e}if(Ce=o[d+20>>2]|0,d=o[d+16+(B>>>31<<2)>>2]|0,S=(Ce|0)==0|(Ce|0)==(d|0)?S:Ce,d)B=B<<1;else{d=S,Ce=61;break}}while(0);if((Ce|0)==61){if((d|0)==0&(l|0)==0){if(l=2<<V,l=(l|0-l)&x,!l){oe=$;break}oe=(l&0-l)+-1|0,M=oe>>>12&16,oe=oe>>>M,S=oe>>>5&8,oe=oe>>>S,B=oe>>>2&4,oe=oe>>>B,V=oe>>>1&2,oe=oe>>>V,d=oe>>>1&1,l=0,d=o[23620+((S|M|B|V|d)+(oe>>>d)<<2)>>2]|0}d?Ce=65:(B=l,M=b)}if((Ce|0)==65)for(S=d;;)if(oe=(o[S+4>>2]&-8)-$|0,d=oe>>>0<b>>>0,b=d?oe:b,l=d?S:l,d=o[S+16>>2]|0,d||(d=o[S+20>>2]|0),d)S=d;else{B=l,M=b;break}if(B|0&&M>>>0<((o[5831]|0)-$|0)>>>0&&(Y=B+$|0,Y>>>0>B>>>0)){S=o[B+24>>2]|0,h=o[B+12>>2]|0;do if((h|0)==(B|0)){if(l=B+20|0,h=o[l>>2]|0,!h&&(l=B+16|0,h=o[l>>2]|0,!h)){h=0;break}for(;;)if(b=h+20|0,d=o[b>>2]|0,d)h=d,l=b;else if(b=h+16|0,d=o[b>>2]|0,d)h=d,l=b;else break;o[l>>2]=0}else xe=o[B+8>>2]|0,o[xe+12>>2]=h,o[h+8>>2]=xe;while(0);do if(S){if(l=o[B+28>>2]|0,d=23620+(l<<2)|0,(B|0)==(o[d>>2]|0)){if(o[d>>2]=h,!h){x=x&~(1<<l),o[5830]=x;break}}else if(xe=S+16|0,o[((o[xe>>2]|0)==(B|0)?xe:S+20|0)>>2]=h,!h)break;o[h+24>>2]=S,l=o[B+16>>2]|0,l|0&&(o[h+16>>2]=l,o[l+24>>2]=h),l=o[B+20>>2]|0,l&&(o[h+20>>2]=l,o[l+24>>2]=h)}while(0);e:do if(M>>>0<16)xe=M+$|0,o[B+4>>2]=xe|3,xe=B+xe+4|0,o[xe>>2]=o[xe>>2]|1;else{if(o[B+4>>2]=$|3,o[Y+4>>2]=M|1,o[Y+M>>2]=M,h=M>>>3,M>>>0<256){d=23356+(h<<1<<2)|0,l=o[5829]|0,h=1<<h,l&h?(l=d+8|0,h=o[l>>2]|0):(o[5829]=l|h,h=d,l=d+8|0),o[l>>2]=Y,o[h+12>>2]=Y,o[Y+8>>2]=h,o[Y+12>>2]=d;break}if(h=M>>>8,h?M>>>0>16777215?d=31:(Ve=(h+1048320|0)>>>16&8,xe=h<<Ve,Te=(xe+520192|0)>>>16&4,xe=xe<<Te,d=(xe+245760|0)>>>16&2,d=14-(Te|Ve|d)+(xe<<d>>>15)|0,d=M>>>(d+7|0)&1|d<<1):d=0,h=23620+(d<<2)|0,o[Y+28>>2]=d,l=Y+16|0,o[l+4>>2]=0,o[l>>2]=0,l=1<<d,!(x&l)){o[5830]=x|l,o[h>>2]=Y,o[Y+24>>2]=h,o[Y+12>>2]=Y,o[Y+8>>2]=Y;break}h=o[h>>2]|0;t:do if((o[h+4>>2]&-8|0)!=(M|0)){for(x=M<<((d|0)==31?0:25-(d>>>1)|0);d=h+16+(x>>>31<<2)|0,l=o[d>>2]|0,!!l;)if((o[l+4>>2]&-8|0)==(M|0)){h=l;break t}else x=x<<1,h=l;o[d>>2]=Y,o[Y+24>>2]=h,o[Y+12>>2]=Y,o[Y+8>>2]=Y;break e}while(0);Ve=h+8|0,xe=o[Ve>>2]|0,o[xe+12>>2]=Y,o[Ve>>2]=Y,o[Y+8>>2]=xe,o[Y+12>>2]=h,o[Y+24>>2]=0}while(0);return xe=B+8|0,De=m,xe|0}else oe=$}else oe=$;else oe=-1;while(0);if(d=o[5831]|0,d>>>0>=oe>>>0)return h=d-oe|0,l=o[5834]|0,h>>>0>15?(xe=l+oe|0,o[5834]=xe,o[5831]=h,o[xe+4>>2]=h|1,o[l+d>>2]=h,o[l+4>>2]=oe|3):(o[5831]=0,o[5834]=0,o[l+4>>2]=d|3,xe=l+d+4|0,o[xe>>2]=o[xe>>2]|1),xe=l+8|0,De=m,xe|0;if(M=o[5832]|0,M>>>0>oe>>>0)return Te=M-oe|0,o[5832]=Te,xe=o[5835]|0,Ve=xe+oe|0,o[5835]=Ve,o[Ve+4>>2]=Te|1,o[xe+4>>2]=oe|3,xe=xe+8|0,De=m,xe|0;if(o[5947]|0?l=o[5949]|0:(o[5949]=4096,o[5948]=4096,o[5950]=-1,o[5951]=-1,o[5952]=0,o[5940]=0,o[5947]=te&-16^1431655768,l=4096),B=oe+48|0,V=oe+47|0,S=l+V|0,b=0-l|0,$=S&b,$>>>0<=oe>>>0||(l=o[5939]|0,l|0&&(Y=o[5937]|0,te=Y+$|0,te>>>0<=Y>>>0|te>>>0>l>>>0)))return xe=0,De=m,xe|0;e:do if(o[5940]&4)h=0,Ce=143;else{d=o[5835]|0;t:do if(d){for(x=23764;te=o[x>>2]|0,!(te>>>0<=d>>>0&&(te+(o[x+4>>2]|0)|0)>>>0>d>>>0);)if(l=o[x+8>>2]|0,l)x=l;else{Ce=128;break t}if(h=S-M&b,h>>>0<2147483647)if(l=_(h|0)|0,(l|0)==((o[x>>2]|0)+(o[x+4>>2]|0)|0)){if((l|0)!=-1){M=h,S=l,Ce=145;break e}}else x=l,Ce=136;else h=0}else Ce=128;while(0);do if((Ce|0)==128)if(d=_(0)|0,(d|0)!=-1&&(h=d,ue=o[5948]|0,be=ue+-1|0,h=(be&h|0?(be+h&0-ue)-h|0:0)+$|0,ue=o[5937]|0,be=h+ue|0,h>>>0>oe>>>0&h>>>0<2147483647)){if(te=o[5939]|0,te|0&&be>>>0<=ue>>>0|be>>>0>te>>>0){h=0;break}if(l=_(h|0)|0,(l|0)==(d|0)){M=h,S=d,Ce=145;break e}else x=l,Ce=136}else h=0;while(0);do if((Ce|0)==136){if(d=0-h|0,!(B>>>0>h>>>0&(h>>>0<2147483647&(x|0)!=-1)))if((x|0)==-1){h=0;break}else{M=h,S=x,Ce=145;break e}if(l=o[5949]|0,l=V-h+l&0-l,l>>>0>=2147483647){M=h,S=x,Ce=145;break e}if((_(l|0)|0)==-1){_(d|0)|0,h=0;break}else{M=l+h|0,S=x,Ce=145;break e}}while(0);o[5940]=o[5940]|4,Ce=143}while(0);if((Ce|0)==143&&$>>>0<2147483647&&(Te=_($|0)|0,be=_(0)|0,ve=be-Te|0,Ge=ve>>>0>(oe+40|0)>>>0,!((Te|0)==-1|Ge^1|Te>>>0<be>>>0&((Te|0)!=-1&(be|0)!=-1)^1))&&(M=Ge?ve:h,S=Te,Ce=145),(Ce|0)==145){h=(o[5937]|0)+M|0,o[5937]=h,h>>>0>(o[5938]|0)>>>0&&(o[5938]=h),V=o[5835]|0;e:do if(V){for(h=23764;;){if(l=o[h>>2]|0,d=o[h+4>>2]|0,(S|0)==(l+d|0)){Ce=154;break}if(x=o[h+8>>2]|0,x)h=x;else break}if((Ce|0)==154&&(Ve=h+4|0,(o[h+12>>2]&8|0)==0)&&S>>>0>V>>>0&l>>>0<=V>>>0){o[Ve>>2]=d+M,xe=(o[5832]|0)+M|0,Te=V+8|0,Te=Te&7|0?0-Te&7:0,Ve=V+Te|0,Te=xe-Te|0,o[5835]=Ve,o[5832]=Te,o[Ve+4>>2]=Te|1,o[V+xe+4>>2]=40,o[5836]=o[5951];break}for(S>>>0<(o[5833]|0)>>>0&&(o[5833]=S),d=S+M|0,h=23764;;){if((o[h>>2]|0)==(d|0)){Ce=162;break}if(l=o[h+8>>2]|0,l)h=l;else break}if((Ce|0)==162&&!(o[h+12>>2]&8|0)){o[h>>2]=S,Y=h+4|0,o[Y>>2]=(o[Y>>2]|0)+M,Y=S+8|0,Y=S+(Y&7|0?0-Y&7:0)|0,h=d+8|0,h=d+(h&7|0?0-h&7:0)|0,$=Y+oe|0,B=h-Y-oe|0,o[Y+4>>2]=oe|3;t:do if((V|0)==(h|0))xe=(o[5832]|0)+B|0,o[5832]=xe,o[5835]=$,o[$+4>>2]=xe|1;else{if((o[5834]|0)==(h|0)){xe=(o[5831]|0)+B|0,o[5831]=xe,o[5834]=$,o[$+4>>2]=xe|1,o[$+xe>>2]=xe;break}if(l=o[h+4>>2]|0,(l&3|0)==1){M=l&-8,x=l>>>3;n:do if(l>>>0<256)if(l=o[h+8>>2]|0,d=o[h+12>>2]|0,(d|0)==(l|0)){o[5829]=o[5829]&~(1<<x);break}else{o[l+12>>2]=d,o[d+8>>2]=l;break}else{S=o[h+24>>2]|0,l=o[h+12>>2]|0;do if((l|0)==(h|0)){if(d=h+16|0,x=d+4|0,l=o[x>>2]|0,l)d=x;else if(l=o[d>>2]|0,!l){l=0;break}for(;;)if(b=l+20|0,x=o[b>>2]|0,x)l=x,d=b;else if(b=l+16|0,x=o[b>>2]|0,x)l=x,d=b;else break;o[d>>2]=0}else xe=o[h+8>>2]|0,o[xe+12>>2]=l,o[l+8>>2]=xe;while(0);if(!S)break;d=o[h+28>>2]|0,x=23620+(d<<2)|0;do if((o[x>>2]|0)!=(h|0)){if(xe=S+16|0,o[((o[xe>>2]|0)==(h|0)?xe:S+20|0)>>2]=l,!l)break n}else{if(o[x>>2]=l,l|0)break;o[5830]=o[5830]&~(1<<d);break n}while(0);if(o[l+24>>2]=S,d=h+16|0,x=o[d>>2]|0,x|0&&(o[l+16>>2]=x,o[x+24>>2]=l),d=o[d+4>>2]|0,!d)break;o[l+20>>2]=d,o[d+24>>2]=l}while(0);h=h+M|0,b=M+B|0}else b=B;if(h=h+4|0,o[h>>2]=o[h>>2]&-2,o[$+4>>2]=b|1,o[$+b>>2]=b,h=b>>>3,b>>>0<256){d=23356+(h<<1<<2)|0,l=o[5829]|0,h=1<<h,l&h?(l=d+8|0,h=o[l>>2]|0):(o[5829]=l|h,h=d,l=d+8|0),o[l>>2]=$,o[h+12>>2]=$,o[$+8>>2]=h,o[$+12>>2]=d;break}h=b>>>8;do if(!h)x=0;else{if(b>>>0>16777215){x=31;break}Ve=(h+1048320|0)>>>16&8,xe=h<<Ve,Te=(xe+520192|0)>>>16&4,xe=xe<<Te,x=(xe+245760|0)>>>16&2,x=14-(Te|Ve|x)+(xe<<x>>>15)|0,x=b>>>(x+7|0)&1|x<<1}while(0);if(h=23620+(x<<2)|0,o[$+28>>2]=x,l=$+16|0,o[l+4>>2]=0,o[l>>2]=0,l=o[5830]|0,d=1<<x,!(l&d)){o[5830]=l|d,o[h>>2]=$,o[$+24>>2]=h,o[$+12>>2]=$,o[$+8>>2]=$;break}h=o[h>>2]|0;n:do if((o[h+4>>2]&-8|0)!=(b|0)){for(x=b<<((x|0)==31?0:25-(x>>>1)|0);d=h+16+(x>>>31<<2)|0,l=o[d>>2]|0,!!l;)if((o[l+4>>2]&-8|0)==(b|0)){h=l;break n}else x=x<<1,h=l;o[d>>2]=$,o[$+24>>2]=h,o[$+12>>2]=$,o[$+8>>2]=$;break t}while(0);Ve=h+8|0,xe=o[Ve>>2]|0,o[xe+12>>2]=$,o[Ve>>2]=$,o[$+8>>2]=xe,o[$+12>>2]=h,o[$+24>>2]=0}while(0);return xe=Y+8|0,De=m,xe|0}for(h=23764;l=o[h>>2]|0,!(l>>>0<=V>>>0&&(xe=l+(o[h+4>>2]|0)|0,xe>>>0>V>>>0));)h=o[h+8>>2]|0;b=xe+-47|0,l=b+8|0,l=b+(l&7|0?0-l&7:0)|0,b=V+16|0,l=l>>>0<b>>>0?V:l,h=l+8|0,d=M+-40|0,Te=S+8|0,Te=Te&7|0?0-Te&7:0,Ve=S+Te|0,Te=d-Te|0,o[5835]=Ve,o[5832]=Te,o[Ve+4>>2]=Te|1,o[S+d+4>>2]=40,o[5836]=o[5951],d=l+4|0,o[d>>2]=27,o[h>>2]=o[5941],o[h+4>>2]=o[5942],o[h+8>>2]=o[5943],o[h+12>>2]=o[5944],o[5941]=S,o[5942]=M,o[5944]=0,o[5943]=h,h=l+24|0;do Ve=h,h=h+4|0,o[h>>2]=7;while((Ve+8|0)>>>0<xe>>>0);if((l|0)!=(V|0)){if(S=l-V|0,o[d>>2]=o[d>>2]&-2,o[V+4>>2]=S|1,o[l>>2]=S,h=S>>>3,S>>>0<256){d=23356+(h<<1<<2)|0,l=o[5829]|0,h=1<<h,l&h?(l=d+8|0,h=o[l>>2]|0):(o[5829]=l|h,h=d,l=d+8|0),o[l>>2]=V,o[h+12>>2]=V,o[V+8>>2]=h,o[V+12>>2]=d;break}if(h=S>>>8,h?S>>>0>16777215?x=31:(Ve=(h+1048320|0)>>>16&8,xe=h<<Ve,Te=(xe+520192|0)>>>16&4,xe=xe<<Te,x=(xe+245760|0)>>>16&2,x=14-(Te|Ve|x)+(xe<<x>>>15)|0,x=S>>>(x+7|0)&1|x<<1):x=0,d=23620+(x<<2)|0,o[V+28>>2]=x,o[V+20>>2]=0,o[b>>2]=0,h=o[5830]|0,l=1<<x,!(h&l)){o[5830]=h|l,o[d>>2]=V,o[V+24>>2]=d,o[V+12>>2]=V,o[V+8>>2]=V;break}h=o[d>>2]|0;t:do if((o[h+4>>2]&-8|0)!=(S|0)){for(x=S<<((x|0)==31?0:25-(x>>>1)|0);d=h+16+(x>>>31<<2)|0,l=o[d>>2]|0,!!l;)if((o[l+4>>2]&-8|0)==(S|0)){h=l;break t}else x=x<<1,h=l;o[d>>2]=V,o[V+24>>2]=h,o[V+12>>2]=V,o[V+8>>2]=V;break e}while(0);Ve=h+8|0,xe=o[Ve>>2]|0,o[xe+12>>2]=V,o[Ve>>2]=V,o[V+8>>2]=xe,o[V+12>>2]=h,o[V+24>>2]=0}}else xe=o[5833]|0,(xe|0)==0|S>>>0<xe>>>0&&(o[5833]=S),o[5941]=S,o[5942]=M,o[5944]=0,o[5838]=o[5947],o[5837]=-1,o[5842]=23356,o[5841]=23356,o[5844]=23364,o[5843]=23364,o[5846]=23372,o[5845]=23372,o[5848]=23380,o[5847]=23380,o[5850]=23388,o[5849]=23388,o[5852]=23396,o[5851]=23396,o[5854]=23404,o[5853]=23404,o[5856]=23412,o[5855]=23412,o[5858]=23420,o[5857]=23420,o[5860]=23428,o[5859]=23428,o[5862]=23436,o[5861]=23436,o[5864]=23444,o[5863]=23444,o[5866]=23452,o[5865]=23452,o[5868]=23460,o[5867]=23460,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,xe=M+-40|0,Te=S+8|0,Te=Te&7|0?0-Te&7:0,Ve=S+Te|0,Te=xe-Te|0,o[5835]=Ve,o[5832]=Te,o[Ve+4>>2]=Te|1,o[S+xe+4>>2]=40,o[5836]=o[5951];while(0);if(h=o[5832]|0,h>>>0>oe>>>0)return Te=h-oe|0,o[5832]=Te,xe=o[5835]|0,Ve=xe+oe|0,o[5835]=Ve,o[Ve+4>>2]=Te|1,o[xe+4>>2]=oe|3,xe=xe+8|0,De=m,xe|0}return xe=dr()|0,o[xe>>2]=12,xe=0,De=m,xe|0}function cn(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(l){d=l+-8|0,b=o[5833]|0,l=o[l+-4>>2]|0,h=l&-8,V=d+h|0;do if(l&1)B=d,M=d;else{if(x=o[d>>2]|0,!(l&3)||(M=d+(0-x)|0,S=x+h|0,M>>>0<b>>>0))return;if((o[5834]|0)==(M|0)){if(l=V+4|0,h=o[l>>2]|0,(h&3|0)!=3){B=M,h=S;break}o[5831]=S,o[l>>2]=h&-2,o[M+4>>2]=S|1,o[M+S>>2]=S;return}if(d=x>>>3,x>>>0<256)if(l=o[M+8>>2]|0,h=o[M+12>>2]|0,(h|0)==(l|0)){o[5829]=o[5829]&~(1<<d),B=M,h=S;break}else{o[l+12>>2]=h,o[h+8>>2]=l,B=M,h=S;break}b=o[M+24>>2]|0,l=o[M+12>>2]|0;do if((l|0)==(M|0)){if(h=M+16|0,d=h+4|0,l=o[d>>2]|0,l)h=d;else if(l=o[h>>2]|0,!l){l=0;break}for(;;)if(x=l+20|0,d=o[x>>2]|0,d)l=d,h=x;else if(x=l+16|0,d=o[x>>2]|0,d)l=d,h=x;else break;o[h>>2]=0}else B=o[M+8>>2]|0,o[B+12>>2]=l,o[l+8>>2]=B;while(0);if(b){if(h=o[M+28>>2]|0,d=23620+(h<<2)|0,(o[d>>2]|0)==(M|0)){if(o[d>>2]=l,!l){o[5830]=o[5830]&~(1<<h),B=M,h=S;break}}else if(B=b+16|0,o[((o[B>>2]|0)==(M|0)?B:b+20|0)>>2]=l,!l){B=M,h=S;break}o[l+24>>2]=b,h=M+16|0,d=o[h>>2]|0,d|0&&(o[l+16>>2]=d,o[d+24>>2]=l),h=o[h+4>>2]|0,h?(o[l+20>>2]=h,o[h+24>>2]=l,B=M,h=S):(B=M,h=S)}else B=M,h=S}while(0);if(!(M>>>0>=V>>>0)&&(l=V+4|0,x=o[l>>2]|0,!!(x&1))){if(x&2)o[l>>2]=x&-2,o[B+4>>2]=h|1,o[M+h>>2]=h,b=h;else{if((o[5835]|0)==(V|0)){if(V=(o[5832]|0)+h|0,o[5832]=V,o[5835]=B,o[B+4>>2]=V|1,(B|0)!=(o[5834]|0))return;o[5834]=0,o[5831]=0;return}if((o[5834]|0)==(V|0)){V=(o[5831]|0)+h|0,o[5831]=V,o[5834]=M,o[B+4>>2]=V|1,o[M+V>>2]=V;return}b=(x&-8)+h|0,d=x>>>3;do if(x>>>0<256)if(h=o[V+8>>2]|0,l=o[V+12>>2]|0,(l|0)==(h|0)){o[5829]=o[5829]&~(1<<d);break}else{o[h+12>>2]=l,o[l+8>>2]=h;break}else{S=o[V+24>>2]|0,l=o[V+12>>2]|0;do if((l|0)==(V|0)){if(h=V+16|0,d=h+4|0,l=o[d>>2]|0,l)h=d;else if(l=o[h>>2]|0,!l){d=0;break}for(;;)if(x=l+20|0,d=o[x>>2]|0,d)l=d,h=x;else if(x=l+16|0,d=o[x>>2]|0,d)l=d,h=x;else break;o[h>>2]=0,d=l}else d=o[V+8>>2]|0,o[d+12>>2]=l,o[l+8>>2]=d,d=l;while(0);if(S|0){if(l=o[V+28>>2]|0,h=23620+(l<<2)|0,(o[h>>2]|0)==(V|0)){if(o[h>>2]=d,!d){o[5830]=o[5830]&~(1<<l);break}}else if(x=S+16|0,o[((o[x>>2]|0)==(V|0)?x:S+20|0)>>2]=d,!d)break;o[d+24>>2]=S,l=V+16|0,h=o[l>>2]|0,h|0&&(o[d+16>>2]=h,o[h+24>>2]=d),l=o[l+4>>2]|0,l|0&&(o[d+20>>2]=l,o[l+24>>2]=d)}}while(0);if(o[B+4>>2]=b|1,o[M+b>>2]=b,(B|0)==(o[5834]|0)){o[5831]=b;return}}if(l=b>>>3,b>>>0<256){d=23356+(l<<1<<2)|0,h=o[5829]|0,l=1<<l,h&l?(h=d+8|0,l=o[h>>2]|0):(o[5829]=h|l,l=d,h=d+8|0),o[h>>2]=B,o[l+12>>2]=B,o[B+8>>2]=l,o[B+12>>2]=d;return}l=b>>>8,l?b>>>0>16777215?x=31:(M=(l+1048320|0)>>>16&8,V=l<<M,S=(V+520192|0)>>>16&4,V=V<<S,x=(V+245760|0)>>>16&2,x=14-(S|M|x)+(V<<x>>>15)|0,x=b>>>(x+7|0)&1|x<<1):x=0,l=23620+(x<<2)|0,o[B+28>>2]=x,o[B+20>>2]=0,o[B+16>>2]=0,h=o[5830]|0,d=1<<x;e:do if(!(h&d))o[5830]=h|d,o[l>>2]=B,o[B+24>>2]=l,o[B+12>>2]=B,o[B+8>>2]=B;else{l=o[l>>2]|0;t:do if((o[l+4>>2]&-8|0)!=(b|0)){for(x=b<<((x|0)==31?0:25-(x>>>1)|0);d=l+16+(x>>>31<<2)|0,h=o[d>>2]|0,!!h;)if((o[h+4>>2]&-8|0)==(b|0)){l=h;break t}else x=x<<1,l=h;o[d>>2]=B,o[B+24>>2]=l,o[B+12>>2]=B,o[B+8>>2]=B;break e}while(0);M=l+8|0,V=o[M>>2]|0,o[V+12>>2]=B,o[M>>2]=B,o[B+8>>2]=V,o[B+12>>2]=l,o[B+24>>2]=0}while(0);if(V=(o[5837]|0)+-1|0,o[5837]=V,!(V|0)){for(l=23772;l=o[l>>2]|0,l;)l=l+8|0;o[5837]=-1}}}}function $i(l,h){l=l|0,h=h|0;var d=0;return l?(d=Qt(h,l)|0,(h|l)>>>0>65535&&(d=((d>>>0)/(l>>>0)|0|0)==(h|0)?d:-1)):d=0,l=Yt(d)|0,!l||!(o[l+-4>>2]&3)||k(l|0,0,d|0)|0,l|0}function Uo(l,h,d,x){return l=l|0,h=h|0,d=d|0,x=x|0,d=l+d>>>0,Ot(h+x+(d>>>0<l>>>0|0)>>>0|0),d|0|0}function Or(l,h,d,x){return l=l|0,h=h|0,d=d|0,x=x|0,x=h-x-(d>>>0>l>>>0|0)>>>0,Ot(x|0),l-d>>>0|0|0}function zs(l){return l=l|0,(l?31-(vn(l^l-1)|0)|0:32)|0}function ms(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,Y=0,oe=0,te=0,ue=0,be=0;if(Y=l,V=h,$=V,M=d,te=x,B=te,!$)return S=(b|0)!=0,B?S?(o[b>>2]=l|0,o[b+4>>2]=h&0,te=0,b=0,Ot(te|0),b|0):(te=0,b=0,Ot(te|0),b|0):(S&&(o[b>>2]=(Y>>>0)%(M>>>0),o[b+4>>2]=0),te=0,b=(Y>>>0)/(M>>>0)>>>0,Ot(te|0),b|0);S=(B|0)==0;do if(M){if(!S){if(S=(vn(B|0)|0)-(vn($|0)|0)|0,S>>>0<=31){oe=S+1|0,B=31-S|0,h=S-31>>31,M=oe,l=Y>>>(oe>>>0)&h|$<<B,h=$>>>(oe>>>0)&h,S=0,B=Y<<B;break}return b?(o[b>>2]=l|0,o[b+4>>2]=V|h&0,te=0,b=0,Ot(te|0),b|0):(te=0,b=0,Ot(te|0),b|0)}if(S=M-1|0,S&M|0){B=(vn(M|0)|0)+33-(vn($|0)|0)|0,be=64-B|0,oe=32-B|0,V=oe>>31,ue=B-32|0,h=ue>>31,M=B,l=oe-1>>31&$>>>(ue>>>0)|($<<oe|Y>>>(B>>>0))&h,h=h&$>>>(B>>>0),S=Y<<be&V,B=($<<be|Y>>>(ue>>>0))&V|Y<<oe&B-33>>31;break}return b|0&&(o[b>>2]=S&Y,o[b+4>>2]=0),(M|0)==1?(ue=V|h&0,be=l|0|0,Ot(ue|0),be|0):(be=zs(M|0)|0,ue=$>>>(be>>>0)|0,be=$<<32-be|Y>>>(be>>>0)|0,Ot(ue|0),be|0)}else{if(S)return b|0&&(o[b>>2]=($>>>0)%(M>>>0),o[b+4>>2]=0),ue=0,be=($>>>0)/(M>>>0)>>>0,Ot(ue|0),be|0;if(!Y)return b|0&&(o[b>>2]=0,o[b+4>>2]=($>>>0)%(B>>>0)),ue=0,be=($>>>0)/(B>>>0)>>>0,Ot(ue|0),be|0;if(S=B-1|0,!(S&B))return b|0&&(o[b>>2]=l|0,o[b+4>>2]=S&$|h&0),ue=0,be=$>>>((zs(B|0)|0)>>>0),Ot(ue|0),be|0;if(S=(vn(B|0)|0)-(vn($|0)|0)|0,S>>>0<=30){h=S+1|0,B=31-S|0,M=h,l=$<<B|Y>>>(h>>>0),h=$>>>(h>>>0),S=0,B=Y<<B;break}return b?(o[b>>2]=l|0,o[b+4>>2]=V|h&0,ue=0,be=0,Ot(ue|0),be|0):(ue=0,be=0,Ot(ue|0),be|0)}while(0);if(!M)$=B,V=0,B=0;else{oe=d|0|0,Y=te|x&0,$=Uo(oe|0,Y|0,-1,-1)|0,d=Oe()|0,V=B,B=0;do x=V,V=S>>>31|V<<1,S=B|S<<1,x=l<<1|x>>>31|0,te=l>>>31|h<<1|0,Or($|0,d|0,x|0,te|0)|0,be=Oe()|0,ue=be>>31|((be|0)<0?-1:0)<<1,B=ue&1,l=Or(x|0,te|0,ue&oe|0,(((be|0)<0?-1:0)>>31|((be|0)<0?-1:0)<<1)&Y|0)|0,h=Oe()|0,M=M-1|0;while(M|0);$=V,V=0}return M=0,b|0&&(o[b>>2]=l,o[b+4>>2]=h),ue=(S|0)>>>31|($|M)<<1|(M<<1|S>>>31)&0|V,be=(S<<1|0)&-2|B,Ot(ue|0),be|0}function Os(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0;return S=De,De=De+16|0,b=S|0,ms(l,h,d,x,b)|0,De=S,Ot(o[b+4>>2]|0),o[b>>2]|0|0}function St(l,h,d){return l=l|0,h=h|0,d=d|0,(d|0)<32?(Ot(h>>>d|0),l>>>d|(h&(1<<d)-1)<<32-d):(Ot(0),h>>>d-32|0)}function Ct(l,h,d){return l=l|0,h=h|0,d=d|0,(d|0)<32?(Ot(h<<d|(l&(1<<d)-1<<32-d)>>>32-d|0),l<<d):(Ot(l<<d-32|0),0)}function Fr(l,h){return l=+l,h=+h,l!=l?+h:h!=h?+l:+on(+l,+h)}function $a(l){return l=+l,l>=0?+Ie(l+.5):+dn(l-.5)}function Fs(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0;if((d|0)>=8192)return ii(l|0,h|0,d|0)|0,l|0;if(S=l|0,b=l+d|0,(l&3)==(h&3)){for(;l&3;){if(!d)return S|0;he[l>>0]=he[h>>0]|0,l=l+1|0,h=h+1|0,d=d-1|0}for(d=b&-4|0,x=d-64|0;(l|0)<=(x|0);)o[l>>2]=o[h>>2],o[l+4>>2]=o[h+4>>2],o[l+8>>2]=o[h+8>>2],o[l+12>>2]=o[h+12>>2],o[l+16>>2]=o[h+16>>2],o[l+20>>2]=o[h+20>>2],o[l+24>>2]=o[h+24>>2],o[l+28>>2]=o[h+28>>2],o[l+32>>2]=o[h+32>>2],o[l+36>>2]=o[h+36>>2],o[l+40>>2]=o[h+40>>2],o[l+44>>2]=o[h+44>>2],o[l+48>>2]=o[h+48>>2],o[l+52>>2]=o[h+52>>2],o[l+56>>2]=o[h+56>>2],o[l+60>>2]=o[h+60>>2],l=l+64|0,h=h+64|0;for(;(l|0)<(d|0);)o[l>>2]=o[h>>2],l=l+4|0,h=h+4|0}else for(d=b-4|0;(l|0)<(d|0);)he[l>>0]=he[h>>0]|0,he[l+1>>0]=he[h+1>>0]|0,he[l+2>>0]=he[h+2>>0]|0,he[l+3>>0]=he[h+3>>0]|0,l=l+4|0,h=h+4|0;for(;(l|0)<(b|0);)he[l>>0]=he[h>>0]|0,l=l+1|0,h=h+1|0;return S|0}function k(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if(S=l+d|0,h=h&255,(d|0)>=67){for(;l&3;)he[l>>0]=h,l=l+1|0;for(x=S&-4|0,M=h|h<<8|h<<16|h<<24,b=x-64|0;(l|0)<=(b|0);)o[l>>2]=M,o[l+4>>2]=M,o[l+8>>2]=M,o[l+12>>2]=M,o[l+16>>2]=M,o[l+20>>2]=M,o[l+24>>2]=M,o[l+28>>2]=M,o[l+32>>2]=M,o[l+36>>2]=M,o[l+40>>2]=M,o[l+44>>2]=M,o[l+48>>2]=M,o[l+52>>2]=M,o[l+56>>2]=M,o[l+60>>2]=M,l=l+64|0;for(;(l|0)<(x|0);)o[l>>2]=M,l=l+4|0}for(;(l|0)<(S|0);)he[l>>0]=h,l=l+1|0;return S-d|0}function c(l){return l=+l,l>=0?+Ie(l+.5):+dn(l-.5)}function _(l){l=l|0;var h=0,d=0,x=0;return x=An()|0,d=o[Le>>2]|0,h=d+l|0,(l|0)>0&(h|0)<(d|0)|(h|0)<0?(ea(h|0)|0,Se(12),-1):(h|0)>(x|0)&&!(nr(h|0)|0)?(Se(12),-1):(o[Le>>2]=h,d|0)}return{___uremdi3:Os,_bitshift64Lshr:St,_bitshift64Shl:Ct,_calloc:$i,_cellAreaKm2:za,_cellAreaM2:oa,_cellAreaRads2:ml,_compact:ZA,_destroyLinkedPolygon:Va,_edgeLengthKm:Ba,_edgeLengthM:Xu,_emscripten_replace_memory:Ia,_exactEdgeLengthKm:_l,_exactEdgeLengthM:fr,_exactEdgeLengthRads:yl,_experimentalH3ToLocalIj:ua,_experimentalLocalIjToH3:No,_free:cn,_geoToH3:Oa,_getDestinationH3IndexFromUnidirectionalEdge:Fo,_getH3IndexesFromUnidirectionalEdge:ho,_getH3UnidirectionalEdge:ji,_getH3UnidirectionalEdgeBoundary:Ua,_getH3UnidirectionalEdgesFromHexagon:bl,_getOriginH3IndexFromUnidirectionalEdge:wl,_getPentagonIndexes:Jr,_getRes0Indexes:cl,_h3Distance:XA,_h3GetBaseCell:ts,_h3GetFaces:la,_h3GetResolution:uA,_h3IndexesAreNeighbors:gs,_h3IsPentagon:Pr,_h3IsResClassIII:cA,_h3IsValid:qA,_h3Line:hA,_h3LineSize:Ut,_h3SetToLinkedGeo:Sr,_h3ToCenterChild:Kr,_h3ToChildren:jr,_h3ToGeo:Ds,_h3ToGeoBoundary:rs,_h3ToParent:vl,_h3UnidirectionalEdgeIsValid:tc,_hexAreaKm2:Oo,_hexAreaM2:Yu,_hexRing:Ee,_i64Subtract:Or,_kRing:ta,_kRingDistances:Al,_llvm_minnum_f64:Fr,_llvm_round_f64:$a,_malloc:Yt,_maxFaceCount:ec,_maxH3ToChildrenSize:Ku,_maxKringSize:La,_maxPolyfillSize:Fe,_maxUncompactSize:Ju,_memcpy:Fs,_memset:k,_numHexagons:QA,_pentagonIndexCount:Na,_pointDistKm:Wn,_pointDistM:yr,_pointDistRads:Gn,_polyfill:ot,_res0IndexCount:ul,_round:c,_sbrk:_,_sizeOfCoordIJ:Mi,_sizeOfGeoBoundary:JA,_sizeOfGeoCoord:nc,_sizeOfGeoPolygon:tu,_sizeOfGeofence:eu,_sizeOfH3Index:th,_sizeOfLinkedGeoPolygon:Bs,_uncompact:Ls,establishStackSpace:ka,stackAlloc:we,stackRestore:ds,stackSave:ko}}(fs,mn,Ne);e.___uremdi3=Ze.___uremdi3,e._bitshift64Lshr=Ze._bitshift64Lshr,e._bitshift64Shl=Ze._bitshift64Shl,e._calloc=Ze._calloc,e._cellAreaKm2=Ze._cellAreaKm2,e._cellAreaM2=Ze._cellAreaM2,e._cellAreaRads2=Ze._cellAreaRads2,e._compact=Ze._compact,e._destroyLinkedPolygon=Ze._destroyLinkedPolygon,e._edgeLengthKm=Ze._edgeLengthKm,e._edgeLengthM=Ze._edgeLengthM;var Vr=e._emscripten_replace_memory=Ze._emscripten_replace_memory;e._exactEdgeLengthKm=Ze._exactEdgeLengthKm,e._exactEdgeLengthM=Ze._exactEdgeLengthM,e._exactEdgeLengthRads=Ze._exactEdgeLengthRads,e._experimentalH3ToLocalIj=Ze._experimentalH3ToLocalIj,e._experimentalLocalIjToH3=Ze._experimentalLocalIjToH3,e._free=Ze._free,e._geoToH3=Ze._geoToH3,e._getDestinationH3IndexFromUnidirectionalEdge=Ze._getDestinationH3IndexFromUnidirectionalEdge,e._getH3IndexesFromUnidirectionalEdge=Ze._getH3IndexesFromUnidirectionalEdge,e._getH3UnidirectionalEdge=Ze._getH3UnidirectionalEdge,e._getH3UnidirectionalEdgeBoundary=Ze._getH3UnidirectionalEdgeBoundary,e._getH3UnidirectionalEdgesFromHexagon=Ze._getH3UnidirectionalEdgesFromHexagon,e._getOriginH3IndexFromUnidirectionalEdge=Ze._getOriginH3IndexFromUnidirectionalEdge,e._getPentagonIndexes=Ze._getPentagonIndexes,e._getRes0Indexes=Ze._getRes0Indexes,e._h3Distance=Ze._h3Distance,e._h3GetBaseCell=Ze._h3GetBaseCell,e._h3GetFaces=Ze._h3GetFaces,e._h3GetResolution=Ze._h3GetResolution,e._h3IndexesAreNeighbors=Ze._h3IndexesAreNeighbors,e._h3IsPentagon=Ze._h3IsPentagon,e._h3IsResClassIII=Ze._h3IsResClassIII,e._h3IsValid=Ze._h3IsValid,e._h3Line=Ze._h3Line,e._h3LineSize=Ze._h3LineSize,e._h3SetToLinkedGeo=Ze._h3SetToLinkedGeo,e._h3ToCenterChild=Ze._h3ToCenterChild,e._h3ToChildren=Ze._h3ToChildren,e._h3ToGeo=Ze._h3ToGeo,e._h3ToGeoBoundary=Ze._h3ToGeoBoundary,e._h3ToParent=Ze._h3ToParent,e._h3UnidirectionalEdgeIsValid=Ze._h3UnidirectionalEdgeIsValid,e._hexAreaKm2=Ze._hexAreaKm2,e._hexAreaM2=Ze._hexAreaM2,e._hexRing=Ze._hexRing,e._i64Subtract=Ze._i64Subtract,e._kRing=Ze._kRing,e._kRingDistances=Ze._kRingDistances,e._llvm_minnum_f64=Ze._llvm_minnum_f64,e._llvm_round_f64=Ze._llvm_round_f64,e._malloc=Ze._malloc,e._maxFaceCount=Ze._maxFaceCount,e._maxH3ToChildrenSize=Ze._maxH3ToChildrenSize,e._maxKringSize=Ze._maxKringSize,e._maxPolyfillSize=Ze._maxPolyfillSize,e._maxUncompactSize=Ze._maxUncompactSize,e._memcpy=Ze._memcpy,e._memset=Ze._memset,e._numHexagons=Ze._numHexagons,e._pentagonIndexCount=Ze._pentagonIndexCount,e._pointDistKm=Ze._pointDistKm,e._pointDistM=Ze._pointDistM,e._pointDistRads=Ze._pointDistRads,e._polyfill=Ze._polyfill,e._res0IndexCount=Ze._res0IndexCount,e._round=Ze._round,e._sbrk=Ze._sbrk,e._sizeOfCoordIJ=Ze._sizeOfCoordIJ,e._sizeOfGeoBoundary=Ze._sizeOfGeoBoundary,e._sizeOfGeoCoord=Ze._sizeOfGeoCoord,e._sizeOfGeoPolygon=Ze._sizeOfGeoPolygon,e._sizeOfGeofence=Ze._sizeOfGeofence,e._sizeOfH3Index=Ze._sizeOfH3Index,e._sizeOfLinkedGeoPolygon=Ze._sizeOfLinkedGeoPolygon,e._uncompact=Ze._uncompact,e.establishStackSpace=Ze.establishStackSpace;var Cs=e.stackAlloc=Ze.stackAlloc,kr=e.stackRestore=Ze.stackRestore,ri=e.stackSave=Ze.stackSave;if(e.asm=Ze,e.cwrap=ie,e.setValue=U,e.getValue=W,e.getTempRet0=I,Hn){oo(Hn)||(Hn=s(Hn));{Un();var Zn=function(X){X.byteLength&&(X=new Uint8Array(X)),qe.set(X,L),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,wi()},Ps=function(){A(Hn,Zn,function(){throw"could not load memory initializer "+Hn})},Bi=Mr(Hn);if(Bi)Zn(Bi.buffer);else if(e.memoryInitializerRequest){var zi=function(){var X=e.memoryInitializerRequest,H=X.response;if(X.status!==200&&X.status!==0){var ee=Mr(e.memoryInitializerRequestURL);if(ee)H=ee.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+X.status+", retrying "+Hn),Ps();return}}Zn(H)};e.memoryInitializerRequest.response?setTimeout(zi,0):e.memoryInitializerRequest.addEventListener("load",zi)}else Ps()}}var Si;Zr=function X(){Si||es(),Si||(Zr=X)};function es(X){if(tr>0||(Nn(),tr>0))return;function H(){Si||(Si=!0,!q&&(xr(),xt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),nn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),H()},1)):H()}e.run=es;function Lr(X){throw e.onAbort&&e.onAbort(X),X+="",a(X),y(X),q=!0,"abort("+X+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Lr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return es(),t}(typeof Pt=="object"?Pt:{}),Sn="number",Jd=Sn,zn=Sn,Kn=Sn,Go=Sn,mr=Sn,cpe=[["sizeOfH3Index",Sn],["sizeOfGeoCoord",Sn],["sizeOfGeoBoundary",Sn],["sizeOfGeoPolygon",Sn],["sizeOfGeofence",Sn],["sizeOfLinkedGeoPolygon",Sn],["sizeOfCoordIJ",Sn],["h3IsValid",Jd,[zn,Kn]],["geoToH3",zn,[Sn,Sn,Go]],["h3ToGeo",null,[zn,Kn,mr]],["h3ToGeoBoundary",null,[zn,Kn,mr]],["maxKringSize",Sn,[Sn]],["kRing",null,[zn,Kn,Sn,mr]],["kRingDistances",null,[zn,Kn,Sn,mr,mr]],["hexRing",null,[zn,Kn,Sn,mr]],["maxPolyfillSize",Sn,[mr,Go]],["polyfill",null,[mr,Go,mr]],["h3SetToLinkedGeo",null,[mr,Sn,mr]],["destroyLinkedPolygon",null,[mr]],["compact",Sn,[mr,mr,Sn]],["uncompact",Sn,[mr,Sn,mr,Sn,Go]],["maxUncompactSize",Sn,[mr,Sn,Go]],["h3IsPentagon",Jd,[zn,Kn]],["h3IsResClassIII",Jd,[zn,Kn]],["h3GetBaseCell",Sn,[zn,Kn]],["h3GetResolution",Sn,[zn,Kn]],["maxFaceCount",Sn,[zn,Kn]],["h3GetFaces",null,[zn,Kn,mr]],["h3ToParent",zn,[zn,Kn,Go]],["h3ToChildren",null,[zn,Kn,Go,mr]],["h3ToCenterChild",zn,[zn,Kn,Go]],["maxH3ToChildrenSize",Sn,[zn,Kn,Go]],["h3IndexesAreNeighbors",Jd,[zn,Kn,zn,Kn]],["getH3UnidirectionalEdge",zn,[zn,Kn,zn,Kn]],["getOriginH3IndexFromUnidirectionalEdge",zn,[zn,Kn]],["getDestinationH3IndexFromUnidirectionalEdge",zn,[zn,Kn]],["h3UnidirectionalEdgeIsValid",Jd,[zn,Kn]],["getH3IndexesFromUnidirectionalEdge",null,[zn,Kn,mr]],["getH3UnidirectionalEdgesFromHexagon",null,[zn,Kn,mr]],["getH3UnidirectionalEdgeBoundary",null,[zn,Kn,mr]],["h3Distance",Sn,[zn,Kn,zn,Kn]],["h3Line",Sn,[zn,Kn,zn,Kn,mr]],["h3LineSize",Sn,[zn,Kn,zn,Kn]],["experimentalH3ToLocalIj",Sn,[zn,Kn,zn,Kn,mr]],["experimentalLocalIjToH3",Sn,[zn,Kn,mr,mr]],["hexAreaM2",Sn,[Go]],["hexAreaKm2",Sn,[Go]],["edgeLengthM",Sn,[Go]],["edgeLengthKm",Sn,[Go]],["pointDistM",Sn,[mr,mr]],["pointDistKm",Sn,[mr,mr]],["pointDistRads",Sn,[mr,mr]],["cellAreaM2",Sn,[zn,Kn]],["cellAreaKm2",Sn,[zn,Kn]],["cellAreaRads2",Sn,[zn,Kn]],["exactEdgeLengthM",Sn,[zn,Kn]],["exactEdgeLengthKm",Sn,[zn,Kn]],["exactEdgeLengthRads",Sn,[zn,Kn]],["numHexagons",Sn,[Go]],["getRes0Indexes",null,[mr]],["res0IndexCount",Sn],["getPentagonIndexes",null,[Sn,mr]],["pentagonIndexCount",Sn]],sn={};cpe.forEach(function(e){sn[e[0]]=Pt.cwrap.apply(Pt,e)});var a0=16,To=4,m6=4,Zc=8,so=sn.sizeOfH3Index(),B2=sn.sizeOfGeoCoord(),eF=sn.sizeOfGeoBoundary(),hpe=sn.sizeOfGeoPolygon(),Dp=sn.sizeOfGeofence(),fpe=sn.sizeOfLinkedGeoPolygon(),tF=sn.sizeOfCoordIJ(),Xo={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function od(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var dpe=/[^0-9a-fA-F]/;function pr(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||dpe.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),a0),n=parseInt(t.substring(t.length-8),a0);return[n,e]}function y6(t){if(t>=0)return t.toString(a0);t=t&2147483647;var e=nF(8,t.toString(a0)),n=(parseInt(e[0],a0)+8).toString(a0);return e=n+e.substring(1),e}function z2(t,e){return y6(e)+nF(8,y6(t))}function nF(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function _6(t,e,n){for(var r=t.length,i=Pt._calloc(r,B2),s=n?1:0,A=n?0:1,a=0;a<r*2;a+=2)Pt.HEAPF64.set([t[a/2][s],t[a/2][A]].map(O2),i/Zc+a);return Pt.HEAPU32.set([r,i],e/To),e}function ppe(t,e){var n=t.length-1,r=Pt._calloc(hpe),i=0,s=i+Dp,A=s+To;_6(t[0],r+i,e);var a;if(n>0){a=Pt._calloc(n,Dp);for(var y=0;y<n;y++)_6(t[y+1],a+Dp*y,e)}return Pt.setValue(r+s,n,"i32"),Pt.setValue(r+A,a,"i32"),r}function gpe(t){var e=0,n=e+Dp,r=n+To,i=To;Pt._free(Pt.getValue(t+e+i,"i8*"));var s=Pt.getValue(t+n,"i32");if(s>0){for(var A=Pt.getValue(t+r,"i32"),a=0;a<s;a++)Pt._free(Pt.getValue(A+Dp*a+i,"i8*"));Pt._free(A)}Pt._free(t)}function rF(t){var e=Pt.getTempRet0();return[t,e]}function ad(t){var e=rF(t),n=e[0],r=e[1];return r?z2(n,r):null}function iF(t,e){e===void 0&&(e=0);var n=Pt.getValue(t+To*e*2,"i32"),r=Pt.getValue(t+To*(e*2+1),"i32");return r?z2(n,r):null}function mpe(t,e,n){Pt.HEAPU32.set(pr(t),e/To+2*n)}function tA(t,e){for(var n=[],r=0;r<e;r++){var i=iF(t,r);i!==null&&n.push(i)}return n}function fS(t,e){for(var n=e.length,r=0;r<n;r++)mpe(e[r],t,r)}function v6(t,e){var n=Pt._calloc(1,B2);return Pt.HEAPF64.set([t,e].map(O2),n/Zc),n}function N_(t){return lF(Pt.getValue(t,"double"))}function dS(t){return[N_(t),N_(t+Zc)]}function sF(t){return[N_(t+Zc),N_(t)]}function oF(t,e,n){for(var r=Pt.getValue(t,"i32"),i=t+Zc,s=[],A=e?sF:dS,a=0;a<r*2;a+=2)s.push(A(i+Zc*a));return n&&s.push(s[0]),s}function ype(t,e){for(var n=[],r=e?sF:dS,i,s,A,a;t;){for(n.push(i=[]),s=Pt.getValue(t,"i8*");s;){for(i.push(A=[]),a=Pt.getValue(s,"i8*");a;)A.push(r(a)),a=Pt.getValue(a+Zc*2,"i8*");e&&A.push(A[0]),s=Pt.getValue(s+m6*2,"i8*")}t=Pt.getValue(t+m6*2,"i8*")}return n}function _pe(t){return{i:Pt.getValue(t,"i32"),j:Pt.getValue(t+To,"i32")}}function vpe(t,e){var n=e.i,r=e.j;Pt.setValue(t,n,"i32"),Pt.setValue(t+To,r,"i32")}function xpe(t,e){for(var n=[],r=0;r<e;r++){var i=Pt.getValue(t+To*r,"i32");i>=0&&n.push(i)}return n}function aF(t){var e=pr(t),n=e[0],r=e[1];return!!sn.h3IsValid(n,r)}function wpe(t){var e=pr(t),n=e[0],r=e[1];return!!sn.h3IsPentagon(n,r)}function bpe(t){var e=pr(t),n=e[0],r=e[1];return!!sn.h3IsResClassIII(n,r)}function Epe(t){var e=pr(t),n=e[0],r=e[1];return sn.h3GetBaseCell(n,r)}function Tpe(t){var e=pr(t),n=e[0],r=e[1],i=sn.maxFaceCount(n,r),s=Pt._malloc(To*i);sn.h3GetFaces(n,r,s);var A=xpe(s,i);return Pt._free(s),A}function Spe(t){var e=pr(t),n=e[0],r=e[1];return sn.h3IsValid(n,r)?sn.h3GetResolution(n,r):-1}function Mpe(t,e,n){var r=Pt._malloc(B2);Pt.HEAPF64.set([t,e].map(O2),r/Zc);var i=ad(sn.geoToH3(r,n));return Pt._free(r),i}function Cpe(t){var e=Pt._malloc(B2),n=pr(t),r=n[0],i=n[1];sn.h3ToGeo(r,i,e);var s=dS(e);return Pt._free(e),s}function Ppe(t,e){var n=Pt._malloc(eF),r=pr(t),i=r[0],s=r[1];sn.h3ToGeoBoundary(i,s,n);var A=oF(n,e,e);return Pt._free(n),A}function Ipe(t,e){var n=pr(t),r=n[0],i=n[1];return ad(sn.h3ToParent(r,i,e))}function kpe(t,e){if(!aF(t))return[];var n=pr(t),r=n[0],i=n[1],s=sn.maxH3ToChildrenSize(r,i,e),A=Pt._calloc(s,so);sn.h3ToChildren(r,i,e,A);var a=tA(A,s);return Pt._free(A),a}function Lpe(t,e){var n=pr(t),r=n[0],i=n[1];return ad(sn.h3ToCenterChild(r,i,e))}function Dpe(t,e){var n=pr(t),r=n[0],i=n[1],s=sn.maxKringSize(e),A=Pt._calloc(s,so);sn.kRing(r,i,e,A);var a=tA(A,s);return Pt._free(A),a}function Rpe(t,e){var n=pr(t),r=n[0],i=n[1],s=sn.maxKringSize(e),A=Pt._calloc(s,so),a=Pt._calloc(s,To);sn.kRingDistances(r,i,e,A,a);for(var y=[],w=0;w<e+1;w++)y.push([]);for(var P=0;P<s*2;P+=2){var I=Pt.getValue(A+To*P,"i32"),L=Pt.getValue(A+To*(P+1),"i32"),U=Pt.getValue(a+To*(P/2),"i32");(I!==0||L!==0)&&y[U].push(z2(I,L))}return Pt._free(A),Pt._free(a),y}function Bpe(t,e){var n=e===0?1:6*e,r=Pt._calloc(n,so),i=sn.hexRing.apply(sn,pr(t).concat([e],[r]));if(i!==0)throw Pt._free(r),new Error("Failed to get hexRing (encountered a pentagon?)");var s=tA(r,n);return Pt._free(r),s}function zpe(t,e,n){if(od(e),n=!!n,t.length===0||t[0].length===0)return[];typeof t[0][0]=="number"&&(t=[t]);var r=ppe(t,n),i=sn.maxPolyfillSize(r,e),s=Pt._calloc(i,so);sn.polyfill(r,e,s);var A=tA(s,i);return Pt._free(s),gpe(r),A}function Ope(t,e){if(!t||!t.length)return[];var n=t.length,r=Pt._calloc(n,so);fS(r,t);var i=Pt._calloc(fpe),s=i;sn.h3SetToLinkedGeo(r,n,i);var A=ype(i,e);return sn.destroyLinkedPolygon(s),Pt._free(s),Pt._free(r),A}function Fpe(t){if(!t||!t.length)return[];var e=t.length,n=Pt._calloc(e,so);fS(n,t);var r=Pt._calloc(e,so),i=sn.compact(n,r,e);if(i!==0)throw Pt._free(n),Pt._free(r),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var s=tA(r,e);return Pt._free(n),Pt._free(r),s}function Npe(t,e){if(od(e),!t||!t.length)return[];var n=t.length,r=Pt._calloc(n,so);fS(r,t);var i=sn.maxUncompactSize(r,n,e),s=Pt._calloc(i,so),A=sn.uncompact(r,n,s,i,e);if(A!==0)throw Pt._free(r),Pt._free(s),new Error("Failed to uncompact (bad resolution?)");var a=tA(s,i);return Pt._free(r),Pt._free(s),a}function Upe(t,e){var n=pr(t),r=n[0],i=n[1],s=pr(e),A=s[0],a=s[1];return!!sn.h3IndexesAreNeighbors(r,i,A,a)}function Vpe(t,e){var n=pr(t),r=n[0],i=n[1],s=pr(e),A=s[0],a=s[1];return ad(sn.getH3UnidirectionalEdge(r,i,A,a))}function Gpe(t){var e=pr(t),n=e[0],r=e[1];return ad(sn.getOriginH3IndexFromUnidirectionalEdge(n,r))}function jpe(t){var e=pr(t),n=e[0],r=e[1];return ad(sn.getDestinationH3IndexFromUnidirectionalEdge(n,r))}function $pe(t){var e=pr(t),n=e[0],r=e[1];return!!sn.h3UnidirectionalEdgeIsValid(n,r)}function Hpe(t){var e=pr(t),n=e[0],r=e[1],i=2,s=Pt._calloc(i,so);sn.getH3IndexesFromUnidirectionalEdge(n,r,s);var A=tA(s,i);return Pt._free(s),A}function Wpe(t){var e=pr(t),n=e[0],r=e[1],i=6,s=Pt._calloc(i,so);sn.getH3UnidirectionalEdgesFromHexagon(n,r,s);var A=tA(s,i);return Pt._free(s),A}function Qpe(t,e){var n=Pt._malloc(eF),r=pr(t),i=r[0],s=r[1];sn.getH3UnidirectionalEdgeBoundary(i,s,n);var A=oF(n,e);return Pt._free(n),A}function qpe(t,e){var n=pr(t),r=n[0],i=n[1],s=pr(e),A=s[0],a=s[1];return sn.h3Distance(r,i,A,a)}function Zpe(t,e){var n=pr(t),r=n[0],i=n[1],s=pr(e),A=s[0],a=s[1],y=sn.h3LineSize(r,i,A,a);if(y<0)throw new Error("Line cannot be calculated");var w=Pt._calloc(y,so);sn.h3Line(r,i,A,a,w);var P=tA(w,y);return Pt._free(w),P}function Ype(t,e){var n=Pt._malloc(tF),r=sn.experimentalH3ToLocalIj.apply(sn,pr(t).concat(pr(e),[n])),i=_pe(n);switch(Pt._free(n),r){case 0:return i;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function Xpe(t,e){if(!e||typeof e.i!="number"||typeof e.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var n=Pt._malloc(tF),r=Pt._malloc(so);vpe(n,e);var i=sn.experimentalLocalIjToH3.apply(sn,pr(t).concat([n],[r])),s=iF(r);if(Pt._free(n),Pt._free(r),i!==0)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return s}function Kpe(t,e,n){var r=v6(t[0],t[1]),i=v6(e[0],e[1]),s;switch(n){case Xo.m:s=sn.pointDistM(r,i);break;case Xo.km:s=sn.pointDistKm(r,i);break;case Xo.rads:s=sn.pointDistRads(r,i);break;default:s=null}if(Pt._free(r),Pt._free(i),s===null)throw new Error("Unknown unit: "+n);return s}function Jpe(t,e){var n=pr(t),r=n[0],i=n[1];switch(e){case Xo.m2:return sn.cellAreaM2(r,i);case Xo.km2:return sn.cellAreaKm2(r,i);case Xo.rads2:return sn.cellAreaRads2(r,i);default:throw new Error("Unknown unit: "+e)}}function ege(t,e){var n=pr(t),r=n[0],i=n[1];switch(e){case Xo.m:return sn.exactEdgeLengthM(r,i);case Xo.km:return sn.exactEdgeLengthKm(r,i);case Xo.rads:return sn.exactEdgeLengthRads(r,i);default:throw new Error("Unknown unit: "+e)}}function tge(t,e){switch(od(t),e){case Xo.m2:return sn.hexAreaM2(t);case Xo.km2:return sn.hexAreaKm2(t);default:throw new Error("Unknown unit: "+e)}}function nge(t,e){switch(od(t),e){case Xo.m:return sn.edgeLengthM(t);case Xo.km:return sn.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function rge(t){od(t);var e=rF(sn.numHexagons(t)),n=e[0],r=e[1];return r?r*Math.pow(2,32)+n:n}function ige(){var t=sn.res0IndexCount(),e=Pt._malloc(so*t);sn.getRes0Indexes(e);var n=tA(e,t);return Pt._free(e),n}function sge(t){od(t);var e=sn.pentagonIndexCount(),n=Pt._malloc(so*e);sn.getPentagonIndexes(t,n);var r=tA(n,e);return Pt._free(n),r}function O2(t){return t*Math.PI/180}function lF(t){return t*180/Math.PI}const oge=Object.freeze(Object.defineProperty({__proto__:null,UNITS:Xo,cellArea:Jpe,compact:Fpe,degsToRads:O2,edgeLength:nge,exactEdgeLength:ege,experimentalH3ToLocalIj:Ype,experimentalLocalIjToH3:Xpe,geoToH3:Mpe,getDestinationH3IndexFromUnidirectionalEdge:jpe,getH3IndexesFromUnidirectionalEdge:Hpe,getH3UnidirectionalEdge:Vpe,getH3UnidirectionalEdgeBoundary:Qpe,getH3UnidirectionalEdgesFromHexagon:Wpe,getOriginH3IndexFromUnidirectionalEdge:Gpe,getPentagonIndexes:sge,getRes0Indexes:ige,h3Distance:qpe,h3GetBaseCell:Epe,h3GetFaces:Tpe,h3GetResolution:Spe,h3IndexToSplitLong:pr,h3IndexesAreNeighbors:Upe,h3IsPentagon:wpe,h3IsResClassIII:bpe,h3IsValid:aF,h3Line:Zpe,h3SetToMultiPolygon:Ope,h3ToCenterChild:Lpe,h3ToChildren:kpe,h3ToGeo:Cpe,h3ToGeoBoundary:Ppe,h3ToParent:Ipe,h3UnidirectionalEdgeIsValid:$pe,hexArea:tge,hexRing:Bpe,kRing:Dpe,kRingDistances:Rpe,numHexagons:rge,pointDist:Kpe,polyfill:zpe,radsToDegs:lF,splitLongToh3Index:z2,uncompact:Npe},Symbol.toStringTag,{value:"Module"})),age=pN(oge);var Sg=age,F2="Feature",AF="FeatureCollection",U_="Polygon",pS="MultiPolygon";function uF(t){for(var e=null,n=0;n<t.length;n++)if(e!==null)for(var r=0;r<t[n].length;r++)e.push(t[n][r]);else e=t[n];return Array.from(new Set(e))}function lge(t){for(var e=0,n=0,r=0,i=t[0],s=0;s<i.length;s++)e+=i[s][0],n+=i[s][1],r++;return[e/r,n/r]}function Age(t,e){var n=t.features;if(!n)throw new Error("No features found");return uF(n.map(function(r){return cF(r,e)}))}function cF(t,e,n){n===void 0&&(n={});var r=t.type,i=t.geometry,s=i&&i.type;if(r===AF)return Age(t,e);if(r!==F2)throw new Error("Unhandled type: "+r);if(s!==U_&&s!==pS)throw new Error("Unhandled geometry type: "+s);var A=s===U_?[i.coordinates]:i.coordinates;return uF(A.map(function(a){var y=Sg.polyfill(a,e,!0);if(y.length||!n.ensureOutput)return y;var w=lge(a),P=w[0],I=w[1];return[Sg.geoToH3(I,P,e)]}))}function hF(t,e){e===void 0&&(e={});var n=[Sg.h3ToGeoBoundary(t,!0)];return{type:F2,id:t,properties:e,geometry:{type:U_,coordinates:n}}}function uge(t,e){e===void 0&&(e={});var n=Sg.h3SetToMultiPolygon(t,!0),r=n.length>1,i=r?pS:U_,s=r?n:n[0]||[];return{type:F2,properties:e,geometry:{type:i,coordinates:s}}}function cge(t,e){e===void 0&&(e={});var n=t.map(function(r){return[Sg.h3ToGeoBoundary(r,{geoJson:!0})]});return{type:F2,properties:e,geometry:{type:pS,coordinates:n}}}function hge(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r],s=e?e(i):{};n.push(hF(i,s))}return{type:AF,features:n}}var fge={featureToH3Set:cF,h3ToFeature:hF,h3SetToFeature:uge,h3SetToMultiPolygonFeature:cge,h3SetToFeatureCollection:hge},x6=fge;function dge({dataDeag:t,disabled:e=!1,deagKey:n}){const{current:r}=At.useRef(Cde(t.features,fe=>fe.properties.id)),[i,s]=At.useState(null),[A,a]=At.useState({}),[y,w]=At.useState([]),[P,I]=At.useState({}),[L,U]=At.useState({type:"FeatureCollection",features:[]}),[W,q]=At.useState({}),[ae,K]=At.useState(!1),ne=At.useCallback(({object:fe})=>{if(!fe){s(null),a({}),w([]);return}if(!e){if(ae)s(null),a({}),w(fe.properties.id);else{const ye=x6.h3ToFeature(fe.hexId),Me={};for(const He of fe.properties[n]){const Qe=r[He],Je=g6(ye,Qe.geometry);Me[Qe.properties.id]=n6(Je)/n6(ye)}a(Me),s(fe.hexId)}return!0}},[P,ae,e,n]),ie=At.useCallback(({object:fe},ye)=>{if(fe.properties.id==y)return U({type:"FeatureCollection",features:[]}),q({}),I({}),K(!1),!0;if(fe.properties[n]==null)return;if(ye.srcEvent.shiftKey)return I(Je=>({...Je,[fe.hexId]:fe.properties[n]})),!0;K(!0),s(null),a({}),w(fe.properties.id),I({});const Me={...P,[fe.hexId]:fe.properties[n]};I(Me);const He={},Qe={type:"FeatureCollection",features:[]};for(const Je in Me)for(const tt of Me[Je]){const Ne=r[tt],nt=x6.h3ToFeature(Je),qe=g6(nt,Ne.geometry);Qe.features.push({...qe,properties:{...Ne.properties}}),He[Ne.properties.id]={...Ne.properties}}return q(He),U(Qe),!0},[P,y,ae,n]);return{hoveredHex:i,clickedHexes:P,hoveredGeos:A,selectedGeoJSON:L,selectedGeos:W,hoveredGeoActive:y,onHover:ne,onClick:ie,selectionFinalized:ae}}const Ja=ZO(Bde,YO),ep=ZO(Rde,{});rl().domain([9,14]).range([0,1]).clamp(!0);const Rp=Koe().domain([new Date("10/31/1921"),new Date("9/30/2021")]).range([0,1199]).invert,pu=0;function pge({speedyCounter:t,curOption:e}){const n=At.useRef(),r=At.useRef(),i=At.useRef({});At.useEffect(()=>{n.current=document.querySelector("#main-tooltip"),r.current=document.querySelector("#secondary-tooltip")},[]);const s=At.useCallback(w=>{const P=w.properties.Demand[Js[pu]][t],I=-w.properties.UnmetDemand[Js[pu]][t],L=-I-w.properties.UnmetDemandBaseline[t];n.current.classList.add("active"),r.current.classList.add("active"),r.current.innerHTML=`        <div><b>Region ID</b> ${w.properties.id}</div>
        <div><b>Scenario Demand</b> ${P}</div>
        <div><b>Scen. Unmet Demand</b> ${I}</div>
        <div><b>Difference in Unmet Demand</b> ${L}</div>
        <div><b>Land Holder</b> ${hw(w)}</div>
      `},[t]),A=At.useCallback(w=>{if(r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${Jk(Rp(t))}</i></div>
      `,w.properties.Demand){const P=w.properties.Demand[Js[pu]][t],I=-w.properties.UnmetDemand[Js[pu]][t],L=-I-w.properties.UnmetDemandBaseline[t];n.current.innerHTML+=`        
          <div><i>${e6[pu]}</i></div>
          <div><b>Region ID</b> ${w.properties.id}</div>
          <div><b>Scenario Demand</b> ${P}</div>
          <div><b>Scen. Unmet Demand</b> ${I}</div>
          <div><b>Difference in Unmet Demand</b> ${L}</div>
          <div><b>Land Holder</b> ${hw(w)}</div>
        `}else{const P=w.properties.Groundwater[t];n.current.innerHTML+=`     
          <div><b>Elem ID</b> ${w.properties.id}</div>
          <div><b>Groundwater</b> ${P}</div>
      `}},[t]),a=At.useCallback(w=>{const P=w.properties.Demand[Js[pu]][t],I=-w.properties.UnmetDemand[Js[pu]][t],L=-I-w.properties.UnmetDemandBaseline[t],U=w.properties.Groundwater[t],W=w.properties.GroundwaterVar[t],q=w.properties.UnmetDemandVar[Js[pu]][t],ae=O3(w.properties.UnmetDemandBaselineVar[t],q),K=w.properties.DURgs.join(", "),ne=w.properties.GWRgs.join(", ");r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${Jk(Rp(t))}</i></div>
        <div><i>${e6[pu]}</i></div>
        <div><b>Groundwater</b> ${U}</div>
        <div><b>Scenario Demand</b> ${P}</div>
        <div><b>Scen. Unmet Demand</b> ${I}</div>
        <div><b>Difference in Unmet Demand</b> ${L}</div>
        <div><b>Land Holder</b> ${hw(w)}</div>
        <div><b>Variance (GW)</b> ${W}</div>
        <div><b>Var. (Scen. UnmetDem)</b> ${q}</div>
        <div><b>Var. (Difference)</b> ${ae}</div>
        <div><b>Demand Regions</b> ${K}</div>
        <div><b>GW Regions</b> ${ne}</div>
      `},[t]);return{getTooltip:At.useCallback(({object:w})=>{if(!w){i.current&&(r.current.classList.remove("active"),Kk(i.current)&&n.current.classList.remove("active"),i.current=w),e>1&&(r.current.classList.remove("active"),n.current.classList.remove("active"));return}e<=1&&Kk(w)?a(w):e<=1&&qO(w)?s(w):A(w),i.current=w},[t,e])}}class gS extends Li{renderLayers(){return[new dg({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new lg(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}}gS.layerName="BaseTerrainLayer";gS.defaultProps={...Li.defaultProps};const w6=0;class mS extends Li{renderLayers(){const{curOption:e,speedyCounter:n}=this.props;return[new Gc({id:"GroundwaterGeo",data:zde,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...Ja.groundwater.interpColor(r.properties.Groundwater[n]),255],visible:e==2,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new Gc({id:"UDemGeo",data:z_,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...Ja.unmetDemand.interpColor(r.properties.UnmetDemand[Js[w6]][n]),255],visible:e==3,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new Gc({id:"DemDiffGeo",data:z_,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...Ja.difference.interpColor(r.properties.UnmetDemand[Js[w6]][n]-r.properties.UnmetDemandBaseline[n]),255],visible:e==4,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0})]}}mS.layerName="BasicGeoLayer";mS.defaultProps={...Li.defaultProps,autoHighlight:!0};const b6=Su("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),E6=Su("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),T6=Su("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),S6=Su("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t));function gge({counter:t,displayMonth:e,dataset:n}){const r=(t+9)%12+1,i=At.useRef();At.useEffect(()=>{i.current=Object.groupBy(pw[n],(w,P)=>Rp(P).toLocaleString("default",{year:"numeric"}))},[n]);const s=rl().domain([0,Pte(pw[n],w=>w)]).range([40,90]),A=rl().domain([1,12]).range([0,2*Math.PI]),a=gI().radius(w=>s(w)).curve(yI).angle((w,P)=>A((P+9)%12+1)),y=gI().radius(w=>s(w)).curve(yI).angle((w,P)=>A(P%12+1));At.useEffect(()=>(ya("#clockContainer").style("visibility","visible"),ya("#pieOutline path").attr("d",pI().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*2)).attr("fill","none").attr("stroke",n=="averageGroundwater"?`rgb(${b6})`:`rgba(${T6}, 1)`),ya("#demandLine path").data([pw[n]]).join("path").attr("d",w=>a(w)).attr("stroke",n=="averageGroundwater"?`rgba(${E6}, 0.3)`:`rgba(${S6}, 0.3)`).attr("stroke-width","0.2").attr("fill","none"),function(){ya("#clockContainer").style("visibility","hidden"),ya("#pie path").attr("d",""),ya("#pieOutline path").attr("d",""),ya("#demandLine path").attr("d",""),ya("#demandLineCur path").attr("d",""),ya("#date").text("")}),[n]),At.useEffect(()=>{ya("#pie path").attr("d",pI().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*r/12*2)).attr("fill",n=="averageGroundwater"?`rgb(${b6})`:`rgba(${T6}, 1)`);let w=Rp(t);e?ya("#date").html("<b>"+w.toLocaleString("default",{year:"numeric"})+"</b><br/>"+w.toLocaleString("default",{month:"long"})):ya("#date").html("<b>"+w.toLocaleString("default",{year:"numeric"})+"</b>"),cre("#demandLineCur path").data([i.current[Rp(t).toLocaleString("default",{year:"numeric"})]]).join("path").attr("d",P=>y(P)).attr("stroke",n=="averageGroundwater"?`rgba(${E6}, 1)`:`rgba(${S6}, 1)`).attr("stroke-width","2").attr("fill","none")},[n,t])}function mge({}){const t=At.useRef();return At.useLayoutEffect(()=>{ya(t.current).attr("width",400).attr("height",500).call(function(r){r.append("g").call(Xk.arcmapLegend().vtitle("Groundwater").utitle("Variance").scale(Ja.groundwater.vsup).size(150).x(400-180).y(500-300))}).call(function(r){r.append("g").call(Xk.simpleLegend().title("Difference w/ Baseline").size(250).height(20).scale(Ja.difference.colorsStepped).x(400-280).y(500-100))})},[]),qn.createElement("svg",{className:"legend-area",ref:t})}function yge({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s}){return qn.createElement(qn.Fragment,null,qn.createElement(gge,{counter:n,displayMonth:!1,dataset:"averageDemandBaseline"}),qn.createElement(mge,null),qn.createElement("div",{className:"styled-input"},qn.createElement("button",{onClick:()=>{s(A=>!A)}},i?"Pause":"Play"),qn.createElement("div",null,qn.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:n,onChange:function(A){r(parseInt(A.target.value))}}),qn.createElement("input",{onChange:function(A){s(!1),r(parseInt(A.target.value))},onInput:function(A){r(parseInt(A.target.value))},value:n,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))),qn.createElement("div",{onChange:function(A){e(A.target.value)},style:{position:"absolute",display:"block",bottom:"60%",right:"0",transform:"translateY(50%)"}},qn.createElement("div",null,qn.createElement("input",{type:"radio",name:"option",value:"0",checked:t==0}),qn.createElement("label",{htmlFor:"option1"},"Option 1")),qn.createElement("div",null,qn.createElement("input",{type:"radio",name:"option",value:"1",checked:t==1}),qn.createElement("label",{htmlFor:"option2"},"Option 2")),qn.createElement("div",null,qn.createElement("input",{type:"radio",name:"option",value:"2",checked:t==2}),qn.createElement("label",{htmlFor:"option2"},"GW")),qn.createElement("div",null,qn.createElement("input",{type:"radio",name:"option",value:"3",checked:t==3}),qn.createElement("label",{htmlFor:"option2"},"Scenario Unmet Dem")),qn.createElement("div",null,qn.createElement("input",{type:"radio",name:"option",value:"4",checked:t==4}),qn.createElement("label",{htmlFor:"option2"},"Difference"))))}const _ge=/^[og]\s*(.+)?/,vge=/^mtllib /,xge=/^usemtl /;class yS{constructor(e){let{index:n,name:r="",mtllib:i,smooth:s,groupStart:A}=e;this.index=n,this.name=r,this.mtllib=i,this.smooth=s,this.groupStart=A,this.groupEnd=-1,this.groupCount=-1,this.inherited=!1}clone(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.index;return new yS({index:e,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0})}}class wge{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.name=e,this.geometry={vertices:[],normals:[],colors:[],uvs:[]},this.materials=[],this.smooth=!0,this.fromDeclaration=null}startMaterial(e,n){const r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);const i=new yS({index:this.materials.length,name:e,mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:r!==void 0?r.smooth:this.smooth,groupStart:r!==void 0?r.groupEnd:0});return this.materials.push(i),i}currentMaterial(){if(this.materials.length>0)return this.materials[this.materials.length-1]}_finalize(e){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),e&&this.materials.length>1)for(let r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}}class bge{constructor(){this.objects=[],this.object=null,this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.materialLibraries=[],this.startObject("",!1)}startObject(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.object&&!this.object.fromDeclaration){this.object.name=e,this.object.fromDeclaration=n;return}const r=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object=new wge(e),this.object.fromDeclaration=n,r&&r.name&&typeof r.clone=="function"){const i=r.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)}finalize(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)}parseVertexIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/3)*3}parseNormalIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/3)*3}parseUVIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/2)*2}addVertex(e,n,r){const i=this.vertices,s=this.object.geometry.vertices;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addVertexPoint(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addVertexLine(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addNormal(e,n,r){const i=this.normals,s=this.object.geometry.normals;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addColor(e,n,r){const i=this.colors,s=this.object.geometry.colors;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addUV(e,n,r){const i=this.uvs,s=this.object.geometry.uvs;s.push(i[e+0],i[e+1]),s.push(i[n+0],i[n+1]),s.push(i[r+0],i[r+1])}addUVLine(e){const n=this.uvs;this.object.geometry.uvs.push(n[e+0],n[e+1])}addFace(e,n,r,i,s,A,a,y,w){const P=this.vertices.length;let I=this.parseVertexIndex(e,P),L=this.parseVertexIndex(n,P),U=this.parseVertexIndex(r,P);if(this.addVertex(I,L,U),i!==void 0&&i!==""){const W=this.uvs.length;I=this.parseUVIndex(i,W),L=this.parseUVIndex(s,W),U=this.parseUVIndex(A,W),this.addUV(I,L,U)}if(a!==void 0&&a!==""){const W=this.normals.length;I=this.parseNormalIndex(a,W),L=a===y?I:this.parseNormalIndex(y,W),U=a===w?I:this.parseNormalIndex(w,W),this.addNormal(I,L,U)}this.colors.length>0&&this.addColor(I,L,U)}addPointGeometry(e){this.object.geometry.type="Points";const n=this.vertices.length;for(const r of e)this.addVertexPoint(this.parseVertexIndex(r,n))}addLineGeometry(e,n){this.object.geometry.type="Line";const r=this.vertices.length,i=this.uvs.length;for(const s of e)this.addVertexLine(this.parseVertexIndex(s,r));for(const s of n)this.addUVLine(this.parseUVIndex(s,i))}}function Ege(t){const e=new bge;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let r="",i="",s=0,A=[];const a=typeof"".trimLeft=="function";for(let P=0,I=n.length;P<I;P++)if(r=n[P],r=a?r.trimLeft():r.trim(),s=r.length,s!==0&&(i=r.charAt(0),i!=="#"))if(i==="v"){const L=r.split(/\s+/);switch(L[0]){case"v":e.vertices.push(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3])),L.length>=7&&e.colors.push(parseFloat(L[4]),parseFloat(L[5]),parseFloat(L[6]));break;case"vn":e.normals.push(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3]));break;case"vt":e.uvs.push(parseFloat(L[1]),parseFloat(L[2]));break}}else if(i==="f"){const U=r.substr(1).trim().split(/\s+/),W=[];for(let ae=0,K=U.length;ae<K;ae++){const ne=U[ae];if(ne.length>0){const ie=ne.split("/");W.push(ie)}}const q=W[0];for(let ae=1,K=W.length-1;ae<K;ae++){const ne=W[ae],ie=W[ae+1];e.addFace(q[0],ne[0],ie[0],q[1],ne[1],ie[1],q[2],ne[2],ie[2])}}else if(i==="l"){const L=r.substring(1).trim().split(" ");let U;const W=[];if(r.indexOf("/")===-1)U=L;else{U=[];for(let q=0,ae=L.length;q<ae;q++){const K=L[q].split("/");K[0]!==""&&U.push(K[0]),K[1]!==""&&W.push(K[1])}}e.addLineGeometry(U,W)}else if(i==="p"){const U=r.substr(1).trim().split(" ");e.addPointGeometry(U)}else if((A=_ge.exec(r))!==null){const L=(" "+A[0].substr(1).trim()).substr(1);e.startObject(L)}else if(xge.test(r))e.object.startMaterial(r.substring(7).trim(),e.materialLibraries);else if(vge.test(r))e.materialLibraries.push(r.substring(7).trim());else if(i==="s"){if(A=r.split(" "),A.length>1){const U=A[1].trim().toLowerCase();e.object.smooth=U!=="0"&&U!=="off"}else e.object.smooth=!0;const L=e.object.currentMaterial();L&&(L.smooth=e.object.smooth)}else{if(r==="\0")continue;throw new Error('Unexpected line: "'.concat(r,'"'))}e.finalize();const y=[],w=[];for(const P of e.objects){const{geometry:I}=P;if(I.vertices.length===0)continue;const L={header:{vertexCount:I.vertices.length/3},attributes:{}};switch(I.type){case"Points":L.mode=0;break;case"Line":L.mode=1;break;default:L.mode=4;break}L.attributes.POSITION={value:new Float32Array(I.vertices),size:3},I.normals.length>0&&(L.attributes.NORMAL={value:new Float32Array(I.normals),size:3}),I.colors.length>0&&(L.attributes.COLOR_0={value:new Float32Array(I.colors),size:3}),I.uvs.length>0&&(L.attributes.TEXCOORD_0={value:new Float32Array(I.uvs),size:2}),L.materials=[];for(const U of P.materials){const W={name:U.name,flatShading:!U.smooth};L.materials.push(W),w.push(W)}L.name=P.name,y.push(L)}return{meshes:y,materials:w}}function Tge(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;for(const i in e)n=n||new Map,i!=="value"&&n.set(i,JSON.stringify(e[i]));const r=[];for(const i in t){const s=t[i],A=Sge(i,s);r.push(A)}return new n0(r,n)}function Sge(t,e){const n=new Map;for(const s in e)s!=="value"&&n.set(s,JSON.stringify(e[s]));const r=xue(e.value);return!("size"in e)||e.size===1?new Lp(t,r,!1,n):new Lp(t,new vue(e.size,new Lp("value",r)),!1,n)}function M6(t,e){const{meshes:n}=Ege(t),r=n.reduce((a,y)=>a+y.header.vertexCount,0),i=Mge(n,r),s={vertexCount:r,boundingBox:jz(i)},A=Tge(i,{mode:4,boundingBox:s.boundingBox});return{loaderData:{header:{}},schema:A,header:s,mode:4,attributes:i}}function Mge(t,e){const n=new Float32Array(e*3);let r,i,s,A=0;for(const y of t){const{POSITION:w,NORMAL:P,COLOR_0:I,TEXCOORD_0:L}=y.attributes;n.set(w.value,A*3),P&&(r=r||new Float32Array(e*3),r.set(P.value,A*3)),I&&(i=i||new Float32Array(e*3),i.set(I.value,A*3)),L&&(s=s||new Float32Array(e*2),s.set(L.value,A*2)),A+=w.value.length/3}const a={};return a.POSITION={value:n,size:3},r&&(a.NORMAL={value:r,size:3}),i&&(a.COLOR_0={value:i,size:3}),s&&(a.TEXCOORD_0={value:s,size:2}),a}const Cge="3.4.14",Pge={name:"OBJ",id:"obj",module:"obj",version:Cge,worker:!0,extensions:["obj"],mimeTypes:["text/plain"],testText:Ige,options:{obj:{}}};function Ige(t){return t[0]==="v"}const fF={...Pge,parse:async(t,e)=>M6(new TextDecoder().decode(t)),parseTextSync:(t,e)=>M6(t)};var Yi=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(X){return e.locateFile?e.locateFile(X,i):i+X}var A;typeof document<"u"&&document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",A=function(H,ee,he){var o=new XMLHttpRequest;o.open("GET",H,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){ee(o.response);return}var Le=Mr(H);if(Le){ee(Le.buffer);return}he()},o.onerror=he,o.send(null)};var a=e.print||console.log.bind(console),y=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var w=0,P=function(X){w=X},I=function(){return w},L=8;function U(X,H,ee,he){switch(ee=ee||"i8",ee.charAt(ee.length-1)==="*"&&(ee="i32"),ee){case"i1":nt[X>>0]=H;break;case"i8":nt[X>>0]=H;break;case"i16":mt[X>>1]=H;break;case"i32":Xt[X>>2]=H;break;case"i64":bi=[H>>>0,(zr=H,+er(zr)>=1?zr>0?(or(+gr(zr/4294967296),4294967295)|0)>>>0:~~+$n((zr-+(~~zr>>>0))/4294967296)>>>0:0)],Xt[X>>2]=bi[0],Xt[X+4>>2]=bi[1];break;case"float":Et[X>>2]=H;break;case"double":fn[X>>3]=H;break;default:Lr("invalid type for setValue: "+ee)}}function W(X,H,ee){switch(H=H||"i8",H.charAt(H.length-1)==="*"&&(H="i32"),H){case"i1":return nt[X>>0];case"i8":return nt[X>>0];case"i16":return mt[X>>1];case"i32":return Xt[X>>2];case"i64":return Xt[X>>2];case"float":return Et[X>>2];case"double":return fn[X>>3];default:Lr("invalid type for getValue: "+H)}return null}var q=!1;function ae(X,H){X||Lr("Assertion failed: "+H)}function K(X){var H=e["_"+X];return ae(H,"Cannot call unknown function "+X+", make sure it is exported"),H}function ne(X,H,ee,he,o){var G={string:function(ft){var Lt=0;if(ft!=null&&ft!==0){var Dt=(ft.length<<2)+1;Lt=Cs(Dt),Qe(ft,Lt,Dt)}return Lt},array:function(ft){var Lt=Cs(ft.length);return Je(ft,Lt),Lt}};function Le(ft){return H==="string"?Me(ft):H==="boolean"?!!ft:ft}var Ie=K(X),Pe=[],ke=0;if(he)for(var We=0;We<he.length;We++){var at=G[ee[We]];at?(ke===0&&(ke=ri()),Pe[We]=at(he[We])):Pe[We]=he[We]}var $e=Ie.apply(null,Pe);return $e=Le($e),ke!==0&&kr(ke),$e}function ie(X,H,ee,he){ee=ee||[];var o=ee.every(function(Le){return Le==="number"}),G=H!=="string";return G&&o&&!he?K(X):function(){return ne(X,H,ee,arguments)}}var fe=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function ye(X,H,ee){for(var he=H+ee,o=H;X[o]&&!(o>=he);)++o;if(o-H>16&&X.subarray&&fe)return fe.decode(X.subarray(H,o));for(var G="";H<o;){var Le=X[H++];if(!(Le&128)){G+=String.fromCharCode(Le);continue}var Ie=X[H++]&63;if((Le&224)==192){G+=String.fromCharCode((Le&31)<<6|Ie);continue}var Pe=X[H++]&63;if((Le&240)==224?Le=(Le&15)<<12|Ie<<6|Pe:Le=(Le&7)<<18|Ie<<12|Pe<<6|X[H++]&63,Le<65536)G+=String.fromCharCode(Le);else{var ke=Le-65536;G+=String.fromCharCode(55296|ke>>10,56320|ke&1023)}}return G}function Me(X,H){return X?ye(qe,X,H):""}function He(X,H,ee,he){if(!(he>0))return 0;for(var o=ee,G=ee+he-1,Le=0;Le<X.length;++Le){var Ie=X.charCodeAt(Le);if(Ie>=55296&&Ie<=57343){var Pe=X.charCodeAt(++Le);Ie=65536+((Ie&1023)<<10)|Pe&1023}if(Ie<=127){if(ee>=G)break;H[ee++]=Ie}else if(Ie<=2047){if(ee+1>=G)break;H[ee++]=192|Ie>>6,H[ee++]=128|Ie&63}else if(Ie<=65535){if(ee+2>=G)break;H[ee++]=224|Ie>>12,H[ee++]=128|Ie>>6&63,H[ee++]=128|Ie&63}else{if(ee+3>=G)break;H[ee++]=240|Ie>>18,H[ee++]=128|Ie>>12&63,H[ee++]=128|Ie>>6&63,H[ee++]=128|Ie&63}}return H[ee]=0,ee-o}function Qe(X,H,ee){return He(X,qe,H,ee)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Je(X,H){nt.set(X,H)}function tt(X,H){return X%H>0&&(X+=H-X%H),X}var Ne,nt,qe,mt,Xt,Et,fn;function yt(X){Ne=X,e.HEAP8=nt=new Int8Array(X),e.HEAP16=mt=new Int16Array(X),e.HEAP32=Xt=new Int32Array(X),e.HEAPU8=qe=new Uint8Array(X),e.HEAPU16=new Uint16Array(X),e.HEAPU32=new Uint32Array(X),e.HEAPF32=Et=new Float32Array(X),e.HEAPF64=fn=new Float64Array(X)}var bt=5267040,Kt=24128,In=e.TOTAL_MEMORY||33554432;e.buffer?Ne=e.buffer:Ne=new ArrayBuffer(In),In=Ne.byteLength,yt(Ne),Xt[Kt>>2]=bt;function En(X){for(;X.length>0;){var H=X.shift();if(typeof H=="function"){H();continue}var ee=H.func;typeof ee=="number"?H.arg===void 0?e.dynCall_v(ee):e.dynCall_vi(ee,H.arg):ee(H.arg===void 0?null:H.arg)}}var Er=[],Jn=[],ir=[],Ar=[];function Nn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Mn(e.preRun.shift());En(Er)}function xr(){En(Jn)}function xt(){En(ir)}function nn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)vt(e.postRun.shift());En(Ar)}function Mn(X){Er.unshift(X)}function vt(X){Ar.unshift(X)}var er=Math.abs,$n=Math.ceil,gr=Math.floor,or=Math.min,tr=0,Zr=null;function Un(X){tr++,e.monitorRunDependencies&&e.monitorRunDependencies(tr)}function wi(X){if(tr--,e.monitorRunDependencies&&e.monitorRunDependencies(tr),tr==0&&Zr){var H=Zr;Zr=null,H()}}e.preloadedImages={},e.preloadedAudios={};var Hn=null,Di="data:application/octet-stream;base64,";function oo(X){return String.prototype.startsWith?X.startsWith(Di):X.indexOf(Di)===0}var zr,bi;Hn="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var Io=24144;function Ki(X){return X}function ct(X){var H=/\b__Z[\w\d_]+/g;return X.replace(H,function(ee){var he=ee;return ee===he?ee:he+" ["+ee+"]"})}function It(){var X=new Error;if(!X.stack){try{throw new Error(0)}catch(H){X=H}if(!X.stack)return"(no stack trace available)"}return X.stack.toString()}function Ms(){var X=It();return e.extraStackTrace&&(X+=`
`+e.extraStackTrace()),ct(X)}function pi(X,H,ee,he){Lr("Assertion failed: "+Me(X)+", at: "+[H?Me(H):"unknown filename",ee,he?Me(he):"unknown function"])}function Rn(){return nt.length}function Ri(X,H,ee){qe.set(qe.subarray(H,H+ee),X)}function Ei(X){return e.___errno_location&&(Xt[e.___errno_location()>>2]=X),X}function Ti(X){Lr("OOM")}function Ji(X){try{var H=new ArrayBuffer(X);return H.byteLength!=X?void 0:(new Int8Array(H).set(nt),Vr(H),yt(H),1)}catch{}}function kt(X){var H=Rn(),ee=16777216,he=2147483648-ee;if(X>he)return!1;for(var o=16777216,G=Math.max(H,o);G<X;)G<=536870912?G=tt(2*G,ee):G=Math.min(tt((3*G+2147483648)/4,ee),he);var Le=Ji(G);return!!Le}var Tn=typeof atob=="function"?atob:function(X){var H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ee="",he,o,G,Le,Ie,Pe,ke,We=0;X=X.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Le=H.indexOf(X.charAt(We++)),Ie=H.indexOf(X.charAt(We++)),Pe=H.indexOf(X.charAt(We++)),ke=H.indexOf(X.charAt(We++)),he=Le<<2|Ie>>4,o=(Ie&15)<<4|Pe>>2,G=(Pe&3)<<6|ke,ee=ee+String.fromCharCode(he),Pe!==64&&(ee=ee+String.fromCharCode(o)),ke!==64&&(ee=ee+String.fromCharCode(G));while(We<X.length);return ee};function wn(X){try{for(var H=Tn(X),ee=new Uint8Array(H.length),he=0;he<H.length;++he)ee[he]=H.charCodeAt(he);return ee}catch{throw new Error("Converting base64 string to bytes failed.")}}function Mr(X){if(oo(X))return wn(X.slice(Di.length))}var fs={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},mn={a:Lr,b:P,c:I,d:pi,e:Ei,f:Rn,g:Ri,h:kt,i:Ti,j:Ki,k:ct,l:Ji,m:It,n:Ms,o:Io,p:Kt},Ze=function(X,H,ee){"almost asm";var he=new X.Int8Array(ee),o=new X.Int32Array(ee);new X.Uint8Array(ee),new X.Float32Array(ee);var G=new X.Float64Array(ee),Le=H.o|0,Ie=H.p|0,Pe=X.Math.floor,ke=X.Math.abs,We=X.Math.sqrt,at=X.Math.pow,$e=X.Math.cos,ft=X.Math.sin,Lt=X.Math.tan,Dt=X.Math.acos,rn=X.Math.asin,jt=X.Math.atan,dn=X.Math.atan2,Qt=X.Math.ceil,on=X.Math.imul,vn=X.Math.min,Ot=X.Math.max,Oe=X.Math.clz32,Mt=H.b,Se=H.c,An=H.d,ii=H.e,nr=H.f,ea=H.g,De=H.h,Ia=H.i,we=24160;function ko(m){return he=new Int8Array(m),o=new Int32Array(m),G=new Float64Array(m),ee=m,!0}function ds(m){m=m|0;var g=0;return g=we,we=we+m|0,we=we+15&-16,g|0}function ka(){return we|0}function La(m){m=m|0,we=m}function ta(m,g){m=m|0,we=m}function Al(m,g){m=m|0,g=g|0;var v=0,E=0,C=0;return(m|0)<0?(g=2,g|0):(m|0)>13780509?(g=Va(15,g)|0,g|0):(v=((m|0)<0)<<31>>31,C=V(m|0,v|0,3,0)|0,E=Se()|0,v=d(m|0,v|0,1,0)|0,v=V(C|0,E|0,v|0,Se()|0)|0,v=d(v|0,Se()|0,1,0)|0,m=Se()|0,o[g>>2]=v,o[g+4>>2]=m,g=0,g|0)}function na(m,g,v,E){return m=m|0,g=g|0,v=v|0,E=E|0,Yr(m,g,v,E,0)|0}function Yr(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0,J=0;if(Q=we,we=we+16|0,O=Q,!(ge(m,g,v,E,C)|0))return E=0,we=Q,E|0;do if((v|0)>=0){if((v|0)>13780509){if(R=Va(15,O)|0,R|0)break;N=O,O=o[N>>2]|0,N=o[N+4>>2]|0}else R=((v|0)<0)<<31>>31,J=V(v|0,R|0,3,0)|0,N=Se()|0,R=d(v|0,R|0,1,0)|0,R=V(J|0,N|0,R|0,Se()|0)|0,R=d(R|0,Se()|0,1,0)|0,N=Se()|0,o[O>>2]=R,o[O+4>>2]=N,O=R;if(Te(E|0,0,O<<3|0)|0,C|0){Te(C|0,0,O<<2|0)|0,R=Ee(m,g,v,E,C,O,N,0)|0;break}R=h(O,4)|0,R?(J=Ee(m,g,v,E,R,O,N,0)|0,l(R),R=J):R=13}else R=2;while(0);return J=R,we=Q,J|0}function ge(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0;if(Ye=we,we=we+16|0,je=Ye,Be=Ye+8|0,Re=je,o[Re>>2]=m,o[Re+4>>2]=g,(v|0)<0)return Be=2,we=Ye,Be|0;if(R=E,o[R>>2]=m,o[R+4>>2]=g,R=(C|0)!=0,R&&(o[C>>2]=0),fr(m,g)|0)return Be=9,we=Ye,Be|0;o[Be>>2]=0;e:do if((v|0)>=1)if(R)for(le=1,J=0,de=0,Re=1,R=m;;){if(!(J|de)){if(R=Fe(R,g,4,Be,je)|0,R|0)break e;if(g=je,R=o[g>>2]|0,g=o[g+4>>2]|0,fr(R,g)|0){R=9;break e}}if(R=Fe(R,g,o[22384+(de<<2)>>2]|0,Be,je)|0,R|0)break e;if(g=je,R=o[g>>2]|0,g=o[g+4>>2]|0,m=E+(le<<3)|0,o[m>>2]=R,o[m+4>>2]=g,o[C+(le<<2)>>2]=Re,m=J+1|0,O=(m|0)==(Re|0),N=de+1|0,Q=(N|0)==6,fr(R,g)|0){R=9;break e}if(Re=Re+(Q&O&1)|0,(Re|0)>(v|0)){R=0;break}else le=le+1|0,J=O?0:m,de=O?Q?0:N:de}else for(le=1,J=0,de=0,Re=1,R=m;;){if(!(J|de)){if(R=Fe(R,g,4,Be,je)|0,R|0)break e;if(g=je,R=o[g>>2]|0,g=o[g+4>>2]|0,fr(R,g)|0){R=9;break e}}if(R=Fe(R,g,o[22384+(de<<2)>>2]|0,Be,je)|0,R|0)break e;if(g=je,R=o[g>>2]|0,g=o[g+4>>2]|0,m=E+(le<<3)|0,o[m>>2]=R,o[m+4>>2]=g,m=J+1|0,O=(m|0)==(Re|0),N=de+1|0,Q=(N|0)==6,fr(R,g)|0){R=9;break e}if(Re=Re+(Q&O&1)|0,(Re|0)>(v|0)){R=0;break}else le=le+1|0,J=O?0:m,de=O?Q?0:N:de}else R=0;while(0);return Be=R,we=Ye,Be|0}function Ee(m,g,v,E,C,R,O,N){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0,R=R|0,O=O|0,N=N|0;var Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0;if(Ye=we,we=we+16|0,je=Ye+8|0,Be=Ye,Q=Y(m|0,g|0,R|0,O|0)|0,le=Se()|0,de=E+(Q<<3)|0,ht=de,ut=o[ht>>2]|0,ht=o[ht+4>>2]|0,J=(ut|0)==(m|0)&(ht|0)==(g|0),!((ut|0)==0&(ht|0)==0|J))do Q=d(Q|0,le|0,1,0)|0,Q=$(Q|0,Se()|0,R|0,O|0)|0,le=Se()|0,de=E+(Q<<3)|0,ut=de,ht=o[ut>>2]|0,ut=o[ut+4>>2]|0,J=(ht|0)==(m|0)&(ut|0)==(g|0);while(!((ht|0)==0&(ut|0)==0|J));if(Q=C+(Q<<2)|0,J&&(o[Q>>2]|0)<=(N|0)||(ut=de,o[ut>>2]=m,o[ut+4>>2]=g,o[Q>>2]=N,(N|0)>=(v|0)))return ut=0,we=Ye,ut|0;switch(J=N+1|0,o[je>>2]=0,Q=Fe(m,g,2,je,Be)|0,Q|0){case 9:{Re=9;break}case 0:{Q=Be,Q=Ee(o[Q>>2]|0,o[Q+4>>2]|0,v,E,C,R,O,J)|0,Q||(Re=9);break}}e:do if((Re|0)==9){switch(o[je>>2]=0,Q=Fe(m,g,3,je,Be)|0,Q|0){case 9:break;case 0:{if(Q=Be,Q=Ee(o[Q>>2]|0,o[Q+4>>2]|0,v,E,C,R,O,J)|0,Q|0)break e;break}default:break e}switch(o[je>>2]=0,Q=Fe(m,g,1,je,Be)|0,Q|0){case 9:break;case 0:{if(Q=Be,Q=Ee(o[Q>>2]|0,o[Q+4>>2]|0,v,E,C,R,O,J)|0,Q|0)break e;break}default:break e}switch(o[je>>2]=0,Q=Fe(m,g,5,je,Be)|0,Q|0){case 9:break;case 0:{if(Q=Be,Q=Ee(o[Q>>2]|0,o[Q+4>>2]|0,v,E,C,R,O,J)|0,Q|0)break e;break}default:break e}switch(o[je>>2]=0,Q=Fe(m,g,4,je,Be)|0,Q|0){case 9:break;case 0:{if(Q=Be,Q=Ee(o[Q>>2]|0,o[Q+4>>2]|0,v,E,C,R,O,J)|0,Q|0)break e;break}default:break e}switch(o[je>>2]=0,Q=Fe(m,g,6,je,Be)|0,Q|0){case 9:break;case 0:{if(Q=Be,Q=Ee(o[Q>>2]|0,o[Q+4>>2]|0,v,E,C,R,O,J)|0,Q|0)break e;break}default:break e}return ut=0,we=Ye,ut|0}while(0);return ut=Q,we=Ye,ut|0}function Fe(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0;if(v>>>0>6)return C=1,C|0;if(de=(o[E>>2]|0)%6|0,o[E>>2]=de,(de|0)>0){R=0;do v=Ao(v)|0,R=R+1|0;while((R|0)<(o[E>>2]|0))}if(de=te(m|0,g|0,45)|0,Se()|0,le=de&127,le>>>0>121)return C=5,C|0;Q=Kr(m,g)|0,R=te(m|0,g|0,52)|0,Se()|0,R=R&15;e:do if(!R)J=8;else{for(;;){if(O=(15-R|0)*3|0,N=te(m|0,g|0,O|0)|0,Se()|0,N=N&7,(N|0)==7){g=5;break}if(Be=(gi(R)|0)==0,R=R+-1|0,Re=ue(7,0,O|0)|0,g=g&~(Se()|0),je=ue(o[(Be?432:16)+(N*28|0)+(v<<2)>>2]|0,0,O|0)|0,O=Se()|0,v=o[(Be?640:224)+(N*28|0)+(v<<2)>>2]|0,m=je|m&~Re,g=O|g,!v){v=0;break e}if(!R){J=8;break e}}return g|0}while(0);(J|0)==8&&(Be=o[848+(le*28|0)+(v<<2)>>2]|0,je=ue(Be|0,0,45)|0,m=je|m,g=Se()|0|g&-1040385,v=o[4272+(le*28|0)+(v<<2)>>2]|0,(Be&127|0)==127&&(Be=ue(o[848+(le*28|0)+20>>2]|0,0,45)|0,g=Se()|0|g&-1040385,v=o[4272+(le*28|0)+20>>2]|0,m=Ls(Be|m,g)|0,g=Se()|0,o[E>>2]=(o[E>>2]|0)+1)),N=te(m|0,g|0,45)|0,Se()|0,N=N&127;e:do if(Vn(N)|0){t:do if((Kr(m,g)|0)==1){if((le|0)!=(N|0))if(sA(N,o[7696+(le*28|0)>>2]|0)|0){m=cA(m,g)|0,O=1,g=Se()|0;break}else An(23313,22416,436,22424);switch(Q|0){case 3:{m=Ls(m,g)|0,g=Se()|0,o[E>>2]=(o[E>>2]|0)+1,O=0;break t}case 5:{m=cA(m,g)|0,g=Se()|0,o[E>>2]=(o[E>>2]|0)+5,O=0;break t}case 0:return Be=9,Be|0;default:return Be=1,Be|0}}else O=0;while(0);if((v|0)>0){R=0;do m=ZA(m,g)|0,g=Se()|0,R=R+1|0;while((R|0)!=(v|0))}if((le|0)!=(N|0)){if(!(nA(N)|0)){if((O|0)!=0|(Kr(m,g)|0)!=5)break;o[E>>2]=(o[E>>2]|0)+1;break}switch(de&127){case 8:case 118:break e}(Kr(m,g)|0)!=3&&(o[E>>2]=(o[E>>2]|0)+1)}}else if((v|0)>0){R=0;do m=Ls(m,g)|0,g=Se()|0,R=R+1|0;while((R|0)!=(v|0))}while(0);return o[E>>2]=((o[E>>2]|0)+v|0)%6|0,Be=C,o[Be>>2]=m,o[Be+4>>2]=g,Be=0,Be|0}function ot(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0,J=0;for(N=we,we=we+16|0,R=N,O=N+8|0,C=(fr(m,g)|0)==0,C=C?1:2;;){if(o[O>>2]=0,J=(Fe(m,g,C,O,R)|0)==0,Q=R,J&((o[Q>>2]|0)==(v|0)?(o[Q+4>>2]|0)==(E|0):0)){m=4;break}if(C=C+1|0,C>>>0>=7){C=7,m=4;break}}return(m|0)==4?(we=N,C|0):0}function wt(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0;if(Be=we,we=we+16|0,Re=Be,je=Be+8|0,de=Re,o[de>>2]=m,o[de+4>>2]=g,!v)return je=E,o[je>>2]=m,o[je+4>>2]=g,je=0,we=Be,je|0;o[je>>2]=0;e:do if(fr(m,g)|0)m=9;else{if(R=(v|0)>0,R){C=0,de=m;do{if(m=Fe(de,g,4,je,Re)|0,m|0)break e;if(g=Re,de=o[g>>2]|0,g=o[g+4>>2]|0,C=C+1|0,fr(de,g)|0){m=9;break e}}while((C|0)<(v|0));if(le=E,o[le>>2]=de,o[le+4>>2]=g,le=v+-1|0,R){J=0,m=1;do{if(C=22384+(J<<2)|0,(J|0)==5)for(O=o[C>>2]|0,R=0,C=m;;){if(m=Re,m=Fe(o[m>>2]|0,o[m+4>>2]|0,O,je,Re)|0,m|0)break e;if((R|0)!=(le|0))if(Q=Re,N=o[Q>>2]|0,Q=o[Q+4>>2]|0,m=E+(C<<3)|0,o[m>>2]=N,o[m+4>>2]=Q,!(fr(N,Q)|0))m=C+1|0;else{m=9;break e}else m=C;if(R=R+1|0,(R|0)>=(v|0))break;C=m}else for(O=Re,Q=o[C>>2]|0,N=0,C=m,R=o[O>>2]|0,O=o[O+4>>2]|0;;){if(m=Fe(R,O,Q,je,Re)|0,m|0)break e;if(O=Re,R=o[O>>2]|0,O=o[O+4>>2]|0,m=E+(C<<3)|0,o[m>>2]=R,o[m+4>>2]=O,m=C+1|0,fr(R,O)|0){m=9;break e}if(N=N+1|0,(N|0)>=(v|0))break;C=m}J=J+1|0}while(J>>>0<6);m=Re,O=de,C=o[m>>2]|0,R=g,m=o[m+4>>2]|0}else O=de,C=de,R=g,m=g}else O=E,o[O>>2]=m,o[O+4>>2]=g,O=m,C=m,R=g,m=g;m=(O|0)==(C|0)&(R|0)==(m|0)?0:9}while(0);return je=m,we=Be,je|0}function Wt(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0,J=0;if(N=we,we=we+48|0,C=N+16|0,R=N+8|0,O=N,v|0)return O=15,we=N,O|0;if(J=m,Q=o[J+4>>2]|0,v=R,o[v>>2]=o[J>>2],o[v+4>>2]=Q,fo(R,C),g=qu(C,g,O)|0,!g){if(v=o[R>>2]|0,R=o[m+8>>2]|0,(R|0)>0){C=o[m+12>>2]|0,g=0;do v=(o[C+(g<<3)>>2]|0)+v|0,g=g+1|0;while((g|0)<(R|0))}g=O,C=o[g>>2]|0,g=o[g+4>>2]|0,R=((v|0)<0)<<31>>31,(g|0)<(R|0)|(g|0)==(R|0)&C>>>0<v>>>0?(g=O,o[g>>2]=v,o[g+4>>2]=R,g=R):v=C,Q=d(v|0,g|0,12,0)|0,J=Se()|0,g=O,o[g>>2]=Q,o[g+4>>2]=J,g=E,o[g>>2]=Q,o[g+4>>2]=J,g=0}return J=g,we=N,J|0}function kn(m,g,v,E,C,R,O){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0,R=R|0,O=O|0;var N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0,it=0,Xe=0,Vt=0,Bt=0,dt=0,_t=0,Cn=0,xn=0,gn=0,yn=0,bn=0,Ln=0,sr=0,Pn=0,_r=0,$r=0,Ha=0;if(sr=we,we=we+64|0,gn=sr+48|0,yn=sr+32|0,bn=sr+24|0,Vt=sr+8|0,Bt=sr,Q=o[m>>2]|0,(Q|0)<=0)return Ln=0,we=sr,Ln|0;for(dt=m+4|0,_t=gn+8|0,Cn=yn+8|0,xn=Vt+8|0,N=0,it=0;;){J=o[dt>>2]|0,rt=J+(it<<4)|0,o[gn>>2]=o[rt>>2],o[gn+4>>2]=o[rt+4>>2],o[gn+8>>2]=o[rt+8>>2],o[gn+12>>2]=o[rt+12>>2],(it|0)==(Q+-1|0)?(o[yn>>2]=o[J>>2],o[yn+4>>2]=o[J+4>>2],o[yn+8>>2]=o[J+8>>2],o[yn+12>>2]=o[J+12>>2]):(rt=J+(it+1<<4)|0,o[yn>>2]=o[rt>>2],o[yn+4>>2]=o[rt+4>>2],o[yn+8>>2]=o[rt+8>>2],o[yn+12>>2]=o[rt+12>>2]),Q=hl(gn,yn,E,bn)|0;e:do if(Q)J=0,N=Q;else if(J=bn,Q=o[J>>2]|0,J=o[J+4>>2]|0,(J|0)>0|(J|0)==0&Q>>>0>0){ut=0,rt=0;t:for(;;){if(Ha=+G[gn>>3],ht=x(Q|0,J|0,ut|0,rt|0)|0,$r=+(ht>>>0)+4294967296*+(Se()|0),Pn=+(Q>>>0)+4294967296*+(J|0),_r=+(ut>>>0)+4294967296*+(rt|0),G[Vt>>3]=Ha*$r/Pn+ +G[yn>>3]*_r/Pn,G[xn>>3]=+G[_t>>3]*$r/Pn+ +G[Cn>>3]*_r/Pn,Q=ns(Vt,E,Bt)|0,Q|0){N=Q;break}ht=Bt,Ye=o[ht>>2]|0,ht=o[ht+4>>2]|0,Re=Y(Ye|0,ht|0,g|0,v|0)|0,le=Se()|0,Q=O+(Re<<3)|0,de=Q,J=o[de>>2]|0,de=o[de+4>>2]|0;n:do if((J|0)==0&(de|0)==0)Xe=Q,Ln=16;else for(je=0,Be=0;;){if((je|0)>(v|0)|(je|0)==(v|0)&Be>>>0>g>>>0){N=1;break t}if((J|0)==(Ye|0)&(de|0)==(ht|0))break n;if(Q=d(Re|0,le|0,1,0)|0,Re=$(Q|0,Se()|0,g|0,v|0)|0,le=Se()|0,Be=d(Be|0,je|0,1,0)|0,je=Se()|0,Q=O+(Re<<3)|0,de=Q,J=o[de>>2]|0,de=o[de+4>>2]|0,(J|0)==0&(de|0)==0){Xe=Q,Ln=16;break}}while(0);if((Ln|0)==16&&(Ln=0,!((Ye|0)==0&(ht|0)==0))&&(Be=Xe,o[Be>>2]=Ye,o[Be+4>>2]=ht,Be=R+(o[C>>2]<<3)|0,o[Be>>2]=Ye,o[Be+4>>2]=ht,Be=C,Be=d(o[Be>>2]|0,o[Be+4>>2]|0,1,0)|0,Ye=Se()|0,ht=C,o[ht>>2]=Be,o[ht+4>>2]=Ye),ut=d(ut|0,rt|0,1,0)|0,rt=Se()|0,J=bn,Q=o[J>>2]|0,J=o[J+4>>2]|0,!((J|0)>(rt|0)|(J|0)==(rt|0)&Q>>>0>ut>>>0)){J=1;break e}}J=0}else J=1;while(0);if(it=it+1|0,!J){Ln=21;break}if(Q=o[m>>2]|0,(it|0)>=(Q|0)){N=0,Ln=21;break}}return(Ln|0)==21?(we=sr,N|0):0}function Sr(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0,it=0,Xe=0,Vt=0,Bt=0,dt=0,_t=0,Cn=0,xn=0,gn=0,yn=0,bn=0,Ln=0,sr=0,Pn=0,_r=0,$r=0;if($r=we,we=we+112|0,Ln=$r+80|0,Q=$r+72|0,sr=$r,Pn=$r+56|0,v|0)return _r=15,we=$r,_r|0;if(J=m+8|0,_r=_((o[J>>2]<<5)+32|0)|0,!_r)return _r=13,we=$r,_r|0;if(nu(m,_r),yn=m,bn=o[yn+4>>2]|0,v=Q,o[v>>2]=o[yn>>2],o[v+4>>2]=bn,fo(Q,Ln),v=qu(Ln,g,sr)|0,v)yn=0,bn=0;else{if(v=o[Q>>2]|0,R=o[J>>2]|0,(R|0)>0){O=o[m+12>>2]|0,C=0;do v=(o[O+(C<<3)>>2]|0)+v|0,C=C+1|0;while((C|0)!=(R|0));C=v}else C=v;v=sr,R=o[v>>2]|0,v=o[v+4>>2]|0,O=((C|0)<0)<<31>>31,(v|0)<(O|0)|(v|0)==(O|0)&R>>>0<C>>>0?(v=sr,o[v>>2]=C,o[v+4>>2]=O,v=O):C=R,yn=d(C|0,v|0,12,0)|0,bn=Se()|0,v=sr,o[v>>2]=yn,o[v+4>>2]=bn,v=0}if(v|0)return l(_r),_r=v,we=$r,_r|0;if(C=h(yn,8)|0,!C)return l(_r),_r=13,we=$r,_r|0;if(N=h(yn,8)|0,!N)return l(_r),l(C),_r=13,we=$r,_r|0;xn=Ln,o[xn>>2]=0,o[xn+4>>2]=0,xn=m,gn=o[xn+4>>2]|0,v=Q,o[v>>2]=o[xn>>2],o[v+4>>2]=gn,v=kn(Q,yn,bn,g,Ln,C,N)|0;e:do if(v)l(C),l(N),l(_r);else{t:do if((o[J>>2]|0)>0){for(O=m+12|0,R=0;v=kn((o[O>>2]|0)+(R<<3)|0,yn,bn,g,Ln,C,N)|0,R=R+1|0,!(v|0);)if((R|0)>=(o[J>>2]|0))break t;l(C),l(N),l(_r);break e}while(0);(bn|0)>0|(bn|0)==0&yn>>>0>0&&Te(N|0,0,yn<<3|0)|0,gn=Ln,xn=o[gn+4>>2]|0;t:do if((xn|0)>0|(xn|0)==0&(o[gn>>2]|0)>>>0>0){dt=C,_t=N,Cn=C,xn=N,gn=C,v=C,Xe=C,Vt=N,Bt=N,C=N;n:for(;;){for(ht=0,ut=0,rt=0,it=0,R=0,O=0;;){N=sr,Q=N+56|0;do o[N>>2]=0,N=N+4|0;while((N|0)<(Q|0));if(g=dt+(ht<<3)|0,J=o[g>>2]|0,g=o[g+4>>2]|0,ge(J,g,1,sr,0)|0){N=sr,Q=N+56|0;do o[N>>2]=0,N=N+4|0;while((N|0)<(Q|0));N=h(7,4)|0,N|0&&(Ee(J,g,1,sr,N,7,0,0)|0,l(N))}for(Ye=0;;){Be=sr+(Ye<<3)|0,je=o[Be>>2]|0,Be=o[Be+4>>2]|0;r:do if((je|0)==0&(Be|0)==0)N=R,Q=O;else{if(le=Y(je|0,Be|0,yn|0,bn|0)|0,J=Se()|0,N=E+(le<<3)|0,g=N,Q=o[g>>2]|0,g=o[g+4>>2]|0,!((Q|0)==0&(g|0)==0)){de=0,Re=0;do{if((de|0)>(bn|0)|(de|0)==(bn|0)&Re>>>0>yn>>>0)break n;if((Q|0)==(je|0)&(g|0)==(Be|0)){N=R,Q=O;break r}N=d(le|0,J|0,1,0)|0,le=$(N|0,Se()|0,yn|0,bn|0)|0,J=Se()|0,Re=d(Re|0,de|0,1,0)|0,de=Se()|0,N=E+(le<<3)|0,g=N,Q=o[g>>2]|0,g=o[g+4>>2]|0}while(!((Q|0)==0&(g|0)==0))}(je|0)==0&(Be|0)==0?(N=R,Q=O):(co(je,Be,Pn)|0,ca(m,_r,Pn)|0&&(Re=d(R|0,O|0,1,0)|0,O=Se()|0,de=N,o[de>>2]=je,o[de+4>>2]=Be,R=_t+(R<<3)|0,o[R>>2]=je,o[R+4>>2]=Be,R=Re),N=R,Q=O)}while(0);if(Ye=Ye+1|0,Ye>>>0>=7)break;R=N,O=Q}if(ht=d(ht|0,ut|0,1,0)|0,ut=Se()|0,rt=d(rt|0,it|0,1,0)|0,it=Se()|0,O=Ln,R=o[O>>2]|0,O=o[O+4>>2]|0,(it|0)<(O|0)|(it|0)==(O|0)&rt>>>0<R>>>0)R=N,O=Q;else break}if((O|0)>0|(O|0)==0&R>>>0>0){R=0,O=0;do it=dt+(R<<3)|0,o[it>>2]=0,o[it+4>>2]=0,R=d(R|0,O|0,1,0)|0,O=Se()|0,it=Ln,rt=o[it+4>>2]|0;while((O|0)<(rt|0)|((O|0)==(rt|0)?R>>>0<(o[it>>2]|0)>>>0:0))}if(it=Ln,o[it>>2]=N,o[it+4>>2]=Q,(Q|0)>0|(Q|0)==0&N>>>0>0)Ye=C,ht=Bt,ut=gn,rt=Vt,it=_t,C=Xe,Bt=v,Vt=Cn,Xe=Ye,v=ht,gn=xn,xn=ut,Cn=rt,_t=dt,dt=it;else break t}l(Cn),l(xn),l(_r),v=1;break e}else v=N;while(0);l(_r),l(C),l(v),v=0}while(0);return _r=v,we=$r,_r|0}function Jt(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(le=we,we=we+176|0,Q=le,(g|0)<1)return zs(v,0,0),J=0,we=le,J|0;for(N=m,N=te(o[N>>2]|0,o[N+4>>2]|0,52)|0,Se()|0,zs(v,(g|0)>6?g:6,N&15),N=0;E=m+(N<<3)|0,E=Ai(o[E>>2]|0,o[E+4>>2]|0,Q)|0,!(E|0);){if(E=o[Q>>2]|0,(E|0)>0){O=0;do R=Q+8+(O<<4)|0,O=O+1|0,E=Q+8+(((O|0)%(E|0)|0)<<4)|0,C=Fr(v,E,R)|0,C?St(v,C)|0:Ct(v,R,E)|0,E=o[Q>>2]|0;while((O|0)<(E|0))}if(N=N+1|0,(N|0)>=(g|0)){E=0,J=13;break}}return(J|0)==13?(we=le,E|0):(ms(v),J=E,we=le,J|0)}function Cr(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0;if(R=we,we=we+32|0,E=R,C=R+16|0,m=Jt(m,g,C)|0,m|0)return v=m,we=R,v|0;if(o[v>>2]=0,o[v+4>>2]=0,o[v+8>>2]=0,m=Os(C)|0,m|0)do{g=Ut(v)|0;do hA(g,m)|0,O=m+16|0,o[E>>2]=o[O>>2],o[E+4>>2]=o[O+4>>2],o[E+8>>2]=o[O+8>>2],o[E+12>>2]=o[O+12>>2],St(C,m)|0,m=$a(C,E)|0;while(m|0);m=Os(C)|0}while(m|0);return ms(C),m=fA(v)|0,m?(El(v),O=m,we=R,O|0):(O=0,we=R,O|0)}function Vn(m){return m=m|0,m>>>0>121?(m=0,m|0):(m=o[7696+(m*28|0)+16>>2]|0,m|0)}function nA(m){return m=m|0,(m|0)==4|(m|0)==117|0}function rA(m){return m=m|0,o[11120+((o[m>>2]|0)*216|0)+((o[m+4>>2]|0)*72|0)+((o[m+8>>2]|0)*24|0)+(o[m+12>>2]<<3)>>2]|0}function iA(m){return m=m|0,o[11120+((o[m>>2]|0)*216|0)+((o[m+4>>2]|0)*72|0)+((o[m+8>>2]|0)*24|0)+(o[m+12>>2]<<3)+4>>2]|0}function FA(m,g){m=m|0,g=g|0,m=7696+(m*28|0)|0,o[g>>2]=o[m>>2],o[g+4>>2]=o[m+4>>2],o[g+8>>2]=o[m+8>>2],o[g+12>>2]=o[m+12>>2]}function NA(m,g){m=m|0,g=g|0;var v=0,E=0;if(g>>>0>20)return g=-1,g|0;do if((o[11120+(g*216|0)>>2]|0)!=(m|0))if((o[11120+(g*216|0)+8>>2]|0)!=(m|0))if((o[11120+(g*216|0)+16>>2]|0)!=(m|0))if((o[11120+(g*216|0)+24>>2]|0)!=(m|0))if((o[11120+(g*216|0)+32>>2]|0)!=(m|0))if((o[11120+(g*216|0)+40>>2]|0)!=(m|0))if((o[11120+(g*216|0)+48>>2]|0)!=(m|0))if((o[11120+(g*216|0)+56>>2]|0)!=(m|0))if((o[11120+(g*216|0)+64>>2]|0)!=(m|0))if((o[11120+(g*216|0)+72>>2]|0)!=(m|0))if((o[11120+(g*216|0)+80>>2]|0)!=(m|0))if((o[11120+(g*216|0)+88>>2]|0)!=(m|0))if((o[11120+(g*216|0)+96>>2]|0)!=(m|0))if((o[11120+(g*216|0)+104>>2]|0)!=(m|0))if((o[11120+(g*216|0)+112>>2]|0)!=(m|0))if((o[11120+(g*216|0)+120>>2]|0)!=(m|0))if((o[11120+(g*216|0)+128>>2]|0)!=(m|0))if((o[11120+(g*216|0)+136>>2]|0)==(m|0))m=2,v=1,E=2;else{if((o[11120+(g*216|0)+144>>2]|0)==(m|0)){m=0,v=2,E=0;break}if((o[11120+(g*216|0)+152>>2]|0)==(m|0)){m=0,v=2,E=1;break}if((o[11120+(g*216|0)+160>>2]|0)==(m|0)){m=0,v=2,E=2;break}if((o[11120+(g*216|0)+168>>2]|0)==(m|0)){m=1,v=2,E=0;break}if((o[11120+(g*216|0)+176>>2]|0)==(m|0)){m=1,v=2,E=1;break}if((o[11120+(g*216|0)+184>>2]|0)==(m|0)){m=1,v=2,E=2;break}if((o[11120+(g*216|0)+192>>2]|0)==(m|0)){m=2,v=2,E=0;break}if((o[11120+(g*216|0)+200>>2]|0)==(m|0)){m=2,v=2,E=1;break}if((o[11120+(g*216|0)+208>>2]|0)==(m|0)){m=2,v=2,E=2;break}else m=-1;return m|0}else m=2,v=1,E=1;else m=2,v=1,E=0;else m=1,v=1,E=2;else m=1,v=1,E=1;else m=1,v=1,E=0;else m=0,v=1,E=2;else m=0,v=1,E=1;else m=0,v=1,E=0;else m=2,v=0,E=2;else m=2,v=0,E=1;else m=2,v=0,E=0;else m=1,v=0,E=2;else m=1,v=0,E=1;else m=1,v=0,E=0;else m=0,v=0,E=2;else m=0,v=0,E=1;else m=0,v=0,E=0;while(0);return g=o[11120+(g*216|0)+(v*72|0)+(m*24|0)+(E<<3)+4>>2]|0,g|0}function sA(m,g){return m=m|0,g=g|0,(o[7696+(m*28|0)+20>>2]|0)==(g|0)?(g=1,g|0):(g=(o[7696+(m*28|0)+24>>2]|0)==(g|0),g|0)}function ul(m,g){return m=m|0,g=g|0,o[848+(m*28|0)+(g<<2)>>2]|0}function cl(m,g){return m=m|0,g=g|0,(o[848+(m*28|0)>>2]|0)==(g|0)?(g=0,g|0):(o[848+(m*28|0)+4>>2]|0)==(g|0)?(g=1,g|0):(o[848+(m*28|0)+8>>2]|0)==(g|0)?(g=2,g|0):(o[848+(m*28|0)+12>>2]|0)==(g|0)?(g=3,g|0):(o[848+(m*28|0)+16>>2]|0)==(g|0)?(g=4,g|0):(o[848+(m*28|0)+20>>2]|0)==(g|0)?(g=5,g|0):((o[848+(m*28|0)+24>>2]|0)==(g|0)?6:7)|0}function oA(){return 122}function aA(m){m=m|0;var g=0,v=0,E=0;g=0;do ue(g|0,0,45)|0,E=Se()|0|134225919,v=m+(g<<3)|0,o[v>>2]=-1,o[v+4>>2]=E,g=g+1|0;while((g|0)!=122);return 0}function Yn(m){return m=m|0,+G[m+16>>3]<+G[m+24>>3]|0}function UA(m,g){m=m|0,g=g|0;var v=0,E=0,C=0;return v=+G[g>>3],!(v>=+G[m+8>>3])||!(v<=+G[m>>3])?(g=0,g|0):(E=+G[m+16>>3],v=+G[m+24>>3],C=+G[g+8>>3],g=C>=v,m=C<=E&1,E<v?g&&(m=1):g||(m=0),g=(m|0)!=0,g|0)}function qu(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0;Be=we,we=we+288|0,le=Be+264|0,de=Be+96|0,J=Be,N=J,Q=N+96|0;do o[N>>2]=0,N=N+4|0;while((N|0)<(Q|0));return g=Ds(g,J)|0,g|0?(je=g,we=Be,je|0):(Q=J,J=o[Q>>2]|0,Q=o[Q+4>>2]|0,co(J,Q,le)|0,Ai(J,Q,de)|0,O=+wl(le,de+8|0),G[le>>3]=+G[m>>3],Q=le+8|0,G[Q>>3]=+G[m+16>>3],G[de>>3]=+G[m+8>>3],J=de+8|0,G[J>>3]=+G[m+24>>3],C=+wl(le,de),ht=+G[Q>>3]-+G[J>>3],R=+ke(+ht),Ye=+G[le>>3]-+G[de>>3],E=+ke(+Ye),!(ht==0|Ye==0)&&(ht=+be(+R,+E),ht=+Qt(+(C*C/+Ce(+(ht/+Ce(+R,+E)),3)/(O*(O*2.59807621135)*.8))),G[Le>>3]=ht,Re=~~ht>>>0,je=+ke(ht)>=1?ht>0?~~+vn(+Pe(ht/4294967296),4294967295)>>>0:~~+Qt((ht-+(~~ht>>>0))/4294967296)>>>0:0,(o[Le+4>>2]&2146435072|0)!=2146435072)?(de=(Re|0)==0&(je|0)==0,g=v,o[g>>2]=de?1:Re,o[g+4>>2]=de?0:je,g=0):g=1,je=g,we=Be,je|0)}function hl(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0,J=0,le=0;J=we,we=we+288|0,O=J+264|0,N=J+96|0,Q=J,C=Q,R=C+96|0;do o[C>>2]=0,C=C+4|0;while((C|0)<(R|0));return v=Ds(v,Q)|0,v|0?(E=v,we=J,E|0):(v=Q,C=o[v>>2]|0,v=o[v+4>>2]|0,co(C,v,O)|0,Ai(C,v,N)|0,le=+wl(O,N+8|0),le=+Qt(+(+wl(m,g)/(le*2))),G[Le>>3]=le,v=~~le>>>0,C=+ke(le)>=1?le>0?~~+vn(+Pe(le/4294967296),4294967295)>>>0:~~+Qt((le-+(~~le>>>0))/4294967296)>>>0:0,(o[Le+4>>2]&2146435072|0)==2146435072?(E=1,we=J,E|0):(Q=(v|0)==0&(C|0)==0,o[E>>2]=Q?1:v,o[E+4>>2]=Q?0:C,E=0,we=J,E|0))}function Gr(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0,o[m>>2]=g,o[m+4>>2]=v,o[m+8>>2]=E}function Lo(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0;de=g+8|0,o[de>>2]=0,Q=+G[m>>3],O=+ke(+Q),J=+G[m+8>>3],N=+ke(+J)/.8660254037844386,O=O+N*.5,v=~~O,m=~~N,O=O-+(v|0),N=N-+(m|0);do if(O<.5)if(O<.3333333333333333)if(o[g>>2]=v,N<(O+1)*.5){o[g+4>>2]=m;break}else{m=m+1|0,o[g+4>>2]=m;break}else if(Re=1-O,m=(!(N<Re)&1)+m|0,o[g+4>>2]=m,Re<=N&N<O*2){v=v+1|0,o[g>>2]=v;break}else{o[g>>2]=v;break}else{if(!(O<.6666666666666666))if(v=v+1|0,o[g>>2]=v,N<O*.5){o[g+4>>2]=m;break}else{m=m+1|0,o[g+4>>2]=m;break}if(N<1-O){if(o[g+4>>2]=m,O*2+-1<N){o[g>>2]=v;break}}else m=m+1|0,o[g+4>>2]=m;v=v+1|0,o[g>>2]=v}while(0);do if(Q<0)if(m&1){le=(m+1|0)/2|0,le=x(v|0,((v|0)<0)<<31>>31|0,le|0,((le|0)<0)<<31>>31|0)|0,v=~~(+(v|0)-((+(le>>>0)+4294967296*+(Se()|0))*2+1)),o[g>>2]=v;break}else{le=(m|0)/2|0,le=x(v|0,((v|0)<0)<<31>>31|0,le|0,((le|0)<0)<<31>>31|0)|0,v=~~(+(v|0)-(+(le>>>0)+4294967296*+(Se()|0))*2),o[g>>2]=v;break}while(0);le=g+4|0,J<0&&(v=v-((m<<1|1|0)/2|0)|0,o[g>>2]=v,m=0-m|0,o[le>>2]=m),E=m-v|0,(v|0)<0?(C=0-v|0,o[le>>2]=E,o[de>>2]=C,o[g>>2]=0,m=E,v=0):C=0,(m|0)<0&&(v=v-m|0,o[g>>2]=v,C=C-m|0,o[de>>2]=C,o[le>>2]=0,m=0),R=v-C|0,E=m-C|0,(C|0)<0&&(o[g>>2]=R,o[le>>2]=E,o[de>>2]=0,m=E,v=R,C=0),E=(m|0)<(v|0)?m:v,E=(C|0)<(E|0)?C:E,!((E|0)<=0)&&(o[g>>2]=v-E,o[le>>2]=m-E,o[de>>2]=C-E)}function Bn(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0;g=o[m>>2]|0,O=m+4|0,v=o[O>>2]|0,(g|0)<0&&(v=v-g|0,o[O>>2]=v,R=m+8|0,o[R>>2]=(o[R>>2]|0)-g,o[m>>2]=0,g=0),(v|0)<0?(g=g-v|0,o[m>>2]=g,R=m+8|0,C=(o[R>>2]|0)-v|0,o[R>>2]=C,o[O>>2]=0,v=0):(C=m+8|0,R=C,C=o[C>>2]|0),(C|0)<0&&(g=g-C|0,o[m>>2]=g,v=v-C|0,o[O>>2]=v,o[R>>2]=0,C=0),E=(v|0)<(g|0)?v:g,E=(C|0)<(E|0)?C:E,!((E|0)<=0)&&(o[m>>2]=g-E,o[O>>2]=v-E,o[R>>2]=C-E)}function ps(m,g){m=m|0,g=g|0;var v=0,E=0;E=o[m+8>>2]|0,v=+((o[m+4>>2]|0)-E|0),G[g>>3]=+((o[m>>2]|0)-E|0)-v*.5,G[g+8>>3]=v*.8660254037844386}function Xr(m,g,v){m=m|0,g=g|0,v=v|0,o[v>>2]=(o[g>>2]|0)+(o[m>>2]|0),o[v+4>>2]=(o[g+4>>2]|0)+(o[m+4>>2]|0),o[v+8>>2]=(o[g+8>>2]|0)+(o[m+8>>2]|0)}function ao(m,g,v){m=m|0,g=g|0,v=v|0,o[v>>2]=(o[m>>2]|0)-(o[g>>2]|0),o[v+4>>2]=(o[m+4>>2]|0)-(o[g+4>>2]|0),o[v+8>>2]=(o[m+8>>2]|0)-(o[g+8>>2]|0)}function fl(m,g){m=m|0,g=g|0;var v=0,E=0;v=on(o[m>>2]|0,g)|0,o[m>>2]=v,v=m+4|0,E=on(o[v>>2]|0,g)|0,o[v>>2]=E,m=m+8|0,g=on(o[m>>2]|0,g)|0,o[m>>2]=g}function Do(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;O=o[m>>2]|0,N=(O|0)<0,E=(o[m+4>>2]|0)-(N?O:0)|0,R=(E|0)<0,C=(R?0-E|0:0)+((o[m+8>>2]|0)-(N?O:0))|0,v=(C|0)<0,m=v?0:C,g=(R?0:E)-(v?C:0)|0,C=(N?0:O)-(R?E:0)-(v?C:0)|0,v=(g|0)<(C|0)?g:C,v=(m|0)<(v|0)?m:v,E=(v|0)>0,m=m-(E?v:0)|0,g=g-(E?v:0)|0;e:do switch(C-(E?v:0)|0){case 0:switch(g|0){case 0:return N=m|0?(m|0)==1?1:7:0,N|0;case 1:return N=m|0?(m|0)==1?3:7:2,N|0;default:break e}case 1:switch(g|0){case 0:return N=m|0?(m|0)==1?5:7:4,N|0;case 1:{if(!m)m=6;else break e;return m|0}default:break e}}while(0);return N=7,N|0}function ra(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;O=m+8|0,C=o[O>>2]|0,R=(o[m>>2]|0)-C|0,N=m+4|0,C=(o[N>>2]|0)-C|0;do if(R>>>0>715827881|C>>>0>715827881){if(v=(R|0)>0,v){if((2147483647-R|0)<(R|0)||(2147483647-(R<<1)|0)<(R|0))return N=1,N|0}else if((-2147483648-R|0)>(R|0)||(-2147483648-(R<<1)|0)>(R|0))return N=1,N|0;if(g=R*3|0,(C|0)>0){if((2147483647-C|0)<(C|0))return N=1,N|0}else if((-2147483648-C|0)>(C|0))return N=1,N|0;if(E=C<<1,(R|0)>-1){if((g|-2147483648|0)>=(C|0))return N=1,N|0}else if((g^-2147483648|0)<(C|0))return N=1,N|0;if(v){if((2147483647-R|0)<(E|0))g=1;else{v=E;break}return g|0}else{if((-2147483648-R|0)>(E|0))g=1;else{v=E;break}return g|0}}else v=C<<1,g=R*3|0;while(0);E=c(+(g-C|0)/7)|0,o[m>>2]=E,C=c(+(v+R|0)/7)|0,o[N>>2]=C,o[O>>2]=0,v=(C|0)<(E|0),g=v?E:C,v=v?C:E;do if((v|0)<0){if((g|0)>0){if((g|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-g|0)>=(v|0)))break;An(23313,22444,355,22455)}if((v|0)==-2147483648|(-2147483648-g|0)>(v|0)&&An(23313,22444,355,22455),(g|0)>-1){if((g|-2147483648|0)<(v|0))break;An(23313,22444,355,22455)}else{if((g^-2147483648|0)>=(v|0))break;An(23313,22444,355,22455)}}while(0);return g=C-E|0,(E|0)<0?(v=0-E|0,o[N>>2]=g,o[O>>2]=v,o[m>>2]=0,E=0):(g=C,v=0),(g|0)<0&&(E=E-g|0,o[m>>2]=E,v=v-g|0,o[O>>2]=v,o[N>>2]=0,g=0),R=E-v|0,C=g-v|0,(v|0)<0?(o[m>>2]=R,o[N>>2]=C,o[O>>2]=0,g=C,C=R,v=0):C=E,E=(g|0)<(C|0)?g:C,E=(v|0)<(E|0)?v:E,(E|0)<=0?(N=0,N|0):(o[m>>2]=C-E,o[N>>2]=g-E,o[O>>2]=v-E,N=0,N|0)}function lo(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;O=m+8|0,C=o[O>>2]|0,R=(o[m>>2]|0)-C|0,N=m+4|0,C=(o[N>>2]|0)-C|0;do if(R>>>0>715827881|C>>>0>715827881){if(v=(R|0)>0,v){if((2147483647-R|0)<(R|0))return N=1,N|0}else if((-2147483648-R|0)>(R|0))return N=1,N|0;if(g=R<<1,(C|0)>0){if((2147483647-C|0)<(C|0)||(2147483647-(C<<1)|0)<(C|0))return N=1,N|0}else if((-2147483648-C|0)>(C|0)||(-2147483648-(C<<1)|0)>(C|0))return N=1,N|0;if(E=C*3|0,v){if((2147483647-g|0)<(C|0))return N=1,N|0}else if((-2147483648-g|0)>(C|0))return N=1,N|0;if((C|0)>-1){if((E|-2147483648|0)<(R|0)){v=E;break}else g=1;return g|0}else{if((E^-2147483648|0)<(R|0))g=1;else{v=E;break}return g|0}}else v=C*3|0,g=R<<1;while(0);E=c(+(g+C|0)/7)|0,o[m>>2]=E,C=c(+(v-R|0)/7)|0,o[N>>2]=C,o[O>>2]=0,v=(C|0)<(E|0),g=v?E:C,v=v?C:E;do if((v|0)<0){if((g|0)>0){if((g|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-g|0)>=(v|0)))break;An(23313,22444,404,22469)}if((v|0)==-2147483648|(-2147483648-g|0)>(v|0)&&An(23313,22444,404,22469),(g|0)>-1){if((g|-2147483648|0)<(v|0))break;An(23313,22444,404,22469)}else{if((g^-2147483648|0)>=(v|0))break;An(23313,22444,404,22469)}}while(0);return g=C-E|0,(E|0)<0?(v=0-E|0,o[N>>2]=g,o[O>>2]=v,o[m>>2]=0,E=0):(g=C,v=0),(g|0)<0&&(E=E-g|0,o[m>>2]=E,v=v-g|0,o[O>>2]=v,o[N>>2]=0,g=0),R=E-v|0,C=g-v|0,(v|0)<0?(o[m>>2]=R,o[N>>2]=C,o[O>>2]=0,g=C,C=R,v=0):C=E,E=(g|0)<(C|0)?g:C,E=(v|0)<(E|0)?v:E,(E|0)<=0?(N=0,N|0):(o[m>>2]=C-E,o[N>>2]=g-E,o[O>>2]=v-E,N=0,N|0)}function lA(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;O=m+8|0,v=o[O>>2]|0,g=(o[m>>2]|0)-v|0,N=m+4|0,v=(o[N>>2]|0)-v|0,E=c(+((g*3|0)-v|0)/7)|0,o[m>>2]=E,g=c(+((v<<1)+g|0)/7)|0,o[N>>2]=g,o[O>>2]=0,v=g-E|0,(E|0)<0?(R=0-E|0,o[N>>2]=v,o[O>>2]=R,o[m>>2]=0,g=v,E=0,v=R):v=0,(g|0)<0&&(E=E-g|0,o[m>>2]=E,v=v-g|0,o[O>>2]=v,o[N>>2]=0,g=0),R=E-v|0,C=g-v|0,(v|0)<0?(o[m>>2]=R,o[N>>2]=C,o[O>>2]=0,g=C,C=R,v=0):C=E,E=(g|0)<(C|0)?g:C,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(o[m>>2]=C-E,o[N>>2]=g-E,o[O>>2]=v-E)}function Da(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;O=m+8|0,v=o[O>>2]|0,g=(o[m>>2]|0)-v|0,N=m+4|0,v=(o[N>>2]|0)-v|0,E=c(+((g<<1)+v|0)/7)|0,o[m>>2]=E,g=c(+((v*3|0)-g|0)/7)|0,o[N>>2]=g,o[O>>2]=0,v=g-E|0,(E|0)<0?(R=0-E|0,o[N>>2]=v,o[O>>2]=R,o[m>>2]=0,g=v,E=0,v=R):v=0,(g|0)<0&&(E=E-g|0,o[m>>2]=E,v=v-g|0,o[O>>2]=v,o[N>>2]=0,g=0),R=E-v|0,C=g-v|0,(v|0)<0?(o[m>>2]=R,o[N>>2]=C,o[O>>2]=0,g=C,C=R,v=0):C=E,E=(g|0)<(C|0)?g:C,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(o[m>>2]=C-E,o[N>>2]=g-E,o[O>>2]=v-E)}function Ro(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;g=o[m>>2]|0,O=m+4|0,v=o[O>>2]|0,N=m+8|0,E=o[N>>2]|0,C=v+(g*3|0)|0,o[m>>2]=C,v=E+(v*3|0)|0,o[O>>2]=v,g=(E*3|0)+g|0,o[N>>2]=g,E=v-C|0,(C|0)<0?(g=g-C|0,o[O>>2]=E,o[N>>2]=g,o[m>>2]=0,v=E,E=0):E=C,(v|0)<0&&(E=E-v|0,o[m>>2]=E,g=g-v|0,o[N>>2]=g,o[O>>2]=0,v=0),R=E-g|0,C=v-g|0,(g|0)<0?(o[m>>2]=R,o[O>>2]=C,o[N>>2]=0,E=R,g=0):C=v,v=(C|0)<(E|0)?C:E,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=E-v,o[O>>2]=C-v,o[N>>2]=g-v)}function Oi(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;C=o[m>>2]|0,O=m+4|0,g=o[O>>2]|0,N=m+8|0,v=o[N>>2]|0,E=(g*3|0)+C|0,C=v+(C*3|0)|0,o[m>>2]=C,o[O>>2]=E,g=(v*3|0)+g|0,o[N>>2]=g,v=E-C|0,(C|0)<0?(g=g-C|0,o[O>>2]=v,o[N>>2]=g,o[m>>2]=0,C=0):v=E,(v|0)<0&&(C=C-v|0,o[m>>2]=C,g=g-v|0,o[N>>2]=g,o[O>>2]=0,v=0),R=C-g|0,E=v-g|0,(g|0)<0?(o[m>>2]=R,o[O>>2]=E,o[N>>2]=0,C=R,g=0):E=v,v=(E|0)<(C|0)?E:C,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=C-v,o[O>>2]=E-v,o[N>>2]=g-v)}function Fi(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0;(g+-1|0)>>>0>=6||(C=(o[15440+(g*12|0)>>2]|0)+(o[m>>2]|0)|0,o[m>>2]=C,N=m+4|0,E=(o[15440+(g*12|0)+4>>2]|0)+(o[N>>2]|0)|0,o[N>>2]=E,O=m+8|0,g=(o[15440+(g*12|0)+8>>2]|0)+(o[O>>2]|0)|0,o[O>>2]=g,v=E-C|0,(C|0)<0?(g=g-C|0,o[N>>2]=v,o[O>>2]=g,o[m>>2]=0,E=0):(v=E,E=C),(v|0)<0&&(E=E-v|0,o[m>>2]=E,g=g-v|0,o[O>>2]=g,o[N>>2]=0,v=0),R=E-g|0,C=v-g|0,(g|0)<0?(o[m>>2]=R,o[N>>2]=C,o[O>>2]=0,E=R,g=0):C=v,v=(C|0)<(E|0)?C:E,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=E-v,o[N>>2]=C-v,o[O>>2]=g-v))}function VA(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;C=o[m>>2]|0,O=m+4|0,g=o[O>>2]|0,N=m+8|0,v=o[N>>2]|0,E=g+C|0,C=v+C|0,o[m>>2]=C,o[O>>2]=E,g=v+g|0,o[N>>2]=g,v=E-C|0,(C|0)<0?(g=g-C|0,o[O>>2]=v,o[N>>2]=g,o[m>>2]=0,E=0):(v=E,E=C),(v|0)<0&&(E=E-v|0,o[m>>2]=E,g=g-v|0,o[N>>2]=g,o[O>>2]=0,v=0),R=E-g|0,C=v-g|0,(g|0)<0?(o[m>>2]=R,o[O>>2]=C,o[N>>2]=0,E=R,g=0):C=v,v=(C|0)<(E|0)?C:E,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=E-v,o[O>>2]=C-v,o[N>>2]=g-v)}function dl(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;g=o[m>>2]|0,O=m+4|0,E=o[O>>2]|0,N=m+8|0,v=o[N>>2]|0,C=E+g|0,o[m>>2]=C,E=v+E|0,o[O>>2]=E,g=v+g|0,o[N>>2]=g,v=E-C|0,(C|0)<0?(g=g-C|0,o[O>>2]=v,o[N>>2]=g,o[m>>2]=0,E=0):(v=E,E=C),(v|0)<0&&(E=E-v|0,o[m>>2]=E,g=g-v|0,o[N>>2]=g,o[O>>2]=0,v=0),R=E-g|0,C=v-g|0,(g|0)<0?(o[m>>2]=R,o[O>>2]=C,o[N>>2]=0,E=R,g=0):C=v,v=(C|0)<(E|0)?C:E,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=E-v,o[O>>2]=C-v,o[N>>2]=g-v)}function Ao(m){switch(m=m|0,m|0){case 1:{m=5;break}case 5:{m=4;break}case 4:{m=6;break}case 6:{m=2;break}case 2:{m=3;break}case 3:{m=1;break}}return m|0}function Bo(m){switch(m=m|0,m|0){case 1:{m=3;break}case 3:{m=2;break}case 2:{m=6;break}case 6:{m=4;break}case 4:{m=5;break}case 5:{m=1;break}}return m|0}function Zu(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;g=o[m>>2]|0,O=m+4|0,v=o[O>>2]|0,N=m+8|0,E=o[N>>2]|0,C=v+(g<<1)|0,o[m>>2]=C,v=E+(v<<1)|0,o[O>>2]=v,g=(E<<1)+g|0,o[N>>2]=g,E=v-C|0,(C|0)<0?(g=g-C|0,o[O>>2]=E,o[N>>2]=g,o[m>>2]=0,v=E,E=0):E=C,(v|0)<0&&(E=E-v|0,o[m>>2]=E,g=g-v|0,o[N>>2]=g,o[O>>2]=0,v=0),R=E-g|0,C=v-g|0,(g|0)<0?(o[m>>2]=R,o[O>>2]=C,o[N>>2]=0,E=R,g=0):C=v,v=(C|0)<(E|0)?C:E,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=E-v,o[O>>2]=C-v,o[N>>2]=g-v)}function GA(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;C=o[m>>2]|0,O=m+4|0,g=o[O>>2]|0,N=m+8|0,v=o[N>>2]|0,E=(g<<1)+C|0,C=v+(C<<1)|0,o[m>>2]=C,o[O>>2]=E,g=(v<<1)+g|0,o[N>>2]=g,v=E-C|0,(C|0)<0?(g=g-C|0,o[O>>2]=v,o[N>>2]=g,o[m>>2]=0,C=0):v=E,(v|0)<0&&(C=C-v|0,o[m>>2]=C,g=g-v|0,o[N>>2]=g,o[O>>2]=0,v=0),R=C-g|0,E=v-g|0,(g|0)<0?(o[m>>2]=R,o[O>>2]=E,o[N>>2]=0,C=R,g=0):E=v,v=(E|0)<(C|0)?E:C,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=C-v,o[O>>2]=E-v,o[N>>2]=g-v)}function pl(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0;return O=(o[m>>2]|0)-(o[g>>2]|0)|0,N=(O|0)<0,E=(o[m+4>>2]|0)-(o[g+4>>2]|0)-(N?O:0)|0,R=(E|0)<0,C=(N?0-O|0:0)+(o[m+8>>2]|0)-(o[g+8>>2]|0)+(R?0-E|0:0)|0,m=(C|0)<0,g=m?0:C,v=(R?0:E)-(m?C:0)|0,C=(N?0:O)-(R?E:0)-(m?C:0)|0,m=(v|0)<(C|0)?v:C,m=(g|0)<(m|0)?g:m,E=(m|0)>0,g=g-(E?m:0)|0,v=v-(E?m:0)|0,m=C-(E?m:0)|0,m=(m|0)>-1?m:0-m|0,v=(v|0)>-1?v:0-v|0,g=(g|0)>-1?g:0-g|0,g=(v|0)>(g|0)?v:g,((m|0)>(g|0)?m:g)|0}function AA(m,g){m=m|0,g=g|0;var v=0;v=o[m+8>>2]|0,o[g>>2]=(o[m>>2]|0)-v,o[g+4>>2]=(o[m+4>>2]|0)-v}function jA(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0;E=o[m>>2]|0,o[g>>2]=E,C=o[m+4>>2]|0,O=g+4|0,o[O>>2]=C,N=g+8|0,o[N>>2]=0,v=(C|0)<(E|0),m=v?E:C,v=v?C:E;do if((v|0)<0){if((m|0)>0){if((m|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-m|0)>=(v|0)))break;return m=1,m|0}if((v|0)==-2147483648|(-2147483648-m|0)>(v|0))return g=1,g|0;if((m|0)>-1){if((m|-2147483648|0)<(v|0))break;return m=1,m|0}else{if((m^-2147483648|0)<(v|0))m=1;else break;return m|0}}while(0);return m=C-E|0,(E|0)<0?(v=0-E|0,o[O>>2]=m,o[N>>2]=v,o[g>>2]=0,E=0):(m=C,v=0),(m|0)<0&&(E=E-m|0,o[g>>2]=E,v=v-m|0,o[N>>2]=v,o[O>>2]=0,m=0),R=E-v|0,C=m-v|0,(v|0)<0?(o[g>>2]=R,o[O>>2]=C,o[N>>2]=0,m=C,C=R,v=0):C=E,E=(m|0)<(C|0)?m:C,E=(v|0)<(E|0)?v:E,(E|0)<=0?(g=0,g|0):(o[g>>2]=C-E,o[O>>2]=m-E,o[N>>2]=v-E,g=0,g|0)}function zo(m){m=m|0;var g=0,v=0,E=0,C=0;g=m+8|0,C=o[g>>2]|0,v=C-(o[m>>2]|0)|0,o[m>>2]=v,E=m+4|0,m=(o[E>>2]|0)-C|0,o[E>>2]=m,o[g>>2]=0-(m+v)}function Ra(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;v=o[m>>2]|0,g=0-v|0,o[m>>2]=g,O=m+8|0,o[O>>2]=0,N=m+4|0,E=o[N>>2]|0,C=E+v|0,(v|0)>0?(o[N>>2]=C,o[O>>2]=v,o[m>>2]=0,g=0,E=C):v=0,(E|0)<0?(R=g-E|0,o[m>>2]=R,v=v-E|0,o[O>>2]=v,o[N>>2]=0,C=R-v|0,g=0-v|0,(v|0)<0?(o[m>>2]=C,o[N>>2]=g,o[O>>2]=0,E=g,v=0):(E=0,C=R)):C=g,g=(E|0)<(C|0)?E:C,g=(v|0)<(g|0)?v:g,!((g|0)<=0)&&(o[m>>2]=C-g,o[N>>2]=E-g,o[O>>2]=v-g)}function $A(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0;if(de=we,we=we+64|0,le=de,N=de+56|0,!(!0&(g&2013265920|0)==134217728&(!0&(E&2013265920|0)==134217728)))return C=5,we=de,C|0;if((m|0)==(v|0)&(g|0)==(E|0))return o[C>>2]=0,C=0,we=de,C|0;if(O=te(m|0,g|0,52)|0,Se()|0,O=O&15,J=te(v|0,E|0,52)|0,Se()|0,(O|0)!=(J&15|0))return C=12,we=de,C|0;if(R=O+-1|0,O>>>0>1){yl(m,g,R,le)|0,yl(v,E,R,N)|0,J=le,Q=o[J>>2]|0,J=o[J+4>>2]|0;e:do if((Q|0)==(o[N>>2]|0)&&(J|0)==(o[N+4>>2]|0)){O=(O^15)*3|0,R=te(m|0,g|0,O|0)|0,Se()|0,R=R&7,O=te(v|0,E|0,O|0)|0,Se()|0,O=O&7;do if((R|0)==0|(O|0)==0)o[C>>2]=1,R=0;else if((R|0)==7)R=5;else{if((R|0)==1|(O|0)==1&&fr(Q,J)|0){R=5;break}if((o[15536+(R<<2)>>2]|0)!=(O|0)&&(o[15568+(R<<2)>>2]|0)!=(O|0))break e;o[C>>2]=1,R=0}while(0);return C=R,we=de,C|0}while(0)}R=le,O=R+56|0;do o[R>>2]=0,R=R+4|0;while((R|0)<(O|0));return na(m,g,1,le)|0,g=le,!((o[g>>2]|0)==(v|0)&&(o[g+4>>2]|0)==(E|0))&&(g=le+8|0,!((o[g>>2]|0)==(v|0)&&(o[g+4>>2]|0)==(E|0)))&&(g=le+16|0,!((o[g>>2]|0)==(v|0)&&(o[g+4>>2]|0)==(E|0)))&&(g=le+24|0,!((o[g>>2]|0)==(v|0)&&(o[g+4>>2]|0)==(E|0)))&&(g=le+32|0,!((o[g>>2]|0)==(v|0)&&(o[g+4>>2]|0)==(E|0)))&&(g=le+40|0,!((o[g>>2]|0)==(v|0)&&(o[g+4>>2]|0)==(E|0)))?(R=le+48|0,R=((o[R>>2]|0)==(v|0)?(o[R+4>>2]|0)==(E|0):0)&1):R=1,o[C>>2]=R,C=0,we=de,C|0}function HA(m,g,v,E,C){return m=m|0,g=g|0,v=v|0,E=E|0,C=C|0,v=ot(m,g,v,E)|0,(v|0)==7?(C=11,C|0):(E=ue(v|0,0,56)|0,g=g&-2130706433|(Se()|0)|268435456,o[C>>2]=m|E,o[C+4>>2]=g,C=0,C|0)}function uo(m,g,v){return m=m|0,g=g|0,v=v|0,!0&(g&2013265920|0)==268435456?(o[v>>2]=m,o[v+4>>2]=g&-2130706433|134217728,v=0,v|0):(v=6,v|0)}function ia(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;return C=we,we=we+16|0,E=C,o[E>>2]=0,!0&(g&2013265920|0)==268435456?(R=te(m|0,g|0,56)|0,Se()|0,E=Fe(m,g&-2130706433|134217728,R&7,E,v)|0,we=C,E|0):(E=6,we=C,E|0)}function WA(m,g){m=m|0,g=g|0;var v=0;switch(v=te(m|0,g|0,56)|0,Se()|0,v&7){case 0:case 7:return v=0,v|0}return v=g&-2130706433|134217728,!(!0&(g&2013265920|0)==268435456)||!0&(g&117440512|0)==16777216&(fr(m,v)|0)!=0?(v=0,v|0):(v=oa(m,v)|0,v|0)}function sa(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0;return C=we,we=we+16|0,E=C,!0&(g&2013265920|0)==268435456?(R=g&-2130706433|134217728,O=v,o[O>>2]=m,o[O+4>>2]=R,o[E>>2]=0,g=te(m|0,g|0,56)|0,Se()|0,E=Fe(m,R,g&7,E,v+8|0)|0,we=C,E|0):(E=6,we=C,E|0)}function ur(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0;return C=(fr(m,g)|0)==0,g=g&-2130706433,E=v,o[E>>2]=C?m:0,o[E+4>>2]=C?g|285212672:0,E=v+8|0,o[E>>2]=m,o[E+4>>2]=g|301989888,E=v+16|0,o[E>>2]=m,o[E+4>>2]=g|318767104,E=v+24|0,o[E>>2]=m,o[E+4>>2]=g|335544320,E=v+32|0,o[E>>2]=m,o[E+4>>2]=g|352321536,v=v+40|0,o[v>>2]=m,o[v+4>>2]=g|369098752,0}function Is(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0;return O=we,we=we+16|0,C=O,R=g&-2130706433|134217728,!0&(g&2013265920|0)==268435456?(E=te(m|0,g|0,56)|0,Se()|0,E=Zt(m,R,E&7)|0,(E|0)==-1?(o[v>>2]=0,R=6,we=O,R|0):(Gi(m,R,C)|0&&An(23313,22484,282,22499),g=te(m|0,g|0,52)|0,Se()|0,g=g&15,fr(m,R)|0?Oo(C,g,E,2,v):QA(C,g,E,2,v),R=0,we=O,R|0)):(R=6,we=O,R|0)}function Gn(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0;E=we,we=we+16|0,C=E,Wn(m,g,v,C),Lo(C,v+4|0),we=E}function Wn(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0;if(N=we,we=we+16|0,Q=N,yr(m,v,Q),R=+Dt(+(1-+G[Q>>3]*.5)),R<1e-16){o[E>>2]=0,o[E+4>>2]=0,o[E+8>>2]=0,o[E+12>>2]=0,we=N;return}if(Q=o[v>>2]|0,C=+G[15920+(Q*24|0)>>3],C=+Jr(C-+Jr(+tc(15600+(Q<<4)|0,m))),gi(g)|0?O=+Jr(C+-.3334731722518321):O=C,C=+Lt(+R)/.381966011250105,(g|0)>0){m=0;do C=C*2.6457513110645907,m=m+1|0;while((m|0)!=(g|0))}R=+$e(+O)*C,G[E>>3]=R,O=+ft(+O)*C,G[E+8>>3]=O,we=N}function yr(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;if(R=we,we=we+32|0,C=R,Ml(m,C),o[g>>2]=0,G[v>>3]=5,E=+dr(16400,C),E<+G[v>>3]&&(o[g>>2]=0,G[v>>3]=E),E=+dr(16424,C),E<+G[v>>3]&&(o[g>>2]=1,G[v>>3]=E),E=+dr(16448,C),E<+G[v>>3]&&(o[g>>2]=2,G[v>>3]=E),E=+dr(16472,C),E<+G[v>>3]&&(o[g>>2]=3,G[v>>3]=E),E=+dr(16496,C),E<+G[v>>3]&&(o[g>>2]=4,G[v>>3]=E),E=+dr(16520,C),E<+G[v>>3]&&(o[g>>2]=5,G[v>>3]=E),E=+dr(16544,C),E<+G[v>>3]&&(o[g>>2]=6,G[v>>3]=E),E=+dr(16568,C),E<+G[v>>3]&&(o[g>>2]=7,G[v>>3]=E),E=+dr(16592,C),E<+G[v>>3]&&(o[g>>2]=8,G[v>>3]=E),E=+dr(16616,C),E<+G[v>>3]&&(o[g>>2]=9,G[v>>3]=E),E=+dr(16640,C),E<+G[v>>3]&&(o[g>>2]=10,G[v>>3]=E),E=+dr(16664,C),E<+G[v>>3]&&(o[g>>2]=11,G[v>>3]=E),E=+dr(16688,C),E<+G[v>>3]&&(o[g>>2]=12,G[v>>3]=E),E=+dr(16712,C),E<+G[v>>3]&&(o[g>>2]=13,G[v>>3]=E),E=+dr(16736,C),E<+G[v>>3]&&(o[g>>2]=14,G[v>>3]=E),E=+dr(16760,C),E<+G[v>>3]&&(o[g>>2]=15,G[v>>3]=E),E=+dr(16784,C),E<+G[v>>3]&&(o[g>>2]=16,G[v>>3]=E),E=+dr(16808,C),E<+G[v>>3]&&(o[g>>2]=17,G[v>>3]=E),E=+dr(16832,C),E<+G[v>>3]&&(o[g>>2]=18,G[v>>3]=E),E=+dr(16856,C),!(E<+G[v>>3])){we=R;return}o[g>>2]=19,G[v>>3]=E,we=R}function hr(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0;if(R=+ic(m),R<1e-16){g=15600+(g<<4)|0,o[C>>2]=o[g>>2],o[C+4>>2]=o[g+4>>2],o[C+8>>2]=o[g+8>>2],o[C+12>>2]=o[g+12>>2];return}if(O=+dn(+ +G[m+8>>3],+ +G[m>>3]),(v|0)>0){m=0;do R=R/2.6457513110645907,m=m+1|0;while((m|0)!=(v|0))}E?(R=R/3,v=(gi(v)|0)==0,R=+jt(+((v?R:R/2.6457513110645907)*.381966011250105))):(R=+jt(+(R*.381966011250105)),gi(v)|0&&(O=+Jr(O+.3334731722518321))),ho(15600+(g<<4)|0,+Jr(+G[15920+(g*24|0)>>3]-O),R,C)}function gl(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0;E=we,we=we+16|0,C=E,ps(m+4|0,C),hr(C,o[m>>2]|0,g,0,v),we=E}function Oo(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0,it=0,Xe=0,Vt=0,Bt=0,dt=0,_t=0,Cn=0,xn=0,gn=0,yn=0,bn=0,Ln=0,sr=0,Pn=0;if(Ln=we,we=we+272|0,R=Ln+256|0,rt=Ln+240|0,gn=Ln,yn=Ln+224|0,bn=Ln+208|0,it=Ln+176|0,Xe=Ln+160|0,Vt=Ln+192|0,Bt=Ln+144|0,dt=Ln+128|0,_t=Ln+112|0,Cn=Ln+96|0,xn=Ln+80|0,o[R>>2]=g,o[rt>>2]=o[m>>2],o[rt+4>>2]=o[m+4>>2],o[rt+8>>2]=o[m+8>>2],o[rt+12>>2]=o[m+12>>2],Yu(rt,R,gn),o[C>>2]=0,rt=E+v+((E|0)==5&1)|0,(rt|0)<=(v|0)){we=Ln;return}Q=o[R>>2]|0,J=yn+4|0,le=it+4|0,de=v+5|0,Re=16880+(Q<<2)|0,je=16960+(Q<<2)|0,Be=dt+8|0,Ye=_t+8|0,ht=Cn+8|0,ut=bn+4|0,N=v;e:for(;;){O=gn+(((N|0)%5|0)<<4)|0,o[bn>>2]=o[O>>2],o[bn+4>>2]=o[O+4>>2],o[bn+8>>2]=o[O+8>>2],o[bn+12>>2]=o[O+12>>2];do;while((Ba(bn,Q,0,1)|0)==2);if((N|0)>(v|0)&(gi(g)|0)!=0){if(o[it>>2]=o[bn>>2],o[it+4>>2]=o[bn+4>>2],o[it+8>>2]=o[bn+8>>2],o[it+12>>2]=o[bn+12>>2],ps(J,Xe),E=o[it>>2]|0,R=o[17040+(E*80|0)+(o[yn>>2]<<2)>>2]|0,o[it>>2]=o[18640+(E*80|0)+(R*20|0)>>2],O=o[18640+(E*80|0)+(R*20|0)+16>>2]|0,(O|0)>0){m=0;do VA(le),m=m+1|0;while((m|0)<(O|0))}switch(O=18640+(E*80|0)+(R*20|0)+4|0,o[Vt>>2]=o[O>>2],o[Vt+4>>2]=o[O+4>>2],o[Vt+8>>2]=o[O+8>>2],fl(Vt,(o[Re>>2]|0)*3|0),Xr(le,Vt,le),Bn(le),ps(le,Bt),sr=+(o[je>>2]|0),G[dt>>3]=sr*3,G[Be>>3]=0,Pn=sr*-1.5,G[_t>>3]=Pn,G[Ye>>3]=sr*2.598076211353316,G[Cn>>3]=Pn,G[ht>>3]=sr*-2.598076211353316,o[17040+((o[it>>2]|0)*80|0)+(o[bn>>2]<<2)>>2]|0){case 1:{m=_t,E=dt;break}case 3:{m=Cn,E=_t;break}case 2:{m=dt,E=Cn;break}default:{m=12;break e}}iu(Xe,Bt,E,m,xn),hr(xn,o[it>>2]|0,Q,1,C+8+(o[C>>2]<<4)|0),o[C>>2]=(o[C>>2]|0)+1}if((N|0)<(de|0)&&(ps(ut,it),hr(it,o[bn>>2]|0,Q,1,C+8+(o[C>>2]<<4)|0),o[C>>2]=(o[C>>2]|0)+1),o[yn>>2]=o[bn>>2],o[yn+4>>2]=o[bn+4>>2],o[yn+8>>2]=o[bn+8>>2],o[yn+12>>2]=o[bn+12>>2],N=N+1|0,(N|0)>=(rt|0)){m=3;break}}if((m|0)==3){we=Ln;return}else(m|0)==12&&An(22522,22569,571,22579)}function Yu(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0;Q=we,we=we+128|0,E=Q+64|0,C=Q,R=E,O=20240,N=R+60|0;do o[R>>2]=o[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));R=C,O=20304,N=R+60|0;do o[R>>2]=o[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));N=(gi(o[g>>2]|0)|0)==0,E=N?E:C,C=m+4|0,Zu(C),GA(C),gi(o[g>>2]|0)|0&&(Oi(C),o[g>>2]=(o[g>>2]|0)+1),o[v>>2]=o[m>>2],g=v+4|0,Xr(C,E,g),Bn(g),o[v+16>>2]=o[m>>2],g=v+20|0,Xr(C,E+12|0,g),Bn(g),o[v+32>>2]=o[m>>2],g=v+36|0,Xr(C,E+24|0,g),Bn(g),o[v+48>>2]=o[m>>2],g=v+52|0,Xr(C,E+36|0,g),Bn(g),o[v+64>>2]=o[m>>2],v=v+68|0,Xr(C,E+48|0,v),Bn(v),we=Q}function Ba(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0;if(Be=we,we=we+32|0,Re=Be+12|0,N=Be,je=m+4|0,de=o[16960+(g<<2)>>2]|0,le=(E|0)!=0,de=le?de*3|0:de,C=o[je>>2]|0,J=m+8|0,O=o[J>>2]|0,le){if(R=m+12|0,E=o[R>>2]|0,C=O+C+E|0,(C|0)==(de|0))return je=1,we=Be,je|0;Q=R}else Q=m+12|0,E=o[Q>>2]|0,C=O+C+E|0;if((C|0)<=(de|0))return je=0,we=Be,je|0;do if((E|0)>0){if(E=o[m>>2]|0,(O|0)>0){R=18640+(E*80|0)+60|0,E=m;break}E=18640+(E*80|0)+40|0,v?(Gr(Re,de,0,0),ao(je,Re,N),dl(N),Xr(N,Re,je),R=E,E=m):(R=E,E=m)}else R=18640+((o[m>>2]|0)*80|0)+20|0,E=m;while(0);if(o[E>>2]=o[R>>2],C=R+16|0,(o[C>>2]|0)>0){E=0;do VA(je),E=E+1|0;while((E|0)<(o[C>>2]|0))}return m=R+4|0,o[Re>>2]=o[m>>2],o[Re+4>>2]=o[m+4>>2],o[Re+8>>2]=o[m+8>>2],g=o[16880+(g<<2)>>2]|0,fl(Re,le?g*3|0:g),Xr(je,Re,je),Bn(je),le?E=((o[J>>2]|0)+(o[je>>2]|0)+(o[Q>>2]|0)|0)==(de|0)?1:2:E=2,je=E,we=Be,je|0}function Xu(m,g){m=m|0,g=g|0;var v=0;do v=Ba(m,g,0,1)|0;while((v|0)==2);return v|0}function QA(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0,it=0,Xe=0,Vt=0,Bt=0,dt=0,_t=0,Cn=0,xn=0,gn=0;if(Cn=we,we=we+240|0,R=Cn+224|0,Vt=Cn+208|0,Bt=Cn,dt=Cn+192|0,_t=Cn+176|0,ht=Cn+160|0,ut=Cn+144|0,rt=Cn+128|0,it=Cn+112|0,Xe=Cn+96|0,o[R>>2]=g,o[Vt>>2]=o[m>>2],o[Vt+4>>2]=o[m+4>>2],o[Vt+8>>2]=o[m+8>>2],o[Vt+12>>2]=o[m+12>>2],ks(Vt,R,Bt),o[C>>2]=0,Ye=E+v+((E|0)==6&1)|0,(Ye|0)<=(v|0)){we=Cn;return}Q=o[R>>2]|0,J=v+6|0,le=16960+(Q<<2)|0,de=ut+8|0,Re=rt+8|0,je=it+8|0,Be=dt+4|0,O=0,N=v,E=-1;e:for(;;){if(R=(N|0)%6|0,m=Bt+(R<<4)|0,o[dt>>2]=o[m>>2],o[dt+4>>2]=o[m+4>>2],o[dt+8>>2]=o[m+8>>2],o[dt+12>>2]=o[m+12>>2],m=O,O=Ba(dt,Q,0,1)|0,(N|0)>(v|0)&(gi(g)|0)!=0&&(m|0)!=1&&(o[dt>>2]|0)!=(E|0)){switch(ps(Bt+(((R+5|0)%6|0)<<4)+4|0,_t),ps(Bt+(R<<4)+4|0,ht),xn=+(o[le>>2]|0),G[ut>>3]=xn*3,G[de>>3]=0,gn=xn*-1.5,G[rt>>3]=gn,G[Re>>3]=xn*2.598076211353316,G[it>>3]=gn,G[je>>3]=xn*-2.598076211353316,R=o[Vt>>2]|0,o[17040+(R*80|0)+(((E|0)==(R|0)?o[dt>>2]|0:E)<<2)>>2]|0){case 1:{m=rt,E=ut;break}case 3:{m=it,E=rt;break}case 2:{m=ut,E=it;break}default:{m=8;break e}}iu(_t,ht,E,m,Xe),!(sc(_t,Xe)|0)&&!(sc(ht,Xe)|0)&&(hr(Xe,o[Vt>>2]|0,Q,1,C+8+(o[C>>2]<<4)|0),o[C>>2]=(o[C>>2]|0)+1)}if((N|0)<(J|0)&&(ps(Be,_t),hr(_t,o[dt>>2]|0,Q,1,C+8+(o[C>>2]<<4)|0),o[C>>2]=(o[C>>2]|0)+1),N=N+1|0,(N|0)>=(Ye|0)){m=3;break}else E=o[dt>>2]|0}if((m|0)==3){we=Cn;return}else(m|0)==8&&An(22606,22569,736,22651)}function ks(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0;Q=we,we=we+160|0,E=Q+80|0,C=Q,R=E,O=20368,N=R+72|0;do o[R>>2]=o[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));R=C,O=20448,N=R+72|0;do o[R>>2]=o[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));N=(gi(o[g>>2]|0)|0)==0,E=N?E:C,C=m+4|0,Zu(C),GA(C),gi(o[g>>2]|0)|0&&(Oi(C),o[g>>2]=(o[g>>2]|0)+1),o[v>>2]=o[m>>2],g=v+4|0,Xr(C,E,g),Bn(g),o[v+16>>2]=o[m>>2],g=v+20|0,Xr(C,E+12|0,g),Bn(g),o[v+32>>2]=o[m>>2],g=v+36|0,Xr(C,E+24|0,g),Bn(g),o[v+48>>2]=o[m>>2],g=v+52|0,Xr(C,E+36|0,g),Bn(g),o[v+64>>2]=o[m>>2],g=v+68|0,Xr(C,E+48|0,g),Bn(g),o[v+80>>2]=o[m>>2],v=v+84|0,Xr(C,E+60|0,v),Bn(v),we=Q}function ml(m,g){return m=m|0,g=g|0,g=te(m|0,g|0,52)|0,Se()|0,g&15|0}function za(m,g){return m=m|0,g=g|0,g=te(m|0,g|0,45)|0,Se()|0,g&127|0}function oa(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0;if(!(!0&(g&-16777216|0)==134217728)||(O=te(m|0,g|0,45)|0,Se()|0,O=O&127,O>>>0>121))return g=0,g|0;v=te(m|0,g|0,52)|0,Se()|0,v=v&15;do if(v|0){for(C=1,E=0;;){if(R=te(m|0,g|0,(15-C|0)*3|0)|0,Se()|0,R=R&7,(R|0)!=0&(E^1))if((R|0)==1&(Vn(O)|0)!=0){N=0,E=13;break}else E=1;if((R|0)==7){N=0,E=13;break}if(C>>>0<v>>>0)C=C+1|0;else{E=9;break}}if((E|0)==9){if((v|0)==15)N=1;else break;return N|0}else if((E|0)==13)return N|0}while(0);for(;;){if(N=te(m|0,g|0,(14-v|0)*3|0)|0,Se()|0,!((N&7|0)==7&!0)){N=0,E=13;break}if(v>>>0<14)v=v+1|0;else{N=1,E=13;break}}return(E|0)==13?N|0:0}function yl(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0;if(R=te(m|0,g|0,52)|0,Se()|0,R=R&15,v>>>0>15)return E=4,E|0;if((R|0)<(v|0))return E=12,E|0;if((R|0)==(v|0))return o[E>>2]=m,o[E+4>>2]=g,E=0,E|0;if(C=ue(v|0,0,52)|0,C=C|m,m=Se()|0|g&-15728641,(R|0)>(v|0))do g=ue(7,0,(14-v|0)*3|0)|0,v=v+1|0,C=g|C,m=Se()|0|m;while((v|0)<(R|0));return o[E>>2]=C,o[E+4>>2]=m,E=0,E|0}function _l(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0;if(R=te(m|0,g|0,52)|0,Se()|0,R=R&15,!((v|0)<16&(R|0)<=(v|0)))return E=4,E|0;C=v-R|0,v=te(m|0,g|0,45)|0,Se()|0;e:do if(!(Vn(v&127)|0))v=Bs(7,0,C,((C|0)<0)<<31>>31)|0,C=Se()|0;else{t:do if(R|0){for(v=1;O=ue(7,0,(15-v|0)*3|0)|0,!!((O&m|0)==0&((Se()|0)&g|0)==0);)if(v>>>0<R>>>0)v=v+1|0;else break t;v=Bs(7,0,C,((C|0)<0)<<31>>31)|0,C=Se()|0;break e}while(0);v=Bs(7,0,C,((C|0)<0)<<31>>31)|0,v=V(v|0,Se()|0,5,0)|0,v=d(v|0,Se()|0,-5,-1)|0,v=M(v|0,Se()|0,6,0)|0,v=d(v|0,Se()|0,1,0)|0,C=Se()|0}while(0);return O=E,o[O>>2]=v,o[O+4>>2]=C,O=0,O|0}function fr(m,g){m=m|0,g=g|0;var v=0,E=0,C=0;if(C=te(m|0,g|0,45)|0,Se()|0,!(Vn(C&127)|0))return C=0,C|0;C=te(m|0,g|0,52)|0,Se()|0,C=C&15;e:do if(!C)v=0;else for(E=1;;){if(v=te(m|0,g|0,(15-E|0)*3|0)|0,Se()|0,v=v&7,v|0)break e;if(E>>>0<C>>>0)E=E+1|0;else{v=0;break}}while(0);return C=(v|0)==0&1,C|0}function uA(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0;if(O=we,we=we+16|0,R=O,la(R,m,g,v),g=R,m=o[g>>2]|0,g=o[g+4>>2]|0,(m|0)==0&(g|0)==0)return we=O,0;C=0,v=0;do N=E+(C<<3)|0,o[N>>2]=m,o[N+4>>2]=g,C=d(C|0,v|0,1,0)|0,v=Se()|0,Na(R),N=R,m=o[N>>2]|0,g=o[N+4>>2]|0;while(!((m|0)==0&(g|0)==0));return we=O,0}function ts(m,g,v,E){return m=m|0,g=g|0,v=v|0,E=E|0,(E|0)<(v|0)?(v=g,E=m,Mt(v|0),E|0):(v=ue(-1,-1,((E-v|0)*3|0)+3|0)|0,E=ue(~v|0,~(Se()|0)|0,(15-E|0)*3|0)|0,v=~(Se()|0)&g,E=~E&m,Mt(v|0),E|0)}function qA(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0;return C=te(m|0,g|0,52)|0,Se()|0,C=C&15,(v|0)<16&(C|0)<=(v|0)?((C|0)<(v|0)&&(C=ue(-1,-1,((v+-1-C|0)*3|0)+3|0)|0,C=ue(~C|0,~(Se()|0)|0,(15-v|0)*3|0)|0,g=~(Se()|0)&g,m=~C&m),C=ue(v|0,0,52)|0,v=g&-15728641|(Se()|0),o[E>>2]=m|C,o[E+4>>2]=v,E=0,E|0):(E=4,E|0)}function vl(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0,it=0,Xe=0,Vt=0,Bt=0,dt=0,_t=0;if((v|0)==0&(E|0)==0)return dt=0,dt|0;if(C=m,R=o[C>>2]|0,C=o[C+4>>2]|0,!0&(C&15728640|0)==0){if(!((E|0)>0|(E|0)==0&v>>>0>0)||(dt=g,o[dt>>2]=R,o[dt+4>>2]=C,(v|0)==1&(E|0)==0))return dt=0,dt|0;C=1;do Vt=m+(C<<3)|0,Bt=o[Vt+4>>2]|0,dt=g+(C<<3)|0,o[dt>>2]=o[Vt>>2],o[dt+4>>2]=Bt,C=C+1|0;while(0<(E|0)|(E|0)==0&C>>>0<v>>>0);return C=0,C|0}if(Xe=v<<3,Bt=_(Xe)|0,!Bt)return dt=13,dt|0;if(Ge(Bt|0,m|0,Xe|0)|0,Vt=h(v,8)|0,!Vt)return l(Bt),dt=13,dt|0;e:do if(v|0){t:for(;;){C=Bt,ut=o[C>>2]|0,C=o[C+4>>2]|0,rt=te(ut|0,C|0,52)|0,Se()|0,rt=rt&15,it=rt+-1|0,ht=(v|0)>0;n:do if((rt|0)!=0&ht){if(je=((v|0)<0)<<31>>31,Be=ue(it|0,0,52)|0,Ye=Se()|0,it>>>0>15){if(!((ut|0)==0&(C|0)==0)){dt=17;break t}for(R=0;;){if(R=R+1|0,(R|0)>=(v|0))break n;if(E=Bt+(R<<3)|0,Ye=o[E>>2]|0,E=o[E+4>>2]|0,!((Ye|0)==0&(E|0)==0)){C=E,dt=17;break t}}}for(R=0,m=ut,E=C;;){if(!((m|0)==0&(E|0)==0)){if(!(!0&(E&117440512|0)==0)){dt=22;break t}if(N=te(m|0,E|0,52)|0,Se()|0,N=N&15,(N|0)<(it|0)){C=12,dt=28;break t}if((N|0)!=(it|0)&&(m=m|Be,E=E&-15728641|Ye,N>>>0>=rt>>>0)){O=it;do Re=ue(7,0,(14-O|0)*3|0)|0,O=O+1|0,m=Re|m,E=Se()|0|E;while(O>>>0<N>>>0)}if(O=Y(m|0,E|0,v|0,je|0)|0,Se()|0,J=Vt+(O<<3)|0,N=J,Q=o[N>>2]|0,N=o[N+4>>2]|0,(Q|0)==0&(N|0)==0)O=J;else for(Re=0;;){if((Re|0)>(v|0)){dt=32;break t}if((Q|0)==(m|0)&(N&-117440513|0)==(E|0)){le=te(Q|0,N|0,56)|0,Se()|0,le=le&7,de=le+1|0,_t=te(Q|0,N|0,45)|0,Se()|0;r:do if(!(Vn(_t&127)|0))N=7;else{if(Q=te(Q|0,N|0,52)|0,Se()|0,Q=Q&15,!Q){N=6;break}for(N=1;;){if(_t=ue(7,0,(15-N|0)*3|0)|0,!((_t&m|0)==0&((Se()|0)&E|0)==0)){N=7;break r}if(N>>>0<Q>>>0)N=N+1|0;else{N=6;break}}}while(0);if((le+2|0)>>>0>N>>>0){dt=42;break t}_t=ue(de|0,0,56)|0,E=Se()|0|E&-117440513,de=J,o[de>>2]=0,o[de+4>>2]=0,m=_t|m}else O=(O+1|0)%(v|0)|0;if(J=Vt+(O<<3)|0,N=J,Q=o[N>>2]|0,N=o[N+4>>2]|0,(Q|0)==0&(N|0)==0){O=J;break}else Re=Re+1|0}_t=O,o[_t>>2]=m,o[_t+4>>2]=E}if(R=R+1|0,(R|0)>=(v|0))break n;E=Bt+(R<<3)|0,m=o[E>>2]|0,E=o[E+4>>2]|0}}while(0);if((v+5|0)>>>0<11){dt=85;break}if(Ye=h((v|0)/6|0,8)|0,!Ye){dt=49;break}n:do if(ht){Re=0,de=0;do{if(N=Vt+(Re<<3)|0,E=N,R=o[E>>2]|0,E=o[E+4>>2]|0,!((R|0)==0&(E|0)==0)){Q=te(R|0,E|0,56)|0,Se()|0,Q=Q&7,m=Q+1|0,J=E&-117440513,_t=te(R|0,E|0,45)|0,Se()|0;r:do if(Vn(_t&127)|0){if(le=te(R|0,E|0,52)|0,Se()|0,le=le&15,le|0)for(O=1;;){if(_t=ue(7,0,(15-O|0)*3|0)|0,!((R&_t|0)==0&(J&(Se()|0)|0)==0))break r;if(O>>>0<le>>>0)O=O+1|0;else break}E=ue(m|0,0,56)|0,R=E|R,E=Se()|0|J,m=N,o[m>>2]=R,o[m+4>>2]=E,m=Q+2|0}while(0);(m|0)==7&&(_t=Ye+(de<<3)|0,o[_t>>2]=R,o[_t+4>>2]=E&-117440513,de=de+1|0)}Re=Re+1|0}while((Re|0)!=(v|0));if(ht){if(Re=((v|0)<0)<<31>>31,je=ue(it|0,0,52)|0,Be=Se()|0,it>>>0>15){if(!((ut|0)==0&(C|0)==0)){C=4,dt=84;break t}for(C=0;;){if(C=C+1|0,(C|0)>=(v|0)){R=0,C=de;break n}if(_t=Bt+(C<<3)|0,!((o[_t>>2]|0)==0&(o[_t+4>>2]|0)==0)){C=4,dt=84;break t}}}for(le=0,R=0,J=ut;;){do if(!((J|0)==0&(C|0)==0)){if(N=te(J|0,C|0,52)|0,Se()|0,N=N&15,(N|0)<(it|0)){C=12,dt=84;break t}do if((N|0)==(it|0))E=J,N=C;else{if(E=J|je,m=C&-15728641|Be,N>>>0<rt>>>0){N=m;break}O=it;do _t=ue(7,0,(14-O|0)*3|0)|0,O=O+1|0,E=_t|E,m=Se()|0|m;while(O>>>0<N>>>0);N=m}while(0);for(O=Y(E|0,N|0,v|0,Re|0)|0,Se()|0,m=0;;){if((m|0)>(v|0)){dt=77;break t}if(_t=Vt+(O<<3)|0,Q=o[_t+4>>2]|0,(Q&-117440513|0)==(N|0)&&(o[_t>>2]|0)==(E|0)){dt=79;break}if(O=(O+1|0)%(v|0)|0,_t=Vt+(O<<3)|0,(o[_t>>2]|0)==(E|0)&&(o[_t+4>>2]|0)==(N|0))break;m=m+1|0}if((dt|0)==79&&(dt=0,!0&(Q&117440512|0)==100663296))break;_t=g+(R<<3)|0,o[_t>>2]=J,o[_t+4>>2]=C,R=R+1|0}while(0);if(C=le+1|0,(C|0)>=(v|0)){C=de;break n}_t=Bt+(C<<3)|0,le=C,J=o[_t>>2]|0,C=o[_t+4>>2]|0}}else R=0,C=de}else R=0,C=0;while(0);if(Te(Vt|0,0,Xe|0)|0,Ge(Bt|0,Ye|0,C<<3|0)|0,l(Ye),C)g=g+(R<<3)|0,v=C;else break e}if((dt|0)==17)!0&(C&117440512|0)==0?(C=4,dt=28):dt=22;else if((dt|0)==32)An(23313,22674,362,22684);else{if((dt|0)==42)return l(Bt),l(Vt),_t=10,_t|0;if((dt|0)==49)return l(Bt),l(Vt),_t=13,_t|0;if((dt|0)==77)An(23313,22674,462,22684);else{if((dt|0)==84)return l(Ye),l(Bt),l(Vt),_t=C,_t|0;if((dt|0)==85){Ge(g|0,Bt|0,v<<3|0)|0;break}}}if((dt|0)==22)return l(Bt),l(Vt),_t=5,_t|0;if((dt|0)==28)return l(Bt),l(Vt),_t=C,_t|0}while(0);return l(Bt),l(Vt),_t=0,_t|0}function Ku(m,g,v,E,C,R,O){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0,R=R|0,O=O|0;var N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0;if(Ye=we,we=we+16|0,Be=Ye,!((v|0)>0|(v|0)==0&g>>>0>0))return Be=0,we=Ye,Be|0;if((O|0)>=16)return Be=12,we=Ye,Be|0;Re=0,je=0,de=0,N=0;e:for(;;){if(J=m+(Re<<3)|0,Q=o[J>>2]|0,J=o[J+4>>2]|0,le=te(Q|0,J|0,52)|0,Se()|0,(le&15|0)>(O|0)){N=12,Q=11;break}if(la(Be,Q,J,O),le=Be,J=o[le>>2]|0,le=o[le+4>>2]|0,(J|0)==0&(le|0)==0)Q=de;else{Q=de;do{if(!((N|0)<(R|0)|(N|0)==(R|0)&Q>>>0<C>>>0)){Q=10;break e}de=E+(Q<<3)|0,o[de>>2]=J,o[de+4>>2]=le,Q=d(Q|0,N|0,1,0)|0,N=Se()|0,Na(Be),de=Be,J=o[de>>2]|0,le=o[de+4>>2]|0}while(!((J|0)==0&(le|0)==0))}if(Re=d(Re|0,je|0,1,0)|0,je=Se()|0,(je|0)<(v|0)|(je|0)==(v|0)&Re>>>0<g>>>0)de=Q;else{N=0,Q=11;break}}return(Q|0)==10?(Be=14,we=Ye,Be|0):(Q|0)==11?(we=Ye,N|0):0}function jr(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0;Re=we,we=we+16|0,de=Re;e:do if((v|0)>0|(v|0)==0&g>>>0>0){for(J=0,O=0,R=0,le=0;;){if(Q=m+(J<<3)|0,N=o[Q>>2]|0,Q=o[Q+4>>2]|0,!((N|0)==0&(Q|0)==0)&&(Q=(_l(N,Q,E,de)|0)==0,N=de,O=d(o[N>>2]|0,o[N+4>>2]|0,O|0,R|0)|0,R=Se()|0,!Q)){R=12;break}if(J=d(J|0,le|0,1,0)|0,le=Se()|0,!((le|0)<(v|0)|(le|0)==(v|0)&J>>>0<g>>>0))break e}return we=Re,R|0}else O=0,R=0;while(0);return o[C>>2]=O,o[C+4>>2]=R,C=0,we=Re,C|0}function Pr(m,g){return m=m|0,g=g|0,g=te(m|0,g|0,52)|0,Se()|0,g&1|0}function Kr(m,g){m=m|0,g=g|0;var v=0,E=0,C=0;if(C=te(m|0,g|0,52)|0,Se()|0,C=C&15,!C)return C=0,C|0;for(E=1;;){if(v=te(m|0,g|0,(15-E|0)*3|0)|0,Se()|0,v=v&7,v|0){E=5;break}if(E>>>0<C>>>0)E=E+1|0;else{v=0,E=5;break}}return(E|0)==5?v|0:0}function ZA(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,Q=0;if(Q=te(m|0,g|0,52)|0,Se()|0,Q=Q&15,!Q)return N=g,Q=m,Mt(N|0),Q|0;for(N=1,v=0;;){R=(15-N|0)*3|0,E=ue(7,0,R|0)|0,C=Se()|0,O=te(m|0,g|0,R|0)|0,Se()|0,R=ue(Ao(O&7)|0,0,R|0)|0,O=Se()|0,m=R|m&~E,g=O|g&~C;e:do if(!v)if((R&E|0)==0&(O&C|0)==0)v=0;else if(E=te(m|0,g|0,52)|0,Se()|0,E=E&15,!E)v=1;else{v=1;t:for(;;){switch(O=te(m|0,g|0,(15-v|0)*3|0)|0,Se()|0,O&7){case 1:break t;case 0:break;default:{v=1;break e}}if(v>>>0<E>>>0)v=v+1|0;else{v=1;break e}}for(v=1;;)if(O=(15-v|0)*3|0,C=te(m|0,g|0,O|0)|0,Se()|0,R=ue(7,0,O|0)|0,g=g&~(Se()|0),O=ue(Ao(C&7)|0,0,O|0)|0,m=m&~R|O,g=g|(Se()|0),v>>>0<E>>>0)v=v+1|0;else{v=1;break}}while(0);if(N>>>0<Q>>>0)N=N+1|0;else break}return Mt(g|0),m|0}function Ls(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0;if(E=te(m|0,g|0,52)|0,Se()|0,E=E&15,!E)return v=g,E=m,Mt(v|0),E|0;for(v=1;R=(15-v|0)*3|0,O=te(m|0,g|0,R|0)|0,Se()|0,C=ue(7,0,R|0)|0,g=g&~(Se()|0),R=ue(Ao(O&7)|0,0,R|0)|0,m=R|m&~C,g=Se()|0|g,v>>>0<E>>>0;)v=v+1|0;return Mt(g|0),m|0}function Ju(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,Q=0;if(Q=te(m|0,g|0,52)|0,Se()|0,Q=Q&15,!Q)return N=g,Q=m,Mt(N|0),Q|0;for(N=1,v=0;;){R=(15-N|0)*3|0,E=ue(7,0,R|0)|0,C=Se()|0,O=te(m|0,g|0,R|0)|0,Se()|0,R=ue(Bo(O&7)|0,0,R|0)|0,O=Se()|0,m=R|m&~E,g=O|g&~C;e:do if(!v)if((R&E|0)==0&(O&C|0)==0)v=0;else if(E=te(m|0,g|0,52)|0,Se()|0,E=E&15,!E)v=1;else{v=1;t:for(;;){switch(O=te(m|0,g|0,(15-v|0)*3|0)|0,Se()|0,O&7){case 1:break t;case 0:break;default:{v=1;break e}}if(v>>>0<E>>>0)v=v+1|0;else{v=1;break e}}for(v=1;;)if(C=(15-v|0)*3|0,R=ue(7,0,C|0)|0,O=g&~(Se()|0),g=te(m|0,g|0,C|0)|0,Se()|0,g=ue(Bo(g&7)|0,0,C|0)|0,m=m&~R|g,g=O|(Se()|0),v>>>0<E>>>0)v=v+1|0;else{v=1;break}}while(0);if(N>>>0<Q>>>0)N=N+1|0;else break}return Mt(g|0),m|0}function cA(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0;if(E=te(m|0,g|0,52)|0,Se()|0,E=E&15,!E)return v=g,E=m,Mt(v|0),E|0;for(v=1;O=(15-v|0)*3|0,R=ue(7,0,O|0)|0,C=g&~(Se()|0),g=te(m|0,g|0,O|0)|0,Se()|0,g=ue(Bo(g&7)|0,0,O|0)|0,m=g|m&~R,g=Se()|0|C,v>>>0<E>>>0;)v=v+1|0;return Mt(g|0),m|0}function si(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(Q=we,we=we+64|0,N=Q+40|0,E=Q+24|0,C=Q+12|0,R=Q,ue(g|0,0,52)|0,v=Se()|0|134225919,!g)return(o[m+4>>2]|0)>2||(o[m+8>>2]|0)>2||(o[m+12>>2]|0)>2?(O=0,N=0,Mt(O|0),we=Q,N|0):(ue(rA(m)|0,0,45)|0,O=Se()|0|v,N=-1,Mt(O|0),we=Q,N|0);if(o[N>>2]=o[m>>2],o[N+4>>2]=o[m+4>>2],o[N+8>>2]=o[m+8>>2],o[N+12>>2]=o[m+12>>2],O=N+4|0,(g|0)>0)for(m=-1;o[E>>2]=o[O>>2],o[E+4>>2]=o[O+4>>2],o[E+8>>2]=o[O+8>>2],g&1?(lA(O),o[C>>2]=o[O>>2],o[C+4>>2]=o[O+4>>2],o[C+8>>2]=o[O+8>>2],Ro(C)):(Da(O),o[C>>2]=o[O>>2],o[C+4>>2]=o[O+4>>2],o[C+8>>2]=o[O+8>>2],Oi(C)),ao(E,C,R),Bn(R),le=(15-g|0)*3|0,J=ue(7,0,le|0)|0,v=v&~(Se()|0),le=ue(Do(R)|0,0,le|0)|0,m=le|m&~J,v=Se()|0|v,(g|0)>1;)g=g+-1|0;else m=-1;e:do if((o[O>>2]|0)<=2&&(o[N+8>>2]|0)<=2&&(o[N+12>>2]|0)<=2){if(E=rA(N)|0,g=ue(E|0,0,45)|0,g=g|m,m=Se()|0|v&-1040385,R=iA(N)|0,!(Vn(E)|0)){if((R|0)<=0)break;for(C=0;;){if(E=te(g|0,m|0,52)|0,Se()|0,E=E&15,E)for(v=1;le=(15-v|0)*3|0,N=te(g|0,m|0,le|0)|0,Se()|0,J=ue(7,0,le|0)|0,m=m&~(Se()|0),le=ue(Ao(N&7)|0,0,le|0)|0,g=g&~J|le,m=m|(Se()|0),v>>>0<E>>>0;)v=v+1|0;if(C=C+1|0,(C|0)==(R|0))break e}}C=te(g|0,m|0,52)|0,Se()|0,C=C&15;t:do if(C){v=1;n:for(;;){switch(le=te(g|0,m|0,(15-v|0)*3|0)|0,Se()|0,le&7){case 1:break n;case 0:break;default:break t}if(v>>>0<C>>>0)v=v+1|0;else break t}if(sA(E,o[N>>2]|0)|0)for(v=1;N=(15-v|0)*3|0,J=ue(7,0,N|0)|0,le=m&~(Se()|0),m=te(g|0,m|0,N|0)|0,Se()|0,m=ue(Bo(m&7)|0,0,N|0)|0,g=g&~J|m,m=le|(Se()|0),v>>>0<C>>>0;)v=v+1|0;else for(v=1;le=(15-v|0)*3|0,N=te(g|0,m|0,le|0)|0,Se()|0,J=ue(7,0,le|0)|0,m=m&~(Se()|0),le=ue(Ao(N&7)|0,0,le|0)|0,g=g&~J|le,m=m|(Se()|0),v>>>0<C>>>0;)v=v+1|0}while(0);if((R|0)>0){v=0;do g=ZA(g,m)|0,m=Se()|0,v=v+1|0;while((v|0)!=(R|0))}}else g=0,m=0;while(0);return J=m,le=g,Mt(J|0),we=Q,le|0}function gi(m){return m=m|0,(m|0)%2|0|0}function ns(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0;return C=we,we=we+16|0,E=C,g>>>0>15?(E=4,we=C,E|0):(o[m+4>>2]&2146435072|0)==2146435072||(o[m+8+4>>2]&2146435072|0)==2146435072?(E=3,we=C,E|0):(Gn(m,g,E),g=si(E,g)|0,E=Se()|0,o[v>>2]=g,o[v+4>>2]=E,(g|0)==0&(E|0)==0&&An(23313,22674,786,22697),E=0,we=C,E|0)}function aa(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0;if(C=v+4|0,R=te(m|0,g|0,52)|0,Se()|0,R=R&15,O=te(m|0,g|0,45)|0,Se()|0,E=(R|0)==0,Vn(O&127)|0){if(E)return O=1,O|0;E=1}else{if(E)return O=0,O|0;!(o[C>>2]|0)&&!(o[v+8>>2]|0)?E=(o[v+12>>2]|0)!=0&1:E=1}for(v=1;v&1?Ro(C):Oi(C),O=te(m|0,g|0,(15-v|0)*3|0)|0,Se()|0,Fi(C,O&7),v>>>0<R>>>0;)v=v+1|0;return E|0}function Gi(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(le=we,we=we+16|0,Q=le,J=te(m|0,g|0,45)|0,Se()|0,J=J&127,J>>>0>121)return o[v>>2]=0,o[v+4>>2]=0,o[v+8>>2]=0,o[v+12>>2]=0,J=5,we=le,J|0;e:do if(Vn(J)|0&&(R=te(m|0,g|0,52)|0,Se()|0,R=R&15,(R|0)!=0)){E=1;t:for(;;){switch(N=te(m|0,g|0,(15-E|0)*3|0)|0,Se()|0,N&7){case 5:break t;case 0:break;default:{E=g;break e}}if(E>>>0<R>>>0)E=E+1|0;else{E=g;break e}}for(C=1,E=g;g=(15-C|0)*3|0,O=ue(7,0,g|0)|0,N=E&~(Se()|0),E=te(m|0,E|0,g|0)|0,Se()|0,E=ue(Bo(E&7)|0,0,g|0)|0,m=m&~O|E,E=N|(Se()|0),C>>>0<R>>>0;)C=C+1|0}else E=g;while(0);if(N=7696+(J*28|0)|0,o[v>>2]=o[N>>2],o[v+4>>2]=o[N+4>>2],o[v+8>>2]=o[N+8>>2],o[v+12>>2]=o[N+12>>2],!(aa(m,E,v)|0))return J=0,we=le,J|0;if(O=v+4|0,o[Q>>2]=o[O>>2],o[Q+4>>2]=o[O+4>>2],o[Q+8>>2]=o[O+8>>2],R=te(m|0,E|0,52)|0,Se()|0,N=R&15,R&1?(Oi(O),R=N+1|0):R=N,!(Vn(J)|0))E=0;else{e:do if(!N)E=0;else for(g=1;;){if(C=te(m|0,E|0,(15-g|0)*3|0)|0,Se()|0,C=C&7,C|0){E=C;break e}if(g>>>0<N>>>0)g=g+1|0;else{E=0;break}}while(0);E=(E|0)==4&1}if(!(Ba(v,R,E,0)|0))(R|0)!=(N|0)&&(o[O>>2]=o[Q>>2],o[O+4>>2]=o[Q+4>>2],o[O+8>>2]=o[Q+8>>2]);else{if(Vn(J)|0)do;while(Ba(v,R,0,0)|0);(R|0)!=(N|0)&&Da(O)}return J=0,we=le,J|0}function co(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;return R=we,we=we+16|0,E=R,C=Gi(m,g,E)|0,C|0?(we=R,C|0):(C=te(m|0,g|0,52)|0,Se()|0,gl(E,C&15,v),C=0,we=R,C|0)}function Ai(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0;if(O=we,we=we+16|0,R=O,E=Gi(m,g,R)|0,E|0)return R=E,we=O,R|0;E=te(m|0,g|0,45)|0,Se()|0,E=(Vn(E&127)|0)==0,C=te(m|0,g|0,52)|0,Se()|0,C=C&15;e:do if(!E){if(C|0)for(E=1;;){if(N=ue(7,0,(15-E|0)*3|0)|0,!((N&m|0)==0&((Se()|0)&g|0)==0))break e;if(E>>>0<C>>>0)E=E+1|0;else break}return Oo(R,C,0,5,v),N=0,we=O,N|0}while(0);return QA(R,C,0,6,v),N=0,we=O,N|0}function Oa(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;if(C=te(m|0,g|0,45)|0,Se()|0,!(Vn(C&127)|0))return C=2,o[v>>2]=C,0;if(C=te(m|0,g|0,52)|0,Se()|0,C=C&15,!C)return C=5,o[v>>2]=C,0;for(E=1;;){if(R=ue(7,0,(15-E|0)*3|0)|0,!((R&m|0)==0&((Se()|0)&g|0)==0)){E=2,m=6;break}if(E>>>0<C>>>0)E=E+1|0;else{E=5,m=6;break}}return(m|0)==6&&(o[v>>2]=E),0}function xl(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0;de=we,we=we+128|0,J=de+112|0,R=de+96|0,le=de,C=te(m|0,g|0,52)|0,Se()|0,N=C&15,o[J>>2]=N,O=te(m|0,g|0,45)|0,Se()|0,O=O&127;e:do if(Vn(O)|0){if(N|0)for(E=1;;){if(Q=ue(7,0,(15-E|0)*3|0)|0,!((Q&m|0)==0&((Se()|0)&g|0)==0)){C=0;break e}if(E>>>0<N>>>0)E=E+1|0;else break}if(C&1)C=1;else return Q=ue(N+1|0,0,52)|0,le=Se()|0|g&-15728641,J=ue(7,0,(14-N|0)*3|0)|0,le=xl((Q|m)&~J,le&~(Se()|0),v)|0,we=de,le|0}else C=0;while(0);if(E=Gi(m,g,R)|0,!E){C?(Yu(R,J,le),Q=5):(ks(R,J,le),Q=6);e:do if(Vn(O)|0)if(!N)m=5;else for(E=1;;){if(O=ue(7,0,(15-E|0)*3|0)|0,!((O&m|0)==0&((Se()|0)&g|0)==0)){m=2;break e}if(E>>>0<N>>>0)E=E+1|0;else{m=5;break}}else m=2;while(0);Te(v|0,-1,m<<2|0)|0;e:do if(C)for(R=0;;){if(O=le+(R<<4)|0,Xu(O,o[J>>2]|0)|0,O=o[O>>2]|0,N=o[v>>2]|0,(N|0)==-1|(N|0)==(O|0))E=v;else{C=0;do{if(C=C+1|0,C>>>0>=m>>>0){E=1;break e}E=v+(C<<2)|0,N=o[E>>2]|0}while(!((N|0)==-1|(N|0)==(O|0)))}if(o[E>>2]=O,R=R+1|0,R>>>0>=Q>>>0){E=0;break}}else for(R=0;;){if(O=le+(R<<4)|0,Ba(O,o[J>>2]|0,0,1)|0,O=o[O>>2]|0,N=o[v>>2]|0,(N|0)==-1|(N|0)==(O|0))E=v;else{C=0;do{if(C=C+1|0,C>>>0>=m>>>0){E=1;break e}E=v+(C<<2)|0,N=o[E>>2]|0}while(!((N|0)==-1|(N|0)==(O|0)))}if(o[E>>2]=O,R=R+1|0,R>>>0>=Q>>>0){E=0;break}}while(0)}return le=E,we=de,le|0}function Fa(){return 12}function Ds(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,Q=0;if(m>>>0>15)return N=4,N|0;if(ue(m|0,0,52)|0,N=Se()|0|134225919,!m){v=0,E=0;do Vn(E)|0&&(ue(E|0,0,45)|0,O=N|(Se()|0),m=g+(v<<3)|0,o[m>>2]=-1,o[m+4>>2]=O,v=v+1|0),E=E+1|0;while((E|0)!=122);return v=0,v|0}v=0,O=0;do{if(Vn(O)|0){for(ue(O|0,0,45)|0,E=1,C=-1,R=N|(Se()|0);Q=ue(7,0,(15-E|0)*3|0)|0,C=C&~Q,R=R&~(Se()|0),(E|0)!=(m|0);)E=E+1|0;Q=g+(v<<3)|0,o[Q>>2]=C,o[Q+4>>2]=R,v=v+1|0}O=O+1|0}while((O|0)!=122);return v=0,v|0}function rs(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0;if(rt=we,we=we+16|0,ht=rt,ut=te(m|0,g|0,52)|0,Se()|0,ut=ut&15,v>>>0>15)return ut=4,we=rt,ut|0;if((ut|0)<(v|0))return ut=12,we=rt,ut|0;if((ut|0)!=(v|0))if(R=ue(v|0,0,52)|0,R=R|m,N=Se()|0|g&-15728641,(ut|0)>(v|0)){Q=v;do Ye=ue(7,0,(14-Q|0)*3|0)|0,Q=Q+1|0,R=Ye|R,N=Se()|0|N;while((Q|0)<(ut|0));Ye=R}else Ye=R;else Ye=m,N=g;Be=te(Ye|0,N|0,45)|0,Se()|0;e:do if(Vn(Be&127)|0){if(Q=te(Ye|0,N|0,52)|0,Se()|0,Q=Q&15,Q|0)for(R=1;;){if(Be=ue(7,0,(15-R|0)*3|0)|0,!((Be&Ye|0)==0&((Se()|0)&N|0)==0)){J=33;break e}if(R>>>0<Q>>>0)R=R+1|0;else break}if(Be=E,o[Be>>2]=0,o[Be+4>>2]=0,(ut|0)>(v|0)){for(Be=g&-15728641,je=ut;;){if(Re=je,je=je+-1|0,je>>>0>15|(ut|0)<(je|0)){J=19;break}if((ut|0)!=(je|0))if(R=ue(je|0,0,52)|0,R=R|m,Q=Se()|0|Be,(ut|0)<(Re|0))de=R;else{J=je;do de=ue(7,0,(14-J|0)*3|0)|0,J=J+1|0,R=de|R,Q=Se()|0|Q;while((J|0)<(ut|0));de=R}else de=m,Q=g;if(le=te(de|0,Q|0,45)|0,Se()|0,!(Vn(le&127)|0))R=0;else{le=te(de|0,Q|0,52)|0,Se()|0,le=le&15;t:do if(!le)R=0;else for(J=1;;){if(R=te(de|0,Q|0,(15-J|0)*3|0)|0,Se()|0,R=R&7,R|0)break t;if(J>>>0<le>>>0)J=J+1|0;else{R=0;break}}while(0);R=(R|0)==0&1}if(Q=te(m|0,g|0,(15-Re|0)*3|0)|0,Se()|0,Q=Q&7,(Q|0)==7){C=5,J=42;break}if(R=(R|0)!=0,(Q|0)==1&R){C=5,J=42;break}if(de=Q+(((Q|0)!=0&R)<<31>>31)|0,de|0&&(J=ut-Re|0,J=Bs(7,0,J,((J|0)<0)<<31>>31)|0,le=Se()|0,R?(R=V(J|0,le|0,5,0)|0,R=d(R|0,Se()|0,-5,-1)|0,R=M(R|0,Se()|0,6,0)|0,R=d(R|0,Se()|0,1,0)|0,Q=Se()|0):(R=J,Q=le),Re=de+-1|0,Re=V(J|0,le|0,Re|0,((Re|0)<0)<<31>>31|0)|0,Re=d(R|0,Q|0,Re|0,Se()|0)|0,de=Se()|0,le=E,le=d(Re|0,de|0,o[le>>2]|0,o[le+4>>2]|0)|0,de=Se()|0,Re=E,o[Re>>2]=le,o[Re+4>>2]=de),(je|0)<=(v|0)){J=37;break}}if((J|0)==19)An(23313,22674,1099,22710);else if((J|0)==37){O=E,C=o[O+4>>2]|0,O=o[O>>2]|0;break}else if((J|0)==42)return we=rt,C|0}else C=0,O=0}else J=33;while(0);e:do if((J|0)==33)if(Be=E,o[Be>>2]=0,o[Be+4>>2]=0,(ut|0)>(v|0)){for(R=ut;;){if(C=te(m|0,g|0,(15-R|0)*3|0)|0,Se()|0,C=C&7,(C|0)==7){C=5;break}if(O=ut-R|0,O=Bs(7,0,O,((O|0)<0)<<31>>31)|0,C=V(O|0,Se()|0,C|0,0)|0,O=Se()|0,Be=E,O=d(o[Be>>2]|0,o[Be+4>>2]|0,C|0,O|0)|0,C=Se()|0,Be=E,o[Be>>2]=O,o[Be+4>>2]=C,R=R+-1|0,(R|0)<=(v|0))break e}return we=rt,C|0}else C=0,O=0;while(0);return _l(Ye,N,ut,ht)|0&&An(23313,22674,1063,22725),ut=ht,ht=o[ut+4>>2]|0,((C|0)>-1|(C|0)==-1&O>>>0>4294967295)&((ht|0)>(C|0)|((ht|0)==(C|0)?(o[ut>>2]|0)>>>0>O>>>0:0))?(ut=0,we=rt,ut|0):(An(23313,22674,1139,22710),0)}function ec(m,g,v,E,C,R){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0,R=R|0;var O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0;if(de=we,we=we+16|0,O=de,C>>>0>15)return R=4,we=de,R|0;if(N=te(v|0,E|0,52)|0,Se()|0,N=N&15,(N|0)>(C|0))return R=12,we=de,R|0;if(_l(v,E,C,O)|0&&An(23313,22674,1063,22725),le=O,J=o[le+4>>2]|0,!(((g|0)>-1|(g|0)==-1&m>>>0>4294967295)&((J|0)>(g|0)|((J|0)==(g|0)?(o[le>>2]|0)>>>0>m>>>0:0))))return R=2,we=de,R|0;le=C-N|0,C=ue(C|0,0,52)|0,Q=Se()|0|E&-15728641,J=R,o[J>>2]=C|v,o[J+4>>2]=Q,J=te(v|0,E|0,45)|0,Se()|0;e:do if(Vn(J&127)|0){if(N|0)for(O=1;;){if(J=ue(7,0,(15-O|0)*3|0)|0,!((J&v|0)==0&((Se()|0)&E|0)==0))break e;if(O>>>0<N>>>0)O=O+1|0;else break}if((le|0)<1)return R=0,we=de,R|0;for(J=N^15,E=-1,Q=1,O=1;;){N=le-Q|0,N=Bs(7,0,N,((N|0)<0)<<31>>31)|0,v=Se()|0;do if(O)if(O=V(N|0,v|0,5,0)|0,O=d(O|0,Se()|0,-5,-1)|0,O=M(O|0,Se()|0,6,0)|0,C=Se()|0,(g|0)>(C|0)|(g|0)==(C|0)&m>>>0>O>>>0){g=d(m|0,g|0,-1,-1)|0,g=x(g|0,Se()|0,O|0,C|0)|0,O=Se()|0,Re=R,Be=o[Re>>2]|0,Re=o[Re+4>>2]|0,Ye=(J+E|0)*3|0,je=ue(7,0,Ye|0)|0,Re=Re&~(Se()|0),E=M(g|0,O|0,N|0,v|0)|0,m=Se()|0,C=d(E|0,m|0,2,0)|0,Ye=ue(C|0,Se()|0,Ye|0)|0,Re=Se()|0|Re,C=R,o[C>>2]=Ye|Be&~je,o[C+4>>2]=Re,m=V(E|0,m|0,N|0,v|0)|0,m=x(g|0,O|0,m|0,Se()|0)|0,O=0,g=Se()|0;break}else{Ye=R,je=o[Ye>>2]|0,Ye=o[Ye+4>>2]|0,Be=ue(7,0,(J+E|0)*3|0)|0,Ye=Ye&~(Se()|0),O=R,o[O>>2]=je&~Be,o[O+4>>2]=Ye,O=1;break}else je=R,C=o[je>>2]|0,je=o[je+4>>2]|0,E=(J+E|0)*3|0,Re=ue(7,0,E|0)|0,je=je&~(Se()|0),Ye=M(m|0,g|0,N|0,v|0)|0,O=Se()|0,E=ue(Ye|0,O|0,E|0)|0,je=Se()|0|je,Be=R,o[Be>>2]=E|C&~Re,o[Be+4>>2]=je,O=V(Ye|0,O|0,N|0,v|0)|0,m=x(m|0,g|0,O|0,Se()|0)|0,O=0,g=Se()|0;while(0);if((le|0)>(Q|0))E=~Q,Q=Q+1|0;else{g=0;break}}return we=de,g|0}while(0);if((le|0)<1)return Ye=0,we=de,Ye|0;for(C=N^15,O=1;;)if(Be=le-O|0,Be=Bs(7,0,Be,((Be|0)<0)<<31>>31)|0,Ye=Se()|0,Q=R,v=o[Q>>2]|0,Q=o[Q+4>>2]|0,N=(C-O|0)*3|0,E=ue(7,0,N|0)|0,Q=Q&~(Se()|0),Re=M(m|0,g|0,Be|0,Ye|0)|0,je=Se()|0,N=ue(Re|0,je|0,N|0)|0,Q=Se()|0|Q,J=R,o[J>>2]=N|v&~E,o[J+4>>2]=Q,Ye=V(Re|0,je|0,Be|0,Ye|0)|0,m=x(m|0,g|0,Ye|0,Se()|0)|0,g=Se()|0,(le|0)<=(O|0)){g=0;break}else O=O+1|0;return we=de,g|0}function la(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0;C=te(g|0,v|0,52)|0,Se()|0,C=C&15,(g|0)==0&(v|0)==0|((E|0)>15|(C|0)>(E|0))?(E=-1,C=-1,g=0,v=0):(R=ts(g,v,C+1|0,E)|0,v=(Se()|0)&-15728641,g=ue(E|0,0,52)|0,g=R|g,v=v|(Se()|0),R=(fr(g,v)|0)==0,E=R?-1:E),R=m,o[R>>2]=g,o[R+4>>2]=v,o[m+8>>2]=C,o[m+12>>2]=E}function Na(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0,Q=0,J=0;if(v=m,g=o[v>>2]|0,v=o[v+4>>2]|0,!((g|0)==0&(v|0)==0)&&(E=te(g|0,v|0,52)|0,Se()|0,E=E&15,N=ue(1,0,(E^15)*3|0)|0,g=d(N|0,Se()|0,g|0,v|0)|0,v=Se()|0,N=m,o[N>>2]=g,o[N+4>>2]=v,N=m+8|0,O=o[N>>2]|0,!((E|0)<(O|0)))){for(Q=m+12|0,R=E;;){if((R|0)==(O|0)){E=5;break}if(J=(R|0)==(o[Q>>2]|0),C=(15-R|0)*3|0,E=te(g|0,v|0,C|0)|0,Se()|0,E=E&7,J&((E|0)==1&!0)){E=7;break}if(!((E|0)==7&!0)){E=10;break}if(J=ue(1,0,C|0)|0,g=d(g|0,v|0,J|0,Se()|0)|0,v=Se()|0,J=m,o[J>>2]=g,o[J+4>>2]=v,(R|0)>(O|0))R=R+-1|0;else{E=10;break}}if((E|0)==5){J=m,o[J>>2]=0,o[J+4>>2]=0,o[N>>2]=-1,o[Q>>2]=-1;return}else if((E|0)==7){O=ue(1,0,C|0)|0,O=d(g|0,v|0,O|0,Se()|0)|0,N=Se()|0,J=m,o[J>>2]=O,o[J+4>>2]=N,o[Q>>2]=R+-1;return}else if((E|0)==10)return}}function Jr(m){m=+m;var g=0;return g=m<0?m+6.283185307179586:m,+(m>=6.283185307179586?g+-6.283185307179586:g)}function gs(m,g){return m=m|0,g=g|0,+ke(+(+G[m>>3]-+G[g>>3]))<17453292519943298e-27?(g=+ke(+(+G[m+8>>3]-+G[g+8>>3]))<17453292519943298e-27,g|0):(g=0,g|0)}function ji(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0;return C=+G[g>>3],E=+G[m>>3],R=+ft(+((C-E)*.5)),v=+ft(+((+G[g+8>>3]-+G[m+8>>3])*.5)),v=R*R+v*(+$e(+C)*+$e(+E)*v),+(+dn(+ +We(+v),+ +We(+(1-v)))*2)}function wl(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0;return C=+G[g>>3],E=+G[m>>3],R=+ft(+((C-E)*.5)),v=+ft(+((+G[g+8>>3]-+G[m+8>>3])*.5)),v=R*R+v*(+$e(+C)*+$e(+E)*v),+(+dn(+ +We(+v),+ +We(+(1-v)))*2*6371.007180918475)}function Fo(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0;return C=+G[g>>3],E=+G[m>>3],R=+ft(+((C-E)*.5)),v=+ft(+((+G[g+8>>3]-+G[m+8>>3])*.5)),v=R*R+v*(+$e(+C)*+$e(+E)*v),+(+dn(+ +We(+v),+ +We(+(1-v)))*2*6371.007180918475*1e3)}function tc(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0;return R=+G[g>>3],E=+$e(+R),C=+G[g+8>>3]-+G[m+8>>3],O=E*+ft(+C),v=+G[m>>3],+ +dn(+O,+(+ft(+R)*+$e(+v)-+$e(+C)*(E*+ft(+v))))}function ho(m,g,v,E){m=m|0,g=+g,v=+v,E=E|0;var C=0,R=0,O=0,N=0;if(v<1e-16){o[E>>2]=o[m>>2],o[E+4>>2]=o[m+4>>2],o[E+8>>2]=o[m+8>>2],o[E+12>>2]=o[m+12>>2];return}R=g<0?g+6.283185307179586:g,R=g>=6.283185307179586?R+-6.283185307179586:R;do if(R<1e-16)g=+G[m>>3]+v,G[E>>3]=g,C=E;else{if(C=+ke(+(R+-3.141592653589793))<1e-16,g=+G[m>>3],C){g=g-v,G[E>>3]=g,C=E;break}if(O=+$e(+v),v=+ft(+v),g=O*+ft(+g)+ +$e(+R)*(v*+$e(+g)),g=g>1?1:g,g=+rn(+(g<-1?-1:g)),G[E>>3]=g,+ke(+(g+-1.5707963267948966))<1e-16){G[E>>3]=1.5707963267948966,G[E+8>>3]=0;return}if(+ke(+(g+1.5707963267948966))<1e-16){G[E>>3]=-1.5707963267948966,G[E+8>>3]=0;return}if(N=+$e(+g),R=v*+ft(+R)/N,v=+G[m>>3],g=(O-+ft(+g)*+ft(+v))/+$e(+v)/N,O=R>1?1:R,g=g>1?1:g,g=+G[m+8>>3]+ +dn(+(O<-1?-1:O),+(g<-1?-1:g)),g>3.141592653589793)do g=g+-6.283185307179586;while(g>3.141592653589793);if(g<-3.141592653589793)do g=g+6.283185307179586;while(g<-3.141592653589793);G[E+8>>3]=g;return}while(0);if(+ke(+(g+-1.5707963267948966))<1e-16){G[C>>3]=1.5707963267948966,G[E+8>>3]=0;return}if(+ke(+(g+1.5707963267948966))<1e-16){G[C>>3]=-1.5707963267948966,G[E+8>>3]=0;return}if(g=+G[m+8>>3],g>3.141592653589793)do g=g+-6.283185307179586;while(g>3.141592653589793);if(g<-3.141592653589793)do g=g+6.283185307179586;while(g<-3.141592653589793);G[E+8>>3]=g}function bl(m,g){return m=m|0,g=g|0,m>>>0>15?(g=4,g|0):(G[g>>3]=+G[20528+(m<<3)>>3],g=0,g|0)}function Ua(m,g){return m=m|0,g=g|0,m>>>0>15?(g=4,g|0):(G[g>>3]=+G[20656+(m<<3)>>3],g=0,g|0)}function Jc(m,g){return m=m|0,g=g|0,m>>>0>15?(g=4,g|0):(G[g>>3]=+G[20784+(m<<3)>>3],g=0,g|0)}function eh(m,g){return m=m|0,g=g|0,m>>>0>15?(g=4,g|0):(G[g>>3]=+G[20912+(m<<3)>>3],g=0,g|0)}function Va(m,g){m=m|0,g=g|0;var v=0;return m>>>0>15?(g=4,g|0):(v=Bs(7,0,m,((m|0)<0)<<31>>31)|0,v=V(v|0,Se()|0,120,0)|0,m=Se()|0,o[g>>2]=v|2,o[g+4>>2]=m,g=0,g|0)}function Aa(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0;return Re=+G[g>>3],le=+G[m>>3],Q=+ft(+((Re-le)*.5)),R=+G[g+8>>3],J=+G[m+8>>3],O=+ft(+((R-J)*.5)),N=+$e(+le),de=+$e(+Re),O=Q*Q+O*(de*N*O),O=+dn(+ +We(+O),+ +We(+(1-O)))*2,Q=+G[v>>3],Re=+ft(+((Q-Re)*.5)),E=+G[v+8>>3],R=+ft(+((E-R)*.5)),C=+$e(+Q),R=Re*Re+R*(de*C*R),R=+dn(+ +We(+R),+ +We(+(1-R)))*2,Q=+ft(+((le-Q)*.5)),E=+ft(+((J-E)*.5)),E=Q*Q+E*(N*C*E),E=+dn(+ +We(+E),+ +We(+(1-E)))*2,C=(O+R+E)*.5,+(+jt(+ +We(+(+Lt(+(C*.5))*+Lt(+((C-O)*.5))*+Lt(+((C-R)*.5))*+Lt(+((C-E)*.5)))))*4)}function is(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0;if(N=we,we=we+192|0,R=N+168|0,O=N,C=co(m,g,R)|0,C|0)return v=C,we=N,v|0;if(Ai(m,g,O)|0&&An(23313,22742,386,22751),g=o[O>>2]|0,(g|0)>0){if(E=+Aa(O+8|0,O+8+(((g|0)!=1&1)<<4)|0,R)+0,(g|0)!=1){m=1;do C=m,m=m+1|0,E=E+ +Aa(O+8+(C<<4)|0,O+8+(((m|0)%(g|0)|0)<<4)|0,R);while((m|0)<(g|0))}}else E=0;return G[v>>3]=E,v=0,we=N,v|0}function Ft(m,g,v){return m=m|0,g=g|0,v=v|0,m=is(m,g,v)|0,m|0||(G[v>>3]=+G[v>>3]*6371.007180918475*6371.007180918475),m|0}function YA(m,g,v){return m=m|0,g=g|0,v=v|0,m=is(m,g,v)|0,m|0||(G[v>>3]=+G[v>>3]*6371.007180918475*6371.007180918475*1e3*1e3),m|0}function ua(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(N=we,we=we+176|0,O=N,m=Is(m,g,O)|0,m|0)return O=m,we=N,O|0;if(G[v>>3]=0,m=o[O>>2]|0,(m|0)<=1)return O=0,we=N,O|0;g=m+-1|0,m=0,E=+G[O+8>>3],C=+G[O+16>>3],R=0;do m=m+1|0,J=E,E=+G[O+8+(m<<4)>>3],le=+ft(+((E-J)*.5)),Q=C,C=+G[O+8+(m<<4)+8>>3],Q=+ft(+((C-Q)*.5)),Q=le*le+Q*(+$e(+E)*+$e(+J)*Q),R=R+ +dn(+ +We(+Q),+ +We(+(1-Q)))*2;while((m|0)<(g|0));return G[v>>3]=R,O=0,we=N,O|0}function No(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(N=we,we=we+176|0,O=N,m=Is(m,g,O)|0,m|0)return O=m,R=+G[v>>3],R=R*6371.007180918475,G[v>>3]=R,we=N,O|0;if(G[v>>3]=0,m=o[O>>2]|0,(m|0)<=1)return O=0,R=0,R=R*6371.007180918475,G[v>>3]=R,we=N,O|0;g=m+-1|0,m=0,E=+G[O+8>>3],C=+G[O+16>>3],R=0;do m=m+1|0,J=E,E=+G[O+8+(m<<4)>>3],le=+ft(+((E-J)*.5)),Q=C,C=+G[O+8+(m<<4)+8>>3],Q=+ft(+((C-Q)*.5)),Q=le*le+Q*(+$e(+J)*+$e(+E)*Q),R=R+ +dn(+ +We(+Q),+ +We(+(1-Q)))*2;while((m|0)!=(g|0));return G[v>>3]=R,O=0,le=R,le=le*6371.007180918475,G[v>>3]=le,we=N,O|0}function XA(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(N=we,we=we+176|0,O=N,m=Is(m,g,O)|0,m|0)return O=m,R=+G[v>>3],R=R*6371.007180918475,R=R*1e3,G[v>>3]=R,we=N,O|0;if(G[v>>3]=0,m=o[O>>2]|0,(m|0)<=1)return O=0,R=0,R=R*6371.007180918475,R=R*1e3,G[v>>3]=R,we=N,O|0;g=m+-1|0,m=0,E=+G[O+8>>3],C=+G[O+16>>3],R=0;do m=m+1|0,J=E,E=+G[O+8+(m<<4)>>3],le=+ft(+((E-J)*.5)),Q=C,C=+G[O+8+(m<<4)+8>>3],Q=+ft(+((C-Q)*.5)),Q=le*le+Q*(+$e(+J)*+$e(+E)*Q),R=R+ +dn(+ +We(+Q),+ +We(+(1-Q)))*2;while((m|0)!=(g|0));return G[v>>3]=R,O=0,le=R,le=le*6371.007180918475,le=le*1e3,G[v>>3]=le,we=N,O|0}function Ut(m){m=m|0;var g=0,v=0,E=0;return g=h(1,12)|0,g||An(22832,22787,49,22845),v=m+4|0,E=o[v>>2]|0,E|0?(E=E+8|0,o[E>>2]=g,o[v>>2]=g,g|0):(o[m>>2]|0&&An(22862,22787,61,22885),E=m,o[E>>2]=g,o[v>>2]=g,g|0)}function hA(m,g){m=m|0,g=g|0;var v=0,E=0;return E=_(24)|0,E||An(22899,22787,78,22913),o[E>>2]=o[g>>2],o[E+4>>2]=o[g+4>>2],o[E+8>>2]=o[g+8>>2],o[E+12>>2]=o[g+12>>2],o[E+16>>2]=0,g=m+4|0,v=o[g>>2]|0,v|0?(o[v+16>>2]=E,o[g>>2]=E,E|0):(o[m>>2]|0&&An(22928,22787,82,22913),o[m>>2]=E,o[g>>2]=E,E|0)}function El(m){m=m|0;var g=0,v=0,E=0,C=0;if(m)for(E=1;;){if(g=o[m>>2]|0,g|0)do{if(v=o[g>>2]|0,v|0)do C=v,v=o[v+16>>2]|0,l(C);while(v|0);C=g,g=o[g+8>>2]|0,l(C)}while(g|0);if(g=m,m=o[m+8>>2]|0,E||l(g),m)E=0;else break}}function fA(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0,it=0,Xe=0,Vt=0,Bt=0,dt=0,_t=0,Cn=0,xn=0,gn=0,yn=0,bn=0,Ln=0,sr=0,Pn=0;if(C=m+8|0,o[C>>2]|0)return Pn=1,Pn|0;if(E=o[m>>2]|0,!E)return Pn=0,Pn|0;g=E,v=0;do v=v+1|0,g=o[g+8>>2]|0;while(g|0);if(v>>>0<2)return Pn=0,Pn|0;Ln=_(v<<2)|0,Ln||An(22948,22787,317,22967),bn=_(v<<5)|0,bn||An(22989,22787,321,22967),o[m>>2]=0,Bt=m+4|0,o[Bt>>2]=0,o[C>>2]=0,v=0,yn=0,Vt=0,de=0;e:for(;;){if(le=o[E>>2]|0,le){R=0,O=le;do{if(Q=+G[O+8>>3],g=O,O=o[O+16>>2]|0,J=(O|0)==0,C=J?le:O,N=+G[C+8>>3],+ke(+(Q-N))>3.141592653589793){Pn=14;break}R=R+(N-Q)*(+G[g>>3]+ +G[C>>3])}while(!J);if((Pn|0)==14){Pn=0,R=0,g=le;do Xe=+G[g+8>>3],gn=g+16|0,xn=o[gn>>2]|0,xn=xn|0?xn:le,it=+G[xn+8>>3],R=R+(+G[g>>3]+ +G[xn>>3])*((it<0?it+6.283185307179586:it)-(Xe<0?Xe+6.283185307179586:Xe)),g=o[(g|0?gn:E)>>2]|0;while(g|0)}R>0?(o[Ln+(yn<<2)>>2]=E,yn=yn+1|0,C=Vt,g=de):Pn=19}else Pn=19;if((Pn|0)==19){Pn=0;do if(v){if(g=v+8|0,o[g>>2]|0){Pn=21;break e}if(v=h(1,12)|0,!v){Pn=23;break e}o[g>>2]=v,C=v+4|0,O=v,g=de}else if(de){C=Bt,O=de+8|0,g=E,v=m;break}else if(o[m>>2]|0){Pn=27;break e}else{C=Bt,O=m,g=E,v=m;break}while(0);if(o[O>>2]=E,o[C>>2]=E,O=bn+(Vt<<5)|0,J=o[E>>2]|0,J){for(le=bn+(Vt<<5)+8|0,G[le>>3]=17976931348623157e292,de=bn+(Vt<<5)+24|0,G[de>>3]=17976931348623157e292,G[O>>3]=-17976931348623157e292,Re=bn+(Vt<<5)+16|0,G[Re>>3]=-17976931348623157e292,ut=17976931348623157e292,rt=-17976931348623157e292,C=0,je=J,Q=17976931348623157e292,Ye=17976931348623157e292,ht=-17976931348623157e292,N=-17976931348623157e292;R=+G[je>>3],Xe=+G[je+8>>3],je=o[je+16>>2]|0,Be=(je|0)==0,it=+G[(Be?J:je)+8>>3],R<Q&&(G[le>>3]=R,Q=R),Xe<Ye&&(G[de>>3]=Xe,Ye=Xe),R>ht?G[O>>3]=R:R=ht,Xe>N&&(G[Re>>3]=Xe,N=Xe),ut=Xe>0&Xe<ut?Xe:ut,rt=Xe<0&Xe>rt?Xe:rt,C=C|+ke(+(Xe-it))>3.141592653589793,!Be;)ht=R;C&&(G[Re>>3]=rt,G[de>>3]=ut)}else o[O>>2]=0,o[O+4>>2]=0,o[O+8>>2]=0,o[O+12>>2]=0,o[O+16>>2]=0,o[O+20>>2]=0,o[O+24>>2]=0,o[O+28>>2]=0;C=Vt+1|0}if(gn=E+8|0,E=o[gn>>2]|0,o[gn>>2]=0,E)Vt=C,de=g;else{Pn=45;break}}if((Pn|0)==21)An(22765,22787,35,22799);else if((Pn|0)==23)An(22819,22787,37,22799);else if((Pn|0)==27)An(22862,22787,61,22885);else if((Pn|0)==45){e:do if((yn|0)>0){for(gn=(C|0)==0,Cn=C<<2,xn=(m|0)==0,_t=0,g=0;;){if(dt=o[Ln+(_t<<2)>>2]|0,gn)Pn=73;else{if(Vt=_(Cn)|0,!Vt){Pn=50;break}if(Bt=_(Cn)|0,!Bt){Pn=52;break}t:do if(xn)v=0;else{for(C=0,v=0,O=m;E=bn+(C<<5)|0,Ga(o[O>>2]|0,E,o[dt>>2]|0)|0?(o[Vt+(v<<2)>>2]=O,o[Bt+(v<<2)>>2]=E,Be=v+1|0):Be=v,O=o[O+8>>2]|0,O;)C=C+1|0,v=Be;if((Be|0)>0)if(E=o[Vt>>2]|0,(Be|0)==1)v=E;else for(Re=0,je=-1,v=E,de=E;;){for(J=o[de>>2]|0,E=0,O=0;C=o[o[Vt+(O<<2)>>2]>>2]|0,(C|0)==(J|0)?le=E:le=E+((Ga(C,o[Bt+(O<<2)>>2]|0,o[J>>2]|0)|0)&1)|0,O=O+1|0,(O|0)!=(Be|0);)E=le;if(C=(le|0)>(je|0),v=C?de:v,E=Re+1|0,(E|0)==(Be|0))break t;Re=E,je=C?le:je,de=o[Vt+(E<<2)>>2]|0}else v=0}while(0);if(l(Vt),l(Bt),v){if(C=v+4|0,E=o[C>>2]|0,E)v=E+8|0;else if(o[v>>2]|0){Pn=70;break}o[v>>2]=dt,o[C>>2]=dt}else Pn=73}if((Pn|0)==73){if(Pn=0,g=o[dt>>2]|0,g|0)do Bt=g,g=o[g+16>>2]|0,l(Bt);while(g|0);l(dt),g=1}if(_t=_t+1|0,(_t|0)>=(yn|0)){sr=g;break e}}(Pn|0)==50?An(23004,22787,249,23023):(Pn|0)==52?An(23042,22787,252,23023):(Pn|0)==70&&An(22862,22787,61,22885)}else sr=0;while(0);return l(Ln),l(bn),Pn=sr,Pn|0}return 0}function Ga(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(!(UA(g,v)|0)||(g=Yn(g)|0,E=+G[v>>3],C=+G[v+8>>3],C=g&C<0?C+6.283185307179586:C,m=o[m>>2]|0,!m))return m=0,m|0;if(g){g=0,J=C,v=m;e:for(;;){for(;O=+G[v>>3],C=+G[v+8>>3],v=v+16|0,le=o[v>>2]|0,le=le|0?le:m,R=+G[le>>3],N=+G[le+8>>3],O>R?(Q=O,O=N):(Q=R,R=O,O=C,C=N),E=E==R|E==Q?E+2220446049250313e-31:E,!!(E<R|E>Q);)if(v=o[v>>2]|0,!v){v=22;break e}if(N=O<0?O+6.283185307179586:O,O=C<0?C+6.283185307179586:C,J=N==J|O==J?J+-2220446049250313e-31:J,Q=N+(O-N)*((E-R)/(Q-R)),(Q<0?Q+6.283185307179586:Q)>J&&(g=g^1),v=o[v>>2]|0,!v){v=22;break}}if((v|0)==22)return g|0}else{g=0,J=C,v=m;e:for(;;){for(;O=+G[v>>3],C=+G[v+8>>3],v=v+16|0,le=o[v>>2]|0,le=le|0?le:m,R=+G[le>>3],N=+G[le+8>>3],O>R?(Q=O,O=N):(Q=R,R=O,O=C,C=N),E=E==R|E==Q?E+2220446049250313e-31:E,!!(E<R|E>Q);)if(v=o[v>>2]|0,!v){v=22;break e}if(J=O==J|C==J?J+-2220446049250313e-31:J,O+(C-O)*((E-R)/(Q-R))>J&&(g=g^1),v=o[v>>2]|0,!v){v=22;break}}if((v|0)==22)return g|0}return 0}function Rs(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0;if(rt=we,we=we+32|0,ut=rt+16|0,ht=rt,R=te(m|0,g|0,52)|0,Se()|0,R=R&15,je=te(v|0,E|0,52)|0,Se()|0,(R|0)!=(je&15|0))return ut=12,we=rt,ut|0;if(J=te(m|0,g|0,45)|0,Se()|0,J=J&127,le=te(v|0,E|0,45)|0,Se()|0,le=le&127,J>>>0>121|le>>>0>121)return ut=5,we=rt,ut|0;if(je=(J|0)!=(le|0),je){if(N=cl(J,le)|0,(N|0)==7)return ut=1,we=rt,ut|0;Q=cl(le,J)|0,(Q|0)==7?An(23066,23090,161,23100):(Be=N,O=Q)}else Be=0,O=0;de=Vn(J)|0,Re=Vn(le)|0,o[ut>>2]=0,o[ut+4>>2]=0,o[ut+8>>2]=0,o[ut+12>>2]=0;do if(Be){if(le=o[4272+(J*28|0)+(Be<<2)>>2]|0,N=(le|0)>0,Re)if(N){J=0,Q=v,N=E;do Q=Ju(Q,N)|0,N=Se()|0,O=Bo(O)|0,(O|0)==1&&(O=Bo(1)|0),J=J+1|0;while((J|0)!=(le|0));le=O,J=Q,Q=N}else le=O,J=v,Q=E;else if(N){J=0,Q=v,N=E;do Q=cA(Q,N)|0,N=Se()|0,O=Bo(O)|0,J=J+1|0;while((J|0)!=(le|0));le=O,J=Q,Q=N}else le=O,J=v,Q=E;if(aa(J,Q,ut)|0,je||An(23115,23090,191,23100),N=(de|0)!=0,O=(Re|0)!=0,N&O&&An(23142,23090,192,23100),N){if(O=Kr(m,g)|0,(O|0)==7){R=5;break}if(he[21872+(O*7|0)+Be>>0]|0){R=1;break}Q=o[21040+(O*28|0)+(Be<<2)>>2]|0,J=Q}else if(O){if(O=Kr(J,Q)|0,(O|0)==7){R=5;break}if(he[21872+(O*7|0)+le>>0]|0){R=1;break}J=0,Q=o[21040+(le*28|0)+(O<<2)>>2]|0}else J=0,Q=0;if((J|Q|0)<0)R=5;else{if((Q|0)>0){N=ut+4|0,O=0;do dl(N),O=O+1|0;while((O|0)!=(Q|0))}if(o[ht>>2]=0,o[ht+4>>2]=0,o[ht+8>>2]=0,Fi(ht,Be),R|0)for(;gi(R)|0?Ro(ht):Oi(ht),(R|0)>1;)R=R+-1|0;if((J|0)>0){R=0;do dl(ht),R=R+1|0;while((R|0)!=(J|0))}Ye=ut+4|0,Xr(Ye,ht,Ye),Bn(Ye),Ye=51}}else if(aa(v,E,ut)|0,(de|0)!=0&(Re|0)!=0)if((le|0)!=(J|0)&&An(23173,23090,261,23100),O=Kr(m,g)|0,R=Kr(v,E)|0,(O|0)==7|(R|0)==7)R=5;else if(he[21872+(O*7|0)+R>>0]|0)R=1;else if(O=o[21040+(O*28|0)+(R<<2)>>2]|0,(O|0)>0){N=ut+4|0,R=0;do dl(N),R=R+1|0;while((R|0)!=(O|0));Ye=51}else Ye=51;else Ye=51;while(0);return(Ye|0)==51&&(R=ut+4|0,o[C>>2]=o[R>>2],o[C+4>>2]=o[R+4>>2],o[C+8>>2]=o[R+8>>2],R=0),ut=R,we=rt,ut|0}function KA(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0,it=0;if(Ye=we,we=we+48|0,J=Ye+36|0,O=Ye+24|0,N=Ye+12|0,Q=Ye,C=te(m|0,g|0,52)|0,Se()|0,C=C&15,Re=te(m|0,g|0,45)|0,Se()|0,Re=Re&127,Re>>>0>121)return E=5,we=Ye,E|0;if(le=Vn(Re)|0,ue(C|0,0,52)|0,ht=Se()|0|134225919,R=E,o[R>>2]=-1,o[R+4>>2]=ht,!C)return C=Do(v)|0,(C|0)==7||(C=ul(Re,C)|0,(C|0)==127)?(ht=1,we=Ye,ht|0):(je=ue(C|0,0,45)|0,Be=Se()|0,Re=E,Be=o[Re+4>>2]&-1040385|Be,ht=E,o[ht>>2]=o[Re>>2]|je,o[ht+4>>2]=Be,ht=0,we=Ye,ht|0);for(o[J>>2]=o[v>>2],o[J+4>>2]=o[v+4>>2],o[J+8>>2]=o[v+8>>2],v=C;;){if(R=v,v=v+-1|0,o[O>>2]=o[J>>2],o[O+4>>2]=o[J+4>>2],o[O+8>>2]=o[J+8>>2],gi(R)|0){if(C=ra(J)|0,C|0){v=13;break}o[N>>2]=o[J>>2],o[N+4>>2]=o[J+4>>2],o[N+8>>2]=o[J+8>>2],Ro(N)}else{if(C=lo(J)|0,C|0){v=13;break}o[N>>2]=o[J>>2],o[N+4>>2]=o[J+4>>2],o[N+8>>2]=o[J+8>>2],Oi(N)}if(ao(O,N,Q),Bn(Q),C=E,rt=o[C>>2]|0,C=o[C+4>>2]|0,it=(15-R|0)*3|0,ut=ue(7,0,it|0)|0,C=C&~(Se()|0),it=ue(Do(Q)|0,0,it|0)|0,C=Se()|0|C,ht=E,o[ht>>2]=it|rt&~ut,o[ht+4>>2]=C,(R|0)<=1){v=14;break}}e:do if((v|0)!=13&&(v|0)==14)if((o[J>>2]|0)<=1&&(o[J+4>>2]|0)<=1&&(o[J+8>>2]|0)<=1){v=Do(J)|0,C=ul(Re,v)|0,(C|0)==127?Q=0:Q=Vn(C)|0;t:do if(v){if(le){if(C=Kr(m,g)|0,(C|0)==7){C=5;break e}if(R=o[21248+(C*28|0)+(v<<2)>>2]|0,(R|0)>0){C=v,v=0;do C=Ao(C)|0,v=v+1|0;while((v|0)!=(R|0))}else C=v;if((C|0)==1){C=9;break e}v=ul(Re,C)|0,(v|0)==127&&An(23200,23090,411,23230),Vn(v)|0?An(23245,23090,412,23230):(Be=v,je=R,de=C)}else Be=C,je=0,de=v;if(N=o[4272+(Re*28|0)+(de<<2)>>2]|0,(N|0)<=-1&&An(23276,23090,419,23230),!Q){if((je|0)<0){C=5;break e}if(je|0){R=E,C=0,v=o[R>>2]|0,R=o[R+4>>2]|0;do v=Ls(v,R)|0,R=Se()|0,it=E,o[it>>2]=v,o[it+4>>2]=R,C=C+1|0;while((C|0)<(je|0))}if((N|0)<=0){C=Be,v=58;break}for(R=E,C=0,v=o[R>>2]|0,R=o[R+4>>2]|0;;)if(v=Ls(v,R)|0,R=Se()|0,it=E,o[it>>2]=v,o[it+4>>2]=R,C=C+1|0,(C|0)==(N|0)){C=Be,v=58;break t}}if(O=cl(Be,Re)|0,(O|0)==7&&An(23066,23090,428,23230),C=E,v=o[C>>2]|0,C=o[C+4>>2]|0,(N|0)>0){R=0;do v=Ls(v,C)|0,C=Se()|0,it=E,o[it>>2]=v,o[it+4>>2]=C,R=R+1|0;while((R|0)!=(N|0))}if(C=Kr(v,C)|0,(C|0)==7&&An(23313,23090,440,23230),v=nA(Be)|0,v=o[(v?21664:21456)+(O*28|0)+(C<<2)>>2]|0,(v|0)<0&&An(23313,23090,454,23230),!v)C=Be,v=58;else{O=E,C=0,R=o[O>>2]|0,O=o[O+4>>2]|0;do R=ZA(R,O)|0,O=Se()|0,it=E,o[it>>2]=R,o[it+4>>2]=O,C=C+1|0;while((C|0)<(v|0));C=Be,v=58}}else if((le|0)!=0&(Q|0)!=0){if(v=Kr(m,g)|0,R=E,R=Kr(o[R>>2]|0,o[R+4>>2]|0)|0,(v|0)==7|(R|0)==7){C=5;break e}if(R=o[21248+(v*28|0)+(R<<2)>>2]|0,(R|0)<0){C=5;break e}if(!R)v=59;else{N=E,v=0,O=o[N>>2]|0,N=o[N+4>>2]|0;do O=Ls(O,N)|0,N=Se()|0,it=E,o[it>>2]=O,o[it+4>>2]=N,v=v+1|0;while((v|0)<(R|0));v=58}}else v=58;while(0);if((v|0)==58&&Q&&(v=59),(v|0)==59&&(it=E,(Kr(o[it>>2]|0,o[it+4>>2]|0)|0)==1)){C=9;break}it=E,ut=o[it>>2]|0,it=o[it+4>>2]&-1040385,rt=ue(C|0,0,45)|0,it=it|(Se()|0),C=E,o[C>>2]=ut|rt,o[C+4>>2]=it,C=0}else C=1;while(0);return it=C,we=Ye,it|0}function th(m,g,v,E,C,R){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0,R=R|0;var O=0,N=0;return N=we,we=we+16|0,O=N,C?m=15:(m=Rs(m,g,v,E,O)|0,m||(AA(O,R),m=0)),we=N,m|0}function nc(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0;return O=we,we=we+16|0,R=O,E?v=15:(v=jA(v,R)|0,v||(v=KA(m,g,R,C)|0)),we=O,v|0}function JA(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0;return Q=we,we=we+32|0,O=Q+12|0,N=Q,R=Rs(m,g,m,g,O)|0,R|0?(N=R,we=Q,N|0):(m=Rs(m,g,v,E,N)|0,m|0?(N=m,we=Q,N|0):(O=pl(O,N)|0,N=C,o[N>>2]=O,o[N+4>>2]=((O|0)<0)<<31>>31,N=0,we=Q,N|0))}function eu(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0;return Q=we,we=we+32|0,O=Q+12|0,N=Q,R=Rs(m,g,m,g,O)|0,!R&&(R=Rs(m,g,v,E,N)|0,!R)?(E=pl(O,N)|0,E=d(E|0,((E|0)<0)<<31>>31|0,1,0)|0,O=Se()|0,N=C,o[N>>2]=E,o[N+4>>2]=O,N=0,we=Q,N|0):(N=R,we=Q,N|0)}function tu(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0,it=0,Xe=0,Vt=0,Bt=0,dt=0,_t=0;if(dt=we,we=we+48|0,O=dt+24|0,N=dt+12|0,Bt=dt,R=Rs(m,g,m,g,O)|0,!R&&(R=Rs(m,g,v,E,N)|0,!R)){Xe=pl(O,N)|0,Vt=((Xe|0)<0)<<31>>31,o[O>>2]=0,o[O+4>>2]=0,o[O+8>>2]=0,o[N>>2]=0,o[N+4>>2]=0,o[N+8>>2]=0,Rs(m,g,m,g,O)|0&&An(23313,23090,691,23299),Rs(m,g,v,E,N)|0&&An(23313,23090,696,23299),zo(O),zo(N),Xe?(de=o[O>>2]|0,Be=+(Xe|0),ut=O+4|0,Re=o[ut>>2]|0,rt=O+8|0,je=o[rt>>2]|0,it=O,E=de,R=Re,v=je,Ye=+((o[N>>2]|0)-de|0)/Be,ht=+((o[N+4>>2]|0)-Re|0)/Be,Be=+((o[N+8>>2]|0)-je|0)/Be):(R=O+4|0,v=O+8|0,ut=R,rt=v,it=O,E=o[O>>2]|0,R=o[R>>2]|0,v=o[v>>2]|0,Ye=0,ht=0,Be=0),o[Bt>>2]=E,je=Bt+4|0,o[je>>2]=R,Re=Bt+8|0,o[Re>>2]=v;e:do if((Xe|0)<0)R=0;else for(le=0,de=0,R=E;;){J=+(de>>>0)+4294967296*+(le|0),_t=Ye*J+ +(R|0),Q=ht*J+ +(o[ut>>2]|0),J=Be*J+ +(o[rt>>2]|0),v=~~+ve(+_t),O=~~+ve(+Q),R=~~+ve(+J),_t=+ke(+(+(v|0)-_t)),Q=+ke(+(+(O|0)-Q)),J=+ke(+(+(R|0)-J));do if(_t>Q&_t>J)v=0-(O+R)|0,E=O;else if(N=0-v|0,Q>J){E=N-R|0;break}else{E=O,R=N-O|0;break}while(0);if(o[Bt>>2]=v,o[je>>2]=E,o[Re>>2]=R,Ra(Bt),R=KA(m,g,Bt,C+(de<<3)|0)|0,R|0)break e;if(!((le|0)<(Vt|0)|(le|0)==(Vt|0)&de>>>0<Xe>>>0)){R=0;break e}R=d(de|0,le|0,1,0)|0,N=Se()|0,le=N,de=R,R=o[it>>2]|0}while(0);return Bt=R,we=dt,Bt|0}return Bt=R,we=dt,Bt|0}function Bs(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0;if((v|0)==0&(E|0)==0)return C=0,R=1,Mt(C|0),R|0;R=m,C=g,m=1,g=0;do O=(v&1|0)==0&!0,m=V((O?1:R)|0,(O?0:C)|0,m|0,g|0)|0,g=Se()|0,v=oe(v|0,E|0,1)|0,E=Se()|0,R=V(R|0,C|0,R|0,C|0)|0,C=Se()|0;while(!((v|0)==0&(E|0)==0));return Mt(g|0),m|0}function Mi(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0;if(!(UA(g,v)|0)||(g=Yn(g)|0,E=+G[v>>3],C=+G[v+8>>3],C=g&C<0?C+6.283185307179586:C,Re=o[m>>2]|0,(Re|0)<=0))return Re=0,Re|0;if(de=o[m+4>>2]|0,g){g=0,le=C,v=-1,m=0;e:for(;;){for(J=m;O=+G[de+(J<<4)>>3],C=+G[de+(J<<4)+8>>3],m=(v+2|0)%(Re|0)|0,R=+G[de+(m<<4)>>3],N=+G[de+(m<<4)+8>>3],O>R?(Q=O,O=N):(Q=R,R=O,O=C,C=N),E=E==R|E==Q?E+2220446049250313e-31:E,!!(E<R|E>Q);)if(v=J+1|0,(v|0)>=(Re|0)){v=22;break e}else m=J,J=v,v=m;if(N=O<0?O+6.283185307179586:O,O=C<0?C+6.283185307179586:C,le=N==le|O==le?le+-2220446049250313e-31:le,Q=N+(O-N)*((E-R)/(Q-R)),(Q<0?Q+6.283185307179586:Q)>le&&(g=g^1),m=J+1|0,(m|0)>=(Re|0)){v=22;break}else v=J}if((v|0)==22)return g|0}else{g=0,le=C,v=-1,m=0;e:for(;;){for(J=m;O=+G[de+(J<<4)>>3],C=+G[de+(J<<4)+8>>3],m=(v+2|0)%(Re|0)|0,R=+G[de+(m<<4)>>3],N=+G[de+(m<<4)+8>>3],O>R?(Q=O,O=N):(Q=R,R=O,O=C,C=N),E=E==R|E==Q?E+2220446049250313e-31:E,!!(E<R|E>Q);)if(v=J+1|0,(v|0)>=(Re|0)){v=22;break e}else m=J,J=v,v=m;if(le=O==le|C==le?le+-2220446049250313e-31:le,O+(C-O)*((E-R)/(Q-R))>le&&(g=g^1),m=J+1|0,(m|0)>=(Re|0)){v=22;break}else v=J}if((v|0)==22)return g|0}return 0}function fo(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0;if(Be=o[m>>2]|0,!Be){o[g>>2]=0,o[g+4>>2]=0,o[g+8>>2]=0,o[g+12>>2]=0,o[g+16>>2]=0,o[g+20>>2]=0,o[g+24>>2]=0,o[g+28>>2]=0;return}if(Ye=g+8|0,G[Ye>>3]=17976931348623157e292,ht=g+24|0,G[ht>>3]=17976931348623157e292,G[g>>3]=-17976931348623157e292,ut=g+16|0,G[ut>>3]=-17976931348623157e292,!((Be|0)<=0)){for(Re=o[m+4>>2]|0,J=17976931348623157e292,le=-17976931348623157e292,de=0,m=-1,R=17976931348623157e292,O=17976931348623157e292,Q=-17976931348623157e292,E=-17976931348623157e292,je=0;v=+G[Re+(je<<4)>>3],N=+G[Re+(je<<4)+8>>3],m=m+2|0,C=+G[Re+(((m|0)==(Be|0)?0:m)<<4)+8>>3],v<R&&(G[Ye>>3]=v,R=v),N<O&&(G[ht>>3]=N,O=N),v>Q?G[g>>3]=v:v=Q,N>E&&(G[ut>>3]=N,E=N),J=N>0&N<J?N:J,le=N<0&N>le?N:le,de=de|+ke(+(N-C))>3.141592653589793,m=je+1|0,(m|0)!=(Be|0);)rt=je,Q=v,je=m,m=rt;de&&(G[ut>>3]=le,G[ht>>3]=J)}}function nu(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0,it=0,Xe=0,Vt=0,Bt=0,dt=0;if(Be=o[m>>2]|0,Be){if(Ye=g+8|0,G[Ye>>3]=17976931348623157e292,ht=g+24|0,G[ht>>3]=17976931348623157e292,G[g>>3]=-17976931348623157e292,ut=g+16|0,G[ut>>3]=-17976931348623157e292,(Be|0)>0){for(C=o[m+4>>2]|0,Re=17976931348623157e292,je=-17976931348623157e292,E=0,v=-1,Q=17976931348623157e292,J=17976931348623157e292,de=-17976931348623157e292,O=-17976931348623157e292,rt=0;R=+G[C+(rt<<4)>>3],le=+G[C+(rt<<4)+8>>3],Bt=v+2|0,N=+G[C+(((Bt|0)==(Be|0)?0:Bt)<<4)+8>>3],R<Q&&(G[Ye>>3]=R,Q=R),le<J&&(G[ht>>3]=le,J=le),R>de?G[g>>3]=R:R=de,le>O&&(G[ut>>3]=le,O=le),Re=le>0&le<Re?le:Re,je=le<0&le>je?le:je,E=E|+ke(+(le-N))>3.141592653589793,v=rt+1|0,(v|0)!=(Be|0);)Bt=rt,de=R,rt=v,v=Bt;E&&(G[ut>>3]=je,G[ht>>3]=Re)}}else o[g>>2]=0,o[g+4>>2]=0,o[g+8>>2]=0,o[g+12>>2]=0,o[g+16>>2]=0,o[g+20>>2]=0,o[g+24>>2]=0,o[g+28>>2]=0;if(Bt=m+8|0,v=o[Bt>>2]|0,!((v|0)<=0)){Vt=m+12|0,Xe=0;do if(C=o[Vt>>2]|0,E=Xe,Xe=Xe+1|0,ht=g+(Xe<<5)|0,ut=o[C+(E<<3)>>2]|0,ut){if(rt=g+(Xe<<5)+8|0,G[rt>>3]=17976931348623157e292,m=g+(Xe<<5)+24|0,G[m>>3]=17976931348623157e292,G[ht>>3]=-17976931348623157e292,it=g+(Xe<<5)+16|0,G[it>>3]=-17976931348623157e292,(ut|0)>0){for(Be=o[C+(E<<3)+4>>2]|0,Re=17976931348623157e292,je=-17976931348623157e292,C=0,E=-1,Ye=0,Q=17976931348623157e292,J=17976931348623157e292,le=-17976931348623157e292,O=-17976931348623157e292;R=+G[Be+(Ye<<4)>>3],de=+G[Be+(Ye<<4)+8>>3],E=E+2|0,N=+G[Be+(((E|0)==(ut|0)?0:E)<<4)+8>>3],R<Q&&(G[rt>>3]=R,Q=R),de<J&&(G[m>>3]=de,J=de),R>le?G[ht>>3]=R:R=le,de>O&&(G[it>>3]=de,O=de),Re=de>0&de<Re?de:Re,je=de<0&de>je?de:je,C=C|+ke(+(de-N))>3.141592653589793,E=Ye+1|0,(E|0)!=(ut|0);)dt=Ye,Ye=E,le=R,E=dt;C&&(G[it>>3]=je,G[m>>3]=Re)}}else o[ht>>2]=0,o[ht+4>>2]=0,o[ht+8>>2]=0,o[ht+12>>2]=0,o[ht+16>>2]=0,o[ht+20>>2]=0,o[ht+24>>2]=0,o[ht+28>>2]=0,v=o[Bt>>2]|0;while((Xe|0)<(v|0))}}function ca(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;if(!(Mi(m,g,v)|0))return C=0,C|0;if(C=m+8|0,(o[C>>2]|0)<=0)return C=1,C|0;for(E=m+12|0,m=0;;){if(R=m,m=m+1|0,Mi((o[E>>2]|0)+(R<<3)|0,g+(m<<5)|0,v)|0){m=0,E=6;break}if((m|0)>=(o[C>>2]|0)){m=1,E=6;break}}return(E|0)==6?m|0:0}function Dr(){return 8}function Tl(){return 16}function rc(){return 168}function ss(){return 8}function wr(){return 16}function ja(){return 12}function Sl(){return 8}function ru(m){return m=m|0,+(+((o[m>>2]|0)>>>0)+4294967296*+(o[m+4>>2]|0))}function ic(m){m=m|0;var g=0,v=0;return v=+G[m>>3],g=+G[m+8>>3],+ +We(+(v*v+g*g))}function iu(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0;J=+G[m>>3],Q=+G[g>>3]-J,N=+G[m+8>>3],O=+G[g+8>>3]-N,de=+G[v>>3],R=+G[E>>3]-de,Re=+G[v+8>>3],le=+G[E+8>>3]-Re,R=(R*(N-Re)-(J-de)*le)/(Q*le-O*R),G[C>>3]=J+Q*R,G[C+8>>3]=N+O*R}function sc(m,g){return m=m|0,g=g|0,+ke(+(+G[m>>3]-+G[g>>3]))<11920928955078125e-23?(g=+ke(+(+G[m+8>>3]-+G[g+8>>3]))<11920928955078125e-23,g|0):(g=0,g|0)}function dr(m,g){m=m|0,g=g|0;var v=0,E=0,C=0;return C=+G[m>>3]-+G[g>>3],E=+G[m+8>>3]-+G[g+8>>3],v=+G[m+16>>3]-+G[g+16>>3],+(C*C+E*E+v*v)}function Ml(m,g){m=m|0,g=g|0;var v=0,E=0,C=0;v=+G[m>>3],E=+$e(+v),v=+ft(+v),G[g+16>>3]=v,v=+G[m+8>>3],C=E*+$e(+v),G[g>>3]=C,v=E*+ft(+v),G[g+8>>3]=v}function Zt(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;if(R=we,we=we+16|0,C=R,E=fr(m,g)|0,(v+-1|0)>>>0>5||(E=(E|0)!=0,(v|0)==1&E))return C=-1,we=R,C|0;do if(Yt(m,g,C)|0)E=-1;else if(E){E=((o[21936+(v<<2)>>2]|0)+5-(o[C>>2]|0)|0)%5|0;break}else{E=((o[21968+(v<<2)>>2]|0)+6-(o[C>>2]|0)|0)%6|0;break}while(0);return C=E,we=R,C|0}function Yt(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0,J=0;if(J=we,we=we+32|0,O=J+16|0,N=J,E=Gi(m,g,O)|0,E|0)return v=E,we=J,v|0;R=za(m,g)|0,Q=Kr(m,g)|0,FA(R,N),E=NA(R,o[O>>2]|0)|0;e:do if(Vn(R)|0){do switch(R|0){case 4:{m=0;break}case 14:{m=1;break}case 24:{m=2;break}case 38:{m=3;break}case 49:{m=4;break}case 58:{m=5;break}case 63:{m=6;break}case 72:{m=7;break}case 83:{m=8;break}case 97:{m=9;break}case 107:{m=10;break}case 117:{m=11;break}default:{E=1;break e}}while(0);if(C=o[22e3+(m*24|0)+8>>2]|0,g=o[22e3+(m*24|0)+16>>2]|0,m=o[O>>2]|0,(m|0)!=(o[N>>2]|0)&&(N=nA(R)|0,m=o[O>>2]|0,N|(m|0)==(g|0)&&(E=(E+1|0)%6|0)),(Q|0)==3&(m|0)==(g|0)){E=(E+5|0)%6|0,C=22;break}(Q|0)==5&(m|0)==(C|0)&&(E=(E+1|0)%6|0),C=22}else C=22;while(0);return(C|0)==22&&(o[v>>2]=E,E=0),v=E,we=J,v|0}function cn(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0,it=0;if(it=we,we=we+32|0,rt=it+24|0,ht=it+20|0,Be=it+8|0,je=it+16|0,Re=it,Q=(fr(m,g)|0)==0,Q=Q?6:5,le=te(m|0,g|0,52)|0,Se()|0,le=le&15,Q>>>0<=v>>>0)return E=2,we=it,E|0;de=(le|0)==0,!de&&(Ye=ue(7,0,(le^15)*3|0)|0,(Ye&m|0)==0&((Se()|0)&g|0)==0)?C=v:R=4;e:do if((R|0)==4){if(C=(fr(m,g)|0)!=0,((C?4:5)|0)<(v|0)||Yt(m,g,rt)|0||(R=(o[rt>>2]|0)+v|0,C?C=22288+(((R|0)%5|0)<<2)|0:C=22320+(((R|0)%6|0)<<2)|0,Ye=o[C>>2]|0,(Ye|0)==7))return E=1,we=it,E|0;o[ht>>2]=0,C=Fe(m,g,Ye,ht,Be)|0;do if(!C){if(N=Be,J=o[N>>2]|0,N=o[N+4>>2]|0,O=N>>>0<g>>>0|(N|0)==(g|0)&J>>>0<m>>>0,R=O?J:m,O=O?N:g,!de&&(de=ue(7,0,(le^15)*3|0)|0,(J&de|0)==0&(N&(Se()|0)|0)==0))C=v;else{if(N=(v+-1+Q|0)%(Q|0)|0,C=fr(m,g)|0,(N|0)<0&&An(23313,23315,245,23324),Q=(C|0)!=0,((Q?4:5)|0)<(N|0)&&An(23313,23315,245,23324),Yt(m,g,rt)|0&&An(23313,23315,245,23324),C=(o[rt>>2]|0)+N|0,Q?C=22288+(((C|0)%5|0)<<2)|0:C=22320+(((C|0)%6|0)<<2)|0,N=o[C>>2]|0,(N|0)==7&&An(23313,23315,245,23324),o[je>>2]=0,C=Fe(m,g,N,je,Re)|0,C|0)break;J=Re,Q=o[J>>2]|0,J=o[J+4>>2]|0;do if(J>>>0<O>>>0|(J|0)==(O|0)&Q>>>0<R>>>0){if(fr(Q,J)|0?R=ot(Q,J,m,g)|0:R=o[22384+((((o[je>>2]|0)+(o[22352+(N<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,C=fr(Q,J)|0,(R+-1|0)>>>0>5){C=-1,R=Q,O=J;break}if(C=(C|0)!=0,(R|0)==1&C){C=-1,R=Q,O=J;break}do if(Yt(Q,J,rt)|0)C=-1;else if(C){C=((o[21936+(R<<2)>>2]|0)+5-(o[rt>>2]|0)|0)%5|0;break}else{C=((o[21968+(R<<2)>>2]|0)+6-(o[rt>>2]|0)|0)%6|0;break}while(0);R=Q,O=J}else C=v;while(0);N=Be,J=o[N>>2]|0,N=o[N+4>>2]|0}if((R|0)==(J|0)&(O|0)==(N|0)){if(Q=(fr(J,N)|0)!=0,Q?m=ot(J,N,m,g)|0:m=o[22384+((((o[ht>>2]|0)+(o[22352+(Ye<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,C=fr(J,N)|0,(m+-1|0)>>>0<=5&&(ut=(C|0)!=0,!((m|0)==1&ut)))do if(Yt(J,N,rt)|0)C=-1;else if(ut){C=((o[21936+(m<<2)>>2]|0)+5-(o[rt>>2]|0)|0)%5|0;break}else{C=((o[21968+(m<<2)>>2]|0)+6-(o[rt>>2]|0)|0)%6|0;break}while(0);else C=-1;C=C+1|0,C=(C|0)==6|Q&(C|0)==5?0:C}g=O,m=R;break e}while(0);return E=C,we=it,E|0}while(0);return ut=ue(C|0,0,56)|0,rt=Se()|0|g&-2130706433|536870912,o[E>>2]=ut|m,o[E+4>>2]=rt,E=0,we=it,E|0}function $i(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;return R=(fr(m,g)|0)==0,E=cn(m,g,0,v)|0,C=(E|0)==0,R?!C||(E=cn(m,g,1,v+8|0)|0,E|0)||(E=cn(m,g,2,v+16|0)|0,E|0)||(E=cn(m,g,3,v+24|0)|0,E|0)||(E=cn(m,g,4,v+32|0)|0,E)?(R=E,R|0):cn(m,g,5,v+40|0)|0:!C||(E=cn(m,g,1,v+8|0)|0,E|0)||(E=cn(m,g,2,v+16|0)|0,E|0)||(E=cn(m,g,3,v+24|0)|0,E|0)||(E=cn(m,g,4,v+32|0)|0,E|0)?(R=E,R|0):(R=v+40|0,o[R>>2]=0,o[R+4>>2]=0,R=0,R|0)}function Uo(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,Q=0;return Q=we,we=we+192|0,C=Q,R=Q+168|0,O=te(m|0,g|0,56)|0,Se()|0,O=O&7,N=g&-2130706433|134217728,E=Gi(m,N,R)|0,E|0?(N=E,we=Q,N|0):(g=te(m|0,g|0,52)|0,Se()|0,g=g&15,fr(m,N)|0?Oo(R,g,O,1,C):QA(R,g,O,1,C),N=C+8|0,o[v>>2]=o[N>>2],o[v+4>>2]=o[N+4>>2],o[v+8>>2]=o[N+8>>2],o[v+12>>2]=o[N+12>>2],N=0,we=Q,N|0)}function Or(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0;return C=we,we=we+16|0,v=C,!(!0&(g&2013265920|0)==536870912)||(E=g&-2130706433|134217728,!(oa(m,E)|0))?(E=0,we=C,E|0):(R=te(m|0,g|0,56)|0,Se()|0,R=(cn(m,E,R&7,v)|0)==0,E=v,E=R&((o[E>>2]|0)==(m|0)?(o[E+4>>2]|0)==(g|0):0)&1,we=C,E|0)}function zs(m,g,v){m=m|0,g=g|0,v=v|0;var E=0;(g|0)>0?(E=h(g,4)|0,o[m>>2]=E,E||An(23337,23360,40,23374)):o[m>>2]=0,o[m+4>>2]=g,o[m+8>>2]=0,o[m+12>>2]=v}function ms(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;C=m+4|0,R=m+12|0,O=m+8|0;e:for(;;){for(v=o[C>>2]|0,g=0;;){if((g|0)>=(v|0))break e;if(E=o[m>>2]|0,N=o[E+(g<<2)>>2]|0,!N)g=g+1|0;else break}g=E+(~~(+ke(+(+at(10,+ +(15-(o[R>>2]|0)|0))*(+G[N>>3]+ +G[N+8>>3])))%+(v|0))>>>0<<2)|0,v=o[g>>2]|0;t:do if(v|0){if(E=N+32|0,(v|0)==(N|0))o[g>>2]=o[E>>2];else{if(v=v+32|0,g=o[v>>2]|0,!g)break;for(;(g|0)!=(N|0);)if(v=g+32|0,g=o[v>>2]|0,!g)break t;o[v>>2]=o[E>>2]}l(N),o[O>>2]=(o[O>>2]|0)+-1}while(0)}l(o[m>>2]|0)}function Os(m){m=m|0;var g=0,v=0,E=0;for(E=o[m+4>>2]|0,v=0;;){if((v|0)>=(E|0)){g=0,v=4;break}if(g=o[(o[m>>2]|0)+(v<<2)>>2]|0,!g)v=v+1|0;else{v=4;break}}return(v|0)==4?g|0:0}function St(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0;if(v=~~(+ke(+(+at(10,+ +(15-(o[m+12>>2]|0)|0))*(+G[g>>3]+ +G[g+8>>3])))%+(o[m+4>>2]|0))>>>0,v=(o[m>>2]|0)+(v<<2)|0,E=o[v>>2]|0,!E)return R=1,R|0;R=g+32|0;do if((E|0)!=(g|0)){if(v=o[E+32>>2]|0,!v)return R=1,R|0;for(C=v;;){if((C|0)==(g|0)){C=8;break}if(v=o[C+32>>2]|0,v)E=C,C=v;else{v=1,C=10;break}}if((C|0)==8){o[E+32>>2]=o[R>>2];break}else if((C|0)==10)return v|0}else o[v>>2]=o[R>>2];while(0);return l(g),R=m+8|0,o[R>>2]=(o[R>>2]|0)+-1,R=0,R|0}function Ct(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0;R=_(40)|0,R||An(23390,23360,98,23403),o[R>>2]=o[g>>2],o[R+4>>2]=o[g+4>>2],o[R+8>>2]=o[g+8>>2],o[R+12>>2]=o[g+12>>2],C=R+16|0,o[C>>2]=o[v>>2],o[C+4>>2]=o[v+4>>2],o[C+8>>2]=o[v+8>>2],o[C+12>>2]=o[v+12>>2],o[R+32>>2]=0,C=~~(+ke(+(+at(10,+ +(15-(o[m+12>>2]|0)|0))*(+G[g>>3]+ +G[g+8>>3])))%+(o[m+4>>2]|0))>>>0,C=(o[m>>2]|0)+(C<<2)|0,E=o[C>>2]|0;do if(!E)o[C>>2]=R;else{for(;!(gs(E,g)|0&&gs(E+16|0,v)|0);)if(C=o[E+32>>2]|0,E=C|0?C:E,!(o[E+32>>2]|0)){O=10;break}if((O|0)==10){o[E+32>>2]=R;break}return l(R),O=E,O|0}while(0);return O=m+8|0,o[O>>2]=(o[O>>2]|0)+1,O=R,O|0}function Fr(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0;if(C=~~(+ke(+(+at(10,+ +(15-(o[m+12>>2]|0)|0))*(+G[g>>3]+ +G[g+8>>3])))%+(o[m+4>>2]|0))>>>0,C=o[(o[m>>2]|0)+(C<<2)>>2]|0,!C)return v=0,v|0;if(!v){for(m=C;;){if(gs(m,g)|0){E=10;break}if(m=o[m+32>>2]|0,!m){m=0,E=10;break}}if((E|0)==10)return m|0}for(m=C;;){if(gs(m,g)|0&&gs(m+16|0,v)|0){E=10;break}if(m=o[m+32>>2]|0,!m){m=0,E=10;break}}return(E|0)==10?m|0:0}function $a(m,g){m=m|0,g=g|0;var v=0;if(v=~~(+ke(+(+at(10,+ +(15-(o[m+12>>2]|0)|0))*(+G[g>>3]+ +G[g+8>>3])))%+(o[m+4>>2]|0))>>>0,m=o[(o[m>>2]|0)+(v<<2)>>2]|0,!m)return v=0,v|0;for(;;){if(gs(m,g)|0){g=5;break}if(m=o[m+32>>2]|0,!m){m=0,g=5;break}}return(g|0)==5?m|0:0}function Fs(){return 23424}function k(m){return m=+m,+ +Ve(+m)}function c(m){return m=+m,~~+k(m)|0}function _(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0,Ye=0,ht=0,ut=0,rt=0,it=0,Xe=0,Vt=0;Vt=we,we=we+16|0,Re=Vt;do if(m>>>0<245){if(J=m>>>0<11?16:m+11&-8,m=J>>>3,de=o[5857]|0,v=de>>>m,v&3|0)return g=(v&1^1)+m|0,m=23468+(g<<1<<2)|0,v=m+8|0,E=o[v>>2]|0,C=E+8|0,R=o[C>>2]|0,(R|0)==(m|0)?o[5857]=de&~(1<<g):(o[R+12>>2]=m,o[v>>2]=R),Xe=g<<3,o[E+4>>2]=Xe|3,Xe=E+Xe+4|0,o[Xe>>2]=o[Xe>>2]|1,Xe=C,we=Vt,Xe|0;if(le=o[5859]|0,J>>>0>le>>>0){if(v|0)return g=2<<m,g=v<<m&(g|0-g),g=(g&0-g)+-1|0,N=g>>>12&16,g=g>>>N,v=g>>>5&8,g=g>>>v,R=g>>>2&4,g=g>>>R,m=g>>>1&2,g=g>>>m,E=g>>>1&1,E=(v|N|R|m|E)+(g>>>E)|0,g=23468+(E<<1<<2)|0,m=g+8|0,R=o[m>>2]|0,N=R+8|0,v=o[N>>2]|0,(v|0)==(g|0)?(m=de&~(1<<E),o[5857]=m):(o[v+12>>2]=g,o[m>>2]=v,m=de),Xe=E<<3,O=Xe-J|0,o[R+4>>2]=J|3,C=R+J|0,o[C+4>>2]=O|1,o[R+Xe>>2]=O,le|0&&(E=o[5862]|0,g=le>>>3,v=23468+(g<<1<<2)|0,g=1<<g,m&g?(m=v+8|0,g=o[m>>2]|0):(o[5857]=m|g,g=v,m=v+8|0),o[m>>2]=E,o[g+12>>2]=E,o[E+8>>2]=g,o[E+12>>2]=v),o[5859]=O,o[5862]=C,Xe=N,we=Vt,Xe|0;if(R=o[5858]|0,R){for(v=(R&0-R)+-1|0,C=v>>>12&16,v=v>>>C,E=v>>>5&8,v=v>>>E,O=v>>>2&4,v=v>>>O,N=v>>>1&2,v=v>>>N,Q=v>>>1&1,Q=o[23732+((E|C|O|N|Q)+(v>>>Q)<<2)>>2]|0,v=Q,N=Q,Q=(o[Q+4>>2]&-8)-J|0;m=o[v+16>>2]|0,!(!m&&(m=o[v+20>>2]|0,!m));)O=(o[m+4>>2]&-8)-J|0,C=O>>>0<Q>>>0,v=m,N=C?m:N,Q=C?O:Q;if(O=N+J|0,O>>>0>N>>>0){C=o[N+24>>2]|0,g=o[N+12>>2]|0;do if((g|0)==(N|0)){if(m=N+20|0,g=o[m>>2]|0,!g&&(m=N+16|0,g=o[m>>2]|0,!g)){v=0;break}for(;;)if(E=g+20|0,v=o[E>>2]|0,v)g=v,m=E;else if(E=g+16|0,v=o[E>>2]|0,v)g=v,m=E;else break;o[m>>2]=0,v=g}else v=o[N+8>>2]|0,o[v+12>>2]=g,o[g+8>>2]=v,v=g;while(0);do if(C|0){if(g=o[N+28>>2]|0,m=23732+(g<<2)|0,(N|0)==(o[m>>2]|0)){if(o[m>>2]=v,!v){o[5858]=R&~(1<<g);break}}else if(Xe=C+16|0,o[((o[Xe>>2]|0)==(N|0)?Xe:C+20|0)>>2]=v,!v)break;o[v+24>>2]=C,g=o[N+16>>2]|0,g|0&&(o[v+16>>2]=g,o[g+24>>2]=v),g=o[N+20>>2]|0,g|0&&(o[v+20>>2]=g,o[g+24>>2]=v)}while(0);return Q>>>0<16?(Xe=Q+J|0,o[N+4>>2]=Xe|3,Xe=N+Xe+4|0,o[Xe>>2]=o[Xe>>2]|1):(o[N+4>>2]=J|3,o[O+4>>2]=Q|1,o[O+Q>>2]=Q,le|0&&(E=o[5862]|0,g=le>>>3,v=23468+(g<<1<<2)|0,g=1<<g,g&de?(m=v+8|0,g=o[m>>2]|0):(o[5857]=g|de,g=v,m=v+8|0),o[m>>2]=E,o[g+12>>2]=E,o[E+8>>2]=g,o[E+12>>2]=v),o[5859]=Q,o[5862]=O),Xe=N+8|0,we=Vt,Xe|0}else de=J}else de=J}else de=J}else if(m>>>0<=4294967231)if(m=m+11|0,J=m&-8,E=o[5858]|0,E){C=0-J|0,m=m>>>8,m?J>>>0>16777215?Q=31:(de=(m+1048320|0)>>>16&8,Ye=m<<de,N=(Ye+520192|0)>>>16&4,Ye=Ye<<N,Q=(Ye+245760|0)>>>16&2,Q=14-(N|de|Q)+(Ye<<Q>>>15)|0,Q=J>>>(Q+7|0)&1|Q<<1):Q=0,v=o[23732+(Q<<2)>>2]|0;e:do if(!v)v=0,m=0,Ye=61;else for(m=0,N=J<<((Q|0)==31?0:25-(Q>>>1)|0),R=0;;){if(O=(o[v+4>>2]&-8)-J|0,O>>>0<C>>>0)if(O)m=v,C=O;else{m=v,C=0,Ye=65;break e}if(Ye=o[v+20>>2]|0,v=o[v+16+(N>>>31<<2)>>2]|0,R=(Ye|0)==0|(Ye|0)==(v|0)?R:Ye,v)N=N<<1;else{v=R,Ye=61;break}}while(0);if((Ye|0)==61){if((v|0)==0&(m|0)==0){if(m=2<<Q,m=(m|0-m)&E,!m){de=J;break}de=(m&0-m)+-1|0,O=de>>>12&16,de=de>>>O,R=de>>>5&8,de=de>>>R,N=de>>>2&4,de=de>>>N,Q=de>>>1&2,de=de>>>Q,v=de>>>1&1,m=0,v=o[23732+((R|O|N|Q|v)+(de>>>v)<<2)>>2]|0}v?Ye=65:(N=m,O=C)}if((Ye|0)==65)for(R=v;;)if(de=(o[R+4>>2]&-8)-J|0,v=de>>>0<C>>>0,C=v?de:C,m=v?R:m,v=o[R+16>>2]|0,v||(v=o[R+20>>2]|0),v)R=v;else{N=m,O=C;break}if(N|0&&O>>>0<((o[5859]|0)-J|0)>>>0&&(le=N+J|0,le>>>0>N>>>0)){R=o[N+24>>2]|0,g=o[N+12>>2]|0;do if((g|0)==(N|0)){if(m=N+20|0,g=o[m>>2]|0,!g&&(m=N+16|0,g=o[m>>2]|0,!g)){g=0;break}for(;;)if(C=g+20|0,v=o[C>>2]|0,v)g=v,m=C;else if(C=g+16|0,v=o[C>>2]|0,v)g=v,m=C;else break;o[m>>2]=0}else Xe=o[N+8>>2]|0,o[Xe+12>>2]=g,o[g+8>>2]=Xe;while(0);do if(R){if(m=o[N+28>>2]|0,v=23732+(m<<2)|0,(N|0)==(o[v>>2]|0)){if(o[v>>2]=g,!g){E=E&~(1<<m),o[5858]=E;break}}else if(Xe=R+16|0,o[((o[Xe>>2]|0)==(N|0)?Xe:R+20|0)>>2]=g,!g)break;o[g+24>>2]=R,m=o[N+16>>2]|0,m|0&&(o[g+16>>2]=m,o[m+24>>2]=g),m=o[N+20>>2]|0,m&&(o[g+20>>2]=m,o[m+24>>2]=g)}while(0);e:do if(O>>>0<16)Xe=O+J|0,o[N+4>>2]=Xe|3,Xe=N+Xe+4|0,o[Xe>>2]=o[Xe>>2]|1;else{if(o[N+4>>2]=J|3,o[le+4>>2]=O|1,o[le+O>>2]=O,g=O>>>3,O>>>0<256){v=23468+(g<<1<<2)|0,m=o[5857]|0,g=1<<g,m&g?(m=v+8|0,g=o[m>>2]|0):(o[5857]=m|g,g=v,m=v+8|0),o[m>>2]=le,o[g+12>>2]=le,o[le+8>>2]=g,o[le+12>>2]=v;break}if(g=O>>>8,g?O>>>0>16777215?v=31:(it=(g+1048320|0)>>>16&8,Xe=g<<it,rt=(Xe+520192|0)>>>16&4,Xe=Xe<<rt,v=(Xe+245760|0)>>>16&2,v=14-(rt|it|v)+(Xe<<v>>>15)|0,v=O>>>(v+7|0)&1|v<<1):v=0,g=23732+(v<<2)|0,o[le+28>>2]=v,m=le+16|0,o[m+4>>2]=0,o[m>>2]=0,m=1<<v,!(E&m)){o[5858]=E|m,o[g>>2]=le,o[le+24>>2]=g,o[le+12>>2]=le,o[le+8>>2]=le;break}g=o[g>>2]|0;t:do if((o[g+4>>2]&-8|0)!=(O|0)){for(E=O<<((v|0)==31?0:25-(v>>>1)|0);v=g+16+(E>>>31<<2)|0,m=o[v>>2]|0,!!m;)if((o[m+4>>2]&-8|0)==(O|0)){g=m;break t}else E=E<<1,g=m;o[v>>2]=le,o[le+24>>2]=g,o[le+12>>2]=le,o[le+8>>2]=le;break e}while(0);it=g+8|0,Xe=o[it>>2]|0,o[Xe+12>>2]=le,o[it>>2]=le,o[le+8>>2]=Xe,o[le+12>>2]=g,o[le+24>>2]=0}while(0);return Xe=N+8|0,we=Vt,Xe|0}else de=J}else de=J;else de=-1;while(0);if(v=o[5859]|0,v>>>0>=de>>>0)return g=v-de|0,m=o[5862]|0,g>>>0>15?(Xe=m+de|0,o[5862]=Xe,o[5859]=g,o[Xe+4>>2]=g|1,o[m+v>>2]=g,o[m+4>>2]=de|3):(o[5859]=0,o[5862]=0,o[m+4>>2]=v|3,Xe=m+v+4|0,o[Xe>>2]=o[Xe>>2]|1),Xe=m+8|0,we=Vt,Xe|0;if(O=o[5860]|0,O>>>0>de>>>0)return rt=O-de|0,o[5860]=rt,Xe=o[5863]|0,it=Xe+de|0,o[5863]=it,o[it+4>>2]=rt|1,o[Xe+4>>2]=de|3,Xe=Xe+8|0,we=Vt,Xe|0;if(o[5975]|0?m=o[5977]|0:(o[5977]=4096,o[5976]=4096,o[5978]=-1,o[5979]=-1,o[5980]=0,o[5968]=0,o[5975]=Re&-16^1431655768,m=4096),N=de+48|0,Q=de+47|0,R=m+Q|0,C=0-m|0,J=R&C,J>>>0<=de>>>0||(m=o[5967]|0,m|0&&(le=o[5965]|0,Re=le+J|0,Re>>>0<=le>>>0|Re>>>0>m>>>0)))return Xe=0,we=Vt,Xe|0;e:do if(o[5968]&4)g=0,Ye=143;else{v=o[5863]|0;t:do if(v){for(E=23876;Re=o[E>>2]|0,!(Re>>>0<=v>>>0&&(Re+(o[E+4>>2]|0)|0)>>>0>v>>>0);)if(m=o[E+8>>2]|0,m)E=m;else{Ye=128;break t}if(g=R-O&C,g>>>0<2147483647)if(m=xe(g|0)|0,(m|0)==((o[E>>2]|0)+(o[E+4>>2]|0)|0)){if((m|0)!=-1){O=g,R=m,Ye=145;break e}}else E=m,Ye=136;else g=0}else Ye=128;while(0);do if((Ye|0)==128)if(v=xe(0)|0,(v|0)!=-1&&(g=v,je=o[5976]|0,Be=je+-1|0,g=(Be&g|0?(Be+g&0-je)-g|0:0)+J|0,je=o[5965]|0,Be=g+je|0,g>>>0>de>>>0&g>>>0<2147483647)){if(Re=o[5967]|0,Re|0&&Be>>>0<=je>>>0|Be>>>0>Re>>>0){g=0;break}if(m=xe(g|0)|0,(m|0)==(v|0)){O=g,R=v,Ye=145;break e}else E=m,Ye=136}else g=0;while(0);do if((Ye|0)==136){if(v=0-g|0,!(N>>>0>g>>>0&(g>>>0<2147483647&(E|0)!=-1)))if((E|0)==-1){g=0;break}else{O=g,R=E,Ye=145;break e}if(m=o[5977]|0,m=Q-g+m&0-m,m>>>0>=2147483647){O=g,R=E,Ye=145;break e}if((xe(m|0)|0)==-1){xe(v|0)|0,g=0;break}else{O=m+g|0,R=E,Ye=145;break e}}while(0);o[5968]=o[5968]|4,Ye=143}while(0);if((Ye|0)==143&&J>>>0<2147483647&&(rt=xe(J|0)|0,Be=xe(0)|0,ht=Be-rt|0,ut=ht>>>0>(de+40|0)>>>0,!((rt|0)==-1|ut^1|rt>>>0<Be>>>0&((rt|0)!=-1&(Be|0)!=-1)^1))&&(O=ut?ht:g,R=rt,Ye=145),(Ye|0)==145){g=(o[5965]|0)+O|0,o[5965]=g,g>>>0>(o[5966]|0)>>>0&&(o[5966]=g),Q=o[5863]|0;e:do if(Q){for(g=23876;;){if(m=o[g>>2]|0,v=o[g+4>>2]|0,(R|0)==(m+v|0)){Ye=154;break}if(E=o[g+8>>2]|0,E)g=E;else break}if((Ye|0)==154&&(it=g+4|0,(o[g+12>>2]&8|0)==0)&&R>>>0>Q>>>0&m>>>0<=Q>>>0){o[it>>2]=v+O,Xe=(o[5860]|0)+O|0,rt=Q+8|0,rt=rt&7|0?0-rt&7:0,it=Q+rt|0,rt=Xe-rt|0,o[5863]=it,o[5860]=rt,o[it+4>>2]=rt|1,o[Q+Xe+4>>2]=40,o[5864]=o[5979];break}for(R>>>0<(o[5861]|0)>>>0&&(o[5861]=R),v=R+O|0,g=23876;;){if((o[g>>2]|0)==(v|0)){Ye=162;break}if(m=o[g+8>>2]|0,m)g=m;else break}if((Ye|0)==162&&!(o[g+12>>2]&8|0)){o[g>>2]=R,le=g+4|0,o[le>>2]=(o[le>>2]|0)+O,le=R+8|0,le=R+(le&7|0?0-le&7:0)|0,g=v+8|0,g=v+(g&7|0?0-g&7:0)|0,J=le+de|0,N=g-le-de|0,o[le+4>>2]=de|3;t:do if((Q|0)==(g|0))Xe=(o[5860]|0)+N|0,o[5860]=Xe,o[5863]=J,o[J+4>>2]=Xe|1;else{if((o[5862]|0)==(g|0)){Xe=(o[5859]|0)+N|0,o[5859]=Xe,o[5862]=J,o[J+4>>2]=Xe|1,o[J+Xe>>2]=Xe;break}if(m=o[g+4>>2]|0,(m&3|0)==1){O=m&-8,E=m>>>3;n:do if(m>>>0<256)if(m=o[g+8>>2]|0,v=o[g+12>>2]|0,(v|0)==(m|0)){o[5857]=o[5857]&~(1<<E);break}else{o[m+12>>2]=v,o[v+8>>2]=m;break}else{R=o[g+24>>2]|0,m=o[g+12>>2]|0;do if((m|0)==(g|0)){if(v=g+16|0,E=v+4|0,m=o[E>>2]|0,m)v=E;else if(m=o[v>>2]|0,!m){m=0;break}for(;;)if(C=m+20|0,E=o[C>>2]|0,E)m=E,v=C;else if(C=m+16|0,E=o[C>>2]|0,E)m=E,v=C;else break;o[v>>2]=0}else Xe=o[g+8>>2]|0,o[Xe+12>>2]=m,o[m+8>>2]=Xe;while(0);if(!R)break;v=o[g+28>>2]|0,E=23732+(v<<2)|0;do if((o[E>>2]|0)!=(g|0)){if(Xe=R+16|0,o[((o[Xe>>2]|0)==(g|0)?Xe:R+20|0)>>2]=m,!m)break n}else{if(o[E>>2]=m,m|0)break;o[5858]=o[5858]&~(1<<v);break n}while(0);if(o[m+24>>2]=R,v=g+16|0,E=o[v>>2]|0,E|0&&(o[m+16>>2]=E,o[E+24>>2]=m),v=o[v+4>>2]|0,!v)break;o[m+20>>2]=v,o[v+24>>2]=m}while(0);g=g+O|0,C=O+N|0}else C=N;if(g=g+4|0,o[g>>2]=o[g>>2]&-2,o[J+4>>2]=C|1,o[J+C>>2]=C,g=C>>>3,C>>>0<256){v=23468+(g<<1<<2)|0,m=o[5857]|0,g=1<<g,m&g?(m=v+8|0,g=o[m>>2]|0):(o[5857]=m|g,g=v,m=v+8|0),o[m>>2]=J,o[g+12>>2]=J,o[J+8>>2]=g,o[J+12>>2]=v;break}g=C>>>8;do if(!g)E=0;else{if(C>>>0>16777215){E=31;break}it=(g+1048320|0)>>>16&8,Xe=g<<it,rt=(Xe+520192|0)>>>16&4,Xe=Xe<<rt,E=(Xe+245760|0)>>>16&2,E=14-(rt|it|E)+(Xe<<E>>>15)|0,E=C>>>(E+7|0)&1|E<<1}while(0);if(g=23732+(E<<2)|0,o[J+28>>2]=E,m=J+16|0,o[m+4>>2]=0,o[m>>2]=0,m=o[5858]|0,v=1<<E,!(m&v)){o[5858]=m|v,o[g>>2]=J,o[J+24>>2]=g,o[J+12>>2]=J,o[J+8>>2]=J;break}g=o[g>>2]|0;n:do if((o[g+4>>2]&-8|0)!=(C|0)){for(E=C<<((E|0)==31?0:25-(E>>>1)|0);v=g+16+(E>>>31<<2)|0,m=o[v>>2]|0,!!m;)if((o[m+4>>2]&-8|0)==(C|0)){g=m;break n}else E=E<<1,g=m;o[v>>2]=J,o[J+24>>2]=g,o[J+12>>2]=J,o[J+8>>2]=J;break t}while(0);it=g+8|0,Xe=o[it>>2]|0,o[Xe+12>>2]=J,o[it>>2]=J,o[J+8>>2]=Xe,o[J+12>>2]=g,o[J+24>>2]=0}while(0);return Xe=le+8|0,we=Vt,Xe|0}for(g=23876;m=o[g>>2]|0,!(m>>>0<=Q>>>0&&(Xe=m+(o[g+4>>2]|0)|0,Xe>>>0>Q>>>0));)g=o[g+8>>2]|0;C=Xe+-47|0,m=C+8|0,m=C+(m&7|0?0-m&7:0)|0,C=Q+16|0,m=m>>>0<C>>>0?Q:m,g=m+8|0,v=O+-40|0,rt=R+8|0,rt=rt&7|0?0-rt&7:0,it=R+rt|0,rt=v-rt|0,o[5863]=it,o[5860]=rt,o[it+4>>2]=rt|1,o[R+v+4>>2]=40,o[5864]=o[5979],v=m+4|0,o[v>>2]=27,o[g>>2]=o[5969],o[g+4>>2]=o[5970],o[g+8>>2]=o[5971],o[g+12>>2]=o[5972],o[5969]=R,o[5970]=O,o[5972]=0,o[5971]=g,g=m+24|0;do it=g,g=g+4|0,o[g>>2]=7;while((it+8|0)>>>0<Xe>>>0);if((m|0)!=(Q|0)){if(R=m-Q|0,o[v>>2]=o[v>>2]&-2,o[Q+4>>2]=R|1,o[m>>2]=R,g=R>>>3,R>>>0<256){v=23468+(g<<1<<2)|0,m=o[5857]|0,g=1<<g,m&g?(m=v+8|0,g=o[m>>2]|0):(o[5857]=m|g,g=v,m=v+8|0),o[m>>2]=Q,o[g+12>>2]=Q,o[Q+8>>2]=g,o[Q+12>>2]=v;break}if(g=R>>>8,g?R>>>0>16777215?E=31:(it=(g+1048320|0)>>>16&8,Xe=g<<it,rt=(Xe+520192|0)>>>16&4,Xe=Xe<<rt,E=(Xe+245760|0)>>>16&2,E=14-(rt|it|E)+(Xe<<E>>>15)|0,E=R>>>(E+7|0)&1|E<<1):E=0,v=23732+(E<<2)|0,o[Q+28>>2]=E,o[Q+20>>2]=0,o[C>>2]=0,g=o[5858]|0,m=1<<E,!(g&m)){o[5858]=g|m,o[v>>2]=Q,o[Q+24>>2]=v,o[Q+12>>2]=Q,o[Q+8>>2]=Q;break}g=o[v>>2]|0;t:do if((o[g+4>>2]&-8|0)!=(R|0)){for(E=R<<((E|0)==31?0:25-(E>>>1)|0);v=g+16+(E>>>31<<2)|0,m=o[v>>2]|0,!!m;)if((o[m+4>>2]&-8|0)==(R|0)){g=m;break t}else E=E<<1,g=m;o[v>>2]=Q,o[Q+24>>2]=g,o[Q+12>>2]=Q,o[Q+8>>2]=Q;break e}while(0);it=g+8|0,Xe=o[it>>2]|0,o[Xe+12>>2]=Q,o[it>>2]=Q,o[Q+8>>2]=Xe,o[Q+12>>2]=g,o[Q+24>>2]=0}}else Xe=o[5861]|0,(Xe|0)==0|R>>>0<Xe>>>0&&(o[5861]=R),o[5969]=R,o[5970]=O,o[5972]=0,o[5866]=o[5975],o[5865]=-1,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,o[5906]=23612,o[5905]=23612,o[5908]=23620,o[5907]=23620,o[5910]=23628,o[5909]=23628,o[5912]=23636,o[5911]=23636,o[5914]=23644,o[5913]=23644,o[5916]=23652,o[5915]=23652,o[5918]=23660,o[5917]=23660,o[5920]=23668,o[5919]=23668,o[5922]=23676,o[5921]=23676,o[5924]=23684,o[5923]=23684,o[5926]=23692,o[5925]=23692,o[5928]=23700,o[5927]=23700,o[5930]=23708,o[5929]=23708,o[5932]=23716,o[5931]=23716,Xe=O+-40|0,rt=R+8|0,rt=rt&7|0?0-rt&7:0,it=R+rt|0,rt=Xe-rt|0,o[5863]=it,o[5860]=rt,o[it+4>>2]=rt|1,o[R+Xe+4>>2]=40,o[5864]=o[5979];while(0);if(g=o[5860]|0,g>>>0>de>>>0)return rt=g-de|0,o[5860]=rt,Xe=o[5863]|0,it=Xe+de|0,o[5863]=it,o[it+4>>2]=rt|1,o[Xe+4>>2]=de|3,Xe=Xe+8|0,we=Vt,Xe|0}return Xe=Fs()|0,o[Xe>>2]=12,Xe=0,we=Vt,Xe|0}function l(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0,Q=0;if(m){v=m+-8|0,C=o[5861]|0,m=o[m+-4>>2]|0,g=m&-8,Q=v+g|0;do if(m&1)N=v,O=v;else{if(E=o[v>>2]|0,!(m&3)||(O=v+(0-E)|0,R=E+g|0,O>>>0<C>>>0))return;if((o[5862]|0)==(O|0)){if(m=Q+4|0,g=o[m>>2]|0,(g&3|0)!=3){N=O,g=R;break}o[5859]=R,o[m>>2]=g&-2,o[O+4>>2]=R|1,o[O+R>>2]=R;return}if(v=E>>>3,E>>>0<256)if(m=o[O+8>>2]|0,g=o[O+12>>2]|0,(g|0)==(m|0)){o[5857]=o[5857]&~(1<<v),N=O,g=R;break}else{o[m+12>>2]=g,o[g+8>>2]=m,N=O,g=R;break}C=o[O+24>>2]|0,m=o[O+12>>2]|0;do if((m|0)==(O|0)){if(g=O+16|0,v=g+4|0,m=o[v>>2]|0,m)g=v;else if(m=o[g>>2]|0,!m){m=0;break}for(;;)if(E=m+20|0,v=o[E>>2]|0,v)m=v,g=E;else if(E=m+16|0,v=o[E>>2]|0,v)m=v,g=E;else break;o[g>>2]=0}else N=o[O+8>>2]|0,o[N+12>>2]=m,o[m+8>>2]=N;while(0);if(C){if(g=o[O+28>>2]|0,v=23732+(g<<2)|0,(o[v>>2]|0)==(O|0)){if(o[v>>2]=m,!m){o[5858]=o[5858]&~(1<<g),N=O,g=R;break}}else if(N=C+16|0,o[((o[N>>2]|0)==(O|0)?N:C+20|0)>>2]=m,!m){N=O,g=R;break}o[m+24>>2]=C,g=O+16|0,v=o[g>>2]|0,v|0&&(o[m+16>>2]=v,o[v+24>>2]=m),g=o[g+4>>2]|0,g?(o[m+20>>2]=g,o[g+24>>2]=m,N=O,g=R):(N=O,g=R)}else N=O,g=R}while(0);if(!(O>>>0>=Q>>>0)&&(m=Q+4|0,E=o[m>>2]|0,!!(E&1))){if(E&2)o[m>>2]=E&-2,o[N+4>>2]=g|1,o[O+g>>2]=g,C=g;else{if((o[5863]|0)==(Q|0)){if(Q=(o[5860]|0)+g|0,o[5860]=Q,o[5863]=N,o[N+4>>2]=Q|1,(N|0)!=(o[5862]|0))return;o[5862]=0,o[5859]=0;return}if((o[5862]|0)==(Q|0)){Q=(o[5859]|0)+g|0,o[5859]=Q,o[5862]=O,o[N+4>>2]=Q|1,o[O+Q>>2]=Q;return}C=(E&-8)+g|0,v=E>>>3;do if(E>>>0<256)if(g=o[Q+8>>2]|0,m=o[Q+12>>2]|0,(m|0)==(g|0)){o[5857]=o[5857]&~(1<<v);break}else{o[g+12>>2]=m,o[m+8>>2]=g;break}else{R=o[Q+24>>2]|0,m=o[Q+12>>2]|0;do if((m|0)==(Q|0)){if(g=Q+16|0,v=g+4|0,m=o[v>>2]|0,m)g=v;else if(m=o[g>>2]|0,!m){v=0;break}for(;;)if(E=m+20|0,v=o[E>>2]|0,v)m=v,g=E;else if(E=m+16|0,v=o[E>>2]|0,v)m=v,g=E;else break;o[g>>2]=0,v=m}else v=o[Q+8>>2]|0,o[v+12>>2]=m,o[m+8>>2]=v,v=m;while(0);if(R|0){if(m=o[Q+28>>2]|0,g=23732+(m<<2)|0,(o[g>>2]|0)==(Q|0)){if(o[g>>2]=v,!v){o[5858]=o[5858]&~(1<<m);break}}else if(E=R+16|0,o[((o[E>>2]|0)==(Q|0)?E:R+20|0)>>2]=v,!v)break;o[v+24>>2]=R,m=Q+16|0,g=o[m>>2]|0,g|0&&(o[v+16>>2]=g,o[g+24>>2]=v),m=o[m+4>>2]|0,m|0&&(o[v+20>>2]=m,o[m+24>>2]=v)}}while(0);if(o[N+4>>2]=C|1,o[O+C>>2]=C,(N|0)==(o[5862]|0)){o[5859]=C;return}}if(m=C>>>3,C>>>0<256){v=23468+(m<<1<<2)|0,g=o[5857]|0,m=1<<m,g&m?(g=v+8|0,m=o[g>>2]|0):(o[5857]=g|m,m=v,g=v+8|0),o[g>>2]=N,o[m+12>>2]=N,o[N+8>>2]=m,o[N+12>>2]=v;return}m=C>>>8,m?C>>>0>16777215?E=31:(O=(m+1048320|0)>>>16&8,Q=m<<O,R=(Q+520192|0)>>>16&4,Q=Q<<R,E=(Q+245760|0)>>>16&2,E=14-(R|O|E)+(Q<<E>>>15)|0,E=C>>>(E+7|0)&1|E<<1):E=0,m=23732+(E<<2)|0,o[N+28>>2]=E,o[N+20>>2]=0,o[N+16>>2]=0,g=o[5858]|0,v=1<<E;e:do if(!(g&v))o[5858]=g|v,o[m>>2]=N,o[N+24>>2]=m,o[N+12>>2]=N,o[N+8>>2]=N;else{m=o[m>>2]|0;t:do if((o[m+4>>2]&-8|0)!=(C|0)){for(E=C<<((E|0)==31?0:25-(E>>>1)|0);v=m+16+(E>>>31<<2)|0,g=o[v>>2]|0,!!g;)if((o[g+4>>2]&-8|0)==(C|0)){m=g;break t}else E=E<<1,m=g;o[v>>2]=N,o[N+24>>2]=m,o[N+12>>2]=N,o[N+8>>2]=N;break e}while(0);O=m+8|0,Q=o[O>>2]|0,o[Q+12>>2]=N,o[O>>2]=N,o[N+8>>2]=Q,o[N+12>>2]=m,o[N+24>>2]=0}while(0);if(Q=(o[5865]|0)+-1|0,o[5865]=Q,!(Q|0)){for(m=23884;m=o[m>>2]|0,m;)m=m+8|0;o[5865]=-1}}}}function h(m,g){m=m|0,g=g|0;var v=0;return m?(v=on(g,m)|0,(g|m)>>>0>65535&&(v=((v>>>0)/(m>>>0)|0|0)==(g|0)?v:-1)):v=0,m=_(v)|0,!m||!(o[m+-4>>2]&3)||Te(m|0,0,v|0)|0,m|0}function d(m,g,v,E){return m=m|0,g=g|0,v=v|0,E=E|0,v=m+v>>>0,Mt(g+E+(v>>>0<m>>>0|0)>>>0|0),v|0|0}function x(m,g,v,E){return m=m|0,g=g|0,v=v|0,E=E|0,E=g-E-(v>>>0>m>>>0|0)>>>0,Mt(E|0),m-v>>>0|0|0}function b(m){return m=m|0,(m?31-(Oe(m^m-1)|0)|0:32)|0}function S(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,je=0,Be=0;if(le=m,Q=g,J=Q,O=v,Re=E,N=Re,!J)return R=(C|0)!=0,N?R?(o[C>>2]=m|0,o[C+4>>2]=g&0,Re=0,C=0,Mt(Re|0),C|0):(Re=0,C=0,Mt(Re|0),C|0):(R&&(o[C>>2]=(le>>>0)%(O>>>0),o[C+4>>2]=0),Re=0,C=(le>>>0)/(O>>>0)>>>0,Mt(Re|0),C|0);R=(N|0)==0;do if(O){if(!R){if(R=(Oe(N|0)|0)-(Oe(J|0)|0)|0,R>>>0<=31){de=R+1|0,N=31-R|0,g=R-31>>31,O=de,m=le>>>(de>>>0)&g|J<<N,g=J>>>(de>>>0)&g,R=0,N=le<<N;break}return C?(o[C>>2]=m|0,o[C+4>>2]=Q|g&0,Re=0,C=0,Mt(Re|0),C|0):(Re=0,C=0,Mt(Re|0),C|0)}if(R=O-1|0,R&O|0){N=(Oe(O|0)|0)+33-(Oe(J|0)|0)|0,Be=64-N|0,de=32-N|0,Q=de>>31,je=N-32|0,g=je>>31,O=N,m=de-1>>31&J>>>(je>>>0)|(J<<de|le>>>(N>>>0))&g,g=g&J>>>(N>>>0),R=le<<Be&Q,N=(J<<Be|le>>>(je>>>0))&Q|le<<de&N-33>>31;break}return C|0&&(o[C>>2]=R&le,o[C+4>>2]=0),(O|0)==1?(je=Q|g&0,Be=m|0|0,Mt(je|0),Be|0):(Be=b(O|0)|0,je=J>>>(Be>>>0)|0,Be=J<<32-Be|le>>>(Be>>>0)|0,Mt(je|0),Be|0)}else{if(R)return C|0&&(o[C>>2]=(J>>>0)%(O>>>0),o[C+4>>2]=0),je=0,Be=(J>>>0)/(O>>>0)>>>0,Mt(je|0),Be|0;if(!le)return C|0&&(o[C>>2]=0,o[C+4>>2]=(J>>>0)%(N>>>0)),je=0,Be=(J>>>0)/(N>>>0)>>>0,Mt(je|0),Be|0;if(R=N-1|0,!(R&N))return C|0&&(o[C>>2]=m|0,o[C+4>>2]=R&J|g&0),je=0,Be=J>>>((b(N|0)|0)>>>0),Mt(je|0),Be|0;if(R=(Oe(N|0)|0)-(Oe(J|0)|0)|0,R>>>0<=30){g=R+1|0,N=31-R|0,O=g,m=J<<N|le>>>(g>>>0),g=J>>>(g>>>0),R=0,N=le<<N;break}return C?(o[C>>2]=m|0,o[C+4>>2]=Q|g&0,je=0,Be=0,Mt(je|0),Be|0):(je=0,Be=0,Mt(je|0),Be|0)}while(0);if(!O)J=N,Q=0,N=0;else{de=v|0|0,le=Re|E&0,J=d(de|0,le|0,-1,-1)|0,v=Se()|0,Q=N,N=0;do E=Q,Q=R>>>31|Q<<1,R=N|R<<1,E=m<<1|E>>>31|0,Re=m>>>31|g<<1|0,x(J|0,v|0,E|0,Re|0)|0,Be=Se()|0,je=Be>>31|((Be|0)<0?-1:0)<<1,N=je&1,m=x(E|0,Re|0,je&de|0,(((Be|0)<0?-1:0)>>31|((Be|0)<0?-1:0)<<1)&le|0)|0,g=Se()|0,O=O-1|0;while(O|0);J=Q,Q=0}return O=0,C|0&&(o[C>>2]=m,o[C+4>>2]=g),je=(R|0)>>>31|(J|O)<<1|(O<<1|R>>>31)&0|Q,Be=(R<<1|0)&-2|N,Mt(je|0),Be|0}function M(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0,J=0;return J=g>>31|((g|0)<0?-1:0)<<1,Q=((g|0)<0?-1:0)>>31|((g|0)<0?-1:0)<<1,R=E>>31|((E|0)<0?-1:0)<<1,C=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,N=x(J^m|0,Q^g|0,J|0,Q|0)|0,O=Se()|0,m=R^J,g=C^Q,x((S(N,O,x(R^v|0,C^E|0,R|0,C|0)|0,Se()|0,0)|0)^m|0,(Se()|0)^g|0,m|0,g|0)|0}function B(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0;return R=m&65535,C=g&65535,v=on(C,R)|0,E=m>>>16,m=(v>>>16)+(on(C,E)|0)|0,C=g>>>16,g=on(C,R)|0,Mt((m>>>16)+(on(C,E)|0)+(((m&65535)+g|0)>>>16)|0),m+g<<16|v&65535|0|0}function V(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0;return C=m,R=v,v=B(C,R)|0,m=Se()|0,Mt((on(g,R)|0)+(on(E,C)|0)+m|m&0|0),v|0|0|0}function $(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,Q=0,J=0;return C=we,we=we+16|0,N=C|0,O=g>>31|((g|0)<0?-1:0)<<1,R=((g|0)<0?-1:0)>>31|((g|0)<0?-1:0)<<1,J=E>>31|((E|0)<0?-1:0)<<1,Q=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,m=x(O^m|0,R^g|0,O|0,R|0)|0,g=Se()|0,S(m,g,x(J^v|0,Q^E|0,J|0,Q|0)|0,Se()|0,N)|0,E=x(o[N>>2]^O|0,o[N+4>>2]^R|0,O|0,R|0)|0,v=Se()|0,we=C,Mt(v|0),E|0}function Y(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0;return R=we,we=we+16|0,C=R|0,S(m,g,v,E,C)|0,we=R,Mt(o[C+4>>2]|0),o[C>>2]|0|0}function oe(m,g,v){return m=m|0,g=g|0,v=v|0,(v|0)<32?(Mt(g>>v|0),m>>>v|(g&(1<<v)-1)<<32-v):(Mt(((g|0)<0?-1:0)|0),g>>v-32|0)}function te(m,g,v){return m=m|0,g=g|0,v=v|0,(v|0)<32?(Mt(g>>>v|0),m>>>v|(g&(1<<v)-1)<<32-v):(Mt(0),g>>>v-32|0)}function ue(m,g,v){return m=m|0,g=g|0,v=v|0,(v|0)<32?(Mt(g<<v|(m&(1<<v)-1<<32-v)>>>32-v|0),m<<v):(Mt(m<<v-32|0),0)}function be(m,g){return m=+m,g=+g,m!=m?+g:g!=g?+m:+Ot(+m,+g)}function Ce(m,g){return m=+m,g=+g,m!=m?+g:g!=g?+m:+vn(+m,+g)}function ve(m){return m=+m,m>=0?+Pe(m+.5):+Qt(m-.5)}function Ge(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;if((v|0)>=8192)return ea(m|0,g|0,v|0)|0,m|0;if(R=m|0,C=m+v|0,(m&3)==(g&3)){for(;m&3;){if(!v)return R|0;he[m>>0]=he[g>>0]|0,m=m+1|0,g=g+1|0,v=v-1|0}for(v=C&-4|0,E=v-64|0;(m|0)<=(E|0);)o[m>>2]=o[g>>2],o[m+4>>2]=o[g+4>>2],o[m+8>>2]=o[g+8>>2],o[m+12>>2]=o[g+12>>2],o[m+16>>2]=o[g+16>>2],o[m+20>>2]=o[g+20>>2],o[m+24>>2]=o[g+24>>2],o[m+28>>2]=o[g+28>>2],o[m+32>>2]=o[g+32>>2],o[m+36>>2]=o[g+36>>2],o[m+40>>2]=o[g+40>>2],o[m+44>>2]=o[g+44>>2],o[m+48>>2]=o[g+48>>2],o[m+52>>2]=o[g+52>>2],o[m+56>>2]=o[g+56>>2],o[m+60>>2]=o[g+60>>2],m=m+64|0,g=g+64|0;for(;(m|0)<(v|0);)o[m>>2]=o[g>>2],m=m+4|0,g=g+4|0}else for(v=C-4|0;(m|0)<(v|0);)he[m>>0]=he[g>>0]|0,he[m+1>>0]=he[g+1>>0]|0,he[m+2>>0]=he[g+2>>0]|0,he[m+3>>0]=he[g+3>>0]|0,m=m+4|0,g=g+4|0;for(;(m|0)<(C|0);)he[m>>0]=he[g>>0]|0,m=m+1|0,g=g+1|0;return R|0}function Te(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0;if(R=m+v|0,g=g&255,(v|0)>=67){for(;m&3;)he[m>>0]=g,m=m+1|0;for(E=R&-4|0,O=g|g<<8|g<<16|g<<24,C=E-64|0;(m|0)<=(C|0);)o[m>>2]=O,o[m+4>>2]=O,o[m+8>>2]=O,o[m+12>>2]=O,o[m+16>>2]=O,o[m+20>>2]=O,o[m+24>>2]=O,o[m+28>>2]=O,o[m+32>>2]=O,o[m+36>>2]=O,o[m+40>>2]=O,o[m+44>>2]=O,o[m+48>>2]=O,o[m+52>>2]=O,o[m+56>>2]=O,o[m+60>>2]=O,m=m+64|0;for(;(m|0)<(E|0);)o[m>>2]=O,m=m+4|0}for(;(m|0)<(R|0);)he[m>>0]=g,m=m+1|0;return R-v|0}function Ve(m){return m=+m,m>=0?+Pe(m+.5):+Qt(m-.5)}function xe(m){m=m|0;var g=0,v=0,E=0;return E=nr()|0,v=o[Ie>>2]|0,g=v+m|0,(m|0)>0&(g|0)<(v|0)|(g|0)<0?(Ia(g|0)|0,ii(12),-1):(g|0)>(E|0)&&!(De(g|0)|0)?(ii(12),-1):(o[Ie>>2]=g,v|0)}return{___divdi3:M,___muldi3:V,___remdi3:$,___uremdi3:Y,_areNeighborCells:$A,_bitshift64Ashr:oe,_bitshift64Lshr:te,_bitshift64Shl:ue,_calloc:h,_cellAreaKm2:Ft,_cellAreaM2:YA,_cellAreaRads2:is,_cellToBoundary:Ai,_cellToCenterChild:qA,_cellToChildPos:rs,_cellToChildren:uA,_cellToChildrenSize:_l,_cellToLatLng:co,_cellToLocalIj:th,_cellToParent:yl,_cellToVertex:cn,_cellToVertexes:$i,_cellsToDirectedEdge:HA,_cellsToLinkedMultiPolygon:Cr,_childPosToCell:ec,_compactCells:vl,_destroyLinkedMultiPolygon:El,_directedEdgeToBoundary:Is,_directedEdgeToCells:sa,_edgeLengthKm:No,_edgeLengthM:XA,_edgeLengthRads:ua,_emscripten_replace_memory:ko,_free:l,_getBaseCellNumber:za,_getDirectedEdgeDestination:ia,_getDirectedEdgeOrigin:uo,_getHexagonAreaAvgKm2:bl,_getHexagonAreaAvgM2:Ua,_getHexagonEdgeLengthAvgKm:Jc,_getHexagonEdgeLengthAvgM:eh,_getIcosahedronFaces:xl,_getNumCells:Va,_getPentagons:Ds,_getRes0Cells:aA,_getResolution:ml,_greatCircleDistanceKm:wl,_greatCircleDistanceM:Fo,_greatCircleDistanceRads:ji,_gridDisk:na,_gridDiskDistances:Yr,_gridDistance:JA,_gridPathCells:tu,_gridPathCellsSize:eu,_gridRingUnsafe:wt,_i64Add:d,_i64Subtract:x,_isPentagon:fr,_isResClassIII:Pr,_isValidCell:oa,_isValidDirectedEdge:WA,_isValidVertex:Or,_latLngToCell:ns,_llvm_maxnum_f64:be,_llvm_minnum_f64:Ce,_llvm_round_f64:ve,_localIjToCell:nc,_malloc:_,_maxFaceCount:Oa,_maxGridDiskSize:Al,_maxPolygonToCellsSize:Wt,_memcpy:Ge,_memset:Te,_originToDirectedEdges:ur,_pentagonCount:Fa,_polygonToCells:Sr,_readInt64AsDoubleFromPointer:ru,_res0CellCount:oA,_round:Ve,_sbrk:xe,_sizeOfCellBoundary:rc,_sizeOfCoordIJ:Sl,_sizeOfGeoLoop:ss,_sizeOfGeoPolygon:wr,_sizeOfH3Index:Dr,_sizeOfLatLng:Tl,_sizeOfLinkedGeoPolygon:ja,_uncompactCells:Ku,_uncompactCellsSize:jr,_vertexToLatLng:Uo,establishStackSpace:ta,stackAlloc:ds,stackRestore:La,stackSave:ka}}(fs,mn,Ne);e.___divdi3=Ze.___divdi3,e.___muldi3=Ze.___muldi3,e.___remdi3=Ze.___remdi3,e.___uremdi3=Ze.___uremdi3,e._areNeighborCells=Ze._areNeighborCells,e._bitshift64Ashr=Ze._bitshift64Ashr,e._bitshift64Lshr=Ze._bitshift64Lshr,e._bitshift64Shl=Ze._bitshift64Shl,e._calloc=Ze._calloc,e._cellAreaKm2=Ze._cellAreaKm2,e._cellAreaM2=Ze._cellAreaM2,e._cellAreaRads2=Ze._cellAreaRads2,e._cellToBoundary=Ze._cellToBoundary,e._cellToCenterChild=Ze._cellToCenterChild,e._cellToChildPos=Ze._cellToChildPos,e._cellToChildren=Ze._cellToChildren,e._cellToChildrenSize=Ze._cellToChildrenSize,e._cellToLatLng=Ze._cellToLatLng,e._cellToLocalIj=Ze._cellToLocalIj,e._cellToParent=Ze._cellToParent,e._cellToVertex=Ze._cellToVertex,e._cellToVertexes=Ze._cellToVertexes,e._cellsToDirectedEdge=Ze._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=Ze._cellsToLinkedMultiPolygon,e._childPosToCell=Ze._childPosToCell,e._compactCells=Ze._compactCells,e._destroyLinkedMultiPolygon=Ze._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=Ze._directedEdgeToBoundary,e._directedEdgeToCells=Ze._directedEdgeToCells,e._edgeLengthKm=Ze._edgeLengthKm,e._edgeLengthM=Ze._edgeLengthM,e._edgeLengthRads=Ze._edgeLengthRads;var Vr=e._emscripten_replace_memory=Ze._emscripten_replace_memory;e._free=Ze._free,e._getBaseCellNumber=Ze._getBaseCellNumber,e._getDirectedEdgeDestination=Ze._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=Ze._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=Ze._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=Ze._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=Ze._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=Ze._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=Ze._getIcosahedronFaces,e._getNumCells=Ze._getNumCells,e._getPentagons=Ze._getPentagons,e._getRes0Cells=Ze._getRes0Cells,e._getResolution=Ze._getResolution,e._greatCircleDistanceKm=Ze._greatCircleDistanceKm,e._greatCircleDistanceM=Ze._greatCircleDistanceM,e._greatCircleDistanceRads=Ze._greatCircleDistanceRads,e._gridDisk=Ze._gridDisk,e._gridDiskDistances=Ze._gridDiskDistances,e._gridDistance=Ze._gridDistance,e._gridPathCells=Ze._gridPathCells,e._gridPathCellsSize=Ze._gridPathCellsSize,e._gridRingUnsafe=Ze._gridRingUnsafe,e._i64Add=Ze._i64Add,e._i64Subtract=Ze._i64Subtract,e._isPentagon=Ze._isPentagon,e._isResClassIII=Ze._isResClassIII,e._isValidCell=Ze._isValidCell,e._isValidDirectedEdge=Ze._isValidDirectedEdge,e._isValidVertex=Ze._isValidVertex,e._latLngToCell=Ze._latLngToCell,e._llvm_maxnum_f64=Ze._llvm_maxnum_f64,e._llvm_minnum_f64=Ze._llvm_minnum_f64,e._llvm_round_f64=Ze._llvm_round_f64,e._localIjToCell=Ze._localIjToCell,e._malloc=Ze._malloc,e._maxFaceCount=Ze._maxFaceCount,e._maxGridDiskSize=Ze._maxGridDiskSize,e._maxPolygonToCellsSize=Ze._maxPolygonToCellsSize,e._memcpy=Ze._memcpy,e._memset=Ze._memset,e._originToDirectedEdges=Ze._originToDirectedEdges,e._pentagonCount=Ze._pentagonCount,e._polygonToCells=Ze._polygonToCells,e._readInt64AsDoubleFromPointer=Ze._readInt64AsDoubleFromPointer,e._res0CellCount=Ze._res0CellCount,e._round=Ze._round,e._sbrk=Ze._sbrk,e._sizeOfCellBoundary=Ze._sizeOfCellBoundary,e._sizeOfCoordIJ=Ze._sizeOfCoordIJ,e._sizeOfGeoLoop=Ze._sizeOfGeoLoop,e._sizeOfGeoPolygon=Ze._sizeOfGeoPolygon,e._sizeOfH3Index=Ze._sizeOfH3Index,e._sizeOfLatLng=Ze._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=Ze._sizeOfLinkedGeoPolygon,e._uncompactCells=Ze._uncompactCells,e._uncompactCellsSize=Ze._uncompactCellsSize,e._vertexToLatLng=Ze._vertexToLatLng,e.establishStackSpace=Ze.establishStackSpace;var Cs=e.stackAlloc=Ze.stackAlloc,kr=e.stackRestore=Ze.stackRestore,ri=e.stackSave=Ze.stackSave;if(e.asm=Ze,e.cwrap=ie,e.setValue=U,e.getValue=W,Hn){oo(Hn)||(Hn=s(Hn));{Un();var Zn=function(X){X.byteLength&&(X=new Uint8Array(X)),qe.set(X,L),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,wi()},Ps=function(){A(Hn,Zn,function(){throw"could not load memory initializer "+Hn})},Bi=Mr(Hn);if(Bi)Zn(Bi.buffer);else if(e.memoryInitializerRequest){var zi=function(){var X=e.memoryInitializerRequest,H=X.response;if(X.status!==200&&X.status!==0){var ee=Mr(e.memoryInitializerRequestURL);if(ee)H=ee.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+X.status+", retrying "+Hn),Ps();return}}Zn(H)};e.memoryInitializerRequest.response?setTimeout(zi,0):e.memoryInitializerRequest.addEventListener("load",zi)}else Ps()}}var Si;Zr=function X(){Si||es(),Si||(Zr=X)};function es(X){if(tr>0||(Nn(),tr>0))return;function H(){Si||(Si=!0,!q&&(xr(),xt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),nn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),H()},1)):H()}e.run=es;function Lr(X){throw e.onAbort&&e.onAbort(X),X+="",a(X),y(X),q=!0,"abort("+X+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Lr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return es(),t}(typeof Yi=="object"?Yi:{}),Qn="number",Dn=Qn,tp=Qn,On=Qn,Fn=Qn,qs=Qn,hn=Qn,kge=[["sizeOfH3Index",Qn],["sizeOfLatLng",Qn],["sizeOfCellBoundary",Qn],["sizeOfGeoLoop",Qn],["sizeOfGeoPolygon",Qn],["sizeOfLinkedGeoPolygon",Qn],["sizeOfCoordIJ",Qn],["readInt64AsDoubleFromPointer",Qn],["isValidCell",tp,[On,Fn]],["latLngToCell",Dn,[Qn,Qn,qs,hn]],["cellToLatLng",Dn,[On,Fn,hn]],["cellToBoundary",Dn,[On,Fn,hn]],["maxGridDiskSize",Dn,[Qn,hn]],["gridDisk",Dn,[On,Fn,Qn,hn]],["gridDiskDistances",Dn,[On,Fn,Qn,hn,hn]],["gridRingUnsafe",Dn,[On,Fn,Qn,hn]],["maxPolygonToCellsSize",Dn,[hn,qs,Qn,hn]],["polygonToCells",Dn,[hn,qs,Qn,hn]],["cellsToLinkedMultiPolygon",Dn,[hn,Qn,hn]],["destroyLinkedMultiPolygon",null,[hn]],["compactCells",Dn,[hn,hn,Qn,Qn]],["uncompactCells",Dn,[hn,Qn,Qn,hn,Qn,qs]],["uncompactCellsSize",Dn,[hn,Qn,Qn,qs,hn]],["isPentagon",tp,[On,Fn]],["isResClassIII",tp,[On,Fn]],["getBaseCellNumber",Qn,[On,Fn]],["getResolution",Qn,[On,Fn]],["maxFaceCount",Dn,[On,Fn,hn]],["getIcosahedronFaces",Dn,[On,Fn,hn]],["cellToParent",Dn,[On,Fn,qs,hn]],["cellToChildren",Dn,[On,Fn,qs,hn]],["cellToCenterChild",Dn,[On,Fn,qs,hn]],["cellToChildrenSize",Dn,[On,Fn,qs,hn]],["cellToChildPos",Dn,[On,Fn,qs,hn]],["childPosToCell",Dn,[Qn,Qn,On,Fn,qs,hn]],["areNeighborCells",Dn,[On,Fn,On,Fn,hn]],["cellsToDirectedEdge",Dn,[On,Fn,On,Fn,hn]],["getDirectedEdgeOrigin",Dn,[On,Fn,hn]],["getDirectedEdgeDestination",Dn,[On,Fn,hn]],["isValidDirectedEdge",tp,[On,Fn]],["directedEdgeToCells",Dn,[On,Fn,hn]],["originToDirectedEdges",Dn,[On,Fn,hn]],["directedEdgeToBoundary",Dn,[On,Fn,hn]],["gridDistance",Dn,[On,Fn,On,Fn,hn]],["gridPathCells",Dn,[On,Fn,On,Fn,hn]],["gridPathCellsSize",Dn,[On,Fn,On,Fn,hn]],["cellToLocalIj",Dn,[On,Fn,On,Fn,Qn,hn]],["localIjToCell",Dn,[On,Fn,hn,Qn,hn]],["getHexagonAreaAvgM2",Dn,[qs,hn]],["getHexagonAreaAvgKm2",Dn,[qs,hn]],["getHexagonEdgeLengthAvgM",Dn,[qs,hn]],["getHexagonEdgeLengthAvgKm",Dn,[qs,hn]],["greatCircleDistanceM",Qn,[hn,hn]],["greatCircleDistanceKm",Qn,[hn,hn]],["greatCircleDistanceRads",Qn,[hn,hn]],["cellAreaM2",Dn,[On,Fn,hn]],["cellAreaKm2",Dn,[On,Fn,hn]],["cellAreaRads2",Dn,[On,Fn,hn]],["edgeLengthM",Dn,[On,Fn,hn]],["edgeLengthKm",Dn,[On,Fn,hn]],["edgeLengthRads",Dn,[On,Fn,hn]],["getNumCells",Dn,[qs,hn]],["getRes0Cells",Dn,[hn]],["res0CellCount",Qn],["getPentagons",Dn,[Qn,hn]],["pentagonCount",Qn],["cellToVertex",Dn,[On,Fn,Qn,hn]],["cellToVertexes",Dn,[On,Fn,hn]],["vertexToLatLng",Dn,[On,Fn,hn]],["isValidVertex",tp,[On,Fn]]],Lge=0,Dge=1,Rge=2,Bge=3,dF=4,zge=5,Oge=6,Fge=7,Nge=8,Uge=9,Vge=10,Gge=11,jge=12,$ge=13,Hge=14,Wge=15,Ss={};Ss[Lge]="Success";Ss[Dge]="The operation failed but a more specific error is not available";Ss[Rge]="Argument was outside of acceptable range";Ss[Bge]="Latitude or longitude arguments were outside of acceptable range";Ss[dF]="Resolution argument was outside of acceptable range";Ss[zge]="Cell argument was not valid";Ss[Oge]="Directed edge argument was not valid";Ss[Fge]="Undirected edge argument was not valid";Ss[Nge]="Vertex argument was not valid";Ss[Uge]="Pentagon distortion was encountered";Ss[Vge]="Duplicate input";Ss[Gge]="Cell arguments were not neighbors";Ss[jge]="Cell arguments had incompatible resolutions";Ss[$ge]="Memory allocation failed";Ss[Hge]="Bounds of provided memory were insufficient";Ss[Wge]="Mode or flags argument was not valid";var _S=1e3,Qge=1001,qge=1002,N2={};N2[_S]="Unknown unit";N2[Qge]="Array length out of bounds";N2[qge]="Got unexpected null value for H3 index";var Zge="Unknown error";function pF(t,e,n){var r=n&&"value"in n,i=new Error((t[e]||Zge)+" (code: "+e+(r?", value: "+n.value:"")+")");return i.code=e,i}function gF(t,e){var n=arguments.length===2?{value:e}:{};return pF(Ss,t,n)}function mF(t,e){var n=arguments.length===2?{value:e}:{};return pF(N2,t,n)}function $c(t){if(t!==0)throw gF(t)}var ro={};kge.forEach(function(e){ro[e[0]]=Yi.cwrap.apply(Yi,e)});var l0=16,Yge=4,qh=8,j3=ro.sizeOfH3Index(),Xge=ro.sizeOfLatLng(),Kge=ro.sizeOfCellBoundary();ro.sizeOfGeoPolygon();ro.sizeOfGeoLoop();ro.sizeOfLinkedGeoPolygon();ro.sizeOfCoordIJ();var Ol={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function Jge(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw gF(dF,t);return t}var eme=/[^0-9a-fA-F]/;function U2(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||eme.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),l0),n=parseInt(t.substring(t.length-8),l0);return[n,e]}function C6(t){if(t>=0)return t.toString(l0);t=t&2147483647;var e=yF(8,t.toString(l0)),n=(parseInt(e[0],l0)+8).toString(l0);return e=n+e.substring(1),e}function tme(t,e){return C6(e)+yF(8,C6(t))}function yF(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function nme(t,e){e===void 0&&(e=0);var n=Yi.getValue(t+j3*e,"i32"),r=Yi.getValue(t+j3*e+Yge,"i32");return r?tme(n,r):null}function _F(t,e){return e===void 0&&(e=0),Yi.getValue(t+qh*e,"double")}function rme(t,e){for(var n=[],r=0;r<e;r++){var i=nme(t,r);i!==null&&n.push(i)}return n}function V_(t){return ame(Yi.getValue(t,"double"))}function vF(t){return[V_(t),V_(t+qh)]}function ime(t){return[V_(t+qh),V_(t)]}function sme(t,e,n){for(var r=Yi.getValue(t,"i32"),i=t+qh,s=[],A=e?ime:vF,a=0;a<r*2;a+=2)s.push(A(i+qh*a));return n&&s.push(s[0]),s}function xF(t){var e=Yi._malloc(Xge),n=U2(t),r=n[0],i=n[1];try{return $c(ro.cellToLatLng(r,i,e)),vF(e)}finally{Yi._free(e)}}function ome(t,e){var n=Yi._malloc(Kge),r=U2(t),i=r[0],s=r[1];try{return $c(ro.cellToBoundary(i,s,n)),sme(n,e,e)}finally{Yi._free(n)}}function P6(t){var e=U2(t),n=e[0],r=e[1],i=6,s=Yi._calloc(i,j3);try{return $c(ro.originToDirectedEdges(n,r,s)),rme(s,i)}finally{Yi._free(s)}}function I6(t,e){var n=U2(t),r=n[0],i=n[1],s=Yi._malloc(qh);try{switch(e){case Ol.m:$c(ro.edgeLengthM(r,i,s));break;case Ol.km:$c(ro.edgeLengthKm(r,i,s));break;case Ol.rads:$c(ro.edgeLengthRads(r,i,s));break;default:throw mF(_S,e)}return _F(s)}finally{Yi._free(s)}}function E1(t,e){Jge(t);var n=Yi._malloc(qh);try{switch(e){case Ol.m:$c(ro.getHexagonEdgeLengthAvgM(t,n));break;case Ol.km:$c(ro.getHexagonEdgeLengthAvgKm(t,n));break;default:throw mF(_S,e)}return _F(n)}finally{Yi._free(n)}}function ame(t){return t*180/Math.PI}const lme=CA().domain([0,1]).range(Ite(0,B_.length)),Ame=B_[0];class V2 extends Li{initializeState(){super.initializeState();const{zoom:e}=this.context.viewport,n=Object.keys(this.props.data).map(s=>parseInt(s)),r=rl().domain(this.props.zoomRange).range([0,1]).clamp(!0),i=CA().domain([0,1]).range(n)(r(e));this.setState({hextiles:this.props.data,resRange:n,lastResolution:i,valueInterpResolution:r}),this.createPolygons()}createPolygons(){const{hextiles:e,lastResolution:n}=this.state,r=[],i=e[n],[s,A]=this.props.offset;Object.keys(i).forEach(a=>{const y=i[a],w=I6(P6(a)[0],Ol.km)*.48,[P,I]=xF(a);let L=0;const U=E1(n,Ol.km)/E1(5,Ol.km);for(let[W,q,ae]of this.props.getValue?Ame:[[0,0,0]])r.push({position:[I+(W+s)*w/(111.32*Math.cos(P*Math.PI/180)),P+(q+A)*w/110.574,(typeof this.props.getElevation=="function"?this.props.getElevation({properties:y}):this.props.getElevation)+ae*1e5*U],properties:y,polyIdx:L++,hexID:a})}),this.setState({...this.state,polygons:r})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:A,changeFlags:a,context:y}=e;if(s.getElevation!=A.getElevation||a.viewportChanged){const w=CA().domain([0,1]).range(n)(i(y.viewport.zoom));(w!=r||s.getElevation!=A.getElevation)&&(this.setState({...this.state,lastResolution:w}),this.createPolygons())}}renderLayers(){const{polygons:e,lastResolution:n,resRange:r}=this.state,i=E1(n,Ol.km)/E1(5,Ol.km);return[new S2(this.getSubLayerProps({data:this.props.data,mesh:this.props.mesh,texture:this.props.texture,textureParameters:this.props.textureParameters,getPosition:this.props.getPosition,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,sizeScale:this.props.sizeScale,_useMeshColors:this.props._useMeshColors,_instanced:this.props._instanced,wireframe:this.props.wireframe,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,id:"IconHexTileLayer",data:e,getPosition:s=>s.position,sizeScale:this.props.sizeScale*i,getTranslation:this.props.getValue===null?[0,0,0]:s=>{const A=B_[lme(this.props.getValue(s))][s.polyIdx],a=B_[0][s.polyIdx],y=I6(P6(s.hexID)[0],Ol.m)*.5;return[(A[0]-a[0])*y,(A[1]-a[1])*y,(A[2]-a[2])*1e5*i]}}))]}}V2.layerName="IconHexTileLayer";V2.defaultProps={...Li.defaultProps,...S2.defaultProps,thicknessRange:[.7,.9],getValue:null,getElevation:()=>0,offset:[0,0],zoomRange:[7,9]};function k6(t,e,n=1){const r=n,[i,s]=xF(t);return e.map(a=>{let y=kA(s,a[0],r),w=kA(i,a[1],r);return[y,w]})}function ume(t,[e,n]){let r=ome(t).map(A=>[A[1],A[0]]),i=k6(t,r,n),s=k6(t,r,e);return[i,s]}class Zh extends Li{initializeState(){super.initializeState();const e=Object.keys(this.props.data).map(i=>parseInt(i)),n=rl().domain(this.props.zoomRange).range([0,1]).clamp(!0),r=CA().domain([0,1]).range(e)(n(this.context.viewport.zoom));this.setState({...this.state,resRange:e,lastResolution:r,valueInterpResolution:n}),this.createPolygons()}createPolygons(){const{lastResolution:e}=this.state,n=[],r=this.props.data[e];Object.keys(r).forEach((i,s)=>{let A=r[i];const a=this.props.getValue?rl().domain([0,1]).range([this.props.thicknessRange[1],this.props.thicknessRange[0]])(this.props.getValue({properties:A})):this.props.thicknessRange[0];let y=ume(i,[a,this.props.thicknessRange[1]]);this.props.raised?n.push({polygon:y.map(w=>w.map(([P,I])=>[P,I,typeof this.props.getElevation=="function"?this.props.getElevation({hexId:i,properties:A}):this.props.getElevation])),hexId:i,properties:A}):n.push({hexId:i,polygon:y,properties:A})}),this.setState({...this.state,polygons:n})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:A,changeFlags:a,context:y}=e;if(s.getElevation!=A.getElevation||s.getValue!=A.getValue||a.viewportChanged){const w=CA().domain([0,1]).range(n)(i(y.viewport.zoom));(w!=r||s.getValue!=A.getValue||s.getElevation!=A.getElevation)&&(this.setState({...this.state,lastResolution:w}),this.createPolygons())}}renderLayers(){return[new Zg(this.getSubLayerProps({data:this.props.data,filled:this.props.filled,stroked:this.props.stroked,extruded:this.props.extruded,wireframe:this.props.wireframe,_normalize:this.props._normalize,_windingOrder:this.props._windingOrder,_full3d:this.props._full3d,elevationScale:this.props.elevationScale,getPolygon:this.props.getPolygon,getElevation:this.props.getElevation,getFillColor:this.props.getFillColor,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,id:"SolidHexTileLayer",data:this.state.polygons,getPolygon:e=>e.polygon,pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,extensions:this.props.extensions,getOffset:this.props.getOffset,lineJointRounded:this.props.lineJointRounded}))]}}Zh.layerName="SolidHexTileLayer";Zh.defaultProps={...Li.defaultProps,...Zg.defaultProps,thicknessRange:[.7,.9],getValue:void 0,raised:!1,zoomRange:[7,9]};class vS extends Li{renderLayers(){const{data:e,deagData:n,curOption:r,hoveredHex:i,visible:s,clickedHexes:A,hoveredGeoActive:a,hoveredGeos:y,selectedGeoJSON:w,selectedGeos:P,selectionFinalized:I,zoomRange:L,getFillColor:U}=this.props;return[new Gc({id:"GeoJsonGray",data:n,opacity:.3,stroked:!1,getFillColor:W=>!I&&W.properties.id in y?[100,100,100,205*y[W.properties.id]+50]:[0,0,0,0],visible:s&&!I,updateTriggers:{getFillColor:[i,I]}}),new Gc({id:"GeoJsonColor",data:n,opacity:.3,pickable:!0,visible:s,getLineWidth:W=>W.properties.id in P?W.properties.id==a?100:20:0,getFillColor:W=>{if(W.properties.id in P){if(W.properties.id==a){const q=[0,0,.5019607843137255,.5019607843137255],ae=[...U({properties:P[W.properties.id]}),255];return[(q[0]*q[3]+ae[0]/255*(1-q[3]))*255,(q[1]*q[3]+ae[1]/255*(1-q[3]))*255,(q[2]*q[3]+ae[2]/255*(1-q[3]))*255,(q[3]*q[3]+ae[3]/255*(1-q[3]))*255]}return[...U({properties:P[W.properties.id]}),255]}return[0,0,0,0]},getLineColor:[0,0,0],updateTriggers:{getFillColor:[a,r,I],getLineWidth:[a,r,I]}}),new Zh({id:"HoveringTiles",data:e,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:!I,autoHighlight:!I,visible:s,zoomRange:L})]}}vS.layerName="DeaggregatedLayer";vS.defaultProps={...Li.defaultProps,autoHighlight:!0};const dh=0;class xS extends Li{renderLayers(){const{data:e,curOption:n,speedyCounter:r,clickedHexes:i,selectionFinalized:s,visible:A,zoomRange:a}=this.props;return[new Zh({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:y=>Ja.groundwater.interpVsup(y.properties.Groundwater[r],y.properties.GroundwaterVar[r]),opacity:1,visible:A,updateTriggers:{getFillColor:[r]},zoomRange:a}),new Zh({id:"DiffRings",data:e,thicknessRange:[.4,.65],getFillColor:y=>n==0?Ja.difference.interpVsup(y.properties.UnmetDemand[Js[dh]][r]-y.properties.UnmetDemandBaseline[r],O3(y.properties.UnmetDemandBaselineVar[r],y.properties.UnmetDemandVar[Js[dh]][r]),!0):Ja.difference.interpColor(y.properties.UnmetDemand[Js[dh]][r]-y.properties.UnmetDemandBaseline[r],!0),getValue:y=>n==0?1:Ja.difference.scaleLinearVar(O3(y.properties.UnmetDemandBaselineVar[r],y.properties.UnmetDemandVar[Js[dh]][r]))*.5+.4,raised:!0,visible:A,getElevation:y=>y.hexId in i?5e3:0,getLineWidth:y=>y.hexId in i?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new KT({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r],getElevation:[s],getLineWidth:[s]},zoomRange:a}),new V2({id:"ScenarioUnmet",data:e,loaders:[fF],mesh:"./assets/drop.obj",raised:!0,getColor:y=>[255,130,35,Ja.unmetDemand.scaleLinearVar(y.properties.UnmetDemandVar[Js[dh]][r])*200+55],getValue:y=>Ja.unmetDemand.scaleLinear(y.properties.UnmetDemand[Js[dh]][r]),visible:A,sizeScale:3e3,opacity:1,updateTriggers:{getTranslation:[r]},zoomRange:a}),new vS({...this.props,id:"DeagLayer",data:e,deagData:z_,getFillColor:y=>Ja.unmetDemand.interpColor(y.properties.UnmetDemand[Js[dh]][r],!1,!1)})]}}xS.layerName="MultivariableHextileLayer";xS.defaultProps={...Li.defaultProps,autoHighlight:!0};function cme(){const t=XO(),e=dge({disabled:t.curOption>1,dataDeag:z_,deagKey:"DURgs"}),{getTooltip:n}=pge(t),r={data:YO,...t,...e};return qn.createElement(qn.Fragment,null,qn.createElement(Oee,{controller:!0,effects:[cS],initialViewState:Pde,getTooltip:n},qn.createElement(ute,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:wT,mapStyle:vte}),qn.createElement(gS,{id:"slide-terrain",...r}),qn.createElement(xS,{id:"slide-waters",...r,zoomRange:[7,9],visible:t.curOption==0||t.curOption==1}),qn.createElement(mS,{id:"slide-basic",...r})),qn.createElement(yge,{...r}))}const yw=512,hme=Math.PI/180;function wF({map:t,gl:e,deck:n}){if(t.__deck)return t.__deck;const r=n?.props._customRender,i=n?.props.onLoad,s=EF({...n?.props,_customRender:()=>{t.triggerRepaint(),r?.("")}});let A;return(!n||n.props.gl===e)&&(Object.assign(s,{gl:e,width:null,height:null,touchAction:"unset",viewState:Mg(t)}),n!=null&&n.isInitialized?L6(n,t):s.onLoad=()=>{i?.(),L6(A,t)}),n?(A=n,n.setProps(s),n.userData.isExternal=!0):(A=new Vh(s),t.on("remove",()=>{bF(t)})),A.userData.mapboxLayers=new Set,t.__deck=A,t.on("render",()=>{A.isInitialized&&yme(A,t)}),A}function L6(t,e){const n=()=>{t.isInitialized?_me(t,e):e.off("move",n)};e.on("move",n)}function bF(t){var e;(e=t.__deck)===null||e===void 0||e.finalize(),t.__deck=null}function EF(t){return{...t,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...t.parameters},views:t.views||[new pT({id:"mapbox"})]}}function fme(t,e){t.userData.mapboxLayers.add(e),wS(t)}function dme(t,e){t.userData.mapboxLayers.delete(e),wS(t)}function pme(t,e){wS(t)}function gme(t,e,n){let{currentViewport:r}=t.userData,i=!1;r||(r=TF(t,e,!0),t.userData.currentViewport=r,i=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[r],layerFilter:({layer:s})=>n.id===s.id||s.props.operation.includes("terrain"),clearStack:i,clearCanvas:!1})}function Mg(t){var e;const{lng:n,lat:r}=t.getCenter(),i={longitude:(n+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return(e=t.getTerrain)!==null&&e!==void 0&&e.call(t)&&mme(t,i),i}function mme(t,e){if(t.getFreeCameraOptions){const{position:n}=t.getFreeCameraOptions();if(!n||n.z===void 0)return;const r=t.transform.height,{longitude:i,latitude:s,pitch:A}=e,a=n.x*yw,y=(1-n.y)*yw,w=n.z*yw,P=Yl([i,s]),I=a-P[0],L=y-P[1],U=Math.sqrt(I*I+L*L),W=A*hme,q=1.5*r,ae=W<.001?q*Math.cos(W)/w:q*Math.sin(W)/U;e.zoom=Math.log2(ae);const K=q*Math.cos(W)/ae,ne=w-K;e.position=[0,0,ne/H1(s)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function TF(t,e,n=!0){return new Nu({id:"mapbox",x:0,y:0,width:t.width,height:t.height,...Mg(e),nearZMultiplier:n?.02:.1,nearZ:e.transform._nearZ/e.transform.height,farZ:e.transform._farZ/e.transform.height})}function yme(t,e){const{mapboxLayers:n,isExternal:r}=t.userData;if(r){const i=Array.from(n,P=>P.id),A=Uh(t.props.layers,Boolean).some(P=>P&&!i.includes(P.id));let a=t.getViewports();const y=a.findIndex(P=>P.id==="mapbox"),w=a.length>1||y<0;(A||w)&&(y>=0&&(a=a.slice(),a[y]=TF(t,e,!1)),t._drawLayers("mapbox-repaint",{viewports:a,layerFilter:P=>(!t.props.layerFilter||t.props.layerFilter(P))&&(P.viewport.id!=="mapbox"||!i.includes(P.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function _me(t,e){t.setProps({viewState:Mg(e)}),t.needsRedraw({clearRedrawFlags:!0})}function wS(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(n=>{const r=n.props.type,i=new r(n.props);e.push(i)}),t.setProps({layers:e})}class vme{constructor(e){if(se(this,"id",void 0),se(this,"type",void 0),se(this,"renderingMode",void 0),se(this,"map",void 0),se(this,"deck",void 0),se(this,"props",void 0),!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}onAdd(e,n){this.map=e,this.deck=wF({map:e,gl:n,deck:this.props.deck}),fme(this.deck,this)}onRemove(){this.deck&&dme(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&pme(this.deck)}render(){gme(this.deck,this.map,this)}}const _w="__UNDEFINED__";function T1(t,e,n,r){if(!t||!e||!t.style||!t.style._loaded)return;const i=Uh(r,Boolean);if(n!==r){const a=Uh(n,Boolean),y=new Set(a.map(w=>w.id));for(const w of i)y.delete(w.id);for(const w of y)t.getLayer(w)&&t.removeLayer(w)}for(const a of i){const y=t.getLayer(a.id);y?y.implementation.setProps(a.props):t.addLayer(new vme({id:a.id,deck:e}),a.props.beforeId)}const s=t.style._order,A={};for(const a of i){let{beforeId:y}=a.props;(!y||!s.includes(y))&&(y=_w),A[y]=A[y]||[],A[y].push(a.id)}for(const a in A){const y=A[a];let w=a===_w?s.length:s.indexOf(a),P=a===_w?void 0:a;for(let I=y.length-1;I>=0;I--){const L=y[I],U=s.indexOf(L);U!==w-1&&(t.moveLayer(L,P),U>w&&w++),w--,P=L}}}class xme{constructor(e){se(this,"_props",void 0),se(this,"_deck",void 0),se(this,"_map",void 0),se(this,"_container",void 0),se(this,"_interleaved",void 0),se(this,"_lastMouseDownPoint",void 0),se(this,"_handleStyleChange",()=>{T1(this._map,this._deck,this._props.layers,this._props.layers)}),se(this,"_updateContainerSize",()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:s}=this._map.getContainer();Object.assign(this._container.style,{width:"".concat(i,"px"),height:"".concat(s,"px")})}}),se(this,"_updateViewState",()=>{const i=this._deck;i&&(i.setProps({viewState:Mg(this._map)}),i.isInitialized&&i.redraw())}),se(this,"_handleMouseEvent",i=>{const s=this._deck;if(!s||!s.isInitialized)return;const A={type:i.type,offsetCenter:i.point,srcEvent:i},a=this._lastMouseDownPoint;switch(!i.point&&a&&(A.deltaX=i.originalEvent.clientX-a.clientX,A.deltaY=i.originalEvent.clientY-a.clientY,A.offsetCenter={x:a.x+A.deltaX,y:a.y+A.deltaY}),A.type){case"mousedown":s._onPointerDown(A),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":A.type="panstart",s._onEvent(A);break;case"drag":A.type="panmove",s._onEvent(A);break;case"dragend":A.type="panend",s._onEvent(A);break;case"click":A.tapCount=1,s._onEvent(A);break;case"dblclick":A.type="click",A.tapCount=2,s._onEvent(A);break;case"mousemove":A.type="pointermove",s._onPointerMove(A);break;case"mouseout":A.type="pointerleave",s._onPointerMove(A);break;default:return}});const{interleaved:n=!1,...r}=e;this._interleaved=n,this._props=r}setProps(e){this._interleaved&&e.layers&&T1(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._deck.setProps(this._interleaved?EF(this._props):this._props)}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const n=document.createElement("div");return Object.assign(n.style,{position:"absolute",left:0,top:0,pointerEvents:"none"}),this._container=n,this._deck=new Vh({...this._props,parent:n,viewState:Mg(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),n}_onAddInterleaved(e){return this._deck=wF({map:e,gl:e.painter.context.gl,deck:new Vh({...this._props,gl:e.painter.context.gl})}),e.on("styledata",this._handleStyleChange),T1(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){var n;e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),(n=this._deck)===null||n===void 0||n.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),T1(e,this._deck,this._props.layers,[]),bF(e)}getDefaultPosition(){return"top-left"}pickObject(e){return ki(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return ki(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return ki(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}const wme=dB(()=>Promise.resolve().then(()=>Fee),void 0),bme=(()=>At.forwardRef(function(e,n){return gB(e,n,wme)}))();function Eme(){const t=XO(),{getTooltip:e}=Sme(t);return qn.createElement(bme,{getTooltip:e,id:"mymap",style:{width:1200,height:800},effects:[cS],light:{anchor:"viewport",color:"yellow",intensity:1},antialias:!0,interleaved:!0,initialViewState:Dde,mapLib:wT,mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",preventStyleDiffing:!0},qn.createElement(Tme,{curInput:t}))}function Tme({curInput:t}){const{current:e}=lte();At.useEffect(()=>{if(!e)return;const n={data:Ode,...t};e.on("load",()=>{const r=new xme({interleaved:!0,effects:[cS],layers:[new dg({id:"carto",data:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:i=>{const{bbox:{west:s,south:A,east:a,north:y}}=i.tile;return new lg(i,{data:null,image:i.data,bounds:[s,A,a,y]})},beforeId:"waterway"}),new dg({id:"supply",data:"http://infovis.cs.ucdavis.edu/mapProxy/wmts/fbfm40/webmercator/{z}/{x}/{y}.png",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:i=>{const{bbox:{west:s,south:A,east:a,north:y}}=i.tile;if(-(s- -119.94742725262628)<y-37.90192590898632)return new lg(i,{data:null,image:i.data,bounds:[s,A,a,y]})},beforeId:"waterway"}),new Zg({id:"ground",data:[[[-120.99582643167989,36.88453894208306],[-120.99582643167989,38.88453894208306],[-118.99582643167989,38.88453894208306],[-118.99582643167989,36.88453894208306]]],stroked:!1,getPolygon:i=>i,getFillColor:[0,0,0,0],getPolygonOffset:({layerIndex:i})=>[0,i*1e3],beforeId:"background"}),new bS({id:"slide-fire",...n,visible:t.curOption==0||t.curOption==1,zoomRange:[9,14]})]});e.getMap().addControl(r).setLight({anchor:"viewport",color:"yellow",intensity:1})})},[])}class bS extends Li{renderLayers(){const{data:e,visible:n,zoomRange:r}=this.props;return[new Zh({id:"DiffRings",data:e,thicknessRange:[0,1],getFillColor:i=>ep.power.interpColor(i.properties.power,!1,!1),extruded:!0,getElevation:i=>3e3*Math.pow(ep.power.scaleLinearVar(i.properties.confidence),4),stroked:!1,getValue:i=>ep.power.scaleLinearVar(i.properties.confidence),visible:n,zoomRange:r}),new V2({id:"ScenarioUnmet",raised:!0,getElevation:i=>3e3*Math.pow(ep.power.scaleLinearVar(i.properties.confidence),4),data:e,loaders:[fF],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",getColor:[0,188,242],getValue:i=>ep.personnel.scaleLinear(i.properties.personnel),visible:n,sizeScale:400,zoomRange:r}),new ES({...this.props,id:"DeagLayer",data:e})]}}bS.layerName="WildfireLayer";bS.defaultProps={...Li.defaultProps,autoHighlight:!0};class ES extends Li{renderLayers(){const{data:e,visible:n,zoomRange:r,selectionFinalized:i=!1}=this.props;return[new Zh({id:"HoveringTiles",data:e,stroked:!1,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:!i,autoHighlight:!i,visible:n,zoomRange:r})]}}ES.layerName="DeaggregatedLayer";ES.defaultProps={...Li.defaultProps,autoHighlight:!0};function Sme({speedyCounter:t,curOption:e}){const n=At.useRef(),r=At.useRef(),i=At.useRef({});At.useEffect(()=>{n.current=document.querySelector("#main-tooltip"),r.current=document.querySelector("#secondary-tooltip")},[]);const s=At.useCallback(a=>{const y=a.properties.power,w=a.properties.confidence,P=a.properties.personnel;r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`      <div><b>Power</b> ${y}</div>
      <div><b>Confidence</b> ${w}</div>
      <div><b>Personnel</b> ${P}</div>
      `},[t]);return{getTooltip:At.useCallback(({object:a})=>{if(!a){r.current.classList.remove("active"),n.current.classList.remove("active");return}s(a),i.current=a},[t,e])}}function Mme(t){$L(t).render(qn.createElement(xV,null,qn.createElement(yV,null,qn.createElement(db,{path:"/",element:qn.createElement(cme,null)}),qn.createElement(db,{path:"fire",element:qn.createElement(Eme,null)}))))}Mme(document.getElementById("app"));
