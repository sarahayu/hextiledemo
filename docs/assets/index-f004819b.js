function eT(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var q9=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Z2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Z9(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var nL={exports:{}},yr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tm=Symbol.for("react.element"),Y9=Symbol.for("react.portal"),X9=Symbol.for("react.fragment"),K9=Symbol.for("react.strict_mode"),J9=Symbol.for("react.profiler"),eU=Symbol.for("react.provider"),tU=Symbol.for("react.context"),nU=Symbol.for("react.forward_ref"),rU=Symbol.for("react.suspense"),iU=Symbol.for("react.memo"),sU=Symbol.for("react.lazy"),dC=Symbol.iterator;function oU(t){return t===null||typeof t!="object"?null:(t=dC&&t[dC]||t["@@iterator"],typeof t=="function"?t:null)}var rL={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},iL=Object.assign,sL={};function Ud(t,e,n){this.props=t,this.context=e,this.refs=sL,this.updater=n||rL}Ud.prototype.isReactComponent={};Ud.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ud.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function oL(){}oL.prototype=Ud.prototype;function tT(t,e,n){this.props=t,this.context=e,this.refs=sL,this.updater=n||rL}var nT=tT.prototype=new oL;nT.constructor=tT;iL(nT,Ud.prototype);nT.isPureReactComponent=!0;var pC=Array.isArray,aL=Object.prototype.hasOwnProperty,rT={current:null},lL={key:!0,ref:!0,__self:!0,__source:!0};function AL(t,e,n){var r,i={},s=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(s=""+e.key),e)aL.call(e,r)&&!lL.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var p=Array(o),_=0;_<o;_++)p[_]=arguments[_+2];i.children=p}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:Tm,type:t,key:s,ref:l,props:i,_owner:rT.current}}function aU(t,e){return{$$typeof:Tm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function iT(t){return typeof t=="object"&&t!==null&&t.$$typeof===Tm}function lU(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var gC=/\/+/g;function Bx(t,e){return typeof t=="object"&&t!==null&&t.key!=null?lU(""+t.key):e.toString(36)}function Sy(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case Tm:case Y9:l=!0}}if(l)return l=t,i=i(l),t=r===""?"."+Bx(l,0):r,pC(i)?(n="",t!=null&&(n=t.replace(gC,"$&/")+"/"),Sy(i,e,n,"",function(_){return _})):i!=null&&(iT(i)&&(i=aU(i,n+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(gC,"$&/")+"/")+t)),e.push(i)),1;if(l=0,r=r===""?".":r+":",pC(t))for(var o=0;o<t.length;o++){s=t[o];var p=r+Bx(s,o);l+=Sy(s,e,n,p,i)}else if(p=oU(t),typeof p=="function")for(t=p.call(t),o=0;!(s=t.next()).done;)s=s.value,p=r+Bx(s,o++),l+=Sy(s,e,n,p,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function w1(t,e,n){if(t==null)return t;var r=[],i=0;return Sy(t,r,"","",function(s){return e.call(n,s,i++)}),r}function AU(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var $o={current:null},Cy={transition:null},uU={ReactCurrentDispatcher:$o,ReactCurrentBatchConfig:Cy,ReactCurrentOwner:rT};yr.Children={map:w1,forEach:function(t,e,n){w1(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return w1(t,function(){e++}),e},toArray:function(t){return w1(t,function(e){return e})||[]},only:function(t){if(!iT(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};yr.Component=Ud;yr.Fragment=X9;yr.Profiler=J9;yr.PureComponent=tT;yr.StrictMode=K9;yr.Suspense=rU;yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uU;yr.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=iL({},t.props),i=t.key,s=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,l=rT.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(p in e)aL.call(e,p)&&!lL.hasOwnProperty(p)&&(r[p]=e[p]===void 0&&o!==void 0?o[p]:e[p])}var p=arguments.length-2;if(p===1)r.children=n;else if(1<p){o=Array(p);for(var _=0;_<p;_++)o[_]=arguments[_+2];r.children=o}return{$$typeof:Tm,type:t.type,key:i,ref:s,props:r,_owner:l}};yr.createContext=function(t){return t={$$typeof:tU,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:eU,_context:t},t.Consumer=t};yr.createElement=AL;yr.createFactory=function(t){var e=AL.bind(null,t);return e.type=t,e};yr.createRef=function(){return{current:null}};yr.forwardRef=function(t){return{$$typeof:nU,render:t}};yr.isValidElement=iT;yr.lazy=function(t){return{$$typeof:sU,_payload:{_status:-1,_result:t},_init:AU}};yr.memo=function(t,e){return{$$typeof:iU,type:t,compare:e===void 0?null:e}};yr.startTransition=function(t){var e=Cy.transition;Cy.transition={};try{t()}finally{Cy.transition=e}};yr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};yr.useCallback=function(t,e){return $o.current.useCallback(t,e)};yr.useContext=function(t){return $o.current.useContext(t)};yr.useDebugValue=function(){};yr.useDeferredValue=function(t){return $o.current.useDeferredValue(t)};yr.useEffect=function(t,e){return $o.current.useEffect(t,e)};yr.useId=function(){return $o.current.useId()};yr.useImperativeHandle=function(t,e,n){return $o.current.useImperativeHandle(t,e,n)};yr.useInsertionEffect=function(t,e){return $o.current.useInsertionEffect(t,e)};yr.useLayoutEffect=function(t,e){return $o.current.useLayoutEffect(t,e)};yr.useMemo=function(t,e){return $o.current.useMemo(t,e)};yr.useReducer=function(t,e,n){return $o.current.useReducer(t,e,n)};yr.useRef=function(t){return $o.current.useRef(t)};yr.useState=function(t){return $o.current.useState(t)};yr.useSyncExternalStore=function(t,e,n){return $o.current.useSyncExternalStore(t,e,n)};yr.useTransition=function(){return $o.current.useTransition()};yr.version="18.2.0";nL.exports=yr;var De=nL.exports;const Ye=Z2(De),cU=eT({__proto__:null,default:Ye},[De]);var uL={exports:{}},Ha={},cL={exports:{}},hL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_t,Tt){var Jt=_t.length;_t.push(Tt);e:for(;0<Jt;){var Ln=Jt-1>>>1,Tn=_t[Ln];if(0<i(Tn,Tt))_t[Ln]=Tt,_t[Jt]=Tn,Jt=Ln;else break e}}function n(_t){return _t.length===0?null:_t[0]}function r(_t){if(_t.length===0)return null;var Tt=_t[0],Jt=_t.pop();if(Jt!==Tt){_t[0]=Jt;e:for(var Ln=0,Tn=_t.length,Ir=Tn>>>1;Ln<Ir;){var tr=2*(Ln+1)-1,ar=_t[tr],pr=tr+1,Gn=_t[pr];if(0>i(ar,Jt))pr<Tn&&0>i(Gn,ar)?(_t[Ln]=Gn,_t[pr]=Jt,Ln=pr):(_t[Ln]=ar,_t[tr]=Jt,Ln=tr);else if(pr<Tn&&0>i(Gn,Jt))_t[Ln]=Gn,_t[pr]=Jt,Ln=pr;else break e}}return Tt}function i(_t,Tt){var Jt=_t.sortIndex-Tt.sortIndex;return Jt!==0?Jt:_t.id-Tt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var p=[],_=[],C=1,M=null,k=3,F=!1,j=!1,H=!1,ie=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,J=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(_t){for(var Tt=n(_);Tt!==null;){if(Tt.callback===null)r(_);else if(Tt.startTime<=_t)r(_),Tt.sortIndex=Tt.expirationTime,e(p,Tt);else break;Tt=n(_)}}function he(_t){if(H=!1,se(_t),!j)if(n(p)!==null)j=!0,Et(pe);else{var Tt=n(_);Tt!==null&&un(he,Tt.startTime-_t)}}function pe(_t,Tt){j=!1,H&&(H=!1,Y(We),We=-1),F=!0;var Jt=k;try{for(se(Tt),M=n(p);M!==null&&(!(M.expirationTime>Tt)||_t&&!Oe());){var Ln=M.callback;if(typeof Ln=="function"){M.callback=null,k=M.priorityLevel;var Tn=Ln(M.expirationTime<=Tt);Tt=t.unstable_now(),typeof Tn=="function"?M.callback=Tn:M===n(p)&&r(p),se(Tt)}else r(p);M=n(p)}if(M!==null)var Ir=!0;else{var tr=n(_);tr!==null&&un(he,tr.startTime-Tt),Ir=!1}return Ir}finally{M=null,k=Jt,F=!1}}var be=!1,Ge=null,We=-1,Xe=5,rt=-1;function Oe(){return!(t.unstable_now()-rt<Xe)}function nt(){if(Ge!==null){var _t=t.unstable_now();rt=_t;var Tt=!0;try{Tt=Ge(!0,_t)}finally{Tt?Ze():(be=!1,Ge=null)}}else be=!1}var Ze;if(typeof J=="function")Ze=function(){J(nt)};else if(typeof MessageChannel<"u"){var pt=new MessageChannel,Yt=pt.port2;pt.port1.onmessage=nt,Ze=function(){Yt.postMessage(null)}}else Ze=function(){ie(nt,0)};function Et(_t){Ge=_t,be||(be=!0,Ze())}function un(_t,Tt){We=ie(function(){_t(t.unstable_now())},Tt)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_t){_t.callback=null},t.unstable_continueExecution=function(){j||F||(j=!0,Et(pe))},t.unstable_forceFrameRate=function(_t){0>_t||125<_t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Xe=0<_t?Math.floor(1e3/_t):5},t.unstable_getCurrentPriorityLevel=function(){return k},t.unstable_getFirstCallbackNode=function(){return n(p)},t.unstable_next=function(_t){switch(k){case 1:case 2:case 3:var Tt=3;break;default:Tt=k}var Jt=k;k=Tt;try{return _t()}finally{k=Jt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_t,Tt){switch(_t){case 1:case 2:case 3:case 4:case 5:break;default:_t=3}var Jt=k;k=_t;try{return Tt()}finally{k=Jt}},t.unstable_scheduleCallback=function(_t,Tt,Jt){var Ln=t.unstable_now();switch(typeof Jt=="object"&&Jt!==null?(Jt=Jt.delay,Jt=typeof Jt=="number"&&0<Jt?Ln+Jt:Ln):Jt=Ln,_t){case 1:var Tn=-1;break;case 2:Tn=250;break;case 5:Tn=1073741823;break;case 4:Tn=1e4;break;default:Tn=5e3}return Tn=Jt+Tn,_t={id:C++,callback:Tt,priorityLevel:_t,startTime:Jt,expirationTime:Tn,sortIndex:-1},Jt>Ln?(_t.sortIndex=Jt,e(_,_t),n(p)===null&&_t===n(_)&&(H?(Y(We),We=-1):H=!0,un(he,Jt-Ln))):(_t.sortIndex=Tn,e(p,_t),j||F||(j=!0,Et(pe))),_t},t.unstable_shouldYield=Oe,t.unstable_wrapCallback=function(_t){var Tt=k;return function(){var Jt=k;k=Tt;try{return _t.apply(this,arguments)}finally{k=Jt}}}})(hL);cL.exports=hL;var hU=cL.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fL=De,ja=hU;function Bt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dL=new Set,Lg={};function Lf(t,e){dd(t,e),dd(t+"Capture",e)}function dd(t,e){for(Lg[t]=e,t=0;t<e.length;t++)dL.add(e[t])}var rc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ib=Object.prototype.hasOwnProperty,fU=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mC={},yC={};function dU(t){return Ib.call(yC,t)?!0:Ib.call(mC,t)?!1:fU.test(t)?yC[t]=!0:(mC[t]=!0,!1)}function pU(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function gU(t,e,n,r){if(e===null||typeof e>"u"||pU(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function jo(t,e,n,r,i,s,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=l}var Ns={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ns[t]=new jo(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ns[e]=new jo(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ns[t]=new jo(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ns[t]=new jo(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ns[t]=new jo(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ns[t]=new jo(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ns[t]=new jo(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ns[t]=new jo(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ns[t]=new jo(t,5,!1,t.toLowerCase(),null,!1,!1)});var sT=/[\-:]([a-z])/g;function oT(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(sT,oT);Ns[e]=new jo(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(sT,oT);Ns[e]=new jo(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(sT,oT);Ns[e]=new jo(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ns[t]=new jo(t,1,!1,t.toLowerCase(),null,!1,!1)});Ns.xlinkHref=new jo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ns[t]=new jo(t,1,!1,t.toLowerCase(),null,!0,!0)});function aT(t,e,n,r){var i=Ns.hasOwnProperty(e)?Ns[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(gU(e,n,i,r)&&(n=null),r||i===null?dU(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var mc=fL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b1=Symbol.for("react.element"),b0=Symbol.for("react.portal"),E0=Symbol.for("react.fragment"),lT=Symbol.for("react.strict_mode"),Lb=Symbol.for("react.profiler"),pL=Symbol.for("react.provider"),gL=Symbol.for("react.context"),AT=Symbol.for("react.forward_ref"),Db=Symbol.for("react.suspense"),Rb=Symbol.for("react.suspense_list"),uT=Symbol.for("react.memo"),Qc=Symbol.for("react.lazy"),mL=Symbol.for("react.offscreen"),_C=Symbol.iterator;function vp(t){return t===null||typeof t!="object"?null:(t=_C&&t[_C]||t["@@iterator"],typeof t=="function"?t:null)}var bi=Object.assign,zx;function Xp(t){if(zx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);zx=e&&e[1]||""}return`
`+zx+t}var Ox=!1;function Fx(t,e){if(!t||Ox)return"";Ox=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(_){var r=_}Reflect.construct(t,[],e)}else{try{e.call()}catch(_){r=_}t.call(e.prototype)}else{try{throw Error()}catch(_){r=_}t()}}catch(_){if(_&&r&&typeof _.stack=="string"){for(var i=_.stack.split(`
`),s=r.stack.split(`
`),l=i.length-1,o=s.length-1;1<=l&&0<=o&&i[l]!==s[o];)o--;for(;1<=l&&0<=o;l--,o--)if(i[l]!==s[o]){if(l!==1||o!==1)do if(l--,o--,0>o||i[l]!==s[o]){var p=`
`+i[l].replace(" at new "," at ");return t.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",t.displayName)),p}while(1<=l&&0<=o);break}}}finally{Ox=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xp(t):""}function mU(t){switch(t.tag){case 5:return Xp(t.type);case 16:return Xp("Lazy");case 13:return Xp("Suspense");case 19:return Xp("SuspenseList");case 0:case 2:case 15:return t=Fx(t.type,!1),t;case 11:return t=Fx(t.type.render,!1),t;case 1:return t=Fx(t.type,!0),t;default:return""}}function Bb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case E0:return"Fragment";case b0:return"Portal";case Lb:return"Profiler";case lT:return"StrictMode";case Db:return"Suspense";case Rb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case gL:return(t.displayName||"Context")+".Consumer";case pL:return(t._context.displayName||"Context")+".Provider";case AT:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case uT:return e=t.displayName||null,e!==null?e:Bb(t.type)||"Memo";case Qc:e=t._payload,t=t._init;try{return Bb(t(e))}catch{}}return null}function yU(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bb(e);case 8:return e===lT?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function yh(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function yL(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _U(t){var e=yL(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(l){r=""+l,s.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function E1(t){t._valueTracker||(t._valueTracker=_U(t))}function _L(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=yL(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function c_(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function zb(t,e){var n=e.checked;return bi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function vC(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=yh(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vL(t,e){e=e.checked,e!=null&&aT(t,"checked",e,!1)}function Ob(t,e){vL(t,e);var n=yh(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Fb(t,e.type,n):e.hasOwnProperty("defaultValue")&&Fb(t,e.type,yh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function xC(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Fb(t,e,n){(e!=="number"||c_(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Kp=Array.isArray;function X0(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+yh(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Nb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Bt(91));return bi({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wC(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Bt(92));if(Kp(n)){if(1<n.length)throw Error(Bt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:yh(n)}}function xL(t,e){var n=yh(e.value),r=yh(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function bC(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function wL(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ub(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?wL(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var T1,bL=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(T1=T1||document.createElement("div"),T1.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=T1.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Dg(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var hg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vU=["Webkit","ms","Moz","O"];Object.keys(hg).forEach(function(t){vU.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),hg[e]=hg[t]})});function EL(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||hg.hasOwnProperty(t)&&hg[t]?(""+e).trim():e+"px"}function TL(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=EL(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var xU=bi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vb(t,e){if(e){if(xU[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Bt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Bt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Bt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Bt(62))}}function Gb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $b=null;function cT(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var jb=null,K0=null,J0=null;function EC(t){if(t=Mm(t)){if(typeof jb!="function")throw Error(Bt(280));var e=t.stateNode;e&&(e=ev(e),jb(t.stateNode,t.type,e))}}function SL(t){K0?J0?J0.push(t):J0=[t]:K0=t}function CL(){if(K0){var t=K0,e=J0;if(J0=K0=null,EC(t),e)for(t=0;t<e.length;t++)EC(e[t])}}function ML(t,e){return t(e)}function PL(){}var Nx=!1;function kL(t,e,n){if(Nx)return t(e,n);Nx=!0;try{return ML(t,e,n)}finally{Nx=!1,(K0!==null||J0!==null)&&(PL(),CL())}}function Rg(t,e){var n=t.stateNode;if(n===null)return null;var r=ev(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Bt(231,e,typeof n));return n}var Hb=!1;if(rc)try{var xp={};Object.defineProperty(xp,"passive",{get:function(){Hb=!0}}),window.addEventListener("test",xp,xp),window.removeEventListener("test",xp,xp)}catch{Hb=!1}function wU(t,e,n,r,i,s,l,o,p){var _=Array.prototype.slice.call(arguments,3);try{e.apply(n,_)}catch(C){this.onError(C)}}var fg=!1,h_=null,f_=!1,Wb=null,bU={onError:function(t){fg=!0,h_=t}};function EU(t,e,n,r,i,s,l,o,p){fg=!1,h_=null,wU.apply(bU,arguments)}function TU(t,e,n,r,i,s,l,o,p){if(EU.apply(this,arguments),fg){if(fg){var _=h_;fg=!1,h_=null}else throw Error(Bt(198));f_||(f_=!0,Wb=_)}}function Df(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function IL(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function TC(t){if(Df(t)!==t)throw Error(Bt(188))}function SU(t){var e=t.alternate;if(!e){if(e=Df(t),e===null)throw Error(Bt(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return TC(i),t;if(s===r)return TC(i),e;s=s.sibling}throw Error(Bt(188))}if(n.return!==r.return)n=i,r=s;else{for(var l=!1,o=i.child;o;){if(o===n){l=!0,n=i,r=s;break}if(o===r){l=!0,r=i,n=s;break}o=o.sibling}if(!l){for(o=s.child;o;){if(o===n){l=!0,n=s,r=i;break}if(o===r){l=!0,r=s,n=i;break}o=o.sibling}if(!l)throw Error(Bt(189))}}if(n.alternate!==r)throw Error(Bt(190))}if(n.tag!==3)throw Error(Bt(188));return n.stateNode.current===n?t:e}function LL(t){return t=SU(t),t!==null?DL(t):null}function DL(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=DL(t);if(e!==null)return e;t=t.sibling}return null}var RL=ja.unstable_scheduleCallback,SC=ja.unstable_cancelCallback,CU=ja.unstable_shouldYield,MU=ja.unstable_requestPaint,Ni=ja.unstable_now,PU=ja.unstable_getCurrentPriorityLevel,hT=ja.unstable_ImmediatePriority,BL=ja.unstable_UserBlockingPriority,d_=ja.unstable_NormalPriority,kU=ja.unstable_LowPriority,zL=ja.unstable_IdlePriority,Y2=null,KA=null;function IU(t){if(KA&&typeof KA.onCommitFiberRoot=="function")try{KA.onCommitFiberRoot(Y2,t,void 0,(t.current.flags&128)===128)}catch{}}var cA=Math.clz32?Math.clz32:RU,LU=Math.log,DU=Math.LN2;function RU(t){return t>>>=0,t===0?32:31-(LU(t)/DU|0)|0}var S1=64,C1=4194304;function Jp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function p_(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,l=n&268435455;if(l!==0){var o=l&~i;o!==0?r=Jp(o):(s&=l,s!==0&&(r=Jp(s)))}else l=n&~i,l!==0?r=Jp(l):s!==0&&(r=Jp(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-cA(e),i=1<<n,r|=t[n],e&=~i;return r}function BU(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zU(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var l=31-cA(s),o=1<<l,p=i[l];p===-1?(!(o&n)||o&r)&&(i[l]=BU(o,e)):p<=e&&(t.expiredLanes|=o),s&=~o}}function Qb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function OL(){var t=S1;return S1<<=1,!(S1&4194240)&&(S1=64),t}function Ux(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Sm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-cA(e),t[e]=n}function OU(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-cA(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function fT(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-cA(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Or=0;function FL(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var NL,dT,UL,VL,GL,qb=!1,M1=[],oh=null,ah=null,lh=null,Bg=new Map,zg=new Map,Yc=[],FU="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function CC(t,e){switch(t){case"focusin":case"focusout":oh=null;break;case"dragenter":case"dragleave":ah=null;break;case"mouseover":case"mouseout":lh=null;break;case"pointerover":case"pointerout":Bg.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":zg.delete(e.pointerId)}}function wp(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Mm(e),e!==null&&dT(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function NU(t,e,n,r,i){switch(e){case"focusin":return oh=wp(oh,t,e,n,r,i),!0;case"dragenter":return ah=wp(ah,t,e,n,r,i),!0;case"mouseover":return lh=wp(lh,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Bg.set(s,wp(Bg.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,zg.set(s,wp(zg.get(s)||null,t,e,n,r,i)),!0}return!1}function $L(t){var e=tf(t.target);if(e!==null){var n=Df(e);if(n!==null){if(e=n.tag,e===13){if(e=IL(n),e!==null){t.blockedOn=e,GL(t.priority,function(){UL(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function My(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Zb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);$b=r,n.target.dispatchEvent(r),$b=null}else return e=Mm(n),e!==null&&dT(e),t.blockedOn=n,!1;e.shift()}return!0}function MC(t,e,n){My(t)&&n.delete(e)}function UU(){qb=!1,oh!==null&&My(oh)&&(oh=null),ah!==null&&My(ah)&&(ah=null),lh!==null&&My(lh)&&(lh=null),Bg.forEach(MC),zg.forEach(MC)}function bp(t,e){t.blockedOn===e&&(t.blockedOn=null,qb||(qb=!0,ja.unstable_scheduleCallback(ja.unstable_NormalPriority,UU)))}function Og(t){function e(i){return bp(i,t)}if(0<M1.length){bp(M1[0],t);for(var n=1;n<M1.length;n++){var r=M1[n];r.blockedOn===t&&(r.blockedOn=null)}}for(oh!==null&&bp(oh,t),ah!==null&&bp(ah,t),lh!==null&&bp(lh,t),Bg.forEach(e),zg.forEach(e),n=0;n<Yc.length;n++)r=Yc[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Yc.length&&(n=Yc[0],n.blockedOn===null);)$L(n),n.blockedOn===null&&Yc.shift()}var ed=mc.ReactCurrentBatchConfig,g_=!0;function VU(t,e,n,r){var i=Or,s=ed.transition;ed.transition=null;try{Or=1,pT(t,e,n,r)}finally{Or=i,ed.transition=s}}function GU(t,e,n,r){var i=Or,s=ed.transition;ed.transition=null;try{Or=4,pT(t,e,n,r)}finally{Or=i,ed.transition=s}}function pT(t,e,n,r){if(g_){var i=Zb(t,e,n,r);if(i===null)Yx(t,e,r,m_,n),CC(t,r);else if(NU(i,t,e,n,r))r.stopPropagation();else if(CC(t,r),e&4&&-1<FU.indexOf(t)){for(;i!==null;){var s=Mm(i);if(s!==null&&NL(s),s=Zb(t,e,n,r),s===null&&Yx(t,e,r,m_,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Yx(t,e,r,null,n)}}var m_=null;function Zb(t,e,n,r){if(m_=null,t=cT(r),t=tf(t),t!==null)if(e=Df(t),e===null)t=null;else if(n=e.tag,n===13){if(t=IL(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return m_=t,null}function jL(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(PU()){case hT:return 1;case BL:return 4;case d_:case kU:return 16;case zL:return 536870912;default:return 16}default:return 16}}var Jc=null,gT=null,Py=null;function HL(){if(Py)return Py;var t,e=gT,n=e.length,r,i="value"in Jc?Jc.value:Jc.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var l=n-t;for(r=1;r<=l&&e[n-r]===i[s-r];r++);return Py=i.slice(t,1<r?1-r:void 0)}function ky(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function P1(){return!0}function PC(){return!1}function Wa(t){function e(n,r,i,s,l){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?P1:PC,this.isPropagationStopped=PC,this}return bi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=P1)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=P1)},persist:function(){},isPersistent:P1}),e}var Vd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mT=Wa(Vd),Cm=bi({},Vd,{view:0,detail:0}),$U=Wa(Cm),Vx,Gx,Ep,X2=bi({},Cm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yT,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ep&&(Ep&&t.type==="mousemove"?(Vx=t.screenX-Ep.screenX,Gx=t.screenY-Ep.screenY):Gx=Vx=0,Ep=t),Vx)},movementY:function(t){return"movementY"in t?t.movementY:Gx}}),kC=Wa(X2),jU=bi({},X2,{dataTransfer:0}),HU=Wa(jU),WU=bi({},Cm,{relatedTarget:0}),$x=Wa(WU),QU=bi({},Vd,{animationName:0,elapsedTime:0,pseudoElement:0}),qU=Wa(QU),ZU=bi({},Vd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),YU=Wa(ZU),XU=bi({},Vd,{data:0}),IC=Wa(XU),KU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},JU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eV={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tV(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=eV[t])?!!e[t]:!1}function yT(){return tV}var nV=bi({},Cm,{key:function(t){if(t.key){var e=KU[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ky(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?JU[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yT,charCode:function(t){return t.type==="keypress"?ky(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ky(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),rV=Wa(nV),iV=bi({},X2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),LC=Wa(iV),sV=bi({},Cm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yT}),oV=Wa(sV),aV=bi({},Vd,{propertyName:0,elapsedTime:0,pseudoElement:0}),lV=Wa(aV),AV=bi({},X2,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),uV=Wa(AV),cV=[9,13,27,32],_T=rc&&"CompositionEvent"in window,dg=null;rc&&"documentMode"in document&&(dg=document.documentMode);var hV=rc&&"TextEvent"in window&&!dg,WL=rc&&(!_T||dg&&8<dg&&11>=dg),DC=String.fromCharCode(32),RC=!1;function QL(t,e){switch(t){case"keyup":return cV.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qL(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var T0=!1;function fV(t,e){switch(t){case"compositionend":return qL(e);case"keypress":return e.which!==32?null:(RC=!0,DC);case"textInput":return t=e.data,t===DC&&RC?null:t;default:return null}}function dV(t,e){if(T0)return t==="compositionend"||!_T&&QL(t,e)?(t=HL(),Py=gT=Jc=null,T0=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return WL&&e.locale!=="ko"?null:e.data;default:return null}}var pV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function BC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!pV[t.type]:e==="textarea"}function ZL(t,e,n,r){SL(r),e=y_(e,"onChange"),0<e.length&&(n=new mT("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var pg=null,Fg=null;function gV(t){oD(t,0)}function K2(t){var e=M0(t);if(_L(e))return t}function mV(t,e){if(t==="change")return e}var YL=!1;if(rc){var jx;if(rc){var Hx="oninput"in document;if(!Hx){var zC=document.createElement("div");zC.setAttribute("oninput","return;"),Hx=typeof zC.oninput=="function"}jx=Hx}else jx=!1;YL=jx&&(!document.documentMode||9<document.documentMode)}function OC(){pg&&(pg.detachEvent("onpropertychange",XL),Fg=pg=null)}function XL(t){if(t.propertyName==="value"&&K2(Fg)){var e=[];ZL(e,Fg,t,cT(t)),kL(gV,e)}}function yV(t,e,n){t==="focusin"?(OC(),pg=e,Fg=n,pg.attachEvent("onpropertychange",XL)):t==="focusout"&&OC()}function _V(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return K2(Fg)}function vV(t,e){if(t==="click")return K2(e)}function xV(t,e){if(t==="input"||t==="change")return K2(e)}function wV(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dA=typeof Object.is=="function"?Object.is:wV;function Ng(t,e){if(dA(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Ib.call(e,i)||!dA(t[i],e[i]))return!1}return!0}function FC(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function NC(t,e){var n=FC(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=FC(n)}}function KL(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?KL(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function JL(){for(var t=window,e=c_();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=c_(t.document)}return e}function vT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function bV(t){var e=JL(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&KL(n.ownerDocument.documentElement,n)){if(r!==null&&vT(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=NC(n,s);var l=NC(n,r);i&&l&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var EV=rc&&"documentMode"in document&&11>=document.documentMode,S0=null,Yb=null,gg=null,Xb=!1;function UC(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Xb||S0==null||S0!==c_(r)||(r=S0,"selectionStart"in r&&vT(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),gg&&Ng(gg,r)||(gg=r,r=y_(Yb,"onSelect"),0<r.length&&(e=new mT("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=S0)))}function k1(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var C0={animationend:k1("Animation","AnimationEnd"),animationiteration:k1("Animation","AnimationIteration"),animationstart:k1("Animation","AnimationStart"),transitionend:k1("Transition","TransitionEnd")},Wx={},eD={};rc&&(eD=document.createElement("div").style,"AnimationEvent"in window||(delete C0.animationend.animation,delete C0.animationiteration.animation,delete C0.animationstart.animation),"TransitionEvent"in window||delete C0.transitionend.transition);function J2(t){if(Wx[t])return Wx[t];if(!C0[t])return t;var e=C0[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in eD)return Wx[t]=e[n];return t}var tD=J2("animationend"),nD=J2("animationiteration"),rD=J2("animationstart"),iD=J2("transitionend"),sD=new Map,VC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ph(t,e){sD.set(t,e),Lf(e,[t])}for(var Qx=0;Qx<VC.length;Qx++){var qx=VC[Qx],TV=qx.toLowerCase(),SV=qx[0].toUpperCase()+qx.slice(1);Ph(TV,"on"+SV)}Ph(tD,"onAnimationEnd");Ph(nD,"onAnimationIteration");Ph(rD,"onAnimationStart");Ph("dblclick","onDoubleClick");Ph("focusin","onFocus");Ph("focusout","onBlur");Ph(iD,"onTransitionEnd");dd("onMouseEnter",["mouseout","mouseover"]);dd("onMouseLeave",["mouseout","mouseover"]);dd("onPointerEnter",["pointerout","pointerover"]);dd("onPointerLeave",["pointerout","pointerover"]);Lf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Lf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Lf("onBeforeInput",["compositionend","keypress","textInput","paste"]);Lf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Lf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Lf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var eg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CV=new Set("cancel close invalid load scroll toggle".split(" ").concat(eg));function GC(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,TU(r,e,void 0,t),t.currentTarget=null}function oD(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var l=r.length-1;0<=l;l--){var o=r[l],p=o.instance,_=o.currentTarget;if(o=o.listener,p!==s&&i.isPropagationStopped())break e;GC(i,o,_),s=p}else for(l=0;l<r.length;l++){if(o=r[l],p=o.instance,_=o.currentTarget,o=o.listener,p!==s&&i.isPropagationStopped())break e;GC(i,o,_),s=p}}}if(f_)throw t=Wb,f_=!1,Wb=null,t}function li(t,e){var n=e[n3];n===void 0&&(n=e[n3]=new Set);var r=t+"__bubble";n.has(r)||(aD(e,t,2,!1),n.add(r))}function Zx(t,e,n){var r=0;e&&(r|=4),aD(n,t,r,e)}var I1="_reactListening"+Math.random().toString(36).slice(2);function Ug(t){if(!t[I1]){t[I1]=!0,dL.forEach(function(n){n!=="selectionchange"&&(CV.has(n)||Zx(n,!1,t),Zx(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[I1]||(e[I1]=!0,Zx("selectionchange",!1,e))}}function aD(t,e,n,r){switch(jL(e)){case 1:var i=VU;break;case 4:i=GU;break;default:i=pT}n=i.bind(null,e,n,t),i=void 0,!Hb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Yx(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(l===4)for(l=r.return;l!==null;){var p=l.tag;if((p===3||p===4)&&(p=l.stateNode.containerInfo,p===i||p.nodeType===8&&p.parentNode===i))return;l=l.return}for(;o!==null;){if(l=tf(o),l===null)return;if(p=l.tag,p===5||p===6){r=s=l;continue e}o=o.parentNode}}r=r.return}kL(function(){var _=s,C=cT(n),M=[];e:{var k=sD.get(t);if(k!==void 0){var F=mT,j=t;switch(t){case"keypress":if(ky(n)===0)break e;case"keydown":case"keyup":F=rV;break;case"focusin":j="focus",F=$x;break;case"focusout":j="blur",F=$x;break;case"beforeblur":case"afterblur":F=$x;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":F=kC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":F=HU;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":F=oV;break;case tD:case nD:case rD:F=qU;break;case iD:F=lV;break;case"scroll":F=$U;break;case"wheel":F=uV;break;case"copy":case"cut":case"paste":F=YU;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":F=LC}var H=(e&4)!==0,ie=!H&&t==="scroll",Y=H?k!==null?k+"Capture":null:k;H=[];for(var J=_,se;J!==null;){se=J;var he=se.stateNode;if(se.tag===5&&he!==null&&(se=he,Y!==null&&(he=Rg(J,Y),he!=null&&H.push(Vg(J,he,se)))),ie)break;J=J.return}0<H.length&&(k=new F(k,j,null,n,C),M.push({event:k,listeners:H}))}}if(!(e&7)){e:{if(k=t==="mouseover"||t==="pointerover",F=t==="mouseout"||t==="pointerout",k&&n!==$b&&(j=n.relatedTarget||n.fromElement)&&(tf(j)||j[ic]))break e;if((F||k)&&(k=C.window===C?C:(k=C.ownerDocument)?k.defaultView||k.parentWindow:window,F?(j=n.relatedTarget||n.toElement,F=_,j=j?tf(j):null,j!==null&&(ie=Df(j),j!==ie||j.tag!==5&&j.tag!==6)&&(j=null)):(F=null,j=_),F!==j)){if(H=kC,he="onMouseLeave",Y="onMouseEnter",J="mouse",(t==="pointerout"||t==="pointerover")&&(H=LC,he="onPointerLeave",Y="onPointerEnter",J="pointer"),ie=F==null?k:M0(F),se=j==null?k:M0(j),k=new H(he,J+"leave",F,n,C),k.target=ie,k.relatedTarget=se,he=null,tf(C)===_&&(H=new H(Y,J+"enter",j,n,C),H.target=se,H.relatedTarget=ie,he=H),ie=he,F&&j)t:{for(H=F,Y=j,J=0,se=H;se;se=a0(se))J++;for(se=0,he=Y;he;he=a0(he))se++;for(;0<J-se;)H=a0(H),J--;for(;0<se-J;)Y=a0(Y),se--;for(;J--;){if(H===Y||Y!==null&&H===Y.alternate)break t;H=a0(H),Y=a0(Y)}H=null}else H=null;F!==null&&$C(M,k,F,H,!1),j!==null&&ie!==null&&$C(M,ie,j,H,!0)}}e:{if(k=_?M0(_):window,F=k.nodeName&&k.nodeName.toLowerCase(),F==="select"||F==="input"&&k.type==="file")var pe=mV;else if(BC(k))if(YL)pe=xV;else{pe=_V;var be=yV}else(F=k.nodeName)&&F.toLowerCase()==="input"&&(k.type==="checkbox"||k.type==="radio")&&(pe=vV);if(pe&&(pe=pe(t,_))){ZL(M,pe,n,C);break e}be&&be(t,k,_),t==="focusout"&&(be=k._wrapperState)&&be.controlled&&k.type==="number"&&Fb(k,"number",k.value)}switch(be=_?M0(_):window,t){case"focusin":(BC(be)||be.contentEditable==="true")&&(S0=be,Yb=_,gg=null);break;case"focusout":gg=Yb=S0=null;break;case"mousedown":Xb=!0;break;case"contextmenu":case"mouseup":case"dragend":Xb=!1,UC(M,n,C);break;case"selectionchange":if(EV)break;case"keydown":case"keyup":UC(M,n,C)}var Ge;if(_T)e:{switch(t){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else T0?QL(t,n)&&(We="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(We="onCompositionStart");We&&(WL&&n.locale!=="ko"&&(T0||We!=="onCompositionStart"?We==="onCompositionEnd"&&T0&&(Ge=HL()):(Jc=C,gT="value"in Jc?Jc.value:Jc.textContent,T0=!0)),be=y_(_,We),0<be.length&&(We=new IC(We,t,null,n,C),M.push({event:We,listeners:be}),Ge?We.data=Ge:(Ge=qL(n),Ge!==null&&(We.data=Ge)))),(Ge=hV?fV(t,n):dV(t,n))&&(_=y_(_,"onBeforeInput"),0<_.length&&(C=new IC("onBeforeInput","beforeinput",null,n,C),M.push({event:C,listeners:_}),C.data=Ge))}oD(M,e)})}function Vg(t,e,n){return{instance:t,listener:e,currentTarget:n}}function y_(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Rg(t,n),s!=null&&r.unshift(Vg(t,s,i)),s=Rg(t,e),s!=null&&r.push(Vg(t,s,i))),t=t.return}return r}function a0(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $C(t,e,n,r,i){for(var s=e._reactName,l=[];n!==null&&n!==r;){var o=n,p=o.alternate,_=o.stateNode;if(p!==null&&p===r)break;o.tag===5&&_!==null&&(o=_,i?(p=Rg(n,s),p!=null&&l.unshift(Vg(n,p,o))):i||(p=Rg(n,s),p!=null&&l.push(Vg(n,p,o)))),n=n.return}l.length!==0&&t.push({event:e,listeners:l})}var MV=/\r\n?/g,PV=/\u0000|\uFFFD/g;function jC(t){return(typeof t=="string"?t:""+t).replace(MV,`
`).replace(PV,"")}function L1(t,e,n){if(e=jC(e),jC(t)!==e&&n)throw Error(Bt(425))}function __(){}var Kb=null,Jb=null;function e3(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var t3=typeof setTimeout=="function"?setTimeout:void 0,kV=typeof clearTimeout=="function"?clearTimeout:void 0,HC=typeof Promise=="function"?Promise:void 0,IV=typeof queueMicrotask=="function"?queueMicrotask:typeof HC<"u"?function(t){return HC.resolve(null).then(t).catch(LV)}:t3;function LV(t){setTimeout(function(){throw t})}function Xx(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Og(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Og(e)}function Ah(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function WC(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Gd=Math.random().toString(36).slice(2),QA="__reactFiber$"+Gd,Gg="__reactProps$"+Gd,ic="__reactContainer$"+Gd,n3="__reactEvents$"+Gd,DV="__reactListeners$"+Gd,RV="__reactHandles$"+Gd;function tf(t){var e=t[QA];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ic]||n[QA]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=WC(t);t!==null;){if(n=t[QA])return n;t=WC(t)}return e}t=n,n=t.parentNode}return null}function Mm(t){return t=t[QA]||t[ic],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function M0(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Bt(33))}function ev(t){return t[Gg]||null}var r3=[],P0=-1;function kh(t){return{current:t}}function ui(t){0>P0||(t.current=r3[P0],r3[P0]=null,P0--)}function ti(t,e){P0++,r3[P0]=t.current,t.current=e}var _h={},yo=kh(_h),Aa=kh(!1),hf=_h;function pd(t,e){var n=t.type.contextTypes;if(!n)return _h;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function ua(t){return t=t.childContextTypes,t!=null}function v_(){ui(Aa),ui(yo)}function QC(t,e,n){if(yo.current!==_h)throw Error(Bt(168));ti(yo,e),ti(Aa,n)}function lD(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Bt(108,yU(t)||"Unknown",i));return bi({},n,r)}function x_(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_h,hf=yo.current,ti(yo,t),ti(Aa,Aa.current),!0}function qC(t,e,n){var r=t.stateNode;if(!r)throw Error(Bt(169));n?(t=lD(t,e,hf),r.__reactInternalMemoizedMergedChildContext=t,ui(Aa),ui(yo),ti(yo,t)):ui(Aa),ti(Aa,n)}var Gu=null,tv=!1,Kx=!1;function AD(t){Gu===null?Gu=[t]:Gu.push(t)}function BV(t){tv=!0,AD(t)}function Ih(){if(!Kx&&Gu!==null){Kx=!0;var t=0,e=Or;try{var n=Gu;for(Or=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Gu=null,tv=!1}catch(i){throw Gu!==null&&(Gu=Gu.slice(t+1)),RL(hT,Ih),i}finally{Or=e,Kx=!1}}return null}var k0=[],I0=0,w_=null,b_=0,ml=[],yl=0,ff=null,Hu=1,Wu="";function Yh(t,e){k0[I0++]=b_,k0[I0++]=w_,w_=t,b_=e}function uD(t,e,n){ml[yl++]=Hu,ml[yl++]=Wu,ml[yl++]=ff,ff=t;var r=Hu;t=Wu;var i=32-cA(r)-1;r&=~(1<<i),n+=1;var s=32-cA(e)+i;if(30<s){var l=i-i%5;s=(r&(1<<l)-1).toString(32),r>>=l,i-=l,Hu=1<<32-cA(e)+i|n<<i|r,Wu=s+t}else Hu=1<<s|n<<i|r,Wu=t}function xT(t){t.return!==null&&(Yh(t,1),uD(t,1,0))}function wT(t){for(;t===w_;)w_=k0[--I0],k0[I0]=null,b_=k0[--I0],k0[I0]=null;for(;t===ff;)ff=ml[--yl],ml[yl]=null,Wu=ml[--yl],ml[yl]=null,Hu=ml[--yl],ml[yl]=null}var Na=null,Oa=null,mi=!1,eA=null;function cD(t,e){var n=_l(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ZC(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Na=t,Oa=Ah(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Na=t,Oa=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ff!==null?{id:Hu,overflow:Wu}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=_l(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Na=t,Oa=null,!0):!1;default:return!1}}function i3(t){return(t.mode&1)!==0&&(t.flags&128)===0}function s3(t){if(mi){var e=Oa;if(e){var n=e;if(!ZC(t,e)){if(i3(t))throw Error(Bt(418));e=Ah(n.nextSibling);var r=Na;e&&ZC(t,e)?cD(r,n):(t.flags=t.flags&-4097|2,mi=!1,Na=t)}}else{if(i3(t))throw Error(Bt(418));t.flags=t.flags&-4097|2,mi=!1,Na=t}}}function YC(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Na=t}function D1(t){if(t!==Na)return!1;if(!mi)return YC(t),mi=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!e3(t.type,t.memoizedProps)),e&&(e=Oa)){if(i3(t))throw hD(),Error(Bt(418));for(;e;)cD(t,e),e=Ah(e.nextSibling)}if(YC(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Bt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Oa=Ah(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Oa=null}}else Oa=Na?Ah(t.stateNode.nextSibling):null;return!0}function hD(){for(var t=Oa;t;)t=Ah(t.nextSibling)}function gd(){Oa=Na=null,mi=!1}function bT(t){eA===null?eA=[t]:eA.push(t)}var zV=mc.ReactCurrentBatchConfig;function Kl(t,e){if(t&&t.defaultProps){e=bi({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var E_=kh(null),T_=null,L0=null,ET=null;function TT(){ET=L0=T_=null}function ST(t){var e=E_.current;ui(E_),t._currentValue=e}function o3(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function td(t,e){T_=t,ET=L0=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(la=!0),t.firstContext=null)}function Sl(t){var e=t._currentValue;if(ET!==t)if(t={context:t,memoizedValue:e,next:null},L0===null){if(T_===null)throw Error(Bt(308));L0=t,T_.dependencies={lanes:0,firstContext:t}}else L0=L0.next=t;return e}var nf=null;function CT(t){nf===null?nf=[t]:nf.push(t)}function fD(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,CT(e)):(n.next=i.next,i.next=n),e.interleaved=n,sc(t,r)}function sc(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var qc=!1;function MT(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dD(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ku(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function uh(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Cr&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,sc(t,n)}return i=r.interleaved,i===null?(e.next=e,CT(r)):(e.next=i.next,i.next=e),r.interleaved=e,sc(t,n)}function Iy(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,fT(t,n)}}function XC(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=l:s=s.next=l,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function S_(t,e,n,r){var i=t.updateQueue;qc=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var p=o,_=p.next;p.next=null,l===null?s=_:l.next=_,l=p;var C=t.alternate;C!==null&&(C=C.updateQueue,o=C.lastBaseUpdate,o!==l&&(o===null?C.firstBaseUpdate=_:o.next=_,C.lastBaseUpdate=p))}if(s!==null){var M=i.baseState;l=0,C=_=p=null,o=s;do{var k=o.lane,F=o.eventTime;if((r&k)===k){C!==null&&(C=C.next={eventTime:F,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var j=t,H=o;switch(k=e,F=n,H.tag){case 1:if(j=H.payload,typeof j=="function"){M=j.call(F,M,k);break e}M=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=H.payload,k=typeof j=="function"?j.call(F,M,k):j,k==null)break e;M=bi({},M,k);break e;case 2:qc=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,k=i.effects,k===null?i.effects=[o]:k.push(o))}else F={eventTime:F,lane:k,tag:o.tag,payload:o.payload,callback:o.callback,next:null},C===null?(_=C=F,p=M):C=C.next=F,l|=k;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;k=o,o=k.next,k.next=null,i.lastBaseUpdate=k,i.shared.pending=null}}while(1);if(C===null&&(p=M),i.baseState=p,i.firstBaseUpdate=_,i.lastBaseUpdate=C,e=i.shared.interleaved,e!==null){i=e;do l|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);pf|=l,t.lanes=l,t.memoizedState=M}}function KC(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Bt(191,i));i.call(r)}}}var pD=new fL.Component().refs;function a3(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:bi({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var nv={isMounted:function(t){return(t=t._reactInternals)?Df(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Uo(),i=hh(t),s=Ku(r,i);s.payload=e,n!=null&&(s.callback=n),e=uh(t,s,i),e!==null&&(hA(e,t,i,r),Iy(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Uo(),i=hh(t),s=Ku(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=uh(t,s,i),e!==null&&(hA(e,t,i,r),Iy(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Uo(),r=hh(t),i=Ku(n,r);i.tag=2,e!=null&&(i.callback=e),e=uh(t,i,r),e!==null&&(hA(e,t,r,n),Iy(e,t,r))}};function JC(t,e,n,r,i,s,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,l):e.prototype&&e.prototype.isPureReactComponent?!Ng(n,r)||!Ng(i,s):!0}function gD(t,e,n){var r=!1,i=_h,s=e.contextType;return typeof s=="object"&&s!==null?s=Sl(s):(i=ua(e)?hf:yo.current,r=e.contextTypes,s=(r=r!=null)?pd(t,i):_h),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=nv,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function eM(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&nv.enqueueReplaceState(e,e.state,null)}function l3(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=pD,MT(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Sl(s):(s=ua(e)?hf:yo.current,i.context=pd(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(a3(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&nv.enqueueReplaceState(i,i.state,null),S_(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Tp(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Bt(309));var r=n.stateNode}if(!r)throw Error(Bt(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(l){var o=i.refs;o===pD&&(o=i.refs={}),l===null?delete o[s]:o[s]=l},e._stringRef=s,e)}if(typeof t!="string")throw Error(Bt(284));if(!n._owner)throw Error(Bt(290,t))}return t}function R1(t,e){throw t=Object.prototype.toString.call(e),Error(Bt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function tM(t){var e=t._init;return e(t._payload)}function mD(t){function e(Y,J){if(t){var se=Y.deletions;se===null?(Y.deletions=[J],Y.flags|=16):se.push(J)}}function n(Y,J){if(!t)return null;for(;J!==null;)e(Y,J),J=J.sibling;return null}function r(Y,J){for(Y=new Map;J!==null;)J.key!==null?Y.set(J.key,J):Y.set(J.index,J),J=J.sibling;return Y}function i(Y,J){return Y=fh(Y,J),Y.index=0,Y.sibling=null,Y}function s(Y,J,se){return Y.index=se,t?(se=Y.alternate,se!==null?(se=se.index,se<J?(Y.flags|=2,J):se):(Y.flags|=2,J)):(Y.flags|=1048576,J)}function l(Y){return t&&Y.alternate===null&&(Y.flags|=2),Y}function o(Y,J,se,he){return J===null||J.tag!==6?(J=sw(se,Y.mode,he),J.return=Y,J):(J=i(J,se),J.return=Y,J)}function p(Y,J,se,he){var pe=se.type;return pe===E0?C(Y,J,se.props.children,he,se.key):J!==null&&(J.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===Qc&&tM(pe)===J.type)?(he=i(J,se.props),he.ref=Tp(Y,J,se),he.return=Y,he):(he=Oy(se.type,se.key,se.props,null,Y.mode,he),he.ref=Tp(Y,J,se),he.return=Y,he)}function _(Y,J,se,he){return J===null||J.tag!==4||J.stateNode.containerInfo!==se.containerInfo||J.stateNode.implementation!==se.implementation?(J=ow(se,Y.mode,he),J.return=Y,J):(J=i(J,se.children||[]),J.return=Y,J)}function C(Y,J,se,he,pe){return J===null||J.tag!==7?(J=lf(se,Y.mode,he,pe),J.return=Y,J):(J=i(J,se),J.return=Y,J)}function M(Y,J,se){if(typeof J=="string"&&J!==""||typeof J=="number")return J=sw(""+J,Y.mode,se),J.return=Y,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case b1:return se=Oy(J.type,J.key,J.props,null,Y.mode,se),se.ref=Tp(Y,null,J),se.return=Y,se;case b0:return J=ow(J,Y.mode,se),J.return=Y,J;case Qc:var he=J._init;return M(Y,he(J._payload),se)}if(Kp(J)||vp(J))return J=lf(J,Y.mode,se,null),J.return=Y,J;R1(Y,J)}return null}function k(Y,J,se,he){var pe=J!==null?J.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return pe!==null?null:o(Y,J,""+se,he);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case b1:return se.key===pe?p(Y,J,se,he):null;case b0:return se.key===pe?_(Y,J,se,he):null;case Qc:return pe=se._init,k(Y,J,pe(se._payload),he)}if(Kp(se)||vp(se))return pe!==null?null:C(Y,J,se,he,null);R1(Y,se)}return null}function F(Y,J,se,he,pe){if(typeof he=="string"&&he!==""||typeof he=="number")return Y=Y.get(se)||null,o(J,Y,""+he,pe);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case b1:return Y=Y.get(he.key===null?se:he.key)||null,p(J,Y,he,pe);case b0:return Y=Y.get(he.key===null?se:he.key)||null,_(J,Y,he,pe);case Qc:var be=he._init;return F(Y,J,se,be(he._payload),pe)}if(Kp(he)||vp(he))return Y=Y.get(se)||null,C(J,Y,he,pe,null);R1(J,he)}return null}function j(Y,J,se,he){for(var pe=null,be=null,Ge=J,We=J=0,Xe=null;Ge!==null&&We<se.length;We++){Ge.index>We?(Xe=Ge,Ge=null):Xe=Ge.sibling;var rt=k(Y,Ge,se[We],he);if(rt===null){Ge===null&&(Ge=Xe);break}t&&Ge&&rt.alternate===null&&e(Y,Ge),J=s(rt,J,We),be===null?pe=rt:be.sibling=rt,be=rt,Ge=Xe}if(We===se.length)return n(Y,Ge),mi&&Yh(Y,We),pe;if(Ge===null){for(;We<se.length;We++)Ge=M(Y,se[We],he),Ge!==null&&(J=s(Ge,J,We),be===null?pe=Ge:be.sibling=Ge,be=Ge);return mi&&Yh(Y,We),pe}for(Ge=r(Y,Ge);We<se.length;We++)Xe=F(Ge,Y,We,se[We],he),Xe!==null&&(t&&Xe.alternate!==null&&Ge.delete(Xe.key===null?We:Xe.key),J=s(Xe,J,We),be===null?pe=Xe:be.sibling=Xe,be=Xe);return t&&Ge.forEach(function(Oe){return e(Y,Oe)}),mi&&Yh(Y,We),pe}function H(Y,J,se,he){var pe=vp(se);if(typeof pe!="function")throw Error(Bt(150));if(se=pe.call(se),se==null)throw Error(Bt(151));for(var be=pe=null,Ge=J,We=J=0,Xe=null,rt=se.next();Ge!==null&&!rt.done;We++,rt=se.next()){Ge.index>We?(Xe=Ge,Ge=null):Xe=Ge.sibling;var Oe=k(Y,Ge,rt.value,he);if(Oe===null){Ge===null&&(Ge=Xe);break}t&&Ge&&Oe.alternate===null&&e(Y,Ge),J=s(Oe,J,We),be===null?pe=Oe:be.sibling=Oe,be=Oe,Ge=Xe}if(rt.done)return n(Y,Ge),mi&&Yh(Y,We),pe;if(Ge===null){for(;!rt.done;We++,rt=se.next())rt=M(Y,rt.value,he),rt!==null&&(J=s(rt,J,We),be===null?pe=rt:be.sibling=rt,be=rt);return mi&&Yh(Y,We),pe}for(Ge=r(Y,Ge);!rt.done;We++,rt=se.next())rt=F(Ge,Y,We,rt.value,he),rt!==null&&(t&&rt.alternate!==null&&Ge.delete(rt.key===null?We:rt.key),J=s(rt,J,We),be===null?pe=rt:be.sibling=rt,be=rt);return t&&Ge.forEach(function(nt){return e(Y,nt)}),mi&&Yh(Y,We),pe}function ie(Y,J,se,he){if(typeof se=="object"&&se!==null&&se.type===E0&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case b1:e:{for(var pe=se.key,be=J;be!==null;){if(be.key===pe){if(pe=se.type,pe===E0){if(be.tag===7){n(Y,be.sibling),J=i(be,se.props.children),J.return=Y,Y=J;break e}}else if(be.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===Qc&&tM(pe)===be.type){n(Y,be.sibling),J=i(be,se.props),J.ref=Tp(Y,be,se),J.return=Y,Y=J;break e}n(Y,be);break}else e(Y,be);be=be.sibling}se.type===E0?(J=lf(se.props.children,Y.mode,he,se.key),J.return=Y,Y=J):(he=Oy(se.type,se.key,se.props,null,Y.mode,he),he.ref=Tp(Y,J,se),he.return=Y,Y=he)}return l(Y);case b0:e:{for(be=se.key;J!==null;){if(J.key===be)if(J.tag===4&&J.stateNode.containerInfo===se.containerInfo&&J.stateNode.implementation===se.implementation){n(Y,J.sibling),J=i(J,se.children||[]),J.return=Y,Y=J;break e}else{n(Y,J);break}else e(Y,J);J=J.sibling}J=ow(se,Y.mode,he),J.return=Y,Y=J}return l(Y);case Qc:return be=se._init,ie(Y,J,be(se._payload),he)}if(Kp(se))return j(Y,J,se,he);if(vp(se))return H(Y,J,se,he);R1(Y,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,J!==null&&J.tag===6?(n(Y,J.sibling),J=i(J,se),J.return=Y,Y=J):(n(Y,J),J=sw(se,Y.mode,he),J.return=Y,Y=J),l(Y)):n(Y,J)}return ie}var md=mD(!0),yD=mD(!1),Pm={},JA=kh(Pm),$g=kh(Pm),jg=kh(Pm);function rf(t){if(t===Pm)throw Error(Bt(174));return t}function PT(t,e){switch(ti(jg,e),ti($g,t),ti(JA,Pm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ub(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ub(e,t)}ui(JA),ti(JA,e)}function yd(){ui(JA),ui($g),ui(jg)}function _D(t){rf(jg.current);var e=rf(JA.current),n=Ub(e,t.type);e!==n&&(ti($g,t),ti(JA,n))}function kT(t){$g.current===t&&(ui(JA),ui($g))}var vi=kh(0);function C_(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Jx=[];function IT(){for(var t=0;t<Jx.length;t++)Jx[t]._workInProgressVersionPrimary=null;Jx.length=0}var Ly=mc.ReactCurrentDispatcher,ew=mc.ReactCurrentBatchConfig,df=0,wi=null,rs=null,xs=null,M_=!1,mg=!1,Hg=0,OV=0;function no(){throw Error(Bt(321))}function LT(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!dA(t[n],e[n]))return!1;return!0}function DT(t,e,n,r,i,s){if(df=s,wi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ly.current=t===null||t.memoizedState===null?VV:GV,t=n(r,i),mg){s=0;do{if(mg=!1,Hg=0,25<=s)throw Error(Bt(301));s+=1,xs=rs=null,e.updateQueue=null,Ly.current=$V,t=n(r,i)}while(mg)}if(Ly.current=P_,e=rs!==null&&rs.next!==null,df=0,xs=rs=wi=null,M_=!1,e)throw Error(Bt(300));return t}function RT(){var t=Hg!==0;return Hg=0,t}function WA(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xs===null?wi.memoizedState=xs=t:xs=xs.next=t,xs}function Cl(){if(rs===null){var t=wi.alternate;t=t!==null?t.memoizedState:null}else t=rs.next;var e=xs===null?wi.memoizedState:xs.next;if(e!==null)xs=e,rs=t;else{if(t===null)throw Error(Bt(310));rs=t,t={memoizedState:rs.memoizedState,baseState:rs.baseState,baseQueue:rs.baseQueue,queue:rs.queue,next:null},xs===null?wi.memoizedState=xs=t:xs=xs.next=t}return xs}function Wg(t,e){return typeof e=="function"?e(t):e}function tw(t){var e=Cl(),n=e.queue;if(n===null)throw Error(Bt(311));n.lastRenderedReducer=t;var r=rs,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=l=null,p=null,_=s;do{var C=_.lane;if((df&C)===C)p!==null&&(p=p.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),r=_.hasEagerState?_.eagerState:t(r,_.action);else{var M={lane:C,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};p===null?(o=p=M,l=r):p=p.next=M,wi.lanes|=C,pf|=C}_=_.next}while(_!==null&&_!==s);p===null?l=r:p.next=o,dA(r,e.memoizedState)||(la=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=p,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,wi.lanes|=s,pf|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function nw(t){var e=Cl(),n=e.queue;if(n===null)throw Error(Bt(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var l=i=i.next;do s=t(s,l.action),l=l.next;while(l!==i);dA(s,e.memoizedState)||(la=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function vD(){}function xD(t,e){var n=wi,r=Cl(),i=e(),s=!dA(r.memoizedState,i);if(s&&(r.memoizedState=i,la=!0),r=r.queue,BT(ED.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||xs!==null&&xs.memoizedState.tag&1){if(n.flags|=2048,Qg(9,bD.bind(null,n,r,i,e),void 0,null),bs===null)throw Error(Bt(349));df&30||wD(n,e,i)}return i}function wD(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=wi.updateQueue,e===null?(e={lastEffect:null,stores:null},wi.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function bD(t,e,n,r){e.value=n,e.getSnapshot=r,TD(e)&&SD(t)}function ED(t,e,n){return n(function(){TD(e)&&SD(t)})}function TD(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!dA(t,n)}catch{return!0}}function SD(t){var e=sc(t,1);e!==null&&hA(e,t,1,-1)}function nM(t){var e=WA();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wg,lastRenderedState:t},e.queue=t,t=t.dispatch=UV.bind(null,wi,t),[e.memoizedState,t]}function Qg(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=wi.updateQueue,e===null?(e={lastEffect:null,stores:null},wi.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function CD(){return Cl().memoizedState}function Dy(t,e,n,r){var i=WA();wi.flags|=t,i.memoizedState=Qg(1|e,n,void 0,r===void 0?null:r)}function rv(t,e,n,r){var i=Cl();r=r===void 0?null:r;var s=void 0;if(rs!==null){var l=rs.memoizedState;if(s=l.destroy,r!==null&&LT(r,l.deps)){i.memoizedState=Qg(e,n,s,r);return}}wi.flags|=t,i.memoizedState=Qg(1|e,n,s,r)}function rM(t,e){return Dy(8390656,8,t,e)}function BT(t,e){return rv(2048,8,t,e)}function MD(t,e){return rv(4,2,t,e)}function PD(t,e){return rv(4,4,t,e)}function kD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function ID(t,e,n){return n=n!=null?n.concat([t]):null,rv(4,4,kD.bind(null,e,t),n)}function zT(){}function LD(t,e){var n=Cl();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&LT(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function DD(t,e){var n=Cl();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&LT(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function RD(t,e,n){return df&21?(dA(n,e)||(n=OL(),wi.lanes|=n,pf|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,la=!0),t.memoizedState=n)}function FV(t,e){var n=Or;Or=n!==0&&4>n?n:4,t(!0);var r=ew.transition;ew.transition={};try{t(!1),e()}finally{Or=n,ew.transition=r}}function BD(){return Cl().memoizedState}function NV(t,e,n){var r=hh(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},zD(t))OD(e,n);else if(n=fD(t,e,n,r),n!==null){var i=Uo();hA(n,t,r,i),FD(n,e,r)}}function UV(t,e,n){var r=hh(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(zD(t))OD(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var l=e.lastRenderedState,o=s(l,n);if(i.hasEagerState=!0,i.eagerState=o,dA(o,l)){var p=e.interleaved;p===null?(i.next=i,CT(e)):(i.next=p.next,p.next=i),e.interleaved=i;return}}catch{}finally{}n=fD(t,e,i,r),n!==null&&(i=Uo(),hA(n,t,r,i),FD(n,e,r))}}function zD(t){var e=t.alternate;return t===wi||e!==null&&e===wi}function OD(t,e){mg=M_=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function FD(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,fT(t,n)}}var P_={readContext:Sl,useCallback:no,useContext:no,useEffect:no,useImperativeHandle:no,useInsertionEffect:no,useLayoutEffect:no,useMemo:no,useReducer:no,useRef:no,useState:no,useDebugValue:no,useDeferredValue:no,useTransition:no,useMutableSource:no,useSyncExternalStore:no,useId:no,unstable_isNewReconciler:!1},VV={readContext:Sl,useCallback:function(t,e){return WA().memoizedState=[t,e===void 0?null:e],t},useContext:Sl,useEffect:rM,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Dy(4194308,4,kD.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Dy(4194308,4,t,e)},useInsertionEffect:function(t,e){return Dy(4,2,t,e)},useMemo:function(t,e){var n=WA();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=WA();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=NV.bind(null,wi,t),[r.memoizedState,t]},useRef:function(t){var e=WA();return t={current:t},e.memoizedState=t},useState:nM,useDebugValue:zT,useDeferredValue:function(t){return WA().memoizedState=t},useTransition:function(){var t=nM(!1),e=t[0];return t=FV.bind(null,t[1]),WA().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=wi,i=WA();if(mi){if(n===void 0)throw Error(Bt(407));n=n()}else{if(n=e(),bs===null)throw Error(Bt(349));df&30||wD(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,rM(ED.bind(null,r,s,t),[t]),r.flags|=2048,Qg(9,bD.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=WA(),e=bs.identifierPrefix;if(mi){var n=Wu,r=Hu;n=(r&~(1<<32-cA(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Hg++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=OV++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},GV={readContext:Sl,useCallback:LD,useContext:Sl,useEffect:BT,useImperativeHandle:ID,useInsertionEffect:MD,useLayoutEffect:PD,useMemo:DD,useReducer:tw,useRef:CD,useState:function(){return tw(Wg)},useDebugValue:zT,useDeferredValue:function(t){var e=Cl();return RD(e,rs.memoizedState,t)},useTransition:function(){var t=tw(Wg)[0],e=Cl().memoizedState;return[t,e]},useMutableSource:vD,useSyncExternalStore:xD,useId:BD,unstable_isNewReconciler:!1},$V={readContext:Sl,useCallback:LD,useContext:Sl,useEffect:BT,useImperativeHandle:ID,useInsertionEffect:MD,useLayoutEffect:PD,useMemo:DD,useReducer:nw,useRef:CD,useState:function(){return nw(Wg)},useDebugValue:zT,useDeferredValue:function(t){var e=Cl();return rs===null?e.memoizedState=t:RD(e,rs.memoizedState,t)},useTransition:function(){var t=nw(Wg)[0],e=Cl().memoizedState;return[t,e]},useMutableSource:vD,useSyncExternalStore:xD,useId:BD,unstable_isNewReconciler:!1};function _d(t,e){try{var n="",r=e;do n+=mU(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function rw(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function A3(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var jV=typeof WeakMap=="function"?WeakMap:Map;function ND(t,e,n){n=Ku(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){I_||(I_=!0,_3=r),A3(t,e)},n}function UD(t,e,n){n=Ku(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){A3(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){A3(t,e),typeof r!="function"&&(ch===null?ch=new Set([this]):ch.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function iM(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new jV;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=iG.bind(null,t,e,n),e.then(t,t))}function sM(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function oM(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ku(-1,1),e.tag=2,uh(n,e,1))),n.lanes|=1),t)}var HV=mc.ReactCurrentOwner,la=!1;function Bo(t,e,n,r){e.child=t===null?yD(e,null,n,r):md(e,t.child,n,r)}function aM(t,e,n,r,i){n=n.render;var s=e.ref;return td(e,i),r=DT(t,e,n,r,s,i),n=RT(),t!==null&&!la?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,oc(t,e,i)):(mi&&n&&xT(e),e.flags|=1,Bo(t,e,r,i),e.child)}function lM(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!jT(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,VD(t,e,s,r,i)):(t=Oy(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var l=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ng,n(l,r)&&t.ref===e.ref)return oc(t,e,i)}return e.flags|=1,t=fh(s,r),t.ref=e.ref,t.return=e,e.child=t}function VD(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Ng(s,r)&&t.ref===e.ref)if(la=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(la=!0);else return e.lanes=t.lanes,oc(t,e,i)}return u3(t,e,n,r,i)}function GD(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ti(R0,Ra),Ra|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ti(R0,Ra),Ra|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ti(R0,Ra),Ra|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ti(R0,Ra),Ra|=r;return Bo(t,e,i,n),e.child}function $D(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function u3(t,e,n,r,i){var s=ua(n)?hf:yo.current;return s=pd(e,s),td(e,i),n=DT(t,e,n,r,s,i),r=RT(),t!==null&&!la?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,oc(t,e,i)):(mi&&r&&xT(e),e.flags|=1,Bo(t,e,n,i),e.child)}function AM(t,e,n,r,i){if(ua(n)){var s=!0;x_(e)}else s=!1;if(td(e,i),e.stateNode===null)Ry(t,e),gD(e,n,r),l3(e,n,r,i),r=!0;else if(t===null){var l=e.stateNode,o=e.memoizedProps;l.props=o;var p=l.context,_=n.contextType;typeof _=="object"&&_!==null?_=Sl(_):(_=ua(n)?hf:yo.current,_=pd(e,_));var C=n.getDerivedStateFromProps,M=typeof C=="function"||typeof l.getSnapshotBeforeUpdate=="function";M||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==r||p!==_)&&eM(e,l,r,_),qc=!1;var k=e.memoizedState;l.state=k,S_(e,r,l,i),p=e.memoizedState,o!==r||k!==p||Aa.current||qc?(typeof C=="function"&&(a3(e,n,C,r),p=e.memoizedState),(o=qc||JC(e,n,o,r,k,p,_))?(M||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=p),l.props=r,l.state=p,l.context=_,r=o):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,dD(t,e),o=e.memoizedProps,_=e.type===e.elementType?o:Kl(e.type,o),l.props=_,M=e.pendingProps,k=l.context,p=n.contextType,typeof p=="object"&&p!==null?p=Sl(p):(p=ua(n)?hf:yo.current,p=pd(e,p));var F=n.getDerivedStateFromProps;(C=typeof F=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==M||k!==p)&&eM(e,l,r,p),qc=!1,k=e.memoizedState,l.state=k,S_(e,r,l,i);var j=e.memoizedState;o!==M||k!==j||Aa.current||qc?(typeof F=="function"&&(a3(e,n,F,r),j=e.memoizedState),(_=qc||JC(e,n,_,r,k,j,p)||!1)?(C||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,j,p),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,j,p)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===t.memoizedProps&&k===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&k===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=j),l.props=r,l.state=j,l.context=p,r=_):(typeof l.componentDidUpdate!="function"||o===t.memoizedProps&&k===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&k===t.memoizedState||(e.flags|=1024),r=!1)}return c3(t,e,n,r,s,i)}function c3(t,e,n,r,i,s){$D(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return i&&qC(e,n,!1),oc(t,e,s);r=e.stateNode,HV.current=e;var o=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=md(e,t.child,null,s),e.child=md(e,null,o,s)):Bo(t,e,o,s),e.memoizedState=r.state,i&&qC(e,n,!0),e.child}function jD(t){var e=t.stateNode;e.pendingContext?QC(t,e.pendingContext,e.pendingContext!==e.context):e.context&&QC(t,e.context,!1),PT(t,e.containerInfo)}function uM(t,e,n,r,i){return gd(),bT(i),e.flags|=256,Bo(t,e,n,r),e.child}var h3={dehydrated:null,treeContext:null,retryLane:0};function f3(t){return{baseLanes:t,cachePool:null,transitions:null}}function HD(t,e,n){var r=e.pendingProps,i=vi.current,s=!1,l=(e.flags&128)!==0,o;if((o=l)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ti(vi,i&1),t===null)return s3(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,s?(r=e.mode,s=e.child,l={mode:"hidden",children:l},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=ov(l,r,0,null),t=lf(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=f3(n),e.memoizedState=h3,t):OT(e,l));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return WV(t,e,l,r,o,i,n);if(s){s=r.fallback,l=e.mode,i=t.child,o=i.sibling;var p={mode:"hidden",children:r.children};return!(l&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=p,e.deletions=null):(r=fh(i,p),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=fh(o,s):(s=lf(s,l,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,l=t.child.memoizedState,l=l===null?f3(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=h3,r}return s=t.child,t=s.sibling,r=fh(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function OT(t,e){return e=ov({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function B1(t,e,n,r){return r!==null&&bT(r),md(e,t.child,null,n),t=OT(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function WV(t,e,n,r,i,s,l){if(n)return e.flags&256?(e.flags&=-257,r=rw(Error(Bt(422))),B1(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=ov({mode:"visible",children:r.children},i,0,null),s=lf(s,i,l,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&md(e,t.child,null,l),e.child.memoizedState=f3(l),e.memoizedState=h3,s);if(!(e.mode&1))return B1(t,e,l,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(Bt(419)),r=rw(s,r,void 0),B1(t,e,l,r)}if(o=(l&t.childLanes)!==0,la||o){if(r=bs,r!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,sc(t,i),hA(r,t,i,-1))}return $T(),r=rw(Error(Bt(421))),B1(t,e,l,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=sG.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Oa=Ah(i.nextSibling),Na=e,mi=!0,eA=null,t!==null&&(ml[yl++]=Hu,ml[yl++]=Wu,ml[yl++]=ff,Hu=t.id,Wu=t.overflow,ff=e),e=OT(e,r.children),e.flags|=4096,e)}function cM(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),o3(t.return,e,n)}function iw(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function WD(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Bo(t,e,r.children,n),r=vi.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cM(t,n,e);else if(t.tag===19)cM(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ti(vi,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&C_(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),iw(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&C_(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}iw(e,!0,n,null,s);break;case"together":iw(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ry(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function oc(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),pf|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Bt(153));if(e.child!==null){for(t=e.child,n=fh(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=fh(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function QV(t,e,n){switch(e.tag){case 3:jD(e),gd();break;case 5:_D(e);break;case 1:ua(e.type)&&x_(e);break;case 4:PT(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ti(E_,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ti(vi,vi.current&1),e.flags|=128,null):n&e.child.childLanes?HD(t,e,n):(ti(vi,vi.current&1),t=oc(t,e,n),t!==null?t.sibling:null);ti(vi,vi.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return WD(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ti(vi,vi.current),r)break;return null;case 22:case 23:return e.lanes=0,GD(t,e,n)}return oc(t,e,n)}var QD,d3,qD,ZD;QD=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};d3=function(){};qD=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,rf(JA.current);var s=null;switch(n){case"input":i=zb(t,i),r=zb(t,r),s=[];break;case"select":i=bi({},i,{value:void 0}),r=bi({},r,{value:void 0}),s=[];break;case"textarea":i=Nb(t,i),r=Nb(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=__)}Vb(n,r);var l;n=null;for(_ in i)if(!r.hasOwnProperty(_)&&i.hasOwnProperty(_)&&i[_]!=null)if(_==="style"){var o=i[_];for(l in o)o.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(Lg.hasOwnProperty(_)?s||(s=[]):(s=s||[]).push(_,null));for(_ in r){var p=r[_];if(o=i?.[_],r.hasOwnProperty(_)&&p!==o&&(p!=null||o!=null))if(_==="style")if(o){for(l in o)!o.hasOwnProperty(l)||p&&p.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in p)p.hasOwnProperty(l)&&o[l]!==p[l]&&(n||(n={}),n[l]=p[l])}else n||(s||(s=[]),s.push(_,n)),n=p;else _==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,o=o?o.__html:void 0,p!=null&&o!==p&&(s=s||[]).push(_,p)):_==="children"?typeof p!="string"&&typeof p!="number"||(s=s||[]).push(_,""+p):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(Lg.hasOwnProperty(_)?(p!=null&&_==="onScroll"&&li("scroll",t),s||o===p||(s=[])):(s=s||[]).push(_,p))}n&&(s=s||[]).push("style",n);var _=s;(e.updateQueue=_)&&(e.flags|=4)}};ZD=function(t,e,n,r){n!==r&&(e.flags|=4)};function Sp(t,e){if(!mi)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ro(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function qV(t,e,n){var r=e.pendingProps;switch(wT(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ro(e),null;case 1:return ua(e.type)&&v_(),ro(e),null;case 3:return r=e.stateNode,yd(),ui(Aa),ui(yo),IT(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(D1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,eA!==null&&(w3(eA),eA=null))),d3(t,e),ro(e),null;case 5:kT(e);var i=rf(jg.current);if(n=e.type,t!==null&&e.stateNode!=null)qD(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Bt(166));return ro(e),null}if(t=rf(JA.current),D1(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[QA]=e,r[Gg]=s,t=(e.mode&1)!==0,n){case"dialog":li("cancel",r),li("close",r);break;case"iframe":case"object":case"embed":li("load",r);break;case"video":case"audio":for(i=0;i<eg.length;i++)li(eg[i],r);break;case"source":li("error",r);break;case"img":case"image":case"link":li("error",r),li("load",r);break;case"details":li("toggle",r);break;case"input":vC(r,s),li("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},li("invalid",r);break;case"textarea":wC(r,s),li("invalid",r)}Vb(n,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var o=s[l];l==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&L1(r.textContent,o,t),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&L1(r.textContent,o,t),i=["children",""+o]):Lg.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&li("scroll",r)}switch(n){case"input":E1(r),xC(r,s,!0);break;case"textarea":E1(r),bC(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=__)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=wL(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),n==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[QA]=e,t[Gg]=r,QD(t,e,!1,!1),e.stateNode=t;e:{switch(l=Gb(n,r),n){case"dialog":li("cancel",t),li("close",t),i=r;break;case"iframe":case"object":case"embed":li("load",t),i=r;break;case"video":case"audio":for(i=0;i<eg.length;i++)li(eg[i],t);i=r;break;case"source":li("error",t),i=r;break;case"img":case"image":case"link":li("error",t),li("load",t),i=r;break;case"details":li("toggle",t),i=r;break;case"input":vC(t,r),i=zb(t,r),li("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=bi({},r,{value:void 0}),li("invalid",t);break;case"textarea":wC(t,r),i=Nb(t,r),li("invalid",t);break;default:i=r}Vb(n,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var p=o[s];s==="style"?TL(t,p):s==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&bL(t,p)):s==="children"?typeof p=="string"?(n!=="textarea"||p!=="")&&Dg(t,p):typeof p=="number"&&Dg(t,""+p):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Lg.hasOwnProperty(s)?p!=null&&s==="onScroll"&&li("scroll",t):p!=null&&aT(t,s,p,l))}switch(n){case"input":E1(t),xC(t,r,!1);break;case"textarea":E1(t),bC(t);break;case"option":r.value!=null&&t.setAttribute("value",""+yh(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?X0(t,!!r.multiple,s,!1):r.defaultValue!=null&&X0(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=__)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ro(e),null;case 6:if(t&&e.stateNode!=null)ZD(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Bt(166));if(n=rf(jg.current),rf(JA.current),D1(e)){if(r=e.stateNode,n=e.memoizedProps,r[QA]=e,(s=r.nodeValue!==n)&&(t=Na,t!==null))switch(t.tag){case 3:L1(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&L1(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[QA]=e,e.stateNode=r}return ro(e),null;case 13:if(ui(vi),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(mi&&Oa!==null&&e.mode&1&&!(e.flags&128))hD(),gd(),e.flags|=98560,s=!1;else if(s=D1(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Bt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Bt(317));s[QA]=e}else gd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ro(e),s=!1}else eA!==null&&(w3(eA),eA=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||vi.current&1?is===0&&(is=3):$T())),e.updateQueue!==null&&(e.flags|=4),ro(e),null);case 4:return yd(),d3(t,e),t===null&&Ug(e.stateNode.containerInfo),ro(e),null;case 10:return ST(e.type._context),ro(e),null;case 17:return ua(e.type)&&v_(),ro(e),null;case 19:if(ui(vi),s=e.memoizedState,s===null)return ro(e),null;if(r=(e.flags&128)!==0,l=s.rendering,l===null)if(r)Sp(s,!1);else{if(is!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=C_(t),l!==null){for(e.flags|=128,Sp(s,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ti(vi,vi.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ni()>vd&&(e.flags|=128,r=!0,Sp(s,!1),e.lanes=4194304)}else{if(!r)if(t=C_(l),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Sp(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!mi)return ro(e),null}else 2*Ni()-s.renderingStartTime>vd&&n!==1073741824&&(e.flags|=128,r=!0,Sp(s,!1),e.lanes=4194304);s.isBackwards?(l.sibling=e.child,e.child=l):(n=s.last,n!==null?n.sibling=l:e.child=l,s.last=l)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ni(),e.sibling=null,n=vi.current,ti(vi,r?n&1|2:n&1),e):(ro(e),null);case 22:case 23:return GT(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ra&1073741824&&(ro(e),e.subtreeFlags&6&&(e.flags|=8192)):ro(e),null;case 24:return null;case 25:return null}throw Error(Bt(156,e.tag))}function ZV(t,e){switch(wT(e),e.tag){case 1:return ua(e.type)&&v_(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return yd(),ui(Aa),ui(yo),IT(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return kT(e),null;case 13:if(ui(vi),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Bt(340));gd()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ui(vi),null;case 4:return yd(),null;case 10:return ST(e.type._context),null;case 22:case 23:return GT(),null;case 24:return null;default:return null}}var z1=!1,fo=!1,YV=typeof WeakSet=="function"?WeakSet:Set,hn=null;function D0(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ki(t,e,r)}else n.current=null}function p3(t,e,n){try{n()}catch(r){ki(t,e,r)}}var hM=!1;function XV(t,e){if(Kb=g_,t=JL(),vT(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var l=0,o=-1,p=-1,_=0,C=0,M=t,k=null;t:for(;;){for(var F;M!==n||i!==0&&M.nodeType!==3||(o=l+i),M!==s||r!==0&&M.nodeType!==3||(p=l+r),M.nodeType===3&&(l+=M.nodeValue.length),(F=M.firstChild)!==null;)k=M,M=F;for(;;){if(M===t)break t;if(k===n&&++_===i&&(o=l),k===s&&++C===r&&(p=l),(F=M.nextSibling)!==null)break;M=k,k=M.parentNode}M=F}n=o===-1||p===-1?null:{start:o,end:p}}else n=null}n=n||{start:0,end:0}}else n=null;for(Jb={focusedElem:t,selectionRange:n},g_=!1,hn=e;hn!==null;)if(e=hn,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,hn=t;else for(;hn!==null;){e=hn;try{var j=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var H=j.memoizedProps,ie=j.memoizedState,Y=e.stateNode,J=Y.getSnapshotBeforeUpdate(e.elementType===e.type?H:Kl(e.type,H),ie);Y.__reactInternalSnapshotBeforeUpdate=J}break;case 3:var se=e.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Bt(163))}}catch(he){ki(e,e.return,he)}if(t=e.sibling,t!==null){t.return=e.return,hn=t;break}hn=e.return}return j=hM,hM=!1,j}function yg(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&p3(e,n,s)}i=i.next}while(i!==r)}}function iv(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function g3(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function YD(t){var e=t.alternate;e!==null&&(t.alternate=null,YD(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[QA],delete e[Gg],delete e[n3],delete e[DV],delete e[RV])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function XD(t){return t.tag===5||t.tag===3||t.tag===4}function fM(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||XD(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function m3(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=__));else if(r!==4&&(t=t.child,t!==null))for(m3(t,e,n),t=t.sibling;t!==null;)m3(t,e,n),t=t.sibling}function y3(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(y3(t,e,n),t=t.sibling;t!==null;)y3(t,e,n),t=t.sibling}var Bs=null,Jl=!1;function Fc(t,e,n){for(n=n.child;n!==null;)KD(t,e,n),n=n.sibling}function KD(t,e,n){if(KA&&typeof KA.onCommitFiberUnmount=="function")try{KA.onCommitFiberUnmount(Y2,n)}catch{}switch(n.tag){case 5:fo||D0(n,e);case 6:var r=Bs,i=Jl;Bs=null,Fc(t,e,n),Bs=r,Jl=i,Bs!==null&&(Jl?(t=Bs,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Bs.removeChild(n.stateNode));break;case 18:Bs!==null&&(Jl?(t=Bs,n=n.stateNode,t.nodeType===8?Xx(t.parentNode,n):t.nodeType===1&&Xx(t,n),Og(t)):Xx(Bs,n.stateNode));break;case 4:r=Bs,i=Jl,Bs=n.stateNode.containerInfo,Jl=!0,Fc(t,e,n),Bs=r,Jl=i;break;case 0:case 11:case 14:case 15:if(!fo&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&p3(n,e,l),i=i.next}while(i!==r)}Fc(t,e,n);break;case 1:if(!fo&&(D0(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){ki(n,e,o)}Fc(t,e,n);break;case 21:Fc(t,e,n);break;case 22:n.mode&1?(fo=(r=fo)||n.memoizedState!==null,Fc(t,e,n),fo=r):Fc(t,e,n);break;default:Fc(t,e,n)}}function dM(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new YV),e.forEach(function(r){var i=oG.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Xl(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,l=e,o=l;e:for(;o!==null;){switch(o.tag){case 5:Bs=o.stateNode,Jl=!1;break e;case 3:Bs=o.stateNode.containerInfo,Jl=!0;break e;case 4:Bs=o.stateNode.containerInfo,Jl=!0;break e}o=o.return}if(Bs===null)throw Error(Bt(160));KD(s,l,i),Bs=null,Jl=!1;var p=i.alternate;p!==null&&(p.return=null),i.return=null}catch(_){ki(i,e,_)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)JD(e,t),e=e.sibling}function JD(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xl(e,t),FA(t),r&4){try{yg(3,t,t.return),iv(3,t)}catch(H){ki(t,t.return,H)}try{yg(5,t,t.return)}catch(H){ki(t,t.return,H)}}break;case 1:Xl(e,t),FA(t),r&512&&n!==null&&D0(n,n.return);break;case 5:if(Xl(e,t),FA(t),r&512&&n!==null&&D0(n,n.return),t.flags&32){var i=t.stateNode;try{Dg(i,"")}catch(H){ki(t,t.return,H)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,l=n!==null?n.memoizedProps:s,o=t.type,p=t.updateQueue;if(t.updateQueue=null,p!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&vL(i,s),Gb(o,l);var _=Gb(o,s);for(l=0;l<p.length;l+=2){var C=p[l],M=p[l+1];C==="style"?TL(i,M):C==="dangerouslySetInnerHTML"?bL(i,M):C==="children"?Dg(i,M):aT(i,C,M,_)}switch(o){case"input":Ob(i,s);break;case"textarea":xL(i,s);break;case"select":var k=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var F=s.value;F!=null?X0(i,!!s.multiple,F,!1):k!==!!s.multiple&&(s.defaultValue!=null?X0(i,!!s.multiple,s.defaultValue,!0):X0(i,!!s.multiple,s.multiple?[]:"",!1))}i[Gg]=s}catch(H){ki(t,t.return,H)}}break;case 6:if(Xl(e,t),FA(t),r&4){if(t.stateNode===null)throw Error(Bt(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(H){ki(t,t.return,H)}}break;case 3:if(Xl(e,t),FA(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Og(e.containerInfo)}catch(H){ki(t,t.return,H)}break;case 4:Xl(e,t),FA(t);break;case 13:Xl(e,t),FA(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(UT=Ni())),r&4&&dM(t);break;case 22:if(C=n!==null&&n.memoizedState!==null,t.mode&1?(fo=(_=fo)||C,Xl(e,t),fo=_):Xl(e,t),FA(t),r&8192){if(_=t.memoizedState!==null,(t.stateNode.isHidden=_)&&!C&&t.mode&1)for(hn=t,C=t.child;C!==null;){for(M=hn=C;hn!==null;){switch(k=hn,F=k.child,k.tag){case 0:case 11:case 14:case 15:yg(4,k,k.return);break;case 1:D0(k,k.return);var j=k.stateNode;if(typeof j.componentWillUnmount=="function"){r=k,n=k.return;try{e=r,j.props=e.memoizedProps,j.state=e.memoizedState,j.componentWillUnmount()}catch(H){ki(r,n,H)}}break;case 5:D0(k,k.return);break;case 22:if(k.memoizedState!==null){gM(M);continue}}F!==null?(F.return=k,hn=F):gM(M)}C=C.sibling}e:for(C=null,M=t;;){if(M.tag===5){if(C===null){C=M;try{i=M.stateNode,_?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=M.stateNode,p=M.memoizedProps.style,l=p!=null&&p.hasOwnProperty("display")?p.display:null,o.style.display=EL("display",l))}catch(H){ki(t,t.return,H)}}}else if(M.tag===6){if(C===null)try{M.stateNode.nodeValue=_?"":M.memoizedProps}catch(H){ki(t,t.return,H)}}else if((M.tag!==22&&M.tag!==23||M.memoizedState===null||M===t)&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===t)break e;for(;M.sibling===null;){if(M.return===null||M.return===t)break e;C===M&&(C=null),M=M.return}C===M&&(C=null),M.sibling.return=M.return,M=M.sibling}}break;case 19:Xl(e,t),FA(t),r&4&&dM(t);break;case 21:break;default:Xl(e,t),FA(t)}}function FA(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(XD(n)){var r=n;break e}n=n.return}throw Error(Bt(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Dg(i,""),r.flags&=-33);var s=fM(t);y3(t,s,i);break;case 3:case 4:var l=r.stateNode.containerInfo,o=fM(t);m3(t,o,l);break;default:throw Error(Bt(161))}}catch(p){ki(t,t.return,p)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function KV(t,e,n){hn=t,eR(t)}function eR(t,e,n){for(var r=(t.mode&1)!==0;hn!==null;){var i=hn,s=i.child;if(i.tag===22&&r){var l=i.memoizedState!==null||z1;if(!l){var o=i.alternate,p=o!==null&&o.memoizedState!==null||fo;o=z1;var _=fo;if(z1=l,(fo=p)&&!_)for(hn=i;hn!==null;)l=hn,p=l.child,l.tag===22&&l.memoizedState!==null?mM(i):p!==null?(p.return=l,hn=p):mM(i);for(;s!==null;)hn=s,eR(s),s=s.sibling;hn=i,z1=o,fo=_}pM(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,hn=s):pM(t)}}function pM(t){for(;hn!==null;){var e=hn;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:fo||iv(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!fo)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Kl(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&KC(e,s,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}KC(e,l,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var p=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&n.focus();break;case"img":p.src&&(n.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var _=e.alternate;if(_!==null){var C=_.memoizedState;if(C!==null){var M=C.dehydrated;M!==null&&Og(M)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Bt(163))}fo||e.flags&512&&g3(e)}catch(k){ki(e,e.return,k)}}if(e===t){hn=null;break}if(n=e.sibling,n!==null){n.return=e.return,hn=n;break}hn=e.return}}function gM(t){for(;hn!==null;){var e=hn;if(e===t){hn=null;break}var n=e.sibling;if(n!==null){n.return=e.return,hn=n;break}hn=e.return}}function mM(t){for(;hn!==null;){var e=hn;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{iv(4,e)}catch(p){ki(e,n,p)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(p){ki(e,i,p)}}var s=e.return;try{g3(e)}catch(p){ki(e,s,p)}break;case 5:var l=e.return;try{g3(e)}catch(p){ki(e,l,p)}}}catch(p){ki(e,e.return,p)}if(e===t){hn=null;break}var o=e.sibling;if(o!==null){o.return=e.return,hn=o;break}hn=e.return}}var JV=Math.ceil,k_=mc.ReactCurrentDispatcher,FT=mc.ReactCurrentOwner,xl=mc.ReactCurrentBatchConfig,Cr=0,bs=null,Yi=null,Fs=0,Ra=0,R0=kh(0),is=0,qg=null,pf=0,sv=0,NT=0,_g=null,oa=null,UT=0,vd=1/0,Vu=null,I_=!1,_3=null,ch=null,O1=!1,eh=null,L_=0,vg=0,v3=null,By=-1,zy=0;function Uo(){return Cr&6?Ni():By!==-1?By:By=Ni()}function hh(t){return t.mode&1?Cr&2&&Fs!==0?Fs&-Fs:zV.transition!==null?(zy===0&&(zy=OL()),zy):(t=Or,t!==0||(t=window.event,t=t===void 0?16:jL(t.type)),t):1}function hA(t,e,n,r){if(50<vg)throw vg=0,v3=null,Error(Bt(185));Sm(t,n,r),(!(Cr&2)||t!==bs)&&(t===bs&&(!(Cr&2)&&(sv|=n),is===4&&Xc(t,Fs)),ca(t,r),n===1&&Cr===0&&!(e.mode&1)&&(vd=Ni()+500,tv&&Ih()))}function ca(t,e){var n=t.callbackNode;zU(t,e);var r=p_(t,t===bs?Fs:0);if(r===0)n!==null&&SC(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&SC(n),e===1)t.tag===0?BV(yM.bind(null,t)):AD(yM.bind(null,t)),IV(function(){!(Cr&6)&&Ih()}),n=null;else{switch(FL(r)){case 1:n=hT;break;case 4:n=BL;break;case 16:n=d_;break;case 536870912:n=zL;break;default:n=d_}n=lR(n,tR.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function tR(t,e){if(By=-1,zy=0,Cr&6)throw Error(Bt(327));var n=t.callbackNode;if(nd()&&t.callbackNode!==n)return null;var r=p_(t,t===bs?Fs:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=D_(t,r);else{e=r;var i=Cr;Cr|=2;var s=rR();(bs!==t||Fs!==e)&&(Vu=null,vd=Ni()+500,af(t,e));do try{nG();break}catch(o){nR(t,o)}while(1);TT(),k_.current=s,Cr=i,Yi!==null?e=0:(bs=null,Fs=0,e=is)}if(e!==0){if(e===2&&(i=Qb(t),i!==0&&(r=i,e=x3(t,i))),e===1)throw n=qg,af(t,0),Xc(t,r),ca(t,Ni()),n;if(e===6)Xc(t,r);else{if(i=t.current.alternate,!(r&30)&&!eG(i)&&(e=D_(t,r),e===2&&(s=Qb(t),s!==0&&(r=s,e=x3(t,s))),e===1))throw n=qg,af(t,0),Xc(t,r),ca(t,Ni()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Bt(345));case 2:Xh(t,oa,Vu);break;case 3:if(Xc(t,r),(r&130023424)===r&&(e=UT+500-Ni(),10<e)){if(p_(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Uo(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=t3(Xh.bind(null,t,oa,Vu),e);break}Xh(t,oa,Vu);break;case 4:if(Xc(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var l=31-cA(r);s=1<<l,l=e[l],l>i&&(i=l),r&=~s}if(r=i,r=Ni()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*JV(r/1960))-r,10<r){t.timeoutHandle=t3(Xh.bind(null,t,oa,Vu),r);break}Xh(t,oa,Vu);break;case 5:Xh(t,oa,Vu);break;default:throw Error(Bt(329))}}}return ca(t,Ni()),t.callbackNode===n?tR.bind(null,t):null}function x3(t,e){var n=_g;return t.current.memoizedState.isDehydrated&&(af(t,e).flags|=256),t=D_(t,e),t!==2&&(e=oa,oa=n,e!==null&&w3(e)),t}function w3(t){oa===null?oa=t:oa.push.apply(oa,t)}function eG(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!dA(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Xc(t,e){for(e&=~NT,e&=~sv,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-cA(e),r=1<<n;t[n]=-1,e&=~r}}function yM(t){if(Cr&6)throw Error(Bt(327));nd();var e=p_(t,0);if(!(e&1))return ca(t,Ni()),null;var n=D_(t,e);if(t.tag!==0&&n===2){var r=Qb(t);r!==0&&(e=r,n=x3(t,r))}if(n===1)throw n=qg,af(t,0),Xc(t,e),ca(t,Ni()),n;if(n===6)throw Error(Bt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Xh(t,oa,Vu),ca(t,Ni()),null}function VT(t,e){var n=Cr;Cr|=1;try{return t(e)}finally{Cr=n,Cr===0&&(vd=Ni()+500,tv&&Ih())}}function gf(t){eh!==null&&eh.tag===0&&!(Cr&6)&&nd();var e=Cr;Cr|=1;var n=xl.transition,r=Or;try{if(xl.transition=null,Or=1,t)return t()}finally{Or=r,xl.transition=n,Cr=e,!(Cr&6)&&Ih()}}function GT(){Ra=R0.current,ui(R0)}function af(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,kV(n)),Yi!==null)for(n=Yi.return;n!==null;){var r=n;switch(wT(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&v_();break;case 3:yd(),ui(Aa),ui(yo),IT();break;case 5:kT(r);break;case 4:yd();break;case 13:ui(vi);break;case 19:ui(vi);break;case 10:ST(r.type._context);break;case 22:case 23:GT()}n=n.return}if(bs=t,Yi=t=fh(t.current,null),Fs=Ra=e,is=0,qg=null,NT=sv=pf=0,oa=_g=null,nf!==null){for(e=0;e<nf.length;e++)if(n=nf[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var l=s.next;s.next=i,r.next=l}n.pending=r}nf=null}return t}function nR(t,e){do{var n=Yi;try{if(TT(),Ly.current=P_,M_){for(var r=wi.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}M_=!1}if(df=0,xs=rs=wi=null,mg=!1,Hg=0,FT.current=null,n===null||n.return===null){is=1,qg=e,Yi=null;break}e:{var s=t,l=n.return,o=n,p=e;if(e=Fs,o.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var _=p,C=o,M=C.tag;if(!(C.mode&1)&&(M===0||M===11||M===15)){var k=C.alternate;k?(C.updateQueue=k.updateQueue,C.memoizedState=k.memoizedState,C.lanes=k.lanes):(C.updateQueue=null,C.memoizedState=null)}var F=sM(l);if(F!==null){F.flags&=-257,oM(F,l,o,s,e),F.mode&1&&iM(s,_,e),e=F,p=_;var j=e.updateQueue;if(j===null){var H=new Set;H.add(p),e.updateQueue=H}else j.add(p);break e}else{if(!(e&1)){iM(s,_,e),$T();break e}p=Error(Bt(426))}}else if(mi&&o.mode&1){var ie=sM(l);if(ie!==null){!(ie.flags&65536)&&(ie.flags|=256),oM(ie,l,o,s,e),bT(_d(p,o));break e}}s=p=_d(p,o),is!==4&&(is=2),_g===null?_g=[s]:_g.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var Y=ND(s,p,e);XC(s,Y);break e;case 1:o=p;var J=s.type,se=s.stateNode;if(!(s.flags&128)&&(typeof J.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(ch===null||!ch.has(se)))){s.flags|=65536,e&=-e,s.lanes|=e;var he=UD(s,o,e);XC(s,he);break e}}s=s.return}while(s!==null)}sR(n)}catch(pe){e=pe,Yi===n&&n!==null&&(Yi=n=n.return);continue}break}while(1)}function rR(){var t=k_.current;return k_.current=P_,t===null?P_:t}function $T(){(is===0||is===3||is===2)&&(is=4),bs===null||!(pf&268435455)&&!(sv&268435455)||Xc(bs,Fs)}function D_(t,e){var n=Cr;Cr|=2;var r=rR();(bs!==t||Fs!==e)&&(Vu=null,af(t,e));do try{tG();break}catch(i){nR(t,i)}while(1);if(TT(),Cr=n,k_.current=r,Yi!==null)throw Error(Bt(261));return bs=null,Fs=0,is}function tG(){for(;Yi!==null;)iR(Yi)}function nG(){for(;Yi!==null&&!CU();)iR(Yi)}function iR(t){var e=aR(t.alternate,t,Ra);t.memoizedProps=t.pendingProps,e===null?sR(t):Yi=e,FT.current=null}function sR(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=ZV(n,e),n!==null){n.flags&=32767,Yi=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{is=6,Yi=null;return}}else if(n=qV(n,e,Ra),n!==null){Yi=n;return}if(e=e.sibling,e!==null){Yi=e;return}Yi=e=t}while(e!==null);is===0&&(is=5)}function Xh(t,e,n){var r=Or,i=xl.transition;try{xl.transition=null,Or=1,rG(t,e,n,r)}finally{xl.transition=i,Or=r}return null}function rG(t,e,n,r){do nd();while(eh!==null);if(Cr&6)throw Error(Bt(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Bt(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(OU(t,s),t===bs&&(Yi=bs=null,Fs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||O1||(O1=!0,lR(d_,function(){return nd(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=xl.transition,xl.transition=null;var l=Or;Or=1;var o=Cr;Cr|=4,FT.current=null,XV(t,n),JD(n,t),bV(Jb),g_=!!Kb,Jb=Kb=null,t.current=n,KV(n),MU(),Cr=o,Or=l,xl.transition=s}else t.current=n;if(O1&&(O1=!1,eh=t,L_=i),s=t.pendingLanes,s===0&&(ch=null),IU(n.stateNode),ca(t,Ni()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(I_)throw I_=!1,t=_3,_3=null,t;return L_&1&&t.tag!==0&&nd(),s=t.pendingLanes,s&1?t===v3?vg++:(vg=0,v3=t):vg=0,Ih(),null}function nd(){if(eh!==null){var t=FL(L_),e=xl.transition,n=Or;try{if(xl.transition=null,Or=16>t?16:t,eh===null)var r=!1;else{if(t=eh,eh=null,L_=0,Cr&6)throw Error(Bt(331));var i=Cr;for(Cr|=4,hn=t.current;hn!==null;){var s=hn,l=s.child;if(hn.flags&16){var o=s.deletions;if(o!==null){for(var p=0;p<o.length;p++){var _=o[p];for(hn=_;hn!==null;){var C=hn;switch(C.tag){case 0:case 11:case 15:yg(8,C,s)}var M=C.child;if(M!==null)M.return=C,hn=M;else for(;hn!==null;){C=hn;var k=C.sibling,F=C.return;if(YD(C),C===_){hn=null;break}if(k!==null){k.return=F,hn=k;break}hn=F}}}var j=s.alternate;if(j!==null){var H=j.child;if(H!==null){j.child=null;do{var ie=H.sibling;H.sibling=null,H=ie}while(H!==null)}}hn=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,hn=l;else e:for(;hn!==null;){if(s=hn,s.flags&2048)switch(s.tag){case 0:case 11:case 15:yg(9,s,s.return)}var Y=s.sibling;if(Y!==null){Y.return=s.return,hn=Y;break e}hn=s.return}}var J=t.current;for(hn=J;hn!==null;){l=hn;var se=l.child;if(l.subtreeFlags&2064&&se!==null)se.return=l,hn=se;else e:for(l=J;hn!==null;){if(o=hn,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:iv(9,o)}}catch(pe){ki(o,o.return,pe)}if(o===l){hn=null;break e}var he=o.sibling;if(he!==null){he.return=o.return,hn=he;break e}hn=o.return}}if(Cr=i,Ih(),KA&&typeof KA.onPostCommitFiberRoot=="function")try{KA.onPostCommitFiberRoot(Y2,t)}catch{}r=!0}return r}finally{Or=n,xl.transition=e}}return!1}function _M(t,e,n){e=_d(n,e),e=ND(t,e,1),t=uh(t,e,1),e=Uo(),t!==null&&(Sm(t,1,e),ca(t,e))}function ki(t,e,n){if(t.tag===3)_M(t,t,n);else for(;e!==null;){if(e.tag===3){_M(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ch===null||!ch.has(r))){t=_d(n,t),t=UD(e,t,1),e=uh(e,t,1),t=Uo(),e!==null&&(Sm(e,1,t),ca(e,t));break}}e=e.return}}function iG(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Uo(),t.pingedLanes|=t.suspendedLanes&n,bs===t&&(Fs&n)===n&&(is===4||is===3&&(Fs&130023424)===Fs&&500>Ni()-UT?af(t,0):NT|=n),ca(t,e)}function oR(t,e){e===0&&(t.mode&1?(e=C1,C1<<=1,!(C1&130023424)&&(C1=4194304)):e=1);var n=Uo();t=sc(t,e),t!==null&&(Sm(t,e,n),ca(t,n))}function sG(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),oR(t,n)}function oG(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Bt(314))}r!==null&&r.delete(e),oR(t,n)}var aR;aR=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Aa.current)la=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return la=!1,QV(t,e,n);la=!!(t.flags&131072)}else la=!1,mi&&e.flags&1048576&&uD(e,b_,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ry(t,e),t=e.pendingProps;var i=pd(e,yo.current);td(e,n),i=DT(null,e,r,t,i,n);var s=RT();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ua(r)?(s=!0,x_(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,MT(e),i.updater=nv,e.stateNode=i,i._reactInternals=e,l3(e,r,t,n),e=c3(null,e,r,!0,s,n)):(e.tag=0,mi&&s&&xT(e),Bo(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ry(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=lG(r),t=Kl(r,t),i){case 0:e=u3(null,e,r,t,n);break e;case 1:e=AM(null,e,r,t,n);break e;case 11:e=aM(null,e,r,t,n);break e;case 14:e=lM(null,e,r,Kl(r.type,t),n);break e}throw Error(Bt(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kl(r,i),u3(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kl(r,i),AM(t,e,r,i,n);case 3:e:{if(jD(e),t===null)throw Error(Bt(387));r=e.pendingProps,s=e.memoizedState,i=s.element,dD(t,e),S_(e,r,null,n);var l=e.memoizedState;if(r=l.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=_d(Error(Bt(423)),e),e=uM(t,e,r,n,i);break e}else if(r!==i){i=_d(Error(Bt(424)),e),e=uM(t,e,r,n,i);break e}else for(Oa=Ah(e.stateNode.containerInfo.firstChild),Na=e,mi=!0,eA=null,n=yD(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(gd(),r===i){e=oc(t,e,n);break e}Bo(t,e,r,n)}e=e.child}return e;case 5:return _D(e),t===null&&s3(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,l=i.children,e3(r,i)?l=null:s!==null&&e3(r,s)&&(e.flags|=32),$D(t,e),Bo(t,e,l,n),e.child;case 6:return t===null&&s3(e),null;case 13:return HD(t,e,n);case 4:return PT(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=md(e,null,r,n):Bo(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kl(r,i),aM(t,e,r,i,n);case 7:return Bo(t,e,e.pendingProps,n),e.child;case 8:return Bo(t,e,e.pendingProps.children,n),e.child;case 12:return Bo(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,l=i.value,ti(E_,r._currentValue),r._currentValue=l,s!==null)if(dA(s.value,l)){if(s.children===i.children&&!Aa.current){e=oc(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){l=s.child;for(var p=o.firstContext;p!==null;){if(p.context===r){if(s.tag===1){p=Ku(-1,n&-n),p.tag=2;var _=s.updateQueue;if(_!==null){_=_.shared;var C=_.pending;C===null?p.next=p:(p.next=C.next,C.next=p),_.pending=p}}s.lanes|=n,p=s.alternate,p!==null&&(p.lanes|=n),o3(s.return,n,e),o.lanes|=n;break}p=p.next}}else if(s.tag===10)l=s.type===e.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(Bt(341));l.lanes|=n,o=l.alternate,o!==null&&(o.lanes|=n),o3(l,n,e),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===e){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}Bo(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,td(e,n),i=Sl(i),r=r(i),e.flags|=1,Bo(t,e,r,n),e.child;case 14:return r=e.type,i=Kl(r,e.pendingProps),i=Kl(r.type,i),lM(t,e,r,i,n);case 15:return VD(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kl(r,i),Ry(t,e),e.tag=1,ua(r)?(t=!0,x_(e)):t=!1,td(e,n),gD(e,r,i),l3(e,r,i,n),c3(null,e,r,!0,t,n);case 19:return WD(t,e,n);case 22:return GD(t,e,n)}throw Error(Bt(156,e.tag))};function lR(t,e){return RL(t,e)}function aG(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _l(t,e,n,r){return new aG(t,e,n,r)}function jT(t){return t=t.prototype,!(!t||!t.isReactComponent)}function lG(t){if(typeof t=="function")return jT(t)?1:0;if(t!=null){if(t=t.$$typeof,t===AT)return 11;if(t===uT)return 14}return 2}function fh(t,e){var n=t.alternate;return n===null?(n=_l(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Oy(t,e,n,r,i,s){var l=2;if(r=t,typeof t=="function")jT(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case E0:return lf(n.children,i,s,e);case lT:l=8,i|=8;break;case Lb:return t=_l(12,n,e,i|2),t.elementType=Lb,t.lanes=s,t;case Db:return t=_l(13,n,e,i),t.elementType=Db,t.lanes=s,t;case Rb:return t=_l(19,n,e,i),t.elementType=Rb,t.lanes=s,t;case mL:return ov(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case pL:l=10;break e;case gL:l=9;break e;case AT:l=11;break e;case uT:l=14;break e;case Qc:l=16,r=null;break e}throw Error(Bt(130,t==null?t:typeof t,""))}return e=_l(l,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function lf(t,e,n,r){return t=_l(7,t,r,e),t.lanes=n,t}function ov(t,e,n,r){return t=_l(22,t,r,e),t.elementType=mL,t.lanes=n,t.stateNode={isHidden:!1},t}function sw(t,e,n){return t=_l(6,t,null,e),t.lanes=n,t}function ow(t,e,n){return e=_l(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function AG(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ux(0),this.expirationTimes=Ux(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ux(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function HT(t,e,n,r,i,s,l,o,p){return t=new AG(t,e,n,o,p),e===1?(e=1,s===!0&&(e|=8)):e=0,s=_l(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},MT(s),t}function uG(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:b0,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function AR(t){if(!t)return _h;t=t._reactInternals;e:{if(Df(t)!==t||t.tag!==1)throw Error(Bt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ua(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Bt(171))}if(t.tag===1){var n=t.type;if(ua(n))return lD(t,n,e)}return e}function uR(t,e,n,r,i,s,l,o,p){return t=HT(n,r,!0,t,i,s,l,o,p),t.context=AR(null),n=t.current,r=Uo(),i=hh(n),s=Ku(r,i),s.callback=e??null,uh(n,s,i),t.current.lanes=i,Sm(t,i,r),ca(t,r),t}function av(t,e,n,r){var i=e.current,s=Uo(),l=hh(i);return n=AR(n),e.context===null?e.context=n:e.pendingContext=n,e=Ku(s,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=uh(i,e,l),t!==null&&(hA(t,i,l,s),Iy(t,i,l)),l}function R_(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function vM(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function WT(t,e){vM(t,e),(t=t.alternate)&&vM(t,e)}function cG(){return null}var cR=typeof reportError=="function"?reportError:function(t){console.error(t)};function QT(t){this._internalRoot=t}lv.prototype.render=QT.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Bt(409));av(t,e,null,null)};lv.prototype.unmount=QT.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;gf(function(){av(null,t,null,null)}),e[ic]=null}};function lv(t){this._internalRoot=t}lv.prototype.unstable_scheduleHydration=function(t){if(t){var e=VL();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Yc.length&&e!==0&&e<Yc[n].priority;n++);Yc.splice(n,0,t),n===0&&$L(t)}};function qT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Av(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function xM(){}function hG(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var _=R_(l);s.call(_)}}var l=uR(e,r,t,0,null,!1,!1,"",xM);return t._reactRootContainer=l,t[ic]=l.current,Ug(t.nodeType===8?t.parentNode:t),gf(),l}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var _=R_(p);o.call(_)}}var p=HT(t,0,!1,null,null,!1,!1,"",xM);return t._reactRootContainer=p,t[ic]=p.current,Ug(t.nodeType===8?t.parentNode:t),gf(function(){av(e,p,n,r)}),p}function uv(t,e,n,r,i){var s=n._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var o=i;i=function(){var p=R_(l);o.call(p)}}av(e,l,t,i)}else l=hG(n,e,t,i,r);return R_(l)}NL=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Jp(e.pendingLanes);n!==0&&(fT(e,n|1),ca(e,Ni()),!(Cr&6)&&(vd=Ni()+500,Ih()))}break;case 13:gf(function(){var r=sc(t,1);if(r!==null){var i=Uo();hA(r,t,1,i)}}),WT(t,1)}};dT=function(t){if(t.tag===13){var e=sc(t,134217728);if(e!==null){var n=Uo();hA(e,t,134217728,n)}WT(t,134217728)}};UL=function(t){if(t.tag===13){var e=hh(t),n=sc(t,e);if(n!==null){var r=Uo();hA(n,t,e,r)}WT(t,e)}};VL=function(){return Or};GL=function(t,e){var n=Or;try{return Or=t,e()}finally{Or=n}};jb=function(t,e,n){switch(e){case"input":if(Ob(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=ev(r);if(!i)throw Error(Bt(90));_L(r),Ob(r,i)}}}break;case"textarea":xL(t,n);break;case"select":e=n.value,e!=null&&X0(t,!!n.multiple,e,!1)}};ML=VT;PL=gf;var fG={usingClientEntryPoint:!1,Events:[Mm,M0,ev,SL,CL,VT]},Cp={findFiberByHostInstance:tf,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},dG={bundleType:Cp.bundleType,version:Cp.version,rendererPackageName:Cp.rendererPackageName,rendererConfig:Cp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mc.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=LL(t),t===null?null:t.stateNode},findFiberByHostInstance:Cp.findFiberByHostInstance||cG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var F1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!F1.isDisabled&&F1.supportsFiber)try{Y2=F1.inject(dG),KA=F1}catch{}}Ha.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fG;Ha.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qT(e))throw Error(Bt(200));return uG(t,e,null,n)};Ha.createRoot=function(t,e){if(!qT(t))throw Error(Bt(299));var n=!1,r="",i=cR;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=HT(t,1,!1,null,null,n,!1,r,i),t[ic]=e.current,Ug(t.nodeType===8?t.parentNode:t),new QT(e)};Ha.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Bt(188)):(t=Object.keys(t).join(","),Error(Bt(268,t)));return t=LL(e),t=t===null?null:t.stateNode,t};Ha.flushSync=function(t){return gf(t)};Ha.hydrate=function(t,e,n){if(!Av(e))throw Error(Bt(200));return uv(null,t,e,!0,n)};Ha.hydrateRoot=function(t,e,n){if(!qT(t))throw Error(Bt(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",l=cR;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=uR(e,null,t,1,n??null,i,!1,s,l),t[ic]=e.current,Ug(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new lv(e)};Ha.render=function(t,e,n){if(!Av(e))throw Error(Bt(200));return uv(null,t,e,!1,n)};Ha.unmountComponentAtNode=function(t){if(!Av(t))throw Error(Bt(40));return t._reactRootContainer?(gf(function(){uv(null,null,t,!1,function(){t._reactRootContainer=null,t[ic]=null})}),!0):!1};Ha.unstable_batchedUpdates=VT;Ha.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Av(n))throw Error(Bt(200));if(t==null||t._reactInternals===void 0)throw Error(Bt(38));return uv(t,e,n,!1,r)};Ha.version="18.2.0-next-9e3b772b8-20220608";function hR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hR)}catch(t){console.error(t)}}hR(),uL.exports=Ha;var ZT=uL.exports,fR,wM=ZT;fR=wM.createRoot,wM.hydrateRoot;/**
 * @remix-run/router v1.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zg(){return Zg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Zg.apply(this,arguments)}var th;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(th||(th={}));const bM="popstate";function pG(t){t===void 0&&(t={});function e(i,s){let{pathname:l="/",search:o="",hash:p=""}=Rf(i.location.hash.substr(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),b3("",{pathname:l,search:o,hash:p},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){let l=i.document.querySelector("base"),o="";if(l&&l.getAttribute("href")){let p=i.location.href,_=p.indexOf("#");o=_===-1?p:p.slice(0,_)}return o+"#"+(typeof s=="string"?s:B_(s))}function r(i,s){cv(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return mG(e,n,r,t)}function Xi(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function cv(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function gG(){return Math.random().toString(36).substr(2,8)}function EM(t,e){return{usr:t.state,key:t.key,idx:e}}function b3(t,e,n,r){return n===void 0&&(n=null),Zg({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Rf(e):e,{state:n,key:e&&e.key||r||gG()})}function B_(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Rf(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function mG(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,l=i.history,o=th.Pop,p=null,_=C();_==null&&(_=0,l.replaceState(Zg({},l.state,{idx:_}),""));function C(){return(l.state||{idx:null}).idx}function M(){o=th.Pop;let ie=C(),Y=ie==null?null:ie-_;_=ie,p&&p({action:o,location:H.location,delta:Y})}function k(ie,Y){o=th.Push;let J=b3(H.location,ie,Y);n&&n(J,ie),_=C()+1;let se=EM(J,_),he=H.createHref(J);try{l.pushState(se,"",he)}catch(pe){if(pe instanceof DOMException&&pe.name==="DataCloneError")throw pe;i.location.assign(he)}s&&p&&p({action:o,location:H.location,delta:1})}function F(ie,Y){o=th.Replace;let J=b3(H.location,ie,Y);n&&n(J,ie),_=C();let se=EM(J,_),he=H.createHref(J);l.replaceState(se,"",he),s&&p&&p({action:o,location:H.location,delta:0})}function j(ie){let Y=i.location.origin!=="null"?i.location.origin:i.location.href,J=typeof ie=="string"?ie:B_(ie);return Xi(Y,"No window.location.(origin|href) available to create URL for href: "+J),new URL(J,Y)}let H={get action(){return o},get location(){return t(i,l)},listen(ie){if(p)throw new Error("A history only accepts one active listener");return i.addEventListener(bM,M),p=ie,()=>{i.removeEventListener(bM,M),p=null}},createHref(ie){return e(i,ie)},createURL:j,encodeLocation(ie){let Y=j(ie);return{pathname:Y.pathname,search:Y.search,hash:Y.hash}},push:k,replace:F,go(ie){return l.go(ie)}};return H}var TM;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(TM||(TM={}));function yG(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Rf(e):e,i=YT(r.pathname||"/",n);if(i==null)return null;let s=dR(t);_G(s);let l=null;for(let o=0;l==null&&o<s.length;++o)l=MG(s[o],IG(i));return l}function dR(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,l,o)=>{let p={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:l,route:s};p.relativePath.startsWith("/")&&(Xi(p.relativePath.startsWith(r),'Absolute route path "'+p.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),p.relativePath=p.relativePath.slice(r.length));let _=dh([r,p.relativePath]),C=n.concat(p);s.children&&s.children.length>0&&(Xi(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_+'".')),dR(s.children,e,C,_)),!(s.path==null&&!s.index)&&e.push({path:_,score:SG(_,s.index),routesMeta:C})};return t.forEach((s,l)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,l);else for(let p of pR(s.path))i(s,l,p)}),e}function pR(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let l=pR(r.join("/")),o=[];return o.push(...l.map(p=>p===""?s:[s,p].join("/"))),i&&o.push(...l),o.map(p=>t.startsWith("/")&&p===""?"/":p)}function _G(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:CG(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const vG=/^:[\w-]+$/,xG=3,wG=2,bG=1,EG=10,TG=-2,SM=t=>t==="*";function SG(t,e){let n=t.split("/"),r=n.length;return n.some(SM)&&(r+=TG),e&&(r+=wG),n.filter(i=>!SM(i)).reduce((i,s)=>i+(vG.test(s)?xG:s===""?bG:EG),r)}function CG(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function MG(t,e){let{routesMeta:n}=t,r={},i="/",s=[];for(let l=0;l<n.length;++l){let o=n[l],p=l===n.length-1,_=i==="/"?e:e.slice(i.length)||"/",C=PG({path:o.relativePath,caseSensitive:o.caseSensitive,end:p},_);if(!C)return null;Object.assign(r,C.params);let M=o.route;s.push({params:r,pathname:dh([i,C.pathname]),pathnameBase:zG(dh([i,C.pathnameBase])),route:M}),C.pathnameBase!=="/"&&(i=dh([i,C.pathnameBase]))}return s}function PG(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=kG(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],l=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((_,C,M)=>{let{paramName:k,isOptional:F}=C;if(k==="*"){let H=o[M]||"";l=s.slice(0,s.length-H.length).replace(/(.)\/+$/,"$1")}const j=o[M];return F&&!j?_[k]=void 0:_[k]=LG(j||"",k),_},{}),pathname:s,pathnameBase:l,pattern:t}}function kG(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),cv(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,p)=>(r.push({paramName:o,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function IG(t){try{return decodeURI(t)}catch(e){return cv(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function LG(t,e){try{return decodeURIComponent(t)}catch(n){return cv(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function YT(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function DG(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Rf(t):t;return{pathname:n?n.startsWith("/")?n:RG(n,e):e,search:OG(r),hash:FG(i)}}function RG(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function aw(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function BG(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function gR(t,e){let n=BG(t);return e?n.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function mR(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Rf(t):(i=Zg({},t),Xi(!i.pathname||!i.pathname.includes("?"),aw("?","pathname","search",i)),Xi(!i.pathname||!i.pathname.includes("#"),aw("#","pathname","hash",i)),Xi(!i.search||!i.search.includes("#"),aw("#","search","hash",i)));let s=t===""||i.pathname==="",l=s?"/":i.pathname,o;if(l==null)o=n;else{let M=e.length-1;if(!r&&l.startsWith("..")){let k=l.split("/");for(;k[0]==="..";)k.shift(),M-=1;i.pathname=k.join("/")}o=M>=0?e[M]:"/"}let p=DG(i,o),_=l&&l!=="/"&&l.endsWith("/"),C=(s||l===".")&&n.endsWith("/");return!p.pathname.endsWith("/")&&(_||C)&&(p.pathname+="/"),p}const dh=t=>t.join("/").replace(/\/\/+/g,"/"),zG=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),OG=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,FG=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function NG(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const yR=["post","put","patch","delete"];new Set(yR);const UG=["get",...yR];new Set(UG);/**
 * React Router v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yg(){return Yg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Yg.apply(this,arguments)}const XT=De.createContext(null),VG=De.createContext(null),Bf=De.createContext(null),hv=De.createContext(null),zf=De.createContext({outlet:null,matches:[],isDataRoute:!1}),_R=De.createContext(null);function GG(t,e){let{relative:n}=e===void 0?{}:e;km()||Xi(!1);let{basename:r,navigator:i}=De.useContext(Bf),{hash:s,pathname:l,search:o}=xR(t,{relative:n}),p=l;return r!=="/"&&(p=l==="/"?r:dh([r,l])),i.createHref({pathname:p,search:o,hash:s})}function km(){return De.useContext(hv)!=null}function fv(){return km()||Xi(!1),De.useContext(hv).location}function vR(t){De.useContext(Bf).static||De.useLayoutEffect(t)}function $G(){let{isDataRoute:t}=De.useContext(zf);return t?n$():jG()}function jG(){km()||Xi(!1);let t=De.useContext(XT),{basename:e,future:n,navigator:r}=De.useContext(Bf),{matches:i}=De.useContext(zf),{pathname:s}=fv(),l=JSON.stringify(gR(i,n.v7_relativeSplatPath)),o=De.useRef(!1);return vR(()=>{o.current=!0}),De.useCallback(function(_,C){if(C===void 0&&(C={}),!o.current)return;if(typeof _=="number"){r.go(_);return}let M=mR(_,JSON.parse(l),s,C.relative==="path");t==null&&e!=="/"&&(M.pathname=M.pathname==="/"?e:dh([e,M.pathname])),(C.replace?r.replace:r.push)(M,C.state,C)},[e,r,l,s,t])}function xR(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=De.useContext(Bf),{matches:i}=De.useContext(zf),{pathname:s}=fv(),l=JSON.stringify(gR(i,r.v7_relativeSplatPath));return De.useMemo(()=>mR(t,JSON.parse(l),s,n==="path"),[t,l,s,n])}function HG(t,e){return WG(t,e)}function WG(t,e,n,r){km()||Xi(!1);let{navigator:i}=De.useContext(Bf),{matches:s}=De.useContext(zf),l=s[s.length-1],o=l?l.params:{};l&&l.pathname;let p=l?l.pathnameBase:"/";l&&l.route;let _=fv(),C;if(e){var M;let ie=typeof e=="string"?Rf(e):e;p==="/"||(M=ie.pathname)!=null&&M.startsWith(p)||Xi(!1),C=ie}else C=_;let k=C.pathname||"/",F=p==="/"?k:k.slice(p.length)||"/",j=yG(t,{pathname:F}),H=XG(j&&j.map(ie=>Object.assign({},ie,{params:Object.assign({},o,ie.params),pathname:dh([p,i.encodeLocation?i.encodeLocation(ie.pathname).pathname:ie.pathname]),pathnameBase:ie.pathnameBase==="/"?p:dh([p,i.encodeLocation?i.encodeLocation(ie.pathnameBase).pathname:ie.pathnameBase])})),s,n,r);return e&&H?De.createElement(hv.Provider,{value:{location:Yg({pathname:"/",search:"",hash:"",state:null,key:"default"},C),navigationType:th.Pop}},H):H}function QG(){let t=t$(),e=NG(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return De.createElement(De.Fragment,null,De.createElement("h2",null,"Unexpected Application Error!"),De.createElement("h3",{style:{fontStyle:"italic"}},e),n?De.createElement("pre",{style:i},n):null,s)}const qG=De.createElement(QG,null);class ZG extends De.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?De.createElement(zf.Provider,{value:this.props.routeContext},De.createElement(_R.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function YG(t){let{routeContext:e,match:n,children:r}=t,i=De.useContext(XT);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),De.createElement(zf.Provider,{value:e},r)}function XG(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let l=t,o=(i=n)==null?void 0:i.errors;if(o!=null){let C=l.findIndex(M=>M.route.id&&o?.[M.route.id]);C>=0||Xi(!1),l=l.slice(0,Math.min(l.length,C+1))}let p=!1,_=-1;if(n&&r&&r.v7_partialHydration)for(let C=0;C<l.length;C++){let M=l[C];if((M.route.HydrateFallback||M.route.hydrateFallbackElement)&&(_=C),M.route.id){let{loaderData:k,errors:F}=n,j=M.route.loader&&k[M.route.id]===void 0&&(!F||F[M.route.id]===void 0);if(M.route.lazy||j){p=!0,_>=0?l=l.slice(0,_+1):l=[l[0]];break}}}return l.reduceRight((C,M,k)=>{let F,j=!1,H=null,ie=null;n&&(F=o&&M.route.id?o[M.route.id]:void 0,H=M.route.errorElement||qG,p&&(_<0&&k===0?(r$("route-fallback",!1),j=!0,ie=null):_===k&&(j=!0,ie=M.route.hydrateFallbackElement||null)));let Y=e.concat(l.slice(0,k+1)),J=()=>{let se;return F?se=H:j?se=ie:M.route.Component?se=De.createElement(M.route.Component,null):M.route.element?se=M.route.element:se=C,De.createElement(YG,{match:M,routeContext:{outlet:C,matches:Y,isDataRoute:n!=null},children:se})};return n&&(M.route.ErrorBoundary||M.route.errorElement||k===0)?De.createElement(ZG,{location:n.location,revalidation:n.revalidation,component:H,error:F,children:J(),routeContext:{outlet:null,matches:Y,isDataRoute:!0}}):J()},null)}var wR=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(wR||{}),z_=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(z_||{});function KG(t){let e=De.useContext(XT);return e||Xi(!1),e}function JG(t){let e=De.useContext(VG);return e||Xi(!1),e}function e$(t){let e=De.useContext(zf);return e||Xi(!1),e}function bR(t){let e=e$(),n=e.matches[e.matches.length-1];return n.route.id||Xi(!1),n.route.id}function t$(){var t;let e=De.useContext(_R),n=JG(z_.UseRouteError),r=bR(z_.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function n$(){let{router:t}=KG(wR.UseNavigateStable),e=bR(z_.UseNavigateStable),n=De.useRef(!1);return vR(()=>{n.current=!0}),De.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Yg({fromRouteId:e},s)))},[t,e])}const CM={};function r$(t,e,n){!e&&!CM[t]&&(CM[t]=!0)}function cl(t){Xi(!1)}function i$(t){let{basename:e="/",children:n=null,location:r,navigationType:i=th.Pop,navigator:s,static:l=!1,future:o}=t;km()&&Xi(!1);let p=e.replace(/^\/*/,"/"),_=De.useMemo(()=>({basename:p,navigator:s,static:l,future:Yg({v7_relativeSplatPath:!1},o)}),[p,o,s,l]);typeof r=="string"&&(r=Rf(r));let{pathname:C="/",search:M="",hash:k="",state:F=null,key:j="default"}=r,H=De.useMemo(()=>{let ie=YT(C,p);return ie==null?null:{location:{pathname:ie,search:M,hash:k,state:F,key:j},navigationType:i}},[p,C,M,k,F,j,i]);return H==null?null:De.createElement(Bf.Provider,{value:_},De.createElement(hv.Provider,{children:n,value:H}))}function s$(t){let{children:e,location:n}=t;return HG(E3(e),n)}new Promise(()=>{});function E3(t,e){e===void 0&&(e=[]);let n=[];return De.Children.forEach(t,(r,i)=>{if(!De.isValidElement(r))return;let s=[...e,i];if(r.type===De.Fragment){n.push.apply(n,E3(r.props.children,s));return}r.type!==cl&&Xi(!1),!r.props.index||!r.props.children||Xi(!1);let l={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=E3(r.props.children,s)),n.push(l)}),n}/**
 * React Router DOM v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function T3(){return T3=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},T3.apply(this,arguments)}function o$(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function a$(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function l$(t,e){return t.button===0&&(!e||e==="_self")&&!a$(t)}const A$=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],u$="6";try{window.__reactRouterVersion=u$}catch{}const c$="startTransition",MM=cU[c$];function h$(t){let{basename:e,children:n,future:r,window:i}=t,s=De.useRef();s.current==null&&(s.current=pG({window:i,v5Compat:!0}));let l=s.current,[o,p]=De.useState({action:l.action,location:l.location}),{v7_startTransition:_}=r||{},C=De.useCallback(M=>{_&&MM?MM(()=>p(M)):p(M)},[p,_]);return De.useLayoutEffect(()=>l.listen(C),[l,C]),De.createElement(i$,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:l,future:r})}const f$=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",d$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bu=De.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:l,state:o,target:p,to:_,preventScrollReset:C,unstable_viewTransition:M}=e,k=o$(e,A$),{basename:F}=De.useContext(Bf),j,H=!1;if(typeof _=="string"&&d$.test(_)&&(j=_,f$))try{let se=new URL(window.location.href),he=_.startsWith("//")?new URL(se.protocol+_):new URL(_),pe=YT(he.pathname,F);he.origin===se.origin&&pe!=null?_=pe+he.search+he.hash:H=!0}catch{}let ie=GG(_,{relative:i}),Y=p$(_,{replace:l,state:o,target:p,preventScrollReset:C,relative:i,unstable_viewTransition:M});function J(se){r&&r(se),se.defaultPrevented||Y(se)}return De.createElement("a",T3({},k,{href:j||ie,onClick:H||s?r:J,ref:n,target:p}))});var PM;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(PM||(PM={}));var kM;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(kM||(kM={}));function p$(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:l,unstable_viewTransition:o}=e===void 0?{}:e,p=$G(),_=fv(),C=xR(t,{relative:l});return De.useCallback(M=>{if(l$(M,n)){M.preventDefault();let k=r!==void 0?r:B_(_)===B_(C);p(t,{replace:k,state:i,preventScrollReset:s,relative:l,unstable_viewTransition:o})}},[_,p,C,r,i,n,t,s,l,o])}function O_(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const KT=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),IM=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);IM&&parseFloat(IM[1]);const g$="3.4.14";function ac(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Fy=typeof process!="object"||String(process)!=="[object process]"||process.browser,m$=typeof window<"u"&&typeof window.orientation<"u",LM=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);LM&&parseFloat(LM[1]);function Xg(t){"@babel/helpers - typeof";return Xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xg(t)}function y$(t,e){if(Xg(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Xg(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _$(t){var e=y$(t,"string");return Xg(e)==="symbol"?e:String(e)}function oe(t,e,n){return e=_$(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class v${constructor(e,n){oe(this,"name",void 0),oe(this,"workerThread",void 0),oe(this,"isRunning",!0),oe(this,"result",void 0),oe(this,"_resolve",()=>{}),oe(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){ac(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ac(this.isRunning),this.isRunning=!1,this._reject(e)}}let lw=class{terminate(){}};const Aw=new Map;function x$(t){ac(t.source&&!t.url||!t.source&&t.url);let e=Aw.get(t.source||t.url);return e||(t.url&&(e=w$(t.url),Aw.set(t.url,e)),t.source&&(e=ER(t.source),Aw.set(t.source,e))),ac(e),e}function w$(t){if(!t.startsWith("http"))return t;const e=b$(t);return ER(e)}function ER(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function b$(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function TR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(DM(t))r.add(t);else if(DM(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)TR(t[i],e,r)}}return n===void 0?Array.from(r):[]}function DM(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const uw=()=>{};class S3{static isSupported(){return typeof Worker<"u"&&Fy||typeof lw<"u"&&!Fy}constructor(e){oe(this,"name",void 0),oe(this,"source",void 0),oe(this,"url",void 0),oe(this,"terminated",!1),oe(this,"worker",void 0),oe(this,"onMessage",void 0),oe(this,"onError",void 0),oe(this,"_loadableURL","");const{name:n,source:r,url:i}=e;ac(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=uw,this.onError=s=>console.log(s),this.worker=Fy?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=uw,this.onError=uw,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||TR(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=x$({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new lw(r,{eval:!1})}else if(this.source)e=new lw(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class E${static isSupported(){return S3.isSupported()}constructor(e){oe(this,"name","unnamed"),oe(this,"source",void 0),oe(this,"url",void 0),oe(this,"maxConcurrency",1),oe(this,"maxMobileConcurrency",1),oe(this,"onDebug",()=>{}),oe(this,"reuseWorkers",!0),oe(this,"props",{}),oe(this,"jobQueue",[]),oe(this,"idleQueue",[]),oe(this,"count",0),oe(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,l,o)=>s.done(o),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,l)=>s.error(l);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new v$(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new S3({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return m$?this.maxMobileConcurrency:this.maxConcurrency}}const T$={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class $u{static isSupported(){return S3.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return $u._workerFarm=$u._workerFarm||new $u({}),$u._workerFarm.setProps(e),$u._workerFarm}constructor(e){oe(this,"props",void 0),oe(this,"workerPools",new Map),this.props={...T$},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new E$({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}oe($u,"_workerFarm",void 0);const S$="latest";function C$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=S$);const l=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(l,"/dist/").concat(r)}return ac(i),i}function M$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g$;ac(t,"no worker provided");const n=t.version;return!(!e||!n)}function P$(t,e){return!$u.isSupported()||!Fy&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&e?.worker}async function k$(t,e,n,r,i){const s=t.id,l=C$(t,n),p=$u.getWorkerFarm(n).getWorkerPool({name:s,url:l});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const _=await p.startJob("process-on-worker",I$.bind(null,i));return _.postMessage("process",{input:e,options:n,context:r}),await(await _.result).result}async function I$(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:l}=r;try{const o=await t(s,l);e.postMessage("done",{id:i,result:o})}catch(o){const p=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:p})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function L$(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function D$(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),i=r.reduce((o,p)=>o+p.byteLength,0),s=new Uint8Array(i);let l=0;for(const o of r)s.set(o,l),l+=o.byteLength;return s.buffer}async function R$(t){const e=[];for await(const n of t)e.push(n);return D$(...e)}function RM(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let BM=class{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=RM(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(RM()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},B$=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof BM?i=e:i=new BM(n,r),this.stats[n]=i),i}};const z$="Queued Requests",O$="Active Requests",F$="Cancelled Requests",N$="Queued Requests Ever",U$="Active Requests Ever",V$={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class G${constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};oe(this,"props",void 0),oe(this,"stats",void 0),oe(this,"activeRequestCount",0),oe(this,"requestQueue",[]),oe(this,"requestMap",new Map),oe(this,"deferredUpdate",null),this.props={...V$,...e},this.stats=new B$({id:this.props.id}),this.stats.get(z$),this.stats.get(O$),this.stats.get(F$),this.stats.get(N$),this.stats.get(U$)}scheduleRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:n},i=new Promise(s=>(r.resolve=s,r));return this.requestQueue.push(r),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){const{handle:n,resolve:r}=e;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const r=e[n];this._updateRequest(r)||(e.splice(n,1),this.requestMap.delete(r.handle),n--)}e.sort((n,r)=>n.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let $$="";const zM={};function j$(t){for(const e in zM)if(t.startsWith(e)){const n=zM[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat($$).concat(t)),t}function H$(t){return t&&typeof t=="object"&&t.isBuffer}function SR(t){if(H$(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function CR(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function W$(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const Q$=t=>typeof t=="boolean",xg=t=>typeof t=="function",Im=t=>t!==null&&typeof t=="object",OM=t=>Im(t)&&t.constructor==={}.constructor,q$=t=>t&&typeof t[Symbol.iterator]=="function",Z$=t=>t&&typeof t[Symbol.asyncIterator]=="function",Of=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Ff=t=>typeof Blob<"u"&&t instanceof Blob,Y$=t=>t&&typeof t=="object"&&t.isBuffer,X$=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Im(t)&&xg(t.tee)&&xg(t.cancel)&&xg(t.getReader),K$=t=>Im(t)&&xg(t.read)&&xg(t.pipe)&&Q$(t.readable),MR=t=>X$(t)||K$(t),J$=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,ej=/^([-\w.]+\/[-\w.+]+)/;function tj(t){const e=ej.exec(t);return e?e[1]:t}function FM(t){const e=J$.exec(t);return e?e[1]:""}const PR=/\?.*/;function nj(t){const e=t.match(PR);return e&&e[0]}function JT(t){return t.replace(PR,"")}function dv(t){return Of(t)?t.url:Ff(t)?t.name||"":typeof t=="string"?t:""}function eS(t){if(Of(t)){const e=t,n=e.headers.get("content-type")||"",r=JT(e.url);return tj(n)||FM(r)}return Ff(t)?t.type||"":typeof t=="string"?FM(t):""}function rj(t){return Of(t)?t.headers["content-length"]||-1:Ff(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function kR(t){if(Of(t))return t;const e={},n=rj(t);n>=0&&(e["content-length"]=String(n));const r=dv(t),i=eS(t);i&&(e["content-type"]=i);const s=await oj(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const l=new Response(t,{headers:e});return Object.defineProperty(l,"url",{value:r}),l}async function ij(t){if(!t.ok){const e=await sj(t);throw new Error(e)}}async function sj(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function oj(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var l;return r(s==null||(l=s.target)===null||l===void 0?void 0:l.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=aj(n);return"data:base64,".concat(r)}return null}function aj(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function NM(t,e){if(typeof t=="string"){t=j$(t);let n=e;return e!=null&&e.fetch&&typeof e?.fetch!="function"&&(n=e.fetch),await fetch(t,n)}return await kR(t)}function lj(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Lm(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||lj()}const N1=globalThis.window||globalThis.self||globalThis.global,Mp=globalThis.process||{},IR=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Lm();function Aj(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let uj=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=Aj(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function cj(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function hj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function cw(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,l=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let F_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(F_||(F_={}));const fj=10;function UM(t){return typeof t!="string"?t:(t=t.toUpperCase(),F_[t]||F_.WHITE)}function dj(t,e,n){if(!Lm&&typeof t=="string"){if(e){const r=UM(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=UM(n);t="\x1B[".concat(r+fj,"m").concat(t,"\x1B[49m")}}return t}function pj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const l=i[s];typeof l=="function"&&(e.find(o=>s===o)||(i[s]=l.bind(t)))}}function N_(t,e){if(!t)throw new Error(e||"Assertion failed")}function l0(){let t;if(Lm()&&N1.performance){var e,n;t=N1==null||(e=N1.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Mp){var r;const i=Mp==null||(r=Mp.hrtime)===null||r===void 0?void 0:r.call(Mp);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const A0={debug:Lm()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},gj={enabled:!0,level:0};function fl(){}const VM={},GM={once:!0};let tS=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=IR,this._startTs=l0(),this._deltaTs=l0(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new uj("__probe-".concat(this.id,"__"),gj),this.timeStamp("".concat(this.id," started")),pj(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((l0()-this._startTs).toPrecision(10))}getDelta(){return Number((l0()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){N_(e,n)}warn(e){return this._getLogFunction(0,e,A0.warn,arguments,GM)}error(e){return this._getLogFunction(0,e,A0.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,A0.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,A0.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,A0.debug||A0.info,arguments,GM)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||fl,r&&[r],{tag:vj(n)}):fl}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:l=1}=e;return this._shouldLog(n||r)?Lm()?_j({image:i,message:s,scale:l}):yj():fl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||fl)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=$M({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||fl)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=LR(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=$M({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,N_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=l0();const l=s.tag||s.message;if(s.once&&l)if(!VM[l])VM[l]=l0();else return fl;return n=mj(this.id,s.message,s),r.bind(console,n,...s.args)}return fl}};tS.VERSION=IR;function LR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return N_(Number.isFinite(e)&&e>=0),e}function $M(t){const{logLevel:e,message:n}=t;t.logLevel=LR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return N_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function mj(t,e,n){if(typeof e=="string"){const r=n.time?hj(cj(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=dj(e,n.color,n.background)}return e}function yj(t){return console.warn("removed"),fl}function _j(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const l=cw(s,n,r);console.log(...l)},s.src=e,fl}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...cw(e,n,r)),fl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...cw(s,n,r)),s.src=e.toDataURL(),fl}return fl}function vj(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const jM=new tS({id:"loaders.gl"});class xj{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class wj{constructor(){oe(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const DR={fetch:null,mimeType:void 0,nothrow:!1,log:new wj,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:KT,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},bj={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function RR(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const BR=()=>{const t=RR();return t.globalOptions=t.globalOptions||{...DR},t.globalOptions};function Ej(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],Tj(t,n),Cj(e,t,r)}function Tj(t,e){HM(t,null,DR,bj,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};HM(r,n.id,i,s,e)}}function HM(t,e,n,r,i){const s=e||"Top level",l=e?"".concat(e,"."):"";for(const o in t){const p=!e&&Im(t[o]),_=o==="baseUri"&&!e,C=o==="workerUrl"&&e;if(!(o in n)&&!_&&!C){if(o in r)jM.warn("".concat(s," loader option '").concat(l).concat(o,"' no longer supported, use '").concat(r[o],"'"))();else if(!p){const M=Sj(o,i);jM.warn("".concat(s," loader option '").concat(l).concat(o,"' not recognized. ").concat(M))()}}}}function Sj(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const l=s.toLowerCase();(n.startsWith(l)||l.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function Cj(t,e,n){const i={...t.options||{}};return Mj(i,n),i.log===null&&(i.log=new xj),WM(i,BR()),WM(i,e),i}function WM(t,e){for(const n in e)if(n in e){const r=e[n];OM(r)&&OM(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function Mj(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function nS(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function rS(t){var e,n;O_(t,"null loader"),O_(nS(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const zR=()=>{const t=RR();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function Pj(t){const e=zR();t=Array.isArray(t)?t:[t];for(const n of t){const r=rS(n);e.find(i=>r===i)||e.unshift(r)}}function kj(){return zR()}const Ij=new tS({id:"loaders.gl"}),Lj=/\.([^.]+)$/;async function Dj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!OR(t))return null;let i=QM(t,e,{...n,nothrow:!0},r);if(i)return i;if(Ff(t)&&(t=await t.slice(0,10).arrayBuffer(),i=QM(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(FR(t));return i}function QM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!OR(t))return null;if(e&&!Array.isArray(e))return rS(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...kj()),Bj(i);const s=Rj(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(FR(t));return s}function Rj(t,e,n,r){const i=dv(t),s=eS(t),l=JT(i)||r?.url;let o=null,p="";if(n!=null&&n.mimeType&&(o=hw(e,n?.mimeType),p="match forced by supplied MIME type ".concat(n?.mimeType)),o=o||zj(e,l),p=p||(o?"matched url ".concat(l):""),o=o||hw(e,s),p=p||(o?"matched MIME type ".concat(s):""),o=o||Fj(e,t),p=p||(o?"matched initial data ".concat(NR(t)):""),o=o||hw(e,n?.fallbackMimeType),p=p||(o?"matched fallback MIME type ".concat(s):""),p){var _;Ij.log(1,"selectLoader selected ".concat((_=o)===null||_===void 0?void 0:_.name,": ").concat(p,"."))}return o}function OR(t){return!(t instanceof Response&&t.status===204)}function FR(t){const e=dv(t),n=eS(t);let r="No valid loader found (";r+=e?"".concat(CR(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?NR(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function Bj(t){for(const e of t)rS(e)}function zj(t,e){const n=e&&Lj.exec(e),r=n&&n[1];return r?Oj(t,r):null}function Oj(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function hw(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function Fj(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(Nj(e,n))return n}else if(ArrayBuffer.isView(e)){if(qM(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&qM(e,0,n))return n;return null}function Nj(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function qM(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>Uj(t,e,n,i))}function Uj(t,e,n,r){if(r instanceof ArrayBuffer)return L$(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=C3(t,e,r.length);return r===i;default:return!1}}function NR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?C3(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?C3(t,0,e):""}function C3(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const Vj=256*1024;function*Gj(t,e){const n=e?.chunkSize||Vj;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),l=t.slice(r,r+s);r+=s,yield i.encode(l)}}const $j=256*1024;function jj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=$j}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),l=new Uint8Array(t,r,i);new Uint8Array(s).set(l),r+=i,yield s}}()}const Hj=1024*1024;async function*Wj(t,e){const n=e?.chunkSize||Hj;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function ZM(t,e){return KT?Qj(t,e):qj(t)}async function*Qj(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:l}=await i;if(s)return;yield SR(l)}}catch{n.releaseLock()}}async function*qj(t,e){for await(const n of t)yield SR(n)}function Zj(t,e){if(typeof t=="string")return Gj(t,e);if(t instanceof ArrayBuffer)return jj(t,e);if(Ff(t))return Wj(t,e);if(MR(t))return ZM(t,e);if(Of(t))return ZM(t.body,e);throw new Error("makeIterator")}const UR="Cannot convert supplied data type";function Yj(t,e,n){if(e.text&&typeof t=="string")return t;if(Y$(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(UR)}async function Xj(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return Yj(t,e);if(Ff(t)&&(t=await kR(t)),Of(t)){const i=t;return await ij(i),e.binary?await i.arrayBuffer():await i.text()}if(MR(t)&&(t=Zj(t,n)),q$(t)||Z$(t))return R$(t);throw new Error(UR)}function VR(t,e){const n=BR(),r=t||n;return typeof r.fetch=="function"?r.fetch:Im(r.fetch)?i=>NM(i,r):e!=null&&e.fetch?e?.fetch:NM}function Kj(t,e,n){if(n)return n;const r={fetch:VR(e,t),...t};if(r.url){const i=JT(r.url);r.baseUrl=i,r.queryString=nj(r.url),r.filename=CR(i),r.baseUrl=W$(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function Jj(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function iS(t,e,n,r){ac(!r||typeof r=="object"),e&&!Array.isArray(e)&&!nS(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=dv(t),l=Jj(e,r),o=await Dj(t,l,n);return o?(n=Ej(n,o,l,i),r=Kj({url:i,parse:iS,loaders:l},n,r||null),await eH(o,t,n,r)):null}async function eH(t,e,n,r){if(M$(t),Of(e)){const i=e,{ok:s,redirected:l,status:o,statusText:p,type:_,url:C}=i,M=Object.fromEntries(i.headers.entries());r.response={headers:M,ok:s,redirected:l,status:o,statusText:p,type:_,url:C}}if(e=await Xj(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(P$(t,n))return await k$(t,e,n,r,iS);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw ac(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function U_(t,e,n,r){!Array.isArray(e)&&!nS(e)&&(n=e,e=void 0);const i=VR(n);let s=t;return typeof t=="string"&&(s=await i(t)),Ff(t)&&(s=await i(t)),await iS(s,e,n)}const tH="3.4.14",{_parseImageNode:nH}=globalThis,M3=typeof Image<"u",P3=typeof ImageBitmap<"u",rH=!!nH,k3=KT?!0:rH;function iH(t){switch(t){case"auto":return P3||M3||k3;case"imagebitmap":return P3;case"image":return M3;case"data":return k3;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function sH(){if(P3)return"imagebitmap";if(M3)return"image";if(k3)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function oH(t){const e=lH(t);if(!e)throw new Error("Not an image");return e}function aH(t){switch(oH(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function lH(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const AH=/^data:image\/svg\+xml/,uH=/\.svg((\?|#).*)?$/;function sS(t){return t&&(AH.test(t)||uH.test(t))}function cH(t,e){if(sS(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return GR(t,e)}function GR(t,e){if(sS(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function $R(t,e,n){const r=cH(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await hH(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function hH(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const fH={};let YM=!0;async function dH(t,e,n){let r;sS(n)?r=await $R(t,e,n):r=GR(t,n);const i=e&&e.imagebitmap;return await pH(r,i)}async function pH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((gH(e)||!YM)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),YM=!1}return await createImageBitmap(t)}function gH(t){for(const e in t||fH)return!1;return!0}function mH(t){return!xH(t,"ftyp",4)||!(t[8]&96)?null:yH(t)}function yH(t){switch(_H(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function _H(t,e,n){return String.fromCharCode(...t.slice(e,n))}function vH(t){return[...t].map(e=>e.charCodeAt(0))}function xH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=vH(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const qA=!1,wg=!0;function jR(t){const e=Dm(t);return bH(e)||SH(e)||EH(e)||TH(e)||wH(e)}function wH(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=mH(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function bH(t){const e=Dm(t);return e.byteLength>=24&&e.getUint32(0,qA)===2303741511?{mimeType:"image/png",width:e.getUint32(16,qA),height:e.getUint32(20,qA)}:null}function EH(t){const e=Dm(t);return e.byteLength>=10&&e.getUint32(0,qA)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,wg),height:e.getUint16(8,wg)}:null}function TH(t){const e=Dm(t);return e.byteLength>=14&&e.getUint16(0,qA)===16973&&e.getUint32(2,wg)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,wg),height:e.getUint32(22,wg)}:null}function SH(t){const e=Dm(t);if(!(e.byteLength>=3&&e.getUint16(0,qA)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=CH();let s=2;for(;s+9<e.byteLength;){const l=e.getUint16(s,qA);if(i.has(l))return{mimeType:"image/jpeg",height:e.getUint16(s+5,qA),width:e.getUint16(s+7,qA)};if(!r.has(l))return null;s+=2,s+=e.getUint16(s,qA)}return null}function CH(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Dm(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function MH(t,e){const{mimeType:n}=jR(t)||{},r=globalThis._parseImageNode;return O_(r),await r(t,n)}async function PH(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},l=kH(i);let o;switch(l){case"imagebitmap":o=await dH(t,e,s);break;case"image":o=await $R(t,e,s);break;case"data":o=await MH(t);break;default:O_(!1)}return i==="data"&&(o=aH(o)),o}function kH(t){switch(t){case"auto":case"data":return sH();default:return iH(t),t}}const IH=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],LH=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],DH={image:{type:"auto",decode:!0}},RH={id:"image",module:"images",name:"Images",version:tH,mimeTypes:LH,extensions:IH,parse:PH,tests:[t=>!!jR(new DataView(t))],options:DH};function HR(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function $d(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||HR()}const Ny={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},U1=Ny.window||Ny.self||Ny.global,Pp=Ny.process||{},WR=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";$d();const fw=globalThis;function BH(t){if(!t&&!$d())return"Node";if(HR(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":fw.chrome?"Chrome":fw.safari?"Safari":fw.mozInnerScreenX?"Firefox":"Unknown"}function zH(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let OH=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";oe(this,"storage",void 0),oe(this,"id",void 0),oe(this,"config",void 0),this.storage=zH(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function FH(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function NH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function dw(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,l=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let V_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(V_||(V_={}));function XM(t){return typeof t=="string"?V_[t.toUpperCase()]||V_.WHITE:t}function UH(t,e,n){return!$d&&typeof t=="string"&&(e&&(e=XM(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=XM(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function VH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function G_(t,e){if(!t)throw new Error(e||"Assertion failed")}function u0(){let t;if($d&&"performance"in U1){var e,n;t=U1==null||(e=U1.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Pp){var r;const i=Pp==null||(r=Pp.hrtime)===null||r===void 0?void 0:r.call(Pp);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const c0={debug:$d&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},GH={enabled:!0,level:0};function dl(){}const KM={},JM={once:!0};let QR=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};oe(this,"id",void 0),oe(this,"VERSION",WR),oe(this,"_startTs",u0()),oe(this,"_deltaTs",u0()),oe(this,"_storage",void 0),oe(this,"userData",{}),oe(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new OH("__probe-".concat(this.id,"__"),GH),this.timeStamp("".concat(this.id," started")),VH(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((u0()-this._startTs).toPrecision(10))}getDelta(){return Number((u0()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){G_(e,n)}warn(e){return this._getLogFunction(0,e,c0.warn,arguments,JM)}error(e){return this._getLogFunction(0,e,c0.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,c0.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,c0.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,c0.debug||c0.info,arguments,JM)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||dl,r&&[r],{tag:WH(n)}):dl}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:l=1}=e;return this._shouldLog(n||r)?$d?HH({image:i,message:s,scale:l}):jH():dl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||dl)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=eP({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||dl)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=qR(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=eP({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,G_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=u0();const l=s.tag||s.message;if(s.once)if(!KM[l])KM[l]=u0();else return dl;return n=$H(this.id,s.message,s),r.bind(console,n,...s.args)}return dl}};oe(QR,"VERSION",WR);function qR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return G_(Number.isFinite(e)&&e>=0),e}function eP(t){const{logLevel:e,message:n}=t;t.logLevel=qR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return G_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function $H(t,e,n){if(typeof e=="string"){const r=n.time?NH(FH(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=UH(e,n.color,n.background)}return e}function jH(t){return console.warn("removed"),dl}function HH(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const l=dw(s,n,r);console.log(...l)},s.src=e,dl}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...dw(e,n,r)),dl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...dw(s,n,r)),s.src=e.toDataURL(),dl}return dl}function WH(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const or=new QR({id:"deck"});let I3={};function QH(t){I3=t}function co(t,e,n,r){or.level>0&&I3[t]&&I3[t].call(null,e,n,r)}function qH(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const ZH={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:qH,parseTextSync:JSON.parse};function YH(){const t="8.9.32",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(or.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:or,_registerLoggers:QH},Pj([ZH,[RH,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const XH=YH(),fr={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(fr,"IDENTITY",{get:()=>(or.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const iA={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},mf={common:0,meters:1,pixels:2},tP={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};function KH(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function jd(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||KH()}const Uy={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},V1=Uy.window||Uy.self||Uy.global,kp=Uy.process||{},ZR=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";jd();function JH(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class eW{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";oe(this,"storage",void 0),oe(this,"id",void 0),oe(this,"config",void 0),this.storage=JH(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function tW(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function nW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function pw(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,l=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let $_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})($_||($_={}));function nP(t){return typeof t=="string"?$_[t.toUpperCase()]||$_.WHITE:t}function rW(t,e,n){return!jd&&typeof t=="string"&&(e&&(e=nP(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=nP(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function iW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function j_(t,e){if(!t)throw new Error(e||"Assertion failed")}function h0(){let t;if(jd&&"performance"in V1){var e,n;t=V1==null||(e=V1.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in kp){var r;const i=kp==null||(r=kp.hrtime)===null||r===void 0?void 0:r.call(kp);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const f0={debug:jd&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},sW={enabled:!0,level:0};function pl(){}const rP={},iP={once:!0};class YR{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};oe(this,"id",void 0),oe(this,"VERSION",ZR),oe(this,"_startTs",h0()),oe(this,"_deltaTs",h0()),oe(this,"_storage",void 0),oe(this,"userData",{}),oe(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new eW("__probe-".concat(this.id,"__"),sW),this.timeStamp("".concat(this.id," started")),iW(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((h0()-this._startTs).toPrecision(10))}getDelta(){return Number((h0()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){j_(e,n)}warn(e){return this._getLogFunction(0,e,f0.warn,arguments,iP)}error(e){return this._getLogFunction(0,e,f0.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,f0.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,f0.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,f0.debug||f0.info,arguments,iP)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||pl,r&&[r],{tag:AW(n)}):pl}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:l=1}=e;return this._shouldLog(n||r)?jd?lW({image:i,message:s,scale:l}):aW():pl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||pl)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=sP({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||pl)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=XR(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=sP({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,j_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=h0();const l=s.tag||s.message;if(s.once)if(!rP[l])rP[l]=h0();else return pl;return n=oW(this.id,s.message,s),r.bind(console,n,...s.args)}return pl}}oe(YR,"VERSION",ZR);function XR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return j_(Number.isFinite(e)&&e>=0),e}function sP(t){const{logLevel:e,message:n}=t;t.logLevel=XR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return j_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function oW(t,e,n){if(typeof e=="string"){const r=n.time?nW(tW(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=rW(e,n.color,n.background)}return e}function aW(t){return console.warn("removed"),pl}function lW(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const l=pw(s,n,r);console.log(...l)},s.src=e,pl}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...pw(e,n,r)),pl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...pw(s,n,r)),s.src=e.toDataURL(),pl}return pl}function AW(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const vn=new YR({id:"luma.gl"});function zo(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const uW="Invalid WebGLRenderingContext",cW="Requires WebGL2";function pv(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function dr(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function hW(t){return dr(t)?t:null}function gv(t){return zo(pv(t),uW),t}function po(t){return zo(dr(t),cW),t}const tg={};function fW(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function dW(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function pW(t,e){tg[t]=!0,e!==void 0&&fW(e)}function gW(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(tg[r]=!0);while(r!==0);for(r in tg)if(tg[r])return delete tg[r],parseInt(r,10);return 0}}const Rm=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Rm.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Rm.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Nf=function(e){const n=this;this.gl=e,gW(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const l=n.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,s);const o=l.attribs[s];return o.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const l=n.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,s);const o=l.attribs[s];return o.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,l){switch(s){case 34962:n.currentArrayBuffer=l;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=l;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,l){const p=n.currentVertexArrayObject.attribs[s];switch(l){case 34975:return p.buffer;case 34338:return p.enabled;case 34339:return p.size;case 34340:return p.stride;case 34341:return p.type;case 34922:return p.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,l,o,p,_,C){const M=n.currentVertexArrayObject;M.maxAttrib=Math.max(M.maxAttrib,s);const k=M.attribs[s];return k.buffer=n.currentArrayBuffer,k.size=l,k.type=o,k.normalized=p,k.stride=_,k.offset=C,k.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{dW("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};Nf.prototype.VERTEX_ARRAY_BINDING_OES=34229;Nf.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Rm(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Nf.prototype.createVertexArrayOES=function(){const e=new Rm(this);return this.vertexArrayObjects.push(e),e};Nf.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};Nf.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Rm&&e.hasBeenBound&&e.ext===this)};Nf.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){pW(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let l=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let p=0;p<=o;p++){const _=s.attribs[p],C=i?i.attribs[p]:null;if((!i||_.enabled!==C.enabled)&&(_.enabled?r.enableVertexAttribArray.call(n,p):r.disableVertexAttribArray.call(n,p)),_.enabled){let M=!1;(!i||_.buffer!==C.buffer)&&(l!==_.buffer&&(r.bindBuffer.call(n,34962,_.buffer),l=_.buffer),M=!0),(M||_.cached!==C.cached)&&r.vertexAttribPointer.call(n,p,_.size,_.type,_.normalized,_.stride,_.offset)}}this.currentArrayBuffer!==l&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function mW(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Nf(this)),this.__OESVertexArrayObject))}}const oP="OES_element_index",aP="WEBGL_draw_buffers",yW="EXT_disjoint_timer_query",_W="EXT_disjoint_timer_query_webgl2",vW="EXT_texture_filter_anisotropic",lP="WEBGL_debug_renderer_info",xW=35723,wW=4352,bW=36795,EW=34047,TW=37445,SW=37446,Jr=t=>dr(t)?void 0:0,CW={3074:t=>dr(t)?void 0:36064,[xW]:t=>dr(t)?void 0:wW,35977:Jr,32937:Jr,[bW]:(t,e)=>{const n=dr(t)?t.getExtension(_W):t.getExtension(yW);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[TW]:(t,e)=>{const n=t.getExtension(lP);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[SW]:(t,e)=>{const n=t.getExtension(lP);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[EW]:(t,e)=>{const n=t.luma.extensions[vW];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Jr,35071:Jr,37447:Jr,36063:(t,e)=>{if(!dr(t)){const n=t.getExtension(aP);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Jr,35374:Jr,35377:Jr,34852:t=>{if(!dr(t)){const e=t.getExtension(aP);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(oP)?2147483647:65535,33001:t=>t.getExtension(oP)?16777216:65535,33e3:t=>16777216,37157:Jr,35373:Jr,35657:Jr,36183:Jr,37137:Jr,34045:Jr,35978:Jr,35979:Jr,35968:Jr,35376:Jr,35375:Jr,35659:Jr,37154:Jr,35371:Jr,35658:Jr,35076:Jr,35077:Jr,35380:Jr};function MW(t,e,n){const r=CW[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const PW="OES_vertex_array_object",KR="ANGLE_instanced_arrays",kW="WEBGL_draw_buffers",IW="EXT_disjoint_timer_query",LW="EXT_texture_filter_anisotropic",DW="VertexArray requires WebGL2 or OES_vertex_array_object extension";function RW(t,e){return{webgl2:dr(t),ext:t.getExtension(e)}}const JR={[PW]:{meta:{suffix:"OES"},createVertexArray:()=>{zo(!1,DW)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[KR]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){zo(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[kW]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{zo(!1)}},[IW]:{meta:{suffix:"EXT"},createQuery:()=>{zo(!1)},deleteQuery:()=>{zo(!1)},beginQuery:()=>{zo(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},gw={readBuffer:(t,e,n)=>{dr(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=RW(t,KR);let l;switch(r){case 35069:l=i?void 0:!1;break;case 35070:l=!i&&!s?0:void 0;break}return l!==void 0?l:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!dr(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!dr(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[LW];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:MW,hint(t,e,n,r){return e(n,r)}};function BW(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(mW(t),zW(t),FW(t,JR),OW(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=BW;function zW(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function OW(t,e){let{target:n,target2:r}=e;Object.keys(gw).forEach(i=>{if(typeof gw[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},l=gw[i].bind(null,t,s);n[i]=l,r[i]=l}})}function FW(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&NW(t,{extension:n,target:t.luma,target2:t})}function NW(t,e){let{extension:n,target:r,target2:i}=e;const s=JR[n];zo(s);const{meta:l={}}=s,{suffix:o=""}=l,p=t.getExtension(n);for(const _ of Object.keys(s)){const C="".concat(_).concat(o);let M=null;_==="meta"||typeof t[_]=="function"||(p&&typeof p[C]=="function"?M=function(){return p[C](...arguments)}:typeof s[_]=="function"&&(M=s[_].bind(r))),M&&(r[_]=M,i[_]=M)}}const oS={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Nc=(t,e,n)=>e?t.enable(n):t.disable(n),AP=(t,e,n)=>t.hint(n,e),Ia=(t,e,n)=>t.pixelStorei(n,e),UW=(t,e)=>{const n=dr(t)?36009:36160;return t.bindFramebuffer(n,e)},VW=(t,e)=>t.bindFramebuffer(36008,e);function Ip(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const GW={3042:Nc,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Nc,2885:(t,e)=>t.cullFace(e),2929:Nc,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Nc,35723:AP,36006:UW,2886:(t,e)=>t.frontFace(e),33170:AP,2849:(t,e)=>t.lineWidth(e),32823:Nc,32824:"polygonOffset",10752:"polygonOffset",35977:Nc,32938:"sampleCoverage",32939:"sampleCoverage",3089:Nc,3088:(t,e)=>t.scissor(...e),2960:Nc,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:Ia,3317:Ia,37440:Ia,37441:Ia,37443:Ia,3330:Ia,3332:Ia,3331:Ia,36010:VW,3314:Ia,32878:Ia,3316:Ia,3315:Ia,32877:Ia,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Ip(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Ip(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Ip(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Ip(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,l,o]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,l,o)},stencilOp:(t,e)=>{e=Ip(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,l,o]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,l,o)},viewport:(t,e)=>t.viewport(...e)};function Mi(t,e,n){return e[t]!==void 0?e[t]:n[t]}const $W={blendEquation:(t,e,n)=>t.blendEquationSeparate(Mi(32777,e,n),Mi(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Mi(32969,e,n),Mi(32968,e,n),Mi(32971,e,n),Mi(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Mi(32824,e,n),Mi(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Mi(32938,e,n),Mi(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Mi(2962,e,n),Mi(2967,e,n),Mi(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Mi(34816,e,n),Mi(36003,e,n),Mi(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Mi(2964,e,n),Mi(2965,e,n),Mi(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Mi(34817,e,n),Mi(34818,e,n),Mi(34819,e,n))},uP={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},NA=(t,e)=>t.isEnabled(e),cP={3042:NA,2884:NA,2929:NA,3024:NA,32823:NA,32926:NA,32928:NA,3089:NA,2960:NA,35977:NA};function eB(t){for(const e in t)return!1;return!0}function jW(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function hP(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function HW(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,l=new Array(s),o=0;o<s;o++)l[o]=arguments[o];const{valueChanged:p,oldValue:_}=n(t.state._updateCache,...l);return p&&r(...l),_},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function WW(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class QW{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?ZW(e):Object.assign({},oS),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){zo(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];lc(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){zo(s!==void 0);const l=e[s],o=this.cache[s];jW(l,o)||(n=!0,r=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=l)}return{valueChanged:n,oldValue:r}}}function tB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(zo(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new QW(t,{copyState:r}),WW(t);for(const s in uP){const l=uP[s];HW(t,s,l)}hP(t,"getParameter"),hP(t,"isEnabled")}return t.state.enable=n,t}function qW(t){t.state||tB(t,{copyState:!1}),t.state.push()}function fP(t){zo(t.state),t.state.pop()}function lc(t,e){if(zo(pv(t),"setParameters requires a WebGL context"),eB(e))return;const n={};for(const i in e){const s=Number(i),l=GW[i];l&&(typeof l=="string"?n[l]=!0:l(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=$W[i];s(t,e,r)}}function ZW(t,e){if(e=e||oS,typeof e=="number"){const i=e,s=cP[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=cP[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function YW(t){lc(t,oS)}function fA(t,e,n){if(eB(e))return n(t);const{nocatch:r=!0}=e;qW(t),lc(t,e);let i;if(r)i=n(t),fP(t);else try{i=n(t)}finally{fP(t)}return i}function xd(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function mw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=xd(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return KW(e,r,i,s,n)}function XW(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function KW(t,e,n,r,i){const s=dP(t[0],e,n);let l=pP(t[1],e,r,i),o=dP(t[0]+1,e,n);const p=o===n-1?o:o-1;o=pP(t[1]+1,e,r,i);let _;return i?(o=o===0?o:o+1,_=l,l=o):_=o===r-1?o:o-1,{x:s,y:l,width:Math.max(p-s+1,1),height:Math.max(_-l+1,1)}}function dP(t,e,n){return Math.min(Math.round(t*e),n-1)}function pP(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const aS=jd(),JW=aS&&typeof document<"u",nB={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function rB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};zo(aS,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},nB,t);const{width:e,height:n}=t;function r(o){if(t.throwOnError)throw new Error(o);return console.error(o),null}t.onError=r;let i;const{canvas:s}=t,l=rQ({canvas:s,width:e,height:n,onError:r});return i=nQ(l,t),i?(i=lS(i,t),iQ(i),i):null}function lS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||sQ(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},nB,e);const{manageState:n,debug:r}=e;return n&&tB(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return vn.log(1,...s)()}}),aS&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),vn.level=Math.max(vn.level,1)):vn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function eQ(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function tQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=XW(e.useDevicePixels);oQ(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function nQ(t,e){const{onError:n}=e;let r=null;const i=p=>r=p.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:l=!0}=e;let o=null;return l&&(o=o||t.getContext("webgl2",e),o=o||t.getContext("experimental-webgl2",e)),s&&(o=o||t.getContext("webgl",e),o=o||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),o?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),o):n("Failed to create ".concat(l&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function rQ(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(JW&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function iQ(t){const e=dr(t)?"WebGL2":"WebGL1",n=eQ(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";vn.info(1,"".concat(e).concat(i," context ").concat(r))()}function sQ(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function oQ(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(vn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let l=e;const o=Math.floor(r*l),p=Math.floor(i*l);t.canvas.width=o,t.canvas.height=p,(t.drawingBufferWidth!==o||t.drawingBufferHeight!==p)&&(vn.warn("Device pixel ratio clamped")(),l=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*l),t.canvas.height=Math.floor(i*l)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}function gP(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let mP=class{constructor(e,n){oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"sampleSize",1),oe(this,"time",void 0),oe(this,"count",void 0),oe(this,"samples",void 0),oe(this,"lastTiming",void 0),oe(this,"lastSampleTime",void 0),oe(this,"lastSampleCount",void 0),oe(this,"_count",0),oe(this,"_time",0),oe(this,"_samples",0),oe(this,"_startTime",0),oe(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=gP(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(gP()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},aQ=class{constructor(e){oe(this,"id",void 0),oe(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof mP?this.stats[n]=e:this.stats[n]=new mP(n,r)),this.stats[n]}};function iB(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function sB(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||iB()}const yw=globalThis;function lQ(t){if(!t&&!sB())return"Node";if(iB(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":yw.chrome?"Chrome":yw.safari?"Safari":yw.mozInnerScreenX?"Firefox":"Unknown"}const bg="8.5.21",AQ="set luma.log.level=1 (or higher) to trace rendering";class uQ{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new aQ({id:e})),this.stats.get(e)}}const sf=new uQ;if(globalThis.luma&&globalThis.luma.VERSION!==bg)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(bg));globalThis.luma||(sB()&&vn.log(1,"luma.gl ".concat(bg," - ").concat(AQ))(),globalThis.luma=globalThis.luma||{VERSION:bg,version:bg,log:vn,stats:sf,globals:{modules:{},nodeIO:{}}});function cQ(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function hQ(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function nn(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function _w(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return nn(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function ph(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const vw={};function vh(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";vw[t]=vw[t]||1;const e=vw[t]++;return"".concat(t,"-").concat(e)}function yP(t){return nn(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function wd(t){let e=!0;for(const n in t){e=!1;break}return e}function oB(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(l=>{s.methodName||(s[l]=()=>{throw vn.removed("Calling removed method ".concat(e,".").concat(l,": "),i)(),new Error(l)})})}const d0="Resource subclass must define virtual methods";let yc=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};gv(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||vh(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=_w(this.gl,e),nn(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=dr(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const o=i.webgl1,p="webgl2"in i?i.webgl2:i.webgl1;return s?p:o}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=dr(this.gl),l={},o=n||Object.keys(i);for(const p of o){const _=i[p];if(_&&(!("webgl2"in _)||s)&&(!("extension"in _)||this.gl.getExtension(_.extension))){const M=r?ph(this.gl,p):p;l[M]=this.getParameter(p,e),r&&_.type==="GLenum"&&(l[M]=ph(this.gl,l[M]))}}return l}setParameter(e,n){e=_w(this.gl,e),nn(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=dr(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=_w(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return oB(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(d0)}_deleteHandle(){throw new Error(d0)}_bindHandle(e){throw new Error(d0)}_getOptsFromHandle(){throw new Error(d0)}_getParameter(e,n){throw new Error(d0)}_setParameter(e,n){throw new Error(d0)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=sf.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];sf.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=sf.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=sf.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const fQ="Failed to deduce GL constant from typed array";function L3(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(fQ)}}function Kg(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function dQ(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const l=n*i;s=s||new Uint8Array(l);for(let o=0;o<r/2;++o){const p=o*l,_=(r-o-1)*l;s.set(e.subarray(p,p+l)),e.copyWithin(p,_,_+l),e.set(s,_)}}function pQ(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),l=new Uint8Array(i*s*4);for(let o=0;o<s;o++)for(let p=0;p<i;p++)for(let _=0;_<4;_++)l[(o*i+p)*4+_]=e[(o*2*n+p*2)*4+_];return{data:l,width:i,height:s}}function D3(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const o in r)if(o in e){const _=r[o]?"".concat(t,".").concat(r[o]):"N/A";vn.removed("".concat(t,".").concat(o),_)()}for(const o in i)if(o in e){const p=i[o];vn.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(p))()}let l=null;for(const o in s)if(o in e){const p=s[o];vn.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(p))(),l=l||Object.assign({},e),l[p]=e[o],delete l[o]}return l||e}const gQ={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},mQ={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Ba{static getBytesPerElement(e){return Kg(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return nn(e.size),Kg(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Ba(gQ,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Ba.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Ba.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=D3("Accessor",e,mQ),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const _P=10,aB={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},yQ={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:aB},_Q={removedProps:aB};class Gr extends yc{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Ba.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Ba.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=D3("Buffer",e,yQ),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=D3("Buffer",e,_Q),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Ba(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;nn(n);const l=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(l,this.handle),i!==0||s!==void 0?(po(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(l,r,n),this.gl.bindBuffer(l,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:l}=this;return po(l),l.bindBuffer(36662,n.handle),l.bindBuffer(36663,this.handle),l.copyBufferSubData(36662,36663,r,i,s),l.bindBuffer(36662,null),l.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};po(this.gl);const s=Kg(this.accessor.type||5126,{clamped:!1}),l=this._getAvailableElementCount(n),o=r;let p,_;e?(_=e.length,p=_-o):(p=Math.min(l,i||l),_=o+p);const C=Math.min(l,p);return i=i||C,nn(i<=C),e=e||new s(_),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(nn(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(_P,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;nn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,_P),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=L3(e);return nn(s),this.setAccessor(new Ba(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;nn(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Kg(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new Ba(this.accessor,{type:L3(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return vn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return vn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return vn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return vn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Ba(this.accessor,e),this}}const AS={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},lB={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},AB={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function vQ(t,e){const n=AS[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=dr(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function xQ(t,e){const n=AS[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const wQ=[9729,9728],vP=globalThis.WebGLBuffer||function(){};class yf extends yc{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&vQ(e,r),s=s&&(!i||xQ(e,r))),s}constructor(e,n){const{id:r=vh("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(J=>this.initialize(Object.assign({},e,{pixels:J,data:J}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:l=0,recreate:o=!1,parameters:p={},pixelStore:_={},textureUnit:C=void 0}=e;n||(n=i);let{width:M,height:k,dataFormat:F,type:j,compressed:H=!1,mipmaps:ie=!0}=e;const{depth:Y=0}=e;return{width:M,height:k,compressed:H,dataFormat:F,type:j}=this._deduceParameters({format:s,type:j,dataFormat:F,compressed:H,data:n,width:M,height:k}),this.width=M,this.height=k,this.depth=Y,this.format=s,this.type=j,this.dataFormat=F,this.border=l,this.textureUnit=C,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),ie&&this._isNPOT()&&(vn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),ie=!1,this._updateForNPOT(p)),this.mipmaps=ie,this.setImageData({data:n,width:M,height:k,depth:Y,format:s,type:j,dataFormat:F,border:l,mipmaps:ie,parameters:_,compressed:H}),ie&&this.generateMipmap(),this.setParameters(p),o&&(this.data=n),r&&(this._video={video:n,parameters:p,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(vn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),fA(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:l=this.border,offset:o=0,parameters:p={}}=e;let{data:_=null,type:C=this.type,width:M=this.width,height:k=this.height,dataFormat:F=this.dataFormat,compressed:j=!1}=e;_||(_=r),{type:C,dataFormat:F,compressed:j,width:M,height:k}=this._deduceParameters({format:s,type:C,dataFormat:F,compressed:j,data:_,width:M,height:k});const{gl:H}=this;H.bindTexture(this.target,this.handle);let ie=null;({data:_,dataType:ie}=this._getDataType({data:_,compressed:j}));let Y,J=0;if(fA(this.gl,p,()=>{switch(ie){case"null":H.texImage2D(n,i,s,M,k,l,F,C,_);break;case"typed-array":H.texImage2D(n,i,s,M,k,l,F,C,_,o);break;case"buffer":Y=po(H),Y.bindBuffer(35052,_.handle||_),Y.texImage2D(n,i,s,M,k,l,F,C,o),Y.bindBuffer(35052,null);break;case"browser-object":dr(H)?H.texImage2D(n,i,s,M,k,l,F,C,_):H.texImage2D(n,i,s,F,C,_);break;case"compressed":for(const[se,he]of _.entries())H.compressedTexImage2D(n,se,he.format,he.width,he.height,l,he.data),J+=he.levelSize;break;default:nn(!1,"Unknown image data type")}}),ie==="compressed")this._trackAllocatedMemory(J,"Texture");else if(_&&_.byteLength)this._trackAllocatedMemory(_.byteLength,"Texture");else{const se=lB[this.dataFormat]||4,he=AB[this.type]||1;this._trackAllocatedMemory(this.width*this.height*se*he,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:l=0,width:o=this.width,height:p=this.height,level:_=0,format:C=this.format,type:M=this.type,dataFormat:k=this.dataFormat,compressed:F=!1,offset:j=0,border:H=this.border,parameters:ie={}}=e;if({type:M,dataFormat:k,compressed:F,width:o,height:p}=this._deduceParameters({format:C,type:M,dataFormat:k,compressed:F,data:i,width:o,height:p}),nn(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const Y=i;i=Y.data,o=Y.shape[0],p=Y.shape[1]}i instanceof Gr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),fA(this.gl,ie,()=>{if(F)this.gl.compressedTexSubImage2D(n,_,s,l,o,p,C,i);else if(i===null)this.gl.texSubImage2D(n,_,s,l,o,p,k,M,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,_,s,l,o,p,k,M,i,j);else if(i instanceof vP){const Y=po(this.gl);Y.bindBuffer(35052,i),Y.texSubImage2D(n,_,s,l,o,p,k,M,j),Y.bindBuffer(35052,null)}else dr(this.gl)?po(this.gl).texSubImage2D(n,_,s,l,o,p,k,M,i):this.gl.texSubImage2D(n,_,s,l,k,M,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return vn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof Gr?{data:n.handle,dataType:"buffer"}:n instanceof vP?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:l,type:o,compressed:p}=e;const _=AS[n];return l=l||_&&_.dataFormat,o=o||_&&_.types[0],p=p||_&&_.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:l,type:o,compressed:p,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},nn(i,"Could not deduced texture size"),nn(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),nn(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:nn(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return dr(this.gl)||!this.width||!this.height?!1:!yP(this.width)||!yP(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:wQ.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let bQ="";function EQ(t,e){return nn(typeof t=="string"),t=bQ+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class da extends yf{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return yf.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};gv(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:EQ(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const R3=[34069,34070,34071,34072,34073,34074];class uB extends yf{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};gv(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:l=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:l})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:l=0,format:o=6408,type:p=5121}=e;const{gl:_}=this,C=i||s,M=await Promise.all(R3.map(k=>{const F=C[k];return Promise.all(Array.isArray(F)?F:[F])}));this.bind(),R3.forEach((k,F)=>{M[F].length>1&&this.opts.mipmaps!==!1&&vn.warn("".concat(this.id," has mipmap and multiple LODs."))(),M[F].forEach((j,H)=>{n&&r?_.texImage2D(k,H,o,n,r,l,o,p,j):_.texImage2D(k,H,o,o,p,j)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:l,border:o=0,format:p=6408,type:_=5121}=e,{gl:C}=this,M=s||l;return this.bind(),M instanceof Promise?M.then(k=>this.setImageDataForFace(Object.assign({},e,{face:n,data:k,pixels:k}))):this.width||this.height?C.texImage2D(n,0,p,r,i,o,p,_,M):C.texImage2D(n,0,p,p,_,M),this}}uB.FACES=R3;class TQ extends yf{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return dr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};po(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:l=1,border:o=0,format:p,type:_=5121,offset:C=0,data:M,parameters:k={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),fA(this.gl,k,()=>{ArrayBuffer.isView(M)&&this.gl.texImage3D(this.target,n,r,i,s,l,o,p,_,M),M instanceof Gr&&(this.gl.bindBuffer(35052,M.handle),this.gl.texImage3D(this.target,n,r,i,s,l,o,p,_,C))}),M&&M.byteLength)this._trackAllocatedMemory(M.byteLength,"Texture");else{const F=lB[this.dataFormat]||4,j=AB[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*F*j,"Texture")}return this.loaded=!0,this}}const Gh="EXT_color_buffer_float",xP={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Gh,bpp:2},33327:{gl2:Gh,bpp:4},34842:{gl2:Gh,bpp:8},33326:{gl2:Gh,bpp:4},33328:{gl2:Gh,bpp:8},34836:{gl2:Gh,bpp:16},35898:{gl2:Gh,bpp:4}};function SQ(t,e,n){const r=n[e];if(!r)return!1;const i=dr(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class B0 extends yc{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||SQ(e,n,xP)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return nn(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&dr(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*xP[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const CQ=256,MQ=1024,PQ=16384,wP=6144,bP=6145,EP=6146,TP=34041,cB="clear: bad arguments";function uS(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let l=0;n&&(l|=PQ,n!==!0&&(s.clearColor=n)),r&&(l|=CQ,r!==!0&&(s.clearDepth=r)),i&&(l|=MQ,r!==!0&&(s.clearStencil=r)),nn(l!==0,cB),fA(t,s,()=>{t.clear(l)})}function kQ(t){let{framebuffer:e=null,buffer:n=wP,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};po(t),fA(t,{framebuffer:e},()=>{switch(n){case wP:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case bP:t.clearBufferfv(bP,0,[i]);break;case EP:t.clearBufferiv(EP,0,[i]);break;case TP:const[s,l]=i;t.clearBufferfi(TP,0,s,l);break;default:nn(!1,cB)}})}function IQ(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return nn(!1),0}}function mv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:l=null,sourceWidth:o,sourceHeight:p,sourceType:_}=e;const{framebuffer:C,deleteFramebuffer:M}=hB(t);nn(C);const{gl:k,handle:F,attachments:j}=C;o=o||C.width,p=p||C.height,s===36064&&F===null&&(s=1028),nn(j[s]),_=_||j[s].type,l=DQ(l,_,i,o,p),_=_||L3(l);const H=k.bindFramebuffer(36160,F);return k.readPixels(n,r,o,p,i,_,l),k.bindFramebuffer(36160,H||null),M&&C.delete(),l}function SP(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=mv(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=pQ({data:r,width:i,height:s}));dQ({data:r,width:i,height:s});const l=document.createElement("canvas");l.width=i,l.height=s;const o=l.getContext("2d"),p=o.createImageData(i,s);return p.data.set(r),o.putImageData(p,0,0),l.toDataURL()}function LQ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:l=6408}=n;let{targetX:o,targetY:p,targetZ:_,width:C,height:M}=n;const{framebuffer:k,deleteFramebuffer:F}=hB(t);nn(k);const{gl:j,handle:H}=k,ie=typeof o<"u"||typeof p<"u"||typeof _<"u";o=o||0,p=p||0,_=_||0;const Y=j.bindFramebuffer(36160,H);nn(e);let J=null;if(e instanceof yf&&(J=e,C=Number.isFinite(C)?C:J.width,M=Number.isFinite(M)?M:J.height,J.bind(0),e=J.target),!ie)j.copyTexImage2D(e,s,l,r,i,C,M,0);else switch(e){case 3553:case 34067:j.copyTexSubImage2D(e,s,o,p,r,i,C,M);break;case 35866:case 32879:po(j).copyTexSubImage3D(e,s,o,p,_,r,i,C,M);break}return J&&J.unbind(),j.bindFramebuffer(36160,Y||null),F&&k.delete(),J}function hB(t){return t instanceof os?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:GQ(t),deleteFramebuffer:!0}}function DQ(t,e,n,r,i){if(t)return t;e=e||5121;const s=Kg(e,{clamped:!1}),l=IQ(n);return new s(r*i*l)}const ei={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function RQ(t){const e=new da(t,{format:6408,type:5126,dataFormat:6408}),n=new os(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const fB={[ei.WEBGL2]:[!1,!0],[ei.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[ei.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[ei.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[ei.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[ei.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[ei.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[ei.FLOAT_BLEND]:["EXT_float_blend"],[ei.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[ei.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[ei.TEXTURE_FLOAT]:["OES_texture_float",!0],[ei.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[ei.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[ei.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[ei.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[ei.COLOR_ATTACHMENT_RGBA32F]:[RQ,"EXT_color_buffer_float"],[ei.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[ei.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[ei.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[ei.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[ei.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[ei.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},BQ=2;function dB(t,e){return cS(t,e)}function cS(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>pB(t,n))}function zQ(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in fB)t.luma.caps[e]===void 0&&(t.luma.caps[e]=pB(t,e));return t.luma.caps}function pB(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=OQ(t,e)),t.luma.caps[e]||vn.log(BQ,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function OQ(t,e){const n=fB[e];nn(n,e);let r;const i=dr(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:nn(!1);return r}const CP="Multiple render targets not supported";class os extends yc{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new os(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=po(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=po(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:l=!0,stencil:o=!1,check:p=!0,readBuffer:_=void 0,drawBuffers:C=void 0}=e;if(nn(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const M in i){const k=i[M];(Array.isArray(k)?k[0]:k).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,l,o,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:_,drawBuffers:C}),i&&p&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:l=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:l});const{gl:o}=this,p=o.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,p||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return nn(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&vn.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(l=>{i[l]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const l in i){nn(l!==void 0,"Misspelled framebuffer binding point?");const o=Number(l),p=i[o];let _=p;if(!_)this._unattach(o);else if(_ instanceof B0)this._attachRenderbuffer({attachment:o,renderbuffer:_});else if(Array.isArray(p)){const[C,M=0,k=0]=p;_=C,this._attachTexture({attachment:o,texture:C,layer:M,level:k})}else this._attachTexture({attachment:o,texture:_,layer:0,level:0});r&&_&&_.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(l=>!this.attachments[l]).forEach(l=>{delete this.attachments[l]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(NQ(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,l=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&uS(this.gl,{color:n,depth:r,stencil:i}),s.forEach((o,p)=>{kQ(this.gl,{drawBuffer:p,value:o})}),this.gl.bindFramebuffer(36160,l||null),this}readPixels(){return vn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return vn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return vn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return vn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return vn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return vn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:l}=e;const o=po(this.gl),p=o.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&l===void 0?o.invalidateFramebuffer(36008,n):o.invalidateFramebuffer(36008,n,r,i,s,l),o.bindFramebuffer(36008,p),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=ph(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const l=n?ph(this.gl,s):s;i[l]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),l=e?ph(this.gl,s):s;r[l]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(SP(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>vn.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=SP(this,{targetMaxHeight:100});return vn.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let l=null;return e&&(l=l||{},l[36064]=new da(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(l[36064])),n&&r?(l=l||{},l[33306]=new B0(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(l[33306])):n?(l=l||{},l[36096]=new B0(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(l[36096])):r&&nn(!1),l}_unattach(e){const n=this.attachments[e];n&&(n instanceof B0?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:l}=this;switch(l.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:po(l).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const p=FQ(i);l.framebufferTexture2D(36160,n,p,r.handle,s);break;case 3553:l.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:nn(!1,"Illegal texture type")}l.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=hW(this.gl);n?n.readBuffer(e):nn(e===36064||e===1029,CP),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=po(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):nn(e.length===1&&(e[0]===36064||e[0]===1029),CP)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=zQ(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function FQ(t){return t<34069?t+34069:t}function NQ(t){return(os.STATUS||{})[t]||"Framebuffer error ".concat(t)}const UQ=[36049,36048,33296,33298,33299,33300,33301,33302,33303];os.ATTACHMENT_PARAMETERS=UQ;function VQ(t,e){nn(t instanceof da||t instanceof uB||t instanceof TQ);const n=t.constructor,{gl:r,width:i,height:s,format:l,type:o,dataFormat:p,border:_,mipmaps:C}=t,M=Object.assign({width:i,height:s,format:l,type:o,dataFormat:p,border:_,mipmaps:C},e);return new n(r,M)}function GQ(t,e){const{gl:n,width:r,height:i,id:s}=t;return new os(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{36064:t}}))}function Vy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const $Q=35632,jQ=35633;function HQ(t){switch(t){case $Q:return"fragment";case jQ:return"vertex";default:return"unknown type"}}function WQ(t,e,n,r){const i=t.split(/\r?\n/),s={},l={},o=r||Vy(e)||"(unnamed)",p="".concat(HQ(n)," shader ").concat(o);for(let C=0;C<i.length;C++){const M=i[C];if(M.length<=1)continue;const k=M.split(":"),F=k[0],j=parseInt(k[2],10);if(isNaN(j))throw new Error("GLSL compilation error in ".concat(p,": ").concat(t));F!=="WARNING"?s[j]=M:l[j]=M}const _=QQ(e);return{shaderName:p,errors:MP(s,_),warnings:MP(l,_)}}function MP(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],l=s.split(":",3),o=l[0],p=parseInt(l[1],10)||0,_=s.substring(l.join(":").length+1).trim();n+=gB("^^^ ".concat(o,": ").concat(_,`

`),p)}}return n}function QQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,l)=>{const o=String(l+e),p=o.length;return gB(o,i-p)+n+s})}function gB(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function mB(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const qQ="Shader: GLSL source code must be a JavaScript string";class Jg extends yc{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return nn(!1),"unknown"}}constructor(e,n){gv(e),nn(typeof n.source=="string",qQ);const r=Vy(n.source,null)||n.id||vh("unnamed ".concat(Jg.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=Vy(n,null);r&&(this.id=vh(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Jg.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Vy(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:l}=WQ(r,this.source,this.shaderType,this.id);throw vn.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),vn.warn("GLSL compilation warnings in ".concat(i,`
`).concat(l))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class xw extends Jg{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class ww extends Jg{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const ZQ={5126:ai.bind(null,"uniform1fv",La,1,io),35664:ai.bind(null,"uniform2fv",La,2,io),35665:ai.bind(null,"uniform3fv",La,3,io),35666:ai.bind(null,"uniform4fv",La,4,io),5124:ai.bind(null,"uniform1iv",Uc,1,io),35667:ai.bind(null,"uniform2iv",Uc,2,io),35668:ai.bind(null,"uniform3iv",Uc,3,io),35669:ai.bind(null,"uniform4iv",Uc,4,io),35670:ai.bind(null,"uniform1iv",Uc,1,io),35671:ai.bind(null,"uniform2iv",Uc,2,io),35672:ai.bind(null,"uniform3iv",Uc,3,io),35673:ai.bind(null,"uniform4iv",Uc,4,io),35674:ai.bind(null,"uniformMatrix2fv",La,4,zu),35675:ai.bind(null,"uniformMatrix3fv",La,9,zu),35676:ai.bind(null,"uniformMatrix4fv",La,16,zu),35678:Rs,35680:Rs,5125:ai.bind(null,"uniform1uiv",G1,1,io),36294:ai.bind(null,"uniform2uiv",G1,2,io),36295:ai.bind(null,"uniform3uiv",G1,3,io),36296:ai.bind(null,"uniform4uiv",G1,4,io),35685:ai.bind(null,"uniformMatrix2x3fv",La,6,zu),35686:ai.bind(null,"uniformMatrix2x4fv",La,8,zu),35687:ai.bind(null,"uniformMatrix3x2fv",La,6,zu),35688:ai.bind(null,"uniformMatrix3x4fv",La,12,zu),35689:ai.bind(null,"uniformMatrix4x2fv",La,8,zu),35690:ai.bind(null,"uniformMatrix4x3fv",La,12,zu),35678:Rs,35680:Rs,35679:Rs,35682:Rs,36289:Rs,36292:Rs,36293:Rs,36298:Rs,36299:Rs,36300:Rs,36303:Rs,36306:Rs,36307:Rs,36308:Rs,36311:Rs},YQ={},XQ={},KQ={},PP=[0];function hS(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(PP[0]=t,t=PP);const i=t.length;if(i%e&&vn.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let l=0;l<i;l++)s[l]=t[l];return s}function La(t,e){return hS(t,e,Float32Array,YQ)}function Uc(t,e){return hS(t,e,Int32Array,XQ)}function G1(t,e){return hS(t,e,Uint32Array,KQ)}function kP(t,e,n){const r=ZQ[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function JQ(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function eq(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!tq(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function tq(t){return Array.isArray(t)||ArrayBuffer.isView(t)?rq(t):isFinite(t)||t===!0||t===!1||t instanceof yf||t instanceof B0?!0:t instanceof os?!!t.texture:!1}function nq(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function rq(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Rs(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function ai(t,e,n,r){let i=null,s=null;return(l,o,p)=>{const _=e(p,n),C=_.length;let M=!1;if(i===null)i=new Float32Array(C),s=C,M=!0;else{nn(s===C,"Uniform length cannot change.");for(let k=0;k<C;++k)if(_[k]!==i[k]){M=!0;break}}return M&&(r(l,t,o,_),i.set(_)),M}}function io(t,e,n,r){t[e](n,r)}function zu(t,e,n,r){t[e](n,!1,r)}const iq=5120,sq=5121,oq=5122,aq=5123,IP=0,$1=1,lq=2,Aq=3,j1=4,uq=5,cq=6,ns=5126,hq=35664,fq=35665,dq=35666,Lp=5124,pq=35667,gq=35668,mq=35669,Dp=5125,yq=36294,_q=36295,vq=36296,xq=35670,wq=35671,bq=35672,Eq=35673,Tq=35674,Sq=35675,Cq=35676,Mq=35685,Pq=35686,kq=35687,Iq=35688,Lq=35689,Dq=35690,B3={[ns]:[ns,1,"float"],[hq]:[ns,2,"vec2"],[fq]:[ns,3,"vec3"],[dq]:[ns,4,"vec4"],[Lp]:[Lp,1,"int"],[pq]:[Lp,2,"ivec2"],[gq]:[Lp,3,"ivec3"],[mq]:[Lp,4,"ivec4"],[Dp]:[Dp,1,"uint"],[yq]:[Dp,2,"uvec2"],[_q]:[Dp,3,"uvec3"],[vq]:[Dp,4,"uvec4"],[xq]:[ns,1,"bool"],[wq]:[ns,2,"bvec2"],[bq]:[ns,3,"bvec3"],[Eq]:[ns,4,"bvec4"],[Tq]:[ns,8,"mat2"],[Mq]:[ns,8,"mat2x3"],[Pq]:[ns,8,"mat2x4"],[Sq]:[ns,12,"mat3"],[kq]:[ns,12,"mat3x2"],[Iq]:[ns,12,"mat3x4"],[Cq]:[ns,16,"mat4"],[Lq]:[ns,16,"mat4x2"],[Dq]:[ns,16,"mat4x3"]};function Rq(t){switch(t){case IP:return IP;case $1:return $1;case Aq:return $1;case lq:return $1;case j1:return j1;case uq:return j1;case cq:return j1;default:return nn(!1),0}}function LP(t){const e=B3[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function yB(t,e){switch(t){case iq:case sq:case oq:case aq:t=ns;break}for(const n in B3){const[r,i,s]=B3[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class Bq{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:l,size:o}=n.getActiveAttrib(e.handle,i),p=n.getAttribLocation(e.handle,s);p>=0&&this._addAttribute(p,s,l,o)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!dr(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:l,size:o}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,l,o)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:l}=LP(r),o={type:s,size:i*l};this._inferProperties(e,n,o);const p={location:e,name:n,accessor:new Ba(o)};this.attributeInfos.push(p),this.attributeInfosByLocation[e]=p,this.attributeInfosByName[p.name]=p}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:l}=LP(r),o=new Ba({type:s,size:i*l}),p={location:e,name:n,accessor:o};this.varyingInfos.push(p),this.varyingInfosByName[p.name]=p}}const DP=4,zq=35981,Oq=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class _B extends yc{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",Oq),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:l=zq}=e;return this.hash=n||"",this.vs=typeof r=="string"?new xw(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new ww(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,nn(this.vs instanceof xw),nn(this.fs instanceof ww),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(po(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,l)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Bq(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:l,end:o,isIndexed:p=!1,indexType:_=5123,instanceCount:C=0,isInstanced:M=C>0,vertexArray:k=null,transformFeedback:F,framebuffer:j,parameters:H={},uniforms:ie,samplers:Y}=e;if((ie||Y)&&(vn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(ie||{})),vn.priority>=n){const J=j?j.id:"default",se="mode=".concat(ph(this.gl,r)," verts=").concat(i," ")+"instances=".concat(C," indexType=").concat(ph(this.gl,_)," ")+"isInstanced=".concat(M," isIndexed=").concat(p," ")+"Framebuffer=".concat(J);vn.log(n,se)()}return nn(k),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||M&&C===0?!1:(k.bindForDraw(i,C,()=>{if(j!==void 0&&(H=Object.assign({},H,{framebuffer:j})),F){const J=Rq(r);F.begin(J)}this._bindTextures(),fA(this.gl,H,()=>{p&&M?this.gl2.drawElementsInstanced(r,i,_,s,C):p&&dr(this.gl)&&!isNaN(l)&&!isNaN(o)?this.gl2.drawRangeElements(r,l,o,i,_,s):p?this.gl.drawElements(r,i,_,s):M?this.gl2.drawArraysInstanced(r,s,i,C):this.gl.drawArrays(r,s,i)}),F&&F.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};vn.priority>=2&&eq(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,l=!1;if(s instanceof os&&(s=s.texture),s instanceof yf)if(l=this.uniforms[n]!==r,l){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const o=s,{textureIndex:p}=i;o.bind(p),s=p,this._textureUniforms[n]=o}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||l)&&nq(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new xw({handle:i});break;case 35632:r.fs=new ww({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=vh(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),vn.time(DP,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),vn.timeEnd(DP,"linkProgram for ".concat(this._getName()))(),e.debug||vn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=JQ(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=kP(e,s,r),r.size>1)for(let l=0;l<r.size;l++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(l,"]")),this._uniformSetters["".concat(i,"[").concat(l,"]")]=kP(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const Fq=34918,Nq=34919,Uq=35007,Vq=36795,Gq=35976,$q=35887,jq=36202;class H_ extends yc{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=dr(e),i=cS(e,ei.TIMER_QUERY);let s=r||i;for(const l of n)switch(l){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:nn(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(Uq)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?jq:$q)}beginTransformFeedbackQuery(){return this.begin(Gq)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,Nq);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(Vq)}getResult(){return this.gl2.getQueryParameter(this.handle,Fq)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return H_.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class vB extends yc{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return dr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};po(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,wd(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:l}=this._getBufferParams(n);return r<0?(this.unused[e]=i,vn.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,l,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof Gr?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let H1=null;function Hq(t){return(!H1||H1.byteLength<t)&&(H1=new ArrayBuffer(t)),H1}function Wq(t,e){const n=Hq(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function Qq(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,l=i*s;let o=0;for(let p=r;o<s;o++)e[p++]=n[o];for(;o<l;)o<l-o?(e.copyWithin(r+o,r,r+o),o*=2):(e.copyWithin(r+o,r,r+l-o),o=l);return e}const qq="elements must be GL.ELEMENT_ARRAY_BUFFER";class Da extends yc{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?dr(e)||lQ()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Da(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Da.MAX_ATTRIBUTES=Da.MAX_ATTRIBUTES||e.getParameter(34921),Da.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Da._setConstantFloatArray(e,n,r);break;case Int32Array:Da._setConstantIntArray(e,n,r);break;case Uint32Array:Da._setConstantUintArray(e,n,r);break;default:nn(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Da.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return nn(!e||e.target===34963,qq),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:l,offset:o,normalized:p,integer:_,divisor:C}=r,{gl:M,gl2:k}=this;return e=Number(e),this.bind(()=>{M.bindBuffer(34962,n.handle),_?(nn(dr(M)),k.vertexAttribIPointer(e,i,s,l,o)):M.vertexAttribPointer(e,i,s,p,l,o),M.enableVertexAttribArray(e),k.vertexAttribDivisor(e,C||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Da.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let l=!this.buffer;if(this.buffer=this.buffer||new Gr(this.gl,i),l=l||this.buffer.reallocate(i),l=l||!this._compareConstantArrayValues(r,this.bufferValue),l){const o=Wq(n.constructor,s);Qq({target:o,source:r,start:0,count:s}),this.buffer.subData(o),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:nn(!1)}}static _setConstantIntArray(e,n,r){switch(nn(dr(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:nn(!1)}}static _setConstantUintArray(e,n,r){switch(nn(dr(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:nn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return nn(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const Zq="VertexArray: attributes must be Buffers or constants (i.e. typed array)",Yq=/^(.+)__LOCATION_([0-9]+)$/,Xq=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Kq{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Da(e),oB(this,"VertexArray","v6.0",Xq),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Gr(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Gr&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof Gr&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:l,name:o}=this._getAttributeIndex(e);if(!Number.isFinite(l)||l<0)return this.unused[e]=n,vn.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const p=this._getAttributeInfo(o||l);if(!p)return s;const _=this.accessors[l]||{},C=Ba.resolve(p.accessor,_,r,i),{size:M,type:k}=C;return nn(Number.isFinite(M)&&Number.isFinite(k)),{location:l,accessor:C}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=Yq.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof Gr)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof Gr){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof Gr){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(Zq)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(Da.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Da.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,l=s>0;if(e.isInstanced=e.isInstanced||l,r instanceof Gr){const o=r;if(l){const p=o.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,p)}else{const p=o.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,p)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function Jq(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let l=0;l<t.length&&l<n;++l)l>0&&(i+=",".concat(l%r===0?" ":"")),i+=em(t[l],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function em(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return Jq(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function RP(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;nn(n);const s=".*_.*",l=".*Matrix",o=n._uniformSetters,p={},_=Object.keys(o).sort();let C=0;for(const F of _)!F.match(s)&&!F.match(l)&&bw({table:p,header:e,uniforms:r,uniformName:F,undefinedOnly:i})&&C++;for(const F of _)F.match(l)&&bw({table:p,header:e,uniforms:r,uniformName:F,undefinedOnly:i})&&C++;for(const F of _)p[F]||bw({table:p,header:e,uniforms:r,uniformName:F,undefinedOnly:i})&&C++;let M=0;const k={};if(!i)for(const F in r){const j=r[F];p[F]||(M++,k[F]={Type:"NOT USED: ".concat(j),[e]:em(j)})}return{table:p,count:C,unusedTable:k,unusedCount:M}}function bw(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const l=r[i],o=eZ(l);return!s||!o?(e[i]={[n]:o?em(l):"N/A","Uniform Type":o?l:"NOT PROVIDED"},!0):!1}function eZ(t){return t!=null}function tZ(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=BP(e,e.elements,null,n));const i=e.values;for(const s in i){const l=e._getAttributeInfo(s);if(l){let o="".concat(s,": ").concat(l.name);const p=e.accessors[l.location];p&&(o="".concat(s,": ").concat(nZ(l.name,p))),r[o]=BP(e,i[s],p,n)}}return r}function BP(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",l=1,o=0,p=0,_,C,M;if(n&&(s=n.type,l=n.size,s=String(s).replace("Array",""),_=s.indexOf("nt")!==-1),e instanceof Gr){const k=e,{data:F,changed:j}=k.getDebugData();C=j?"*":"",M=F,p=k.byteLength,o=p/F.BYTES_PER_ELEMENT/l;let H;if(n){const ie=n.divisor>0;H="".concat(ie?"I ":"P "," ").concat(o," (x").concat(l,"=").concat(p," bytes ").concat(ph(i,s),")")}else _=!0,H="".concat(p," bytes");return{[r]:"".concat(C).concat(em(M,{size:l,isInteger:_})),"Format ":H}}return M=e,l=e.length,s=String(e.constructor.name).replace("Array",""),_=s.indexOf("nt")!==-1,{[r]:"".concat(em(M,{size:l,isInteger:_})," (constant)"),"Format ":"".concat(l,"x").concat(s," (constant)")}}function nZ(t,e){const{type:n,size:r}=e,i=yB(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function rZ(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=zP(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=zP(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function zP(t){const{type:e,size:n}=t.accessor,r=yB(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}function iZ(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function sZ(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||iZ()}const OP=sZ()&&typeof document<"u";let oZ=0;class aZ{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=ie=>rB(ie),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:l=()=>{},onError:o,gl:p=null,glOptions:_={},debug:C=!1,createFramebuffer:M=!1,autoResizeViewport:k=!0,autoResizeDrawingBuffer:F=!0,stats:j=sf.get("animation-loop-".concat(oZ++))}=e;let{useDevicePixels:H=!0}=e;"useDevicePixelRatio"in e&&(vn.deprecated("useDevicePixelRatio","useDevicePixels")(),H=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:l,onError:o,gl:p,glOptions:_,debug:C,createFramebuffer:M},this.gl=p,this.needsRedraw=null,this.timeline=null,this.stats=j,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:k,autoResizeDrawingBuffer:F,useDevicePixels:H}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return nn(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=H_.isSupported(this.gl,["timers"])?new H_(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return vn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=OP?new Promise((e,n)=>{if(OP&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):hQ(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):cQ(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?lS(this.props.gl,e):this.onCreateContext(e),!pv(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");YW(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&tQ(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new os(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Bm="vs",fS="fs";function Ua(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Ew={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function lZ(t){const e={};for(const n in t){const r=t[n],i=AZ(r);e[n]=i}return e}function AZ(t){let e=FP(t);return e==="object"?t?"type"in t?Object.assign({},t,Ew[t.type]):"value"in t?(e=FP(t.value),Object.assign({type:e},t,Ew[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Ew[e])}function FP(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const uZ="vs",cZ="fs";class NP{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:l,getUniforms:o,deprecations:p=[],defines:_={},inject:C={},vertexShader:M,fragmentShader:k}=e;Ua(typeof n=="string"),this.name=n,this.vs=r||M,this.fs=i||k,this.getModuleUniforms=o,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(p),this.defines=_,this.injections=hZ(C),l&&(this.uniforms=lZ(l))}getModuleSource(e){let n;switch(e){case uZ:n=this.vs||"";break;case cZ:n=this.fs||"";break;default:Ua(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&Ua(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function hZ(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function fZ(t){return dZ(wB(t))}function dZ(t){const e={},n={};return xB({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function xB(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&xB({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function wB(t,e){return t.map(n=>(n instanceof NP||(Ua(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Ua(n.name,"shader module has no name"),n=new NP(n),n.dependencies=wB(n.dependencies)),n))}function pZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const gZ=7936,mZ=7937,yZ=7938,_Z=35724,dS={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Kh={};Object.keys(dS).forEach(t=>{Kh[t]=t});function vZ(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function xZ(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||gZ),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||mZ);return{gpuVendor:wZ(n,r),vendor:n,renderer:r,version:t.getParameter(yZ),shadingLanguageVersion:t.getParameter(_Z)}}function wZ(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const Tw={};function UP(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=dS[e];if(Ua(r,e),!pZ(n))return!0;if(e in Tw)return Tw[e];const i=r[0],s=n.behavior||"enable",l="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),o=t.createShader(35633);t.shaderSource(o,l),t.compileShader(o);const p=t.getShaderParameter(o,35713);return t.deleteShader(o),Tw[e]=p,p}function bZ(t,e){const n=dS[e];Ua(n,e);const r=vZ(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return Ua(i===!1||i===!0),i}function W1(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>bZ(t,n))}function EZ(t){switch(xZ(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function TZ(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return W1(t,Kh.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),W1(t,Kh.GLSL_DERIVATIVES)&&UP(t,Kh.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),W1(t,Kh.GLSL_FRAG_DATA)&&UP(t,Kh.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),W1(t,Kh.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const SZ=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,CZ=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,MZ={[Bm]:SZ,[fS]:CZ},Gy="__LUMA_INJECT_DECLARATIONS__",VP=/void\s+main\s*\([^)]*\)\s*\{\n?/,GP=/}\n?[^{}]*$/,Sw=[];function $P(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Bm;for(const s in n){const l=n[s];l.sort((p,_)=>p.order-_.order),Sw.length=l.length;for(let p=0,_=l.length;p<_;++p)Sw[p]=l[p].injection;const o="".concat(Sw.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(Gy,o));break;case"vs:#main-start":i&&(t=t.replace(VP,p=>p+o));break;case"vs:#main-end":i&&(t=t.replace(GP,p=>o+p));break;case"fs:#decl":i||(t=t.replace(Gy,o));break;case"fs:#main-start":i||(t=t.replace(VP,p=>p+o));break;case"fs:#main-end":i||(t=t.replace(GP,p=>o+p));break;default:t=t.replace(s,p=>p+o)}}return t=t.replace(Gy,""),r&&(t=t.replace(/\}\s*$/,s=>s+MZ[e])),t}function z3(t){const e={};return Ua(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function bd(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const bB=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],PZ=[...bB,[bd("attribute"),"in $1"],[bd("varying"),"out $1"]],kZ=[...bB,[bd("varying"),"in $1"]],EB=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],IZ=[...EB,[bd("in"),"attribute $1"],[bd("out"),"varying $1"]],LZ=[...EB,[bd("in"),"varying $1"]],O3="gl_FragColor",F3=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,DZ=/void\s+main\s*\([^)]*\)\s*\{\n?/;function RZ(t,e,n){switch(e){case 300:return n?W_(t,PZ):BZ(t);case 100:return n?W_(t,IZ):zZ(t);default:throw new Error("unknown GLSL version ".concat(e))}}function W_(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function BZ(t){t=W_(t,kZ);const e=t.match(F3);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(O3,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(DZ,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(O3,"\\b"),"g"),n)}return t}function zZ(t){t=W_(t,LZ);const e=t.match(F3);if(e){const n=e[1];t=t.replace(F3,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),O3)}return t}const OZ=`

`.concat(Gy,`

`),TB={[Bm]:"vertex",[fS]:"fragment"},FZ=`precision highp float;

`;function NZ(t,e){const{vs:n,fs:r}=e,i=fZ(e.modules||[]);return{gl:t,vs:jP(t,Object.assign({},e,{source:n,type:Bm,modules:i})),fs:jP(t,Object.assign({},e,{source:r,type:fS,modules:i})),getUniforms:UZ(i)}}function jP(t,e){let{id:n,source:r,type:i,modules:s,defines:l={},hookFunctions:o=[],inject:p={},transpileToGLSL100:_=!1,prologue:C=!0,log:M}=e;Ua(typeof r=="string","shader source must be a string");const k=i===Bm,F=r.split(`
`);let j=100,H="",ie=r;F[0].indexOf("#version ")===0?(j=300,H=F[0],ie=F.slice(1).join(`
`)):H="#version ".concat(j);const Y={};s.forEach(Ge=>{Object.assign(Y,Ge.getDefines())}),Object.assign(Y,l);let J=C?"".concat(H,`
`).concat(GZ({id:n,source:r,type:i}),`
`).concat(VZ({type:i}),`
`).concat(EZ(t),`
`).concat(TZ(t),`
`).concat($Z(Y),`
`).concat(k?"":FZ,`
`):"".concat(H,`
`);const se=HZ(o),he={},pe={},be={};for(const Ge in p){const We=typeof p[Ge]=="string"?{injection:p[Ge],order:0}:p[Ge],Xe=Ge.match(/^(v|f)s:(#)?([\w-]+)$/);if(Xe){const rt=Xe[2],Oe=Xe[3];rt?Oe==="decl"?pe[Ge]=[We]:be[Ge]=[We]:he[Ge]=[We]}else be[Ge]=[We]}for(const Ge of s){M&&Ge.checkDeprecations(ie,M);const We=Ge.getModuleSource(i,j);J+=We;const Xe=Ge.injections[i];for(const rt in Xe){const Oe=rt.match(/^(v|f)s:#([\w-]+)$/);if(Oe){const Ze=Oe[2]==="decl"?pe:be;Ze[rt]=Ze[rt]||[],Ze[rt].push(Xe[rt])}else he[rt]=he[rt]||[],he[rt].push(Xe[rt])}}return J+=OZ,J=$P(J,i,pe),J+=jZ(se[i],he),J+=ie,J=$P(J,i,be),J=RZ(J,_?100:j,k),J}function UZ(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function VZ(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(TB[e].toUpperCase(),`
`)}function GZ(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(TB[r],`

`):""}function $Z(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function jZ(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((l,o)=>l.order-o.order);for(const l of s)n+="  ".concat(l.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function HZ(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),l=n.replace(/\(.+/,"");e[i][l]=Object.assign(r,{signature:s})}),e}const WZ="void main() {gl_FragColor = vec4(0);}",SB=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,QZ=`#version 300 es
`.concat(SB);function CB(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const l=s.split(";")[0];return{qualifier:r,type:i,name:l}}function MB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?QZ:e>300?"#version ".concat(e,`
`).concat(SB):WZ;const s=YZ(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function qZ(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ua(!1),null}}function ZZ(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ua(!1),null}}function YZ(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Ua(!1),null}}const XZ=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,KZ={name:"fp32",vs:XZ,fs:null};function tm(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Oo={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function JZ(t,{precision:e=Oo.precision}={}){return t=eY(t),"".concat(parseFloat(t.toPrecision(e)))}function _f(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function nh(t,e,n){return nY(t,r=>Math.max(e,Math.min(n,r)))}function wl(t,e,n){return _f(t)?t.map((r,i)=>wl(r,e[i],n)):n*e+(1-n)*t}function Ju(t,e,n){const r=Oo.EPSILON;n&&(Oo.EPSILON=n);try{if(t===e)return!0;if(_f(t)&&_f(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Ju(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Oo.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Oo.EPSILON=r}}function eY(t){return Math.round(t/Oo.EPSILON)*Oo.EPSILON}function tY(t){return t.clone?t.clone():new Array(t.length)}function nY(t,e,n){if(_f(t)){const r=t;n=n||tY(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function rY(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class pS extends rY(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:_f(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Oo)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+JZ(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Ju(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Oo.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function iY(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Qr(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Eg(t,e,n=""){if(Oo.debug&&!iY(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class PB extends pS{get x(){return this[0]}set x(e){this[0]=Qr(e)}get y(){return this[1]}set y(e){this[1]=Qr(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return Qr(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Qr(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return tm(e>=0&&e<this.ELEMENTS,"index is out of range"),Qr(this[e])}setComponent(e,n){return tm(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var Tg=1e-6,pA=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function sY(){var t=new pA(2);return pA!=Float32Array&&(t[0]=0,t[1]=0),t}function N3(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function oY(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function aY(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function lY(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function AY(t,e){return t[0]=-e[0],t[1]=-e[1],t}function kB(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function uY(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function cY(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var hY=oY;(function(){var t=sY();return function(e,n,r,i,s,l){var o,p;for(n||(n=2),r||(r=0),i?p=Math.min(i*n+r,e.length):p=e.length,o=r;o<p;o+=n)t[0]=e[o],t[1]=e[o+1],s(t,t,l),e[o]=t[0],e[o+1]=t[1];return e}})();function fY(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function IB(t,e,n){const r=e[0],i=e[1],s=e[2],l=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/l,t[1]=(n[1]*r+n[5]*i+n[9]*s)/l,t[2]=(n[2]*r+n[6]*i+n[10]*s)/l,t}function dY(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function pY(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function LB(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*s,t[1]=n[1]*r+n[4]*i+n[7]*s,t[2]=n[2]*r+n[5]*i+n[8]*s,t[3]=e[3],t}function DB(){var t=new pA(3);return pA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function gY(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function HP(t,e,n){var r=new pA(3);return r[0]=t,r[1]=e,r[2]=n,r}function mY(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function yY(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function _Y(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function vY(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function xY(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function RB(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function $y(t,e,n){var r=e[0],i=e[1],s=e[2],l=n[0],o=n[1],p=n[2];return t[0]=i*p-s*o,t[1]=s*l-r*p,t[2]=r*o-i*l,t}function wY(t,e,n,r){var i=e[0],s=e[1],l=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=l+r*(n[2]-l),t}function gS(t,e,n){var r=e[0],i=e[1],s=e[2],l=n[3]*r+n[7]*i+n[11]*s+n[15];return l=l||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/l,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/l,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/l,t}function BB(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function zB(t,e,n){var r=n[0],i=n[1],s=n[2],l=n[3],o=e[0],p=e[1],_=e[2],C=i*_-s*p,M=s*o-r*_,k=r*p-i*o,F=i*k-s*M,j=s*C-r*k,H=r*M-i*C,ie=l*2;return C*=ie,M*=ie,k*=ie,F*=2,j*=2,H*=2,t[0]=o+C+F,t[1]=p+M+j,t[2]=_+k+H,t}function bY(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function EY(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function TY(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function SY(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],l=e[1],o=e[2],p=Math.sqrt(n*n+r*r+i*i),_=Math.sqrt(s*s+l*l+o*o),C=p*_,M=C&&RB(t,e)/C;return Math.acos(Math.min(Math.max(M,-1),1))}var OB=mY,CY=yY,FB=gY,Cw=_Y;(function(){var t=DB();return function(e,n,r,i,s,l){var o,p;for(n||(n=3),r||(r=0),i?p=Math.min(i*n+r,e.length):p=e.length,o=r;o<p;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],s(t,t,l),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const Mw=[0,0,0];let Q1;class An extends PB{static get ZERO(){return Q1||(Q1=new An(0,0,0),Object.freeze(Q1)),Q1}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&_f(e)?this.copy(e):(Oo.debug&&(Qr(e),Qr(n),Qr(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Oo.debug&&(Qr(e.x),Qr(e.y),Qr(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Qr(e)}angle(e){return SY(this,e)}cross(e){return $y(this,this,e),this.check()}rotateX({radians:e,origin:n=Mw}){return bY(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Mw}){return EY(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Mw}){return TY(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return gS(this,this,e),this.check()}transformAsVector(e){return IB(this,this,e),this.check()}transformByMatrix3(e){return BB(this,this,e),this.check()}transformByMatrix2(e){return dY(this,this,e),this.check()}transformByQuaternion(e){return zB(this,this,e),this.check()}}let q1;class mS extends PB{static get ZERO(){return q1||(q1=new mS(0,0,0,0),Object.freeze(q1)),q1}constructor(e=0,n=0,r=0,i=0){super(-0,-0,-0,-0),_f(e)&&arguments.length===1?this.copy(e):(Oo.debug&&(Qr(e),Qr(n),Qr(r),Qr(i)),this[0]=e,this[1]=n,this[2]=r,this[3]=i)}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Oo.debug&&(Qr(e.x),Qr(e.y),Qr(e.z),Qr(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Qr(e)}get w(){return this[3]}set w(e){this[3]=Qr(e)}transform(e){return gS(this,this,e),this.check()}transformByMatrix3(e){return LB(this,this,e),this.check()}transformByMatrix2(e){return pY(this,this,e),this.check()}transformByQuaternion(e){return zB(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class NB extends pS{toString(){let e="[";if(Oo.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Qr(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function MY(){var t=new pA(9);return pA!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function PY(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function kY(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=e[4],o=e[5],p=e[6],_=e[7],C=e[8],M=C*l-o*_,k=-C*s+o*p,F=_*s-l*p,j=n*M+r*k+i*F;return j?(j=1/j,t[0]=M*j,t[1]=(-C*r+i*_)*j,t[2]=(o*r-i*l)*j,t[3]=k*j,t[4]=(C*n-i*p)*j,t[5]=(-o*n+i*s)*j,t[6]=F*j,t[7]=(-_*n+r*p)*j,t[8]=(l*n-r*s)*j,t):null}function IY(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],l=t[5],o=t[6],p=t[7],_=t[8];return e*(_*s-l*p)+n*(-_*i+l*o)+r*(p*i-s*o)}function WP(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],p=e[5],_=e[6],C=e[7],M=e[8],k=n[0],F=n[1],j=n[2],H=n[3],ie=n[4],Y=n[5],J=n[6],se=n[7],he=n[8];return t[0]=k*r+F*l+j*_,t[1]=k*i+F*o+j*C,t[2]=k*s+F*p+j*M,t[3]=H*r+ie*l+Y*_,t[4]=H*i+ie*o+Y*C,t[5]=H*s+ie*p+Y*M,t[6]=J*r+se*l+he*_,t[7]=J*i+se*o+he*C,t[8]=J*s+se*p+he*M,t}function LY(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],p=e[5],_=e[6],C=e[7],M=e[8],k=n[0],F=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=l,t[4]=o,t[5]=p,t[6]=k*r+F*l+_,t[7]=k*i+F*o+C,t[8]=k*s+F*p+M,t}function DY(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],p=e[5],_=e[6],C=e[7],M=e[8],k=Math.sin(n),F=Math.cos(n);return t[0]=F*r+k*l,t[1]=F*i+k*o,t[2]=F*s+k*p,t[3]=F*l-k*r,t[4]=F*o-k*i,t[5]=F*p-k*s,t[6]=_,t[7]=C,t[8]=M,t}function QP(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function RY(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n+n,o=r+r,p=i+i,_=n*l,C=r*l,M=r*o,k=i*l,F=i*o,j=i*p,H=s*l,ie=s*o,Y=s*p;return t[0]=1-M-j,t[3]=C-Y,t[6]=k+ie,t[1]=C+Y,t[4]=1-_-j,t[7]=F-H,t[2]=k-ie,t[5]=F+H,t[8]=1-_-M,t}var U3;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(U3||(U3={}));const BY=Object.freeze([1,0,0,0,1,0,0,0,1]);class Os extends NB{static get IDENTITY(){return OY()}static get ZERO(){return zY()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return U3}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(BY)}fromObject(e){return this.check()}fromQuaternion(e){return RY(this,e),this.check()}set(e,n,r,i,s,l,o,p,_){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=l,this[6]=o,this[7]=p,this[8]=_,this.check()}setRowMajor(e,n,r,i,s,l,o,p,_){return this[0]=e,this[1]=i,this[2]=o,this[3]=n,this[4]=s,this[5]=p,this[6]=r,this[7]=l,this[8]=_,this.check()}determinant(){return IY(this)}transpose(){return PY(this,this),this.check()}invert(){return kY(this,this),this.check()}multiplyLeft(e){return WP(this,e,this),this.check()}multiplyRight(e){return WP(this,this,e),this.check()}rotate(e){return DY(this,this,e),this.check()}scale(e){return Array.isArray(e)?QP(this,this,e):QP(this,this,[e,e]),this.check()}translate(e){return LY(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=uY(n||[-0,-0],e,this);break;case 3:r=BB(n||[-0,-0,-0],e,this);break;case 4:r=LB(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Eg(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let Z1,Y1;function zY(){return Z1||(Z1=new Os([0,0,0,0,0,0,0,0,0]),Object.freeze(Z1)),Z1}function OY(){return Y1||(Y1=new Os,Object.freeze(Y1)),Y1}function FY(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function NY(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],l=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=l,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function V3(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=e[4],o=e[5],p=e[6],_=e[7],C=e[8],M=e[9],k=e[10],F=e[11],j=e[12],H=e[13],ie=e[14],Y=e[15],J=n*o-r*l,se=n*p-i*l,he=n*_-s*l,pe=r*p-i*o,be=r*_-s*o,Ge=i*_-s*p,We=C*H-M*j,Xe=C*ie-k*j,rt=C*Y-F*j,Oe=M*ie-k*H,nt=M*Y-F*H,Ze=k*Y-F*ie,pt=J*Ze-se*nt+he*Oe+pe*rt-be*Xe+Ge*We;return pt?(pt=1/pt,t[0]=(o*Ze-p*nt+_*Oe)*pt,t[1]=(i*nt-r*Ze-s*Oe)*pt,t[2]=(H*Ge-ie*be+Y*pe)*pt,t[3]=(k*be-M*Ge-F*pe)*pt,t[4]=(p*rt-l*Ze-_*Xe)*pt,t[5]=(n*Ze-i*rt+s*Xe)*pt,t[6]=(ie*he-j*Ge-Y*se)*pt,t[7]=(C*Ge-k*he+F*se)*pt,t[8]=(l*nt-o*rt+_*We)*pt,t[9]=(r*rt-n*nt-s*We)*pt,t[10]=(j*be-H*he+Y*J)*pt,t[11]=(M*he-C*be-F*J)*pt,t[12]=(o*Xe-l*Oe-p*We)*pt,t[13]=(n*Oe-r*Xe+i*We)*pt,t[14]=(H*se-j*pe-ie*J)*pt,t[15]=(C*pe-M*se+k*J)*pt,t):null}function UY(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],l=t[5],o=t[6],p=t[7],_=t[8],C=t[9],M=t[10],k=t[11],F=t[12],j=t[13],H=t[14],ie=t[15],Y=e*l-n*s,J=e*o-r*s,se=e*p-i*s,he=n*o-r*l,pe=n*p-i*l,be=r*p-i*o,Ge=_*j-C*F,We=_*H-M*F,Xe=_*ie-k*F,rt=C*H-M*j,Oe=C*ie-k*j,nt=M*ie-k*H;return Y*nt-J*Oe+se*rt+he*Xe-pe*We+be*Ge}function Af(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],p=e[5],_=e[6],C=e[7],M=e[8],k=e[9],F=e[10],j=e[11],H=e[12],ie=e[13],Y=e[14],J=e[15],se=n[0],he=n[1],pe=n[2],be=n[3];return t[0]=se*r+he*o+pe*M+be*H,t[1]=se*i+he*p+pe*k+be*ie,t[2]=se*s+he*_+pe*F+be*Y,t[3]=se*l+he*C+pe*j+be*J,se=n[4],he=n[5],pe=n[6],be=n[7],t[4]=se*r+he*o+pe*M+be*H,t[5]=se*i+he*p+pe*k+be*ie,t[6]=se*s+he*_+pe*F+be*Y,t[7]=se*l+he*C+pe*j+be*J,se=n[8],he=n[9],pe=n[10],be=n[11],t[8]=se*r+he*o+pe*M+be*H,t[9]=se*i+he*p+pe*k+be*ie,t[10]=se*s+he*_+pe*F+be*Y,t[11]=se*l+he*C+pe*j+be*J,se=n[12],he=n[13],pe=n[14],be=n[15],t[12]=se*r+he*o+pe*M+be*H,t[13]=se*i+he*p+pe*k+be*ie,t[14]=se*s+he*_+pe*F+be*Y,t[15]=se*l+he*C+pe*j+be*J,t}function Q_(t,e,n){var r=n[0],i=n[1],s=n[2],l,o,p,_,C,M,k,F,j,H,ie,Y;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(l=e[0],o=e[1],p=e[2],_=e[3],C=e[4],M=e[5],k=e[6],F=e[7],j=e[8],H=e[9],ie=e[10],Y=e[11],t[0]=l,t[1]=o,t[2]=p,t[3]=_,t[4]=C,t[5]=M,t[6]=k,t[7]=F,t[8]=j,t[9]=H,t[10]=ie,t[11]=Y,t[12]=l*r+C*i+j*s+e[12],t[13]=o*r+M*i+H*s+e[13],t[14]=p*r+k*i+ie*s+e[14],t[15]=_*r+F*i+Y*s+e[15]),t}function yS(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function VY(t,e,n,r){var i=r[0],s=r[1],l=r[2],o=Math.hypot(i,s,l),p,_,C,M,k,F,j,H,ie,Y,J,se,he,pe,be,Ge,We,Xe,rt,Oe,nt,Ze,pt,Yt;return o<Tg?null:(o=1/o,i*=o,s*=o,l*=o,p=Math.sin(n),_=Math.cos(n),C=1-_,M=e[0],k=e[1],F=e[2],j=e[3],H=e[4],ie=e[5],Y=e[6],J=e[7],se=e[8],he=e[9],pe=e[10],be=e[11],Ge=i*i*C+_,We=s*i*C+l*p,Xe=l*i*C-s*p,rt=i*s*C-l*p,Oe=s*s*C+_,nt=l*s*C+i*p,Ze=i*l*C+s*p,pt=s*l*C-i*p,Yt=l*l*C+_,t[0]=M*Ge+H*We+se*Xe,t[1]=k*Ge+ie*We+he*Xe,t[2]=F*Ge+Y*We+pe*Xe,t[3]=j*Ge+J*We+be*Xe,t[4]=M*rt+H*Oe+se*nt,t[5]=k*rt+ie*Oe+he*nt,t[6]=F*rt+Y*Oe+pe*nt,t[7]=j*rt+J*Oe+be*nt,t[8]=M*Ze+H*pt+se*Yt,t[9]=k*Ze+ie*pt+he*Yt,t[10]=F*Ze+Y*pt+pe*Yt,t[11]=j*Ze+J*pt+be*Yt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function UB(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],l=e[5],o=e[6],p=e[7],_=e[8],C=e[9],M=e[10],k=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+_*r,t[5]=l*i+C*r,t[6]=o*i+M*r,t[7]=p*i+k*r,t[8]=_*i-s*r,t[9]=C*i-l*r,t[10]=M*i-o*r,t[11]=k*i-p*r,t}function GY(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],l=e[1],o=e[2],p=e[3],_=e[8],C=e[9],M=e[10],k=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-_*r,t[1]=l*i-C*r,t[2]=o*i-M*r,t[3]=p*i-k*r,t[8]=s*r+_*i,t[9]=l*r+C*i,t[10]=o*r+M*i,t[11]=p*r+k*i,t}function VB(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],l=e[1],o=e[2],p=e[3],_=e[4],C=e[5],M=e[6],k=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+_*r,t[1]=l*i+C*r,t[2]=o*i+M*r,t[3]=p*i+k*r,t[4]=_*i-s*r,t[5]=C*i-l*r,t[6]=M*i-o*r,t[7]=k*i-p*r,t}function $Y(t,e){var n=e[0],r=e[1],i=e[2],s=e[4],l=e[5],o=e[6],p=e[8],_=e[9],C=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(s,l,o),t[2]=Math.hypot(p,_,C),t}function jY(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n+n,o=r+r,p=i+i,_=n*l,C=r*l,M=r*o,k=i*l,F=i*o,j=i*p,H=s*l,ie=s*o,Y=s*p;return t[0]=1-M-j,t[1]=C+Y,t[2]=k-ie,t[3]=0,t[4]=C-Y,t[5]=1-_-j,t[6]=F+H,t[7]=0,t[8]=k+ie,t[9]=F-H,t[10]=1-_-M,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function HY(t,e,n,r,i,s,l){var o=1/(n-e),p=1/(i-r),_=1/(s-l);return t[0]=s*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*p,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(i+r)*p,t[10]=(l+s)*_,t[11]=-1,t[12]=0,t[13]=0,t[14]=l*s*2*_,t[15]=0,t}function WY(t,e,n,r,i){var s=1/Math.tan(e/2),l;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(l=1/(r-i),t[10]=(i+r)*l,t[14]=2*i*r*l):(t[10]=-1,t[14]=-2*r),t}var QY=WY;function qY(t,e,n,r,i,s,l){var o=1/(e-n),p=1/(r-i),_=1/(s-l);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*p,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*_,t[11]=0,t[12]=(e+n)*o,t[13]=(i+r)*p,t[14]=(l+s)*_,t[15]=1,t}var ZY=qY;function YY(t,e,n,r){var i,s,l,o,p,_,C,M,k,F,j=e[0],H=e[1],ie=e[2],Y=r[0],J=r[1],se=r[2],he=n[0],pe=n[1],be=n[2];return Math.abs(j-he)<Tg&&Math.abs(H-pe)<Tg&&Math.abs(ie-be)<Tg?FY(t):(C=j-he,M=H-pe,k=ie-be,F=1/Math.hypot(C,M,k),C*=F,M*=F,k*=F,i=J*k-se*M,s=se*C-Y*k,l=Y*M-J*C,F=Math.hypot(i,s,l),F?(F=1/F,i*=F,s*=F,l*=F):(i=0,s=0,l=0),o=M*l-k*s,p=k*i-C*l,_=C*s-M*i,F=Math.hypot(o,p,_),F?(F=1/F,o*=F,p*=F,_*=F):(o=0,p=0,_=0),t[0]=i,t[1]=o,t[2]=C,t[3]=0,t[4]=s,t[5]=p,t[6]=M,t[7]=0,t[8]=l,t[9]=_,t[10]=k,t[11]=0,t[12]=-(i*j+s*H+l*ie),t[13]=-(o*j+p*H+_*ie),t[14]=-(C*j+M*H+k*ie),t[15]=1,t)}function XY(){var t=new pA(4);return pA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function KY(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function _S(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function JY(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function eX(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function tX(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n*n+r*r+i*i+s*s;return l>0&&(l=1/Math.sqrt(l)),t[0]=n*l,t[1]=r*l,t[2]=i*l,t[3]=s*l,t}function nX(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function rX(t,e,n,r){var i=e[0],s=e[1],l=e[2],o=e[3];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=l+r*(n[2]-l),t[3]=o+r*(n[3]-o),t}function Hd(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*l,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*l,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*l,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*l,t}function iX(t,e,n){var r=e[0],i=e[1],s=e[2],l=n[0],o=n[1],p=n[2],_=n[3],C=_*r+o*s-p*i,M=_*i+p*r-l*s,k=_*s+l*i-o*r,F=-l*r-o*i-p*s;return t[0]=C*_+F*-l+M*-p-k*-o,t[1]=M*_+F*-o+k*-l-C*-p,t[2]=k*_+F*-p+C*-o-M*-l,t[3]=e[3],t}(function(){var t=XY();return function(e,n,r,i,s,l){var o,p;for(n||(n=4),r||(r=0),i?p=Math.min(i*n+r,e.length):p=e.length,o=r;o<p;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,l),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var G3;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(G3||(G3={}));const sX=45*Math.PI/180,oX=1,Pw=.1,kw=500,aX=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class ha extends NB{static get IDENTITY(){return AX()}static get ZERO(){return lX()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return G3}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,l,o,p,_,C,M,k,F,j,H,ie){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=l,this[6]=o,this[7]=p,this[8]=_,this[9]=C,this[10]=M,this[11]=k,this[12]=F,this[13]=j,this[14]=H,this[15]=ie,this.check()}setRowMajor(e,n,r,i,s,l,o,p,_,C,M,k,F,j,H,ie){return this[0]=e,this[1]=s,this[2]=_,this[3]=F,this[4]=n,this[5]=l,this[6]=C,this[7]=j,this[8]=r,this[9]=o,this[10]=M,this[11]=H,this[12]=i,this[13]=p,this[14]=k,this[15]=ie,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(aX)}fromObject(e){return this.check()}fromQuaternion(e){return jY(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:l=Pw,far:o=kw}=e;return o===1/0?uX(this,n,r,i,s,l):HY(this,n,r,i,s,l,o),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return YY(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:l=Pw,far:o=kw}=e;return ZY(this,n,r,i,s,l,o),this.check()}orthographic(e){const{fovy:n=sX,aspect:r=oX,focalDistance:i=1,near:s=Pw,far:l=kw}=e;qP(n);const o=n/2,p=i*Math.tan(o),_=p*r;return this.ortho({left:-_,right:_,bottom:-p,top:p,near:s,far:l})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return qP(n),QY(this,n,r,i,s),this.check()}determinant(){return UY(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],l=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*l,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*l,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],l=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*l,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*l,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*l,e}transpose(){return NY(this,this),this.check()}invert(){return V3(this,this),this.check()}multiplyLeft(e){return Af(this,e,this),this.check()}multiplyRight(e){return Af(this,this,e),this.check()}rotateX(e){return UB(this,this,e),this.check()}rotateY(e){return GY(this,this,e),this.check()}rotateZ(e){return VB(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return VY(this,this,e,n),this.check()}scale(e){return yS(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Q_(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Hd(n||[-0,-0,-0,-0],e,this),Eg(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=cY(n||[-0,-0],e,this);break;case 3:i=gS(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Eg(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=fY(n||[-0,-0],e,this);break;case 3:r=IB(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Eg(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let X1,K1;function lX(){return X1||(X1=new ha([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(X1)),X1}function AX(){return K1||(K1=new ha,Object.freeze(K1)),K1}function qP(t){if(t>Math.PI*2)throw Error("expected radians")}function uX(t,e,n,r,i,s){const l=2*s/(n-e),o=2*s/(i-r),p=(n+e)/(n-e),_=(i+r)/(i-r),C=-1,M=-1,k=-2*s;return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=p,t[9]=_,t[10]=C,t[11]=M,t[12]=0,t[13]=0,t[14]=k,t[15]=0,t}function ZP(){var t=new pA(4);return pA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function cX(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function GB(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function YP(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=n[0],p=n[1],_=n[2],C=n[3];return t[0]=r*C+l*o+i*_-s*p,t[1]=i*C+l*p+s*o-r*_,t[2]=s*C+l*_+r*p-i*o,t[3]=l*C-r*o-i*p-s*_,t}function hX(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],l=e[3],o=Math.sin(n),p=Math.cos(n);return t[0]=r*p+l*o,t[1]=i*p+s*o,t[2]=s*p-i*o,t[3]=l*p-r*o,t}function fX(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],l=e[3],o=Math.sin(n),p=Math.cos(n);return t[0]=r*p-s*o,t[1]=i*p+l*o,t[2]=s*p+r*o,t[3]=l*p-i*o,t}function dX(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],l=e[3],o=Math.sin(n),p=Math.cos(n);return t[0]=r*p+i*o,t[1]=i*p-r*o,t[2]=s*p+l*o,t[3]=l*p-s*o,t}function pX(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function jy(t,e,n,r){var i=e[0],s=e[1],l=e[2],o=e[3],p=n[0],_=n[1],C=n[2],M=n[3],k,F,j,H,ie;return F=i*p+s*_+l*C+o*M,F<0&&(F=-F,p=-p,_=-_,C=-C,M=-M),1-F>Tg?(k=Math.acos(F),j=Math.sin(k),H=Math.sin((1-r)*k)/j,ie=Math.sin(r*k)/j):(H=1-r,ie=r),t[0]=H*i+ie*p,t[1]=H*s+ie*_,t[2]=H*l+ie*C,t[3]=H*o+ie*M,t}function gX(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n*n+r*r+i*i+s*s,o=l?1/l:0;return t[0]=-n*o,t[1]=-r*o,t[2]=-i*o,t[3]=s*o,t}function mX(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function $B(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,l=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[s*3+s]-e[l*3+l]+1),t[i]=.5*r,r=.5/r,t[3]=(e[s*3+l]-e[l*3+s])*r,t[s]=(e[s*3+i]+e[i*3+s])*r,t[l]=(e[l*3+i]+e[i*3+l])*r}return t}var yX=KY,_X=_S,vX=nX,xX=rX,wX=JY,bX=eX,jB=tX,EX=function(){var t=DB(),e=HP(1,0,0),n=HP(0,1,0);return function(r,i,s){var l=RB(i,s);return l<-.999999?($y(t,e,i),FB(t)<1e-6&&$y(t,n,i),xY(t,t),GB(r,t,Math.PI),r):l>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):($y(t,i,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+l,jB(r,r))}}();(function(){var t=ZP(),e=ZP();return function(n,r,i,s,l,o){return jy(t,r,l,o),jy(e,i,s,o),jy(n,t,e,2*o*(1-o)),n}})();(function(){var t=MY();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],jB(e,$B(e,t))}})();const TX=[0,0,0,1];class XP extends pS{constructor(e=0,n=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return $B(this,e),this.check()}fromAxisRotation(e,n){return GB(this,e,n),this.check()}identity(){return cX(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Qr(e)}get y(){return this[1]}set y(e){this[1]=Qr(e)}get z(){return this[2]}set z(e){this[2]=Qr(e)}get w(){return this[3]}set w(e){this[3]=Qr(e)}len(){return wX(this)}lengthSquared(){return bX(this)}dot(e){return vX(this,e)}rotationTo(e,n){return EX(this,e,n),this.check()}add(e){return yX(this,this,e),this.check()}calculateW(){return pX(this,this),this.check()}conjugate(){return mX(this,this),this.check()}invert(){return gX(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(xX(this,e,n,r),this.check())}multiplyRight(e){return YP(this,this,e),this.check()}multiplyLeft(e){return YP(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return hX(this,this,e),this.check()}rotateY(e){return fX(this,this,e),this.check()}rotateZ(e){return dX(this,this,e),this.check()}scale(e){return _X(this,this,e),this.check()}slerp(e,n,r){let i,s,l;switch(arguments.length){case 1:({start:i=TX,target:s,ratio:l}=e);break;case 2:i=this,s=e,l=n;break;default:i=e,s=n,l=r}return jy(this,i,s,l),this.check()}transformVector4(e,n=new mS){return iX(n,e,this),Eg(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const HB={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},KP=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,SX={lightSources:{}};function Iw(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function CX(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=Iw(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,l)=>{i["lighting_uPointLight[".concat(l,"].color")]=Iw(s),i["lighting_uPointLight[".concat(l,"].position")]=s.position,i["lighting_uPointLight[".concat(l,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,l)=>{i["lighting_uDirectionalLight[".concat(l,"].color")]=Iw(s),i["lighting_uDirectionalLight[".concat(l,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function WB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:SX;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},CX({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return WB({lightSources:e})}return{}}const QB={name:"lights",vs:KP,fs:KP,getUniforms:WB,defines:{MAX_LIGHTS:3}},MX=new Uint8Array([0,255,255,255]),PX={pickingSelectedColor:null,pickingHighlightColor:MX,pickingActive:!1,pickingAttribute:!1};function kX(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:PX;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const IX=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,LX=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,DX={name:"picking",vs:IX,fs:LX,getUniforms:kX},qB=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,RX={};function BX(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function ZB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:RX;if(!("material"in t))return{};const{material:e}=t;return e?BX(e):{lighting_uEnabled:!1}}const zX={name:"gouraud-lighting",dependencies:[QB],vs:qB,defines:{LIGHTING_VERTEX:1},getUniforms:ZB},OX={name:"phong-lighting",dependencies:[QB],fs:qB,defines:{LIGHTING_FRAGMENT:1},getUniforms:ZB},FX=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,NX={name:"transform",vs:FX,fs:null};class zm{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new zm(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:l=[],bufferMode:o=35981,transpileToGLSL100:p=!1}=e,_=this._getModuleList(e.modules),C=this._getHash(n),M=this._getHash(r),k=_.map(se=>this._getHash(se.name)).sort(),F=l.map(se=>this._getHash(se)),j=Object.keys(i).sort(),H=Object.keys(s).sort(),ie=[],Y=[];for(const se of j)ie.push(this._getHash(se)),ie.push(this._getHash(i[se]));for(const se of H)Y.push(this._getHash(se)),Y.push(this._getHash(s[se]));const J="".concat(C,"/").concat(M,"D").concat(ie.join("/"),"M").concat(k.join("/"),"I").concat(Y.join("/"),"V").concat(F.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(p?"T":"");if(!this._programCache[J]){const se=NZ(this.gl,{vs:n,fs:r,modules:_,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:p});this._programCache[J]=new _B(this.gl,{hash:J,vs:se.vs,fs:se.fs,varyings:l,bufferMode:o}),this._getUniforms[J]=se.getUniforms||(he=>{}),this._useCounts[J]=0}return this._useCounts[J]++,this._programCache[J]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,l=this._defaultModules.length;s<l;++s){const o=this._defaultModules[s],p=o.name;n[i++]=o,r[p]=!0}for(let s=0,l=e.length;s<l;++s){const o=e[s],p=o.name;r[p]||(n[i++]=o,r[p]=!0)}return n.length=i,n}}const UX={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function VX(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const l=e.attributes[s],o=GX(s,n);if(s==="indices")i=l;else if(l.constant)r[o]=l.value;else{const p=l.value,_={...l};delete _.value,r[o]=[new Gr(t,p),_],$X(s,_)}}if(i){const s=i.value||i;nn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const l={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new Gr(t,{data:s,target:34963}),l]}return r}function GX(t,e){const{attributeMap:n=UX}=e||{};return n&&n[t]||t}function $X(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}nn(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const p0=2,jX=1e4,HX="Model needs drawMode and vertexCount",JP=()=>{},WX={};class Ac{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=vh("model")}=n;nn(pv(e)),this.id=r,this.gl=e,this.id=n.id||vh("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||zm.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:p,bufferMode:_,transpileToGLSL100:C}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:p,bufferMode:_,transpileToGLSL100:C},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},nn(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),HX)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:p,bufferMode:_,transpileToGLSL100:C}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:p,bufferMode:_,transpileToGLSL100:C},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return nn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return nn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=VX(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(wd(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return uS(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:l=this.transformFeedback,parameters:o={},vertexArray:p=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let _;vn.priority>=p0&&(_=this._logDrawCallStart(p0));const C=this.vertexArray.getDrawParams(),{isIndexed:M=C.isIndexed,indexType:k=C.indexType,indexOffset:F=C.indexOffset,vertexArrayInstanced:j=C.isInstanced}=this.props;j&&!this.isInstanced&&vn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:H,instanceCount:ie}=this,{onBeforeRender:Y=JP,onAfterRender:J=JP}=this.props;Y(),this.program.setUniforms(this.uniforms);const se=this.program.draw(Object.assign(WX,e,{logPriority:_,uniforms:null,framebuffer:r,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:p,transformFeedback:l,isIndexed:M,indexType:k,isInstanced:H,instanceCount:ie,offset:M?F:0}));return J(),vn.priority>=p0&&this._logDrawCallEnd(_,p,r),se}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{35977:n})),i.forEach(l=>l.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(l=>l.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return vn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:l,defines:o,varyings:p,bufferMode:_,transpileToGLSL100:C}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:l,defines:o,varyings:p,bufferMode:_,transpileToGLSL100:C}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}nn(n instanceof _B,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Kq(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof Gr&&n.delete()}}_setAnimationProps(e){this.animated&&nn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(wd(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new vB(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:jX;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),vn.group(p0,">>> DRAWING MODEL ".concat(this.id),{collapsed:vn.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=tZ({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:l,unusedTable:o,unusedCount:p}=RP({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:_,count:C}=RP({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});C>0&&vn.log("MISSING UNIFORMS",Object.keys(_))(),p>0&&vn.log("UNUSED UNIFORMS",Object.keys(o))();const M=rZ(this.vertexArray.configuration);vn.table(e,s)(),vn.table(e,l)(),vn.table(e+1,M)(),i&&i.log({logLevel:p0,message:"Rendered to ".concat(i.id)}),vn.groupEnd(p0)()}}class QX{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof Gr?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&nn(dr(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const l=n[s],{byteLength:o,usage:p,accessor:_}=l;r[i]=this._createNewBuffer(i,{byteLength:o,usage:p,accessor:_})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new vB(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],nn(r[s]instanceof Gr)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new Gr(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const qX="transform_uSampler_",q_="transform_uSize_",ek="transform_position";function ZX(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,l=Object.keys(n).length,o=null;const p={};let _=e,C={};if(l>0||r){const M=_.split(`
`),k=M.slice();if(M.forEach((F,j,H)=>{if(l>0){const ie=eK(F,n);if(ie){const{updatedLine:Y,inject:J}=ie;k[j]=Y,C=z3([C,J]),Object.assign(p,ie.samplerTextureMap),l--}}r&&!o&&(o=JX(F,r))}),r){nn(i);const F="".concat(q_).concat(r),j="uniform vec2 ".concat(F,`;
`),H="     vec2 ".concat(ek," = transform_getPos(").concat(F,`);
     gl_Position = vec4(`).concat(ek,`, 0, 1.);
`);C=z3([C,{"vs:#decl":j,"vs:#main-start":H}])}_=k.join(`
`)}return{vs:_,targetTextureType:o,inject:C,samplerTextureMap:p}}function YX(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,l;n&&({width:s,height:l}=r,i["".concat(q_).concat(n)]=[s,l]);for(const o in e)({width:s,height:l}=e[o]),i["".concat(q_).concat(o)]=[s,l];return i}function XX(t){return CB(t,["attribute","in"])}function KX(t){const e="".concat(qX).concat(t),n="".concat(q_).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function JX(t,e){const n=CB(t,["varying","out"]);return n&&n.name===e?n.type:null}function eK(t,e){const n={},r=XX(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const l="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:o,sizeName:p,uniformDeclerations:_}=KX(s),C=qZ(i),M="  ".concat(i," ").concat(s," = transform_getInput(").concat(o,", ").concat(p,").").concat(C,`;
`);return n[o]=s,{updatedLine:l,inject:{"vs:#decl":_,"vs:#main-start":M},samplerTextureMap:n}}return null}const tK={10241:9728,10240:9728,10242:33071,10243:33071},nK="transform_output";class rK{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],l=Object.assign({},n,e.attributes),o=Object.assign({},e.uniforms),p=Object.assign({},e.parameters);let _=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){l.transform_elementID=this.elementIDBuffer;for(const M in this.samplerTextureMap){const k=this.samplerTextureMap[M];o[M]=r[k]}this._setSourceTextureParameters();const C=YX({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(o,C)}return this.hasTargetTexture&&(_=!1,p.viewport=[0,0,i.width,i.height]),{attributes:l,framebuffer:i,uniforms:o,discard:_,parameters:p}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=mv(n);if(!e)return r;const i=r.constructor,s=ZZ(this.targetTextureType),l=new i(r.length*s/4);let o=0;for(let p=0;p<r.length;p+=4)for(let _=0;_<s;_++)l[o++]=r[p+_];return l}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof da)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new Gr(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:l,height:o}=s,{framebuffer:p}=e;p?(p.update({attachments:{36064:s},resizeAttachments:!1}),p.resize({width:l,height:o})):e.framebuffer=new os(this.gl,{id:"transform-framebuffer",width:l,height:o,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(tK)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=VQ(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:l,inject:o,samplerTextureMap:p}=ZX({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),_=z3([e.inject||{},o]);this.targetTextureType=l,this.samplerTextureMap=p;const C=e._fs||MB({version:mB(i),input:this.targetTextureVarying,inputType:l,output:nK}),M=this.hasSourceTextures||this.targetTextureVarying?[NX].concat(e.modules||[]):e.modules;return{vs:i,fs:C,modules:M,uniforms:s,inject:_}}}let vS=class{static isSupported(e){return dr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();nn(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Ac(n,Object.assign({},e,{fs:e.fs||MB({version:mB(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){iK(n)&&(this.bufferTransform=new QX(e,n)),sK(n)&&(this.textureTransform=new rK(e,n)),nn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}};function iK(t){return!!(!wd(t.feedbackBuffers)||!wd(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function sK(t){return!!(!wd(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const tk={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class ec{static get DRAW_MODE(){return tk}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=vh("geometry"),drawMode:r=tk.TRIANGLES,attributes:i={},indices:s=null,vertexCount:l=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=l||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,nn(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(nn(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:l,size:o,constant:p}=s;!p&&l&&o>=1&&(r=Math.min(r,l.length/o))}return nn(Number.isFinite(r)),r}}let oK=1,aK=1;class YB{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,l=oK++,o={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(o,this.time),this.channels.set(l,o),l}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:l}=i;s.setTime(this.getTime(l))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=aK++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const lK=[255,255,255],AK=1;let uK=0;class XB{constructor(e={}){oe(this,"id",void 0),oe(this,"color",void 0),oe(this,"intensity",void 0),oe(this,"type","ambient");const{color:n=lK}=e,{intensity:r=AK}=e;this.id=e.id||"ambient-".concat(uK++),this.color=n,this.intensity=r}}const cK=[255,255,255],hK=1,fK=[0,0,-1];let dK=0;class $3{constructor(e={}){oe(this,"id",void 0),oe(this,"color",void 0),oe(this,"intensity",void 0),oe(this,"type","directional"),oe(this,"direction",void 0),oe(this,"shadow",void 0);const{color:n=cK}=e,{intensity:r=hK}=e,{direction:i=fK}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(dK++),this.color=n,this.intensity=r,this.type="directional",this.direction=new An(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class pK{constructor(e,n={id:"pass"}){oe(this,"id",void 0),oe(this,"gl",void 0),oe(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class xS extends pK{constructor(...e){super(...e),oe(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return lc(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:l,clearStack:o=!0,clearCanvas:p=!0}=e;e.pass=e.pass||"unknown";const _=this.gl;p&&mK(_,n),o&&(this._lastRenderIndex=-1);const C=[];for(const M of i){const k=s&&s[M.id];l?.(M);const F=this._getDrawLayerParams(M,e),j=M.subViewports||[M];for(const H of j){const ie=this._drawLayersInViewport(_,{target:n,moduleParameters:r,viewport:H,view:k,pass:e.pass,layers:e.layers},F);C.push(ie)}}return C}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:l,effects:o,moduleParameters:p},_=!1){const C=[],M=KB(this._lastRenderIndex+1),k={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:l},F={};for(let j=0;j<n.length;j++){const H=n[j],ie=this._shouldDrawLayer(H,k,s,F),Y={shouldDrawLayer:ie};ie&&!_&&(Y.layerRenderIndex=M(H,ie),Y.moduleParameters=this._getModuleParameters(H,o,r,p),Y.layerParameters=this.getLayerParameters(H,j,e)),C[j]=Y}return C}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:l,view:o},p){const _=gK(e,{moduleParameters:r,target:s,viewport:l});if(o&&o.props.clear){const M=o.props.clear===!0?{color:!0,depth:!0}:o.props.clear;fA(e,{scissorTest:!0,scissor:_},()=>uS(e,M))}const C={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};lc(e,{viewport:_});for(let M=0;M<n.length;M++){const k=n[M],{shouldDrawLayer:F,layerRenderIndex:j,moduleParameters:H,layerParameters:ie}=p[M];if(F&&k.props.pickable&&C.pickableCount++,k.isComposite)C.compositeCount++;else if(F){C.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,j),H.viewport=l;try{k._drawLayer({moduleParameters:H,uniforms:{layerIndex:j},parameters:ie})}catch(Y){k.raiseError(Y,"drawing ".concat(k," to ").concat(i))}}}return C}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let l=e.parent;for(;l;){if(!l.props.visible||!l.filterSubLayer(n))return!1;n.layer=l,l=l.parent}if(r){const o=n.layer.id;if(o in i||(i[o]=r(n)),!i[o])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const l=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:xd(this.gl)});if(n)for(const p of n){var o;Object.assign(l,(o=p.getModuleParameters)===null||o===void 0?void 0:o.call(p,e))}return Object.assign(l,this.getModuleParameters(e,n),i)}}function KB(t=0,e={}){const n={},r=(i,s)=>{const l=i.props._offset,o=i.id,p=i.parent&&i.parent.id;let _;if(p&&!(p in e)&&r(i.parent,!1),p in n){const C=n[p]=n[p]||KB(e[p],e);_=C(i,s),n[o]=C}else Number.isFinite(l)?(_=l+(e[p]||0),n[o]=null):_=t;return s&&_>=t&&(t=_+1),e[o]=_,_};return r}function gK(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||xd(t),l=i?n.height:t.drawingBufferHeight,o=r;return[o.x*s,l-(o.y+o.height)*s,o.width*s,o.height*s]}function mK(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;lc(t,{viewport:[0,0,n,r]}),t.clear(16640)}class yK extends xS{constructor(e,n){super(e,n),oe(this,"shadowMap",void 0),oe(this,"depthBuffer",void 0),oe(this,"fbo",void 0),this.shadowMap=new da(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new B0(e,{format:33189,width:1,height:1}),this.fbo=new os(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;fA(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=xd(this.gl),s=r.width*i,l=r.height*i;(s!==n.width||l!==n.height)&&n.resize({width:s,height:l}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const JB="#define SMOOTH_EDGE_RADIUS 0.5",_K=`
`.concat(JB,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),vK=`
`.concat(JB,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),xK={name:"geometry",vs:_K,fs:vK},wK=Object.keys(fr).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(fr[t],";")).join(""),bK=Object.keys(iA).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(iA[t],";")).join(""),EK=Object.keys(mf).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(mf[t],";")).join(""),TK="".concat(wK,`
`).concat(bK,`
`).concat(EK,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function SK(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Om(t){let e={},n;return r=>{for(const i in r)if(!SK(r[i],e[i])){n=t(r),e=r;break}return n}}const nk=[0,0,0,0],CK=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],ez=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],MK=[0,0,0],tz=[0,0,0],PK=Om(LK);function nz(t,e,n=tz){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===fr.LNGLAT_OFFSETS||e===fr.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case iA.WEB_MERCATOR:(e===fr.LNGLAT||e===fr.CARTESIAN)&&(i=[0,0,0],s=!1);break;case iA.WEB_MERCATOR_AUTO_OFFSET:e===fr.LNGLAT?r=i:e===fr.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case iA.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case iA.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function kK(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:l}=t,o=nk,p=nk,_=t.cameraPosition;const{geospatialOrigin:C,shaderCoordinateOrigin:M,offsetMode:k}=nz(t,e,n);return k&&(p=t.projectPosition(C||M),_=[_[0]-p[0],_[1]-p[1],_[2]-p[2]],p[3]=1,o=Hd([],p,l),s=r||s,l=Af([],i,s),l=Af([],l,CK)),{viewMatrix:s,viewProjectionMatrix:l,projectionCenter:o,originCommon:p,cameraPosCommon:_,shaderCoordinateOrigin:M,geospatialOrigin:C}}function IK({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=fr.DEFAULT,coordinateOrigin:i=tz,autoWrapLongitude:s=!1}){r===fr.DEFAULT&&(r=t.isGeospatial?fr.LNGLAT:fr.CARTESIAN);const l=PK({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return l.project_uWrapLongitude=s,l.project_uModelMatrix=n||ez,l}function LK({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:l,cameraPosCommon:o,shaderCoordinateOrigin:p,geospatialOrigin:_}=kK(t,n,r),C=t.getDistanceScales(),M=[t.width*e,t.height*e],k=Hd([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,F={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:p,project_uCommonOrigin:l.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:M,project_uDevicePixelRatio:e,project_uFocalDistance:k,project_uCommonUnitsPerMeter:C.unitsPerMeter,project_uCommonUnitsPerWorldUnit:C.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:MK,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:ez,project_uCameraPosition:o};if(_){const j=t.getDistanceScales(_);switch(n){case fr.METER_OFFSETS:F.project_uCommonUnitsPerWorldUnit=j.unitsPerMeter,F.project_uCommonUnitsPerWorldUnit2=j.unitsPerMeter2;break;case fr.LNGLAT:case fr.LNGLAT_OFFSETS:t._pseudoMeters||(F.project_uCommonUnitsPerMeter=j.unitsPerMeter),F.project_uCommonUnitsPerWorldUnit=j.unitsPerDegree,F.project_uCommonUnitsPerWorldUnit2=j.unitsPerDegree2;break;case fr.CARTESIAN:F.project_uCommonUnitsPerWorldUnit=[1,1,j.unitsPerMeter[2]],F.project_uCommonUnitsPerWorldUnit2=[0,0,j.unitsPerMeter2[2]];break}}return F}const DK={};function RK(t=DK){return"viewport"in t?IK(t):{}}const wS={name:"project",dependencies:[KZ,xK],vs:TK,getUniforms:RK};function BK(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function rd(t,e){const n=Hd([],e,t);return _S(n,n,1/n[3]),n}function rk(t,e){const n=t%e;return n<0?e+n:n}function zK(t,e,n){return n*e+(1-n)*t}function j3(t,e,n){return t<e?e:t>n?n:t}function OK(t){return Math.log(t)*Math.LOG2E}const bS=Math.log2||OK;function uc(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const sA=Math.PI,rz=sA/4,bl=sA/180,H3=180/sA,Ed=512,Z_=4003e4,J1=85.051129,FK=1.5;function ik(t){return Math.pow(2,t)}function iz(t){return bS(t)}function gA(t){const[e,n]=t;uc(Number.isFinite(e)),uc(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*bl,i=n*bl,s=Ed*(r+sA)/(2*sA),l=Ed*(sA+Math.log(Math.tan(rz+i*.5)))/(2*sA);return[s,l]}function vf(t){const[e,n]=t,r=e/Ed*(2*sA)-sA,i=2*(Math.atan(Math.exp(n/Ed*(2*sA)-sA))-rz);return[r*H3,i*H3]}function NK(t){const{latitude:e}=t;uc(Number.isFinite(e));const n=Math.cos(e*bl);return iz(Z_*n)-9}function Hy(t){const e=Math.cos(t*bl);return Ed/Z_/e}function W3(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;uc(Number.isFinite(e)&&Number.isFinite(n));const i=Ed,s=Math.cos(e*bl),l=i/360,o=l/s,p=i/Z_/s,_={unitsPerMeter:[p,p,p],metersPerUnit:[1/p,1/p,1/p],unitsPerDegree:[l,o,p],degreesPerUnit:[1/l,1/o,1/p]};if(r){const C=bl*Math.tan(e*bl)/s,M=l*C/2,k=i/Z_*C,F=k/o*p;_.unitsPerDegree2=[0,M,k],_.unitsPerMeter2=[F,0,F]}return _}function sz(t,e){const[n,r,i]=t,[s,l,o]=e,{unitsPerMeter:p,unitsPerMeter2:_}=W3({longitude:n,latitude:r,highPrecision:!0}),C=gA(t);C[0]+=s*(p[0]+_[0]*l),C[1]+=l*(p[1]+_[1]*l);const M=vf(C),k=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[M[0],M[1],k]:M}function UK(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:l}=t,o=BK();Q_(o,o,[0,0,-i]),UB(o,o,-n*bl),VB(o,o,r*bl);const p=s/e;return yS(o,o,[p,p,p]),l&&Q_(o,o,vY([],l)),o}function VK(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:l,scale:o,nearZMultiplier:p=1,farZMultiplier:_=1}=t;let{fovy:C=Y_(FK)}=t;r!==void 0&&(C=Y_(r));const M=C*bl,k=i*bl,F=oz(C);let j=F;l&&(j+=l[2]*o/Math.cos(k)/n);const H=M*(.5+(s?s[1]:0)/n),ie=Math.sin(H)*j/Math.sin(j3(Math.PI/2-k-H,.01,Math.PI-.01)),Y=Math.sin(k)*ie+j,J=j*10,se=Math.min(Y*_,J);return{fov:M,aspect:e/n,focalDistance:F,near:p,far:se}}function Y_(t){return 2*Math.atan(.5/t)*H3}function oz(t){return .5/Math.tan(.5*t*bl)}function az(t,e){const[n,r,i=0]=t;return uc(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),rd(e,[n,r,i,1])}function ES(t,e,n=0){const[r,i,s]=t;if(uc(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return rd(e,[r,i,s,1]);const l=rd(e,[r,i,0,1]),o=rd(e,[r,i,1,1]),p=l[2],_=o[2],C=p===_?0:((n||0)-p)/(_-p);return kB([],l,o,C)}function GK(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:l=[0,0]}=t,[[o,p],[_,C]]=r,M=$K(t.padding),k=gA([o,j3(C,-J1,J1)]),F=gA([_,j3(p,-J1,J1)]),j=[Math.max(Math.abs(F[0]-k[0]),i),Math.max(Math.abs(F[1]-k[1]),i)],H=[e-M.left-M.right-Math.abs(l[0])*2,n-M.top-M.bottom-Math.abs(l[1])*2];uc(H[0]>0&&H[1]>0);const ie=H[0]/j[0],Y=H[1]/j[1],J=(M.right-M.left)/2/ie,se=(M.top-M.bottom)/2/Y,he=[(F[0]+k[0])/2+J,(F[1]+k[1])/2+se],pe=vf(he),be=Math.min(s,bS(Math.abs(Math.min(ie,Y))));return uc(Number.isFinite(be)),{longitude:pe[0],latitude:pe[1],zoom:be}}function $K(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(uc(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const sk=Math.PI/180;function jK(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},l=i([0,r],s),o=i([n,r],s);let p,_;const C=t.fovy?.5*t.fovy*sk:Math.atan(.5/t.altitude),M=(90-t.pitch)*sk;return C>M-.01?(p=ok(t,0,e),_=ok(t,n,e)):(p=i([0,0],s),_=i([n,0],s)),[l,o,_,p]}function ok(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=rd(r,[e,0,1,1]),s=rd(r,[e,t.height,1,1]),o=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),p=kB([],i,s,o),_=vf(p);return _.push(n),_}const ak=512;function HK(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:l,bearing:o=0}=t;(i<-180||i>180)&&(i=rk(i+180,360)-180),(o<-180||o>180)&&(o=rk(o+180,360)-180);const p=bS(n/ak);if(l<=p)l=p,s=0;else{const _=n/2/Math.pow(2,l),C=vf([0,_])[1];if(s<C)s=C;else{const M=vf([0,ak-_])[1];s>M&&(s=M)}}return{width:e,height:n,longitude:i,latitude:s,zoom:l,pitch:r,bearing:o}}const lz=.01,WK=["longitude","latitude","zoom"],Az={curve:1.414,speed:1.2};function QK(t,e,n,r){const{startZoom:i,startCenterXY:s,uDelta:l,w0:o,u1:p,S:_,rho:C,rho2:M,r0:k}=uz(t,e,r);if(p<lz){const he={};for(const pe of WK){const be=t[pe],Ge=e[pe];he[pe]=zK(be,Ge,n)}return he}const F=n*_,j=Math.cosh(k)/Math.cosh(k+C*F),H=o*((Math.cosh(k)*Math.tanh(k+C*F)-Math.sinh(k))/M)/p,ie=1/j,Y=i+iz(ie),J=aY([],l,H);N3(J,J,s);const se=vf(J);return{longitude:se[0],latitude:se[1],zoom:Y}}function qK(t,e,n){const r={...Az,...n},{screenSpeed:i,speed:s,maxDuration:l}=r,{S:o,rho:p}=uz(t,e,r),_=1e3*o;let C;return Number.isFinite(i)?C=_/(i/p):C=_/s,Number.isFinite(l)&&C>l?0:C}function uz(t,e,n){n=Object.assign({},Az,n);const r=n.curve,i=t.zoom,s=[t.longitude,t.latitude],l=ik(i),o=e.zoom,p=[e.longitude,e.latitude],_=ik(o-i),C=gA(s),M=gA(p),k=hY([],M,C),F=Math.max(t.width,t.height),j=F/_,H=lY(k)*l,ie=Math.max(H,lz),Y=r*r,J=(j*j-F*F+Y*Y*ie*ie)/(2*F*Y*ie),se=(j*j-F*F-Y*Y*ie*ie)/(2*j*Y*ie),he=Math.log(Math.sqrt(J*J+1)-J),pe=Math.log(Math.sqrt(se*se+1)-se),be=(pe-he)/r;return{startZoom:i,startCenterXY:C,uDelta:k,w0:F,u1:H,S:be,rho:r,rho2:Y,r0:he,r1:pe}}const ZK=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,YK=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,XK=Om(nJ),KK=Om(rJ),JK=[0,0,0,1],eJ=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function tJ(t,e){const[n,r,i]=t,s=ES([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function nJ({viewport:t,center:e}){return new ha(t.viewProjectionMatrix).invert().transform(e)}function rJ({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(l=>tJ(l,r));for(const l of e){const o=l.clone().translate(new An(t.center).negate()),p=s.map(C=>o.transform(C)),_=new ha().ortho({left:Math.min(...p.map(C=>C[0])),right:Math.max(...p.map(C=>C[0])),bottom:Math.min(...p.map(C=>C[1])),top:Math.max(...p.map(C=>C[1])),near:Math.min(...p.map(C=>-C[2])),far:Math.max(...p.map(C=>-C[2]))});n.push(_.multiplyRight(l))}return n}function iJ(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||JK,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=XK({viewport:t.viewport,center:e.project_uCenter}),s=[],l=KK({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let o=0;o<t.shadowMatrices.length;o++){const p=l[o],_=p.clone().translate(new An(t.viewport.center).negate());e.project_uCoordinateSystem===fr.LNGLAT&&e.project_uProjectionMode===iA.WEB_MERCATOR?(l[o]=_,s[o]=i):(l[o]=p.clone().multiplyRight(eJ),s[o]=_.transform(i))}for(let o=0;o<l.length;o++)r["shadow_uViewProjectionMatrices[".concat(o,"]")]=l[o],r["shadow_uProjectCenters[".concat(o,"]")]=s[o],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(o)]=t.shadowMaps[o]:r["shadow_uShadowMap".concat(o)]=t.dummyShadowMap;return r}const Lw={name:"shadow",dependencies:[wS],vs:ZK,fs:YK,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?iJ(t,e):{}},sJ={color:[255,255,255],intensity:1},lk=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],oJ=[0,0,0,200/255];class TS{constructor(e={}){oe(this,"id","lighting-effect"),oe(this,"props",void 0),oe(this,"shadowColor",oJ),oe(this,"shadow",void 0),oe(this,"ambientLight",void 0),oe(this,"directionalLights",void 0),oe(this,"pointLights",void 0),oe(this,"shadowPasses",[]),oe(this,"shadowMaps",[]),oe(this,"dummyShadowMap",null),oe(this,"programManager",void 0),oe(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:l}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=zm.getDefaultProgramManager(e),Lw&&this.programManager.addDefaultModule(Lw)),this.dummyShadowMap||(this.dummyShadowMap=new da(e,{width:1,height:1}));for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:l,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Lw),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new ha().lookAt({eye:new An(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new yK(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new XB(sJ),this.directionalLights.push(new $3(lk[0]),new $3(lk[1])))}}class aJ{constructor(e={}){oe(this,"_pool",[]),oe(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:l=!1,initialize:o=!1,maxCount:p}){const _=i||e&&e.constructor||Float32Array,C=n*r+s;if(ArrayBuffer.isView(e)){if(C<=e.length)return e;if(C*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new _(e.buffer,0,C)}let M=1/0;p&&(M=p*r+s);const k=this._allocate(_,C,o,M);return e&&l?k.set(e):o||k.fill(0,0,4),this._release(e),k}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const l=this._pool,o=e.BYTES_PER_ELEMENT*s,p=l.findIndex(_=>_.byteLength>=o);if(p>=0){const _=new e(l.splice(p,1)[0],0,s);return r&&_.fill(0),_}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(l=>l.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const Td=new aJ;function ng(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function lJ(t){return[t[12],t[13],t[14]]}function AJ(t){return{left:g0(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:g0(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:g0(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:g0(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:g0(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:g0(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const Ak=new An;function g0(t,e,n,r){Ak.set(t,e,n);const i=Ak.len();return{distance:r/i,normal:new An(-t/i,-e/i,-n/i)}}function uJ(t){return t-Math.fround(t)}let Rp;function Dw(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Rp=Td.allocate(Rp,s,{type:Float32Array,size:n*2});let l=r,o=0;for(;l<i;){for(let p=0;p<n;p++){const _=t[l++];Rp[o+p]=_,Rp[o+p+n]=uJ(_)}o+=n*2}return Rp.subarray(0,s*n*2)}function cJ(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const hJ=Math.PI/180,fJ=ng(),uk=[0,0,0],dJ={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function pJ({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:l,far:o}){const p=t/e,_=n?new ha().orthographic({fovy:r,aspect:p,focalDistance:i,near:l,far:o}):new ha().perspective({fovy:r,aspect:p,near:l,far:o});if(s){const{left:C=0,right:M=0,top:k=0,bottom:F=0}=s,j=nh((C+t-M)/2,0,t)-t/2,H=nh((k+e-F)/2,0,e)-e/2;_[8]-=j*2/t,_[9]+=H*2/e}return _}class Uf{constructor(e={}){oe(this,"id",void 0),oe(this,"x",void 0),oe(this,"y",void 0),oe(this,"width",void 0),oe(this,"height",void 0),oe(this,"padding",void 0),oe(this,"isGeospatial",void 0),oe(this,"zoom",void 0),oe(this,"focalDistance",void 0),oe(this,"position",void 0),oe(this,"modelMatrix",void 0),oe(this,"distanceScales",void 0),oe(this,"scale",void 0),oe(this,"center",void 0),oe(this,"cameraPosition",void 0),oe(this,"projectionMatrix",void 0),oe(this,"viewMatrix",void 0),oe(this,"viewMatrixUncentered",void 0),oe(this,"viewMatrixInverse",void 0),oe(this,"viewProjectionMatrix",void 0),oe(this,"pixelProjectionMatrix",void 0),oe(this,"pixelUnprojectionMatrix",void 0),oe(this,"resolution",void 0),oe(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||dJ,this.focalDistance=e.focalDistance||1,this.position=e.position||uk,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?iA.WEB_MERCATOR:iA.WEB_MERCATOR_AUTO_OFFSET:iA.IDENTITY}equals(e){return e instanceof Uf?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Ju(e.projectionMatrix,this.projectionMatrix)&&Ju(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=az(r,this.pixelProjectionMatrix),[s,l]=i,o=n?l:this.height-l;return e.length===2?[s,o]:[s,o,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,l]=e,o=n?s:this.height-s,p=r&&r*this.distanceScales.unitsPerMeter[2],_=ES([i,o,l],this.pixelUnprojectionMatrix,p),[C,M,k]=this.unprojectPosition(_);return Number.isFinite(l)?[C,M,k]:Number.isFinite(r)?[C,M,r]:[C,M]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=gA(e);return n[1]=nh(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?vf(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),l=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],l[0]),Math.min(r[1],i[1],s[1],l[1]),Math.max(r[0],i[0],s[0],l[0]),Math.max(r[1],i[1],s[1],l[1])]}getDistanceScales(e){return e?W3({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,AJ(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=NK({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||W3({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:l}=e;let o=uk;if(s&&(o=l?new ha(l).transformAsVector(s,[]):s),this.isGeospatial){const p=this.projectPosition([n,r,0]);this.center=new An(o).scale(this.distanceScales.unitsPerMeter).add(p)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:n=fJ,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:l=75,near:o=.1,far:p=1e3,padding:_=null,focalDistance:C=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new ha().multiplyRight(n).translate(new An(this.center).negate()),this.projectionMatrix=r||pJ({width:this.width,height:this.height,orthographic:i,fovyRadians:s||l*hJ,focalDistance:C,padding:_,near:o,far:p});const M=ng();Af(M,M,this.projectionMatrix),Af(M,M,this.viewMatrix),this.viewProjectionMatrix=M,this.viewMatrixInverse=V3([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=lJ(this.viewMatrixInverse);const k=ng(),F=ng();yS(k,k,[this.width/2,-this.height/2,1]),Q_(k,k,[1,-1,0]),Af(F,k,this.viewProjectionMatrix),this.pixelProjectionMatrix=F,this.pixelUnprojectionMatrix=V3(ng(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||or.warn("Pixel project matrix not invertible")()}}oe(Uf,"displayName","Viewport");class cc extends Uf{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:l=0,nearZMultiplier:o=.1,farZMultiplier:p=1.01,nearZ:_,farZ:C,orthographic:M=!1,projectionMatrix:k,repeat:F=!1,worldOffset:j=0,position:H,padding:ie,legacyMeterSizes:Y=!1}=e;let{width:J,height:se,altitude:he=1.5}=e;const pe=Math.pow(2,i);J=J||1,se=se||1;let be,Ge=null;if(k)he=k[5]/2,be=Y_(he);else{e.fovy?(be=e.fovy,he=oz(be)):be=Y_(he);let Xe;if(ie){const{top:rt=0,bottom:Oe=0}=ie;Xe=[0,nh((rt+se-Oe)/2,0,se)-se/2]}Ge=VK({width:J,height:se,scale:pe,center:H&&[0,0,H[2]*Hy(n)],offset:Xe,pitch:s,fovy:be,nearZMultiplier:o,farZMultiplier:p}),Number.isFinite(_)&&(Ge.near=_),Number.isFinite(C)&&(Ge.far=C)}let We=UK({height:se,pitch:s,bearing:l,scale:pe,altitude:he});j&&(We=new ha().translate([512*j,0,0]).multiplyLeft(We)),super({...e,width:J,height:se,viewMatrix:We,longitude:r,latitude:n,zoom:i,...Ge,fovy:be,focalDistance:he}),oe(this,"longitude",void 0),oe(this,"latitude",void 0),oe(this,"pitch",void 0),oe(this,"bearing",void 0),oe(this,"altitude",void 0),oe(this,"fovy",void 0),oe(this,"orthographic",void 0),oe(this,"_subViewports",void 0),oe(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=l,this.altitude=he,this.fovy=be,this.orthographic=M,this._subViewports=F?[]:null,this._pseudoMeters=Y,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new cc({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Hy(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Hy(r);return[n,r,i]}addMetersToLngLat(e,n){return sz(e,n)}panByPosition(e,n){const r=ES(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=N3([],i,AY([],r)),l=N3([],this.center,s),[o,p]=this.unprojectFlat(l);return{longitude:o,latitude:p}}getBounds(e={}){const n=jK(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:l,zoom:o}=GK({width:r,height:i,bounds:e,...n});return new cc({width:r,height:i,longitude:s,latitude:l,zoom:o})}}oe(cc,"displayName","WebMercatorViewport");const ck=[0,0,0];function Rw(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof cc){const[i,s,l=0]=t,o=e.getDistanceScales([i,s]);r[2]=l*o.unitsPerMeter[2]}return r}function gJ(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:l}=t;return i===fr.DEFAULT&&(i=e.isGeospatial?fr.LNGLAT:fr.CARTESIAN),s===void 0&&(s=i),l===void 0&&(l=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:l}}function cz(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[l,o,p=0]=t;switch(n&&([l,o,p]=Hd([],[l,o,p,1],n)),r){case fr.LNGLAT:return Rw([l,o,p],e,s);case fr.LNGLAT_OFFSETS:return Rw([l+i[0],o+i[1],p+(i[2]||0)],e,s);case fr.METER_OFFSETS:return Rw(sz(i,[l,o,p]),e,s);case fr.CARTESIAN:default:return e.isGeospatial?[l+i[0],o+i[1],p+i[2]]:e.projectPosition([l,o,p])}}function mJ(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:l,fromCoordinateOrigin:o}=gJ(e),{autoOffset:p=!0}=e,{geospatialOrigin:_=ck,shaderCoordinateOrigin:C=ck,offsetMode:M=!1}=p?nz(n,r,i):{},k=cz(t,{viewport:n,modelMatrix:s,coordinateSystem:l,coordinateOrigin:o,offsetMode:M});if(M){const F=n.projectPosition(_||C);OB(k,k,F)}return k}const xf=Math.PI/180,yJ=1e3*60*60*24,_J=2440588,vJ=2451545,X_=xf*23.4397,xJ=357.5291,wJ=.98560028,bJ=280.147,EJ=360.9856235;function TJ(t,e,n){const r=xf*-n,i=xf*e,s=CJ(t),l=BJ(s),o=LJ(s,r)-l.rightAscension;return{azimuth:kJ(o,i,l.declination),altitude:IJ(o,i,l.declination)}}function hk(t,e,n){const{azimuth:r,altitude:i}=TJ(t,e,n);return[Math.sin(r)*Math.cos(i),Math.cos(r)*Math.cos(i),-Math.sin(i)]}function SJ(t){return(typeof t=="number"?t:t.getTime())/yJ-.5+_J}function CJ(t){return SJ(t)-vJ}function MJ(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(X_)-Math.tan(e)*Math.sin(X_),Math.cos(n))}function PJ(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(X_)+Math.cos(e)*Math.sin(X_)*Math.sin(n))}function kJ(t,e,n){const r=t,i=e,s=n;return Math.atan2(Math.sin(r),Math.cos(r)*Math.sin(i)-Math.tan(s)*Math.cos(i))}function IJ(t,e,n){const r=t,i=e,s=n;return Math.asin(Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos(r))}function LJ(t,e){return xf*(bJ+EJ*t)-e}function DJ(t){return xf*(xJ+wJ*t)}function RJ(t){const e=t,n=xf*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e)),r=xf*102.9372;return e+n+r+Math.PI}function BJ(t){const e=DJ(t),n=RJ(e);return{declination:PJ(n,0),rightAscension:MJ(n,0)}}class zJ extends $3{constructor(e){super(e),oe(this,"timestamp",void 0),this.timestamp=e.timestamp}getProjectedLight({layer:e}){const{viewport:n}=e.context;if(n.resolution&&n.resolution>0){const[i,s,l]=hk(this.timestamp,0,0);this.direction=[i,-l,s]}else{const{latitude:i,longitude:s}=n;this.direction=hk(this.timestamp,i,s)}return this}}const fk={blendFunc:[1,0,32771,0],blendEquation:32774};class hz extends xS{constructor(...e){super(...e),oe(this,"pickZ",void 0),oe(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:l,deviceRect:{x:o,y:p,width:_,height:C},cullRect:M,effects:k,pass:F="picking",pickZ:j,moduleParameters:H}){const ie=this.gl;this.pickZ=j;const Y=this._resetColorEncoder(j),J=fA(ie,{scissorTest:!0,scissor:[o,p,_,C],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...fk,blend:!j},()=>super.render({target:l,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:M,effects:k?.filter(he=>he.useInPicking),pass:F,isPicking:!0,moduleParameters:H}));return this._colorEncoderState=null,{decodePickingColor:Y&&FJ.bind(null,Y),stats:J}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:l}=e.props;return this._colorEncoderState?s&&l.includes("draw")&&(Object.assign(i,fk),i.blend=!0,i.blendColor=OJ(this._colorEncoderState,e,r)):i.blend=!1,l.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function OJ(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,l=r.get(e);return l?(l.viewports.push(n),s=l.a):(s=r.size+1,s<=255?(l={a:s,layer:e,viewports:[n]},r.set(e,l),i[s]=l):(or.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function FJ(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const w0={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},K_=Symbol.for("component"),gh=Symbol.for("propTypes"),Bw=Symbol.for("deprecatedProps"),id=Symbol.for("asyncPropDefaults"),wf=Symbol.for("asyncPropOriginal"),rh=Symbol.for("asyncPropResolved");function bf(t,e=()=>!0){return Array.isArray(t)?fz(t,e,[]):e(t)?[t]:[]}function fz(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?fz(i,e,n):e(i)&&n.push(i)}return n}function NJ({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let l=0;for(let o=n;l<i;l++)t[o++]=e[l];for(;l<s;)l<s-l?(t.copyWithin(n+l,n,n+l),l*=2):(t.copyWithin(n+l,n,n+s-l),l=s);return t}function dk(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class pk{constructor(e,n){oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"sampleSize",1),oe(this,"time",void 0),oe(this,"count",void 0),oe(this,"samples",void 0),oe(this,"lastTiming",void 0),oe(this,"lastSampleTime",void 0),oe(this,"lastSampleCount",void 0),oe(this,"_count",0),oe(this,"_time",0),oe(this,"_samples",0),oe(this,"_startTime",0),oe(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=dk(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(dk()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class dz{constructor(e){oe(this,"id",void 0),oe(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof pk?this.stats[n]=e:this.stats[n]=new pk(n,r)),this.stats[n]}}class UJ{constructor(e,n,r){oe(this,"id",void 0),oe(this,"context",void 0),oe(this,"isLoaded",void 0),oe(this,"persistent",void 0),oe(this,"_loadCount",0),oe(this,"_subscribers",new Set),oe(this,"_data",void 0),oe(this,"_loader",void 0),oe(this,"_error",void 0),oe(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=U_(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class VJ{constructor({gl:e,protocol:n}){oe(this,"protocol",void 0),oe(this,"_context",void 0),oe(this,"_resources",void 0),oe(this,"_consumers",void 0),oe(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new UJ(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:l}=this;e.startsWith(l)&&(e=e.replace(l,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const o=s[e];if(this._track(r,i,o,n),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,l=s[e]=s[e]||{},o=l[n]||{},p=o.resourceId&&this._resources[o.resourceId];p&&(p.unsubscribe(o),this.prune()),r&&(l[n]=o,o.onChange=i,o.resourceId=r.id,r.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const GJ=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Vf={name:"project32",dependencies:[wS],vs:GJ},Gf={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...DX},$J=[wS],jJ=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function HJ(t){const e=zm.getDefaultProgramManager(t);for(const n of $J)e.addDefaultModule(n);for(const n of jJ)e.addShaderHook(n);return e}const WJ="layerManager.setLayers",QJ="layerManager.activateViewport";class qJ{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){oe(this,"layers",void 0),oe(this,"context",void 0),oe(this,"resourceManager",void 0),oe(this,"_lastRenderedLayers",[]),oe(this,"_needsRedraw",!1),oe(this,"_needsUpdate",!1),oe(this,"_nextLayers",null),oe(this,"_debug",!1),oe(this,"activateViewport",l=>{co(QJ,this,l),l&&(this.context.viewport=l)}),this.layers=[],this.resourceManager=new VJ({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&HJ(e),stats:r||new dz({id:"deck.gl"}),viewport:i||new Uf({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new YB,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){co(WJ,this,n,e),this._lastRenderedLayers=e;const r=bf(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const l of e)r[l.id]?or.warn("Multiple old layers with same id ".concat(l.id))():r[l.id]=l;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const l of i)if(l.hasUniformTransition()){s="Uniform transition in ".concat(l);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&or.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let l=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),l=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}l&&this._updateSublayersRecursively(l,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=w0.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=w0.MATCHED,n!==e&&(e.lifecycle=w0.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=w0.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=w0.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function oA(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!oA(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!oA(t[s],e[s],n-1))return!1;return!0}return!1}class ZJ{constructor(e){oe(this,"width",void 0),oe(this,"height",void 0),oe(this,"views",void 0),oe(this,"viewState",void 0),oe(this,"controllers",void 0),oe(this,"timeline",void 0),oe(this,"_viewports",void 0),oe(this,"_viewportMap",void 0),oe(this,"_isUpdating",void 0),oe(this,"_needsRedraw",void 0),oe(this,"_needsUpdate",void 0),oe(this,"_eventManager",void 0),oe(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const l=r[s];if(l.containsPixel(i)){const o=e.slice();return o[0]-=l.x,o[1]-=l.y,l.unproject(o,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=bf(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!oA(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):or.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var l;return(l=this.getView(e.id))===null||l===void 0?void 0:l.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const l={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,l)),i&&i.setProps(l),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],l=this.getViewState(s),o=s.makeViewport({viewState:l,width:this.width,height:this.height});let p=n[s.id];const _=!!s.controller;_&&!p&&(r=!0),(r||!_)&&p&&(p.finalize(),p=null),this.controllers[s.id]=this._updateController(s,l,o,p),o&&this._viewports.unshift(o)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const YJ=/([0-9]+\.?[0-9]*)(%|px)/;function Vc(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=YJ.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Gc(t,e){return t.relative?Math.round(t.position*e):t.position}function Ui(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class El{constructor(e){oe(this,"id",void 0),oe(this,"viewportInstance",void 0),oe(this,"_x",void 0),oe(this,"_y",void 0),oe(this,"_width",void 0),oe(this,"_height",void 0),oe(this,"_padding",void 0),oe(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:l="100%",padding:o=null,viewportInstance:p}=e||{};Ui(!p||p instanceof Uf),this.viewportInstance=p,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Vc(r),this._y=Vc(i),this._width=Vc(s),this._height=Vc(l),this._padding=o&&{left:Vc(o.left||0),right:Vc(o.right||0),top:Vc(o.top||0),bottom:Vc(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&oA(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Gc(this._x,e),y:Gc(this._y,n),width:Gc(this._width,e),height:Gc(this._height,n)};return this._padding&&(r.padding={left:Gc(this._padding.left,e),top:Gc(this._padding.top,n),right:Gc(this._padding.right,e),bottom:Gc(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let Fm=class{constructor(e){oe(this,"_inProgress",void 0),oe(this,"_handle",void 0),oe(this,"_timeline",void 0),oe(this,"time",void 0),oe(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const gk=()=>{},Q3={BREAK:1,SNAP_TO_END:2,IGNORE:3},XJ=t=>t,KJ=Q3.BREAK;class JJ{constructor(e){oe(this,"getControllerState",void 0),oe(this,"props",void 0),oe(this,"propsInTransition",void 0),oe(this,"transition",void 0),oe(this,"onViewStateChange",void 0),oe(this,"onStateChange",void 0),oe(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:l,duration:o,easing:p}}=n,_=p(r/o),C=i.interpolateProps(s,l,_);this.propsInTransition=this.getControllerState({...this.props,...C}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Fm(e.timeline),this.onViewStateChange=e.onViewStateChange||gk,this.onStateChange=e.onStateChange||gk}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:l}=this.transition.settings;i={...r,...s===Q3.SNAP_TO_END?l:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Q3.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,l=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(l===0)return;const o=s.initializeProps(e,i);this.propsInTransition={};const p={duration:l,easing:n.transitionEasing||XJ,interpolator:s,interruption:n.transitionInterruption||KJ,startProps:o.start,endProps:o.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(p),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(n)}}}class pz{constructor(e){oe(this,"_propsToCompare",void 0),oe(this,"_propsToExtract",void 0),oe(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Ju(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Ui(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const eee=["longitude","latitude","zoom","bearing","pitch"],tee=["longitude","latitude","zoom"];class gz extends pz{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:eee,required:tee},super(r.transitionProps),oe(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const l=i(e),o=i(n),p=l.unproject(s);r.start.around=s,Object.assign(r.end,{around:o.project(p),aroundPosition:p,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=wl(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,wl(e.around,n.around,r)))}return i}}const $c={transitionDuration:0},nee=300,ey=t=>1-(1-t)*(1-t),m0={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},$h={};class ree{constructor(e){oe(this,"props",void 0),oe(this,"state",{}),oe(this,"transitionManager",void 0),oe(this,"eventManager",void 0),oe(this,"onViewStateChange",void 0),oe(this,"onStateChange",void 0),oe(this,"makeViewport",void 0),oe(this,"_controllerState",void 0),oe(this,"_events",{}),oe(this,"_interactionState",{isDragging:!1}),oe(this,"_customEvents",[]),oe(this,"_eventStartBlocked",null),oe(this,"_panMove",!1),oe(this,"invertPan",!1),oe(this,"dragMode","rotate"),oe(this,"inertia",0),oe(this,"scrollZoom",!0),oe(this,"dragPan",!0),oe(this,"dragRotate",!0),oe(this,"doubleClickZoom",!0),oe(this,"touchZoom",!0),oe(this,"touchRotate",!1),oe(this,"keyboard",!0),this.transitionManager=new JJ({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?nee:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:l=!0,touchZoom:o=!0,touchRotate:p=!1,keyboard:_=!0}=e,C=!!this.onViewStateChange;this.toggleEvents(m0.WHEEL,C&&r),this.toggleEvents(m0.PAN,C),this.toggleEvents(m0.PINCH,C&&(o||p)),this.toggleEvents(m0.TRIPLE_PAN,C&&p),this.toggleEvents(m0.DOUBLE_TAP,C&&l),this.toggleEvents(m0.KEYBOARD,C&&_),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=l,this.touchZoom=o,this.touchRotate=p,this.keyboard=_}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const l=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:l})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,$c,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,$c,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ey},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,$c,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ey},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let l=2/(1+Math.exp(-Math.abs(s*r)));s<0&&l!==0&&(l=1/l);const o=this.controllerState.zoom({pos:n,scale:l});return this.updateViewport(o,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,$c,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,$c,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ey},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return $h._startPinchRotation=e.rotation,$h._lastPinchEvent=e,this.updateViewport(r,$c,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:$h._startPinchRotation-r})}return this.updateViewport(n,$c,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),$h._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=$h;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const l=Math.log2(e.scale),o=(l-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),p=Math.pow(2,l+o*n/2);s=s.zoom({pos:i,scale:p}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:ey},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return $h._startPinchRotation=null,$h._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:l}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let p;const _={};switch(e.srcEvent.code){case"Minus":p=n?o.zoomOut(r).zoomOut(r):o.zoomOut(r),_.isZooming=!0;break;case"Equal":p=n?o.zoomIn(r).zoomIn(r):o.zoomIn(r),_.isZooming=!0;break;case"ArrowLeft":n?(p=o.rotateLeft(s),_.isRotating=!0):(p=o.moveLeft(i),_.isPanning=!0);break;case"ArrowRight":n?(p=o.rotateRight(s),_.isRotating=!0):(p=o.moveRight(i),_.isPanning=!0);break;case"ArrowUp":n?(p=o.rotateUp(l),_.isRotating=!0):(p=o.moveUp(i),_.isPanning=!0);break;case"ArrowDown":n?(p=o.rotateDown(l),_.isRotating=!0):(p=o.moveDown(i),_.isPanning=!0);break;default:return!1}return this.updateViewport(p,this._getTransitionProps(),_),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?$c:e?{...n,transitionInterpolator:new gz({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class iee{constructor(e,n){oe(this,"_viewportProps",void 0),oe(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const mk=5,see=1.2;class oee extends iee{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:l,bearing:o=0,pitch:p=0,altitude:_=1.5,position:C=[0,0,0],maxZoom:M=20,minZoom:k=0,maxPitch:F=60,minPitch:j=0,startPanLngLat:H,startZoomLngLat:ie,startRotatePos:Y,startBearing:J,startPitch:se,startZoom:he,normalize:pe=!0}=e;Ui(Number.isFinite(s)),Ui(Number.isFinite(i)),Ui(Number.isFinite(l)),super({width:n,height:r,latitude:i,longitude:s,zoom:l,bearing:o,pitch:p,altitude:_,maxZoom:M,minZoom:k,maxPitch:F,minPitch:j,normalize:pe,position:C},{startPanLngLat:H,startZoomLngLat:ie,startRotatePos:Y,startBearing:J,startPitch:se,startZoom:he}),oe(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:l}=this.getState();if(!i||s===void 0||l===void 0)return this;let o;return e?o=this._getNewRotation(e,i,l,s):o={bearing:s+n,pitch:l+r},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:l,minZoom:o}=this.getViewportProps();let p=i+Math.log2(r);p=nh(p,o,l);const _=this.makeViewport({...this.getViewportProps(),zoom:p});return this._getUpdatedState({zoom:p,..._.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=nh(i,r,n);const{maxPitch:s,minPitch:l,pitch:o}=e;e.pitch=nh(o,l,s);const{normalize:p=!0}=e;return p&&Object.assign(e,HK(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],l=e[1]-n[1],o=e[1],p=n[1],{width:_,height:C}=this.getViewportProps(),M=s/_;let k=0;l>0?Math.abs(C-p)>mk&&(k=l/(p-C)*see):l<0&&p>mk&&(k=1-o/p),k=nh(k,-1,1);const{minPitch:F,maxPitch:j}=this.getViewportProps(),H=i+180*M;let ie=r;return k>0?ie=r+k*(j-r):k<0&&(ie=r-k*(F-r)),{pitch:ie,bearing:H}}}class aee extends ree{constructor(...e){super(...e),oe(this,"ControllerState",oee),oe(this,"transition",{transitionDuration:300,transitionInterpolator:new gz({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),oe(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class tc extends El{get ViewportType(){return cc}get ControllerType(){return aee}}oe(tc,"displayName","MapView");const lee=new TS;function Aee(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,s=(r=e.order)!==null&&r!==void 0?r:1/0;return i-s}class uee{constructor(){oe(this,"effects",void 0),oe(this,"_resolvedEffects",[]),oe(this,"_defaultEffects",[]),oe(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>Aee(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(oA(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),r.push(s)):(s.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof TS)||this._resolvedEffects.push(lee),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class cee extends xS{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const hee="deckRenderer.renderLayers";class fee{constructor(e){oe(this,"gl",void 0),oe(this,"layerFilter",void 0),oe(this,"drawPickingColors",void 0),oe(this,"drawLayersPass",void 0),oe(this,"pickLayersPass",void 0),oe(this,"renderCount",void 0),oe(this,"_needsRedraw",void 0),oe(this,"renderBuffers",void 0),oe(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new cee(e),this.pickLayersPass=new hz(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||os.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,co(hee,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new os(this.gl),new os(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const l=s.postRender(this.gl,i);i.inputBuffer=l,i.swapBuffer=l===r[0]?r[1]:r[0]}}}const dee={pickedColor:null,pickedObjectIndex:-1};function pee({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:l,y:o,width:p,height:_}=s;let C=i*i,M=-1,k=0;for(let F=0;F<_;F++){const j=F+o-r,H=j*j;if(H>C)k+=4*p;else for(let ie=0;ie<p;ie++){if(t[k+3]-1>=0){const J=ie+l-n,se=J*J+H;se<=C&&(C=se,M=k)}k+=4}}if(M>=0){const F=t.slice(M,M+4),j=e(F);if(j){const H=Math.floor(M/4/p),ie=M/4-H*p;return{...j,pickedColor:F,pickedX:l+ie,pickedY:o+H}}or.error("Picked non-existent layer. Is picking buffer corrupt?")()}return dee}function gee({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),l=s.join(",");if(!n.has(l)){const o=e(s);o?n.set(l,{...o,color:s}):or.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function mz({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let l=e[0];e.length>1&&(l=yee(t?.pickedViewports||e,{x:r,y:i}));let o;if(l){const p=[r-l.x,i-l.y];s!==void 0&&(p[2]=s),o=l.unproject(p)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:o,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function mee(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:l,pickedObjectIndex:o}=e,p=l?[l]:[];if(r==="hover"){const M=n.index,k=n.layerId,F=l?l.props.id:null;if(F!==k||o!==M){if(F!==k){const j=i.find(H=>H.props.id===k);j&&p.unshift(j)}n.layerId=F,n.index=o,n.info=null}}const _=mz(t),C=new Map;return C.set(null,_),p.forEach(M=>{let k={..._};M===l&&(k.color=s,k.index=o,k.picked=!0),k=yz({layer:M,info:k,mode:r});const F=k.layer;M===l&&r==="hover"&&(n.info=k),C.set(F.id,k),r==="hover"&&F.updateAutoHighlight(k)}),C}function yz({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function yee(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class _ee{constructor(e){oe(this,"gl",void 0),oe(this,"pickingFBO",void 0),oe(this,"depthFBO",void 0),oe(this,"pickLayersPass",void 0),oe(this,"layerFilter",void 0),oe(this,"lastPickedInfo",void 0),oe(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new hz(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const l=s&&s.layer&&s.layer.id,o=s&&s.viewport&&s.viewport.id,p=l?r.find(k=>k.id===l):null,_=o&&i.find(k=>k.id===o)||i[0],C=_&&_.unproject([e-_.x,n-_.y]);return{...s,...{x:e,y:n,viewport:_,coordinate:C,layer:p}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new os(r),os.isSupported(r,{colorBufferFloat:!0}))){const i=new os(r);i.attach({36064:new da(r,{format:dr(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:l=0,depth:o=1,mode:p="query",unproject3D:_,onViewportActive:C,effects:M}){const k=this._getPickable(e),F=xd(this.gl);if(!k)return{result:[],emptyInfo:mz({viewports:r,x:i,y:s,pixelRatio:F})};this._resizeBuffer();const j=mw(this.gl,[i,s],!0),H=[j.x+Math.floor(j.width/2),j.y+Math.floor(j.height/2)],ie=Math.round(l*F),{width:Y,height:J}=this.pickingFBO,se=this._getPickingRect({deviceX:H[0],deviceY:H[1],deviceRadius:ie,deviceWidth:Y,deviceHeight:J}),he={x:i-l,y:s-l,width:l*2+1,height:l*2+1};let pe;const be=[],Ge=new Set;for(let We=0;We<o;We++){let Xe;if(se){const Oe=this._drawAndSample({layers:k,views:n,viewports:r,onViewportActive:C,deviceRect:se,cullRect:he,effects:M,pass:"picking:".concat(p)});Xe=pee({...Oe,deviceX:H[0],deviceY:H[1],deviceRadius:ie,deviceRect:se})}else Xe={pickedColor:null,pickedObjectIndex:-1};let rt;if(Xe.pickedLayer&&_&&this.depthFBO){const{pickedColors:Oe}=this._drawAndSample({layers:[Xe.pickedLayer],views:n,viewports:r,onViewportActive:C,deviceRect:{x:Xe.pickedX,y:Xe.pickedY,width:1,height:1},cullRect:he,effects:M,pass:"picking:".concat(p,":z")},!0);Oe[3]&&(rt=Oe[0])}Xe.pickedLayer&&We+1<o&&(Ge.add(Xe.pickedLayer),Xe.pickedLayer.disablePickingIndex(Xe.pickedObjectIndex)),pe=mee({pickInfo:Xe,lastPickedInfo:this.lastPickedInfo,mode:p,layers:k,viewports:r,x:i,y:s,z:rt,pixelRatio:F});for(const Oe of pe.values())Oe.layer&&be.push(Oe);if(!Xe.pickedColor)break}for(const We of Ge)We.restorePickingColors();return{result:be,emptyInfo:pe.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:l=1,height:o=1,mode:p="query",maxObjects:_=null,onViewportActive:C,effects:M}){const k=this._getPickable(e);if(!k)return[];this._resizeBuffer();const F=xd(this.gl),j=mw(this.gl,[i,s],!0),H=j.x,ie=j.y+j.height,Y=mw(this.gl,[i+l,s+o],!0),J=Y.x+Y.width,se=Y.y,he={x:H,y:se,width:J-H,height:ie-se},pe=this._drawAndSample({layers:k,views:n,viewports:r,onViewportActive:C,deviceRect:he,cullRect:{x:i,y:s,width:l,height:o},effects:M,pass:"picking:".concat(p)}),be=gee(pe),Ge=new Map,We=Number.isFinite(_);for(let Xe=0;Xe<be.length&&!(We&&_&&Ge.size>=_);Xe++){const rt=be[Xe];let Oe={color:rt.pickedColor,layer:null,index:rt.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:F};Oe=yz({layer:rt.pickedLayer,info:Oe,mode:p}),Ge.has(Oe.object)||Ge.set(Oe.object,Oe)}return Array.from(Ge.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:l,effects:o,pass:p},_=!1){const C=_?this.depthFBO:this.pickingFBO,M={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:C,deviceRect:s,cullRect:l,effects:o,pass:p,pickZ:_,preRenderStats:{}};for(const J of o)J.useInPicking&&(M.preRenderStats[J.id]=J.preRender(this.gl,M));const{decodePickingColor:k}=this.pickLayersPass.render(M),{x:F,y:j,width:H,height:ie}=s,Y=new(_?Float32Array:Uint8Array)(H*ie*4);return mv(C,{sourceX:F,sourceY:j,sourceWidth:H,sourceHeight:ie,target:Y}),{pickedColors:Y,decodePickingColor:k}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const l=Math.max(0,e-r),o=Math.max(0,n-r),p=Math.min(i,e+r+1)-l,_=Math.min(s,n+r+1)-o;return p<=0||_<=0?null:{x:l,y:o,width:p,height:_}}}const vee={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class xee{constructor(e){oe(this,"el",null),oe(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,vee),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var _z={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],l=n.createElement("div"),o="function",p=Math.round,_=Math.abs,C=Date.now;function M(me,Te,Ue){return setTimeout(se(me,Ue),Te)}function k(me,Te,Ue){return Array.isArray(me)?(F(me,Ue[Te],Ue),!0):!1}function F(me,Te,Ue){var lt;if(me)if(me.forEach)me.forEach(Te,Ue);else if(me.length!==i)for(lt=0;lt<me.length;)Te.call(Ue,me[lt],lt,me),lt++;else for(lt in me)me.hasOwnProperty(lt)&&Te.call(Ue,me[lt],lt,me)}function j(me,Te,Ue){var lt="DEPRECATED METHOD: "+Te+`
`+Ue+` AT 
`;return function(){var bt=new Error("get-stack-trace"),Qt=bt&&bt.stack?bt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Dn=e.console&&(e.console.warn||e.console.log);return Dn&&Dn.call(e.console,lt,Qt),me.apply(this,arguments)}}var H;typeof Object.assign!="function"?H=function(Te){if(Te===i||Te===null)throw new TypeError("Cannot convert undefined or null to object");for(var Ue=Object(Te),lt=1;lt<arguments.length;lt++){var bt=arguments[lt];if(bt!==i&&bt!==null)for(var Qt in bt)bt.hasOwnProperty(Qt)&&(Ue[Qt]=bt[Qt])}return Ue}:H=Object.assign;var ie=j(function(Te,Ue,lt){for(var bt=Object.keys(Ue),Qt=0;Qt<bt.length;)(!lt||lt&&Te[bt[Qt]]===i)&&(Te[bt[Qt]]=Ue[bt[Qt]]),Qt++;return Te},"extend","Use `assign`."),Y=j(function(Te,Ue){return ie(Te,Ue,!0)},"merge","Use `assign`.");function J(me,Te,Ue){var lt=Te.prototype,bt;bt=me.prototype=Object.create(lt),bt.constructor=me,bt._super=lt,Ue&&H(bt,Ue)}function se(me,Te){return function(){return me.apply(Te,arguments)}}function he(me,Te){return typeof me==o?me.apply(Te&&Te[0]||i,Te):me}function pe(me,Te){return me===i?Te:me}function be(me,Te,Ue){F(rt(Te),function(lt){me.addEventListener(lt,Ue,!1)})}function Ge(me,Te,Ue){F(rt(Te),function(lt){me.removeEventListener(lt,Ue,!1)})}function We(me,Te){for(;me;){if(me==Te)return!0;me=me.parentNode}return!1}function Xe(me,Te){return me.indexOf(Te)>-1}function rt(me){return me.trim().split(/\s+/g)}function Oe(me,Te,Ue){if(me.indexOf&&!Ue)return me.indexOf(Te);for(var lt=0;lt<me.length;){if(Ue&&me[lt][Ue]==Te||!Ue&&me[lt]===Te)return lt;lt++}return-1}function nt(me){return Array.prototype.slice.call(me,0)}function Ze(me,Te,Ue){for(var lt=[],bt=[],Qt=0;Qt<me.length;){var Dn=Te?me[Qt][Te]:me[Qt];Oe(bt,Dn)<0&&lt.push(me[Qt]),bt[Qt]=Dn,Qt++}return Ue&&(Te?lt=lt.sort(function(en,Br){return en[Te]>Br[Te]}):lt=lt.sort()),lt}function pt(me,Te){for(var Ue,lt,bt=Te[0].toUpperCase()+Te.slice(1),Qt=0;Qt<s.length;){if(Ue=s[Qt],lt=Ue?Ue+bt:Te,lt in me)return lt;Qt++}return i}var Yt=1;function Et(){return Yt++}function un(me){var Te=me.ownerDocument||me;return Te.defaultView||Te.parentWindow||e}var _t=/mobile|tablet|ip(ad|hone|od)|android/i,Tt="ontouchstart"in e,Jt=pt(e,"PointerEvent")!==i,Ln=Tt&&_t.test(navigator.userAgent),Tn="touch",Ir="pen",tr="mouse",ar="kinect",pr=25,Gn=1,Mr=2,wt=4,rn=8,Pn=1,xt=2,nr=4,Qn=8,br=16,cr=xt|nr,rr=Qn|br,ni=cr|rr,$n=["x","y"],Ii=["clientX","clientY"];function qn(me,Te){var Ue=this;this.manager=me,this.callback=Te,this.element=me.element,this.target=me.options.inputTarget,this.domHandler=function(lt){he(me.options.enable,[me])&&Ue.handler(lt)},this.init()}qn.prototype={handler:function(){},init:function(){this.evEl&&be(this.element,this.evEl,this.domHandler),this.evTarget&&be(this.target,this.evTarget,this.domHandler),this.evWin&&be(un(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ge(this.element,this.evEl,this.domHandler),this.evTarget&&Ge(this.target,this.evTarget,this.domHandler),this.evWin&&Ge(un(this.element),this.evWin,this.domHandler)}};function Gi(me){var Te,Ue=me.options.inputClass;return Ue?Te=Ue:Jt?Te=Ke:Ln?Te=Hi:Tt?Te=K:Te=Sn,new Te(me,vo)}function vo(me,Te,Ue){var lt=Ue.pointers.length,bt=Ue.changedPointers.length,Qt=Te&Gn&&lt-bt===0,Dn=Te&(wt|rn)&&lt-bt===0;Ue.isFirst=!!Qt,Ue.isFinal=!!Dn,Qt&&(me.session={}),Ue.eventType=Te,$r(me,Ue),me.emit("hammer.input",Ue),me.recognize(Ue),me.session.prevInput=Ue}function $r(me,Te){var Ue=me.session,lt=Te.pointers,bt=lt.length;Ue.firstInput||(Ue.firstInput=As(Te)),bt>1&&!Ue.firstMultiple?Ue.firstMultiple=As(Te):bt===1&&(Ue.firstMultiple=!1);var Qt=Ue.firstInput,Dn=Ue.firstMultiple,Dr=Dn?Dn.center:Qt.center,en=Te.center=ht(lt);Te.timeStamp=C(),Te.deltaTime=Te.timeStamp-Qt.timeStamp,Te.angle=zn(Dr,en),Te.distance=Ei(Dr,en),Li(Ue,Te),Te.offsetDirection=Vs(Te.deltaX,Te.deltaY);var Br=It(Te.deltaTime,Te.deltaX,Te.deltaY);Te.overallVelocityX=Br.x,Te.overallVelocityY=Br.y,Te.overallVelocity=_(Br.x)>_(Br.y)?Br.x:Br.y,Te.scale=Dn?Di(Dn.pointers,lt):1,Te.rotation=Dn?$i(Dn.pointers,lt):0,Te.maxPointers=Ue.prevInput?Te.pointers.length>Ue.prevInput.maxPointers?Te.pointers.length:Ue.prevInput.maxPointers:Te.pointers.length,Ho(Ue,Te);var jn=me.element;We(Te.srcEvent.target,jn)&&(jn=Te.srcEvent.target),Te.target=jn}function Li(me,Te){var Ue=Te.center,lt=me.offsetDelta||{},bt=me.prevDelta||{},Qt=me.prevInput||{};(Te.eventType===Gn||Qt.eventType===wt)&&(bt=me.prevDelta={x:Qt.deltaX||0,y:Qt.deltaY||0},lt=me.offsetDelta={x:Ue.x,y:Ue.y}),Te.deltaX=bt.x+(Ue.x-lt.x),Te.deltaY=bt.y+(Ue.y-lt.y)}function Ho(me,Te){var Ue=me.lastInterval||Te,lt=Te.timeStamp-Ue.timeStamp,bt,Qt,Dn,Dr;if(Te.eventType!=rn&&(lt>pr||Ue.velocity===i)){var en=Te.deltaX-Ue.deltaX,Br=Te.deltaY-Ue.deltaY,jn=It(lt,en,Br);Qt=jn.x,Dn=jn.y,bt=_(jn.x)>_(jn.y)?jn.x:jn.y,Dr=Vs(en,Br),me.lastInterval=Te}else bt=Ue.velocity,Qt=Ue.velocityX,Dn=Ue.velocityY,Dr=Ue.direction;Te.velocity=bt,Te.velocityX=Qt,Te.velocityY=Dn,Te.direction=Dr}function As(me){for(var Te=[],Ue=0;Ue<me.pointers.length;)Te[Ue]={clientX:p(me.pointers[Ue].clientX),clientY:p(me.pointers[Ue].clientY)},Ue++;return{timeStamp:C(),pointers:Te,center:ht(Te),deltaX:me.deltaX,deltaY:me.deltaY}}function ht(me){var Te=me.length;if(Te===1)return{x:p(me[0].clientX),y:p(me[0].clientY)};for(var Ue=0,lt=0,bt=0;bt<Te;)Ue+=me[bt].clientX,lt+=me[bt].clientY,bt++;return{x:p(Ue/Te),y:p(lt/Te)}}function It(me,Te,Ue){return{x:Te/me||0,y:Ue/me||0}}function Vs(me,Te){return me===Te?Pn:_(me)>=_(Te)?me<0?xt:nr:Te<0?Qn:br}function Ei(me,Te,Ue){Ue||(Ue=$n);var lt=Te[Ue[0]]-me[Ue[0]],bt=Te[Ue[1]]-me[Ue[1]];return Math.sqrt(lt*lt+bt*bt)}function zn(me,Te,Ue){Ue||(Ue=$n);var lt=Te[Ue[0]]-me[Ue[0]],bt=Te[Ue[1]]-me[Ue[1]];return Math.atan2(bt,lt)*180/Math.PI}function $i(me,Te){return zn(Te[1],Te[0],Ii)+zn(me[1],me[0],Ii)}function Di(me,Te){return Ei(Te[0],Te[1],Ii)/Ei(me[0],me[1],Ii)}var Ri={mousedown:Gn,mousemove:Mr,mouseup:wt},us="mousedown",Lt="mousemove mouseup";function Sn(){this.evEl=us,this.evWin=Lt,this.pressed=!1,qn.apply(this,arguments)}J(Sn,qn,{handler:function(Te){var Ue=Ri[Te.type];Ue&Gn&&Te.button===0&&(this.pressed=!0),Ue&Mr&&Te.which!==1&&(Ue=wt),this.pressed&&(Ue&wt&&(this.pressed=!1),this.callback(this.manager,Ue,{pointers:[Te],changedPointers:[Te],pointerType:tr,srcEvent:Te}))}});var bn={pointerdown:Gn,pointermove:Mr,pointerup:wt,pointercancel:rn,pointerout:rn},Rr={2:Tn,3:Ir,4:tr,5:ar},Ss="pointerdown",yn="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Ss="MSPointerDown",yn="MSPointerMove MSPointerUp MSPointerCancel");function Ke(){this.evEl=Ss,this.evWin=yn,qn.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}J(Ke,qn,{handler:function(Te){var Ue=this.store,lt=!1,bt=Te.type.toLowerCase().replace("ms",""),Qt=bn[bt],Dn=Rr[Te.pointerType]||Te.pointerType,Dr=Dn==Tn,en=Oe(Ue,Te.pointerId,"pointerId");Qt&Gn&&(Te.button===0||Dr)?en<0&&(Ue.push(Te),en=Ue.length-1):Qt&(wt|rn)&&(lt=!0),!(en<0)&&(Ue[en]=Te,this.callback(this.manager,Qt,{pointers:Ue,changedPointers:[Te],pointerType:Dn,srcEvent:Te}),lt&&Ue.splice(en,1))}});var qr={touchstart:Gn,touchmove:Mr,touchend:wt,touchcancel:rn},Gs="touchstart",Fr="touchstart touchmove touchend touchcancel";function hi(){this.evTarget=Gs,this.evWin=Fr,this.started=!1,qn.apply(this,arguments)}J(hi,qn,{handler:function(Te){var Ue=qr[Te.type];if(Ue===Gn&&(this.started=!0),!!this.started){var lt=Xn.call(this,Te,Ue);Ue&(wt|rn)&&lt[0].length-lt[1].length===0&&(this.started=!1),this.callback(this.manager,Ue,{pointers:lt[0],changedPointers:lt[1],pointerType:Tn,srcEvent:Te})}}});function Xn(me,Te){var Ue=nt(me.touches),lt=nt(me.changedTouches);return Te&(wt|rn)&&(Ue=Ze(Ue.concat(lt),"identifier",!0)),[Ue,lt]}var $s={touchstart:Gn,touchmove:Mr,touchend:wt,touchcancel:rn},ji="touchstart touchmove touchend touchcancel";function Hi(){this.evTarget=ji,this.targetIds={},qn.apply(this,arguments)}J(Hi,qn,{handler:function(Te){var Ue=$s[Te.type],lt=Bi.call(this,Te,Ue);lt&&this.callback(this.manager,Ue,{pointers:lt[0],changedPointers:lt[1],pointerType:Tn,srcEvent:Te})}});function Bi(me,Te){var Ue=nt(me.touches),lt=this.targetIds;if(Te&(Gn|Mr)&&Ue.length===1)return lt[Ue[0].identifier]=!0,[Ue,Ue];var bt,Qt,Dn=nt(me.changedTouches),Dr=[],en=this.target;if(Qt=Ue.filter(function(Br){return We(Br.target,en)}),Te===Gn)for(bt=0;bt<Qt.length;)lt[Qt[bt].identifier]=!0,bt++;for(bt=0;bt<Dn.length;)lt[Dn[bt].identifier]&&Dr.push(Dn[bt]),Te&(wt|rn)&&delete lt[Dn[bt].identifier],bt++;if(Dr.length)return[Ze(Qt.concat(Dr),"identifier",!0),Dr]}var cs=2500,Nr=25;function K(){qn.apply(this,arguments);var me=se(this.handler,this);this.touch=new Hi(this.manager,me),this.mouse=new Sn(this.manager,me),this.primaryTouch=null,this.lastTouches=[]}J(K,qn,{handler:function(Te,Ue,lt){var bt=lt.pointerType==Tn,Qt=lt.pointerType==tr;if(!(Qt&&lt.sourceCapabilities&&lt.sourceCapabilities.firesTouchEvents)){if(bt)Q.call(this,Ue,lt);else if(Qt&&fe.call(this,lt))return;this.callback(Te,Ue,lt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Q(me,Te){me&Gn?(this.primaryTouch=Te.changedPointers[0].identifier,te.call(this,Te)):me&(wt|rn)&&te.call(this,Te)}function te(me){var Te=me.changedPointers[0];if(Te.identifier===this.primaryTouch){var Ue={x:Te.clientX,y:Te.clientY};this.lastTouches.push(Ue);var lt=this.lastTouches,bt=function(){var Qt=lt.indexOf(Ue);Qt>-1&&lt.splice(Qt,1)};setTimeout(bt,cs)}}function fe(me){for(var Te=me.srcEvent.clientX,Ue=me.srcEvent.clientY,lt=0;lt<this.lastTouches.length;lt++){var bt=this.lastTouches[lt],Qt=Math.abs(Te-bt.x),Dn=Math.abs(Ue-bt.y);if(Qt<=Nr&&Dn<=Nr)return!0}return!1}var a=pt(l.style,"touchAction"),G=a!==i,Le="compute",ke="auto",Pe="manipulation",Ie="none",qe="pan-x",At="pan-y",Qe=Rt();function dt(me,Te){this.manager=me,this.set(Te)}dt.prototype={set:function(me){me==Le&&(me=this.compute()),G&&this.manager.element.style&&Qe[me]&&(this.manager.element.style[a]=me),this.actions=me.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var me=[];return F(this.manager.recognizers,function(Te){he(Te.options.enable,[Te])&&(me=me.concat(Te.getTouchAction()))}),Dt(me.join(" "))},preventDefaults:function(me){var Te=me.srcEvent,Ue=me.offsetDirection;if(this.manager.session.prevented){Te.preventDefault();return}var lt=this.actions,bt=Xe(lt,Ie)&&!Qe[Ie],Qt=Xe(lt,At)&&!Qe[At],Dn=Xe(lt,qe)&&!Qe[qe];if(bt){var Dr=me.pointers.length===1,en=me.distance<2,Br=me.deltaTime<250;if(Dr&&en&&Br)return}if(!(Dn&&Qt)&&(bt||Qt&&Ue&cr||Dn&&Ue&rr))return this.preventSrc(Te)},preventSrc:function(me){this.manager.session.prevented=!0,me.preventDefault()}};function Dt(me){if(Xe(me,Ie))return Ie;var Te=Xe(me,qe),Ue=Xe(me,At);return Te&&Ue?Ie:Te||Ue?Te?qe:At:Xe(me,Pe)?Pe:ke}function Rt(){if(!G)return!1;var me={},Te=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ue){me[Ue]=Te?e.CSS.supports("touch-action",Ue):!0}),me}var sn=1,jt=2,pn=4,qt=8,an=qt,xn=16,Ft=32;function Ne(me){this.options=H({},this.defaults,me||{}),this.id=Et(),this.manager=null,this.options.enable=pe(this.options.enable,!0),this.state=sn,this.simultaneous={},this.requireFail=[]}Ne.prototype={defaults:{},set:function(me){return H(this.options,me),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(me){if(k(me,"recognizeWith",this))return this;var Te=this.simultaneous;return me=cn(me,this),Te[me.id]||(Te[me.id]=me,me.recognizeWith(this)),this},dropRecognizeWith:function(me){return k(me,"dropRecognizeWith",this)?this:(me=cn(me,this),delete this.simultaneous[me.id],this)},requireFailure:function(me){if(k(me,"requireFailure",this))return this;var Te=this.requireFail;return me=cn(me,this),Oe(Te,me)===-1&&(Te.push(me),me.requireFailure(this)),this},dropRequireFailure:function(me){if(k(me,"dropRequireFailure",this))return this;me=cn(me,this);var Te=Oe(this.requireFail,me);return Te>-1&&this.requireFail.splice(Te,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(me){return!!this.simultaneous[me.id]},emit:function(me){var Te=this,Ue=this.state;function lt(bt){Te.manager.emit(bt,me)}Ue<qt&&lt(Te.options.event+Mt(Ue)),lt(Te.options.event),me.additionalEvent&&lt(me.additionalEvent),Ue>=qt&&lt(Te.options.event+Mt(Ue))},tryEmit:function(me){if(this.canEmit())return this.emit(me);this.state=Ft},canEmit:function(){for(var me=0;me<this.requireFail.length;){if(!(this.requireFail[me].state&(Ft|sn)))return!1;me++}return!0},recognize:function(me){var Te=H({},me);if(!he(this.options.enable,[this,Te])){this.reset(),this.state=Ft;return}this.state&(an|xn|Ft)&&(this.state=sn),this.state=this.process(Te),this.state&(jt|pn|qt|xn)&&this.tryEmit(Te)},process:function(me){},getTouchAction:function(){},reset:function(){}};function Mt(me){return me&xn?"cancel":me&qt?"end":me&pn?"move":me&jt?"start":""}function Ce(me){return me==br?"down":me==Qn?"up":me==xt?"left":me==nr?"right":""}function cn(me,Te){var Ue=Te.manager;return Ue?Ue.get(me):me}function fi(){Ne.apply(this,arguments)}J(fi,Ne,{defaults:{pointers:1},attrTest:function(me){var Te=this.options.pointers;return Te===0||me.pointers.length===Te},process:function(me){var Te=this.state,Ue=me.eventType,lt=Te&(jt|pn),bt=this.attrTest(me);return lt&&(Ue&rn||!bt)?Te|xn:lt||bt?Ue&wt?Te|qt:Te&jt?Te|pn:jt:Ft}});function ir(){fi.apply(this,arguments),this.pX=null,this.pY=null}J(ir,fi,{defaults:{event:"pan",threshold:10,pointers:1,direction:ni},getTouchAction:function(){var me=this.options.direction,Te=[];return me&cr&&Te.push(At),me&rr&&Te.push(qe),Te},directionTest:function(me){var Te=this.options,Ue=!0,lt=me.distance,bt=me.direction,Qt=me.deltaX,Dn=me.deltaY;return bt&Te.direction||(Te.direction&cr?(bt=Qt===0?Pn:Qt<0?xt:nr,Ue=Qt!=this.pX,lt=Math.abs(me.deltaX)):(bt=Dn===0?Pn:Dn<0?Qn:br,Ue=Dn!=this.pY,lt=Math.abs(me.deltaY))),me.direction=bt,Ue&&lt>Te.threshold&&bt&Te.direction},attrTest:function(me){return fi.prototype.attrTest.call(this,me)&&(this.state&jt||!(this.state&jt)&&this.directionTest(me))},emit:function(me){this.pX=me.deltaX,this.pY=me.deltaY;var Te=Ce(me.direction);Te&&(me.additionalEvent=this.options.event+Te),this._super.emit.call(this,me)}});function pa(){fi.apply(this,arguments)}J(pa,fi,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ie]},attrTest:function(me){return this._super.attrTest.call(this,me)&&(Math.abs(me.scale-1)>this.options.threshold||this.state&jt)},emit:function(me){if(me.scale!==1){var Te=me.scale<1?"in":"out";me.additionalEvent=this.options.event+Te}this._super.emit.call(this,me)}});function Re(){Ne.apply(this,arguments),this._timer=null,this._input=null}J(Re,Ne,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ke]},process:function(me){var Te=this.options,Ue=me.pointers.length===Te.pointers,lt=me.distance<Te.threshold,bt=me.deltaTime>Te.time;if(this._input=me,!lt||!Ue||me.eventType&(wt|rn)&&!bt)this.reset();else if(me.eventType&Gn)this.reset(),this._timer=M(function(){this.state=an,this.tryEmit()},Te.time,this);else if(me.eventType&wt)return an;return Ft},reset:function(){clearTimeout(this._timer)},emit:function(me){this.state===an&&(me&&me.eventType&wt?this.manager.emit(this.options.event+"up",me):(this._input.timeStamp=C(),this.manager.emit(this.options.event,this._input)))}});function Qa(){fi.apply(this,arguments)}J(Qa,fi,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ie]},attrTest:function(me){return this._super.attrTest.call(this,me)&&(Math.abs(me.rotation)>this.options.threshold||this.state&jt)}});function we(){fi.apply(this,arguments)}J(we,fi,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:cr|rr,pointers:1},getTouchAction:function(){return ir.prototype.getTouchAction.call(this)},attrTest:function(me){var Te=this.options.direction,Ue;return Te&(cr|rr)?Ue=me.overallVelocity:Te&cr?Ue=me.overallVelocityX:Te&rr&&(Ue=me.overallVelocityY),this._super.attrTest.call(this,me)&&Te&me.offsetDirection&&me.distance>this.options.threshold&&me.maxPointers==this.options.pointers&&_(Ue)>this.options.velocity&&me.eventType&wt},emit:function(me){var Te=Ce(me.offsetDirection);Te&&this.manager.emit(this.options.event+Te,me),this.manager.emit(this.options.event,me)}});function Wo(){Ne.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}J(Wo,Ne,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Pe]},process:function(me){var Te=this.options,Ue=me.pointers.length===Te.pointers,lt=me.distance<Te.threshold,bt=me.deltaTime<Te.time;if(this.reset(),me.eventType&Gn&&this.count===0)return this.failTimeout();if(lt&&bt&&Ue){if(me.eventType!=wt)return this.failTimeout();var Qt=this.pTime?me.timeStamp-this.pTime<Te.interval:!0,Dn=!this.pCenter||Ei(this.pCenter,me.center)<Te.posThreshold;this.pTime=me.timeStamp,this.pCenter=me.center,!Dn||!Qt?this.count=1:this.count+=1,this._input=me;var Dr=this.count%Te.taps;if(Dr===0)return this.hasRequireFailures()?(this._timer=M(function(){this.state=an,this.tryEmit()},Te.interval,this),jt):an}return Ft},failTimeout:function(){return this._timer=M(function(){this.state=Ft},this.options.interval,this),Ft},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==an&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Cs(me,Te){return Te=Te||{},Te.recognizers=pe(Te.recognizers,Cs.defaults.preset),new ga(me,Te)}Cs.VERSION="2.0.7",Cs.defaults={domEvents:!1,touchAction:Le,enable:!0,inputTarget:null,inputClass:null,preset:[[Qa,{enable:!1}],[pa,{enable:!1},["rotate"]],[we,{direction:cr}],[ir,{direction:cr},["swipe"]],[Wo],[Wo,{event:"doubletap",taps:2},["tap"]],[Re]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var qa=1,Za=2;function ga(me,Te){this.options=H({},Cs.defaults,Te||{}),this.options.inputTarget=this.options.inputTarget||me,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=me,this.input=Gi(this),this.touchAction=new dt(this,this.options.touchAction),Ml(this,!0),F(this.options.recognizers,function(Ue){var lt=this.add(new Ue[0](Ue[1]));Ue[2]&&lt.recognizeWith(Ue[2]),Ue[3]&&lt.requireFailure(Ue[3])},this)}ga.prototype={set:function(me){return H(this.options,me),me.touchAction&&this.touchAction.update(),me.inputTarget&&(this.input.destroy(),this.input.target=me.inputTarget,this.input.init()),this},stop:function(me){this.session.stopped=me?Za:qa},recognize:function(me){var Te=this.session;if(!Te.stopped){this.touchAction.preventDefaults(me);var Ue,lt=this.recognizers,bt=Te.curRecognizer;(!bt||bt&&bt.state&an)&&(bt=Te.curRecognizer=null);for(var Qt=0;Qt<lt.length;)Ue=lt[Qt],Te.stopped!==Za&&(!bt||Ue==bt||Ue.canRecognizeWith(bt))?Ue.recognize(me):Ue.reset(),!bt&&Ue.state&(jt|pn|qt)&&(bt=Te.curRecognizer=Ue),Qt++}},get:function(me){if(me instanceof Ne)return me;for(var Te=this.recognizers,Ue=0;Ue<Te.length;Ue++)if(Te[Ue].options.event==me)return Te[Ue];return null},add:function(me){if(k(me,"add",this))return this;var Te=this.get(me.options.event);return Te&&this.remove(Te),this.recognizers.push(me),me.manager=this,this.touchAction.update(),me},remove:function(me){if(k(me,"remove",this))return this;if(me=this.get(me),me){var Te=this.recognizers,Ue=Oe(Te,me);Ue!==-1&&(Te.splice(Ue,1),this.touchAction.update())}return this},on:function(me,Te){if(me!==i&&Te!==i){var Ue=this.handlers;return F(rt(me),function(lt){Ue[lt]=Ue[lt]||[],Ue[lt].push(Te)}),this}},off:function(me,Te){if(me!==i){var Ue=this.handlers;return F(rt(me),function(lt){Te?Ue[lt]&&Ue[lt].splice(Oe(Ue[lt],Te),1):delete Ue[lt]}),this}},emit:function(me,Te){this.options.domEvents&&ma(me,Te);var Ue=this.handlers[me]&&this.handlers[me].slice();if(!(!Ue||!Ue.length)){Te.type=me,Te.preventDefault=function(){Te.srcEvent.preventDefault()};for(var lt=0;lt<Ue.length;)Ue[lt](Te),lt++}},destroy:function(){this.element&&Ml(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Ml(me,Te){var Ue=me.element;if(Ue.style){var lt;F(me.options.cssProps,function(bt,Qt){lt=pt(Ue.style,Qt),Te?(me.oldCssProps[lt]=Ue.style[lt],Ue.style[lt]=bt):Ue.style[lt]=me.oldCssProps[lt]||""}),Te||(me.oldCssProps={})}}function ma(me,Te){var Ue=n.createEvent("Event");Ue.initEvent(me,!0,!0),Ue.gesture=Te,Te.target.dispatchEvent(Ue)}H(Cs,{INPUT_START:Gn,INPUT_MOVE:Mr,INPUT_END:wt,INPUT_CANCEL:rn,STATE_POSSIBLE:sn,STATE_BEGAN:jt,STATE_CHANGED:pn,STATE_ENDED:qt,STATE_RECOGNIZED:an,STATE_CANCELLED:xn,STATE_FAILED:Ft,DIRECTION_NONE:Pn,DIRECTION_LEFT:xt,DIRECTION_RIGHT:nr,DIRECTION_UP:Qn,DIRECTION_DOWN:br,DIRECTION_HORIZONTAL:cr,DIRECTION_VERTICAL:rr,DIRECTION_ALL:ni,Manager:ga,Input:qn,TouchAction:dt,TouchInput:Hi,MouseInput:Sn,PointerEventInput:Ke,TouchMouseInput:K,SingleTouchInput:hi,Recognizer:Ne,AttrRecognizer:fi,Tap:Wo,Pan:ir,Swipe:we,Pinch:pa,Rotate:Qa,Press:Re,on:be,off:Ge,each:F,merge:Y,extend:ie,assign:H,inherit:J,bindFn:se,prefixed:pt});var ri=typeof e<"u"?e:typeof self<"u"?self:{};ri.Hammer=Cs,typeof i=="function"&&i.amd?i(function(){return Cs}):t.exports?t.exports=Cs:e[r]=Cs})(window,document,"Hammer")})(_z);var Nm=_z.exports;const wee=Z2(Nm),UA=eT({__proto__:null,default:wee},[Nm]),vz=1,xz=2,q3=4,bee={mousedown:vz,mousemove:xz,mouseup:q3};function Eee(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function Tee(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(Eee(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function See(t){t.prototype.handler=function(n){let r=bee[n.type];r&vz&&n.button>=0&&(this.pressed=!0),r&xz&&n.which===0&&(r=q3),this.pressed&&(r&q3&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}Tee(Nm.PointerEventInput);See(Nm.MouseInput);const Cee=Nm.Manager;class yv{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const Mee=UA?[[UA.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[UA.Rotate,{enable:!1}],[UA.Pinch,{enable:!1}],[UA.Swipe,{enable:!1}],[UA.Pan,{threshold:0,enable:!1}],[UA.Press,{enable:!1}],[UA.Tap,{event:"doubletap",taps:2,enable:!1}],[UA.Tap,{event:"anytap",enable:!1}],[UA.Tap,{enable:!1}]]:null,yk={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Pee={doubletap:["tap"]},kee={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},SS={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Iee={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},_k={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Lee=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",z0=typeof window<"u"?window:global;let Z3=!1;try{const t={get passive(){return Z3=!0,!0}};z0.addEventListener("test",null,t),z0.removeEventListener("test",null)}catch{Z3=!1}const Dee=Lee.indexOf("firefox")!==-1,{WHEEL_EVENTS:Ree}=SS,vk="wheel",xk=4.000244140625,Bee=40,zee=.25;class Oee extends yv{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;z0.WheelEvent&&(Dee&&i.deltaMode===z0.WheelEvent.DOM_DELTA_PIXEL&&(s/=z0.devicePixelRatio),i.deltaMode===z0.WheelEvent.DOM_DELTA_LINE&&(s*=Bee)),s!==0&&s%xk===0&&(s=Math.floor(s/xk)),i.shiftKey&&s&&(s=s*zee),this.callback({type:vk,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(Ree),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,Z3?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===vk&&(this.options.enable=n)}}const{MOUSE_EVENTS:Fee}=SS,wk="pointermove",bk="pointerover",Ek="pointerout",Tk="pointerenter",Sk="pointerleave";class Nee extends yv{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(Fee),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===wk&&(this.enableMoveEvent=n),e===bk&&(this.enableOverEvent=n),e===Ek&&(this.enableOutEvent=n),e===Tk&&(this.enableEnterEvent=n),e===Sk&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(bk,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(Ek,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(Tk,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(Sk,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(wk,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:Uee}=SS,Ck="keydown",Mk="keyup";class Vee extends yv{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:Ck,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:Mk,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Uee),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Ck&&(this.enableDownEvent=n),e===Mk&&(this.enableUpEvent=n)}}const Pk="contextmenu";class Gee extends yv{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:Pk,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===Pk&&(this.options.enable=n)}}const Y3=1,J_=2,X3=4,$ee={pointerdown:Y3,pointermove:J_,pointerup:X3,mousedown:Y3,mousemove:J_,mouseup:X3},jee=1,Hee=2,Wee=3,Qee=0,qee=1,Zee=2,Yee=1,Xee=2,Kee=4;function Jee(t){const e=$ee[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,l=!1,o=!1;return e===X3||e===J_&&!Number.isFinite(n)?(s=i===jee,l=i===Hee,o=i===Wee):e===J_?(s=!!(n&Yee),l=!!(n&Kee),o=!!(n&Xee)):e===Y3&&(s=r===Qee,l=r===qee,o=r===Zee),{leftButton:s,middleButton:l,rightButton:o}}function ete(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,l={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:l}}const zw={srcElement:"root",priority:0};class tte{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:l,handlersByElement:o}=this;let p=zw;typeof r=="string"||r&&r.addEventListener?p={...zw,srcElement:r}:r&&(p={...zw,...r});let _=o.get(p.srcElement);_||(_=[],o.set(p.srcElement,_));const C={type:e,handler:n,srcElement:p.srcElement,priority:p.priority};i&&(C.once=!0),s&&(C.passive=!0),l.push(C),this._active=this._active||!C.passive;let M=_.length-1;for(;M>=0&&!(_[M].priority>=C.priority);)M--;_.splice(M+1,0,C)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const l=r[s];if(l.type===e&&l.handler===n){r.splice(s,1);const o=i.get(l.srcElement);o.splice(o.indexOf(l),1),o.length===0&&i.delete(l.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},l=()=>{e.handled=!0,i=!0},o=[];for(let p=0;p<r.length;p++){const{type:_,handler:C,once:M}=r[p];if(C({...e,type:_,stopPropagation:s,stopImmediatePropagation:l}),M&&o.push(r[p]),i)break}for(let p=0;p<o.length;p++){const{type:_,handler:C}=o[p];this.remove(_,C)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...Jee(e),...ete(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const nte={events:null,recognizers:null,recognizerOptions:{},Manager:Cee,touchAction:"none",tabIndex:0};class rte{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,l=kee[s.type];l&&this.manager.emit(l,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...nte,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||Mee}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(yk).forEach(i=>{const s=this.manager.get(i);s&&yk[i].forEach(l=>{s.recognizeWith(l)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const l=n.recognizerOptions[i];delete l.enable,s.set(l)}}this.wheelInput=new Oee(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Nee(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Vee(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new Gee(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=Pee[e];s&&!this.options.recognizers&&s.forEach(l=>{const o=r.get(l);n?(o.requireFailure(e),i.dropRequireFailure(l)):o.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const C in e)this._addEventHandler(C,e[C],r,i,s);return}const{manager:l,events:o}=this,p=_k[e]||e;let _=o.get(p);_||(_=new tte(this),o.set(p,_),_.recognizerName=Iee[p]||p,l&&l.on(p,_.handleEvent)),_.add(e,n,r,i,s),_.isEmpty()||this._toggleRecognizer(_.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const l in e)this._removeEventHandler(l,e[l]);return}const{events:r}=this,i=_k[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:l}=s;let o=!1;for(const p of r.values())if(p.recognizerName===l&&!p.isEmpty()){o=!0;break}o||this._toggleRecognizer(l,!1)}}}function jh(){}const ite=({isDragging:t})=>t?"grabbing":"grab",wz={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:jh,onResize:jh,onViewStateChange:jh,onInteractionStateChange:jh,onBeforeRender:jh,onAfterRender:jh,onLoad:jh,onError:t=>or.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:ite,getTooltip:null,debug:!1,drawPickingColors:!1};class Ef{constructor(e){oe(this,"props",void 0),oe(this,"width",0),oe(this,"height",0),oe(this,"userData",{}),oe(this,"canvas",null),oe(this,"viewManager",null),oe(this,"layerManager",null),oe(this,"effectManager",null),oe(this,"deckRenderer",null),oe(this,"deckPicker",null),oe(this,"eventManager",null),oe(this,"tooltip",null),oe(this,"metrics",void 0),oe(this,"animationLoop",void 0),oe(this,"stats",void 0),oe(this,"viewState",void 0),oe(this,"cursorState",void 0),oe(this,"_needsRedraw",void 0),oe(this,"_pickRequest",void 0),oe(this,"_lastPointerDownInfo",null),oe(this,"_metricsCounter",void 0),oe(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),oe(this,"_onEvent",n=>{const r=tP[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),l=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=l,p=o&&(o[r.handler]||o.props[r.handler]),_=this.props[r.handler];let C=!1;p&&(C=p.call(o,l,n)),!C&&_&&_(l,n)}),oe(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...wz,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&or.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),BH()==="IE"&&or.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new dz({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Td.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,l,o,p;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(l=this.deckPicker)===null||l===void 0||l.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(p=this.tooltip)===null||p===void 0||p.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var _;(_=this.canvas.parentElement)===null||_===void 0||_.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&or.removed("onLayerHover","onHover")(),"onLayerClick"in e&&or.removed("onLayerClick","onClick")(),e.initialViewState&&!oA(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),l=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||l,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Ui(this.viewManager),this.viewManager.views}getViewports(e){return Ui(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){Ui(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Ui(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,s=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||s!==this.height){var l,o;this.width=i,this.height=s,(l=this.viewManager)===null||l===void 0||l.setProps({width:i,height:s}),(o=this.layerManager)===null||o===void 0||o.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:l,onError:o,onBeforeRender:p,onAfterRender:_,useDevicePixels:C}=e;return new aZ({width:n,height:r,useDevicePixels:C,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:M=>rB({...s,...M,canvas:this.canvas,debug:l,onContextLost:()=>this._onContextLost()}),onInitialize:M=>this._setGLContext(M.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:p,onAfterRender:_,onError:o})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new tc({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,l=!1;for(const o of r){var n;s=o,l=((n=o.layer)===null||n===void 0?void 0:n.onHover(o,e.event))||l}if(!l&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const o=this.props.getTooltip(s);this.tooltip.setTooltip(o,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,lS(e,{enable:!0,copyState:!0})),this.tooltip=new xee(this.canvas),lc(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new YB;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new rte(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in tP)this.eventManager.on(i,this._onEvent);this.viewManager=new ZJ({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new qJ(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new uee,this.deckRenderer=new fee(e),this.deckPicker=new _ee(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;lc(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),or.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=sf.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}oe(Ef,"defaultProps",wz);oe(Ef,"VERSION",XH);class Ow{constructor(e,n){oe(this,"opts",void 0),oe(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const l=n.elementOffset||0;for(let o=0;o<i;++o)s[o]=r[l+o]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function ste(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function Wy(t){return t.stride||t.size*t.bytesPerElement}function bz(t,e){e.offset&&or.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Wy(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function ote(t,e){const n=bz(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class ate{constructor(e,n,r){oe(this,"gl",void 0),oe(this,"id",void 0),oe(this,"size",void 0),oe(this,"settings",void 0),oe(this,"value",void 0),oe(this,"doublePrecision",void 0),oe(this,"_buffer",void 0),oe(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:l}=n;l=Number.isFinite(l)?[l]:l||new Array(this.size).fill(0);let o;s?o=5126:!i&&n.isIndexed?o=e&&dB(e,ei.ELEMENT_INDEX_UINT32)?5125:5123:o=i||5126;let p=ste(i||o||5126);this.doublePrecision=s,s&&n.fp64===!1&&(p=Float32Array),this.value=null,this.settings={...n,defaultType:p,defaultValue:l,logicalType:i,type:o,size:this.size,bytesPerElement:p.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new Gr(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Wy(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Td.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=ote(this.getAccessor(),n||{});return r[e]=new Ow(this,s.high),r["".concat(e,"64Low")]=i?new Ow(this,s.low):new Float32Array(this.size),r}if(n){const r=bz(this.getAccessor(),n);return{[e]:new Ow(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const l=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let p=0;p<s;)for(let _=0;_<i;_++){const C=n[p++];C<l[_]&&(l[_]=C),C>o[_]&&(o[_]=C)}e=[l,o]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof Gr?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const l=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(l?2:1),i.stride=Wy(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=Wy(i);const{buffer:l,byteOffset:o}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Dw(s,i));const p=s.byteLength+o+i.stride*2;l.byteLength<p&&l.reallocate(p),l.setAccessor(null),l.subData({data:s,offset:o}),i.type=r.type||l.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Dw(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=Td.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:l,byteOffset:o}=this;return l.byteLength<s.byteLength+o&&(l.reallocate(s.byteLength+o),n&&i&&l.subData({data:i instanceof Float64Array?Dw(i,this):i,offset:o})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&or.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let l=s;for(;--l>=0;)n[r+l]=i[l];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let l=s;for(;--l>=0;)n[r+l]=Number.isFinite(e[l])?e[l]:i[l]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const kk=[],Ik=[];function Wd(t,e=0,n=1/0){let r=kk;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(Ik.length=t.length,r=Ik):r=kk,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function Ez(t){return t&&t[Symbol.asyncIterator]}function Tz(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:l}=e,o=t.BYTES_PER_ELEMENT,p=r?r/o:n,_=i?i/o:0,C=Math.floor((t.length-_)/p);return(M,{index:k,target:F})=>{if(!s){const Y=k*p+_;for(let J=0;J<n;J++)F[J]=t[Y+J];return F}const j=s[k],H=s[k+1]||C;let ie;if(l){ie=new Array(H-j);for(let Y=j;Y<H;Y++){const J=Y*p+_;F=new Array(n);for(let se=0;se<n;se++)F[se]=t[J+se];ie[Y-j]=F}}else if(p===n)ie=t.subarray(j*n+_,H*n+_);else{ie=new t.constructor((H-j)*n);let Y=0;for(let J=j;J<H;J++){const se=J*p+_;for(let he=0;he<n;he++)ie[Y++]=t[se+he]}}return ie}}const lte=[],Qy=[[0,1/0]];function Ate(t,e){if(t===Qy||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const l=t[s];l[1]<e[0]?(n.push(l),i=s+1):l[0]>e[1]?n.push(l):e=[Math.min(l[0],e[0]),Math.max(l[1],e[1])]}return n.splice(i,0,e),n}function Fw(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,l=t.end||n.length,o=e.length,p=l-r;if(o>p){n.set(e.subarray(0,p),r);return}if(n.set(e,r),!s)return;let _=o;for(;_<p;){const C=s(_,e);for(let M=0;M<i;M++)n[r+_]=C[M]||0,_++}}function ute({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return Fw({source:t,target:e,size:n,getData:r}),e;let l=0,o=0;const p=r&&((C,M)=>r(C+o,M)),_=Math.min(i.length,s.length);for(let C=1;C<_;C++){const M=i[C]*n,k=s[C]*n;Fw({source:t.subarray(l,M),target:e,start:o,end:k,size:n,getData:p}),l=M,o=k}return o<e.length&&Fw({source:[],target:e,start:o,size:n,getData:p}),e}const cte={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Sz(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...cte[n],...e,...t,type:n}}function Cz(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function Mz(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function Pz(t){t.push(t.shift())}function CS(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,l=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*l}function kz({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=l=>l}){const l=n.doublePrecision&&n.value instanceof Float64Array?2:1,o=n.size*l,p=n.byteOffset,_=n.startIndices,C=i&&_,M=CS(n,e),k=n.isConstant;if(!C&&r>=M)return;const F=k?n.value:n.getBuffer().getData({srcByteOffset:p});if(n.settings.normalized&&!k){const Y=s;s=(J,se)=>n.normalizeConstant(Y(J,se))}const j=k?(Y,J)=>s(F,J):(Y,J)=>s(F.subarray(Y,Y+o),J),H=t.getData({length:r}),ie=new Float32Array(M);ute({source:H,target:ie,sourceStartIndices:i,targetStartIndices:_,size:o,getData:j}),t.byteLength<ie.byteLength+p&&t.reallocate(ie.byteLength+p),t.subData({data:ie,offset:p})}class MS extends ate{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Qy}),oe(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return Sz(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=Ate(this.state.updateRanges,[r,i])}else this.state.updateRanges=Qy}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=lte}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==Qy),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:l,noAlloc:o}}=this;let p=!0;if(l){for(const[_,C]of s)l.call(i,this,{data:n,startRow:_,endRow:C,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[_,C]of s){const M=Number.isFinite(_)?this.getVertexOffset(_):0,k=Number.isFinite(C)?this.getVertexOffset(C):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:M,endOffset:k})}this._checkAttributeArray()}else p=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),p}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const l=e;Ui(ArrayBuffer.isView(l.value),"invalid ".concat(i.accessor));const o=!!l.size&&l.size!==this.size;return r.binaryAccessor=Tz(l.value,{size:l.size||this.size,stride:l.stride,offset:l.offset,startIndices:n,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:l}){if(e.constant)return;const{settings:o,state:p,value:_,size:C,startIndices:M}=e,{accessor:k,transform:F}=o,j=p.binaryAccessor||(typeof k=="function"?k:s[k]);Ui(typeof j=="function",'accessor "'.concat(k,'" is not a function'));let H=e.getVertexOffset(r);const{iterable:ie,objectInfo:Y}=Wd(n,r,i);for(const J of ie){Y.index++;let se=j(J,Y);if(F&&(se=F.call(this,se)),M){const he=(Y.index<M.length-1?M[Y.index+1]:l)-M[Y.index];if(se&&Array.isArray(se[0])){let pe=H;for(const be of se)e._normalizeValue(be,_,pe),pe+=C}else se&&se.length>C?_.set(se,H):(e._normalizeValue(se,Y.target,0),NJ({target:_,source:Y.target,start:H,count:he}));H+=he*C}else e._normalizeValue(se,_,H),H+=C}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class hte{constructor({gl:e,attribute:n,timeline:r}){oe(this,"gl",void 0),oe(this,"type","interpolation"),oe(this,"attributeInTransition",void 0),oe(this,"settings",void 0),oe(this,"attribute",void 0),oe(this,"transition",void 0),oe(this,"currentStartIndices",void 0),oe(this,"currentLength",void 0),oe(this,"transform",void 0),oe(this,"buffers",void 0),this.gl=e,this.transition=new Fm(r),this.attribute=n,this.attributeInTransition=new MS(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=dte(e,n);const i={byteLength:0,usage:35050};this.buffers=[new Gr(e,i),new Gr(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;Pz(i);const l={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)kz({buffer:o,...l});this.currentStartIndices=s.startIndices,this.currentLength=CS(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:Cz(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const fte=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function dte(t,e){const n=Mz(e.size);return new vS(t,{vs:fte,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class pte{constructor({gl:e,attribute:n,timeline:r}){oe(this,"gl",void 0),oe(this,"type","spring"),oe(this,"attributeInTransition",void 0),oe(this,"settings",void 0),oe(this,"attribute",void 0),oe(this,"transition",void 0),oe(this,"currentStartIndices",void 0),oe(this,"currentLength",void 0),oe(this,"texture",void 0),oe(this,"framebuffer",void 0),oe(this,"transform",void 0),oe(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Fm(r),this.attribute=n,this.attributeInTransition=new MS(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=mte(e),this.framebuffer=yte(e,this.texture),this.transform=gte(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new Gr(e,i),new Gr(e,i),new Gr(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,l={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)kz({buffer:o,...l});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=CS(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:Cz(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const l=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:l.stiffness,damping:l.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Pz(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),mv(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function gte(t,e,n){const r=Mz(e.size);return new vS(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function mte(t){return new da(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function yte(t,e){return new os(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const _te={interpolation:hte,spring:pte};class vte{constructor(e,{id:n,timeline:r}){oe(this,"id",void 0),oe(this,"isSupported",void 0),oe(this,"gl",void 0),oe(this,"timeline",void 0),oe(this,"transitions",void 0),oe(this,"needsRedraw",void 0),oe(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=vS.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],l=s.getTransitionSetting(n);l&&this._updateAttribute(i,s,l)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){or.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const l=_te[r.type];l?this.transitions[e]=new l({attribute:n,timeline:this.timeline,gl:this.gl}):(or.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const Lk="attributeManager.invalidate",xte="attributeManager.updateStart",wte="attributeManager.updateEnd",bte="attribute.updateStart",Ete="attribute.allocate",Tte="attribute.updateEnd";class Ste{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){oe(this,"id",void 0),oe(this,"gl",void 0),oe(this,"attributes",void 0),oe(this,"updateTriggers",void 0),oe(this,"needsRedraw",void 0),oe(this,"userData",void 0),oe(this,"stats",void 0),oe(this,"attributeTransitionManager",void 0),oe(this,"mergeBoundsMemoized",Om(cJ)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new vte(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);co(Lk,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);co(Lk,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:l={},context:o={}}){let p=!1;co(xte,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const _ in this.attributes){const C=this.attributes[_],M=C.settings.accessor;C.startIndices=r,C.numInstances=n,s[_]&&or.removed("props.".concat(_),"data.attributes.".concat(_))(),C.setExternalBuffer(l[_])||C.setBinaryValue(typeof M=="string"?l[M]:void 0,e.startIndices)||typeof M=="string"&&!l[M]&&C.setConstantValue(s[M])||C.needsUpdate()&&(p=!0,this._updateAttribute({attribute:C,numInstances:n,data:e,props:s,context:o})),this.needsRedraw=this.needsRedraw||C.needsRedraw()}p&&co(wte,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const l=n[s];l.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=l)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new MS(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(l=>{const o=r[l];o&&o.setNeedsUpdate(o.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(co(bte,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&co(Ete,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,co(Tte,n,r))}}class Cte extends Fm{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,l=s(e/i);this._value=wl(n,r,l)}}const Dk=1e-5;function Rk(t,e,n,r,i){const s=e-t,o=(n-e)*i,p=-s*r;return o+p+s+e}function Mte(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let l=0;l<n.length;l++)s[l]=Rk(t[l],e[l],n[l],r,i);return s}return Rk(t,e,n,r,i)}function Bk(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class Pte extends Fm{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:l=e}=this;let o=Mte(s,l,n,r,i);const p=Bk(o,n),_=Bk(o,l);p<Dk&&_<Dk&&(o=n,this.end()),this._prevValue=l,this._currValue=o}}const kte={interpolation:Cte,spring:Pte};class Ite{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const p=s.get(e),{value:_=p.settings.fromValue}=p;n=_,this.remove(e)}if(i=Sz(i),!i)return;const l=kte[i.type];if(!l){or.error("unsupported transition type '".concat(i.type,"'"))();return}const o=new l(this.timeline);o.start({...i,fromValue:n,toValue:r}),s.set(e,o)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Lte(t){const e=t[gh];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function Dte(t,e){const n=Iz({newProps:t,oldProps:e,propTypes:t[gh],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=Bte(t,e);let i=!1;return r||(i=zte(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:Ote(t,e),transitionsChanged:Rte(t,e)}}function Rte(t,e){if(!t.transitions)return!1;const n={},r=t[gh];let i=!1;for(const s in t.transitions){const l=r[s],o=l&&l.type;(o==="number"||o==="color"||o==="array")&&K3(t[s],e[s],l)&&(n[s]=!0,i=!0)}return i?n:!1}function Iz({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const l=K3(t[s],e[s],r[s]);if(l)return"".concat(i,".").concat(s," ").concat(l)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const l=K3(t[s],e[s],r[s]);if(l)return"".concat(i,".").concat(s," ").concat(l)}}return!1}function K3(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function Bte(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function zte(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&zk(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&zk(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function Ote(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function zk(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},Iz({oldProps:i,newProps:r,triggerName:n})}const Fte="count(): argument not an object",Nte="count(): argument not a container";function Ute(t){if(!Gte(t))throw new Error(Fte);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(Vte(t))return Object.keys(t).length;throw new Error(Nte)}function Vte(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function Gte(t){return t!==null&&typeof t=="object"}function J3(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const $te={10241:9987,10240:9729,10242:33071,10243:33071},eE={};function jte(t,e,n,r){if(n instanceof da)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const s=new da(e,{...n,parameters:{...$te,...i,...r}});return eE[s.id]=t,s}function Hte(t,e){!e||!(e instanceof da)||eE[e.id]===t&&(e.delete(),delete eE[e.id])}const Wte={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||tE(t)&&(t.length===3||t.length===4)},equal(t,e,n){return oA(t,e,1)}},accessor:{validate(t,e){const n=e2(t);return n==="function"||n===e2(e.value)},equal(t,e,n){return typeof e=="function"?!0:oA(t,e,1)}},array:{validate(t,e){return e.optional&&!t||tE(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?oA(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?oA(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:jte(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{Hte(n.id,t)}}};function Qte(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const l=s?.deprecatedFor;if(l)r[i]=Array.isArray(l)?l:[l];else{const o=qte(i,s);e[i]=o,n[i]=o.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function qte(t,e){switch(e2(e)){case"object":return Bp(t,e);case"array":return Bp(t,{type:"array",value:e,compare:!1});case"boolean":return Bp(t,{type:"boolean",value:e});case"number":return Bp(t,{type:"number",value:e});case"function":return Bp(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Bp(t,e){return"type"in e?{name:t,...Wte[e.type],...e}:"value"in e?{name:t,type:e2(e.value),...e}:{name:t,type:"object",value:e}}function tE(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function e2(t){return tE(t)?"array":t===null?"null":typeof t}function Zte(t,e){let n;for(let s=e.length-1;s>=0;s--){const l=e[s];"extensions"in l&&(n=l.extensions)}const r=nE(t.constructor,n),i=Object.create(r);i[K_]=t,i[wf]={},i[rh]={};for(let s=0;s<e.length;++s){const l=e[s];for(const o in l)i[o]=l[o]}return Object.freeze(i),i}const Yte="_mergedDefaultProps";function nE(t,e){let n=Yte;if(e)for(const i of e){const s=i.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const r=Lz(t,n);return r||(t[n]=Xte(t,e||[]))}function Xte(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=nE(r),s=Lz(t,"defaultProps")||{},l=Qte(s),o=Object.assign(Object.create(null),i,l.defaultProps),p=Object.assign(Object.create(null),i?.[gh],l.propTypes),_=Object.assign(Object.create(null),i?.[Bw],l.deprecatedProps);for(const C of e){const M=nE(C.constructor);M&&(Object.assign(o,M),Object.assign(p,M[gh]),Object.assign(_,M[Bw]))}return Kte(o,t),ene(o,p),Jte(o,_),o[gh]=p,o[Bw]=_,e.length===0&&!PS(t,"_propTypes")&&(t._propTypes=p),o}function Kte(t,e){const n=nne(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function Jte(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])PS(this,s)||(this[s]=r);or.deprecated(i,e[n].join("/"))()}})}function ene(t,e){const n={},r={};for(const i in e){const s=e[i],{name:l,value:o}=s;s.async&&(n[l]=o,r[l]=tne(l))}t[id]=n,t[wf]={},Object.defineProperties(t,r)}function tne(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||Ez(e)?this[wf][t]=e:this[rh][t]=e},get(){if(this[rh]){if(t in this[rh])return this[rh][t]||this[id][t];if(t in this[wf]){const e=this[K_]&&this[K_].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[id][t]}}return this[id][t]}}}function PS(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Lz(t,e){return PS(t,e)&&t[e]}function nne(t){const e=t.componentName;return e||or.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let rne=0;class kS{constructor(...e){oe(this,"id",void 0),oe(this,"props",void 0),oe(this,"count",void 0),this.props=Zte(this,e),this.id=this.props.id,this.count=rne++}clone(e){const{props:n}=this,r={};for(const i in n[id])i in n[rh]?r[i]=n[rh][i]:i in n[wf]&&(r[i]=n[wf][i]);return new this.constructor({...n,...r,...e})}}oe(kS,"componentName","Component");oe(kS,"defaultProps",{});const ine=Object.freeze({});class sne{constructor(e){oe(this,"component",void 0),oe(this,"onAsyncPropUpdated",void 0),oe(this,"asyncProps",void 0),oe(this,"oldProps",void 0),oe(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||ine}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[K_]||this.component;const n=e[rh]||{},r=e[wf]||e,i=e[id]||{};for(const s in n){const l=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,l),n[s]=this.getAsyncProp(s)}for(const s in r){const l=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,l)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(Ez(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],l=0;for await(const o of n){if(!this.component)return;const{dataTransform:p}=this.component.props;p?s=p(o,s):s=s.concat(o),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:l,endRow:s.length}]}),l=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[gh];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class one extends sne{constructor({attributeManager:e,layer:n}){super(n),oe(this,"attributeManager",void 0),oe(this,"needsRedraw",void 0),oe(this,"needsUpdate",void 0),oe(this,"subLayers",void 0),oe(this,"usesPickingColorCache",void 0),oe(this,"hasPickingBuffer",void 0),oe(this,"changeFlags",void 0),oe(this,"viewport",void 0),oe(this,"uniformTransitions",void 0),oe(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r?.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const ane="layer.changeFlag",lne="layer.initialize",Ane="layer.update",une="layer.finalize",cne="layer.matched",Ok=2**24-1,hne=Object.freeze([]),fne=Om(({oldViewport:t,viewport:e})=>t.equals(e));let VA=new Uint8ClampedArray(0);const dne={data:{type:"data",value:hne,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:l}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var o;i={...i,fetch:{...(o=i)===null||o===void 0?void 0:o.fetch,signal:s}}}let p=l.contains(t);return!p&&!i&&(l.add({resourceId:t,data:U_(t,r),persistent:!1}),p=!0),p?l.subscribe({resourceId:t,onChange:_=>{var C;return(C=n.internalState)===null||C===void 0?void 0:C.reloadAsyncProp(e,_)},consumerId:n.id,requestId:e}):U_(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:fr.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class vA extends kS{constructor(...e){super(...e),oe(this,"internalState",null),oe(this,"lifecycle",w0.NO_STATE),oe(this,"context",void 0),oe(this,"state",void 0),oe(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Ui(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=cz(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,l]=az(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,l]}unproject(e){return Ui(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Ui(this.internalState);const r=this.internalState.viewport||this.context.viewport;return mJ(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===fr.DEFAULT||e===fr.LNGLAT||e===fr.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Ui(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Ute(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=J3(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,l=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(s!==l){this.internalState.hasPickingBuffer=l;const{pickingColors:o,instancePickingColors:p}=n.attributes,_=o||p;_&&(l&&_.constant&&(_.constant=!1,n.invalidate(_.id)),!_.value&&!l&&(_.constant=!0,_.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,l;(s=this.context)===null||s===void 0||(l=s.onError)===null||l===void 0||l.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!fne({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(VA.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>Ok&&or.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),VA=Td.allocate(VA,n,{size:3,copy:!0,maxCount:Math.max(n,Ok)});const i=Math.floor(VA.length/3),s=[];for(let l=r;l<i;l++)this.encodePickingColor(l,s),VA[l*3+0]=s[0],VA[l*3+1]=s[1],VA[l*3+2]=s[2]}e.value=VA.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,l=s&&n.attributes&&n.attributes[s.id];if(l&&l.value){const o=l.value,p=this.encodePickingColor(e);for(let _=0;_<n.length;_++){const C=s.getVertexOffset(_);o[C]===p[0]&&o[C+1]===p[1]&&o[C+2]===p[2]&&this._disablePickingIndex(_)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),l=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(l-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==VA.buffer&&(r.value=VA.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Ui(!this.internalState),Ui(Number.isFinite(this.props.coordinateSystem)),co(lne,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new one({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(or.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new Ite(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){co(cne,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(co(Ane,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,l=this._updateUniformTransition();i.propsInTransition=l,r.viewport=i.viewport||s,this.props=l;try{const o=this._getUpdateParams(),p=this.getModels();if(r.gl)this.updateState(o);else try{this.updateState(o)}catch{}for(const C of this.props.extensions)C.updateState.call(this,o,C);const _=this.getModels()[0]!==p[0];this._postUpdate(o,_)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){co(une,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const l=this.props.opacity;n.opacity=Math.pow(l,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:o}=this.props,p=o&&o(n)||[0,0];lc(s.gl,{polygonOffset:p}),fA(s.gl,r,()=>{const _={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const C of this.props.extensions)C.draw.call(this,_,C);this.draw(_)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const l=e[i],o=n[i];l&&Array.isArray(o)&&(n.dataChanged=Array.isArray(l)?o.concat(l):l,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&co(ane,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=Dte(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){Lte(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Ste(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s?.setInstanceCount(this.getNumInstances());const{autoHighlight:l,highlightedObjectIndex:o,highlightColor:p}=r;if(n||i.autoHighlight!==l||i.highlightedObjectIndex!==o||i.highlightColor!==p){const _={};l||(_.pickingSelectedColor=null),Array.isArray(p)&&(_.pickingHighlightColor=p),(n||o!==i.highlightedObjectIndex)&&(_.pickingSelectedColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setModuleParameters(_)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}oe(vA,"defaultProps",dne);oe(vA,"layerName","Layer");const pne="compositeLayer.renderLayers";class Vn extends vA{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:l,getPolygonOffset:o,highlightedObjectIndex:p,autoHighlight:_,highlightColor:C,coordinateSystem:M,coordinateOrigin:k,wrapLongitude:F,positionFormat:j,modelMatrix:H,extensions:ie,fetch:Y,operation:J,_subLayerProps:se}=this.props,he={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:l,getPolygonOffset:o,highlightedObjectIndex:p,autoHighlight:_,highlightColor:C,coordinateSystem:M,coordinateOrigin:k,wrapLongitude:F,positionFormat:j,modelMatrix:H,extensions:ie,fetch:Y,operation:J},pe=se&&e.id&&se[e.id],be=pe&&pe.updateTriggers,Ge=e.id||"sublayer";if(pe){const We=this.props[gh],Xe=e.type?e.type._propTypes:{};for(const rt in pe){const Oe=Xe[rt]||We[rt];Oe&&Oe.type==="accessor"&&(pe[rt]=this.getSubLayerAccessor(pe[rt]))}}Object.assign(he,e,pe),he.id="".concat(this.props.id,"-").concat(Ge),he.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...be};for(const We of ie){const Xe=We.getSubLayerProps.call(this,We);Xe&&Object.assign(he,Xe,{updateTriggers:Object.assign(he.updateTriggers,Xe.updateTriggers)})}return he}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=bf(s,Boolean),this.internalState.subLayers=r}co(pne,this,i,r);for(const s of r)s.parent=this}}oe(Vn,"layerName","CompositeLayer");const ty=Math.PI/180,Fk=180/Math.PI,qy=6370972,O0=256;function gne(){const t=O0/qy,e=Math.PI/180*O0;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class mne extends Uf{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,nearZMultiplier:s=.1,farZMultiplier:l=2,resolution:o=10}=e;let{height:p,altitude:_=1.5}=e;p=p||1,_=Math.max(.75,_);const C=new ha().lookAt({eye:[0,-_,0],up:[0,0,1]}),M=Math.pow(2,i);C.rotateX(n*ty),C.rotateZ(-r*ty),C.scale(M/p);const k=Math.atan(.5/_),F=O0*2*M/p;super({...e,height:p,viewMatrix:C,longitude:r,latitude:n,zoom:i,distanceScales:gne(),fovyRadians:k*2,focalDistance:_,near:s,far:Math.min(2,1/F+1)*_*l}),oe(this,"longitude",void 0),oe(this,"latitude",void 0),oe(this,"resolution",void 0),this.latitude=n,this.longitude=r,this.resolution=o}get projectionMode(){return iA.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,this.height/2],n),i=this.unproject([this.width/2,0],n),s=this.unproject([this.width,this.height/2],n),l=this.unproject([this.width/2,this.height],n);return s[0]<this.longitude&&(s[0]+=360),r[0]>this.longitude&&(r[0]-=360),[Math.min(r[0],s[0],i[0],l[0]),Math.min(r[1],s[1],i[1],l[1]),Math.max(r[0],s[0],i[0],l[0]),Math.max(r[1],s[1],i[1],l[1])]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,l]=e,o=n?s:this.height-s,{pixelUnprojectionMatrix:p}=this;let _;if(Number.isFinite(l))_=Nw(p,[i,o,l,1]);else{const F=Nw(p,[i,o,-1,1]),j=Nw(p,[i,o,1,1]),H=((r||0)/qy+1)*O0,ie=Cw(OB([],F,j)),Y=Cw(F),J=Cw(j),he=4*((4*Y*J-(ie-Y-J)**2)/16)/ie,pe=Math.sqrt(Y-he),be=Math.sqrt(Math.max(0,H*H-he)),Ge=(pe-be)/Math.sqrt(ie);_=wY([],F,j,Ge)}const[C,M,k]=this.unprojectPosition(_);return Number.isFinite(l)?[C,M,k]:Number.isFinite(r)?[C,M,r]:[C,M]}projectPosition(e){const[n,r,i=0]=e,s=n*ty,l=r*ty,o=Math.cos(l),p=(i/qy+1)*O0;return[Math.sin(s)*o*p,-Math.cos(s)*o*p,Math.sin(l)*p]}unprojectPosition(e){const[n,r,i]=e,s=FB(e),l=Math.asin(i/s),p=Math.atan2(n,-r)*Fk,_=l*Fk,C=(s/O0-1)*qy;return[p,_,C]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const r=this.unproject(n);return{longitude:e[0]-r[0]+this.longitude,latitude:e[1]-r[1]+this.latitude}}}function Nw(t,e){const n=Hd([],e,t);return _S(n,n,1/n[3]),n}class IS{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){oe(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&oA(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,r={updateTriggers:{}};for(const i in n)if(i in this.props){const s=n[i],l=this.props[i];r[i]=l,s&&s.type==="accessor"&&(r.updateTriggers[i]=this.props.updateTriggers[i],typeof l=="function"&&(r[i]=this.getSubLayerAccessor(l)))}return r}initializeState(e,n){}updateState(e,n){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,n){}finalizeState(e,n){}}oe(IS,"defaultProps",{});oe(IS,"extensionName","LayerExtension");const Uw={bearing:0,pitch:0,position:[0,0,0]},yne={speed:1.2,curve:1.414};class xh extends pz{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),oe(this,"opts",void 0),this.opts={...yne,...e}}interpolateProps(e,n,r){const i=QK(e,n,r,this.opts);for(const s in Uw)i[s]=wl(e[s]||Uw[s],n[s]||Uw[s],r);return i}getDuration(e,n){let{transitionDuration:r}=n;return r==="auto"&&(r=qK(e,n,this.opts)),r}}class Dz{constructor(e){oe(this,"opts",void 0),oe(this,"typedArrayManager",void 0),oe(this,"indexStarts",[0]),oe(this,"vertexStarts",[0]),oe(this,"vertexCount",0),oe(this,"instanceCount",0),oe(this,"attributes",void 0),oe(this,"_attributeDefs",void 0),oe(this,"data",void 0),oe(this,"getGeometry",void 0),oe(this,"geometryBuffer",void 0),oe(this,"buffers",void 0),oe(this,"positionSize",void 0),oe(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=Td,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:l,dataChanged:o,normalize:p=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(l==="XY"?2:3),this.buffers=r,this.normalize=p,s&&(Ui(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),p||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(o))for(const _ of o)this._rebuildGeometry(_);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?Tz(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:l}=this;for(const o in s)if(o in i)l.release(r[o]),r[o]=null;else{const p=s[o];p.copy=n,r[o]=l.allocate(r[o],e,p)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:l,objectInfo:o}=Wd(i,n,r);for(const p of l){o.index++;const _=s?s(p,o):null;e(_,o.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:l}=this,{startRow:o=0,endRow:p=1/0}=e||{},_={};if(e||(n=[0],r=[0]),this.normalize||!l)this._forEachGeometry((M,k)=>{const F=M&&this.normalizeGeometry(M);_[k]=F,r[k+1]=r[k]+(F?this.getGeometrySize(F):0)},o,p),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(l))i=i||l.length/this.positionSize;else if(l instanceof Gr){const M=l.accessor.stride||this.positionSize*4;i=i||l.byteLength/M}else if(l.buffer){const M=l.stride||this.positionSize*4;i=i||l.buffer.byteLength/M}else if(l.value){const M=l.value,k=l.stride/M.BYTES_PER_ELEMENT||this.positionSize;i=i||M.length/k}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const C={};this._forEachGeometry((M,k)=>{const F=_[k]||M;C.vertexStart=r[k],C.indexStart=n[k];const j=k<r.length-1?r[k+1]:i;C.geometrySize=j-r[k],C.geometryIndex=k,this.updateGeometryAttributes(F,C)},o,p),this.vertexCount=n[n.length-1]}}const _ne=typeof window<"u"?De.useLayoutEffect:De.useEffect,vne=_ne;function t2(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const xne={position:"absolute",zIndex:-1};function Rz(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>Rz(n,e));if(_v(t)){if(wne(t))return e.style=xne,De.cloneElement(t,e);if(bne(t))return De.cloneElement(t,e)}return t}function _v(t){return t&&typeof t=="object"&&"type"in t||!1}function wne(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function bne(t){const e=t.type;return e&&e.deckGLViewProps}function rE(t){if(typeof t=="function")return De.createElement(El,{},t);if(Array.isArray(t))return t.map(rE);if(_v(t)){if(t.type===De.Fragment)return rE(t.props.children);if(t2(t.type,El))return t}return t}function Ene({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return De.Children.forEach(rE(t),l=>{if(_v(l)){const o=l.type;if(t2(o,vA)){const p=Tne(o,l.props);i.push(p)}else r.push(l);if(t2(o,El)&&o!==El&&l.props.id){const p=new o(l.props);s[p.id]=p}}else l&&r.push(l)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(l=>{s[l.id]=l}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function Tne(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function Sne({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const l of t){let o=s,p=l;_v(l)&&t2(l.type,El)&&(o=l.props.id||s,p=l.props.children);const _=r.getViewport(o),C=r.getViewState(o);if(_){C.padding=_.padding;const{x:M,y:k,width:F,height:j}=_;p=Rz(p,{x:M,y:k,width:F,height:j,viewport:_,viewState:C}),i[o]||(i[o]={viewport:_,children:[]}),i[o].children.push(p)}}return Object.keys(i).map(l=>{const{viewport:o,children:p}=i[l],{x:_,y:C,width:M,height:k}=o,F={position:"absolute",left:_,top:C,width:M,height:k},j="view-".concat(l),H=De.createElement("div",{key:j,id:j,style:F},...p);if(n){const ie={viewport:o,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:Y=>{Y.viewId=l,e._onViewStateChange(Y)}};return De.createElement(n,{key:j,value:ie},H)}return H})}const Cne={mixBlendMode:null};function Mne({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in Cne?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function Pne(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function Bz(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function kne(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():Bz(t)}});return r}const zz=De.forwardRef((t,e)=>{const[n,r]=De.useState(0),s=De.useRef({control:null,version:n,forceUpdate:()=>r(pe=>pe+1)}).current,l=De.useRef(null),o=De.useRef(null),p=De.useMemo(()=>Ene(t),[t.layers,t.views,t.children]);let _=!0;const C=pe=>{var be;return _&&t.viewState?(s.viewStateUpdateRequested=pe,null):(s.viewStateUpdateRequested=null,(be=t.onViewStateChange)===null||be===void 0?void 0:be.call(t,pe))},M=pe=>{if(_)s.interactionStateUpdateRequested=pe;else{var be;s.interactionStateUpdateRequested=null,(be=t.onInteractionStateChange)===null||be===void 0||be.call(t,pe)}},k=De.useMemo(()=>{const pe={...t,style:null,width:"100%",height:"100%",parent:l.current,canvas:o.current,layers:p.layers,views:p.views,onViewStateChange:C,onInteractionStateChange:M};return delete pe._customRender,s.deck&&s.deck.setProps(pe),pe},[t]);De.useEffect(()=>{const pe=t.Deck||Ef;return s.deck=kne(s,pe,{...k,parent:l.current,canvas:o.current}),()=>{var be;return(be=s.deck)===null||be===void 0?void 0:be.finalize()}},[]),vne(()=>{Bz(s);const{viewStateUpdateRequested:pe,interactionStateUpdateRequested:be}=s;pe&&C(pe),be&&M(be)}),De.useImperativeHandle(e,()=>Pne(s),[]);const F=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:j,width:H,height:ie,id:Y,style:J}=t,{containerStyle:se,canvasStyle:he}=De.useMemo(()=>Mne({width:H,height:ie,style:J}),[H,ie,J]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===F||s.version!==n){s.lastRenderedViewports=F,s.version=n;const pe=Sne({children:p.children,deck:s.deck,ContextProvider:j}),be=De.createElement("canvas",{key:"canvas",id:Y||"deckgl-overlay",ref:o,style:he});s.control=De.createElement("div",{id:"".concat(Y||"deckgl","-wrapper"),ref:l,style:se},[be,pe])}return _=!1,s.control});zz.defaultProps=Ef.defaultProps;const _c=zz;var Oz={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(q9,function(){var n,r,i;function s(o,p){if(!n)n=p;else if(!r)r=p;else{var _="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",C={};n(C),i=p(C),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([_],{type:"text/javascript"})))}}s(["exports"],function(o){var p=_;function _(f,u,g,T){this.cx=3*f,this.bx=3*(g-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(T-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=u,this.p2x=g,this.p2y=T}function C(f,u,g,T){const D=new p(f,u,g,T);return function(z){return D.solve(z)}}_.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,u){if(u===void 0&&(u=1e-6),f<0)return 0;if(f>1)return 1;for(var g=f,T=0;T<8;T++){var D=this.sampleCurveX(g)-f;if(Math.abs(D)<u)return g;var z=this.sampleCurveDerivativeX(g);if(Math.abs(z)<1e-6)break;g-=D/z}var N=0,$=1;for(g=f,T=0;T<20&&(D=this.sampleCurveX(g),!(Math.abs(D-f)<u));T++)f>D?N=g:$=g,g=.5*($-N)+N;return g},solve:function(f,u){return this.sampleCurveY(this.solveCurveX(f,u))}};const M=C(.25,.1,.25,1);function k(f,u,g){return Math.min(g,Math.max(u,f))}function F(f,u,g){const T=g-u,D=((f-u)%T+T)%T+u;return D===u?g:D}function j(f,...u){for(const g of u)for(const T in g)f[T]=g[T];return f}let H=1;function ie(f,u){f.forEach(g=>{u[g]&&(u[g]=u[g].bind(u))})}function Y(f,u,g){const T={};for(const D in f)T[D]=u.call(g||this,f[D],D,f);return T}function J(f,u,g){const T={};for(const D in f)u.call(g||this,f[D],D,f)&&(T[D]=f[D]);return T}function se(f){return Array.isArray(f)?f.map(se):typeof f=="object"&&f?Y(f,se):f}const he={};function pe(f){he[f]||(typeof console<"u"&&console.warn(f),he[f]=!0)}function be(f,u,g){return(g.y-f.y)*(u.x-f.x)>(u.y-f.y)*(g.x-f.x)}function Ge(f){let u=0;for(let g,T,D=0,z=f.length,N=z-1;D<z;N=D++)g=f[D],T=f[N],u+=(T.x-g.x)*(g.y+T.y);return u}function We(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Xe(f){const u={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(g,T,D,z)=>{const N=D||z;return u[T]=!N||N.toLowerCase(),""}),u["max-age"]){const g=parseInt(u["max-age"],10);isNaN(g)?delete u["max-age"]:u["max-age"]=g}return u}let rt,Oe,nt=null;function Ze(f){if(nt==null){const u=f.navigator?f.navigator.userAgent:null;nt=!!f.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return nt}function pt(f){return typeof ImageBitmap<"u"&&f instanceof ImageBitmap}const Yt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f){const u=requestAnimationFrame(f);return{cancel:()=>cancelAnimationFrame(u)}},getImageData(f,u=0){const g=window.document.createElement("canvas"),T=g.getContext("2d");if(!T)throw new Error("failed to create canvas 2d context");return g.width=f.width,g.height=f.height,T.drawImage(f,0,0,f.width,f.height),T.getImageData(-u,-u,f.width+2*u,f.height+2*u)},resolveURL:f=>(rt||(rt=document.createElement("a")),rt.href=f,rt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Oe==null&&(Oe=matchMedia("(prefers-reduced-motion: reduce)")),Oe.matches)}};var Et=un;function un(f,u){this.x=f,this.y=u}un.prototype={clone:function(){return new un(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,u){return this.clone()._rotateAround(f,u)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var u=f.x-this.x,g=f.y-this.y;return u*u+g*g},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,u){return Math.atan2(this.x*u-this.y*f,this.x*f+this.y*u)},_matMult:function(f){var u=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=u,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var u=Math.cos(f),g=Math.sin(f),T=g*this.x+u*this.y;return this.x=u*this.x-g*this.y,this.y=T,this},_rotateAround:function(f,u){var g=Math.cos(f),T=Math.sin(f),D=u.y+T*(this.x-u.x)+g*(this.y-u.y);return this.x=u.x+g*(this.x-u.x)-T*(this.y-u.y),this.y=D,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},un.convert=function(f){return f instanceof un?f:Array.isArray(f)?new un(f[0],f[1]):f};const _t={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Tt="mapbox-tiles";let Jt,Ln,Tn=500,Ir=50;function tr(){typeof caches>"u"||Jt||(Jt=caches.open(Tt))}let ar=1/0;const pr={supported:!1,testSupport:function(f){!wt&&Mr&&(rn?Pn(f):Gn=f)}};let Gn,Mr,wt=!1,rn=!1;function Pn(f){const u=f.createTexture();f.bindTexture(f.TEXTURE_2D,u);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,Mr),f.isContextLost())return;pr.supported=!0}catch{}f.deleteTexture(u),wt=!0}typeof document<"u"&&(Mr=document.createElement("img"),Mr.onload=function(){Gn&&Pn(Gn),Gn=null,rn=!0},Mr.onerror=function(){wt=!0,Gn=null},Mr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const xt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(xt);class nr extends Error{constructor(u,g,T,D){super(`AJAXError: ${g} (${u}): ${T}`),this.status=u,this.statusText=g,this.url=T,this.body=D}}const Qn=We()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function br(f,u){const g=new AbortController,T=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Qn(),signal:g.signal});let D=!1,z=!1;return f.type==="json"&&T.headers.set("Accept","application/json"),((N,$,Z)=>{if(z)return;const re=Date.now();fetch(T).then(Ae=>Ae.ok?((ce,ge,ye)=>{(f.type==="arrayBuffer"?ce.arrayBuffer():f.type==="json"?ce.json():ce.text()).then(_e=>{z||(ge&&ye&&function(Ve,Fe,it){if(tr(),!Jt)return;const ut={status:Fe.status,statusText:Fe.statusText,headers:new Headers};Fe.headers.forEach((at,yt)=>ut.headers.set(yt,at));const tt=Xe(Fe.headers.get("Cache-Control")||"");tt["no-store"]||(tt["max-age"]&&ut.headers.set("Expires",new Date(it+1e3*tt["max-age"]).toUTCString()),new Date(ut.headers.get("Expires")).getTime()-it<42e4||function(at,yt){if(Ln===void 0)try{new Response(new ReadableStream),Ln=!0}catch{Ln=!1}Ln?yt(at.body):at.blob().then(yt)}(Fe,at=>{const yt=new Response(at,ut);tr(),Jt&&Jt.then(mt=>mt.put(function(Zt){const tn=Zt.indexOf("?");return tn<0?Zt:Zt.slice(0,tn)}(Ve.url),yt)).catch(mt=>pe(mt.message))}))}(T,ge,ye),D=!0,u(null,_e,ce.headers.get("Cache-Control"),ce.headers.get("Expires")))}).catch(_e=>{z||u(new Error(_e.message))})})(Ae,null,re):Ae.blob().then(ce=>u(new nr(Ae.status,Ae.statusText,f.url,ce)))).catch(Ae=>{Ae.code!==20&&u(new Error(Ae.message))})})(),{cancel:()=>{z=!0,D||g.abort()}}}const cr=function(f,u){if(/:\/\//.test(f.url)&&!/^https?:|^file:/.test(f.url)){if(We()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u);if(!We()){const T=f.url.substring(0,f.url.indexOf("://"));return(_t.REGISTERED_PROTOCOLS[T]||br)(f,u)}}if(!(/^file:/.test(g=f.url)||/^file:/.test(Qn())&&!/^\w+:/.test(g))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return br(f,u);if(We()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u,void 0,!0)}var g;return function(T,D){const z=new XMLHttpRequest;z.open(T.method||"GET",T.url,!0),T.type==="arrayBuffer"&&(z.responseType="arraybuffer");for(const N in T.headers)z.setRequestHeader(N,T.headers[N]);return T.type==="json"&&(z.responseType="text",z.setRequestHeader("Accept","application/json")),z.withCredentials=T.credentials==="include",z.onerror=()=>{D(new Error(z.statusText))},z.onload=()=>{if((z.status>=200&&z.status<300||z.status===0)&&z.response!==null){let N=z.response;if(T.type==="json")try{N=JSON.parse(z.response)}catch($){return D($)}D(null,N,z.getResponseHeader("Cache-Control"),z.getResponseHeader("Expires"))}else{const N=new Blob([z.response],{type:z.getResponseHeader("Content-Type")});D(new nr(z.status,z.statusText,T.url,N))}},z.send(T.body),{cancel:()=>z.abort()}}(f,u)},rr=function(f,u){return cr(j(f,{type:"arrayBuffer"}),u)};function ni(f){const u=window.document.createElement("a");return u.href=f,u.protocol===window.document.location.protocol&&u.host===window.document.location.host}const $n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ii,qn;Ii=[],qn=0;const Gi=function(f,u){if(pr.supported&&(f.headers||(f.headers={}),f.headers.accept="image/webp,*/*"),qn>=_t.MAX_PARALLEL_IMAGE_REQUESTS){const z={requestParameters:f,callback:u,cancelled:!1,cancel(){this.cancelled=!0}};return Ii.push(z),z}qn++;let g=!1;const T=()=>{if(!g)for(g=!0,qn--;Ii.length&&qn<_t.MAX_PARALLEL_IMAGE_REQUESTS;){const z=Ii.shift(),{requestParameters:N,callback:$,cancelled:Z}=z;Z||(z.cancel=Gi(N,$).cancel)}},D=rr(f,(z,N,$,Z)=>{T(),z?u(z):N&&function(re,Ae){typeof createImageBitmap=="function"?function(ce,ge){const ye=new Blob([new Uint8Array(ce)],{type:"image/png"});createImageBitmap(ye).then(_e=>{ge(null,_e)}).catch(_e=>{ge(new Error(`Could not load image because of ${_e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(re,Ae):function(ce,ge){const ye=new Image;ye.onload=()=>{ge(null,ye),URL.revokeObjectURL(ye.src),ye.onload=null,window.requestAnimationFrame(()=>{ye.src=$n})},ye.onerror=()=>ge(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _e=new Blob([new Uint8Array(ce)],{type:"image/png"});ye.src=ce.byteLength?URL.createObjectURL(_e):$n}(re,Ae)}(N,(re,Ae)=>{re!=null?u(re):Ae!=null&&u(null,Ae,{cacheControl:$,expires:Z})})});return{cancel:()=>{D.cancel(),T()}}};function vo(f,u,g){g[f]&&g[f].indexOf(u)!==-1||(g[f]=g[f]||[],g[f].push(u))}function $r(f,u,g){if(g&&g[f]){const T=g[f].indexOf(u);T!==-1&&g[f].splice(T,1)}}class Li{constructor(u,g={}){j(this,g),this.type=u}}class Ho extends Li{constructor(u,g={}){super("error",j({error:u},g))}}class As{on(u,g){return this._listeners=this._listeners||{},vo(u,g,this._listeners),this}off(u,g){return $r(u,g,this._listeners),$r(u,g,this._oneTimeListeners),this}once(u,g){return this._oneTimeListeners=this._oneTimeListeners||{},vo(u,g,this._oneTimeListeners),this}fire(u,g){typeof u=="string"&&(u=new Li(u,g||{}));const T=u.type;if(this.listens(T)){u.target=this;const D=this._listeners&&this._listeners[T]?this._listeners[T].slice():[];for(const $ of D)$.call(this,u);const z=this._oneTimeListeners&&this._oneTimeListeners[T]?this._oneTimeListeners[T].slice():[];for(const $ of z)$r(T,$,this._oneTimeListeners),$.call(this,u);const N=this._eventedParent;N&&(j(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),N.fire(u))}else u instanceof Ho&&console.error(u.error);return this}listens(u){return this._listeners&&this._listeners[u]&&this._listeners[u].length>0||this._oneTimeListeners&&this._oneTimeListeners[u]&&this._oneTimeListeners[u].length>0||this._eventedParent&&this._eventedParent.listens(u)}setEventedParent(u,g){return this._eventedParent=u,this._eventedParentData=g,this}}var ht={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class It{constructor(u,g,T,D){this.message=(u?`${u}: `:"")+T,D&&(this.identifier=D),g!=null&&g.__line__&&(this.line=g.__line__)}}function Vs(f){const u=f.value;return u?[new It(f.key,u,"constants have been deprecated as of v8")]:[]}function Ei(f,...u){for(const g of u)for(const T in g)f[T]=g[T];return f}function zn(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function $i(f){if(Array.isArray(f))return f.map($i);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const u={};for(const g in f)u[g]=$i(f[g]);return u}return zn(f)}class Di extends Error{constructor(u,g){super(g),this.message=g,this.key=u}}class Ri{constructor(u,g=[]){this.parent=u,this.bindings={};for(const[T,D]of g)this.bindings[T]=D}concat(u){return new Ri(this,u)}get(u){if(this.bindings[u])return this.bindings[u];if(this.parent)return this.parent.get(u);throw new Error(`${u} not found in scope.`)}has(u){return!!this.bindings[u]||!!this.parent&&this.parent.has(u)}}const us={kind:"null"},Lt={kind:"number"},Sn={kind:"string"},bn={kind:"boolean"},Rr={kind:"color"},Ss={kind:"object"},yn={kind:"value"},Ke={kind:"collator"},qr={kind:"formatted"},Gs={kind:"padding"},Fr={kind:"resolvedImage"};function hi(f,u){return{kind:"array",itemType:f,N:u}}function Xn(f){if(f.kind==="array"){const u=Xn(f.itemType);return typeof f.N=="number"?`array<${u}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${u}>`}return f.kind}const $s=[us,Lt,Sn,bn,Rr,qr,Ss,hi(yn),Gs,Fr];function ji(f,u){if(u.kind==="error")return null;if(f.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!ji(f.itemType,u.itemType))&&(typeof f.N!="number"||f.N===u.N))return null}else{if(f.kind===u.kind)return null;if(f.kind==="value"){for(const g of $s)if(!ji(g,u))return null}}return`Expected ${Xn(f)} but found ${Xn(u)} instead.`}function Hi(f,u){return u.some(g=>g.kind===f.kind)}function Bi(f,u){return u.some(g=>g==="null"?f===null:g==="array"?Array.isArray(f):g==="object"?f&&!Array.isArray(f)&&typeof f=="object":g===typeof f)}var cs,Nr={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function K(f){return(f=Math.round(f))<0?0:f>255?255:f}function Q(f){return K(f[f.length-1]==="%"?parseFloat(f)/100*255:parseInt(f))}function te(f){return(u=f[f.length-1]==="%"?parseFloat(f)/100:parseFloat(f))<0?0:u>1?1:u;var u}function fe(f,u,g){return g<0?g+=1:g>1&&(g-=1),6*g<1?f+(u-f)*g*6:2*g<1?u:3*g<2?f+(u-f)*(2/3-g)*6:f}try{cs={}.parseCSSColor=function(f){var u,g=f.replace(/ /g,"").toLowerCase();if(g in Nr)return Nr[g].slice();if(g[0]==="#")return g.length===4?(u=parseInt(g.substr(1),16))>=0&&u<=4095?[(3840&u)>>4|(3840&u)>>8,240&u|(240&u)>>4,15&u|(15&u)<<4,1]:null:g.length===7&&(u=parseInt(g.substr(1),16))>=0&&u<=16777215?[(16711680&u)>>16,(65280&u)>>8,255&u,1]:null;var T=g.indexOf("("),D=g.indexOf(")");if(T!==-1&&D+1===g.length){var z=g.substr(0,T),N=g.substr(T+1,D-(T+1)).split(","),$=1;switch(z){case"rgba":if(N.length!==4)return null;$=te(N.pop());case"rgb":return N.length!==3?null:[Q(N[0]),Q(N[1]),Q(N[2]),$];case"hsla":if(N.length!==4)return null;$=te(N.pop());case"hsl":if(N.length!==3)return null;var Z=(parseFloat(N[0])%360+360)%360/360,re=te(N[1]),Ae=te(N[2]),ce=Ae<=.5?Ae*(re+1):Ae+re-Ae*re,ge=2*Ae-ce;return[K(255*fe(ge,ce,Z+1/3)),K(255*fe(ge,ce,Z)),K(255*fe(ge,ce,Z-1/3)),$];default:return null}}return null}}catch{}class a{constructor(u,g,T,D=1){this.r=u,this.g=g,this.b=T,this.a=D}static parse(u){if(!u)return;if(u instanceof a)return u;if(typeof u!="string")return;const g=cs(u);return g?new a(g[0]/255*g[3],g[1]/255*g[3],g[2]/255*g[3],g[3]):void 0}toString(){const[u,g,T,D]=this.toArray();return`rgba(${Math.round(u)},${Math.round(g)},${Math.round(T)},${D})`}toArray(){const{r:u,g,b:T,a:D}=this;return D===0?[0,0,0,0]:[255*u/D,255*g/D,255*T/D,D]}}a.black=new a(0,0,0,1),a.white=new a(1,1,1,1),a.transparent=new a(0,0,0,0),a.red=new a(1,0,0,1);class G{constructor(u,g,T){this.sensitivity=u?g?"variant":"case":g?"accent":"base",this.locale=T,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(u,g){return this.collator.compare(u,g)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Le{constructor(u,g,T,D,z){this.text=u,this.image=g,this.scale=T,this.fontStack=D,this.textColor=z}}class ke{constructor(u){this.sections=u}static fromString(u){return new ke([new Le(u,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(u=>u.text.length!==0||u.image&&u.image.name.length!==0)}static factory(u){return u instanceof ke?u:ke.fromString(u)}toString(){return this.sections.length===0?"":this.sections.map(u=>u.text).join("")}}class Pe{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Pe)return u;if(typeof u=="number")return new Pe([u,u,u,u]);if(Array.isArray(u)&&!(u.length<1||u.length>4)){for(const g of u)if(typeof g!="number")return;switch(u.length){case 1:u=[u[0],u[0],u[0],u[0]];break;case 2:u=[u[0],u[1],u[0],u[1]];break;case 3:u=[u[0],u[1],u[2],u[1]]}return new Pe(u)}}toString(){return JSON.stringify(this.values)}}class Ie{constructor(u){this.name=u.name,this.available=u.available}toString(){return this.name}static fromString(u){return u?new Ie({name:u,available:!1}):null}}function qe(f,u,g,T){return typeof f=="number"&&f>=0&&f<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof g=="number"&&g>=0&&g<=255?T===void 0||typeof T=="number"&&T>=0&&T<=1?null:`Invalid rgba value [${[f,u,g,T].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof T=="number"?[f,u,g,T]:[f,u,g]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function At(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof a||f instanceof G||f instanceof ke||f instanceof Pe||f instanceof Ie)return!0;if(Array.isArray(f)){for(const u of f)if(!At(u))return!1;return!0}if(typeof f=="object"){for(const u in f)if(!At(f[u]))return!1;return!0}return!1}function Qe(f){if(f===null)return us;if(typeof f=="string")return Sn;if(typeof f=="boolean")return bn;if(typeof f=="number")return Lt;if(f instanceof a)return Rr;if(f instanceof G)return Ke;if(f instanceof ke)return qr;if(f instanceof Pe)return Gs;if(f instanceof Ie)return Fr;if(Array.isArray(f)){const u=f.length;let g;for(const T of f){const D=Qe(T);if(g){if(g===D)continue;g=yn;break}g=D}return hi(g||yn,u)}return Ss}function dt(f){const u=typeof f;return f===null?"":u==="string"||u==="number"||u==="boolean"?String(f):f instanceof a||f instanceof ke||f instanceof Pe||f instanceof Ie?f.toString():JSON.stringify(f)}class Dt{constructor(u,g){this.type=u,this.value=g}static parse(u,g){if(u.length!==2)return g.error(`'literal' expression requires exactly one argument, but found ${u.length-1} instead.`);if(!At(u[1]))return g.error("invalid value");const T=u[1];let D=Qe(T);const z=g.expectedType;return D.kind!=="array"||D.N!==0||!z||z.kind!=="array"||typeof z.N=="number"&&z.N!==0||(D=z),new Dt(D,T)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Rt{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}}const sn={string:Sn,number:Lt,boolean:bn,object:Ss};class jt{constructor(u,g){this.type=u,this.args=g}static parse(u,g){if(u.length<2)return g.error("Expected at least one argument.");let T,D=1;const z=u[0];if(z==="array"){let $,Z;if(u.length>2){const re=u[1];if(typeof re!="string"||!(re in sn)||re==="object")return g.error('The item type argument of "array" must be one of string, number, boolean',1);$=sn[re],D++}else $=yn;if(u.length>3){if(u[2]!==null&&(typeof u[2]!="number"||u[2]<0||u[2]!==Math.floor(u[2])))return g.error('The length argument to "array" must be a positive integer literal',2);Z=u[2],D++}T=hi($,Z)}else{if(!sn[z])throw new Error(`Types doesn't contain name = ${z}`);T=sn[z]}const N=[];for(;D<u.length;D++){const $=g.parse(u[D],D,yn);if(!$)return null;N.push($)}return new jt(T,N)}evaluate(u){for(let g=0;g<this.args.length;g++){const T=this.args[g].evaluate(u);if(!ji(this.type,Qe(T)))return T;if(g===this.args.length-1)throw new Rt(`Expected value to be of type ${Xn(this.type)}, but found ${Xn(Qe(T))} instead.`)}throw new Error}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const pn={"to-boolean":bn,"to-color":Rr,"to-number":Lt,"to-string":Sn};class qt{constructor(u,g){this.type=u,this.args=g}static parse(u,g){if(u.length<2)return g.error("Expected at least one argument.");const T=u[0];if(!pn[T])throw new Error(`Can't parse ${T} as it is not part of the known types`);if((T==="to-boolean"||T==="to-string")&&u.length!==2)return g.error("Expected one argument.");const D=pn[T],z=[];for(let N=1;N<u.length;N++){const $=g.parse(u[N],N,yn);if(!$)return null;z.push($)}return new qt(D,z)}evaluate(u){if(this.type.kind==="boolean")return!!this.args[0].evaluate(u);if(this.type.kind==="color"){let g,T;for(const D of this.args){if(g=D.evaluate(u),T=null,g instanceof a)return g;if(typeof g=="string"){const z=u.parseColor(g);if(z)return z}else if(Array.isArray(g)&&(T=g.length<3||g.length>4?`Invalid rbga value ${JSON.stringify(g)}: expected an array containing either three or four numeric values.`:qe(g[0],g[1],g[2],g[3]),!T))return new a(g[0]/255,g[1]/255,g[2]/255,g[3])}throw new Rt(T||`Could not parse color from value '${typeof g=="string"?g:JSON.stringify(g)}'`)}if(this.type.kind==="padding"){let g;for(const T of this.args){g=T.evaluate(u);const D=Pe.parse(g);if(D)return D}throw new Rt(`Could not parse padding from value '${typeof g=="string"?g:JSON.stringify(g)}'`)}if(this.type.kind==="number"){let g=null;for(const T of this.args){if(g=T.evaluate(u),g===null)return 0;const D=Number(g);if(!isNaN(D))return D}throw new Rt(`Could not convert ${JSON.stringify(g)} to number.`)}return this.type.kind==="formatted"?ke.fromString(dt(this.args[0].evaluate(u))):this.type.kind==="resolvedImage"?Ie.fromString(dt(this.args[0].evaluate(u))):dt(this.args[0].evaluate(u))}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const an=["Unknown","Point","LineString","Polygon"];class xn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?an[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(u){let g=this._parseColorCache[u];return g||(g=this._parseColorCache[u]=a.parse(u)),g}}class Ft{constructor(u,g,T,D){this.name=u,this.type=g,this._evaluate=T,this.args=D}evaluate(u){return this._evaluate(u,this.args)}eachChild(u){this.args.forEach(u)}outputDefined(){return!1}static parse(u,g){const T=u[0],D=Ft.definitions[T];if(!D)return g.error(`Unknown expression "${T}". If you wanted a literal array, use ["literal", [...]].`,0);const z=Array.isArray(D)?D[0]:D.type,N=Array.isArray(D)?[[D[1],D[2]]]:D.overloads,$=N.filter(([re])=>!Array.isArray(re)||re.length===u.length-1);let Z=null;for(const[re,Ae]of $){Z=new bt(g.registry,g.path,null,g.scope);const ce=[];let ge=!1;for(let ye=1;ye<u.length;ye++){const _e=u[ye],Ve=Array.isArray(re)?re[ye-1]:re.type,Fe=Z.parse(_e,1+ce.length,Ve);if(!Fe){ge=!0;break}ce.push(Fe)}if(!ge)if(Array.isArray(re)&&re.length!==ce.length)Z.error(`Expected ${re.length} arguments, but found ${ce.length} instead.`);else{for(let ye=0;ye<ce.length;ye++){const _e=Array.isArray(re)?re[ye]:re.type,Ve=ce[ye];Z.concat(ye+1).checkSubtype(_e,Ve.type)}if(Z.errors.length===0)return new Ft(T,z,Ae,ce)}}if($.length===1)g.errors.push(...Z.errors);else{const re=($.length?$:N).map(([ce])=>{return ge=ce,Array.isArray(ge)?`(${ge.map(Xn).join(", ")})`:`(${Xn(ge.type)}...)`;var ge}).join(" | "),Ae=[];for(let ce=1;ce<u.length;ce++){const ge=g.parse(u[ce],1+Ae.length);if(!ge)return null;Ae.push(Xn(ge.type))}g.error(`Expected arguments of type ${re}, but found (${Ae.join(", ")}) instead.`)}return null}static register(u,g){Ft.definitions=g;for(const T in g)u[T]=Ft}}class Ne{constructor(u,g,T){this.type=Ke,this.locale=T,this.caseSensitive=u,this.diacriticSensitive=g}static parse(u,g){if(u.length!==2)return g.error("Expected one argument.");const T=u[1];if(typeof T!="object"||Array.isArray(T))return g.error("Collator options argument must be an object.");const D=g.parse(T["case-sensitive"]!==void 0&&T["case-sensitive"],1,bn);if(!D)return null;const z=g.parse(T["diacritic-sensitive"]!==void 0&&T["diacritic-sensitive"],1,bn);if(!z)return null;let N=null;return T.locale&&(N=g.parse(T.locale,1,Sn),!N)?null:new Ne(D,z,N)}evaluate(u){return new G(this.caseSensitive.evaluate(u),this.diacriticSensitive.evaluate(u),this.locale?this.locale.evaluate(u):null)}eachChild(u){u(this.caseSensitive),u(this.diacriticSensitive),this.locale&&u(this.locale)}outputDefined(){return!1}}const Mt=8192;function Ce(f,u){f[0]=Math.min(f[0],u[0]),f[1]=Math.min(f[1],u[1]),f[2]=Math.max(f[2],u[0]),f[3]=Math.max(f[3],u[1])}function cn(f,u){return!(f[0]<=u[0]||f[2]>=u[2]||f[1]<=u[1]||f[3]>=u[3])}function fi(f,u){const g=(180+f[0])/360,T=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,D=Math.pow(2,u.z);return[Math.round(g*D*Mt),Math.round(T*D*Mt)]}function ir(f,u,g){const T=f[0]-u[0],D=f[1]-u[1],z=f[0]-g[0],N=f[1]-g[1];return T*N-z*D==0&&T*z<=0&&D*N<=0}function pa(f,u){let g=!1;for(let N=0,$=u.length;N<$;N++){const Z=u[N];for(let re=0,Ae=Z.length;re<Ae-1;re++){if(ir(f,Z[re],Z[re+1]))return!1;(D=Z[re])[1]>(T=f)[1]!=(z=Z[re+1])[1]>T[1]&&T[0]<(z[0]-D[0])*(T[1]-D[1])/(z[1]-D[1])+D[0]&&(g=!g)}}var T,D,z;return g}function Re(f,u){for(let g=0;g<u.length;g++)if(pa(f,u[g]))return!0;return!1}function Qa(f,u,g,T){const D=T[0]-g[0],z=T[1]-g[1],N=(f[0]-g[0])*z-D*(f[1]-g[1]),$=(u[0]-g[0])*z-D*(u[1]-g[1]);return N>0&&$<0||N<0&&$>0}function we(f,u,g){for(const re of g)for(let Ae=0;Ae<re.length-1;++Ae)if(($=[(N=re[Ae+1])[0]-(z=re[Ae])[0],N[1]-z[1]])[0]*(Z=[(D=u)[0]-(T=f)[0],D[1]-T[1]])[1]-$[1]*Z[0]!=0&&Qa(T,D,z,N)&&Qa(z,N,T,D))return!0;var T,D,z,N,$,Z;return!1}function Wo(f,u){for(let g=0;g<f.length;++g)if(!pa(f[g],u))return!1;for(let g=0;g<f.length-1;++g)if(we(f[g],f[g+1],u))return!1;return!0}function Cs(f,u){for(let g=0;g<u.length;g++)if(Wo(f,u[g]))return!0;return!1}function qa(f,u,g){const T=[];for(let D=0;D<f.length;D++){const z=[];for(let N=0;N<f[D].length;N++){const $=fi(f[D][N],g);Ce(u,$),z.push($)}T.push(z)}return T}function Za(f,u,g){const T=[];for(let D=0;D<f.length;D++){const z=qa(f[D],u,g);T.push(z)}return T}function ga(f,u,g,T){if(f[0]<g[0]||f[0]>g[2]){const D=.5*T;let z=f[0]-g[0]>D?-T:g[0]-f[0]>D?T:0;z===0&&(z=f[0]-g[2]>D?-T:g[2]-f[0]>D?T:0),f[0]+=z}Ce(u,f)}function Ml(f,u,g,T){const D=Math.pow(2,T.z)*Mt,z=[T.x*Mt,T.y*Mt],N=[];for(const $ of f)for(const Z of $){const re=[Z.x+z[0],Z.y+z[1]];ga(re,u,g,D),N.push(re)}return N}function ma(f,u,g,T){const D=Math.pow(2,T.z)*Mt,z=[T.x*Mt,T.y*Mt],N=[];for(const Z of f){const re=[];for(const Ae of Z){const ce=[Ae.x+z[0],Ae.y+z[1]];Ce(u,ce),re.push(ce)}N.push(re)}if(u[2]-u[0]<=D/2){($=u)[0]=$[1]=1/0,$[2]=$[3]=-1/0;for(const Z of N)for(const re of Z)ga(re,u,g,D)}var $;return N}class ri{constructor(u,g){this.type=bn,this.geojson=u,this.geometries=g}static parse(u,g){if(u.length!==2)return g.error(`'within' expression requires exactly one argument, but found ${u.length-1} instead.`);if(At(u[1])){const T=u[1];if(T.type==="FeatureCollection")for(let D=0;D<T.features.length;++D){const z=T.features[D].geometry.type;if(z==="Polygon"||z==="MultiPolygon")return new ri(T,T.features[D].geometry)}else if(T.type==="Feature"){const D=T.geometry.type;if(D==="Polygon"||D==="MultiPolygon")return new ri(T,T.geometry)}else if(T.type==="Polygon"||T.type==="MultiPolygon")return new ri(T,T)}return g.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(g,T){const D=[1/0,1/0,-1/0,-1/0],z=[1/0,1/0,-1/0,-1/0],N=g.canonicalID();if(T.type==="Polygon"){const $=qa(T.coordinates,z,N),Z=Ml(g.geometry(),D,z,N);if(!cn(D,z))return!1;for(const re of Z)if(!pa(re,$))return!1}if(T.type==="MultiPolygon"){const $=Za(T.coordinates,z,N),Z=Ml(g.geometry(),D,z,N);if(!cn(D,z))return!1;for(const re of Z)if(!Re(re,$))return!1}return!0}(u,this.geometries);if(u.geometryType()==="LineString")return function(g,T){const D=[1/0,1/0,-1/0,-1/0],z=[1/0,1/0,-1/0,-1/0],N=g.canonicalID();if(T.type==="Polygon"){const $=qa(T.coordinates,z,N),Z=ma(g.geometry(),D,z,N);if(!cn(D,z))return!1;for(const re of Z)if(!Wo(re,$))return!1}if(T.type==="MultiPolygon"){const $=Za(T.coordinates,z,N),Z=ma(g.geometry(),D,z,N);if(!cn(D,z))return!1;for(const re of Z)if(!Cs(re,$))return!1}return!0}(u,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function me(f){if(f instanceof Ft&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof ri)return!1;let u=!0;return f.eachChild(g=>{u&&!me(g)&&(u=!1)}),u}function Te(f){if(f instanceof Ft&&f.name==="feature-state")return!1;let u=!0;return f.eachChild(g=>{u&&!Te(g)&&(u=!1)}),u}function Ue(f,u){if(f instanceof Ft&&u.indexOf(f.name)>=0)return!1;let g=!0;return f.eachChild(T=>{g&&!Ue(T,u)&&(g=!1)}),g}class lt{constructor(u,g){this.type=g.type,this.name=u,this.boundExpression=g}static parse(u,g){if(u.length!==2||typeof u[1]!="string")return g.error("'var' expression requires exactly one string literal argument.");const T=u[1];return g.scope.has(T)?new lt(T,g.scope.get(T)):g.error(`Unknown variable "${T}". Make sure "${T}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(u){return this.boundExpression.evaluate(u)}eachChild(){}outputDefined(){return!1}}class bt{constructor(u,g=[],T,D=new Ri,z=[]){this.registry=u,this.path=g,this.key=g.map(N=>`[${N}]`).join(""),this.scope=D,this.errors=z,this.expectedType=T}parse(u,g,T,D,z={}){return g?this.concat(g,T,D)._parse(u,z):this._parse(u,z)}_parse(u,g){function T(D,z,N){return N==="assert"?new jt(z,[D]):N==="coerce"?new qt(z,[D]):D}if(u!==null&&typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"||(u=["literal",u]),Array.isArray(u)){if(u.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const D=u[0];if(typeof D!="string")return this.error(`Expression name must be a string, but found ${typeof D} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const z=this.registry[D];if(z){let N=z.parse(u,this);if(!N)return null;if(this.expectedType){const $=this.expectedType,Z=N.type;if($.kind!=="string"&&$.kind!=="number"&&$.kind!=="boolean"&&$.kind!=="object"&&$.kind!=="array"||Z.kind!=="value")if($.kind!=="color"&&$.kind!=="formatted"&&$.kind!=="resolvedImage"||Z.kind!=="value"&&Z.kind!=="string")if($.kind!=="padding"||Z.kind!=="value"&&Z.kind!=="number"&&Z.kind!=="array"){if(this.checkSubtype($,Z))return null}else N=T(N,$,g.typeAnnotation||"coerce");else N=T(N,$,g.typeAnnotation||"coerce");else N=T(N,$,g.typeAnnotation||"assert")}if(!(N instanceof Dt)&&N.type.kind!=="resolvedImage"&&Qt(N)){const $=new xn;try{N=new Dt(N.type,N.evaluate($))}catch(Z){return this.error(Z.message),null}}return N}return this.error(`Unknown expression "${D}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(u===void 0?"'undefined' value invalid. Use null instead.":typeof u=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof u} instead.`)}concat(u,g,T){const D=typeof u=="number"?this.path.concat(u):this.path,z=T?this.scope.concat(T):this.scope;return new bt(this.registry,D,g||null,z,this.errors)}error(u,...g){const T=`${this.key}${g.map(D=>`[${D}]`).join("")}`;this.errors.push(new Di(T,u))}checkSubtype(u,g){const T=ji(u,g);return T&&this.error(T),T}}function Qt(f){if(f instanceof lt)return Qt(f.boundExpression);if(f instanceof Ft&&f.name==="error"||f instanceof Ne||f instanceof ri)return!1;const u=f instanceof qt||f instanceof jt;let g=!0;return f.eachChild(T=>{g=u?g&&Qt(T):g&&T instanceof Dt}),!!g&&me(f)&&Ue(f,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Dn(f,u){const g=f.length-1;let T,D,z=0,N=g,$=0;for(;z<=N;)if($=Math.floor((z+N)/2),T=f[$],D=f[$+1],T<=u){if($===g||u<D)return $;z=$+1}else{if(!(T>u))throw new Rt("Input is not a number.");N=$-1}return 0}class Dr{constructor(u,g,T){this.type=u,this.input=g,this.labels=[],this.outputs=[];for(const[D,z]of T)this.labels.push(D),this.outputs.push(z)}static parse(u,g){if(u.length-1<4)return g.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return g.error("Expected an even number of arguments.");const T=g.parse(u[1],1,Lt);if(!T)return null;const D=[];let z=null;g.expectedType&&g.expectedType.kind!=="value"&&(z=g.expectedType);for(let N=1;N<u.length;N+=2){const $=N===1?-1/0:u[N],Z=u[N+1],re=N,Ae=N+1;if(typeof $!="number")return g.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',re);if(D.length&&D[D.length-1][0]>=$)return g.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',re);const ce=g.parse(Z,Ae,z);if(!ce)return null;z=z||ce.type,D.push([$,ce])}return new Dr(z,T,D)}evaluate(u){const g=this.labels,T=this.outputs;if(g.length===1)return T[0].evaluate(u);const D=this.input.evaluate(u);if(D<=g[0])return T[0].evaluate(u);const z=g.length;return D>=g[z-1]?T[z-1].evaluate(u):T[Dn(g,D)].evaluate(u)}eachChild(u){u(this.input);for(const g of this.outputs)u(g)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function en(f,u,g){return f*(1-g)+u*g}var Br=Object.freeze({__proto__:null,number:en,color:function(f,u,g){return new a(en(f.r,u.r,g),en(f.g,u.g,g),en(f.b,u.b,g),en(f.a,u.a,g))},array:function(f,u,g){return f.map((T,D)=>en(T,u[D],g))},padding:function(f,u,g){const T=f.values,D=u.values;return new Pe([en(T[0],D[0],g),en(T[1],D[1],g),en(T[2],D[2],g),en(T[3],D[3],g)])}});const jn=.95047,TA=1.08883,SA=4/29,CA=6/29,au=3*CA*CA,lu=Math.PI/180,MA=180/Math.PI;function Pl(f){return f>.008856451679035631?Math.pow(f,1/3):f/au+SA}function kl(f){return f>CA?f*f*f:au*(f-SA)}function PA(f){return 255*(f<=.0031308?12.92*f:1.055*Math.pow(f,1/2.4)-.055)}function kA(f){return(f/=255)<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function Kn(f){const u=kA(f.r),g=kA(f.g),T=kA(f.b),D=Pl((.4124564*u+.3575761*g+.1804375*T)/jn),z=Pl((.2126729*u+.7151522*g+.072175*T)/1);return{l:116*z-16,a:500*(D-z),b:200*(z-Pl((.0193339*u+.119192*g+.9503041*T)/TA)),alpha:f.a}}function Au(f){let u=(f.l+16)/116,g=isNaN(f.a)?u:u+f.a/500,T=isNaN(f.b)?u:u-f.b/200;return u=1*kl(u),g=jn*kl(g),T=TA*kl(T),new a(PA(3.2404542*g-1.5371385*u-.4985314*T),PA(-.969266*g+1.8760108*u+.041556*T),PA(.0556434*g-.2040259*u+1.0572252*T),f.alpha)}function xc(f,u,g){const T=u-f;return f+g*(T>180||T<-180?T-360*Math.round(T/360):T)}const Il={forward:Kn,reverse:Au,interpolate:function(f,u,g){return{l:en(f.l,u.l,g),a:en(f.a,u.a,g),b:en(f.b,u.b,g),alpha:en(f.alpha,u.alpha,g)}}},Zr={forward:function(f){const{l:u,a:g,b:T}=Kn(f),D=Math.atan2(T,g)*MA;return{h:D<0?D+360:D,c:Math.sqrt(g*g+T*T),l:u,alpha:f.a}},reverse:function(f){const u=f.h*lu,g=f.c;return Au({l:f.l,a:Math.cos(u)*g,b:Math.sin(u)*g,alpha:f.alpha})},interpolate:function(f,u,g){return{h:xc(f.h,u.h,g),c:en(f.c,u.c,g),l:en(f.l,u.l,g),alpha:en(f.alpha,u.alpha,g)}}};var Qo=Object.freeze({__proto__:null,lab:Il,hcl:Zr});class On{constructor(u,g,T,D,z){this.type=u,this.operator=g,this.interpolation=T,this.input=D,this.labels=[],this.outputs=[];for(const[N,$]of z)this.labels.push(N),this.outputs.push($)}static interpolationFactor(u,g,T,D){let z=0;if(u.name==="exponential")z=Ms(g,u.base,T,D);else if(u.name==="linear")z=Ms(g,1,T,D);else if(u.name==="cubic-bezier"){const N=u.controlPoints;z=new p(N[0],N[1],N[2],N[3]).solve(Ms(g,1,T,D))}return z}static parse(u,g){let[T,D,z,...N]=u;if(!Array.isArray(D)||D.length===0)return g.error("Expected an interpolation type expression.",1);if(D[0]==="linear")D={name:"linear"};else if(D[0]==="exponential"){const re=D[1];if(typeof re!="number")return g.error("Exponential interpolation requires a numeric base.",1,1);D={name:"exponential",base:re}}else{if(D[0]!=="cubic-bezier")return g.error(`Unknown interpolation type ${String(D[0])}`,1,0);{const re=D.slice(1);if(re.length!==4||re.some(Ae=>typeof Ae!="number"||Ae<0||Ae>1))return g.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);D={name:"cubic-bezier",controlPoints:re}}}if(u.length-1<4)return g.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return g.error("Expected an even number of arguments.");if(z=g.parse(z,2,Lt),!z)return null;const $=[];let Z=null;T==="interpolate-hcl"||T==="interpolate-lab"?Z=Rr:g.expectedType&&g.expectedType.kind!=="value"&&(Z=g.expectedType);for(let re=0;re<N.length;re+=2){const Ae=N[re],ce=N[re+1],ge=re+3,ye=re+4;if(typeof Ae!="number")return g.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ge);if($.length&&$[$.length-1][0]>=Ae)return g.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ge);const _e=g.parse(ce,ye,Z);if(!_e)return null;Z=Z||_e.type,$.push([Ae,_e])}return Z.kind==="number"||Z.kind==="color"||Z.kind==="padding"||Z.kind==="array"&&Z.itemType.kind==="number"&&typeof Z.N=="number"?new On(Z,T,D,z,$):g.error(`Type ${Xn(Z)} is not interpolatable.`)}evaluate(u){const g=this.labels,T=this.outputs;if(g.length===1)return T[0].evaluate(u);const D=this.input.evaluate(u);if(D<=g[0])return T[0].evaluate(u);const z=g.length;if(D>=g[z-1])return T[z-1].evaluate(u);const N=Dn(g,D),$=On.interpolationFactor(this.interpolation,D,g[N],g[N+1]),Z=T[N].evaluate(u),re=T[N+1].evaluate(u);return this.operator==="interpolate"?Br[this.type.kind.toLowerCase()](Z,re,$):this.operator==="interpolate-hcl"?Zr.reverse(Zr.interpolate(Zr.forward(Z),Zr.forward(re),$)):Il.reverse(Il.interpolate(Il.forward(Z),Il.forward(re),$))}eachChild(u){u(this.input);for(const g of this.outputs)u(g)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function Ms(f,u,g,T){const D=T-g,z=f-g;return D===0?0:u===1?z/D:(Math.pow(u,z)-1)/(Math.pow(u,D)-1)}class ii{constructor(u,g){this.type=u,this.args=g}static parse(u,g){if(u.length<2)return g.error("Expectected at least one argument.");let T=null;const D=g.expectedType;D&&D.kind!=="value"&&(T=D);const z=[];for(const $ of u.slice(1)){const Z=g.parse($,1+z.length,T,void 0,{typeAnnotation:"omit"});if(!Z)return null;T=T||Z.type,z.push(Z)}if(!T)throw new Error("No output type");const N=D&&z.some($=>ji(D,$.type));return new ii(N?yn:T,z)}evaluate(u){let g,T=null,D=0;for(const z of this.args)if(D++,T=z.evaluate(u),T&&T instanceof Ie&&!T.available&&(g||(g=T.name),T=null,D===this.args.length&&(T=g)),T!==null)break;return T}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}class xo{constructor(u,g){this.type=g.type,this.bindings=[].concat(u),this.result=g}evaluate(u){return this.result.evaluate(u)}eachChild(u){for(const g of this.bindings)u(g[1]);u(this.result)}static parse(u,g){if(u.length<4)return g.error(`Expected at least 3 arguments, but found ${u.length-1} instead.`);const T=[];for(let z=1;z<u.length-1;z+=2){const N=u[z];if(typeof N!="string")return g.error(`Expected string, but found ${typeof N} instead.`,z);if(/[^a-zA-Z0-9_]/.test(N))return g.error("Variable names must contain only alphanumeric characters or '_'.",z);const $=g.parse(u[z+1],z+1);if(!$)return null;T.push([N,$])}const D=g.parse(u[u.length-1],u.length-1,g.expectedType,T);return D?new xo(T,D):null}outputDefined(){return this.result.outputDefined()}}class Ll{constructor(u,g,T){this.type=u,this.index=g,this.input=T}static parse(u,g){if(u.length!==3)return g.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const T=g.parse(u[1],1,Lt),D=g.parse(u[2],2,hi(g.expectedType||yn));return T&&D?new Ll(D.type.itemType,T,D):null}evaluate(u){const g=this.index.evaluate(u),T=this.input.evaluate(u);if(g<0)throw new Rt(`Array index out of bounds: ${g} < 0.`);if(g>=T.length)throw new Rt(`Array index out of bounds: ${g} > ${T.length-1}.`);if(g!==Math.floor(g))throw new Rt(`Array index must be an integer, but found ${g} instead.`);return T[g]}eachChild(u){u(this.index),u(this.input)}outputDefined(){return!1}}class qo{constructor(u,g){this.type=bn,this.needle=u,this.haystack=g}static parse(u,g){if(u.length!==3)return g.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const T=g.parse(u[1],1,yn),D=g.parse(u[2],2,yn);return T&&D?Hi(T.type,[bn,Sn,Lt,us,yn])?new qo(T,D):g.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(T.type)} instead`):null}evaluate(u){const g=this.needle.evaluate(u),T=this.haystack.evaluate(u);if(!T)return!1;if(!Bi(g,["boolean","string","number","null"]))throw new Rt(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(Qe(g))} instead.`);if(!Bi(T,["string","array"]))throw new Rt(`Expected second argument to be of type array or string, but found ${Xn(Qe(T))} instead.`);return T.indexOf(g)>=0}eachChild(u){u(this.needle),u(this.haystack)}outputDefined(){return!0}}class ya{constructor(u,g,T){this.type=Lt,this.needle=u,this.haystack=g,this.fromIndex=T}static parse(u,g){if(u.length<=2||u.length>=5)return g.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const T=g.parse(u[1],1,yn),D=g.parse(u[2],2,yn);if(!T||!D)return null;if(!Hi(T.type,[bn,Sn,Lt,us,yn]))return g.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(T.type)} instead`);if(u.length===4){const z=g.parse(u[3],3,Lt);return z?new ya(T,D,z):null}return new ya(T,D)}evaluate(u){const g=this.needle.evaluate(u),T=this.haystack.evaluate(u);if(!Bi(g,["boolean","string","number","null"]))throw new Rt(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(Qe(g))} instead.`);if(!Bi(T,["string","array"]))throw new Rt(`Expected second argument to be of type array or string, but found ${Xn(Qe(T))} instead.`);if(this.fromIndex){const D=this.fromIndex.evaluate(u);return T.indexOf(g,D)}return T.indexOf(g)}eachChild(u){u(this.needle),u(this.haystack),this.fromIndex&&u(this.fromIndex)}outputDefined(){return!1}}class wo{constructor(u,g,T,D,z,N){this.inputType=u,this.type=g,this.input=T,this.cases=D,this.outputs=z,this.otherwise=N}static parse(u,g){if(u.length<5)return g.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if(u.length%2!=1)return g.error("Expected an even number of arguments.");let T,D;g.expectedType&&g.expectedType.kind!=="value"&&(D=g.expectedType);const z={},N=[];for(let re=2;re<u.length-1;re+=2){let Ae=u[re];const ce=u[re+1];Array.isArray(Ae)||(Ae=[Ae]);const ge=g.concat(re);if(Ae.length===0)return ge.error("Expected at least one branch label.");for(const _e of Ae){if(typeof _e!="number"&&typeof _e!="string")return ge.error("Branch labels must be numbers or strings.");if(typeof _e=="number"&&Math.abs(_e)>Number.MAX_SAFE_INTEGER)return ge.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof _e=="number"&&Math.floor(_e)!==_e)return ge.error("Numeric branch labels must be integer values.");if(T){if(ge.checkSubtype(T,Qe(_e)))return null}else T=Qe(_e);if(z[String(_e)]!==void 0)return ge.error("Branch labels must be unique.");z[String(_e)]=N.length}const ye=g.parse(ce,re,D);if(!ye)return null;D=D||ye.type,N.push(ye)}const $=g.parse(u[1],1,yn);if(!$)return null;const Z=g.parse(u[u.length-1],u.length-1,D);return Z?$.type.kind!=="value"&&g.concat(1).checkSubtype(T,$.type)?null:new wo(T,D,$,z,N,Z):null}evaluate(u){const g=this.input.evaluate(u);return(Qe(g)===this.inputType&&this.outputs[this.cases[g]]||this.otherwise).evaluate(u)}eachChild(u){u(this.input),this.outputs.forEach(u),u(this.otherwise)}outputDefined(){return this.outputs.every(u=>u.outputDefined())&&this.otherwise.outputDefined()}}class IA{constructor(u,g,T){this.type=u,this.branches=g,this.otherwise=T}static parse(u,g){if(u.length<4)return g.error(`Expected at least 3 arguments, but found only ${u.length-1}.`);if(u.length%2!=0)return g.error("Expected an odd number of arguments.");let T;g.expectedType&&g.expectedType.kind!=="value"&&(T=g.expectedType);const D=[];for(let N=1;N<u.length-1;N+=2){const $=g.parse(u[N],N,bn);if(!$)return null;const Z=g.parse(u[N+1],N+1,T);if(!Z)return null;D.push([$,Z]),T=T||Z.type}const z=g.parse(u[u.length-1],u.length-1,T);if(!z)return null;if(!T)throw new Error("Can't infer output type");return new IA(T,D,z)}evaluate(u){for(const[g,T]of this.branches)if(g.evaluate(u))return T.evaluate(u);return this.otherwise.evaluate(u)}eachChild(u){for(const[g,T]of this.branches)u(g),u(T);u(this.otherwise)}outputDefined(){return this.branches.every(([u,g])=>g.outputDefined())&&this.otherwise.outputDefined()}}class Ya{constructor(u,g,T,D){this.type=u,this.input=g,this.beginIndex=T,this.endIndex=D}static parse(u,g){if(u.length<=2||u.length>=5)return g.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const T=g.parse(u[1],1,yn),D=g.parse(u[2],2,Lt);if(!T||!D)return null;if(!Hi(T.type,[hi(yn),Sn,yn]))return g.error(`Expected first argument to be of type array or string, but found ${Xn(T.type)} instead`);if(u.length===4){const z=g.parse(u[3],3,Lt);return z?new Ya(T.type,T,D,z):null}return new Ya(T.type,T,D)}evaluate(u){const g=this.input.evaluate(u),T=this.beginIndex.evaluate(u);if(!Bi(g,["string","array"]))throw new Rt(`Expected first argument to be of type array or string, but found ${Xn(Qe(g))} instead.`);if(this.endIndex){const D=this.endIndex.evaluate(u);return g.slice(T,D)}return g.slice(T)}eachChild(u){u(this.input),u(this.beginIndex),this.endIndex&&u(this.endIndex)}outputDefined(){return!1}}function Zo(f,u){return f==="=="||f==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function Wi(f,u,g,T){return T.compare(u,g)===0}function Qi(f,u,g){const T=f!=="=="&&f!=="!=";return class Fz{constructor(z,N,$){this.type=bn,this.lhs=z,this.rhs=N,this.collator=$,this.hasUntypedArgument=z.type.kind==="value"||N.type.kind==="value"}static parse(z,N){if(z.length!==3&&z.length!==4)return N.error("Expected two or three arguments.");const $=z[0];let Z=N.parse(z[1],1,yn);if(!Z)return null;if(!Zo($,Z.type))return N.concat(1).error(`"${$}" comparisons are not supported for type '${Xn(Z.type)}'.`);let re=N.parse(z[2],2,yn);if(!re)return null;if(!Zo($,re.type))return N.concat(2).error(`"${$}" comparisons are not supported for type '${Xn(re.type)}'.`);if(Z.type.kind!==re.type.kind&&Z.type.kind!=="value"&&re.type.kind!=="value")return N.error(`Cannot compare types '${Xn(Z.type)}' and '${Xn(re.type)}'.`);T&&(Z.type.kind==="value"&&re.type.kind!=="value"?Z=new jt(re.type,[Z]):Z.type.kind!=="value"&&re.type.kind==="value"&&(re=new jt(Z.type,[re])));let Ae=null;if(z.length===4){if(Z.type.kind!=="string"&&re.type.kind!=="string"&&Z.type.kind!=="value"&&re.type.kind!=="value")return N.error("Cannot use collator to compare non-string types.");if(Ae=N.parse(z[3],3,Ke),!Ae)return null}return new Fz(Z,re,Ae)}evaluate(z){const N=this.lhs.evaluate(z),$=this.rhs.evaluate(z);if(T&&this.hasUntypedArgument){const Z=Qe(N),re=Qe($);if(Z.kind!==re.kind||Z.kind!=="string"&&Z.kind!=="number")throw new Rt(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${Z.kind}, ${re.kind}) instead.`)}if(this.collator&&!T&&this.hasUntypedArgument){const Z=Qe(N),re=Qe($);if(Z.kind!=="string"||re.kind!=="string")return u(z,N,$)}return this.collator?g(z,N,$,this.collator.evaluate(z)):u(z,N,$)}eachChild(z){z(this.lhs),z(this.rhs),this.collator&&z(this.collator)}outputDefined(){return!0}}}const uu=Qi("==",function(f,u,g){return u===g},Wi),Dl=Qi("!=",function(f,u,g){return u!==g},function(f,u,g,T){return!Wi(0,u,g,T)}),bo=Qi("<",function(f,u,g){return u<g},function(f,u,g,T){return T.compare(u,g)<0}),Yo=Qi(">",function(f,u,g){return u>g},function(f,u,g,T){return T.compare(u,g)>0}),wc=Qi("<=",function(f,u,g){return u<=g},function(f,u,g,T){return T.compare(u,g)<=0}),cu=Qi(">=",function(f,u,g){return u>=g},function(f,u,g,T){return T.compare(u,g)>=0});class Rl{constructor(u,g,T,D,z){this.type=Sn,this.number=u,this.locale=g,this.currency=T,this.minFractionDigits=D,this.maxFractionDigits=z}static parse(u,g){if(u.length!==3)return g.error("Expected two arguments.");const T=g.parse(u[1],1,Lt);if(!T)return null;const D=u[2];if(typeof D!="object"||Array.isArray(D))return g.error("NumberFormat options argument must be an object.");let z=null;if(D.locale&&(z=g.parse(D.locale,1,Sn),!z))return null;let N=null;if(D.currency&&(N=g.parse(D.currency,1,Sn),!N))return null;let $=null;if(D["min-fraction-digits"]&&($=g.parse(D["min-fraction-digits"],1,Lt),!$))return null;let Z=null;return D["max-fraction-digits"]&&(Z=g.parse(D["max-fraction-digits"],1,Lt),!Z)?null:new Rl(T,z,N,$,Z)}evaluate(u){return new Intl.NumberFormat(this.locale?this.locale.evaluate(u):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(u):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(u):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(u):void 0}).format(this.number.evaluate(u))}eachChild(u){u(this.number),this.locale&&u(this.locale),this.currency&&u(this.currency),this.minFractionDigits&&u(this.minFractionDigits),this.maxFractionDigits&&u(this.maxFractionDigits)}outputDefined(){return!1}}class LA{constructor(u){this.type=qr,this.sections=u}static parse(u,g){if(u.length<2)return g.error("Expected at least one argument.");const T=u[1];if(!Array.isArray(T)&&typeof T=="object")return g.error("First argument must be an image or text section.");const D=[];let z=!1;for(let N=1;N<=u.length-1;++N){const $=u[N];if(z&&typeof $=="object"&&!Array.isArray($)){z=!1;let Z=null;if($["font-scale"]&&(Z=g.parse($["font-scale"],1,Lt),!Z))return null;let re=null;if($["text-font"]&&(re=g.parse($["text-font"],1,hi(Sn)),!re))return null;let Ae=null;if($["text-color"]&&(Ae=g.parse($["text-color"],1,Rr),!Ae))return null;const ce=D[D.length-1];ce.scale=Z,ce.font=re,ce.textColor=Ae}else{const Z=g.parse(u[N],1,yn);if(!Z)return null;const re=Z.type.kind;if(re!=="string"&&re!=="value"&&re!=="null"&&re!=="resolvedImage")return g.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");z=!0,D.push({content:Z,scale:null,font:null,textColor:null})}}return new LA(D)}evaluate(u){return new ke(this.sections.map(g=>{const T=g.content.evaluate(u);return Qe(T)===Fr?new Le("",T,null,null,null):new Le(dt(T),null,g.scale?g.scale.evaluate(u):null,g.font?g.font.evaluate(u).join(","):null,g.textColor?g.textColor.evaluate(u):null)}))}eachChild(u){for(const g of this.sections)u(g.content),g.scale&&u(g.scale),g.font&&u(g.font),g.textColor&&u(g.textColor)}outputDefined(){return!1}}class hu{constructor(u){this.type=Fr,this.input=u}static parse(u,g){if(u.length!==2)return g.error("Expected two arguments.");const T=g.parse(u[1],1,Sn);return T?new hu(T):g.error("No image name provided.")}evaluate(u){const g=this.input.evaluate(u),T=Ie.fromString(g);return T&&u.availableImages&&(T.available=u.availableImages.indexOf(g)>-1),T}eachChild(u){u(this.input)}outputDefined(){return!1}}class Xo{constructor(u){this.type=Lt,this.input=u}static parse(u,g){if(u.length!==2)return g.error(`Expected 1 argument, but found ${u.length-1} instead.`);const T=g.parse(u[1],1);return T?T.type.kind!=="array"&&T.type.kind!=="string"&&T.type.kind!=="value"?g.error(`Expected argument of type string or array, but found ${Xn(T.type)} instead.`):new Xo(T):null}evaluate(u){const g=this.input.evaluate(u);if(typeof g=="string"||Array.isArray(g))return g.length;throw new Rt(`Expected value to be of type string or array, but found ${Xn(Qe(g))} instead.`)}eachChild(u){u(this.input)}outputDefined(){return!1}}const Xa={"==":uu,"!=":Dl,">":Yo,"<":bo,">=":cu,"<=":wc,array:jt,at:Ll,boolean:jt,case:IA,coalesce:ii,collator:Ne,format:LA,image:hu,in:qo,"index-of":ya,interpolate:On,"interpolate-hcl":On,"interpolate-lab":On,length:Xo,let:xo,literal:Dt,match:wo,number:jt,"number-format":Rl,object:jt,slice:Ya,step:Dr,string:jt,"to-boolean":qt,"to-color":qt,"to-number":qt,"to-string":qt,var:lt,within:ri};function fu(f,[u,g,T,D]){u=u.evaluate(f),g=g.evaluate(f),T=T.evaluate(f);const z=D?D.evaluate(f):1,N=qe(u,g,T,z);if(N)throw new Rt(N);return new a(u/255*z,g/255*z,T/255*z,z)}function du(f,u){return f in u}function Eo(f,u){const g=u[f];return g===void 0?null:g}function _a(f){return{type:f}}function pu(f){return{result:"success",value:f}}function va(f){return{result:"error",value:f}}function gr(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function js(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function Hn(f){return!!f.expression&&f.expression.interpolated}function Zn(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function Tr(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function _r(f){return f}function Bl(f,u){const g=u.type==="color",T=f.stops&&typeof f.stops[0][0]=="object",D=T||!(T||f.property!==void 0),z=f.type||(Hn(u)?"exponential":"interval");if(g||u.type==="padding"){const re=g?a.parse:Pe.parse;(f=Ei({},f)).stops&&(f.stops=f.stops.map(Ae=>[Ae[0],re(Ae[1])])),f.default=re(f.default?f.default:u.default)}if(f.colorSpace&&f.colorSpace!=="rgb"&&!Qo[f.colorSpace])throw new Error(`Unknown color space: ${f.colorSpace}`);let N,$,Z;if(z==="exponential")N=Ec;else if(z==="interval")N=Ka;else if(z==="categorical"){N=bc,$=Object.create(null);for(const re of f.stops)$[re[0]]=re[1];Z=typeof f.stops[0][0]}else{if(z!=="identity")throw new Error(`Unknown function type "${z}"`);N=gu}if(T){const re={},Ae=[];for(let ye=0;ye<f.stops.length;ye++){const _e=f.stops[ye],Ve=_e[0].zoom;re[Ve]===void 0&&(re[Ve]={zoom:Ve,type:f.type,property:f.property,default:f.default,stops:[]},Ae.push(Ve)),re[Ve].stops.push([_e[0].value,_e[1]])}const ce=[];for(const ye of Ae)ce.push([re[ye].zoom,Bl(re[ye],u)]);const ge={name:"linear"};return{kind:"composite",interpolationType:ge,interpolationFactor:On.interpolationFactor.bind(void 0,ge),zoomStops:ce.map(ye=>ye[0]),evaluate:({zoom:ye},_e)=>Ec({stops:ce,base:f.base},u,ye).evaluate(ye,_e)}}if(D){const re=z==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:re,interpolationFactor:On.interpolationFactor.bind(void 0,re),zoomStops:f.stops.map(Ae=>Ae[0]),evaluate:({zoom:Ae})=>N(f,u,Ae,$,Z)}}return{kind:"source",evaluate(re,Ae){const ce=Ae&&Ae.properties?Ae.properties[f.property]:void 0;return ce===void 0?Ko(f.default,u.default):N(f,u,ce,$,Z)}}}function Ko(f,u,g){return f!==void 0?f:u!==void 0?u:g!==void 0?g:void 0}function bc(f,u,g,T,D){return Ko(typeof g===D?T[g]:void 0,f.default,u.default)}function Ka(f,u,g){if(Zn(g)!=="number")return Ko(f.default,u.default);const T=f.stops.length;if(T===1||g<=f.stops[0][0])return f.stops[0][1];if(g>=f.stops[T-1][0])return f.stops[T-1][1];const D=Dn(f.stops.map(z=>z[0]),g);return f.stops[D][1]}function Ec(f,u,g){const T=f.base!==void 0?f.base:1;if(Zn(g)!=="number")return Ko(f.default,u.default);const D=f.stops.length;if(D===1||g<=f.stops[0][0])return f.stops[0][1];if(g>=f.stops[D-1][0])return f.stops[D-1][1];const z=Dn(f.stops.map(Ae=>Ae[0]),g),N=function(Ae,ce,ge,ye){const _e=ye-ge,Ve=Ae-ge;return _e===0?0:ce===1?Ve/_e:(Math.pow(ce,Ve)-1)/(Math.pow(ce,_e)-1)}(g,T,f.stops[z][0],f.stops[z+1][0]),$=f.stops[z][1],Z=f.stops[z+1][1];let re=Br[u.type]||_r;if(f.colorSpace&&f.colorSpace!=="rgb"){const Ae=Qo[f.colorSpace];re=(ce,ge)=>Ae.reverse(Ae.interpolate(Ae.forward(ce),Ae.forward(ge),N))}return typeof $.evaluate=="function"?{evaluate(...Ae){const ce=$.evaluate.apply(void 0,Ae),ge=Z.evaluate.apply(void 0,Ae);if(ce!==void 0&&ge!==void 0)return re(ce,ge,N)}}:re($,Z,N)}function gu(f,u,g){switch(u.type){case"color":g=a.parse(g);break;case"formatted":g=ke.fromString(g.toString());break;case"resolvedImage":g=Ie.fromString(g.toString());break;case"padding":g=Pe.parse(g);break;default:Zn(g)===u.type||u.type==="enum"&&u.values[g]||(g=void 0)}return Ko(g,f.default,u.default)}Ft.register(Xa,{error:[{kind:"error"},[Sn],(f,[u])=>{throw new Rt(u.evaluate(f))}],typeof:[Sn,[yn],(f,[u])=>Xn(Qe(u.evaluate(f)))],"to-rgba":[hi(Lt,4),[Rr],(f,[u])=>u.evaluate(f).toArray()],rgb:[Rr,[Lt,Lt,Lt],fu],rgba:[Rr,[Lt,Lt,Lt,Lt],fu],has:{type:bn,overloads:[[[Sn],(f,[u])=>du(u.evaluate(f),f.properties())],[[Sn,Ss],(f,[u,g])=>du(u.evaluate(f),g.evaluate(f))]]},get:{type:yn,overloads:[[[Sn],(f,[u])=>Eo(u.evaluate(f),f.properties())],[[Sn,Ss],(f,[u,g])=>Eo(u.evaluate(f),g.evaluate(f))]]},"feature-state":[yn,[Sn],(f,[u])=>Eo(u.evaluate(f),f.featureState||{})],properties:[Ss,[],f=>f.properties()],"geometry-type":[Sn,[],f=>f.geometryType()],id:[yn,[],f=>f.id()],zoom:[Lt,[],f=>f.globals.zoom],"heatmap-density":[Lt,[],f=>f.globals.heatmapDensity||0],"line-progress":[Lt,[],f=>f.globals.lineProgress||0],accumulated:[yn,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[Lt,_a(Lt),(f,u)=>{let g=0;for(const T of u)g+=T.evaluate(f);return g}],"*":[Lt,_a(Lt),(f,u)=>{let g=1;for(const T of u)g*=T.evaluate(f);return g}],"-":{type:Lt,overloads:[[[Lt,Lt],(f,[u,g])=>u.evaluate(f)-g.evaluate(f)],[[Lt],(f,[u])=>-u.evaluate(f)]]},"/":[Lt,[Lt,Lt],(f,[u,g])=>u.evaluate(f)/g.evaluate(f)],"%":[Lt,[Lt,Lt],(f,[u,g])=>u.evaluate(f)%g.evaluate(f)],ln2:[Lt,[],()=>Math.LN2],pi:[Lt,[],()=>Math.PI],e:[Lt,[],()=>Math.E],"^":[Lt,[Lt,Lt],(f,[u,g])=>Math.pow(u.evaluate(f),g.evaluate(f))],sqrt:[Lt,[Lt],(f,[u])=>Math.sqrt(u.evaluate(f))],log10:[Lt,[Lt],(f,[u])=>Math.log(u.evaluate(f))/Math.LN10],ln:[Lt,[Lt],(f,[u])=>Math.log(u.evaluate(f))],log2:[Lt,[Lt],(f,[u])=>Math.log(u.evaluate(f))/Math.LN2],sin:[Lt,[Lt],(f,[u])=>Math.sin(u.evaluate(f))],cos:[Lt,[Lt],(f,[u])=>Math.cos(u.evaluate(f))],tan:[Lt,[Lt],(f,[u])=>Math.tan(u.evaluate(f))],asin:[Lt,[Lt],(f,[u])=>Math.asin(u.evaluate(f))],acos:[Lt,[Lt],(f,[u])=>Math.acos(u.evaluate(f))],atan:[Lt,[Lt],(f,[u])=>Math.atan(u.evaluate(f))],min:[Lt,_a(Lt),(f,u)=>Math.min(...u.map(g=>g.evaluate(f)))],max:[Lt,_a(Lt),(f,u)=>Math.max(...u.map(g=>g.evaluate(f)))],abs:[Lt,[Lt],(f,[u])=>Math.abs(u.evaluate(f))],round:[Lt,[Lt],(f,[u])=>{const g=u.evaluate(f);return g<0?-Math.round(-g):Math.round(g)}],floor:[Lt,[Lt],(f,[u])=>Math.floor(u.evaluate(f))],ceil:[Lt,[Lt],(f,[u])=>Math.ceil(u.evaluate(f))],"filter-==":[bn,[Sn,yn],(f,[u,g])=>f.properties()[u.value]===g.value],"filter-id-==":[bn,[yn],(f,[u])=>f.id()===u.value],"filter-type-==":[bn,[Sn],(f,[u])=>f.geometryType()===u.value],"filter-<":[bn,[Sn,yn],(f,[u,g])=>{const T=f.properties()[u.value],D=g.value;return typeof T==typeof D&&T<D}],"filter-id-<":[bn,[yn],(f,[u])=>{const g=f.id(),T=u.value;return typeof g==typeof T&&g<T}],"filter->":[bn,[Sn,yn],(f,[u,g])=>{const T=f.properties()[u.value],D=g.value;return typeof T==typeof D&&T>D}],"filter-id->":[bn,[yn],(f,[u])=>{const g=f.id(),T=u.value;return typeof g==typeof T&&g>T}],"filter-<=":[bn,[Sn,yn],(f,[u,g])=>{const T=f.properties()[u.value],D=g.value;return typeof T==typeof D&&T<=D}],"filter-id-<=":[bn,[yn],(f,[u])=>{const g=f.id(),T=u.value;return typeof g==typeof T&&g<=T}],"filter->=":[bn,[Sn,yn],(f,[u,g])=>{const T=f.properties()[u.value],D=g.value;return typeof T==typeof D&&T>=D}],"filter-id->=":[bn,[yn],(f,[u])=>{const g=f.id(),T=u.value;return typeof g==typeof T&&g>=T}],"filter-has":[bn,[yn],(f,[u])=>u.value in f.properties()],"filter-has-id":[bn,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[bn,[hi(Sn)],(f,[u])=>u.value.indexOf(f.geometryType())>=0],"filter-id-in":[bn,[hi(yn)],(f,[u])=>u.value.indexOf(f.id())>=0],"filter-in-small":[bn,[Sn,hi(yn)],(f,[u,g])=>g.value.indexOf(f.properties()[u.value])>=0],"filter-in-large":[bn,[Sn,hi(yn)],(f,[u,g])=>function(T,D,z,N){for(;z<=N;){const $=z+N>>1;if(D[$]===T)return!0;D[$]>T?N=$-1:z=$+1}return!1}(f.properties()[u.value],g.value,0,g.value.length-1)],all:{type:bn,overloads:[[[bn,bn],(f,[u,g])=>u.evaluate(f)&&g.evaluate(f)],[_a(bn),(f,u)=>{for(const g of u)if(!g.evaluate(f))return!1;return!0}]]},any:{type:bn,overloads:[[[bn,bn],(f,[u,g])=>u.evaluate(f)||g.evaluate(f)],[_a(bn),(f,u)=>{for(const g of u)if(g.evaluate(f))return!0;return!1}]]},"!":[bn,[bn],(f,[u])=>!u.evaluate(f)],"is-supported-script":[bn,[Sn],(f,[u])=>{const g=f.globals&&f.globals.isSupportedScript;return!g||g(u.evaluate(f))}],upcase:[Sn,[Sn],(f,[u])=>u.evaluate(f).toUpperCase()],downcase:[Sn,[Sn],(f,[u])=>u.evaluate(f).toLowerCase()],concat:[Sn,_a(yn),(f,u)=>u.map(g=>dt(g.evaluate(f))).join("")],"resolved-locale":[Sn,[Ke],(f,[u])=>u.evaluate(f).resolvedLocale()]});class Hs{constructor(u,g){this.expression=u,this._warningHistory={},this._evaluator=new xn,this._defaultValue=g?function(T){return T.type==="color"&&Tr(T.default)?new a(0,0,0,0):T.type==="color"?a.parse(T.default)||null:T.type==="padding"?Pe.parse(T.default)||null:T.default===void 0?null:T.default}(g):null,this._enumValues=g&&g.type==="enum"?g.values:null}evaluateWithoutErrorHandling(u,g,T,D,z,N){return this._evaluator.globals=u,this._evaluator.feature=g,this._evaluator.featureState=T,this._evaluator.canonical=D,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=N,this.expression.evaluate(this._evaluator)}evaluate(u,g,T,D,z,N){this._evaluator.globals=u,this._evaluator.feature=g||null,this._evaluator.featureState=T||null,this._evaluator.canonical=D,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=N||null;try{const $=this.expression.evaluate(this._evaluator);if($==null||typeof $=="number"&&$!=$)return this._defaultValue;if(this._enumValues&&!($ in this._enumValues))throw new Rt(`Expected value to be one of ${Object.keys(this._enumValues).map(Z=>JSON.stringify(Z)).join(", ")}, but found ${JSON.stringify($)} instead.`);return $}catch($){return this._warningHistory[$.message]||(this._warningHistory[$.message]=!0,typeof console<"u"&&console.warn($.message)),this._defaultValue}}}function zl(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in Xa}function Ja(f,u){const g=new bt(Xa,[],u?function(D){const z={color:Rr,string:Sn,number:Lt,enum:Sn,boolean:bn,formatted:qr,padding:Gs,resolvedImage:Fr};return D.type==="array"?hi(z[D.value]||yn,D.length):z[D.type]}(u):void 0),T=g.parse(f,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return T?pu(new Hs(T,u)):va(g.errors)}class xa{constructor(u,g){this.kind=u,this._styleExpression=g,this.isStateDependent=u!=="constant"&&!Te(g.expression)}evaluateWithoutErrorHandling(u,g,T,D,z,N){return this._styleExpression.evaluateWithoutErrorHandling(u,g,T,D,z,N)}evaluate(u,g,T,D,z,N){return this._styleExpression.evaluate(u,g,T,D,z,N)}}class Ol{constructor(u,g,T,D){this.kind=u,this.zoomStops=T,this._styleExpression=g,this.isStateDependent=u!=="camera"&&!Te(g.expression),this.interpolationType=D}evaluateWithoutErrorHandling(u,g,T,D,z,N){return this._styleExpression.evaluateWithoutErrorHandling(u,g,T,D,z,N)}evaluate(u,g,T,D,z,N){return this._styleExpression.evaluate(u,g,T,D,z,N)}interpolationFactor(u,g,T){return this.interpolationType?On.interpolationFactor(this.interpolationType,u,g,T):0}}function Fl(f,u){const g=Ja(f,u);if(g.result==="error")return g;const T=g.value.expression,D=me(T);if(!D&&!gr(u))return va([new Di("","data expressions not supported")]);const z=Ue(T,["zoom"]);if(!z&&!js(u))return va([new Di("","zoom expressions not supported")]);const N=DA(T);return N||z?N instanceof Di?va([N]):N instanceof On&&!Hn(u)?va([new Di("",'"interpolate" expressions cannot be used with this property')]):pu(N?new Ol(D?"camera":"composite",g.value,N.labels,N instanceof On?N.interpolation:void 0):new xa(D?"constant":"source",g.value)):va([new Di("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class vr{constructor(u,g){this._parameters=u,this._specification=g,Ei(this,Bl(this._parameters,this._specification))}static deserialize(u){return new vr(u._parameters,u._specification)}static serialize(u){return{_parameters:u._parameters,_specification:u._specification}}}function DA(f){let u=null;if(f instanceof xo)u=DA(f.result);else if(f instanceof ii){for(const g of f.args)if(u=DA(g),u)break}else(f instanceof Dr||f instanceof On)&&f.input instanceof Ft&&f.input.name==="zoom"&&(u=f);return u instanceof Di||f.eachChild(g=>{const T=DA(g);T instanceof Di?u=T:!u&&T?u=new Di("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):u&&T&&u!==T&&(u=new Di("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),u}function hs(f){const u=f.key,g=f.value,T=f.valueSpec||{},D=f.objectElementValidators||{},z=f.style,N=f.styleSpec;let $=[];const Z=Zn(g);if(Z!=="object")return[new It(u,g,`object expected, ${Z} found`)];for(const re in g){const Ae=re.split(".")[0],ce=T[Ae]||T["*"];let ge;if(D[Ae])ge=D[Ae];else if(T[Ae])ge=Ji;else if(D["*"])ge=D["*"];else{if(!T["*"]){$.push(new It(u,g[re],`unknown property "${re}"`));continue}ge=Ji}$=$.concat(ge({key:(u&&`${u}.`)+re,value:g[re],valueSpec:ce,style:z,styleSpec:N,object:g,objectKey:re},g))}for(const re in T)D[re]||T[re].required&&T[re].default===void 0&&g[re]===void 0&&$.push(new It(u,g,`missing required property "${re}"`));return $}function mu(f){const u=f.value,g=f.valueSpec,T=f.style,D=f.styleSpec,z=f.key,N=f.arrayElementValidator||Ji;if(Zn(u)!=="array")return[new It(z,u,`array expected, ${Zn(u)} found`)];if(g.length&&u.length!==g.length)return[new It(z,u,`array length ${g.length} expected, length ${u.length} found`)];if(g["min-length"]&&u.length<g["min-length"])return[new It(z,u,`array length at least ${g["min-length"]} expected, length ${u.length} found`)];let $={type:g.value,values:g.values};D.$version<7&&($.function=g.function),Zn(g.value)==="object"&&($=g.value);let Z=[];for(let re=0;re<u.length;re++)Z=Z.concat(N({array:u,arrayIndex:re,value:u[re],valueSpec:$,style:T,styleSpec:D,key:`${z}[${re}]`}));return Z}function Nl(f){const u=f.key,g=f.value,T=f.valueSpec;let D=Zn(g);return D==="number"&&g!=g&&(D="NaN"),D!=="number"?[new It(u,g,`number expected, ${D} found`)]:"minimum"in T&&g<T.minimum?[new It(u,g,`${g} is less than the minimum value ${T.minimum}`)]:"maximum"in T&&g>T.maximum?[new It(u,g,`${g} is greater than the maximum value ${T.maximum}`)]:[]}function Tc(f){const u=f.valueSpec,g=zn(f.value.type);let T,D,z,N={};const $=g!=="categorical"&&f.value.property===void 0,Z=!$,re=Zn(f.value.stops)==="array"&&Zn(f.value.stops[0])==="array"&&Zn(f.value.stops[0][0])==="object",Ae=hs({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(ye){if(g==="identity")return[new It(ye.key,ye.value,'identity function may not have a "stops" property')];let _e=[];const Ve=ye.value;return _e=_e.concat(mu({key:ye.key,value:Ve,valueSpec:ye.valueSpec,style:ye.style,styleSpec:ye.styleSpec,arrayElementValidator:ce})),Zn(Ve)==="array"&&Ve.length===0&&_e.push(new It(ye.key,Ve,"array must have at least one stop")),_e},default:function(ye){return Ji({key:ye.key,value:ye.value,valueSpec:u,style:ye.style,styleSpec:ye.styleSpec})}}});return g==="identity"&&$&&Ae.push(new It(f.key,f.value,'missing required property "property"')),g==="identity"||f.value.stops||Ae.push(new It(f.key,f.value,'missing required property "stops"')),g==="exponential"&&f.valueSpec.expression&&!Hn(f.valueSpec)&&Ae.push(new It(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(Z&&!gr(f.valueSpec)?Ae.push(new It(f.key,f.value,"property functions not supported")):$&&!js(f.valueSpec)&&Ae.push(new It(f.key,f.value,"zoom functions not supported"))),g!=="categorical"&&!re||f.value.property!==void 0||Ae.push(new It(f.key,f.value,'"property" property is required')),Ae;function ce(ye){let _e=[];const Ve=ye.value,Fe=ye.key;if(Zn(Ve)!=="array")return[new It(Fe,Ve,`array expected, ${Zn(Ve)} found`)];if(Ve.length!==2)return[new It(Fe,Ve,`array length 2 expected, length ${Ve.length} found`)];if(re){if(Zn(Ve[0])!=="object")return[new It(Fe,Ve,`object expected, ${Zn(Ve[0])} found`)];if(Ve[0].zoom===void 0)return[new It(Fe,Ve,"object stop key must have zoom")];if(Ve[0].value===void 0)return[new It(Fe,Ve,"object stop key must have value")];if(z&&z>zn(Ve[0].zoom))return[new It(Fe,Ve[0].zoom,"stop zoom values must appear in ascending order")];zn(Ve[0].zoom)!==z&&(z=zn(Ve[0].zoom),D=void 0,N={}),_e=_e.concat(hs({key:`${Fe}[0]`,value:Ve[0],valueSpec:{zoom:{}},style:ye.style,styleSpec:ye.styleSpec,objectElementValidators:{zoom:Nl,value:ge}}))}else _e=_e.concat(ge({key:`${Fe}[0]`,value:Ve[0],valueSpec:{},style:ye.style,styleSpec:ye.styleSpec},Ve));return zl($i(Ve[1]))?_e.concat([new It(`${Fe}[1]`,Ve[1],"expressions are not allowed in function stops.")]):_e.concat(Ji({key:`${Fe}[1]`,value:Ve[1],valueSpec:u,style:ye.style,styleSpec:ye.styleSpec}))}function ge(ye,_e){const Ve=Zn(ye.value),Fe=zn(ye.value),it=ye.value!==null?ye.value:_e;if(T){if(Ve!==T)return[new It(ye.key,it,`${Ve} stop domain type must match previous stop domain type ${T}`)]}else T=Ve;if(Ve!=="number"&&Ve!=="string"&&Ve!=="boolean")return[new It(ye.key,it,"stop domain value must be a number, string, or boolean")];if(Ve!=="number"&&g!=="categorical"){let ut=`number expected, ${Ve} found`;return gr(u)&&g===void 0&&(ut+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new It(ye.key,it,ut)]}return g!=="categorical"||Ve!=="number"||isFinite(Fe)&&Math.floor(Fe)===Fe?g!=="categorical"&&Ve==="number"&&D!==void 0&&Fe<D?[new It(ye.key,it,"stop domain values must appear in ascending order")]:(D=Fe,g==="categorical"&&Fe in N?[new It(ye.key,it,"stop domain values must be unique")]:(N[Fe]=!0,[])):[new It(ye.key,it,`integer expected, found ${Fe}`)]}}function Yr(f){const u=(f.expressionContext==="property"?Fl:Ja)($i(f.value),f.valueSpec);if(u.result==="error")return u.value.map(T=>new It(`${f.key}${T.key}`,f.value,T.message));const g=u.value.expression||u.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!g.outputDefined())return[new It(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!Te(g))return[new It(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!Te(g))return[new It(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!Ue(g,["zoom","feature-state"]))return[new It(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!me(g))return[new It(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function zr(f){const u=f.key,g=f.value,T=f.valueSpec,D=[];return Array.isArray(T.values)?T.values.indexOf(zn(g))===-1&&D.push(new It(u,g,`expected one of [${T.values.join(", ")}], ${JSON.stringify(g)} found`)):Object.keys(T.values).indexOf(zn(g))===-1&&D.push(new It(u,g,`expected one of [${Object.keys(T.values).join(", ")}], ${JSON.stringify(g)} found`)),D}function si(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const u of f.slice(1))if(!si(u)&&typeof u!="boolean")return!1;return!0;default:return!0}}const yu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ws(f){if(f==null)return{filter:()=>!0,needGeometry:!1};si(f)||(f=di(f));const u=Ja(f,yu);if(u.result==="error")throw new Error(u.value.map(g=>`${g.key}: ${g.message}`).join(", "));return{filter:(g,T,D)=>u.value.evaluate(g,T,{},D),needGeometry:RA(f)}}function Sc(f,u){return f<u?-1:f>u?1:0}function RA(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(let u=1;u<f.length;u++)if(RA(f[u]))return!0;return!1}function di(f){if(!f)return!0;const u=f[0];return f.length<=1?u!=="any":u==="=="?Ti(f[1],f[2],"=="):u==="!="?Ki(Ti(f[1],f[2],"==")):u==="<"||u===">"||u==="<="||u===">="?Ti(f[1],f[2],u):u==="any"?(g=f.slice(1),["any"].concat(g.map(di))):u==="all"?["all"].concat(f.slice(1).map(di)):u==="none"?["all"].concat(f.slice(1).map(di).map(Ki)):u==="in"?fs(f[1],f.slice(2)):u==="!in"?Ki(fs(f[1],f.slice(2))):u==="has"?wa(f[1]):u==="!has"?Ki(wa(f[1])):u!=="within"||f;var g}function Ti(f,u,g){switch(f){case"$type":return[`filter-type-${g}`,u];case"$id":return[`filter-id-${g}`,u];default:return[`filter-${g}`,f,u]}}function fs(f,u){if(u.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(g=>typeof g!=typeof u[0])?["filter-in-large",f,["literal",u.sort(Sc)]]:["filter-in-small",f,["literal",u]]}}function wa(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function Ki(f){return["!",f]}function To(f){return si($i(f.value))?Yr(Ei({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):yi(f)}function yi(f){const u=f.value,g=f.key;if(Zn(u)!=="array")return[new It(g,u,`array expected, ${Zn(u)} found`)];const T=f.styleSpec;let D,z=[];if(u.length<1)return[new It(g,u,"filter array must have at least 1 element")];switch(z=z.concat(zr({key:`${g}[0]`,value:u[0],valueSpec:T.filter_operator,style:f.style,styleSpec:f.styleSpec})),zn(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&zn(u[1])==="$type"&&z.push(new It(g,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&z.push(new It(g,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(D=Zn(u[1]),D!=="string"&&z.push(new It(`${g}[1]`,u[1],`string expected, ${D} found`)));for(let N=2;N<u.length;N++)D=Zn(u[N]),zn(u[1])==="$type"?z=z.concat(zr({key:`${g}[${N}]`,value:u[N],valueSpec:T.geometry_type,style:f.style,styleSpec:f.styleSpec})):D!=="string"&&D!=="number"&&D!=="boolean"&&z.push(new It(`${g}[${N}]`,u[N],`string, number, or boolean expected, ${D} found`));break;case"any":case"all":case"none":for(let N=1;N<u.length;N++)z=z.concat(yi({key:`${g}[${N}]`,value:u[N],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":D=Zn(u[1]),u.length!==2?z.push(new It(g,u,`filter array for "${u[0]}" operator must have 2 elements`)):D!=="string"&&z.push(new It(`${g}[1]`,u[1],`string expected, ${D} found`));break;case"within":D=Zn(u[1]),u.length!==2?z.push(new It(g,u,`filter array for "${u[0]}" operator must have 2 elements`)):D!=="object"&&z.push(new It(`${g}[1]`,u[1],`object expected, ${D} found`))}return z}function el(f,u){const g=f.key,T=f.style,D=f.styleSpec,z=f.value,N=f.objectKey,$=D[`${u}_${f.layerType}`];if(!$)return[];const Z=N.match(/^(.*)-transition$/);if(u==="paint"&&Z&&$[Z[1]]&&$[Z[1]].transition)return Ji({key:g,value:z,valueSpec:D.transition,style:T,styleSpec:D});const re=f.valueSpec||$[N];if(!re)return[new It(g,z,`unknown property "${N}"`)];let Ae;if(Zn(z)==="string"&&gr(re)&&!re.tokens&&(Ae=/^{([^}]+)}$/.exec(z)))return[new It(g,z,`"${N}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Ae[1])} }\`.`)];const ce=[];return f.layerType==="symbol"&&(N==="text-field"&&T&&!T.glyphs&&ce.push(new It(g,z,'use of "text-field" requires a style "glyphs" property')),N==="text-font"&&Tr($i(z))&&zn(z.type)==="identity"&&ce.push(new It(g,z,'"text-font" does not support identity functions'))),ce.concat(Ji({key:f.key,value:z,valueSpec:re,style:T,styleSpec:D,expressionContext:"property",propertyType:u,propertyKey:N}))}function Ul(f){return el(f,"paint")}function tl(f){return el(f,"layout")}function Qs(f){let u=[];const g=f.value,T=f.key,D=f.style,z=f.styleSpec;g.type||g.ref||u.push(new It(T,g,'either "type" or "ref" is required'));let N=zn(g.type);const $=zn(g.ref);if(g.id){const Z=zn(g.id);for(let re=0;re<f.arrayIndex;re++){const Ae=D.layers[re];zn(Ae.id)===Z&&u.push(new It(T,g.id,`duplicate layer id "${g.id}", previously used at line ${Ae.id.__line__}`))}}if("ref"in g){let Z;["type","source","source-layer","filter","layout"].forEach(re=>{re in g&&u.push(new It(T,g[re],`"${re}" is prohibited for ref layers`))}),D.layers.forEach(re=>{zn(re.id)===$&&(Z=re)}),Z?Z.ref?u.push(new It(T,g.ref,"ref cannot reference another ref layer")):N=zn(Z.type):u.push(new It(T,g.ref,`ref layer "${$}" not found`))}else if(N!=="background")if(g.source){const Z=D.sources&&D.sources[g.source],re=Z&&zn(Z.type);Z?re==="vector"&&N==="raster"?u.push(new It(T,g.source,`layer "${g.id}" requires a raster source`)):re==="raster"&&N!=="raster"?u.push(new It(T,g.source,`layer "${g.id}" requires a vector source`)):re!=="vector"||g["source-layer"]?re==="raster-dem"&&N!=="hillshade"?u.push(new It(T,g.source,"raster-dem source can only be used with layer type 'hillshade'.")):N!=="line"||!g.paint||!g.paint["line-gradient"]||re==="geojson"&&Z.lineMetrics||u.push(new It(T,g,`layer "${g.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new It(T,g,`layer "${g.id}" must specify a "source-layer"`)):u.push(new It(T,g.source,`source "${g.source}" not found`))}else u.push(new It(T,g,'missing required property "source"'));return u=u.concat(hs({key:T,value:g,valueSpec:z.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ji({key:`${T}.type`,value:g.type,valueSpec:z.layer.type,style:f.style,styleSpec:f.styleSpec,object:g,objectKey:"type"}),filter:To,layout:Z=>hs({layer:g,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":re=>tl(Ei({layerType:N},re))}}),paint:Z=>hs({layer:g,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":re=>Ul(Ei({layerType:N},re))}})}})),u}function ds(f){const u=f.value,g=f.key,T=Zn(u);return T!=="string"?[new It(g,u,`string expected, ${T} found`)]:[]}const Cc={promoteId:function({key:f,value:u}){if(Zn(u)==="string")return ds({key:f,value:u});{const g=[];for(const T in u)g.push(...ds({key:`${f}.${T}`,value:u[T]}));return g}}};function ba(f){const u=f.value,g=f.key,T=f.styleSpec,D=f.style;if(!u.type)return[new It(g,u,'"type" is required')];const z=zn(u.type);let N;switch(z){case"vector":case"raster":case"raster-dem":return N=hs({key:g,value:u,valueSpec:T[`source_${z.replace("-","_")}`],style:f.style,styleSpec:T,objectElementValidators:Cc}),N;case"geojson":if(N=hs({key:g,value:u,valueSpec:T.source_geojson,style:D,styleSpec:T,objectElementValidators:Cc}),u.cluster)for(const $ in u.clusterProperties){const[Z,re]=u.clusterProperties[$],Ae=typeof Z=="string"?[Z,["accumulated"],["get",$]]:Z;N.push(...Yr({key:`${g}.${$}.map`,value:re,expressionContext:"cluster-map"})),N.push(...Yr({key:`${g}.${$}.reduce`,value:Ae,expressionContext:"cluster-reduce"}))}return N;case"video":return hs({key:g,value:u,valueSpec:T.source_video,style:D,styleSpec:T});case"image":return hs({key:g,value:u,valueSpec:T.source_image,style:D,styleSpec:T});case"canvas":return[new It(g,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return zr({key:`${g}.type`,value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:D,styleSpec:T})}}function nl(f){const u=f.value,g=f.styleSpec,T=g.light,D=f.style;let z=[];const N=Zn(u);if(u===void 0)return z;if(N!=="object")return z=z.concat([new It("light",u,`object expected, ${N} found`)]),z;for(const $ in u){const Z=$.match(/^(.*)-transition$/);z=z.concat(Z&&T[Z[1]]&&T[Z[1]].transition?Ji({key:$,value:u[$],valueSpec:g.transition,style:D,styleSpec:g}):T[$]?Ji({key:$,value:u[$],valueSpec:T[$],style:D,styleSpec:g}):[new It($,u[$],`unknown property "${$}"`)])}return z}function oi(f){const u=f.value,g=f.styleSpec,T=g.terrain,D=f.style;let z=[];const N=Zn(u);if(u===void 0)return z;if(N!=="object")return z=z.concat([new It("terrain",u,`object expected, ${N} found`)]),z;for(const $ in u)z=z.concat(T[$]?Ji({key:$,value:u[$],valueSpec:T[$],style:D,styleSpec:g}):[new It($,u[$],`unknown property "${$}"`)]);return z}const Ps={"*":()=>[],array:mu,boolean:function(f){const u=f.value,g=f.key,T=Zn(u);return T!=="boolean"?[new It(g,u,`boolean expected, ${T} found`)]:[]},number:Nl,color:function(f){const u=f.key,g=f.value,T=Zn(g);return T!=="string"?[new It(u,g,`color expected, ${T} found`)]:cs(g)===null?[new It(u,g,`color expected, "${g}" found`)]:[]},constants:Vs,enum:zr,filter:To,function:Tc,layer:Qs,object:hs,source:ba,light:nl,terrain:oi,string:ds,formatted:function(f){return ds(f).length===0?[]:Yr(f)},resolvedImage:function(f){return ds(f).length===0?[]:Yr(f)},padding:function(f){const u=f.key,g=f.value;if(Zn(g)==="array"){if(g.length<1||g.length>4)return[new It(u,g,`padding requires 1 to 4 values; ${g.length} values found`)];const T={type:"number"};let D=[];for(let z=0;z<g.length;z++)D=D.concat(Ji({key:`${u}[${z}]`,value:g[z],valueSpec:T}));return D}return Nl({key:u,value:g,valueSpec:{}})}};function Ji(f){const u=f.value,g=f.valueSpec,T=f.styleSpec;return g.expression&&Tr(zn(u))?Tc(f):g.expression&&zl($i(u))?Yr(f):g.type&&Ps[g.type]?Ps[g.type](f):hs(Ei({},f,{valueSpec:g.type?T[g.type]:g}))}function Vl(f){const u=f.value,g=f.key,T=ds(f);return T.length||(u.indexOf("{fontstack}")===-1&&T.push(new It(g,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&T.push(new It(g,u,'"glyphs" url must include a "{range}" token'))),T}function Jo(f,u=ht){let g=[];return g=g.concat(Ji({key:"",value:f,valueSpec:u.$root,styleSpec:u,style:f,objectElementValidators:{glyphs:Vl,"*":()=>[]}})),f.constants&&(g=g.concat(Vs({key:"constants",value:f.constants,style:f,styleSpec:u}))),Mc(g)}function Mc(f){return[].concat(f).sort((u,g)=>u.line-g.line)}function So(f){return function(...u){return Mc(f.apply(this,u))}}Jo.source=So(ba),Jo.light=So(nl),Jo.terrain=So(oi),Jo.layer=So(Qs),Jo.filter=So(To),Jo.paintProperty=So(Ul),Jo.layoutProperty=So(tl);const Gl=Jo,rl=Gl.light,Dh=Gl.paintProperty,Rh=Gl.layoutProperty;function il(f,u){let g=!1;if(u&&u.length)for(const T of u)f.fire(new Ho(new Error(T.message))),g=!0;return g}class Ea{constructor(u,g,T){const D=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;const N=new Int32Array(this.arrayBuffer);u=N[0],this.d=(g=N[1])+2*(T=N[2]);for(let Z=0;Z<this.d*this.d;Z++){const re=N[3+Z],Ae=N[3+Z+1];D.push(re===Ae?null:N.subarray(re,Ae))}const $=N[3+D.length+1];this.keys=N.subarray(N[3+D.length],$),this.bboxes=N.subarray($),this.insert=this._insertReadonly}else{this.d=g+2*T;for(let N=0;N<this.d*this.d;N++)D.push([]);this.keys=[],this.bboxes=[]}this.n=g,this.extent=u,this.padding=T,this.scale=g/u,this.uid=0;const z=T/g*u;this.min=-z,this.max=u+z}insert(u,g,T,D,z){this._forEachCell(g,T,D,z,this._insertCell,this.uid++,void 0,void 0),this.keys.push(u),this.bboxes.push(g),this.bboxes.push(T),this.bboxes.push(D),this.bboxes.push(z)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(u,g,T,D,z,N){this.cells[z].push(N)}query(u,g,T,D,z){const N=this.min,$=this.max;if(u<=N&&g<=N&&$<=T&&$<=D&&!z)return Array.prototype.slice.call(this.keys);{const Z=[];return this._forEachCell(u,g,T,D,this._queryCell,Z,{},z),Z}}_queryCell(u,g,T,D,z,N,$,Z){const re=this.cells[z];if(re!==null){const Ae=this.keys,ce=this.bboxes;for(let ge=0;ge<re.length;ge++){const ye=re[ge];if($[ye]===void 0){const _e=4*ye;(Z?Z(ce[_e+0],ce[_e+1],ce[_e+2],ce[_e+3]):u<=ce[_e+2]&&g<=ce[_e+3]&&T>=ce[_e+0]&&D>=ce[_e+1])?($[ye]=!0,N.push(Ae[ye])):$[ye]=!1}}}}_forEachCell(u,g,T,D,z,N,$,Z){const re=this._convertToCellCoord(u),Ae=this._convertToCellCoord(g),ce=this._convertToCellCoord(T),ge=this._convertToCellCoord(D);for(let ye=re;ye<=ce;ye++)for(let _e=Ae;_e<=ge;_e++){const Ve=this.d*_e+ye;if((!Z||Z(this._convertFromCellCoord(ye),this._convertFromCellCoord(_e),this._convertFromCellCoord(ye+1),this._convertFromCellCoord(_e+1)))&&z.call(this,u,g,T,D,Ve,N,$,Z))return}}_convertFromCellCoord(u){return(u-this.padding)/this.scale}_convertToCellCoord(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const u=this.cells,g=3+this.cells.length+1+1;let T=0;for(let N=0;N<this.cells.length;N++)T+=this.cells[N].length;const D=new Int32Array(g+T+this.keys.length+this.bboxes.length);D[0]=this.extent,D[1]=this.n,D[2]=this.padding;let z=g;for(let N=0;N<u.length;N++){const $=u[N];D[3+N]=z,D.set($,z),z+=$.length}return D[3+u.length]=z,D.set(this.keys,z),z+=this.keys.length,D[3+u.length+1]=z,D.set(this.bboxes,z),z+=this.bboxes.length,D.buffer}static serialize(u,g){const T=u.toArrayBuffer();return g&&g.push(T),{buffer:T}}static deserialize(u){return new Ea(u.buffer)}}const ps={};function Nt(f,u,g={}){if(ps[f])throw new Error(`${f} is already registered.`);Object.defineProperty(u,"_classRegistryKey",{value:f,writeable:!1}),ps[f]={klass:u,omit:g.omit||[],shallow:g.shallow||[]}}Nt("Object",Object),Nt("TransferableGridIndex",Ea),Nt("Color",a),Nt("Error",Error),Nt("AJAXError",nr),Nt("ResolvedImage",Ie),Nt("StylePropertyFunction",vr),Nt("StyleExpression",Hs,{omit:["_evaluator"]}),Nt("ZoomDependentExpression",Ol),Nt("ZoomConstantExpression",xa),Nt("CompoundExpression",Ft,{omit:["_evaluate"]});for(const f in Xa)Xa[f]._classRegistryKey||Nt(`Expression_${f}`,Xa[f]);function _u(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function Ta(f,u){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob)return f;if(_u(f)||pt(f))return u&&u.push(f),f;if(ArrayBuffer.isView(f)){const g=f;return u&&u.push(g.buffer),g}if(f instanceof ImageData)return u&&u.push(f.data.buffer),f;if(Array.isArray(f)){const g=[];for(const T of f)g.push(Ta(T,u));return g}if(typeof f=="object"){const g=f.constructor,T=g._classRegistryKey;if(!T)throw new Error("can't serialize object of unregistered class");if(!ps[T])throw new Error(`${T} is not registered.`);const D=g.serialize?g.serialize(f,u):{};if(g.serialize){if(u&&D===u[u.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const z in f){if(!f.hasOwnProperty(z)||ps[T].omit.indexOf(z)>=0)continue;const N=f[z];D[z]=ps[T].shallow.indexOf(z)>=0?N:Ta(N,u)}f instanceof Error&&(D.message=f.message)}if(D.$name)throw new Error("$name property is reserved for worker serialization logic.");return T!=="Object"&&(D.$name=T),D}throw new Error("can't serialize object of type "+typeof f)}function ea(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob||_u(f)||pt(f)||ArrayBuffer.isView(f)||f instanceof ImageData)return f;if(Array.isArray(f))return f.map(ea);if(typeof f=="object"){const u=f.$name||"Object";if(!ps[u])throw new Error(`can't deserialize unregistered class ${u}`);const{klass:g}=ps[u];if(!g)throw new Error(`can't deserialize unregistered class ${u}`);if(g.deserialize)return g.deserialize(f);const T=Object.create(g.prototype);for(const D of Object.keys(f)){if(D==="$name")continue;const z=f[D];T[D]=ps[u].shallow.indexOf(D)>=0?z:ea(z)}return T}throw new Error("can't deserialize object of type "+typeof f)}class vu{constructor(){this.first=!0}update(u,g){const T=Math.floor(u);return this.first?(this.first=!1,this.lastIntegerZoom=T,this.lastIntegerZoomTime=0,this.lastZoom=u,this.lastFloorZoom=T,!0):(this.lastFloorZoom>T?(this.lastIntegerZoom=T+1,this.lastIntegerZoomTime=g):this.lastFloorZoom<T&&(this.lastIntegerZoom=T,this.lastIntegerZoomTime=g),u!==this.lastZoom&&(this.lastZoom=u,this.lastFloorZoom=T,!0))}}const Vt={"Latin-1 Supplement":f=>f>=128&&f<=255,Arabic:f=>f>=1536&&f<=1791,"Arabic Supplement":f=>f>=1872&&f<=1919,"Arabic Extended-A":f=>f>=2208&&f<=2303,"Hangul Jamo":f=>f>=4352&&f<=4607,"Unified Canadian Aboriginal Syllabics":f=>f>=5120&&f<=5759,Khmer:f=>f>=6016&&f<=6143,"Unified Canadian Aboriginal Syllabics Extended":f=>f>=6320&&f<=6399,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"CJK Radicals Supplement":f=>f>=11904&&f<=12031,"Kangxi Radicals":f=>f>=12032&&f<=12255,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Bopomofo:f=>f>=12544&&f<=12591,"Hangul Compatibility Jamo":f=>f>=12592&&f<=12687,Kanbun:f=>f>=12688&&f<=12703,"Bopomofo Extended":f=>f>=12704&&f<=12735,"CJK Strokes":f=>f>=12736&&f<=12783,"Katakana Phonetic Extensions":f=>f>=12784&&f<=12799,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"CJK Unified Ideographs Extension A":f=>f>=13312&&f<=19903,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Yi Syllables":f=>f>=40960&&f<=42127,"Yi Radicals":f=>f>=42128&&f<=42191,"Hangul Jamo Extended-A":f=>f>=43360&&f<=43391,"Hangul Syllables":f=>f>=44032&&f<=55215,"Hangul Jamo Extended-B":f=>f>=55216&&f<=55295,"Private Use Area":f=>f>=57344&&f<=63743,"CJK Compatibility Ideographs":f=>f>=63744&&f<=64255,"Arabic Presentation Forms-A":f=>f>=64336&&f<=65023,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Arabic Presentation Forms-B":f=>f>=65136&&f<=65279,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519};function BA(f){for(const u of f)if(sl(u.charCodeAt(0)))return!0;return!1}function $l(f){for(const u of f)if(!zA(u.charCodeAt(0)))return!1;return!0}function zA(f){return!(Vt.Arabic(f)||Vt["Arabic Supplement"](f)||Vt["Arabic Extended-A"](f)||Vt["Arabic Presentation Forms-A"](f)||Vt["Arabic Presentation Forms-B"](f))}function sl(f){return!(f!==746&&f!==747&&(f<4352||!(Vt["Bopomofo Extended"](f)||Vt.Bopomofo(f)||Vt["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Vt["CJK Compatibility Ideographs"](f)||Vt["CJK Compatibility"](f)||Vt["CJK Radicals Supplement"](f)||Vt["CJK Strokes"](f)||!(!Vt["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Vt["CJK Unified Ideographs Extension A"](f)||Vt["CJK Unified Ideographs"](f)||Vt["Enclosed CJK Letters and Months"](f)||Vt["Hangul Compatibility Jamo"](f)||Vt["Hangul Jamo Extended-A"](f)||Vt["Hangul Jamo Extended-B"](f)||Vt["Hangul Jamo"](f)||Vt["Hangul Syllables"](f)||Vt.Hiragana(f)||Vt["Ideographic Description Characters"](f)||Vt.Kanbun(f)||Vt["Kangxi Radicals"](f)||Vt["Katakana Phonetic Extensions"](f)||Vt.Katakana(f)&&f!==12540||!(!Vt["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Vt["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Vt["Unified Canadian Aboriginal Syllabics"](f)||Vt["Unified Canadian Aboriginal Syllabics Extended"](f)||Vt["Vertical Forms"](f)||Vt["Yijing Hexagram Symbols"](f)||Vt["Yi Syllables"](f)||Vt["Yi Radicals"](f))))}function qs(f){return!(sl(f)||function(u){return!!(Vt["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||Vt["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||Vt["Letterlike Symbols"](u)||Vt["Number Forms"](u)||Vt["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||Vt["Control Pictures"](u)&&u!==9251||Vt["Optical Character Recognition"](u)||Vt["Enclosed Alphanumerics"](u)||Vt["Geometric Shapes"](u)||Vt["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||Vt["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||Vt["CJK Symbols and Punctuation"](u)||Vt.Katakana(u)||Vt["Private Use Area"](u)||Vt["CJK Compatibility Forms"](u)||Vt["Small Form Variants"](u)||Vt["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(f))}function xu(f){return f>=1424&&f<=2303||Vt["Arabic Presentation Forms-A"](f)||Vt["Arabic Presentation Forms-B"](f)}function Bh(f,u){return!(!u&&xu(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Vt.Khmer(f))}function Pc(f){for(const u of f)if(xu(u.charCodeAt(0)))return!0;return!1}const wu="deferred",bu="loading",Eu="loaded";let Zs=null,zi="unavailable",Co=null;const Tu=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(zi="error"),Zs&&Zs(f)};function Sa(){Ur.fire(new Li("pluginStateChange",{pluginStatus:zi,pluginURL:Co}))}const Ur=new As,jl=function(){return zi},kc=function(){if(zi!==wu||!Co)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");zi=bu,Sa(),Co&&rr({url:Co},f=>{f?Tu(f):(zi=Eu,Sa())})},gs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>zi===Eu||gs.applyArabicShaping!=null,isLoading:()=>zi===bu,setState(f){if(!We())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");zi=f.pluginStatus,Co=f.pluginURL},isParsed(){if(!We())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return gs.applyArabicShaping!=null&&gs.processBidirectionalText!=null&&gs.processStyledBidirectionalText!=null},getPluginURL(){if(!We())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Co}};class Pr{constructor(u,g){this.zoom=u,g?(this.now=g.now,this.fadeDuration=g.fadeDuration,this.zoomHistory=g.zoomHistory,this.transition=g.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new vu,this.transition={})}isSupportedScript(u){return function(g,T){for(const D of g)if(!Bh(D.charCodeAt(0),T))return!1;return!0}(u,gs.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const u=this.zoom,g=u-Math.floor(u),T=this.crossFadingFactor();return u>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:g+(1-g)*T}:{fromScale:.5,toScale:1,t:1-(1-T)*g}}}class ol{constructor(u,g){this.property=u,this.value=g,this.expression=function(T,D){if(Tr(T))return new vr(T,D);if(zl(T)){const z=Fl(T,D);if(z.result==="error")throw new Error(z.value.map(N=>`${N.key}: ${N.message}`).join(", "));return z.value}{let z=T;return D.type==="color"&&typeof T=="string"?z=a.parse(T):D.type!=="padding"||typeof T!="number"&&!Array.isArray(T)||(z=Pe.parse(T)),{kind:"constant",evaluate:()=>z}}}(g===void 0?u.specification.default:g,u.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(u,g,T){return this.property.possiblyEvaluate(this,u,g,T)}}class Hl{constructor(u){this.property=u,this.value=new ol(u,void 0)}transitioned(u,g){return new Ic(this.property,this.value,g,j({},u.transition,this.transition),u.now)}untransitioned(){return new Ic(this.property,this.value,null,{},0)}}class Su{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitionablePropertyValues)}getValue(u){return se(this._values[u].value.value)}setValue(u,g){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Hl(this._values[u].property)),this._values[u].value=new ol(this._values[u].property,g===null?void 0:se(g))}getTransition(u){return se(this._values[u].transition)}setTransition(u,g){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Hl(this._values[u].property)),this._values[u].transition=se(g)||void 0}serialize(){const u={};for(const g of Object.keys(this._values)){const T=this.getValue(g);T!==void 0&&(u[g]=T);const D=this.getTransition(g);D!==void 0&&(u[`${g}-transition`]=D)}return u}transitioned(u,g){const T=new Cu(this._properties);for(const D of Object.keys(this._values))T._values[D]=this._values[D].transitioned(u,g._values[D]);return T}untransitioned(){const u=new Cu(this._properties);for(const g of Object.keys(this._values))u._values[g]=this._values[g].untransitioned();return u}}class Ic{constructor(u,g,T,D,z){this.property=u,this.value=g,this.begin=z+D.delay||0,this.end=this.begin+D.duration||0,u.specification.transition&&(D.delay||D.duration)&&(this.prior=T)}possiblyEvaluate(u,g,T){const D=u.now||0,z=this.value.possiblyEvaluate(u,g,T),N=this.prior;if(N){if(D>this.end)return this.prior=null,z;if(this.value.isDataDriven())return this.prior=null,z;if(D<this.begin)return N.possiblyEvaluate(u,g,T);{const $=(D-this.begin)/(this.end-this.begin);return this.property.interpolate(N.possiblyEvaluate(u,g,T),z,function(Z){if(Z<=0)return 0;if(Z>=1)return 1;const re=Z*Z,Ae=re*Z;return 4*(Z<.5?Ae:3*(Z-re)+Ae-.75)}($))}}return z}}class Cu{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitioningPropertyValues)}possiblyEvaluate(u,g,T){const D=new Wl(this._properties);for(const z of Object.keys(this._values))D._values[z]=this._values[z].possiblyEvaluate(u,g,T);return D}hasTransition(){for(const u of Object.keys(this._values))if(this._values[u].prior)return!0;return!1}}class Lc{constructor(u){this._properties=u,this._values=Object.create(u.defaultPropertyValues)}getValue(u){return se(this._values[u].value)}setValue(u,g){this._values[u]=new ol(this._values[u].property,g===null?void 0:se(g))}serialize(){const u={};for(const g of Object.keys(this._values)){const T=this.getValue(g);T!==void 0&&(u[g]=T)}return u}possiblyEvaluate(u,g,T){const D=new Wl(this._properties);for(const z of Object.keys(this._values))D._values[z]=this._values[z].possiblyEvaluate(u,g,T);return D}}class xr{constructor(u,g,T){this.property=u,this.value=g,this.parameters=T}isConstant(){return this.value.kind==="constant"}constantOr(u){return this.value.kind==="constant"?this.value.value:u}evaluate(u,g,T,D){return this.property.evaluate(this.value,this.parameters,u,g,T,D)}}class Wl{constructor(u){this._properties=u,this._values=Object.create(u.defaultPossiblyEvaluatedValues)}get(u){return this._values[u]}}class Xt{constructor(u){this.specification=u}possiblyEvaluate(u,g){if(u.isDataDriven())throw new Error("Value should not be data driven");return u.expression.evaluate(g)}interpolate(u,g,T){const D=Br[this.specification.type];return D?D(u,g,T):u}}class Kt{constructor(u,g){this.specification=u,this.overrides=g}possiblyEvaluate(u,g,T,D){return new xr(this,u.expression.kind==="constant"||u.expression.kind==="camera"?{kind:"constant",value:u.expression.evaluate(g,null,{},T,D)}:u.expression,g)}interpolate(u,g,T){if(u.value.kind!=="constant"||g.value.kind!=="constant")return u;if(u.value.value===void 0||g.value.value===void 0)return new xr(this,{kind:"constant",value:void 0},u.parameters);const D=Br[this.specification.type];return D?new xr(this,{kind:"constant",value:D(u.value.value,g.value.value,T)},u.parameters):u}evaluate(u,g,T,D,z,N){return u.kind==="constant"?u.value:u.evaluate(g,T,D,z,N)}}class fn extends Kt{possiblyEvaluate(u,g,T,D){if(u.value===void 0)return new xr(this,{kind:"constant",value:void 0},g);if(u.expression.kind==="constant"){const z=u.expression.evaluate(g,null,{},T,D),N=u.property.specification.type==="resolvedImage"&&typeof z!="string"?z.name:z,$=this._calculate(N,N,N,g);return new xr(this,{kind:"constant",value:$},g)}if(u.expression.kind==="camera"){const z=this._calculate(u.expression.evaluate({zoom:g.zoom-1}),u.expression.evaluate({zoom:g.zoom}),u.expression.evaluate({zoom:g.zoom+1}),g);return new xr(this,{kind:"constant",value:z},g)}return new xr(this,u.expression,g)}evaluate(u,g,T,D,z,N){if(u.kind==="source"){const $=u.evaluate(g,T,D,z,N);return this._calculate($,$,$,g)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(g.zoom)-1},T,D),u.evaluate({zoom:Math.floor(g.zoom)},T,D),u.evaluate({zoom:Math.floor(g.zoom)+1},T,D),g):u.value}_calculate(u,g,T,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:u,to:g}:{from:T,to:g}}interpolate(u){return u}}class es{constructor(u){this.specification=u}possiblyEvaluate(u,g,T,D){if(u.value!==void 0){if(u.expression.kind==="constant"){const z=u.expression.evaluate(g,null,{},T,D);return this._calculate(z,z,z,g)}return this._calculate(u.expression.evaluate(new Pr(Math.floor(g.zoom-1),g)),u.expression.evaluate(new Pr(Math.floor(g.zoom),g)),u.expression.evaluate(new Pr(Math.floor(g.zoom+1),g)),g)}}_calculate(u,g,T,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:u,to:g}:{from:T,to:g}}interpolate(u){return u}}class ta{constructor(u){this.specification=u}possiblyEvaluate(u,g,T,D){return!!u.expression.evaluate(g,null,{},T,D)}interpolate(){return!1}}class jr{constructor(u){this.properties=u,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const g in u){const T=u[g];T.specification.overridable&&this.overridableProperties.push(g);const D=this.defaultPropertyValues[g]=new ol(T,void 0),z=this.defaultTransitionablePropertyValues[g]=new Hl(T);this.defaultTransitioningPropertyValues[g]=z.untransitioned(),this.defaultPossiblyEvaluatedValues[g]=D.possiblyEvaluate({})}}}Nt("DataDrivenProperty",Kt),Nt("DataConstantProperty",Xt),Nt("CrossFadedDataDrivenProperty",fn),Nt("CrossFadedProperty",es),Nt("ColorRampProperty",ta);const Ys="-transition";class ks extends As{constructor(u,g){if(super(),this.id=u.id,this.type=u.type,this._featureFilter={filter:()=>!0,needGeometry:!1},u.type!=="custom"&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),g.layout&&(this._unevaluatedLayout=new Lc(g.layout)),g.paint)){this._transitionablePaint=new Su(g.paint);for(const T in u.paint)this.setPaintProperty(T,u.paint[T],{validate:!1});for(const T in u.layout)this.setLayoutProperty(T,u.layout[T],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wl(g.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)}setLayoutProperty(u,g,T={}){g!=null&&this._validate(Rh,`layers.${this.id}.layout.${u}`,u,g,T)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,g):this.visibility=g)}getPaintProperty(u){return u.endsWith(Ys)?this._transitionablePaint.getTransition(u.slice(0,-Ys.length)):this._transitionablePaint.getValue(u)}setPaintProperty(u,g,T={}){if(g!=null&&this._validate(Dh,`layers.${this.id}.paint.${u}`,u,g,T))return!1;if(u.endsWith(Ys))return this._transitionablePaint.setTransition(u.slice(0,-Ys.length),g||void 0),!1;{const D=this._transitionablePaint._values[u],z=D.property.specification["property-type"]==="cross-faded-data-driven",N=D.value.isDataDriven(),$=D.value;this._transitionablePaint.setValue(u,g),this._handleSpecialPaintPropertyUpdate(u);const Z=this._transitionablePaint._values[u].value;return Z.isDataDriven()||N||z||this._handleOverridablePaintPropertyUpdate(u,$,Z)}}_handleSpecialPaintPropertyUpdate(u){}_handleOverridablePaintPropertyUpdate(u,g,T){return!1}isHidden(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"}updateTransitions(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(u,g){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,g)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,g)}serialize(){const u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),J(u,(g,T)=>!(g===void 0||T==="layout"&&!Object.keys(g).length||T==="paint"&&!Object.keys(g).length))}_validate(u,g,T,D,z={}){return(!z||z.validate!==!1)&&il(this,u.call(Gl,{key:g,layerType:this.type,objectKey:T,value:D,styleSpec:ht,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const u in this.paint._values){const g=this.paint.get(u);if(g instanceof xr&&gr(g.property.specification)&&(g.value.kind==="source"||g.value.kind==="composite")&&g.value.isStateDependent)return!0}return!1}}const Xs={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ct{constructor(u,g){this._structArray=u,this._pos1=g*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Pt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(u,g){return u._trim(),g&&(u.isTransferred=!0,g.push(u.arrayBuffer)),{length:u.length,arrayBuffer:u.arrayBuffer}}static deserialize(u){const g=Object.create(this.prototype);return g.arrayBuffer=u.arrayBuffer,g.length=u.length,g.capacity=u.arrayBuffer.byteLength/g.bytesPerElement,g._refreshViews(),g}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(u){this.reserve(u),this.length=u}reserve(u){if(u>this.capacity){this.capacity=Math.max(u,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const g=this.uint8;this._refreshViews(),g&&this.uint8.set(g)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Hr(f,u=1){let g=0,T=0;return{members:f.map(D=>{const z=Xs[D.type].BYTES_PER_ELEMENT,N=g=al(g,Math.max(u,z)),$=D.components||1;return T=Math.max(T,z),g+=z*$,{name:D.name,type:D.type,components:$,offset:N}}),size:al(g,Math.max(T,u)),alignment:u}}function al(f,u){return Math.ceil(f/u)*u}class Ks extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g){const T=this.length;return this.resize(T+1),this.emplace(T,u,g)}emplace(u,g,T){const D=2*u;return this.int16[D+0]=g,this.int16[D+1]=T,u}}Ks.prototype.bytesPerElement=4,Nt("StructArrayLayout2i4",Ks);class L extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,g,T,D)}emplace(u,g,T,D,z){const N=4*u;return this.int16[N+0]=g,this.int16[N+1]=T,this.int16[N+2]=D,this.int16[N+3]=z,u}}L.prototype.bytesPerElement=8,Nt("StructArrayLayout4i8",L);class c extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N){const $=this.length;return this.resize($+1),this.emplace($,u,g,T,D,z,N)}emplace(u,g,T,D,z,N,$){const Z=6*u;return this.int16[Z+0]=g,this.int16[Z+1]=T,this.int16[Z+2]=D,this.int16[Z+3]=z,this.int16[Z+4]=N,this.int16[Z+5]=$,u}}c.prototype.bytesPerElement=12,Nt("StructArrayLayout2i4i12",c);class v extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N){const $=this.length;return this.resize($+1),this.emplace($,u,g,T,D,z,N)}emplace(u,g,T,D,z,N,$){const Z=4*u,re=8*u;return this.int16[Z+0]=g,this.int16[Z+1]=T,this.uint8[re+4]=D,this.uint8[re+5]=z,this.uint8[re+6]=N,this.uint8[re+7]=$,u}}v.prototype.bytesPerElement=8,Nt("StructArrayLayout2i4ub8",v);class A extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g){const T=this.length;return this.resize(T+1),this.emplace(T,u,g)}emplace(u,g,T){const D=2*u;return this.float32[D+0]=g,this.float32[D+1]=T,u}}A.prototype.bytesPerElement=8,Nt("StructArrayLayout2f8",A);class h extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N,$,Z,re,Ae){const ce=this.length;return this.resize(ce+1),this.emplace(ce,u,g,T,D,z,N,$,Z,re,Ae)}emplace(u,g,T,D,z,N,$,Z,re,Ae,ce){const ge=10*u;return this.uint16[ge+0]=g,this.uint16[ge+1]=T,this.uint16[ge+2]=D,this.uint16[ge+3]=z,this.uint16[ge+4]=N,this.uint16[ge+5]=$,this.uint16[ge+6]=Z,this.uint16[ge+7]=re,this.uint16[ge+8]=Ae,this.uint16[ge+9]=ce,u}}h.prototype.bytesPerElement=20,Nt("StructArrayLayout10ui20",h);class d extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N,$,Z,re,Ae,ce,ge){const ye=this.length;return this.resize(ye+1),this.emplace(ye,u,g,T,D,z,N,$,Z,re,Ae,ce,ge)}emplace(u,g,T,D,z,N,$,Z,re,Ae,ce,ge,ye){const _e=12*u;return this.int16[_e+0]=g,this.int16[_e+1]=T,this.int16[_e+2]=D,this.int16[_e+3]=z,this.uint16[_e+4]=N,this.uint16[_e+5]=$,this.uint16[_e+6]=Z,this.uint16[_e+7]=re,this.int16[_e+8]=Ae,this.int16[_e+9]=ce,this.int16[_e+10]=ge,this.int16[_e+11]=ye,u}}d.prototype.bytesPerElement=24,Nt("StructArrayLayout4i4ui4i24",d);class w extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,g,T)}emplace(u,g,T,D){const z=3*u;return this.float32[z+0]=g,this.float32[z+1]=T,this.float32[z+2]=D,u}}w.prototype.bytesPerElement=12,Nt("StructArrayLayout3f12",w);class b extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u){const g=this.length;return this.resize(g+1),this.emplace(g,u)}emplace(u,g){return this.uint32[1*u+0]=g,u}}b.prototype.bytesPerElement=4,Nt("StructArrayLayout1ul4",b);class S extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N,$,Z,re){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,u,g,T,D,z,N,$,Z,re)}emplace(u,g,T,D,z,N,$,Z,re,Ae){const ce=10*u,ge=5*u;return this.int16[ce+0]=g,this.int16[ce+1]=T,this.int16[ce+2]=D,this.int16[ce+3]=z,this.int16[ce+4]=N,this.int16[ce+5]=$,this.uint32[ge+3]=Z,this.uint16[ce+8]=re,this.uint16[ce+9]=Ae,u}}S.prototype.bytesPerElement=20,Nt("StructArrayLayout6i1ul2ui20",S);class P extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N){const $=this.length;return this.resize($+1),this.emplace($,u,g,T,D,z,N)}emplace(u,g,T,D,z,N,$){const Z=6*u;return this.int16[Z+0]=g,this.int16[Z+1]=T,this.int16[Z+2]=D,this.int16[Z+3]=z,this.int16[Z+4]=N,this.int16[Z+5]=$,u}}P.prototype.bytesPerElement=12,Nt("StructArrayLayout2i2i2i12",P);class B extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z){const N=this.length;return this.resize(N+1),this.emplace(N,u,g,T,D,z)}emplace(u,g,T,D,z,N){const $=4*u,Z=8*u;return this.float32[$+0]=g,this.float32[$+1]=T,this.float32[$+2]=D,this.int16[Z+6]=z,this.int16[Z+7]=N,u}}B.prototype.bytesPerElement=16,Nt("StructArrayLayout2f1f2i16",B);class V extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,g,T,D)}emplace(u,g,T,D,z){const N=12*u,$=3*u;return this.uint8[N+0]=g,this.uint8[N+1]=T,this.float32[$+1]=D,this.float32[$+2]=z,u}}V.prototype.bytesPerElement=12,Nt("StructArrayLayout2ub2f12",V);class W extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,g,T)}emplace(u,g,T,D){const z=3*u;return this.uint16[z+0]=g,this.uint16[z+1]=T,this.uint16[z+2]=D,u}}W.prototype.bytesPerElement=6,Nt("StructArrayLayout3ui6",W);class X extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N,$,Z,re,Ae,ce,ge,ye,_e,Ve,Fe,it){const ut=this.length;return this.resize(ut+1),this.emplace(ut,u,g,T,D,z,N,$,Z,re,Ae,ce,ge,ye,_e,Ve,Fe,it)}emplace(u,g,T,D,z,N,$,Z,re,Ae,ce,ge,ye,_e,Ve,Fe,it,ut){const tt=24*u,at=12*u,yt=48*u;return this.int16[tt+0]=g,this.int16[tt+1]=T,this.uint16[tt+2]=D,this.uint16[tt+3]=z,this.uint32[at+2]=N,this.uint32[at+3]=$,this.uint32[at+4]=Z,this.uint16[tt+10]=re,this.uint16[tt+11]=Ae,this.uint16[tt+12]=ce,this.float32[at+7]=ge,this.float32[at+8]=ye,this.uint8[yt+36]=_e,this.uint8[yt+37]=Ve,this.uint8[yt+38]=Fe,this.uint32[at+10]=it,this.int16[tt+22]=ut,u}}X.prototype.bytesPerElement=48,Nt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",X);class ae extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N,$,Z,re,Ae,ce,ge,ye,_e,Ve,Fe,it,ut,tt,at,yt,mt,Zt,tn,Ht,Ut,Ot,Wt){const $t=this.length;return this.resize($t+1),this.emplace($t,u,g,T,D,z,N,$,Z,re,Ae,ce,ge,ye,_e,Ve,Fe,it,ut,tt,at,yt,mt,Zt,tn,Ht,Ut,Ot,Wt)}emplace(u,g,T,D,z,N,$,Z,re,Ae,ce,ge,ye,_e,Ve,Fe,it,ut,tt,at,yt,mt,Zt,tn,Ht,Ut,Ot,Wt,$t){const St=34*u,gn=17*u;return this.int16[St+0]=g,this.int16[St+1]=T,this.int16[St+2]=D,this.int16[St+3]=z,this.int16[St+4]=N,this.int16[St+5]=$,this.int16[St+6]=Z,this.int16[St+7]=re,this.uint16[St+8]=Ae,this.uint16[St+9]=ce,this.uint16[St+10]=ge,this.uint16[St+11]=ye,this.uint16[St+12]=_e,this.uint16[St+13]=Ve,this.uint16[St+14]=Fe,this.uint16[St+15]=it,this.uint16[St+16]=ut,this.uint16[St+17]=tt,this.uint16[St+18]=at,this.uint16[St+19]=yt,this.uint16[St+20]=mt,this.uint16[St+21]=Zt,this.uint16[St+22]=tn,this.uint32[gn+12]=Ht,this.float32[gn+13]=Ut,this.float32[gn+14]=Ot,this.float32[gn+15]=Wt,this.float32[gn+16]=$t,u}}ae.prototype.bytesPerElement=68,Nt("StructArrayLayout8i15ui1ul4f68",ae);class ne extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u){const g=this.length;return this.resize(g+1),this.emplace(g,u)}emplace(u,g){return this.float32[1*u+0]=g,u}}ne.prototype.bytesPerElement=4,Nt("StructArrayLayout1f4",ne);class ue extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,g,T)}emplace(u,g,T,D){const z=3*u;return this.int16[z+0]=g,this.int16[z+1]=T,this.int16[z+2]=D,u}}ue.prototype.bytesPerElement=6,Nt("StructArrayLayout3i6",ue);class Ee extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,g,T)}emplace(u,g,T,D){const z=4*u;return this.uint32[2*u+0]=g,this.uint16[z+2]=T,this.uint16[z+3]=D,u}}Ee.prototype.bytesPerElement=8,Nt("StructArrayLayout1ul2ui8",Ee);class Me extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g){const T=this.length;return this.resize(T+1),this.emplace(T,u,g)}emplace(u,g,T){const D=2*u;return this.uint16[D+0]=g,this.uint16[D+1]=T,u}}Me.prototype.bytesPerElement=4,Nt("StructArrayLayout2ui4",Me);class ve extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u){const g=this.length;return this.resize(g+1),this.emplace(g,u)}emplace(u,g){return this.uint16[1*u+0]=g,u}}ve.prototype.bytesPerElement=2,Nt("StructArrayLayout1ui2",ve);class je extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,g,T,D)}emplace(u,g,T,D,z){const N=4*u;return this.float32[N+0]=g,this.float32[N+1]=T,this.float32[N+2]=D,this.float32[N+3]=z,u}}je.prototype.bytesPerElement=16,Nt("StructArrayLayout4f16",je);class Se extends Ct{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Et(this.anchorPointX,this.anchorPointY)}}Se.prototype.size=20;class $e extends S{get(u){return new Se(this,u)}}Nt("CollisionBoxArray",$e);class xe extends Ct{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(u){this._structArray.uint8[this._pos1+37]=u}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(u){this._structArray.uint8[this._pos1+38]=u}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(u){this._structArray.uint32[this._pos4+10]=u}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}xe.prototype.size=48;class y extends X{get(u){return new xe(this,u)}}Nt("PlacedSymbolArray",y);class m extends Ct{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(u){this._structArray.uint32[this._pos4+12]=u}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}m.prototype.size=68;class x extends ae{get(u){return new m(this,u)}}Nt("SymbolInstanceArray",x);class E extends ne{getoffsetX(u){return this.float32[1*u+0]}}Nt("GlyphOffsetArray",E);class I extends ue{getx(u){return this.int16[3*u+0]}gety(u){return this.int16[3*u+1]}gettileUnitDistanceFromAnchor(u){return this.int16[3*u+2]}}Nt("SymbolLineVertexArray",I);class R extends Ct{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}R.prototype.size=8;class O extends Ee{get(u){return new R(this,u)}}Nt("FeatureIndexArray",O);class U extends Ks{}class q extends Ks{}class ee extends Ks{}class le extends c{}class de extends v{}class Be extends A{}class He extends h{}class ze extends d{}class Je extends w{}class ft extends b{}class ct extends P{}class st extends V{}class ot extends W{}class et extends Me{}const Gt=Hr([{name:"a_pos",components:2,type:"Int16"}],4),{members:zt}=Gt;class gt{constructor(u=[]){this.segments=u}prepareSegment(u,g,T,D){let z=this.segments[this.segments.length-1];return u>gt.MAX_VERTEX_ARRAY_LENGTH&&pe(`Max vertices per segment is ${gt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${u}`),(!z||z.vertexLength+u>gt.MAX_VERTEX_ARRAY_LENGTH||z.sortKey!==D)&&(z={vertexOffset:g.length,primitiveOffset:T.length,vertexLength:0,primitiveLength:0},D!==void 0&&(z.sortKey=D),this.segments.push(z)),z}get(){return this.segments}destroy(){for(const u of this.segments)for(const g in u.vaos)u.vaos[g].destroy()}static simpleSegment(u,g,T,D){return new gt([{vertexOffset:u,primitiveOffset:g,vertexLength:T,primitiveLength:D,vaos:{},sortKey:0}])}}function vt(f,u){return 256*(f=k(Math.floor(f),0,255))+k(Math.floor(u),0,255)}gt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Nt("SegmentVector",gt);const kn=Hr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var wn={exports:{}},mn={exports:{}};mn.exports=function(f,u){var g,T,D,z,N,$,Z,re;for(T=f.length-(g=3&f.length),D=u,N=3432918353,$=461845907,re=0;re<T;)Z=255&f.charCodeAt(re)|(255&f.charCodeAt(++re))<<8|(255&f.charCodeAt(++re))<<16|(255&f.charCodeAt(++re))<<24,++re,D=27492+(65535&(z=5*(65535&(D=(D^=Z=(65535&(Z=(Z=(65535&Z)*N+(((Z>>>16)*N&65535)<<16)&4294967295)<<15|Z>>>17))*$+(((Z>>>16)*$&65535)<<16)&4294967295)<<13|D>>>19))+((5*(D>>>16)&65535)<<16)&4294967295))+((58964+(z>>>16)&65535)<<16);switch(Z=0,g){case 3:Z^=(255&f.charCodeAt(re+2))<<16;case 2:Z^=(255&f.charCodeAt(re+1))<<8;case 1:D^=Z=(65535&(Z=(Z=(65535&(Z^=255&f.charCodeAt(re)))*N+(((Z>>>16)*N&65535)<<16)&4294967295)<<15|Z>>>17))*$+(((Z>>>16)*$&65535)<<16)&4294967295}return D^=f.length,D=2246822507*(65535&(D^=D>>>16))+((2246822507*(D>>>16)&65535)<<16)&4294967295,D=3266489909*(65535&(D^=D>>>13))+((3266489909*(D>>>16)&65535)<<16)&4294967295,(D^=D>>>16)>>>0};var _n={exports:{}};_n.exports=function(f,u){for(var g,T=f.length,D=u^T,z=0;T>=4;)g=1540483477*(65535&(g=255&f.charCodeAt(z)|(255&f.charCodeAt(++z))<<8|(255&f.charCodeAt(++z))<<16|(255&f.charCodeAt(++z))<<24))+((1540483477*(g>>>16)&65535)<<16),D=1540483477*(65535&D)+((1540483477*(D>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),T-=4,++z;switch(T){case 3:D^=(255&f.charCodeAt(z+2))<<16;case 2:D^=(255&f.charCodeAt(z+1))<<8;case 1:D=1540483477*(65535&(D^=255&f.charCodeAt(z)))+((1540483477*(D>>>16)&65535)<<16)}return D=1540483477*(65535&(D^=D>>>13))+((1540483477*(D>>>16)&65535)<<16),(D^=D>>>15)>>>0};var En=mn.exports,Rn=_n.exports;wn.exports=En,wn.exports.murmur3=En,wn.exports.murmur2=Rn;class lr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(u,g,T,D){this.ids.push(In(u)),this.positions.push(g,T,D)}getPositions(u){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const g=In(u);let T=0,D=this.ids.length-1;for(;T<D;){const N=T+D>>1;this.ids[N]>=g?D=N:T=N+1}const z=[];for(;this.ids[T]===g;)z.push({index:this.positions[3*T],start:this.positions[3*T+1],end:this.positions[3*T+2]}),T++;return z}static serialize(u,g){const T=new Float64Array(u.ids),D=new Uint32Array(u.positions);return Sr(T,D,0,T.length-1),g&&g.push(T.buffer,D.buffer),{ids:T,positions:D}}static deserialize(u){const g=new lr;return g.ids=u.ids,g.positions=u.positions,g.indexed=!0,g}}function In(f){const u=+f;return!isNaN(u)&&u<=Number.MAX_SAFE_INTEGER?u:wn.exports(String(f))}function Sr(f,u,g,T){for(;g<T;){const D=f[g+T>>1];let z=g-1,N=T+1;for(;;){do z++;while(f[z]<D);do N--;while(f[N]>D);if(z>=N)break;Xr(f,z,N),Xr(u,3*z,3*N),Xr(u,3*z+1,3*N+1),Xr(u,3*z+2,3*N+2)}N-g<T-N?(Sr(f,u,g,N),g=N+1):(Sr(f,u,N+1,T),T=N)}}function Xr(f,u,g){const T=f[u];f[u]=f[g],f[g]=T}Nt("FeaturePositionMap",lr);class ll{constructor(u,g){this.gl=u.gl,this.location=g}}class Mu extends ll{constructor(u,g){super(u,g),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Xf extends ll{constructor(u,g){super(u,g),this.current=[0,0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))}}class W4 extends ll{constructor(u,g){super(u,g),this.current=a.transparent}set(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))}}const oN=new Float32Array(16);function Xv(f){return[vt(255*f.r,255*f.g),vt(255*f.b,255*f.a)]}class rp{constructor(u,g,T){this.value=u,this.uniformNames=g.map(D=>`u_${D}`),this.type=T}setUniform(u,g,T){u.set(T.constantOr(this.value))}getBinding(u,g,T){return this.type==="color"?new W4(u,g):new Mu(u,g)}}class Kf{constructor(u,g){this.uniformNames=g.map(T=>`u_${T}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(u,g){this.pixelRatioFrom=g.pixelRatio,this.pixelRatioTo=u.pixelRatio,this.patternFrom=g.tlbr,this.patternTo=u.tlbr}setUniform(u,g,T,D){const z=D==="u_pattern_to"?this.patternTo:D==="u_pattern_from"?this.patternFrom:D==="u_pixel_ratio_to"?this.pixelRatioTo:D==="u_pixel_ratio_from"?this.pixelRatioFrom:null;z&&u.set(z)}getBinding(u,g,T){return T.substr(0,9)==="u_pattern"?new Xf(u,g):new Mu(u,g)}}class Pu{constructor(u,g,T,D){this.expression=u,this.type=T,this.maxValue=0,this.paintVertexAttributes=g.map(z=>({name:`a_${z}`,type:"Float32",components:T==="color"?2:1,offset:0})),this.paintVertexArray=new D}populatePaintArray(u,g,T,D,z){const N=this.paintVertexArray.length,$=this.expression.evaluate(new Pr(0),g,{},D,[],z);this.paintVertexArray.resize(u),this._setPaintValue(N,u,$)}updatePaintArray(u,g,T,D){const z=this.expression.evaluate({zoom:0},T,D);this._setPaintValue(u,g,z)}_setPaintValue(u,g,T){if(this.type==="color"){const D=Xv(T);for(let z=u;z<g;z++)this.paintVertexArray.emplace(z,D[0],D[1])}else{for(let D=u;D<g;D++)this.paintVertexArray.emplace(D,T);this.maxValue=Math.max(this.maxValue,Math.abs(T))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ql{constructor(u,g,T,D,z,N){this.expression=u,this.uniformNames=g.map($=>`u_${$}_t`),this.type=T,this.useIntegerZoom=D,this.zoom=z,this.maxValue=0,this.paintVertexAttributes=g.map($=>({name:`a_${$}`,type:"Float32",components:T==="color"?4:2,offset:0})),this.paintVertexArray=new N}populatePaintArray(u,g,T,D,z){const N=this.expression.evaluate(new Pr(this.zoom),g,{},D,[],z),$=this.expression.evaluate(new Pr(this.zoom+1),g,{},D,[],z),Z=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValue(Z,u,N,$)}updatePaintArray(u,g,T,D){const z=this.expression.evaluate({zoom:this.zoom},T,D),N=this.expression.evaluate({zoom:this.zoom+1},T,D);this._setPaintValue(u,g,z,N)}_setPaintValue(u,g,T,D){if(this.type==="color"){const z=Xv(T),N=Xv(D);for(let $=u;$<g;$++)this.paintVertexArray.emplace($,z[0],z[1],N[0],N[1])}else{for(let z=u;z<g;z++)this.paintVertexArray.emplace(z,T,D);this.maxValue=Math.max(this.maxValue,Math.abs(T),Math.abs(D))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(u,g){const T=this.useIntegerZoom?Math.floor(g.zoom):g.zoom,D=k(this.expression.interpolationFactor(T,this.zoom,this.zoom+1),0,1);u.set(D)}getBinding(u,g,T){return new Mu(u,g)}}class Dc{constructor(u,g,T,D,z,N){this.expression=u,this.type=g,this.useIntegerZoom=T,this.zoom=D,this.layerId=N,this.zoomInPaintVertexArray=new z,this.zoomOutPaintVertexArray=new z}populatePaintArray(u,g,T){const D=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(u),this.zoomOutPaintVertexArray.resize(u),this._setPaintValues(D,u,g.patterns&&g.patterns[this.layerId],T)}updatePaintArray(u,g,T,D,z){this._setPaintValues(u,g,T.patterns&&T.patterns[this.layerId],z)}_setPaintValues(u,g,T,D){if(!D||!T)return;const{min:z,mid:N,max:$}=T,Z=D[z],re=D[N],Ae=D[$];if(Z&&re&&Ae)for(let ce=u;ce<g;ce++)this.zoomInPaintVertexArray.emplace(ce,re.tl[0],re.tl[1],re.br[0],re.br[1],Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],re.pixelRatio,Z.pixelRatio),this.zoomOutPaintVertexArray.emplace(ce,re.tl[0],re.tl[1],re.br[0],re.br[1],Ae.tl[0],Ae.tl[1],Ae.br[0],Ae.br[1],re.pixelRatio,Ae.pixelRatio)}upload(u){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=u.createVertexBuffer(this.zoomInPaintVertexArray,kn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=u.createVertexBuffer(this.zoomOutPaintVertexArray,kn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Q4{constructor(u,g,T){this.binders={},this._buffers=[];const D=[];for(const z in u.paint._values){if(!T(z))continue;const N=u.paint.get(z);if(!(N instanceof xr&&gr(N.property.specification)))continue;const $=aN(z,u.type),Z=N.value,re=N.property.specification.type,Ae=N.property.useIntegerZoom,ce=N.property.specification["property-type"],ge=ce==="cross-faded"||ce==="cross-faded-data-driven";if(Z.kind==="constant")this.binders[z]=ge?new Kf(Z.value,$):new rp(Z.value,$,re),D.push(`/u_${z}`);else if(Z.kind==="source"||ge){const ye=q4(z,re,"source");this.binders[z]=ge?new Dc(Z,re,Ae,g,ye,u.id):new Pu(Z,$,re,ye),D.push(`/a_${z}`)}else{const ye=q4(z,re,"composite");this.binders[z]=new Ql(Z,$,re,Ae,g,ye),D.push(`/z_${z}`)}}this.cacheKey=D.sort().join("")}getMaxValue(u){const g=this.binders[u];return g instanceof Pu||g instanceof Ql?g.maxValue:0}populatePaintArrays(u,g,T,D,z){for(const N in this.binders){const $=this.binders[N];($ instanceof Pu||$ instanceof Ql||$ instanceof Dc)&&$.populatePaintArray(u,g,T,D,z)}}setConstantPatternPositions(u,g){for(const T in this.binders){const D=this.binders[T];D instanceof Kf&&D.setConstantPatternPositions(u,g)}}updatePaintArrays(u,g,T,D,z){let N=!1;for(const $ in u){const Z=g.getPositions($);for(const re of Z){const Ae=T.feature(re.index);for(const ce in this.binders){const ge=this.binders[ce];if((ge instanceof Pu||ge instanceof Ql||ge instanceof Dc)&&ge.expression.isStateDependent===!0){const ye=D.paint.get(ce);ge.expression=ye.value,ge.updatePaintArray(re.start,re.end,Ae,u[$],z),N=!0}}}}return N}defines(){const u=[];for(const g in this.binders){const T=this.binders[g];(T instanceof rp||T instanceof Kf)&&u.push(...T.uniformNames.map(D=>`#define HAS_UNIFORM_${D}`))}return u}getBinderAttributes(){const u=[];for(const g in this.binders){const T=this.binders[g];if(T instanceof Pu||T instanceof Ql)for(let D=0;D<T.paintVertexAttributes.length;D++)u.push(T.paintVertexAttributes[D].name);else if(T instanceof Dc)for(let D=0;D<kn.members.length;D++)u.push(kn.members[D].name)}return u}getBinderUniforms(){const u=[];for(const g in this.binders){const T=this.binders[g];if(T instanceof rp||T instanceof Kf||T instanceof Ql)for(const D of T.uniformNames)u.push(D)}return u}getPaintVertexBuffers(){return this._buffers}getUniforms(u,g){const T=[];for(const D in this.binders){const z=this.binders[D];if(z instanceof rp||z instanceof Kf||z instanceof Ql){for(const N of z.uniformNames)if(g[N]){const $=z.getBinding(u,g[N],N);T.push({name:N,property:D,binding:$})}}}return T}setUniforms(u,g,T,D){for(const{name:z,property:N,binding:$}of g)this.binders[N].setUniform($,D,T.get(N),z)}updatePaintBuffers(u){this._buffers=[];for(const g in this.binders){const T=this.binders[g];if(u&&T instanceof Dc){const D=u.fromScale===2?T.zoomInPaintVertexBuffer:T.zoomOutPaintVertexBuffer;D&&this._buffers.push(D)}else(T instanceof Pu||T instanceof Ql)&&T.paintVertexBuffer&&this._buffers.push(T.paintVertexBuffer)}}upload(u){for(const g in this.binders){const T=this.binders[g];(T instanceof Pu||T instanceof Ql||T instanceof Dc)&&T.upload(u)}this.updatePaintBuffers()}destroy(){for(const u in this.binders){const g=this.binders[u];(g instanceof Pu||g instanceof Ql||g instanceof Dc)&&g.destroy()}}}class zh{constructor(u,g,T=()=>!0){this.programConfigurations={};for(const D of u)this.programConfigurations[D.id]=new Q4(D,g,T);this.needsUpload=!1,this._featureMap=new lr,this._bufferOffset=0}populatePaintArrays(u,g,T,D,z,N){for(const $ in this.programConfigurations)this.programConfigurations[$].populatePaintArrays(u,g,D,z,N);g.id!==void 0&&this._featureMap.add(g.id,T,this._bufferOffset,u),this._bufferOffset=u,this.needsUpload=!0}updatePaintArrays(u,g,T,D){for(const z of T)this.needsUpload=this.programConfigurations[z.id].updatePaintArrays(u,this._featureMap,g,z,D)||this.needsUpload}get(u){return this.programConfigurations[u]}upload(u){if(this.needsUpload){for(const g in this.programConfigurations)this.programConfigurations[g].upload(u);this.needsUpload=!1}}destroy(){for(const u in this.programConfigurations)this.programConfigurations[u].destroy()}}function aN(f,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(`${u}-`,"").replace(/-/g,"_")]}function q4(f,u,g){const T={color:{source:A,composite:je},number:{source:ne,composite:A}},D=function(z){return{"line-pattern":{source:He,composite:He},"fill-pattern":{source:He,composite:He},"fill-extrusion-pattern":{source:He,composite:He}}[z]}(f);return D&&D[g]||T[u][g]}Nt("ConstantBinder",rp),Nt("CrossFadedConstantBinder",Kf),Nt("SourceExpressionBinder",Pu),Nt("CrossFadedCompositeBinder",Dc),Nt("CompositeExpressionBinder",Ql),Nt("ProgramConfiguration",Q4,{omit:["_buffers"]}),Nt("ProgramConfigurationSet",zh);var Oi=8192;const Kv=Math.pow(2,14)-1,Z4=-Kv-1;function Oh(f){const u=Oi/f.extent,g=f.loadGeometry();for(let T=0;T<g.length;T++){const D=g[T];for(let z=0;z<D.length;z++){const N=D[z],$=Math.round(N.x*u),Z=Math.round(N.y*u);N.x=k($,Z4,Kv),N.y=k(Z,Z4,Kv),($<N.x||$>N.x+1||Z<N.y||Z>N.y+1)&&pe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return g}function Fh(f,u){return{type:f.type,id:f.id,properties:f.properties,geometry:u?Oh(f):[]}}function e1(f,u,g,T,D){f.emplaceBack(2*u+(T+1)/2,2*g+(D+1)/2)}class Jv{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(g=>g.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new q,this.indexArray=new ot,this.segments=new gt,this.programConfigurations=new zh(u.layers,u.zoom),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id)}populate(u,g,T){const D=this.layers[0],z=[];let N=null,$=!1;D.type==="circle"&&(N=D.layout.get("circle-sort-key"),$=!N.isConstant());for(const{feature:Z,id:re,index:Ae,sourceLayerIndex:ce}of u){const ge=this.layers[0]._featureFilter.needGeometry,ye=Fh(Z,ge);if(!this.layers[0]._featureFilter.filter(new Pr(this.zoom),ye,T))continue;const _e=$?N.evaluate(ye,{},T):void 0,Ve={id:re,properties:Z.properties,type:Z.type,sourceLayerIndex:ce,index:Ae,geometry:ge?ye.geometry:Oh(Z),patterns:{},sortKey:_e};z.push(Ve)}$&&z.sort((Z,re)=>Z.sortKey-re.sortKey);for(const Z of z){const{geometry:re,index:Ae,sourceLayerIndex:ce}=Z,ge=u[Ae].feature;this.addFeature(Z,re,Ae,T),g.featureIndex.insert(ge,re,Ae,ce,this.index)}}update(u,g,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,g,this.stateDependentLayers,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,zt),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(u,g,T,D){for(const z of g)for(const N of z){const $=N.x,Z=N.y;if($<0||$>=Oi||Z<0||Z>=Oi)continue;const re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,u.sortKey),Ae=re.vertexLength;e1(this.layoutVertexArray,$,Z,-1,-1),e1(this.layoutVertexArray,$,Z,1,-1),e1(this.layoutVertexArray,$,Z,1,1),e1(this.layoutVertexArray,$,Z,-1,1),this.indexArray.emplaceBack(Ae,Ae+1,Ae+2),this.indexArray.emplaceBack(Ae,Ae+3,Ae+2),re.vertexLength+=4,re.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,{},D)}}function Y4(f,u){for(let g=0;g<f.length;g++)if(Jf(u,f[g]))return!0;for(let g=0;g<u.length;g++)if(Jf(f,u[g]))return!0;return!!ex(f,u)}function lN(f,u,g){return!!Jf(f,u)||!!tx(u,f,g)}function X4(f,u){if(f.length===1)return J4(u,f[0]);for(let g=0;g<u.length;g++){const T=u[g];for(let D=0;D<T.length;D++)if(Jf(f,T[D]))return!0}for(let g=0;g<f.length;g++)if(J4(u,f[g]))return!0;for(let g=0;g<u.length;g++)if(ex(f,u[g]))return!0;return!1}function AN(f,u,g){if(f.length>1){if(ex(f,u))return!0;for(let T=0;T<u.length;T++)if(tx(u[T],f,g))return!0}for(let T=0;T<f.length;T++)if(tx(f[T],u,g))return!0;return!1}function ex(f,u){if(f.length===0||u.length===0)return!1;for(let g=0;g<f.length-1;g++){const T=f[g],D=f[g+1];for(let z=0;z<u.length-1;z++)if(uN(T,D,u[z],u[z+1]))return!0}return!1}function uN(f,u,g,T){return be(f,g,T)!==be(u,g,T)&&be(f,u,g)!==be(f,u,T)}function tx(f,u,g){const T=g*g;if(u.length===1)return f.distSqr(u[0])<T;for(let D=1;D<u.length;D++)if(K4(f,u[D-1],u[D])<T)return!0;return!1}function K4(f,u,g){const T=u.distSqr(g);if(T===0)return f.distSqr(u);const D=((f.x-u.x)*(g.x-u.x)+(f.y-u.y)*(g.y-u.y))/T;return f.distSqr(D<0?u:D>1?g:g.sub(u)._mult(D)._add(u))}function J4(f,u){let g,T,D,z=!1;for(let N=0;N<f.length;N++){g=f[N];for(let $=0,Z=g.length-1;$<g.length;Z=$++)T=g[$],D=g[Z],T.y>u.y!=D.y>u.y&&u.x<(D.x-T.x)*(u.y-T.y)/(D.y-T.y)+T.x&&(z=!z)}return z}function Jf(f,u){let g=!1;for(let T=0,D=f.length-1;T<f.length;D=T++){const z=f[T],N=f[D];z.y>u.y!=N.y>u.y&&u.x<(N.x-z.x)*(u.y-z.y)/(N.y-z.y)+z.x&&(g=!g)}return g}function cN(f,u,g){const T=g[0],D=g[2];if(f.x<T.x&&u.x<T.x||f.x>D.x&&u.x>D.x||f.y<T.y&&u.y<T.y||f.y>D.y&&u.y>D.y)return!1;const z=be(f,u,g[0]);return z!==be(f,u,g[1])||z!==be(f,u,g[2])||z!==be(f,u,g[3])}function ip(f,u,g){const T=u.paint.get(f).value;return T.kind==="constant"?T.value:g.programConfigurations.get(u.id).getMaxValue(f)}function t1(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function n1(f,u,g,T,D){if(!u[0]&&!u[1])return f;const z=Et.convert(u)._mult(D);g==="viewport"&&z._rotate(-T);const N=[];for(let $=0;$<f.length;$++)N.push(f[$].sub(z));return N}Nt("CircleBucket",Jv,{omit:["layers"]});const hN=new jr({"circle-sort-key":new Kt(ht.layout_circle["circle-sort-key"])});var fN={paint:new jr({"circle-radius":new Kt(ht.paint_circle["circle-radius"]),"circle-color":new Kt(ht.paint_circle["circle-color"]),"circle-blur":new Kt(ht.paint_circle["circle-blur"]),"circle-opacity":new Kt(ht.paint_circle["circle-opacity"]),"circle-translate":new Xt(ht.paint_circle["circle-translate"]),"circle-translate-anchor":new Xt(ht.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xt(ht.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xt(ht.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Kt(ht.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Kt(ht.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Kt(ht.paint_circle["circle-stroke-opacity"])}),layout:hN},Js=1e-6,eo=typeof Float32Array<"u"?Float32Array:Array;function e5(){var f=new eo(9);return eo!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[5]=0,f[6]=0,f[7]=0),f[0]=1,f[4]=1,f[8]=1,f}function nx(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function t5(f,u,g){var T=u[0],D=u[1],z=u[2],N=u[3],$=u[4],Z=u[5],re=u[6],Ae=u[7],ce=u[8],ge=u[9],ye=u[10],_e=u[11],Ve=u[12],Fe=u[13],it=u[14],ut=u[15],tt=g[0],at=g[1],yt=g[2],mt=g[3];return f[0]=tt*T+at*$+yt*ce+mt*Ve,f[1]=tt*D+at*Z+yt*ge+mt*Fe,f[2]=tt*z+at*re+yt*ye+mt*it,f[3]=tt*N+at*Ae+yt*_e+mt*ut,f[4]=(tt=g[4])*T+(at=g[5])*$+(yt=g[6])*ce+(mt=g[7])*Ve,f[5]=tt*D+at*Z+yt*ge+mt*Fe,f[6]=tt*z+at*re+yt*ye+mt*it,f[7]=tt*N+at*Ae+yt*_e+mt*ut,f[8]=(tt=g[8])*T+(at=g[9])*$+(yt=g[10])*ce+(mt=g[11])*Ve,f[9]=tt*D+at*Z+yt*ge+mt*Fe,f[10]=tt*z+at*re+yt*ye+mt*it,f[11]=tt*N+at*Ae+yt*_e+mt*ut,f[12]=(tt=g[12])*T+(at=g[13])*$+(yt=g[14])*ce+(mt=g[15])*Ve,f[13]=tt*D+at*Z+yt*ge+mt*Fe,f[14]=tt*z+at*re+yt*ye+mt*it,f[15]=tt*N+at*Ae+yt*_e+mt*ut,f}Math.hypot||(Math.hypot=function(){for(var f=0,u=arguments.length;u--;)f+=arguments[u]*arguments[u];return Math.sqrt(f)});var sp,dN=t5;function n5(){var f=new eo(3);return eo!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f}function r5(f,u,g){var T=new eo(3);return T[0]=f,T[1]=u,T[2]=g,T}function r1(f,u,g){var T=u[0],D=u[1],z=u[2],N=u[3];return f[0]=g[0]*T+g[4]*D+g[8]*z+g[12]*N,f[1]=g[1]*T+g[5]*D+g[9]*z+g[13]*N,f[2]=g[2]*T+g[6]*D+g[10]*z+g[14]*N,f[3]=g[3]*T+g[7]*D+g[11]*z+g[15]*N,f}function i5(){var f=new eo(4);return eo!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f[3]=1,f}function s5(f,u){const g=r1([],[f.x,f.y,0,1],u);return new Et(g[0]/g[3],g[1]/g[3])}n5(),sp=new eo(4),eo!=Float32Array&&(sp[0]=0,sp[1]=0,sp[2]=0,sp[3]=0),n5(),r5(1,0,0),r5(0,1,0),i5(),i5(),e5(),function(){var f;f=new eo(2),eo!=Float32Array&&(f[0]=0,f[1]=0)}();class o5 extends Jv{}Nt("HeatmapBucket",o5,{omit:["layers"]});var pN={paint:new jr({"heatmap-radius":new Kt(ht.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Kt(ht.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xt(ht.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ta(ht.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xt(ht.paint_heatmap["heatmap-opacity"])})};function rx(f,{width:u,height:g},T,D){if(D){if(D instanceof Uint8ClampedArray)D=new Uint8Array(D.buffer);else if(D.length!==u*g*T)throw new RangeError(`mismatched image size. expected: ${D.length} but got: ${u*g*T}`)}else D=new Uint8Array(u*g*T);return f.width=u,f.height=g,f.data=D,f}function a5(f,{width:u,height:g},T){if(u===f.width&&g===f.height)return;const D=rx({},{width:u,height:g},T);ix(f,D,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,u),height:Math.min(f.height,g)},T),f.width=u,f.height=g,f.data=D.data}function ix(f,u,g,T,D,z){if(D.width===0||D.height===0)return u;if(D.width>f.width||D.height>f.height||g.x>f.width-D.width||g.y>f.height-D.height)throw new RangeError("out of range source coordinates for image copy");if(D.width>u.width||D.height>u.height||T.x>u.width-D.width||T.y>u.height-D.height)throw new RangeError("out of range destination coordinates for image copy");const N=f.data,$=u.data;if(N===$)throw new Error("srcData equals dstData, so image is already copied");for(let Z=0;Z<D.height;Z++){const re=((g.y+Z)*f.width+g.x)*z,Ae=((T.y+Z)*u.width+T.x)*z;for(let ce=0;ce<D.width*z;ce++)$[Ae+ce]=N[re+ce]}return u}class op{constructor(u,g){rx(this,u,1,g)}resize(u){a5(this,u,1)}clone(){return new op({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,g,T,D,z){ix(u,g,T,D,z,1)}}class Ca{constructor(u,g){rx(this,u,4,g)}resize(u){a5(this,u,4)}replace(u,g){g?this.data.set(u):this.data=u instanceof Uint8ClampedArray?new Uint8Array(u.buffer):u}clone(){return new Ca({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,g,T,D,z){ix(u,g,T,D,z,4)}}function l5(f){const u={},g=f.resolution||256,T=f.clips?f.clips.length:1,D=f.image||new Ca({width:g,height:T});if(Math.log(g)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${g}`);const z=(N,$,Z)=>{u[f.evaluationKey]=Z;const re=f.expression.evaluate(u);D.data[N+$+0]=Math.floor(255*re.r/re.a),D.data[N+$+1]=Math.floor(255*re.g/re.a),D.data[N+$+2]=Math.floor(255*re.b/re.a),D.data[N+$+3]=Math.floor(255*re.a)};if(f.clips)for(let N=0,$=0;N<T;++N,$+=4*g)for(let Z=0,re=0;Z<g;Z++,re+=4){const Ae=Z/(g-1),{start:ce,end:ge}=f.clips[N];z($,re,ce*(1-Ae)+ge*Ae)}else for(let N=0,$=0;N<g;N++,$+=4)z(0,$,N/(g-1));return D}Nt("AlphaImage",op),Nt("RGBAImage",Ca);var gN={paint:new jr({"hillshade-illumination-direction":new Xt(ht.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xt(ht.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xt(ht.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xt(ht.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xt(ht.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xt(ht.paint_hillshade["hillshade-accent-color"])})};const mN=Hr([{name:"a_pos",components:2,type:"Int16"}],4),{members:yN}=mN;var i1={exports:{}};function s1(f,u,g){g=g||2;var T,D,z,N,$,Z,re,Ae=u&&u.length,ce=Ae?u[0]*g:f.length,ge=A5(f,0,ce,g,!0),ye=[];if(!ge||ge.next===ge.prev)return ye;if(Ae&&(ge=function(Ve,Fe,it,ut){var tt,at,yt,mt=[];for(tt=0,at=Fe.length;tt<at;tt++)(yt=A5(Ve,Fe[tt]*ut,tt<at-1?Fe[tt+1]*ut:Ve.length,ut,!1))===yt.next&&(yt.steiner=!0),mt.push(SN(yt));for(mt.sort(bN),tt=0;tt<mt.length;tt++)it=EN(mt[tt],it);return it}(f,u,ge,g)),f.length>80*g){T=z=f[0],D=N=f[1];for(var _e=g;_e<ce;_e+=g)($=f[_e])<T&&(T=$),(Z=f[_e+1])<D&&(D=Z),$>z&&(z=$),Z>N&&(N=Z);re=(re=Math.max(z-T,N-D))!==0?32767/re:0}return ap(ge,ye,g,T,D,re,0),ye}function A5(f,u,g,T,D){var z,N;if(D===ax(f,u,g,T)>0)for(z=u;z<g;z+=T)N=h5(z,f[z],f[z+1],N);else for(z=g-T;z>=u;z-=T)N=h5(z,f[z],f[z+1],N);return N&&o1(N,N.next)&&(Ap(N),N=N.next),N}function Nh(f,u){if(!f)return f;u||(u=f);var g,T=f;do if(g=!1,T.steiner||!o1(T,T.next)&&_i(T.prev,T,T.next)!==0)T=T.next;else{if(Ap(T),(T=u=T.prev)===T.next)break;g=!0}while(g||T!==u);return u}function ap(f,u,g,T,D,z,N){if(f){!N&&z&&function(Ae,ce,ge,ye){var _e=Ae;do _e.z===0&&(_e.z=sx(_e.x,_e.y,ce,ge,ye)),_e.prevZ=_e.prev,_e.nextZ=_e.next,_e=_e.next;while(_e!==Ae);_e.prevZ.nextZ=null,_e.prevZ=null,function(Ve){var Fe,it,ut,tt,at,yt,mt,Zt,tn=1;do{for(it=Ve,Ve=null,at=null,yt=0;it;){for(yt++,ut=it,mt=0,Fe=0;Fe<tn&&(mt++,ut=ut.nextZ);Fe++);for(Zt=tn;mt>0||Zt>0&&ut;)mt!==0&&(Zt===0||!ut||it.z<=ut.z)?(tt=it,it=it.nextZ,mt--):(tt=ut,ut=ut.nextZ,Zt--),at?at.nextZ=tt:Ve=tt,tt.prevZ=at,at=tt;it=ut}at.nextZ=null,tn*=2}while(yt>1)}(_e)}(f,T,D,z);for(var $,Z,re=f;f.prev!==f.next;)if($=f.prev,Z=f.next,z?vN(f,T,D,z):_N(f))u.push($.i/g|0),u.push(f.i/g|0),u.push(Z.i/g|0),Ap(f),f=Z.next,re=Z.next;else if((f=Z)===re){N?N===1?ap(f=xN(Nh(f),u,g),u,g,T,D,z,2):N===2&&wN(f,u,g,T,D,z):ap(Nh(f),u,g,T,D,z,1);break}}}function _N(f){var u=f.prev,g=f,T=f.next;if(_i(u,g,T)>=0)return!1;for(var D=u.x,z=g.x,N=T.x,$=u.y,Z=g.y,re=T.y,Ae=D<z?D<N?D:N:z<N?z:N,ce=$<Z?$<re?$:re:Z<re?Z:re,ge=D>z?D>N?D:N:z>N?z:N,ye=$>Z?$>re?$:re:Z>re?Z:re,_e=T.next;_e!==u;){if(_e.x>=Ae&&_e.x<=ge&&_e.y>=ce&&_e.y<=ye&&e0(D,$,z,Z,N,re,_e.x,_e.y)&&_i(_e.prev,_e,_e.next)>=0)return!1;_e=_e.next}return!0}function vN(f,u,g,T){var D=f.prev,z=f,N=f.next;if(_i(D,z,N)>=0)return!1;for(var $=D.x,Z=z.x,re=N.x,Ae=D.y,ce=z.y,ge=N.y,ye=$<Z?$<re?$:re:Z<re?Z:re,_e=Ae<ce?Ae<ge?Ae:ge:ce<ge?ce:ge,Ve=$>Z?$>re?$:re:Z>re?Z:re,Fe=Ae>ce?Ae>ge?Ae:ge:ce>ge?ce:ge,it=sx(ye,_e,u,g,T),ut=sx(Ve,Fe,u,g,T),tt=f.prevZ,at=f.nextZ;tt&&tt.z>=it&&at&&at.z<=ut;){if(tt.x>=ye&&tt.x<=Ve&&tt.y>=_e&&tt.y<=Fe&&tt!==D&&tt!==N&&e0($,Ae,Z,ce,re,ge,tt.x,tt.y)&&_i(tt.prev,tt,tt.next)>=0||(tt=tt.prevZ,at.x>=ye&&at.x<=Ve&&at.y>=_e&&at.y<=Fe&&at!==D&&at!==N&&e0($,Ae,Z,ce,re,ge,at.x,at.y)&&_i(at.prev,at,at.next)>=0))return!1;at=at.nextZ}for(;tt&&tt.z>=it;){if(tt.x>=ye&&tt.x<=Ve&&tt.y>=_e&&tt.y<=Fe&&tt!==D&&tt!==N&&e0($,Ae,Z,ce,re,ge,tt.x,tt.y)&&_i(tt.prev,tt,tt.next)>=0)return!1;tt=tt.prevZ}for(;at&&at.z<=ut;){if(at.x>=ye&&at.x<=Ve&&at.y>=_e&&at.y<=Fe&&at!==D&&at!==N&&e0($,Ae,Z,ce,re,ge,at.x,at.y)&&_i(at.prev,at,at.next)>=0)return!1;at=at.nextZ}return!0}function xN(f,u,g){var T=f;do{var D=T.prev,z=T.next.next;!o1(D,z)&&u5(D,T,T.next,z)&&lp(D,z)&&lp(z,D)&&(u.push(D.i/g|0),u.push(T.i/g|0),u.push(z.i/g|0),Ap(T),Ap(T.next),T=f=z),T=T.next}while(T!==f);return Nh(T)}function wN(f,u,g,T,D,z){var N=f;do{for(var $=N.next.next;$!==N.prev;){if(N.i!==$.i&&CN(N,$)){var Z=c5(N,$);return N=Nh(N,N.next),Z=Nh(Z,Z.next),ap(N,u,g,T,D,z,0),void ap(Z,u,g,T,D,z,0)}$=$.next}N=N.next}while(N!==f)}function bN(f,u){return f.x-u.x}function EN(f,u){var g=function(D,z){var N,$=z,Z=D.x,re=D.y,Ae=-1/0;do{if(re<=$.y&&re>=$.next.y&&$.next.y!==$.y){var ce=$.x+(re-$.y)*($.next.x-$.x)/($.next.y-$.y);if(ce<=Z&&ce>Ae&&(Ae=ce,N=$.x<$.next.x?$:$.next,ce===Z))return N}$=$.next}while($!==z);if(!N)return null;var ge,ye=N,_e=N.x,Ve=N.y,Fe=1/0;$=N;do Z>=$.x&&$.x>=_e&&Z!==$.x&&e0(re<Ve?Z:Ae,re,_e,Ve,re<Ve?Ae:Z,re,$.x,$.y)&&(ge=Math.abs(re-$.y)/(Z-$.x),lp($,D)&&(ge<Fe||ge===Fe&&($.x>N.x||$.x===N.x&&TN(N,$)))&&(N=$,Fe=ge)),$=$.next;while($!==ye);return N}(f,u);if(!g)return u;var T=c5(g,f);return Nh(T,T.next),Nh(g,g.next)}function TN(f,u){return _i(f.prev,f,u.prev)<0&&_i(u.next,f,f.next)<0}function sx(f,u,g,T,D){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-g)*D|0)|f<<8))|f<<4))|f<<2))|f<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-T)*D|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function SN(f){var u=f,g=f;do(u.x<g.x||u.x===g.x&&u.y<g.y)&&(g=u),u=u.next;while(u!==f);return g}function e0(f,u,g,T,D,z,N,$){return(D-N)*(u-$)>=(f-N)*(z-$)&&(f-N)*(T-$)>=(g-N)*(u-$)&&(g-N)*(z-$)>=(D-N)*(T-$)}function CN(f,u){return f.next.i!==u.i&&f.prev.i!==u.i&&!function(g,T){var D=g;do{if(D.i!==g.i&&D.next.i!==g.i&&D.i!==T.i&&D.next.i!==T.i&&u5(D,D.next,g,T))return!0;D=D.next}while(D!==g);return!1}(f,u)&&(lp(f,u)&&lp(u,f)&&function(g,T){var D=g,z=!1,N=(g.x+T.x)/2,$=(g.y+T.y)/2;do D.y>$!=D.next.y>$&&D.next.y!==D.y&&N<(D.next.x-D.x)*($-D.y)/(D.next.y-D.y)+D.x&&(z=!z),D=D.next;while(D!==g);return z}(f,u)&&(_i(f.prev,f,u.prev)||_i(f,u.prev,u))||o1(f,u)&&_i(f.prev,f,f.next)>0&&_i(u.prev,u,u.next)>0)}function _i(f,u,g){return(u.y-f.y)*(g.x-u.x)-(u.x-f.x)*(g.y-u.y)}function o1(f,u){return f.x===u.x&&f.y===u.y}function u5(f,u,g,T){var D=l1(_i(f,u,g)),z=l1(_i(f,u,T)),N=l1(_i(g,T,f)),$=l1(_i(g,T,u));return D!==z&&N!==$||!(D!==0||!a1(f,g,u))||!(z!==0||!a1(f,T,u))||!(N!==0||!a1(g,f,T))||!($!==0||!a1(g,u,T))}function a1(f,u,g){return u.x<=Math.max(f.x,g.x)&&u.x>=Math.min(f.x,g.x)&&u.y<=Math.max(f.y,g.y)&&u.y>=Math.min(f.y,g.y)}function l1(f){return f>0?1:f<0?-1:0}function lp(f,u){return _i(f.prev,f,f.next)<0?_i(f,u,f.next)>=0&&_i(f,f.prev,u)>=0:_i(f,u,f.prev)<0||_i(f,f.next,u)<0}function c5(f,u){var g=new ox(f.i,f.x,f.y),T=new ox(u.i,u.x,u.y),D=f.next,z=u.prev;return f.next=u,u.prev=f,g.next=D,D.prev=g,T.next=g,g.prev=T,z.next=T,T.prev=z,T}function h5(f,u,g,T){var D=new ox(f,u,g);return T?(D.next=T.next,D.prev=T,T.next.prev=D,T.next=D):(D.prev=D,D.next=D),D}function Ap(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function ox(f,u,g){this.i=f,this.x=u,this.y=g,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ax(f,u,g,T){for(var D=0,z=u,N=g-T;z<g;z+=T)D+=(f[N]-f[z])*(f[z+1]+f[N+1]),N=z;return D}function MN(f,u,g,T,D){f5(f,u,g||0,T||f.length-1,D||PN)}function f5(f,u,g,T,D){for(;T>g;){if(T-g>600){var z=T-g+1,N=u-g+1,$=Math.log(z),Z=.5*Math.exp(2*$/3),re=.5*Math.sqrt($*Z*(z-Z)/z)*(N-z/2<0?-1:1);f5(f,u,Math.max(g,Math.floor(u-N*Z/z+re)),Math.min(T,Math.floor(u+(z-N)*Z/z+re)),D)}var Ae=f[u],ce=g,ge=T;for(up(f,g,u),D(f[T],Ae)>0&&up(f,g,T);ce<ge;){for(up(f,ce,ge),ce++,ge--;D(f[ce],Ae)<0;)ce++;for(;D(f[ge],Ae)>0;)ge--}D(f[g],Ae)===0?up(f,g,ge):up(f,++ge,T),ge<=u&&(g=ge+1),u<=ge&&(T=ge-1)}}function up(f,u,g){var T=f[u];f[u]=f[g],f[g]=T}function PN(f,u){return f<u?-1:f>u?1:0}function lx(f,u){const g=f.length;if(g<=1)return[f];const T=[];let D,z;for(let N=0;N<g;N++){const $=Ge(f[N]);$!==0&&(f[N].area=Math.abs($),z===void 0&&(z=$<0),z===$<0?(D&&T.push(D),D=[f[N]]):D.push(f[N]))}if(D&&T.push(D),u>1)for(let N=0;N<T.length;N++)T[N].length<=u||(MN(T[N],u,1,T[N].length-1,kN),T[N]=T[N].slice(0,u));return T}function kN(f,u){return u.area-f.area}function Ax(f,u,g){const T=g.patternDependencies;let D=!1;for(const z of u){const N=z.paint.get(`${f}-pattern`);N.isConstant()||(D=!0);const $=N.constantOr(null);$&&(D=!0,T[$.to]=!0,T[$.from]=!0)}return D}function ux(f,u,g,T,D){const z=D.patternDependencies;for(const N of u){const $=N.paint.get(`${f}-pattern`).value;if($.kind!=="constant"){let Z=$.evaluate({zoom:T-1},g,{},D.availableImages),re=$.evaluate({zoom:T},g,{},D.availableImages),Ae=$.evaluate({zoom:T+1},g,{},D.availableImages);Z=Z&&Z.name?Z.name:Z,re=re&&re.name?re.name:re,Ae=Ae&&Ae.name?Ae.name:Ae,z[Z]=!0,z[re]=!0,z[Ae]=!0,g.patterns[N.id]={min:Z,mid:re,max:Ae}}}return g}i1.exports=s1,i1.exports.default=s1,s1.deviation=function(f,u,g,T){var D=u&&u.length,z=Math.abs(ax(f,0,D?u[0]*g:f.length,g));if(D)for(var N=0,$=u.length;N<$;N++)z-=Math.abs(ax(f,u[N]*g,N<$-1?u[N+1]*g:f.length,g));var Z=0;for(N=0;N<T.length;N+=3){var re=T[N]*g,Ae=T[N+1]*g,ce=T[N+2]*g;Z+=Math.abs((f[re]-f[ce])*(f[Ae+1]-f[re+1])-(f[re]-f[Ae])*(f[ce+1]-f[re+1]))}return z===0&&Z===0?0:Math.abs((Z-z)/z)},s1.flatten=function(f){for(var u=f[0][0].length,g={vertices:[],holes:[],dimensions:u},T=0,D=0;D<f.length;D++){for(var z=0;z<f[D].length;z++)for(var N=0;N<u;N++)g.vertices.push(f[D][z][N]);D>0&&g.holes.push(T+=f[D-1].length)}return g};class cx{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(g=>g.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ee,this.indexArray=new ot,this.indexArray2=new et,this.programConfigurations=new zh(u.layers,u.zoom),this.segments=new gt,this.segments2=new gt,this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id)}populate(u,g,T){this.hasPattern=Ax("fill",this.layers,g);const D=this.layers[0].layout.get("fill-sort-key"),z=!D.isConstant(),N=[];for(const{feature:$,id:Z,index:re,sourceLayerIndex:Ae}of u){const ce=this.layers[0]._featureFilter.needGeometry,ge=Fh($,ce);if(!this.layers[0]._featureFilter.filter(new Pr(this.zoom),ge,T))continue;const ye=z?D.evaluate(ge,{},T,g.availableImages):void 0,_e={id:Z,properties:$.properties,type:$.type,sourceLayerIndex:Ae,index:re,geometry:ce?ge.geometry:Oh($),patterns:{},sortKey:ye};N.push(_e)}z&&N.sort(($,Z)=>$.sortKey-Z.sortKey);for(const $ of N){const{geometry:Z,index:re,sourceLayerIndex:Ae}=$;if(this.hasPattern){const ce=ux("fill",this.layers,$,this.zoom,g);this.patternFeatures.push(ce)}else this.addFeature($,Z,re,T,{});g.featureIndex.insert(u[re].feature,Z,re,Ae,this.index)}}update(u,g,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,g,this.stateDependentLayers,T)}addFeatures(u,g,T){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,g,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,yN),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.indexBuffer2=u.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(u,g,T,D,z){for(const N of lx(g,500)){let $=0;for(const ye of N)$+=ye.length;const Z=this.segments.prepareSegment($,this.layoutVertexArray,this.indexArray),re=Z.vertexLength,Ae=[],ce=[];for(const ye of N){if(ye.length===0)continue;ye!==N[0]&&ce.push(Ae.length/2);const _e=this.segments2.prepareSegment(ye.length,this.layoutVertexArray,this.indexArray2),Ve=_e.vertexLength;this.layoutVertexArray.emplaceBack(ye[0].x,ye[0].y),this.indexArray2.emplaceBack(Ve+ye.length-1,Ve),Ae.push(ye[0].x),Ae.push(ye[0].y);for(let Fe=1;Fe<ye.length;Fe++)this.layoutVertexArray.emplaceBack(ye[Fe].x,ye[Fe].y),this.indexArray2.emplaceBack(Ve+Fe-1,Ve+Fe),Ae.push(ye[Fe].x),Ae.push(ye[Fe].y);_e.vertexLength+=ye.length,_e.primitiveLength+=ye.length}const ge=i1.exports(Ae,ce);for(let ye=0;ye<ge.length;ye+=3)this.indexArray.emplaceBack(re+ge[ye],re+ge[ye+1],re+ge[ye+2]);Z.vertexLength+=$,Z.primitiveLength+=ge.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}}Nt("FillBucket",cx,{omit:["layers","patternFeatures"]});const IN=new jr({"fill-sort-key":new Kt(ht.layout_fill["fill-sort-key"])});var LN={paint:new jr({"fill-antialias":new Xt(ht.paint_fill["fill-antialias"]),"fill-opacity":new Kt(ht.paint_fill["fill-opacity"]),"fill-color":new Kt(ht.paint_fill["fill-color"]),"fill-outline-color":new Kt(ht.paint_fill["fill-outline-color"]),"fill-translate":new Xt(ht.paint_fill["fill-translate"]),"fill-translate-anchor":new Xt(ht.paint_fill["fill-translate-anchor"]),"fill-pattern":new fn(ht.paint_fill["fill-pattern"])}),layout:IN};const DN=Hr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),RN=Hr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:BN}=DN;var Rc={},zN=Et,d5=t0;function t0(f,u,g,T,D){this.properties={},this.extent=g,this.type=0,this._pbf=f,this._geometry=-1,this._keys=T,this._values=D,f.readFields(ON,this,u)}function ON(f,u,g){f==1?u.id=g.readVarint():f==2?function(T,D){for(var z=T.readVarint()+T.pos;T.pos<z;){var N=D._keys[T.readVarint()],$=D._values[T.readVarint()];D.properties[N]=$}}(g,u):f==3?u.type=g.readVarint():f==4&&(u._geometry=g.pos)}function FN(f){for(var u,g,T=0,D=0,z=f.length,N=z-1;D<z;N=D++)T+=((g=f[N]).x-(u=f[D]).x)*(u.y+g.y);return T}t0.types=["Unknown","Point","LineString","Polygon"],t0.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var u,g=f.readVarint()+f.pos,T=1,D=0,z=0,N=0,$=[];f.pos<g;){if(D<=0){var Z=f.readVarint();T=7&Z,D=Z>>3}if(D--,T===1||T===2)z+=f.readSVarint(),N+=f.readSVarint(),T===1&&(u&&$.push(u),u=[]),u.push(new zN(z,N));else{if(T!==7)throw new Error("unknown command "+T);u&&u.push(u[0].clone())}}return u&&$.push(u),$},t0.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var u=f.readVarint()+f.pos,g=1,T=0,D=0,z=0,N=1/0,$=-1/0,Z=1/0,re=-1/0;f.pos<u;){if(T<=0){var Ae=f.readVarint();g=7&Ae,T=Ae>>3}if(T--,g===1||g===2)(D+=f.readSVarint())<N&&(N=D),D>$&&($=D),(z+=f.readSVarint())<Z&&(Z=z),z>re&&(re=z);else if(g!==7)throw new Error("unknown command "+g)}return[N,Z,$,re]},t0.prototype.toGeoJSON=function(f,u,g){var T,D,z=this.extent*Math.pow(2,g),N=this.extent*f,$=this.extent*u,Z=this.loadGeometry(),re=t0.types[this.type];function Ae(ye){for(var _e=0;_e<ye.length;_e++){var Ve=ye[_e];ye[_e]=[360*(Ve.x+N)/z-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ve.y+$)/z)*Math.PI/180))-90]}}switch(this.type){case 1:var ce=[];for(T=0;T<Z.length;T++)ce[T]=Z[T][0];Ae(Z=ce);break;case 2:for(T=0;T<Z.length;T++)Ae(Z[T]);break;case 3:for(Z=function(ye){var _e=ye.length;if(_e<=1)return[ye];for(var Ve,Fe,it=[],ut=0;ut<_e;ut++){var tt=FN(ye[ut]);tt!==0&&(Fe===void 0&&(Fe=tt<0),Fe===tt<0?(Ve&&it.push(Ve),Ve=[ye[ut]]):Ve.push(ye[ut]))}return Ve&&it.push(Ve),it}(Z),T=0;T<Z.length;T++)for(D=0;D<Z[T].length;D++)Ae(Z[T][D])}Z.length===1?Z=Z[0]:re="Multi"+re;var ge={type:"Feature",geometry:{type:re,coordinates:Z},properties:this.properties};return"id"in this&&(ge.id=this.id),ge};var NN=d5,p5=g5;function g5(f,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(UN,this,u),this.length=this._features.length}function UN(f,u,g){f===15?u.version=g.readVarint():f===1?u.name=g.readString():f===5?u.extent=g.readVarint():f===2?u._features.push(g.pos):f===3?u._keys.push(g.readString()):f===4&&u._values.push(function(T){for(var D=null,z=T.readVarint()+T.pos;T.pos<z;){var N=T.readVarint()>>3;D=N===1?T.readString():N===2?T.readFloat():N===3?T.readDouble():N===4?T.readVarint64():N===5?T.readVarint():N===6?T.readSVarint():N===7?T.readBoolean():null}return D}(g))}g5.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var u=this._pbf.readVarint()+this._pbf.pos;return new NN(this._pbf,u,this.extent,this._keys,this._values)};var VN=p5;function GN(f,u,g){if(f===3){var T=new VN(g,g.readVarint()+g.pos);T.length&&(u[T.name]=T)}}Rc.VectorTile=function(f,u){this.layers=f.readFields(GN,{},u)},Rc.VectorTileFeature=d5,Rc.VectorTileLayer=p5;const $N=Rc.VectorTileFeature.types,hx=Math.pow(2,13);function cp(f,u,g,T,D,z,N,$){f.emplaceBack(u,g,2*Math.floor(T*hx)+N,D*hx*2,z*hx*2,Math.round($))}class fx{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(g=>g.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new le,this.centroidVertexArray=new U,this.indexArray=new ot,this.programConfigurations=new zh(u.layers,u.zoom),this.segments=new gt,this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id)}populate(u,g,T){this.features=[],this.hasPattern=Ax("fill-extrusion",this.layers,g);for(const{feature:D,id:z,index:N,sourceLayerIndex:$}of u){const Z=this.layers[0]._featureFilter.needGeometry,re=Fh(D,Z);if(!this.layers[0]._featureFilter.filter(new Pr(this.zoom),re,T))continue;const Ae={id:z,sourceLayerIndex:$,index:N,geometry:Z?re.geometry:Oh(D),properties:D.properties,type:D.type,patterns:{}};this.hasPattern?this.features.push(ux("fill-extrusion",this.layers,Ae,this.zoom,g)):this.addFeature(Ae,Ae.geometry,N,T,{}),g.featureIndex.insert(D,Ae.geometry,N,$,this.index,!0)}}addFeatures(u,g,T){for(const D of this.features){const{geometry:z}=D;this.addFeature(D,z,D.index,g,T)}}update(u,g,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,g,this.stateDependentLayers,T)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,BN),this.centroidVertexBuffer=u.createVertexBuffer(this.centroidVertexArray,RN.members,!0),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(u,g,T,D,z){const N={x:0,y:0,vertexCount:0};for(const $ of lx(g,500)){let Z=0;for(const _e of $)Z+=_e.length;let re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const _e of $){if(_e.length===0||HN(_e))continue;let Ve=0;for(let Fe=0;Fe<_e.length;Fe++){const it=_e[Fe];if(Fe>=1){const ut=_e[Fe-1];if(!jN(it,ut)){re.vertexLength+4>gt.MAX_VERTEX_ARRAY_LENGTH&&(re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const tt=it.sub(ut)._perp()._unit(),at=ut.dist(it);Ve+at>32768&&(Ve=0),cp(this.layoutVertexArray,it.x,it.y,tt.x,tt.y,0,0,Ve),cp(this.layoutVertexArray,it.x,it.y,tt.x,tt.y,0,1,Ve),N.x+=2*it.x,N.y+=2*it.y,N.vertexCount+=2,Ve+=at,cp(this.layoutVertexArray,ut.x,ut.y,tt.x,tt.y,0,0,Ve),cp(this.layoutVertexArray,ut.x,ut.y,tt.x,tt.y,0,1,Ve),N.x+=2*ut.x,N.y+=2*ut.y,N.vertexCount+=2;const yt=re.vertexLength;this.indexArray.emplaceBack(yt,yt+2,yt+1),this.indexArray.emplaceBack(yt+1,yt+2,yt+3),re.vertexLength+=4,re.primitiveLength+=2}}}}if(re.vertexLength+Z>gt.MAX_VERTEX_ARRAY_LENGTH&&(re=this.segments.prepareSegment(Z,this.layoutVertexArray,this.indexArray)),$N[u.type]!=="Polygon")continue;const Ae=[],ce=[],ge=re.vertexLength;for(const _e of $)if(_e.length!==0){_e!==$[0]&&ce.push(Ae.length/2);for(let Ve=0;Ve<_e.length;Ve++){const Fe=_e[Ve];cp(this.layoutVertexArray,Fe.x,Fe.y,0,0,1,1,0),N.x+=Fe.x,N.y+=Fe.y,N.vertexCount+=1,Ae.push(Fe.x),Ae.push(Fe.y)}}const ye=i1.exports(Ae,ce);for(let _e=0;_e<ye.length;_e+=3)this.indexArray.emplaceBack(ge+ye[_e],ge+ye[_e+2],ge+ye[_e+1]);re.primitiveLength+=ye.length/3,re.vertexLength+=Z}for(let $=0;$<N.vertexCount;$++)this.centroidVertexArray.emplaceBack(Math.floor(N.x/N.vertexCount),Math.floor(N.y/N.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}}function jN(f,u){return f.x===u.x&&(f.x<0||f.x>Oi)||f.y===u.y&&(f.y<0||f.y>Oi)}function HN(f){return f.every(u=>u.x<0)||f.every(u=>u.x>Oi)||f.every(u=>u.y<0)||f.every(u=>u.y>Oi)}Nt("FillExtrusionBucket",fx,{omit:["layers","features"]});var WN={paint:new jr({"fill-extrusion-opacity":new Xt(ht["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Kt(ht["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xt(ht["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xt(ht["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new fn(ht["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Kt(ht["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Kt(ht["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Xt(ht["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function hp(f,u){return f.x*u.x+f.y*u.y}function m5(f,u){if(f.length===1){let g=0;const T=u[g++];let D;for(;!D||T.equals(D);)if(D=u[g++],!D)return 1/0;for(;g<u.length;g++){const z=u[g],N=f[0],$=D.sub(T),Z=z.sub(T),re=N.sub(T),Ae=hp($,$),ce=hp($,Z),ge=hp(Z,Z),ye=hp(re,$),_e=hp(re,Z),Ve=Ae*ge-ce*ce,Fe=(ge*ye-ce*_e)/Ve,it=(Ae*_e-ce*ye)/Ve,ut=T.z*(1-Fe-it)+D.z*Fe+z.z*it;if(isFinite(ut))return ut}return 1/0}{let g=1/0;for(const T of u)g=Math.min(g,T.z);return g}}const QN=Hr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:qN}=QN,ZN=Hr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:YN}=ZN,XN=Rc.VectorTileFeature.types,KN=Math.cos(Math.PI/180*37.5),y5=Math.pow(2,14)/.5;class dx{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(g=>g.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(g=>{this.gradients[g.id]={}}),this.layoutVertexArray=new de,this.layoutVertexArray2=new Be,this.indexArray=new ot,this.programConfigurations=new zh(u.layers,u.zoom),this.segments=new gt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id)}populate(u,g,T){this.hasPattern=Ax("line",this.layers,g);const D=this.layers[0].layout.get("line-sort-key"),z=!D.isConstant(),N=[];for(const{feature:$,id:Z,index:re,sourceLayerIndex:Ae}of u){const ce=this.layers[0]._featureFilter.needGeometry,ge=Fh($,ce);if(!this.layers[0]._featureFilter.filter(new Pr(this.zoom),ge,T))continue;const ye=z?D.evaluate(ge,{},T):void 0,_e={id:Z,properties:$.properties,type:$.type,sourceLayerIndex:Ae,index:re,geometry:ce?ge.geometry:Oh($),patterns:{},sortKey:ye};N.push(_e)}z&&N.sort(($,Z)=>$.sortKey-Z.sortKey);for(const $ of N){const{geometry:Z,index:re,sourceLayerIndex:Ae}=$;if(this.hasPattern){const ce=ux("line",this.layers,$,this.zoom,g);this.patternFeatures.push(ce)}else this.addFeature($,Z,re,T,{});g.featureIndex.insert(u[re].feature,Z,re,Ae,this.index)}}update(u,g,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,g,this.stateDependentLayers,T)}addFeatures(u,g,T){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,g,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=u.createVertexBuffer(this.layoutVertexArray2,YN)),this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,qN),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(u){if(u.properties&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_end"))return{start:+u.properties.mapbox_clip_start,end:+u.properties.mapbox_clip_end}}addFeature(u,g,T,D,z){const N=this.layers[0].layout,$=N.get("line-join").evaluate(u,{}),Z=N.get("line-cap"),re=N.get("line-miter-limit"),Ae=N.get("line-round-limit");this.lineClips=this.lineFeatureClips(u);for(const ce of g)this.addLine(ce,u,$,Z,re,Ae);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}addLine(u,g,T,D,z,N){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let it=0;it<u.length-1;it++)this.totalDistance+=u[it].dist(u[it+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const $=XN[g.type]==="Polygon";let Z=u.length;for(;Z>=2&&u[Z-1].equals(u[Z-2]);)Z--;let re=0;for(;re<Z-1&&u[re].equals(u[re+1]);)re++;if(Z<($?3:2))return;T==="bevel"&&(z=1.05);const Ae=this.overscaling<=16?122880/(512*this.overscaling):0,ce=this.segments.prepareSegment(10*Z,this.layoutVertexArray,this.indexArray);let ge,ye,_e,Ve,Fe;this.e1=this.e2=-1,$&&(ge=u[Z-2],Fe=u[re].sub(ge)._unit()._perp());for(let it=re;it<Z;it++){if(_e=it===Z-1?$?u[re+1]:void 0:u[it+1],_e&&u[it].equals(_e))continue;Fe&&(Ve=Fe),ge&&(ye=ge),ge=u[it],Fe=_e?_e.sub(ge)._unit()._perp():Ve,Ve=Ve||Fe;let ut=Ve.add(Fe);ut.x===0&&ut.y===0||ut._unit();const tt=Ve.x*Fe.x+Ve.y*Fe.y,at=ut.x*Fe.x+ut.y*Fe.y,yt=at!==0?1/at:1/0,mt=2*Math.sqrt(2-2*at),Zt=at<KN&&ye&&_e,tn=Ve.x*Fe.y-Ve.y*Fe.x>0;if(Zt&&it>re){const Ot=ge.dist(ye);if(Ot>2*Ae){const Wt=ge.sub(ge.sub(ye)._mult(Ae/Ot)._round());this.updateDistance(ye,Wt),this.addCurrentVertex(Wt,Ve,0,0,ce),ye=Wt}}const Ht=ye&&_e;let Ut=Ht?T:$?"butt":D;if(Ht&&Ut==="round"&&(yt<N?Ut="miter":yt<=2&&(Ut="fakeround")),Ut==="miter"&&yt>z&&(Ut="bevel"),Ut==="bevel"&&(yt>2&&(Ut="flipbevel"),yt<z&&(Ut="miter")),ye&&this.updateDistance(ye,ge),Ut==="miter")ut._mult(yt),this.addCurrentVertex(ge,ut,0,0,ce);else if(Ut==="flipbevel"){if(yt>100)ut=Fe.mult(-1);else{const Ot=yt*Ve.add(Fe).mag()/Ve.sub(Fe).mag();ut._perp()._mult(Ot*(tn?-1:1))}this.addCurrentVertex(ge,ut,0,0,ce),this.addCurrentVertex(ge,ut.mult(-1),0,0,ce)}else if(Ut==="bevel"||Ut==="fakeround"){const Ot=-Math.sqrt(yt*yt-1),Wt=tn?Ot:0,$t=tn?0:Ot;if(ye&&this.addCurrentVertex(ge,Ve,Wt,$t,ce),Ut==="fakeround"){const St=Math.round(180*mt/Math.PI/20);for(let gn=1;gn<St;gn++){let ln=gn/St;if(ln!==.5){const Vr=ln-.5;ln+=ln*Vr*(ln-1)*((1.0904+tt*(tt*(3.55645-1.43519*tt)-3.2452))*Vr*Vr+(.848013+tt*(.215638*tt-1.06021)))}const Wn=Fe.sub(Ve)._mult(ln)._add(Ve)._unit()._mult(tn?-1:1);this.addHalfVertex(ge,Wn.x,Wn.y,!1,tn,0,ce)}}_e&&this.addCurrentVertex(ge,Fe,-Wt,-$t,ce)}else if(Ut==="butt")this.addCurrentVertex(ge,ut,0,0,ce);else if(Ut==="square"){const Ot=ye?1:-1;this.addCurrentVertex(ge,ut,Ot,Ot,ce)}else Ut==="round"&&(ye&&(this.addCurrentVertex(ge,Ve,0,0,ce),this.addCurrentVertex(ge,Ve,1,1,ce,!0)),_e&&(this.addCurrentVertex(ge,Fe,-1,-1,ce,!0),this.addCurrentVertex(ge,Fe,0,0,ce)));if(Zt&&it<Z-1){const Ot=ge.dist(_e);if(Ot>2*Ae){const Wt=ge.add(_e.sub(ge)._mult(Ae/Ot)._round());this.updateDistance(ge,Wt),this.addCurrentVertex(Wt,Fe,0,0,ce),ge=Wt}}}}addCurrentVertex(u,g,T,D,z,N=!1){const $=g.y*D-g.x,Z=-g.y-g.x*D;this.addHalfVertex(u,g.x+g.y*T,g.y-g.x*T,N,!1,T,z),this.addHalfVertex(u,$,Z,N,!0,-D,z),this.distance>y5/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(u,g,T,D,z,N))}addHalfVertex({x:u,y:g},T,D,z,N,$,Z){const re=.5*(this.lineClips?this.scaledDistance*(y5-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((u<<1)+(z?1:0),(g<<1)+(N?1:0),Math.round(63*T)+128,Math.round(63*D)+128,1+($===0?0:$<0?-1:1)|(63&re)<<2,re>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Ae=Z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Ae),Z.primitiveLength++),N?this.e2=Ae:this.e1=Ae}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(u,g){this.distance+=u.dist(g),this.updateScaledDistance()}}Nt("LineBucket",dx,{omit:["layers","patternFeatures"]});const JN=new jr({"line-cap":new Xt(ht.layout_line["line-cap"]),"line-join":new Kt(ht.layout_line["line-join"]),"line-miter-limit":new Xt(ht.layout_line["line-miter-limit"]),"line-round-limit":new Xt(ht.layout_line["line-round-limit"]),"line-sort-key":new Kt(ht.layout_line["line-sort-key"])});var _5={paint:new jr({"line-opacity":new Kt(ht.paint_line["line-opacity"]),"line-color":new Kt(ht.paint_line["line-color"]),"line-translate":new Xt(ht.paint_line["line-translate"]),"line-translate-anchor":new Xt(ht.paint_line["line-translate-anchor"]),"line-width":new Kt(ht.paint_line["line-width"]),"line-gap-width":new Kt(ht.paint_line["line-gap-width"]),"line-offset":new Kt(ht.paint_line["line-offset"]),"line-blur":new Kt(ht.paint_line["line-blur"]),"line-dasharray":new es(ht.paint_line["line-dasharray"]),"line-pattern":new fn(ht.paint_line["line-pattern"]),"line-gradient":new ta(ht.paint_line["line-gradient"])}),layout:JN};const v5=new class extends Kt{possiblyEvaluate(f,u){return u=new Pr(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(f,u)}evaluate(f,u,g,T){return u=j({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(f,u,g,T)}}(_5.paint.properties["line-width"].specification);function x5(f,u){return u>0?u+2*f:f}v5.useIntegerZoom=!0;const e9=Hr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),t9=Hr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Hr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const n9=Hr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Hr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const w5=Hr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),r9=Hr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function i9(f,u,g){return f.sections.forEach(T=>{T.text=function(D,z,N){const $=z.layout.get("text-transform").evaluate(N,{});return $==="uppercase"?D=D.toLocaleUpperCase():$==="lowercase"&&(D=D.toLocaleLowerCase()),gs.applyArabicShaping&&(D=gs.applyArabicShaping(D)),D}(T.text,u,g)}),f}Hr([{name:"triangle",components:3,type:"Uint16"}]),Hr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Hr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Hr([{type:"Float32",name:"offsetX"}]),Hr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const fp={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var ts=24,px=Lr,b5=function(f,u,g,T,D){var z,N,$=8*D-T-1,Z=(1<<$)-1,re=Z>>1,Ae=-7,ce=g?D-1:0,ge=g?-1:1,ye=f[u+ce];for(ce+=ge,z=ye&(1<<-Ae)-1,ye>>=-Ae,Ae+=$;Ae>0;z=256*z+f[u+ce],ce+=ge,Ae-=8);for(N=z&(1<<-Ae)-1,z>>=-Ae,Ae+=T;Ae>0;N=256*N+f[u+ce],ce+=ge,Ae-=8);if(z===0)z=1-re;else{if(z===Z)return N?NaN:1/0*(ye?-1:1);N+=Math.pow(2,T),z-=re}return(ye?-1:1)*N*Math.pow(2,z-T)},E5=function(f,u,g,T,D,z){var N,$,Z,re=8*z-D-1,Ae=(1<<re)-1,ce=Ae>>1,ge=D===23?Math.pow(2,-24)-Math.pow(2,-77):0,ye=T?0:z-1,_e=T?1:-1,Ve=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?($=isNaN(u)?1:0,N=Ae):(N=Math.floor(Math.log(u)/Math.LN2),u*(Z=Math.pow(2,-N))<1&&(N--,Z*=2),(u+=N+ce>=1?ge/Z:ge*Math.pow(2,1-ce))*Z>=2&&(N++,Z/=2),N+ce>=Ae?($=0,N=Ae):N+ce>=1?($=(u*Z-1)*Math.pow(2,D),N+=ce):($=u*Math.pow(2,ce-1)*Math.pow(2,D),N=0));D>=8;f[g+ye]=255&$,ye+=_e,$/=256,D-=8);for(N=N<<D|$,re+=D;re>0;f[g+ye]=255&N,ye+=_e,N/=256,re-=8);f[g+ye-_e]|=128*Ve};function Lr(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}Lr.Varint=0,Lr.Fixed64=1,Lr.Bytes=2,Lr.Fixed32=5;var Bc,gx=4294967296,T5=1/gx,S5=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ku(f){return f.type===Lr.Bytes?f.readVarint()+f.pos:f.pos+1}function n0(f,u,g){return g?4294967296*u+(f>>>0):4294967296*(u>>>0)+(f>>>0)}function C5(f,u,g){var T=u<=16383?1:u<=2097151?2:u<=268435455?3:Math.floor(Math.log(u)/(7*Math.LN2));g.realloc(T);for(var D=g.pos-1;D>=f;D--)g.buf[D+T]=g.buf[D]}function s9(f,u){for(var g=0;g<f.length;g++)u.writeVarint(f[g])}function o9(f,u){for(var g=0;g<f.length;g++)u.writeSVarint(f[g])}function a9(f,u){for(var g=0;g<f.length;g++)u.writeFloat(f[g])}function l9(f,u){for(var g=0;g<f.length;g++)u.writeDouble(f[g])}function A9(f,u){for(var g=0;g<f.length;g++)u.writeBoolean(f[g])}function u9(f,u){for(var g=0;g<f.length;g++)u.writeFixed32(f[g])}function c9(f,u){for(var g=0;g<f.length;g++)u.writeSFixed32(f[g])}function h9(f,u){for(var g=0;g<f.length;g++)u.writeFixed64(f[g])}function f9(f,u){for(var g=0;g<f.length;g++)u.writeSFixed64(f[g])}function A1(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+16777216*f[u+3]}function r0(f,u,g){f[g]=u,f[g+1]=u>>>8,f[g+2]=u>>>16,f[g+3]=u>>>24}function M5(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+(f[u+3]<<24)}function d9(f,u,g){f===1&&g.readMessage(p9,u)}function p9(f,u,g){if(f===3){const{id:T,bitmap:D,width:z,height:N,left:$,top:Z,advance:re}=g.readMessage(g9,{});u.push({id:T,bitmap:new op({width:z+6,height:N+6},D),metrics:{width:z,height:N,left:$,top:Z,advance:re}})}}function g9(f,u,g){f===1?u.id=g.readVarint():f===2?u.bitmap=g.readBytes():f===3?u.width=g.readVarint():f===4?u.height=g.readVarint():f===5?u.left=g.readSVarint():f===6?u.top=g.readSVarint():f===7&&(u.advance=g.readVarint())}function P5(f){let u=0,g=0;for(const N of f)u+=N.w*N.h,g=Math.max(g,N.w);f.sort((N,$)=>$.h-N.h);const T=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),g),h:1/0}];let D=0,z=0;for(const N of f)for(let $=T.length-1;$>=0;$--){const Z=T[$];if(!(N.w>Z.w||N.h>Z.h)){if(N.x=Z.x,N.y=Z.y,z=Math.max(z,N.y+N.h),D=Math.max(D,N.x+N.w),N.w===Z.w&&N.h===Z.h){const re=T.pop();$<T.length&&(T[$]=re)}else N.h===Z.h?(Z.x+=N.w,Z.w-=N.w):N.w===Z.w?(Z.y+=N.h,Z.h-=N.h):(T.push({x:Z.x+N.w,y:Z.y,w:Z.w-N.w,h:N.h}),Z.y+=N.h,Z.h-=N.h);break}}return{w:D,h:z,fill:u/(D*z)||0}}Lr.prototype={destroy:function(){this.buf=null},readFields:function(f,u,g){for(g=g||this.length;this.pos<g;){var T=this.readVarint(),D=T>>3,z=this.pos;this.type=7&T,f(D,u,this),this.pos===z&&this.skip(T)}return u},readMessage:function(f,u){return this.readFields(f,u,this.readVarint()+this.pos)},readFixed32:function(){var f=A1(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=M5(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=A1(this.buf,this.pos)+A1(this.buf,this.pos+4)*gx;return this.pos+=8,f},readSFixed64:function(){var f=A1(this.buf,this.pos)+M5(this.buf,this.pos+4)*gx;return this.pos+=8,f},readFloat:function(){var f=b5(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=b5(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var u,g,T=this.buf;return u=127&(g=T[this.pos++]),g<128?u:(u|=(127&(g=T[this.pos++]))<<7,g<128?u:(u|=(127&(g=T[this.pos++]))<<14,g<128?u:(u|=(127&(g=T[this.pos++]))<<21,g<128?u:function(D,z,N){var $,Z,re=N.buf;if($=(112&(Z=re[N.pos++]))>>4,Z<128||($|=(127&(Z=re[N.pos++]))<<3,Z<128)||($|=(127&(Z=re[N.pos++]))<<10,Z<128)||($|=(127&(Z=re[N.pos++]))<<17,Z<128)||($|=(127&(Z=re[N.pos++]))<<24,Z<128)||($|=(1&(Z=re[N.pos++]))<<31,Z<128))return n0(D,$,z);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(g=T[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var f=this.readVarint()+this.pos,u=this.pos;return this.pos=f,f-u>=12&&S5?function(g,T,D){return S5.decode(g.subarray(T,D))}(this.buf,u,f):function(g,T,D){for(var z="",N=T;N<D;){var $,Z,re,Ae=g[N],ce=null,ge=Ae>239?4:Ae>223?3:Ae>191?2:1;if(N+ge>D)break;ge===1?Ae<128&&(ce=Ae):ge===2?(192&($=g[N+1]))==128&&(ce=(31&Ae)<<6|63&$)<=127&&(ce=null):ge===3?(Z=g[N+2],(192&($=g[N+1]))==128&&(192&Z)==128&&((ce=(15&Ae)<<12|(63&$)<<6|63&Z)<=2047||ce>=55296&&ce<=57343)&&(ce=null)):ge===4&&(Z=g[N+2],re=g[N+3],(192&($=g[N+1]))==128&&(192&Z)==128&&(192&re)==128&&((ce=(15&Ae)<<18|(63&$)<<12|(63&Z)<<6|63&re)<=65535||ce>=1114112)&&(ce=null)),ce===null?(ce=65533,ge=1):ce>65535&&(ce-=65536,z+=String.fromCharCode(ce>>>10&1023|55296),ce=56320|1023&ce),z+=String.fromCharCode(ce),N+=ge}return z}(this.buf,u,f)},readBytes:function(){var f=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,f);return this.pos=f,u},readPackedVarint:function(f,u){if(this.type!==Lr.Bytes)return f.push(this.readVarint(u));var g=ku(this);for(f=f||[];this.pos<g;)f.push(this.readVarint(u));return f},readPackedSVarint:function(f){if(this.type!==Lr.Bytes)return f.push(this.readSVarint());var u=ku(this);for(f=f||[];this.pos<u;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==Lr.Bytes)return f.push(this.readBoolean());var u=ku(this);for(f=f||[];this.pos<u;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==Lr.Bytes)return f.push(this.readFloat());var u=ku(this);for(f=f||[];this.pos<u;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==Lr.Bytes)return f.push(this.readDouble());var u=ku(this);for(f=f||[];this.pos<u;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==Lr.Bytes)return f.push(this.readFixed32());var u=ku(this);for(f=f||[];this.pos<u;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==Lr.Bytes)return f.push(this.readSFixed32());var u=ku(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==Lr.Bytes)return f.push(this.readFixed64());var u=ku(this);for(f=f||[];this.pos<u;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==Lr.Bytes)return f.push(this.readSFixed64());var u=ku(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed64());return f},skip:function(f){var u=7&f;if(u===Lr.Varint)for(;this.buf[this.pos++]>127;);else if(u===Lr.Bytes)this.pos=this.readVarint()+this.pos;else if(u===Lr.Fixed32)this.pos+=4;else{if(u!==Lr.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(f,u){this.writeVarint(f<<3|u)},realloc:function(f){for(var u=this.length||16;u<this.pos+f;)u*=2;if(u!==this.length){var g=new Uint8Array(u);g.set(this.buf),this.buf=g,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),r0(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),r0(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),r0(this.buf,-1&f,this.pos),r0(this.buf,Math.floor(f*T5),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),r0(this.buf,-1&f,this.pos),r0(this.buf,Math.floor(f*T5),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(u,g){var T,D;if(u>=0?(T=u%4294967296|0,D=u/4294967296|0):(D=~(-u/4294967296),4294967295^(T=~(-u%4294967296))?T=T+1|0:(T=0,D=D+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");g.realloc(10),function(z,N,$){$.buf[$.pos++]=127&z|128,z>>>=7,$.buf[$.pos++]=127&z|128,z>>>=7,$.buf[$.pos++]=127&z|128,z>>>=7,$.buf[$.pos++]=127&z|128,$.buf[$.pos]=127&(z>>>=7)}(T,0,g),function(z,N){var $=(7&z)<<4;N.buf[N.pos++]|=$|((z>>>=3)?128:0),z&&(N.buf[N.pos++]=127&z|((z>>>=7)?128:0),z&&(N.buf[N.pos++]=127&z|((z>>>=7)?128:0),z&&(N.buf[N.pos++]=127&z|((z>>>=7)?128:0),z&&(N.buf[N.pos++]=127&z|((z>>>=7)?128:0),z&&(N.buf[N.pos++]=127&z)))))}(D,g)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(!!f)},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var u=this.pos;this.pos=function(T,D,z){for(var N,$,Z=0;Z<D.length;Z++){if((N=D.charCodeAt(Z))>55295&&N<57344){if(!$){N>56319||Z+1===D.length?(T[z++]=239,T[z++]=191,T[z++]=189):$=N;continue}if(N<56320){T[z++]=239,T[z++]=191,T[z++]=189,$=N;continue}N=$-55296<<10|N-56320|65536,$=null}else $&&(T[z++]=239,T[z++]=191,T[z++]=189,$=null);N<128?T[z++]=N:(N<2048?T[z++]=N>>6|192:(N<65536?T[z++]=N>>12|224:(T[z++]=N>>18|240,T[z++]=N>>12&63|128),T[z++]=N>>6&63|128),T[z++]=63&N|128)}return z}(this.buf,f,this.pos);var g=this.pos-u;g>=128&&C5(u,g,this),this.pos=u-1,this.writeVarint(g),this.pos+=g},writeFloat:function(f){this.realloc(4),E5(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),E5(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var u=f.length;this.writeVarint(u),this.realloc(u);for(var g=0;g<u;g++)this.buf[this.pos++]=f[g]},writeRawMessage:function(f,u){this.pos++;var g=this.pos;f(u,this);var T=this.pos-g;T>=128&&C5(g,T,this),this.pos=g-1,this.writeVarint(T),this.pos+=T},writeMessage:function(f,u,g){this.writeTag(f,Lr.Bytes),this.writeRawMessage(u,g)},writePackedVarint:function(f,u){u.length&&this.writeMessage(f,s9,u)},writePackedSVarint:function(f,u){u.length&&this.writeMessage(f,o9,u)},writePackedBoolean:function(f,u){u.length&&this.writeMessage(f,A9,u)},writePackedFloat:function(f,u){u.length&&this.writeMessage(f,a9,u)},writePackedDouble:function(f,u){u.length&&this.writeMessage(f,l9,u)},writePackedFixed32:function(f,u){u.length&&this.writeMessage(f,u9,u)},writePackedSFixed32:function(f,u){u.length&&this.writeMessage(f,c9,u)},writePackedFixed64:function(f,u){u.length&&this.writeMessage(f,h9,u)},writePackedSFixed64:function(f,u){u.length&&this.writeMessage(f,f9,u)},writeBytesField:function(f,u){this.writeTag(f,Lr.Bytes),this.writeBytes(u)},writeFixed32Field:function(f,u){this.writeTag(f,Lr.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(f,u){this.writeTag(f,Lr.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(f,u){this.writeTag(f,Lr.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(f,u){this.writeTag(f,Lr.Fixed64),this.writeSFixed64(u)},writeVarintField:function(f,u){this.writeTag(f,Lr.Varint),this.writeVarint(u)},writeSVarintField:function(f,u){this.writeTag(f,Lr.Varint),this.writeSVarint(u)},writeStringField:function(f,u){this.writeTag(f,Lr.Bytes),this.writeString(u)},writeFloatField:function(f,u){this.writeTag(f,Lr.Fixed32),this.writeFloat(u)},writeDoubleField:function(f,u){this.writeTag(f,Lr.Fixed64),this.writeDouble(u)},writeBooleanField:function(f,u){this.writeVarintField(f,!!u)}};class mx{constructor(u,{pixelRatio:g,version:T,stretchX:D,stretchY:z,content:N}){this.paddedRect=u,this.pixelRatio=g,this.stretchX=D,this.stretchY=z,this.content=N,this.version=T}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class k5{constructor(u,g){const T={},D={};this.haveRenderCallbacks=[];const z=[];this.addImages(u,T,z),this.addImages(g,D,z);const{w:N,h:$}=P5(z),Z=new Ca({width:N||1,height:$||1});for(const re in u){const Ae=u[re],ce=T[re].paddedRect;Ca.copy(Ae.data,Z,{x:0,y:0},{x:ce.x+1,y:ce.y+1},Ae.data)}for(const re in g){const Ae=g[re],ce=D[re].paddedRect,ge=ce.x+1,ye=ce.y+1,_e=Ae.data.width,Ve=Ae.data.height;Ca.copy(Ae.data,Z,{x:0,y:0},{x:ge,y:ye},Ae.data),Ca.copy(Ae.data,Z,{x:0,y:Ve-1},{x:ge,y:ye-1},{width:_e,height:1}),Ca.copy(Ae.data,Z,{x:0,y:0},{x:ge,y:ye+Ve},{width:_e,height:1}),Ca.copy(Ae.data,Z,{x:_e-1,y:0},{x:ge-1,y:ye},{width:1,height:Ve}),Ca.copy(Ae.data,Z,{x:0,y:0},{x:ge+_e,y:ye},{width:1,height:Ve})}this.image=Z,this.iconPositions=T,this.patternPositions=D}addImages(u,g,T){for(const D in u){const z=u[D],N={x:0,y:0,w:z.data.width+2,h:z.data.height+2};T.push(N),g[D]=new mx(N,z),z.hasRenderCallback&&this.haveRenderCallbacks.push(D)}}patchUpdatedImages(u,g){u.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const T in u.updatedImages)this.patchUpdatedImage(this.iconPositions[T],u.getImage(T),g),this.patchUpdatedImage(this.patternPositions[T],u.getImage(T),g)}patchUpdatedImage(u,g,T){if(!u||!g||u.version===g.version)return;u.version=g.version;const[D,z]=u.tl;T.update(g.data,void 0,{x:D,y:z})}}Nt("ImagePosition",mx),Nt("ImageAtlas",k5),o.WritingMode=void 0,(Bc=o.WritingMode||(o.WritingMode={}))[Bc.none=0]="none",Bc[Bc.horizontal=1]="horizontal",Bc[Bc.vertical=2]="vertical",Bc[Bc.horizontalOnly=3]="horizontalOnly";const u1=-17;class dp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(u,g){const T=new dp;return T.scale=u||1,T.fontStack=g,T}static forImage(u){const g=new dp;return g.imageName=u,g}}class i0{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(u,g){const T=new i0;for(let D=0;D<u.sections.length;D++){const z=u.sections[D];z.image?T.addImageSection(z):T.addTextSection(z,g)}return T}length(){return this.text.length}getSection(u){return this.sections[this.sectionIndex[u]]}getSectionIndex(u){return this.sectionIndex[u]}getCharCode(u){return this.text.charCodeAt(u)}verticalizePunctuation(){this.text=function(u){let g="";for(let T=0;T<u.length;T++){const D=u.charCodeAt(T+1)||null,z=u.charCodeAt(T-1)||null;g+=D&&qs(D)&&!fp[u[T+1]]||z&&qs(z)&&!fp[u[T-1]]||!fp[u[T]]?u[T]:fp[u[T]]}return g}(this.text)}trim(){let u=0;for(let T=0;T<this.text.length&&h1[this.text.charCodeAt(T)];T++)u++;let g=this.text.length;for(let T=this.text.length-1;T>=0&&T>=u&&h1[this.text.charCodeAt(T)];T--)g--;this.text=this.text.substring(u,g),this.sectionIndex=this.sectionIndex.slice(u,g)}substring(u,g){const T=new i0;return T.text=this.text.substring(u,g),T.sectionIndex=this.sectionIndex.slice(u,g),T.sections=this.sections,T}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((u,g)=>Math.max(u,this.sections[g].scale),0)}addTextSection(u,g){this.text+=u.text,this.sections.push(dp.forText(u.scale,u.fontStack||g));const T=this.sections.length-1;for(let D=0;D<u.text.length;++D)this.sectionIndex.push(T)}addImageSection(u){const g=u.image?u.image.name:"";if(g.length===0)return void pe("Can't add FormattedSection with an empty image.");const T=this.getNextImageSectionCharCode();T?(this.text+=String.fromCharCode(T),this.sections.push(dp.forImage(g)),this.sectionIndex.push(this.sections.length-1)):pe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function c1(f,u,g,T,D,z,N,$,Z,re,Ae,ce,ge,ye,_e,Ve){const Fe=i0.fromFeature(f,D);let it;ce===o.WritingMode.vertical&&Fe.verticalizePunctuation();const{processBidirectionalText:ut,processStyledBidirectionalText:tt}=gs;if(ut&&Fe.sections.length===1){it=[];const mt=ut(Fe.toString(),yx(Fe,re,z,u,T,ye,_e));for(const Zt of mt){const tn=new i0;tn.text=Zt,tn.sections=Fe.sections;for(let Ht=0;Ht<Zt.length;Ht++)tn.sectionIndex.push(0);it.push(tn)}}else if(tt){it=[];const mt=tt(Fe.text,Fe.sectionIndex,yx(Fe,re,z,u,T,ye,_e));for(const Zt of mt){const tn=new i0;tn.text=Zt[0],tn.sectionIndex=Zt[1],tn.sections=Fe.sections,it.push(tn)}}else it=function(mt,Zt){const tn=[],Ht=mt.text;let Ut=0;for(const Ot of Zt)tn.push(mt.substring(Ut,Ot)),Ut=Ot;return Ut<Ht.length&&tn.push(mt.substring(Ut,Ht.length)),tn}(Fe,yx(Fe,re,z,u,T,ye,_e));const at=[],yt={positionedLines:at,text:Fe.toString(),top:Ae[1],bottom:Ae[1],left:Ae[0],right:Ae[0],writingMode:ce,iconsInText:!1,verticalizable:!1};return function(mt,Zt,tn,Ht,Ut,Ot,Wt,$t,St,gn,ln,Wn){let Vr=0,Wr=u1,Fi=0,Pa=0;const ms=$t==="right"?1:$t==="left"?0:.5;let Si=0;for(const Ci of Ut){Ci.trim();const _s=Ci.getMaxScale(),Ls=(_s-1)*ts,to={positionedGlyphs:[],lineOffset:0};mt.positionedLines[Si]=to;const Po=to.positionedGlyphs;let ko=0;if(!Ci.length()){Wr+=Ot,++Si;continue}for(let Zi=0;Zi<Ci.length();Zi++){const Jn=Ci.getSection(Zi),na=Ci.getSectionIndex(Zi),vs=Ci.getCharCode(Zi);let Ds=0,Al=null,ql=null,Zl=null,Lu=ts;const ul=!(St===o.WritingMode.horizontal||!ln&&!sl(vs)||ln&&(h1[vs]||(qi=vs,Vt.Arabic(qi)||Vt["Arabic Supplement"](qi)||Vt["Arabic Extended-A"](qi)||Vt["Arabic Presentation Forms-A"](qi)||Vt["Arabic Presentation Forms-B"](qi))));if(Jn.imageName){const ka=Ht[Jn.imageName];if(!ka)continue;Zl=Jn.imageName,mt.iconsInText=mt.iconsInText||!0,ql=ka.paddedRect;const Io=ka.displaySize;Jn.scale=Jn.scale*ts/Wn,Al={width:Io[0],height:Io[1],left:1,top:-3,advance:ul?Io[1]:Io[0]},Ds=Ls+(ts-Io[1]*Jn.scale),Lu=Al.advance;const Du=ul?Io[0]*Jn.scale-ts*_s:Io[1]*Jn.scale-ts*_s;Du>0&&Du>ko&&(ko=Du)}else{const ka=tn[Jn.fontStack],Io=ka&&ka[vs];if(Io&&Io.rect)ql=Io.rect,Al=Io.metrics;else{const Du=Zt[Jn.fontStack],mp=Du&&Du[vs];if(!mp)continue;Al=mp.metrics}Ds=(_s-Jn.scale)*ts}ul?(mt.verticalizable=!0,Po.push({glyph:vs,imageName:Zl,x:Vr,y:Wr+Ds,vertical:ul,scale:Jn.scale,fontStack:Jn.fontStack,sectionIndex:na,metrics:Al,rect:ql}),Vr+=Lu*Jn.scale+gn):(Po.push({glyph:vs,imageName:Zl,x:Vr,y:Wr+Ds,vertical:ul,scale:Jn.scale,fontStack:Jn.fontStack,sectionIndex:na,metrics:Al,rect:ql}),Vr+=Al.advance*Jn.scale+gn)}Po.length!==0&&(Fi=Math.max(Vr-gn,Fi),_9(Po,0,Po.length-1,ms,ko)),Vr=0;const Kr=Ot*_s+ko;to.lineOffset=Math.max(ko,Ls),Wr+=Kr,Pa=Math.max(Kr,Pa),++Si}var qi;const ys=Wr-u1,{horizontalAlign:Is,verticalAlign:Mo}=_x(Wt);(function(Ci,_s,Ls,to,Po,ko,Kr,Zi,Jn){const na=(_s-Ls)*Po;let vs=0;vs=ko!==Kr?-Zi*to-u1:(-to*Jn+.5)*Kr;for(const Ds of Ci)for(const Al of Ds.positionedGlyphs)Al.x+=na,Al.y+=vs})(mt.positionedLines,ms,Is,Mo,Fi,Pa,Ot,ys,Ut.length),mt.top+=-Mo*ys,mt.bottom=mt.top+ys,mt.left+=-Is*Fi,mt.right=mt.left+Fi}(yt,u,g,T,it,N,$,Z,ce,re,ge,Ve),!function(mt){for(const Zt of mt)if(Zt.positionedGlyphs.length!==0)return!1;return!0}(at)&&yt}const h1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},m9={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function I5(f,u,g,T,D,z){if(u.imageName){const N=T[u.imageName];return N?N.displaySize[0]*u.scale*ts/z+D:0}{const N=g[u.fontStack],$=N&&N[f];return $?$.metrics.advance*u.scale+D:0}}function L5(f,u,g,T){const D=Math.pow(f-u,2);return T?f<u?D/2:2*D:D+Math.abs(g)*g}function y9(f,u,g){let T=0;return f===10&&(T-=1e4),g&&(T+=150),f!==40&&f!==65288||(T+=50),u!==41&&u!==65289||(T+=50),T}function D5(f,u,g,T,D,z){let N=null,$=L5(u,g,D,z);for(const Z of T){const re=L5(u-Z.x,g,D,z)+Z.badness;re<=$&&(N=Z,$=re)}return{index:f,x:u,priorBreak:N,badness:$}}function R5(f){return f?R5(f.priorBreak).concat(f.index):[]}function yx(f,u,g,T,D,z,N){if(z!=="point")return[];if(!f)return[];const $=[],Z=function(ge,ye,_e,Ve,Fe,it){let ut=0;for(let tt=0;tt<ge.length();tt++){const at=ge.getSection(tt);ut+=I5(ge.getCharCode(tt),at,Ve,Fe,ye,it)}return ut/Math.max(1,Math.ceil(ut/_e))}(f,u,g,T,D,N),re=f.text.indexOf("​")>=0;let Ae=0;for(let ge=0;ge<f.length();ge++){const ye=f.getSection(ge),_e=f.getCharCode(ge);if(h1[_e]||(Ae+=I5(_e,ye,T,D,u,N)),ge<f.length()-1){const Ve=!((ce=_e)<11904||!(Vt["Bopomofo Extended"](ce)||Vt.Bopomofo(ce)||Vt["CJK Compatibility Forms"](ce)||Vt["CJK Compatibility Ideographs"](ce)||Vt["CJK Compatibility"](ce)||Vt["CJK Radicals Supplement"](ce)||Vt["CJK Strokes"](ce)||Vt["CJK Symbols and Punctuation"](ce)||Vt["CJK Unified Ideographs Extension A"](ce)||Vt["CJK Unified Ideographs"](ce)||Vt["Enclosed CJK Letters and Months"](ce)||Vt["Halfwidth and Fullwidth Forms"](ce)||Vt.Hiragana(ce)||Vt["Ideographic Description Characters"](ce)||Vt["Kangxi Radicals"](ce)||Vt["Katakana Phonetic Extensions"](ce)||Vt.Katakana(ce)||Vt["Vertical Forms"](ce)||Vt["Yi Radicals"](ce)||Vt["Yi Syllables"](ce)));(m9[_e]||Ve||ye.imageName)&&$.push(D5(ge+1,Ae,Z,$,y9(_e,f.getCharCode(ge+1),Ve&&re),!1))}}var ce;return R5(D5(f.length(),Ae,Z,$,0,!0))}function _x(f){let u=.5,g=.5;switch(f){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":g=1;break;case"top":case"top-right":case"top-left":g=0}return{horizontalAlign:u,verticalAlign:g}}function _9(f,u,g,T,D){if(!T&&!D)return;const z=f[g],N=(f[g].x+z.metrics.advance*z.scale)*T;for(let $=u;$<=g;$++)f[$].x-=N,f[$].y+=D}function v9(f,u,g){const{horizontalAlign:T,verticalAlign:D}=_x(g),z=u[0]-f.displaySize[0]*T,N=u[1]-f.displaySize[1]*D;return{image:f,top:N,bottom:N+f.displaySize[1],left:z,right:z+f.displaySize[0]}}function B5(f,u,g,T,D,z){const N=f.image;let $;if(N.content){const Fe=N.content,it=N.pixelRatio||1;$=[Fe[0]/it,Fe[1]/it,N.displaySize[0]-Fe[2]/it,N.displaySize[1]-Fe[3]/it]}const Z=u.left*z,re=u.right*z;let Ae,ce,ge,ye;g==="width"||g==="both"?(ye=D[0]+Z-T[3],ce=D[0]+re+T[1]):(ye=D[0]+(Z+re-N.displaySize[0])/2,ce=ye+N.displaySize[0]);const _e=u.top*z,Ve=u.bottom*z;return g==="height"||g==="both"?(Ae=D[1]+_e-T[0],ge=D[1]+Ve+T[2]):(Ae=D[1]+(_e+Ve-N.displaySize[1])/2,ge=Ae+N.displaySize[1]),{image:N,top:Ae,right:ce,bottom:ge,left:ye,collisionPadding:$}}const Iu=128;function z5(f,u){const{expression:g}=u;if(g.kind==="constant")return{kind:"constant",layoutSize:g.evaluate(new Pr(f+1))};if(g.kind==="source")return{kind:"source"};{const{zoomStops:T,interpolationType:D}=g;let z=0;for(;z<T.length&&T[z]<=f;)z++;z=Math.max(0,z-1);let N=z;for(;N<T.length&&T[N]<f+1;)N++;N=Math.min(T.length-1,N);const $=T[z],Z=T[N];return g.kind==="composite"?{kind:"composite",minZoom:$,maxZoom:Z,interpolationType:D}:{kind:"camera",minZoom:$,maxZoom:Z,minSize:g.evaluate(new Pr($)),maxSize:g.evaluate(new Pr(Z)),interpolationType:D}}}class zc extends Et{constructor(u,g,T,D){super(u,g),this.angle=T,D!==void 0&&(this.segment=D)}clone(){return new zc(this.x,this.y,this.angle,this.segment)}}function O5(f,u,g,T,D){if(u.segment===void 0)return!0;let z=u,N=u.segment+1,$=0;for(;$>-g/2;){if(N--,N<0)return!1;$-=f[N].dist(z),z=f[N]}$+=f[N].dist(f[N+1]),N++;const Z=[];let re=0;for(;$<g/2;){const Ae=f[N],ce=f[N+1];if(!ce)return!1;let ge=f[N-1].angleTo(Ae)-Ae.angleTo(ce);for(ge=Math.abs((ge+3*Math.PI)%(2*Math.PI)-Math.PI),Z.push({distance:$,angleDelta:ge}),re+=ge;$-Z[0].distance>T;)re-=Z.shift().angleDelta;if(re>D)return!1;N++,$+=Ae.dist(ce)}return!0}function F5(f){let u=0;for(let g=0;g<f.length-1;g++)u+=f[g].dist(f[g+1]);return u}function N5(f,u,g){return f?.6*u*g:0}function U5(f,u){return Math.max(f?f.right-f.left:0,u?u.right-u.left:0)}function x9(f,u,g,T,D,z){const N=N5(g,D,z),$=U5(g,T)*z;let Z=0;const re=F5(f)/2;for(let Ae=0;Ae<f.length-1;Ae++){const ce=f[Ae],ge=f[Ae+1],ye=ce.dist(ge);if(Z+ye>re){const _e=(re-Z)/ye,Ve=en(ce.x,ge.x,_e),Fe=en(ce.y,ge.y,_e),it=new zc(Ve,Fe,ge.angleTo(ce),Ae);return it._round(),!N||O5(f,it,$,N,u)?it:void 0}Z+=ye}}function w9(f,u,g,T,D,z,N,$,Z){const re=N5(T,z,N),Ae=U5(T,D),ce=Ae*N,ge=f[0].x===0||f[0].x===Z||f[0].y===0||f[0].y===Z;return u-ce<u/4&&(u=ce+u/4),V5(f,ge?u/2*$%u:(Ae/2+2*z)*N*$%u,u,re,g,ce,ge,!1,Z)}function V5(f,u,g,T,D,z,N,$,Z){const re=z/2,Ae=F5(f);let ce=0,ge=u-g,ye=[];for(let _e=0;_e<f.length-1;_e++){const Ve=f[_e],Fe=f[_e+1],it=Ve.dist(Fe),ut=Fe.angleTo(Ve);for(;ge+g<ce+it;){ge+=g;const tt=(ge-ce)/it,at=en(Ve.x,Fe.x,tt),yt=en(Ve.y,Fe.y,tt);if(at>=0&&at<Z&&yt>=0&&yt<Z&&ge-re>=0&&ge+re<=Ae){const mt=new zc(at,yt,ut,_e);mt._round(),T&&!O5(f,mt,z,T,D)||ye.push(mt)}}ce+=it}return $||ye.length||N||(ye=V5(f,ce/2,g,T,D,z,N,!0,Z)),ye}function G5(f,u,g,T,D){const z=[];for(let N=0;N<f.length;N++){const $=f[N];let Z;for(let re=0;re<$.length-1;re++){let Ae=$[re],ce=$[re+1];Ae.x<u&&ce.x<u||(Ae.x<u?Ae=new Et(u,Ae.y+(u-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round():ce.x<u&&(ce=new Et(u,Ae.y+(u-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round()),Ae.y<g&&ce.y<g||(Ae.y<g?Ae=new Et(Ae.x+(g-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),g)._round():ce.y<g&&(ce=new Et(Ae.x+(g-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),g)._round()),Ae.x>=T&&ce.x>=T||(Ae.x>=T?Ae=new Et(T,Ae.y+(T-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round():ce.x>=T&&(ce=new Et(T,Ae.y+(T-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round()),Ae.y>=D&&ce.y>=D||(Ae.y>=D?Ae=new Et(Ae.x+(D-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),D)._round():ce.y>=D&&(ce=new Et(Ae.x+(D-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),D)._round()),Z&&Ae.equals(Z[Z.length-1])||(Z=[Ae],z.push(Z)),Z.push(ce)))))}}return z}function $5(f,u,g,T){const D=[],z=f.image,N=z.pixelRatio,$=z.paddedRect.w-2,Z=z.paddedRect.h-2,re=f.right-f.left,Ae=f.bottom-f.top,ce=z.stretchX||[[0,$]],ge=z.stretchY||[[0,Z]],ye=(Ot,Wt)=>Ot+Wt[1]-Wt[0],_e=ce.reduce(ye,0),Ve=ge.reduce(ye,0),Fe=$-_e,it=Z-Ve;let ut=0,tt=_e,at=0,yt=Ve,mt=0,Zt=Fe,tn=0,Ht=it;if(z.content&&T){const Ot=z.content;ut=f1(ce,0,Ot[0]),at=f1(ge,0,Ot[1]),tt=f1(ce,Ot[0],Ot[2]),yt=f1(ge,Ot[1],Ot[3]),mt=Ot[0]-ut,tn=Ot[1]-at,Zt=Ot[2]-Ot[0]-tt,Ht=Ot[3]-Ot[1]-yt}const Ut=(Ot,Wt,$t,St)=>{const gn=d1(Ot.stretch-ut,tt,re,f.left),ln=p1(Ot.fixed-mt,Zt,Ot.stretch,_e),Wn=d1(Wt.stretch-at,yt,Ae,f.top),Vr=p1(Wt.fixed-tn,Ht,Wt.stretch,Ve),Wr=d1($t.stretch-ut,tt,re,f.left),Fi=p1($t.fixed-mt,Zt,$t.stretch,_e),Pa=d1(St.stretch-at,yt,Ae,f.top),ms=p1(St.fixed-tn,Ht,St.stretch,Ve),Si=new Et(gn,Wn),qi=new Et(Wr,Wn),ys=new Et(Wr,Pa),Is=new Et(gn,Pa),Mo=new Et(ln/N,Vr/N),Ci=new Et(Fi/N,ms/N),_s=u*Math.PI/180;if(_s){const Po=Math.sin(_s),ko=Math.cos(_s),Kr=[ko,-Po,Po,ko];Si._matMult(Kr),qi._matMult(Kr),Is._matMult(Kr),ys._matMult(Kr)}const Ls=Ot.stretch+Ot.fixed,to=Wt.stretch+Wt.fixed;return{tl:Si,tr:qi,bl:Is,br:ys,tex:{x:z.paddedRect.x+1+Ls,y:z.paddedRect.y+1+to,w:$t.stretch+$t.fixed-Ls,h:St.stretch+St.fixed-to},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Mo,pixelOffsetBR:Ci,minFontScaleX:Zt/N/re,minFontScaleY:Ht/N/Ae,isSDF:g}};if(T&&(z.stretchX||z.stretchY)){const Ot=j5(ce,Fe,_e),Wt=j5(ge,it,Ve);for(let $t=0;$t<Ot.length-1;$t++){const St=Ot[$t],gn=Ot[$t+1];for(let ln=0;ln<Wt.length-1;ln++)D.push(Ut(St,Wt[ln],gn,Wt[ln+1]))}}else D.push(Ut({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:$+1},{fixed:0,stretch:Z+1}));return D}function f1(f,u,g){let T=0;for(const D of f)T+=Math.max(u,Math.min(g,D[1]))-Math.max(u,Math.min(g,D[0]));return T}function j5(f,u,g){const T=[{fixed:-1,stretch:0}];for(const[D,z]of f){const N=T[T.length-1];T.push({fixed:D-N.stretch,stretch:N.stretch}),T.push({fixed:D-N.stretch,stretch:N.stretch+(z-D)})}return T.push({fixed:u+1,stretch:g}),T}function d1(f,u,g,T){return f/u*g+T}function p1(f,u,g,T){return f-u*g/T}Nt("Anchor",zc);class g1{constructor(u,g,T,D,z,N,$,Z,re,Ae){if(this.boxStartIndex=u.length,re){let ce=N.top,ge=N.bottom;const ye=N.collisionPadding;ye&&(ce-=ye[1],ge+=ye[3]);let _e=ge-ce;_e>0&&(_e=Math.max(10,_e),this.circleDiameter=_e)}else{let ce=N.top*$-Z[0],ge=N.bottom*$+Z[2],ye=N.left*$-Z[3],_e=N.right*$+Z[1];const Ve=N.collisionPadding;if(Ve&&(ye-=Ve[0]*$,ce-=Ve[1]*$,_e+=Ve[2]*$,ge+=Ve[3]*$),Ae){const Fe=new Et(ye,ce),it=new Et(_e,ce),ut=new Et(ye,ge),tt=new Et(_e,ge),at=Ae*Math.PI/180;Fe._rotate(at),it._rotate(at),ut._rotate(at),tt._rotate(at),ye=Math.min(Fe.x,it.x,ut.x,tt.x),_e=Math.max(Fe.x,it.x,ut.x,tt.x),ce=Math.min(Fe.y,it.y,ut.y,tt.y),ge=Math.max(Fe.y,it.y,ut.y,tt.y)}u.emplaceBack(g.x,g.y,ye,ce,_e,ge,T,D,z)}this.boxEndIndex=u.length}}class b9{constructor(u=[],g=E9){if(this.data=u,this.length=this.data.length,this.compare=g,this.length>0)for(let T=(this.length>>1)-1;T>=0;T--)this._down(T)}push(u){this.data.push(u),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const u=this.data[0],g=this.data.pop();return this.length--,this.length>0&&(this.data[0]=g,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:g,compare:T}=this,D=g[u];for(;u>0;){const z=u-1>>1,N=g[z];if(T(D,N)>=0)break;g[u]=N,u=z}g[u]=D}_down(u){const{data:g,compare:T}=this,D=this.length>>1,z=g[u];for(;u<D;){let N=1+(u<<1),$=g[N];const Z=N+1;if(Z<this.length&&T(g[Z],$)<0&&(N=Z,$=g[Z]),T($,z)>=0)break;g[u]=$,u=N}g[u]=z}}function E9(f,u){return f<u?-1:f>u?1:0}function T9(f,u=1,g=!1){let T=1/0,D=1/0,z=-1/0,N=-1/0;const $=f[0];for(let ye=0;ye<$.length;ye++){const _e=$[ye];(!ye||_e.x<T)&&(T=_e.x),(!ye||_e.y<D)&&(D=_e.y),(!ye||_e.x>z)&&(z=_e.x),(!ye||_e.y>N)&&(N=_e.y)}const Z=Math.min(z-T,N-D);let re=Z/2;const Ae=new b9([],S9);if(Z===0)return new Et(T,D);for(let ye=T;ye<z;ye+=Z)for(let _e=D;_e<N;_e+=Z)Ae.push(new s0(ye+re,_e+re,re,f));let ce=function(ye){let _e=0,Ve=0,Fe=0;const it=ye[0];for(let ut=0,tt=it.length,at=tt-1;ut<tt;at=ut++){const yt=it[ut],mt=it[at],Zt=yt.x*mt.y-mt.x*yt.y;Ve+=(yt.x+mt.x)*Zt,Fe+=(yt.y+mt.y)*Zt,_e+=3*Zt}return new s0(Ve/_e,Fe/_e,0,ye)}(f),ge=Ae.length;for(;Ae.length;){const ye=Ae.pop();(ye.d>ce.d||!ce.d)&&(ce=ye,g&&console.log("found best %d after %d probes",Math.round(1e4*ye.d)/1e4,ge)),ye.max-ce.d<=u||(re=ye.h/2,Ae.push(new s0(ye.p.x-re,ye.p.y-re,re,f)),Ae.push(new s0(ye.p.x+re,ye.p.y-re,re,f)),Ae.push(new s0(ye.p.x-re,ye.p.y+re,re,f)),Ae.push(new s0(ye.p.x+re,ye.p.y+re,re,f)),ge+=4)}return g&&(console.log(`num probes: ${ge}`),console.log(`best distance: ${ce.d}`)),ce.p}function S9(f,u){return u.max-f.max}function s0(f,u,g,T){this.p=new Et(f,u),this.h=g,this.d=function(D,z){let N=!1,$=1/0;for(let Z=0;Z<z.length;Z++){const re=z[Z];for(let Ae=0,ce=re.length,ge=ce-1;Ae<ce;ge=Ae++){const ye=re[Ae],_e=re[ge];ye.y>D.y!=_e.y>D.y&&D.x<(_e.x-ye.x)*(D.y-ye.y)/(_e.y-ye.y)+ye.x&&(N=!N),$=Math.min($,K4(D,ye,_e))}}return(N?1:-1)*Math.sqrt($)}(this.p,T),this.max=this.d+this.h*Math.SQRT2}const vx=Number.POSITIVE_INFINITY;function H5(f,u){return u[1]!==vx?function(g,T,D){let z=0,N=0;switch(T=Math.abs(T),D=Math.abs(D),g){case"top-right":case"top-left":case"top":N=D-7;break;case"bottom-right":case"bottom-left":case"bottom":N=7-D}switch(g){case"top-right":case"bottom-right":case"right":z=-T;break;case"top-left":case"bottom-left":case"left":z=T}return[z,N]}(f,u[0],u[1]):function(g,T){let D=0,z=0;T<0&&(T=0);const N=T/Math.sqrt(2);switch(g){case"top-right":case"top-left":z=N-7;break;case"bottom-right":case"bottom-left":z=7-N;break;case"bottom":z=7-T;break;case"top":z=T-7}switch(g){case"top-right":case"bottom-right":D=-N;break;case"top-left":case"bottom-left":D=N;break;case"left":D=T;break;case"right":D=-T}return[D,z]}(f,u[0])}function xx(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function C9(f,u,g,T,D,z,N,$,Z,re,Ae){let ce=z.textMaxSize.evaluate(u,{});ce===void 0&&(ce=N);const ge=f.layers[0].layout,ye=ge.get("icon-offset").evaluate(u,{},Ae),_e=Q5(g.horizontal),Ve=N/24,Fe=f.tilePixelRatio*Ve,it=f.tilePixelRatio*ce/24,ut=f.tilePixelRatio*$,tt=f.tilePixelRatio*ge.get("symbol-spacing"),at=ge.get("text-padding")*f.tilePixelRatio,yt=function(St,gn,ln,Wn=1){const Vr=St.get("icon-padding").evaluate(gn,{},ln),Wr=Vr&&Vr.values;return[Wr[0]*Wn,Wr[1]*Wn,Wr[2]*Wn,Wr[3]*Wn]}(ge,u,Ae,f.tilePixelRatio),mt=ge.get("text-max-angle")/180*Math.PI,Zt=ge.get("text-rotation-alignment")!=="viewport"&&ge.get("symbol-placement")!=="point",tn=ge.get("icon-rotation-alignment")==="map"&&ge.get("symbol-placement")!=="point",Ht=ge.get("symbol-placement"),Ut=tt/2,Ot=ge.get("icon-text-fit");let Wt;T&&Ot!=="none"&&(f.allowVerticalPlacement&&g.vertical&&(Wt=B5(T,g.vertical,Ot,ge.get("icon-text-fit-padding"),ye,Ve)),_e&&(T=B5(T,_e,Ot,ge.get("icon-text-fit-padding"),ye,Ve)));const $t=(St,gn)=>{gn.x<0||gn.x>=Oi||gn.y<0||gn.y>=Oi||function(ln,Wn,Vr,Wr,Fi,Pa,ms,Si,qi,ys,Is,Mo,Ci,_s,Ls,to,Po,ko,Kr,Zi,Jn,na,vs,Ds,Al){const ql=ln.addToLineVertexArray(Wn,Vr);let Zl,Lu,ul,ka,Io=0,Du=0,mp=0,AC=0,Ix=-1,Lx=-1;const Ru={};let uC=wn.exports(""),Dx=0,Rx=0;if(Si._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Dx,Rx]=Si.layout.get("text-offset").evaluate(Jn,{},Ds).map(Lo=>Lo*ts):(Dx=Si.layout.get("text-radial-offset").evaluate(Jn,{},Ds)*ts,Rx=vx),ln.allowVerticalPlacement&&Wr.vertical){const Lo=Si.layout.get("text-rotate").evaluate(Jn,{},Ds)+90;ul=new g1(qi,Wn,ys,Is,Mo,Wr.vertical,Ci,_s,Ls,Lo),ms&&(ka=new g1(qi,Wn,ys,Is,Mo,ms,Po,ko,Ls,Lo))}if(Fi){const Lo=Si.layout.get("icon-rotate").evaluate(Jn,{}),OA=Si.layout.get("icon-text-fit")!=="none",yp=$5(Fi,Lo,vs,OA),_p=ms?$5(ms,Lo,vs,OA):void 0;Lu=new g1(qi,Wn,ys,Is,Mo,Fi,Po,ko,!1,Lo),Io=4*yp.length;const fC=ln.iconSizeData;let Vh=null;fC.kind==="source"?(Vh=[Iu*Si.layout.get("icon-size").evaluate(Jn,{})],Vh[0]>Oc&&pe(`${ln.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):fC.kind==="composite"&&(Vh=[Iu*na.compositeIconSizes[0].evaluate(Jn,{},Ds),Iu*na.compositeIconSizes[1].evaluate(Jn,{},Ds)],(Vh[0]>Oc||Vh[1]>Oc)&&pe(`${ln.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),ln.addSymbols(ln.icon,yp,Vh,Zi,Kr,Jn,o.WritingMode.none,Wn,ql.lineStartIndex,ql.lineLength,-1,Ds),Ix=ln.icon.placedSymbolArray.length-1,_p&&(Du=4*_p.length,ln.addSymbols(ln.icon,_p,Vh,Zi,Kr,Jn,o.WritingMode.vertical,Wn,ql.lineStartIndex,ql.lineLength,-1,Ds),Lx=ln.icon.placedSymbolArray.length-1)}const cC=Object.keys(Wr.horizontal);for(const Lo of cC){const OA=Wr.horizontal[Lo];if(!Zl){uC=wn.exports(OA.text);const _p=Si.layout.get("text-rotate").evaluate(Jn,{},Ds);Zl=new g1(qi,Wn,ys,Is,Mo,OA,Ci,_s,Ls,_p)}const yp=OA.positionedLines.length===1;if(mp+=W5(ln,Wn,OA,Pa,Si,Ls,Jn,to,ql,Wr.vertical?o.WritingMode.horizontal:o.WritingMode.horizontalOnly,yp?cC:[Lo],Ru,Ix,na,Ds),yp)break}Wr.vertical&&(AC+=W5(ln,Wn,Wr.vertical,Pa,Si,Ls,Jn,to,ql,o.WritingMode.vertical,["vertical"],Ru,Lx,na,Ds));const U9=Zl?Zl.boxStartIndex:ln.collisionBoxArray.length,V9=Zl?Zl.boxEndIndex:ln.collisionBoxArray.length,G9=ul?ul.boxStartIndex:ln.collisionBoxArray.length,$9=ul?ul.boxEndIndex:ln.collisionBoxArray.length,j9=Lu?Lu.boxStartIndex:ln.collisionBoxArray.length,H9=Lu?Lu.boxEndIndex:ln.collisionBoxArray.length,W9=ka?ka.boxStartIndex:ln.collisionBoxArray.length,Q9=ka?ka.boxEndIndex:ln.collisionBoxArray.length;let Yl=-1;const x1=(Lo,OA)=>Lo&&Lo.circleDiameter?Math.max(Lo.circleDiameter,OA):OA;Yl=x1(Zl,Yl),Yl=x1(ul,Yl),Yl=x1(Lu,Yl),Yl=x1(ka,Yl);const hC=Yl>-1?1:0;hC&&(Yl*=Al/ts),ln.glyphOffsetArray.length>=o0.MAX_GLYPHS&&pe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Jn.sortKey!==void 0&&ln.addToSortKeyRanges(ln.symbolInstances.length,Jn.sortKey),ln.symbolInstances.emplaceBack(Wn.x,Wn.y,Ru.right>=0?Ru.right:-1,Ru.center>=0?Ru.center:-1,Ru.left>=0?Ru.left:-1,Ru.vertical||-1,Ix,Lx,uC,U9,V9,G9,$9,j9,H9,W9,Q9,ys,mp,AC,Io,Du,hC,0,Ci,Dx,Rx,Yl)}(f,gn,St,g,T,D,Wt,f.layers[0],f.collisionBoxArray,u.index,u.sourceLayerIndex,f.index,Fe,[at,at,at,at],Zt,Z,ut,yt,tn,ye,u,z,re,Ae,N)};if(Ht==="line")for(const St of G5(u.geometry,0,0,Oi,Oi)){const gn=w9(St,tt,mt,g.vertical||_e,T,24,it,f.overscaling,Oi);for(const ln of gn){const Wn=_e;Wn&&M9(f,Wn.text,Ut,ln)||$t(St,ln)}}else if(Ht==="line-center"){for(const St of u.geometry)if(St.length>1){const gn=x9(St,mt,g.vertical||_e,T,24,it);gn&&$t(St,gn)}}else if(u.type==="Polygon")for(const St of lx(u.geometry,0)){const gn=T9(St,16);$t(St[0],new zc(gn.x,gn.y,0))}else if(u.type==="LineString")for(const St of u.geometry)$t(St,new zc(St[0].x,St[0].y,0));else if(u.type==="Point")for(const St of u.geometry)for(const gn of St)$t([gn],new zc(gn.x,gn.y,0))}const Oc=32640;function W5(f,u,g,T,D,z,N,$,Z,re,Ae,ce,ge,ye,_e){const Ve=function(ut,tt,at,yt,mt,Zt,tn,Ht){const Ut=yt.layout.get("text-rotate").evaluate(Zt,{})*Math.PI/180,Ot=[];for(const Wt of tt.positionedLines)for(const $t of Wt.positionedGlyphs){if(!$t.rect)continue;const St=$t.rect||{};let gn=4,ln=!0,Wn=1,Vr=0;const Wr=(mt||Ht)&&$t.vertical,Fi=$t.metrics.advance*$t.scale/2;if(Ht&&tt.verticalizable){const Kr=($t.scale-1)*ts,Zi=(ts-$t.metrics.width*$t.scale)/2;Vr=Wt.lineOffset/2-($t.imageName?-Zi:Kr)}if($t.imageName){const Kr=tn[$t.imageName];ln=Kr.sdf,Wn=Kr.pixelRatio,gn=1/Wn}const Pa=mt?[$t.x+Fi,$t.y]:[0,0];let ms=mt?[0,0]:[$t.x+Fi+at[0],$t.y+at[1]-Vr],Si=[0,0];Wr&&(Si=ms,ms=[0,0]);const qi=($t.metrics.left-gn)*$t.scale-Fi+ms[0],ys=(-$t.metrics.top-gn)*$t.scale+ms[1],Is=qi+St.w*$t.scale/Wn,Mo=ys+St.h*$t.scale/Wn,Ci=new Et(qi,ys),_s=new Et(Is,ys),Ls=new Et(qi,Mo),to=new Et(Is,Mo);if(Wr){const Kr=new Et(-Fi,Fi-u1),Zi=-Math.PI/2,Jn=12-Fi,na=new Et(22-Jn,-($t.imageName?Jn:0)),vs=new Et(...Si);Ci._rotateAround(Zi,Kr)._add(na)._add(vs),_s._rotateAround(Zi,Kr)._add(na)._add(vs),Ls._rotateAround(Zi,Kr)._add(na)._add(vs),to._rotateAround(Zi,Kr)._add(na)._add(vs)}if(Ut){const Kr=Math.sin(Ut),Zi=Math.cos(Ut),Jn=[Zi,-Kr,Kr,Zi];Ci._matMult(Jn),_s._matMult(Jn),Ls._matMult(Jn),to._matMult(Jn)}const Po=new Et(0,0),ko=new Et(0,0);Ot.push({tl:Ci,tr:_s,bl:Ls,br:to,tex:St,writingMode:tt.writingMode,glyphOffset:Pa,sectionIndex:$t.sectionIndex,isSDF:ln,pixelOffsetTL:Po,pixelOffsetBR:ko,minFontScaleX:0,minFontScaleY:0})}return Ot}(0,g,$,D,z,N,T,f.allowVerticalPlacement),Fe=f.textSizeData;let it=null;Fe.kind==="source"?(it=[Iu*D.layout.get("text-size").evaluate(N,{})],it[0]>Oc&&pe(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Fe.kind==="composite"&&(it=[Iu*ye.compositeTextSizes[0].evaluate(N,{},_e),Iu*ye.compositeTextSizes[1].evaluate(N,{},_e)],(it[0]>Oc||it[1]>Oc)&&pe(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),f.addSymbols(f.text,Ve,it,$,z,N,re,u,Z.lineStartIndex,Z.lineLength,ge,_e);for(const ut of Ae)ce[ut]=f.text.placedSymbolArray.length-1;return 4*Ve.length}function Q5(f){for(const u in f)return f[u];return null}function M9(f,u,g,T){const D=f.compareText;if(u in D){const z=D[u];for(let N=z.length-1;N>=0;N--)if(T.dist(z[N])<g)return!0}else D[u]=[];return D[u].push(T),!1}const P9=Rc.VectorTileFeature.types,k9=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function m1(f,u,g,T,D,z,N,$,Z,re,Ae,ce,ge){const ye=$?Math.min(Oc,Math.round($[0])):0,_e=$?Math.min(Oc,Math.round($[1])):0;f.emplaceBack(u,g,Math.round(32*T),Math.round(32*D),z,N,(ye<<1)+(Z?1:0),_e,16*re,16*Ae,256*ce,256*ge)}function wx(f,u,g){f.emplaceBack(u.x,u.y,g),f.emplaceBack(u.x,u.y,g),f.emplaceBack(u.x,u.y,g),f.emplaceBack(u.x,u.y,g)}function I9(f){for(const u of f.sections)if(Pc(u.text))return!0;return!1}class bx{constructor(u){this.layoutVertexArray=new ze,this.indexArray=new ot,this.programConfigurations=u,this.segments=new gt,this.dynamicLayoutVertexArray=new Je,this.opacityVertexArray=new ft,this.placedSymbolArray=new y}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(u,g,T,D){this.isEmpty()||(T&&(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,e9.members),this.indexBuffer=u.createIndexBuffer(this.indexArray,g),this.dynamicLayoutVertexBuffer=u.createVertexBuffer(this.dynamicLayoutVertexArray,t9.members,!0),this.opacityVertexBuffer=u.createVertexBuffer(this.opacityVertexArray,k9,!0),this.opacityVertexBuffer.itemSize=1),(T||D)&&this.programConfigurations.upload(u))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Nt("SymbolBuffers",bx);class Ex{constructor(u,g,T){this.layoutVertexArray=new u,this.layoutAttributes=g,this.indexArray=new T,this.segments=new gt,this.collisionVertexArray=new st}upload(u){this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=u.createVertexBuffer(this.collisionVertexArray,n9.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Nt("CollisionBuffers",Ex);class o0{constructor(u){this.collisionBoxArray=u.collisionBoxArray,this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(N=>N.id),this.index=u.index,this.pixelRatio=u.pixelRatio,this.sourceLayerIndex=u.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=nx([]),this.placementViewportMatrix=nx([]);const g=this.layers[0]._unevaluatedLayout._values;this.textSizeData=z5(this.zoom,g["text-size"]),this.iconSizeData=z5(this.zoom,g["icon-size"]);const T=this.layers[0].layout,D=T.get("symbol-sort-key"),z=T.get("symbol-z-order");this.canOverlap=Sx(T,"text-overlap","text-allow-overlap")!=="never"||Sx(T,"icon-overlap","icon-allow-overlap")!=="never"||T.get("text-ignore-placement")||T.get("icon-ignore-placement"),this.sortFeaturesByKey=z!=="viewport-y"&&!D.isConstant(),this.sortFeaturesByY=(z==="viewport-y"||z==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,T.get("symbol-placement")==="point"&&(this.writingModes=T.get("text-writing-mode").map(N=>o.WritingMode[N])),this.stateDependentLayerIds=this.layers.filter(N=>N.isStateDependent()).map(N=>N.id),this.sourceID=u.sourceID}createArrays(){this.text=new bx(new zh(this.layers,this.zoom,u=>/^text/.test(u))),this.icon=new bx(new zh(this.layers,this.zoom,u=>/^icon/.test(u))),this.glyphOffsetArray=new E,this.lineVertexArray=new I,this.symbolInstances=new x}calculateGlyphDependencies(u,g,T,D,z){for(let N=0;N<u.length;N++)if(g[u.charCodeAt(N)]=!0,(T||D)&&z){const $=fp[u.charAt(N)];$&&(g[$.charCodeAt(0)]=!0)}}populate(u,g,T){const D=this.layers[0],z=D.layout,N=z.get("text-font"),$=z.get("text-field"),Z=z.get("icon-image"),re=($.value.kind!=="constant"||$.value.value instanceof ke&&!$.value.value.isEmpty()||$.value.value.toString().length>0)&&(N.value.kind!=="constant"||N.value.value.length>0),Ae=Z.value.kind!=="constant"||!!Z.value.value||Object.keys(Z.parameters).length>0,ce=z.get("symbol-sort-key");if(this.features=[],!re&&!Ae)return;const ge=g.iconDependencies,ye=g.glyphDependencies,_e=g.availableImages,Ve=new Pr(this.zoom);for(const{feature:Fe,id:it,index:ut,sourceLayerIndex:tt}of u){const at=D._featureFilter.needGeometry,yt=Fh(Fe,at);if(!D._featureFilter.filter(Ve,yt,T))continue;let mt,Zt;if(at||(yt.geometry=Oh(Fe)),re){const Ht=D.getValueAndResolveTokens("text-field",yt,T,_e),Ut=ke.factory(Ht);I9(Ut)&&(this.hasRTLText=!0),(!this.hasRTLText||jl()==="unavailable"||this.hasRTLText&&gs.isParsed())&&(mt=i9(Ut,D,yt))}if(Ae){const Ht=D.getValueAndResolveTokens("icon-image",yt,T,_e);Zt=Ht instanceof Ie?Ht:Ie.fromString(Ht)}if(!mt&&!Zt)continue;const tn=this.sortFeaturesByKey?ce.evaluate(yt,{},T):void 0;if(this.features.push({id:it,text:mt,icon:Zt,index:ut,sourceLayerIndex:tt,geometry:yt.geometry,properties:Fe.properties,type:P9[Fe.type],sortKey:tn}),Zt&&(ge[Zt.name]=!0),mt){const Ht=N.evaluate(yt,{},T).join(","),Ut=z.get("text-rotation-alignment")!=="viewport"&&z.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(o.WritingMode.vertical)>=0;for(const Ot of mt.sections)if(Ot.image)ge[Ot.image.name]=!0;else{const Wt=BA(mt.toString()),$t=Ot.fontStack||Ht,St=ye[$t]=ye[$t]||{};this.calculateGlyphDependencies(Ot.text,St,Ut,this.allowVerticalPlacement,Wt)}}}z.get("symbol-placement")==="line"&&(this.features=function(Fe){const it={},ut={},tt=[];let at=0;function yt(Ht){tt.push(Fe[Ht]),at++}function mt(Ht,Ut,Ot){const Wt=ut[Ht];return delete ut[Ht],ut[Ut]=Wt,tt[Wt].geometry[0].pop(),tt[Wt].geometry[0]=tt[Wt].geometry[0].concat(Ot[0]),Wt}function Zt(Ht,Ut,Ot){const Wt=it[Ut];return delete it[Ut],it[Ht]=Wt,tt[Wt].geometry[0].shift(),tt[Wt].geometry[0]=Ot[0].concat(tt[Wt].geometry[0]),Wt}function tn(Ht,Ut,Ot){const Wt=Ot?Ut[0][Ut[0].length-1]:Ut[0][0];return`${Ht}:${Wt.x}:${Wt.y}`}for(let Ht=0;Ht<Fe.length;Ht++){const Ut=Fe[Ht],Ot=Ut.geometry,Wt=Ut.text?Ut.text.toString():null;if(!Wt){yt(Ht);continue}const $t=tn(Wt,Ot),St=tn(Wt,Ot,!0);if($t in ut&&St in it&&ut[$t]!==it[St]){const gn=Zt($t,St,Ot),ln=mt($t,St,tt[gn].geometry);delete it[$t],delete ut[St],ut[tn(Wt,tt[ln].geometry,!0)]=ln,tt[gn].geometry=null}else $t in ut?mt($t,St,Ot):St in it?Zt($t,St,Ot):(yt(Ht),it[$t]=at-1,ut[St]=at-1)}return tt.filter(Ht=>Ht.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Fe,it)=>Fe.sortKey-it.sortKey)}update(u,g,T){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(u,g,this.layers,T),this.icon.programConfigurations.updatePaintArrays(u,g,this.layers,T))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(u){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(u),this.iconCollisionBox.upload(u)),this.text.upload(u,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(u,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(u,g){const T=this.lineVertexArray.length;if(u.segment!==void 0){let D=u.dist(g[u.segment+1]),z=u.dist(g[u.segment]);const N={};for(let $=u.segment+1;$<g.length;$++)N[$]={x:g[$].x,y:g[$].y,tileUnitDistanceFromAnchor:D},$<g.length-1&&(D+=g[$+1].dist(g[$]));for(let $=u.segment||0;$>=0;$--)N[$]={x:g[$].x,y:g[$].y,tileUnitDistanceFromAnchor:z},$>0&&(z+=g[$-1].dist(g[$]));for(let $=0;$<g.length;$++){const Z=N[$];this.lineVertexArray.emplaceBack(Z.x,Z.y,Z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:T,lineLength:this.lineVertexArray.length-T}}addSymbols(u,g,T,D,z,N,$,Z,re,Ae,ce,ge){const ye=u.indexArray,_e=u.layoutVertexArray,Ve=u.segments.prepareSegment(4*g.length,_e,ye,this.canOverlap?N.sortKey:void 0),Fe=this.glyphOffsetArray.length,it=Ve.vertexLength,ut=this.allowVerticalPlacement&&$===o.WritingMode.vertical?Math.PI/2:0,tt=N.text&&N.text.sections;for(let at=0;at<g.length;at++){const{tl:yt,tr:mt,bl:Zt,br:tn,tex:Ht,pixelOffsetTL:Ut,pixelOffsetBR:Ot,minFontScaleX:Wt,minFontScaleY:$t,glyphOffset:St,isSDF:gn,sectionIndex:ln}=g[at],Wn=Ve.vertexLength,Vr=St[1];m1(_e,Z.x,Z.y,yt.x,Vr+yt.y,Ht.x,Ht.y,T,gn,Ut.x,Ut.y,Wt,$t),m1(_e,Z.x,Z.y,mt.x,Vr+mt.y,Ht.x+Ht.w,Ht.y,T,gn,Ot.x,Ut.y,Wt,$t),m1(_e,Z.x,Z.y,Zt.x,Vr+Zt.y,Ht.x,Ht.y+Ht.h,T,gn,Ut.x,Ot.y,Wt,$t),m1(_e,Z.x,Z.y,tn.x,Vr+tn.y,Ht.x+Ht.w,Ht.y+Ht.h,T,gn,Ot.x,Ot.y,Wt,$t),wx(u.dynamicLayoutVertexArray,Z,ut),ye.emplaceBack(Wn,Wn+1,Wn+2),ye.emplaceBack(Wn+1,Wn+2,Wn+3),Ve.vertexLength+=4,Ve.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(St[0]),at!==g.length-1&&ln===g[at+1].sectionIndex||u.programConfigurations.populatePaintArrays(_e.length,N,N.index,{},ge,tt&&tt[ln])}u.placedSymbolArray.emplaceBack(Z.x,Z.y,Fe,this.glyphOffsetArray.length-Fe,it,re,Ae,Z.segment,T?T[0]:0,T?T[1]:0,D[0],D[1],$,0,!1,0,ce)}_addCollisionDebugVertex(u,g,T,D,z,N){return g.emplaceBack(0,0),u.emplaceBack(T.x,T.y,D,z,Math.round(N.x),Math.round(N.y))}addCollisionDebugVertices(u,g,T,D,z,N,$){const Z=z.segments.prepareSegment(4,z.layoutVertexArray,z.indexArray),re=Z.vertexLength,Ae=z.layoutVertexArray,ce=z.collisionVertexArray,ge=$.anchorX,ye=$.anchorY;this._addCollisionDebugVertex(Ae,ce,N,ge,ye,new Et(u,g)),this._addCollisionDebugVertex(Ae,ce,N,ge,ye,new Et(T,g)),this._addCollisionDebugVertex(Ae,ce,N,ge,ye,new Et(T,D)),this._addCollisionDebugVertex(Ae,ce,N,ge,ye,new Et(u,D)),Z.vertexLength+=4;const _e=z.indexArray;_e.emplaceBack(re,re+1),_e.emplaceBack(re+1,re+2),_e.emplaceBack(re+2,re+3),_e.emplaceBack(re+3,re),Z.primitiveLength+=4}addDebugCollisionBoxes(u,g,T,D){for(let z=u;z<g;z++){const N=this.collisionBoxArray.get(z);this.addCollisionDebugVertices(N.x1,N.y1,N.x2,N.y2,D?this.textCollisionBox:this.iconCollisionBox,N.anchorPoint,T)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ex(ct,w5.members,et),this.iconCollisionBox=new Ex(ct,w5.members,et);for(let u=0;u<this.symbolInstances.length;u++){const g=this.symbolInstances.get(u);this.addDebugCollisionBoxes(g.textBoxStartIndex,g.textBoxEndIndex,g,!0),this.addDebugCollisionBoxes(g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g,!0),this.addDebugCollisionBoxes(g.iconBoxStartIndex,g.iconBoxEndIndex,g,!1),this.addDebugCollisionBoxes(g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g,!1)}}_deserializeCollisionBoxesForSymbol(u,g,T,D,z,N,$,Z,re){const Ae={};for(let ce=g;ce<T;ce++){const ge=u.get(ce);Ae.textBox={x1:ge.x1,y1:ge.y1,x2:ge.x2,y2:ge.y2,anchorPointX:ge.anchorPointX,anchorPointY:ge.anchorPointY},Ae.textFeatureIndex=ge.featureIndex;break}for(let ce=D;ce<z;ce++){const ge=u.get(ce);Ae.verticalTextBox={x1:ge.x1,y1:ge.y1,x2:ge.x2,y2:ge.y2,anchorPointX:ge.anchorPointX,anchorPointY:ge.anchorPointY},Ae.verticalTextFeatureIndex=ge.featureIndex;break}for(let ce=N;ce<$;ce++){const ge=u.get(ce);Ae.iconBox={x1:ge.x1,y1:ge.y1,x2:ge.x2,y2:ge.y2,anchorPointX:ge.anchorPointX,anchorPointY:ge.anchorPointY},Ae.iconFeatureIndex=ge.featureIndex;break}for(let ce=Z;ce<re;ce++){const ge=u.get(ce);Ae.verticalIconBox={x1:ge.x1,y1:ge.y1,x2:ge.x2,y2:ge.y2,anchorPointX:ge.anchorPointX,anchorPointY:ge.anchorPointY},Ae.verticalIconFeatureIndex=ge.featureIndex;break}return Ae}deserializeCollisionBoxes(u){this.collisionArrays=[];for(let g=0;g<this.symbolInstances.length;g++){const T=this.symbolInstances.get(g);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(u,T.textBoxStartIndex,T.textBoxEndIndex,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T.iconBoxStartIndex,T.iconBoxEndIndex,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(u,g){const T=u.placedSymbolArray.get(g),D=T.vertexStartIndex+4*T.numGlyphs;for(let z=T.vertexStartIndex;z<D;z+=4)u.indexArray.emplaceBack(z,z+1,z+2),u.indexArray.emplaceBack(z+1,z+2,z+3)}getSortedSymbolIndexes(u){if(this.sortedAngle===u&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const g=Math.sin(u),T=Math.cos(u),D=[],z=[],N=[];for(let $=0;$<this.symbolInstances.length;++$){N.push($);const Z=this.symbolInstances.get($);D.push(0|Math.round(g*Z.anchorX+T*Z.anchorY)),z.push(Z.featureIndex)}return N.sort(($,Z)=>D[$]-D[Z]||z[Z]-z[$]),N}addToSortKeyRanges(u,g){const T=this.sortKeyRanges[this.sortKeyRanges.length-1];T&&T.sortKey===g?T.symbolInstanceEnd=u+1:this.sortKeyRanges.push({sortKey:g,symbolInstanceStart:u,symbolInstanceEnd:u+1})}sortFeatures(u){if(this.sortFeaturesByY&&this.sortedAngle!==u&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(u),this.sortedAngle=u,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const g of this.symbolInstanceIndexes){const T=this.symbolInstances.get(g);this.featureSortOrder.push(T.featureIndex),[T.rightJustifiedTextSymbolIndex,T.centerJustifiedTextSymbolIndex,T.leftJustifiedTextSymbolIndex].forEach((D,z,N)=>{D>=0&&N.indexOf(D)===z&&this.addIndicesForPlacedSymbol(this.text,D)}),T.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,T.verticalPlacedTextSymbolIndex),T.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.placedIconSymbolIndex),T.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Nt("SymbolBucket",o0,{omit:["layers","collisionBoxArray","features","compareText"]}),o0.MAX_GLYPHS=65535,o0.addDynamicAttributes=wx;const L9=new jr({"symbol-placement":new Xt(ht.layout_symbol["symbol-placement"]),"symbol-spacing":new Xt(ht.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xt(ht.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Kt(ht.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xt(ht.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Xt(ht.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Xt(ht.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Xt(ht.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xt(ht.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xt(ht.layout_symbol["icon-rotation-alignment"]),"icon-size":new Kt(ht.layout_symbol["icon-size"]),"icon-text-fit":new Xt(ht.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Xt(ht.layout_symbol["icon-text-fit-padding"]),"icon-image":new Kt(ht.layout_symbol["icon-image"]),"icon-rotate":new Kt(ht.layout_symbol["icon-rotate"]),"icon-padding":new Kt(ht.layout_symbol["icon-padding"]),"icon-keep-upright":new Xt(ht.layout_symbol["icon-keep-upright"]),"icon-offset":new Kt(ht.layout_symbol["icon-offset"]),"icon-anchor":new Kt(ht.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xt(ht.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xt(ht.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xt(ht.layout_symbol["text-rotation-alignment"]),"text-field":new Kt(ht.layout_symbol["text-field"]),"text-font":new Kt(ht.layout_symbol["text-font"]),"text-size":new Kt(ht.layout_symbol["text-size"]),"text-max-width":new Kt(ht.layout_symbol["text-max-width"]),"text-line-height":new Xt(ht.layout_symbol["text-line-height"]),"text-letter-spacing":new Kt(ht.layout_symbol["text-letter-spacing"]),"text-justify":new Kt(ht.layout_symbol["text-justify"]),"text-radial-offset":new Kt(ht.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xt(ht.layout_symbol["text-variable-anchor"]),"text-anchor":new Kt(ht.layout_symbol["text-anchor"]),"text-max-angle":new Xt(ht.layout_symbol["text-max-angle"]),"text-writing-mode":new Xt(ht.layout_symbol["text-writing-mode"]),"text-rotate":new Kt(ht.layout_symbol["text-rotate"]),"text-padding":new Xt(ht.layout_symbol["text-padding"]),"text-keep-upright":new Xt(ht.layout_symbol["text-keep-upright"]),"text-transform":new Kt(ht.layout_symbol["text-transform"]),"text-offset":new Kt(ht.layout_symbol["text-offset"]),"text-allow-overlap":new Xt(ht.layout_symbol["text-allow-overlap"]),"text-overlap":new Xt(ht.layout_symbol["text-overlap"]),"text-ignore-placement":new Xt(ht.layout_symbol["text-ignore-placement"]),"text-optional":new Xt(ht.layout_symbol["text-optional"])});var Tx={paint:new jr({"icon-opacity":new Kt(ht.paint_symbol["icon-opacity"]),"icon-color":new Kt(ht.paint_symbol["icon-color"]),"icon-halo-color":new Kt(ht.paint_symbol["icon-halo-color"]),"icon-halo-width":new Kt(ht.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Kt(ht.paint_symbol["icon-halo-blur"]),"icon-translate":new Xt(ht.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xt(ht.paint_symbol["icon-translate-anchor"]),"text-opacity":new Kt(ht.paint_symbol["text-opacity"]),"text-color":new Kt(ht.paint_symbol["text-color"],{runtimeType:Rr,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new Kt(ht.paint_symbol["text-halo-color"]),"text-halo-width":new Kt(ht.paint_symbol["text-halo-width"]),"text-halo-blur":new Kt(ht.paint_symbol["text-halo-blur"]),"text-translate":new Xt(ht.paint_symbol["text-translate"]),"text-translate-anchor":new Xt(ht.paint_symbol["text-translate-anchor"])}),layout:L9};class q5{constructor(u){if(u.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=u.property.overrides?u.property.overrides.runtimeType:us,this.defaultValue=u}evaluate(u){if(u.formattedSection){const g=this.defaultValue.property.overrides;if(g&&g.hasOverride(u.formattedSection))return g.getOverride(u.formattedSection)}return u.feature&&u.featureState?this.defaultValue.evaluate(u.feature,u.featureState):this.defaultValue.property.specification.default}eachChild(u){this.defaultValue.isConstant()||u(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Nt("FormatSectionOverride",q5,{omit:["defaultValue"]});class y1 extends ks{constructor(u){super(u,Tx)}recalculate(u,g){if(super.recalculate(u,g),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const T=this.layout.get("text-writing-mode");if(T){const D=[];for(const z of T)D.indexOf(z)<0&&D.push(z);this.layout._values["text-writing-mode"]=D}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(u,g,T,D){const z=this.layout.get(u).evaluate(g,{},T,D),N=this._unevaluatedLayout._values[u];return N.isDataDriven()||zl(N.value)||!z?z:function($,Z){return Z.replace(/{([^{}]+)}/g,(re,Ae)=>Ae in $?String($[Ae]):"")}(g.properties,z)}createBucket(u){return new o0(u)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const u of Tx.paint.overridableProperties){if(!y1.hasPaintOverride(this.layout,u))continue;const g=this.paint.get(u),T=new q5(g),D=new Hs(T,g.property.specification);let z=null;z=g.value.kind==="constant"||g.value.kind==="source"?new xa("source",D):new Ol("composite",D,g.value.zoomStops),this.paint._values[u]=new xr(g.property,z,g.parameters)}}_handleOverridablePaintPropertyUpdate(u,g,T){return!(!this.layout||g.isDataDriven()||T.isDataDriven())&&y1.hasPaintOverride(this.layout,u)}static hasPaintOverride(u,g){const T=u.get("text-field"),D=Tx.paint.properties[g];let z=!1;const N=$=>{for(const Z of $)if(D.overrides&&D.overrides.hasOverride(Z))return void(z=!0)};if(T.value.kind==="constant"&&T.value.value instanceof ke)N(T.value.value.sections);else if(T.value.kind==="source"){const $=re=>{z||(re instanceof Dt&&Qe(re.value)===qr?N(re.value.sections):re instanceof LA?N(re.sections):re.eachChild($))},Z=T.value;Z._styleExpression&&$(Z._styleExpression.expression)}return z}}function Sx(f,u,g){let T="never";const D=f.get(u);return D?T=D:f.get(g)&&(T="always"),T}var D9={paint:new jr({"background-color":new Xt(ht.paint_background["background-color"]),"background-pattern":new es(ht.paint_background["background-pattern"]),"background-opacity":new Xt(ht.paint_background["background-opacity"])})},R9={paint:new jr({"raster-opacity":new Xt(ht.paint_raster["raster-opacity"]),"raster-hue-rotate":new Xt(ht.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xt(ht.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xt(ht.paint_raster["raster-brightness-max"]),"raster-saturation":new Xt(ht.paint_raster["raster-saturation"]),"raster-contrast":new Xt(ht.paint_raster["raster-contrast"]),"raster-resampling":new Xt(ht.paint_raster["raster-resampling"]),"raster-fade-duration":new Xt(ht.paint_raster["raster-fade-duration"])})};class B9 extends ks{constructor(u){super(u,{}),this.onAdd=g=>{this.implementation.onAdd&&this.implementation.onAdd(g,g.painter.context.gl)},this.onRemove=g=>{this.implementation.onRemove&&this.implementation.onRemove(g,g.painter.context.gl)},this.implementation=u}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const z9={circle:class extends ks{constructor(f){super(f,fN)}createBucket(f){return new Jv(f)}queryRadius(f){const u=f;return ip("circle-radius",this,u)+ip("circle-stroke-width",this,u)+t1(this.paint.get("circle-translate"))}queryIntersectsFeature(f,u,g,T,D,z,N,$){const Z=n1(f,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),z.angle,N),re=this.paint.get("circle-radius").evaluate(u,g)+this.paint.get("circle-stroke-width").evaluate(u,g),Ae=this.paint.get("circle-pitch-alignment")==="map",ce=Ae?Z:function(ye,_e){return ye.map(Ve=>s5(Ve,_e))}(Z,$),ge=Ae?re*N:re;for(const ye of T)for(const _e of ye){const Ve=Ae?_e:s5(_e,$);let Fe=ge;const it=r1([],[_e.x,_e.y,0,1],$);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Fe*=it[3]/z.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Fe*=z.cameraToCenterDistance/it[3]),lN(ce,Ve,Fe))return!0}return!1}},heatmap:class extends ks{constructor(f){super(f,pN),this._updateColorRamp()}createBucket(f){return new o5(f)}_handleSpecialPaintPropertyUpdate(f){f==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=l5({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends ks{constructor(f){super(f,gN)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends ks{constructor(f){super(f,LN)}recalculate(f,u){super.recalculate(f,u);const g=this.paint._values["fill-outline-color"];g.value.kind==="constant"&&g.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(f){return new cx(f)}queryRadius(){return t1(this.paint.get("fill-translate"))}queryIntersectsFeature(f,u,g,T,D,z,N){return X4(n1(f,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),z.angle,N),T)}isTileClipped(){return!0}},"fill-extrusion":class extends ks{constructor(f){super(f,WN)}createBucket(f){return new fx(f)}queryRadius(){return t1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(f,u,g,T,D,z,N,$){const Z=n1(f,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),z.angle,N),re=this.paint.get("fill-extrusion-height").evaluate(u,g),Ae=this.paint.get("fill-extrusion-base").evaluate(u,g),ce=function(ye,_e,Ve,Fe){const it=[];for(const ut of ye){const tt=[ut.x,ut.y,0,1];r1(tt,tt,_e),it.push(new Et(tt[0]/tt[3],tt[1]/tt[3]))}return it}(Z,$),ge=function(ye,_e,Ve,Fe){const it=[],ut=[],tt=Fe[8]*_e,at=Fe[9]*_e,yt=Fe[10]*_e,mt=Fe[11]*_e,Zt=Fe[8]*Ve,tn=Fe[9]*Ve,Ht=Fe[10]*Ve,Ut=Fe[11]*Ve;for(const Ot of ye){const Wt=[],$t=[];for(const St of Ot){const gn=St.x,ln=St.y,Wn=Fe[0]*gn+Fe[4]*ln+Fe[12],Vr=Fe[1]*gn+Fe[5]*ln+Fe[13],Wr=Fe[2]*gn+Fe[6]*ln+Fe[14],Fi=Fe[3]*gn+Fe[7]*ln+Fe[15],Pa=Wr+yt,ms=Fi+mt,Si=Wn+Zt,qi=Vr+tn,ys=Wr+Ht,Is=Fi+Ut,Mo=new Et((Wn+tt)/ms,(Vr+at)/ms);Mo.z=Pa/ms,Wt.push(Mo);const Ci=new Et(Si/Is,qi/Is);Ci.z=ys/Is,$t.push(Ci)}it.push(Wt),ut.push($t)}return[it,ut]}(T,Ae,re,$);return function(ye,_e,Ve){let Fe=1/0;X4(Ve,_e)&&(Fe=m5(Ve,_e[0]));for(let it=0;it<_e.length;it++){const ut=_e[it],tt=ye[it];for(let at=0;at<ut.length-1;at++){const yt=ut[at],mt=[yt,ut[at+1],tt[at+1],tt[at],yt];Y4(Ve,mt)&&(Fe=Math.min(Fe,m5(Ve,mt)))}}return Fe!==1/0&&Fe}(ge[0],ge[1],ce)}},line:class extends ks{constructor(f){super(f,_5),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(f){f==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Dr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(f,u){super.recalculate(f,u),this.paint._values["line-floorwidth"]=v5.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,f)}createBucket(f){return new dx(f)}queryRadius(f){const u=f,g=x5(ip("line-width",this,u),ip("line-gap-width",this,u)),T=ip("line-offset",this,u);return g/2+Math.abs(T)+t1(this.paint.get("line-translate"))}queryIntersectsFeature(f,u,g,T,D,z,N){const $=n1(f,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),z.angle,N),Z=N/2*x5(this.paint.get("line-width").evaluate(u,g),this.paint.get("line-gap-width").evaluate(u,g)),re=this.paint.get("line-offset").evaluate(u,g);return re&&(T=function(Ae,ce){const ge=[];for(let ye=0;ye<Ae.length;ye++){const _e=Ae[ye],Ve=[];for(let Fe=0;Fe<_e.length;Fe++){const it=_e[Fe-1],ut=_e[Fe],tt=_e[Fe+1],at=Fe===0?new Et(0,0):ut.sub(it)._unit()._perp(),yt=Fe===_e.length-1?new Et(0,0):tt.sub(ut)._unit()._perp(),mt=at._add(yt)._unit(),Zt=mt.x*yt.x+mt.y*yt.y;Zt!==0&&mt._mult(1/Zt),Ve.push(mt._mult(ce)._add(ut))}ge.push(Ve)}return ge}(T,re*N)),function(Ae,ce,ge){for(let ye=0;ye<ce.length;ye++){const _e=ce[ye];if(Ae.length>=3){for(let Ve=0;Ve<_e.length;Ve++)if(Jf(Ae,_e[Ve]))return!0}if(AN(Ae,_e,ge))return!0}return!1}($,T,Z)}isTileClipped(){return!0}},symbol:y1,background:class extends ks{constructor(f){super(f,D9)}},raster:class extends ks{constructor(f){super(f,R9)}}};class O9{constructor(u){this._callback=u,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Z5=63710088e-1;class pi{constructor(u,g){if(isNaN(u)||isNaN(g))throw new Error(`Invalid LngLat object: (${u}, ${g})`);if(this.lng=+u,this.lat=+g,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new pi(F(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(u){const g=Math.PI/180,T=this.lat*g,D=u.lat*g,z=Math.sin(T)*Math.sin(D)+Math.cos(T)*Math.cos(D)*Math.cos((u.lng-this.lng)*g);return Z5*Math.acos(Math.min(z,1))}toBounds(u=0){const g=360*u/40075017,T=g/Math.cos(Math.PI/180*this.lat);return new Uh(new pi(this.lng-T,this.lat-g),new pi(this.lng+T,this.lat+g))}static convert(u){if(u instanceof pi)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new pi(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&typeof u=="object"&&u!==null)return new pi(Number("lng"in u?u.lng:u.lon),Number(u.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Uh{constructor(u,g){u&&(g?this.setSouthWest(u).setNorthEast(g):u.length===4?this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]]):this.setSouthWest(u[0]).setNorthEast(u[1]))}setNorthEast(u){return this._ne=u instanceof pi?new pi(u.lng,u.lat):pi.convert(u),this}setSouthWest(u){return this._sw=u instanceof pi?new pi(u.lng,u.lat):pi.convert(u),this}extend(u){const g=this._sw,T=this._ne;let D,z;if(u instanceof pi)D=u,z=u;else{if(!(u instanceof Uh))return Array.isArray(u)?u.length===4||u.every(Array.isArray)?this.extend(Uh.convert(u)):this.extend(pi.convert(u)):this;if(D=u._sw,z=u._ne,!D||!z)return this}return g||T?(g.lng=Math.min(D.lng,g.lng),g.lat=Math.min(D.lat,g.lat),T.lng=Math.max(z.lng,T.lng),T.lat=Math.max(z.lat,T.lat)):(this._sw=new pi(D.lng,D.lat),this._ne=new pi(z.lng,z.lat)),this}getCenter(){return new pi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new pi(this.getWest(),this.getNorth())}getSouthEast(){return new pi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(u){const{lng:g,lat:T}=pi.convert(u);let D=this._sw.lng<=g&&g<=this._ne.lng;return this._sw.lng>this._ne.lng&&(D=this._sw.lng>=g&&g>=this._ne.lng),this._sw.lat<=T&&T<=this._ne.lat&&D}static convert(u){return u instanceof Uh?u:u&&new Uh(u)}}const Y5=2*Math.PI*Z5;function X5(f){return Y5*Math.cos(f*Math.PI/180)}function K5(f){return(180+f)/360}function J5(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function eC(f,u){return f/X5(u)}function Cx(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}class _1{constructor(u,g,T=0){this.x=+u,this.y=+g,this.z=+T}static fromLngLat(u,g=0){const T=pi.convert(u);return new _1(K5(T.lng),J5(T.lat),eC(g,T.lat))}toLngLat(){return new pi(360*this.x-180,Cx(this.y))}toAltitude(){return this.z*X5(Cx(this.y))}meterInMercatorCoordinateUnits(){return 1/Y5*(u=Cx(this.y),1/Math.cos(u*Math.PI/180));var u}}function tC(f,u,g){var T=2*Math.PI*6378137/256/Math.pow(2,g);return[f*T-2*Math.PI*6378137/2,u*T-2*Math.PI*6378137/2]}class Mx{constructor(u,g,T){if(u<0||u>25||T<0||T>=Math.pow(2,u)||g<0||g>=Math.pow(2,u))throw new Error(`x=${g}, y=${T}, z=${u} outside of bounds. 0<=x<${Math.pow(2,u)}, 0<=y<${Math.pow(2,u)} 0<=z<=25 `);this.z=u,this.x=g,this.y=T,this.key=pp(0,u,u,g,T)}equals(u){return this.z===u.z&&this.x===u.x&&this.y===u.y}url(u,g,T){const D=(N=this.y,$=this.z,Z=tC(256*(z=this.x),256*(N=Math.pow(2,$)-N-1),$),re=tC(256*(z+1),256*(N+1),$),Z[0]+","+Z[1]+","+re[0]+","+re[1]);var z,N,$,Z,re;const Ae=function(ce,ge,ye){let _e,Ve="";for(let Fe=ce;Fe>0;Fe--)_e=1<<Fe-1,Ve+=(ge&_e?1:0)+(ye&_e?2:0);return Ve}(this.z,this.x,this.y);return u[(this.x+this.y)%u.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(T==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,g>1?"@2x":"").replace(/{quadkey}/g,Ae).replace(/{bbox-epsg-3857}/g,D)}isChildOf(u){const g=this.z-u.z;return g>0&&u.x===this.x>>g&&u.y===this.y>>g}getTilePoint(u){const g=Math.pow(2,this.z);return new Et((u.x*g-this.x)*Oi,(u.y*g-this.y)*Oi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class nC{constructor(u,g){this.wrap=u,this.canonical=g,this.key=pp(u,g.z,g.z,g.x,g.y)}}class Ma{constructor(u,g,T,D,z){if(u<T)throw new Error(`overscaledZ should be >= z; overscaledZ = ${u}; z = ${T}`);this.overscaledZ=u,this.wrap=g,this.canonical=new Mx(T,+D,+z),this.key=pp(g,u,T,D,z)}clone(){return new Ma(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(u){return this.overscaledZ===u.overscaledZ&&this.wrap===u.wrap&&this.canonical.equals(u.canonical)}scaledTo(u){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const g=this.canonical.z-u;return u>this.canonical.z?new Ma(u,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ma(u,this.wrap,u,this.canonical.x>>g,this.canonical.y>>g)}calculateScaledKey(u,g){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const T=this.canonical.z-u;return u>this.canonical.z?pp(this.wrap*+g,u,this.canonical.z,this.canonical.x,this.canonical.y):pp(this.wrap*+g,u,u,this.canonical.x>>T,this.canonical.y>>T)}isChildOf(u){if(u.wrap!==this.wrap)return!1;const g=this.canonical.z-u.canonical.z;return u.overscaledZ===0||u.overscaledZ<this.overscaledZ&&u.canonical.x===this.canonical.x>>g&&u.canonical.y===this.canonical.y>>g}children(u){if(this.overscaledZ>=u)return[new Ma(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const g=this.canonical.z+1,T=2*this.canonical.x,D=2*this.canonical.y;return[new Ma(g,this.wrap,g,T,D),new Ma(g,this.wrap,g,T+1,D),new Ma(g,this.wrap,g,T,D+1),new Ma(g,this.wrap,g,T+1,D+1)]}isLessThan(u){return this.wrap<u.wrap||!(this.wrap>u.wrap)&&(this.overscaledZ<u.overscaledZ||!(this.overscaledZ>u.overscaledZ)&&(this.canonical.x<u.canonical.x||!(this.canonical.x>u.canonical.x)&&this.canonical.y<u.canonical.y))}wrapped(){return new Ma(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(u){return new Ma(this.overscaledZ,u,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new nC(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(u){return this.canonical.getTilePoint(new _1(u.x-this.wrap,u.y))}}function pp(f,u,g,T,D){(f*=2)<0&&(f=-1*f-1);const z=1<<g;return(z*z*f+z*D+T).toString(36)+g.toString(36)+u.toString(36)}Nt("CanonicalTileID",Mx),Nt("OverscaledTileID",Ma,{omit:["posMatrix"]});class rC{constructor(u,g,T){if(this.uid=u,g.height!==g.width)throw new RangeError("DEM tiles must be square");if(T&&T!=="mapbox"&&T!=="terrarium")return void pe(`"${T}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=g.height;const D=this.dim=g.height-2;this.data=new Uint32Array(g.data.buffer),this.encoding=T||"mapbox";for(let z=0;z<D;z++)this.data[this._idx(-1,z)]=this.data[this._idx(0,z)],this.data[this._idx(D,z)]=this.data[this._idx(D-1,z)],this.data[this._idx(z,-1)]=this.data[this._idx(z,0)],this.data[this._idx(z,D)]=this.data[this._idx(z,D-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(D,-1)]=this.data[this._idx(D-1,0)],this.data[this._idx(-1,D)]=this.data[this._idx(0,D-1)],this.data[this._idx(D,D)]=this.data[this._idx(D-1,D-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let z=0;z<D;z++)for(let N=0;N<D;N++){const $=this.get(z,N);$>this.max&&(this.max=$),$<this.min&&(this.min=$)}}get(u,g){const T=new Uint8Array(this.data.buffer),D=4*this._idx(u,g);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(T[D],T[D+1],T[D+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(u,g){if(u<-1||u>=this.dim+1||g<-1||g>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(g+1)*this.stride+(u+1)}_unpackMapbox(u,g,T){return(256*u*256+256*g+T)/10-1e4}_unpackTerrarium(u,g,T){return 256*u+g+T/256-32768}getPixels(){return new Ca({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(u,g,T){if(this.dim!==u.dim)throw new Error("dem dimension mismatch");let D=g*this.dim,z=g*this.dim+this.dim,N=T*this.dim,$=T*this.dim+this.dim;switch(g){case-1:D=z-1;break;case 1:z=D+1}switch(T){case-1:N=$-1;break;case 1:$=N+1}const Z=-g*this.dim,re=-T*this.dim;for(let Ae=N;Ae<$;Ae++)for(let ce=D;ce<z;ce++)this.data[this._idx(ce,Ae)]=u.data[this._idx(ce+Z,Ae+re)]}}Nt("DEMData",rC);class iC{constructor(u){this._stringToNumber={},this._numberToString=[];for(let g=0;g<u.length;g++){const T=u[g];this._stringToNumber[T]=g,this._numberToString[g]=T}}encode(u){return this._stringToNumber[u]}decode(u){if(u>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${u} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[u]}}class sC{constructor(u,g,T,D,z){this.type="Feature",this._vectorTileFeature=u,u._z=g,u._x=T,u._y=D,this.properties=u.properties,this.id=z}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(u){this._geometry=u}toJSON(){const u={geometry:this.geometry};for(const g in this)g!=="_geometry"&&g!=="_vectorTileFeature"&&(u[g]=this[g]);return u}}class oC{constructor(u,g){this.tileID=u,this.x=u.canonical.x,this.y=u.canonical.y,this.z=u.canonical.z,this.grid=new Ea(Oi,16,0),this.grid3D=new Ea(Oi,16,0),this.featureIndexArray=new O,this.promoteId=g}insert(u,g,T,D,z,N){const $=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(T,D,z);const Z=N?this.grid3D:this.grid;for(let re=0;re<g.length;re++){const Ae=g[re],ce=[1/0,1/0,-1/0,-1/0];for(let ge=0;ge<Ae.length;ge++){const ye=Ae[ge];ce[0]=Math.min(ce[0],ye.x),ce[1]=Math.min(ce[1],ye.y),ce[2]=Math.max(ce[2],ye.x),ce[3]=Math.max(ce[3],ye.y)}ce[0]<Oi&&ce[1]<Oi&&ce[2]>=0&&ce[3]>=0&&Z.insert($,ce[0],ce[1],ce[2],ce[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Rc.VectorTile(new px(this.rawTileData)).layers,this.sourceLayerCoder=new iC(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(u,g,T,D){this.loadVTLayers();const z=u.params||{},N=Oi/u.tileSize/u.scale,$=Ws(z.filter),Z=u.queryGeometry,re=u.queryPadding*N,Ae=lC(Z),ce=this.grid.query(Ae.minX-re,Ae.minY-re,Ae.maxX+re,Ae.maxY+re),ge=lC(u.cameraQueryGeometry),ye=this.grid3D.query(ge.minX-re,ge.minY-re,ge.maxX+re,ge.maxY+re,(Fe,it,ut,tt)=>function(at,yt,mt,Zt,tn){for(const Ut of at)if(yt<=Ut.x&&mt<=Ut.y&&Zt>=Ut.x&&tn>=Ut.y)return!0;const Ht=[new Et(yt,mt),new Et(yt,tn),new Et(Zt,tn),new Et(Zt,mt)];if(at.length>2){for(const Ut of Ht)if(Jf(at,Ut))return!0}for(let Ut=0;Ut<at.length-1;Ut++)if(cN(at[Ut],at[Ut+1],Ht))return!0;return!1}(u.cameraQueryGeometry,Fe-re,it-re,ut+re,tt+re));for(const Fe of ye)ce.push(Fe);ce.sort(F9);const _e={};let Ve;for(let Fe=0;Fe<ce.length;Fe++){const it=ce[Fe];if(it===Ve)continue;Ve=it;const ut=this.featureIndexArray.get(it);let tt=null;this.loadMatchingFeature(_e,ut.bucketIndex,ut.sourceLayerIndex,ut.featureIndex,$,z.layers,z.availableImages,g,T,D,(at,yt,mt)=>(tt||(tt=Oh(at)),yt.queryIntersectsFeature(Z,at,mt,tt,this.z,u.transform,N,u.pixelPosMatrix)))}return _e}loadMatchingFeature(u,g,T,D,z,N,$,Z,re,Ae,ce){const ge=this.bucketLayerIDs[g];if(N&&!function(Fe,it){for(let ut=0;ut<Fe.length;ut++)if(it.indexOf(Fe[ut])>=0)return!0;return!1}(N,ge))return;const ye=this.sourceLayerCoder.decode(T),_e=this.vtLayers[ye].feature(D);if(z.needGeometry){const Fe=Fh(_e,!0);if(!z.filter(new Pr(this.tileID.overscaledZ),Fe,this.tileID.canonical))return}else if(!z.filter(new Pr(this.tileID.overscaledZ),_e))return;const Ve=this.getId(_e,ye);for(let Fe=0;Fe<ge.length;Fe++){const it=ge[Fe];if(N&&N.indexOf(it)<0)continue;const ut=Z[it];if(!ut)continue;let tt={};Ve&&Ae&&(tt=Ae.getState(ut.sourceLayer||"_geojsonTileLayer",Ve));const at=j({},re[it]);at.paint=aC(at.paint,ut.paint,_e,tt,$),at.layout=aC(at.layout,ut.layout,_e,tt,$);const yt=!ce||ce(_e,ut,tt);if(!yt)continue;const mt=new sC(_e,this.z,this.x,this.y,Ve);mt.layer=at;let Zt=u[it];Zt===void 0&&(Zt=u[it]=[]),Zt.push({featureIndex:D,feature:mt,intersectionZ:yt})}}lookupSymbolFeatures(u,g,T,D,z,N,$,Z){const re={};this.loadVTLayers();const Ae=Ws(z);for(const ce of u)this.loadMatchingFeature(re,T,D,ce,Ae,N,$,Z,g);return re}hasLayer(u){for(const g of this.bucketLayerIDs)for(const T of g)if(u===T)return!0;return!1}getId(u,g){let T=u.id;return this.promoteId&&(T=u.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[g]],typeof T=="boolean"&&(T=Number(T))),T}}function aC(f,u,g,T,D){return Y(f,(z,N)=>{const $=u instanceof Wl?u.get(N):null;return $&&$.evaluate?$.evaluate(g,T,D):$})}function lC(f){let u=1/0,g=1/0,T=-1/0,D=-1/0;for(const z of f)u=Math.min(u,z.x),g=Math.min(g,z.y),T=Math.max(T,z.x),D=Math.max(D,z.y);return{minX:u,minY:g,maxX:T,maxY:D}}function F9(f,u){return u-f}var Px;Nt("FeatureIndex",oC,{omit:["rawTileData","sourceLayerCoder"]}),o.PerformanceMarkers=void 0,(Px=o.PerformanceMarkers||(o.PerformanceMarkers={})).create="create",Px.load="load",Px.fullLoad="fullLoad";let v1=null,gp=[];const kx=1e3/30,N9={mark(f){performance.mark(f)},frame(f){const u=f;v1!=null&&gp.push(u-v1),v1=u},clearMetrics(){v1=null,gp=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const f in o.PerformanceMarkers)performance.clearMarks(o.PerformanceMarkers[f])},getPerformanceMetrics(){performance.measure("loadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.load),performance.measure("fullLoadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.fullLoad);const f=performance.getEntriesByName("loadTime")[0].duration,u=performance.getEntriesByName("fullLoadTime")[0].duration,g=gp.length,T=1/(gp.reduce((z,N)=>z+N,0)/g/1e3),D=gp.filter(z=>z>kx).reduce((z,N)=>z+(N-kx)/kx,0);return{loadTime:f,fullLoadTime:u,fps:T,percentDroppedFrames:D/(g+D)*100}}};o.AJAXError=nr,o.ARRAY_TYPE=eo,o.Actor=class{constructor(f,u,g){this.target=f,this.parent=u,this.mapId=g,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ie(["receive","process"],this),this.invoker=new O9(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=We()?f:window}send(f,u,g,T,D=!1){const z=Math.round(1e18*Math.random()).toString(36).substring(0,10);g&&(this.callbacks[z]=g);const N=Ze(this.globalScope)?void 0:[];return this.target.postMessage({id:z,type:f,hasCallback:!!g,targetMapId:T,mustQueue:D,sourceMapId:this.mapId,data:Ta(u,N)},N),{cancel:()=>{g&&delete this.callbacks[z],this.target.postMessage({id:z,type:"<cancel>",targetMapId:T,sourceMapId:this.mapId})}}}receive(f){const u=f.data,g=u.id;if(g&&(!u.targetMapId||this.mapId===u.targetMapId))if(u.type==="<cancel>"){delete this.tasks[g];const T=this.cancelCallbacks[g];delete this.cancelCallbacks[g],T&&T()}else We()||u.mustQueue?(this.tasks[g]=u,this.taskQueue.push(g),this.invoker.trigger()):this.processTask(g,u)}process(){if(!this.taskQueue.length)return;const f=this.taskQueue.shift(),u=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),u&&this.processTask(f,u)}processTask(f,u){if(u.type==="<response>"){const g=this.callbacks[f];delete this.callbacks[f],g&&(u.error?g(ea(u.error)):g(null,ea(u.data)))}else{let g=!1;const T=Ze(this.globalScope)?void 0:[],D=u.hasCallback?($,Z)=>{g=!0,delete this.cancelCallbacks[f],this.target.postMessage({id:f,type:"<response>",sourceMapId:this.mapId,error:$?Ta($):null,data:Ta(Z,T)},T)}:$=>{g=!0};let z=null;const N=ea(u.data);if(this.parent[u.type])z=this.parent[u.type](u.sourceMapId,N,D);else if(this.parent.getWorkerSource){const $=u.type.split(".");z=this.parent.getWorkerSource(u.sourceMapId,$[0],N.source)[$[1]](N,D)}else D(new Error(`Could not find function ${u.type}`));!g&&z&&z.cancel&&(this.cancelCallbacks[f]=z.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.AlphaImage=op,o.CanonicalTileID=Mx,o.CollisionBoxArray=$e,o.CollisionCircleLayoutArray=class extends B{},o.Color=a,o.DEMData=rC,o.DataConstantProperty=Xt,o.DictionaryCoder=iC,o.EXTENT=Oi,o.ErrorEvent=Ho,o.EvaluationParameters=Pr,o.Event=Li,o.Evented=As,o.FeatureIndex=oC,o.FillBucket=cx,o.FillExtrusionBucket=fx,o.GeoJSONFeature=sC,o.ImageAtlas=k5,o.ImagePosition=mx,o.LineBucket=dx,o.LineStripIndexArray=class extends ve{},o.LngLat=pi,o.LngLatBounds=Uh,o.MercatorCoordinate=_1,o.ONE_EM=ts,o.OverscaledTileID=Ma,o.PerformanceUtils=N9,o.PosArray=U,o.Properties=jr,o.QuadTriangleArray=class extends W{},o.RGBAImage=Ca,o.RasterBoundsArray=class extends L{},o.RequestPerformance=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return f.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),f}},o.ResourceType=xt,o.SegmentVector=gt,o.SymbolBucket=o0,o.Transitionable=Su,o.TriangleIndexArray=ot,o.Uniform1f=Mu,o.Uniform1i=class extends ll{constructor(f,u){super(f,u),this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},o.Uniform2f=class extends ll{constructor(f,u){super(f,u),this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}},o.Uniform3f=class extends ll{constructor(f,u){super(f,u),this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}},o.Uniform4f=Xf,o.UniformColor=W4,o.UniformMatrix4f=class extends ll{constructor(f,u){super(f,u),this.current=oN}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let u=1;u<16;u++)if(f[u]!==this.current[u]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}},o.UnwrappedTileID=nC,o.ValidationError=It,o.ZoomHistory=vu,o.add=function(f,u,g){return f[0]=u[0]+g[0],f[1]=u[1]+g[1],f[2]=u[2]+g[2],f},o.addDynamicAttributes=wx,o.asyncAll=function(f,u,g){if(!f.length)return g(null,[]);let T=f.length;const D=new Array(f.length);let z=null;f.forEach((N,$)=>{u(N,(Z,re)=>{Z&&(z=Z),D[$]=re,--T==0&&g(z,D)})})},o.bezier=C,o.bindAll=ie,o.cacheEntryPossiblyAdded=function(f){ar++,ar>Ir&&(f.getActor().send("enforceCacheSizeLimit",Tn),ar=0)},o.clamp=k,o.clearTileCache=function(f){const u=caches.delete(Tt);f&&u.catch(f).then(()=>f())},o.clipLine=G5,o.clone=function(f){var u=new eo(16);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5],u[6]=f[6],u[7]=f[7],u[8]=f[8],u[9]=f[9],u[10]=f[10],u[11]=f[11],u[12]=f[12],u[13]=f[13],u[14]=f[14],u[15]=f[15],u},o.clone$1=se,o.clone$2=function(f){var u=new eo(3);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u},o.collisionCircleLayout=r9,o.config=_t,o.copy=function(f,u){return f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[4]=u[4],f[5]=u[5],f[6]=u[6],f[7]=u[7],f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},o.create=function(){var f=new eo(16);return eo!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},o.create$1=e5,o.createExpression=Ja,o.createFilter=Ws,o.createLayout=Hr,o.createStyleLayer=function(f){return f.type==="custom"?new B9(f):new z9[f.type](f)},o.cross=function(f,u,g){var T=u[0],D=u[1],z=u[2],N=g[0],$=g[1],Z=g[2];return f[0]=D*Z-z*$,f[1]=z*N-T*Z,f[2]=T*$-D*N,f},o.dot=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]},o.dot$1=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]+f[3]*u[3]},o.ease=M,o.emitValidationErrors=il,o.enforceCacheSizeLimit=function(f){tr(),Jt&&Jt.then(u=>{u.keys().then(g=>{for(let T=0;T<g.length-f;T++)u.delete(g[T])})})},o.equals=function(f,u){var g=f[0],T=f[1],D=f[2],z=f[3],N=f[4],$=f[5],Z=f[6],re=f[7],Ae=f[8],ce=f[9],ge=f[10],ye=f[11],_e=f[12],Ve=f[13],Fe=f[14],it=f[15],ut=u[0],tt=u[1],at=u[2],yt=u[3],mt=u[4],Zt=u[5],tn=u[6],Ht=u[7],Ut=u[8],Ot=u[9],Wt=u[10],$t=u[11],St=u[12],gn=u[13],ln=u[14],Wn=u[15];return Math.abs(g-ut)<=Js*Math.max(1,Math.abs(g),Math.abs(ut))&&Math.abs(T-tt)<=Js*Math.max(1,Math.abs(T),Math.abs(tt))&&Math.abs(D-at)<=Js*Math.max(1,Math.abs(D),Math.abs(at))&&Math.abs(z-yt)<=Js*Math.max(1,Math.abs(z),Math.abs(yt))&&Math.abs(N-mt)<=Js*Math.max(1,Math.abs(N),Math.abs(mt))&&Math.abs($-Zt)<=Js*Math.max(1,Math.abs($),Math.abs(Zt))&&Math.abs(Z-tn)<=Js*Math.max(1,Math.abs(Z),Math.abs(tn))&&Math.abs(re-Ht)<=Js*Math.max(1,Math.abs(re),Math.abs(Ht))&&Math.abs(Ae-Ut)<=Js*Math.max(1,Math.abs(Ae),Math.abs(Ut))&&Math.abs(ce-Ot)<=Js*Math.max(1,Math.abs(ce),Math.abs(Ot))&&Math.abs(ge-Wt)<=Js*Math.max(1,Math.abs(ge),Math.abs(Wt))&&Math.abs(ye-$t)<=Js*Math.max(1,Math.abs(ye),Math.abs($t))&&Math.abs(_e-St)<=Js*Math.max(1,Math.abs(_e),Math.abs(St))&&Math.abs(Ve-gn)<=Js*Math.max(1,Math.abs(Ve),Math.abs(gn))&&Math.abs(Fe-ln)<=Js*Math.max(1,Math.abs(Fe),Math.abs(ln))&&Math.abs(it-Wn)<=Js*Math.max(1,Math.abs(it),Math.abs(Wn))},o.evaluateSizeForFeature=function(f,{uSize:u,uSizeT:g},{lowerSize:T,upperSize:D}){return f.kind==="source"?T/Iu:f.kind==="composite"?en(T/Iu,D/Iu,g):u},o.evaluateSizeForZoom=function(f,u){let g=0,T=0;if(f.kind==="constant")T=f.layoutSize;else if(f.kind!=="source"){const{interpolationType:D,minZoom:z,maxZoom:N}=f,$=D?k(On.interpolationFactor(D,u,z,N),0,1):0;f.kind==="camera"?T=en(f.minSize,f.maxSize,$):g=$}return{uSizeT:g,uSize:T}},o.evaluateVariableOffset=H5,o.evented=Ur,o.exported=Yt,o.exported$1=pr,o.extend=j,o.filterObject=J,o.fromRotation=function(f,u){var g=Math.sin(u),T=Math.cos(u);return f[0]=T,f[1]=g,f[2]=0,f[3]=-g,f[4]=T,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},o.fromScaling=function(f,u){return f[0]=u[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=u[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=u[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},o.getAnchorAlignment=_x,o.getAnchorJustification=xx,o.getArrayBuffer=rr,o.getImage=Gi,o.getJSON=function(f,u){return cr(j(f,{type:"json"}),u)},o.getOverlapMode=Sx,o.getRTLTextPluginStatus=jl,o.getReferrer=Qn,o.getVideo=function(f,u){const g=window.document.createElement("video");g.muted=!0,g.onloadstart=function(){u(null,g)};for(let T=0;T<f.length;T++){const D=window.document.createElement("source");ni(f[T])||(g.crossOrigin="Anonymous"),D.src=f[T],g.appendChild(D)}return{cancel:()=>{}}},o.identity=nx,o.invert=function(f,u){var g=u[0],T=u[1],D=u[2],z=u[3],N=u[4],$=u[5],Z=u[6],re=u[7],Ae=u[8],ce=u[9],ge=u[10],ye=u[11],_e=u[12],Ve=u[13],Fe=u[14],it=u[15],ut=g*$-T*N,tt=g*Z-D*N,at=g*re-z*N,yt=T*Z-D*$,mt=T*re-z*$,Zt=D*re-z*Z,tn=Ae*Ve-ce*_e,Ht=Ae*Fe-ge*_e,Ut=Ae*it-ye*_e,Ot=ce*Fe-ge*Ve,Wt=ce*it-ye*Ve,$t=ge*it-ye*Fe,St=ut*$t-tt*Wt+at*Ot+yt*Ut-mt*Ht+Zt*tn;return St?(f[0]=($*$t-Z*Wt+re*Ot)*(St=1/St),f[1]=(D*Wt-T*$t-z*Ot)*St,f[2]=(Ve*Zt-Fe*mt+it*yt)*St,f[3]=(ge*mt-ce*Zt-ye*yt)*St,f[4]=(Z*Ut-N*$t-re*Ht)*St,f[5]=(g*$t-D*Ut+z*Ht)*St,f[6]=(Fe*at-_e*Zt-it*tt)*St,f[7]=(Ae*Zt-ge*at+ye*tt)*St,f[8]=(N*Wt-$*Ut+re*tn)*St,f[9]=(T*Ut-g*Wt-z*tn)*St,f[10]=(_e*mt-Ve*at+it*ut)*St,f[11]=(ce*at-Ae*mt-ye*ut)*St,f[12]=($*Ht-N*Ot-Z*tn)*St,f[13]=(g*Ot-T*Ht+D*tn)*St,f[14]=(Ve*tt-_e*yt-Fe*ut)*St,f[15]=(Ae*yt-ce*tt+ge*ut)*St,f):null},o.isImageBitmap=pt,o.isSafari=Ze,o.isWorker=We,o.keysDifference=function(f,u){const g=[];for(const T in f)T in u||g.push(T);return g},o.lazyLoadRTLTextPlugin=function(){gs.isLoading()||gs.isLoaded()||jl()!=="deferred"||kc()},o.makeRequest=cr,o.mapObject=Y,o.mercatorXfromLng=K5,o.mercatorYfromLat=J5,o.mercatorZfromAltitude=eC,o.mul=dN,o.mul$1=function(f,u,g){return f[0]=u[0]*g[0],f[1]=u[1]*g[1],f[2]=u[2]*g[2],f[3]=u[3]*g[3],f},o.multiply=t5,o.nextPowerOfTwo=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},o.normalize=function(f,u){var g=u[0],T=u[1],D=u[2],z=g*g+T*T+D*D;return z>0&&(z=1/Math.sqrt(z)),f[0]=u[0]*z,f[1]=u[1]*z,f[2]=u[2]*z,f},o.number=en,o.ortho=function(f,u,g,T,D,z,N){var $=1/(u-g),Z=1/(T-D),re=1/(z-N);return f[0]=-2*$,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*Z,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*re,f[11]=0,f[12]=(u+g)*$,f[13]=(D+T)*Z,f[14]=(N+z)*re,f[15]=1,f},o.parseCacheControl=Xe,o.parseGlyphPbf=function(f){return new px(f).readFields(d9,[])},o.pbf=px,o.performSymbolLayout=function(f){f.bucket.createArrays(),f.bucket.tilePixelRatio=Oi/(512*f.bucket.overscaling),f.bucket.compareText={},f.bucket.iconsNeedLinear=!1;const u=f.bucket.layers[0].layout,g=f.bucket.layers[0]._unevaluatedLayout._values,T={layoutIconSize:g["icon-size"].possiblyEvaluate(new Pr(f.bucket.zoom+1),f.canonical),layoutTextSize:g["text-size"].possiblyEvaluate(new Pr(f.bucket.zoom+1),f.canonical),textMaxSize:g["text-size"].possiblyEvaluate(new Pr(18))};if(f.bucket.textSizeData.kind==="composite"){const{minZoom:Z,maxZoom:re}=f.bucket.textSizeData;T.compositeTextSizes=[g["text-size"].possiblyEvaluate(new Pr(Z),f.canonical),g["text-size"].possiblyEvaluate(new Pr(re),f.canonical)]}if(f.bucket.iconSizeData.kind==="composite"){const{minZoom:Z,maxZoom:re}=f.bucket.iconSizeData;T.compositeIconSizes=[g["icon-size"].possiblyEvaluate(new Pr(Z),f.canonical),g["icon-size"].possiblyEvaluate(new Pr(re),f.canonical)]}const D=u.get("text-line-height")*ts,z=u.get("text-rotation-alignment")!=="viewport"&&u.get("symbol-placement")!=="point",N=u.get("text-keep-upright"),$=u.get("text-size");for(const Z of f.bucket.features){const re=u.get("text-font").evaluate(Z,{},f.canonical).join(","),Ae=$.evaluate(Z,{},f.canonical),ce=T.layoutTextSize.evaluate(Z,{},f.canonical),ge=T.layoutIconSize.evaluate(Z,{},f.canonical),ye={horizontal:{},vertical:void 0},_e=Z.text;let Ve,Fe=[0,0];if(_e){const tt=_e.toString(),at=u.get("text-letter-spacing").evaluate(Z,{},f.canonical)*ts,yt=$l(tt)?at:0,mt=u.get("text-anchor").evaluate(Z,{},f.canonical),Zt=u.get("text-variable-anchor");if(!Zt){const Wt=u.get("text-radial-offset").evaluate(Z,{},f.canonical);Fe=Wt?H5(mt,[Wt*ts,vx]):u.get("text-offset").evaluate(Z,{},f.canonical).map($t=>$t*ts)}let tn=z?"center":u.get("text-justify").evaluate(Z,{},f.canonical);const Ht=u.get("symbol-placement"),Ut=Ht==="point"?u.get("text-max-width").evaluate(Z,{},f.canonical)*ts:0,Ot=()=>{f.bucket.allowVerticalPlacement&&BA(tt)&&(ye.vertical=c1(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,mt,"left",yt,Fe,o.WritingMode.vertical,!0,Ht,ce,Ae))};if(!z&&Zt){const Wt=tn==="auto"?Zt.map(St=>xx(St)):[tn];let $t=!1;for(let St=0;St<Wt.length;St++){const gn=Wt[St];if(!ye.horizontal[gn])if($t)ye.horizontal[gn]=ye.horizontal[0];else{const ln=c1(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,"center",gn,yt,Fe,o.WritingMode.horizontal,!1,Ht,ce,Ae);ln&&(ye.horizontal[gn]=ln,$t=ln.positionedLines.length===1)}}Ot()}else{tn==="auto"&&(tn=xx(mt));const Wt=c1(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,mt,tn,yt,Fe,o.WritingMode.horizontal,!1,Ht,ce,Ae);Wt&&(ye.horizontal[tn]=Wt),Ot(),BA(tt)&&z&&N&&(ye.vertical=c1(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,mt,tn,yt,Fe,o.WritingMode.vertical,!1,Ht,ce,Ae))}}let it=!1;if(Z.icon&&Z.icon.name){const tt=f.imageMap[Z.icon.name];tt&&(Ve=v9(f.imagePositions[Z.icon.name],u.get("icon-offset").evaluate(Z,{},f.canonical),u.get("icon-anchor").evaluate(Z,{},f.canonical)),it=!!tt.sdf,f.bucket.sdfIcons===void 0?f.bucket.sdfIcons=it:f.bucket.sdfIcons!==it&&pe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(tt.pixelRatio!==f.bucket.pixelRatio||u.get("icon-rotate").constantOr(1)!==0)&&(f.bucket.iconsNeedLinear=!0))}const ut=Q5(ye.horizontal)||ye.vertical;f.bucket.iconsInText=!!ut&&ut.iconsInText,(ut||Ve)&&C9(f.bucket,Z,ye,Ve,f.imageMap,T,ce,ge,Fe,it,f.canonical)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()},o.perspective=function(f,u,g,T,D){var z,N=1/Math.tan(u/2);return f[0]=N/g,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=N,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,D!=null&&D!==1/0?(f[10]=(D+T)*(z=1/(T-D)),f[14]=2*D*T*z):(f[10]=-1,f[14]=-2*T),f},o.pick=function(f,u){const g={};for(let T=0;T<u.length;T++){const D=u[T];D in f&&(g[D]=f[D])}return g},o.plugin=gs,o.pointGeometry=Et,o.polygonIntersectsPolygon=Y4,o.potpack=P5,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=Nt,o.registerForPluginStateChange=function(f){return f({pluginStatus:zi,pluginURL:Co}),Ur.on("pluginStateChange",f),f},o.renderColorRamp=l5,o.rotateX=function(f,u,g){var T=Math.sin(g),D=Math.cos(g),z=u[4],N=u[5],$=u[6],Z=u[7],re=u[8],Ae=u[9],ce=u[10],ge=u[11];return u!==f&&(f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[4]=z*D+re*T,f[5]=N*D+Ae*T,f[6]=$*D+ce*T,f[7]=Z*D+ge*T,f[8]=re*D-z*T,f[9]=Ae*D-N*T,f[10]=ce*D-$*T,f[11]=ge*D-Z*T,f},o.rotateZ=function(f,u,g){var T=Math.sin(g),D=Math.cos(g),z=u[0],N=u[1],$=u[2],Z=u[3],re=u[4],Ae=u[5],ce=u[6],ge=u[7];return u!==f&&(f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[0]=z*D+re*T,f[1]=N*D+Ae*T,f[2]=$*D+ce*T,f[3]=Z*D+ge*T,f[4]=re*D-z*T,f[5]=Ae*D-N*T,f[6]=ce*D-$*T,f[7]=ge*D-Z*T,f},o.scale=function(f,u,g){var T=g[0],D=g[1],z=g[2];return f[0]=u[0]*T,f[1]=u[1]*T,f[2]=u[2]*T,f[3]=u[3]*T,f[4]=u[4]*D,f[5]=u[5]*D,f[6]=u[6]*D,f[7]=u[7]*D,f[8]=u[8]*z,f[9]=u[9]*z,f[10]=u[10]*z,f[11]=u[11]*z,f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},o.scale$1=function(f,u,g){return f[0]=u[0]*g,f[1]=u[1]*g,f[2]=u[2]*g,f},o.setCacheLimits=function(f,u){Tn=f,Ir=u},o.setRTLTextPlugin=function(f,u,g=!1){if(zi===wu||zi===bu||zi===Eu)throw new Error("setRTLTextPlugin cannot be called multiple times.");Co=Yt.resolveURL(f),zi=wu,Zs=u,Sa(),g||kc()},o.spec=ht,o.sphericalToCartesian=function([f,u,g]){return u+=90,u*=Math.PI/180,g*=Math.PI/180,{x:f*Math.cos(u)*Math.sin(g),y:f*Math.sin(u)*Math.sin(g),z:f*Math.cos(g)}},o.sqrLen=function(f){var u=f[0],g=f[1];return u*u+g*g},o.sub=function(f,u,g){return f[0]=u[0]-g[0],f[1]=u[1]-g[1],f[2]=u[2]-g[2],f},o.toEvaluationFeature=Fh,o.transformMat3=function(f,u,g){var T=u[0],D=u[1],z=u[2];return f[0]=T*g[0]+D*g[3]+z*g[6],f[1]=T*g[1]+D*g[4]+z*g[7],f[2]=T*g[2]+D*g[5]+z*g[8],f},o.transformMat4=r1,o.transformMat4$1=function(f,u,g){var T=u[0],D=u[1];return f[0]=g[0]*T+g[4]*D+g[12],f[1]=g[1]*T+g[5]*D+g[13],f},o.translate=function(f,u,g){var T,D,z,N,$,Z,re,Ae,ce,ge,ye,_e,Ve=g[0],Fe=g[1],it=g[2];return u===f?(f[12]=u[0]*Ve+u[4]*Fe+u[8]*it+u[12],f[13]=u[1]*Ve+u[5]*Fe+u[9]*it+u[13],f[14]=u[2]*Ve+u[6]*Fe+u[10]*it+u[14],f[15]=u[3]*Ve+u[7]*Fe+u[11]*it+u[15]):(D=u[1],z=u[2],N=u[3],$=u[4],Z=u[5],re=u[6],Ae=u[7],ce=u[8],ge=u[9],ye=u[10],_e=u[11],f[0]=T=u[0],f[1]=D,f[2]=z,f[3]=N,f[4]=$,f[5]=Z,f[6]=re,f[7]=Ae,f[8]=ce,f[9]=ge,f[10]=ye,f[11]=_e,f[12]=T*Ve+$*Fe+ce*it+u[12],f[13]=D*Ve+Z*Fe+ge*it+u[13],f[14]=z*Ve+re*Fe+ye*it+u[14],f[15]=N*Ve+Ae*Fe+_e*it+u[15]),f},o.triggerPluginCompletionEvent=Tu,o.unicodeBlockLookup=Vt,o.uniqueId=function(){return H++},o.validateCustomStyleLayer=function(f){const u=[],g=f.id;return g===void 0&&u.push({message:`layers.${g}: missing required property "id"`}),f.render===void 0&&u.push({message:`layers.${g}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&u.push({message:`layers.${g}: property "renderingMode" must be either "2d" or "3d"`}),u},o.validateLight=rl,o.validateStyle=Gl,o.vectorTile=Rc,o.warnOnce=pe,o.wrap=F}),s(["./shared"],function(o){function p(K){const Q=typeof K;if(Q==="number"||Q==="boolean"||Q==="string"||K==null)return JSON.stringify(K);if(Array.isArray(K)){let a="[";for(const G of K)a+=`${p(G)},`;return`${a}]`}const te=Object.keys(K).sort();let fe="{";for(let a=0;a<te.length;a++)fe+=`${JSON.stringify(te[a])}:${p(K[te[a]])},`;return`${fe}}`}function _(K){let Q="";for(const te of o.refProperties)Q+=`/${p(K[te])}`;return Q}class C{constructor(Q){this.keyCache={},Q&&this.replace(Q)}replace(Q){this._layerConfigs={},this._layers={},this.update(Q,[])}update(Q,te){for(const a of Q){this._layerConfigs[a.id]=a;const G=this._layers[a.id]=o.createStyleLayer(a);G._featureFilter=o.createFilter(G.filter),this.keyCache[a.id]&&delete this.keyCache[a.id]}for(const a of te)delete this.keyCache[a],delete this._layerConfigs[a],delete this._layers[a];this.familiesBySource={};const fe=function(a,G){const Le={};for(let Pe=0;Pe<a.length;Pe++){const Ie=G&&G[a[Pe].id]||_(a[Pe]);G&&(G[a[Pe].id]=Ie);let qe=Le[Ie];qe||(qe=Le[Ie]=[]),qe.push(a[Pe])}const ke=[];for(const Pe in Le)ke.push(Le[Pe]);return ke}(Object.values(this._layerConfigs),this.keyCache);for(const a of fe){const G=a.map(At=>this._layers[At.id]),Le=G[0];if(Le.visibility==="none")continue;const ke=Le.source||"";let Pe=this.familiesBySource[ke];Pe||(Pe=this.familiesBySource[ke]={});const Ie=Le.sourceLayer||"_geojsonTileLayer";let qe=Pe[Ie];qe||(qe=Pe[Ie]=[]),qe.push(G)}}}class M{constructor(Q){const te={},fe=[];for(const ke in Q){const Pe=Q[ke],Ie=te[ke]={};for(const qe in Pe){const At=Pe[+qe];if(!At||At.bitmap.width===0||At.bitmap.height===0)continue;const Qe={x:0,y:0,w:At.bitmap.width+2,h:At.bitmap.height+2};fe.push(Qe),Ie[qe]={rect:Qe,metrics:At.metrics}}}const{w:a,h:G}=o.potpack(fe),Le=new o.AlphaImage({width:a||1,height:G||1});for(const ke in Q){const Pe=Q[ke];for(const Ie in Pe){const qe=Pe[+Ie];if(!qe||qe.bitmap.width===0||qe.bitmap.height===0)continue;const At=te[ke][Ie].rect;o.AlphaImage.copy(qe.bitmap,Le,{x:0,y:0},{x:At.x+1,y:At.y+1},qe.bitmap)}}this.image=Le,this.positions=te}}o.register("GlyphAtlas",M);class k{constructor(Q){this.tileID=new o.OverscaledTileID(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),this.uid=Q.uid,this.zoom=Q.zoom,this.pixelRatio=Q.pixelRatio,this.tileSize=Q.tileSize,this.source=Q.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Q.showCollisionBoxes,this.collectResourceTiming=!!Q.collectResourceTiming,this.returnDependencies=!!Q.returnDependencies,this.promoteId=Q.promoteId}parse(Q,te,fe,a,G){this.status="parsing",this.data=Q,this.collisionBoxArray=new o.CollisionBoxArray;const Le=new o.DictionaryCoder(Object.keys(Q.layers).sort()),ke=new o.FeatureIndex(this.tileID,this.promoteId);ke.bucketLayerIDs=[];const Pe={},Ie={featureIndex:ke,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:fe},qe=te.familiesBySource[this.source];for(const qt in qe){const an=Q.layers[qt];if(!an)continue;an.version===1&&o.warnOnce(`Vector tile source "${this.source}" layer "${qt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xn=Le.encode(qt),Ft=[];for(let Ne=0;Ne<an.length;Ne++){const Mt=an.feature(Ne),Ce=ke.getId(Mt,qt);Ft.push({feature:Mt,id:Ce,index:Ne,sourceLayerIndex:xn})}for(const Ne of qe[qt]){const Mt=Ne[0];Mt.source!==this.source&&o.warnOnce(`layer.source = ${Mt.source} does not equal this.source = ${this.source}`),Mt.minzoom&&this.zoom<Math.floor(Mt.minzoom)||Mt.maxzoom&&this.zoom>=Mt.maxzoom||Mt.visibility!=="none"&&(F(Ne,this.zoom,fe),(Pe[Mt.id]=Mt.createBucket({index:ke.bucketLayerIDs.length,layers:Ne,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xn,sourceID:this.source})).populate(Ft,Ie,this.tileID.canonical),ke.bucketLayerIDs.push(Ne.map(Ce=>Ce.id)))}}let At,Qe,dt,Dt;const Rt=o.mapObject(Ie.glyphDependencies,qt=>Object.keys(qt).map(Number));Object.keys(Rt).length?a.send("getGlyphs",{uid:this.uid,stacks:Rt},(qt,an)=>{At||(At=qt,Qe=an,pn.call(this))}):Qe={};const sn=Object.keys(Ie.iconDependencies);sn.length?a.send("getImages",{icons:sn,source:this.source,tileID:this.tileID,type:"icons"},(qt,an)=>{At||(At=qt,dt=an,pn.call(this))}):dt={};const jt=Object.keys(Ie.patternDependencies);function pn(){if(At)return G(At);if(Qe&&dt&&Dt){const qt=new M(Qe),an=new o.ImageAtlas(dt,Dt);for(const xn in Pe){const Ft=Pe[xn];Ft instanceof o.SymbolBucket?(F(Ft.layers,this.zoom,fe),o.performSymbolLayout({bucket:Ft,glyphMap:Qe,glyphPositions:qt.positions,imageMap:dt,imagePositions:an.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ft.hasPattern&&(Ft instanceof o.LineBucket||Ft instanceof o.FillBucket||Ft instanceof o.FillExtrusionBucket)&&(F(Ft.layers,this.zoom,fe),Ft.addFeatures(Ie,this.tileID.canonical,an.patternPositions))}this.status="done",G(null,{buckets:Object.values(Pe).filter(xn=>!xn.isEmpty()),featureIndex:ke,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:qt.image,imageAtlas:an,glyphMap:this.returnDependencies?Qe:null,iconMap:this.returnDependencies?dt:null,glyphPositions:this.returnDependencies?qt.positions:null})}}jt.length?a.send("getImages",{icons:jt,source:this.source,tileID:this.tileID,type:"patterns"},(qt,an)=>{At||(At=qt,Dt=an,pn.call(this))}):Dt={},pn.call(this)}}function F(K,Q,te){const fe=new o.EvaluationParameters(Q);for(const a of K)a.recalculate(fe,te)}function j(K,Q){const te=o.getArrayBuffer(K.request,(fe,a,G,Le)=>{fe?Q(fe):a&&Q(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(a)),rawData:a,cacheControl:G,expires:Le})});return()=>{te.cancel(),Q()}}class H{constructor(Q,te,fe,a){this.actor=Q,this.layerIndex=te,this.availableImages=fe,this.loadVectorData=a||j,this.loading={},this.loaded={}}loadTile(Q,te){const fe=Q.uid;this.loading||(this.loading={});const a=!!(Q&&Q.request&&Q.request.collectResourceTiming)&&new o.RequestPerformance(Q.request),G=this.loading[fe]=new k(Q);G.abort=this.loadVectorData(Q,(Le,ke)=>{if(delete this.loading[fe],Le||!ke)return G.status="done",this.loaded[fe]=G,te(Le);const Pe=ke.rawData,Ie={};ke.expires&&(Ie.expires=ke.expires),ke.cacheControl&&(Ie.cacheControl=ke.cacheControl);const qe={};if(a){const At=a.finish();At&&(qe.resourceTiming=JSON.parse(JSON.stringify(At)))}G.vectorTile=ke.vectorTile,G.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor,(At,Qe)=>{if(At||!Qe)return te(At);te(null,o.extend({rawTileData:Pe.slice(0)},Qe,Ie,qe))}),this.loaded=this.loaded||{},this.loaded[fe]=G})}reloadTile(Q,te){const fe=this.loaded,a=Q.uid,G=this;if(fe&&fe[a]){const Le=fe[a];Le.showCollisionBoxes=Q.showCollisionBoxes;const ke=(Pe,Ie)=>{const qe=Le.reloadCallback;qe&&(delete Le.reloadCallback,Le.parse(Le.vectorTile,G.layerIndex,this.availableImages,G.actor,qe)),te(Pe,Ie)};Le.status==="parsing"?Le.reloadCallback=ke:Le.status==="done"&&(Le.vectorTile?Le.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.actor,ke):ke())}}abortTile(Q,te){const fe=this.loading,a=Q.uid;fe&&fe[a]&&fe[a].abort&&(fe[a].abort(),delete fe[a]),te()}removeTile(Q,te){const fe=this.loaded,a=Q.uid;fe&&fe[a]&&delete fe[a],te()}}class ie{constructor(){this.loaded={}}loadTile(Q,te){const{uid:fe,encoding:a,rawImageData:G}=Q,Le=o.isImageBitmap(G)?this.getImageData(G):G,ke=new o.DEMData(fe,Le,a);this.loaded=this.loaded||{},this.loaded[fe]=ke,te(null,ke)}getImageData(Q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Q.width,Q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Q.width,this.offscreenCanvas.height=Q.height,this.offscreenCanvasContext.drawImage(Q,0,0,Q.width,Q.height);const te=this.offscreenCanvasContext.getImageData(-1,-1,Q.width+2,Q.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:te.width,height:te.height},te.data)}removeTile(Q){const te=this.loaded,fe=Q.uid;te&&te[fe]&&delete te[fe]}}var Y=function K(Q,te){var fe,a=Q&&Q.type;if(a==="FeatureCollection")for(fe=0;fe<Q.features.length;fe++)K(Q.features[fe],te);else if(a==="GeometryCollection")for(fe=0;fe<Q.geometries.length;fe++)K(Q.geometries[fe],te);else if(a==="Feature")K(Q.geometry,te);else if(a==="Polygon")J(Q.coordinates,te);else if(a==="MultiPolygon")for(fe=0;fe<Q.coordinates.length;fe++)J(Q.coordinates[fe],te);return Q};function J(K,Q){if(K.length!==0){se(K[0],Q);for(var te=1;te<K.length;te++)se(K[te],!Q)}}function se(K,Q){for(var te=0,fe=0,a=0,G=K.length,Le=G-1;a<G;Le=a++){var ke=(K[a][0]-K[Le][0])*(K[Le][1]+K[a][1]),Pe=te+ke;fe+=Math.abs(te)>=Math.abs(ke)?te-Pe+ke:ke-Pe+te,te=Pe}te+fe>=0!=!!Q&&K.reverse()}const he=o.vectorTile.VectorTileFeature.prototype.toGeoJSON;class pe{constructor(Q){this._feature=Q,this.extent=o.EXTENT,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(this._feature.type===1){const Q=[];for(const te of this._feature.geometry)Q.push([new o.pointGeometry(te[0],te[1])]);return Q}{const Q=[];for(const te of this._feature.geometry){const fe=[];for(const a of te)fe.push(new o.pointGeometry(a[0],a[1]));Q.push(fe)}return Q}}toGeoJSON(Q,te,fe){return he.call(this,Q,te,fe)}}class be{constructor(Q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=Q.length,this._features=Q}feature(Q){return new pe(this._features[Q])}}var Ge={exports:{}},We=o.pointGeometry,Xe=o.vectorTile.VectorTileFeature,rt=Oe;function Oe(K,Q){this.options=Q||{},this.features=K,this.length=K.length}function nt(K,Q){this.id=typeof K.id=="number"?K.id:void 0,this.type=K.type,this.rawGeometry=K.type===1?[K.geometry]:K.geometry,this.properties=K.tags,this.extent=Q||4096}Oe.prototype.feature=function(K){return new nt(this.features[K],this.options.extent)},nt.prototype.loadGeometry=function(){var K=this.rawGeometry;this.geometry=[];for(var Q=0;Q<K.length;Q++){for(var te=K[Q],fe=[],a=0;a<te.length;a++)fe.push(new We(te[a][0],te[a][1]));this.geometry.push(fe)}return this.geometry},nt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var K=this.geometry,Q=1/0,te=-1/0,fe=1/0,a=-1/0,G=0;G<K.length;G++)for(var Le=K[G],ke=0;ke<Le.length;ke++){var Pe=Le[ke];Q=Math.min(Q,Pe.x),te=Math.max(te,Pe.x),fe=Math.min(fe,Pe.y),a=Math.max(a,Pe.y)}return[Q,fe,te,a]},nt.prototype.toGeoJSON=Xe.prototype.toGeoJSON;var Ze=o.pbf,pt=rt;function Yt(K){var Q=new Ze;return function(te,fe){for(var a in te.layers)fe.writeMessage(3,Et,te.layers[a])}(K,Q),Q.finish()}function Et(K,Q){var te;Q.writeVarintField(15,K.version||1),Q.writeStringField(1,K.name||""),Q.writeVarintField(5,K.extent||4096);var fe={keys:[],values:[],keycache:{},valuecache:{}};for(te=0;te<K.length;te++)fe.feature=K.feature(te),Q.writeMessage(2,un,fe);var a=fe.keys;for(te=0;te<a.length;te++)Q.writeStringField(3,a[te]);var G=fe.values;for(te=0;te<G.length;te++)Q.writeMessage(4,Tn,G[te])}function un(K,Q){var te=K.feature;te.id!==void 0&&Q.writeVarintField(1,te.id),Q.writeMessage(2,_t,K),Q.writeVarintField(3,te.type),Q.writeMessage(4,Ln,te)}function _t(K,Q){var te=K.feature,fe=K.keys,a=K.values,G=K.keycache,Le=K.valuecache;for(var ke in te.properties){var Pe=te.properties[ke],Ie=G[ke];if(Pe!==null){Ie===void 0&&(fe.push(ke),G[ke]=Ie=fe.length-1),Q.writeVarint(Ie);var qe=typeof Pe;qe!=="string"&&qe!=="boolean"&&qe!=="number"&&(Pe=JSON.stringify(Pe));var At=qe+":"+Pe,Qe=Le[At];Qe===void 0&&(a.push(Pe),Le[At]=Qe=a.length-1),Q.writeVarint(Qe)}}}function Tt(K,Q){return(Q<<3)+(7&K)}function Jt(K){return K<<1^K>>31}function Ln(K,Q){for(var te=K.loadGeometry(),fe=K.type,a=0,G=0,Le=te.length,ke=0;ke<Le;ke++){var Pe=te[ke],Ie=1;fe===1&&(Ie=Pe.length),Q.writeVarint(Tt(1,Ie));for(var qe=fe===3?Pe.length-1:Pe.length,At=0;At<qe;At++){At===1&&fe!==1&&Q.writeVarint(Tt(2,qe-1));var Qe=Pe[At].x-a,dt=Pe[At].y-G;Q.writeVarint(Jt(Qe)),Q.writeVarint(Jt(dt)),a+=Qe,G+=dt}fe===3&&Q.writeVarint(Tt(7,1))}}function Tn(K,Q){var te=typeof K;te==="string"?Q.writeStringField(1,K):te==="boolean"?Q.writeBooleanField(7,K):te==="number"&&(K%1!=0?Q.writeDoubleField(3,K):K<0?Q.writeSVarintField(6,K):Q.writeVarintField(5,K))}function Ir(K,Q,te,fe,a,G){if(a-fe<=te)return;const Le=fe+a>>1;tr(K,Q,Le,fe,a,G%2),Ir(K,Q,te,fe,Le-1,G+1),Ir(K,Q,te,Le+1,a,G+1)}function tr(K,Q,te,fe,a,G){for(;a>fe;){if(a-fe>600){const Ie=a-fe+1,qe=te-fe+1,At=Math.log(Ie),Qe=.5*Math.exp(2*At/3),dt=.5*Math.sqrt(At*Qe*(Ie-Qe)/Ie)*(qe-Ie/2<0?-1:1);tr(K,Q,te,Math.max(fe,Math.floor(te-qe*Qe/Ie+dt)),Math.min(a,Math.floor(te+(Ie-qe)*Qe/Ie+dt)),G)}const Le=Q[2*te+G];let ke=fe,Pe=a;for(ar(K,Q,fe,te),Q[2*a+G]>Le&&ar(K,Q,fe,a);ke<Pe;){for(ar(K,Q,ke,Pe),ke++,Pe--;Q[2*ke+G]<Le;)ke++;for(;Q[2*Pe+G]>Le;)Pe--}Q[2*fe+G]===Le?ar(K,Q,fe,Pe):(Pe++,ar(K,Q,Pe,a)),Pe<=te&&(fe=Pe+1),te<=Pe&&(a=Pe-1)}}function ar(K,Q,te,fe){pr(K,te,fe),pr(Q,2*te,2*fe),pr(Q,2*te+1,2*fe+1)}function pr(K,Q,te){const fe=K[Q];K[Q]=K[te],K[te]=fe}function Gn(K,Q,te,fe){const a=K-te,G=Q-fe;return a*a+G*G}Ge.exports=Yt,Ge.exports.fromVectorTileJs=Yt,Ge.exports.fromGeojsonVt=function(K,Q){Q=Q||{};var te={};for(var fe in K)te[fe]=new pt(K[fe].features,Q),te[fe].name=fe,te[fe].version=Q.version,te[fe].extent=Q.extent;return Yt({layers:te})},Ge.exports.GeoJSONWrapper=pt;const Mr=K=>K[0],wt=K=>K[1];class rn{constructor(Q,te=Mr,fe=wt,a=64,G=Float64Array){this.nodeSize=a,this.points=Q;const Le=Q.length<65536?Uint16Array:Uint32Array,ke=this.ids=new Le(Q.length),Pe=this.coords=new G(2*Q.length);for(let Ie=0;Ie<Q.length;Ie++)ke[Ie]=Ie,Pe[2*Ie]=te(Q[Ie]),Pe[2*Ie+1]=fe(Q[Ie]);Ir(ke,Pe,a,0,ke.length-1,0)}range(Q,te,fe,a){return function(G,Le,ke,Pe,Ie,qe,At){const Qe=[0,G.length-1,0],dt=[];let Dt,Rt;for(;Qe.length;){const sn=Qe.pop(),jt=Qe.pop(),pn=Qe.pop();if(jt-pn<=At){for(let xn=pn;xn<=jt;xn++)Dt=Le[2*xn],Rt=Le[2*xn+1],Dt>=ke&&Dt<=Ie&&Rt>=Pe&&Rt<=qe&&dt.push(G[xn]);continue}const qt=Math.floor((pn+jt)/2);Dt=Le[2*qt],Rt=Le[2*qt+1],Dt>=ke&&Dt<=Ie&&Rt>=Pe&&Rt<=qe&&dt.push(G[qt]);const an=(sn+1)%2;(sn===0?ke<=Dt:Pe<=Rt)&&(Qe.push(pn),Qe.push(qt-1),Qe.push(an)),(sn===0?Ie>=Dt:qe>=Rt)&&(Qe.push(qt+1),Qe.push(jt),Qe.push(an))}return dt}(this.ids,this.coords,Q,te,fe,a,this.nodeSize)}within(Q,te,fe){return function(a,G,Le,ke,Pe,Ie){const qe=[0,a.length-1,0],At=[],Qe=Pe*Pe;for(;qe.length;){const dt=qe.pop(),Dt=qe.pop(),Rt=qe.pop();if(Dt-Rt<=Ie){for(let an=Rt;an<=Dt;an++)Gn(G[2*an],G[2*an+1],Le,ke)<=Qe&&At.push(a[an]);continue}const sn=Math.floor((Rt+Dt)/2),jt=G[2*sn],pn=G[2*sn+1];Gn(jt,pn,Le,ke)<=Qe&&At.push(a[sn]);const qt=(dt+1)%2;(dt===0?Le-Pe<=jt:ke-Pe<=pn)&&(qe.push(Rt),qe.push(sn-1),qe.push(qt)),(dt===0?Le+Pe>=jt:ke+Pe>=pn)&&(qe.push(sn+1),qe.push(Dt),qe.push(qt))}return At}(this.ids,this.coords,Q,te,fe,this.nodeSize)}}const Pn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:K=>K},xt=Math.fround||(nr=new Float32Array(1),K=>(nr[0]=+K,nr[0]));var nr;class Qn{constructor(Q){this.options=Gi(Object.create(Pn),Q),this.trees=new Array(this.options.maxZoom+1)}load(Q){const{log:te,minZoom:fe,maxZoom:a,nodeSize:G}=this.options;te&&console.time("total time");const Le=`prepare ${Q.length} points`;te&&console.time(Le),this.points=Q;let ke=[];for(let Pe=0;Pe<Q.length;Pe++)Q[Pe].geometry&&ke.push(cr(Q[Pe],Pe));this.trees[a+1]=new rn(ke,vo,$r,G,Float32Array),te&&console.timeEnd(Le);for(let Pe=a;Pe>=fe;Pe--){const Ie=+Date.now();ke=this._cluster(ke,Pe),this.trees[Pe]=new rn(ke,vo,$r,G,Float32Array),te&&console.log("z%d: %d clusters in %dms",Pe,ke.length,+Date.now()-Ie)}return te&&console.timeEnd("total time"),this}getClusters(Q,te){let fe=((Q[0]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,Q[1]));let G=Q[2]===180?180:((Q[2]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)fe=-180,G=180;else if(fe>G){const qe=this.getClusters([fe,a,180,Le],te),At=this.getClusters([-180,a,G,Le],te);return qe.concat(At)}const ke=this.trees[this._limitZoom(te)],Pe=ke.range($n(fe),Ii(Le),$n(G),Ii(a)),Ie=[];for(const qe of Pe){const At=ke.points[qe];Ie.push(At.numPoints?rr(At):this.points[At.index])}return Ie}getChildren(Q){const te=this._getOriginId(Q),fe=this._getOriginZoom(Q),a="No cluster with the specified id.",G=this.trees[fe];if(!G)throw new Error(a);const Le=G.points[te];if(!Le)throw new Error(a);const ke=this.options.radius/(this.options.extent*Math.pow(2,fe-1)),Pe=G.within(Le.x,Le.y,ke),Ie=[];for(const qe of Pe){const At=G.points[qe];At.parentId===Q&&Ie.push(At.numPoints?rr(At):this.points[At.index])}if(Ie.length===0)throw new Error(a);return Ie}getLeaves(Q,te,fe){const a=[];return this._appendLeaves(a,Q,te=te||10,fe=fe||0,0),a}getTile(Q,te,fe){const a=this.trees[this._limitZoom(Q)],G=Math.pow(2,Q),{extent:Le,radius:ke}=this.options,Pe=ke/Le,Ie=(fe-Pe)/G,qe=(fe+1+Pe)/G,At={features:[]};return this._addTileFeatures(a.range((te-Pe)/G,Ie,(te+1+Pe)/G,qe),a.points,te,fe,G,At),te===0&&this._addTileFeatures(a.range(1-Pe/G,Ie,1,qe),a.points,G,fe,G,At),te===G-1&&this._addTileFeatures(a.range(0,Ie,Pe/G,qe),a.points,-1,fe,G,At),At.features.length?At:null}getClusterExpansionZoom(Q){let te=this._getOriginZoom(Q)-1;for(;te<=this.options.maxZoom;){const fe=this.getChildren(Q);if(te++,fe.length!==1)break;Q=fe[0].properties.cluster_id}return te}_appendLeaves(Q,te,fe,a,G){const Le=this.getChildren(te);for(const ke of Le){const Pe=ke.properties;if(Pe&&Pe.cluster?G+Pe.point_count<=a?G+=Pe.point_count:G=this._appendLeaves(Q,Pe.cluster_id,fe,a,G):G<a?G++:Q.push(ke),Q.length===fe)break}return G}_addTileFeatures(Q,te,fe,a,G,Le){for(const ke of Q){const Pe=te[ke],Ie=Pe.numPoints;let qe,At,Qe;if(Ie)qe=ni(Pe),At=Pe.x,Qe=Pe.y;else{const Rt=this.points[Pe.index];qe=Rt.properties,At=$n(Rt.geometry.coordinates[0]),Qe=Ii(Rt.geometry.coordinates[1])}const dt={type:1,geometry:[[Math.round(this.options.extent*(At*G-fe)),Math.round(this.options.extent*(Qe*G-a))]],tags:qe};let Dt;Ie?Dt=Pe.id:this.options.generateId?Dt=Pe.index:this.points[Pe.index].id&&(Dt=this.points[Pe.index].id),Dt!==void 0&&(dt.id=Dt),Le.features.push(dt)}}_limitZoom(Q){return Math.max(this.options.minZoom,Math.min(Math.floor(+Q),this.options.maxZoom+1))}_cluster(Q,te){const fe=[],{radius:a,extent:G,reduce:Le,minPoints:ke}=this.options,Pe=a/(G*Math.pow(2,te));for(let Ie=0;Ie<Q.length;Ie++){const qe=Q[Ie];if(qe.zoom<=te)continue;qe.zoom=te;const At=this.trees[te+1],Qe=At.within(qe.x,qe.y,Pe),dt=qe.numPoints||1;let Dt=dt;for(const Rt of Qe){const sn=At.points[Rt];sn.zoom>te&&(Dt+=sn.numPoints||1)}if(Dt>dt&&Dt>=ke){let Rt=qe.x*dt,sn=qe.y*dt,jt=Le&&dt>1?this._map(qe,!0):null;const pn=(Ie<<5)+(te+1)+this.points.length;for(const qt of Qe){const an=At.points[qt];if(an.zoom<=te)continue;an.zoom=te;const xn=an.numPoints||1;Rt+=an.x*xn,sn+=an.y*xn,an.parentId=pn,Le&&(jt||(jt=this._map(qe,!0)),Le(jt,this._map(an)))}qe.parentId=pn,fe.push(br(Rt/Dt,sn/Dt,pn,Dt,jt))}else if(fe.push(qe),Dt>1)for(const Rt of Qe){const sn=At.points[Rt];sn.zoom<=te||(sn.zoom=te,fe.push(sn))}}return fe}_getOriginId(Q){return Q-this.points.length>>5}_getOriginZoom(Q){return(Q-this.points.length)%32}_map(Q,te){if(Q.numPoints)return te?Gi({},Q.properties):Q.properties;const fe=this.points[Q.index].properties,a=this.options.map(fe);return te&&a===fe?Gi({},a):a}}function br(K,Q,te,fe,a){return{x:xt(K),y:xt(Q),zoom:1/0,id:te,parentId:-1,numPoints:fe,properties:a}}function cr(K,Q){const[te,fe]=K.geometry.coordinates;return{x:xt($n(te)),y:xt(Ii(fe)),zoom:1/0,index:Q,parentId:-1}}function rr(K){return{type:"Feature",id:K.id,properties:ni(K),geometry:{type:"Point",coordinates:[(Q=K.x,360*(Q-.5)),qn(K.y)]}};var Q}function ni(K){const Q=K.numPoints,te=Q>=1e4?`${Math.round(Q/1e3)}k`:Q>=1e3?Math.round(Q/100)/10+"k":Q;return Gi(Gi({},K.properties),{cluster:!0,cluster_id:K.id,point_count:Q,point_count_abbreviated:te})}function $n(K){return K/360+.5}function Ii(K){const Q=Math.sin(K*Math.PI/180),te=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return te<0?0:te>1?1:te}function qn(K){const Q=(180-360*K)*Math.PI/180;return 360*Math.atan(Math.exp(Q))/Math.PI-90}function Gi(K,Q){for(const te in Q)K[te]=Q[te];return K}function vo(K){return K.x}function $r(K){return K.y}function Li(K,Q,te,fe){for(var a,G=fe,Le=te-Q>>1,ke=te-Q,Pe=K[Q],Ie=K[Q+1],qe=K[te],At=K[te+1],Qe=Q+3;Qe<te;Qe+=3){var dt=Ho(K[Qe],K[Qe+1],Pe,Ie,qe,At);if(dt>G)a=Qe,G=dt;else if(dt===G){var Dt=Math.abs(Qe-Le);Dt<ke&&(a=Qe,ke=Dt)}}G>fe&&(a-Q>3&&Li(K,Q,a,fe),K[a+2]=G,te-a>3&&Li(K,a,te,fe))}function Ho(K,Q,te,fe,a,G){var Le=a-te,ke=G-fe;if(Le!==0||ke!==0){var Pe=((K-te)*Le+(Q-fe)*ke)/(Le*Le+ke*ke);Pe>1?(te=a,fe=G):Pe>0&&(te+=Le*Pe,fe+=ke*Pe)}return(Le=K-te)*Le+(ke=Q-fe)*ke}function As(K,Q,te,fe){var a={id:K===void 0?null:K,type:Q,geometry:te,tags:fe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(G){var Le=G.geometry,ke=G.type;if(ke==="Point"||ke==="MultiPoint"||ke==="LineString")ht(G,Le);else if(ke==="Polygon"||ke==="MultiLineString")for(var Pe=0;Pe<Le.length;Pe++)ht(G,Le[Pe]);else if(ke==="MultiPolygon")for(Pe=0;Pe<Le.length;Pe++)for(var Ie=0;Ie<Le[Pe].length;Ie++)ht(G,Le[Pe][Ie])}(a),a}function ht(K,Q){for(var te=0;te<Q.length;te+=3)K.minX=Math.min(K.minX,Q[te]),K.minY=Math.min(K.minY,Q[te+1]),K.maxX=Math.max(K.maxX,Q[te]),K.maxY=Math.max(K.maxY,Q[te+1])}function It(K,Q,te,fe){if(Q.geometry){var a=Q.geometry.coordinates,G=Q.geometry.type,Le=Math.pow(te.tolerance/((1<<te.maxZoom)*te.extent),2),ke=[],Pe=Q.id;if(te.promoteId?Pe=Q.properties[te.promoteId]:te.generateId&&(Pe=fe||0),G==="Point")Vs(a,ke);else if(G==="MultiPoint")for(var Ie=0;Ie<a.length;Ie++)Vs(a[Ie],ke);else if(G==="LineString")Ei(a,ke,Le,!1);else if(G==="MultiLineString"){if(te.lineMetrics){for(Ie=0;Ie<a.length;Ie++)Ei(a[Ie],ke=[],Le,!1),K.push(As(Pe,"LineString",ke,Q.properties));return}zn(a,ke,Le,!1)}else if(G==="Polygon")zn(a,ke,Le,!0);else{if(G!=="MultiPolygon"){if(G==="GeometryCollection"){for(Ie=0;Ie<Q.geometry.geometries.length;Ie++)It(K,{id:Pe,geometry:Q.geometry.geometries[Ie],properties:Q.properties},te,fe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ie=0;Ie<a.length;Ie++){var qe=[];zn(a[Ie],qe,Le,!0),ke.push(qe)}}K.push(As(Pe,G,ke,Q.properties))}}function Vs(K,Q){Q.push($i(K[0])),Q.push(Di(K[1])),Q.push(0)}function Ei(K,Q,te,fe){for(var a,G,Le=0,ke=0;ke<K.length;ke++){var Pe=$i(K[ke][0]),Ie=Di(K[ke][1]);Q.push(Pe),Q.push(Ie),Q.push(0),ke>0&&(Le+=fe?(a*Ie-Pe*G)/2:Math.sqrt(Math.pow(Pe-a,2)+Math.pow(Ie-G,2))),a=Pe,G=Ie}var qe=Q.length-3;Q[2]=1,Li(Q,0,qe,te),Q[qe+2]=1,Q.size=Math.abs(Le),Q.start=0,Q.end=Q.size}function zn(K,Q,te,fe){for(var a=0;a<K.length;a++){var G=[];Ei(K[a],G,te,fe),Q.push(G)}}function $i(K){return K/360+.5}function Di(K){var Q=Math.sin(K*Math.PI/180),te=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return te<0?0:te>1?1:te}function Ri(K,Q,te,fe,a,G,Le,ke){if(fe/=Q,G>=(te/=Q)&&Le<fe)return K;if(Le<te||G>=fe)return null;for(var Pe=[],Ie=0;Ie<K.length;Ie++){var qe=K[Ie],At=qe.geometry,Qe=qe.type,dt=a===0?qe.minX:qe.minY,Dt=a===0?qe.maxX:qe.maxY;if(dt>=te&&Dt<fe)Pe.push(qe);else if(!(Dt<te||dt>=fe)){var Rt=[];if(Qe==="Point"||Qe==="MultiPoint")us(At,Rt,te,fe,a);else if(Qe==="LineString")Lt(At,Rt,te,fe,a,!1,ke.lineMetrics);else if(Qe==="MultiLineString")bn(At,Rt,te,fe,a,!1);else if(Qe==="Polygon")bn(At,Rt,te,fe,a,!0);else if(Qe==="MultiPolygon")for(var sn=0;sn<At.length;sn++){var jt=[];bn(At[sn],jt,te,fe,a,!0),jt.length&&Rt.push(jt)}if(Rt.length){if(ke.lineMetrics&&Qe==="LineString"){for(sn=0;sn<Rt.length;sn++)Pe.push(As(qe.id,Qe,Rt[sn],qe.tags));continue}Qe!=="LineString"&&Qe!=="MultiLineString"||(Rt.length===1?(Qe="LineString",Rt=Rt[0]):Qe="MultiLineString"),Qe!=="Point"&&Qe!=="MultiPoint"||(Qe=Rt.length===3?"Point":"MultiPoint"),Pe.push(As(qe.id,Qe,Rt,qe.tags))}}}return Pe.length?Pe:null}function us(K,Q,te,fe,a){for(var G=0;G<K.length;G+=3){var Le=K[G+a];Le>=te&&Le<=fe&&(Q.push(K[G]),Q.push(K[G+1]),Q.push(K[G+2]))}}function Lt(K,Q,te,fe,a,G,Le){for(var ke,Pe,Ie=Sn(K),qe=a===0?Ss:yn,At=K.start,Qe=0;Qe<K.length-3;Qe+=3){var dt=K[Qe],Dt=K[Qe+1],Rt=K[Qe+2],sn=K[Qe+3],jt=K[Qe+4],pn=a===0?dt:Dt,qt=a===0?sn:jt,an=!1;Le&&(ke=Math.sqrt(Math.pow(dt-sn,2)+Math.pow(Dt-jt,2))),pn<te?qt>te&&(Pe=qe(Ie,dt,Dt,sn,jt,te),Le&&(Ie.start=At+ke*Pe)):pn>fe?qt<fe&&(Pe=qe(Ie,dt,Dt,sn,jt,fe),Le&&(Ie.start=At+ke*Pe)):Rr(Ie,dt,Dt,Rt),qt<te&&pn>=te&&(Pe=qe(Ie,dt,Dt,sn,jt,te),an=!0),qt>fe&&pn<=fe&&(Pe=qe(Ie,dt,Dt,sn,jt,fe),an=!0),!G&&an&&(Le&&(Ie.end=At+ke*Pe),Q.push(Ie),Ie=Sn(K)),Le&&(At+=ke)}var xn=K.length-3;dt=K[xn],Dt=K[xn+1],Rt=K[xn+2],(pn=a===0?dt:Dt)>=te&&pn<=fe&&Rr(Ie,dt,Dt,Rt),xn=Ie.length-3,G&&xn>=3&&(Ie[xn]!==Ie[0]||Ie[xn+1]!==Ie[1])&&Rr(Ie,Ie[0],Ie[1],Ie[2]),Ie.length&&Q.push(Ie)}function Sn(K){var Q=[];return Q.size=K.size,Q.start=K.start,Q.end=K.end,Q}function bn(K,Q,te,fe,a,G){for(var Le=0;Le<K.length;Le++)Lt(K[Le],Q,te,fe,a,G,!1)}function Rr(K,Q,te,fe){K.push(Q),K.push(te),K.push(fe)}function Ss(K,Q,te,fe,a,G){var Le=(G-Q)/(fe-Q);return K.push(G),K.push(te+(a-te)*Le),K.push(1),Le}function yn(K,Q,te,fe,a,G){var Le=(G-te)/(a-te);return K.push(Q+(fe-Q)*Le),K.push(G),K.push(1),Le}function Ke(K,Q){for(var te=[],fe=0;fe<K.length;fe++){var a,G=K[fe],Le=G.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")a=qr(G.geometry,Q);else if(Le==="MultiLineString"||Le==="Polygon"){a=[];for(var ke=0;ke<G.geometry.length;ke++)a.push(qr(G.geometry[ke],Q))}else if(Le==="MultiPolygon")for(a=[],ke=0;ke<G.geometry.length;ke++){for(var Pe=[],Ie=0;Ie<G.geometry[ke].length;Ie++)Pe.push(qr(G.geometry[ke][Ie],Q));a.push(Pe)}te.push(As(G.id,Le,a,G.tags))}return te}function qr(K,Q){var te=[];te.size=K.size,K.start!==void 0&&(te.start=K.start,te.end=K.end);for(var fe=0;fe<K.length;fe+=3)te.push(K[fe]+Q,K[fe+1],K[fe+2]);return te}function Gs(K,Q){if(K.transformed)return K;var te,fe,a,G=1<<K.z,Le=K.x,ke=K.y;for(te=0;te<K.features.length;te++){var Pe=K.features[te],Ie=Pe.geometry,qe=Pe.type;if(Pe.geometry=[],qe===1)for(fe=0;fe<Ie.length;fe+=2)Pe.geometry.push(Fr(Ie[fe],Ie[fe+1],Q,G,Le,ke));else for(fe=0;fe<Ie.length;fe++){var At=[];for(a=0;a<Ie[fe].length;a+=2)At.push(Fr(Ie[fe][a],Ie[fe][a+1],Q,G,Le,ke));Pe.geometry.push(At)}}return K.transformed=!0,K}function Fr(K,Q,te,fe,a,G){return[Math.round(te*(K*fe-a)),Math.round(te*(Q*fe-G))]}function hi(K,Q,te,fe,a){for(var G=Q===a.maxZoom?0:a.tolerance/((1<<Q)*a.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:te,y:fe,z:Q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ke=0;ke<K.length;ke++){Le.numFeatures++,Xn(Le,K[ke],G,a);var Pe=K[ke].minX,Ie=K[ke].minY,qe=K[ke].maxX,At=K[ke].maxY;Pe<Le.minX&&(Le.minX=Pe),Ie<Le.minY&&(Le.minY=Ie),qe>Le.maxX&&(Le.maxX=qe),At>Le.maxY&&(Le.maxY=At)}return Le}function Xn(K,Q,te,fe){var a=Q.geometry,G=Q.type,Le=[];if(G==="Point"||G==="MultiPoint")for(var ke=0;ke<a.length;ke+=3)Le.push(a[ke]),Le.push(a[ke+1]),K.numPoints++,K.numSimplified++;else if(G==="LineString")$s(Le,a,K,te,!1,!1);else if(G==="MultiLineString"||G==="Polygon")for(ke=0;ke<a.length;ke++)$s(Le,a[ke],K,te,G==="Polygon",ke===0);else if(G==="MultiPolygon")for(var Pe=0;Pe<a.length;Pe++){var Ie=a[Pe];for(ke=0;ke<Ie.length;ke++)$s(Le,Ie[ke],K,te,!0,ke===0)}if(Le.length){var qe=Q.tags||null;if(G==="LineString"&&fe.lineMetrics){for(var At in qe={},Q.tags)qe[At]=Q.tags[At];qe.mapbox_clip_start=a.start/a.size,qe.mapbox_clip_end=a.end/a.size}var Qe={geometry:Le,type:G==="Polygon"||G==="MultiPolygon"?3:G==="LineString"||G==="MultiLineString"?2:1,tags:qe};Q.id!==null&&(Qe.id=Q.id),K.features.push(Qe)}}function $s(K,Q,te,fe,a,G){var Le=fe*fe;if(fe>0&&Q.size<(a?Le:fe))te.numPoints+=Q.length/3;else{for(var ke=[],Pe=0;Pe<Q.length;Pe+=3)(fe===0||Q[Pe+2]>Le)&&(te.numSimplified++,ke.push(Q[Pe]),ke.push(Q[Pe+1])),te.numPoints++;a&&function(Ie,qe){for(var At=0,Qe=0,dt=Ie.length,Dt=dt-2;Qe<dt;Dt=Qe,Qe+=2)At+=(Ie[Qe]-Ie[Dt])*(Ie[Qe+1]+Ie[Dt+1]);if(At>0===qe)for(Qe=0,dt=Ie.length;Qe<dt/2;Qe+=2){var Rt=Ie[Qe],sn=Ie[Qe+1];Ie[Qe]=Ie[dt-2-Qe],Ie[Qe+1]=Ie[dt-1-Qe],Ie[dt-2-Qe]=Rt,Ie[dt-1-Qe]=sn}}(ke,G),K.push(ke)}}function ji(K,Q){var te=(Q=this.options=function(a,G){for(var Le in G)a[Le]=G[Le];return a}(Object.create(this.options),Q)).debug;if(te&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");var fe=function(a,G){var Le=[];if(a.type==="FeatureCollection")for(var ke=0;ke<a.features.length;ke++)It(Le,a.features[ke],G,ke);else It(Le,a.type==="Feature"?a:{geometry:a},G);return Le}(K,Q);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=function(a,G){var Le=G.buffer/G.extent,ke=a,Pe=Ri(a,1,-1-Le,Le,0,-1,2,G),Ie=Ri(a,1,1-Le,2+Le,0,-1,2,G);return(Pe||Ie)&&(ke=Ri(a,1,-Le,1+Le,0,-1,2,G)||[],Pe&&(ke=Ke(Pe,1).concat(ke)),Ie&&(ke=ke.concat(Ke(Ie,-1)))),ke}(fe,Q),fe.length&&this.splitTile(fe,0,0,0),te&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Hi(K,Q,te){return 32*((1<<K)*te+Q)+K}function Bi(K,Q){const te=K.tileID.canonical;if(!this._geoJSONIndex)return Q(null,null);const fe=this._geoJSONIndex.getTile(te.z,te.x,te.y);if(!fe)return Q(null,null);const a=new be(fe.features);let G=Ge.exports(a);G.byteOffset===0&&G.byteLength===G.buffer.byteLength||(G=new Uint8Array(G)),Q(null,{vectorTile:a,rawData:G.buffer})}ji.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ji.prototype.splitTile=function(K,Q,te,fe,a,G,Le){for(var ke=[K,Q,te,fe],Pe=this.options,Ie=Pe.debug;ke.length;){fe=ke.pop(),te=ke.pop(),Q=ke.pop(),K=ke.pop();var qe=1<<Q,At=Hi(Q,te,fe),Qe=this.tiles[At];if(!Qe&&(Ie>1&&console.time("creation"),Qe=this.tiles[At]=hi(K,Q,te,fe,Pe),this.tileCoords.push({z:Q,x:te,y:fe}),Ie)){Ie>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,te,fe,Qe.numFeatures,Qe.numPoints,Qe.numSimplified),console.timeEnd("creation"));var dt="z"+Q;this.stats[dt]=(this.stats[dt]||0)+1,this.total++}if(Qe.source=K,a){if(Q===Pe.maxZoom||Q===a)continue;var Dt=1<<a-Q;if(te!==Math.floor(G/Dt)||fe!==Math.floor(Le/Dt))continue}else if(Q===Pe.indexMaxZoom||Qe.numPoints<=Pe.indexMaxPoints)continue;if(Qe.source=null,K.length!==0){Ie>1&&console.time("clipping");var Rt,sn,jt,pn,qt,an,xn=.5*Pe.buffer/Pe.extent,Ft=.5-xn,Ne=.5+xn,Mt=1+xn;Rt=sn=jt=pn=null,qt=Ri(K,qe,te-xn,te+Ne,0,Qe.minX,Qe.maxX,Pe),an=Ri(K,qe,te+Ft,te+Mt,0,Qe.minX,Qe.maxX,Pe),K=null,qt&&(Rt=Ri(qt,qe,fe-xn,fe+Ne,1,Qe.minY,Qe.maxY,Pe),sn=Ri(qt,qe,fe+Ft,fe+Mt,1,Qe.minY,Qe.maxY,Pe),qt=null),an&&(jt=Ri(an,qe,fe-xn,fe+Ne,1,Qe.minY,Qe.maxY,Pe),pn=Ri(an,qe,fe+Ft,fe+Mt,1,Qe.minY,Qe.maxY,Pe),an=null),Ie>1&&console.timeEnd("clipping"),ke.push(Rt||[],Q+1,2*te,2*fe),ke.push(sn||[],Q+1,2*te,2*fe+1),ke.push(jt||[],Q+1,2*te+1,2*fe),ke.push(pn||[],Q+1,2*te+1,2*fe+1)}}},ji.prototype.getTile=function(K,Q,te){var fe=this.options,a=fe.extent,G=fe.debug;if(K<0||K>24)return null;var Le=1<<K,ke=Hi(K,Q=(Q%Le+Le)%Le,te);if(this.tiles[ke])return Gs(this.tiles[ke],a);G>1&&console.log("drilling down to z%d-%d-%d",K,Q,te);for(var Pe,Ie=K,qe=Q,At=te;!Pe&&Ie>0;)Ie--,qe=Math.floor(qe/2),At=Math.floor(At/2),Pe=this.tiles[Hi(Ie,qe,At)];return Pe&&Pe.source?(G>1&&console.log("found parent tile z%d-%d-%d",Ie,qe,At),G>1&&console.time("drilling down"),this.splitTile(Pe.source,Ie,qe,At,K,Q,te),G>1&&console.timeEnd("drilling down"),this.tiles[ke]?Gs(this.tiles[ke],a):null):null};class cs extends H{constructor(Q,te,fe,a){super(Q,te,fe,Bi),a&&(this.loadGeoJSON=a)}loadData(Q,te){var fe;(fe=this._pendingRequest)===null||fe===void 0||fe.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const a=!!(Q&&Q.request&&Q.request.collectResourceTiming)&&new o.RequestPerformance(Q.request);this._pendingCallback=te,this._pendingRequest=this.loadGeoJSON(Q,(G,Le)=>{if(delete this._pendingCallback,delete this._pendingRequest,G||!Le)return te(G);if(typeof Le!="object")return te(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));{Y(Le,!0);try{if(Q.filter){const Pe=o.createExpression(Q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Pe.result==="error")throw new Error(Pe.value.map(qe=>`${qe.key}: ${qe.message}`).join(", "));Le={type:"FeatureCollection",features:Le.features.filter(qe=>Pe.value.evaluate({zoom:0},qe))}}this._geoJSONIndex=Q.cluster?new Qn(function({superclusterOptions:Pe,clusterProperties:Ie}){if(!Ie||!Pe)return Pe;const qe={},At={},Qe={accumulated:null,zoom:0},dt={properties:null},Dt=Object.keys(Ie);for(const Rt of Dt){const[sn,jt]=Ie[Rt],pn=o.createExpression(jt),qt=o.createExpression(typeof sn=="string"?[sn,["accumulated"],["get",Rt]]:sn);qe[Rt]=pn.value,At[Rt]=qt.value}return Pe.map=Rt=>{dt.properties=Rt;const sn={};for(const jt of Dt)sn[jt]=qe[jt].evaluate(Qe,dt);return sn},Pe.reduce=(Rt,sn)=>{dt.properties=sn;for(const jt of Dt)Qe.accumulated=Rt[jt],Rt[jt]=At[jt].evaluate(Qe,dt)},Pe}(Q)).load(Le.features):function(Pe,Ie){return new ji(Pe,Ie)}(Le,Q.geojsonVtOptions)}catch(Pe){return te(Pe)}this.loaded={};const ke={};if(a){const Pe=a.finish();Pe&&(ke.resourceTiming={},ke.resourceTiming[Q.source]=JSON.parse(JSON.stringify(Pe)))}te(null,ke)}})}reloadTile(Q,te){const fe=this.loaded;return fe&&fe[Q.uid]?super.reloadTile(Q,te):this.loadTile(Q,te)}loadGeoJSON(Q,te){if(Q.request)return o.getJSON(Q.request,te);if(typeof Q.data=="string")try{te(null,JSON.parse(Q.data))}catch{te(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`))}else te(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(Q,te){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),te()}getClusterExpansionZoom(Q,te){try{te(null,this._geoJSONIndex.getClusterExpansionZoom(Q.clusterId))}catch(fe){te(fe)}}getClusterChildren(Q,te){try{te(null,this._geoJSONIndex.getChildren(Q.clusterId))}catch(fe){te(fe)}}getClusterLeaves(Q,te){try{te(null,this._geoJSONIndex.getLeaves(Q.clusterId,Q.limit,Q.offset))}catch(fe){te(fe)}}}class Nr{constructor(Q){this.self=Q,this.actor=new o.Actor(Q,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:H,geojson:cs},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(te,fe)=>{if(this.workerSourceTypes[te])throw new Error(`Worker source with name "${te}" already registered.`);this.workerSourceTypes[te]=fe},this.self.registerRTLTextPlugin=te=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=te.applyArabicShaping,o.plugin.processBidirectionalText=te.processBidirectionalText,o.plugin.processStyledBidirectionalText=te.processStyledBidirectionalText}}setReferrer(Q,te){this.referrer=te}setImages(Q,te,fe){this.availableImages[Q]=te;for(const a in this.workerSources[Q]){const G=this.workerSources[Q][a];for(const Le in G)G[Le].availableImages=te}fe()}setLayers(Q,te,fe){this.getLayerIndex(Q).replace(te),fe()}updateLayers(Q,te,fe){this.getLayerIndex(Q).update(te.layers,te.removedIds),fe()}loadTile(Q,te,fe){this.getWorkerSource(Q,te.type,te.source).loadTile(te,fe)}loadDEMTile(Q,te,fe){this.getDEMWorkerSource(Q,te.source).loadTile(te,fe)}reloadTile(Q,te,fe){this.getWorkerSource(Q,te.type,te.source).reloadTile(te,fe)}abortTile(Q,te,fe){this.getWorkerSource(Q,te.type,te.source).abortTile(te,fe)}removeTile(Q,te,fe){this.getWorkerSource(Q,te.type,te.source).removeTile(te,fe)}removeDEMTile(Q,te){this.getDEMWorkerSource(Q,te.source).removeTile(te)}removeSource(Q,te,fe){if(!this.workerSources[Q]||!this.workerSources[Q][te.type]||!this.workerSources[Q][te.type][te.source])return;const a=this.workerSources[Q][te.type][te.source];delete this.workerSources[Q][te.type][te.source],a.removeSource!==void 0?a.removeSource(te,fe):fe()}loadWorkerSource(Q,te,fe){try{this.self.importScripts(te.url),fe()}catch(a){fe(a.toString())}}syncRTLPluginState(Q,te,fe){try{o.plugin.setState(te);const a=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&a!=null){this.self.importScripts(a);const G=o.plugin.isParsed();fe(G?void 0:new Error(`RTL Text Plugin failed to import scripts from ${a}`),G)}}catch(a){fe(a.toString())}}getAvailableImages(Q){let te=this.availableImages[Q];return te||(te=[]),te}getLayerIndex(Q){let te=this.layerIndexes[Q];return te||(te=this.layerIndexes[Q]=new C),te}getWorkerSource(Q,te,fe){if(this.workerSources[Q]||(this.workerSources[Q]={}),this.workerSources[Q][te]||(this.workerSources[Q][te]={}),!this.workerSources[Q][te][fe]){const a={send:(G,Le,ke)=>{this.actor.send(G,Le,ke,Q)}};this.workerSources[Q][te][fe]=new this.workerSourceTypes[te](a,this.getLayerIndex(Q),this.getAvailableImages(Q))}return this.workerSources[Q][te][fe]}getDEMWorkerSource(Q,te){return this.demWorkerSources[Q]||(this.demWorkerSources[Q]={}),this.demWorkerSources[Q][te]||(this.demWorkerSources[Q][te]=new ie),this.demWorkerSources[Q][te]}enforceCacheSizeLimit(Q,te){o.enforceCacheSizeLimit(te)}}return o.isWorker()&&(self.worker=new Nr(self)),Nr}),s(["./shared"],function(o){var p=_;function _(L){return!function(c){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var A,h,d=new Blob([""],{type:"text/javascript"}),w=URL.createObjectURL(d);try{h=new Worker(w),A=!0}catch{A=!1}return h&&h.terminate(),URL.revokeObjectURL(w),A}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var A=document.createElement("canvas");A.width=A.height=1;var h=A.getContext("2d");if(!h)return!1;var d=h.getImageData(0,0,1,1);return d&&d.width===A.width}()?(C[v=c&&c.failIfMajorPerformanceCaveat]===void 0&&(C[v]=function(A){var h,d=function(w){var b=document.createElement("canvas"),S=Object.create(_.webGLContextAttributes);return S.failIfMajorPerformanceCaveat=w,b.getContext("webgl",S)||b.getContext("experimental-webgl",S)}(A);if(!d)return!1;try{h=d.createShader(d.VERTEX_SHADER)}catch{return!1}return!(!h||d.isContextLost())&&(d.shaderSource(h,"void main() {}"),d.compileShader(h),d.getShaderParameter(h,d.COMPILE_STATUS)===!0)}(v)),C[v]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var v}(L)}var C={};function M(L,c){if(Array.isArray(L)){if(!Array.isArray(c)||L.length!==c.length)return!1;for(let v=0;v<L.length;v++)if(!M(L[v],c[v]))return!1;return!0}if(typeof L=="object"&&L!==null&&c!==null){if(typeof c!="object"||Object.keys(L).length!==Object.keys(c).length)return!1;for(const v in L)if(!M(L[v],c[v]))return!1;return!0}return L===c}_.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class k{static testProp(c){if(!k.docStyle)return c[0];for(let v=0;v<c.length;v++)if(c[v]in k.docStyle)return c[v];return c[0]}static create(c,v,A){const h=window.document.createElement(c);return v!==void 0&&(h.className=v),A&&A.appendChild(h),h}static createNS(c,v){return window.document.createElementNS(c,v)}static disableDrag(){k.docStyle&&k.selectProp&&(k.userSelect=k.docStyle[k.selectProp],k.docStyle[k.selectProp]="none")}static enableDrag(){k.docStyle&&k.selectProp&&(k.docStyle[k.selectProp]=k.userSelect)}static setTransform(c,v){c.style[k.transformProp]=v}static addEventListener(c,v,A,h={}){c.addEventListener(v,A,"passive"in h?h:h.capture)}static removeEventListener(c,v,A,h={}){c.removeEventListener(v,A,"passive"in h?h:h.capture)}static suppressClickInternal(c){c.preventDefault(),c.stopPropagation(),window.removeEventListener("click",k.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",k.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",k.suppressClickInternal,!0)},0)}static mousePos(c,v){const A=c.getBoundingClientRect();return new o.pointGeometry(v.clientX-A.left-c.clientLeft,v.clientY-A.top-c.clientTop)}static touchPos(c,v){const A=c.getBoundingClientRect(),h=[];for(let d=0;d<v.length;d++)h.push(new o.pointGeometry(v[d].clientX-A.left-c.clientLeft,v[d].clientY-A.top-c.clientTop));return h}static mouseButton(c){return c.button}static remove(c){c.parentNode&&c.parentNode.removeChild(c)}}k.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,k.selectProp=k.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),k.transformProp=k.testProp(["transform","WebkitTransform"]);class F{constructor(c){this._transformRequestFn=c}transformRequest(c,v){return this._transformRequestFn&&this._transformRequestFn(c,v)||{url:c}}normalizeSpriteURL(c,v,A){const h=function(d){const w=d.match(j);if(!w)throw new Error(`Unable to parse URL "${d}"`);return{protocol:w[1],authority:w[2],path:w[3]||"/",params:w[4]?w[4].split("&"):[]}}(c);return h.path+=`${v}${A}`,function(d){const w=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${w}`}(h)}setTransformRequest(c){this._transformRequestFn=c}}const j=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class H{constructor(c,v,A,h){this.context=c,this.format=A,this.texture=c.gl.createTexture(),this.update(v,h)}update(c,v,A){const{width:h,height:d}=c,w=!(this.size&&this.size[0]===h&&this.size[1]===d||A),{context:b}=this,{gl:S}=b;if(this.useMipmap=!!(v&&v.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!v||v.premultiply!==!1)),w)this.size=[h,d],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||o.isImageBitmap(c)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,c):S.texImage2D(S.TEXTURE_2D,0,this.format,h,d,0,this.format,S.UNSIGNED_BYTE,c.data);else{const{x:P,y:B}=A||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||o.isImageBitmap(c)?S.texSubImage2D(S.TEXTURE_2D,0,P,B,S.RGBA,S.UNSIGNED_BYTE,c):S.texSubImage2D(S.TEXTURE_2D,0,P,B,h,d,S.RGBA,S.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)}bind(c,v,A){const{context:h}=this,{gl:d}=h;d.bindTexture(d.TEXTURE_2D,this.texture),A!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(A=d.LINEAR),c!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,c),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,A||c),this.filter=c),v!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,v),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,v),this.wrap=v)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}function ie(L){const{userImage:c}=L;return!!(c&&c.render&&c.render())&&(L.data.replace(new Uint8Array(c.data.buffer)),!0)}class Y extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:v,callback:A}of this.requestors)this._notify(v,A);this.requestors=[]}}getImage(c){return this.images[c]}addImage(c,v){if(this.images[c])throw new Error(`Image id ${c} already exist, use updateImage instead`);this._validate(c,v)&&(this.images[c]=v)}_validate(c,v){let A=!0;return this._validateStretch(v.stretchX,v.data&&v.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),A=!1),this._validateStretch(v.stretchY,v.data&&v.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),A=!1),this._validateContent(v.content,v)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),A=!1),A}_validateStretch(c,v){if(!c)return!0;let A=0;for(const h of c){if(h[0]<A||h[1]<h[0]||v<h[1])return!1;A=h[1]}return!0}_validateContent(c,v){return!(c&&(c.length!==4||c[0]<0||v.data.width<c[0]||c[1]<0||v.data.height<c[1]||c[2]<0||v.data.width<c[2]||c[3]<0||v.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,v){const A=this.images[c];if(A.data.width!==v.data.width||A.data.height!==v.data.height)throw new Error(`size mismatch between old image (${A.data.width}x${A.data.height}) and new image (${v.data.width}x${v.data.height}).`);v.version=A.version+1,this.images[c]=v,this.updatedImages[c]=!0}removeImage(c){const v=this.images[c];delete this.images[c],delete this.patterns[c],v.userImage&&v.userImage.onRemove&&v.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,v){let A=!0;if(!this.isLoaded())for(const h of c)this.images[h]||(A=!1);this.isLoaded()||A?this._notify(c,v):this.requestors.push({ids:c,callback:v})}_notify(c,v){const A={};for(const h of c){this.images[h]||this.fire(new o.Event("styleimagemissing",{id:h}));const d=this.images[h];d?A[h]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:o.warnOnce(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}v(null,A)}getPixelSize(){const{width:c,height:v}=this.atlasImage;return{width:c,height:v}}getPattern(c){const v=this.patterns[c],A=this.getImage(c);if(!A)return null;if(v&&v.position.version===A.version)return v.position;if(v)v.position.version=A.version;else{const h={w:A.data.width+2,h:A.data.height+2,x:0,y:0},d=new o.ImagePosition(h,A);this.patterns[c]={bin:h,position:d}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const v=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new H(c,this.atlasImage,v.RGBA),this.atlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const d in this.patterns)c.push(this.patterns[d].bin);const{w:v,h:A}=o.potpack(c),h=this.atlasImage;h.resize({width:v||1,height:A||1});for(const d in this.patterns){const{bin:w}=this.patterns[d],b=w.x+1,S=w.y+1,P=this.images[d].data,B=P.width,V=P.height;o.RGBAImage.copy(P,h,{x:0,y:0},{x:b,y:S},{width:B,height:V}),o.RGBAImage.copy(P,h,{x:0,y:V-1},{x:b,y:S-1},{width:B,height:1}),o.RGBAImage.copy(P,h,{x:0,y:0},{x:b,y:S+V},{width:B,height:1}),o.RGBAImage.copy(P,h,{x:B-1,y:0},{x:b-1,y:S},{width:1,height:V}),o.RGBAImage.copy(P,h,{x:0,y:0},{x:b+B,y:S},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const v of c){if(this.callbackDispatchedThisFrame[v])continue;this.callbackDispatchedThisFrame[v]=!0;const A=this.images[v];A||o.warnOnce(`Image with ID: "${v}" was not found`),ie(A)&&this.updateImage(v,A)}}}const J=1e20;function se(L,c,v,A,h,d,w,b,S){for(let P=c;P<c+A;P++)he(L,v*d+P,d,h,w,b,S);for(let P=v;P<v+h;P++)he(L,P*d+c,1,A,w,b,S)}function he(L,c,v,A,h,d,w){d[0]=0,w[0]=-J,w[1]=J,h[0]=L[c];for(let b=1,S=0,P=0;b<A;b++){h[b]=L[c+b*v];const B=b*b;do{const V=d[S];P=(h[b]-h[V]+B-V*V)/(b-V)/2}while(P<=w[S]&&--S>-1);S++,d[S]=b,w[S]=P,w[S+1]=J}for(let b=0,S=0;b<A;b++){for(;w[S+1]<b;)S++;const P=d[S],B=b-P;L[c+b*v]=h[P]+B*B}}class pe{constructor(c,v){this.requestManager=c,this.localIdeographFontFamily=v,this.entries={}}setURL(c){this.url=c}getGlyphs(c,v){const A=[];for(const h in c)for(const d of c[h])A.push({stack:h,id:d});o.asyncAll(A,({stack:h,id:d},w)=>{let b=this.entries[h];b||(b=this.entries[h]={glyphs:{},requests:{},ranges:{}});let S=b.glyphs[d];if(S!==void 0)return void w(null,{stack:h,id:d,glyph:S});if(S=this._tinySDF(b,h,d),S)return b.glyphs[d]=S,void w(null,{stack:h,id:d,glyph:S});const P=Math.floor(d/256);if(256*P>65535)return void w(new Error("glyphs > 65535 not supported"));if(b.ranges[P])return void w(null,{stack:h,id:d,glyph:S});let B=b.requests[P];B||(B=b.requests[P]=[],pe.loadGlyphRange(h,P,this.url,this.requestManager,(V,W)=>{if(W){for(const X in W)this._doesCharSupportLocalGlyph(+X)||(b.glyphs[+X]=W[+X]);b.ranges[P]=!0}for(const X of B)X(V,W);delete b.requests[P]})),B.push((V,W)=>{V?w(V):W&&w(null,{stack:h,id:d,glyph:W[d]||null})})},(h,d)=>{if(h)v(h);else if(d){const w={};for(const{stack:b,id:S,glyph:P}of d)(w[b]||(w[b]={}))[S]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics};v(null,w)}})}_doesCharSupportLocalGlyph(c){return!!this.localIdeographFontFamily&&(o.unicodeBlockLookup["CJK Unified Ideographs"](c)||o.unicodeBlockLookup["Hangul Syllables"](c)||o.unicodeBlockLookup.Hiragana(c)||o.unicodeBlockLookup.Katakana(c))}_tinySDF(c,v,A){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(A))return;let d=c.tinySDF;if(!d){let b="400";/bold/i.test(v)?b="900":/medium/i.test(v)?b="500":/light/i.test(v)&&(b="200"),d=c.tinySDF=new pe.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:h,fontWeight:b})}const w=d.draw(String.fromCharCode(A));return{id:A,bitmap:new o.AlphaImage({width:w.width||30,height:w.height||30},w.data),metrics:{width:w.glyphWidth||24,height:w.glyphHeight||24,left:w.glyphLeft||0,top:w.glyphTop-27||-8,advance:w.glyphAdvance||24}}}}pe.loadGlyphRange=function(L,c,v,A,h){const d=256*c,w=d+255,b=A.transformRequest(v.replace("{fontstack}",L).replace("{range}",`${d}-${w}`),o.ResourceType.Glyphs);o.getArrayBuffer(b,(S,P)=>{if(S)h(S);else if(P){const B={};for(const V of o.parseGlyphPbf(P))B[V.id]=V;h(null,B)}})},pe.TinySDF=class{constructor({fontSize:L=24,buffer:c=3,radius:v=8,cutoff:A=.25,fontFamily:h="sans-serif",fontWeight:d="normal",fontStyle:w="normal"}={}){this.buffer=c,this.cutoff=A,this.radius=v;const b=this.size=L+4*c,S=this._createCanvas(b),P=this.ctx=S.getContext("2d",{willReadFrequently:!0});P.font=`${w} ${d} ${L}px ${h}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(L){const c=document.createElement("canvas");return c.width=c.height=L,c}draw(L){const{width:c,actualBoundingBoxAscent:v,actualBoundingBoxDescent:A,actualBoundingBoxLeft:h,actualBoundingBoxRight:d}=this.ctx.measureText(L),w=Math.ceil(v),b=Math.min(this.size-this.buffer,Math.ceil(d-h)),S=Math.min(this.size-this.buffer,w+Math.ceil(A)),P=b+2*this.buffer,B=S+2*this.buffer,V=Math.max(P*B,0),W=new Uint8ClampedArray(V),X={data:W,width:P,height:B,glyphWidth:b,glyphHeight:S,glyphTop:w,glyphLeft:0,glyphAdvance:c};if(b===0||S===0)return X;const{ctx:ae,buffer:ne,gridInner:ue,gridOuter:Ee}=this;ae.clearRect(ne,ne,b,S),ae.fillText(L,ne,ne+w);const Me=ae.getImageData(ne,ne,b,S);Ee.fill(J,0,V),ue.fill(0,0,V);for(let ve=0;ve<S;ve++)for(let je=0;je<b;je++){const Se=Me.data[4*(ve*b+je)+3]/255;if(Se===0)continue;const $e=(ve+ne)*P+je+ne;if(Se===1)Ee[$e]=0,ue[$e]=J;else{const xe=.5-Se;Ee[$e]=xe>0?xe*xe:0,ue[$e]=xe<0?xe*xe:0}}se(Ee,0,0,P,B,P,this.f,this.v,this.z),se(ue,ne,ne,b,S,P,this.f,this.v,this.z);for(let ve=0;ve<V;ve++){const je=Math.sqrt(Ee[ve])-Math.sqrt(ue[ve]);W[ve]=Math.round(255-255*(je/this.radius+this.cutoff))}return X}};const be=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(L,c){return o.sphericalToCartesian(L.expression.evaluate(c))}interpolate(L,c,v){return{x:o.number(L.x,c.x,v),y:o.number(L.y,c.y,v),z:o.number(L.z,c.z,v)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),Ge="-transition";class We extends o.Evented{constructor(c){super(),this._transitionable=new o.Transitionable(be),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,v={}){if(!this._validate(o.validateLight,c,v))for(const A in c){const h=c[A];A.endsWith(Ge)?this._transitionable.setTransition(A.slice(0,-Ge.length),h):this._transitionable.setValue(A,h)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,v,A){return(!A||A.validate!==!1)&&o.emitValidationErrors(this,c.call(o.validateStyle,o.extend({value:v,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class Xe{constructor(c,v){this.width=c,this.height=v,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(c,v){const A=c.join(",")+String(v);return this.dashEntry[A]||(this.dashEntry[A]=this.addDash(c,v)),this.dashEntry[A]}getDashRanges(c,v,A){const h=[];let d=c.length%2==1?-c[c.length-1]*A:0,w=c[0]*A,b=!0;h.push({left:d,right:w,isDash:b,zeroLength:c[0]===0});let S=c[0];for(let P=1;P<c.length;P++){b=!b;const B=c[P];d=S*A,S+=B,w=S*A,h.push({left:d,right:w,isDash:b,zeroLength:B===0})}return h}addRoundDash(c,v,A){const h=v/2;for(let d=-A;d<=A;d++){const w=this.width*(this.nextRow+A+d);let b=0,S=c[b];for(let P=0;P<this.width;P++){P/S.right>1&&(S=c[++b]);const B=Math.abs(P-S.left),V=Math.abs(P-S.right),W=Math.min(B,V);let X;const ae=d/A*(h+1);if(S.isDash){const ne=h-Math.abs(ae);X=Math.sqrt(W*W+ne*ne)}else X=h-Math.sqrt(W*W+ae*ae);this.data[w+P]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(c){for(let b=c.length-1;b>=0;--b){const S=c[b],P=c[b+1];S.zeroLength?c.splice(b,1):P&&P.isDash===S.isDash&&(P.left=S.left,c.splice(b,1))}const v=c[0],A=c[c.length-1];v.isDash===A.isDash&&(v.left=A.left-this.width,A.right=v.right+this.width);const h=this.width*this.nextRow;let d=0,w=c[d];for(let b=0;b<this.width;b++){b/w.right>1&&(w=c[++d]);const S=Math.abs(b-w.left),P=Math.abs(b-w.right),B=Math.min(S,P);this.data[h+b]=Math.max(0,Math.min(255,(w.isDash?B:-B)+128))}}addDash(c,v){const A=v?7:0,h=2*A+1;if(this.nextRow+h>this.height)return o.warnOnce("LineAtlas out of space"),null;let d=0;for(let b=0;b<c.length;b++)d+=c[b];if(d!==0){const b=this.width/d,S=this.getDashRanges(c,this.width,b);v?this.addRoundDash(S,b,A):this.addRegularDash(S)}const w={y:(this.nextRow+A+.5)/this.height,height:2*A/this.height,width:d};return this.nextRow+=h,this.dirty=!0,w}bind(c){const v=c.gl;this.texture?(v.bindTexture(v.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,v.texSubImage2D(v.TEXTURE_2D,0,0,0,this.width,this.height,v.ALPHA,v.UNSIGNED_BYTE,this.data))):(this.texture=v.createTexture(),v.bindTexture(v.TEXTURE_2D,this.texture),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.REPEAT),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.REPEAT),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.LINEAR),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.LINEAR),v.texImage2D(v.TEXTURE_2D,0,v.ALPHA,this.width,this.height,0,v.ALPHA,v.UNSIGNED_BYTE,this.data))}}class rt{constructor(c,v){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const A=this.workerPool.acquire(this.id);for(let h=0;h<A.length;h++){const d=new rt.Actor(A[h],v,this.id);d.name=`Worker ${h}`,this.actors.push(d)}if(!this.actors.length)throw new Error("No actors found")}broadcast(c,v,A){o.asyncAll(this.actors,(h,d)=>{h.send(c,v,d)},A=A||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Oe(L,c,v){const A=function(h,d){if(h)return v(h);if(d){const w=o.pick(o.extend(d,L),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);d.vector_layers&&(w.vectorLayers=d.vector_layers,w.vectorLayerIds=w.vectorLayers.map(b=>b.id)),v(null,w)}};return L.url?o.getJSON(c.transformRequest(L.url,o.ResourceType.Source),A):o.exported.frame(()=>A(null,L))}rt.Actor=o.Actor;class nt{constructor(c,v,A){this.bounds=o.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=v||0,this.maxzoom=A||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const v=Math.pow(2,c.z),A=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*v),h=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*v),d=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*v),w=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*v);return c.x>=A&&c.x<d&&c.y>=h&&c.y<w}}class Ze extends o.Evented{constructor(c,v,A,h){if(super(),this.id=c,this.dispatcher=A,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(v,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},v),this._collectResourceTiming=v.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Oe(this._options,this.map._requestManager,(c,v)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),c?this.fire(new o.ErrorEvent(c)):v&&(o.extend(this,v),v.bounds&&(this.tileBounds=new nt(v.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}setSourceProperty(c){this._tileJSONRequest&&this._tileJSONRequest.cancel(),c(),this.load()}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}setUrl(c){return this.setSourceProperty(()=>{this.url=c,this._options.url=c}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}loadTile(c,v){const A=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h={request:this.map._requestManager.transformRequest(A,o.ResourceType.Tile),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function d(w,b){return delete c.request,c.aborted?v(null):w&&w.status!==404?v(w):(b&&b.resourceTiming&&(c.resourceTiming=b.resourceTiming),this.map._refreshExpiredTiles&&b&&c.setExpiryData(b),c.loadVectorData(b,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),v(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}h.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired"?c.state==="loading"?c.reloadCallback=v:c.request=c.actor.send("reloadTile",h,d.bind(this)):(c.actor=this.dispatcher.getActor(),c.request=c.actor.send("loadTile",h,d.bind(this)))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id},void 0)}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class pt extends o.Evented{constructor(c,v,A,h){super(),this.id=c,this.dispatcher=A,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},v),o.extend(this,o.pick(v,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Oe(this._options,this.map._requestManager,(c,v)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new o.ErrorEvent(c)):v&&(o.extend(this,v),v.bounds&&(this.tileBounds=new nt(v.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,v){const A=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);c.request=o.getImage(this.map._requestManager.transformRequest(A,o.ResourceType.Tile),(h,d,w)=>{if(delete c.request,c.aborted)c.state="unloaded",v(null);else if(h)c.state="errored",v(h);else if(d){this.map._refreshExpiredTiles&&c.setExpiryData(w);const b=this.map.painter.context,S=b.gl;c.texture=this.map.painter.getTileTexture(d.width),c.texture?c.texture.update(d,{useMipmap:!0}):(c.texture=new H(b,d,S.RGBA,{useMipmap:!0}),c.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),b.extTextureFilterAnisotropic&&S.texParameterf(S.TEXTURE_2D,b.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,b.extTextureFilterAnisotropicMax)),c.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),v(null)}})}abortTile(c,v){c.request&&(c.request.cancel(),delete c.request),v()}unloadTile(c,v){c.texture&&this.map.painter.saveTileTexture(c.texture),v()}hasTransition(){return!1}}let Yt;class Et extends pt{constructor(c,v,A,h){super(c,v,A,h),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},v),this.encoding=v.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(c,v){const A=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function h(d,w){d&&(c.state="errored",v(d)),w&&(c.dem=w,c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0,c.state="loaded",v(null))}c.request=o.getImage(this.map._requestManager.transformRequest(A,o.ResourceType.Tile),function(d,w){if(delete c.request,c.aborted)c.state="unloaded",v(null);else if(d)c.state="errored",v(d);else if(w){this.map._refreshExpiredTiles&&c.setExpiryData(w),delete w.cacheControl,delete w.expires;const b=o.isImageBitmap(w)&&(Yt==null&&(Yt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Yt)?w:o.exported.getImageData(w,1),S={uid:c.uid,coord:c.tileID,source:this.id,rawImageData:b,encoding:this.encoding};c.actor&&c.state!=="expired"||(c.actor=this.dispatcher.getActor(),c.actor.send("loadDEMTile",S,h.bind(this)))}}.bind(this)),c.neighboringTiles=this._getNeighboringTiles(c.tileID)}_getNeighboringTiles(c){const v=c.canonical,A=Math.pow(2,v.z),h=(v.x-1+A)%A,d=v.x===0?c.wrap-1:c.wrap,w=(v.x+1+A)%A,b=v.x+1===A?c.wrap+1:c.wrap,S={};return S[new o.OverscaledTileID(c.overscaledZ,d,v.z,h,v.y).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,b,v.z,w,v.y).key]={backfilled:!1},v.y>0&&(S[new o.OverscaledTileID(c.overscaledZ,d,v.z,h,v.y-1).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,c.wrap,v.z,v.x,v.y-1).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,b,v.z,w,v.y-1).key]={backfilled:!1}),v.y+1<A&&(S[new o.OverscaledTileID(c.overscaledZ,d,v.z,h,v.y+1).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,c.wrap,v.z,v.x,v.y+1).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,b,v.z,w,v.y+1).key]={backfilled:!1}),S}unloadTile(c){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&c.actor.send("removeDEMTile",{uid:c.uid,source:this.id})}}class un extends o.Evented{constructor(c,v,A,h){super(),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=A.getActor(),this.setEventedParent(h),this._data=v.data,this._options=o.extend({},v),this._collectResourceTiming=v.collectResourceTiming,v.maxzoom!==void 0&&(this.maxzoom=v.maxzoom),v.type&&(this.type=v.type),v.attribution&&(this.attribution=v.attribution),this.promoteId=v.promoteId;const d=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:v.cluster||!1,geojsonVtOptions:{buffer:(v.buffer!==void 0?v.buffer:128)*d,tolerance:(v.tolerance!==void 0?v.tolerance:.375)*d,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:v.lineMetrics||!1,generateId:v.generateId||!1},superclusterOptions:{maxZoom:v.clusterMaxZoom!==void 0?v.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,v.clusterMinPoints||2),extent:o.EXTENT,radius:(v.clusterRadius||50)*d,log:!1,generateId:v.generateId||!1},clusterProperties:v.clusterProperties,filter:v.filter},v.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(c){this.map=c,this.load()}setData(c){return this._data=c,this._updateWorkerData("content"),this}getClusterExpansionZoom(c,v){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:c,source:this.id},v),this}getClusterChildren(c,v){return this.actor.send("geojson.getClusterChildren",{clusterId:c,source:this.id},v),this}getClusterLeaves(c,v,A,h){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:c,limit:v,offset:A},h),this}_updateWorkerData(c){const v=o.extend({},this.workerOptions),A=this._data;typeof A=="string"?(v.request=this.map._requestManager.transformRequest(o.exported.resolveURL(A),o.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(A),this._pendingLoads++,this.fire(new o.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,v,(h,d)=>{if(this._pendingLoads--,this._removed||d&&d.abandoned)return void this.fire(new o.Event("dataabort",{dataType:"source",sourceDataType:c}));let w=null;if(d&&d.resourceTiming&&d.resourceTiming[this.id]&&(w=d.resourceTiming[this.id].slice(0)),h)return void this.fire(new o.ErrorEvent(h));const b={dataType:"source",sourceDataType:c};this._collectResourceTiming&&w&&w.length>0&&o.extend(b,{resourceTiming:w}),this.fire(new o.Event("data",b))})}loaded(){return this._pendingLoads===0}loadTile(c,v){const A=c.actor?"reloadTile":"loadTile";c.actor=this.actor;const h={type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};c.request=this.actor.send(A,h,(d,w)=>(delete c.request,c.unloadVectorData(),c.aborted?v(null):d?v(d):(c.loadVectorData(w,this.map.painter,A==="reloadTile"),v(null))))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.aborted=!0}unloadTile(c){c.unloadVectorData(),this.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var _t=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Tt extends o.Evented{constructor(c,v,A,h){super(),this.id=c,this.dispatcher=A,this.coordinates=v.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=v}load(c,v){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(A,h)=>{this._loaded=!0,A?this.fire(new o.ErrorEvent(A)):h&&(this.image=h,c&&(this.coordinates=c),v&&v(),this._finishLoading())})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this.options.url=c.url,this.load(c.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}setCoordinates(c){this.coordinates=c;const v=c.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(h){let d=1/0,w=1/0,b=-1/0,S=-1/0;for(const W of h)d=Math.min(d,W.x),w=Math.min(w,W.y),b=Math.max(b,W.x),S=Math.max(S,W.y);const P=Math.max(b-d,S-w),B=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),V=Math.pow(2,B);return new o.CanonicalTileID(B,Math.floor((d+b)/2*V),Math.floor((w+S)/2*V))}(v),this.minzoom=this.maxzoom=this.tileID.z;const A=v.map(h=>this.tileID.getTilePoint(h)._round());return this._boundsArray=new o.RasterBoundsArray,this._boundsArray.emplaceBack(A[0].x,A[0].y,0,0),this._boundsArray.emplaceBack(A[1].x,A[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(A[3].x,A[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(A[2].x,A[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,v=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,_t.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new H(c,this.image,v.RGBA),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE));for(const A in this.tiles){const h=this.tiles[A];h.state!=="loaded"&&(h.state="loaded",h.texture=this.texture)}}loadTile(c,v){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},v(null)):(c.state="errored",v(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Jt extends Tt{constructor(c,v,A,h){super(c,v,A,h),this.roundZoom=!0,this.type="video",this.options=v}load(){this._loaded=!1;const c=this.options;this.urls=[];for(const v of c.urls)this.urls.push(this.map._requestManager.transformRequest(v,o.ResourceType.Source).url);o.getVideo(this.urls,(v,A)=>{this._loaded=!0,v?this.fire(new o.ErrorEvent(v)):A&&(this.video=A,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(c){if(this.video){const v=this.video.seekable;c<v.start(0)||c>v.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${v.start(0)} and ${v.end(0)}-second mark.`))):this.video.currentTime=c}}getVideo(){return this.video}onAdd(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const c=this.map.painter.context,v=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,_t.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE),v.texSubImage2D(v.TEXTURE_2D,0,0,0,v.RGBA,v.UNSIGNED_BYTE,this.video)):(this.texture=new H(c,this.video,v.RGBA),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE));for(const A in this.tiles){const h=this.tiles[A];h.state!=="loaded"&&(h.state="loaded",h.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Ln extends Tt{constructor(c,v,A,h){super(c,v,A,h),v.coordinates?Array.isArray(v.coordinates)&&v.coordinates.length===4&&!v.coordinates.some(d=>!Array.isArray(d)||d.length!==2||d.some(w=>typeof w!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'missing required property "coordinates"'))),v.animate&&typeof v.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'optional "animate" property must be a boolean value'))),v.canvas?typeof v.canvas=="string"||v.canvas instanceof HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'missing required property "canvas"'))),this.options=v,this.animate=v.animate===void 0||v.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const v=this.map.painter.context,A=v.gl;this.boundsBuffer||(this.boundsBuffer=v.createVertexBuffer(this._boundsArray,_t.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(c||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new H(v,this.canvas,A.RGBA,{premultiply:!0});for(const h in this.tiles){const d=this.tiles[h];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const c of[this.canvas.width,this.canvas.height])if(isNaN(c)||c<=0)return!0;return!1}}const Tn={vector:Ze,raster:pt,"raster-dem":Et,geojson:un,video:Jt,image:Tt,canvas:Ln};function Ir(L,c){const v=o.create();return o.translate(v,v,[1,1,0]),o.scale(v,v,[.5*L.width,.5*L.height,1]),o.multiply(v,v,L.calculatePosMatrix(c.toUnwrapped()))}function tr(L,c,v,A,h,d){const w=function(V,W,X){if(V)for(const ae of V){const ne=W[ae];if(ne&&ne.source===X&&ne.type==="fill-extrusion")return!0}else for(const ae in W){const ne=W[ae];if(ne.source===X&&ne.type==="fill-extrusion")return!0}return!1}(h&&h.layers,c,L.id),b=d.maxPitchScaleFactor(),S=L.tilesIn(A,b,w);S.sort(ar);const P=[];for(const V of S)P.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(c,v,L._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,h,d,b,Ir(L.transform,V.tileID))});const B=function(V){const W={},X={};for(const ae of V){const ne=ae.queryResults,ue=ae.wrappedTileID,Ee=X[ue]=X[ue]||{};for(const Me in ne){const ve=ne[Me],je=Ee[Me]=Ee[Me]||{},Se=W[Me]=W[Me]||[];for(const $e of ve)je[$e.featureIndex]||(je[$e.featureIndex]=!0,Se.push($e))}}return W}(P);for(const V in B)B[V].forEach(W=>{const X=W.feature,ae=L.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=ae});return B}function ar(L,c){const v=L.tileID,A=c.tileID;return v.overscaledZ-A.overscaledZ||v.canonical.y-A.canonical.y||v.wrap-A.wrap||v.canonical.x-A.canonical.x}class pr{constructor(c,v){this.tileID=c,this.uid=o.uniqueId(),this.uses=0,this.tileSize=v,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(c){const v=c+this.timeAdded;v<o.exported.now()||this.fadeEndTime&&v<this.fadeEndTime||(this.fadeEndTime=v)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(c){this.demTexture&&c.saveTileTexture(this.demTexture),this.textures.forEach(v=>c.saveTileTexture(v)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(c,v,A){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(h,d){const w={};if(!d)return w;for(const b of h){const S=b.layerIds.map(P=>d.getLayer(P)).filter(Boolean);if(S.length!==0){b.layers=S,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(P=>S.filter(B=>B.id===P)[0]));for(const P of S)w[P.id]=b}}return w}(c.buckets,v.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const d=this.buckets[h];if(d instanceof o.SymbolBucket){if(this.hasSymbolBuckets=!0,!A)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const d=this.buckets[h];if(d instanceof o.SymbolBucket&&d.hasRTLText){this.hasRTLText=!0,o.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const h in this.buckets){const d=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,v.style.getLayer(h).queryRadius(d))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new o.CollisionBoxArray}unloadVectorData(){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(c){return this.buckets[c.id]}upload(c){for(const A in this.buckets){const h=this.buckets[A];h.uploadPending()&&h.upload(c)}const v=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new H(c,this.imageAtlas.image,v.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new H(c,this.glyphAtlasImage,v.ALPHA),this.glyphAtlasImage=null)}prepare(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)}queryRenderedFeatures(c,v,A,h,d,w,b,S,P,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:d,scale:w,tileSize:this.tileSize,pixelPosMatrix:B,transform:S,params:b,queryPadding:this.queryPadding*P},c,v,A):{}}querySourceFeatures(c,v){const A=this.latestFeatureIndex;if(!A||!A.rawTileData)return;const h=A.loadVTLayers(),d=v?v.sourceLayer:"",w=h._geojsonTileLayer||h[d];if(!w)return;const b=o.createFilter(v&&v.filter),{z:S,x:P,y:B}=this.tileID.canonical,V={z:S,x:P,y:B};for(let W=0;W<w.length;W++){const X=w.feature(W);if(b.needGeometry){const ue=o.toEvaluationFeature(X,!0);if(!b.filter(new o.EvaluationParameters(this.tileID.overscaledZ),ue,this.tileID.canonical))continue}else if(!b.filter(new o.EvaluationParameters(this.tileID.overscaledZ),X))continue;const ae=A.getId(X,d),ne=new o.GeoJSONFeature(X,S,P,B,ae);ne.tile=V,c.push(ne)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(c){const v=this.expirationTime;if(c.cacheControl){const A=o.parseCacheControl(c.cacheControl);A["max-age"]&&(this.expirationTime=Date.now()+1e3*A["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){const A=Date.now();let h=!1;if(this.expirationTime>A)h=!1;else if(v)if(this.expirationTime<v)h=!0;else{const d=this.expirationTime-v;d?this.expirationTime=A+Math.max(d,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(c,v){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(c).length===0)return;const A=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!v.style.hasLayer(h))continue;const d=this.buckets[h],w=d.layers[0].sourceLayer||"_geojsonTileLayer",b=A[w],S=c[w];if(!b||!S||Object.keys(S).length===0)continue;d.update(S,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});const P=v&&v.style&&v.style.getLayer(h);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(c){this.symbolFadeHoldUntil=o.exported.now()+c}setDependencies(c,v){const A={};for(const h of v)A[h]=!0;this.dependencies[c]=A}hasDependency(c,v){for(const A of c){const h=this.dependencies[A];if(h){for(const d of v)if(h[d])return!0}}return!1}}class Gn{constructor(c,v){this.max=c,this.onRemove=v,this.reset()}reset(){for(const c in this.data)for(const v of this.data[c])v.timeout&&clearTimeout(v.timeout),this.onRemove(v.value);return this.data={},this.order=[],this}add(c,v,A){const h=c.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const d={value:v,timeout:void 0};if(A!==void 0&&(d.timeout=setTimeout(()=>{this.remove(c,d)},A)),this.data[h].push(d),this.order.push(h),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(c){return c.wrapped().key in this.data}getAndRemove(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null}_getAndRemoveByKey(c){const v=this.data[c].shift();return v.timeout&&clearTimeout(v.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),v.value}getByKey(c){const v=this.data[c];return v?v[0].value:null}get(c){return this.has(c)?this.data[c.wrapped().key][0].value:null}remove(c,v){if(!this.has(c))return this;const A=c.wrapped().key,h=v===void 0?0:this.data[A].indexOf(v),d=this.data[A][h];return this.data[A].splice(h,1),d.timeout&&clearTimeout(d.timeout),this.data[A].length===0&&delete this.data[A],this.onRemove(d.value),this.order.splice(this.order.indexOf(A),1),this}setMaxSize(c){for(this.max=c;this.order.length>this.max;){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}filter(c){const v=[];for(const A in this.data)for(const h of this.data[A])c(h.value)||v.push(h);for(const A of v)this.remove(A.value.tileID,A)}}class Mr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,v,A){const h=String(v);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][h]=this.stateChanges[c][h]||{},o.extend(this.stateChanges[c][h],A),this.deletedStates[c]===null){this.deletedStates[c]={};for(const d in this.state[c])d!==h&&(this.deletedStates[c][d]=null)}else if(this.deletedStates[c]&&this.deletedStates[c][h]===null){this.deletedStates[c][h]={};for(const d in this.state[c][h])A[d]||(this.deletedStates[c][h][d]=null)}else for(const d in A)this.deletedStates[c]&&this.deletedStates[c][h]&&this.deletedStates[c][h][d]===null&&delete this.deletedStates[c][h][d]}removeFeatureState(c,v,A){if(this.deletedStates[c]===null)return;const h=String(v);if(this.deletedStates[c]=this.deletedStates[c]||{},A&&v!==void 0)this.deletedStates[c][h]!==null&&(this.deletedStates[c][h]=this.deletedStates[c][h]||{},this.deletedStates[c][h][A]=null);else if(v!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][h])for(A in this.deletedStates[c][h]={},this.stateChanges[c][h])this.deletedStates[c][h][A]=null;else this.deletedStates[c][h]=null;else this.deletedStates[c]=null}getState(c,v){const A=String(v),h=o.extend({},(this.state[c]||{})[A],(this.stateChanges[c]||{})[A]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){const d=this.deletedStates[c][v];if(d===null)return{};for(const w in d)delete h[w]}return h}initializeTileState(c,v){c.setFeatureState(this.state,v)}coalesceChanges(c,v){const A={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const d={};for(const w in this.stateChanges[h])this.state[h][w]||(this.state[h][w]={}),o.extend(this.state[h][w],this.stateChanges[h][w]),d[w]=this.state[h][w];A[h]=d}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const d={};if(this.deletedStates[h]===null)for(const w in this.state[h])d[w]={},this.state[h][w]={};else for(const w in this.deletedStates[h]){if(this.deletedStates[h][w]===null)this.state[h][w]={};else for(const b of Object.keys(this.deletedStates[h][w]))delete this.state[h][w][b];d[w]=this.state[h][w]}A[h]=A[h]||{},o.extend(A[h],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(A).length!==0)for(const h in c)c[h].setFeatureState(A,v)}}class wt extends o.Evented{constructor(c,v,A){super(),this.id=c,this.dispatcher=A,this.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(h,d,w,b){const S=new Tn[d.type](h,d,w,b);if(S.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${S.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],S),S}(c,v,A,this),this._tiles={},this._cache=new Gn(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Mr}onAdd(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(c)}onRemove(c){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(c)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const c in this._tiles){const v=this._tiles[c];if(v.state!=="loaded"&&v.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(c,v){return this._source.loadTile(c,v)}_unloadTile(c){if(this._source.unloadTile)return this._source.unloadTile(c,()=>{})}_abortTile(c){this._source.abortTile&&this._source.abortTile(c,()=>{}),this._source.fire(new o.Event("dataabort",{tile:c,coord:c.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(c){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const v in this._tiles){const A=this._tiles[v];A.upload(c),A.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(c=>c.tileID).sort(rn).map(c=>c.key)}getRenderableIds(c){const v=[];for(const A in this._tiles)this._isIdRenderable(A,c)&&v.push(this._tiles[A]);return c?v.sort((A,h)=>{const d=A.tileID,w=h.tileID,b=new o.pointGeometry(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),S=new o.pointGeometry(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-w.overscaledZ||S.y-b.y||S.x-b.x}).map(A=>A.tileID.key):v.map(A=>A.tileID).sort(rn).map(A=>A.key)}hasRenderableParent(c){const v=this.findLoadedParent(c,0);return!!v&&this._isIdRenderable(v.tileID.key)}_isIdRenderable(c,v){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(v||!this._tiles[c].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)this._tiles[c].state!=="errored"&&this._reloadTile(c,"reloading")}}_reloadTile(c,v){const A=this._tiles[c];A&&(A.state!=="loading"&&(A.state=v),this._loadTile(A,this._tileLoaded.bind(this,A,c,v)))}_tileLoaded(c,v,A,h){if(h)return c.state="errored",void(h.status!==404?this._source.fire(new o.ErrorEvent(h,{tile:c})):this.update(this.transform,this.terrain));c.timeAdded=o.exported.now(),A==="expired"&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(v,c),this.getSource().type==="raster-dem"&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),c.aborted||this._source.fire(new o.Event("data",{dataType:"source",tile:c,coord:c.tileID}))}_backfillDEM(c){const v=this.getRenderableIds();for(let h=0;h<v.length;h++){const d=v[h];if(c.neighboringTiles&&c.neighboringTiles[d]){const w=this.getTileByID(d);A(c,w),A(w,c)}}function A(h,d){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let w=d.tileID.canonical.x-h.tileID.canonical.x;const b=d.tileID.canonical.y-h.tileID.canonical.y,S=Math.pow(2,h.tileID.canonical.z),P=d.tileID.key;w===0&&b===0||Math.abs(b)>1||(Math.abs(w)>1&&(Math.abs(w+S)===1?w+=S:Math.abs(w-S)===1&&(w-=S)),d.dem&&h.dem&&(h.dem.backfillBorder(d.dem,w,b),h.neighboringTiles&&h.neighboringTiles[P]&&(h.neighboringTiles[P].backfilled=!0)))}}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._tiles[c]}_retainLoadedChildren(c,v,A,h){for(const d in this._tiles){let w=this._tiles[d];if(h[d]||!w.hasData()||w.tileID.overscaledZ<=v||w.tileID.overscaledZ>A)continue;let b=w.tileID;for(;w&&w.tileID.overscaledZ>v+1;){const P=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[P.key],w&&w.hasData()&&(b=P)}let S=b;for(;S.overscaledZ>v;)if(S=S.scaledTo(S.overscaledZ-1),c[S.key]){h[b.key]=b;break}}}findLoadedParent(c,v){if(c.key in this._loadedParentTiles){const A=this._loadedParentTiles[c.key];return A&&A.tileID.overscaledZ>=v?A:null}for(let A=c.overscaledZ-1;A>=v;A--){const h=c.scaledTo(A),d=this._getLoadedTile(h);if(d)return d}}_getLoadedTile(c){const v=this._tiles[c.key];return v&&v.hasData()?v:this._cache.getByKey(c.wrapped().key)}updateCacheSize(c){const v=Math.ceil(c.width/this._source.tileSize)+1,A=Math.ceil(c.height/this._source.tileSize)+1,h=Math.floor(v*A*5),d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(d)}handleWrapJump(c){const v=Math.round((c-(this._prevLng===void 0?c:this._prevLng))/360);if(this._prevLng=c,v){const A={};for(const h in this._tiles){const d=this._tiles[h];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+v),A[d.tileID.key]=d}this._tiles=A;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}update(c,v){if(this.transform=c,this.terrain=v,!this._sourceLoaded||this._paused)return;let A;this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?A=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(P=>new o.OverscaledTileID(P.canonical.z,P.wrap,P.canonical.z,P.canonical.x,P.canonical.y)):(A=c.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:v}),this._source.hasTile&&(A=A.filter(P=>this._source.hasTile(P)))):A=[];const h=c.coveringZoomLevel(this._source),d=Math.max(h-wt.maxOverzooming,this._source.minzoom),w=Math.max(h+wt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const P={};for(const B of A)if(B.canonical.z>this._source.minzoom){const V=B.scaledTo(B.canonical.z-1);P[V.key]=V;const W=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));P[W.key]=W}A=A.concat(Object.values(P))}const b=this._updateRetainedTiles(A,h);if(Pn(this._source.type)){const P={},B={},V=Object.keys(b);for(const W of V){const X=b[W],ae=this._tiles[W];if(!ae||ae.fadeEndTime&&ae.fadeEndTime<=o.exported.now())continue;const ne=this.findLoadedParent(X,d);ne&&(this._addTile(ne.tileID),P[ne.tileID.key]=ne.tileID),B[W]=X}this._retainLoadedChildren(B,h,w,b);for(const W in P)b[W]||(this._coveredTiles[W]=!0,b[W]=P[W]);if(v){const W={},X={};for(const ae of A)this._tiles[ae.key].hasData()?W[ae.key]=ae:X[ae.key]=ae;for(const ae in X){const ne=X[ae].children(this._source.maxzoom);this._tiles[ne[0].key]&&this._tiles[ne[1].key]&&this._tiles[ne[2].key]&&this._tiles[ne[3].key]&&(W[ne[0].key]=b[ne[0].key]=ne[0],W[ne[1].key]=b[ne[1].key]=ne[1],W[ne[2].key]=b[ne[2].key]=ne[2],W[ne[3].key]=b[ne[3].key]=ne[3],delete X[ae])}for(const ae in X){const ne=this.findLoadedParent(X[ae],this._source.minzoom);if(ne){W[ne.tileID.key]=b[ne.tileID.key]=ne.tileID;for(const ue in W)W[ue].isChildOf(ne.tileID)&&delete W[ue]}}for(const ae in this._tiles)W[ae]||(this._coveredTiles[ae]=!0)}}for(const P in b)this._tiles[P].clearFadeHold();const S=o.keysDifference(this._tiles,b);for(const P of S){const B=this._tiles[P];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(P)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(c)}_updateRetainedTiles(c,v){const A={},h={},d=Math.max(v-wt.maxOverzooming,this._source.minzoom),w=Math.max(v+wt.maxUnderzooming,this._source.minzoom),b={};for(const S of c){const P=this._addTile(S);A[S.key]=S,P.hasData()||v<this._source.maxzoom&&(b[S.key]=S)}this._retainLoadedChildren(b,v,w,A);for(const S of c){let P=this._tiles[S.key];if(P.hasData())continue;if(v+1>this._source.maxzoom){const V=S.children(this._source.maxzoom)[0],W=this.getTile(V);if(W&&W.hasData()){A[V.key]=V;continue}}else{const V=S.children(this._source.maxzoom);if(A[V[0].key]&&A[V[1].key]&&A[V[2].key]&&A[V[3].key])continue}let B=P.wasRequested();for(let V=S.overscaledZ-1;V>=d;--V){const W=S.scaledTo(V);if(h[W.key]||(h[W.key]=!0,P=this.getTile(W),!P&&B&&(P=this._addTile(W)),P&&(A[W.key]=W,B=P.wasRequested(),P.hasData())))break}}return A}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const c in this._tiles){const v=[];let A,h=this._tiles[c].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){A=this._loadedParentTiles[h.key];break}v.push(h.key);const d=h.scaledTo(h.overscaledZ-1);if(A=this._getLoadedTile(d),A)break;h=d}for(const d of v)this._loadedParentTiles[d]=A}}_addTile(c){let v=this._tiles[c.key];if(v)return v;v=this._cache.getAndRemove(c),v&&(this._setTileReloadTimer(c.key,v),v.tileID=c,this._state.initializeTileState(v,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,v)));const A=v;return v||(v=new pr(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(v,this._tileLoaded.bind(this,v,c.key,v.state))),v.uses++,this._tiles[c.key]=v,A||this._source.fire(new o.Event("dataloading",{tile:v,coord:v.tileID,dataType:"source"})),v}_setTileReloadTimer(c,v){c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);const A=v.getExpiryTimeout();A&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},A))}_removeTile(c){const v=this._tiles[c];v&&(v.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),v.uses>0||(v.hasData()&&v.state!=="reloading"?this._cache.add(v.tileID,v,v.getExpiryTimeout()):(v.aborted=!0,this._abortTile(v),this._unloadTile(v))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const c in this._tiles)this._removeTile(c);this._cache.reset()}tilesIn(c,v,A){const h=[],d=this.transform;if(!d)return h;const w=A?d.getCameraQueryGeometry(c):c,b=c.map(ae=>d.pointCoordinate(ae,this.terrain)),S=w.map(ae=>d.pointCoordinate(ae,this.terrain)),P=this.getIds();let B=1/0,V=1/0,W=-1/0,X=-1/0;for(const ae of S)B=Math.min(B,ae.x),V=Math.min(V,ae.y),W=Math.max(W,ae.x),X=Math.max(X,ae.y);for(let ae=0;ae<P.length;ae++){const ne=this._tiles[P[ae]];if(ne.holdingForFade())continue;const ue=ne.tileID,Ee=Math.pow(2,d.zoom-ne.tileID.overscaledZ),Me=v*ne.queryPadding*o.EXTENT/ne.tileSize/Ee,ve=[ue.getTilePoint(new o.MercatorCoordinate(B,V)),ue.getTilePoint(new o.MercatorCoordinate(W,X))];if(ve[0].x-Me<o.EXTENT&&ve[0].y-Me<o.EXTENT&&ve[1].x+Me>=0&&ve[1].y+Me>=0){const je=b.map($e=>ue.getTilePoint($e)),Se=S.map($e=>ue.getTilePoint($e));h.push({tile:ne,tileID:ue,queryGeometry:je,cameraQueryGeometry:Se,scale:Ee})}}return h}getVisibleCoordinates(c){const v=this.getRenderableIds(c).map(A=>this._tiles[A].tileID);for(const A of v)A.posMatrix=this.transform.calculatePosMatrix(A.toUnwrapped());return v}hasTransition(){if(this._source.hasTransition())return!0;if(Pn(this._source.type))for(const c in this._tiles){const v=this._tiles[c];if(v.fadeEndTime!==void 0&&v.fadeEndTime>=o.exported.now())return!0}return!1}setFeatureState(c,v,A){this._state.updateState(c=c||"_geojsonTileLayer",v,A)}removeFeatureState(c,v,A){this._state.removeFeatureState(c=c||"_geojsonTileLayer",v,A)}getFeatureState(c,v){return this._state.getState(c=c||"_geojsonTileLayer",v)}setDependencies(c,v,A){const h=this._tiles[c];h&&h.setDependencies(v,A)}reloadTilesForDependencies(c,v){for(const A in this._tiles)this._tiles[A].hasDependency(c,v)&&this._reloadTile(A,"reloading");this._cache.filter(A=>!A.hasDependency(c,v))}}function rn(L,c){const v=Math.abs(2*L.wrap)-+(L.wrap<0),A=Math.abs(2*c.wrap)-+(c.wrap<0);return L.overscaledZ-c.overscaledZ||A-v||c.canonical.y-L.canonical.y||c.canonical.x-L.canonical.x}function Pn(L){return L==="raster"||L==="image"||L==="video"}wt.maxOverzooming=10,wt.maxUnderzooming=3;const xt="mapboxgl_preloaded_worker_pool";class nr{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<nr.workerCount;)this.workers.push(new Worker(Ks.workerUrl));return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(v=>{v.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[xt]}numActive(){return Object.keys(this.active).length}}const Qn=Math.floor(o.exported.hardwareConcurrency/2);let br;function cr(){return br||(br=new nr),br}function rr(L,c){const v={};for(const A in L)A!=="ref"&&(v[A]=L[A]);return o.refProperties.forEach(A=>{A in c&&(v[A]=c[A])}),v}function ni(L){L=L.slice();const c=Object.create(null);for(let v=0;v<L.length;v++)c[L[v].id]=L[v];for(let v=0;v<L.length;v++)"ref"in L[v]&&(L[v]=rr(L[v],c[L[v].ref]));return L}nr.workerCount=Math.max(Math.min(Qn,6),1);const $n={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ii(L,c,v){v.push({command:$n.addSource,args:[L,c[L]]})}function qn(L,c,v){c.push({command:$n.removeSource,args:[L]}),v[L]=!0}function Gi(L,c,v,A){qn(L,v,A),Ii(L,c,v)}function vo(L,c,v){let A;for(A in L[v])if(Object.prototype.hasOwnProperty.call(L[v],A)&&A!=="data"&&!M(L[v][A],c[v][A]))return!1;for(A in c[v])if(Object.prototype.hasOwnProperty.call(c[v],A)&&A!=="data"&&!M(L[v][A],c[v][A]))return!1;return!0}function $r(L,c,v,A,h,d){let w;for(w in c=c||{},L=L||{})Object.prototype.hasOwnProperty.call(L,w)&&(M(L[w],c[w])||v.push({command:d,args:[A,w,c[w],h]}));for(w in c)Object.prototype.hasOwnProperty.call(c,w)&&!Object.prototype.hasOwnProperty.call(L,w)&&(M(L[w],c[w])||v.push({command:d,args:[A,w,c[w],h]}))}function Li(L){return L.id}function Ho(L,c){return L[c.id]=c,L}class As{constructor(c,v){this.reset(c,v)}reset(c,v){this.points=c||[],this._distances=[0];for(let A=1;A<this.points.length;A++)this._distances[A]=this._distances[A-1]+this.points[A].dist(this.points[A-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(v||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=o.clamp(c,0,1);let v=1,A=this._distances[v];const h=c*this.paddedLength+this.padding;for(;A<h&&v<this._distances.length;)A=this._distances[++v];const d=v-1,w=this._distances[d],b=A-w,S=b>0?(h-w)/b:0;return this.points[d].mult(1-S).add(this.points[v].mult(S))}}function ht(L,c){let v=!0;return L==="always"||L!=="never"&&c!=="never"||(v=!1),v}class It{constructor(c,v,A){const h=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(c/A),this.yCellCount=Math.ceil(v/A);for(let w=0;w<this.xCellCount*this.yCellCount;w++)h.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=v,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/v,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,v,A,h,d){this._forEachCell(v,A,h,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(v),this.bboxes.push(A),this.bboxes.push(h),this.bboxes.push(d)}insertCircle(c,v,A,h){this._forEachCell(v-h,A-h,v+h,A+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(v),this.circles.push(A),this.circles.push(h)}_insertBoxCell(c,v,A,h,d,w){this.boxCells[d].push(w)}_insertCircleCell(c,v,A,h,d,w){this.circleCells[d].push(w)}_query(c,v,A,h,d,w,b){if(A<0||c>this.width||h<0||v>this.height)return[];const S=[];if(c<=0&&v<=0&&this.width<=A&&this.height<=h){if(d)return[{key:null,x1:c,y1:v,x2:A,y2:h}];for(let P=0;P<this.boxKeys.length;P++)S.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const B=this.circles[3*P],V=this.circles[3*P+1],W=this.circles[3*P+2];S.push({key:this.circleKeys[P],x1:B-W,y1:V-W,x2:B+W,y2:V+W})}}else this._forEachCell(c,v,A,h,this._queryCell,S,{hitTest:d,overlapMode:w,seenUids:{box:{},circle:{}}},b);return S}query(c,v,A,h){return this._query(c,v,A,h,!1,null)}hitTest(c,v,A,h,d,w){return this._query(c,v,A,h,!0,d,w).length>0}hitTestCircle(c,v,A,h,d){const w=c-A,b=c+A,S=v-A,P=v+A;if(b<0||w>this.width||P<0||S>this.height)return!1;const B=[];return this._forEachCell(w,S,b,P,this._queryCellCircle,B,{hitTest:!0,overlapMode:h,circle:{x:c,y:v,radius:A},seenUids:{box:{},circle:{}}},d),B.length>0}_queryCell(c,v,A,h,d,w,b,S){const{seenUids:P,hitTest:B,overlapMode:V}=b,W=this.boxCells[d];if(W!==null){const ae=this.bboxes;for(const ne of W)if(!P.box[ne]){P.box[ne]=!0;const ue=4*ne,Ee=this.boxKeys[ne];if(c<=ae[ue+2]&&v<=ae[ue+3]&&A>=ae[ue+0]&&h>=ae[ue+1]&&(!S||S(Ee))&&(!B||!ht(V,Ee.overlapMode))&&(w.push({key:Ee,x1:ae[ue],y1:ae[ue+1],x2:ae[ue+2],y2:ae[ue+3]}),B))return!0}}const X=this.circleCells[d];if(X!==null){const ae=this.circles;for(const ne of X)if(!P.circle[ne]){P.circle[ne]=!0;const ue=3*ne,Ee=this.circleKeys[ne];if(this._circleAndRectCollide(ae[ue],ae[ue+1],ae[ue+2],c,v,A,h)&&(!S||S(Ee))&&(!B||!ht(V,Ee.overlapMode))){const Me=ae[ue],ve=ae[ue+1],je=ae[ue+2];if(w.push({key:Ee,x1:Me-je,y1:ve-je,x2:Me+je,y2:ve+je}),B)return!0}}}return!1}_queryCellCircle(c,v,A,h,d,w,b,S){const{circle:P,seenUids:B,overlapMode:V}=b,W=this.boxCells[d];if(W!==null){const ae=this.bboxes;for(const ne of W)if(!B.box[ne]){B.box[ne]=!0;const ue=4*ne,Ee=this.boxKeys[ne];if(this._circleAndRectCollide(P.x,P.y,P.radius,ae[ue+0],ae[ue+1],ae[ue+2],ae[ue+3])&&(!S||S(Ee))&&!ht(V,Ee.overlapMode))return w.push(!0),!0}}const X=this.circleCells[d];if(X!==null){const ae=this.circles;for(const ne of X)if(!B.circle[ne]){B.circle[ne]=!0;const ue=3*ne,Ee=this.circleKeys[ne];if(this._circlesCollide(ae[ue],ae[ue+1],ae[ue+2],P.x,P.y,P.radius)&&(!S||S(Ee))&&!ht(V,Ee.overlapMode))return w.push(!0),!0}}}_forEachCell(c,v,A,h,d,w,b,S){const P=this._convertToXCellCoord(c),B=this._convertToYCellCoord(v),V=this._convertToXCellCoord(A),W=this._convertToYCellCoord(h);for(let X=P;X<=V;X++)for(let ae=B;ae<=W;ae++)if(d.call(this,c,v,A,h,this.xCellCount*ae+X,w,b,S))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,v,A,h,d,w){const b=h-c,S=d-v,P=A+w;return P*P>b*b+S*S}_circleAndRectCollide(c,v,A,h,d,w,b){const S=(w-h)/2,P=Math.abs(c-(h+S));if(P>S+A)return!1;const B=(b-d)/2,V=Math.abs(v-(d+B));if(V>B+A)return!1;if(P<=S||V<=B)return!0;const W=P-S,X=V-B;return W*W+X*X<=A*A}}function Vs(L,c,v,A,h){const d=o.create();return c?(o.scale(d,d,[1/h,1/h,1]),v||o.rotateZ(d,d,A.angle)):o.multiply(d,A.labelPlaneMatrix,L),d}function Ei(L,c,v,A,h){if(c){const d=o.clone(L);return o.scale(d,d,[h,h,1]),v||o.rotateZ(d,d,-A.angle),d}return A.glCoordMatrix}function zn(L,c,v){let A;v?(A=[L.x,L.y,v(L.x,L.y),1],o.transformMat4(A,A,c)):(A=[L.x,L.y,0,1],Ke(A,A,c));const h=A[3];return{point:new o.pointGeometry(A[0]/h,A[1]/h),signedDistanceFromCamera:h}}function $i(L,c){return .5+L/c*.5}function Di(L,c){const v=L[0]/L[3],A=L[1]/L[3];return v>=-c[0]&&v<=c[0]&&A>=-c[1]&&A<=c[1]}function Ri(L,c,v,A,h,d,w,b,S,P){const B=A?L.textSizeData:L.iconSizeData,V=o.evaluateSizeForZoom(B,v.transform.zoom),W=[256/v.width*2+1,256/v.height*2+1],X=A?L.text.dynamicLayoutVertexArray:L.icon.dynamicLayoutVertexArray;X.clear();const ae=L.lineVertexArray,ne=A?L.text.placedSymbolArray:L.icon.placedSymbolArray,ue=v.transform.width/v.transform.height;let Ee=!1;for(let Me=0;Me<ne.length;Me++){const ve=ne.get(Me);if(ve.hidden||ve.writingMode===o.WritingMode.vertical&&!Ee){yn(ve.numGlyphs,X);continue}let je;if(Ee=!1,P?(je=[ve.anchorX,ve.anchorY,P(ve.anchorX,ve.anchorY),1],o.transformMat4(je,je,c)):(je=[ve.anchorX,ve.anchorY,0,1],Ke(je,je,c)),!Di(je,W)){yn(ve.numGlyphs,X);continue}const Se=$i(v.transform.cameraToCenterDistance,je[3]),$e=o.evaluateSizeForFeature(B,V,ve),xe=w?$e/Se:$e*Se,y=new o.pointGeometry(ve.anchorX,ve.anchorY),m=zn(y,h,P).point,x={},E=Sn(ve,xe,!1,b,c,h,d,L.glyphOffsetArray,ae,X,m,y,x,ue,S,P);Ee=E.useVertical,(E.notEnoughRoom||Ee||E.needsFlipping&&Sn(ve,xe,!0,b,c,h,d,L.glyphOffsetArray,ae,X,m,y,x,ue,S,P).notEnoughRoom)&&yn(ve.numGlyphs,X)}A?L.text.dynamicLayoutVertexBuffer.updateData(X):L.icon.dynamicLayoutVertexBuffer.updateData(X)}function us(L,c,v,A,h,d,w,b,S,P,B,V,W){const X=b.glyphStartIndex+b.numGlyphs,ae=b.lineStartIndex,ne=b.lineStartIndex+b.lineLength,ue=c.getoffsetX(b.glyphStartIndex),Ee=c.getoffsetX(X-1),Me=Rr(L*ue,v,A,h,d,w,b.segment,ae,ne,S,P,B,V,W);if(!Me)return null;const ve=Rr(L*Ee,v,A,h,d,w,b.segment,ae,ne,S,P,B,V,W);return ve?{first:Me,last:ve}:null}function Lt(L,c,v,A){return L===o.WritingMode.horizontal&&Math.abs(v.y-c.y)>Math.abs(v.x-c.x)*A?{useVertical:!0}:(L===o.WritingMode.vertical?c.y<v.y:c.x>v.x)?{needsFlipping:!0}:null}function Sn(L,c,v,A,h,d,w,b,S,P,B,V,W,X,ae,ne){const ue=c/24,Ee=L.lineOffsetX*ue,Me=L.lineOffsetY*ue;let ve;if(L.numGlyphs>1){const je=L.glyphStartIndex+L.numGlyphs,Se=L.lineStartIndex,$e=L.lineStartIndex+L.lineLength,xe=us(ue,b,Ee,Me,v,B,V,L,S,d,W,ae,ne);if(!xe)return{notEnoughRoom:!0};const y=zn(xe.first.point,w,ne).point,m=zn(xe.last.point,w,ne).point;if(A&&!v){const x=Lt(L.writingMode,y,m,X);if(x)return x}ve=[xe.first];for(let x=L.glyphStartIndex+1;x<je-1;x++)ve.push(Rr(ue*b.getoffsetX(x),Ee,Me,v,B,V,L.segment,Se,$e,S,d,W,ae,ne));ve.push(xe.last)}else{if(A&&!v){const Se=zn(V,h,ne).point,$e=L.lineStartIndex+L.segment+1,xe=new o.pointGeometry(S.getx($e),S.gety($e)),y=zn(xe,h,ne),m=y.signedDistanceFromCamera>0?y.point:bn(V,xe,Se,1,h,ne),x=Lt(L.writingMode,Se,m,X);if(x)return x}const je=Rr(ue*b.getoffsetX(L.glyphStartIndex),Ee,Me,v,B,V,L.segment,L.lineStartIndex,L.lineStartIndex+L.lineLength,S,d,W,ae,ne);if(!je)return{notEnoughRoom:!0};ve=[je]}for(const je of ve)o.addDynamicAttributes(P,je.point,je.angle);return{}}function bn(L,c,v,A,h,d){const w=zn(L.add(L.sub(c)._unit()),h,d).point,b=v.sub(w);return v.add(b._mult(A/b.mag()))}function Rr(L,c,v,A,h,d,w,b,S,P,B,V,W,X){const ae=A?L-c:L+c;let ne=ae>0?1:-1,ue=0;A&&(ne*=-1,ue=Math.PI),ne<0&&(ue+=Math.PI);let Ee=ne>0?b+w:b+w+1,Me=h,ve=h,je=0,Se=0;const $e=Math.abs(ae),xe=[];for(;je+Se<=$e;){if(Ee+=ne,Ee<b||Ee>=S)return null;if(ve=Me,xe.push(Me),Me=V[Ee],Me===void 0){const I=new o.pointGeometry(P.getx(Ee),P.gety(Ee)),R=zn(I,B,X);if(R.signedDistanceFromCamera>0)Me=V[Ee]=R.point;else{const O=Ee-ne;Me=bn(je===0?d:new o.pointGeometry(P.getx(O),P.gety(O)),I,ve,$e-je+1,B,X)}}je+=Se,Se=ve.dist(Me)}const y=($e-je)/Se,m=Me.sub(ve),x=m.mult(y)._add(ve);x._add(m._unit()._perp()._mult(v*ne));const E=ue+Math.atan2(Me.y-ve.y,Me.x-ve.x);return xe.push(x),{point:x,angle:W?E:0,path:xe}}const Ss=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function yn(L,c){for(let v=0;v<L;v++){const A=c.length;c.resize(A+4),c.float32.set(Ss,3*A)}}function Ke(L,c,v){const A=c[0],h=c[1];return L[0]=v[0]*A+v[4]*h+v[12],L[1]=v[1]*A+v[5]*h+v[13],L[3]=v[3]*A+v[7]*h+v[15],L}const qr=100;class Gs{constructor(c,v=new It(c.width+200,c.height+200,25),A=new It(c.width+200,c.height+200,25)){this.transform=c,this.grid=v,this.ignoredGrid=A,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+qr,this.screenBottomBoundary=c.height+qr,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(c,v,A,h,d,w){const b=this.projectAndGetPerspectiveRatio(h,c.anchorPointX,c.anchorPointY,w),S=A*b.perspectiveRatio,P=c.x1*S+b.point.x,B=c.y1*S+b.point.y,V=c.x2*S+b.point.x,W=c.y2*S+b.point.y;return!this.isInsideGrid(P,B,V,W)||v!=="always"&&this.grid.hitTest(P,B,V,W,v,d)||b.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[P,B,V,W],offscreen:this.isOffscreen(P,B,V,W)}}placeCollisionCircles(c,v,A,h,d,w,b,S,P,B,V,W,X,ae){const ne=[],ue=new o.pointGeometry(v.anchorX,v.anchorY),Ee=zn(ue,w,ae),Me=$i(this.transform.cameraToCenterDistance,Ee.signedDistanceFromCamera),ve=(B?d/Me:d*Me)/o.ONE_EM,je=zn(ue,b,ae).point,Se=us(ve,h,v.lineOffsetX*ve,v.lineOffsetY*ve,!1,je,ue,v,A,b,{},!1,ae);let $e=!1,xe=!1,y=!0;if(Se){const m=.5*W*Me+X,x=new o.pointGeometry(-100,-100),E=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),I=new As,R=Se.first,O=Se.last;let U=[];for(let le=R.path.length-1;le>=1;le--)U.push(R.path[le]);for(let le=1;le<O.path.length;le++)U.push(O.path[le]);const q=2.5*m;if(S){const le=U.map(de=>zn(de,S,ae));U=le.some(de=>de.signedDistanceFromCamera<=0)?[]:le.map(de=>de.point)}let ee=[];if(U.length>0){const le=U[0].clone(),de=U[0].clone();for(let Be=1;Be<U.length;Be++)le.x=Math.min(le.x,U[Be].x),le.y=Math.min(le.y,U[Be].y),de.x=Math.max(de.x,U[Be].x),de.y=Math.max(de.y,U[Be].y);ee=le.x>=x.x&&de.x<=E.x&&le.y>=x.y&&de.y<=E.y?[U]:de.x<x.x||le.x>E.x||de.y<x.y||le.y>E.y?[]:o.clipLine([U],x.x,x.y,E.x,E.y)}for(const le of ee){I.reset(le,.25*m);let de=0;de=I.length<=.5*m?1:Math.ceil(I.paddedLength/q)+1;for(let Be=0;Be<de;Be++){const He=Be/Math.max(de-1,1),ze=I.lerp(He),Je=ze.x+qr,ft=ze.y+qr;ne.push(Je,ft,m,0);const ct=Je-m,st=ft-m,ot=Je+m,et=ft+m;if(y=y&&this.isOffscreen(ct,st,ot,et),xe=xe||this.isInsideGrid(ct,st,ot,et),c!=="always"&&this.grid.hitTestCircle(Je,ft,m,c,V)&&($e=!0,!P))return{circles:[],offscreen:!1,collisionDetected:$e}}}}return{circles:!P&&$e||!xe||Me<this.perspectiveRatioCutoff?[]:ne,offscreen:y,collisionDetected:$e}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const v=[];let A=1/0,h=1/0,d=-1/0,w=-1/0;for(const B of c){const V=new o.pointGeometry(B.x+qr,B.y+qr);A=Math.min(A,V.x),h=Math.min(h,V.y),d=Math.max(d,V.x),w=Math.max(w,V.y),v.push(V)}const b=this.grid.query(A,h,d,w).concat(this.ignoredGrid.query(A,h,d,w)),S={},P={};for(const B of b){const V=B.key;if(S[V.bucketInstanceId]===void 0&&(S[V.bucketInstanceId]={}),S[V.bucketInstanceId][V.featureIndex])continue;const W=[new o.pointGeometry(B.x1,B.y1),new o.pointGeometry(B.x2,B.y1),new o.pointGeometry(B.x2,B.y2),new o.pointGeometry(B.x1,B.y2)];o.polygonIntersectsPolygon(v,W)&&(S[V.bucketInstanceId][V.featureIndex]=!0,P[V.bucketInstanceId]===void 0&&(P[V.bucketInstanceId]=[]),P[V.bucketInstanceId].push(V.featureIndex))}return P}insertCollisionBox(c,v,A,h,d,w){(A?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:d,collisionGroupID:w,overlapMode:v},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,v,A,h,d,w){const b=A?this.ignoredGrid:this.grid,S={bucketInstanceId:h,featureIndex:d,collisionGroupID:w,overlapMode:v};for(let P=0;P<c.length;P+=4)b.insertCircle(S,c[P],c[P+1],c[P+2])}projectAndGetPerspectiveRatio(c,v,A,h){let d;return h?(d=[v,A,h(v,A),1],o.transformMat4(d,d,c)):(d=[v,A,0,1],Ke(d,d,c)),{point:new o.pointGeometry((d[0]/d[3]+1)/2*this.transform.width+qr,(-d[1]/d[3]+1)/2*this.transform.height+qr),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}}isOffscreen(c,v,A,h){return A<qr||c>=this.screenRightBoundary||h<qr||v>this.screenBottomBoundary}isInsideGrid(c,v,A,h){return A>=0&&c<this.gridRightBoundary&&h>=0&&v<this.gridBottomBoundary}getViewportMatrix(){const c=o.identity([]);return o.translate(c,c,[-100,-100,0]),c}}function Fr(L,c,v){return c*(o.EXTENT/(L.tileSize*Math.pow(2,v-L.tileID.overscaledZ)))}class hi{constructor(c,v,A,h){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?v:-v))):h&&A?1:0,this.placed=A}isHidden(){return this.opacity===0&&!this.placed}}class Xn{constructor(c,v,A,h,d){this.text=new hi(c?c.text:null,v,A,d),this.icon=new hi(c?c.icon:null,v,h,d)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class $s{constructor(c,v,A){this.text=c,this.icon=v,this.skipFade=A}}class ji{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Hi{constructor(c,v,A,h,d){this.bucketInstanceId=c,this.featureIndex=v,this.sourceLayerIndex=A,this.bucketIndex=h,this.tileID=d}}class Bi{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const v=++this.maxGroupID;this.collisionGroups[c]={ID:v,predicate:A=>A.collisionGroupID===v}}return this.collisionGroups[c]}}function cs(L,c,v,A,h){const{horizontalAlign:d,verticalAlign:w}=o.getAnchorAlignment(L),b=-(d-.5)*c,S=-(w-.5)*v,P=o.evaluateVariableOffset(L,A);return new o.pointGeometry(b+P[0]*h,S+P[1]*h)}function Nr(L,c,v,A,h,d){const{x1:w,x2:b,y1:S,y2:P,anchorPointX:B,anchorPointY:V}=L,W=new o.pointGeometry(c,v);return A&&W._rotate(h?d:-d),{x1:w+W.x,y1:S+W.y,x2:b+W.x,y2:P+W.y,anchorPointX:B,anchorPointY:V}}class K{constructor(c,v,A,h,d){this.transform=c.clone(),this.terrain=v,this.collisionIndex=new Gs(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=A,this.retainedQueryData={},this.collisionGroups=new Bi(h),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,v,A,h){const d=A.getBucket(v),w=A.latestFeatureIndex;if(!d||!w||v.id!==d.layerIds[0])return;const b=A.collisionBoxArray,S=d.layers[0].layout,P=Math.pow(2,this.transform.zoom-A.tileID.overscaledZ),B=A.tileSize/o.EXTENT,V=this.transform.calculatePosMatrix(A.tileID.toUnwrapped()),W=S.get("text-pitch-alignment")==="map",X=S.get("text-rotation-alignment")==="map",ae=Fr(A,1,this.transform.zoom),ne=Vs(V,W,X,this.transform,ae);let ue=null;if(W){const Me=Ei(V,W,X,this.transform,ae);ue=o.multiply([],this.transform.labelPlaneMatrix,Me)}this.retainedQueryData[d.bucketInstanceId]=new Hi(d.bucketInstanceId,w,d.sourceLayerIndex,d.index,A.tileID);const Ee={bucket:d,layout:S,posMatrix:V,textLabelPlaneMatrix:ne,labelToScreenMatrix:ue,scale:P,textPixelRatio:B,holdingForFade:A.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(h)for(const Me of d.sortKeyRanges){const{sortKey:ve,symbolInstanceStart:je,symbolInstanceEnd:Se}=Me;c.push({sortKey:ve,symbolInstanceStart:je,symbolInstanceEnd:Se,parameters:Ee})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:Ee})}attemptAnchorPlacement(c,v,A,h,d,w,b,S,P,B,V,W,X,ae,ne,ue){const Ee=[W.textOffset0,W.textOffset1],Me=cs(c,A,h,Ee,d),ve=this.collisionIndex.placeCollisionBox(Nr(v,Me.x,Me.y,w,b,this.transform.angle),V,S,P,B.predicate,ue);if((!ne||this.collisionIndex.placeCollisionBox(Nr(ne,Me.x,Me.y,w,b,this.transform.angle),V,S,P,B.predicate,ue).box.length!==0)&&ve.box.length>0){let je;if(this.prevPlacement&&this.prevPlacement.variableOffsets[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID].text&&(je=this.prevPlacement.variableOffsets[W.crossTileID].anchor),W.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[W.crossTileID]={textOffset:Ee,width:A,height:h,anchor:c,textBoxScale:d,prevAnchor:je},this.markUsedJustification(X,c,W,ae),X.allowVerticalPlacement&&(this.markUsedOrientation(X,ae,W),this.placedOrientations[W.crossTileID]=ae),{shift:Me,placedGlyphBoxes:ve}}}placeLayerBucketPart(c,v,A){const{bucket:h,layout:d,posMatrix:w,textLabelPlaneMatrix:b,labelToScreenMatrix:S,textPixelRatio:P,holdingForFade:B,collisionBoxArray:V,partiallyEvaluatedTextSize:W,collisionGroup:X}=c.parameters,ae=d.get("text-optional"),ne=d.get("icon-optional"),ue=o.getOverlapMode(d,"text-overlap","text-allow-overlap"),Ee=ue==="always",Me=o.getOverlapMode(d,"icon-overlap","icon-allow-overlap"),ve=Me==="always",je=d.get("text-rotation-alignment")==="map",Se=d.get("text-pitch-alignment")==="map",$e=d.get("icon-text-fit")!=="none",xe=d.get("symbol-z-order")==="viewport-y",y=Ee&&(ve||!h.hasIconData()||ne),m=ve&&(Ee||!h.hasTextData()||ae);!h.collisionArrays&&V&&h.deserializeCollisionBoxes(V);const x=(E,I)=>{if(v[E.crossTileID])return;if(B)return void(this.placements[E.crossTileID]=new $s(!1,!1,!1));let R=!1,O=!1,U=!0,q=null,ee={box:null,offscreen:null},le={box:null,offscreen:null},de=null,Be=null,He=null,ze=0,Je=0,ft=0;I.textFeatureIndex?ze=I.textFeatureIndex:E.useRuntimeCollisionCircles&&(ze=E.featureIndex),I.verticalTextFeatureIndex&&(Je=I.verticalTextFeatureIndex);const ct=this.retainedQueryData[h.bucketInstanceId].tileID,st=this.terrain?(zt,gt)=>this.terrain.getElevation(ct,zt,gt):null;for(const zt of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const gt=I[zt];gt&&(gt.elevation=st?st(gt.anchorPointX,gt.anchorPointY):0)}const ot=I.textBox;if(ot){const zt=vt=>{let kn=o.WritingMode.horizontal;if(h.allowVerticalPlacement&&!vt&&this.prevPlacement){const wn=this.prevPlacement.placedOrientations[E.crossTileID];wn&&(this.placedOrientations[E.crossTileID]=wn,kn=wn,this.markUsedOrientation(h,kn,E))}return kn},gt=(vt,kn)=>{if(h.allowVerticalPlacement&&E.numVerticalGlyphVertices>0&&I.verticalTextBox){for(const wn of h.writingModes)if(wn===o.WritingMode.vertical?(ee=kn(),le=ee):ee=vt(),ee&&ee.box&&ee.box.length)break}else ee=vt()};if(d.get("text-variable-anchor")){let vt=d.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[E.crossTileID]){const mn=this.prevPlacement.variableOffsets[E.crossTileID];vt.indexOf(mn.anchor)>0&&(vt=vt.filter(_n=>_n!==mn.anchor),vt.unshift(mn.anchor))}const kn=(mn,_n,En)=>{const Rn=mn.x2-mn.x1,lr=mn.y2-mn.y1,In=E.textBoxScale,Sr=$e&&Me==="never"?_n:null;let Xr={box:[],offscreen:!1};const ll=ue!=="never"?2*vt.length:vt.length;for(let Mu=0;Mu<ll;++Mu){const Xf=this.attemptAnchorPlacement(vt[Mu%vt.length],mn,Rn,lr,In,je,Se,P,w,X,Mu>=vt.length?ue:"never",E,h,En,Sr,st);if(Xf&&(Xr=Xf.placedGlyphBoxes,Xr&&Xr.box&&Xr.box.length)){R=!0,q=Xf.shift;break}}return Xr};gt(()=>kn(ot,I.iconBox,o.WritingMode.horizontal),()=>{const mn=I.verticalTextBox;return h.allowVerticalPlacement&&!(ee&&ee.box&&ee.box.length)&&E.numVerticalGlyphVertices>0&&mn?kn(mn,I.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),ee&&(R=ee.box,U=ee.offscreen);const wn=zt(ee&&ee.box);if(!R&&this.prevPlacement){const mn=this.prevPlacement.variableOffsets[E.crossTileID];mn&&(this.variableOffsets[E.crossTileID]=mn,this.markUsedJustification(h,mn.anchor,E,wn))}}else{const vt=(kn,wn)=>{const mn=this.collisionIndex.placeCollisionBox(kn,ue,P,w,X.predicate,st);return mn&&mn.box&&mn.box.length&&(this.markUsedOrientation(h,wn,E),this.placedOrientations[E.crossTileID]=wn),mn};gt(()=>vt(ot,o.WritingMode.horizontal),()=>{const kn=I.verticalTextBox;return h.allowVerticalPlacement&&E.numVerticalGlyphVertices>0&&kn?vt(kn,o.WritingMode.vertical):{box:null,offscreen:null}}),zt(ee&&ee.box&&ee.box.length)}}if(de=ee,R=de&&de.box&&de.box.length>0,U=de&&de.offscreen,E.useRuntimeCollisionCircles){const zt=h.text.placedSymbolArray.get(E.centerJustifiedTextSymbolIndex),gt=o.evaluateSizeForFeature(h.textSizeData,W,zt),vt=d.get("text-padding");Be=this.collisionIndex.placeCollisionCircles(ue,zt,h.lineVertexArray,h.glyphOffsetArray,gt,w,b,S,A,Se,X.predicate,E.collisionCircleDiameter,vt,st),Be.circles.length&&Be.collisionDetected&&!A&&o.warnOnce("Collisions detected, but collision boxes are not shown"),R=Ee||Be.circles.length>0&&!Be.collisionDetected,U=U&&Be.offscreen}if(I.iconFeatureIndex&&(ft=I.iconFeatureIndex),I.iconBox){const zt=gt=>{const vt=$e&&q?Nr(gt,q.x,q.y,je,Se,this.transform.angle):gt;return this.collisionIndex.placeCollisionBox(vt,Me,P,w,X.predicate,st)};le&&le.box&&le.box.length&&I.verticalIconBox?(He=zt(I.verticalIconBox),O=He.box.length>0):(He=zt(I.iconBox),O=He.box.length>0),U=U&&He.offscreen}const et=ae||E.numHorizontalGlyphVertices===0&&E.numVerticalGlyphVertices===0,Gt=ne||E.numIconVertices===0;if(et||Gt?Gt?et||(O=O&&R):R=O&&R:O=R=O&&R,R&&de&&de.box&&this.collisionIndex.insertCollisionBox(de.box,ue,d.get("text-ignore-placement"),h.bucketInstanceId,le&&le.box&&Je?Je:ze,X.ID),O&&He&&this.collisionIndex.insertCollisionBox(He.box,Me,d.get("icon-ignore-placement"),h.bucketInstanceId,ft,X.ID),Be&&(R&&this.collisionIndex.insertCollisionCircles(Be.circles,ue,d.get("text-ignore-placement"),h.bucketInstanceId,ze,X.ID),A)){const zt=h.bucketInstanceId;let gt=this.collisionCircleArrays[zt];gt===void 0&&(gt=this.collisionCircleArrays[zt]=new ji);for(let vt=0;vt<Be.circles.length;vt+=4)gt.circles.push(Be.circles[vt+0]),gt.circles.push(Be.circles[vt+1]),gt.circles.push(Be.circles[vt+2]),gt.circles.push(Be.collisionDetected?1:0)}if(E.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[E.crossTileID]=new $s(R||y,O||m,U||h.justReloaded),v[E.crossTileID]=!0};if(xe){if(c.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const E=h.getSortedSymbolIndexes(this.transform.angle);for(let I=E.length-1;I>=0;--I){const R=E[I];x(h.symbolInstances.get(R),h.collisionArrays[R])}}else for(let E=c.symbolInstanceStart;E<c.symbolInstanceEnd;E++)x(h.symbolInstances.get(E),h.collisionArrays[E]);if(A&&h.bucketInstanceId in this.collisionCircleArrays){const E=this.collisionCircleArrays[h.bucketInstanceId];o.invert(E.invProjMatrix,w),E.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}markUsedJustification(c,v,A,h){let d;d=h===o.WritingMode.vertical?A.verticalPlacedTextSymbolIndex:{left:A.leftJustifiedTextSymbolIndex,center:A.centerJustifiedTextSymbolIndex,right:A.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(v)];const w=[A.leftJustifiedTextSymbolIndex,A.centerJustifiedTextSymbolIndex,A.rightJustifiedTextSymbolIndex,A.verticalPlacedTextSymbolIndex];for(const b of w)b>=0&&(c.text.placedSymbolArray.get(b).crossTileID=d>=0&&b!==d?0:A.crossTileID)}markUsedOrientation(c,v,A){const h=v===o.WritingMode.horizontal||v===o.WritingMode.horizontalOnly?v:0,d=v===o.WritingMode.vertical?v:0,w=[A.leftJustifiedTextSymbolIndex,A.centerJustifiedTextSymbolIndex,A.rightJustifiedTextSymbolIndex];for(const b of w)c.text.placedSymbolArray.get(b).placedOrientation=h;A.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(A.verticalPlacedTextSymbolIndex).placedOrientation=d)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const v=this.prevPlacement;let A=!1;this.prevZoomAdjustment=v?v.zoomAdjustment(this.transform.zoom):0;const h=v?v.symbolFadeChange(c):1,d=v?v.opacities:{},w=v?v.variableOffsets:{},b=v?v.placedOrientations:{};for(const S in this.placements){const P=this.placements[S],B=d[S];B?(this.opacities[S]=new Xn(B,h,P.text,P.icon),A=A||P.text!==B.text.placed||P.icon!==B.icon.placed):(this.opacities[S]=new Xn(null,h,P.text,P.icon,P.skipFade),A=A||P.text||P.icon)}for(const S in d){const P=d[S];if(!this.opacities[S]){const B=new Xn(P,h,!1,!1);B.isHidden()||(this.opacities[S]=B,A=A||P.text.placed||P.icon.placed)}}for(const S in w)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=w[S]);for(const S in b)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=b[S]);if(v&&v.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");A?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=v?v.lastPlacementChangeTime:c)}updateLayerOpacities(c,v){const A={};for(const h of v){const d=h.getBucket(c);d&&h.latestFeatureIndex&&c.id===d.layerIds[0]&&this.updateBucketOpacities(d,A,h.collisionBoxArray)}}updateBucketOpacities(c,v,A){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const h=c.layers[0].layout,d=new Xn(null,0,!1,!1,!0),w=h.get("text-allow-overlap"),b=h.get("icon-allow-overlap"),S=h.get("text-variable-anchor"),P=h.get("text-rotation-alignment")==="map",B=h.get("text-pitch-alignment")==="map",V=h.get("icon-text-fit")!=="none",W=new Xn(null,0,w&&(b||!c.hasIconData()||h.get("icon-optional")),b&&(w||!c.hasTextData()||h.get("text-optional")),!0);!c.collisionArrays&&A&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(A);const X=(ae,ne,ue)=>{for(let Ee=0;Ee<ne/4;Ee++)ae.opacityVertexArray.emplaceBack(ue)};for(let ae=0;ae<c.symbolInstances.length;ae++){const ne=c.symbolInstances.get(ae),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:Ee,crossTileID:Me}=ne;let ve=this.opacities[Me];v[Me]?ve=d:ve||(ve=W,this.opacities[Me]=ve),v[Me]=!0;const je=ne.numIconVertices>0,Se=this.placedOrientations[ne.crossTileID],$e=Se===o.WritingMode.vertical,xe=Se===o.WritingMode.horizontal||Se===o.WritingMode.horizontalOnly;if(ue>0||Ee>0){const y=Ie(ve.text);X(c.text,ue,$e?qe:y),X(c.text,Ee,xe?qe:y);const m=ve.text.isHidden();[ne.rightJustifiedTextSymbolIndex,ne.centerJustifiedTextSymbolIndex,ne.leftJustifiedTextSymbolIndex].forEach(I=>{I>=0&&(c.text.placedSymbolArray.get(I).hidden=m||$e?1:0)}),ne.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(ne.verticalPlacedTextSymbolIndex).hidden=m||xe?1:0);const x=this.variableOffsets[ne.crossTileID];x&&this.markUsedJustification(c,x.anchor,ne,Se);const E=this.placedOrientations[ne.crossTileID];E&&(this.markUsedJustification(c,"left",ne,E),this.markUsedOrientation(c,E,ne))}if(je){const y=Ie(ve.icon),m=!(V&&ne.verticalPlacedIconSymbolIndex&&$e);ne.placedIconSymbolIndex>=0&&(X(c.icon,ne.numIconVertices,m?y:qe),c.icon.placedSymbolArray.get(ne.placedIconSymbolIndex).hidden=ve.icon.isHidden()),ne.verticalPlacedIconSymbolIndex>=0&&(X(c.icon,ne.numVerticalIconVertices,m?qe:y),c.icon.placedSymbolArray.get(ne.verticalPlacedIconSymbolIndex).hidden=ve.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const y=c.collisionArrays[ae];if(y){let m=new o.pointGeometry(0,0);if(y.textBox||y.verticalTextBox){let E=!0;if(S){const I=this.variableOffsets[Me];I?(m=cs(I.anchor,I.width,I.height,I.textOffset,I.textBoxScale),P&&m._rotate(B?this.transform.angle:-this.transform.angle)):E=!1}y.textBox&&Q(c.textCollisionBox.collisionVertexArray,ve.text.placed,!E||$e,m.x,m.y),y.verticalTextBox&&Q(c.textCollisionBox.collisionVertexArray,ve.text.placed,!E||xe,m.x,m.y)}const x=!!(!xe&&y.verticalIconBox);y.iconBox&&Q(c.iconCollisionBox.collisionVertexArray,ve.icon.placed,x,V?m.x:0,V?m.y:0),y.verticalIconBox&&Q(c.iconCollisionBox.collisionVertexArray,ve.icon.placed,!x,V?m.x:0,V?m.y:0)}}}if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.text.opacityVertexArray.length!==c.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${c.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${c.text.layoutVertexArray.length}) / 4`);if(c.icon.opacityVertexArray.length!==c.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${c.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${c.icon.layoutVertexArray.length}) / 4`);if(c.bucketInstanceId in this.collisionCircleArrays){const ae=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=ae.invProjMatrix,c.placementViewportMatrix=ae.viewportMatrix,c.collisionCircleArray=ae.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,v){const A=this.zoomAtLastRecencyCheck===v?1-this.zoomAdjustment(v):1;return this.zoomAtLastRecencyCheck=v,this.commitTime+this.fadeDuration*A>c}setStale(){this.stale=!0}}function Q(L,c,v,A,h){L.emplaceBack(c?1:0,v?1:0,A||0,h||0),L.emplaceBack(c?1:0,v?1:0,A||0,h||0),L.emplaceBack(c?1:0,v?1:0,A||0,h||0),L.emplaceBack(c?1:0,v?1:0,A||0,h||0)}const te=Math.pow(2,25),fe=Math.pow(2,24),a=Math.pow(2,17),G=Math.pow(2,16),Le=Math.pow(2,9),ke=Math.pow(2,8),Pe=Math.pow(2,1);function Ie(L){if(L.opacity===0&&!L.placed)return 0;if(L.opacity===1&&L.placed)return 4294967295;const c=L.placed?1:0,v=Math.floor(127*L.opacity);return v*te+c*fe+v*a+c*G+v*Le+c*ke+v*Pe+c}const qe=0;class At{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&!c.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,v,A,h,d){const w=this._bucketParts;for(;this._currentTileIndex<c.length;)if(v.getBucketParts(w,h,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((b,S)=>b.sortKey-S.sortKey));this._currentPartIndex<w.length;)if(v.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,A),this._currentPartIndex++,d())return!0;return!1}}class Qe{constructor(c,v,A,h,d,w,b,S){this.placement=new K(c,v,w,b,S),this._currentPlacementIndex=A.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=d,this._done=!1}isDone(){return this._done}continuePlacement(c,v,A){const h=o.exported.now(),d=()=>{const w=o.exported.now()-h;return!this._forceFullPlacement&&w>2};for(;this._currentPlacementIndex>=0;){const w=v[c[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=b)&&(!w.maxzoom||w.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new At(w)),this._inProgressLayer.continuePlacement(A[w.source],this.placement,this._showCollisionBoxes,w,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const dt=512/o.EXTENT/2;class Dt{constructor(c,v,A){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=A;for(let h=0;h<v.length;h++){const d=v.get(h),w=d.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:d.crossTileID,coord:this.getScaledCoordinates(d,c)})}}getScaledCoordinates(c,v){const A=dt/Math.pow(2,v.canonical.z-this.tileID.canonical.z);return{x:Math.floor((v.canonical.x*o.EXTENT+c.anchorX)*A),y:Math.floor((v.canonical.y*o.EXTENT+c.anchorY)*A)}}findMatches(c,v,A){const h=this.tileID.canonical.z<v.canonical.z?1:Math.pow(2,this.tileID.canonical.z-v.canonical.z);for(let d=0;d<c.length;d++){const w=c.get(d);if(w.crossTileID)continue;const b=this.indexedSymbolInstances[w.key];if(!b)continue;const S=this.getScaledCoordinates(w,v);for(const P of b)if(Math.abs(P.coord.x-S.x)<=h&&Math.abs(P.coord.y-S.y)<=h&&!A[P.crossTileID]){A[P.crossTileID]=!0,w.crossTileID=P.crossTileID;break}}}}class Rt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class sn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const v=Math.round((c-this.lng)/360);if(v!==0)for(const A in this.indexes){const h=this.indexes[A],d={};for(const w in h){const b=h[w];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+v),d[b.tileID.key]=b}this.indexes[A]=d}this.lng=c}addBucket(c,v,A){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===v.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let d=0;d<v.symbolInstances.length;d++)v.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const h=this.usedCrossTileIDs[c.overscaledZ];for(const d in this.indexes){const w=this.indexes[d];if(Number(d)>c.overscaledZ)for(const b in w){const S=w[b];S.tileID.isChildOf(c)&&S.findMatches(v.symbolInstances,c,h)}else{const b=w[c.scaledTo(Number(d)).key];b&&b.findMatches(v.symbolInstances,c,h)}}for(let d=0;d<v.symbolInstances.length;d++){const w=v.symbolInstances.get(d);w.crossTileID||(w.crossTileID=A.generate(),h[w.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Dt(c,v.symbolInstances,v.bucketInstanceId),!0}removeBucketCrossTileIDs(c,v){for(const A in v.indexedSymbolInstances)for(const h of v.indexedSymbolInstances[A])delete this.usedCrossTileIDs[c][h.crossTileID]}removeStaleBuckets(c){let v=!1;for(const A in this.indexes){const h=this.indexes[A];for(const d in h)c[h[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(A,h[d]),delete h[d],v=!0)}return v}}class jt{constructor(){this.layerIndexes={},this.crossTileIDs=new Rt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,v,A){let h=this.layerIndexes[c.id];h===void 0&&(h=this.layerIndexes[c.id]=new sn);let d=!1;const w={};h.handleWrapJump(A);for(const b of v){const S=b.getBucket(c);S&&c.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(b.tileID,S,this.crossTileIDs)&&(d=!0),w[S.bucketInstanceId]=!0)}return h.removeStaleBuckets(w)&&(d=!0),d}pruneUnusedLayers(c){const v={};c.forEach(A=>{v[A]=!0});for(const A in this.layerIndexes)v[A]||delete this.layerIndexes[A]}}var pn=o.createLayout([{name:"a_pos",type:"Int16",components:2}]);class qt extends o.Evented{constructor(c){super(),this.sourceCache=c,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=c._cache.max,c.usedForTerrain=!0,c.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const c in this._tiles){const v=this._tiles[c];v.textures.forEach(A=>A.destroy()),v.textures=[]}}update(c,v){this.sourceCache.update(c,v),this._renderableTilesKeys=[];for(const A of c.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:v}))this._renderableTilesKeys.push(A.key),this._tiles[A.key]||(A.posMatrix=new Float64Array(16),o.ortho(A.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),this._tiles[A.key]=new pr(A,this.tileSize))}removeOutdated(c){const v={};this.renderHistory=this.renderHistory.filter((A,h)=>this.renderHistory.indexOf(A)===h).slice(0,this.renderHistorySize);for(const A of this._renderableTilesKeys)v[A]=!0;for(const A of this.renderHistory)v[A]=!0;for(const A in this._tiles)v[A]||(this._tiles[A].clearTextures(c),delete this._tiles[A])}getRenderableTiles(){return this._renderableTilesKeys.map(c=>this.getTileByID(c))}getTileByID(c){return this._tiles[c]}getTerrainCoords(c){const v={};for(const A of this._renderableTilesKeys){const h=this._tiles[A].tileID;if(h.canonical.equals(c.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16),o.ortho(d.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),v[A]=d}else if(h.canonical.isChildOf(c.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16);const w=h.canonical.z-c.canonical.z,b=h.canonical.x-(h.canonical.x>>w<<w),S=h.canonical.y-(h.canonical.y>>w<<w),P=o.EXTENT>>w;o.ortho(d.posMatrix,0,P,0,P,0,1),o.translate(d.posMatrix,d.posMatrix,[-b*P,-S*P,0]),v[A]=d}else if(c.canonical.isChildOf(h.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16);const w=c.canonical.z-h.canonical.z,b=c.canonical.x-(c.canonical.x>>w<<w),S=c.canonical.y-(c.canonical.y>>w<<w),P=o.EXTENT>>w;o.ortho(d.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),o.translate(d.posMatrix,d.posMatrix,[b*P,S*P,0]),o.scale(d.posMatrix,d.posMatrix,[1/2**w,1/2**w,0]),v[A]=d}}return v}getSourceTile(c,v){const A=this.sourceCache._source;let h=c.overscaledZ-this.deltaZoom;if(h>A.maxzoom&&(h=A.maxzoom),h<A.minzoom)return null;this._sourceTileCache[c.key]||(this._sourceTileCache[c.key]=c.scaledTo(h).key);let d=this.sourceCache.getTileByID(this._sourceTileCache[c.key]);if((!d||!d.dem)&&v)for(;h>=A.minzoom&&(!d||!d.dem);)d=this.sourceCache.getTileByID(c.scaledTo(h--).key);return d}tilesAfterTime(c=Date.now()){return Object.values(this._tiles).filter(v=>v.timeLoaded>=c)}}class an{constructor(c,v,A){this.style=c,this.sourceCache=new qt(v),this.options=A,this.exaggeration=typeof A.exaggeration=="number"?A.exaggeration:1,this.elevationOffset=typeof A.elevationOffset=="number"?A.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(c,v,A,h=o.EXTENT){if(!(v>=0&&v<h&&A>=0&&A<h))return this.elevationOffset;let d=0;const w=this.getTerrainData(c);if(w.tile&&w.tile.dem){const b=o.transformMat4$1([],[v/h*o.EXTENT,A/h*o.EXTENT],w.u_terrain_matrix),S=[b[0]*w.tile.dem.dim,b[1]*w.tile.dem.dim],P=[Math.floor(S[0]),Math.floor(S[1])],B=w.tile.dem.get(P[0],P[1]),V=w.tile.dem.get(P[0],P[1]+1),W=w.tile.dem.get(P[0]+1,P[1]),X=w.tile.dem.get(P[0]+1,P[1]+1);d=o.number(o.number(B,V,S[0]-P[0]),o.number(W,X,S[0]-P[0]),S[1]-P[1])}return d}rememberForRerender(c,v){for(const A in this.sourceCache._tiles){const h=this.sourceCache._tiles[A];(h.tileID.equals(v)||h.tileID.isChildOf(v))&&(c===this.sourceCache.sourceCache.id&&(h.timeLoaded=Date.now()),this._rerender[c]=this._rerender[c]||{},this._rerender[c][h.tileID.key]=!0)}}needsRerender(c,v){return this._rerender[c]&&this._rerender[c][v.key]}clearRerenderCache(){this._rerender={}}getElevation(c,v,A,h=o.EXTENT){return(this.getDEMElevation(c,v,A,h)+this.elevationOffset)*this.exaggeration}getTerrainData(c){if(!this._emptyDemTexture){const h=this.style.map.painter.context,d=new o.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new H(h,d,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new H(h,new o.RGBAImage({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.identity([])}const v=this.sourceCache.getSourceTile(c,!0);if(v&&v.dem&&(!v.demTexture||v.needsTerrainPrepare)){const h=this.style.map.painter.context;v.demTexture=this.style.map.painter.getTileTexture(v.dem.stride),v.demTexture?v.demTexture.update(v.dem.getPixels(),{premultiply:!1}):v.demTexture=new H(h,v.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),v.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),v.needsTerrainPrepare=!1}const A=v&&v+v.tileID.key+c.key;if(A&&!this._demMatrixCache[A]){const h=this.sourceCache.sourceCache._source.maxzoom;let d=c.canonical.z-v.tileID.canonical.z;c.overscaledZ>c.canonical.z&&(c.canonical.z>=h?d=c.canonical.z-h:o.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=c.canonical.x-(c.canonical.x>>d<<d),b=c.canonical.y-(c.canonical.y>>d<<d),S=o.fromScaling(new Float64Array(16),[1/(o.EXTENT<<d),1/(o.EXTENT<<d),0]);o.translate(S,S,[w*o.EXTENT,b*o.EXTENT,0]),this._demMatrixCache[c.key]={matrix:S,coord:c}}return{u_depth:2,u_terrain:3,u_terrain_dim:v&&v.dem&&v.dem.dim||1,u_terrain_matrix:A?this._demMatrixCache[c.key].matrix:this._emptyDemMatrix,u_terrain_unpack:v&&v.dem&&v.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(v&&v.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:v}}getRTTFramebuffer(){const c=this.style.map.painter;if(!this._rttFramebuffer){const v=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=c.context.createFramebuffer(v,v,!0),this._rttFramebuffer.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,v,v))}return this._rttFramebuffer}getFramebuffer(c){const v=this.style.map.painter,A=v.width/devicePixelRatio,h=v.height/devicePixelRatio;return!this._fbo||this._fbo.width===A&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new H(v.context,{width:A,height:h,data:null},v.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(v.context.gl.NEAREST,v.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new H(v.context,{width:A,height:h,data:null},v.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(v.context.gl.NEAREST,v.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=v.context.createFramebuffer(A,h,!0),this._fbo.depthAttachment.set(v.context.createRenderbuffer(v.context.gl.DEPTH_COMPONENT16,A,h))),this._fbo.colorAttachment.set(c==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const c=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const v=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let d=0,w=0;d<this._coordsTextureSize;d++)for(let b=0;b<this._coordsTextureSize;b++,w+=4)v[w+0]=255&b,v[w+1]=255&d,v[w+2]=b>>8<<4|d>>8,v[w+3]=0;const A=new o.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(v.buffer)),h=new H(c,A,c.gl.RGBA,{premultiply:!1});return h.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(c){const v=new Uint8Array(4),A=this.style.map.painter,h=A.context,d=h.gl;h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(c.x,A.height/devicePixelRatio-c.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,v),h.bindFramebuffer.set(null);const w=v[0]+(v[2]>>4<<8),b=v[1]+((15&v[2])<<8),S=this.coordsIndex[255-v[3]],P=S&&this.sourceCache.getTileByID(S);if(!P)return null;const B=this._coordsTextureSize,V=(1<<P.tileID.canonical.z)*B;return new o.MercatorCoordinate((P.tileID.canonical.x*B+w)/V,(P.tileID.canonical.y*B+b)/V,this.getElevation(P.tileID,w,b,B))}getTerrainMesh(){if(this._mesh)return this._mesh;const c=this.style.map.painter.context,v=new o.PosArray,A=new o.TriangleIndexArray,h=this.meshSize,d=o.EXTENT/h,w=h*h;for(let b=0;b<=h;b++)for(let S=0;S<=h;S++)v.emplaceBack(S*d,b*d);for(let b=0;b<w;b+=h+1)for(let S=0;S<h;S++)A.emplaceBack(S+b,h+S+b+1,h+S+b+2),A.emplaceBack(S+b,h+S+b+2,S+b+1);return this._mesh={indexBuffer:c.createIndexBuffer(A),vertexBuffer:c.createVertexBuffer(v,pn.members),segments:o.SegmentVector.simpleSegment(0,0,v.length,A.length)},this._mesh}getMinMaxElevation(c){const v=this.getTerrainData(c).tile,A={minElevation:null,maxElevation:null};return v&&v.dem&&(A.minElevation=(v.dem.min+this.elevationOffset)*this.exaggeration,A.maxElevation=(v.dem.max+this.elevationOffset)*this.exaggeration),A}}const xn=(L,c)=>o.emitValidationErrors(L,c&&c.filter(v=>v.identifier!=="source.canvas")),Ft=o.pick($n,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ne=o.pick($n,["setCenter","setZoom","setBearing","setPitch"]),Mt=function(){const L={},c=o.spec.$version;for(const v in o.spec.$root){const A=o.spec.$root[v];if(A.required){let h=null;h=v==="version"?c:A.type==="array"?[]:{},h!=null&&(L[v]=h)}}return L}();class Ce extends o.Evented{constructor(c,v={}){super(),this.map=c,this.dispatcher=new rt(cr(),this),this.imageManager=new Y,this.imageManager.setEventedParent(this),this.glyphManager=new pe(c._requestManager,v.localIdeographFontFamily),this.lineAtlas=new Xe(256,512),this.crossTileSymbolIndex=new jt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const A=this;this._rtlTextPluginCallback=Ce.registerForPluginStateChange(h=>{A.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:h.pluginStatus,pluginURL:h.pluginURL},(d,w)=>{if(o.triggerPluginCompletionEvent(d),w&&w.every(b=>b))for(const b in A.sourceCaches)A.sourceCaches[b].reload()})}),this.on("data",h=>{if(h.dataType!=="source"||h.sourceDataType!=="metadata")return;const d=this.sourceCaches[h.sourceId];if(!d)return;const w=d.getSource();if(w&&w.vectorLayerIds)for(const b in this._layers){const S=this._layers[b];S.source===w.id&&this._validateLayer(S)}})}loadURL(c,v={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const A=typeof v.validate!="boolean"||v.validate,h=this.map._requestManager.transformRequest(c,o.ResourceType.Style);this._request=o.getJSON(h,(d,w)=>{this._request=null,d?this.fire(new o.ErrorEvent(d)):w&&this._load(w,A)})}loadJSON(c,v={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(c,v.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Mt,!1)}_load(c,v){if(v&&xn(this,o.validateStyle(c)))return;this._loaded=!0,this.stylesheet=c;for(const h in c.sources)this.addSource(h,c.sources[h],{validate:!1});c.sprite?this._loadSprite(c.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(c.glyphs);const A=ni(this.stylesheet.layers);this._order=A.map(h=>h.id),this._layers={},this._serializedLayers={};for(let h of A)h=o.createStyleLayer(h),h.setEventedParent(this,{layer:{id:h.id}}),this._layers[h.id]=h,this._serializedLayers[h.id]=h.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new We(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}_loadSprite(c){this._spriteRequest=function(v,A,h,d){let w,b,S;const P=h>1?"@2x":"";let B=o.getJSON(A.transformRequest(A.normalizeSpriteURL(v,P,".json"),o.ResourceType.SpriteJSON),(X,ae)=>{B=null,S||(S=X,w=ae,W())}),V=o.getImage(A.transformRequest(A.normalizeSpriteURL(v,P,".png"),o.ResourceType.SpriteImage),(X,ae)=>{V=null,S||(S=X,b=ae,W())});function W(){if(S)d(S);else if(w&&b){const X=o.exported.getImageData(b),ae={};for(const ne in w){const{width:ue,height:Ee,x:Me,y:ve,sdf:je,pixelRatio:Se,stretchX:$e,stretchY:xe,content:y}=w[ne],m=new o.RGBAImage({width:ue,height:Ee});o.RGBAImage.copy(X,m,{x:Me,y:ve},{x:0,y:0},{width:ue,height:Ee}),ae[ne]={data:m,pixelRatio:Se,sdf:je,stretchX:$e,stretchY:xe,content:y}}d(null,ae)}}return{cancel(){B&&(B.cancel(),B=null),V&&(V.cancel(),V=null)}}}(c,this.map._requestManager,this.map.getPixelRatio(),(v,A)=>{if(this._spriteRequest=null,v)this.fire(new o.ErrorEvent(v));else if(A)for(const h in A)this.imageManager.addImage(h,A[h]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(c){const v=this.sourceCaches[c.source];if(!v)return;const A=c.sourceLayer;if(!A)return;const h=v.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(A)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${A}" does not exist on source "${h.id}" as specified by style layer "${c.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this.sourceCaches)if(!this.sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const v=[];for(const A of c){const h=this._layers[A];h.type!=="custom"&&v.push(h.serialize())}return v}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(c){if(!this._loaded)return;const v=this._changed;if(this._changed){const h=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);(h.length||d.length)&&this._updateWorkerLayers(h,d);for(const w in this._updatedSources){const b=this._updatedSources[w];if(b==="reload")this._reloadSource(w);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(w)}}this._updateTilesForChangedImages();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(c);this.light.updateTransitions(c),this._resetUpdates()}const A={};for(const h in this.sourceCaches){const d=this.sourceCaches[h];A[h]=d.used,d.used=!1}for(const h of this._order){const d=this._layers[h];d.recalculate(c,this._availableImages),!d.isHidden(c.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(const h in A){const d=this.sourceCaches[h];A[h]!==d.used&&d.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(c),this.z=c.zoom,v&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const v in this.sourceCaches)this.sourceCaches[v].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,v){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:v})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(c){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),c){const v=this.sourceCaches[c.source];if(!v)throw new Error(`cannot load terrain, because there exists no source with ID: ${c.source}`);this.terrain=new an(this,v,c),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=A=>{A.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=A=>{A.tile&&(A.sourceId===c.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(A.sourceId,A.tile.tileID)):A.source.type==="geojson"&&this.terrain.rememberForRerender(A.sourceId,A.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new o.Event("terrain",{terrain:c}))}setState(c){if(this._checkLoaded(),xn(this,o.validateStyle(c)))return!1;(c=o.clone$1(c)).layers=ni(c.layers);const v=function(h,d){if(!h)return[{command:$n.setStyle,args:[d]}];let w=[];try{if(!M(h.version,d.version))return[{command:$n.setStyle,args:[d]}];M(h.center,d.center)||w.push({command:$n.setCenter,args:[d.center]}),M(h.zoom,d.zoom)||w.push({command:$n.setZoom,args:[d.zoom]}),M(h.bearing,d.bearing)||w.push({command:$n.setBearing,args:[d.bearing]}),M(h.pitch,d.pitch)||w.push({command:$n.setPitch,args:[d.pitch]}),M(h.sprite,d.sprite)||w.push({command:$n.setSprite,args:[d.sprite]}),M(h.glyphs,d.glyphs)||w.push({command:$n.setGlyphs,args:[d.glyphs]}),M(h.transition,d.transition)||w.push({command:$n.setTransition,args:[d.transition]}),M(h.light,d.light)||w.push({command:$n.setLight,args:[d.light]});const b={},S=[];(function(B,V,W,X){let ae;for(ae in V=V||{},B=B||{})Object.prototype.hasOwnProperty.call(B,ae)&&(Object.prototype.hasOwnProperty.call(V,ae)||qn(ae,W,X));for(ae in V)Object.prototype.hasOwnProperty.call(V,ae)&&(Object.prototype.hasOwnProperty.call(B,ae)?M(B[ae],V[ae])||(B[ae].type==="geojson"&&V[ae].type==="geojson"&&vo(B,V,ae)?W.push({command:$n.setGeoJSONSourceData,args:[ae,V[ae].data]}):Gi(ae,V,W,X)):Ii(ae,V,W))})(h.sources,d.sources,S,b);const P=[];h.layers&&h.layers.forEach(B=>{b[B.source]?w.push({command:$n.removeLayer,args:[B.id]}):P.push(B)}),w=w.concat(S),function(B,V,W){V=V||[];const X=(B=B||[]).map(Li),ae=V.map(Li),ne=B.reduce(Ho,{}),ue=V.reduce(Ho,{}),Ee=X.slice(),Me=Object.create(null);let ve,je,Se,$e,xe,y,m;for(ve=0,je=0;ve<X.length;ve++)Se=X[ve],Object.prototype.hasOwnProperty.call(ue,Se)?je++:(W.push({command:$n.removeLayer,args:[Se]}),Ee.splice(Ee.indexOf(Se,je),1));for(ve=0,je=0;ve<ae.length;ve++)Se=ae[ae.length-1-ve],Ee[Ee.length-1-ve]!==Se&&(Object.prototype.hasOwnProperty.call(ne,Se)?(W.push({command:$n.removeLayer,args:[Se]}),Ee.splice(Ee.lastIndexOf(Se,Ee.length-je),1)):je++,y=Ee[Ee.length-ve],W.push({command:$n.addLayer,args:[ue[Se],y]}),Ee.splice(Ee.length-ve,0,Se),Me[Se]=!0);for(ve=0;ve<ae.length;ve++)if(Se=ae[ve],$e=ne[Se],xe=ue[Se],!Me[Se]&&!M($e,xe))if(M($e.source,xe.source)&&M($e["source-layer"],xe["source-layer"])&&M($e.type,xe.type)){for(m in $r($e.layout,xe.layout,W,Se,null,$n.setLayoutProperty),$r($e.paint,xe.paint,W,Se,null,$n.setPaintProperty),M($e.filter,xe.filter)||W.push({command:$n.setFilter,args:[Se,xe.filter]}),M($e.minzoom,xe.minzoom)&&M($e.maxzoom,xe.maxzoom)||W.push({command:$n.setLayerZoomRange,args:[Se,xe.minzoom,xe.maxzoom]}),$e)Object.prototype.hasOwnProperty.call($e,m)&&m!=="layout"&&m!=="paint"&&m!=="filter"&&m!=="metadata"&&m!=="minzoom"&&m!=="maxzoom"&&(m.indexOf("paint.")===0?$r($e[m],xe[m],W,Se,m.slice(6),$n.setPaintProperty):M($e[m],xe[m])||W.push({command:$n.setLayerProperty,args:[Se,m,xe[m]]}));for(m in xe)Object.prototype.hasOwnProperty.call(xe,m)&&!Object.prototype.hasOwnProperty.call($e,m)&&m!=="layout"&&m!=="paint"&&m!=="filter"&&m!=="metadata"&&m!=="minzoom"&&m!=="maxzoom"&&(m.indexOf("paint.")===0?$r($e[m],xe[m],W,Se,m.slice(6),$n.setPaintProperty):M($e[m],xe[m])||W.push({command:$n.setLayerProperty,args:[Se,m,xe[m]]}))}else W.push({command:$n.removeLayer,args:[Se]}),y=Ee[Ee.lastIndexOf(Se)+1],W.push({command:$n.addLayer,args:[xe,y]})}(P,d.layers,w)}catch(b){console.warn("Unable to compute style diff:",b),w=[{command:$n.setStyle,args:[d]}]}return w}(this.serialize(),c).filter(h=>!(h.command in Ne));if(v.length===0)return!1;const A=v.filter(h=>!(h.command in Ft));if(A.length>0)throw new Error(`Unimplemented: ${A.map(h=>h.command).join(", ")}.`);return v.forEach(h=>{h.command!=="setTransition"&&this[h.command].apply(this,h.args)}),this.stylesheet=c,!0}addImage(c,v){if(this.getImage(c))return this.fire(new o.ErrorEvent(new Error(`An image named "${c}" already exists.`)));this.imageManager.addImage(c,v),this._afterImageUpdated(c)}updateImage(c,v){this.imageManager.updateImage(c,v)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){if(!this.getImage(c))return this.fire(new o.ErrorEvent(new Error(`An image named "${c}" does not exist.`)));this.imageManager.removeImage(c),this._afterImageUpdated(c)}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(c,v,A={}){if(this._checkLoaded(),this.sourceCaches[c]!==void 0)throw new Error(`Source "${c}" already exists.`);if(!v.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(v).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(v.type)>=0&&this._validate(o.validateStyle.source,`sources.${c}`,v,null,A))return;this.map&&this.map._collectResourceTiming&&(v.collectResourceTiming=!0);const h=this.sourceCaches[c]=new wt(c,v,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:h.serialize(),sourceId:c})),h.onAdd(this.map),this._changed=!0}removeSource(c){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error("There is no source with this ID");for(const A in this._layers)if(this._layers[A].source===c)return this.fire(new o.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${A}" is using it.`)));const v=this.sourceCaches[c];delete this.sourceCaches[c],delete this._updatedSources[c],v.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),v.setEventedParent(null),v.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(c,v){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error(`There is no source with this ID=${c}`);const A=this.sourceCaches[c].getSource();if(A.type!=="geojson")throw new Error(`geojsonSource.type is ${A.type}, which is !== 'geojson`);A.setData(v),this._changed=!0}getSource(c){return this.sourceCaches[c]&&this.sourceCaches[c].getSource()}addLayer(c,v,A={}){this._checkLoaded();const h=c.id;if(this.getLayer(h))return void this.fire(new o.ErrorEvent(new Error(`Layer "${h}" already exists on this map.`)));let d;if(c.type==="custom"){if(xn(this,o.validateCustomStyleLayer(c)))return;d=o.createStyleLayer(c)}else{if(typeof c.source=="object"&&(this.addSource(h,c.source),c=o.clone$1(c),c=o.extend(c,{source:h})),this._validate(o.validateStyle.layer,`layers.${h}`,c,{arrayIndex:-1},A))return;d=o.createStyleLayer(c),this._validateLayer(d),d.setEventedParent(this,{layer:{id:h}}),this._serializedLayers[d.id]=d.serialize()}const w=v?this._order.indexOf(v):this._order.length;if(v&&w===-1)this.fire(new o.ErrorEvent(new Error(`Cannot add layer "${h}" before non-existing layer "${v}".`)));else{if(this._order.splice(w,0,h),this._layerOrderChanged=!0,this._layers[h]=d,this._removedLayers[h]&&d.source&&d.type!=="custom"){const b=this._removedLayers[h];delete this._removedLayers[h],b.type!==d.type?this._updatedSources[d.source]="clear":(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map)}}moveLayer(c,v){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new o.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===v)return;const A=this._order.indexOf(c);this._order.splice(A,1);const h=v?this._order.indexOf(v):this._order.length;v&&h===-1?this.fire(new o.ErrorEvent(new Error(`Cannot move layer "${c}" before non-existing layer "${v}".`))):(this._order.splice(h,0,c),this._layerOrderChanged=!0)}removeLayer(c){this._checkLoaded();const v=this._layers[c];if(!v)return void this.fire(new o.ErrorEvent(new Error(`Cannot remove non-existing layer "${c}".`)));v.setEventedParent(null);const A=this._order.indexOf(c);this._order.splice(A,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=v,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],v.onRemove&&v.onRemove(this.map)}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}setLayerZoomRange(c,v,A){this._checkLoaded();const h=this.getLayer(c);h?h.minzoom===v&&h.maxzoom===A||(v!=null&&(h.minzoom=v),A!=null&&(h.maxzoom=A),this._updateLayer(h)):this.fire(new o.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${c}".`)))}setFilter(c,v,A={}){this._checkLoaded();const h=this.getLayer(c);if(h){if(!M(h.filter,v))return v==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(o.validateStyle.filter,`layers.${h.id}.filter`,v,null,A)||(h.filter=o.clone$1(v),this._updateLayer(h)))}else this.fire(new o.ErrorEvent(new Error(`Cannot filter non-existing layer "${c}".`)))}getFilter(c){return o.clone$1(this.getLayer(c).filter)}setLayoutProperty(c,v,A,h={}){this._checkLoaded();const d=this.getLayer(c);d?M(d.getLayoutProperty(v),A)||(d.setLayoutProperty(v,A,h),this._updateLayer(d)):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getLayoutProperty(c,v){const A=this.getLayer(c);if(A)return A.getLayoutProperty(v);this.fire(new o.ErrorEvent(new Error(`Cannot get style of non-existing layer "${c}".`)))}setPaintProperty(c,v,A,h={}){this._checkLoaded();const d=this.getLayer(c);d?M(d.getPaintProperty(v),A)||(d.setPaintProperty(v,A,h)&&this._updateLayer(d),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getPaintProperty(c,v){return this.getLayer(c).getPaintProperty(v)}setFeatureState(c,v){this._checkLoaded();const A=c.source,h=c.sourceLayer,d=this.sourceCaches[A];if(d===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${A}' does not exist in the map's style.`)));const w=d.getSource().type;w==="geojson"&&h?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||h?(c.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),d.setFeatureState(h,c.id,v)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(c,v){this._checkLoaded();const A=c.source,h=this.sourceCaches[A];if(h===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${A}' does not exist in the map's style.`)));const d=h.getSource().type,w=d==="vector"?c.sourceLayer:void 0;d!=="vector"||w?v&&typeof c.id!="string"&&typeof c.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(w,c.id,v):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(c){this._checkLoaded();const v=c.source,A=c.sourceLayer,h=this.sourceCaches[v];if(h!==void 0)return h.getSource().type!=="vector"||A?(c.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),h.getFeatureState(A,c.id)):void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,c=>c.serialize()),layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&this.sourceCaches[c.source].getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(c){const v=w=>this._layers[w].type==="fill-extrusion",A={},h=[];for(let w=this._order.length-1;w>=0;w--){const b=this._order[w];if(v(b)){A[b]=w;for(const S of c){const P=S[b];if(P)for(const B of P)h.push(B)}}}h.sort((w,b)=>b.intersectionZ-w.intersectionZ);const d=[];for(let w=this._order.length-1;w>=0;w--){const b=this._order[w];if(v(b))for(let S=h.length-1;S>=0;S--){const P=h[S].feature;if(A[P.layer.id]<w)break;d.push(P),h.pop()}else for(const S of c){const P=S[b];if(P)for(const B of P)d.push(B.feature)}}return d}queryRenderedFeatures(c,v,A){v&&v.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",v.filter,null,v);const h={};if(v&&v.layers){if(!Array.isArray(v.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const w of v.layers){const b=this._layers[w];if(!b)return this.fire(new o.ErrorEvent(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];h[b.source]=!0}}const d=[];v.availableImages=this._availableImages;for(const w in this.sourceCaches)v.layers&&!h[w]||d.push(tr(this.sourceCaches[w],this._layers,this._serializedLayers,c,v,A));return this.placement&&d.push(function(w,b,S,P,B,V,W){const X={},ae=V.queryRenderedSymbols(P),ne=[];for(const ue of Object.keys(ae).map(Number))ne.push(W[ue]);ne.sort(ar);for(const ue of ne){const Ee=ue.featureIndex.lookupSymbolFeatures(ae[ue.bucketInstanceId],b,ue.bucketIndex,ue.sourceLayerIndex,B.filter,B.layers,B.availableImages,w);for(const Me in Ee){const ve=X[Me]=X[Me]||[],je=Ee[Me];je.sort((Se,$e)=>{const xe=ue.featureSortOrder;if(xe){const y=xe.indexOf(Se.featureIndex);return xe.indexOf($e.featureIndex)-y}return $e.featureIndex-Se.featureIndex});for(const Se of je)ve.push(Se)}}for(const ue in X)X[ue].forEach(Ee=>{const Me=Ee.feature,ve=S[w[ue].source].getFeatureState(Me.layer["source-layer"],Me.id);Me.source=Me.layer.source,Me.layer["source-layer"]&&(Me.sourceLayer=Me.layer["source-layer"]),Me.state=ve});return X}(this._layers,this._serializedLayers,this.sourceCaches,c,v,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(c,v){v&&v.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",v.filter,null,v);const A=this.sourceCaches[c];return A?function(h,d){const w=h.getRenderableIds().map(P=>h.getTileByID(P)),b=[],S={};for(let P=0;P<w.length;P++){const B=w[P],V=B.tileID.canonical.key;S[V]||(S[V]=!0,B.querySourceFeatures(b,d))}return b}(A,v):[]}addSourceType(c,v,A){return Ce.getSourceType(c)?A(new Error(`A source type called "${c}" already exists.`)):(Ce.setSourceType(c,v),v.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:v.workerSourceURL},A):A(null,null))}getLight(){return this.light.getLight()}setLight(c,v={}){this._checkLoaded();const A=this.light.getLight();let h=!1;for(const w in c)if(!M(c[w],A[w])){h=!0;break}if(!h)return;const d={now:o.exported.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,v),this.light.updateTransitions(d)}_validate(c,v,A,h,d={}){return(!d||d.validate!==!1)&&xn(this,c.call(o.validateStyle,o.extend({key:v,style:this.serialize(),value:A,styleSpec:o.spec},h)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this.sourceCaches){const v=this.sourceCaches[c];v.setEventedParent(null),v.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){this.sourceCaches[c].clearTiles()}_reloadSource(c){this.sourceCaches[c].resume(),this.sourceCaches[c].reload()}_updateSources(c){for(const v in this.sourceCaches)this.sourceCaches[v].update(c,this.terrain)}_generateCollisionBoxes(){for(const c in this.sourceCaches)this._reloadSource(c)}_updatePlacement(c,v,A,h,d=!1){let w=!1,b=!1;const S={};for(const P of this._order){const B=this._layers[P];if(B.type!=="symbol")continue;if(!S[B.source]){const W=this.sourceCaches[B.source];S[B.source]=W.getRenderableIds(!0).map(X=>W.getTileByID(X)).sort((X,ae)=>ae.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(ae.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(B,S[B.source],c.center.lng);w=w||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((d=d||this._layerOrderChanged||A===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),c.zoom))&&(this.pauseablePlacement=new Qe(c,this.terrain,this._order,d,v,A,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),b=!0),w&&this.pauseablePlacement.placement.setStale()),b||w)for(const P of this._order){const B=this._layers[P];B.type==="symbol"&&this.placement.updateLayerOpacities(B,S[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const c in this.sourceCaches)this.sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,v,A){this.imageManager.getImages(v.icons,A),this._updateTilesForChangedImages();const h=this.sourceCaches[v.source];h&&h.setDependencies(v.tileID.key,v.type,v.icons)}getGlyphs(c,v,A){this.glyphManager.getGlyphs(v.stacks,A)}getResource(c,v,A){return o.makeRequest(v,A)}}Ce.getSourceType=function(L){return Tn[L]},Ce.setSourceType=function(L,c){Tn[L]=c},Ce.registerForPluginStateChange=o.registerForPluginStateChange;var cn="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const fi={prelude:ir(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:ir(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:ir(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ir(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ir("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ir(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:ir(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ir("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ir("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ir("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:ir(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:ir(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:ir(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:ir(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ir(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ir(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ir(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ir(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:ir(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ir(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ir(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ir(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ir(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:ir(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ir(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ir(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ir("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",cn),terrainDepth:ir("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",cn),terrainCoords:ir("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",cn)};function ir(L,c){const v=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,A=c.match(/attribute ([\w]+) ([\w]+)/g),h=L.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=d?d.concat(h):h,b={};return{fragmentSource:L=L.replace(v,(S,P,B,V,W)=>(b[W]=!0,P==="define"?`
#ifndef HAS_UNIFORM_u_${W}
varying ${B} ${V} ${W};
#else
uniform ${B} ${V} u_${W};
#endif
`:`
#ifdef HAS_UNIFORM_u_${W}
    ${B} ${V} ${W} = u_${W};
#endif
`)),vertexSource:c=c.replace(v,(S,P,B,V,W)=>{const X=V==="float"?"vec2":"vec4",ae=W.match(/color/)?"color":X;return b[W]?P==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
attribute ${B} ${X} a_${W};
varying ${B} ${V} ${W};
#else
uniform ${B} ${V} u_${W};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = a_${W};
#else
    ${B} ${V} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = unpack_mix_${ae}(a_${W}, u_${W}_t);
#else
    ${B} ${V} ${W} = u_${W};
#endif
`:P==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
attribute ${B} ${X} a_${W};
#else
uniform ${B} ${V} u_${W};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${B} ${V} ${W} = a_${W};
#else
    ${B} ${V} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${B} ${V} ${W} = unpack_mix_${ae}(a_${W}, u_${W}_t);
#else
    ${B} ${V} ${W} = u_${W};
#endif
`}),staticAttributes:A,staticUniforms:w}}class pa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(c,v,A,h,d,w,b,S,P){this.context=c;let B=this.boundPaintVertexBuffers.length!==h.length;for(let V=0;!B&&V<h.length;V++)this.boundPaintVertexBuffers[V]!==h[V]&&(B=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===v&&this.boundLayoutVertexBuffer===A&&!B&&this.boundIndexBuffer===d&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===b&&this.boundDynamicVertexBuffer2===S&&this.boundDynamicVertexBuffer3===P?(c.bindVertexArrayOES.set(this.vao),b&&b.bind(),d&&d.dynamicDraw&&d.bind(),S&&S.bind(),P&&P.bind()):this.freshBind(v,A,h,d,w,b,S,P)}freshBind(c,v,A,h,d,w,b,S){let P;const B=c.numAttributes,V=this.context,W=V.gl;if(V.extVertexArrayObject)this.vao&&this.destroy(),this.vao=V.extVertexArrayObject.createVertexArrayOES(),V.bindVertexArrayOES.set(this.vao),P=0,this.boundProgram=c,this.boundLayoutVertexBuffer=v,this.boundPaintVertexBuffers=A,this.boundIndexBuffer=h,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=S;else{P=V.currentNumAttributes||0;for(let X=B;X<P;X++)W.disableVertexAttribArray(X)}v.enableAttributes(W,c);for(const X of A)X.enableAttributes(W,c);w&&w.enableAttributes(W,c),b&&b.enableAttributes(W,c),S&&S.enableAttributes(W,c),v.bind(),v.setVertexAttribPointers(W,c,d);for(const X of A)X.bind(),X.setVertexAttribPointers(W,c,d);w&&(w.bind(),w.setVertexAttribPointers(W,c,d)),h&&h.bind(),b&&(b.bind(),b.setVertexAttribPointers(W,c,d)),S&&(S.bind(),S.setVertexAttribPointers(W,c,d)),V.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Re(L){const c=[];for(let v=0;v<L.length;v++){if(L[v]===null)continue;const A=L[v].split(" ");c.push(A.pop())}return c}class Qa{constructor(c,v,A,h,d,w,b){const S=c.gl;this.program=S.createProgram();const P=Re(A.staticAttributes),B=h?h.getBinderAttributes():[],V=P.concat(B),W=fi.prelude.staticUniforms?Re(fi.prelude.staticUniforms):[],X=A.staticUniforms?Re(A.staticUniforms):[],ae=h?h.getBinderUniforms():[],ne=W.concat(X).concat(ae),ue=[];for(const xe of ne)ue.indexOf(xe)<0&&ue.push(xe);const Ee=h?h.defines():[];w&&Ee.push("#define OVERDRAW_INSPECTOR;"),b&&Ee.push("#define TERRAIN3D;");const Me=Ee.concat(fi.prelude.fragmentSource,A.fragmentSource).join(`
`),ve=Ee.concat(fi.prelude.vertexSource,A.vertexSource).join(`
`),je=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(je,Me),S.compileShader(je),S.attachShader(this.program,je);const Se=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(Se,ve),S.compileShader(Se),S.attachShader(this.program,Se),this.attributes={};const $e={};this.numAttributes=V.length;for(let xe=0;xe<this.numAttributes;xe++)V[xe]&&(S.bindAttribLocation(this.program,xe,V[xe]),this.attributes[V[xe]]=xe);S.linkProgram(this.program),S.deleteShader(Se),S.deleteShader(je);for(let xe=0;xe<ue.length;xe++){const y=ue[xe];if(y&&!$e[y]){const m=S.getUniformLocation(this.program,y);m&&($e[y]=m)}}this.fixedUniforms=d(c,$e),this.terrainUniforms=((xe,y)=>({u_depth:new o.Uniform1i(xe,y.u_depth),u_terrain:new o.Uniform1i(xe,y.u_terrain),u_terrain_dim:new o.Uniform1f(xe,y.u_terrain_dim),u_terrain_matrix:new o.UniformMatrix4f(xe,y.u_terrain_matrix),u_terrain_unpack:new o.Uniform4f(xe,y.u_terrain_unpack),u_terrain_offset:new o.Uniform1f(xe,y.u_terrain_offset),u_terrain_exaggeration:new o.Uniform1f(xe,y.u_terrain_exaggeration)}))(c,$e),this.binderUniforms=h?h.getUniforms(c,$e):[]}draw(c,v,A,h,d,w,b,S,P,B,V,W,X,ae,ne,ue,Ee,Me){const ve=c.gl;if(this.failedToCreate)return;if(c.program.set(this.program),c.setDepthMode(A),c.setStencilMode(h),c.setColorMode(d),c.setCullFace(w),S){c.activeTexture.set(ve.TEXTURE2),ve.bindTexture(ve.TEXTURE_2D,S.depthTexture),c.activeTexture.set(ve.TEXTURE3),ve.bindTexture(ve.TEXTURE_2D,S.texture);for(const Se in this.terrainUniforms)this.terrainUniforms[Se].set(S[Se])}for(const Se in this.fixedUniforms)this.fixedUniforms[Se].set(b[Se]);ne&&ne.setUniforms(c,this.binderUniforms,X,{zoom:ae});let je=0;switch(v){case ve.LINES:je=2;break;case ve.TRIANGLES:je=3;break;case ve.LINE_STRIP:je=1}for(const Se of W.get()){const $e=Se.vaos||(Se.vaos={});($e[P]||($e[P]=new pa)).bind(c,this,B,ne?ne.getPaintVertexBuffers():[],V,Se.vertexOffset,ue,Ee,Me),ve.drawElements(v,Se.primitiveLength*je,ve.UNSIGNED_SHORT,Se.primitiveOffset*je*2)}}}function we(L,c,v){const A=1/Fr(v,1,c.transform.tileZoom),h=Math.pow(2,v.tileID.overscaledZ),d=v.tileSize*Math.pow(2,c.transform.tileZoom)/h,w=d*(v.tileID.canonical.x+v.tileID.wrap*h),b=d*v.tileID.canonical.y;return{u_image:0,u_texsize:v.imageAtlasTexture.size,u_scale:[A,L.fromScale,L.toScale],u_fade:L.t,u_pixel_coord_upper:[w>>16,b>>16],u_pixel_coord_lower:[65535&w,65535&b]}}const Wo=(L,c,v,A)=>{const h=c.style.light,d=h.properties.get("position"),w=[d.x,d.y,d.z],b=o.create$1();h.properties.get("anchor")==="viewport"&&o.fromRotation(b,-c.transform.angle),o.transformMat3(w,w,b);const S=h.properties.get("color");return{u_matrix:L,u_lightpos:w,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[S.r,S.g,S.b],u_vertical_gradient:+v,u_opacity:A}},Cs=(L,c,v,A,h,d,w)=>o.extend(Wo(L,c,v,A),we(d,c,w),{u_height_factor:-Math.pow(2,h.overscaledZ)/w.tileSize/8}),qa=L=>({u_matrix:L}),Za=(L,c,v,A)=>o.extend(qa(L),we(v,c,A)),ga=(L,c)=>({u_matrix:L,u_world:c}),Ml=(L,c,v,A,h)=>o.extend(Za(L,c,v,A),{u_world:h}),ma=(L,c,v,A)=>{const h=L.transform;let d,w;if(A.paint.get("circle-pitch-alignment")==="map"){const b=Fr(v,1,h.zoom);d=!0,w=[b,b]}else d=!1,w=h.pixelsToGLUnits;return{u_camera_to_center_distance:h.cameraToCenterDistance,u_scale_with_map:+(A.paint.get("circle-pitch-scale")==="map"),u_matrix:L.translatePosMatrix(c.posMatrix,v,A.paint.get("circle-translate"),A.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:L.pixelRatio,u_extrude_scale:w}},ri=(L,c,v)=>{const A=Fr(v,1,c.zoom),h=Math.pow(2,c.zoom-v.tileID.overscaledZ),d=v.tileID.overscaleFactor();return{u_matrix:L,u_camera_to_center_distance:c.cameraToCenterDistance,u_pixels_to_tile_units:A,u_extrude_scale:[c.pixelsToGLUnits[0]/(A*h),c.pixelsToGLUnits[1]/(A*h)],u_overscale_factor:d}},me=(L,c,v=1)=>({u_matrix:L,u_color:c,u_overlay:0,u_overlay_scale:v}),Te=L=>({u_matrix:L}),Ue=(L,c,v,A)=>({u_matrix:L,u_extrude_scale:Fr(c,1,v),u_intensity:A});function lt(L,c){const v=Math.pow(2,c.canonical.z),A=c.canonical.y;return[new o.MercatorCoordinate(0,A/v).toLngLat().lat,new o.MercatorCoordinate(0,(A+1)/v).toLngLat().lat]}const bt=(L,c,v,A)=>{const h=L.transform;return{u_matrix:Br(L,c,v,A),u_ratio:1/Fr(c,1,h.zoom),u_device_pixel_ratio:L.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Qt=(L,c,v,A,h)=>o.extend(bt(L,c,v,h),{u_image:0,u_image_height:A}),Dn=(L,c,v,A,h)=>{const d=L.transform,w=en(c,d);return{u_matrix:Br(L,c,v,h),u_texsize:c.imageAtlasTexture.size,u_ratio:1/Fr(c,1,d.zoom),u_device_pixel_ratio:L.pixelRatio,u_image:0,u_scale:[w,A.fromScale,A.toScale],u_fade:A.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Dr=(L,c,v,A,h,d)=>{const w=L.lineAtlas,b=en(c,L.transform),S=v.layout.get("line-cap")==="round",P=w.getDash(A.from,S),B=w.getDash(A.to,S),V=P.width*h.fromScale,W=B.width*h.toScale;return o.extend(bt(L,c,v,d),{u_patternscale_a:[b/V,-P.height/2],u_patternscale_b:[b/W,-B.height/2],u_sdfgamma:w.width/(256*Math.min(V,W)*L.pixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:B.y,u_mix:h.t})};function en(L,c){return 1/Fr(L,1,c.tileZoom)}function Br(L,c,v,A){return L.translatePosMatrix(A?A.posMatrix:c.tileID.posMatrix,c,v.paint.get("line-translate"),v.paint.get("line-translate-anchor"))}const jn=(L,c,v,A,h)=>{return{u_matrix:L,u_tl_parent:c,u_scale_parent:v,u_buffer_scale:1,u_fade_t:A.mix,u_opacity:A.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(w=h.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(d=h.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:TA(h.paint.get("raster-hue-rotate"))};var d,w};function TA(L){L*=Math.PI/180;const c=Math.sin(L),v=Math.cos(L);return[(2*v+1)/3,(-Math.sqrt(3)*c-v+1)/3,(Math.sqrt(3)*c-v+1)/3]}const SA=(L,c,v,A,h,d,w,b,S,P)=>{const B=h.transform;return{u_is_size_zoom_constant:+(L==="constant"||L==="source"),u_is_size_feature_constant:+(L==="constant"||L==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:B.cameraToCenterDistance,u_pitch:B.pitch/360*2*Math.PI,u_rotate_symbol:+v,u_aspect_ratio:B.width/B.height,u_fade_change:h.options.fadeDuration?h.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:w,u_coord_matrix:b,u_is_text:+S,u_pitch_with_map:+A,u_texsize:P,u_texture:0}},CA=(L,c,v,A,h,d,w,b,S,P,B)=>{const V=h.transform;return o.extend(SA(L,c,v,A,h,d,w,b,S,P),{u_gamma_scale:A?Math.cos(V._pitch)*V.cameraToCenterDistance:1,u_device_pixel_ratio:h.pixelRatio,u_is_halo:+B})},au=(L,c,v,A,h,d,w,b,S,P)=>o.extend(CA(L,c,v,A,h,d,w,b,!0,S,!0),{u_texsize_icon:P,u_texture_icon:1}),lu=(L,c,v)=>({u_matrix:L,u_opacity:c,u_color:v}),MA=(L,c,v,A,h,d)=>o.extend(function(w,b,S,P){const B=S.imageManager.getPattern(w.from.toString()),V=S.imageManager.getPattern(w.to.toString()),{width:W,height:X}=S.imageManager.getPixelSize(),ae=Math.pow(2,P.tileID.overscaledZ),ne=P.tileSize*Math.pow(2,S.transform.tileZoom)/ae,ue=ne*(P.tileID.canonical.x+P.tileID.wrap*ae),Ee=ne*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[W,X],u_mix:b.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/Fr(P,1,S.transform.tileZoom),u_pixel_coord_upper:[ue>>16,Ee>>16],u_pixel_coord_lower:[65535&ue,65535&Ee]}}(A,d,v,h),{u_matrix:L,u_opacity:c}),Pl={fillExtrusion:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_lightpos:new o.Uniform3f(L,c.u_lightpos),u_lightintensity:new o.Uniform1f(L,c.u_lightintensity),u_lightcolor:new o.Uniform3f(L,c.u_lightcolor),u_vertical_gradient:new o.Uniform1f(L,c.u_vertical_gradient),u_opacity:new o.Uniform1f(L,c.u_opacity)}),fillExtrusionPattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_lightpos:new o.Uniform3f(L,c.u_lightpos),u_lightintensity:new o.Uniform1f(L,c.u_lightintensity),u_lightcolor:new o.Uniform3f(L,c.u_lightcolor),u_vertical_gradient:new o.Uniform1f(L,c.u_vertical_gradient),u_height_factor:new o.Uniform1f(L,c.u_height_factor),u_image:new o.Uniform1i(L,c.u_image),u_texsize:new o.Uniform2f(L,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade),u_opacity:new o.Uniform1f(L,c.u_opacity)}),fill:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),fillPattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_image:new o.Uniform1i(L,c.u_image),u_texsize:new o.Uniform2f(L,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade)}),fillOutline:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_world:new o.Uniform2f(L,c.u_world)}),fillOutlinePattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_world:new o.Uniform2f(L,c.u_world),u_image:new o.Uniform1i(L,c.u_image),u_texsize:new o.Uniform2f(L,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade)}),circle:(L,c)=>({u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(L,c.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(L,c.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),collisionBox:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(L,c.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(L,c.u_extrude_scale),u_overscale_factor:new o.Uniform1f(L,c.u_overscale_factor)}),collisionCircle:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_inv_matrix:new o.UniformMatrix4f(L,c.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(L,c.u_viewport_size)}),debug:(L,c)=>({u_color:new o.UniformColor(L,c.u_color),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_overlay:new o.Uniform1i(L,c.u_overlay),u_overlay_scale:new o.Uniform1f(L,c.u_overlay_scale)}),clippingMask:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),heatmap:(L,c)=>({u_extrude_scale:new o.Uniform1f(L,c.u_extrude_scale),u_intensity:new o.Uniform1f(L,c.u_intensity),u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),heatmapTexture:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_world:new o.Uniform2f(L,c.u_world),u_image:new o.Uniform1i(L,c.u_image),u_color_ramp:new o.Uniform1i(L,c.u_color_ramp),u_opacity:new o.Uniform1f(L,c.u_opacity)}),hillshade:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_image:new o.Uniform1i(L,c.u_image),u_latrange:new o.Uniform2f(L,c.u_latrange),u_light:new o.Uniform2f(L,c.u_light),u_shadow:new o.UniformColor(L,c.u_shadow),u_highlight:new o.UniformColor(L,c.u_highlight),u_accent:new o.UniformColor(L,c.u_accent)}),hillshadePrepare:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_image:new o.Uniform1i(L,c.u_image),u_dimension:new o.Uniform2f(L,c.u_dimension),u_zoom:new o.Uniform1f(L,c.u_zoom),u_unpack:new o.Uniform4f(L,c.u_unpack)}),line:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels)}),lineGradient:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels),u_image:new o.Uniform1i(L,c.u_image),u_image_height:new o.Uniform1f(L,c.u_image_height)}),linePattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_texsize:new o.Uniform2f(L,c.u_texsize),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_image:new o.Uniform1i(L,c.u_image),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade)}),lineSDF:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(L,c.u_patternscale_a),u_patternscale_b:new o.Uniform2f(L,c.u_patternscale_b),u_sdfgamma:new o.Uniform1f(L,c.u_sdfgamma),u_image:new o.Uniform1i(L,c.u_image),u_tex_y_a:new o.Uniform1f(L,c.u_tex_y_a),u_tex_y_b:new o.Uniform1f(L,c.u_tex_y_b),u_mix:new o.Uniform1f(L,c.u_mix)}),raster:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_tl_parent:new o.Uniform2f(L,c.u_tl_parent),u_scale_parent:new o.Uniform1f(L,c.u_scale_parent),u_buffer_scale:new o.Uniform1f(L,c.u_buffer_scale),u_fade_t:new o.Uniform1f(L,c.u_fade_t),u_opacity:new o.Uniform1f(L,c.u_opacity),u_image0:new o.Uniform1i(L,c.u_image0),u_image1:new o.Uniform1i(L,c.u_image1),u_brightness_low:new o.Uniform1f(L,c.u_brightness_low),u_brightness_high:new o.Uniform1f(L,c.u_brightness_high),u_saturation_factor:new o.Uniform1f(L,c.u_saturation_factor),u_contrast_factor:new o.Uniform1f(L,c.u_contrast_factor),u_spin_weights:new o.Uniform3f(L,c.u_spin_weights)}),symbolIcon:(L,c)=>({u_is_size_zoom_constant:new o.Uniform1i(L,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(L,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(L,c.u_size_t),u_size:new o.Uniform1f(L,c.u_size),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(L,c.u_pitch),u_rotate_symbol:new o.Uniform1i(L,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(L,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(L,c.u_fade_change),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(L,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(L,c.u_coord_matrix),u_is_text:new o.Uniform1i(L,c.u_is_text),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_texsize:new o.Uniform2f(L,c.u_texsize),u_texture:new o.Uniform1i(L,c.u_texture)}),symbolSDF:(L,c)=>({u_is_size_zoom_constant:new o.Uniform1i(L,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(L,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(L,c.u_size_t),u_size:new o.Uniform1f(L,c.u_size),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(L,c.u_pitch),u_rotate_symbol:new o.Uniform1i(L,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(L,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(L,c.u_fade_change),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(L,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(L,c.u_coord_matrix),u_is_text:new o.Uniform1i(L,c.u_is_text),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_texsize:new o.Uniform2f(L,c.u_texsize),u_texture:new o.Uniform1i(L,c.u_texture),u_gamma_scale:new o.Uniform1f(L,c.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(L,c.u_is_halo)}),symbolTextAndIcon:(L,c)=>({u_is_size_zoom_constant:new o.Uniform1i(L,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(L,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(L,c.u_size_t),u_size:new o.Uniform1f(L,c.u_size),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(L,c.u_pitch),u_rotate_symbol:new o.Uniform1i(L,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(L,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(L,c.u_fade_change),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(L,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(L,c.u_coord_matrix),u_is_text:new o.Uniform1i(L,c.u_is_text),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_texsize:new o.Uniform2f(L,c.u_texsize),u_texsize_icon:new o.Uniform2f(L,c.u_texsize_icon),u_texture:new o.Uniform1i(L,c.u_texture),u_texture_icon:new o.Uniform1i(L,c.u_texture_icon),u_gamma_scale:new o.Uniform1f(L,c.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(L,c.u_is_halo)}),background:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_opacity:new o.Uniform1f(L,c.u_opacity),u_color:new o.UniformColor(L,c.u_color)}),backgroundPattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_opacity:new o.Uniform1f(L,c.u_opacity),u_image:new o.Uniform1i(L,c.u_image),u_pattern_tl_a:new o.Uniform2f(L,c.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(L,c.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(L,c.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(L,c.u_pattern_br_b),u_texsize:new o.Uniform2f(L,c.u_texsize),u_mix:new o.Uniform1f(L,c.u_mix),u_pattern_size_a:new o.Uniform2f(L,c.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(L,c.u_pattern_size_b),u_scale_a:new o.Uniform1f(L,c.u_scale_a),u_scale_b:new o.Uniform1f(L,c.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(L,c.u_tile_units_to_pixels)}),terrain:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_texture:new o.Uniform1i(L,c.u_texture)}),terrainDepth:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),terrainCoords:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_texture:new o.Uniform1i(L,c.u_texture),u_terrain_coords_id:new o.Uniform1f(L,c.u_terrain_coords_id)})};class kl{constructor(c,v,A){this.context=c;const h=c.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!A,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,v.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete v.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const v=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),v.bufferSubData(v.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const PA={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class kA{constructor(c,v,A,h){this.length=v.length,this.attributes=A,this.itemSize=v.bytesPerElement,this.dynamicDraw=h,this.context=c;const d=c.gl;this.buffer=d.createBuffer(),c.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,v.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete v.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){if(c.length!==this.length)throw new Error(`Length of new data is ${c.length}, which doesn't match current length of ${this.length}`);const v=this.context.gl;this.bind(),v.bufferSubData(v.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,v){for(let A=0;A<this.attributes.length;A++){const h=v.attributes[this.attributes[A].name];h!==void 0&&c.enableVertexAttribArray(h)}}setVertexAttribPointers(c,v,A){for(let h=0;h<this.attributes.length;h++){const d=this.attributes[h],w=v.attributes[d.name];w!==void 0&&c.vertexAttribPointer(w,d.components,c[PA[d.type]],!1,this.itemSize,d.offset+this.itemSize*(A||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Kn{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Au extends Kn{getDefault(){return o.Color.transparent}set(c){const v=this.current;(c.r!==v.r||c.g!==v.g||c.b!==v.b||c.a!==v.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class xc extends Kn{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class Il extends Kn{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class Zr extends Kn{getDefault(){return[!0,!0,!0,!0]}set(c){const v=this.current;(c[0]!==v[0]||c[1]!==v[1]||c[2]!==v[2]||c[3]!==v[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Qo extends Kn{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class On extends Kn{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Ms extends Kn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const v=this.current;(c.func!==v.func||c.ref!==v.ref||c.mask!==v.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class ii extends Kn{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const v=this.current;(c[0]!==v[0]||c[1]!==v[1]||c[2]!==v[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class xo extends Kn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const v=this.gl;c?v.enable(v.STENCIL_TEST):v.disable(v.STENCIL_TEST),this.current=c,this.dirty=!1}}class Ll extends Kn{getDefault(){return[0,1]}set(c){const v=this.current;(c[0]!==v[0]||c[1]!==v[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class qo extends Kn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const v=this.gl;c?v.enable(v.DEPTH_TEST):v.disable(v.DEPTH_TEST),this.current=c,this.dirty=!1}}class ya extends Kn{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class wo extends Kn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const v=this.gl;c?v.enable(v.BLEND):v.disable(v.BLEND),this.current=c,this.dirty=!1}}class IA extends Kn{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const v=this.current;(c[0]!==v[0]||c[1]!==v[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class Ya extends Kn{getDefault(){return o.Color.transparent}set(c){const v=this.current;(c.r!==v.r||c.g!==v.g||c.b!==v.b||c.a!==v.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Zo extends Kn{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class Wi extends Kn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const v=this.gl;c?v.enable(v.CULL_FACE):v.disable(v.CULL_FACE),this.current=c,this.dirty=!1}}class Qi extends Kn{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class uu extends Kn{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class Dl extends Kn{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class bo extends Kn{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class Yo extends Kn{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const v=this.current;(c[0]!==v[0]||c[1]!==v[1]||c[2]!==v[2]||c[3]!==v[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class wc extends Kn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const v=this.gl;v.bindFramebuffer(v.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class cu extends Kn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const v=this.gl;v.bindRenderbuffer(v.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Rl extends Kn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const v=this.gl;v.bindTexture(v.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class LA extends Kn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const v=this.gl;v.bindBuffer(v.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class hu extends Kn{getDefault(){return null}set(c){const v=this.gl;v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Xo extends Kn{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class Xa extends Kn{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const v=this.gl;v.pixelStorei(v.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class fu extends Kn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const v=this.gl;v.pixelStorei(v.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class du extends Kn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const v=this.gl;v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class Eo extends Kn{constructor(c,v){super(c),this.context=c,this.parent=v}getDefault(){return null}}class _a extends Eo{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const v=this.gl;v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class pu extends Eo{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const v=this.gl;v.framebufferRenderbuffer(v.FRAMEBUFFER,v.DEPTH_ATTACHMENT,v.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class va{constructor(c,v,A,h){this.context=c,this.width=v,this.height=A;const d=c.gl,w=this.framebuffer=d.createFramebuffer();if(this.colorAttachment=new _a(c,w),h&&(this.depthAttachment=new pu(c,w)),d.checkFramebufferStatus(d.FRAMEBUFFER)!==d.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const c=this.context.gl,v=this.colorAttachment.get();if(v&&c.deleteTexture(v),this.depthAttachment){const A=this.depthAttachment.get();A&&c.deleteRenderbuffer(A)}c.deleteFramebuffer(this.framebuffer)}}class gr{constructor(c,v,A){this.blendFunction=c,this.blendColor=v,this.mask=A}}gr.Replace=[1,0],gr.disabled=new gr(gr.Replace,o.Color.transparent,[!1,!1,!1,!1]),gr.unblended=new gr(gr.Replace,o.Color.transparent,[!0,!0,!0,!0]),gr.alphaBlended=new gr([1,771],o.Color.transparent,[!0,!0,!0,!0]);class js{constructor(c){this.gl=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Au(this),this.clearDepth=new xc(this),this.clearStencil=new Il(this),this.colorMask=new Zr(this),this.depthMask=new Qo(this),this.stencilMask=new On(this),this.stencilFunc=new Ms(this),this.stencilOp=new ii(this),this.stencilTest=new xo(this),this.depthRange=new Ll(this),this.depthTest=new qo(this),this.depthFunc=new ya(this),this.blend=new wo(this),this.blendFunc=new IA(this),this.blendColor=new Ya(this),this.blendEquation=new Zo(this),this.cullFace=new Wi(this),this.cullFaceSide=new Qi(this),this.frontFace=new uu(this),this.program=new Dl(this),this.activeTexture=new bo(this),this.viewport=new Yo(this),this.bindFramebuffer=new wc(this),this.bindRenderbuffer=new cu(this),this.bindTexture=new Rl(this),this.bindVertexBuffer=new LA(this),this.bindElementBuffer=new hu(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Xo(this),this.pixelStoreUnpack=new Xa(this),this.pixelStoreUnpackPremultiplyAlpha=new fu(this),this.pixelStoreUnpackFlipY=new du(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=c.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(c.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,v){return new kl(this,c,v)}createVertexBuffer(c,v,A){return new kA(this,c,v,A)}createRenderbuffer(c,v,A){const h=this.gl,d=h.createRenderbuffer();return this.bindRenderbuffer.set(d),h.renderbufferStorage(h.RENDERBUFFER,c,v,A),this.bindRenderbuffer.set(null),d}createFramebuffer(c,v,A){return new va(this,c,v,A)}clear({color:c,depth:v}){const A=this.gl;let h=0;c&&(h|=A.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),v!==void 0&&(h|=A.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(v),this.depthMask.set(!0)),A.clear(h)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){M(c.blendFunction,gr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Hn{constructor(c,v,A){this.func=c,this.mask=v,this.range=A}}Hn.ReadOnly=!1,Hn.ReadWrite=!0,Hn.disabled=new Hn(519,Hn.ReadOnly,[0,1]);const Zn=7680;class Tr{constructor(c,v,A,h,d,w){this.test=c,this.ref=v,this.mask=A,this.fail=h,this.depthFail=d,this.pass=w}}Tr.disabled=new Tr({func:519,mask:0},0,0,Zn,Zn,Zn);class _r{constructor(c,v,A){this.enable=c,this.mode=v,this.frontFace=A}}let Bl;function Ko(L,c,v,A,h,d,w){const b=L.context,S=b.gl,P=L.useProgram("collisionBox"),B=[];let V=0,W=0;for(let ve=0;ve<A.length;ve++){const je=A[ve],Se=c.getTile(je),$e=Se.getBucket(v);if(!$e)continue;let xe=je.posMatrix;h[0]===0&&h[1]===0||(xe=L.translatePosMatrix(je.posMatrix,Se,h,d));const y=w?$e.textCollisionBox:$e.iconCollisionBox,m=$e.collisionCircleArray;if(m.length>0){const x=o.create(),E=xe;o.mul(x,$e.placementInvProjMatrix,L.transform.glCoordMatrix),o.mul(x,x,$e.placementViewportMatrix),B.push({circleArray:m,circleOffset:W,transform:E,invTransform:x,coord:je}),V+=m.length/4,W=V}y&&P.draw(b,S.LINES,Hn.disabled,Tr.disabled,L.colorModeForRenderPass(),_r.disabled,ri(xe,L.transform,Se),L.style.terrain&&L.style.terrain.getTerrainData(je),v.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,null,L.transform.zoom,null,null,y.collisionVertexBuffer)}if(!w||!B.length)return;const X=L.useProgram("collisionCircle"),ae=new o.CollisionCircleLayoutArray;ae.resize(4*V),ae._trim();let ne=0;for(const ve of B)for(let je=0;je<ve.circleArray.length/4;je++){const Se=4*je,$e=ve.circleArray[Se+0],xe=ve.circleArray[Se+1],y=ve.circleArray[Se+2],m=ve.circleArray[Se+3];ae.emplace(ne++,$e,xe,y,m,0),ae.emplace(ne++,$e,xe,y,m,1),ae.emplace(ne++,$e,xe,y,m,2),ae.emplace(ne++,$e,xe,y,m,3)}(!Bl||Bl.length<2*V)&&(Bl=function(ve){const je=2*ve,Se=new o.QuadTriangleArray;Se.resize(je),Se._trim();for(let $e=0;$e<je;$e++){const xe=6*$e;Se.uint16[xe+0]=4*$e+0,Se.uint16[xe+1]=4*$e+1,Se.uint16[xe+2]=4*$e+2,Se.uint16[xe+3]=4*$e+2,Se.uint16[xe+4]=4*$e+3,Se.uint16[xe+5]=4*$e+0}return Se}(V));const ue=b.createIndexBuffer(Bl,!0),Ee=b.createVertexBuffer(ae,o.collisionCircleLayout.members,!0);for(const ve of B){const je={u_matrix:ve.transform,u_inv_matrix:ve.invTransform,u_camera_to_center_distance:(Me=L.transform).cameraToCenterDistance,u_viewport_size:[Me.width,Me.height]};X.draw(b,S.TRIANGLES,Hn.disabled,Tr.disabled,L.colorModeForRenderPass(),_r.disabled,je,L.style.terrain&&L.style.terrain.getTerrainData(ve.coord),v.id,Ee,ue,o.SegmentVector.simpleSegment(0,2*ve.circleOffset,ve.circleArray.length,ve.circleArray.length/2),null,L.transform.zoom,null,null,null)}var Me;Ee.destroy(),ue.destroy()}_r.disabled=new _r(!1,1029,2305),_r.backCCW=new _r(!0,1029,2305);const bc=o.identity(new Float32Array(16));function Ka(L,c,v,A,h,d){const{horizontalAlign:w,verticalAlign:b}=o.getAnchorAlignment(L),S=-(w-.5)*c,P=-(b-.5)*v,B=o.evaluateVariableOffset(L,A);return new o.pointGeometry((S/h+B[0])*d,(P/h+B[1])*d)}function Ec(L,c,v,A,h,d,w,b,S,P,B){const V=L.text.placedSymbolArray,W=L.text.dynamicLayoutVertexArray,X=L.icon.dynamicLayoutVertexArray,ae={};W.clear();for(let ne=0;ne<V.length;ne++){const ue=V.get(ne),Ee=L.allowVerticalPlacement&&!ue.placedOrientation,Me=ue.hidden||!ue.crossTileID||Ee?null:A[ue.crossTileID];if(Me){const ve=new o.pointGeometry(ue.anchorX,ue.anchorY),je=zn(ve,v?w:d,B),Se=$i(h.cameraToCenterDistance,je.signedDistanceFromCamera);let $e=o.evaluateSizeForFeature(L.textSizeData,S,ue)*Se/o.ONE_EM;v&&($e*=L.tilePixelRatio/b);const{width:xe,height:y,anchor:m,textOffset:x,textBoxScale:E}=Me,I=Ka(m,xe,y,x,E,$e),R=v?zn(ve.add(I),d,B).point:je.point.add(c?I.rotate(-h.angle):I),O=L.allowVerticalPlacement&&ue.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let U=0;U<ue.numGlyphs;U++)o.addDynamicAttributes(W,R,O);P&&ue.associatedIconIndex>=0&&(ae[ue.associatedIconIndex]={shiftedAnchor:R,angle:O})}else yn(ue.numGlyphs,W)}if(P){X.clear();const ne=L.icon.placedSymbolArray;for(let ue=0;ue<ne.length;ue++){const Ee=ne.get(ue);if(Ee.hidden)yn(Ee.numGlyphs,X);else{const Me=ae[ue];if(Me)for(let ve=0;ve<Ee.numGlyphs;ve++)o.addDynamicAttributes(X,Me.shiftedAnchor,Me.angle);else yn(Ee.numGlyphs,X)}}L.icon.dynamicLayoutVertexBuffer.updateData(X)}L.text.dynamicLayoutVertexBuffer.updateData(W)}function gu(L,c,v){return v.iconsInText&&c?"symbolTextAndIcon":L?"symbolSDF":"symbolIcon"}function Hs(L,c,v,A,h,d,w,b,S,P,B,V){const W=L.context,X=W.gl,ae=L.transform,ne=b==="map",ue=S==="map",Ee=b!=="viewport"&&v.layout.get("symbol-placement")!=="point",Me=ne&&!ue&&!Ee,ve=!v.layout.get("symbol-sort-key").isConstant();let je=!1;const Se=L.depthModeForSublayer(0,Hn.ReadOnly),$e=v.layout.get("text-variable-anchor"),xe=[];for(const y of A){const m=c.getTile(y),x=m.getBucket(v);if(!x)continue;const E=h?x.text:x.icon;if(!E||!E.segments.get().length)continue;const I=E.programConfigurations.get(v.id),R=h||x.sdfIcons,O=h?x.textSizeData:x.iconSizeData,U=ue||ae.pitch!==0,q=L.useProgram(gu(R,h,x),I),ee=o.evaluateSizeForZoom(O,ae.zoom),le=L.style.terrain&&L.style.terrain.getTerrainData(y);let de,Be,He,ze,Je=[0,0],ft=null;if(h){if(Be=m.glyphAtlasTexture,He=X.LINEAR,de=m.glyphAtlasTexture.size,x.iconsInText){Je=m.imageAtlasTexture.size,ft=m.imageAtlasTexture;const _n=O.kind==="composite"||O.kind==="camera";ze=U||L.options.rotating||L.options.zooming||_n?X.LINEAR:X.NEAREST}}else{const _n=v.layout.get("icon-size").constantOr(0)!==1||x.iconsNeedLinear;Be=m.imageAtlasTexture,He=R||L.options.rotating||L.options.zooming||_n||U?X.LINEAR:X.NEAREST,de=m.imageAtlasTexture.size}const ct=Fr(m,1,L.transform.zoom),st=Vs(y.posMatrix,ue,ne,L.transform,ct),ot=Ei(y.posMatrix,ue,ne,L.transform,ct),et=$e&&x.hasTextData(),Gt=v.layout.get("icon-text-fit")!=="none"&&et&&x.hasIconData();if(Ee){const _n=L.style.terrain?(Rn,lr)=>L.style.terrain.getElevation(y,Rn,lr):null,En=v.layout.get("text-rotation-alignment")==="map";Ri(x,y.posMatrix,L,h,st,ot,ue,P,En,_n)}const zt=L.translatePosMatrix(y.posMatrix,m,d,w),gt=Ee||h&&$e||Gt?bc:st,vt=L.translatePosMatrix(ot,m,d,w,!0),kn=R&&v.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let wn;wn=R?x.iconsInText?au(O.kind,ee,Me,ue,L,zt,gt,vt,de,Je):CA(O.kind,ee,Me,ue,L,zt,gt,vt,h,de,!0):SA(O.kind,ee,Me,ue,L,zt,gt,vt,h,de);const mn={program:q,buffers:E,uniformValues:wn,atlasTexture:Be,atlasTextureIcon:ft,atlasInterpolation:He,atlasInterpolationIcon:ze,isSDF:R,hasHalo:kn};if(ve&&x.canOverlap){je=!0;const _n=E.segments.get();for(const En of _n)xe.push({segments:new o.SegmentVector([En]),sortKey:En.sortKey,state:mn,terrainData:le})}else xe.push({segments:E.segments,sortKey:0,state:mn,terrainData:le})}je&&xe.sort((y,m)=>y.sortKey-m.sortKey);for(const y of xe){const m=y.state;if(W.activeTexture.set(X.TEXTURE0),m.atlasTexture.bind(m.atlasInterpolation,X.CLAMP_TO_EDGE),m.atlasTextureIcon&&(W.activeTexture.set(X.TEXTURE1),m.atlasTextureIcon&&m.atlasTextureIcon.bind(m.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),m.isSDF){const x=m.uniformValues;m.hasHalo&&(x.u_is_halo=1,zl(m.buffers,y.segments,v,L,m.program,Se,B,V,x,y.terrainData)),x.u_is_halo=0}zl(m.buffers,y.segments,v,L,m.program,Se,B,V,m.uniformValues,y.terrainData)}}function zl(L,c,v,A,h,d,w,b,S,P){const B=A.context;h.draw(B,B.gl.TRIANGLES,d,w,b,_r.disabled,S,P,v.id,L.layoutVertexBuffer,L.indexBuffer,c,v.paint,A.transform.zoom,L.programConfigurations.get(v.id),L.dynamicLayoutVertexBuffer,L.opacityVertexBuffer)}function Ja(L,c,v,A,h,d,w){const b=L.context.gl,S=v.paint.get("fill-pattern"),P=S&&S.constantOr(1),B=v.getCrossfadeParameters();let V,W,X,ae,ne;w?(W=P&&!v.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=b.LINES):(W=P?"fillPattern":"fill",V=b.TRIANGLES);for(const ue of A){const Ee=c.getTile(ue);if(P&&!Ee.patternsLoaded())continue;const Me=Ee.getBucket(v);if(!Me)continue;const ve=Me.programConfigurations.get(v.id),je=L.useProgram(W,ve),Se=L.style.terrain&&L.style.terrain.getTerrainData(ue);P&&(L.context.activeTexture.set(b.TEXTURE0),Ee.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),ve.updatePaintBuffers(B));const $e=S.constantOr(null);if($e&&Ee.imageAtlas){const m=Ee.imageAtlas,x=m.patternPositions[$e.to.toString()],E=m.patternPositions[$e.from.toString()];x&&E&&ve.setConstantPatternPositions(x,E)}const xe=Se?ue:null,y=L.translatePosMatrix(xe?xe.posMatrix:ue.posMatrix,Ee,v.paint.get("fill-translate"),v.paint.get("fill-translate-anchor"));if(w){ae=Me.indexBuffer2,ne=Me.segments2;const m=[b.drawingBufferWidth,b.drawingBufferHeight];X=W==="fillOutlinePattern"&&P?Ml(y,L,B,Ee,m):ga(y,m)}else ae=Me.indexBuffer,ne=Me.segments,X=P?Za(y,L,B,Ee):qa(y);je.draw(L.context,V,h,L.stencilModeForClipping(ue),d,_r.disabled,X,Se,v.id,Me.layoutVertexBuffer,ae,ne,v.paint,L.transform.zoom,ve)}}function xa(L,c,v,A,h,d,w){const b=L.context,S=b.gl,P=v.paint.get("fill-extrusion-pattern"),B=P.constantOr(1),V=v.getCrossfadeParameters(),W=v.paint.get("fill-extrusion-opacity");for(const X of A){const ae=c.getTile(X),ne=ae.getBucket(v);if(!ne)continue;const ue=L.style.terrain&&L.style.terrain.getTerrainData(X),Ee=ne.programConfigurations.get(v.id),Me=L.useProgram(B?"fillExtrusionPattern":"fillExtrusion",Ee);B&&(L.context.activeTexture.set(S.TEXTURE0),ae.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),Ee.updatePaintBuffers(V));const ve=P.constantOr(null);if(ve&&ae.imageAtlas){const xe=ae.imageAtlas,y=xe.patternPositions[ve.to.toString()],m=xe.patternPositions[ve.from.toString()];y&&m&&Ee.setConstantPatternPositions(y,m)}const je=L.translatePosMatrix(X.posMatrix,ae,v.paint.get("fill-extrusion-translate"),v.paint.get("fill-extrusion-translate-anchor")),Se=v.paint.get("fill-extrusion-vertical-gradient"),$e=B?Cs(je,L,Se,W,X,V,ae):Wo(je,L,Se,W);Me.draw(b,b.gl.TRIANGLES,h,d,w,_r.backCCW,$e,ue,v.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,v.paint,L.transform.zoom,Ee,L.style.terrain&&ne.centroidVertexBuffer)}}function Ol(L,c,v,A,h,d,w){const b=L.context,S=b.gl,P=v.fbo;if(!P)return;const B=L.useProgram("hillshade"),V=L.style.terrain&&L.style.terrain.getTerrainData(c);b.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,P.colorAttachment.get()),B.draw(b,S.TRIANGLES,h,d,w,_r.disabled,((W,X,ae,ne)=>{const ue=ae.paint.get("hillshade-shadow-color"),Ee=ae.paint.get("hillshade-highlight-color"),Me=ae.paint.get("hillshade-accent-color");let ve=ae.paint.get("hillshade-illumination-direction")*(Math.PI/180);ae.paint.get("hillshade-illumination-anchor")==="viewport"&&(ve-=W.transform.angle);const je=!W.options.moving;return{u_matrix:ne?ne.posMatrix:W.transform.calculatePosMatrix(X.tileID.toUnwrapped(),je),u_image:0,u_latrange:lt(0,X.tileID),u_light:[ae.paint.get("hillshade-exaggeration"),ve],u_shadow:ue,u_highlight:Ee,u_accent:Me}})(L,v,A,V?c:null),V,A.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments)}function Fl(L,c,v,A,h,d){const w=L.context,b=w.gl,S=c.dem;if(S&&S.data){const P=S.dim,B=S.stride,V=S.getPixels();if(w.activeTexture.set(b.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||L.getTileTexture(B),c.demTexture){const X=c.demTexture;X.update(V,{premultiply:!1}),X.bind(b.NEAREST,b.CLAMP_TO_EDGE)}else c.demTexture=new H(w,V,b.RGBA,{premultiply:!1}),c.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);w.activeTexture.set(b.TEXTURE0);let W=c.fbo;if(!W){const X=new H(w,{width:P,height:P,data:null},b.RGBA);X.bind(b.LINEAR,b.CLAMP_TO_EDGE),W=c.fbo=w.createFramebuffer(P,P,!0),W.colorAttachment.set(X.texture)}w.bindFramebuffer.set(W.framebuffer),w.viewport.set([0,0,P,P]),L.useProgram("hillshadePrepare").draw(w,b.TRIANGLES,A,h,d,_r.disabled,((X,ae)=>{const ne=ae.stride,ue=o.create();return o.ortho(ue,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(ue,ue,[0,-o.EXTENT,0]),{u_matrix:ue,u_image:1,u_dimension:[ne,ne],u_zoom:X.overscaledZ,u_unpack:ae.getUnpackVector()}})(c.tileID,S),null,v.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function vr(L,c,v,A,h,d){const w=A.paint.get("raster-fade-duration");if(!d&&w>0){const b=o.exported.now(),S=(b-L.timeAdded)/w,P=c?(b-c.timeAdded)/w:-1,B=v.getSource(),V=h.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),W=!c||Math.abs(c.tileID.overscaledZ-V)>Math.abs(L.tileID.overscaledZ-V),X=W&&L.refreshedUponExpiration?1:o.clamp(W?S:1-P,0,1);return L.refreshedUponExpiration&&S>=1&&(L.refreshedUponExpiration=!1),c?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const DA=new o.Color(1,0,0,1),hs=new o.Color(0,1,0,1),mu=new o.Color(0,0,1,1),Nl=new o.Color(1,0,1,1),Tc=new o.Color(0,1,1,1);function Yr(L,c,v,A){si(L,0,c+v/2,L.transform.width,v,A)}function zr(L,c,v,A){si(L,c-v/2,0,v,L.transform.height,A)}function si(L,c,v,A,h,d){const w=L.context,b=w.gl;b.enable(b.SCISSOR_TEST),b.scissor(c*L.pixelRatio,v*L.pixelRatio,A*L.pixelRatio,h*L.pixelRatio),w.clear({color:d}),b.disable(b.SCISSOR_TEST)}function yu(L,c,v){const A=L.context,h=A.gl,d=v.posMatrix,w=L.useProgram("debug"),b=Hn.disabled,S=Tr.disabled,P=L.colorModeForRenderPass(),B="$debug",V=L.style.terrain&&L.style.terrain.getTerrainData(v);A.activeTexture.set(h.TEXTURE0),L.emptyTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE);const W=c.getTileByID(v.key).latestRawTileData,X=Math.floor((W&&W.byteLength||0)/1024),ae=c.getTile(v).tileSize,ne=512/Math.min(ae,512)*(v.overscaledZ/L.transform.zoom)*.5;let ue=v.canonical.toString();v.overscaledZ!==v.canonical.z&&(ue+=` => ${v.overscaledZ}`),function(Ee,Me){Ee.initDebugOverlayCanvas();const ve=Ee.debugOverlayCanvas,je=Ee.context.gl,Se=Ee.debugOverlayCanvas.getContext("2d");Se.clearRect(0,0,ve.width,ve.height),Se.shadowColor="white",Se.shadowBlur=2,Se.lineWidth=1.5,Se.strokeStyle="white",Se.textBaseline="top",Se.font="bold 36px Open Sans, sans-serif",Se.fillText(Me,5,5),Se.strokeText(Me,5,5),Ee.debugOverlayTexture.update(ve),Ee.debugOverlayTexture.bind(je.LINEAR,je.CLAMP_TO_EDGE)}(L,`${ue} ${X}kB`),w.draw(A,h.TRIANGLES,b,S,gr.alphaBlended,_r.disabled,me(d,o.Color.transparent,ne),null,B,L.debugBuffer,L.quadTriangleIndexBuffer,L.debugSegments),w.draw(A,h.LINE_STRIP,b,S,P,_r.disabled,me(d,o.Color.red),V,B,L.debugBuffer,L.tileBorderIndexBuffer,L.debugSegments)}function Ws(L,c,v){const A=L.context,h=A.gl,d=L.colorModeForRenderPass(),w=new Hn(h.LEQUAL,Hn.ReadWrite,L.depthRangeFor3D),b=L.useProgram("terrain"),S=c.getTerrainMesh(),P=c.getTerrainData(v.tileID);A.bindFramebuffer.set(null),A.viewport.set([0,0,L.width,L.height]),A.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,c.getRTTFramebuffer().colorAttachment.get());const B=L.transform.calculatePosMatrix(v.tileID.toUnwrapped());b.draw(A,h.TRIANGLES,w,Tr.disabled,d,_r.backCCW,{u_matrix:B,u_texture:0},P,"terrain",S.vertexBuffer,S.indexBuffer,S.segments)}function Sc(L,c,v,A){const h=L.context,d=v.tileSize*c.qualityFactor;v.textures[A]||(v.textures[A]=L.getTileTexture(d)||new H(h,{width:d,height:d,data:null},h.gl.RGBA),v.textures[A].bind(h.gl.LINEAR,h.gl.CLAMP_TO_EDGE),A===0&&c.sourceCache.renderHistory.unshift(v.tileID.key));const w=c.getRTTFramebuffer();w.colorAttachment.set(v.textures[A].texture),h.bindFramebuffer.set(w.framebuffer),h.viewport.set([0,0,d,d])}class RA{constructor(c){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=c,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=c.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const c=this.painter.style,v=c.terrain;for(const A in c.sourceCaches){this._coordsDescendingInv[A]={};const h=c.sourceCaches[A].getVisibleCoordinates();for(const d of h){const w=v.sourceCache.getTerrainCoords(d);for(const b in w)this._coordsDescendingInv[A][b]||(this._coordsDescendingInv[A][b]=[]),this._coordsDescendingInv[A][b].push(w[b])}}for(const A of c._order){const h=c._layers[A],d=h.source;if(this._renderToTexture[h.type]&&!this._coordsDescendingInvStr[d]){this._coordsDescendingInvStr[d]={};for(const w in this._coordsDescendingInv[d])this._coordsDescendingInvStr[d][w]=this._coordsDescendingInv[d][w].map(b=>b.key).sort().join()}}return this._renderableTiles.forEach(A=>{for(const h in this._coordsDescendingInvStr){const d=this._coordsDescendingInvStr[h][A.tileID.key];d&&d!==A.textureCoords[h]&&A.clearTextures(this.painter),v.needsRerender(h,A.tileID)&&A.clearTextures(this.painter)}this._rerender[A.tileID.key]=!A.textures.length}),v.clearRerenderCache(),v.sourceCache.removeOutdated(this.painter),this}renderLayer(c){const v=c.type,A=this.painter,h=A.style._order,d=A.currentLayer,w=d+1===h.length;if(this._renderToTexture[v]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=v,this._stacks[this._stacks.length-1].push(h[d]),!w))return!0;if(this._renderToTexture[this._prevType]||v==="hillshade"||this._renderToTexture[v]&&w){this._prevType=v;const b=this._stacks.length-1,S=this._stacks[b]||[];for(const P of this._renderableTiles){if(Sc(A,A.style.terrain,P,b),this._rerender[P.tileID.key]){A.context.clear({color:o.Color.transparent});for(let B=0;B<S.length;B++){const V=A.style._layers[S[B]],W=V.source?this._coordsDescendingInv[V.source][P.tileID.key]:[P.tileID];A._renderTileClippingMasks(V,W),A.renderLayer(A,A.style.sourceCaches[V.source],V,W),V.source&&(P.textureCoords[V.source]=this._coordsDescendingInvStr[V.source][P.tileID.key])}}Ws(A,A.style.terrain,P)}if(v==="hillshade"){this._stacks.push([h[d]]);for(const P of this._renderableTiles){const B=this._coordsDescendingInv[c.source][P.tileID.key];Sc(A,A.style.terrain,P,this._stacks.length-1),A.context.clear({color:o.Color.transparent}),A._renderTileClippingMasks(c,B),A.renderLayer(A,A.style.sourceCaches[c.source],c,B),Ws(A,A.style.terrain,P)}return!0}return this._renderToTexture[v]}return!1}}const di={symbol:function(L,c,v,A,h){if(L.renderPass!=="translucent")return;const d=Tr.disabled,w=L.colorModeForRenderPass();v.layout.get("text-variable-anchor")&&function(b,S,P,B,V,W,X){const ae=S.transform,ne=V==="map",ue=W==="map";for(const Ee of b){const Me=B.getTile(Ee),ve=Me.getBucket(P);if(!ve||!ve.text||!ve.text.segments.get().length)continue;const je=o.evaluateSizeForZoom(ve.textSizeData,ae.zoom),Se=Fr(Me,1,S.transform.zoom),$e=Vs(Ee.posMatrix,ue,ne,S.transform,Se),xe=P.layout.get("icon-text-fit")!=="none"&&ve.hasIconData();if(je){const y=Math.pow(2,ae.zoom-Me.tileID.overscaledZ);Ec(ve,ne,ue,X,ae,$e,Ee.posMatrix,y,je,xe,S.style.terrain?(m,x)=>S.style.terrain.getElevation(Ee,m,x):null)}}}(A,L,v,c,v.layout.get("text-rotation-alignment"),v.layout.get("text-pitch-alignment"),h),v.paint.get("icon-opacity").constantOr(1)!==0&&Hs(L,c,v,A,!1,v.paint.get("icon-translate"),v.paint.get("icon-translate-anchor"),v.layout.get("icon-rotation-alignment"),v.layout.get("icon-pitch-alignment"),v.layout.get("icon-keep-upright"),d,w),v.paint.get("text-opacity").constantOr(1)!==0&&Hs(L,c,v,A,!0,v.paint.get("text-translate"),v.paint.get("text-translate-anchor"),v.layout.get("text-rotation-alignment"),v.layout.get("text-pitch-alignment"),v.layout.get("text-keep-upright"),d,w),c.map.showCollisionBoxes&&(Ko(L,c,v,A,v.paint.get("text-translate"),v.paint.get("text-translate-anchor"),!0),Ko(L,c,v,A,v.paint.get("icon-translate"),v.paint.get("icon-translate-anchor"),!1))},circle:function(L,c,v,A){if(L.renderPass!=="translucent")return;const h=v.paint.get("circle-opacity"),d=v.paint.get("circle-stroke-width"),w=v.paint.get("circle-stroke-opacity"),b=!v.layout.get("circle-sort-key").isConstant();if(h.constantOr(1)===0&&(d.constantOr(1)===0||w.constantOr(1)===0))return;const S=L.context,P=S.gl,B=L.depthModeForSublayer(0,Hn.ReadOnly),V=Tr.disabled,W=L.colorModeForRenderPass(),X=[];for(let ae=0;ae<A.length;ae++){const ne=A[ae],ue=c.getTile(ne),Ee=ue.getBucket(v);if(!Ee)continue;const Me=Ee.programConfigurations.get(v.id),ve=L.useProgram("circle",Me),je=Ee.layoutVertexBuffer,Se=Ee.indexBuffer,$e=L.style.terrain&&L.style.terrain.getTerrainData(ne),xe={programConfiguration:Me,program:ve,layoutVertexBuffer:je,indexBuffer:Se,uniformValues:ma(L,ne,ue,v),terrainData:$e};if(b){const y=Ee.segments.get();for(const m of y)X.push({segments:new o.SegmentVector([m]),sortKey:m.sortKey,state:xe})}else X.push({segments:Ee.segments,sortKey:0,state:xe})}b&&X.sort((ae,ne)=>ae.sortKey-ne.sortKey);for(const ae of X){const{programConfiguration:ne,program:ue,layoutVertexBuffer:Ee,indexBuffer:Me,uniformValues:ve,terrainData:je}=ae.state;ue.draw(S,P.TRIANGLES,B,V,W,_r.disabled,ve,je,v.id,Ee,Me,ae.segments,v.paint,L.transform.zoom,ne)}},heatmap:function(L,c,v,A){if(v.paint.get("heatmap-opacity")!==0)if(L.renderPass==="offscreen"){const h=L.context,d=h.gl,w=Tr.disabled,b=new gr([d.ONE,d.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(S,P,B){const V=S.gl;S.activeTexture.set(V.TEXTURE1),S.viewport.set([0,0,P.width/4,P.height/4]);let W=B.heatmapFbo;if(W)V.bindTexture(V.TEXTURE_2D,W.colorAttachment.get()),S.bindFramebuffer.set(W.framebuffer);else{const X=V.createTexture();V.bindTexture(V.TEXTURE_2D,X),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.LINEAR),W=B.heatmapFbo=S.createFramebuffer(P.width/4,P.height/4,!1),function(ae,ne,ue,Ee){const Me=ae.gl;Me.texImage2D(Me.TEXTURE_2D,0,Me.RGBA,ne.width/4,ne.height/4,0,Me.RGBA,ae.extRenderToTextureHalfFloat?ae.extTextureHalfFloat.HALF_FLOAT_OES:Me.UNSIGNED_BYTE,null),Ee.colorAttachment.set(ue)}(S,P,X,W)}})(h,L,v),h.clear({color:o.Color.transparent});for(let S=0;S<A.length;S++){const P=A[S];if(c.hasRenderableParent(P))continue;const B=c.getTile(P),V=B.getBucket(v);if(!V)continue;const W=V.programConfigurations.get(v.id),X=L.useProgram("heatmap",W),{zoom:ae}=L.transform;X.draw(h,d.TRIANGLES,Hn.disabled,w,b,_r.disabled,Ue(P.posMatrix,B,ae,v.paint.get("heatmap-intensity")),null,v.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,v.paint,L.transform.zoom,W)}h.viewport.set([0,0,L.width,L.height])}else L.renderPass==="translucent"&&(L.context.setColorMode(L.colorModeForRenderPass()),function(h,d){const w=h.context,b=w.gl,S=d.heatmapFbo;if(!S)return;w.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,S.colorAttachment.get()),w.activeTexture.set(b.TEXTURE1);let P=d.colorRampTexture;P||(P=d.colorRampTexture=new H(w,d.colorRamp,b.RGBA)),P.bind(b.LINEAR,b.CLAMP_TO_EDGE),h.useProgram("heatmapTexture").draw(w,b.TRIANGLES,Hn.disabled,Tr.disabled,h.colorModeForRenderPass(),_r.disabled,((B,V,W,X)=>{const ae=o.create();o.ortho(ae,0,B.width,B.height,0,0,1);const ne=B.context.gl;return{u_matrix:ae,u_world:[ne.drawingBufferWidth,ne.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:V.paint.get("heatmap-opacity")}})(h,d),null,d.id,h.viewportBuffer,h.quadTriangleIndexBuffer,h.viewportSegments,d.paint,h.transform.zoom)}(L,v))},line:function(L,c,v,A){if(L.renderPass!=="translucent")return;const h=v.paint.get("line-opacity"),d=v.paint.get("line-width");if(h.constantOr(1)===0||d.constantOr(1)===0)return;const w=L.depthModeForSublayer(0,Hn.ReadOnly),b=L.colorModeForRenderPass(),S=v.paint.get("line-dasharray"),P=v.paint.get("line-pattern"),B=P.constantOr(1),V=v.paint.get("line-gradient"),W=v.getCrossfadeParameters(),X=B?"linePattern":S?"lineSDF":V?"lineGradient":"line",ae=L.context,ne=ae.gl;let ue=!0;for(const Ee of A){const Me=c.getTile(Ee);if(B&&!Me.patternsLoaded())continue;const ve=Me.getBucket(v);if(!ve)continue;const je=ve.programConfigurations.get(v.id),Se=L.context.program.get(),$e=L.useProgram(X,je),xe=ue||$e.program!==Se,y=L.style.terrain&&L.style.terrain.getTerrainData(Ee),m=P.constantOr(null);if(m&&Me.imageAtlas){const I=Me.imageAtlas,R=I.patternPositions[m.to.toString()],O=I.patternPositions[m.from.toString()];R&&O&&je.setConstantPatternPositions(R,O)}const x=y?Ee:null,E=B?Dn(L,Me,v,W,x):S?Dr(L,Me,v,S,W,x):V?Qt(L,Me,v,ve.lineClipsArray.length,x):bt(L,Me,v,x);if(B)ae.activeTexture.set(ne.TEXTURE0),Me.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),je.updatePaintBuffers(W);else if(S&&(xe||L.lineAtlas.dirty))ae.activeTexture.set(ne.TEXTURE0),L.lineAtlas.bind(ae);else if(V){const I=ve.gradients[v.id];let R=I.texture;if(v.gradientVersion!==I.version){let O=256;if(v.stepInterpolant){const U=c.getSource().maxzoom,q=Ee.canonical.z===U?Math.ceil(1<<L.transform.maxZoom-Ee.canonical.z):1;O=o.clamp(o.nextPowerOfTwo(ve.maxLineLength/o.EXTENT*1024*q),256,ae.maxTextureSize)}I.gradient=o.renderColorRamp({expression:v.gradientExpression(),evaluationKey:"lineProgress",resolution:O,image:I.gradient||void 0,clips:ve.lineClipsArray}),I.texture?I.texture.update(I.gradient):I.texture=new H(ae,I.gradient,ne.RGBA),I.version=v.gradientVersion,R=I.texture}ae.activeTexture.set(ne.TEXTURE0),R.bind(v.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}$e.draw(ae,ne.TRIANGLES,w,L.stencilModeForClipping(Ee),b,_r.disabled,E,y,v.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,v.paint,L.transform.zoom,je,ve.layoutVertexBuffer2),ue=!1}},fill:function(L,c,v,A){const h=v.paint.get("fill-color"),d=v.paint.get("fill-opacity");if(d.constantOr(1)===0)return;const w=L.colorModeForRenderPass(),b=v.paint.get("fill-pattern"),S=L.opaquePassEnabledForLayer()&&!b.constantOr(1)&&h.constantOr(o.Color.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(L.renderPass===S){const P=L.depthModeForSublayer(1,L.renderPass==="opaque"?Hn.ReadWrite:Hn.ReadOnly);Ja(L,c,v,A,P,w,!1)}if(L.renderPass==="translucent"&&v.paint.get("fill-antialias")){const P=L.depthModeForSublayer(v.getPaintProperty("fill-outline-color")?2:0,Hn.ReadOnly);Ja(L,c,v,A,P,w,!0)}},"fill-extrusion":function(L,c,v,A){const h=v.paint.get("fill-extrusion-opacity");if(h!==0&&L.renderPass==="translucent"){const d=new Hn(L.context.gl.LEQUAL,Hn.ReadWrite,L.depthRangeFor3D);if(h!==1||v.paint.get("fill-extrusion-pattern").constantOr(1))xa(L,c,v,A,d,Tr.disabled,gr.disabled),xa(L,c,v,A,d,L.stencilModeFor3D(),L.colorModeForRenderPass());else{const w=L.colorModeForRenderPass();xa(L,c,v,A,d,Tr.disabled,w)}}},hillshade:function(L,c,v,A){if(L.renderPass!=="offscreen"&&L.renderPass!=="translucent")return;const h=L.context,d=L.depthModeForSublayer(0,Hn.ReadOnly),w=L.colorModeForRenderPass(),[b,S]=L.renderPass==="translucent"?L.stencilConfigForOverlap(A):[{},A];for(const P of S){const B=c.getTile(P);B.needsHillshadePrepare!==void 0&&B.needsHillshadePrepare&&L.renderPass==="offscreen"?Fl(L,B,v,d,Tr.disabled,w):L.renderPass==="translucent"&&Ol(L,P,B,v,d,b[P.overscaledZ],w)}h.viewport.set([0,0,L.width,L.height])},raster:function(L,c,v,A){if(L.renderPass!=="translucent"||v.paint.get("raster-opacity")===0||!A.length)return;const h=L.context,d=h.gl,w=c.getSource(),b=L.useProgram("raster"),S=L.colorModeForRenderPass(),[P,B]=w instanceof Tt?[{},A]:L.stencilConfigForOverlap(A),V=B[B.length-1].overscaledZ,W=!L.options.moving;for(const X of B){const ae=L.depthModeForSublayer(X.overscaledZ-V,v.paint.get("raster-opacity")===1?Hn.ReadWrite:Hn.ReadOnly,d.LESS),ne=c.getTile(X);ne.registerFadeDuration(v.paint.get("raster-fade-duration"));const ue=c.findLoadedParent(X,0),Ee=vr(ne,ue,c,v,L.transform,L.style.terrain);let Me,ve;const je=v.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;h.activeTexture.set(d.TEXTURE0),ne.texture.bind(je,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(d.TEXTURE1),ue?(ue.texture.bind(je,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),Me=Math.pow(2,ue.tileID.overscaledZ-ne.tileID.overscaledZ),ve=[ne.tileID.canonical.x*Me%1,ne.tileID.canonical.y*Me%1]):ne.texture.bind(je,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);const Se=L.style.terrain&&L.style.terrain.getTerrainData(X),$e=Se?X:null,xe=$e?$e.posMatrix:L.transform.calculatePosMatrix(X.toUnwrapped(),W),y=jn(xe,ve||[0,0],Me||1,Ee,v);w instanceof Tt?b.draw(h,d.TRIANGLES,ae,Tr.disabled,S,_r.disabled,y,Se,v.id,w.boundsBuffer,L.quadTriangleIndexBuffer,w.boundsSegments):b.draw(h,d.TRIANGLES,ae,P[X.overscaledZ],S,_r.disabled,y,Se,v.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments)}},background:function(L,c,v,A){const h=v.paint.get("background-color"),d=v.paint.get("background-opacity");if(d===0)return;const w=L.context,b=w.gl,S=L.transform,P=S.tileSize,B=v.paint.get("background-pattern");if(L.isPatternMissing(B))return;const V=!B&&h.a===1&&d===1&&L.opaquePassEnabledForLayer()?"opaque":"translucent";if(L.renderPass!==V)return;const W=Tr.disabled,X=L.depthModeForSublayer(0,V==="opaque"?Hn.ReadWrite:Hn.ReadOnly),ae=L.colorModeForRenderPass(),ne=L.useProgram(B?"backgroundPattern":"background"),ue=A||S.coveringTiles({tileSize:P,terrain:L.style.terrain});B&&(w.activeTexture.set(b.TEXTURE0),L.imageManager.bind(L.context));const Ee=v.getCrossfadeParameters();for(const Me of ue){const ve=A?Me.posMatrix:L.transform.calculatePosMatrix(Me.toUnwrapped()),je=B?MA(ve,d,L,B,{tileID:Me,tileSize:P},Ee):lu(ve,d,h),Se=L.style.terrain&&L.style.terrain.getTerrainData(Me);ne.draw(w,b.TRIANGLES,X,W,ae,_r.disabled,je,Se,v.id,L.tileExtentBuffer,L.quadTriangleIndexBuffer,L.tileExtentSegments)}},debug:function(L,c,v){for(let A=0;A<v.length;A++)yu(L,c,v[A])},custom:function(L,c,v){const A=L.context,h=v.implementation;if(L.renderPass==="offscreen"){const d=h.prerender;d&&(L.setCustomLayerDefaults(),A.setColorMode(L.colorModeForRenderPass()),d.call(h,A.gl,L.transform.customLayerMatrix()),A.setDirty(),L.setBaseState())}else if(L.renderPass==="translucent"){L.setCustomLayerDefaults(),A.setColorMode(L.colorModeForRenderPass()),A.setStencilMode(Tr.disabled);const d=h.renderingMode==="3d"?new Hn(L.context.gl.LEQUAL,Hn.ReadWrite,L.depthRangeFor3D):L.depthModeForSublayer(0,Hn.ReadOnly);A.setDepthMode(d),h.render(A.gl,L.transform.customLayerMatrix()),A.setDirty(),L.setBaseState(),A.bindFramebuffer.set(null)}}};class Ti{constructor(c,v){this.context=new js(c),this.transform=v,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.create(),renderTime:0},this.setup(),this.numSublayers=wt.maxUnderzooming+wt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new jt,this.gpuTimers={}}resize(c,v,A){if(this.width=c*A,this.height=v*A,this.pixelRatio=A,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const c=this.context,v=new o.PosArray;v.emplaceBack(0,0),v.emplaceBack(o.EXTENT,0),v.emplaceBack(0,o.EXTENT),v.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(v,pn.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const A=new o.PosArray;A.emplaceBack(0,0),A.emplaceBack(o.EXTENT,0),A.emplaceBack(0,o.EXTENT),A.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=c.createVertexBuffer(A,pn.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const h=new o.RasterBoundsArray;h.emplaceBack(0,0,0,0),h.emplaceBack(o.EXTENT,0,o.EXTENT,0),h.emplaceBack(0,o.EXTENT,0,o.EXTENT),h.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(h,_t.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const d=new o.PosArray;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(d,pn.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const w=new o.LineStripIndexArray;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(w);const b=new o.TriangleIndexArray;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(b),this.emptyTexture=new H(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA);const S=this.context.gl;this.stencilClearMode=new Tr({func:S.ALWAYS,mask:0},0,255,S.ZERO,S.ZERO,S.ZERO)}clearStencil(){const c=this.context,v=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const A=o.create();o.ortho(A,0,this.width,this.height,0,0,1),o.scale(A,A,[v.drawingBufferWidth,v.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,v.TRIANGLES,Hn.disabled,this.stencilClearMode,gr.disabled,_r.disabled,Te(A),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(c,v){if(this.currentStencilSource===c.source||!c.isTileClipped()||!v||!v.length)return;this.currentStencilSource=c.source;const A=this.context,h=A.gl;this.nextStencilID+v.length>256&&this.clearStencil(),A.setColorMode(gr.disabled),A.setDepthMode(Hn.disabled);const d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of v){const b=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,S=this.style.terrain&&this.style.terrain.getTerrainData(w);d.draw(A,h.TRIANGLES,Hn.disabled,new Tr({func:h.ALWAYS,mask:0},b,255,h.KEEP,h.KEEP,h.REPLACE),gr.disabled,_r.disabled,Te(w.posMatrix),S,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,v=this.context.gl;return new Tr({func:v.NOTEQUAL,mask:255},c,255,v.KEEP,v.KEEP,v.REPLACE)}stencilModeForClipping(c){const v=this.context.gl;return new Tr({func:v.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,v.KEEP,v.KEEP,v.REPLACE)}stencilConfigForOverlap(c){const v=this.context.gl,A=c.sort((w,b)=>b.overscaledZ-w.overscaledZ),h=A[A.length-1].overscaledZ,d=A[0].overscaledZ-h+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const w={};for(let b=0;b<d;b++)w[b+h]=new Tr({func:v.GEQUAL,mask:255},b+this.nextStencilID,255,v.KEEP,v.KEEP,v.REPLACE);return this.nextStencilID+=d,[w,A]}return[{[h]:Tr.disabled},A]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new gr([c.CONSTANT_COLOR,c.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?gr.unblended:gr.alphaBlended}depthModeForSublayer(c,v,A){if(!this.opaquePassEnabledForLayer())return Hn.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new Hn(A||this.context.gl.LEQUAL,v,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,v){this.style=c,this.options=v,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const A=this.style._order,h=this.style.sourceCaches,d=this.style.terrain&&new RA(this);for(const P in h){const B=h[P];B.used&&B.prepare(this.context)}const w={},b={},S={};for(const P in h){const B=h[P];w[P]=B.getVisibleCoordinates(),b[P]=w[P].slice().reverse(),S[P]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let P=0;P<A.length;P++)if(this.style._layers[A[P]].is3D()){this.opaquePassCutoff=P;break}if(d){this.opaquePassCutoff=0;const P=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!o.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||P.length)&&(o.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,V){const W=B.context,X=W.gl,ae=gr.unblended,ne=new Hn(X.LEQUAL,Hn.ReadWrite,[0,1]),ue=V.getTerrainMesh(),Ee=V.sourceCache.getRenderableTiles(),Me=B.useProgram("terrainDepth");W.bindFramebuffer.set(V.getFramebuffer("depth").framebuffer),W.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),W.clear({color:o.Color.transparent,depth:1});for(const ve of Ee){const je=V.getTerrainData(ve.tileID),Se=B.transform.calculatePosMatrix(ve.tileID.toUnwrapped());Me.draw(W,X.TRIANGLES,ne,Tr.disabled,ae,_r.backCCW,{u_matrix:Se},je,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments)}W.bindFramebuffer.set(null),W.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain),function(B,V){const W=B.context,X=W.gl,ae=gr.unblended,ne=new Hn(X.LEQUAL,Hn.ReadWrite,[0,1]),ue=V.getTerrainMesh(),Ee=V.getCoordsTexture(),Me=V.sourceCache.getRenderableTiles(),ve=B.useProgram("terrainCoords");W.bindFramebuffer.set(V.getFramebuffer("coords").framebuffer),W.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),W.clear({color:o.Color.transparent,depth:1}),V.coordsIndex=[];for(const je of Me){const Se=V.getTerrainData(je.tileID);W.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,Ee.texture);const $e=B.transform.calculatePosMatrix(je.tileID.toUnwrapped());ve.draw(W,X.TRIANGLES,ne,Tr.disabled,ae,_r.backCCW,{u_matrix:$e,u_terrain_coords_id:(255-V.coordsIndex.length)/255,u_texture:0},Se,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments),V.coordsIndex.push(je.tileID.key)}W.bindFramebuffer.set(null),W.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const P of A){const B=this.style._layers[P];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const V=b[B.source];(B.type==="custom"||V.length)&&this.renderLayer(this,h[B.source],B,V)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:v.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=v.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],!d)for(this.renderPass="opaque",this.currentLayer=A.length-1;this.currentLayer>=0;this.currentLayer--){const P=this.style._layers[A[this.currentLayer]],B=h[P.source],V=w[P.source];this._renderTileClippingMasks(P,V),this.renderLayer(this,B,P,V)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<A.length;this.currentLayer++){const P=this.style._layers[A[this.currentLayer]],B=h[P.source];if(d&&d.renderLayer(P))continue;const V=(P.type==="symbol"?S:b)[P.source];this._renderTileClippingMasks(P,w[P.source]),this.renderLayer(this,B,P,V)}if(this.options.showTileBoundaries){let P,B;Object.values(this.style._layers).forEach(V=>{V.source&&!V.isHidden(this.transform.zoom)&&(V.source!==(B&&B.id)&&(B=this.style.sourceCaches[V.source]),(!P||P.getSource().maxzoom<B.getSource().maxzoom)&&(P=B))}),P&&di.debug(this,P,P.getVisibleCoordinates())}this.options.showPadding&&function(P){const B=P.transform.padding;Yr(P,P.transform.height-(B.top||0),3,DA),Yr(P,B.bottom||0,3,hs),zr(P,B.left||0,3,mu),zr(P,P.transform.width-(B.right||0),3,Nl);const V=P.transform.centerPoint;(function(W,X,ae,ne){si(W,X-1,ae-10,2,20,ne),si(W,X-10,ae-1,20,2,ne)})(P,V.x,P.transform.height-V.y,Tc)}(this),this.context.setDefault()}renderLayer(c,v,A,h){A.isHidden(this.transform.zoom)||(A.type==="background"||A.type==="custom"||(h||[]).length)&&(this.id=A.id,this.gpuTimingStart(A),di[A.type](c,v,A,h,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const v=this.context.extTimerQuery;let A=this.gpuTimers[c.id];A||(A=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:v.createQueryEXT()}),A.calls++,v.beginQueryEXT(v.TIME_ELAPSED_EXT,A.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}queryGpuTimers(c){const v={};for(const A in c){const h=c[A],d=this.context.extTimerQuery,w=d.getQueryObjectEXT(h.query,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(h.query),v[A]=w}return v}translatePosMatrix(c,v,A,h,d){if(!A[0]&&!A[1])return c;const w=d?h==="map"?this.transform.angle:0:h==="viewport"?-this.transform.angle:0;if(w){const P=Math.sin(w),B=Math.cos(w);A=[A[0]*B-A[1]*P,A[0]*P+A[1]*B]}const b=[d?A[0]:Fr(v,A[0],this.transform.zoom),d?A[1]:Fr(v,A[1],this.transform.zoom),0],S=new Float32Array(16);return o.translate(S,c,b),S}saveTileTexture(c){const v=this._tileTextures[c.size[0]];v?v.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const v=this._tileTextures[c];return v&&v.length>0?v.pop():null}isPatternMissing(c){if(!c)return!1;if(!c.from||!c.to)return!0;const v=this.imageManager.getPattern(c.from.toString()),A=this.imageManager.getPattern(c.to.toString());return!v||!A}useProgram(c,v){this.cache=this.cache||{};const A=c+(v?v.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[A]||(this.cache[A]=new Qa(this.context,c,fi[c],v,Pl[c],this._showOverdrawInspector,this.style.terrain)),this.cache[A]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new H(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class fs{constructor(c,v){this.points=c,this.planes=v}static fromInvProjectionMatrix(c,v,A){const h=Math.pow(2,A),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const S=1/(b=o.transformMat4([],b,c))[3]/v*h;return o.mul$1(b,b,[S,S,1/b[3],S])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const S=o.sub([],d[b[0]],d[b[1]]),P=o.sub([],d[b[2]],d[b[1]]),B=o.normalize([],o.cross([],S,P)),V=-o.dot(B,d[b[1]]);return B.concat(V)});return new fs(d,w)}}class wa{constructor(c,v){this.min=c,this.max=v,this.center=o.scale$1([],o.add([],this.min,this.max),.5)}quadrant(c){const v=[c%2==0,c<2],A=o.clone$2(this.min),h=o.clone$2(this.max);for(let d=0;d<v.length;d++)A[d]=v[d]?this.min[d]:this.center[d],h[d]=v[d]?this.center[d]:this.max[d];return h[2]=this.max[2],new wa(A,h)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}intersects(c){const v=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let A=!0;for(let h=0;h<c.planes.length;h++){const d=c.planes[h];let w=0;for(let b=0;b<v.length;b++)o.dot$1(d,v[b])>=0&&w++;if(w===0)return 0;w!==v.length&&(A=!1)}if(A)return 2;for(let h=0;h<3;h++){let d=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let b=0;b<c.points.length;b++){const S=c.points[b][h]-this.min[h];d=Math.min(d,S),w=Math.max(w,S)}if(w<0||d>this.max[h]-this.min[h])return 0}return 1}}class Ki{constructor(c=0,v=0,A=0,h=0){if(isNaN(c)||c<0||isNaN(v)||v<0||isNaN(A)||A<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=v,this.left=A,this.right=h}interpolate(c,v,A){return v.top!=null&&c.top!=null&&(this.top=o.number(c.top,v.top,A)),v.bottom!=null&&c.bottom!=null&&(this.bottom=o.number(c.bottom,v.bottom,A)),v.left!=null&&c.left!=null&&(this.left=o.number(c.left,v.left,A)),v.right!=null&&c.right!=null&&(this.right=o.number(c.right,v.right,A)),this}getCenter(c,v){const A=o.clamp((this.left+c-this.right)/2,0,c),h=o.clamp((this.top+v-this.bottom)/2,0,v);return new o.pointGeometry(A,h)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Ki(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class To{constructor(c,v,A,h,d){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=d===void 0||!!d,this._minZoom=c||0,this._maxZoom=v||22,this._minPitch=A??0,this._maxPitch=h??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ki,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const c=new To(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c._center=this._center,c._elevation=this._elevation,c.zoom=this.zoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(c){const v=-o.wrap(c,-180,180)*Math.PI/180;var A;this.angle!==v&&(this._unmodified=!1,this.angle=v,this._calcMatrices(),this.rotationMatrix=(A=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(A[1]=0,A[2]=0),A[0]=1,A[3]=1,A),function(h,d,w){var b=d[0],S=d[1],P=d[2],B=d[3],V=Math.sin(w),W=Math.cos(w);h[0]=b*W+P*V,h[1]=S*W+B*V,h[2]=b*-V+P*W,h[3]=S*-V+B*W}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const v=o.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==v&&(this._unmodified=!1,this._pitch=v,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(c){const v=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==v&&(this._unmodified=!1,this._zoom=v,this.scale=this.zoomScale(v),this.tileZoom=Math.floor(v),this.zoomFraction=v-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(c){c!==this._elevation&&(this._elevation=c,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,v,A){this._unmodified=!1,this._edgeInsets.interpolate(c,v,A),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const v=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,v)}getVisibleUnwrappedCoordinates(c){const v=[new o.UnwrappedTileID(0,c)];if(this._renderWorldCopies){const A=this.pointCoordinate(new o.pointGeometry(0,0)),h=this.pointCoordinate(new o.pointGeometry(this.width,0)),d=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),w=this.pointCoordinate(new o.pointGeometry(0,this.height)),b=Math.floor(Math.min(A.x,h.x,d.x,w.x)),S=Math.floor(Math.max(A.x,h.x,d.x,w.x)),P=1;for(let B=b-P;B<=S+P;B++)B!==0&&v.push(new o.UnwrappedTileID(B,c))}return v}coveringTiles(c){var v,A;let h=this.coveringZoomLevel(c);const d=h;if(c.minzoom!==void 0&&h<c.minzoom)return[];c.maxzoom!==void 0&&h>c.maxzoom&&(h=c.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),b=o.MercatorCoordinate.fromLngLat(this.center),S=Math.pow(2,h),P=[S*w.x,S*w.y,0],B=[S*b.x,S*b.y,0],V=fs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h);let W=c.minzoom||0;!c.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(W=h);const X=c.terrain?2/Math.min(this.tileSize,c.tileSize)*this.tileSize:3,ae=ve=>({aabb:new wa([ve*S,0,0],[(ve+1)*S,S,0]),zoom:0,x:0,y:0,wrap:ve,fullyVisible:!1}),ne=[],ue=[],Ee=h,Me=c.reparseOverscaled?d:h;if(this._renderWorldCopies)for(let ve=1;ve<=3;ve++)ne.push(ae(-ve)),ne.push(ae(ve));for(ne.push(ae(0));ne.length>0;){const ve=ne.pop(),je=ve.x,Se=ve.y;let $e=ve.fullyVisible;if(!$e){const I=ve.aabb.intersects(V);if(I===0)continue;$e=I===2}const xe=c.terrain?P:B,y=ve.aabb.distanceX(xe),m=ve.aabb.distanceY(xe),x=Math.max(Math.abs(y),Math.abs(m)),E=X+(1<<Ee-ve.zoom)-2;if(ve.zoom===Ee||x>E&&ve.zoom>=W){const I=Ee-ve.zoom,R=P[0]-.5-(je<<I),O=P[1]-.5-(Se<<I);ue.push({tileID:new o.OverscaledTileID(ve.zoom===Ee?Me:ve.zoom,ve.wrap,ve.zoom,je,Se),distanceSq:o.sqrLen([B[0]-.5-je,B[1]-.5-Se]),tileDistanceToCamera:Math.sqrt(R*R+O*O)})}else for(let I=0;I<4;I++){const R=(je<<1)+I%2,O=(Se<<1)+(I>>1),U=ve.zoom+1;let q=ve.aabb.quadrant(I);if(c.terrain){const ee=new o.OverscaledTileID(U,ve.wrap,U,R,O),le=c.terrain.getMinMaxElevation(ee),de=(v=le.minElevation)!==null&&v!==void 0?v:this.elevation,Be=(A=le.maxElevation)!==null&&A!==void 0?A:this.elevation;q=new wa([q.min[0],q.min[1],de],[q.max[0],q.max[1],Be])}ne.push({aabb:q,zoom:U,x:R,y:O,wrap:ve.wrap,fullyVisible:$e})}}return ue.sort((ve,je)=>ve.distanceSq-je.distanceSq).map(ve=>ve.tileID)}resize(c,v){this.width=c,this.height=v,this.pixelsToGLUnits=[2/c,-2/v],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const v=o.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.pointGeometry(o.mercatorXfromLng(c.lng)*this.worldSize,o.mercatorYfromLat(v)*this.worldSize)}unproject(c){return new o.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(c){this.freezeElevation||(this.elevation=c?this.getElevation(this._center,c):0)}getElevation(c,v){const A=o.MercatorCoordinate.fromLngLat(c),h=(1<<this.tileZoom)*o.EXTENT,d=A.x*h,w=A.y*h,b=Math.floor(d/o.EXTENT),S=Math.floor(w/o.EXTENT),P=new o.OverscaledTileID(this.tileZoom,0,this.tileZoom,b,S);return v.getElevation(P,d%o.EXTENT,w%o.EXTENT,o.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(c){const v=this.pointLocation(this.centerPoint,c),A=this.getElevation(v,c);if(!(this.elevation-A))return;const h=this.getCameraPosition(),d=o.MercatorCoordinate.fromLngLat(h.lngLat,h.altitude),w=o.MercatorCoordinate.fromLngLat(v,A),b=d.x-w.x,S=d.y-w.y,P=d.z-w.z,B=Math.sqrt(b*b+S*S+P*P),V=this.scaleZoom(this.cameraToCenterDistance/B/this.tileSize);this._elevation=A,this._center=v,this.zoom=V}setLocationAtPoint(c,v){const A=this.pointCoordinate(v),h=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(c),w=new o.MercatorCoordinate(d.x-(A.x-h.x),d.y-(A.y-h.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(c,v){return v?this.coordinatePoint(this.locationCoordinate(c),this.getElevation(c,v),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(c))}pointLocation(c,v){return this.coordinateLocation(this.pointCoordinate(c,v))}locationCoordinate(c){return o.MercatorCoordinate.fromLngLat(c)}coordinateLocation(c){return c&&c.toLngLat()}pointCoordinate(c,v){if(v){const W=v.pointCoordinate(c);if(W!=null)return W}const A=[c.x,c.y,0,1],h=[c.x,c.y,1,1];o.transformMat4(A,A,this.pixelMatrixInverse),o.transformMat4(h,h,this.pixelMatrixInverse);const d=A[3],w=h[3],b=A[1]/d,S=h[1]/w,P=A[2]/d,B=h[2]/w,V=P===B?0:(0-P)/(B-P);return new o.MercatorCoordinate(o.number(A[0]/d,h[0]/w,V)/this.worldSize,o.number(b,S,V)/this.worldSize)}coordinatePoint(c,v=0,A=this.pixelMatrix){const h=[c.x*this.worldSize,c.y*this.worldSize,v,1];return o.transformMat4(h,h,A),new o.pointGeometry(h[0]/h[3],h[1]/h[3])}getBounds(){const c=Math.max(0,this.height/2-this.getHorizon());return new o.LngLatBounds().extend(this.pointLocation(new o.pointGeometry(0,c))).extend(this.pointLocation(new o.pointGeometry(this.width,c))).extend(this.pointLocation(new o.pointGeometry(this.width,this.height))).extend(this.pointLocation(new o.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(c,v=!1){const A=c.key,h=v?this._alignedPosMatrixCache:this._posMatrixCache;if(h[A])return h[A];const d=c.canonical,w=this.worldSize/this.zoomScale(d.z),b=d.x+Math.pow(2,d.z)*c.wrap,S=o.identity(new Float64Array(16));return o.translate(S,S,[b*w,d.y*w,0]),o.scale(S,S,[w/o.EXTENT,w/o.EXTENT,1]),o.multiply(S,v?this.alignedProjMatrix:this.projMatrix,S),h[A]=new Float32Array(S),h[A]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let c,v,A,h,d=-90,w=90,b=-180,S=180;const P=this.size,B=this._unmodified;if(this.latRange){const X=this.latRange;d=o.mercatorYfromLat(X[1])*this.worldSize,w=o.mercatorYfromLat(X[0])*this.worldSize,c=w-d<P.y?P.y/(w-d):0}if(this.lngRange){const X=this.lngRange;b=o.wrap(o.mercatorXfromLng(X[0])*this.worldSize,0,this.worldSize),S=o.wrap(o.mercatorXfromLng(X[1])*this.worldSize,0,this.worldSize),S<b&&(S+=this.worldSize),v=S-b<P.x?P.x/(S-b):0}const V=this.point,W=Math.max(v||0,c||0);if(W)return this.center=this.unproject(new o.pointGeometry(v?(S+b)/2:V.x,c?(w+d)/2:V.y)),this.zoom+=this.scaleZoom(W),this._unmodified=B,void(this._constraining=!1);if(this.latRange){const X=V.y,ae=P.y/2;X-ae<d&&(h=d+ae),X+ae>w&&(h=w-ae)}if(this.lngRange){const X=(b+S)/2,ae=o.wrap(V.x,X-this.worldSize/2,X+this.worldSize/2),ne=P.x/2;ae-ne<b&&(A=b+ne),ae+ne>S&&(A=S-ne)}A===void 0&&h===void 0||(this.center=this.unproject(new o.pointGeometry(A!==void 0?A:V.x,h!==void 0?h:V.y)).wrap()),this._unmodified=B,this._constraining=!1}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,v=this.point.x,A=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let h=o.identity(new Float64Array(16));o.scale(h,h,[this.width/2,-this.height/2,1]),o.translate(h,h,[1,-1,0]),this.labelPlaneMatrix=h,h=o.identity(new Float64Array(16)),o.scale(h,h,[1,-1,1]),o.translate(h,h,[-1,-1,0]),o.scale(h,h,[2/this.width,2/this.height,1]),this.glCoordMatrix=h,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const d=Math.PI/2+this._pitch,w=this._fov*(.5+c.y/this.height),b=Math.sin(w)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-d-w,.01,Math.PI-.01)),S=this.getHorizon(),P=2*Math.atan(S/this.cameraToCenterDistance)*(.5+c.y/(2*S)),B=Math.sin(P)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-d-P,.01,Math.PI-.01)),V=Math.cos(Math.PI/2-this._pitch)*b+this.cameraToSeaLevelDistance,W=Math.cos(Math.PI/2-this._pitch)*B+this.cameraToSeaLevelDistance,X=1.01*Math.min(V,W),ae=this.height/50;h=new Float64Array(16),o.perspective(h,this._fov,this.width/this.height,ae,X),h[8]=2*-c.x/this.width,h[9]=2*c.y/this.height,o.scale(h,h,[1,-1,1]),o.translate(h,h,[0,0,-this.cameraToCenterDistance]),o.rotateX(h,h,this._pitch),o.rotateZ(h,h,this.angle),o.translate(h,h,[-v,-A,0]),this.mercatorMatrix=o.scale([],h,[this.worldSize,this.worldSize,this.worldSize]),o.scale(h,h,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,h),o.translate(h,h,[0,0,-this.elevation]),this.projMatrix=h,this.invProjMatrix=o.invert([],h),this.pixelMatrix3D=o.multiply(new Float64Array(16),this.labelPlaneMatrix,h);const ne=this.width%2/2,ue=this.height%2/2,Ee=Math.cos(this.angle),Me=Math.sin(this.angle),ve=v-Math.round(v)+Ee*ne+Me*ue,je=A-Math.round(A)+Ee*ue+Me*ne,Se=new Float64Array(h);if(o.translate(Se,Se,[ve>.5?ve-1:ve,je>.5?je-1:je,0]),this.alignedProjMatrix=Se,h=o.invert(new Float64Array(16),this.pixelMatrix),!h)throw new Error("failed to invert matrix");this.pixelMatrixInverse=h,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const c=this.pointCoordinate(new o.pointGeometry(0,0)),v=[c.x*this.worldSize,c.y*this.worldSize,0,1];return o.transformMat4(v,v,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,c))}getCameraQueryGeometry(c){const v=this.getCameraPoint();if(c.length===1)return[c[0],v];{let A=v.x,h=v.y,d=v.x,w=v.y;for(const b of c)A=Math.min(A,b.x),h=Math.min(h,b.y),d=Math.max(d,b.x),w=Math.max(w,b.y);return[new o.pointGeometry(A,h),new o.pointGeometry(d,h),new o.pointGeometry(d,w),new o.pointGeometry(A,w),new o.pointGeometry(A,h)]}}}class yi{constructor(c){this._hashName=c&&encodeURIComponent(c),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(v,A){let h=!1,d=null;const w=()=>{d=null,h&&(v(),d=setTimeout(w,300),h=!1)};return()=>(h=!0,d||w(),d)}(this._updateHashUnthrottled.bind(this))}addTo(c){return this._map=c,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(c){const v=this._map.getCenter(),A=Math.round(100*this._map.getZoom())/100,h=Math.ceil((A*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,h),w=Math.round(v.lng*d)/d,b=Math.round(v.lat*d)/d,S=this._map.getBearing(),P=this._map.getPitch();let B="";if(B+=c?`/${w}/${b}/${A}`:`${A}/${b}/${w}`,(S||P)&&(B+="/"+Math.round(10*S)/10),P&&(B+=`/${Math.round(P)}`),this._hashName){const V=this._hashName;let W=!1;const X=window.location.hash.slice(1).split("&").map(ae=>{const ne=ae.split("=")[0];return ne===V?(W=!0,`${ne}=${B}`):ae}).filter(ae=>ae);return W||X.push(`${V}=${B}`),`#${X.join("&")}`}return`#${B}`}_getCurrentHash(){const c=window.location.hash.replace("#","");if(this._hashName){let v;return c.split("&").map(A=>A.split("=")).forEach(A=>{A[0]===this._hashName&&(v=A)}),(v&&v[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._getCurrentHash();if(c.length>=3&&!c.some(v=>isNaN(v))){const v=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:v,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,c)}catch{}}}const el={linearity:.3,easing:o.bezier(0,0,.3,1)},Ul=o.extend({deceleration:2500,maxSpeed:1400},el),tl=o.extend({deceleration:20,maxSpeed:1400},el),Qs=o.extend({deceleration:1e3,maxSpeed:360},el),ds=o.extend({deceleration:1e3,maxSpeed:90},el);class Cc{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,v=o.exported.now();for(;c.length>0&&v-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const v={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)v.zoom+=d.zoomDelta||0,v.bearing+=d.bearingDelta||0,v.pitch+=d.pitchDelta||0,d.panDelta&&v.pan._add(d.panDelta),d.around&&(v.around=d.around),d.pinchAround&&(v.pinchAround=d.pinchAround);const A=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(v.pan.mag()){const d=nl(v.pan.mag(),A,o.extend({},Ul,c||{}));h.offset=v.pan.mult(d.amount/v.pan.mag()),h.center=this._map.transform.center,ba(h,d)}if(v.zoom){const d=nl(v.zoom,A,tl);h.zoom=this._map.transform.zoom+d.amount,ba(h,d)}if(v.bearing){const d=nl(v.bearing,A,Qs);h.bearing=this._map.transform.bearing+o.clamp(d.amount,-179,179),ba(h,d)}if(v.pitch){const d=nl(v.pitch,A,ds);h.pitch=this._map.transform.pitch+d.amount,ba(h,d)}if(h.zoom||h.bearing){const d=v.pinchAround===void 0?v.around:v.pinchAround;h.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),o.extend(h,{noMoveStart:!0})}}function ba(L,c){(!L.duration||L.duration<c.duration)&&(L.duration=c.duration,L.easing=c.easing)}function nl(L,c,v){const{maxSpeed:A,linearity:h,deceleration:d}=v,w=o.clamp(L*h/(c/1e3),-A,A),b=Math.abs(w)/(d*h);return{easing:v.easing,duration:1e3*b,amount:w*(b/2)}}class oi extends o.Event{constructor(c,v,A,h={}){const d=k.mousePos(v.getCanvasContainer(),A),w=v.unproject(d);super(c,o.extend({point:d,lngLat:w,originalEvent:A},h)),this._defaultPrevented=!1,this.target=v}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Ps extends o.Event{constructor(c,v,A){const h=c==="touchend"?A.changedTouches:A.touches,d=k.touchPos(v.getCanvasContainer(),h),w=d.map(S=>v.unproject(S)),b=d.reduce((S,P,B,V)=>S.add(P.div(V.length)),new o.pointGeometry(0,0));super(c,{points:d,point:b,lngLats:w,lngLat:v.unproject(b),originalEvent:A}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Ji extends o.Event{constructor(c,v,A){super(c,{originalEvent:A}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Vl{constructor(c,v){this._map=c,this._clickTolerance=v.clickTolerance}reset(){delete this._mousedownPos}wheel(c){return this._firePreventable(new Ji(c.type,this._map,c))}mousedown(c,v){return this._mousedownPos=v,this._firePreventable(new oi(c.type,this._map,c))}mouseup(c){this._map.fire(new oi(c.type,this._map,c))}click(c,v){this._mousedownPos&&this._mousedownPos.dist(v)>=this._clickTolerance||this._map.fire(new oi(c.type,this._map,c))}dblclick(c){return this._firePreventable(new oi(c.type,this._map,c))}mouseover(c){this._map.fire(new oi(c.type,this._map,c))}mouseout(c){this._map.fire(new oi(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Ps(c.type,this._map,c))}touchmove(c){this._map.fire(new Ps(c.type,this._map,c))}touchend(c){this._map.fire(new Ps(c.type,this._map,c))}touchcancel(c){this._map.fire(new Ps(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Jo{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(c){this._map.fire(new oi(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new oi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._ignoreContextMenu||this._map.fire(new oi(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Mc{constructor(c,v){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=v.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,v){this.isEnabled()&&c.shiftKey&&c.button===0&&(k.disableDrag(),this._startPos=this._lastPos=v,this._active=!0)}mousemoveWindow(c,v){if(!this._active)return;const A=v;if(this._lastPos.equals(A)||!this._box&&A.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=A,this._box||(this._box=k.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const d=Math.min(h.x,A.x),w=Math.max(h.x,A.x),b=Math.min(h.y,A.y),S=Math.max(h.y,A.y);k.setTransform(this._box,`translate(${d}px,${b}px)`),this._box.style.width=w-d+"px",this._box.style.height=S-b+"px"}mouseupWindow(c,v){if(!this._active||c.button!==0)return;const A=this._startPos,h=v;if(this.reset(),k.suppressClick(),A.x!==h.x||A.y!==h.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:d=>d.fitScreenCoordinates(A,h,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",c)}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(k.remove(this._box),this._box=null),k.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(c,v){return this._map.fire(new o.Event(c,{originalEvent:v}))}}function So(L,c){if(L.length!==c.length)throw new Error(`The number of touches and points are not equal - touches ${L.length}, points ${c.length}`);const v={};for(let A=0;A<L.length;A++)v[L[A].identifier]=c[A];return v}class Gl{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(c,v,A){(this.centroid||A.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),A.length===this.numTouches&&(this.centroid=function(h){const d=new o.pointGeometry(0,0);for(const w of h)d._add(w);return d.div(h.length)}(v),this.touches=So(A,v)))}touchmove(c,v,A){if(this.aborted||!this.centroid)return;const h=So(A,v);for(const d in this.touches){const w=this.touches[d],b=h[d];(!b||b.dist(w)>30)&&(this.aborted=!0)}}touchend(c,v,A){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),A.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class rl{constructor(c){this.singleTap=new Gl(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(c,v,A){this.singleTap.touchstart(c,v,A)}touchmove(c,v,A){this.singleTap.touchmove(c,v,A)}touchend(c,v,A){const h=this.singleTap.touchend(c,v,A);if(h){const d=c.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(h)<30;if(d&&w||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class Dh{constructor(){this._zoomIn=new rl({numTouches:1,numTaps:2}),this._zoomOut=new rl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,v,A){this._zoomIn.touchstart(c,v,A),this._zoomOut.touchstart(c,v,A)}touchmove(c,v,A){this._zoomIn.touchmove(c,v,A),this._zoomOut.touchmove(c,v,A)}touchend(c,v,A){const h=this._zoomIn.touchend(c,v,A),d=this._zoomOut.touchend(c,v,A);return h?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(h)},{originalEvent:c})}):d?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(d)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Rh={0:1,2:2};class il{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(c,v){return!1}_move(c,v){return{}}mousedown(c,v){if(this._lastPoint)return;const A=k.mouseButton(c);this._correctButton(c,A)&&(this._lastPoint=v,this._eventButton=A)}mousemoveWindow(c,v){const A=this._lastPoint;if(A){if(c.preventDefault(),function(h,d){const w=Rh[d];return h.buttons===void 0||(h.buttons&w)!==w}(c,this._eventButton))this.reset();else if(this._moved||!(v.dist(A)<this._clickTolerance))return this._moved=!0,this._lastPoint=v,this._move(A,v)}}mouseupWindow(c){this._lastPoint&&k.mouseButton(c)===this._eventButton&&(this._moved&&k.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ea extends il{mousedown(c,v){super.mousedown(c,v),this._lastPoint&&(this._active=!0)}_correctButton(c,v){return v===0&&!c.ctrlKey}_move(c,v){return{around:v,panDelta:v.sub(c)}}}class ps extends il{_correctButton(c,v){return v===0&&c.ctrlKey||v===2}_move(c,v){const A=.8*(v.x-c.x);if(A)return this._active=!0,{bearingDelta:A}}contextmenu(c){c.preventDefault()}}class Nt extends il{_correctButton(c,v){return v===0&&c.ctrlKey||v===2}_move(c,v){const A=-.5*(v.y-c.y);if(A)return this._active=!0,{pitchDelta:A}}contextmenu(c){c.preventDefault()}}class _u{constructor(c,v){this._minTouches=c.cooperativeGestures?2:1,this._clickTolerance=c.clickTolerance||1,this._map=v,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(c,v,A){return this._calculateTransform(c,v,A)}touchmove(c,v,A){if(this._map._cooperativeGestures&&(this._minTouches===2&&A.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(c,!1,A.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(A.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,v,A)}touchend(c,v,A){this._calculateTransform(c,v,A),this._active&&A.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,v,A){A.length>0&&(this._active=!0);const h=So(A,v),d=new o.pointGeometry(0,0),w=new o.pointGeometry(0,0);let b=0;for(const P in h){const B=h[P],V=this._touches[P];V&&(d._add(B),w._add(B.sub(V)),b++,h[P]=B)}if(this._touches=h,b<this._minTouches||!w.mag())return;const S=w.div(b);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(b),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ta{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(c){}_move(c,v,A){return{}}touchstart(c,v,A){this._firstTwoTouches||A.length<2||(this._firstTwoTouches=[A[0].identifier,A[1].identifier],this._start([v[0],v[1]]))}touchmove(c,v,A){if(!this._firstTwoTouches)return;c.preventDefault();const[h,d]=this._firstTwoTouches,w=ea(A,v,h),b=ea(A,v,d);if(!w||!b)return;const S=this._aroundCenter?null:w.add(b).div(2);return this._move([w,b],S,c)}touchend(c,v,A){if(!this._firstTwoTouches)return;const[h,d]=this._firstTwoTouches,w=ea(A,v,h),b=ea(A,v,d);w&&b||(this._active&&k.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ea(L,c,v){for(let A=0;A<L.length;A++)if(L[A].identifier===v)return c[A]}function vu(L,c){return Math.log(L/c)/Math.LN2}class Vt extends Ta{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,v){const A=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(vu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:vu(this._distance,A),pinchAround:v}}}function BA(L,c){return 180*L.angleWith(c)/Math.PI}class $l extends Ta{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,v){const A=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:BA(this._vector,A),pinchAround:v}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const v=25/(Math.PI*this._minDiameter)*360,A=BA(c,this._startVector);return Math.abs(A)<v}}function zA(L){return Math.abs(L.y)>Math.abs(L.x)}class sl extends Ta{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(c,v,A){super.touchstart(c,v,A),this._currentTouchCount=A.length}_start(c){this._lastPoints=c,zA(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,v,A){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const h=c[0].sub(this._lastPoints[0]),d=c[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,d,A.timeStamp),this._valid?(this._lastPoints=c,this._active=!0,{pitchDelta:(h.y+d.y)/2*-.5}):void 0}gestureBeginsVertically(c,v,A){if(this._valid!==void 0)return this._valid;const h=c.mag()>=2,d=v.mag()>=2;if(!h&&!d)return;if(!h||!d)return this._firstMove===void 0&&(this._firstMove=A),A-this._firstMove<100&&void 0;const w=c.y>0==v.y>0;return zA(c)&&zA(v)&&w}}const qs={panStep:100,bearingStep:15,pitchStep:10};class xu{constructor(){const c=qs;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let v=0,A=0,h=0,d=0,w=0;switch(c.keyCode){case 61:case 107:case 171:case 187:v=1;break;case 189:case 109:case 173:v=-1;break;case 37:c.shiftKey?A=-1:(c.preventDefault(),d=-1);break;case 39:c.shiftKey?A=1:(c.preventDefault(),d=1);break;case 38:c.shiftKey?h=1:(c.preventDefault(),w=-1);break;case 40:c.shiftKey?h=-1:(c.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(A=0,h=0),{cameraAnimation:b=>{const S=b.getZoom();b.easeTo({duration:300,easeId:"keyboardHandler",easing:Bh,zoom:v?Math.round(S)+v*(c.shiftKey?2:1):S,bearing:b.getBearing()+A*this._bearingStep,pitch:b.getPitch()+h*this._pitchStep,offset:[-d*this._panStep,-w*this._panStep],center:b.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Bh(L){return L*(2-L)}const Pc=4.000244140625;class wu{constructor(c,v){this._map=c,this._el=c.getCanvasContainer(),this._handler=v,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&c.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;c.preventDefault()}let v=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const A=o.exported.now(),h=A-(this._lastWheelEventTime||0);this._lastWheelEventTime=A,v!==0&&v%Pc==0?this._type="wheel":v!==0&&Math.abs(v)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=v,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(h*v)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,v+=this._lastValue)),c.shiftKey&&v&&(v/=4),this._type&&(this._lastWheelEvent=c,this._delta-=v,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const v=k.mousePos(this._el,c);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(v)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>Pc?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&S!==0&&(S=1/S);const P=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(P*S))),this._type==="wheel"&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const v=typeof this._targetZoom=="number"?this._targetZoom:c.zoom,A=this._startZoom,h=this._easing;let d,w=!1;if(this._type==="wheel"&&A&&h){const b=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),S=h(b);d=o.number(A,v,S),b<1?this._frameId||(this._frameId=!0):w=!0}else d=v,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:d-c.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let v=o.ease;if(this._prevEase){const A=this._prevEase,h=(o.exported.now()-A.start)/A.duration,d=A.easing(h+.01)-A.easing(h),w=.27/Math.sqrt(d*d+1e-4)*.01,b=Math.sqrt(.0729-w*w);v=o.bezier(w,b,.25,1)}return this._prevEase={start:o.exported.now(),duration:c,easing:v},v}reset(){this._active=!1}}class bu{constructor(c,v){this._clickZoom=c,this._tapZoom=v}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Eu{constructor(){this.reset()}reset(){this._active=!1}dblclick(c,v){return c.preventDefault(),{cameraAnimation:A=>{A.easeTo({duration:300,zoom:A.getZoom()+(c.shiftKey?-1:1),around:A.unproject(v)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zs{constructor(){this._tap=new rl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(c,v,A){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?A.length>0&&(this._swipePoint=v[0],this._swipeTouch=A[0].identifier):this._tap.touchstart(c,v,A))}touchmove(c,v,A){if(this._tapTime){if(this._swipePoint){if(A[0].identifier!==this._swipeTouch)return;const h=v[0],d=h.y-this._swipePoint.y;return this._swipePoint=h,c.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(c,v,A)}touchend(c,v,A){this._tapTime?this._swipePoint&&A.length===0&&this.reset():this._tap.touchend(c,v,A)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zi{constructor(c,v,A){this._el=c,this._mousePan=v,this._touchPan=A}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Co{constructor(c,v,A){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=v,this._mousePitch=A}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Tu{constructor(c,v,A,h){this._el=c,this._touchZoom=v,this._touchRotate=A,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Sa=L=>L.zoom||L.drag||L.pitch||L.rotate;class Ur extends o.Event{}function jl(L){return L.panDelta&&L.panDelta.mag()||L.zoomDelta||L.bearingDelta||L.pitchDelta}class kc{constructor(c,v){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Cc(c),this._bearingSnap=v.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(v),o.bindAll(["handleEvent","handleWindowEvent"],this);const A=this._el;this._listeners=[[A,"touchstart",{passive:!0}],[A,"touchmove",{passive:!1}],[A,"touchend",void 0],[A,"touchcancel",void 0],[A,"mousedown",void 0],[A,"mousemove",void 0],[A,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[A,"mouseover",void 0],[A,"mouseout",void 0],[A,"dblclick",void 0],[A,"click",void 0],[A,"keydown",{capture:!1}],[A,"keyup",void 0],[A,"wheel",{passive:!1}],[A,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,d,w]of this._listeners)k.addEventListener(h,d,h===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[c,v,A]of this._listeners)k.removeEventListener(c,v,c===document?this.handleWindowEvent:this.handleEvent,A)}_addDefaultHandlers(c){const v=this._map,A=v.getCanvasContainer();this._add("mapEvent",new Vl(v,c));const h=v.boxZoom=new Mc(v,c);this._add("boxZoom",h);const d=new Dh,w=new Eu;v.doubleClickZoom=new bu(w,d),this._add("tapZoom",d),this._add("clickZoom",w);const b=new Zs;this._add("tapDragZoom",b);const S=v.touchPitch=new sl(v);this._add("touchPitch",S);const P=new ps(c),B=new Nt(c);v.dragRotate=new Co(c,P,B),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]);const V=new Ea(c),W=new _u(c,v);v.dragPan=new zi(A,V,W),this._add("mousePan",V),this._add("touchPan",W,["touchZoom","touchRotate"]);const X=new $l,ae=new Vt;v.touchZoomRotate=new Tu(A,ae,X,b),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",ae,["touchPan","touchRotate"]);const ne=v.scrollZoom=new wu(v,this);this._add("scrollZoom",ne,["mousePan"]);const ue=v.keyboard=new xu;this._add("keyboard",ue),this._add("blockableMapEvent",new Jo(v));for(const Ee of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[Ee]&&v[Ee].enable(c[Ee])}_add(c,v,A){this._handlers.push({handlerName:c,handler:v,allowed:A}),this._handlersById[c]=v}stop(c){if(!this._updatingCamera){for(const{handler:v}of this._handlers)v.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Sa(this._eventsInProgress)||this.isZooming()}_blockedByActive(c,v,A){for(const h in c)if(h!==A&&(!v||v.indexOf(h)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const v=[];for(const A of c)this._el.contains(A.target)&&v.push(A);return v}handleEvent(c,v){if(c.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const A=c.type==="renderFrame"?void 0:c,h={needsRenderFrame:!1},d={},w={},b=c.touches,S=b?this._getMapTouches(b):void 0,P=S?k.touchPos(this._el,S):k.mousePos(this._el,c);for(const{handlerName:W,handler:X,allowed:ae}of this._handlers){if(!X.isEnabled())continue;let ne;this._blockedByActive(w,ae,W)?X.reset():X[v||c.type]&&(ne=X[v||c.type](c,P,S),this.mergeHandlerResult(h,d,ne,W,A),ne&&ne.needsRenderFrame&&this._triggerRenderFrame()),(ne||X.isActive())&&(w[W]=X)}const B={};for(const W in this._previousActiveHandlers)w[W]||(B[W]=A);this._previousActiveHandlers=w,(Object.keys(B).length||jl(h))&&(this._changes.push([h,d,B]),this._triggerRenderFrame()),(Object.keys(w).length||jl(h))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=h;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))}mergeHandlerResult(c,v,A,h,d){if(!A)return;o.extend(c,A);const w={handlerName:h,originalEvent:A.originalEvent||d};A.zoomDelta!==void 0&&(v.zoom=w),A.panDelta!==void 0&&(v.drag=w),A.pitchDelta!==void 0&&(v.pitch=w),A.bearingDelta!==void 0&&(v.rotate=w)}_applyChanges(){const c={},v={},A={};for(const[h,d,w]of this._changes)h.panDelta&&(c.panDelta=(c.panDelta||new o.pointGeometry(0,0))._add(h.panDelta)),h.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+h.pitchDelta),h.around!==void 0&&(c.around=h.around),h.pinchAround!==void 0&&(c.pinchAround=h.pinchAround),h.noInertia&&(c.noInertia=h.noInertia),o.extend(v,d),o.extend(A,w);this._updateMapTransform(c,v,A),this._changes=[]}_updateMapTransform(c,v,A){const h=this._map,d=h.transform,w=h.style&&h.style.terrain;if(!(jl(c)||w&&this._drag))return this._fireEvents(v,A,!0);let{panDelta:b,zoomDelta:S,bearingDelta:P,pitchDelta:B,around:V,pinchAround:W}=c;W!==void 0&&(V=W),h._stop(!0),V=V||h.transform.centerPoint;const X=d.pointLocation(b?V.sub(b):V);P&&(d.bearing+=P),B&&(d.pitch+=B),S&&(d.zoom+=S),w?v.drag&&!this._drag?(this._drag={center:d.centerPoint,lngLat:d.pointLocation(V),point:V,handlerName:v.drag.handlerName},h.fire(new o.Event("freezeElevation",{freeze:!0}))):this._drag&&A[this._drag.handlerName]?(h.fire(new o.Event("freezeElevation",{freeze:!1})),this._drag=null):v.drag&&this._drag&&(d.center=d.pointLocation(d.centerPoint.sub(b))):d.setLocationAtPoint(X,V),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(v,A,!0)}_fireEvents(c,v,A){const h=Sa(this._eventsInProgress),d=Sa(c),w={};for(const B in c){const{originalEvent:V}=c[B];this._eventsInProgress[B]||(w[`${B}start`]=V),this._eventsInProgress[B]=c[B]}!h&&d&&this._fireEvent("movestart",d.originalEvent);for(const B in w)this._fireEvent(B,w[B]);d&&this._fireEvent("move",d.originalEvent);for(const B in c){const{originalEvent:V}=c[B];this._fireEvent(B,V)}const b={};let S;for(const B in this._eventsInProgress){const{handlerName:V,originalEvent:W}=this._eventsInProgress[B];this._handlersById[V].isActive()||(delete this._eventsInProgress[B],S=v[V]||W,b[`${B}end`]=S)}for(const B in b)this._fireEvent(B,b[B]);const P=Sa(this._eventsInProgress);if(A&&(h||d)&&!P){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;B?(V(B.bearing||this._map.getBearing())&&(B.bearing=0),this._map.easeTo(B,{originalEvent:S})):(this._map.fire(new o.Event("moveend",{originalEvent:S})),V(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,v){this._map.fire(new o.Event(c,v?{originalEvent:v}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{delete this._frameId,this.handleEvent(new Ur("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const gs={extend:(L,...c)=>o.extend(L,...c),run(L){L()},logToElement(L,c=!1,v="log"){const A=window.document.getElementById(v);A&&(c&&(A.innerHTML=""),A.innerHTML+=`<br>${L}`)}};class Pr extends o.Evented{constructor(c,v){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=v.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,v){return this.jumpTo({center:c},v)}panBy(c,v,A){return c=o.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,o.extend({offset:c},v),A)}panTo(c,v,A){return this.easeTo(o.extend({center:c},v),A)}getZoom(){return this.transform.zoom}setZoom(c,v){return this.jumpTo({zoom:c},v),this}zoomTo(c,v,A){return this.easeTo(o.extend({zoom:c},v),A)}zoomIn(c,v){return this.zoomTo(this.getZoom()+1,c,v),this}zoomOut(c,v){return this.zoomTo(this.getZoom()-1,c,v),this}getBearing(){return this.transform.bearing}setBearing(c,v){return this.jumpTo({bearing:c},v),this}getPadding(){return this.transform.padding}setPadding(c,v){return this.jumpTo({padding:c},v),this}rotateTo(c,v,A){return this.easeTo(o.extend({bearing:c},v),A)}resetNorth(c,v){return this.rotateTo(0,o.extend({duration:1e3},c),v),this}resetNorthPitch(c,v){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},c),v),this}snapToNorth(c,v){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,v):this}getPitch(){return this.transform.pitch}setPitch(c,v){return this.jumpTo({pitch:c},v),this}cameraForBounds(c,v){c=o.LngLatBounds.convert(c);const A=v&&v.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),A,v)}_cameraForBoxAndBearing(c,v,A,h){const d={top:0,bottom:0,right:0,left:0};if(typeof(h=o.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const Se=h.padding;h.padding={top:Se,bottom:Se,right:Se,left:Se}}h.padding=o.extend(d,h.padding);const w=this.transform,b=w.padding,S=w.project(o.LngLat.convert(c)),P=w.project(o.LngLat.convert(v)),B=S.rotate(-A*Math.PI/180),V=P.rotate(-A*Math.PI/180),W=new o.pointGeometry(Math.max(B.x,V.x),Math.max(B.y,V.y)),X=new o.pointGeometry(Math.min(B.x,V.x),Math.min(B.y,V.y)),ae=W.sub(X),ne=(w.width-(b.left+b.right+h.padding.left+h.padding.right))/ae.x,ue=(w.height-(b.top+b.bottom+h.padding.top+h.padding.bottom))/ae.y;if(ue<0||ne<0)return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ee=Math.min(w.scaleZoom(w.scale*Math.min(ne,ue)),h.maxZoom),Me=o.pointGeometry.convert(h.offset),ve=new o.pointGeometry((h.padding.left-h.padding.right)/2,(h.padding.top-h.padding.bottom)/2).rotate(A*Math.PI/180),je=Me.add(ve).mult(w.scale/w.zoomScale(Ee));return{center:w.unproject(S.add(P).div(2).sub(je)),zoom:Ee,bearing:A}}fitBounds(c,v,A){return this._fitInternal(this.cameraForBounds(c,v),v,A)}fitScreenCoordinates(c,v,A,h,d){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.pointGeometry.convert(c)),this.transform.pointLocation(o.pointGeometry.convert(v)),A,h),h,d)}_fitInternal(c,v,A){return c?(delete(v=o.extend(c,v)).padding,v.linear?this.easeTo(v,A):this.flyTo(v,A)):this}jumpTo(c,v){this.stop();const A=this.transform;let h=!1,d=!1,w=!1;return"zoom"in c&&A.zoom!==+c.zoom&&(h=!0,A.zoom=+c.zoom),c.center!==void 0&&(A.center=o.LngLat.convert(c.center)),"bearing"in c&&A.bearing!==+c.bearing&&(d=!0,A.bearing=+c.bearing),"pitch"in c&&A.pitch!==+c.pitch&&(w=!0,A.pitch=+c.pitch),c.padding==null||A.isPaddingEqual(c.padding)||(A.padding=c.padding),this.fire(new o.Event("movestart",v)).fire(new o.Event("move",v)),h&&this.fire(new o.Event("zoomstart",v)).fire(new o.Event("zoom",v)).fire(new o.Event("zoomend",v)),d&&this.fire(new o.Event("rotatestart",v)).fire(new o.Event("rotate",v)).fire(new o.Event("rotateend",v)),w&&this.fire(new o.Event("pitchstart",v)).fire(new o.Event("pitch",v)).fire(new o.Event("pitchend",v)),this.fire(new o.Event("moveend",v))}calculateCameraOptionsFromTo(c,v,A,h=0){const d=o.MercatorCoordinate.fromLngLat(c,v),w=o.MercatorCoordinate.fromLngLat(A,h),b=w.x-d.x,S=w.y-d.y,P=w.z-d.z,B=Math.hypot(b,S,P);if(B===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(b,S),W=this.transform.scaleZoom(this.transform.cameraToCenterDistance/B/this.transform.tileSize),X=180*Math.atan2(b,-S)/Math.PI;let ae=180*Math.acos(V/B)/Math.PI;return ae=P<0?90-ae:90+ae,{center:w.toLngLat(),zoom:W,pitch:ae,bearing:X}}easeTo(c,v){this._stop(!1,c.easeId),((c=o.extend({offset:[0,0],duration:500,easing:o.ease},c)).animate===!1||!c.essential&&o.exported.prefersReducedMotion)&&(c.duration=0);const A=this.transform,h=this.getZoom(),d=this.getBearing(),w=this.getPitch(),b=this.getPadding(),S="zoom"in c?+c.zoom:h,P="bearing"in c?this._normalizeBearing(c.bearing,d):d,B="pitch"in c?+c.pitch:w,V="padding"in c?c.padding:A.padding,W=o.pointGeometry.convert(c.offset);let X=A.centerPoint.add(W);const ae=A.pointLocation(X),ne=o.LngLat.convert(c.center||ae);this._normalizeCenter(ne);const ue=A.project(ae),Ee=A.project(ne).sub(ue),Me=A.zoomScale(S-h);let ve,je;c.around&&(ve=o.LngLat.convert(c.around),je=A.locationPoint(ve));const Se={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||S!==h,this._rotating=this._rotating||d!==P,this._pitching=this._pitching||B!==w,this._padding=!A.isPaddingEqual(V),this._easeId=c.easeId,this._prepareEase(v,c.noMoveStart,Se),this._ease($e=>{if(this._zooming&&(A.zoom=o.number(h,S,$e)),this._rotating&&(A.bearing=o.number(d,P,$e)),this._pitching&&(A.pitch=o.number(w,B,$e)),this._padding&&(A.interpolatePadding(b,V,$e),X=A.centerPoint.add(W)),ve)A.setLocationAtPoint(ve,je);else{const xe=A.zoomScale(A.zoom-h),y=S>h?Math.min(2,Me):Math.max(.5,Me),m=Math.pow(y,1-$e),x=A.unproject(ue.add(Ee.mult($e*m)).mult(xe));A.setLocationAtPoint(A.renderWorldCopies?x.wrap():x,X)}this._fireMoveEvents(v)},$e=>{this._afterEase(v,$e)},c),this}_prepareEase(c,v,A={}){this._moving=!0,this.fire(new o.Event("freezeElevation",{freeze:!0})),v||A.moving||this.fire(new o.Event("movestart",c)),this._zooming&&!A.zooming&&this.fire(new o.Event("zoomstart",c)),this._rotating&&!A.rotating&&this.fire(new o.Event("rotatestart",c)),this._pitching&&!A.pitching&&this.fire(new o.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new o.Event("move",c)),this._zooming&&this.fire(new o.Event("zoom",c)),this._rotating&&this.fire(new o.Event("rotate",c)),this._pitching&&this.fire(new o.Event("pitch",c))}_afterEase(c,v){if(this._easeId&&v&&this._easeId===v)return;delete this._easeId,this.fire(new o.Event("freezeElevation",{freeze:!1}));const A=this._zooming,h=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,A&&this.fire(new o.Event("zoomend",c)),h&&this.fire(new o.Event("rotateend",c)),d&&this.fire(new o.Event("pitchend",c)),this.fire(new o.Event("moveend",c))}flyTo(c,v){if(!c.essential&&o.exported.prefersReducedMotion){const U=o.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(U,v)}this.stop(),c=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},c);const A=this.transform,h=this.getZoom(),d=this.getBearing(),w=this.getPitch(),b=this.getPadding(),S="zoom"in c?o.clamp(+c.zoom,A.minZoom,A.maxZoom):h,P="bearing"in c?this._normalizeBearing(c.bearing,d):d,B="pitch"in c?+c.pitch:w,V="padding"in c?c.padding:A.padding,W=A.zoomScale(S-h),X=o.pointGeometry.convert(c.offset);let ae=A.centerPoint.add(X);const ne=A.pointLocation(ae),ue=o.LngLat.convert(c.center||ne);this._normalizeCenter(ue);const Ee=A.project(ne),Me=A.project(ue).sub(Ee);let ve=c.curve;const je=Math.max(A.width,A.height),Se=je/W,$e=Me.mag();if("minZoom"in c){const U=o.clamp(Math.min(c.minZoom,h,S),A.minZoom,A.maxZoom),q=je/A.zoomScale(U-h);ve=Math.sqrt(q/$e*2)}const xe=ve*ve;function y(U){const q=(Se*Se-je*je+(U?-1:1)*xe*xe*$e*$e)/(2*(U?Se:je)*xe*$e);return Math.log(Math.sqrt(q*q+1)-q)}function m(U){return(Math.exp(U)-Math.exp(-U))/2}function x(U){return(Math.exp(U)+Math.exp(-U))/2}const E=y(0);let I=function(U){return x(E)/x(E+ve*U)},R=function(U){return je*((x(E)*(m(q=E+ve*U)/x(q))-m(E))/xe)/$e;var q},O=(y(1)-E)/ve;if(Math.abs($e)<1e-6||!isFinite(O)){if(Math.abs(je-Se)<1e-6)return this.easeTo(c,v);const U=Se<je?-1:1;O=Math.abs(Math.log(Se/je))/ve,R=function(){return 0},I=function(q){return Math.exp(U*ve*q)}}return c.duration="duration"in c?+c.duration:1e3*O/("screenSpeed"in c?+c.screenSpeed/ve:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=d!==P,this._pitching=B!==w,this._padding=!A.isPaddingEqual(V),this._prepareEase(v,!1),this._ease(U=>{const q=U*O,ee=1/I(q);A.zoom=U===1?S:h+A.scaleZoom(ee),this._rotating&&(A.bearing=o.number(d,P,U)),this._pitching&&(A.pitch=o.number(w,B,U)),this._padding&&(A.interpolatePadding(b,V,U),ae=A.centerPoint.add(X));const le=U===1?ue:A.unproject(Ee.add(Me.mult(R(q))).mult(ee));A.setLocationAtPoint(A.renderWorldCopies?le.wrap():le,ae),this._fireMoveEvents(v)},()=>this._afterEase(v),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,v){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const A=this._onEaseEnd;delete this._onEaseEnd,A.call(this,v)}if(!c){const A=this.handlers;A&&A.stop(!1)}return this}_ease(c,v,A){A.animate===!1||A.duration===0?(c(1),v()):(this._easeStart=o.exported.now(),this._easeOptions=A,this._onEaseFrame=c,this._onEaseEnd=v,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,v){c=o.wrap(c,-180,180);const A=Math.abs(c-v);return Math.abs(c-360-v)<A&&(c-=360),Math.abs(c+360-v)<A&&(c+=360),c}_normalizeCenter(c){const v=this.transform;if(!v.renderWorldCopies||v.lngRange)return;const A=c.lng-v.center.lng;c.lng+=A>180?-360:A<-180?360:0}}class ol{constructor(c={}){this.options=c,o.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){return this._map=c,this._compact=this.options&&this.options.compact,this._container=k.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=k.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=k.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){k.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(c,v){const A=this._map._getUIString(`AttributionControl.${v}`);c.title=A,c.setAttribute("aria-label",A)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const v=this._map.style.sourceCaches;for(const h in v){const d=v[h];if(d.used||d.usedForTerrain){const w=d.getSource();w.attribution&&c.indexOf(w.attribution)<0&&c.push(w.attribution)}}c=c.filter(h=>String(h).trim()),c.sort((h,d)=>h.length-d.length),c=c.filter((h,d)=>{for(let w=d+1;w<c.length;w++)if(c[w].indexOf(h)>=0)return!1;return!0});const A=c.join(" | ");A!==this._attribHTML&&(this._attribHTML=A,c.length?(this._innerContainer.innerHTML=A,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Hl{constructor(c={}){this.options=c,o.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(c){this._map=c,this._compact=this.options&&this.options.compact,this._container=k.create("div","maplibregl-ctrl mapboxgl-ctrl");const v=k.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return v.target="_blank",v.rel="noopener nofollow",v.href="https://maplibre.org/",v.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),v.setAttribute("rel","noopener nofollow"),this._container.appendChild(v),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){k.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const c=this._container.children;if(c.length){const v=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&v.classList.add("maplibregl-compact","mapboxgl-compact"):v.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class Su{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const v=++this._id;return this._queue.push({callback:c,id:v,cancelled:!1}),v}remove(c){const v=this._currentlyRunning,A=v?this._queue.concat(v):this._queue;for(const h of A)if(h.id===c)return void(h.cancelled=!0)}run(c=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const v=this._currentlyRunning=this._queue;this._queue=[];for(const A of v)if(!A.cancelled&&(A.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Ic={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},Cu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Lc={showCompass:!0,showZoom:!0,visualizePitch:!1};class xr{constructor(c,v,A=!1){this._clickTolerance=10,this.element=v,this.mouseRotate=new ps({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,A&&(this.mousePitch=new Nt({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),k.addEventListener(v,"mousedown",this.mousedown),k.addEventListener(v,"touchstart",this.touchstart,{passive:!1}),k.addEventListener(v,"touchmove",this.touchmove),k.addEventListener(v,"touchend",this.touchend),k.addEventListener(v,"touchcancel",this.reset)}down(c,v){this.mouseRotate.mousedown(c,v),this.mousePitch&&this.mousePitch.mousedown(c,v),k.disableDrag()}move(c,v){const A=this.map,h=this.mouseRotate.mousemoveWindow(c,v);if(h&&h.bearingDelta&&A.setBearing(A.getBearing()+h.bearingDelta),this.mousePitch){const d=this.mousePitch.mousemoveWindow(c,v);d&&d.pitchDelta&&A.setPitch(A.getPitch()+d.pitchDelta)}}off(){const c=this.element;k.removeEventListener(c,"mousedown",this.mousedown),k.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),k.removeEventListener(c,"touchmove",this.touchmove),k.removeEventListener(c,"touchend",this.touchend),k.removeEventListener(c,"touchcancel",this.reset),this.offTemp()}offTemp(){k.enableDrag(),k.removeEventListener(window,"mousemove",this.mousemove),k.removeEventListener(window,"mouseup",this.mouseup)}mousedown(c){this.down(o.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),k.mousePos(this.element,c)),k.addEventListener(window,"mousemove",this.mousemove),k.addEventListener(window,"mouseup",this.mouseup)}mousemove(c){this.move(c,k.mousePos(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=k.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){c.targetTouches.length!==1?this.reset():(this._lastPos=k.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Wl(L,c,v){if(L=new o.LngLat(L.lng,L.lat),c){const A=new o.LngLat(L.lng-360,L.lat),h=new o.LngLat(L.lng+360,L.lat),d=v.locationPoint(L).distSqr(c);v.locationPoint(A).distSqr(c)<d?L=A:v.locationPoint(h).distSqr(c)<d&&(L=h)}for(;Math.abs(L.lng-v.center.lng)>180;){const A=v.locationPoint(L);if(A.x>=0&&A.y>=0&&A.x<=v.width&&A.y<=v.height)break;L.lng>v.center.lng?L.lng-=360:L.lng+=360}return L}const Xt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Kt(L,c,v){const A=L.classList;for(const h in Xt)A.remove(`maplibregl-${v}-anchor-${h}`,`mapboxgl-${v}-anchor-${h}`);A.add(`maplibregl-${v}-anchor-${c}`,`mapboxgl-${v}-anchor-${c}`)}class fn extends o.Evented{constructor(c,v){if(super(),(c instanceof HTMLElement||v)&&(c=o.extend({element:c},v)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment!=="auto"?c.pitchAlignment:this._rotationAlignment,c&&c.element)this._element=c.element,this._offset=o.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=k.create("div"),this._element.setAttribute("aria-label","Map marker");const A=k.createNS("http://www.w3.org/2000/svg","svg"),h=41,d=27;A.setAttributeNS(null,"display","block"),A.setAttributeNS(null,"height",`${h}px`),A.setAttributeNS(null,"width",`${d}px`),A.setAttributeNS(null,"viewBox",`0 0 ${d} ${h}`);const w=k.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const b=k.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const S=k.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Me of P){const ve=k.createNS("http://www.w3.org/2000/svg","ellipse");ve.setAttributeNS(null,"opacity","0.04"),ve.setAttributeNS(null,"cx","10.5"),ve.setAttributeNS(null,"cy","5.80029008"),ve.setAttributeNS(null,"rx",Me.rx),ve.setAttributeNS(null,"ry",Me.ry),S.appendChild(ve)}const B=k.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const V=k.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(V);const W=k.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"opacity","0.25"),W.setAttributeNS(null,"fill","#000000");const X=k.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),W.appendChild(X);const ae=k.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ae.setAttributeNS(null,"fill","#FFFFFF");const ne=k.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ue=k.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#000000"),ue.setAttributeNS(null,"opacity","0.25"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962");const Ee=k.createNS("http://www.w3.org/2000/svg","circle");Ee.setAttributeNS(null,"fill","#FFFFFF"),Ee.setAttributeNS(null,"cx","5.5"),Ee.setAttributeNS(null,"cy","5.5"),Ee.setAttributeNS(null,"r","5.4999962"),ne.appendChild(ue),ne.appendChild(Ee),b.appendChild(S),b.appendChild(B),b.appendChild(W),b.appendChild(ae),b.appendChild(ne),A.appendChild(b),A.setAttributeNS(null,"height",h*this._scale+"px"),A.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(A),this._offset=o.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",A=>{A.preventDefault()}),this._element.addEventListener("mousedown",A=>{A.preventDefault()}),Kt(this._element,this._anchor,"marker"),this._popup=null}addTo(c){return this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),k.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=o.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const h=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(c){const v=c.code,A=c.charCode||c.keyCode;v!=="Space"&&v!=="Enter"&&A!==32&&A!==13||this.togglePopup()}_onMapClick(c){const v=c.originalEvent.target,A=this._element;this._popup&&(v===A||A.contains(v))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?c.remove():c.addTo(this._map),this):this}_update(c){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Wl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let A="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?A="rotateX(0deg)":this._pitchAlignment==="map"&&(A=`rotateX(${this._map.getPitch()}deg)`),c&&c.type!=="moveend"||(this._pos=this._pos.round()),k.setTransform(this._element,`${Xt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${A} ${v}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const h=this._map.unproject(this._pos),d=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=h.distanceTo(this._lngLat)>20*d?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(c){return this._offset=o.pointGeometry.convert(c),this._update(),this}_onMove(c){if(!this._isDragging){const v=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=v}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(c){this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c&&c!=="auto"?c:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const es={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ta,jr=0,Ys=!1;const ks={maxWidth:100,unit:"metric"};function Xs(L,c,v){const A=v&&v.maxWidth||100,h=L._container.clientHeight/2,d=L.unproject([0,h]),w=L.unproject([A,h]),b=d.distanceTo(w);if(v&&v.unit==="imperial"){const S=3.2808*b;S>5280?Ct(c,A,S/5280,L._getUIString("ScaleControl.Miles")):Ct(c,A,S,L._getUIString("ScaleControl.Feet"))}else v&&v.unit==="nautical"?Ct(c,A,b/1852,L._getUIString("ScaleControl.NauticalMiles")):b>=1e3?Ct(c,A,b/1e3,L._getUIString("ScaleControl.Kilometers")):Ct(c,A,b,L._getUIString("ScaleControl.Meters"))}function Ct(L,c,v,A){const h=function(d){const w=Math.pow(10,`${Math.floor(d)}`.length-1);let b=d/w;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(S){const P=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*P)/P}(b),w*b}(v);L.style.width=c*(h/v)+"px",L.innerHTML=`${h}&nbsp;${A}`}const Pt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Hr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function al(L){if(L){if(typeof L=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(L,2)));return{center:new o.pointGeometry(0,0),top:new o.pointGeometry(0,L),"top-left":new o.pointGeometry(c,c),"top-right":new o.pointGeometry(-c,c),bottom:new o.pointGeometry(0,-L),"bottom-left":new o.pointGeometry(c,-c),"bottom-right":new o.pointGeometry(-c,-c),left:new o.pointGeometry(L,0),right:new o.pointGeometry(-L,0)}}if(L instanceof o.pointGeometry||Array.isArray(L)){const c=o.pointGeometry.convert(L);return{center:c,top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}return{center:o.pointGeometry.convert(L.center||[0,0]),top:o.pointGeometry.convert(L.top||[0,0]),"top-left":o.pointGeometry.convert(L["top-left"]||[0,0]),"top-right":o.pointGeometry.convert(L["top-right"]||[0,0]),bottom:o.pointGeometry.convert(L.bottom||[0,0]),"bottom-left":o.pointGeometry.convert(L["bottom-left"]||[0,0]),"bottom-right":o.pointGeometry.convert(L["bottom-right"]||[0,0]),left:o.pointGeometry.convert(L.left||[0,0]),right:o.pointGeometry.convert(L.right||[0,0])}}return al(new o.pointGeometry(0,0))}const Ks={supported:p,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends Pr{constructor(L){var c;if(o.PerformanceUtils.mark(o.PerformanceMarkers.create),(L=o.extend({},Cu,L)).minZoom!=null&&L.maxZoom!=null&&L.minZoom>L.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(L.minPitch!=null&&L.maxPitch!=null&&L.minPitch>L.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(L.minPitch!=null&&L.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(L.maxPitch!=null&&L.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new To(L.minZoom,L.maxZoom,L.minPitch,L.maxPitch,L.renderWorldCopies),{bearingSnap:L.bearingSnap}),this._interactive=L.interactive,this._cooperativeGestures=L.cooperativeGestures,this._maxTileCacheSize=L.maxTileCacheSize,this._failIfMajorPerformanceCaveat=L.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=L.preserveDrawingBuffer,this._antialias=L.antialias,this._trackResize=L.trackResize,this._bearingSnap=L.bearingSnap,this._refreshExpiredTiles=L.refreshExpiredTiles,this._fadeDuration=L.fadeDuration,this._crossSourceCollisions=L.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=L.collectResourceTiming,this._renderTaskQueue=new Su,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},Ic,L.locale),this._clickTolerance=L.clickTolerance,this._pixelRatio=(c=L.pixelRatio)!==null&&c!==void 0?c:devicePixelRatio,this._requestManager=new F(L.transformRequest),typeof L.container=="string"){if(this._container=document.getElementById(L.container),!this._container)throw new Error(`Container '${L.container}' not found.`)}else{if(!(L.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=L.container}if(L.maxBounds&&this.setMaxBounds(L.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new kc(this,L),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=L.hash&&new yi(typeof L.hash=="string"&&L.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:L.center,zoom:L.zoom,bearing:L.bearing,pitch:L.pitch}),L.bounds&&(this.resize(),this.fitBounds(L.bounds,o.extend({},L.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=L.localIdeographFontFamily,L.style&&this.setStyle(L.style,{localIdeographFontFamily:L.localIdeographFontFamily}),L.attributionControl&&this.addControl(new ol({customAttribution:L.customAttribution})),L.maplibreLogo&&this.addControl(new Hl,L.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",v=>{this._update(v.dataType==="style"),this.fire(new o.Event(`${v.dataType}data`,v))}),this.on("dataloading",v=>{this.fire(new o.Event(`${v.dataType}dataloading`,v))}),this.on("dataabort",v=>{this.fire(new o.Event("sourcedataabort",v))})}_getMapId(){return this._mapId}addControl(L,c){if(c===void 0&&(c=L.getDefaultPosition?L.getDefaultPosition():"top-right"),!L||!L.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const v=L.onAdd(this);this._controls.push(L);const A=this._controlPositions[c];return c.indexOf("bottom")!==-1?A.insertBefore(v,A.firstChild):A.appendChild(v),this}removeControl(L){if(!L||!L.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(L);return c>-1&&this._controls.splice(c,1),L.onRemove(this),this}hasControl(L){return this._controls.indexOf(L)>-1}calculateCameraOptionsFromTo(L,c,v,A){return A==null&&this.style.terrain&&(A=this.transform.getElevation(v,this.style.terrain)),super.calculateCameraOptionsFromTo(L,c,v,A)}resize(L){const c=this._containerDimensions(),v=c[0],A=c[1];this._resizeCanvas(v,A,this.getPixelRatio()),this.transform.resize(v,A),this.painter.resize(v,A,this.getPixelRatio());const h=!this._moving;return h&&(this.stop(),this.fire(new o.Event("movestart",L)).fire(new o.Event("move",L))),this.fire(new o.Event("resize",L)),h&&this.fire(new o.Event("moveend",L)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(L){const[c,v]=this._containerDimensions();this._pixelRatio=L,this._resizeCanvas(c,v,L),this.painter.resize(c,v,L)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(L){return this.transform.setMaxBounds(o.LngLatBounds.convert(L)),this._update()}setMinZoom(L){if((L=L??-2)>=-2&&L<=this.transform.maxZoom)return this.transform.minZoom=L,this._update(),this.getZoom()<L&&this.setZoom(L),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(L){if((L=L??22)>=this.transform.minZoom)return this.transform.maxZoom=L,this._update(),this.getZoom()>L&&this.setZoom(L),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(L){if((L=L??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(L>=0&&L<=this.transform.maxPitch)return this.transform.minPitch=L,this._update(),this.getPitch()<L&&this.setPitch(L),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(L){if((L=L??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(L>=this.transform.minPitch)return this.transform.maxPitch=L,this._update(),this.getPitch()>L&&this.setPitch(L),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(L){return this.transform.renderWorldCopies=L,this._update()}project(L){return this.transform.locationPoint(o.LngLat.convert(L),this.style&&this.style.terrain)}unproject(L){return this.transform.pointLocation(o.pointGeometry.convert(L),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(L,c,v){if(L==="mouseenter"||L==="mouseover"){let A=!1;return{layer:c,listener:v,delegates:{mousemove:d=>{const w=this.getLayer(c)?this.queryRenderedFeatures(d.point,{layers:[c]}):[];w.length?A||(A=!0,v.call(this,new oi(L,this,d.originalEvent,{features:w}))):A=!1},mouseout:()=>{A=!1}}}}if(L==="mouseleave"||L==="mouseout"){let A=!1;return{layer:c,listener:v,delegates:{mousemove:w=>{(this.getLayer(c)?this.queryRenderedFeatures(w.point,{layers:[c]}):[]).length?A=!0:A&&(A=!1,v.call(this,new oi(L,this,w.originalEvent)))},mouseout:w=>{A&&(A=!1,v.call(this,new oi(L,this,w.originalEvent)))}}}}{const A=h=>{const d=this.getLayer(c)?this.queryRenderedFeatures(h.point,{layers:[c]}):[];d.length&&(h.features=d,v.call(this,h),delete h.features)};return{layer:c,listener:v,delegates:{[L]:A}}}}on(L,c,v){if(v===void 0)return super.on(L,c);const A=this._createDelegatedListener(L,c,v);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[L]=this._delegatedListeners[L]||[],this._delegatedListeners[L].push(A);for(const h in A.delegates)this.on(h,A.delegates[h]);return this}once(L,c,v){if(v===void 0)return super.once(L,c);const A=this._createDelegatedListener(L,c,v);for(const h in A.delegates)this.once(h,A.delegates[h]);return this}off(L,c,v){return v===void 0?super.off(L,c):(this._delegatedListeners&&this._delegatedListeners[L]&&(A=>{const h=this._delegatedListeners[L];for(let d=0;d<h.length;d++){const w=h[d];if(w.layer===c&&w.listener===v){for(const b in w.delegates)this.off(b,w.delegates[b]);return h.splice(d,1),this}}})(),this)}queryRenderedFeatures(L,c){if(!this.style)return[];let v;if(c!==void 0||L===void 0||L instanceof o.pointGeometry||Array.isArray(L)||(c=L,L=void 0),c=c||{},(L=L||[[0,0],[this.transform.width,this.transform.height]])instanceof o.pointGeometry||typeof L[0]=="number")v=[o.pointGeometry.convert(L)];else{const A=o.pointGeometry.convert(L[0]),h=o.pointGeometry.convert(L[1]);v=[A,new o.pointGeometry(h.x,A.y),h,new o.pointGeometry(A.x,h.y),A]}return this.style.queryRenderedFeatures(v,c,this.transform)}querySourceFeatures(L,c){return this.style.querySourceFeatures(L,c)}setStyle(L,c){return(c=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&L?(this._diffStyle(L,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._updateStyle(L,c))}setTransformRequest(L){return this._requestManager.setTransformRequest(L),this}_getUIString(L){const c=this._locale[L];if(c==null)throw new Error(`Missing UI string '${L}'`);return c}_updateStyle(L,c){return this.style&&(this.style.setEventedParent(null),this.style._remove()),L?(this.style=new Ce(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof L=="string"?this.style.loadURL(L):this.style.loadJSON(L),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ce(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(L,c){if(typeof L=="string"){const v=this._requestManager.transformRequest(L,o.ResourceType.Style);o.getJSON(v,(A,h)=>{A?this.fire(new o.ErrorEvent(A)):h&&this._updateDiff(h,c)})}else typeof L=="object"&&this._updateDiff(L,c)}_updateDiff(L,c){try{this.style.setState(L)&&this._update(!0)}catch(v){o.warnOnce(`Unable to perform style diff: ${v.message||v.error||v}.  Rebuilding the style from scratch.`),this._updateStyle(L,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")}addSource(L,c){return this._lazyInitEmptyStyle(),this.style.addSource(L,c),this._update(!0)}isSourceLoaded(L){const c=this.style&&this.style.sourceCaches[L];if(c!==void 0)return c.loaded();this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${L}'`)))}setTerrain(L){return this.style.setTerrain(L),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const L=this.style&&this.style.sourceCaches;for(const c in L){const v=L[c]._tiles;for(const A in v){const h=v[A];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}addSourceType(L,c,v){return this._lazyInitEmptyStyle(),this.style.addSourceType(L,c,v)}removeSource(L){return this.style.removeSource(L),this._update(!0)}getSource(L){return this.style.getSource(L)}addImage(L,c,{pixelRatio:v=1,sdf:A=!1,stretchX:h,stretchY:d,content:w}={}){if(this._lazyInitEmptyStyle(),c instanceof HTMLImageElement||o.isImageBitmap(c)){const{width:b,height:S,data:P}=o.exported.getImageData(c);this.style.addImage(L,{data:new o.RGBAImage({width:b,height:S},P),pixelRatio:v,stretchX:h,stretchY:d,content:w,sdf:A,version:0})}else{if(c.width===void 0||c.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:b,height:S,data:P}=c,B=c;this.style.addImage(L,{data:new o.RGBAImage({width:b,height:S},new Uint8Array(P)),pixelRatio:v,stretchX:h,stretchY:d,content:w,sdf:A,version:0,userImage:B}),B.onAdd&&B.onAdd(this,L)}}}updateImage(L,c){const v=this.style.getImage(L);if(!v)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const A=c instanceof HTMLImageElement||o.isImageBitmap(c)?o.exported.getImageData(c):c,{width:h,height:d,data:w}=A;if(h===void 0||d===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==v.data.width||d!==v.data.height)return this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(c instanceof HTMLImageElement||o.isImageBitmap(c));v.data.replace(w,b),this.style.updateImage(L,v)}hasImage(L){return L?!!this.style.getImage(L):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(L){this.style.removeImage(L)}loadImage(L,c){o.getImage(this._requestManager.transformRequest(L,o.ResourceType.Image),c)}listImages(){return this.style.listImages()}addLayer(L,c){return this._lazyInitEmptyStyle(),this.style.addLayer(L,c),this._update(!0)}moveLayer(L,c){return this.style.moveLayer(L,c),this._update(!0)}removeLayer(L){return this.style.removeLayer(L),this._update(!0)}getLayer(L){return this.style.getLayer(L)}setLayerZoomRange(L,c,v){return this.style.setLayerZoomRange(L,c,v),this._update(!0)}setFilter(L,c,v={}){return this.style.setFilter(L,c,v),this._update(!0)}getFilter(L){return this.style.getFilter(L)}setPaintProperty(L,c,v,A={}){return this.style.setPaintProperty(L,c,v,A),this._update(!0)}getPaintProperty(L,c){return this.style.getPaintProperty(L,c)}setLayoutProperty(L,c,v,A={}){return this.style.setLayoutProperty(L,c,v,A),this._update(!0)}getLayoutProperty(L,c){return this.style.getLayoutProperty(L,c)}setLight(L,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(L,c),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(L,c){return this.style.setFeatureState(L,c),this._update()}removeFeatureState(L,c){return this.style.removeFeatureState(L,c),this._update()}getFeatureState(L){return this.style.getFeatureState(L)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let L=0,c=0;return this._container&&(L=this._container.clientWidth||400,c=this._container.clientHeight||300),[L,c]}_setupContainer(){const L=this._container;L.classList.add("maplibregl-map","mapboxgl-map");const c=this._canvasContainer=k.create("div","maplibregl-canvas-container mapboxgl-canvas-container",L);this._interactive&&c.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=k.create("canvas","maplibregl-canvas mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const v=this._containerDimensions();this._resizeCanvas(v[0],v[1],this.getPixelRatio());const A=this._controlContainer=k.create("div","maplibregl-control-container mapboxgl-control-container",L),h=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(d=>{h[d]=k.create("div",`maplibregl-ctrl-${d} mapboxgl-ctrl-${d}`,A)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const L=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=k.create("div","maplibregl-cooperative-gesture-screen",L);let c="Control",v=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(v=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map",c="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${v}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",A=>{A.key===c&&(this._metaPress=!0)}),document.addEventListener("keyup",A=>{A.key===c&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",A=>{this._onCooperativeGesture(A,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(L,c,v){this._canvas.width=v*L,this._canvas.height=v*c,this._canvas.style.width=`${L}px`,this._canvas.style.height=`${c}px`}_setupPainter(){const L=o.extend({},p.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._canvas.getContext("webgl",L)||this._canvas.getContext("experimental-webgl",L);c?(this.painter=new Ti(c,this.transform),o.exported$1.testSupport(c)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(L){L.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:L}))}_contextRestored(L){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:L}))}_onMapScroll(L){if(L.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(L,c,v){return!c&&v<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(L){return this.style?(this._styleDirty=this._styleDirty||L,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(L){return this._update(),this._renderTaskQueue.add(L)}_cancelRenderFrame(L){this._renderTaskQueue.remove(L)}_render(L){let c,v=0;const A=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(c=A.createQueryEXT(),A.beginQueryEXT(A.TIME_ELAPSED_EXT,c),v=o.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(L),this._removed)return;let h=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const w=this.transform.zoom,b=o.exported.now();this.style.zoomHistory.update(w,b);const S=new o.EvaluationParameters(w,{now:b,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),P=S.crossFadingFactor();P===1&&P===this._crossFadingFactor||(h=!0,this._crossFadingFactor=P),this.style.update(S)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.load),this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||h)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const w=o.exported.now()-v;A.endQueryEXT(A.TIME_ELAPSED_EXT,c),setTimeout(()=>{const b=A.getQueryObjectEXT(c,A.QUERY_RESULT_EXT)/1e6;A.deleteQueryEXT(c),this.fire(new o.Event("gpu-timing-frame",{cpuTime:w,gpuTime:b}))},50)}if(this.listens("gpu-timing-layer")){const w=this.painter.collectGpuTimers();setTimeout(()=>{const b=this.painter.queryGpuTimers(w);this.fire(new o.Event("gpu-timing-layer",{layerTimes:b}))},50)}const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const L=this.painter.context.gl.getExtension("WEBGL_lose_context");L&&L.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),k.remove(this._canvasContainer),k.remove(this._controlContainer),this._cooperativeGestures&&k.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),o.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=o.exported.frame(L=>{o.PerformanceUtils.frame(L),this._frame=null,this._render(L)}))}_onWindowOnline(){this._update()}_onWindowResize(L){this._trackResize&&this.resize({originalEvent:L})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(L){this._showTileBoundaries!==L&&(this._showTileBoundaries=L,this._update())}get showPadding(){return!!this._showPadding}set showPadding(L){this._showPadding!==L&&(this._showPadding=L,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(L){this._showCollisionBoxes!==L&&(this._showCollisionBoxes=L,L?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(L){this._showOverdrawInspector!==L&&(this._showOverdrawInspector=L,this._update())}get repaint(){return!!this._repaint}set repaint(L){this._repaint!==L&&(this._repaint=L,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(L){this._vertices=L,this._update()}_setCacheLimits(L,c){o.setCacheLimits(L,c)}get version(){return"2.4.0"}},NavigationControl:class{constructor(L){this.options=o.extend({},Lc,L),this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",c=>this._map.zoomIn({},{originalEvent:c})),k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",c=>this._map.zoomOut({},{originalEvent:c})),k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",c=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:c}):this._map.resetNorth({},{originalEvent:c})}),this._compassIcon=k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const L=this._map.getZoom(),c=L===this._map.getMaxZoom(),v=L===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())}_rotateCompassArrow(){const L=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=L}onAdd(L){return this._map=L,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new xr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){k.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(L,c){const v=k.create("button",L,this._container);return v.type="button",v.addEventListener("click",c),v}_setButtonTitle(L,c){const v=this._map._getUIString(`NavigationControl.${c}`);L.title=v,L.setAttribute("aria-label",v)}},GeolocateControl:class extends o.Evented{constructor(L){super(),this.options=o.extend({},es,L),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(L){var c;return this._map=L,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,ta!==void 0?c(ta):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(v=>{ta=v.state!=="denied",c(ta)}):(ta=!!window.navigator.geolocation,c(ta)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),k.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,jr=0,Ys=!1}_isOutOfMapMaxBounds(L){const c=this._map.getMaxBounds(),v=L.coords;return c&&(v.longitude<c.getWest()||v.longitude>c.getEast()||v.latitude<c.getSouth()||v.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(L){if(this._map){if(this._isOutOfMapMaxBounds(L))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",L)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=L,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(L),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(L),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",L)),this._finish()}}_updateCamera(L){const c=new o.LngLat(L.coords.longitude,L.coords.latitude),v=L.coords.accuracy,A=this._map.getBearing(),h=o.extend({bearing:A},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(v),h,{geolocateSource:!0})}_updateMarker(L){if(L){const c=new o.LngLat(L.coords.longitude,L.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=L.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const L=this._map._container.clientHeight/2,c=this._map.unproject([0,L]),v=this._map.unproject([1,L]),A=c.distanceTo(v),h=Math.ceil(2*this._accuracy/A);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(L){if(this._map){if(this.options.trackUserLocation)if(L.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(L.code===3&&Ys)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",L)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(L){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=k.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",L===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=k.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new fn(this._dotElement),this._circleElement=k.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new fn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":jr--,Ys=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let L;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),jr++,jr>1?(L={maximumAge:6e5,timeout:0},Ys=!0):(L=this.options.positionOptions,Ys=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,L)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ol,LogoControl:Hl,ScaleControl:class{constructor(L){this.options=o.extend({},ks,L),o.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Xs(this._map,this._container,this.options)}onAdd(L){return this._map=L,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",L.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){k.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(L){this.options.unit=L,Xs(this._map,this._container,this.options)}},FullscreenControl:class{constructor(L){this._fullscreen=!1,L&&L.container&&(L.container instanceof HTMLElement?this._container=L.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(L){return this._map=L,this._container||(this._container=this._map.getContainer()),this._controlContainer=k.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){k.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const L=this._fullscreenButton=k.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",L).setAttribute("aria-hidden","true"),L.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const L=this._getTitle();this._fullscreenButton.setAttribute("aria-label",L),this._fullscreenButton.title=L}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(L){this.options=L,o.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(L){return this._map=L,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=k.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){k.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends o.Evented{constructor(L){super(),this.options=o.extend(Object.create(Pt),L),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(L){return this._map&&this.remove(),this._map=L,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&k.remove(this._content),this._container&&(k.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(L){return this._lngLat=o.LngLat.convert(L),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(L){return this.setDOMContent(document.createTextNode(L))}setHTML(L){const c=document.createDocumentFragment(),v=document.createElement("body");let A;for(v.innerHTML=L;A=v.firstChild,A;)c.appendChild(A);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(L){return this.options.maxWidth=L,this._update(),this}setDOMContent(L){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=k.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(L),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(L){this._container&&this._container.classList.add(L)}removeClassName(L){this._container&&this._container.classList.remove(L)}setOffset(L){return this.options.offset=L,this._update(),this}toggleClassName(L){if(this._container)return this._container.classList.toggle(L)}_createCloseButton(){this.options.closeButton&&(this._closeButton=k.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(L){this._update(L.point)}_onMouseMove(L){this._update(L.point)}_onDrag(L){this._update(L.point)}_update(L){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=k.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=k.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(d=>this._container.classList.add(d)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Wl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!L))return;const c=this._pos=this._trackPointer&&L?L:this._map.project(this._lngLat);let v=this.options.anchor;const A=al(this.options.offset);if(!v){const d=this._container.offsetWidth,w=this._container.offsetHeight;let b;b=c.y+A.bottom.y<w?["top"]:c.y>this._map.transform.height-w?["bottom"]:[],c.x<d/2?b.push("left"):c.x>this._map.transform.width-d/2&&b.push("right"),v=b.length===0?"bottom":b.join("-")}const h=c.add(A[v]).round();k.setTransform(this._container,`${Xt[v]} translate(${h.x}px,${h.y}px)`),Kt(this._container,v,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const L=this._container.querySelector(Hr);L&&L.focus()}_onClose(){this.remove()}},Marker:fn,Style:Ce,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,AJAXError:o.AJAXError,config:o.config,CanvasSource:Ln,GeoJSONSource:un,ImageSource:Tt,RasterDEMTileSource:Et,RasterTileSource:pt,VectorTileSource:Ze,VideoSource:Jt,prewarm:function(){cr().acquire(xt)},clearPrewarmedResources:function(){const L=br;L&&(L.isPreloaded()&&L.numActive()===1?(L.release(xt),br=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return nr.workerCount},set workerCount(L){nr.workerCount=L},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(L){o.config.MAX_PARALLEL_IMAGE_REQUESTS=L},clearStorage(L){o.clearTileCache(L)},workerUrl:"",addProtocol(L,c){o.config.REGISTERED_PROTOCOLS[L]=c},removeProtocol(L){delete o.config.REGISTERED_PROTOCOLS[L]}};return gs.extend(Ks,{isSafari:o.isSafari,getPerformanceMetrics:o.PerformanceUtils.getPerformanceMetrics}),Ks});var l=i;return l})})(Oz);var Nz=Oz.exports;const Vo=Z2(Nz),Ine=eT({__proto__:null,default:Vo},[Nz]),Lne="modulepreload",Dne=function(t){return"/"+t},Nk={},Uz=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=Dne(s),s in Nk)return;Nk[s]=!0;const l=s.endsWith(".css"),o=l?'[rel="stylesheet"]':"";if(!!r)for(let C=i.length-1;C>=0;C--){const M=i[C];if(M.href===s&&(!l||M.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const _=document.createElement("link");if(_.rel=l?"stylesheet":Lne,l||(_.as="script",_.crossOrigin=""),_.href=s,document.head.appendChild(_),l)return new Promise((C,M)=>{_.addEventListener("load",C),_.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s})},Vz=De.createContext(null);function Rne(){var t;const e=(t=De.useContext(Vz))===null||t===void 0?void 0:t.maps,n=De.useContext(Um);return De.useMemo(()=>({...e,current:n?.map}),[e,n])}function Bne(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function ju(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!ju(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!ju(t[i],e[i]))return!1;return!0}return!1}function zne(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function Uk(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();ju(n,r)||e.setProjection(n)}function Vk(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function Gk(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const One=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function $k(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const l of One)l in s&&(i[l]=s[l])}return i||r});return{...t,layers:n}}const jk={version:8,sources:{},layers:[]},Hk={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Vw={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Wk={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Fne=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Nne=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Sd{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[Wk[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[Hk[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[Vw[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=Sd.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const l=i._resizeObserver;l&&(l.disconnect(),l.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:o}=e;return o&&(o.bounds?i.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):r._updateViewState(o,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=jk}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||Une()||null,container:e,style:$k(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const C=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=C,n.gl)}const l=new this._MapClass(i);s.padding&&l.setPadding(s.padding),n.cursor&&(l.getCanvas().style.cursor=n.cursor),this._createShadowTransform(l);const o=l._render;l._render=C=>{this._inRender=!0,o.call(l,C),this._inRender=!1};const p=l._renderTaskQueue.run;l._renderTaskQueue.run=C=>{p.call(l._renderTaskQueue,C),this._onBeforeRepaint()},l.on("render",()=>this._onAfterRepaint());const _=l.fire;l.fire=this._fireEvent.bind(this,_),l.on("resize",()=>{this._renderTransform.resize(l.transform.width,l.transform.height)}),l.on("styledata",()=>{this._updateStyleComponents(this.props,{}),Uk(l.transform,this._renderTransform)}),l.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const C in Hk)l.on(C,this._onPointerEvent);for(const C in Vw)l.on(C,this._onCameraEvent);for(const C in Wk)l.on(C,this._onEvent);this._map=l}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n?.remove(),Sd.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=zne(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:l,bearing:o}=i,p=r.isMoving();p&&(i.cameraElevationReference="sea");const _=Gk(i,{...Vk(r.transform),...e});if(p&&(i.cameraElevationReference="ground"),_&&n){const C=this._deferredEvents;C.move=!0,C.zoom||(C.zoom=s!==i.zoom),C.rotate||(C.rotate=o!==i.bearing),C.pitch||(C.pitch=l!==i.pitch)}return p||Gk(r.transform,e),_}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of Fne)if(s in e&&!ju(e[s],n[s])){i=!0;const l=r[`set${s[0].toUpperCase()}${s.slice(1)}`];l?.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=jk,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle($k(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!ju(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!ju(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!ju(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let l=!1;for(const o of Nne){const p=(r=e[o])!==null&&r!==void 0?r:!0,_=(i=n[o])!==null&&i!==void 0?i:!0;ju(p,_)||(l=!0,p?s[o].enable(p):s[o].disable())}return l}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,l=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,o=this._queryRenderedFeatures(e.point),p=o.length>0;!p&&l&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=o,p&&!l&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,l=typeof n=="string"?n:n.type;return l==="move"&&this._updateViewState(this.props,!1),l in Vw&&(typeof n=="object"&&(n.viewState=Vk(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{Uk(this._renderTransform,n),e.transform=n}}}Sd.savedMaps=[];function Une(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const Vne=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Gne(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const l=e.queryTerrainElevation(r,i);return e.transform=s,l},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const l=e.queryRenderedFeatures(r,i);return e.transform=s,l}};for(const r of $ne(e))!(r in n)&&!Vne.includes(r)&&(n[r]=e[r].bind(e));return n}function $ne(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const jne=typeof document<"u"?De.useLayoutEffect:De.useEffect,Hne=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function Wne(t,e){for(const r of Hne)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!1)}const Um=De.createContext(null);function Gz(t,e,n){const r=De.useContext(Vz),[i,s]=De.useState(null),l=De.useRef(),{current:o}=De.useRef({mapLib:null,map:null});De.useEffect(()=>{const C=t.mapLib;let M=!0,k;return Promise.resolve(C||n).then(F=>{if(!M)return;if(!F)throw new Error("Invalid mapLib");const j="Map"in F?F:F.default;if(!j.Map)throw new Error("Invalid mapLib");if(Wne(j,t),!j.supported||j.supported(t))t.reuseMaps&&(k=Sd.reuse(t,l.current)),k||(k=new Sd(j.Map,t,l.current)),o.map=Gne(k),o.mapLib=j,s(k),r?.onMapMount(o.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(F=>{const{onError:j}=t;j?j({type:"error",target:null,originalEvent:null,error:F}):console.error(F)}),()=>{M=!1,k&&(r?.onMapUnmount(t.id),t.reuseMaps?k.recycle():k.destroy())}},[]),jne(()=>{i&&i.setProps(t)}),De.useImperativeHandle(e,()=>o.map,[i]);const p=De.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),_={height:"100%"};return De.createElement("div",{id:t.id,ref:l,style:p},i&&De.createElement(Um.Provider,{value:o},De.createElement("div",{"mapboxgl-children":"",style:_},t.children)))}const Qne=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function $f(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!Qne.test(r)?n[r]=`${i}px`:n[r]=i}}function qne(t,e){const{map:n,mapLib:r}=De.useContext(Um),i=De.useRef({props:t});i.current.props=t;const s=De.useMemo(()=>{let H=!1;De.Children.forEach(t.children,J=>{J&&(H=!0)});const ie={...t,element:H?document.createElement("div"):null},Y=new r.Marker(ie);return Y.setLngLat([t.longitude,t.latitude]),Y.getElement().addEventListener("click",J=>{var se,he;(he=(se=i.current.props).onClick)===null||he===void 0||he.call(se,{type:"click",target:Y,originalEvent:J})}),Y.on("dragstart",J=>{var se,he;const pe=J;pe.lngLat=s.getLngLat(),(he=(se=i.current.props).onDragStart)===null||he===void 0||he.call(se,pe)}),Y.on("drag",J=>{var se,he;const pe=J;pe.lngLat=s.getLngLat(),(he=(se=i.current.props).onDrag)===null||he===void 0||he.call(se,pe)}),Y.on("dragend",J=>{var se,he;const pe=J;pe.lngLat=s.getLngLat(),(he=(se=i.current.props).onDragEnd)===null||he===void 0||he.call(se,pe)}),Y},[]);De.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:l,latitude:o,offset:p,style:_,draggable:C=!1,popup:M=null,rotation:k=0,rotationAlignment:F="auto",pitchAlignment:j="auto"}=t;return De.useEffect(()=>{$f(s.getElement(),_)},[_]),De.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==l||s.getLngLat().lat!==o)&&s.setLngLat([l,o]),p&&!Bne(s.getOffset(),p)&&s.setOffset(p),s.isDraggable()!==C&&s.setDraggable(C),s.getRotation()!==k&&s.setRotation(k),s.getRotationAlignment()!==F&&s.setRotationAlignment(F),s.getPitchAlignment()!==j&&s.setPitchAlignment(j),s.getPopup()!==M&&s.setPopup(M),ZT.createPortal(t.children,s.getElement())}De.memo(De.forwardRef(qne));function Qk(t){return new Set(t?t.trim().split(/\s+/):[])}function Zne(t,e){const{map:n,mapLib:r}=De.useContext(Um),i=De.useMemo(()=>document.createElement("div"),[]),s=De.useRef({props:t});s.current.props=t;const l=De.useMemo(()=>{const o={...t},p=new r.Popup(o);return p.setLngLat([t.longitude,t.latitude]),p.once("open",_=>{var C,M;(M=(C=s.current.props).onOpen)===null||M===void 0||M.call(C,_)}),p},[]);if(De.useEffect(()=>{const o=p=>{var _,C;(C=(_=s.current.props).onClose)===null||C===void 0||C.call(_,p)};return l.on("close",o),l.setDOMContent(i).addTo(n.getMap()),()=>{l.off("close",o),l.isOpen()&&l.remove()}},[]),De.useEffect(()=>{$f(l.getElement(),t.style)},[t.style]),De.useImperativeHandle(e,()=>l,[]),l.isOpen()&&((l.getLngLat().lng!==t.longitude||l.getLngLat().lat!==t.latitude)&&l.setLngLat([t.longitude,t.latitude]),t.offset&&!ju(l.options.offset,t.offset)&&l.setOffset(t.offset),(l.options.anchor!==t.anchor||l.options.maxWidth!==t.maxWidth)&&(l.options.anchor=t.anchor,l.setMaxWidth(t.maxWidth)),l.options.className!==t.className)){const o=Qk(l.options.className),p=Qk(t.className);for(const _ of o)p.has(_)||l.removeClassName(_);for(const _ of p)o.has(_)||l.addClassName(_);l.options.className=t.className}return ZT.createPortal(t.children,i)}De.memo(De.forwardRef(Zne));function Vm(t,e,n,r){const i=De.useContext(Um),s=De.useMemo(()=>t(i),[]);return De.useEffect(()=>{const l=r||n||e,o=typeof e=="function"&&typeof n=="function"?e:null,p=typeof n=="function"?n:typeof e=="function"?e:null,{map:_}=i;return _.hasControl(s)||(_.addControl(s,l?.position),o&&o(i)),()=>{p&&p(i),_.hasControl(s)&&_.removeControl(s)}},[]),s}function Yne(t){const e=Vm(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return De.useEffect(()=>{$f(e._container,t.style)},[t.style]),null}De.memo(Yne);function Xne(t){const e=Vm(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return De.useEffect(()=>{$f(e._controlContainer,t.style)},[t.style]),null}De.memo(Xne);function Kne(t,e){const n=De.useRef({props:t}),r=Vm(({mapLib:i})=>{const s=new i.GeolocateControl(t),l=s._setupUI;return s._setupUI=o=>{s._container.hasChildNodes()||l(o)},s.on("geolocate",o=>{var p,_;(_=(p=n.current.props).onGeolocate)===null||_===void 0||_.call(p,o)}),s.on("error",o=>{var p,_;(_=(p=n.current.props).onError)===null||_===void 0||_.call(p,o)}),s.on("outofmaxbounds",o=>{var p,_;(_=(p=n.current.props).onOutOfMaxBounds)===null||_===void 0||_.call(p,o)}),s.on("trackuserlocationstart",o=>{var p,_;(_=(p=n.current.props).onTrackUserLocationStart)===null||_===void 0||_.call(p,o)}),s.on("trackuserlocationend",o=>{var p,_;(_=(p=n.current.props).onTrackUserLocationEnd)===null||_===void 0||_.call(p,o)}),s},{position:t.position});return n.current.props=t,De.useImperativeHandle(e,()=>r,[]),De.useEffect(()=>{$f(r._container,t.style)},[t.style]),null}De.memo(De.forwardRef(Kne));function Jne(t){const e=Vm(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return De.useEffect(()=>{$f(e._container,t.style)},[t.style]),null}De.memo(Jne);function ere(t){const e=Vm(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=De.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),De.useEffect(()=>{$f(e._container,i)},[i]),null}De.memo(ere);function tre(){return Rne()}const nre=Uz(()=>import("./__vite-optional-peer-dep_mapbox-gl_react-map-gl-b25bb000.js"),[]),Va=(()=>De.forwardRef(function(e,n){return Gz(e,n,nre)}))(),rre=8,ire="OSM Liberty",sre={"maputnik:license":"https://github.com/maputnik/osm-liberty/blob/gh-pages/LICENSE.md","maputnik:renderer":"mbgljs","openmaptiles:version":"3.x"},ore={openmaptiles:{type:"vector",url:"https://tiles.basemaps.cartocdn.com/vector/carto.streets/v1/tiles.json"},natural_earth_shaded_relief:{maxzoom:6,tileSize:256,tiles:["https://klokantech.github.io/naturalearthtiles/tiles/natural_earth_2_shaded_relief.raster/{z}/{x}/{y}.png"],type:"raster"}},are="https://maputnik.github.io/osm-liberty/sprites/osm-liberty",lre="https://orangemug.github.io/font-glyphs/glyphs/{fontstack}/{range}.pbf",Are=[{id:"boundary_3",type:"line",source:"openmaptiles","source-layer":"boundary",minzoom:8,filter:["all",["in","admin_level",3,4]],layout:{"line-join":"round"},paint:{"line-color":"#9e9cab","line-dasharray":[5,1],"line-width":{base:1,stops:[[4,.4],[5,1],[12,1.8]]}}},{id:"boundary_2_z0-4",type:"line",source:"openmaptiles","source-layer":"boundary",maxzoom:5,filter:["all",["==","admin_level",2],["!has","claimed_by"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"hsl(248, 1%, 41%)","line-opacity":{base:1,stops:[[0,.4],[4,1]]},"line-width":{base:1,stops:[[3,1],[5,1.2],[12,3]]}}},{id:"boundary_2_z5-",type:"line",source:"openmaptiles","source-layer":"boundary",minzoom:5,filter:["all",["==","admin_level",2]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"hsl(248, 1%, 41%)","line-opacity":{base:1,stops:[[0,.4],[4,1]]},"line-width":{base:1,stops:[[3,1],[5,1.2],[12,3]]}}},{id:"water_name_line",type:"symbol",source:"openmaptiles","source-layer":"waterway",filter:["all",["==","$type","LineString"]],layout:{"text-field":"{name}","text-font":["Roboto Regular"],"text-max-width":5,"text-size":12,"symbol-placement":"line"},paint:{"text-color":"#5d60be","text-halo-color":"rgba(255,255,255,0.7)","text-halo-width":1}},{id:"water_name_point",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["==","$type","Point"],layout:{"text-field":"{name}","text-font":["Roboto Regular"],"text-max-width":5,"text-size":12},paint:{"text-color":"#5d60be","text-halo-color":"rgba(255,255,255,0.7)","text-halo-width":1}},{id:"poi_z16",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",20]],layout:{"icon-image":["match",["get","subclass"],["florist","furniture"],["get","subclass"],["get","class"]],"text-anchor":"top","text-field":"{name}","text-font":["Roboto Condensed Italic"],"text-max-width":9,"text-offset":[0,.6],"text-size":12},paint:{"text-color":"#666","text-halo-blur":.5,"text-halo-color":"#ffffff","text-halo-width":1}},{id:"poi_z15",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],[">=","rank",7],["<","rank",20]],layout:{"icon-image":["match",["get","subclass"],["florist","furniture"],["get","subclass"],["get","class"]],"text-anchor":"top","text-field":"{name}","text-font":["Roboto Condensed Italic"],"text-max-width":9,"text-offset":[0,.6],"text-size":12},paint:{"text-color":"#666","text-halo-blur":.5,"text-halo-color":"#ffffff","text-halo-width":1}},{id:"poi_z14",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],[">=","rank",1],["<","rank",7]],layout:{"icon-image":["match",["get","subclass"],["florist","furniture"],["get","subclass"],["get","class"]],"text-anchor":"top","text-field":"{name}","text-font":["Roboto Condensed Italic"],"text-max-width":9,"text-offset":[0,.6],"text-size":12},paint:{"text-color":"#666","text-halo-blur":.5,"text-halo-color":"#ffffff","text-halo-width":1}},{id:"poi_transit",type:"symbol",source:"openmaptiles","source-layer":"poi",filter:["all",["in","class","bus","rail","airport"]],layout:{"icon-image":"{class}","text-anchor":"left","text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-max-width":9,"text-offset":[.9,0],"text-size":12},paint:{"text-color":"#4898ff","text-halo-blur":.5,"text-halo-color":"#ffffff","text-halo-width":1}},{id:"place_other",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",["in","class","hamlet","island","islet","neighbourhood","suburb","quarter"]],layout:{"text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-letter-spacing":.1,"text-max-width":9,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-transform":"uppercase"},paint:{"text-color":"#633","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1.2}},{id:"place_village",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"]],layout:{"text-field":"{name_en}","text-font":["Roboto Regular"],"text-max-width":8,"text-size":{base:1.2,stops:[[10,12],[15,22]]}},paint:{"text-color":"#333","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1.2}},{id:"place_town",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"]],layout:{"icon-image":{base:1,stops:[[0,"dot_9"],[8,""]]},"text-anchor":"bottom","text-field":"{name_en}","text-font":["Roboto Regular"],"text-max-width":8,"text-offset":[0,0],"text-size":{base:1.2,stops:[[7,12],[11,16]]}},paint:{"text-color":"#333","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1.2}},{id:"place_city",type:"symbol",source:"openmaptiles","source-layer":"place",minzoom:5,filter:["all",["==","class","city"]],layout:{"icon-image":{base:1,stops:[[0,"dot_9"],[8,""]]},"text-anchor":"bottom","text-field":"{name_en}","text-font":["Roboto Medium"],"text-max-width":8,"text-offset":[0,0],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"icon-allow-overlap":!0,"icon-optional":!1},paint:{"text-color":"#333","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1.2}},{id:"state",type:"symbol",source:"openmaptiles","source-layer":"place",maxzoom:6,filter:["all",["==","class","state"]],layout:{"text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-size":{stops:[[4,11],[6,15]]},"text-transform":"uppercase"},paint:{"text-color":"#633","text-halo-color":"rgba(255,255,255,0.7)","text-halo-width":1}},{id:"country_3",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",[">=","rank",3],["==","class","country"]],layout:{"text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-max-width":6.25,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"none"},paint:{"text-color":"#334","text-halo-blur":1,"text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1}},{id:"country_2",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",["==","rank",2],["==","class","country"]],layout:{"text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-max-width":6.25,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"none"},paint:{"text-color":"#334","text-halo-blur":1,"text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1}},{id:"country_1",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",["==","rank",1],["==","class","country"]],layout:{"text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-max-width":6.25,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"none"},paint:{"text-color":"#334","text-halo-blur":1,"text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1}},{id:"continent",type:"symbol",source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"]],layout:{"text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-size":13,"text-transform":"uppercase","text-justify":"center"},paint:{"text-color":"#633","text-halo-color":"rgba(255,255,255,0.7)","text-halo-width":1}}],ure="osm-liberty",Ga={version:rre,name:ire,metadata:sre,sources:ore,sprite:are,glyphs:lre,layers:Are,id:ure};function Zy(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function cre(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function LS(t){let e,n,r;t.length!==2?(e=Zy,n=(o,p)=>Zy(t(o),p),r=(o,p)=>t(o)-p):(e=t===Zy||t===cre?t:hre,n=t,r=t);function i(o,p,_=0,C=o.length){if(_<C){if(e(p,p)!==0)return C;do{const M=_+C>>>1;n(o[M],p)<0?_=M+1:C=M}while(_<C)}return _}function s(o,p,_=0,C=o.length){if(_<C){if(e(p,p)!==0)return C;do{const M=_+C>>>1;n(o[M],p)<=0?_=M+1:C=M}while(_<C)}return _}function l(o,p,_=0,C=o.length){const M=i(o,p,_,C-1);return M>_&&r(o[M-1],p)>-r(o[M],p)?M-1:M}return{left:i,center:l,right:s}}function hre(){return 0}function fre(t){return t===null?NaN:+t}const dre=LS(Zy),pre=dre.right;LS(fre).center;const $z=pre;function jc(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of t)(s=e(s,++i,t))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}class qk extends Map{constructor(e,n=yre){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(Zk(this,e))}has(e){return super.has(Zk(this,e))}set(e,n){return super.set(gre(this,e),n)}delete(e){return super.delete(mre(this,e))}}function Zk({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function gre({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function mre({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function yre(t){return t!==null&&typeof t=="object"?t.valueOf():t}const _re=Math.sqrt(50),vre=Math.sqrt(10),xre=Math.sqrt(2);function n2(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),l=s>=_re?10:s>=vre?5:s>=xre?2:1;let o,p,_;return i<0?(_=Math.pow(10,-i)/l,o=Math.round(t*_),p=Math.round(e*_),o/_<t&&++o,p/_>e&&--p,_=-_):(_=Math.pow(10,i)*l,o=Math.round(t/_),p=Math.round(e/_),o*_<t&&++o,p*_>e&&--p),p<o&&.5<=n&&n<2?n2(t,e,n*2):[o,p,_]}function wre(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,l]=r?n2(e,t,n):n2(t,e,n);if(!(s>=i))return[];const o=s-i+1,p=new Array(o);if(r)if(l<0)for(let _=0;_<o;++_)p[_]=(s-_)/-l;else for(let _=0;_<o;++_)p[_]=(s-_)*l;else if(l<0)for(let _=0;_<o;++_)p[_]=(i+_)/-l;else for(let _=0;_<o;++_)p[_]=(i+_)*l;return p}function iE(t,e,n){return e=+e,t=+t,n=+n,n2(t,e,n)[2]}function sE(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?iE(e,t,n):iE(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function bre(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function wh(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}function Ere(t){return t}var Gw=1,Yy=2,Yk=3,rg=4,Xk=1e-6;function Tre(t){return"translate("+t+",0)"}function Sre(t){return"translate(0,"+t+")"}function Cre(t){return e=>+t(e)}function Mre(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function Pre(){return!this.__axis}function jz(t,e){var n=[],r=null,i=null,s=6,l=6,o=3,p=typeof window<"u"&&window.devicePixelRatio>1?0:.5,_=t===Gw||t===rg?-1:1,C=t===rg||t===Yy?"x":"y",M=t===Gw||t===Yk?Tre:Sre;function k(F){var j=r??(e.ticks?e.ticks.apply(e,n):e.domain()),H=i??(e.tickFormat?e.tickFormat.apply(e,n):Ere),ie=Math.max(s,0)+o,Y=e.range(),J=+Y[0]+p,se=+Y[Y.length-1]+p,he=(e.bandwidth?Mre:Cre)(e.copy(),p),pe=F.selection?F.selection():F,be=pe.selectAll(".domain").data([null]),Ge=pe.selectAll(".tick").data(j,e).order(),We=Ge.exit(),Xe=Ge.enter().append("g").attr("class","tick"),rt=Ge.select("line"),Oe=Ge.select("text");be=be.merge(be.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Ge=Ge.merge(Xe),rt=rt.merge(Xe.append("line").attr("stroke","currentColor").attr(C+"2",_*s)),Oe=Oe.merge(Xe.append("text").attr("fill","currentColor").attr(C,_*ie).attr("dy",t===Gw?"0em":t===Yk?"0.71em":"0.32em")),F!==pe&&(be=be.transition(F),Ge=Ge.transition(F),rt=rt.transition(F),Oe=Oe.transition(F),We=We.transition(F).attr("opacity",Xk).attr("transform",function(nt){return isFinite(nt=he(nt))?M(nt+p):this.getAttribute("transform")}),Xe.attr("opacity",Xk).attr("transform",function(nt){var Ze=this.parentNode.__axis;return M((Ze&&isFinite(Ze=Ze(nt))?Ze:he(nt))+p)})),We.remove(),be.attr("d",t===rg||t===Yy?l?"M"+_*l+","+J+"H"+p+"V"+se+"H"+_*l:"M"+p+","+J+"V"+se:l?"M"+J+","+_*l+"V"+p+"H"+se+"V"+_*l:"M"+J+","+p+"H"+se),Ge.attr("opacity",1).attr("transform",function(nt){return M(he(nt)+p)}),rt.attr(C+"2",_*s),Oe.attr(C,_*ie).text(H),pe.filter(Pre).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Yy?"start":t===rg?"end":"middle"),pe.each(function(){this.__axis=he})}return k.scale=function(F){return arguments.length?(e=F,k):e},k.ticks=function(){return n=Array.from(arguments),k},k.tickArguments=function(F){return arguments.length?(n=F==null?[]:Array.from(F),k):n.slice()},k.tickValues=function(F){return arguments.length?(r=F==null?null:Array.from(F),k):r&&r.slice()},k.tickFormat=function(F){return arguments.length?(i=F,k):i},k.tickSize=function(F){return arguments.length?(s=l=+F,k):s},k.tickSizeInner=function(F){return arguments.length?(s=+F,k):s},k.tickSizeOuter=function(F){return arguments.length?(l=+F,k):l},k.tickPadding=function(F){return arguments.length?(o=+F,k):o},k.offset=function(F){return arguments.length?(p=+F,k):p},k}function nm(t){return jz(Yy,t)}function r2(t){return jz(rg,t)}var kre={value:()=>{}};function Hz(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Xy(n)}function Xy(t){this._=t}function Ire(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Xy.prototype=Hz.prototype={constructor:Xy,on:function(t,e){var n=this._,r=Ire(t+"",n),i,s=-1,l=r.length;if(arguments.length<2){for(;++s<l;)if((i=(t=r[s]).type)&&(i=Lre(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<l;)if(i=(t=r[s]).type)n[i]=Kk(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Kk(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Xy(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function Lre(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Kk(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=kre,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var oE="http://www.w3.org/1999/xhtml";const Jk={svg:"http://www.w3.org/2000/svg",xhtml:oE,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function vv(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Jk.hasOwnProperty(e)?{space:Jk[e],local:t}:t}function Dre(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===oE&&e.documentElement.namespaceURI===oE?e.createElement(t):e.createElementNS(n,t)}}function Rre(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Wz(t){var e=vv(t);return(e.local?Rre:Dre)(e)}function Bre(){}function DS(t){return t==null?Bre:function(){return this.querySelector(t)}}function zre(t){typeof t!="function"&&(t=DS(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=new Array(l),p,_,C=0;C<l;++C)(p=s[C])&&(_=t.call(p,p.__data__,C,s))&&("__data__"in p&&(_.__data__=p.__data__),o[C]=_);return new Go(r,this._parents)}function Qz(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Ore(){return[]}function qz(t){return t==null?Ore:function(){return this.querySelectorAll(t)}}function Fre(t){return function(){return Qz(t.apply(this,arguments))}}function Nre(t){typeof t=="function"?t=Fre(t):t=qz(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var l=e[s],o=l.length,p,_=0;_<o;++_)(p=l[_])&&(r.push(t.call(p,p.__data__,_,l)),i.push(p));return new Go(r,i)}function Zz(t){return function(){return this.matches(t)}}function Yz(t){return function(e){return e.matches(t)}}var Ure=Array.prototype.find;function Vre(t){return function(){return Ure.call(this.children,t)}}function Gre(){return this.firstElementChild}function $re(t){return this.select(t==null?Gre:Vre(typeof t=="function"?t:Yz(t)))}var jre=Array.prototype.filter;function Hre(){return Array.from(this.children)}function Wre(t){return function(){return jre.call(this.children,t)}}function Qre(t){return this.selectAll(t==null?Hre:Wre(typeof t=="function"?t:Yz(t)))}function qre(t){typeof t!="function"&&(t=Zz(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=[],p,_=0;_<l;++_)(p=s[_])&&t.call(p,p.__data__,_,s)&&o.push(p);return new Go(r,this._parents)}function Xz(t){return new Array(t.length)}function Zre(){return new Go(this._enter||this._groups.map(Xz),this._parents)}function i2(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}i2.prototype={constructor:i2,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Yre(t){return function(){return t}}function Xre(t,e,n,r,i,s){for(var l=0,o,p=e.length,_=s.length;l<_;++l)(o=e[l])?(o.__data__=s[l],r[l]=o):n[l]=new i2(t,s[l]);for(;l<p;++l)(o=e[l])&&(i[l]=o)}function Kre(t,e,n,r,i,s,l){var o,p,_=new Map,C=e.length,M=s.length,k=new Array(C),F;for(o=0;o<C;++o)(p=e[o])&&(k[o]=F=l.call(p,p.__data__,o,e)+"",_.has(F)?i[o]=p:_.set(F,p));for(o=0;o<M;++o)F=l.call(t,s[o],o,s)+"",(p=_.get(F))?(r[o]=p,p.__data__=s[o],_.delete(F)):n[o]=new i2(t,s[o]);for(o=0;o<C;++o)(p=e[o])&&_.get(k[o])===p&&(i[o]=p)}function Jre(t){return t.__data__}function eie(t,e){if(!arguments.length)return Array.from(this,Jre);var n=e?Kre:Xre,r=this._parents,i=this._groups;typeof t!="function"&&(t=Yre(t));for(var s=i.length,l=new Array(s),o=new Array(s),p=new Array(s),_=0;_<s;++_){var C=r[_],M=i[_],k=M.length,F=tie(t.call(C,C&&C.__data__,_,r)),j=F.length,H=o[_]=new Array(j),ie=l[_]=new Array(j),Y=p[_]=new Array(k);n(C,M,H,ie,Y,F,e);for(var J=0,se=0,he,pe;J<j;++J)if(he=H[J]){for(J>=se&&(se=J+1);!(pe=ie[se])&&++se<j;);he._next=pe||null}}return l=new Go(l,r),l._enter=o,l._exit=p,l}function tie(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function nie(){return new Go(this._exit||this._groups.map(Xz),this._parents)}function rie(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function iie(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,l=Math.min(i,s),o=new Array(i),p=0;p<l;++p)for(var _=n[p],C=r[p],M=_.length,k=o[p]=new Array(M),F,j=0;j<M;++j)(F=_[j]||C[j])&&(k[j]=F);for(;p<i;++p)o[p]=n[p];return new Go(o,this._parents)}function sie(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],l;--i>=0;)(l=r[i])&&(s&&l.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(l,s),s=l);return this}function oie(t){t||(t=aie);function e(M,k){return M&&k?t(M.__data__,k.__data__):!M-!k}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var l=n[s],o=l.length,p=i[s]=new Array(o),_,C=0;C<o;++C)(_=l[C])&&(p[C]=_);p.sort(e)}return new Go(i,this._parents).order()}function aie(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function lie(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Aie(){return Array.from(this)}function uie(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var l=r[i];if(l)return l}return null}function cie(){let t=0;for(const e of this)++t;return t}function hie(){return!this.node()}function fie(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,l=i.length,o;s<l;++s)(o=i[s])&&t.call(o,o.__data__,s,i);return this}function die(t){return function(){this.removeAttribute(t)}}function pie(t){return function(){this.removeAttributeNS(t.space,t.local)}}function gie(t,e){return function(){this.setAttribute(t,e)}}function mie(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function yie(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function _ie(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function vie(t,e){var n=vv(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?pie:die:typeof e=="function"?n.local?_ie:yie:n.local?mie:gie)(n,e))}function Kz(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function xie(t){return function(){this.style.removeProperty(t)}}function wie(t,e,n){return function(){this.style.setProperty(t,e,n)}}function bie(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Eie(t,e,n){return arguments.length>1?this.each((e==null?xie:typeof e=="function"?bie:wie)(t,e,n??"")):Cd(this.node(),t)}function Cd(t,e){return t.style.getPropertyValue(e)||Kz(t).getComputedStyle(t,null).getPropertyValue(e)}function Tie(t){return function(){delete this[t]}}function Sie(t,e){return function(){this[t]=e}}function Cie(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Mie(t,e){return arguments.length>1?this.each((e==null?Tie:typeof e=="function"?Cie:Sie)(t,e)):this.node()[t]}function Jz(t){return t.trim().split(/^|\s+/)}function RS(t){return t.classList||new eO(t)}function eO(t){this._node=t,this._names=Jz(t.getAttribute("class")||"")}eO.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function tO(t,e){for(var n=RS(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function nO(t,e){for(var n=RS(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Pie(t){return function(){tO(this,t)}}function kie(t){return function(){nO(this,t)}}function Iie(t,e){return function(){(e.apply(this,arguments)?tO:nO)(this,t)}}function Lie(t,e){var n=Jz(t+"");if(arguments.length<2){for(var r=RS(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Iie:e?Pie:kie)(n,e))}function Die(){this.textContent=""}function Rie(t){return function(){this.textContent=t}}function Bie(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function zie(t){return arguments.length?this.each(t==null?Die:(typeof t=="function"?Bie:Rie)(t)):this.node().textContent}function Oie(){this.innerHTML=""}function Fie(t){return function(){this.innerHTML=t}}function Nie(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Uie(t){return arguments.length?this.each(t==null?Oie:(typeof t=="function"?Nie:Fie)(t)):this.node().innerHTML}function Vie(){this.nextSibling&&this.parentNode.appendChild(this)}function Gie(){return this.each(Vie)}function $ie(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function jie(){return this.each($ie)}function Hie(t){var e=typeof t=="function"?t:Wz(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Wie(){return null}function Qie(t,e){var n=typeof t=="function"?t:Wz(t),r=e==null?Wie:typeof e=="function"?e:DS(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function qie(){var t=this.parentNode;t&&t.removeChild(this)}function Zie(){return this.each(qie)}function Yie(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Xie(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Kie(t){return this.select(t?Xie:Yie)}function Jie(t){return arguments.length?this.property("__data__",t):this.node().__data__}function ese(t){return function(e){t.call(this,e,this.__data__)}}function tse(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function nse(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function rse(t,e,n){return function(){var r=this.__on,i,s=ese(e);if(r){for(var l=0,o=r.length;l<o;++l)if((i=r[l]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function ise(t,e,n){var r=tse(t+""),i,s=r.length,l;if(arguments.length<2){var o=this.node().__on;if(o){for(var p=0,_=o.length,C;p<_;++p)for(i=0,C=o[p];i<s;++i)if((l=r[i]).type===C.type&&l.name===C.name)return C.value}return}for(o=e?rse:nse,i=0;i<s;++i)this.each(o(r[i],e,n));return this}function rO(t,e,n){var r=Kz(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function sse(t,e){return function(){return rO(this,t,e)}}function ose(t,e){return function(){return rO(this,t,e.apply(this,arguments))}}function ase(t,e){return this.each((typeof e=="function"?ose:sse)(t,e))}function*lse(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,l;i<s;++i)(l=r[i])&&(yield l)}var BS=[null];function Go(t,e){this._groups=t,this._parents=e}function Gm(){return new Go([[document.documentElement]],BS)}function Ase(){return this}Go.prototype=Gm.prototype={constructor:Go,select:zre,selectAll:Nre,selectChild:$re,selectChildren:Qre,filter:qre,data:eie,enter:Zre,exit:nie,join:rie,merge:iie,selection:Ase,order:sie,sort:oie,call:lie,nodes:Aie,node:uie,size:cie,empty:hie,each:fie,attr:vie,style:Eie,property:Mie,classed:Lie,text:zie,html:Uie,raise:Gie,lower:jie,append:Hie,insert:Qie,remove:Zie,clone:Kie,datum:Jie,on:ise,dispatch:ase,[Symbol.iterator]:lse};function Ai(t){return typeof t=="string"?new Go([[document.querySelector(t)]],[document.documentElement]):new Go([[t]],BS)}function nA(t){return typeof t=="string"?new Go([document.querySelectorAll(t)],[document.documentElement]):new Go([Qz(t)],BS)}function $m(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function xv(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function jf(){}var rm=.7,s2=1/rm,sd="\\s*([+-]?\\d+)\\s*",im="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",eu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",use=/^#([0-9a-f]{3,8})$/,cse=new RegExp(`^rgb\\(${sd},${sd},${sd}\\)$`),hse=new RegExp(`^rgb\\(${eu},${eu},${eu}\\)$`),fse=new RegExp(`^rgba\\(${sd},${sd},${sd},${im}\\)$`),dse=new RegExp(`^rgba\\(${eu},${eu},${eu},${im}\\)$`),pse=new RegExp(`^hsl\\(${im},${eu},${eu}\\)$`),gse=new RegExp(`^hsla\\(${im},${eu},${eu},${im}\\)$`),eI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$m(jf,Tf,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:tI,formatHex:tI,formatHex8:mse,formatHsl:yse,formatRgb:nI,toString:nI});function tI(){return this.rgb().formatHex()}function mse(){return this.rgb().formatHex8()}function yse(){return sO(this).formatHsl()}function nI(){return this.rgb().formatRgb()}function Tf(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=use.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?rI(e):n===3?new go(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ny(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ny(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=cse.exec(t))?new go(e[1],e[2],e[3],1):(e=hse.exec(t))?new go(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=fse.exec(t))?ny(e[1],e[2],e[3],e[4]):(e=dse.exec(t))?ny(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=pse.exec(t))?oI(e[1],e[2]/100,e[3]/100,1):(e=gse.exec(t))?oI(e[1],e[2]/100,e[3]/100,e[4]):eI.hasOwnProperty(t)?rI(eI[t]):t==="transparent"?new go(NaN,NaN,NaN,0):null}function rI(t){return new go(t>>16&255,t>>8&255,t&255,1)}function ny(t,e,n,r){return r<=0&&(t=e=n=NaN),new go(t,e,n,r)}function iO(t){return t instanceof jf||(t=Tf(t)),t?(t=t.rgb(),new go(t.r,t.g,t.b,t.opacity)):new go}function Sf(t,e,n,r){return arguments.length===1?iO(t):new go(t,e,n,r??1)}function go(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}$m(go,Sf,xv(jf,{brighter(t){return t=t==null?s2:Math.pow(s2,t),new go(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?rm:Math.pow(rm,t),new go(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new go(uf(this.r),uf(this.g),uf(this.b),o2(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:iI,formatHex:iI,formatHex8:_se,formatRgb:sI,toString:sI}));function iI(){return`#${of(this.r)}${of(this.g)}${of(this.b)}`}function _se(){return`#${of(this.r)}${of(this.g)}${of(this.b)}${of((isNaN(this.opacity)?1:this.opacity)*255)}`}function sI(){const t=o2(this.opacity);return`${t===1?"rgb(":"rgba("}${uf(this.r)}, ${uf(this.g)}, ${uf(this.b)}${t===1?")":`, ${t})`}`}function o2(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function uf(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function of(t){return t=uf(t),(t<16?"0":"")+t.toString(16)}function oI(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new rA(t,e,n,r)}function sO(t){if(t instanceof rA)return new rA(t.h,t.s,t.l,t.opacity);if(t instanceof jf||(t=Tf(t)),!t)return new rA;if(t instanceof rA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),l=NaN,o=s-i,p=(s+i)/2;return o?(e===s?l=(n-r)/o+(n<r)*6:n===s?l=(r-e)/o+2:l=(e-n)/o+4,o/=p<.5?s+i:2-s-i,l*=60):o=p>0&&p<1?0:l,new rA(l,o,p,t.opacity)}function vse(t,e,n,r){return arguments.length===1?sO(t):new rA(t,e,n,r??1)}function rA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}$m(rA,vse,xv(jf,{brighter(t){return t=t==null?s2:Math.pow(s2,t),new rA(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?rm:Math.pow(rm,t),new rA(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new go($w(t>=240?t-240:t+120,i,r),$w(t,i,r),$w(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new rA(aI(this.h),ry(this.s),ry(this.l),o2(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=o2(this.opacity);return`${t===1?"hsl(":"hsla("}${aI(this.h)}, ${ry(this.s)*100}%, ${ry(this.l)*100}%${t===1?")":`, ${t})`}`}}));function aI(t){return t=(t||0)%360,t<0?t+360:t}function ry(t){return Math.max(0,Math.min(1,t||0))}function $w(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const xse=Math.PI/180,wse=180/Math.PI,a2=18,oO=.96422,aO=1,lO=.82521,AO=4/29,od=6/29,uO=3*od*od,bse=od*od*od;function cO(t){if(t instanceof tu)return new tu(t.l,t.a,t.b,t.opacity);if(t instanceof XA)return fO(t);t instanceof go||(t=iO(t));var e=Qw(t.r),n=Qw(t.g),r=Qw(t.b),i=jw((.2225045*e+.7168786*n+.0606169*r)/aO),s,l;return e===n&&n===r?s=l=i:(s=jw((.4360747*e+.3850649*n+.1430804*r)/oO),l=jw((.0139322*e+.0971045*n+.7141733*r)/lO)),new tu(116*i-16,500*(s-i),200*(i-l),t.opacity)}function Ese(t,e,n,r){return arguments.length===1?cO(t):new tu(t,e,n,r??1)}function tu(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}$m(tu,Ese,xv(jf,{brighter(t){return new tu(this.l+a2*(t??1),this.a,this.b,this.opacity)},darker(t){return new tu(this.l-a2*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=oO*Hw(e),t=aO*Hw(t),n=lO*Hw(n),new go(Ww(3.1338561*e-1.6168667*t-.4906146*n),Ww(-.9787684*e+1.9161415*t+.033454*n),Ww(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function jw(t){return t>bse?Math.pow(t,1/3):t/uO+AO}function Hw(t){return t>od?t*t*t:uO*(t-AO)}function Ww(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Qw(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function hO(t){if(t instanceof XA)return new XA(t.h,t.c,t.l,t.opacity);if(t instanceof tu||(t=cO(t)),t.a===0&&t.b===0)return new XA(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*wse;return new XA(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function lI(t,e,n,r){return arguments.length===1?hO(t):new XA(n,e,t,r??1)}function Tse(t,e,n,r){return arguments.length===1?hO(t):new XA(t,e,n,r??1)}function XA(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function fO(t){if(isNaN(t.h))return new tu(t.l,0,0,t.opacity);var e=t.h*xse;return new tu(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}$m(XA,Tse,xv(jf,{brighter(t){return new XA(this.h,this.c,this.l+a2*(t??1),this.opacity)},darker(t){return new XA(this.h,this.c,this.l-a2*(t??1),this.opacity)},rgb(){return fO(this).rgb()}}));function Sse(t,e,n,r,i){var s=t*t,l=s*t;return((1-3*t+3*s-l)*e+(4-6*s+3*l)*n+(1+3*t+3*s-3*l)*r+l*i)/6}function Cse(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],s=t[r+1],l=r>0?t[r-1]:2*i-s,o=r<e-1?t[r+2]:2*s-i;return Sse((n-r/e)*e,l,i,s,o)}}const zS=t=>()=>t;function Mse(t,e){return function(n){return t+n*e}}function Pse(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function kse(t){return(t=+t)==1?dO:function(e,n){return n-e?Pse(e,n,t):zS(isNaN(e)?n:e)}}function dO(t,e){var n=e-t;return n?Mse(t,n):zS(isNaN(t)?e:t)}const l2=function t(e){var n=kse(e);function r(i,s){var l=n((i=Sf(i)).r,(s=Sf(s)).r),o=n(i.g,s.g),p=n(i.b,s.b),_=dO(i.opacity,s.opacity);return function(C){return i.r=l(C),i.g=o(C),i.b=p(C),i.opacity=_(C),i+""}}return r.gamma=t,r}(1);function Ise(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),s=new Array(n),l,o;for(l=0;l<n;++l)o=Sf(e[l]),r[l]=o.r||0,i[l]=o.g||0,s[l]=o.b||0;return r=t(r),i=t(i),s=t(s),o.opacity=1,function(p){return o.r=r(p),o.g=i(p),o.b=s(p),o+""}}}var pO=Ise(Cse);function Lse(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function Dse(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Rse(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),l;for(l=0;l<r;++l)i[l]=OS(t[l],e[l]);for(;l<n;++l)s[l]=e[l];return function(o){for(l=0;l<r;++l)s[l]=i[l](o);return s}}function Bse(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function tA(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function zse(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=OS(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var aE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qw=new RegExp(aE.source,"g");function Ose(t){return function(){return t}}function Fse(t){return function(e){return t(e)+""}}function gO(t,e){var n=aE.lastIndex=qw.lastIndex=0,r,i,s,l=-1,o=[],p=[];for(t=t+"",e=e+"";(r=aE.exec(t))&&(i=qw.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[l]?o[l]+=s:o[++l]=s),(r=r[0])===(i=i[0])?o[l]?o[l]+=i:o[++l]=i:(o[++l]=null,p.push({i:l,x:tA(r,i)})),n=qw.lastIndex;return n<e.length&&(s=e.slice(n),o[l]?o[l]+=s:o[++l]=s),o.length<2?p[0]?Fse(p[0].x):Ose(e):(e=p.length,function(_){for(var C=0,M;C<e;++C)o[(M=p[C]).i]=M.x(_);return o.join("")})}function OS(t,e){var n=typeof e,r;return e==null||n==="boolean"?zS(e):(n==="number"?tA:n==="string"?(r=Tf(e))?(e=r,l2):gO:e instanceof Tf?l2:e instanceof Date?Bse:Dse(e)?Lse:Array.isArray(e)?Rse:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?zse:tA)(t,e)}function Nse(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var AI=180/Math.PI,lE={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function mO(t,e,n,r,i,s){var l,o,p;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(p=t*n+e*r)&&(n-=t*p,r-=e*p),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,p/=o),t*r<e*n&&(t=-t,e=-e,p=-p,l=-l),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*AI,skewX:Math.atan(p)*AI,scaleX:l,scaleY:o}}var iy;function Use(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?lE:mO(e.a,e.b,e.c,e.d,e.e,e.f)}function Vse(t){return t==null||(iy||(iy=document.createElementNS("http://www.w3.org/2000/svg","g")),iy.setAttribute("transform",t),!(t=iy.transform.baseVal.consolidate()))?lE:(t=t.matrix,mO(t.a,t.b,t.c,t.d,t.e,t.f))}function yO(t,e,n,r){function i(_){return _.length?_.pop()+" ":""}function s(_,C,M,k,F,j){if(_!==M||C!==k){var H=F.push("translate(",null,e,null,n);j.push({i:H-4,x:tA(_,M)},{i:H-2,x:tA(C,k)})}else(M||k)&&F.push("translate("+M+e+k+n)}function l(_,C,M,k){_!==C?(_-C>180?C+=360:C-_>180&&(_+=360),k.push({i:M.push(i(M)+"rotate(",null,r)-2,x:tA(_,C)})):C&&M.push(i(M)+"rotate("+C+r)}function o(_,C,M,k){_!==C?k.push({i:M.push(i(M)+"skewX(",null,r)-2,x:tA(_,C)}):C&&M.push(i(M)+"skewX("+C+r)}function p(_,C,M,k,F,j){if(_!==M||C!==k){var H=F.push(i(F)+"scale(",null,",",null,")");j.push({i:H-4,x:tA(_,M)},{i:H-2,x:tA(C,k)})}else(M!==1||k!==1)&&F.push(i(F)+"scale("+M+","+k+")")}return function(_,C){var M=[],k=[];return _=t(_),C=t(C),s(_.translateX,_.translateY,C.translateX,C.translateY,M,k),l(_.rotate,C.rotate,M,k),o(_.skewX,C.skewX,M,k),p(_.scaleX,_.scaleY,C.scaleX,C.scaleY,M,k),_=C=null,function(F){for(var j=-1,H=k.length,ie;++j<H;)M[(ie=k[j]).i]=ie.x(F);return M.join("")}}}var Gse=yO(Use,"px, ","px)","deg)"),$se=yO(Vse,", ",")",")");function uI(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}var Md=0,ig=0,zp=0,_O=1e3,A2,sg,u2=0,Cf=0,wv=0,sm=typeof performance=="object"&&performance.now?performance:Date,vO=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function FS(){return Cf||(vO(jse),Cf=sm.now()+wv)}function jse(){Cf=0}function c2(){this._call=this._time=this._next=null}c2.prototype=xO.prototype={constructor:c2,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?FS():+n)+(e==null?0:+e),!this._next&&sg!==this&&(sg?sg._next=this:A2=this,sg=this),this._call=t,this._time=n,AE()},stop:function(){this._call&&(this._call=null,this._time=1/0,AE())}};function xO(t,e,n){var r=new c2;return r.restart(t,e,n),r}function Hse(){FS(),++Md;for(var t=A2,e;t;)(e=Cf-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Md}function cI(){Cf=(u2=sm.now())+wv,Md=ig=0;try{Hse()}finally{Md=0,Qse(),Cf=0}}function Wse(){var t=sm.now(),e=t-u2;e>_O&&(wv-=e,u2=t)}function Qse(){for(var t,e=A2,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:A2=n);sg=t,AE(r)}function AE(t){if(!Md){ig&&(ig=clearTimeout(ig));var e=t-Cf;e>24?(t<1/0&&(ig=setTimeout(cI,t-sm.now()-wv)),zp&&(zp=clearInterval(zp))):(zp||(u2=sm.now(),zp=setInterval(Wse,_O)),Md=1,vO(cI))}}function hI(t,e,n){var r=new c2;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var qse=Hz("start","end","cancel","interrupt"),Zse=[],wO=0,fI=1,uE=2,Ky=3,dI=4,cE=5,Jy=6;function bv(t,e,n,r,i,s){var l=t.__transition;if(!l)t.__transition={};else if(n in l)return;Yse(t,n,{name:e,index:r,group:i,on:qse,tween:Zse,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:wO})}function NS(t,e){var n=xA(t,e);if(n.state>wO)throw new Error("too late; already scheduled");return n}function ou(t,e){var n=xA(t,e);if(n.state>Ky)throw new Error("too late; already running");return n}function xA(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Yse(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=xO(s,0,n.time);function s(_){n.state=fI,n.timer.restart(l,n.delay,n.time),n.delay<=_&&l(_-n.delay)}function l(_){var C,M,k,F;if(n.state!==fI)return p();for(C in r)if(F=r[C],F.name===n.name){if(F.state===Ky)return hI(l);F.state===dI?(F.state=Jy,F.timer.stop(),F.on.call("interrupt",t,t.__data__,F.index,F.group),delete r[C]):+C<e&&(F.state=Jy,F.timer.stop(),F.on.call("cancel",t,t.__data__,F.index,F.group),delete r[C])}if(hI(function(){n.state===Ky&&(n.state=dI,n.timer.restart(o,n.delay,n.time),o(_))}),n.state=uE,n.on.call("start",t,t.__data__,n.index,n.group),n.state===uE){for(n.state=Ky,i=new Array(k=n.tween.length),C=0,M=-1;C<k;++C)(F=n.tween[C].value.call(t,t.__data__,n.index,n.group))&&(i[++M]=F);i.length=M+1}}function o(_){for(var C=_<n.duration?n.ease.call(null,_/n.duration):(n.timer.restart(p),n.state=cE,1),M=-1,k=i.length;++M<k;)i[M].call(t,C);n.state===cE&&(n.on.call("end",t,t.__data__,n.index,n.group),p())}function p(){n.state=Jy,n.timer.stop(),delete r[e];for(var _ in r)return;delete t.__transition}}function Xse(t,e){var n=t.__transition,r,i,s=!0,l;if(n){e=e==null?null:e+"";for(l in n){if((r=n[l]).name!==e){s=!1;continue}i=r.state>uE&&r.state<cE,r.state=Jy,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[l]}s&&delete t.__transition}}function Kse(t){return this.each(function(){Xse(this,t)})}function Jse(t,e){var n,r;return function(){var i=ou(this,t),s=i.tween;if(s!==n){r=n=s;for(var l=0,o=r.length;l<o;++l)if(r[l].name===e){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function eoe(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=ou(this,t),l=s.tween;if(l!==r){i=(r=l).slice();for(var o={name:e,value:n},p=0,_=i.length;p<_;++p)if(i[p].name===e){i[p]=o;break}p===_&&i.push(o)}s.tween=i}}function toe(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=xA(this.node(),n).tween,i=0,s=r.length,l;i<s;++i)if((l=r[i]).name===t)return l.value;return null}return this.each((e==null?Jse:eoe)(n,t,e))}function US(t,e,n){var r=t._id;return t.each(function(){var i=ou(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return xA(i,r).value[e]}}function bO(t,e){var n;return(typeof e=="number"?tA:e instanceof Tf?l2:(n=Tf(e))?(e=n,l2):gO)(t,e)}function noe(t){return function(){this.removeAttribute(t)}}function roe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ioe(t,e,n){var r,i=n+"",s;return function(){var l=this.getAttribute(t);return l===i?null:l===r?s:s=e(r=l,n)}}function soe(t,e,n){var r,i=n+"",s;return function(){var l=this.getAttributeNS(t.space,t.local);return l===i?null:l===r?s:s=e(r=l,n)}}function ooe(t,e,n){var r,i,s;return function(){var l,o=n(this),p;return o==null?void this.removeAttribute(t):(l=this.getAttribute(t),p=o+"",l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o)))}}function aoe(t,e,n){var r,i,s;return function(){var l,o=n(this),p;return o==null?void this.removeAttributeNS(t.space,t.local):(l=this.getAttributeNS(t.space,t.local),p=o+"",l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o)))}}function loe(t,e){var n=vv(t),r=n==="transform"?$se:bO;return this.attrTween(t,typeof e=="function"?(n.local?aoe:ooe)(n,r,US(this,"attr."+t,e)):e==null?(n.local?roe:noe)(n):(n.local?soe:ioe)(n,r,e))}function Aoe(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function uoe(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function coe(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&uoe(t,s)),n}return i._value=e,i}function hoe(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&Aoe(t,s)),n}return i._value=e,i}function foe(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=vv(t);return this.tween(n,(r.local?coe:hoe)(r,e))}function doe(t,e){return function(){NS(this,t).delay=+e.apply(this,arguments)}}function poe(t,e){return e=+e,function(){NS(this,t).delay=e}}function goe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?doe:poe)(e,t)):xA(this.node(),e).delay}function moe(t,e){return function(){ou(this,t).duration=+e.apply(this,arguments)}}function yoe(t,e){return e=+e,function(){ou(this,t).duration=e}}function _oe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?moe:yoe)(e,t)):xA(this.node(),e).duration}function voe(t,e){if(typeof e!="function")throw new Error;return function(){ou(this,t).ease=e}}function xoe(t){var e=this._id;return arguments.length?this.each(voe(e,t)):xA(this.node(),e).ease}function woe(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ou(this,t).ease=n}}function boe(t){if(typeof t!="function")throw new Error;return this.each(woe(this._id,t))}function Eoe(t){typeof t!="function"&&(t=Zz(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=[],p,_=0;_<l;++_)(p=s[_])&&t.call(p,p.__data__,_,s)&&o.push(p);return new hc(r,this._parents,this._name,this._id)}function Toe(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),l=new Array(r),o=0;o<s;++o)for(var p=e[o],_=n[o],C=p.length,M=l[o]=new Array(C),k,F=0;F<C;++F)(k=p[F]||_[F])&&(M[F]=k);for(;o<r;++o)l[o]=e[o];return new hc(l,this._parents,this._name,this._id)}function Soe(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Coe(t,e,n){var r,i,s=Soe(e)?NS:ou;return function(){var l=s(this,t),o=l.on;o!==r&&(i=(r=o).copy()).on(e,n),l.on=i}}function Moe(t,e){var n=this._id;return arguments.length<2?xA(this.node(),n).on.on(t):this.each(Coe(n,t,e))}function Poe(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function koe(){return this.on("end.remove",Poe(this._id))}function Ioe(t){var e=this._name,n=this._id;typeof t!="function"&&(t=DS(t));for(var r=this._groups,i=r.length,s=new Array(i),l=0;l<i;++l)for(var o=r[l],p=o.length,_=s[l]=new Array(p),C,M,k=0;k<p;++k)(C=o[k])&&(M=t.call(C,C.__data__,k,o))&&("__data__"in C&&(M.__data__=C.__data__),_[k]=M,bv(_[k],e,n,k,_,xA(C,n)));return new hc(s,this._parents,e,n)}function Loe(t){var e=this._name,n=this._id;typeof t!="function"&&(t=qz(t));for(var r=this._groups,i=r.length,s=[],l=[],o=0;o<i;++o)for(var p=r[o],_=p.length,C,M=0;M<_;++M)if(C=p[M]){for(var k=t.call(C,C.__data__,M,p),F,j=xA(C,n),H=0,ie=k.length;H<ie;++H)(F=k[H])&&bv(F,e,n,H,k,j);s.push(k),l.push(C)}return new hc(s,l,e,n)}var Doe=Gm.prototype.constructor;function Roe(){return new Doe(this._groups,this._parents)}function Boe(t,e){var n,r,i;return function(){var s=Cd(this,t),l=(this.style.removeProperty(t),Cd(this,t));return s===l?null:s===n&&l===r?i:i=e(n=s,r=l)}}function EO(t){return function(){this.style.removeProperty(t)}}function zoe(t,e,n){var r,i=n+"",s;return function(){var l=Cd(this,t);return l===i?null:l===r?s:s=e(r=l,n)}}function Ooe(t,e,n){var r,i,s;return function(){var l=Cd(this,t),o=n(this),p=o+"";return o==null&&(p=o=(this.style.removeProperty(t),Cd(this,t))),l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o))}}function Foe(t,e){var n,r,i,s="style."+e,l="end."+s,o;return function(){var p=ou(this,t),_=p.on,C=p.value[s]==null?o||(o=EO(e)):void 0;(_!==n||i!==C)&&(r=(n=_).copy()).on(l,i=C),p.on=r}}function Noe(t,e,n){var r=(t+="")=="transform"?Gse:bO;return e==null?this.styleTween(t,Boe(t,r)).on("end.style."+t,EO(t)):typeof e=="function"?this.styleTween(t,Ooe(t,r,US(this,"style."+t,e))).each(Foe(this._id,t)):this.styleTween(t,zoe(t,r,e),n).on("end.style."+t,null)}function Uoe(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Voe(t,e,n){var r,i;function s(){var l=e.apply(this,arguments);return l!==i&&(r=(i=l)&&Uoe(t,l,n)),r}return s._value=e,s}function Goe(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Voe(t,e,n??""))}function $oe(t){return function(){this.textContent=t}}function joe(t){return function(){var e=t(this);this.textContent=e??""}}function Hoe(t){return this.tween("text",typeof t=="function"?joe(US(this,"text",t)):$oe(t==null?"":t+""))}function Woe(t){return function(e){this.textContent=t.call(this,e)}}function Qoe(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Woe(i)),e}return r._value=t,r}function qoe(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Qoe(t))}function Zoe(){for(var t=this._name,e=this._id,n=TO(),r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],o=l.length,p,_=0;_<o;++_)if(p=l[_]){var C=xA(p,e);bv(p,t,n,_,l,{time:C.time+C.delay+C.duration,delay:0,duration:C.duration,ease:C.ease})}return new hc(r,this._parents,t,n)}function Yoe(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,l){var o={value:l},p={value:function(){--i===0&&s()}};n.each(function(){var _=ou(this,r),C=_.on;C!==t&&(e=(t=C).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(p)),_.on=e}),i===0&&s()})}var Xoe=0;function hc(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function TO(){return++Xoe}var Ou=Gm.prototype;hc.prototype={constructor:hc,select:Ioe,selectAll:Loe,selectChild:Ou.selectChild,selectChildren:Ou.selectChildren,filter:Eoe,merge:Toe,selection:Roe,transition:Zoe,call:Ou.call,nodes:Ou.nodes,node:Ou.node,size:Ou.size,empty:Ou.empty,each:Ou.each,on:Moe,attr:loe,attrTween:foe,style:Noe,styleTween:Goe,text:Hoe,textTween:qoe,remove:koe,tween:toe,delay:goe,duration:_oe,ease:xoe,easeVarying:boe,end:Yoe,[Symbol.iterator]:Ou[Symbol.iterator]};function Koe(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Joe={time:null,delay:0,duration:250,ease:Koe};function eae(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function tae(t){var e,n;t instanceof hc?(e=t._id,t=t._name):(e=TO(),(n=Joe).time=FS(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],o=l.length,p,_=0;_<o;++_)(p=l[_])&&bv(p,t,e,_,l,n||eae(p,e));return new hc(r,this._parents,t,e)}Gm.prototype.interrupt=Kse;Gm.prototype.transition=tae;const hE=Math.PI,fE=2*hE,Jh=1e-6,nae=fE-Jh;function SO(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function rae(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return SO;const n=10**e;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let iae=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?SO:rae(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,s,l){this._append`C${+e},${+n},${+r},${+i},${this._x1=+s},${this._y1=+l}`}arcTo(e,n,r,i,s){if(e=+e,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let l=this._x1,o=this._y1,p=r-e,_=i-n,C=l-e,M=o-n,k=C*C+M*M;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(k>Jh)if(!(Math.abs(M*p-_*C)>Jh)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let F=r-l,j=i-o,H=p*p+_*_,ie=F*F+j*j,Y=Math.sqrt(H),J=Math.sqrt(k),se=s*Math.tan((hE-Math.acos((H+k-ie)/(2*Y*J)))/2),he=se/J,pe=se/Y;Math.abs(he-1)>Jh&&this._append`L${e+he*C},${n+he*M}`,this._append`A${s},${s},0,0,${+(M*F>C*j)},${this._x1=e+pe*p},${this._y1=n+pe*_}`}}arc(e,n,r,i,s,l){if(e=+e,n=+n,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),p=r*Math.sin(i),_=e+o,C=n+p,M=1^l,k=l?i-s:s-i;this._x1===null?this._append`M${_},${C}`:(Math.abs(this._x1-_)>Jh||Math.abs(this._y1-C)>Jh)&&this._append`L${_},${C}`,r&&(k<0&&(k=k%fE+fE),k>nae?this._append`A${r},${r},0,1,${M},${e-o},${n-p}A${r},${r},0,1,${M},${this._x1=_},${this._y1=C}`:k>Jh&&this._append`A${r},${r},0,${+(k>=hE)},${M},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};const nc=11102230246251565e-32,so=134217729,sae=(3+8*nc)*nc;function Zw(t,e,n,r,i){let s,l,o,p,_=e[0],C=r[0],M=0,k=0;C>_==C>-_?(s=_,_=e[++M]):(s=C,C=r[++k]);let F=0;if(M<t&&k<n)for(C>_==C>-_?(l=_+s,o=s-(l-_),_=e[++M]):(l=C+s,o=s-(l-C),C=r[++k]),s=l,o!==0&&(i[F++]=o);M<t&&k<n;)C>_==C>-_?(l=s+_,p=l-s,o=s-(l-p)+(_-p),_=e[++M]):(l=s+C,p=l-s,o=s-(l-p)+(C-p),C=r[++k]),s=l,o!==0&&(i[F++]=o);for(;M<t;)l=s+_,p=l-s,o=s-(l-p)+(_-p),_=e[++M],s=l,o!==0&&(i[F++]=o);for(;k<n;)l=s+C,p=l-s,o=s-(l-p)+(C-p),C=r[++k],s=l,o!==0&&(i[F++]=o);return(s!==0||F===0)&&(i[F++]=s),F}function oae(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}function jm(t){return new Float64Array(t)}const aae=(3+16*nc)*nc,lae=(2+12*nc)*nc,Aae=(9+64*nc)*nc*nc,y0=jm(4),pI=jm(8),gI=jm(12),mI=jm(16),Do=jm(4);function uae(t,e,n,r,i,s,l){let o,p,_,C,M,k,F,j,H,ie,Y,J,se,he,pe,be,Ge,We;const Xe=t-i,rt=n-i,Oe=e-s,nt=r-s;he=Xe*nt,k=so*Xe,F=k-(k-Xe),j=Xe-F,k=so*nt,H=k-(k-nt),ie=nt-H,pe=j*ie-(he-F*H-j*H-F*ie),be=Oe*rt,k=so*Oe,F=k-(k-Oe),j=Oe-F,k=so*rt,H=k-(k-rt),ie=rt-H,Ge=j*ie-(be-F*H-j*H-F*ie),Y=pe-Ge,M=pe-Y,y0[0]=pe-(Y+M)+(M-Ge),J=he+Y,M=J-he,se=he-(J-M)+(Y-M),Y=se-be,M=se-Y,y0[1]=se-(Y+M)+(M-be),We=J+Y,M=We-J,y0[2]=J-(We-M)+(Y-M),y0[3]=We;let Ze=oae(4,y0),pt=lae*l;if(Ze>=pt||-Ze>=pt||(M=t-Xe,o=t-(Xe+M)+(M-i),M=n-rt,_=n-(rt+M)+(M-i),M=e-Oe,p=e-(Oe+M)+(M-s),M=r-nt,C=r-(nt+M)+(M-s),o===0&&p===0&&_===0&&C===0)||(pt=Aae*l+sae*Math.abs(Ze),Ze+=Xe*C+nt*o-(Oe*_+rt*p),Ze>=pt||-Ze>=pt))return Ze;he=o*nt,k=so*o,F=k-(k-o),j=o-F,k=so*nt,H=k-(k-nt),ie=nt-H,pe=j*ie-(he-F*H-j*H-F*ie),be=p*rt,k=so*p,F=k-(k-p),j=p-F,k=so*rt,H=k-(k-rt),ie=rt-H,Ge=j*ie-(be-F*H-j*H-F*ie),Y=pe-Ge,M=pe-Y,Do[0]=pe-(Y+M)+(M-Ge),J=he+Y,M=J-he,se=he-(J-M)+(Y-M),Y=se-be,M=se-Y,Do[1]=se-(Y+M)+(M-be),We=J+Y,M=We-J,Do[2]=J-(We-M)+(Y-M),Do[3]=We;const Yt=Zw(4,y0,4,Do,pI);he=Xe*C,k=so*Xe,F=k-(k-Xe),j=Xe-F,k=so*C,H=k-(k-C),ie=C-H,pe=j*ie-(he-F*H-j*H-F*ie),be=Oe*_,k=so*Oe,F=k-(k-Oe),j=Oe-F,k=so*_,H=k-(k-_),ie=_-H,Ge=j*ie-(be-F*H-j*H-F*ie),Y=pe-Ge,M=pe-Y,Do[0]=pe-(Y+M)+(M-Ge),J=he+Y,M=J-he,se=he-(J-M)+(Y-M),Y=se-be,M=se-Y,Do[1]=se-(Y+M)+(M-be),We=J+Y,M=We-J,Do[2]=J-(We-M)+(Y-M),Do[3]=We;const Et=Zw(Yt,pI,4,Do,gI);he=o*C,k=so*o,F=k-(k-o),j=o-F,k=so*C,H=k-(k-C),ie=C-H,pe=j*ie-(he-F*H-j*H-F*ie),be=p*_,k=so*p,F=k-(k-p),j=p-F,k=so*_,H=k-(k-_),ie=_-H,Ge=j*ie-(be-F*H-j*H-F*ie),Y=pe-Ge,M=pe-Y,Do[0]=pe-(Y+M)+(M-Ge),J=he+Y,M=J-he,se=he-(J-M)+(Y-M),Y=se-be,M=se-Y,Do[1]=se-(Y+M)+(M-be),We=J+Y,M=We-J,Do[2]=J-(We-M)+(Y-M),Do[3]=We;const un=Zw(Et,gI,4,Do,mI);return mI[un-1]}function cae(t,e,n,r,i,s){const l=(e-s)*(n-i),o=(t-i)*(r-s),p=l-o,_=Math.abs(l+o);return Math.abs(p)>=aae*_?p:-uae(t,e,n,r,i,s,_)}function hae(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function h2(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Pd(t){return t=h2(Math.abs(t)),t?t[1]:NaN}function fae(t,e){return function(n,r){for(var i=n.length,s=[],l=0,o=t[0],p=0;i>0&&o>0&&(p+o+1>r&&(o=Math.max(1,r-p)),s.push(n.substring(i-=o,i+o)),!((p+=o+1)>r));)o=t[l=(l+1)%t.length];return s.reverse().join(e)}}function dae(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var pae=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function f2(t){if(!(e=pae.exec(t)))throw new Error("invalid format: "+t);var e;return new VS({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}f2.prototype=VS.prototype;function VS(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}VS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function gae(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var CO;function mae(t,e){var n=h2(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(CO=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+h2(t,Math.max(0,e+s-1))[0]}function yI(t,e){var n=h2(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const _I={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:hae,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>yI(t*100,e),r:yI,s:mae,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function vI(t){return t}var xI=Array.prototype.map,wI=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function yae(t){var e=t.grouping===void 0||t.thousands===void 0?vI:fae(xI.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?vI:dae(xI.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",p=t.nan===void 0?"NaN":t.nan+"";function _(M){M=f2(M);var k=M.fill,F=M.align,j=M.sign,H=M.symbol,ie=M.zero,Y=M.width,J=M.comma,se=M.precision,he=M.trim,pe=M.type;pe==="n"?(J=!0,pe="g"):_I[pe]||(se===void 0&&(se=12),he=!0,pe="g"),(ie||k==="0"&&F==="=")&&(ie=!0,k="0",F="=");var be=H==="$"?n:H==="#"&&/[boxX]/.test(pe)?"0"+pe.toLowerCase():"",Ge=H==="$"?r:/[%p]/.test(pe)?l:"",We=_I[pe],Xe=/[defgprs%]/.test(pe);se=se===void 0?6:/[gprs]/.test(pe)?Math.max(1,Math.min(21,se)):Math.max(0,Math.min(20,se));function rt(Oe){var nt=be,Ze=Ge,pt,Yt,Et;if(pe==="c")Ze=We(Oe)+Ze,Oe="";else{Oe=+Oe;var un=Oe<0||1/Oe<0;if(Oe=isNaN(Oe)?p:We(Math.abs(Oe),se),he&&(Oe=gae(Oe)),un&&+Oe==0&&j!=="+"&&(un=!1),nt=(un?j==="("?j:o:j==="-"||j==="("?"":j)+nt,Ze=(pe==="s"?wI[8+CO/3]:"")+Ze+(un&&j==="("?")":""),Xe){for(pt=-1,Yt=Oe.length;++pt<Yt;)if(Et=Oe.charCodeAt(pt),48>Et||Et>57){Ze=(Et===46?i+Oe.slice(pt+1):Oe.slice(pt))+Ze,Oe=Oe.slice(0,pt);break}}}J&&!ie&&(Oe=e(Oe,1/0));var _t=nt.length+Oe.length+Ze.length,Tt=_t<Y?new Array(Y-_t+1).join(k):"";switch(J&&ie&&(Oe=e(Tt+Oe,Tt.length?Y-Ze.length:1/0),Tt=""),F){case"<":Oe=nt+Oe+Ze+Tt;break;case"=":Oe=nt+Tt+Oe+Ze;break;case"^":Oe=Tt.slice(0,_t=Tt.length>>1)+nt+Oe+Ze+Tt.slice(_t);break;default:Oe=Tt+nt+Oe+Ze;break}return s(Oe)}return rt.toString=function(){return M+""},rt}function C(M,k){var F=_((M=f2(M),M.type="f",M)),j=Math.max(-8,Math.min(8,Math.floor(Pd(k)/3)))*3,H=Math.pow(10,-j),ie=wI[8+j/3];return function(Y){return F(H*Y)+ie}}return{format:_,formatPrefix:C}}var sy,ci,MO;_ae({thousands:",",grouping:[3],currency:["$",""]});function _ae(t){return sy=yae(t),ci=sy.format,MO=sy.formatPrefix,sy}function vae(t){return Math.max(0,-Pd(Math.abs(t)))}function xae(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Pd(e)/3)))*3-Pd(Math.abs(t)))}function wae(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Pd(e)-Pd(t))+1}function Hm(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const bI=Symbol("implicit");function PO(){var t=new qk,e=[],n=[],r=bI;function i(s){let l=t.get(s);if(l===void 0){if(r!==bI)return r;t.set(s,l=e.push(s)-1)}return n[l%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new qk;for(const l of s)t.has(l)||t.set(l,e.push(l)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return PO(e,n).unknown(r)},Hm.apply(i,arguments),i}function kO(){var t=PO().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,s,l,o=!1,p=0,_=0,C=.5;delete t.unknown;function M(){var k=e().length,F=i<r,j=F?i:r,H=F?r:i;s=(H-j)/Math.max(1,k-p+_*2),o&&(s=Math.floor(s)),j+=(H-j-s*(k-p))*C,l=s*(1-p),o&&(j=Math.round(j),l=Math.round(l));var ie=wh(k).map(function(Y){return j+s*Y});return n(F?ie.reverse():ie)}return t.domain=function(k){return arguments.length?(e(k),M()):e()},t.range=function(k){return arguments.length?([r,i]=k,r=+r,i=+i,M()):[r,i]},t.rangeRound=function(k){return[r,i]=k,r=+r,i=+i,o=!0,M()},t.bandwidth=function(){return l},t.step=function(){return s},t.round=function(k){return arguments.length?(o=!!k,M()):o},t.padding=function(k){return arguments.length?(p=Math.min(1,_=+k),M()):p},t.paddingInner=function(k){return arguments.length?(p=Math.min(1,k),M()):p},t.paddingOuter=function(k){return arguments.length?(_=+k,M()):_},t.align=function(k){return arguments.length?(C=Math.max(0,Math.min(1,k)),M()):C},t.copy=function(){return kO(e(),[r,i]).round(o).paddingInner(p).paddingOuter(_).align(C)},Hm.apply(M(),arguments)}function IO(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return IO(e())},t}function Qu(){return IO(kO.apply(null,arguments).paddingInner(1))}function bae(t){return function(){return t}}function Eae(t){return+t}var EI=[0,1];function F0(t){return t}function dE(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:bae(isNaN(e)?NaN:.5)}function Tae(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function Sae(t,e,n){var r=t[0],i=t[1],s=e[0],l=e[1];return i<r?(r=dE(i,r),s=n(l,s)):(r=dE(r,i),s=n(s,l)),function(o){return s(r(o))}}function Cae(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),l=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<r;)i[l]=dE(t[l],t[l+1]),s[l]=n(e[l],e[l+1]);return function(o){var p=$z(t,o,1,r)-1;return s[p](i[p](o))}}function LO(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Mae(){var t=EI,e=EI,n=OS,r,i,s,l=F0,o,p,_;function C(){var k=Math.min(t.length,e.length);return l!==F0&&(l=Tae(t[0],t[k-1])),o=k>2?Cae:Sae,p=_=null,M}function M(k){return k==null||isNaN(k=+k)?s:(p||(p=o(t.map(r),e,n)))(r(l(k)))}return M.invert=function(k){return l(i((_||(_=o(e,t.map(r),tA)))(k)))},M.domain=function(k){return arguments.length?(t=Array.from(k,Eae),C()):t.slice()},M.range=function(k){return arguments.length?(e=Array.from(k),C()):e.slice()},M.rangeRound=function(k){return e=Array.from(k),n=Nse,C()},M.clamp=function(k){return arguments.length?(l=k?!0:F0,C()):l!==F0},M.interpolate=function(k){return arguments.length?(n=k,C()):n},M.unknown=function(k){return arguments.length?(s=k,M):s},function(k,F){return r=k,i=F,C()}}function DO(){return Mae()(F0,F0)}function Pae(t,e,n,r){var i=sE(t,e,n),s;switch(r=f2(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=xae(i,l))&&(r.precision=s),MO(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=wae(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=vae(i))&&(r.precision=s-(r.type==="%")*2);break}}return ci(r)}function RO(t){var e=t.domain;return t.ticks=function(n){var r=e();return wre(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return Pae(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,l=r[i],o=r[s],p,_,C=10;for(o<l&&(_=l,l=o,o=_,_=i,i=s,s=_);C-- >0;){if(_=iE(l,o,n),_===p)return r[i]=l,r[s]=o,e(r);if(_>0)l=Math.floor(l/_)*_,o=Math.ceil(o/_)*_;else if(_<0)l=Math.ceil(l*_)/_,o=Math.floor(o*_)/_;else break;p=_}return t},t}function ur(){var t=DO();return t.copy=function(){return LO(t,ur())},Hm.apply(t,arguments),RO(t)}function kae(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],s=t[r],l;return s<i&&(l=n,n=r,r=l,l=i,i=s,s=l),t[n]=e.floor(i),t[r]=e.ceil(s),t}function ss(){var t=0,e=1,n=1,r=[.5],i=[0,1],s;function l(p){return p!=null&&p<=p?i[$z(r,p,0,n)]:s}function o(){var p=-1;for(r=new Array(n);++p<n;)r[p]=((p+1)*e-(p-n)*t)/(n+1);return l}return l.domain=function(p){return arguments.length?([t,e]=p,t=+t,e=+e,o()):[t,e]},l.range=function(p){return arguments.length?(n=(i=Array.from(p)).length-1,o()):i.slice()},l.invertExtent=function(p){var _=i.indexOf(p);return _<0?[NaN,NaN]:_<1?[t,r[0]]:_>=n?[r[n-1],e]:[r[_-1],r[_]]},l.unknown=function(p){return arguments.length&&(s=p),l},l.thresholds=function(){return r.slice()},l.copy=function(){return ss().domain([t,e]).range(i).unknown(s)},Hm.apply(RO(l),arguments)}const Yw=new Date,Xw=new Date;function ls(t,e,n,r){function i(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(t(s=new Date(+s)),s),i.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),i.round=s=>{const l=i(s),o=i.ceil(s);return s-l<o-s?l:o},i.offset=(s,l)=>(e(s=new Date(+s),l==null?1:Math.floor(l)),s),i.range=(s,l,o)=>{const p=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<l)||!(o>0))return p;let _;do p.push(_=new Date(+s)),e(s,o),t(s);while(_<s&&s<l);return p},i.filter=s=>ls(l=>{if(l>=l)for(;t(l),!s(l);)l.setTime(l-1)},(l,o)=>{if(l>=l)if(o<0)for(;++o<=0;)for(;e(l,-1),!s(l););else for(;--o>=0;)for(;e(l,1),!s(l););}),n&&(i.count=(s,l)=>(Yw.setTime(+s),Xw.setTime(+l),t(Yw),t(Xw),Math.floor(n(Yw,Xw))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?l=>r(l)%s===0:l=>i.count(0,l)%s===0):i)),i}const d2=ls(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);d2.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?ls(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):d2);d2.range;const qu=1e3,vl=qu*60,Zu=vl*60,fc=Zu*24,GS=fc*7,TI=fc*30,Kw=fc*365,N0=ls(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*qu)},(t,e)=>(e-t)/qu,t=>t.getUTCSeconds());N0.range;const $S=ls(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*qu)},(t,e)=>{t.setTime(+t+e*vl)},(t,e)=>(e-t)/vl,t=>t.getMinutes());$S.range;const Iae=ls(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*vl)},(t,e)=>(e-t)/vl,t=>t.getUTCMinutes());Iae.range;const jS=ls(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*qu-t.getMinutes()*vl)},(t,e)=>{t.setTime(+t+e*Zu)},(t,e)=>(e-t)/Zu,t=>t.getHours());jS.range;const Lae=ls(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Zu)},(t,e)=>(e-t)/Zu,t=>t.getUTCHours());Lae.range;const Wm=ls(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*vl)/fc,t=>t.getDate()-1);Wm.range;const HS=ls(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/fc,t=>t.getUTCDate()-1);HS.range;const Dae=ls(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/fc,t=>Math.floor(t/fc));Dae.range;function Hf(t){return ls(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*vl)/GS)}const Ev=Hf(0),p2=Hf(1),Rae=Hf(2),Bae=Hf(3),kd=Hf(4),zae=Hf(5),Oae=Hf(6);Ev.range;p2.range;Rae.range;Bae.range;kd.range;zae.range;Oae.range;function Wf(t){return ls(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/GS)}const BO=Wf(0),g2=Wf(1),Fae=Wf(2),Nae=Wf(3),Id=Wf(4),Uae=Wf(5),Vae=Wf(6);BO.range;g2.range;Fae.range;Nae.range;Id.range;Uae.range;Vae.range;const WS=ls(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());WS.range;const Gae=ls(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Gae.range;const dc=ls(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());dc.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:ls(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});dc.range;const Mf=ls(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Mf.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:ls(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});Mf.range;function $ae(t,e,n,r,i,s){const l=[[N0,1,qu],[N0,5,5*qu],[N0,15,15*qu],[N0,30,30*qu],[s,1,vl],[s,5,5*vl],[s,15,15*vl],[s,30,30*vl],[i,1,Zu],[i,3,3*Zu],[i,6,6*Zu],[i,12,12*Zu],[r,1,fc],[r,2,2*fc],[n,1,GS],[e,1,TI],[e,3,3*TI],[t,1,Kw]];function o(_,C,M){const k=C<_;k&&([_,C]=[C,_]);const F=M&&typeof M.range=="function"?M:p(_,C,M),j=F?F.range(_,+C+1):[];return k?j.reverse():j}function p(_,C,M){const k=Math.abs(C-_)/M,F=LS(([,,ie])=>ie).right(l,k);if(F===l.length)return t.every(sE(_/Kw,C/Kw,M));if(F===0)return d2.every(Math.max(sE(_,C,M),1));const[j,H]=l[k/l[F-1][2]<l[F][2]/k?F-1:F];return j.every(H)}return[o,p]}const[jae,Hae]=$ae(dc,WS,Ev,Wm,jS,$S);function Jw(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function eb(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Op(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Wae(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,s=t.days,l=t.shortDays,o=t.months,p=t.shortMonths,_=Fp(i),C=Np(i),M=Fp(s),k=Np(s),F=Fp(l),j=Np(l),H=Fp(o),ie=Np(o),Y=Fp(p),J=Np(p),se={a:un,A:_t,b:Tt,B:Jt,c:null,d:II,e:II,f:ple,g:Tle,G:Cle,H:hle,I:fle,j:dle,L:zO,m:gle,M:mle,p:Ln,q:Tn,Q:RI,s:BI,S:yle,u:_le,U:vle,V:xle,w:wle,W:ble,x:null,X:null,y:Ele,Y:Sle,Z:Mle,"%":DI},he={a:Ir,A:tr,b:ar,B:pr,c:null,d:LI,e:LI,f:Lle,g:Gle,G:jle,H:Ple,I:kle,j:Ile,L:FO,m:Dle,M:Rle,p:Gn,q:Mr,Q:RI,s:BI,S:Ble,u:zle,U:Ole,V:Fle,w:Nle,W:Ule,x:null,X:null,y:Vle,Y:$le,Z:Hle,"%":DI},pe={a:rt,A:Oe,b:nt,B:Ze,c:pt,d:PI,e:PI,f:lle,g:MI,G:CI,H:kI,I:kI,j:ile,L:ale,m:rle,M:sle,p:Xe,q:nle,Q:ule,s:cle,S:ole,u:Xae,U:Kae,V:Jae,w:Yae,W:ele,x:Yt,X:Et,y:MI,Y:CI,Z:tle,"%":Ale};se.x=be(n,se),se.X=be(r,se),se.c=be(e,se),he.x=be(n,he),he.X=be(r,he),he.c=be(e,he);function be(wt,rn){return function(Pn){var xt=[],nr=-1,Qn=0,br=wt.length,cr,rr,ni;for(Pn instanceof Date||(Pn=new Date(+Pn));++nr<br;)wt.charCodeAt(nr)===37&&(xt.push(wt.slice(Qn,nr)),(rr=SI[cr=wt.charAt(++nr)])!=null?cr=wt.charAt(++nr):rr=cr==="e"?" ":"0",(ni=rn[cr])&&(cr=ni(Pn,rr)),xt.push(cr),Qn=nr+1);return xt.push(wt.slice(Qn,nr)),xt.join("")}}function Ge(wt,rn){return function(Pn){var xt=Op(1900,void 0,1),nr=We(xt,wt,Pn+="",0),Qn,br;if(nr!=Pn.length)return null;if("Q"in xt)return new Date(xt.Q);if("s"in xt)return new Date(xt.s*1e3+("L"in xt?xt.L:0));if(rn&&!("Z"in xt)&&(xt.Z=0),"p"in xt&&(xt.H=xt.H%12+xt.p*12),xt.m===void 0&&(xt.m="q"in xt?xt.q:0),"V"in xt){if(xt.V<1||xt.V>53)return null;"w"in xt||(xt.w=1),"Z"in xt?(Qn=eb(Op(xt.y,0,1)),br=Qn.getUTCDay(),Qn=br>4||br===0?g2.ceil(Qn):g2(Qn),Qn=HS.offset(Qn,(xt.V-1)*7),xt.y=Qn.getUTCFullYear(),xt.m=Qn.getUTCMonth(),xt.d=Qn.getUTCDate()+(xt.w+6)%7):(Qn=Jw(Op(xt.y,0,1)),br=Qn.getDay(),Qn=br>4||br===0?p2.ceil(Qn):p2(Qn),Qn=Wm.offset(Qn,(xt.V-1)*7),xt.y=Qn.getFullYear(),xt.m=Qn.getMonth(),xt.d=Qn.getDate()+(xt.w+6)%7)}else("W"in xt||"U"in xt)&&("w"in xt||(xt.w="u"in xt?xt.u%7:"W"in xt?1:0),br="Z"in xt?eb(Op(xt.y,0,1)).getUTCDay():Jw(Op(xt.y,0,1)).getDay(),xt.m=0,xt.d="W"in xt?(xt.w+6)%7+xt.W*7-(br+5)%7:xt.w+xt.U*7-(br+6)%7);return"Z"in xt?(xt.H+=xt.Z/100|0,xt.M+=xt.Z%100,eb(xt)):Jw(xt)}}function We(wt,rn,Pn,xt){for(var nr=0,Qn=rn.length,br=Pn.length,cr,rr;nr<Qn;){if(xt>=br)return-1;if(cr=rn.charCodeAt(nr++),cr===37){if(cr=rn.charAt(nr++),rr=pe[cr in SI?rn.charAt(nr++):cr],!rr||(xt=rr(wt,Pn,xt))<0)return-1}else if(cr!=Pn.charCodeAt(xt++))return-1}return xt}function Xe(wt,rn,Pn){var xt=_.exec(rn.slice(Pn));return xt?(wt.p=C.get(xt[0].toLowerCase()),Pn+xt[0].length):-1}function rt(wt,rn,Pn){var xt=F.exec(rn.slice(Pn));return xt?(wt.w=j.get(xt[0].toLowerCase()),Pn+xt[0].length):-1}function Oe(wt,rn,Pn){var xt=M.exec(rn.slice(Pn));return xt?(wt.w=k.get(xt[0].toLowerCase()),Pn+xt[0].length):-1}function nt(wt,rn,Pn){var xt=Y.exec(rn.slice(Pn));return xt?(wt.m=J.get(xt[0].toLowerCase()),Pn+xt[0].length):-1}function Ze(wt,rn,Pn){var xt=H.exec(rn.slice(Pn));return xt?(wt.m=ie.get(xt[0].toLowerCase()),Pn+xt[0].length):-1}function pt(wt,rn,Pn){return We(wt,e,rn,Pn)}function Yt(wt,rn,Pn){return We(wt,n,rn,Pn)}function Et(wt,rn,Pn){return We(wt,r,rn,Pn)}function un(wt){return l[wt.getDay()]}function _t(wt){return s[wt.getDay()]}function Tt(wt){return p[wt.getMonth()]}function Jt(wt){return o[wt.getMonth()]}function Ln(wt){return i[+(wt.getHours()>=12)]}function Tn(wt){return 1+~~(wt.getMonth()/3)}function Ir(wt){return l[wt.getUTCDay()]}function tr(wt){return s[wt.getUTCDay()]}function ar(wt){return p[wt.getUTCMonth()]}function pr(wt){return o[wt.getUTCMonth()]}function Gn(wt){return i[+(wt.getUTCHours()>=12)]}function Mr(wt){return 1+~~(wt.getUTCMonth()/3)}return{format:function(wt){var rn=be(wt+="",se);return rn.toString=function(){return wt},rn},parse:function(wt){var rn=Ge(wt+="",!1);return rn.toString=function(){return wt},rn},utcFormat:function(wt){var rn=be(wt+="",he);return rn.toString=function(){return wt},rn},utcParse:function(wt){var rn=Ge(wt+="",!0);return rn.toString=function(){return wt},rn}}}var SI={"-":"",_:" ",0:"0"},Ts=/^\s*\d+/,Qae=/^%/,qae=/[\\^$*+?|[\]().{}]/g;function kr(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(e)+i:i)}function Zae(t){return t.replace(qae,"\\$&")}function Fp(t){return new RegExp("^(?:"+t.map(Zae).join("|")+")","i")}function Np(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Yae(t,e,n){var r=Ts.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Xae(t,e,n){var r=Ts.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Kae(t,e,n){var r=Ts.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Jae(t,e,n){var r=Ts.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function ele(t,e,n){var r=Ts.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function CI(t,e,n){var r=Ts.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function MI(t,e,n){var r=Ts.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function tle(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function nle(t,e,n){var r=Ts.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function rle(t,e,n){var r=Ts.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function PI(t,e,n){var r=Ts.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function ile(t,e,n){var r=Ts.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function kI(t,e,n){var r=Ts.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function sle(t,e,n){var r=Ts.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function ole(t,e,n){var r=Ts.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function ale(t,e,n){var r=Ts.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function lle(t,e,n){var r=Ts.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Ale(t,e,n){var r=Qae.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function ule(t,e,n){var r=Ts.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function cle(t,e,n){var r=Ts.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function II(t,e){return kr(t.getDate(),e,2)}function hle(t,e){return kr(t.getHours(),e,2)}function fle(t,e){return kr(t.getHours()%12||12,e,2)}function dle(t,e){return kr(1+Wm.count(dc(t),t),e,3)}function zO(t,e){return kr(t.getMilliseconds(),e,3)}function ple(t,e){return zO(t,e)+"000"}function gle(t,e){return kr(t.getMonth()+1,e,2)}function mle(t,e){return kr(t.getMinutes(),e,2)}function yle(t,e){return kr(t.getSeconds(),e,2)}function _le(t){var e=t.getDay();return e===0?7:e}function vle(t,e){return kr(Ev.count(dc(t)-1,t),e,2)}function OO(t){var e=t.getDay();return e>=4||e===0?kd(t):kd.ceil(t)}function xle(t,e){return t=OO(t),kr(kd.count(dc(t),t)+(dc(t).getDay()===4),e,2)}function wle(t){return t.getDay()}function ble(t,e){return kr(p2.count(dc(t)-1,t),e,2)}function Ele(t,e){return kr(t.getFullYear()%100,e,2)}function Tle(t,e){return t=OO(t),kr(t.getFullYear()%100,e,2)}function Sle(t,e){return kr(t.getFullYear()%1e4,e,4)}function Cle(t,e){var n=t.getDay();return t=n>=4||n===0?kd(t):kd.ceil(t),kr(t.getFullYear()%1e4,e,4)}function Mle(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+kr(e/60|0,"0",2)+kr(e%60,"0",2)}function LI(t,e){return kr(t.getUTCDate(),e,2)}function Ple(t,e){return kr(t.getUTCHours(),e,2)}function kle(t,e){return kr(t.getUTCHours()%12||12,e,2)}function Ile(t,e){return kr(1+HS.count(Mf(t),t),e,3)}function FO(t,e){return kr(t.getUTCMilliseconds(),e,3)}function Lle(t,e){return FO(t,e)+"000"}function Dle(t,e){return kr(t.getUTCMonth()+1,e,2)}function Rle(t,e){return kr(t.getUTCMinutes(),e,2)}function Ble(t,e){return kr(t.getUTCSeconds(),e,2)}function zle(t){var e=t.getUTCDay();return e===0?7:e}function Ole(t,e){return kr(BO.count(Mf(t)-1,t),e,2)}function NO(t){var e=t.getUTCDay();return e>=4||e===0?Id(t):Id.ceil(t)}function Fle(t,e){return t=NO(t),kr(Id.count(Mf(t),t)+(Mf(t).getUTCDay()===4),e,2)}function Nle(t){return t.getUTCDay()}function Ule(t,e){return kr(g2.count(Mf(t)-1,t),e,2)}function Vle(t,e){return kr(t.getUTCFullYear()%100,e,2)}function Gle(t,e){return t=NO(t),kr(t.getUTCFullYear()%100,e,2)}function $le(t,e){return kr(t.getUTCFullYear()%1e4,e,4)}function jle(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Id(t):Id.ceil(t),kr(t.getUTCFullYear()%1e4,e,4)}function Hle(){return"+0000"}function DI(){return"%"}function RI(t){return+t}function BI(t){return Math.floor(+t/1e3)}var _0,UO;Wle({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Wle(t){return _0=Wae(t),UO=_0.format,_0.parse,_0.utcFormat,_0.utcParse,_0}function Qle(t){return new Date(t)}function qle(t){return t instanceof Date?+t:+new Date(+t)}function VO(t,e,n,r,i,s,l,o,p,_){var C=DO(),M=C.invert,k=C.domain,F=_(".%L"),j=_(":%S"),H=_("%I:%M"),ie=_("%I %p"),Y=_("%a %d"),J=_("%b %d"),se=_("%B"),he=_("%Y");function pe(be){return(p(be)<be?F:o(be)<be?j:l(be)<be?H:s(be)<be?ie:r(be)<be?i(be)<be?Y:J:n(be)<be?se:he)(be)}return C.invert=function(be){return new Date(M(be))},C.domain=function(be){return arguments.length?k(Array.from(be,qle)):k().map(Qle)},C.ticks=function(be){var Ge=k();return t(Ge[0],Ge[Ge.length-1],be??10)},C.tickFormat=function(be,Ge){return Ge==null?pe:_(Ge)},C.nice=function(be){var Ge=k();return(!be||typeof be.range!="function")&&(be=e(Ge[0],Ge[Ge.length-1],be??10)),be?k(kae(Ge,be)):C},C.copy=function(){return LO(C,VO(t,e,n,r,i,s,l,o,p,_))},C}function Zle(){return Hm.apply(VO(jae,Hae,dc,WS,Ev,Wm,jS,$S,N0,UO).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Qd(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const qd=t=>pO(t[t.length-1]);var Yle=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Qd);const Xle=qd(Yle);var Kle=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Qd);const Jle=qd(Kle);var eAe=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Qd);const tAe=qd(eAe);var nAe=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Qd);const rAe=qd(nAe);var iAe=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Qd);const zI=qd(iAe);var sAe=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Qd);const OI=qd(sAe);function sa(t){return function(){return t}}const FI=Math.abs,oo=Math.atan2,Hh=Math.cos,oAe=Math.max,tb=Math.min,GA=Math.sin,U0=Math.sqrt,Ao=1e-12,om=Math.PI,m2=om/2,aAe=2*om;function lAe(t){return t>1?0:t<-1?om:Math.acos(t)}function NI(t){return t>=1?m2:t<=-1?-m2:Math.asin(t)}function GO(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new iae(e)}function AAe(t){return t.innerRadius}function uAe(t){return t.outerRadius}function cAe(t){return t.startAngle}function hAe(t){return t.endAngle}function fAe(t){return t&&t.padAngle}function dAe(t,e,n,r,i,s,l,o){var p=n-t,_=r-e,C=l-i,M=o-s,k=M*p-C*_;if(!(k*k<Ao))return k=(C*(e-s)-M*(t-i))/k,[t+k*p,e+k*_]}function oy(t,e,n,r,i,s,l){var o=t-n,p=e-r,_=(l?s:-s)/U0(o*o+p*p),C=_*p,M=-_*o,k=t+C,F=e+M,j=n+C,H=r+M,ie=(k+j)/2,Y=(F+H)/2,J=j-k,se=H-F,he=J*J+se*se,pe=i-s,be=k*H-j*F,Ge=(se<0?-1:1)*U0(oAe(0,pe*pe*he-be*be)),We=(be*se-J*Ge)/he,Xe=(-be*J-se*Ge)/he,rt=(be*se+J*Ge)/he,Oe=(-be*J+se*Ge)/he,nt=We-ie,Ze=Xe-Y,pt=rt-ie,Yt=Oe-Y;return nt*nt+Ze*Ze>pt*pt+Yt*Yt&&(We=rt,Xe=Oe),{cx:We,cy:Xe,x01:-C,y01:-M,x11:We*(i/pe-1),y11:Xe*(i/pe-1)}}function y2(){var t=AAe,e=uAe,n=sa(0),r=null,i=cAe,s=hAe,l=fAe,o=null,p=GO(_);function _(){var C,M,k=+t.apply(this,arguments),F=+e.apply(this,arguments),j=i.apply(this,arguments)-m2,H=s.apply(this,arguments)-m2,ie=FI(H-j),Y=H>j;if(o||(o=C=p()),F<k&&(M=F,F=k,k=M),!(F>Ao))o.moveTo(0,0);else if(ie>aAe-Ao)o.moveTo(F*Hh(j),F*GA(j)),o.arc(0,0,F,j,H,!Y),k>Ao&&(o.moveTo(k*Hh(H),k*GA(H)),o.arc(0,0,k,H,j,Y));else{var J=j,se=H,he=j,pe=H,be=ie,Ge=ie,We=l.apply(this,arguments)/2,Xe=We>Ao&&(r?+r.apply(this,arguments):U0(k*k+F*F)),rt=tb(FI(F-k)/2,+n.apply(this,arguments)),Oe=rt,nt=rt,Ze,pt;if(Xe>Ao){var Yt=NI(Xe/k*GA(We)),Et=NI(Xe/F*GA(We));(be-=Yt*2)>Ao?(Yt*=Y?1:-1,he+=Yt,pe-=Yt):(be=0,he=pe=(j+H)/2),(Ge-=Et*2)>Ao?(Et*=Y?1:-1,J+=Et,se-=Et):(Ge=0,J=se=(j+H)/2)}var un=F*Hh(J),_t=F*GA(J),Tt=k*Hh(pe),Jt=k*GA(pe);if(rt>Ao){var Ln=F*Hh(se),Tn=F*GA(se),Ir=k*Hh(he),tr=k*GA(he),ar;if(ie<om)if(ar=dAe(un,_t,Ir,tr,Ln,Tn,Tt,Jt)){var pr=un-ar[0],Gn=_t-ar[1],Mr=Ln-ar[0],wt=Tn-ar[1],rn=1/GA(lAe((pr*Mr+Gn*wt)/(U0(pr*pr+Gn*Gn)*U0(Mr*Mr+wt*wt)))/2),Pn=U0(ar[0]*ar[0]+ar[1]*ar[1]);Oe=tb(rt,(k-Pn)/(rn-1)),nt=tb(rt,(F-Pn)/(rn+1))}else Oe=nt=0}Ge>Ao?nt>Ao?(Ze=oy(Ir,tr,un,_t,F,nt,Y),pt=oy(Ln,Tn,Tt,Jt,F,nt,Y),o.moveTo(Ze.cx+Ze.x01,Ze.cy+Ze.y01),nt<rt?o.arc(Ze.cx,Ze.cy,nt,oo(Ze.y01,Ze.x01),oo(pt.y01,pt.x01),!Y):(o.arc(Ze.cx,Ze.cy,nt,oo(Ze.y01,Ze.x01),oo(Ze.y11,Ze.x11),!Y),o.arc(0,0,F,oo(Ze.cy+Ze.y11,Ze.cx+Ze.x11),oo(pt.cy+pt.y11,pt.cx+pt.x11),!Y),o.arc(pt.cx,pt.cy,nt,oo(pt.y11,pt.x11),oo(pt.y01,pt.x01),!Y))):(o.moveTo(un,_t),o.arc(0,0,F,J,se,!Y)):o.moveTo(un,_t),!(k>Ao)||!(be>Ao)?o.lineTo(Tt,Jt):Oe>Ao?(Ze=oy(Tt,Jt,Ln,Tn,k,-Oe,Y),pt=oy(un,_t,Ir,tr,k,-Oe,Y),o.lineTo(Ze.cx+Ze.x01,Ze.cy+Ze.y01),Oe<rt?o.arc(Ze.cx,Ze.cy,Oe,oo(Ze.y01,Ze.x01),oo(pt.y01,pt.x01),!Y):(o.arc(Ze.cx,Ze.cy,Oe,oo(Ze.y01,Ze.x01),oo(Ze.y11,Ze.x11),!Y),o.arc(0,0,k,oo(Ze.cy+Ze.y11,Ze.cx+Ze.x11),oo(pt.cy+pt.y11,pt.cx+pt.x11),Y),o.arc(pt.cx,pt.cy,Oe,oo(pt.y11,pt.x11),oo(pt.y01,pt.x01),!Y))):o.arc(0,0,k,pe,he,Y)}if(o.closePath(),C)return o=null,C+""||null}return _.centroid=function(){var C=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,M=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-om/2;return[Hh(M)*C,GA(M)*C]},_.innerRadius=function(C){return arguments.length?(t=typeof C=="function"?C:sa(+C),_):t},_.outerRadius=function(C){return arguments.length?(e=typeof C=="function"?C:sa(+C),_):e},_.cornerRadius=function(C){return arguments.length?(n=typeof C=="function"?C:sa(+C),_):n},_.padRadius=function(C){return arguments.length?(r=C==null?null:typeof C=="function"?C:sa(+C),_):r},_.startAngle=function(C){return arguments.length?(i=typeof C=="function"?C:sa(+C),_):i},_.endAngle=function(C){return arguments.length?(s=typeof C=="function"?C:sa(+C),_):s},_.padAngle=function(C){return arguments.length?(l=typeof C=="function"?C:sa(+C),_):l},_.context=function(C){return arguments.length?(o=C??null,_):o},_}function pAe(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function $O(t){this._context=t}$O.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function jO(t){return new $O(t)}function gAe(t){return t[0]}function mAe(t){return t[1]}function _2(t,e){var n=sa(!0),r=null,i=jO,s=null,l=GO(o);t=typeof t=="function"?t:t===void 0?gAe:sa(t),e=typeof e=="function"?e:e===void 0?mAe:sa(e);function o(p){var _,C=(p=pAe(p)).length,M,k=!1,F;for(r==null&&(s=i(F=l())),_=0;_<=C;++_)!(_<C&&n(M=p[_],_,p))===k&&((k=!k)?s.lineStart():s.lineEnd()),k&&s.point(+t(M,_,p),+e(M,_,p));if(F)return s=null,F+""||null}return o.x=function(p){return arguments.length?(t=typeof p=="function"?p:sa(+p),o):t},o.y=function(p){return arguments.length?(e=typeof p=="function"?p:sa(+p),o):e},o.defined=function(p){return arguments.length?(n=typeof p=="function"?p:sa(!!p),o):n},o.curve=function(p){return arguments.length?(i=p,r!=null&&(s=i(r)),o):i},o.context=function(p){return arguments.length?(p==null?r=s=null:s=i(r=p),o):r},o}var yAe=WO(jO);function HO(t){this._curve=t}HO.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};function WO(t){function e(n){return new HO(t(n))}return e._curve=t,e}function _Ae(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(n){return arguments.length?e(WO(n)):e()._curve},t}function UI(){return _Ae(_2().curve(yAe))}function VI(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function QS(t,e){this._context=t,this._k=(1-e)/6}QS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:VI(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:VI(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(r){return new QS(r,e)}return n.tension=function(r){return t(+r)},n})(0);function vAe(t,e,n){var r=t._x1,i=t._y1,s=t._x2,l=t._y2;if(t._l01_a>Ao){var o=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,p=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*o-t._x0*t._l12_2a+t._x2*t._l01_2a)/p,i=(i*o-t._y0*t._l12_2a+t._y2*t._l01_2a)/p}if(t._l23_a>Ao){var _=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,C=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*_+t._x1*t._l23_2a-e*t._l12_2a)/C,l=(l*_+t._y1*t._l23_2a-n*t._l12_2a)/C}t._context.bezierCurveTo(r,i,s,l,t._x2,t._y2)}function QO(t,e){this._context=t,this._alpha=e}QO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:vAe(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const GI=function t(e){function n(r){return e?new QO(r,e):new QS(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function og(t,e,n){this.k=t,this.x=e,this.y=n}og.prototype={constructor:og,scale:function(t){return t===1?this:new og(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new og(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};og.prototype;const xAe=new Uint16Array([0,2,1,0,3,2]),wAe=new Float32Array([0,1,0,0,1,0,1,1]);function bAe(t,e){if(!e)return EAe(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,s=Math.ceil(r/e)+1,l=(i-1)*(s-1)*6,o=new Uint32Array(l),p=new Float32Array(i*s*2),_=new Float64Array(i*s*3);let C=0,M=0;for(let k=0;k<i;k++){const F=k/(i-1);for(let j=0;j<s;j++){const H=j/(s-1),ie=TAe(t,F,H);_[C*3+0]=ie[0],_[C*3+1]=ie[1],_[C*3+2]=ie[2]||0,p[C*2+0]=F,p[C*2+1]=1-H,k>0&&j>0&&(o[M++]=C-s,o[M++]=C-s-1,o[M++]=C-1,o[M++]=C-s,o[M++]=C-1,o[M++]=C),C++}}return{vertexCount:l,positions:_,indices:o,texCoords:p}}function EAe(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:xAe,texCoords:wAe}}function TAe(t,e,n){return wl(wl(t[0],t[1],n),wl(t[3],t[2],n),e)}const SAe=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,CAe=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,MAe=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(CAe,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive && !picking_uAttribute) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),PAe={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:fr.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class bh extends vA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:SAe,fs:MAe,modules:[Vf,Gf]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:r=>r.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:r=>r.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:r=>r.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:r}){const i=this.getAttributeManager();if(r.extensionsChanged){var s;const{gl:l}=this.context;(s=this.state.model)===null||s===void 0||s.delete(),this.state.model=this._getModel(l),i.invalidateAll()}if(e.bounds!==n.bounds){const l=this.state.mesh,o=this._createMesh();this.state.model.setVertexCount(o.vertexCount);for(const p in o)l&&l[p]!==o[p]&&i.invalidate(p);this.setState({mesh:o,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,r=e.info;if(!r.color||!n)return r.bitmap=null,r;const{width:i,height:s}=n;r.index=0;const l=kAe(r.color),o=[Math.floor(l[0]*i),Math.floor(l[1]*s)];return r.bitmap={size:{width:i,height:s},uv:l,pixel:o},r}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return $I(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),bAe(n,this.context.viewport.resolution)}_getModel(e){return e?new Ac(e,{...this.getShaders(),id:this.props.id,geometry:new ec({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:r}=e,{model:i,coordinateConversion:s,bounds:l,disablePicking:o}=this.state,{image:p,desaturate:_,transparentColor:C,tintColor:M}=this.props;r.pickingActive&&o||p&&i&&i.setUniforms(n).setUniforms({bitmapTexture:p,desaturate:_,transparentColor:C.map(k=>k/255),tintColor:M.slice(0,3).map(k=>k/255),coordinateConversion:s,bounds:l}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:r}=fr;let{_imageCoordinateSystem:i}=this.props;if(i!==r){const{bounds:s}=this.props;if(!$I(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const l=this.context.viewport.resolution?e:n;if(i=i===e?e:n,i===e&&l===n)return{coordinateConversion:-1,bounds:s};if(i===n&&l===e){const o=gA([s[0],s[1]]),p=gA([s[2],s[3]]);return{coordinateConversion:1,bounds:[o[0],o[1],p[0],p[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}oe(bh,"layerName","BitmapLayer");oe(bh,"defaultProps",PAe);function kAe(t){const[e,n,r]=t,i=(r&240)/256,s=(r&15)/16;return[(e+s)/256,(n+i)/256]}function $I(t){return Number.isFinite(t[0])}const IAe=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,LAe=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,DAe=1024,RAe=4,jI=()=>{},HI={10241:9987,10240:9729,10242:33071,10243:33071};function BAe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function zAe(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),l=Math.floor(e.height*i);return i===1?{data:e,width:s,height:l}:(t.canvas.height=l,t.canvas.width=s,t.clearRect(0,0,s,l),t.drawImage(e,0,0,e.width,e.height,0,0,s,l),{data:t.canvas,width:s,height:l})}function am(t){return t&&(t.id||t.url)}function OAe(t,e,n,r){const i=t.width,s=t.height,l=new da(t.gl,{width:e,height:n,parameters:r});return LQ(t,l,{targetY:0,width:i,height:s}),t.delete(),l}function WI(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],l=am(i);t[l]={...i,x:s,y:n}}}function FAe({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:l}){let o=[];for(let p=0;p<t.length;p++){const _=t[p],C=am(_);if(!n[C]){const{height:M,width:k}=_;r+k+e>l&&(WI(n,o,i),r=0,i=s+i+e,s=0,o=[]),o.push({icon:_,xOffset:r}),r=r+k+e,s=Math.max(s,M)}}return o.length>0&&WI(n,o,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:l,canvasHeight:BAe(s+i+e)}}function NAe(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=Wd(t);for(const l of i){s.index++;const o=e(l,s),p=am(o);if(!o)throw new Error("Icon is missing.");if(!o.url)throw new Error("Icon url is missing.");!r[p]&&(!n[p]||o.url!==n[p].url)&&(r[p]={...o,source:l,sourceIndex:s.index})}return r}class UAe{constructor(e,{onUpdate:n=jI,onError:r=jI}){oe(this,"gl",void 0),oe(this,"onUpdate",void 0),oe(this,"onError",void 0),oe(this,"_loadOptions",null),oe(this,"_texture",null),oe(this,"_externalTexture",null),oe(this,"_mapping",{}),oe(this,"_textureParameters",null),oe(this,"_pendingCount",0),oe(this,"_autoPacking",!1),oe(this,"_xOffset",0),oe(this,"_yOffset",0),oe(this,"_rowHeight",0),oe(this,"_buffer",RAe),oe(this,"_canvasWidth",DAe),oe(this,"_canvasHeight",0),oe(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?am(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var l;(l=this._texture)===null||l===void 0||l.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(NAe(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:l,rowHeight:o,canvasHeight:p}=FAe({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=o,this._mapping=i,this._xOffset=s,this._yOffset=l,this._canvasHeight=p,this._texture||(this._texture=new da(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||HI})),this._texture.height!==this._canvasHeight&&(this._texture=OAe(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||HI)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,U_(r.url,this._loadOptions).then(i=>{const s=am(r),l=this._mapping[s],{x:o,y:p,width:_,height:C}=l,{data:M,width:k,height:F}=zAe(n,i,_,C);this._texture.setSubImageData({data:M,x:o+(_-k)/2,y:p+(C-F)/2,width:k,height:F}),l.width=k,l.height=F,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const qO=[0,0,0,255],VAe={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:qO},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class Tv extends vA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:IAe,fs:LAe,modules:[Vf,Gf]})}initializeState(){this.state={iconManager:new UAe(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:qO},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:l,iconMapping:o,data:p,getIcon:_,textureParameters:C}=n,{iconManager:M}=this.state,k=l||this.internalState.isAsyncPropLoading("iconAtlas");if(M.setProps({loadOptions:n.loadOptions,autoPacking:!k,iconAtlas:l,iconMapping:k?o:null,textureParameters:C}),k?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&M.packIcons(p,_),i.extensionsChanged){var F;const{gl:j}=this.context;(F=this.state.model)===null||F===void 0||F.delete(),this.state.model=this._getModel(j),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:l,alphaCutoff:o}=this.props,{iconManager:p}=this.state,_=p.getTexture();_&&this.state.model.setUniforms(e).setUniforms({iconsTexture:_,iconsTextureDim:[_.width,_.height],sizeUnits:mf[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:l,alphaCutoff:o}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new Ac(e,{...this.getShaders(),id:this.props.id,geometry:new ec({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):or.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}oe(Tv,"defaultProps",VAe);oe(Tv,"layerName","IconLayer");const GAe=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,$Ae=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,QI=[0,0,0,255],jAe={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:QI},getLineColor:{type:"accessor",value:QI},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class qS extends vA{getShaders(){return super.getShaders({vs:GAe,fs:$Ae,modules:[Vf,Gf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:l,filled:o,billboard:p,antialiasing:_,lineWidthUnits:C,lineWidthScale:M,lineWidthMinPixels:k,lineWidthMaxPixels:F}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:l?1:0,filled:o,billboard:p,antialiasing:_,radiusUnits:mf[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:mf[C],lineWidthScale:M,lineWidthMinPixels:k,lineWidthMaxPixels:F}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new Ac(e,{...this.getShaders(),id:this.props.id,geometry:new ec({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}oe(qS,"defaultProps",jAe);oe(qS,"layerName","ScatterplotLayer");const ZO={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function YO(t,e,n={}){return HAe(t,n)!==e?(QAe(t,n),!0):!1}function HAe(t,e={}){return Math.sign(WAe(t,e))}function WAe(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let l=n,o=r-i;l<r;l+=i)s+=(t[l]-t[o])*(t[l+1]+t[o+1]),o=l;return s/2}function QAe(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,l=Math.floor(s/2);for(let o=0;o<l;++o){const p=n+o*i,_=n+(s-1-o)*i;for(let C=0;C<i;++C){const M=t[p+C];t[p+C]=t[_+C],t[_+C]=M}}}function aA(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function pE(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function lm(t,e,n,r,i=[]){const s=r+e*n;for(let l=0;l<n;l++)i[l]=t[s+l];return i}function gE(t,e,n,r,i=[]){let s,l;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),l=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),l=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),l=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),l=0;else return null;for(let o=0;o<t.length;o++)i[o]=(l&1)===o?r[l]:s*(e[o]-t[o])+t[o];return i}function e_(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function XO(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:l=0,endIndex:o=t.length}=e||{},p=(o-l)/n;let _=[];const C=[_],M=lm(t,0,n,l);let k,F;const j=JO(M,i,s,[]),H=[];aA(_,M);for(let ie=1;ie<p;ie++){for(k=lm(t,ie,n,l,k),F=e_(k,j);F;){gE(M,k,F,j,H);const Y=e_(H,j);Y&&(gE(M,H,Y,j,H),F=Y),aA(_,H),pE(M,H),ZAe(j,i,F),r&&_.length>n&&(_=[],C.push(_),aA(_,M)),F=e_(k,j)}aA(_,k),pE(M,k)}return r?C:C[0]}const qI=0,qAe=1;function ay(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function KO(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:l=!1}=n||{},o=[],p=[{pos:t,types:l?new Array(t.length/r).fill(qAe):null,holes:e||[]}],_=[[],[]];let C=[];for(;p.length;){const{pos:M,types:k,holes:F}=p.shift();YAe(M,r,F[0]||M.length,_),C=JO(_[0],i,s,C);const j=e_(_[1],C);if(j){let H=ZI(M,k,r,0,F[0]||M.length,C,j);const ie={pos:H[0].pos,types:H[0].types,holes:[]},Y={pos:H[1].pos,types:H[1].types,holes:[]};p.push(ie,Y);for(let J=0;J<F.length;J++)H=ZI(M,k,r,F[J],F[J+1]||M.length,C,j),H[0]&&(ie.holes.push(ie.pos.length),ie.pos=ay(ie.pos,H[0].pos),l&&(ie.types=ay(ie.types,H[0].types))),H[1]&&(Y.holes.push(Y.pos.length),Y.pos=ay(Y.pos,H[1].pos),l&&(Y.types=ay(Y.types,H[1].types)))}else{const H={positions:M};l&&(H.edgeTypes=k),F.length&&(H.holeIndices=F),o.push(H)}}return o}function ZI(t,e,n,r,i,s,l){const o=(i-r)/n,p=[],_=[],C=[],M=[],k=[];let F,j,H;const ie=lm(t,o-1,n,r);let Y=Math.sign(l&8?ie[1]-s[3]:ie[0]-s[2]),J=e&&e[o-1],se=0,he=0;for(let pe=0;pe<o;pe++)F=lm(t,pe,n,r,F),j=Math.sign(l&8?F[1]-s[3]:F[0]-s[2]),H=e&&e[r/n+pe],j&&Y&&Y!==j&&(gE(ie,F,l,s,k),aA(p,k)&&C.push(J),aA(_,k)&&M.push(J)),j<=0?(aA(p,F)&&C.push(H),se-=j):C.length&&(C[C.length-1]=qI),j>=0?(aA(_,F)&&M.push(H),he+=j):M.length&&(M[M.length-1]=qI),pE(ie,F),Y=j,J=H;return[se?{pos:p,types:e&&C}:null,he?{pos:_,types:e&&M}:null]}function JO(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function ZAe(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function YAe(t,e,n,r){let i=1/0,s=-1/0,l=1/0,o=-1/0;for(let p=0;p<n;p+=e){const _=t[p],C=t[p+1];i=_<i?_:i,s=_>s?_:s,l=C<l?C:l,o=C>o?C:o}return r[0][0]=i,r[0][1]=l,r[1][0]=s,r[1][1]=o,r}const XAe=85.051129;function KAe(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},l=t.slice(r,i);eF(l,n,0,i-r);const o=XO(l,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const p of o)tF(p,n);return o}function JAe(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const l=[],o=[];let p=0,_=0;for(let M=0;M<=e.length;M++){const k=e[M]||t.length,F=_,j=eue(t,r,p,k);for(let H=j;H<k;H++)l[_++]=t[H];for(let H=p;H<j;H++)l[_++]=t[H];eF(l,r,F,_),tue(l,r,F,_,n?.maxLatitude),p=k,o[M]=_}o.pop();const C=KO(l,o,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const M of C)tF(M.positions,r);return C}function eue(t,e,n,r){let i=-1,s=-1;for(let l=n+1;l<r;l+=e){const o=Math.abs(t[l]);o>i&&(i=o,s=l-1)}return s}function tue(t,e,n,r,i=XAe){const s=t[n],l=t[r-e];if(Math.abs(s-l)>180){const o=lm(t,0,e,n);o[0]+=Math.round((l-s)/360)*360,aA(t,o),o[1]=Math.sign(o[1])*i,aA(t,o),o[0]=s,aA(t,o)}}function eF(t,e,n,r){let i=t[0],s;for(let l=n;l<r;l+=e){s=t[l];const o=s-i;(o>180||o<-180)&&(s-=Math.round(o/360)*360),t[l]=i=s}}function tF(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}function nue(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let l=0;l<t.length;l++)for(let o=0;o<e;o++)i[l*e+o]=t[l][o]||0}else i=t;return n?XO(i,{size:e,gridResolution:n}):r?KAe(i,{size:e}):i}const rue=1,iue=2,nb=4;class sue extends Dz{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?nue(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(YI(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&YI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:l}=n;r.fill(0,s,s+l),i?(r[s]=nb,r[s+l-2]=nb):(r[s]+=rue,r[s+l-2]+=iue),r[s+l-1]=nb}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,l=new Array(3);for(let o=i,p=0;p<s;o++,p++)this.getPointOnPath(e,p,l),r[o*3]=l[0],r[o*3+1]=l[1],r[o*3+2]=l[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function YI(t){return Array.isArray(t[0])}const oue=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,aue=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,nF=[0,0,0,255],lue={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:nF},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},rb={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class Sv extends vA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:oue,fs:aue,modules:[Vf,Gf]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:rb,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:rb,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:rb,defaultValue:nF},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new sue({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:o}=this.state,p=n.data.attributes||{};o.updateGeometry({data:n.data,geometryBuffer:p.getPath,buffers:p,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var l;const{gl:o}=this.context;(l=this.state.model)===null||l===void 0||l.delete(),this.state.model=this._getModel(o),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:l,widthScale:o,widthMinPixels:p,widthMaxPixels:_}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:mf[l],widthScale:o,miterLimit:s,widthMinPixels:p,widthMaxPixels:_}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Ac(e,{...this.getShaders(),id:this.props.id,geometry:new ec({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}oe(Sv,"defaultProps",lue);oe(Sv,"layerName","PathLayer");var ZS={exports:{}};ZS.exports=Cv;ZS.exports.default=Cv;function Cv(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=rF(t,0,i,n,!0),l=[];if(!s||s.next===s.prev)return l;var o,p,_,C,M,k,F;if(r&&(s=fue(t,e,s,n)),t.length>80*n){o=_=t[0],p=C=t[1];for(var j=n;j<i;j+=n)M=t[j],k=t[j+1],M<o&&(o=M),k<p&&(p=k),M>_&&(_=M),k>C&&(C=k);F=Math.max(_-o,C-p),F=F!==0?32767/F:0}return Am(s,l,n,o,p,F,0),l}function rF(t,e,n,r,i){var s,l;if(i===_E(t,e,n,r)>0)for(s=e;s<n;s+=r)l=XI(s,t[s],t[s+1],l);else for(s=n-r;s>=e;s-=r)l=XI(s,t[s],t[s+1],l);return l&&Mv(l,l.next)&&(cm(l),l=l.next),l}function Pf(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(Mv(n,n.next)||xi(n.prev,n,n.next)===0)){if(cm(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function Am(t,e,n,r,i,s,l){if(t){!l&&s&&yue(t,r,i,s);for(var o=t,p,_;t.prev!==t.next;){if(p=t.prev,_=t.next,s?uue(t,r,i,s):Aue(t)){e.push(p.i/n|0),e.push(t.i/n|0),e.push(_.i/n|0),cm(t),t=_.next,o=_.next;continue}if(t=_,t===o){l?l===1?(t=cue(Pf(t),e,n),Am(t,e,n,r,i,s,2)):l===2&&hue(t,e,n,r,i,s):Am(Pf(t),e,n,r,i,s,1);break}}}}function Aue(t){var e=t.prev,n=t,r=t.next;if(xi(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,l=r.x,o=e.y,p=n.y,_=r.y,C=i<s?i<l?i:l:s<l?s:l,M=o<p?o<_?o:_:p<_?p:_,k=i>s?i>l?i:l:s>l?s:l,F=o>p?o>_?o:_:p>_?p:_,j=r.next;j!==e;){if(j.x>=C&&j.x<=k&&j.y>=M&&j.y<=F&&V0(i,o,s,p,l,_,j.x,j.y)&&xi(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function uue(t,e,n,r){var i=t.prev,s=t,l=t.next;if(xi(i,s,l)>=0)return!1;for(var o=i.x,p=s.x,_=l.x,C=i.y,M=s.y,k=l.y,F=o<p?o<_?o:_:p<_?p:_,j=C<M?C<k?C:k:M<k?M:k,H=o>p?o>_?o:_:p>_?p:_,ie=C>M?C>k?C:k:M>k?M:k,Y=mE(F,j,e,n,r),J=mE(H,ie,e,n,r),se=t.prevZ,he=t.nextZ;se&&se.z>=Y&&he&&he.z<=J;){if(se.x>=F&&se.x<=H&&se.y>=j&&se.y<=ie&&se!==i&&se!==l&&V0(o,C,p,M,_,k,se.x,se.y)&&xi(se.prev,se,se.next)>=0||(se=se.prevZ,he.x>=F&&he.x<=H&&he.y>=j&&he.y<=ie&&he!==i&&he!==l&&V0(o,C,p,M,_,k,he.x,he.y)&&xi(he.prev,he,he.next)>=0))return!1;he=he.nextZ}for(;se&&se.z>=Y;){if(se.x>=F&&se.x<=H&&se.y>=j&&se.y<=ie&&se!==i&&se!==l&&V0(o,C,p,M,_,k,se.x,se.y)&&xi(se.prev,se,se.next)>=0)return!1;se=se.prevZ}for(;he&&he.z<=J;){if(he.x>=F&&he.x<=H&&he.y>=j&&he.y<=ie&&he!==i&&he!==l&&V0(o,C,p,M,_,k,he.x,he.y)&&xi(he.prev,he,he.next)>=0)return!1;he=he.nextZ}return!0}function cue(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!Mv(i,s)&&iF(i,r,r.next,s)&&um(i,s)&&um(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),cm(r),cm(r.next),r=t=s),r=r.next}while(r!==t);return Pf(r)}function hue(t,e,n,r,i,s){var l=t;do{for(var o=l.next.next;o!==l.prev;){if(l.i!==o.i&&xue(l,o)){var p=sF(l,o);l=Pf(l,l.next),p=Pf(p,p.next),Am(l,e,n,r,i,s,0),Am(p,e,n,r,i,s,0);return}o=o.next}l=l.next}while(l!==t)}function fue(t,e,n,r){var i=[],s,l,o,p,_;for(s=0,l=e.length;s<l;s++)o=e[s]*r,p=s<l-1?e[s+1]*r:t.length,_=rF(t,o,p,r,!1),_===_.next&&(_.steiner=!0),i.push(vue(_));for(i.sort(due),s=0;s<i.length;s++)n=pue(i[s],n);return n}function due(t,e){return t.x-e.x}function pue(t,e){var n=gue(t,e);if(!n)return e;var r=sF(n,t);return Pf(r,r.next),Pf(n,n.next)}function gue(t,e){var n=e,r=t.x,i=t.y,s=-1/0,l;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var o=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=r&&o>s&&(s=o,l=n.x<n.next.x?n:n.next,o===r))return l}n=n.next}while(n!==e);if(!l)return null;var p=l,_=l.x,C=l.y,M=1/0,k;n=l;do r>=n.x&&n.x>=_&&r!==n.x&&V0(i<C?r:s,i,_,C,i<C?s:r,i,n.x,n.y)&&(k=Math.abs(i-n.y)/(r-n.x),um(n,t)&&(k<M||k===M&&(n.x>l.x||n.x===l.x&&mue(l,n)))&&(l=n,M=k)),n=n.next;while(n!==p);return l}function mue(t,e){return xi(t.prev,t,e.prev)<0&&xi(e.next,t,t.next)<0}function yue(t,e,n,r){var i=t;do i.z===0&&(i.z=mE(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,_ue(i)}function _ue(t){var e,n,r,i,s,l,o,p,_=1;do{for(n=t,t=null,s=null,l=0;n;){for(l++,r=n,o=0,e=0;e<_&&(o++,r=r.nextZ,!!r);e++);for(p=_;o>0||p>0&&r;)o!==0&&(p===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,o--):(i=r,r=r.nextZ,p--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,_*=2}while(l>1);return t}function mE(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function vue(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function V0(t,e,n,r,i,s,l,o){return(i-l)*(e-o)>=(t-l)*(s-o)&&(t-l)*(r-o)>=(n-l)*(e-o)&&(n-l)*(s-o)>=(i-l)*(r-o)}function xue(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!wue(t,e)&&(um(t,e)&&um(e,t)&&bue(t,e)&&(xi(t.prev,t,e.prev)||xi(t,e.prev,e))||Mv(t,e)&&xi(t.prev,t,t.next)>0&&xi(e.prev,e,e.next)>0)}function xi(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Mv(t,e){return t.x===e.x&&t.y===e.y}function iF(t,e,n,r){var i=Ay(xi(t,e,n)),s=Ay(xi(t,e,r)),l=Ay(xi(n,r,t)),o=Ay(xi(n,r,e));return!!(i!==s&&l!==o||i===0&&ly(t,n,e)||s===0&&ly(t,r,e)||l===0&&ly(n,t,r)||o===0&&ly(n,e,r))}function ly(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ay(t){return t>0?1:t<0?-1:0}function wue(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&iF(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function um(t,e){return xi(t.prev,t,t.next)<0?xi(t,e,t.next)>=0&&xi(t,t.prev,e)>=0:xi(t,e,t.prev)<0||xi(t,t.next,e)<0}function bue(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function sF(t,e){var n=new yE(t.i,t.x,t.y),r=new yE(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function XI(t,e,n,r){var i=new yE(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function cm(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function yE(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Cv.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,l=Math.abs(_E(t,0,s,n));if(i)for(var o=0,p=e.length;o<p;o++){var _=e[o]*n,C=o<p-1?e[o+1]*n:t.length;l-=Math.abs(_E(t,_,C,n))}var M=0;for(o=0;o<r.length;o+=3){var k=r[o]*n,F=r[o+1]*n,j=r[o+2]*n;M+=Math.abs((t[k]-t[j])*(t[F+1]-t[k+1])-(t[k]-t[F])*(t[j+1]-t[k+1]))}return l===0&&M===0?0:Math.abs((M-l)/l)};function _E(t,e,n,r){for(var i=0,s=e,l=n-r;s<n;s+=r)i+=(t[l]-t[s])*(t[s+1]+t[l+1]),l=s;return i}Cv.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var l=0;l<e;l++)n.vertices.push(t[i][s][l]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var Eue=ZS.exports;const Tue=Z2(Eue),uy=ZO.CLOCKWISE,KI=ZO.COUNTER_CLOCKWISE,ih={isClosed:!0};function Sue(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function ag(t){return"positions"in t?t.positions:t}function t_(t){return"holeIndices"in t?t.holeIndices:null}function Cue(t){return Array.isArray(t[0])}function Mue(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function Pue(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function kue(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function JI(t,e,n,r,i){let s=e;const l=n.length;for(let o=0;o<l;o++)for(let p=0;p<r;p++)t[s++]=n[o][p]||0;if(!Pue(n))for(let o=0;o<r;o++)t[s++]=n[0][o]||0;return ih.start=e,ih.end=s,ih.size=r,YO(t,i,ih),s}function e6(t,e,n,r,i=0,s,l){s=s||n.length;const o=s-i;if(o<=0)return e;let p=e;for(let _=0;_<o;_++)t[p++]=n[i+_];if(!kue(n,r,i,s))for(let _=0;_<r;_++)t[p++]=n[i+_];return ih.start=e,ih.end=p,ih.size=r,YO(t,l,ih),p}function oF(t,e){Sue(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let l=0;for(let o=0;o<=s.length;o++)l=e6(n,l,i,e,s[o-1],s[o],o===0?uy:KI),r.push(l);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!Cue(t))return e6(n,0,t,e,0,n.length,uy),n;if(!Mue(t)){let i=0;for(const[s,l]of t.entries())i=JI(n,i,l,e,s===0?uy:KI),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return JI(n,0,t,e,uy),n}function ib(t,e,n){const r=t.length/3;let i=0;for(let s=0;s<r;s++){const l=(s+1)%r;i+=t[s*3+e]*t[l*3+n],i-=t[l*3+e]*t[s*3+n]}return Math.abs(i/2)}function t6(t,e,n,r){const i=t.length/3;for(let s=0;s<i;s++){const l=s*3,o=t[l+0],p=t[l+1],_=t[l+2];t[l+e]=o,t[l+n]=p,t[l+r]=_}}function Iue(t,e,n,r){let i=t_(t);i&&(i=i.map(o=>o/e));let s=ag(t);const l=r&&e===3;if(n){const o=s.length;s=s.slice();const p=[];for(let _=0;_<o;_+=e){p[0]=s[_],p[1]=s[_+1],l&&(p[2]=s[_+2]);const C=n(p);s[_]=C[0],s[_+1]=C[1],l&&(s[_+2]=C[2])}}if(l){const o=ib(s,0,1),p=ib(s,0,2),_=ib(s,1,2);if(!o&&!p&&!_)return[];o>p&&o>_||(p>_?(n||(s=s.slice()),t6(s,0,2,1)):(n||(s=s.slice()),t6(s,2,0,1)))}return Tue(s,i,e)}class Lue extends Dz{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=oF(e,this.positionSize);return this.opts.resolution?KO(ag(n),t_(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?JAe(ag(n),t_(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(n6(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return ag(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&n6(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:l,typedArrayManager:o}=this;let p=s.indices;if(!p||!e)return;let _=i;const C=Iue(e,this.positionSize,this.opts.preproject,this.opts.full3d);p=o.allocate(p,i+C.length,{copy:!0});for(let M=0;M<C.length;M++)p[_++]=C[M]+r;l[n+1]=i+C.length,s.indices=p}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const l=ag(e);for(let o=n,p=0;p<r;o++,p++){const _=l[p*s],C=l[p*s+1],M=s>2?l[p*s+2]:0;i[o*3]=_,i[o*3+1]=C,i[o*3+2]=M}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,l=e&&t_(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),l)for(let o=0;o<l.length;o++)s[n+l[o]/i-1]=0;s[n+r-1]=0}}function n6(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const aF=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Due=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(aF,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),Rue=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(aF,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),Bue=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,v2=[0,0,0,255],zue={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:v2},getLineColor:{type:"accessor",value:v2},material:!0},cy={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class Pv extends vA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?Due:Rue,fs:Bue,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Vf,zX,Gf]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===fr.DEFAULT&&(r=fr.LNGLAT);let s;r===fr.LNGLAT&&(i?s=n.projectPosition.bind(n):s=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new Lue({preproject:s,fp64:this.use64bitPositions(),IndexType:!e||cS(e,ei.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const l=this.getAttributeManager(),o=!0;l.remove(["instancePickingColors"]),l.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:cy,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,transition:cy,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:cy,accessor:"getFillColor",defaultValue:v2,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:cy,accessor:"getLineColor",defaultValue:v2,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(p,{index:_,target:C})=>this.encodePickingColor(p&&p.__source?p.__source.index:_,C),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:l,sideModel:o,polygonTesselator:p}=this.state,_={...e,extruded:!!n,elevationScale:s};o&&(o.setInstanceCount(p.instanceCount-1),o.setUniforms(_),i&&(o.setDrawMode(3),o.setUniforms({isWireframe:!0}).draw()),r&&(o.setDrawMode(6),o.setUniforms({isWireframe:!1}).draw())),l&&(l.setVertexCount(p.vertexCount),l.setUniforms(_).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var o;(o=this.state.models)===null||o===void 0||o.forEach(p=>p.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,l=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:l.getPolygon,buffers:l,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let s,l;if(r){const o=this.getShaders("top");o.defines.NON_INSTANCED_MODEL=1,s=new Ac(e,{...o,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(l=new Ac(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new ec({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),l.userData.excludeAttributes={indices:!0}),{models:[l,s].filter(Boolean),topModel:s,sideModel:l}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}oe(Pv,"defaultProps",zue);oe(Pv,"layerName","SolidPolygonLayer");function lF({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,l=t.length;let o=l,p=l;for(let k=0;k<l;k++){const F=e(t[k]);if(o>k&&F>=i&&(o=k),F>=s){p=k;break}}let _=o;const M=p-o!==r.length?t.slice(p):void 0;for(let k=0;k<r.length;k++)t[_++]=r[k];if(M){for(let k=0;k<M.length;k++)t[_++]=M[k];t.length=_}return{startRow:o,endRow:o+r.length}}const AF=[0,0,0,255],Oue=[0,0,0,255],Fue={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:Oue},getLineColor:{type:"accessor",value:AF},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class Qf extends Vn{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&or.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(s=>lF({data:r,getIndex:l=>l.__source.index,dataRange:s,replace:this._getPaths(s)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:s}=this.props,l=[],o=i==="XY"?2:3,{startRow:p,endRow:_}=e,{iterable:C,objectInfo:M}=Wd(n,p,_);for(const k of C){M.index++;let F=r(k,M);s&&(F=oF(F,o));const{holeIndices:j}=F,H=F.positions||F;if(j)for(let ie=0;ie<=j.length;ie++){const Y=H.slice(j[ie-1]||0,j[ie]||H.length);l.push(this.getSubLayerRow({path:Y},k,M.index))}else l.push(this.getSubLayerRow({path:H},k,M.index))}return l}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:s,wireframe:l,_normalize:o,_windingOrder:p,elevationScale:_,transitions:C,positionFormat:M}=this.props,{lineWidthUnits:k,lineWidthScale:F,lineWidthMinPixels:j,lineWidthMaxPixels:H,lineJointRounded:ie,lineMiterLimit:Y,lineDashJustified:J}=this.props,{getFillColor:se,getLineColor:he,getLineWidth:pe,getLineDashArray:be,getElevation:Ge,getPolygon:We,updateTriggers:Xe,material:rt}=this.props,{paths:Oe,pathsDiff:nt}=this.state,Ze=this.getSubLayerClass("fill",Pv),pt=this.getSubLayerClass("stroke",Sv),Yt=this.shouldRenderSubLayer("fill",Oe)&&new Ze({_dataDiff:n,extruded:s,elevationScale:_,filled:i,wireframe:l,_normalize:o,_windingOrder:p,getElevation:Ge,getFillColor:se,getLineColor:s&&l?he:AF,material:rt,transitions:C},this.getSubLayerProps({id:"fill",updateTriggers:Xe&&{getPolygon:Xe.getPolygon,getElevation:Xe.getElevation,getFillColor:Xe.getFillColor,lineColors:s&&l,getLineColor:Xe.getLineColor}}),{data:e,positionFormat:M,getPolygon:We}),Et=!s&&r&&this.shouldRenderSubLayer("stroke",Oe)&&new pt({_dataDiff:nt&&(()=>nt),widthUnits:k,widthScale:F,widthMinPixels:j,widthMaxPixels:H,jointRounded:ie,miterLimit:Y,dashJustified:J,_pathType:"loop",transitions:C&&{getWidth:C.getLineWidth,getColor:C.getLineColor,getPath:C.getPolygon},getColor:this.getSubLayerAccessor(he),getWidth:this.getSubLayerAccessor(pe),getDashArray:this.getSubLayerAccessor(be)},this.getSubLayerProps({id:"stroke",updateTriggers:Xe&&{getWidth:Xe.getLineWidth,getColor:Xe.getLineColor,getDashArray:Xe.getLineDashArray}}),{data:Oe,positionFormat:M,getPath:un=>un.path});return[!s&&Yt,Et,s&&Yt]}}oe(Qf,"layerName","PolygonLayer");oe(Qf,"defaultProps",Fue);function Nue(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?Uue(t,r,n):null}function Uue(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function Vue(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let l=0;l<i.length;l++)e(i[l],s),n[r][l*3+0]=s[0],n[r][l*3+1]=s[1],n[r][l*3+2]=s[2]}return n}const Gue=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,sb=192/256,r6=[],$ue={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class YS extends Tv{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:Gue}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&or.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,l=i?Math.max(r,sb*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:sb,outlineBuffer:l,gamma:r,sdf:!!n,outlineColor:s},super.draw(e),n&&i){const{iconManager:o}=this.state;o.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:sb}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):r6}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):r6}}oe(YS,"defaultProps",$ue);oe(YS,"layerName","MultiIconLayer");const Sg=1e20;class jue{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:l="normal",fontStyle:o="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const p=this.size=e+n*4,_=this._createCanvas(p),C=this.ctx=_.getContext("2d",{willReadFrequently:!0});C.font=`${o} ${l} ${e}px ${s}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(p*p),this.gridInner=new Float64Array(p*p),this.f=new Float64Array(p),this.z=new Float64Array(p+1),this.v=new Uint16Array(p)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:l}=this.ctx.measureText(e),o=Math.ceil(r),p=0,_=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(l-s))),C=Math.min(this.size-this.buffer,o+Math.ceil(i)),M=_+2*this.buffer,k=C+2*this.buffer,F=Math.max(M*k,0),j=new Uint8ClampedArray(F),H={data:j,width:M,height:k,glyphWidth:_,glyphHeight:C,glyphTop:o,glyphLeft:p,glyphAdvance:n};if(_===0||C===0)return H;const{ctx:ie,buffer:Y,gridInner:J,gridOuter:se}=this;ie.clearRect(Y,Y,_,C),ie.fillText(e,Y,Y+o);const he=ie.getImageData(Y,Y,_,C);se.fill(Sg,0,F),J.fill(0,0,F);for(let pe=0;pe<C;pe++)for(let be=0;be<_;be++){const Ge=he.data[4*(pe*_+be)+3]/255;if(Ge===0)continue;const We=(pe+Y)*M+be+Y;if(Ge===1)se[We]=0,J[We]=Sg;else{const Xe=.5-Ge;se[We]=Xe>0?Xe*Xe:0,J[We]=Xe<0?Xe*Xe:0}}i6(se,0,0,M,k,M,this.f,this.v,this.z),i6(J,Y,Y,_,C,M,this.f,this.v,this.z);for(let pe=0;pe<F;pe++){const be=Math.sqrt(se[pe])-Math.sqrt(J[pe]);j[pe]=Math.round(255-255*(be/this.radius+this.cutoff))}return H}}function i6(t,e,n,r,i,s,l,o,p){for(let _=e;_<e+r;_++)s6(t,n*s+_,s,i,l,o,p);for(let _=n;_<n+i;_++)s6(t,_*s+e,1,r,l,o,p)}function s6(t,e,n,r,i,s,l){s[0]=0,l[0]=-Sg,l[1]=Sg,i[0]=t[e];for(let o=1,p=0,_=0;o<r;o++){i[o]=t[e+o*n];const C=o*o;do{const M=s[p];_=(i[o]-i[M]+C-M*M)/(o-M)/2}while(_<=l[p]&&--p>-1);p++,s[p]=o,l[p]=_,l[p+1]=Sg}for(let o=0,p=0;o<r;o++){for(;l[p+1]<o;)p++;const _=s[p],C=o-_;t[e+o*n]=i[_]+C*C}}const Hue=32,Wue=[];function Que(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function que({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:l=0,yOffset:o=0}){let p=0,_=l;const C=n+r*2;for(const M of t)if(!s[M]){const k=e(M);_+k+r*2>i&&(_=0,p++),s[M]={x:_+r,y:o+p*C+r,width:k,height:C,layoutWidth:k,layoutHeight:n},_+=k+r*2}return{mapping:s,xOffset:_,yOffset:o+p*C,canvasHeight:Que(o+(p+1)*C)}}function uF(t,e,n,r){let i=0;for(let l=e;l<n;l++){var s;const o=t[l];i+=((s=r[o])===null||s===void 0?void 0:s.layoutWidth)||0}return i}function cF(t,e,n,r,i,s){let l=e,o=0;for(let p=e;p<n;p++){const _=uF(t,p,p+1,i);o+_>r&&(l<p&&s.push(p),l=p,o=0),o+=_}return o}function Zue(t,e,n,r,i,s){let l=e,o=e,p=e,_=0;for(let C=e;C<n;C++)if((t[C]===" "||t[C+1]===" "||C+1===n)&&(p=C+1),p>o){let M=uF(t,o,p,i);_+M>r&&(l<o&&(s.push(o),l=o,_=0),M>r&&(M=cF(t,o,p,r,i,s),l=s[s.length-1])),o=p,_+=M}return _}function Yue(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const l=[];return e==="break-all"?cF(t,i,s,n,r,l):Zue(t,i,s,n,r,l),l}function Xue(t,e,n,r,i,s){let l=0,o=0;for(let p=e;p<n;p++){const _=t[p],C=r[_];C?(o||(o=C.layoutHeight),i[p]=l+C.layoutWidth/2,l+=C.layoutWidth):(or.warn("Missing character: ".concat(_," (").concat(_.codePointAt(0),")"))(),i[p]=l,l+=Hue)}s[0]=l,s[1]=o}function Kue(t,e,n,r,i){const s=Array.from(t),l=s.length,o=new Array(l),p=new Array(l),_=new Array(l),C=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,M=[0,0],k=[0,0];let F=0,j=0,H=0;for(let Y=0;Y<=l;Y++){const J=s[Y];if((J===`
`||Y===l)&&(H=Y),H>j){const se=C?Yue(s,n,r,i,j,H):Wue;for(let he=0;he<=se.length;he++){const pe=he===0?j:se[he-1],be=he<se.length?se[he]:H;Xue(s,pe,be,i,o,k);for(let Ge=pe;Ge<be;Ge++){var ie;const We=s[Ge],Xe=((ie=i[We])===null||ie===void 0?void 0:ie.layoutOffsetY)||0;p[Ge]=F+k[1]/2+Xe,_[Ge]=k[0]}F=F+k[1]*e,M[0]=Math.max(M[0],k[0])}j=H}J===`
`&&(o[j]=0,p[j]=0,_[j]=0,j++)}return M[1]=F,{x:o,y:p,rowWidth:_,size:M}}function Jue({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const l=t.BYTES_PER_ELEMENT,o=n?n/l:1,p=r?r/l:0,_=i[e]||Math.ceil((t.length-p)/o),C=s&&new Set,M=new Array(e);let k=t;if(o>1||p>0){const F=t.constructor;k=new F(_);for(let j=0;j<_;j++)k[j]=t[j*o+p]}for(let F=0;F<e;F++){const j=i[F],H=i[F+1]||_,ie=k.subarray(j,H);M[F]=String.fromCodePoint.apply(null,ie),C&&ie.forEach(C.add,C)}if(C)for(const F of C)s.add(String.fromCodePoint(F));return{texts:M,characterCount:_}}class hF{constructor(e=5){oe(this,"limit",void 0),oe(this,"_cache",{}),oe(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function ece(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const ad={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:ece(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},o6=1024,a6=.9,l6=1.2,fF=3;let x2=new hF(fF);function tce(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=x2.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function nce(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function A6(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function rce(t){or.assert(Number.isFinite(t)&&t>=fF,"Invalid cache limit"),x2=new hF(t)}class ice{constructor(){oe(this,"props",{...ad}),oe(this,"_key",void 0),oe(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*l6+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=tce(this._key,this.props.characterSet),r=x2.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,x2.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:l,sdf:o,radius:p,cutoff:_}=this.props;let C=n&&n.data;C||(C=document.createElement("canvas"),C.width=o6);const M=C.getContext("2d",{willReadFrequently:!0});A6(M,r,s,i);const{mapping:k,canvasHeight:F,xOffset:j,yOffset:H}=que({getFontWidth:ie=>M.measureText(ie).width,fontHeight:s*l6,buffer:l,characterSet:e,maxCanvasWidth:o6,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(C.height!==F){const ie=M.getImageData(0,0,C.width,C.height);C.height=F,M.putImageData(ie,0,0)}if(A6(M,r,s,i),o){const ie=new jue({fontSize:s,buffer:l,radius:p,cutoff:_,fontFamily:r,fontWeight:"".concat(i)});for(const Y of e){const{data:J,width:se,height:he,glyphTop:pe}=ie.draw(Y);k[Y].width=se,k[Y].layoutOffsetY=s*a6-pe;const be=M.createImageData(se,he);nce(J,be),M.putImageData(be,k[Y].x,k[Y].y)}}else for(const ie of e)M.fillText(ie,k[ie].x,k[ie].y+l+s*a6);return{xOffset:j,yOffset:H,mapping:k,data:C,width:C.width,height:C.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:l,cutoff:o}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(l," ").concat(o):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const sce=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,oce=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,ace={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class XS extends vA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:sce,fs:oce,modules:[Vf,Gf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:l,getLineWidth:o}=this.props;let{padding:p}=this.props;p.length<4&&(p=[p[0],p[1],p[0],p[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!o,padding:p,sizeUnits:mf[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:l}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new Ac(e,{...this.getShaders(),id:this.props.id,geometry:new ec({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}oe(XS,"defaultProps",ace);oe(XS,"layerName","TextBackgroundLayer");const u6={start:1,middle:0,end:-1},c6={top:1,center:0,bottom:-1},ob=[0,0,0,255],lce=1,Ace={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:ob},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:ad.characterSet},fontFamily:ad.fontFamily,fontWeight:ad.fontWeight,lineHeight:lce,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:ob},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:ob},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class KS extends Vn{constructor(...e){super(...e),oe(this,"state",void 0),oe(this,"getBoundingRect",(n,r)=>{let{size:[i,s]}=this.transformParagraph(n,r);const{fontSize:l}=this.state.fontAtlasManager.props;i/=l,s/=l;const{getTextAnchor:o,getAlignmentBaseline:p}=this.props,_=u6[typeof o=="function"?o(n,r):o],C=c6[typeof p=="function"?p(n,r):p];return[(_-1)*i/2,(C-1)*s/2,i,s]}),oe(this,"getIconOffsets",(n,r)=>{const{getTextAnchor:i,getAlignmentBaseline:s}=this.props,{x:l,y:o,rowWidth:p,size:[_,C]}=this.transformParagraph(n,r),M=u6[typeof i=="function"?i(n,r):i],k=c6[typeof s=="function"?s(n,r):s],F=l.length,j=new Array(F*2);let H=0;for(let ie=0;ie<F;ie++){const Y=(1-M)*(_-p[ie])/2;j[H++]=(M-1)*_/2+Y+l[ie],j[H++]=(k-1)*C/2+o[ie]}return j})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new ice},this.props.maxWidth>0&&or.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,l={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(l),!0;for(const o in l)if(l[o]!==i.props[o])return i.setProps(l),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,l=n.startIndices,o;const p=r==="auto"&&new Set;if(i&&l){const{texts:_,characterCount:C}=Jue({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:l,characterSet:p});o=C,s=(M,{index:k})=>_[k]}else{const{iterable:_,objectInfo:C}=Wd(n);l=[0],o=0;for(const M of _){C.index++;const k=Array.from(s(M,C)||"");p&&k.forEach(p.add,p),o+=k.length,l.push(o)}}this.setState({getText:s,startIndices:l,numInstances:o,characterSet:p||r})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:l,lineHeight:o,maxWidth:p}=this.props,_=s(e,n)||"";return Kue(_,o,l,p*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:l},styleVersion:o}=this.state,{data:p,_dataDiff:_,getPosition:C,getColor:M,getSize:k,getAngle:F,getPixelOffset:j,getBackgroundColor:H,getBorderColor:ie,getBorderWidth:Y,backgroundPadding:J,background:se,billboard:he,fontSettings:pe,outlineWidth:be,outlineColor:Ge,sizeScale:We,sizeUnits:Xe,sizeMinPixels:rt,sizeMaxPixels:Oe,transitions:nt,updateTriggers:Ze}=this.props,pt=this.getSubLayerClass("characters",YS),Yt=this.getSubLayerClass("background",XS);return[se&&new Yt({getFillColor:H,getLineColor:ie,getLineWidth:Y,padding:J,getPosition:C,getSize:k,getAngle:F,getPixelOffset:j,billboard:he,sizeScale:We,sizeUnits:Xe,sizeMinPixels:rt,sizeMaxPixels:Oe,transitions:nt&&{getPosition:nt.getPosition,getAngle:nt.getAngle,getSize:nt.getSize,getFillColor:nt.getBackgroundColor,getLineColor:nt.getBorderColor,getLineWidth:nt.getBorderWidth,getPixelOffset:nt.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:Ze.getPosition,getAngle:Ze.getAngle,getSize:Ze.getSize,getFillColor:Ze.getBackgroundColor,getLineColor:Ze.getBorderColor,getLineWidth:Ze.getBorderWidth,getPixelOffset:Ze.getPixelOffset,getBoundingRect:{getText:Ze.getText,getTextAnchor:Ze.getTextAnchor,getAlignmentBaseline:Ze.getAlignmentBaseline,styleVersion:o}}}),{data:p.attributes&&p.attributes.background?{length:p.length,attributes:p.attributes.background}:p,_dataDiff:_,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new pt({sdf:pe.sdf,smoothing:Number.isFinite(pe.smoothing)?pe.smoothing:ad.smoothing,outlineWidth:be/(pe.radius||ad.radius),outlineColor:Ge,iconAtlas:s,iconMapping:l,getPosition:C,getColor:M,getSize:k,getAngle:F,getPixelOffset:j,billboard:he,sizeScale:We*i,sizeUnits:Xe,sizeMinPixels:rt*i,sizeMaxPixels:Oe*i,transitions:nt&&{getPosition:nt.getPosition,getAngle:nt.getAngle,getColor:nt.getColor,getSize:nt.getSize,getPixelOffset:nt.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:Ze.getText,getPosition:Ze.getPosition,getAngle:Ze.getAngle,getColor:Ze.getColor,getSize:Ze.getSize,getPixelOffset:Ze.getPixelOffset,getIconOffsets:{getTextAnchor:Ze.getTextAnchor,getAlignmentBaseline:Ze.getAlignmentBaseline,styleVersion:o}}}),{data:p,_dataDiff:_,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){rce(e)}}oe(KS,"defaultProps",Ace);oe(KS,"layerName","TextLayer");const n_={circle:{type:qS,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Tv,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:KS,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},r_={type:Sv,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},vE={type:Pv,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Up({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function ab(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const l=e[s];let o=t.props[s];s.startsWith("get")&&(o=t.getSubLayerAccessor(o),i.updateTriggers[l]=r[s],n&&(i.transitions[l]=n[s])),i[l]=o}return i}function uce(t){if(Array.isArray(t))return t;switch(or.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return or.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function h6(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let l=i;l<s;l++){const o=t[l],{geometry:p}=o;if(p)if(p.type==="GeometryCollection"){or.assert(Array.isArray(p.geometries),"GeoJSON does not have geometries array");const{geometries:_}=p;for(let C=0;C<_.length;C++){const M=_[C];f6(M,r,e,o,l)}}else f6(p,r,e,o,l)}return r}function f6(t,e,n,r,i){const{type:s,coordinates:l}=t,{pointFeatures:o,lineFeatures:p,polygonFeatures:_,polygonOutlineFeatures:C}=e;if(!hce(s,l)){or.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":o.push(n({geometry:t},r,i));break;case"MultiPoint":l.forEach(M=>{o.push(n({geometry:{type:"Point",coordinates:M}},r,i))});break;case"LineString":p.push(n({geometry:t},r,i));break;case"MultiLineString":l.forEach(M=>{p.push(n({geometry:{type:"LineString",coordinates:M}},r,i))});break;case"Polygon":_.push(n({geometry:t},r,i)),l.forEach(M=>{C.push(n({geometry:{type:"LineString",coordinates:M}},r,i))});break;case"MultiPolygon":l.forEach(M=>{_.push(n({geometry:{type:"Polygon",coordinates:M}},r,i)),M.forEach(k=>{C.push(n({geometry:{type:"LineString",coordinates:k}},r,i))})});break}}const cce={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function hce(t,e){let n=cce[t];for(or.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function dF(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function hy(t){return t.geometry.coordinates}function fce(t,e){const n=dF(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:l}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=hy,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=hy,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=hy,n.polygonsOutline.data=l,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=hy,n}function dce(t,e){const n=dF(),{points:r,lines:i,polygons:s}=t,l=Vue(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:l.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:l.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:l.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:l.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const pce=["points","linestrings","polygons"],gce={...Up(n_.circle),...Up(n_.icon),...Up(n_.text),...Up(r_),...Up(vE),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class as extends Vn{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=dce(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=uce(e.data),i=this.getSubLayerRow.bind(this);let s={};const l={};if(Array.isArray(n.dataChanged)){const p=this.state.features;for(const _ in p)s[_]=p[_].slice(),l[_]=[];for(const _ of n.dataChanged){const C=h6(r,i,_);for(const M in p)l[M].push(lF({data:s[M],getIndex:k=>k.__source.index,dataRange:_,replace:C[M]}))}}else s=h6(r,i);const o=fce(s,l);this.setState({features:s,featuresDiff:l,layerProps:o})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=pce.find(s=>i.id.startsWith("".concat(this.id,"-").concat(s,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,vE.type);if(s){const l=ab(this,vE.props),o=e&&n;return o||delete l.getLineColor,l.updateTriggers.lineColors=o,new s(l,this.getSubLayerProps({id:i,updateTriggers:l.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",l=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,r_.type),o=this.shouldRenderSubLayer(s,r.lines.data)&&this.getSubLayerClass(s,r_.type);if(l||o){const p=ab(this,r_.props);return[l&&new l(p,this.getSubLayerProps({id:i,updateTriggers:p.updateTriggers}),r.polygonsOutline),o&&new o(p,this.getSubLayerProps({id:s,updateTriggers:p.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(o=>o.__source.index===i));const s=new Set(e.split("+")),l=[];for(const o of s){const p="points-".concat(o),_=n_[o],C=_&&this.shouldRenderSubLayer(p,n.points.data)&&this.getSubLayerClass(p,_.type);if(C){const M=ab(this,_.props);let k=n.points;if(o==="text"&&r){const{instancePickingColors:F,...j}=k.data.attributes;k={...k,data:{...k.data,attributes:j}}}l.push(new C(M,this.getSubLayerProps({id:p,updateTriggers:M.updateTriggers,highlightedObjectIndex:i}),k))}}return l}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:l}=i,o=Nue(s,l);return e(o,i)}}}oe(as,"layerName","GeoJsonLayer");oe(as,"defaultProps",gce);class mce{constructor(e){oe(this,"index",void 0),oe(this,"isVisible",void 0),oe(this,"isSelected",void 0),oe(this,"parent",void 0),oe(this,"children",void 0),oe(this,"content",void 0),oe(this,"state",void 0),oe(this,"layers",void 0),oe(this,"id",void 0),oe(this,"zoom",void 0),oe(this,"userData",void 0),oe(this,"boundingBox",void 0),oe(this,"_abortController",void 0),oe(this,"_loader",void 0),oe(this,"_loaderId",void 0),oe(this,"_isLoaded",void 0),oe(this,"_isCancelled",void 0),oe(this,"_needsReload",void 0),oe(this,"_bbox",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:n,onLoad:r,onError:i}){const{index:s,id:l,bbox:o,userData:p,zoom:_}=this,C=this._loaderId;this._abortController=new AbortController;const{signal:M}=this._abortController,k=await n.scheduleRequest(this,H=>H.isSelected?1:-1);if(!k){this._isCancelled=!0;return}if(this._isCancelled){k.done();return}let F=null,j;try{F=await e({index:s,id:l,bbox:o,userData:p,zoom:_,signal:M})}catch(H){j=H||!0}finally{k.done()}if(C===this._loaderId){if(this._loader=void 0,this.content=F,this._isCancelled&&!F){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,j?i(j,this):r(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const ho={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},d6=new An,yce=new An;class JS{constructor(e=[0,0,0],n=[0,0,0],r){oe(this,"center",void 0),oe(this,"halfDiagonal",void 0),oe(this,"minimum",void 0),oe(this,"maximum",void 0),r=r||d6.copy(e).add(n).scale(.5),this.center=new An(r),this.halfDiagonal=new An(n).subtract(this.center),this.minimum=new An(e),this.maximum=new An(n)}clone(){return new JS(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,r=yce.from(e.normal),i=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),s=this.center.dot(r)+e.distance;return s-i>0?ho.INSIDE:s+i<0?ho.OUTSIDE:ho.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=d6.from(e).subtract(this.center),{halfDiagonal:r}=this;let i=0,s;return s=Math.abs(n.x)-r.x,s>0&&(i+=s*s),s=Math.abs(n.y)-r.y,s>0&&(i+=s*s),s=Math.abs(n.z)-r.z,s>0&&(i+=s*s),i}}const Vp=new An,p6=new An;class e4{constructor(e=[0,0,0],n=0){oe(this,"center",void 0),oe(this,"radius",void 0),this.radius=-0,this.center=new An,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=Vp.from(n),this.center=new An().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new e4(this.center,this.radius)}union(e){const n=this.center,r=this.radius,i=e.center,s=e.radius,l=Vp.copy(i).subtract(n),o=l.magnitude();if(r>=o+s)return this.clone();if(s>=o+r)return e.clone();const p=(r+o+s)*.5;return p6.copy(l).scale((-r+p)/o).add(n),this.center.copy(p6),this.radius=p,this}expand(e){const r=Vp.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=$Y(Vp,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=Vp.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,s=e.normal.dot(n)+e.distance;return s<-r?ho.OUTSIDE:s<r?ho.INTERSECTING:ho.INSIDE}}const _ce=new An,vce=new An,fy=new An,dy=new An,py=new An,xce=new An,wce=new An,Fu={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class t4{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){oe(this,"center",void 0),oe(this,"halfAxes",void 0),this.center=new An().from(e),this.halfAxes=new Os(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new An(e).len(),new An(n).len(),new An(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),i=new An(e).normalize(),s=new An(n).normalize(),l=new An(r).normalize();return new XP().fromMatrix3(new Os([...i,...s,...l]))}fromCenterHalfSizeQuaternion(e,n,r){const i=new XP(r),s=new Os().fromQuaternion(i);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new An().from(e),this.halfAxes=s,this}clone(){return new t4(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new e4){const n=this.halfAxes,r=n.getColumn(0,fy),i=n.getColumn(1,dy),s=n.getColumn(2,py),l=_ce.copy(r).add(i).add(s);return e.center.copy(this.center),e.radius=l.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,i=this.halfAxes,s=r.x,l=r.y,o=r.z,p=Math.abs(s*i[Fu.COLUMN0ROW0]+l*i[Fu.COLUMN0ROW1]+o*i[Fu.COLUMN0ROW2])+Math.abs(s*i[Fu.COLUMN1ROW0]+l*i[Fu.COLUMN1ROW1]+o*i[Fu.COLUMN1ROW2])+Math.abs(s*i[Fu.COLUMN2ROW0]+l*i[Fu.COLUMN2ROW1]+o*i[Fu.COLUMN2ROW2]),_=r.dot(n)+e.distance;return _<=-p?ho.OUTSIDE:_>=p?ho.INSIDE:ho.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=vce.from(e).subtract(this.center),r=this.halfAxes,i=r.getColumn(0,fy),s=r.getColumn(1,dy),l=r.getColumn(2,py),o=i.magnitude(),p=s.magnitude(),_=l.magnitude();i.normalize(),s.normalize(),l.normalize();let C=0,M;return M=Math.abs(n.dot(i))-o,M>0&&(C+=M*M),M=Math.abs(n.dot(s))-p,M>0&&(C+=M*M),M=Math.abs(n.dot(l))-_,M>0&&(C+=M*M),C}computePlaneDistances(e,n,r=[-0,-0]){let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const l=this.center,o=this.halfAxes,p=o.getColumn(0,fy),_=o.getColumn(1,dy),C=o.getColumn(2,py),M=xce.copy(p).add(_).add(C).add(l),k=wce.copy(M).subtract(e);let F=n.dot(k);return i=Math.min(F,i),s=Math.max(F,s),M.copy(l).add(p).add(_).subtract(C),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),M.copy(l).add(p).subtract(_).add(C),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),M.copy(l).add(p).subtract(_).subtract(C),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),l.copy(M).subtract(p).add(_).add(C),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),l.copy(M).subtract(p).add(_).subtract(C),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),l.copy(M).subtract(p).subtract(_).add(C),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),l.copy(M).subtract(p).subtract(_).subtract(C),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),r[0]=i,r[1]=s,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,fy);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,dy);r.transformAsPoint(e);const i=this.halfAxes.getColumn(2,py);return i.transformAsPoint(e),this.halfAxes=new Os([...n,...r,...i]),this}getTransform(){throw new Error("not implemented")}}const g6=new An,m6=new An;class Ld{constructor(e=[0,0,1],n=0){oe(this,"normal",void 0),oe(this,"distance",void 0),this.normal=new An,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return tm(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=g6.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,i){return this.normal.set(e,n,r),tm(Ju(this.normal.len(),1)),this.distance=i,this}clone(){return new Ld(this.normal,this.distance)}equals(e){return Ju(this.distance,e.distance)&&Ju(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=m6.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){e=g6.from(e);const r=this.getPointDistance(e),i=m6.copy(this.normal).scale(r);return e.subtract(i).to(n)}}const y6=[new An([1,0,0]),new An([0,1,0]),new An([0,0,1])],_6=new An,bce=new An;new Ld(new An(1,0,0),0);class Yu{constructor(e=[]){oe(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*y6.length;const n=e.center,r=e.radius;let i=0;for(const s of y6){let l=this.planes[i],o=this.planes[i+1];l||(l=this.planes[i]=new Ld),o||(o=this.planes[i+1]=new Ld);const p=_6.copy(s).scale(-r).add(n);-s.dot(p),l.fromPointNormal(p,s);const _=_6.copy(s).scale(r).add(n),C=bce.copy(s).negate();-C.dot(_),o.fromPointNormal(_,C),i+=2}return this}computeVisibility(e){let n=ho.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case ho.OUTSIDE:return ho.OUTSIDE;case ho.INTERSECTING:n=ho.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(tm(Number.isFinite(n),"parentPlaneMask is required."),n===Yu.MASK_OUTSIDE||n===Yu.MASK_INSIDE)return n;let r=Yu.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const l=s<31?1<<s:0;if(s<31&&!(n&l))continue;const o=i[s],p=e.intersectPlane(o);if(p===ho.OUTSIDE)return Yu.MASK_OUTSIDE;p===ho.INTERSECTING&&(r|=l)}return r}}oe(Yu,"MASK_OUTSIDE",4294967295);oe(Yu,"MASK_INSIDE",0);oe(Yu,"MASK_INDETERMINATE",2147483647);new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;const jA=new Os,Ece=new Os,Tce=new Os,gy=new Os,v6=new Os;function Sce(t,e={}){const n=HB.EPSILON20,r=10;let i=0,s=0;const l=Ece,o=Tce;l.identity(),o.copy(t);const p=n*Cce(o);for(;s<r&&Mce(o)>p;)Pce(o,gy),v6.copy(gy).transpose(),o.multiplyRight(gy),o.multiplyLeft(v6),l.multiplyRight(gy),++i>2&&(++s,i=0);return e.unitary=l.toTarget(e.unitary),e.diagonal=o.toTarget(e.diagonal),e}function Cce(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const xE=[1,0,0],wE=[2,2,1];function Mce(t){let e=0;for(let n=0;n<3;++n){const r=t[jA.getElementIndex(wE[n],xE[n])];e+=2*r*r}return Math.sqrt(e)}function Pce(t,e){const n=HB.EPSILON15;let r=0,i=1;for(let _=0;_<3;++_){const C=Math.abs(t[jA.getElementIndex(wE[_],xE[_])]);C>r&&(i=_,r=C)}const s=xE[i],l=wE[i];let o=1,p=0;if(Math.abs(t[jA.getElementIndex(l,s)])>n){const _=t[jA.getElementIndex(l,l)],C=t[jA.getElementIndex(s,s)],M=t[jA.getElementIndex(l,s)],k=(_-C)/2/M;let F;k<0?F=-1/(-k+Math.sqrt(1+k*k)):F=1/(k+Math.sqrt(1+k*k)),o=1/Math.sqrt(1+F*F),p=F*o}return Os.IDENTITY.to(e),e[jA.getElementIndex(s,s)]=e[jA.getElementIndex(l,l)]=o,e[jA.getElementIndex(l,s)]=p,e[jA.getElementIndex(s,l)]=-p,e}const Hc=new An,kce=new An,Ice=new An,Lce=new An,Dce=new An,Rce=new Os,Bce={diagonal:new Os,unitary:new Os};function zce(t,e=new t4){if(!t||t.length===0)return e.halfAxes=new Os([0,0,0,0,0,0,0,0,0]),e.center=new An,e;const n=t.length,r=new An(0,0,0);for(const Xe of t)r.add(Xe);const i=1/n;r.multiplyByScalar(i);let s=0,l=0,o=0,p=0,_=0,C=0;for(const Xe of t){const rt=Hc.copy(Xe).subtract(r);s+=rt.x*rt.x,l+=rt.x*rt.y,o+=rt.x*rt.z,p+=rt.y*rt.y,_+=rt.y*rt.z,C+=rt.z*rt.z}s*=i,l*=i,o*=i,p*=i,_*=i,C*=i;const M=Rce;M[0]=s,M[1]=l,M[2]=o,M[3]=l,M[4]=p,M[5]=_,M[6]=o,M[7]=_,M[8]=C;const{unitary:k}=Sce(M,Bce),F=e.halfAxes.copy(k);let j=F.getColumn(0,Ice),H=F.getColumn(1,Lce),ie=F.getColumn(2,Dce),Y=-Number.MAX_VALUE,J=-Number.MAX_VALUE,se=-Number.MAX_VALUE,he=Number.MAX_VALUE,pe=Number.MAX_VALUE,be=Number.MAX_VALUE;for(const Xe of t)Hc.copy(Xe),Y=Math.max(Hc.dot(j),Y),J=Math.max(Hc.dot(H),J),se=Math.max(Hc.dot(ie),se),he=Math.min(Hc.dot(j),he),pe=Math.min(Hc.dot(H),pe),be=Math.min(Hc.dot(ie),be);j=j.multiplyByScalar(.5*(he+Y)),H=H.multiplyByScalar(.5*(pe+J)),ie=ie.multiplyByScalar(.5*(be+se)),e.center.copy(j).add(H).add(ie);const Ge=kce.set(Y-he,J-pe,se-be).multiplyByScalar(.5),We=new Os([Ge[0],0,0,0,Ge[1],0,0,0,Ge[2]]);return e.halfAxes.multiplyRight(We),e}const G0=512,x6=3,pF=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],gF=pF.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),Oce=gF.concat([[.25,.5],[.75,.5]]);class $0{constructor(e,n,r){oe(this,"x",void 0),oe(this,"y",void 0),oe(this,"z",void 0),oe(this,"childVisible",void 0),oe(this,"selected",void 0),oe(this,"_children",void 0),this.x=e,this.y=n,this.z=r}get children(){if(!this._children){const e=this.x*2,n=this.y*2,r=this.z+1;this._children=[new $0(e,n,r),new $0(e,n+1,r),new $0(e+1,n,r),new $0(e+1,n+1,r)]}return this._children}update(e){const{viewport:n,cullingVolume:r,elevationBounds:i,minZ:s,maxZ:l,bounds:o,offset:p,project:_}=e,C=this.getBoundingVolume(i,p,_);if(o&&!this.insideBounds(o)||r.computeVisibility(C)<0)return!1;if(!this.childVisible){let{z:k}=this;if(k<l&&k>=s){const F=C.distanceTo(n.cameraPosition)*n.scale/n.height;k+=Math.floor(Math.log2(F))}if(k>=l)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const k of this.children)k.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,r,i]){const s=Math.pow(2,this.z),l=G0/s;return this.x*l<r&&this.y*l<i&&(this.x+1)*l>e&&(this.y+1)*l>n}getBoundingVolume(e,n,r){if(r){const p=this.z<1?Oce:this.z<2?gF:pF,_=[];for(const C of p){const M=EE(this.x+C[0],this.y+C[1],this.z);M[2]=e[0],_.push(r(M)),e[0]!==e[1]&&(M[2]=e[1],_.push(r(M)))}return zce(_)}const i=Math.pow(2,this.z),s=G0/i,l=this.x*s+n*G0,o=G0-(this.y+1)*s;return new JS([l,o,e[0]],[l+s,o+s,e[1]])}}function Fce(t,e,n,r){const i=t instanceof mne&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map(({normal:F,distance:j})=>new Ld(F.clone().negate(),j)),l=new Yu(s),o=t.distanceScales.unitsPerMeter[2],p=n&&n[0]*o||0,_=n&&n[1]*o||0,C=t instanceof cc&&t.pitch<=60?e:0;if(r){const[F,j,H,ie]=r,Y=gA([F,ie]),J=gA([H,j]);r=[Y[0],G0-Y[1],J[0],G0-J[1]]}const M=new $0(0,0,0),k={viewport:t,project:i,cullingVolume:l,elevationBounds:[p,_],minZ:C,maxZ:e,bounds:r,offset:0};if(M.update(k),t instanceof cc&&t.subViewports&&t.subViewports.length>1){for(k.offset=-1;M.update(k)&&!(--k.offset<-x6););for(k.offset=1;M.update(k)&&!(++k.offset>x6););}return M.getSelected()}const pc=512,Nce=[-1/0,-1/0,1/0,1/0],Uce={type:"object",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function mF(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(i=>i[0])),Math.min(...n.map(i=>i[1])),Math.max(...n.map(i=>i[0])),Math.max(...n.map(i=>i[1]))]}function Vce(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function Gce(t,e){if(!t||!t.length)return null;const{index:n,id:r}=e;if(Array.isArray(t)){const s=Vce(r)%t.length;t=t[s]}let i=t;for(const s of Object.keys(n)){const l=new RegExp("{".concat(s,"}"),"g");i=i.replace(l,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function $ce(t,e,n){let r;if(e&&e.length===2){const[i,s]=e,l=t.getBounds({z:i}),o=t.getBounds({z:s});r=[Math.min(l[0],o[0]),Math.min(l[1],o[1]),Math.max(l[2],o[2]),Math.max(l[3],o[3])]}else r=t.getBounds();return t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}function jce({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map(i=>bE(i,e,n))}function bE(t,e,n){if(!Array.isArray(e)){const s=n.x-t.x,l=n.y-t.y,{width:o,height:p}=n,_={targetZ:e},C=t.unproject([s,l],_),M=t.unproject([s+o,l],_),k=t.unproject([s,l+p],_),F=t.unproject([s+o,l+p],_);return[Math.min(C[0],M[0],k[0],F[0]),Math.min(C[1],M[1],k[1],F[1]),Math.max(C[0],M[0],k[0],F[0]),Math.max(C[1],M[1],k[1],F[1])]}const r=bE(t,e[0],n),i=bE(t,e[1],n);return[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[2],i[2]),Math.max(r[3],i[3])]}function Hce(t,e,n){return n?mF(t,n).map(i=>i*e/pc):t.map(r=>r*e/pc)}function n4(t,e){return Math.pow(2,t)*pc/e}function EE(t,e,n){const r=n4(n,pc),i=t/r*360-180,s=Math.PI-2*Math.PI*e/r,l=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[i,l]}function w6(t,e,n,r){const i=n4(n,r);return[t/i*pc,e/i*pc]}function Wce(t,e,n,r,i=pc){if(t.isGeospatial){const[_,C]=EE(e,n,r),[M,k]=EE(e+1,n+1,r);return{west:_,north:C,east:M,south:k}}const[s,l]=w6(e,n,r,i),[o,p]=w6(e+1,n+1,r,i);return{left:s,top:l,right:o,bottom:p}}function Qce(t,e,n,r,i){const s=$ce(t,null,r),l=n4(e,n),[o,p,_,C]=Hce(s,l,i),M=[];for(let k=Math.floor(o);k<_;k++)for(let F=Math.floor(p);F<C;F++)M.push({x:k,y:F,z:e});return M}function qce({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:s=pc,modelMatrix:l,modelMatrixInverse:o,zoomOffset:p=0}){let _=t.isGeospatial?Math.round(t.zoom+Math.log2(pc/s))+p:Math.ceil(t.zoom)+p;if(typeof n=="number"&&Number.isFinite(n)&&_<n){if(!i)return[];_=n}typeof e=="number"&&Number.isFinite(e)&&_>e&&(_=e);let C=i;return l&&o&&i&&!t.isGeospatial&&(C=mF(i,l)),t.isGeospatial?Fce(t,_,r,i):Qce(t,_,s,C||Nce,o)}function Zce(t){let e={},n;return r=>{for(const i in r)if(!Yce(r[i],e[i])){n=t(r),e=r;break}return n}}function Yce(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}const b6=1,kv=2,Xce="never",Kce="no-overlap",r4="best-available",Jce=5,ehe={[r4]:rhe,[Kce]:ihe,[Xce]:()=>{}},the={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class nhe{constructor(e){oe(this,"opts",void 0),oe(this,"_requestScheduler",void 0),oe(this,"_cache",void 0),oe(this,"_dirty",void 0),oe(this,"_tiles",void 0),oe(this,"_cacheByteSize",void 0),oe(this,"_viewport",void 0),oe(this,"_zRange",void 0),oe(this,"_selectedTiles",void 0),oe(this,"_frameNumber",void 0),oe(this,"_modelMatrix",void 0),oe(this,"_modelMatrixInverse",void 0),oe(this,"_maxZoom",void 0),oe(this,"_minZoom",void 0),oe(this,"onTileLoad",void 0),oe(this,"_getCullBounds",Zce(jce)),this.opts={...the,...e},this.onTileLoad=n=>{var r,i;(r=(i=this.opts).onTileLoad)===null||r===void 0||r.call(i,n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new G$({maxRequests:e.maxRequests,throttleRequests:!!(e.maxRequests&&e.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new ha,this._modelMatrixInverse=new ha,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:r}={}){const i=new ha(r),s=!i.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!Ju(this._zRange,n)||s){s&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=e,this._zRange=n;const o=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=o.map(p=>this._getTile(p,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(o=>this._getTile(o.index,!0)));const l=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),l&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const r=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:i}=e;for(const[s,l,o,p]of r){let _;if("west"in i)_=i.west<o&&i.east>s&&i.south<p&&i.north>l;else{const C=Math.min(i.top,i.bottom),M=Math.max(i.top,i.bottom);_=i.left<o&&i.right>s&&C<p&&M>l}if(_)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:r,zRange:i,modelMatrix:s,modelMatrixInverse:l}){const{tileSize:o,extent:p,zoomOffset:_}=this.opts;return qce({viewport:e,maxZoom:n,minZoom:r,zRange:i,tileSize:o,extent:p,modelMatrix:s,modelMatrixInverse:l,zoomOffset:_})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:Wce(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),r=Math.floor(e.y/2),i=e.z-1;return{x:n,y:r,z:i}}updateTileStates(){const e=this.opts.refinementStrategy||r4,n=new Array(this._cache.size);let r=0;for(const i of this._cache.values())n[r++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(const i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof e=="function"?e:ehe[e])(Array.from(this._cache.values())),r=0;for(const i of this._cache.values())if(n[r++]!==i.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,n=[];let r=0;for(const i of this._cache.values())i.isLoading&&(r++,!i.isSelected&&!i.isVisible&&n.push(i));for(;e>0&&r>e&&n.length>0;)n.shift().abort(),r--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const r=this._getNearestAncestor(n);n.parent=r,r!=null&&r.children&&r.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,r=n.maxCacheSize||(n.maxCacheByteSize?1/0:Jce*this.selectedTiles.length),i=n.maxCacheByteSize||1/0;if(e.size>r||this._cacheByteSize>i){for(const[p,_]of e){if(!_.isVisible&&!_.isSelected){var l,o;this._cacheByteSize-=n.maxCacheByteSize?_.byteLength:0,e.delete(p),(l=(o=this.opts).onTileUnload)===null||l===void 0||l.call(o,_)}if(e.size<=r&&this._cacheByteSize<=i)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((p,_)=>p.zoom-_.zoom),this._dirty=!1)}_getTile(e,n){const r=this.getTileId(e);let i=this._cache.get(r),s=!1;return!i&&n?(i=new mce(e),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:r,zoom:this.getTileZoom(i.index)}),s=!0,this._cache.set(r,i),this._dirty=!0):i&&i.needsReload&&(s=!0),i&&s&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(e){const{_minZoom:n=0}=this;let r=e.index;for(;this.getTileZoom(r)>n;){r=this.getParentIndex(r);const i=this._getTile(r);if(i)return i}return null}}function rhe(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!yF(e)&&i4(e);for(const e of t)e.isVisible=!!(e.state&kv)}function ihe(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&yF(n);const e=Array.from(t).sort((n,r)=>n.zoom-r.zoom);for(const n of e)if(n.isVisible=!!(n.state&kv),n.children&&(n.isVisible||n.state&b6))for(const r of n.children)r.state=b6;else n.isSelected&&i4(n)}function yF(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=kv,!0;e=e.parent}return!1}function i4(t){for(const e of t.children)e.isLoaded||e.content?e.state|=kv:i4(e)}const she={TilesetClass:nhe,data:{type:"data",value:[]},dataComparator:Uce.equal,renderSubLayers:{type:"function",value:t=>new as(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:r4,zRange:null,maxRequests:6,zoomOffset:0};class Eh extends Vn{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n,r;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||(r=n.selectedTiles)===null||r===void 0?void 0:r.every(i=>i.isLoaded&&i.layers&&i.layers.every(s=>s.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:s,maxZoom:l,minZoom:o,maxRequests:p,zoomOffset:_}=this.props;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:l,minZoom:o,tileSize:e,refinementStrategy:i,extent:s,maxRequests:p,zoomOffset:_,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:r}=this.props,i=e.update(this.context.viewport,{zRange:n,modelMatrix:r}),{isLoaded:s}=e,l=this.state.isLoaded!==s,o=this.state.frameNumber!==i;s&&(l||o)&&this._onViewportLoad(),o&&this.setState({frameNumber:i}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:r,fetch:i}=this.props,{signal:s}=e;return e.url=typeof n=="string"||Array.isArray(n)?Gce(n,e):null,r?r(e):i&&e.url?i(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){const r=n.props.tile;return e.picked&&(e.tile=r),e.sourceTile=r,e}_updateAutoHighlight(e){const n=e.sourceTile;if(n&&n.layers)for(const r of n.layers)r.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(r=>e.layers[0].props[r]!==n[r])&&(e.layers=e.layers.map(r=>r.clone(n)));else{const r=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=bf(r,Boolean).map(i=>i.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:r}=e.props;return this.state.tileset.isTileVisible(r,n)}}oe(Eh,"defaultProps",she);oe(Eh,"layerName","TileLayer");const lb=Math.PI/180,my=new Float32Array(16),E6=new Float32Array(12);function T6(t,e,n){const r=e[0]*lb,i=e[1]*lb,s=e[2]*lb,l=Math.sin(s),o=Math.sin(r),p=Math.sin(i),_=Math.cos(s),C=Math.cos(r),M=Math.cos(i),k=n[0],F=n[1],j=n[2];t[0]=k*M*C,t[1]=k*p*C,t[2]=k*-o,t[3]=F*(-p*_+M*o*l),t[4]=F*(M*_+p*o*l),t[5]=F*C*l,t[6]=j*(p*l+M*o*_),t[7]=j*(-M*l+p*o*_),t[8]=j*C*_}function S6(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const ohe={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:i,getScale:s,getTranslation:l,getTransformMatrix:o}=this.props,p=Array.isArray(o),_=p&&o.length===16,C=Array.isArray(s),M=Array.isArray(i),k=Array.isArray(l),F=_||!p&&!!o(r[0]);F?t.constant=_:t.constant=M&&C&&k;const j=t.value;if(t.constant){let H;F?(my.set(o),H=S6(my)):(H=E6,T6(H,i,s),H.set(l,9)),t.value=new Float32Array(H)}else{let H=e*t.size;const{iterable:ie,objectInfo:Y}=Wd(r,e,n);for(const J of ie){Y.index++;let se;if(F)my.set(_?o:o(J,Y)),se=S6(my);else{se=E6;const he=M?i:i(J,Y),pe=C?s:s(J,Y);T6(se,he,pe),se.set(k?l:l(J,Y),9)}j[H++]=se[0],j[H++]=se[1],j[H++]=se[2],j[H++]=se[3],j[H++]=se[4],j[H++]=se[5],j[H++]=se[6],j[H++]=se[7],j[H++]=se[8],j[H++]=se[9],j[H++]=se[10],j[H++]=se[11]}}}};function ahe(t,e){return e===fr.CARTESIAN||e===fr.METER_OFFSETS||e===fr.DEFAULT&&!t.isGeospatial}const lhe=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Ahe=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function _F(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,l=-1/0;const o=t.POSITION?t.POSITION.value:[],p=o&&o.length;for(let _=0;_<p;_+=3){const C=o[_],M=o[_+1],k=o[_+2];e=C<e?C:e,n=M<n?M:n,r=k<r?k:r,i=C>i?C:i,s=M>s?M:s,l=k>l?k:l}return[[e,n,r],[i,s,l]]}function uhe(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class j0{constructor(e,n){oe(this,"fields",void 0),oe(this,"metadata",void 0),uhe(Array.isArray(e)),che(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(const l of r)e[l]=!0;const s=this.fields.filter(l=>e[l.name]);return new j0(s,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=n.map(s=>this.fields[s]).filter(Boolean);return new j0(i,this.metadata)}assign(e){let n,r=this.metadata;if(e instanceof j0){const l=e;n=l.fields,r=C6(C6(new Map,this.metadata),l.metadata)}else n=e;const i=Object.create(null);for(const l of this.fields)i[l.name]=l;for(const l of n)i[l.name]=l;const s=Object.values(i);return new j0(s,r)}}function che(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function C6(t,e){return new Map([...t||new Map,...e||new Map])}class Cg{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"nullable",void 0),oe(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new Cg(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Pi=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({}),vF,xF,wF;class s4{static isNull(e){return e&&e.typeId===Pi.Null}static isInt(e){return e&&e.typeId===Pi.Int}static isFloat(e){return e&&e.typeId===Pi.Float}static isBinary(e){return e&&e.typeId===Pi.Binary}static isUtf8(e){return e&&e.typeId===Pi.Utf8}static isBool(e){return e&&e.typeId===Pi.Bool}static isDecimal(e){return e&&e.typeId===Pi.Decimal}static isDate(e){return e&&e.typeId===Pi.Date}static isTime(e){return e&&e.typeId===Pi.Time}static isTimestamp(e){return e&&e.typeId===Pi.Timestamp}static isInterval(e){return e&&e.typeId===Pi.Interval}static isList(e){return e&&e.typeId===Pi.List}static isStruct(e){return e&&e.typeId===Pi.Struct}static isUnion(e){return e&&e.typeId===Pi.Union}static isFixedSizeBinary(e){return e&&e.typeId===Pi.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Pi.FixedSizeList}static isMap(e){return e&&e.typeId===Pi.Map}static isDictionary(e){return e&&e.typeId===Pi.Dictionary}get typeId(){return Pi.NONE}compareTo(e){return this===e}}vF=Symbol.toStringTag;class Zd extends s4{constructor(e,n){super(),oe(this,"isSigned",void 0),oe(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return Pi.Int}get[vF](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class hhe extends Zd{constructor(){super(!0,8)}}class fhe extends Zd{constructor(){super(!0,16)}}class dhe extends Zd{constructor(){super(!0,32)}}class phe extends Zd{constructor(){super(!1,8)}}class ghe extends Zd{constructor(){super(!1,16)}}class mhe extends Zd{constructor(){super(!1,32)}}const bF={HALF:16,SINGLE:32,DOUBLE:64};xF=Symbol.toStringTag;class EF extends s4{constructor(e){super(),oe(this,"precision",void 0),this.precision=e}get typeId(){return Pi.Float}get[xF](){return"Float"}toString(){return"Float".concat(this.precision)}}class yhe extends EF{constructor(){super(bF.SINGLE)}}class _he extends EF{constructor(){super(bF.DOUBLE)}}wF=Symbol.toStringTag;class vhe extends s4{constructor(e,n){super(),oe(this,"listSize",void 0),oe(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return Pi.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[wF](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function xhe(t){switch(t.constructor){case Int8Array:return new hhe;case Uint8Array:return new phe;case Int16Array:return new fhe;case Uint16Array:return new ghe;case Int32Array:return new dhe;case Uint32Array:return new mhe;case Float32Array:return new yhe;case Float64Array:return new _he;default:throw new Error("array type not supported")}}function M6(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),or.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function P6(t,e){if(t.attributes)return M6(t.attributes,e),t instanceof ec?t:new ec(t);if(t.positions||t.POSITION)return M6(t,e),new ec({attributes:t});throw Error("Invalid mesh")}const whe=[0,0,0,255],bhe={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:whe},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class Iv extends vA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){const e=!dr(this.context.gl),n={};return dB(this.context.gl,ei.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:lhe,fs:Ahe,modules:[Vf,OX,Gf],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:r}=this.props;if(!r)return null;if(n=(e=r.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:i}=P6(r,this.props._useMeshColors);i.POSITION=i.POSITION||i.positions,n=_F(i)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:ohe}),this.setState({emptyTexture:new da(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e;if(n.mesh!==r.mesh||i.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const l=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(l.NORMAL||l.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:r,coordinateSystem:i,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:r,composeModelMatrix:!s||ahe(n,i),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new Ac(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:P6(e,this.props._useMeshColors),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:i}=this.state;return n.setUniforms({sampler:r||i,hasTexture:!!r}),n}setTexture(e){const{emptyTexture:n,model:r}=this.state;r&&r.setUniforms({sampler:e||n,hasTexture:!!e})}}oe(Iv,"defaultProps",bhe);oe(Iv,"layerName","SimpleMeshLayer");const Ehe={inject:{"vs:#decl":`
attribute vec2 instanceDashArrays;
attribute float instanceDashOffsets;
varying vec2 vDashArray;
varying float vDashOffset;
`,"vs:#main-end":`
vDashArray = instanceDashArrays;
vDashOffset = instanceDashOffsets / width.x;
`,"fs:#decl":`
uniform float dashAlignMode;
uniform float capType;
uniform bool dashGapPickable;
varying vec2 vDashArray;
varying float vDashOffset;

float round(float x) {
  return floor(x + 0.5);
}
`,"fs:#main-start":`
  float solidLength = vDashArray.x;
  float gapLength = vDashArray.y;
  float unitLength = solidLength + gapLength;

  float offset;

  if (unitLength > 0.0) {
    if (dashAlignMode == 0.0) {
      offset = vDashOffset;
    } else {
      unitLength = vPathLength / round(vPathLength / unitLength);
      offset = solidLength / 2.0;
    }

    float unitOffset = mod(vPathPosition.y + offset, unitLength);

    if (gapLength > 0.0 && unitOffset > solidLength) {
      if (capType <= 0.5) {
        if (!(dashGapPickable && picking_uActive)) {
          discard;
        }
      } else {
        float distToEnd = length(vec2(
          min(unitOffset - solidLength, unitLength - unitOffset),
          vPathPosition.x
        ));
        if (distToEnd > 1.0) {
          if (!(dashGapPickable && picking_uActive)) {
            discard;
          }
        }
      }
    }
  }
`}},The={inject:{"vs:#decl":`
attribute float instanceOffsets;
`,"vs:DECKGL_FILTER_SIZE":`
  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
  size *= offsetWidth;
`,"vs:#main-end":`
  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
  float offsetDir = sign(instanceOffsets);
  vPathPosition.x = (vPathPosition.x + offsetDir) * offsetWidth - offsetDir;
  vPathPosition.y *= offsetWidth;
  vPathLength *= offsetWidth;
`,"fs:#main-start":`
  float isInside;
  isInside = step(-1.0, vPathPosition.x) * step(vPathPosition.x, 1.0);
  if (isInside == 0.0) {
    discard;
  }
`}},She={getDashArray:{type:"accessor",value:[0,0]},getOffset:{type:"accessor",value:0},dashJustified:!1,dashGapPickable:!1};class qf extends IS{constructor({dash:e=!1,offset:n=!1,highPrecisionDash:r=!1}={}){super({dash:e||r,offset:n,highPrecisionDash:r})}isEnabled(e){return"pathTesselator"in e.state}getShaders(e){if(!e.isEnabled(this))return null;let n={};return e.opts.dash&&(n=J3(n,Ehe)),e.opts.offset&&(n=J3(n,The)),n}initializeState(e,n){const r=this.getAttributeManager();!r||!n.isEnabled(this)||(n.opts.dash&&r.addInstanced({instanceDashArrays:{size:2,accessor:"getDashArray"}}),n.opts.highPrecisionDash&&r.addInstanced({instanceDashOffsets:{size:1,accessor:"getPath",transform:n.getDashOffsets.bind(this)}}),n.opts.offset&&r.addInstanced({instanceOffsets:{size:1,accessor:"getOffset"}}))}updateState(e,n){if(!n.isEnabled(this))return;const r={};n.opts.dash&&(r.dashAlignMode=this.props.dashJustified?1:0,r.dashGapPickable=!!this.props.dashGapPickable),this.state.model.setUniforms(r)}getDashOffsets(e){const n=[0],r=this.props.positionFormat==="XY"?2:3,i=Array.isArray(e[0]),s=i?e.length:e.length/r;let l,o;for(let p=0;p<s-1;p++)l=i?e[p]:e.slice(p*r,p*r+r),l=this.projectPosition(l),p>0&&(n[p]=n[p-1]+CY(o,l)),o=l;return n}}oe(qf,"defaultProps",She);oe(qf,"extensionName","PathStyleExtension");function TF(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Che(t){return t.length===1&&(t=Mhe(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}function Mhe(t){return function(e,n){return TF(t(e),n)}}Che(TF);function hm(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var Ab=Array.prototype.slice;function Phe(t){return t}var i_=1,s_=2,TE=3,yy=4,k6=1e-6;function khe(t){return"translate("+(t+.5)+",0)"}function Ihe(t){return"translate(0,"+(t+.5)+")"}function Lhe(t){return function(e){return+t(e)}}function Dhe(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function Rhe(){return!this.__axis}function o4(t,e){var n=[],r=null,i=null,s=6,l=6,o=3,p=t===i_||t===yy?-1:1,_=t===yy||t===s_?"x":"y",C=t===i_||t===TE?khe:Ihe;function M(k){var F=r??(e.ticks?e.ticks.apply(e,n):e.domain()),j=i??(e.tickFormat?e.tickFormat.apply(e,n):Phe),H=Math.max(s,0)+o,ie=e.range(),Y=+ie[0]+.5,J=+ie[ie.length-1]+.5,se=(e.bandwidth?Dhe:Lhe)(e.copy()),he=k.selection?k.selection():k,pe=he.selectAll(".domain").data([null]),be=he.selectAll(".tick").data(F,e).order(),Ge=be.exit(),We=be.enter().append("g").attr("class","tick"),Xe=be.select("line"),rt=be.select("text");pe=pe.merge(pe.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),be=be.merge(We),Xe=Xe.merge(We.append("line").attr("stroke","currentColor").attr(_+"2",p*s)),rt=rt.merge(We.append("text").attr("fill","currentColor").attr(_,p*H).attr("dy",t===i_?"0em":t===TE?"0.71em":"0.32em")),k!==he&&(pe=pe.transition(k),be=be.transition(k),Xe=Xe.transition(k),rt=rt.transition(k),Ge=Ge.transition(k).attr("opacity",k6).attr("transform",function(Oe){return isFinite(Oe=se(Oe))?C(Oe):this.getAttribute("transform")}),We.attr("opacity",k6).attr("transform",function(Oe){var nt=this.parentNode.__axis;return C(nt&&isFinite(nt=nt(Oe))?nt:se(Oe))})),Ge.remove(),pe.attr("d",t===yy||t==s_?l?"M"+p*l+","+Y+"H0.5V"+J+"H"+p*l:"M0.5,"+Y+"V"+J:l?"M"+Y+","+p*l+"V0.5H"+J+"V"+p*l:"M"+Y+",0.5H"+J),be.attr("opacity",1).attr("transform",function(Oe){return C(se(Oe))}),Xe.attr(_+"2",p*s),rt.attr(_,p*H).text(j),he.filter(Rhe).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===s_?"start":t===yy?"end":"middle"),he.each(function(){this.__axis=se})}return M.scale=function(k){return arguments.length?(e=k,M):e},M.ticks=function(){return n=Ab.call(arguments),M},M.tickArguments=function(k){return arguments.length?(n=k==null?[]:Ab.call(k),M):n.slice()},M.tickValues=function(k){return arguments.length?(r=k==null?null:Ab.call(k),M):r&&r.slice()},M.tickFormat=function(k){return arguments.length?(i=k,M):i},M.tickSize=function(k){return arguments.length?(s=l=+k,M):s},M.tickSizeInner=function(k){return arguments.length?(s=+k,M):s},M.tickSizeOuter=function(k){return arguments.length?(l=+k,M):l},M.tickPadding=function(k){return arguments.length?(o=+k,M):o},M}function Bhe(t){return o4(i_,t)}function SF(t){return o4(s_,t)}function zhe(t){return o4(TE,t)}var Ohe={value:function(){}};function CF(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new o_(n)}function o_(t){this._=t}function Fhe(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}o_.prototype=CF.prototype={constructor:o_,on:function(t,e){var n=this._,r=Fhe(t+"",n),i,s=-1,l=r.length;if(arguments.length<2){for(;++s<l;)if((i=(t=r[s]).type)&&(i=Nhe(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<l;)if(i=(t=r[s]).type)n[i]=I6(n[i],t.name,e);else if(e==null)for(i in n)n[i]=I6(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new o_(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function Nhe(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function I6(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Ohe,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var SE="http://www.w3.org/1999/xhtml";const L6={svg:"http://www.w3.org/2000/svg",xhtml:SE,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Lv(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),L6.hasOwnProperty(e)?{space:L6[e],local:t}:t}function Uhe(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===SE&&e.documentElement.namespaceURI===SE?e.createElement(t):e.createElementNS(n,t)}}function Vhe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function MF(t){var e=Lv(t);return(e.local?Vhe:Uhe)(e)}function Ghe(){}function a4(t){return t==null?Ghe:function(){return this.querySelector(t)}}function $he(t){typeof t!="function"&&(t=a4(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=new Array(l),p,_,C=0;C<l;++C)(p=s[C])&&(_=t.call(p,p.__data__,C,s))&&("__data__"in p&&(_.__data__=p.__data__),o[C]=_);return new mA(r,this._parents)}function jhe(){return[]}function PF(t){return t==null?jhe:function(){return this.querySelectorAll(t)}}function Hhe(t){typeof t!="function"&&(t=PF(t));for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var l=e[s],o=l.length,p,_=0;_<o;++_)(p=l[_])&&(r.push(t.call(p,p.__data__,_,l)),i.push(p));return new mA(r,i)}function kF(t){return function(){return this.matches(t)}}function Whe(t){typeof t!="function"&&(t=kF(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=[],p,_=0;_<l;++_)(p=s[_])&&t.call(p,p.__data__,_,s)&&o.push(p);return new mA(r,this._parents)}function IF(t){return new Array(t.length)}function Qhe(){return new mA(this._enter||this._groups.map(IF),this._parents)}function w2(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}w2.prototype={constructor:w2,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function qhe(t){return function(){return t}}var D6="$";function Zhe(t,e,n,r,i,s){for(var l=0,o,p=e.length,_=s.length;l<_;++l)(o=e[l])?(o.__data__=s[l],r[l]=o):n[l]=new w2(t,s[l]);for(;l<p;++l)(o=e[l])&&(i[l]=o)}function Yhe(t,e,n,r,i,s,l){var o,p,_={},C=e.length,M=s.length,k=new Array(C),F;for(o=0;o<C;++o)(p=e[o])&&(k[o]=F=D6+l.call(p,p.__data__,o,e),F in _?i[o]=p:_[F]=p);for(o=0;o<M;++o)F=D6+l.call(t,s[o],o,s),(p=_[F])?(r[o]=p,p.__data__=s[o],_[F]=null):n[o]=new w2(t,s[o]);for(o=0;o<C;++o)(p=e[o])&&_[k[o]]===p&&(i[o]=p)}function Xhe(t,e){if(!t)return F=new Array(this.size()),_=-1,this.each(function(be){F[++_]=be}),F;var n=e?Yhe:Zhe,r=this._parents,i=this._groups;typeof t!="function"&&(t=qhe(t));for(var s=i.length,l=new Array(s),o=new Array(s),p=new Array(s),_=0;_<s;++_){var C=r[_],M=i[_],k=M.length,F=t.call(C,C&&C.__data__,_,r),j=F.length,H=o[_]=new Array(j),ie=l[_]=new Array(j),Y=p[_]=new Array(k);n(C,M,H,ie,Y,F,e);for(var J=0,se=0,he,pe;J<j;++J)if(he=H[J]){for(J>=se&&(se=J+1);!(pe=ie[se])&&++se<j;);he._next=pe||null}}return l=new mA(l,r),l._enter=o,l._exit=p,l}function Khe(){return new mA(this._exit||this._groups.map(IF),this._parents)}function Jhe(t,e,n){var r=this.enter(),i=this,s=this.exit();return r=typeof t=="function"?t(r):r.append(t+""),e!=null&&(i=e(i)),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function efe(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),l=new Array(r),o=0;o<s;++o)for(var p=e[o],_=n[o],C=p.length,M=l[o]=new Array(C),k,F=0;F<C;++F)(k=p[F]||_[F])&&(M[F]=k);for(;o<r;++o)l[o]=e[o];return new mA(l,this._parents)}function tfe(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],l;--i>=0;)(l=r[i])&&(s&&l.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(l,s),s=l);return this}function nfe(t){t||(t=rfe);function e(M,k){return M&&k?t(M.__data__,k.__data__):!M-!k}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var l=n[s],o=l.length,p=i[s]=new Array(o),_,C=0;C<o;++C)(_=l[C])&&(p[C]=_);p.sort(e)}return new mA(i,this._parents).order()}function rfe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ife(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function sfe(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function ofe(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var l=r[i];if(l)return l}return null}function afe(){var t=0;return this.each(function(){++t}),t}function lfe(){return!this.node()}function Afe(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,l=i.length,o;s<l;++s)(o=i[s])&&t.call(o,o.__data__,s,i);return this}function ufe(t){return function(){this.removeAttribute(t)}}function cfe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function hfe(t,e){return function(){this.setAttribute(t,e)}}function ffe(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function dfe(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function pfe(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function gfe(t,e){var n=Lv(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?cfe:ufe:typeof e=="function"?n.local?pfe:dfe:n.local?ffe:hfe)(n,e))}function LF(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function mfe(t){return function(){this.style.removeProperty(t)}}function yfe(t,e,n){return function(){this.style.setProperty(t,e,n)}}function _fe(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function vfe(t,e,n){return arguments.length>1?this.each((e==null?mfe:typeof e=="function"?_fe:yfe)(t,e,n??"")):Dd(this.node(),t)}function Dd(t,e){return t.style.getPropertyValue(e)||LF(t).getComputedStyle(t,null).getPropertyValue(e)}function xfe(t){return function(){delete this[t]}}function wfe(t,e){return function(){this[t]=e}}function bfe(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Efe(t,e){return arguments.length>1?this.each((e==null?xfe:typeof e=="function"?bfe:wfe)(t,e)):this.node()[t]}function DF(t){return t.trim().split(/^|\s+/)}function l4(t){return t.classList||new RF(t)}function RF(t){this._node=t,this._names=DF(t.getAttribute("class")||"")}RF.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function BF(t,e){for(var n=l4(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function zF(t,e){for(var n=l4(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Tfe(t){return function(){BF(this,t)}}function Sfe(t){return function(){zF(this,t)}}function Cfe(t,e){return function(){(e.apply(this,arguments)?BF:zF)(this,t)}}function Mfe(t,e){var n=DF(t+"");if(arguments.length<2){for(var r=l4(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Cfe:e?Tfe:Sfe)(n,e))}function Pfe(){this.textContent=""}function kfe(t){return function(){this.textContent=t}}function Ife(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Lfe(t){return arguments.length?this.each(t==null?Pfe:(typeof t=="function"?Ife:kfe)(t)):this.node().textContent}function Dfe(){this.innerHTML=""}function Rfe(t){return function(){this.innerHTML=t}}function Bfe(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function zfe(t){return arguments.length?this.each(t==null?Dfe:(typeof t=="function"?Bfe:Rfe)(t)):this.node().innerHTML}function Ofe(){this.nextSibling&&this.parentNode.appendChild(this)}function Ffe(){return this.each(Ofe)}function Nfe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ufe(){return this.each(Nfe)}function Vfe(t){var e=typeof t=="function"?t:MF(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Gfe(){return null}function $fe(t,e){var n=typeof t=="function"?t:MF(t),r=e==null?Gfe:typeof e=="function"?e:a4(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function jfe(){var t=this.parentNode;t&&t.removeChild(this)}function Hfe(){return this.each(jfe)}function Wfe(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Qfe(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function qfe(t){return this.select(t?Qfe:Wfe)}function Zfe(t){return arguments.length?this.property("__data__",t):this.node().__data__}var OF={};if(typeof document<"u"){var Yfe=document.documentElement;"onmouseenter"in Yfe||(OF={mouseenter:"mouseover",mouseleave:"mouseout"})}function Xfe(t,e,n){return t=FF(t,e,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&t.call(this,r)}}function FF(t,e,n){return function(r){try{t.call(this,this.__data__,e,n)}finally{}}}function Kfe(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Jfe(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.capture):e[++r]=s;++r?e.length=r:delete this.__on}}}function e0e(t,e,n){var r=OF.hasOwnProperty(t.type)?Xfe:FF;return function(i,s,l){var o=this.__on,p,_=r(e,s,l);if(o){for(var C=0,M=o.length;C<M;++C)if((p=o[C]).type===t.type&&p.name===t.name){this.removeEventListener(p.type,p.listener,p.capture),this.addEventListener(p.type,p.listener=_,p.capture=n),p.value=e;return}}this.addEventListener(t.type,_,n),p={type:t.type,name:t.name,value:e,listener:_,capture:n},o?o.push(p):this.__on=[p]}}function t0e(t,e,n){var r=Kfe(t+""),i,s=r.length,l;if(arguments.length<2){var o=this.node().__on;if(o){for(var p=0,_=o.length,C;p<_;++p)for(i=0,C=o[p];i<s;++i)if((l=r[i]).type===C.type&&l.name===C.name)return C.value}return}for(o=e?e0e:Jfe,n==null&&(n=!1),i=0;i<s;++i)this.each(o(r[i],e,n));return this}function NF(t,e,n){var r=LF(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function n0e(t,e){return function(){return NF(this,t,e)}}function r0e(t,e){return function(){return NF(this,t,e.apply(this,arguments))}}function i0e(t,e){return this.each((typeof e=="function"?r0e:n0e)(t,e))}var s0e=[null];function mA(t,e){this._groups=t,this._parents=e}function Qm(){return new mA([[document.documentElement]],s0e)}mA.prototype=Qm.prototype={constructor:mA,select:$he,selectAll:Hhe,filter:Whe,data:Xhe,enter:Qhe,exit:Khe,join:Jhe,merge:efe,order:tfe,sort:nfe,call:ife,nodes:sfe,node:ofe,size:afe,empty:lfe,each:Afe,attr:gfe,style:vfe,property:Efe,classed:Mfe,text:Lfe,html:zfe,raise:Ffe,lower:Ufe,append:Vfe,insert:$fe,remove:Hfe,clone:qfe,datum:Zfe,on:t0e,dispatch:i0e};function qm(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Dv(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Zf(){}var fm=.7,b2=1/fm,ld="\\s*([+-]?\\d+)\\s*",dm="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",nu="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",o0e=/^#([0-9a-f]{3,8})$/,a0e=new RegExp("^rgb\\("+[ld,ld,ld]+"\\)$"),l0e=new RegExp("^rgb\\("+[nu,nu,nu]+"\\)$"),A0e=new RegExp("^rgba\\("+[ld,ld,ld,dm]+"\\)$"),u0e=new RegExp("^rgba\\("+[nu,nu,nu,dm]+"\\)$"),c0e=new RegExp("^hsl\\("+[dm,nu,nu]+"\\)$"),h0e=new RegExp("^hsla\\("+[dm,nu,nu,dm]+"\\)$"),R6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qm(Zf,kf,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:B6,formatHex:B6,formatHsl:f0e,formatRgb:z6,toString:z6});function B6(){return this.rgb().formatHex()}function f0e(){return VF(this).formatHsl()}function z6(){return this.rgb().formatRgb()}function kf(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=o0e.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?O6(e):n===3?new Fo(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?_y(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?_y(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=a0e.exec(t))?new Fo(e[1],e[2],e[3],1):(e=l0e.exec(t))?new Fo(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=A0e.exec(t))?_y(e[1],e[2],e[3],e[4]):(e=u0e.exec(t))?_y(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=c0e.exec(t))?U6(e[1],e[2]/100,e[3]/100,1):(e=h0e.exec(t))?U6(e[1],e[2]/100,e[3]/100,e[4]):R6.hasOwnProperty(t)?O6(R6[t]):t==="transparent"?new Fo(NaN,NaN,NaN,0):null}function O6(t){return new Fo(t>>16&255,t>>8&255,t&255,1)}function _y(t,e,n,r){return r<=0&&(t=e=n=NaN),new Fo(t,e,n,r)}function UF(t){return t instanceof Zf||(t=kf(t)),t?(t=t.rgb(),new Fo(t.r,t.g,t.b,t.opacity)):new Fo}function CE(t,e,n,r){return arguments.length===1?UF(t):new Fo(t,e,n,r??1)}function Fo(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}qm(Fo,CE,Dv(Zf,{brighter:function(t){return t=t==null?b2:Math.pow(b2,t),new Fo(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?fm:Math.pow(fm,t),new Fo(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:F6,formatHex:F6,formatRgb:N6,toString:N6}));function F6(){return"#"+ub(this.r)+ub(this.g)+ub(this.b)}function N6(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function ub(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function U6(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ZA(t,e,n,r)}function VF(t){if(t instanceof ZA)return new ZA(t.h,t.s,t.l,t.opacity);if(t instanceof Zf||(t=kf(t)),!t)return new ZA;if(t instanceof ZA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),l=NaN,o=s-i,p=(s+i)/2;return o?(e===s?l=(n-r)/o+(n<r)*6:n===s?l=(r-e)/o+2:l=(e-n)/o+4,o/=p<.5?s+i:2-s-i,l*=60):o=p>0&&p<1?0:l,new ZA(l,o,p,t.opacity)}function ME(t,e,n,r){return arguments.length===1?VF(t):new ZA(t,e,n,r??1)}function ZA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}qm(ZA,ME,Dv(Zf,{brighter:function(t){return t=t==null?b2:Math.pow(b2,t),new ZA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?fm:Math.pow(fm,t),new ZA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Fo(cb(t>=240?t-240:t+120,i,r),cb(t,i,r),cb(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function cb(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}var d0e=Math.PI/180,p0e=180/Math.PI,E2=18,GF=.96422,$F=1,jF=.82521,HF=4/29,Ad=6/29,WF=3*Ad*Ad,g0e=Ad*Ad*Ad;function QF(t){if(t instanceof ru)return new ru(t.l,t.a,t.b,t.opacity);if(t instanceof Xu)return qF(t);t instanceof Fo||(t=UF(t));var e=pb(t.r),n=pb(t.g),r=pb(t.b),i=hb((.2225045*e+.7168786*n+.0606169*r)/$F),s,l;return e===n&&n===r?s=l=i:(s=hb((.4360747*e+.3850649*n+.1430804*r)/GF),l=hb((.0139322*e+.0971045*n+.7141733*r)/jF)),new ru(116*i-16,500*(s-i),200*(i-l),t.opacity)}function pm(t,e,n,r){return arguments.length===1?QF(t):new ru(t,e,n,r??1)}function ru(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}qm(ru,pm,Dv(Zf,{brighter:function(t){return new ru(this.l+E2*(t??1),this.a,this.b,this.opacity)},darker:function(t){return new ru(this.l-E2*(t??1),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=GF*fb(e),t=$F*fb(t),n=jF*fb(n),new Fo(db(3.1338561*e-1.6168667*t-.4906146*n),db(-.9787684*e+1.9161415*t+.033454*n),db(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function hb(t){return t>g0e?Math.pow(t,1/3):t/WF+HF}function fb(t){return t>Ad?t*t*t:WF*(t-HF)}function db(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function pb(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function m0e(t){if(t instanceof Xu)return new Xu(t.h,t.c,t.l,t.opacity);if(t instanceof ru||(t=QF(t)),t.a===0&&t.b===0)return new Xu(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*p0e;return new Xu(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function y0e(t,e,n,r){return arguments.length===1?m0e(t):new Xu(t,e,n,r??1)}function Xu(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function qF(t){if(isNaN(t.h))return new ru(t.l,0,0,t.opacity);var e=t.h*d0e;return new ru(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}qm(Xu,y0e,Dv(Zf,{brighter:function(t){return new Xu(this.h,this.c,this.l+E2*(t??1),this.opacity)},darker:function(t){return new Xu(this.h,this.c,this.l-E2*(t??1),this.opacity)},rgb:function(){return qF(this).rgb()}}));function ZF(t){return function(){return t}}function _0e(t,e){return function(n){return t+n*e}}function v0e(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function x0e(t){return(t=+t)==1?H0:function(e,n){return n-e?v0e(e,n,t):ZF(isNaN(e)?n:e)}}function H0(t,e){var n=e-t;return n?_0e(t,n):ZF(isNaN(t)?e:t)}const V6=function t(e){var n=x0e(e);function r(i,s){var l=n((i=CE(i)).r,(s=CE(s)).r),o=n(i.g,s.g),p=n(i.b,s.b),_=H0(i.opacity,s.opacity);return function(C){return i.r=l(C),i.g=o(C),i.b=p(C),i.opacity=_(C),i+""}}return r.gamma=t,r}(1);function Zc(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var PE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gb=new RegExp(PE.source,"g");function w0e(t){return function(){return t}}function b0e(t){return function(e){return t(e)+""}}function E0e(t,e){var n=PE.lastIndex=gb.lastIndex=0,r,i,s,l=-1,o=[],p=[];for(t=t+"",e=e+"";(r=PE.exec(t))&&(i=gb.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[l]?o[l]+=s:o[++l]=s),(r=r[0])===(i=i[0])?o[l]?o[l]+=i:o[++l]=i:(o[++l]=null,p.push({i:l,x:Zc(r,i)})),n=gb.lastIndex;return n<e.length&&(s=e.slice(n),o[l]?o[l]+=s:o[++l]=s),o.length<2?p[0]?b0e(p[0].x):w0e(e):(e=p.length,function(_){for(var C=0,M;C<e;++C)o[(M=p[C]).i]=M.x(_);return o.join("")})}var G6=180/Math.PI,kE={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function YF(t,e,n,r,i,s){var l,o,p;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(p=t*n+e*r)&&(n-=t*p,r-=e*p),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,p/=o),t*r<e*n&&(t=-t,e=-e,p=-p,l=-l),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*G6,skewX:Math.atan(p)*G6,scaleX:l,scaleY:o}}var Gp,mb,$6,vy;function T0e(t){return t==="none"?kE:(Gp||(Gp=document.createElement("DIV"),mb=document.documentElement,$6=document.defaultView),Gp.style.transform=t,t=$6.getComputedStyle(mb.appendChild(Gp),null).getPropertyValue("transform"),mb.removeChild(Gp),t=t.slice(7,-1).split(","),YF(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function S0e(t){return t==null||(vy||(vy=document.createElementNS("http://www.w3.org/2000/svg","g")),vy.setAttribute("transform",t),!(t=vy.transform.baseVal.consolidate()))?kE:(t=t.matrix,YF(t.a,t.b,t.c,t.d,t.e,t.f))}function XF(t,e,n,r){function i(_){return _.length?_.pop()+" ":""}function s(_,C,M,k,F,j){if(_!==M||C!==k){var H=F.push("translate(",null,e,null,n);j.push({i:H-4,x:Zc(_,M)},{i:H-2,x:Zc(C,k)})}else(M||k)&&F.push("translate("+M+e+k+n)}function l(_,C,M,k){_!==C?(_-C>180?C+=360:C-_>180&&(_+=360),k.push({i:M.push(i(M)+"rotate(",null,r)-2,x:Zc(_,C)})):C&&M.push(i(M)+"rotate("+C+r)}function o(_,C,M,k){_!==C?k.push({i:M.push(i(M)+"skewX(",null,r)-2,x:Zc(_,C)}):C&&M.push(i(M)+"skewX("+C+r)}function p(_,C,M,k,F,j){if(_!==M||C!==k){var H=F.push(i(F)+"scale(",null,",",null,")");j.push({i:H-4,x:Zc(_,M)},{i:H-2,x:Zc(C,k)})}else(M!==1||k!==1)&&F.push(i(F)+"scale("+M+","+k+")")}return function(_,C){var M=[],k=[];return _=t(_),C=t(C),s(_.translateX,_.translateY,C.translateX,C.translateY,M,k),l(_.rotate,C.rotate,M,k),o(_.skewX,C.skewX,M,k),p(_.scaleX,_.scaleY,C.scaleX,C.scaleY,M,k),_=C=null,function(F){for(var j=-1,H=k.length,ie;++j<H;)M[(ie=k[j]).i]=ie.x(F);return M.join("")}}}var C0e=XF(T0e,"px, ","px)","deg)"),M0e=XF(S0e,", ",")",")");function P0e(t,e){var n=H0((t=pm(t)).l,(e=pm(e)).l),r=H0(t.a,e.a),i=H0(t.b,e.b),s=H0(t.opacity,e.opacity);return function(l){return t.l=n(l),t.a=r(l),t.b=i(l),t.opacity=s(l),t+""}}var Rd=0,lg=0,$p=0,KF=1e3,T2,Ag,S2=0,If=0,Rv=0,gm=typeof performance=="object"&&performance.now?performance:Date,JF=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Bv(){return If||(JF(k0e),If=gm.now()+Rv)}function k0e(){If=0}function C2(){this._call=this._time=this._next=null}C2.prototype=e7.prototype={constructor:C2,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Bv():+n)+(e==null?0:+e),!this._next&&Ag!==this&&(Ag?Ag._next=this:T2=this,Ag=this),this._call=t,this._time=n,IE()},stop:function(){this._call&&(this._call=null,this._time=1/0,IE())}};function e7(t,e,n){var r=new C2;return r.restart(t,e,n),r}function I0e(){Bv(),++Rd;for(var t=T2,e;t;)(e=If-t._time)>=0&&t._call.call(null,e),t=t._next;--Rd}function j6(){If=(S2=gm.now())+Rv,Rd=lg=0;try{I0e()}finally{Rd=0,D0e(),If=0}}function L0e(){var t=gm.now(),e=t-S2;e>KF&&(Rv-=e,S2=t)}function D0e(){for(var t,e=T2,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:T2=n);Ag=t,IE(r)}function IE(t){if(!Rd){lg&&(lg=clearTimeout(lg));var e=t-If;e>24?(t<1/0&&(lg=setTimeout(j6,t-gm.now()-Rv)),$p&&($p=clearInterval($p))):($p||(S2=gm.now(),$p=setInterval(L0e,KF)),Rd=1,JF(j6))}}function H6(t,e,n){var r=new C2;return e=e==null?0:+e,r.restart(function(i){r.stop(),t(i+e)},e,n),r}var R0e=CF("start","end","cancel","interrupt"),B0e=[],t7=0,W6=1,LE=2,a_=3,Q6=4,DE=5,l_=6;function zv(t,e,n,r,i,s){var l=t.__transition;if(!l)t.__transition={};else if(n in l)return;z0e(t,n,{name:e,index:r,group:i,on:R0e,tween:B0e,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:t7})}function A4(t,e){var n=wA(t,e);if(n.state>t7)throw new Error("too late; already scheduled");return n}function vc(t,e){var n=wA(t,e);if(n.state>a_)throw new Error("too late; already running");return n}function wA(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function z0e(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=e7(s,0,n.time);function s(_){n.state=W6,n.timer.restart(l,n.delay,n.time),n.delay<=_&&l(_-n.delay)}function l(_){var C,M,k,F;if(n.state!==W6)return p();for(C in r)if(F=r[C],F.name===n.name){if(F.state===a_)return H6(l);F.state===Q6?(F.state=l_,F.timer.stop(),F.on.call("interrupt",t,t.__data__,F.index,F.group),delete r[C]):+C<e&&(F.state=l_,F.timer.stop(),F.on.call("cancel",t,t.__data__,F.index,F.group),delete r[C])}if(H6(function(){n.state===a_&&(n.state=Q6,n.timer.restart(o,n.delay,n.time),o(_))}),n.state=LE,n.on.call("start",t,t.__data__,n.index,n.group),n.state===LE){for(n.state=a_,i=new Array(k=n.tween.length),C=0,M=-1;C<k;++C)(F=n.tween[C].value.call(t,t.__data__,n.index,n.group))&&(i[++M]=F);i.length=M+1}}function o(_){for(var C=_<n.duration?n.ease.call(null,_/n.duration):(n.timer.restart(p),n.state=DE,1),M=-1,k=i.length;++M<k;)i[M].call(t,C);n.state===DE&&(n.on.call("end",t,t.__data__,n.index,n.group),p())}function p(){n.state=l_,n.timer.stop(),delete r[e];for(var _ in r)return;delete t.__transition}}function O0e(t,e){var n=t.__transition,r,i,s=!0,l;if(n){e=e==null?null:e+"";for(l in n){if((r=n[l]).name!==e){s=!1;continue}i=r.state>LE&&r.state<DE,r.state=l_,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[l]}s&&delete t.__transition}}function F0e(t){return this.each(function(){O0e(this,t)})}function N0e(t,e){var n,r;return function(){var i=vc(this,t),s=i.tween;if(s!==n){r=n=s;for(var l=0,o=r.length;l<o;++l)if(r[l].name===e){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function U0e(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=vc(this,t),l=s.tween;if(l!==r){i=(r=l).slice();for(var o={name:e,value:n},p=0,_=i.length;p<_;++p)if(i[p].name===e){i[p]=o;break}p===_&&i.push(o)}s.tween=i}}function V0e(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=wA(this.node(),n).tween,i=0,s=r.length,l;i<s;++i)if((l=r[i]).name===t)return l.value;return null}return this.each((e==null?N0e:U0e)(n,t,e))}function u4(t,e,n){var r=t._id;return t.each(function(){var i=vc(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return wA(i,r).value[e]}}function n7(t,e){var n;return(typeof e=="number"?Zc:e instanceof kf?V6:(n=kf(e))?(e=n,V6):E0e)(t,e)}function G0e(t){return function(){this.removeAttribute(t)}}function $0e(t){return function(){this.removeAttributeNS(t.space,t.local)}}function j0e(t,e,n){var r,i=n+"",s;return function(){var l=this.getAttribute(t);return l===i?null:l===r?s:s=e(r=l,n)}}function H0e(t,e,n){var r,i=n+"",s;return function(){var l=this.getAttributeNS(t.space,t.local);return l===i?null:l===r?s:s=e(r=l,n)}}function W0e(t,e,n){var r,i,s;return function(){var l,o=n(this),p;return o==null?void this.removeAttribute(t):(l=this.getAttribute(t),p=o+"",l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o)))}}function Q0e(t,e,n){var r,i,s;return function(){var l,o=n(this),p;return o==null?void this.removeAttributeNS(t.space,t.local):(l=this.getAttributeNS(t.space,t.local),p=o+"",l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o)))}}function q0e(t,e){var n=Lv(t),r=n==="transform"?M0e:n7;return this.attrTween(t,typeof e=="function"?(n.local?Q0e:W0e)(n,r,u4(this,"attr."+t,e)):e==null?(n.local?$0e:G0e)(n):(n.local?H0e:j0e)(n,r,e))}function Z0e(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Y0e(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function X0e(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&Y0e(t,s)),n}return i._value=e,i}function K0e(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&Z0e(t,s)),n}return i._value=e,i}function J0e(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Lv(t);return this.tween(n,(r.local?X0e:K0e)(r,e))}function ede(t,e){return function(){A4(this,t).delay=+e.apply(this,arguments)}}function tde(t,e){return e=+e,function(){A4(this,t).delay=e}}function nde(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?ede:tde)(e,t)):wA(this.node(),e).delay}function rde(t,e){return function(){vc(this,t).duration=+e.apply(this,arguments)}}function ide(t,e){return e=+e,function(){vc(this,t).duration=e}}function sde(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?rde:ide)(e,t)):wA(this.node(),e).duration}function ode(t,e){if(typeof e!="function")throw new Error;return function(){vc(this,t).ease=e}}function ade(t){var e=this._id;return arguments.length?this.each(ode(e,t)):wA(this.node(),e).ease}function lde(t){typeof t!="function"&&(t=kF(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=[],p,_=0;_<l;++_)(p=s[_])&&t.call(p,p.__data__,_,s)&&o.push(p);return new gc(r,this._parents,this._name,this._id)}function Ade(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),l=new Array(r),o=0;o<s;++o)for(var p=e[o],_=n[o],C=p.length,M=l[o]=new Array(C),k,F=0;F<C;++F)(k=p[F]||_[F])&&(M[F]=k);for(;o<r;++o)l[o]=e[o];return new gc(l,this._parents,this._name,this._id)}function ude(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function cde(t,e,n){var r,i,s=ude(e)?A4:vc;return function(){var l=s(this,t),o=l.on;o!==r&&(i=(r=o).copy()).on(e,n),l.on=i}}function hde(t,e){var n=this._id;return arguments.length<2?wA(this.node(),n).on.on(t):this.each(cde(n,t,e))}function fde(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function dde(){return this.on("end.remove",fde(this._id))}function pde(t){var e=this._name,n=this._id;typeof t!="function"&&(t=a4(t));for(var r=this._groups,i=r.length,s=new Array(i),l=0;l<i;++l)for(var o=r[l],p=o.length,_=s[l]=new Array(p),C,M,k=0;k<p;++k)(C=o[k])&&(M=t.call(C,C.__data__,k,o))&&("__data__"in C&&(M.__data__=C.__data__),_[k]=M,zv(_[k],e,n,k,_,wA(C,n)));return new gc(s,this._parents,e,n)}function gde(t){var e=this._name,n=this._id;typeof t!="function"&&(t=PF(t));for(var r=this._groups,i=r.length,s=[],l=[],o=0;o<i;++o)for(var p=r[o],_=p.length,C,M=0;M<_;++M)if(C=p[M]){for(var k=t.call(C,C.__data__,M,p),F,j=wA(C,n),H=0,ie=k.length;H<ie;++H)(F=k[H])&&zv(F,e,n,H,k,j);s.push(k),l.push(C)}return new gc(s,l,e,n)}var mde=Qm.prototype.constructor;function yde(){return new mde(this._groups,this._parents)}function _de(t,e){var n,r,i;return function(){var s=Dd(this,t),l=(this.style.removeProperty(t),Dd(this,t));return s===l?null:s===n&&l===r?i:i=e(n=s,r=l)}}function r7(t){return function(){this.style.removeProperty(t)}}function vde(t,e,n){var r,i=n+"",s;return function(){var l=Dd(this,t);return l===i?null:l===r?s:s=e(r=l,n)}}function xde(t,e,n){var r,i,s;return function(){var l=Dd(this,t),o=n(this),p=o+"";return o==null&&(p=o=(this.style.removeProperty(t),Dd(this,t))),l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o))}}function wde(t,e){var n,r,i,s="style."+e,l="end."+s,o;return function(){var p=vc(this,t),_=p.on,C=p.value[s]==null?o||(o=r7(e)):void 0;(_!==n||i!==C)&&(r=(n=_).copy()).on(l,i=C),p.on=r}}function bde(t,e,n){var r=(t+="")=="transform"?C0e:n7;return e==null?this.styleTween(t,_de(t,r)).on("end.style."+t,r7(t)):typeof e=="function"?this.styleTween(t,xde(t,r,u4(this,"style."+t,e))).each(wde(this._id,t)):this.styleTween(t,vde(t,r,e),n).on("end.style."+t,null)}function Ede(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Tde(t,e,n){var r,i;function s(){var l=e.apply(this,arguments);return l!==i&&(r=(i=l)&&Ede(t,l,n)),r}return s._value=e,s}function Sde(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Tde(t,e,n??""))}function Cde(t){return function(){this.textContent=t}}function Mde(t){return function(){var e=t(this);this.textContent=e??""}}function Pde(t){return this.tween("text",typeof t=="function"?Mde(u4(this,"text",t)):Cde(t==null?"":t+""))}function kde(t){return function(e){this.textContent=t.call(this,e)}}function Ide(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&kde(i)),e}return r._value=t,r}function Lde(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Ide(t))}function Dde(){for(var t=this._name,e=this._id,n=i7(),r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],o=l.length,p,_=0;_<o;++_)if(p=l[_]){var C=wA(p,e);zv(p,t,n,_,l,{time:C.time+C.delay+C.duration,delay:0,duration:C.duration,ease:C.ease})}return new gc(r,this._parents,t,n)}function Rde(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,l){var o={value:l},p={value:function(){--i===0&&s()}};n.each(function(){var _=vc(this,r),C=_.on;C!==t&&(e=(t=C).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(p)),_.on=e})})}var Bde=0;function gc(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function i7(){return++Bde}var v0=Qm.prototype;gc.prototype={constructor:gc,select:pde,selectAll:gde,filter:lde,merge:Ade,selection:yde,transition:Dde,call:v0.call,nodes:v0.nodes,node:v0.node,size:v0.size,empty:v0.empty,each:v0.each,on:hde,attr:q0e,attrTween:J0e,style:bde,styleTween:Sde,text:Pde,textTween:Lde,remove:dde,tween:V0e,delay:nde,duration:sde,ease:ade,end:Rde};function zde(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var RE={time:null,delay:0,duration:250,ease:zde};function Ode(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return RE.time=Bv(),RE;return n}function Fde(t){var e,n;t instanceof gc?(e=t._id,t=t._name):(e=i7(),(n=RE).time=Bv(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],o=l.length,p,_=0;_<o;++_)(p=l[_])&&zv(p,t,e,_,l,n||Ode(p,e));return new gc(r,this._parents,t,e)}Qm.prototype.interrupt=F0e;Qm.prototype.transition=Fde;var BE=Math.PI,zE=2*BE,ef=1e-6,Nde=zE-ef;function OE(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function s7(){return new OE}OE.prototype=s7.prototype={constructor:OE,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var s=this._x1,l=this._y1,o=n-t,p=r-e,_=s-t,C=l-e,M=_*_+C*C;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(M>ef)if(!(Math.abs(C*o-p*_)>ef)||!i)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var k=n-s,F=r-l,j=o*o+p*p,H=k*k+F*F,ie=Math.sqrt(j),Y=Math.sqrt(M),J=i*Math.tan((BE-Math.acos((j+M-H)/(2*ie*Y)))/2),se=J/Y,he=J/ie;Math.abs(se-1)>ef&&(this._+="L"+(t+se*_)+","+(e+se*C)),this._+="A"+i+","+i+",0,0,"+ +(C*k>_*F)+","+(this._x1=t+he*o)+","+(this._y1=e+he*p)}},arc:function(t,e,n,r,i,s){t=+t,e=+e,n=+n,s=!!s;var l=n*Math.cos(r),o=n*Math.sin(r),p=t+l,_=e+o,C=1^s,M=s?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+p+","+_:(Math.abs(this._x1-p)>ef||Math.abs(this._y1-_)>ef)&&(this._+="L"+p+","+_),n&&(M<0&&(M=M%zE+zE),M>Nde?this._+="A"+n+","+n+",0,1,"+C+","+(t-l)+","+(e-o)+"A"+n+","+n+",0,1,"+C+","+(this._x1=p)+","+(this._y1=_):M>ef&&(this._+="A"+n+","+n+",0,"+ +(M>=BE)+","+C+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var hl="$";function M2(){}M2.prototype=P2.prototype={constructor:M2,has:function(t){return hl+t in this},get:function(t){return this[hl+t]},set:function(t,e){return this[hl+t]=e,this},remove:function(t){var e=hl+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===hl&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===hl&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===hl&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===hl&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===hl&&++t;return t},empty:function(){for(var t in this)if(t[0]===hl)return!1;return!0},each:function(t){for(var e in this)e[0]===hl&&t(this[e],e.slice(1),this)}};function P2(t,e){var n=new M2;if(t instanceof M2)t.each(function(o,p){n.set(p,o)});else if(Array.isArray(t)){var r=-1,i=t.length,s;if(e==null)for(;++r<i;)n.set(r,t[r]);else for(;++r<i;)n.set(e(s=t[r],r,t),s)}else if(t)for(var l in t)n.set(l,t[l]);return n}function q6(){}var Wh=P2.prototype;q6.prototype={constructor:q6,has:Wh.has,add:function(t){return t+="",this[hl+t]=t,this},remove:Wh.remove,clear:Wh.clear,values:Wh.keys,size:Wh.size,empty:Wh.empty,each:Wh.each};function Ude(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function k2(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Vde(t){return t=k2(Math.abs(t)),t?t[1]:NaN}function Gde(t,e){return function(n,r){for(var i=n.length,s=[],l=0,o=t[0],p=0;i>0&&o>0&&(p+o+1>r&&(o=Math.max(1,r-p)),s.push(n.substring(i-=o,i+o)),!((p+=o+1)>r));)o=t[l=(l+1)%t.length];return s.reverse().join(e)}}function $de(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var jde=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function FE(t){if(!(e=jde.exec(t)))throw new Error("invalid format: "+t);var e;return new c4({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}FE.prototype=c4.prototype;function c4(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}c4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Hde(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var o7;function Wde(t,e){var n=k2(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(o7=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+k2(t,Math.max(0,e+s-1))[0]}function Z6(t,e){var n=k2(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Y6={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:Ude,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Z6(t*100,e)},r:Z6,s:Wde,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function X6(t){return t}var K6=Array.prototype.map,J6=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Qde(t){var e=t.grouping===void 0||t.thousands===void 0?X6:Gde(K6.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?X6:$de(K6.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"-":t.minus+"",p=t.nan===void 0?"NaN":t.nan+"";function _(M){M=FE(M);var k=M.fill,F=M.align,j=M.sign,H=M.symbol,ie=M.zero,Y=M.width,J=M.comma,se=M.precision,he=M.trim,pe=M.type;pe==="n"?(J=!0,pe="g"):Y6[pe]||(se===void 0&&(se=12),he=!0,pe="g"),(ie||k==="0"&&F==="=")&&(ie=!0,k="0",F="=");var be=H==="$"?n:H==="#"&&/[boxX]/.test(pe)?"0"+pe.toLowerCase():"",Ge=H==="$"?r:/[%p]/.test(pe)?l:"",We=Y6[pe],Xe=/[defgprs%]/.test(pe);se=se===void 0?6:/[gprs]/.test(pe)?Math.max(1,Math.min(21,se)):Math.max(0,Math.min(20,se));function rt(Oe){var nt=be,Ze=Ge,pt,Yt,Et;if(pe==="c")Ze=We(Oe)+Ze,Oe="";else{Oe=+Oe;var un=Oe<0||1/Oe<0;if(Oe=isNaN(Oe)?p:We(Math.abs(Oe),se),he&&(Oe=Hde(Oe)),un&&+Oe==0&&j!=="+"&&(un=!1),nt=(un?j==="("?j:o:j==="-"||j==="("?"":j)+nt,Ze=(pe==="s"?J6[8+o7/3]:"")+Ze+(un&&j==="("?")":""),Xe){for(pt=-1,Yt=Oe.length;++pt<Yt;)if(Et=Oe.charCodeAt(pt),48>Et||Et>57){Ze=(Et===46?i+Oe.slice(pt+1):Oe.slice(pt))+Ze,Oe=Oe.slice(0,pt);break}}}J&&!ie&&(Oe=e(Oe,1/0));var _t=nt.length+Oe.length+Ze.length,Tt=_t<Y?new Array(Y-_t+1).join(k):"";switch(J&&ie&&(Oe=e(Tt+Oe,Tt.length?Y-Ze.length:1/0),Tt=""),F){case"<":Oe=nt+Oe+Ze+Tt;break;case"=":Oe=nt+Tt+Oe+Ze;break;case"^":Oe=Tt.slice(0,_t=Tt.length>>1)+nt+Oe+Ze+Tt.slice(_t);break;default:Oe=Tt+nt+Oe+Ze;break}return s(Oe)}return rt.toString=function(){return M+""},rt}function C(M,k){var F=_((M=FE(M),M.type="f",M)),j=Math.max(-8,Math.min(8,Math.floor(Vde(k)/3)))*3,H=Math.pow(10,-j),ie=J6[8+j/3];return function(Y){return F(H*Y)+ie}}return{format:_,formatPrefix:C}}var xy,Bd;qde({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function qde(t){return xy=Qde(t),Bd=xy.format,xy.formatPrefix,xy}function Yd(){return Math.random()}(function t(e){function n(r,i){return r=r==null?0:+r,i=i==null?1:+i,arguments.length===1?(i=r,r=0):i-=r,function(){return e()*i+r}}return n.source=t,n})(Yd);const Zde=function t(e){function n(r,i){var s,l;return r=r==null?0:+r,i=i==null?1:+i,function(){var o;if(s!=null)o=s,s=null;else do s=e()*2-1,o=e()*2-1,l=s*s+o*o;while(!l||l>1);return r+i*o*Math.sqrt(-2*Math.log(l)/l)}}return n.source=t,n}(Yd);(function t(e){function n(){var r=Zde.source(e).apply(this,arguments);return function(){return Math.exp(r())}}return n.source=t,n})(Yd);const Yde=function t(e){function n(r){return function(){for(var i=0,s=0;s<r;++s)i+=e();return i}}return n.source=t,n}(Yd);(function t(e){function n(r){var i=Yde.source(e)(r);return function(){return i()/r}}return n.source=t,n})(Yd);(function t(e){function n(r){return function(){return-Math.log(1-e())/r}}return n.source=t,n})(Yd);function a7(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Xde(t){return t.length===1&&(t=Kde(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}function Kde(t){return function(e,n){return a7(t(e),n)}}var Jde=Xde(a7),epe=Jde.right;function tpe(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var NE=Math.sqrt(50),UE=Math.sqrt(10),VE=Math.sqrt(2);function npe(t,e,n){var r,i=-1,s,l,o;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(s=t,t=e,e=s),(o=A_(t,e,n))===0||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),l=new Array(s=Math.ceil(e-t+1));++i<s;)l[i]=(t+i)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),l=new Array(s=Math.ceil(t-e+1));++i<s;)l[i]=(t-i)/o;return r&&l.reverse(),l}function A_(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,i);return i>=0?(s>=NE?10:s>=UE?5:s>=VE?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=NE?10:s>=UE?5:s>=VE?2:1)}function rpe(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=NE?i*=10:s>=UE?i*=5:s>=VE&&(i*=2),e<t?-i:i}function h4(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var l7=Array.prototype,ipe=l7.map,GE=l7.slice,e8={name:"implicit"};function A7(){var t=P2(),e=[],n=[],r=e8;function i(s){var l=s+"",o=t.get(l);if(!o){if(r!==e8)return r;t.set(l,o=e.push(s))}return n[(o-1)%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=P2();for(var l=-1,o=s.length,p,_;++l<o;)t.has(_=(p=s[l])+"")||t.set(_,e.push(p));return i},i.range=function(s){return arguments.length?(n=GE.call(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return A7(e,n).unknown(r)},h4.apply(i,arguments),i}function u7(){var t=A7().unknown(void 0),e=t.domain,n=t.range,r=[0,1],i,s,l=!1,o=0,p=0,_=.5;delete t.unknown;function C(){var M=e().length,k=r[1]<r[0],F=r[k-0],j=r[1-k];i=(j-F)/Math.max(1,M-o+p*2),l&&(i=Math.floor(i)),F+=(j-F-i*(M-o))*_,s=i*(1-o),l&&(F=Math.round(F),s=Math.round(s));var H=tpe(M).map(function(ie){return F+i*ie});return n(k?H.reverse():H)}return t.domain=function(M){return arguments.length?(e(M),C()):e()},t.range=function(M){return arguments.length?(r=[+M[0],+M[1]],C()):r.slice()},t.rangeRound=function(M){return r=[+M[0],+M[1]],l=!0,C()},t.bandwidth=function(){return s},t.step=function(){return i},t.round=function(M){return arguments.length?(l=!!M,C()):l},t.padding=function(M){return arguments.length?(o=Math.min(1,p=+M),C()):o},t.paddingInner=function(M){return arguments.length?(o=Math.min(1,M),C()):o},t.paddingOuter=function(M){return arguments.length?(p=+M,C()):p},t.align=function(M){return arguments.length?(_=Math.max(0,Math.min(1,M)),C()):_},t.copy=function(){return u7(e(),r).round(l).paddingInner(o).paddingOuter(p).align(_)},h4.apply(C(),arguments)}function c7(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return c7(e())},t}function I2(){return c7(u7.apply(null,arguments).paddingInner(1))}function f4(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function h7(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Zm(){}var mm=.7,L2=1/mm,ud="\\s*([+-]?\\d+)\\s*",ym="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",iu="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",spe=/^#([0-9a-f]{3,8})$/,ope=new RegExp("^rgb\\("+[ud,ud,ud]+"\\)$"),ape=new RegExp("^rgb\\("+[iu,iu,iu]+"\\)$"),lpe=new RegExp("^rgba\\("+[ud,ud,ud,ym]+"\\)$"),Ape=new RegExp("^rgba\\("+[iu,iu,iu,ym]+"\\)$"),upe=new RegExp("^hsl\\("+[ym,iu,iu]+"\\)$"),cpe=new RegExp("^hsla\\("+[ym,iu,iu,ym]+"\\)$"),t8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};f4(Zm,_m,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:n8,formatHex:n8,formatHsl:hpe,formatRgb:r8,toString:r8});function n8(){return this.rgb().formatHex()}function hpe(){return f7(this).formatHsl()}function r8(){return this.rgb().formatRgb()}function _m(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=spe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?i8(e):n===3?new Fa(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?wy(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?wy(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ope.exec(t))?new Fa(e[1],e[2],e[3],1):(e=ape.exec(t))?new Fa(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=lpe.exec(t))?wy(e[1],e[2],e[3],e[4]):(e=Ape.exec(t))?wy(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=upe.exec(t))?a8(e[1],e[2]/100,e[3]/100,1):(e=cpe.exec(t))?a8(e[1],e[2]/100,e[3]/100,e[4]):t8.hasOwnProperty(t)?i8(t8[t]):t==="transparent"?new Fa(NaN,NaN,NaN,0):null}function i8(t){return new Fa(t>>16&255,t>>8&255,t&255,1)}function wy(t,e,n,r){return r<=0&&(t=e=n=NaN),new Fa(t,e,n,r)}function fpe(t){return t instanceof Zm||(t=_m(t)),t?(t=t.rgb(),new Fa(t.r,t.g,t.b,t.opacity)):new Fa}function $E(t,e,n,r){return arguments.length===1?fpe(t):new Fa(t,e,n,r??1)}function Fa(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}f4(Fa,$E,h7(Zm,{brighter:function(t){return t=t==null?L2:Math.pow(L2,t),new Fa(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?mm:Math.pow(mm,t),new Fa(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:s8,formatHex:s8,formatRgb:o8,toString:o8}));function s8(){return"#"+yb(this.r)+yb(this.g)+yb(this.b)}function o8(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function yb(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function a8(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new YA(t,e,n,r)}function f7(t){if(t instanceof YA)return new YA(t.h,t.s,t.l,t.opacity);if(t instanceof Zm||(t=_m(t)),!t)return new YA;if(t instanceof YA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),l=NaN,o=s-i,p=(s+i)/2;return o?(e===s?l=(n-r)/o+(n<r)*6:n===s?l=(r-e)/o+2:l=(e-n)/o+4,o/=p<.5?s+i:2-s-i,l*=60):o=p>0&&p<1?0:l,new YA(l,o,p,t.opacity)}function dpe(t,e,n,r){return arguments.length===1?f7(t):new YA(t,e,n,r??1)}function YA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}f4(YA,dpe,h7(Zm,{brighter:function(t){return t=t==null?L2:Math.pow(L2,t),new YA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?mm:Math.pow(mm,t),new YA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Fa(_b(t>=240?t-240:t+120,i,r),_b(t,i,r),_b(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function _b(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function d4(t){return function(){return t}}function ppe(t,e){return function(n){return t+n*e}}function gpe(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function mpe(t){return(t=+t)==1?d7:function(e,n){return n-e?gpe(e,n,t):d4(isNaN(e)?n:e)}}function d7(t,e){var n=e-t;return n?ppe(t,n):d4(isNaN(t)?e:t)}const l8=function t(e){var n=mpe(e);function r(i,s){var l=n((i=$E(i)).r,(s=$E(s)).r),o=n(i.g,s.g),p=n(i.b,s.b),_=d7(i.opacity,s.opacity);return function(C){return i.r=l(C),i.g=o(C),i.b=p(C),i.opacity=_(C),i+""}}return r.gamma=t,r}(1);function ype(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function _pe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function vpe(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),l;for(l=0;l<r;++l)i[l]=p4(t[l],e[l]);for(;l<n;++l)s[l]=e[l];return function(o){for(l=0;l<r;++l)s[l]=i[l](o);return s}}function xpe(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function D2(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function wpe(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=p4(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var jE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,vb=new RegExp(jE.source,"g");function bpe(t){return function(){return t}}function Epe(t){return function(e){return t(e)+""}}function Tpe(t,e){var n=jE.lastIndex=vb.lastIndex=0,r,i,s,l=-1,o=[],p=[];for(t=t+"",e=e+"";(r=jE.exec(t))&&(i=vb.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[l]?o[l]+=s:o[++l]=s),(r=r[0])===(i=i[0])?o[l]?o[l]+=i:o[++l]=i:(o[++l]=null,p.push({i:l,x:D2(r,i)})),n=vb.lastIndex;return n<e.length&&(s=e.slice(n),o[l]?o[l]+=s:o[++l]=s),o.length<2?p[0]?Epe(p[0].x):bpe(e):(e=p.length,function(_){for(var C=0,M;C<e;++C)o[(M=p[C]).i]=M.x(_);return o.join("")})}function p4(t,e){var n=typeof e,r;return e==null||n==="boolean"?d4(e):(n==="number"?D2:n==="string"?(r=_m(e))?(e=r,l8):Tpe:e instanceof _m?l8:e instanceof Date?xpe:_pe(e)?ype:Array.isArray(e)?vpe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?wpe:D2)(t,e)}function Spe(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Cpe(t){return function(){return t}}function Mpe(t){return+t}var A8=[0,1];function W0(t){return t}function HE(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Cpe(isNaN(e)?NaN:.5)}function u8(t){var e=t[0],n=t[t.length-1],r;return e>n&&(r=e,e=n,n=r),function(i){return Math.max(e,Math.min(n,i))}}function Ppe(t,e,n){var r=t[0],i=t[1],s=e[0],l=e[1];return i<r?(r=HE(i,r),s=n(l,s)):(r=HE(r,i),s=n(s,l)),function(o){return s(r(o))}}function kpe(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),l=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<r;)i[l]=HE(t[l],t[l+1]),s[l]=n(e[l],e[l+1]);return function(o){var p=epe(t,o,1,r)-1;return s[p](i[p](o))}}function Ipe(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Lpe(){var t=A8,e=A8,n=p4,r,i,s,l=W0,o,p,_;function C(){return o=Math.min(t.length,e.length)>2?kpe:Ppe,p=_=null,M}function M(k){return isNaN(k=+k)?s:(p||(p=o(t.map(r),e,n)))(r(l(k)))}return M.invert=function(k){return l(i((_||(_=o(e,t.map(r),D2)))(k)))},M.domain=function(k){return arguments.length?(t=ipe.call(k,Mpe),l===W0||(l=u8(t)),C()):t.slice()},M.range=function(k){return arguments.length?(e=GE.call(k),C()):e.slice()},M.rangeRound=function(k){return e=GE.call(k),n=Spe,C()},M.clamp=function(k){return arguments.length?(l=k?u8(t):W0,M):l!==W0},M.interpolate=function(k){return arguments.length?(n=k,C()):n},M.unknown=function(k){return arguments.length?(s=k,M):s},function(k,F){return r=k,i=F,C()}}function Dpe(t,e){return Lpe()(t,e)}function Rpe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function R2(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function zd(t){return t=R2(Math.abs(t)),t?t[1]:NaN}function Bpe(t,e){return function(n,r){for(var i=n.length,s=[],l=0,o=t[0],p=0;i>0&&o>0&&(p+o+1>r&&(o=Math.max(1,r-p)),s.push(n.substring(i-=o,i+o)),!((p+=o+1)>r));)o=t[l=(l+1)%t.length];return s.reverse().join(e)}}function zpe(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Ope=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function B2(t){if(!(e=Ope.exec(t)))throw new Error("invalid format: "+t);var e;return new g4({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}B2.prototype=g4.prototype;function g4(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}g4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Fpe(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var p7;function Npe(t,e){var n=R2(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(p7=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+R2(t,Math.max(0,e+s-1))[0]}function c8(t,e){var n=R2(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const h8={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:Rpe,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return c8(t*100,e)},r:c8,s:Npe,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function f8(t){return t}var d8=Array.prototype.map,p8=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Upe(t){var e=t.grouping===void 0||t.thousands===void 0?f8:Bpe(d8.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?f8:zpe(d8.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"-":t.minus+"",p=t.nan===void 0?"NaN":t.nan+"";function _(M){M=B2(M);var k=M.fill,F=M.align,j=M.sign,H=M.symbol,ie=M.zero,Y=M.width,J=M.comma,se=M.precision,he=M.trim,pe=M.type;pe==="n"?(J=!0,pe="g"):h8[pe]||(se===void 0&&(se=12),he=!0,pe="g"),(ie||k==="0"&&F==="=")&&(ie=!0,k="0",F="=");var be=H==="$"?n:H==="#"&&/[boxX]/.test(pe)?"0"+pe.toLowerCase():"",Ge=H==="$"?r:/[%p]/.test(pe)?l:"",We=h8[pe],Xe=/[defgprs%]/.test(pe);se=se===void 0?6:/[gprs]/.test(pe)?Math.max(1,Math.min(21,se)):Math.max(0,Math.min(20,se));function rt(Oe){var nt=be,Ze=Ge,pt,Yt,Et;if(pe==="c")Ze=We(Oe)+Ze,Oe="";else{Oe=+Oe;var un=Oe<0||1/Oe<0;if(Oe=isNaN(Oe)?p:We(Math.abs(Oe),se),he&&(Oe=Fpe(Oe)),un&&+Oe==0&&j!=="+"&&(un=!1),nt=(un?j==="("?j:o:j==="-"||j==="("?"":j)+nt,Ze=(pe==="s"?p8[8+p7/3]:"")+Ze+(un&&j==="("?")":""),Xe){for(pt=-1,Yt=Oe.length;++pt<Yt;)if(Et=Oe.charCodeAt(pt),48>Et||Et>57){Ze=(Et===46?i+Oe.slice(pt+1):Oe.slice(pt))+Ze,Oe=Oe.slice(0,pt);break}}}J&&!ie&&(Oe=e(Oe,1/0));var _t=nt.length+Oe.length+Ze.length,Tt=_t<Y?new Array(Y-_t+1).join(k):"";switch(J&&ie&&(Oe=e(Tt+Oe,Tt.length?Y-Ze.length:1/0),Tt=""),F){case"<":Oe=nt+Oe+Ze+Tt;break;case"=":Oe=nt+Tt+Oe+Ze;break;case"^":Oe=Tt.slice(0,_t=Tt.length>>1)+nt+Oe+Ze+Tt.slice(_t);break;default:Oe=Tt+nt+Oe+Ze;break}return s(Oe)}return rt.toString=function(){return M+""},rt}function C(M,k){var F=_((M=B2(M),M.type="f",M)),j=Math.max(-8,Math.min(8,Math.floor(zd(k)/3)))*3,H=Math.pow(10,-j),ie=p8[8+j/3];return function(Y){return F(H*Y)+ie}}return{format:_,formatPrefix:C}}var by,g7,m7;Vpe({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Vpe(t){return by=Upe(t),g7=by.format,m7=by.formatPrefix,by}function Gpe(t){return Math.max(0,-zd(Math.abs(t)))}function $pe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(zd(e)/3)))*3-zd(Math.abs(t)))}function jpe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,zd(e)-zd(t))+1}function Hpe(t,e,n,r){var i=rpe(t,e,n),s;switch(r=B2(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=$pe(i,l))&&(r.precision=s),m7(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=jpe(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=Gpe(i))&&(r.precision=s-(r.type==="%")*2);break}}return g7(r)}function Wpe(t){var e=t.domain;return t.ticks=function(n){var r=e();return npe(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return Hpe(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,l=r[i],o=r[s],p;return o<l&&(p=l,l=o,o=p,p=i,i=s,s=p),p=A_(l,o,n),p>0?(l=Math.floor(l/p)*p,o=Math.ceil(o/p)*p,p=A_(l,o,n)):p<0&&(l=Math.ceil(l*p)/p,o=Math.floor(o*p)/p,p=A_(l,o,n)),p>0?(r[i]=Math.floor(l/p)*p,r[s]=Math.ceil(o/p)*p,e(r)):p<0&&(r[i]=Math.ceil(l*p)/p,r[s]=Math.floor(o*p)/p,e(r)),t},t}function lA(){var t=Dpe(W0,W0);return t.copy=function(){return Ipe(t,lA())},h4.apply(t,arguments),Wpe(t)}function Ov(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}function Fv(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const Qpe=Fv(Ov("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));Fv(Ov("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));Fv(Ov("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));Fv(Ov("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Wc(t){return function(){return t}}var g8=Math.abs,ao=Math.atan2,Qh=Math.cos,qpe=Math.max,xb=Math.min,$A=Math.sin,Q0=Math.sqrt,ia=1e-12,vm=Math.PI,z2=vm/2,Zpe=2*vm;function Ype(t){return t>1?0:t<-1?vm:Math.acos(t)}function m8(t){return t>=1?z2:t<=-1?-z2:Math.asin(t)}function Xpe(t){return t.innerRadius}function Kpe(t){return t.outerRadius}function Jpe(t){return t.startAngle}function ege(t){return t.endAngle}function tge(t){return t&&t.padAngle}function nge(t,e,n,r,i,s,l,o){var p=n-t,_=r-e,C=l-i,M=o-s,k=M*p-C*_;if(!(k*k<ia))return k=(C*(e-s)-M*(t-i))/k,[t+k*p,e+k*_]}function Ey(t,e,n,r,i,s,l){var o=t-n,p=e-r,_=(l?s:-s)/Q0(o*o+p*p),C=_*p,M=-_*o,k=t+C,F=e+M,j=n+C,H=r+M,ie=(k+j)/2,Y=(F+H)/2,J=j-k,se=H-F,he=J*J+se*se,pe=i-s,be=k*H-j*F,Ge=(se<0?-1:1)*Q0(qpe(0,pe*pe*he-be*be)),We=(be*se-J*Ge)/he,Xe=(-be*J-se*Ge)/he,rt=(be*se+J*Ge)/he,Oe=(-be*J+se*Ge)/he,nt=We-ie,Ze=Xe-Y,pt=rt-ie,Yt=Oe-Y;return nt*nt+Ze*Ze>pt*pt+Yt*Yt&&(We=rt,Xe=Oe),{cx:We,cy:Xe,x01:-C,y01:-M,x11:We*(i/pe-1),y11:Xe*(i/pe-1)}}function y7(){var t=Xpe,e=Kpe,n=Wc(0),r=null,i=Jpe,s=ege,l=tge,o=null;function p(){var _,C,M=+t.apply(this,arguments),k=+e.apply(this,arguments),F=i.apply(this,arguments)-z2,j=s.apply(this,arguments)-z2,H=g8(j-F),ie=j>F;if(o||(o=_=s7()),k<M&&(C=k,k=M,M=C),!(k>ia))o.moveTo(0,0);else if(H>Zpe-ia)o.moveTo(k*Qh(F),k*$A(F)),o.arc(0,0,k,F,j,!ie),M>ia&&(o.moveTo(M*Qh(j),M*$A(j)),o.arc(0,0,M,j,F,ie));else{var Y=F,J=j,se=F,he=j,pe=H,be=H,Ge=l.apply(this,arguments)/2,We=Ge>ia&&(r?+r.apply(this,arguments):Q0(M*M+k*k)),Xe=xb(g8(k-M)/2,+n.apply(this,arguments)),rt=Xe,Oe=Xe,nt,Ze;if(We>ia){var pt=m8(We/M*$A(Ge)),Yt=m8(We/k*$A(Ge));(pe-=pt*2)>ia?(pt*=ie?1:-1,se+=pt,he-=pt):(pe=0,se=he=(F+j)/2),(be-=Yt*2)>ia?(Yt*=ie?1:-1,Y+=Yt,J-=Yt):(be=0,Y=J=(F+j)/2)}var Et=k*Qh(Y),un=k*$A(Y),_t=M*Qh(he),Tt=M*$A(he);if(Xe>ia){var Jt=k*Qh(J),Ln=k*$A(J),Tn=M*Qh(se),Ir=M*$A(se),tr;if(H<vm&&(tr=nge(Et,un,Tn,Ir,Jt,Ln,_t,Tt))){var ar=Et-tr[0],pr=un-tr[1],Gn=Jt-tr[0],Mr=Ln-tr[1],wt=1/$A(Ype((ar*Gn+pr*Mr)/(Q0(ar*ar+pr*pr)*Q0(Gn*Gn+Mr*Mr)))/2),rn=Q0(tr[0]*tr[0]+tr[1]*tr[1]);rt=xb(Xe,(M-rn)/(wt-1)),Oe=xb(Xe,(k-rn)/(wt+1))}}be>ia?Oe>ia?(nt=Ey(Tn,Ir,Et,un,k,Oe,ie),Ze=Ey(Jt,Ln,_t,Tt,k,Oe,ie),o.moveTo(nt.cx+nt.x01,nt.cy+nt.y01),Oe<Xe?o.arc(nt.cx,nt.cy,Oe,ao(nt.y01,nt.x01),ao(Ze.y01,Ze.x01),!ie):(o.arc(nt.cx,nt.cy,Oe,ao(nt.y01,nt.x01),ao(nt.y11,nt.x11),!ie),o.arc(0,0,k,ao(nt.cy+nt.y11,nt.cx+nt.x11),ao(Ze.cy+Ze.y11,Ze.cx+Ze.x11),!ie),o.arc(Ze.cx,Ze.cy,Oe,ao(Ze.y11,Ze.x11),ao(Ze.y01,Ze.x01),!ie))):(o.moveTo(Et,un),o.arc(0,0,k,Y,J,!ie)):o.moveTo(Et,un),!(M>ia)||!(pe>ia)?o.lineTo(_t,Tt):rt>ia?(nt=Ey(_t,Tt,Jt,Ln,M,-rt,ie),Ze=Ey(Et,un,Tn,Ir,M,-rt,ie),o.lineTo(nt.cx+nt.x01,nt.cy+nt.y01),rt<Xe?o.arc(nt.cx,nt.cy,rt,ao(nt.y01,nt.x01),ao(Ze.y01,Ze.x01),!ie):(o.arc(nt.cx,nt.cy,rt,ao(nt.y01,nt.x01),ao(nt.y11,nt.x11),!ie),o.arc(0,0,M,ao(nt.cy+nt.y11,nt.cx+nt.x11),ao(Ze.cy+Ze.y11,Ze.cx+Ze.x11),ie),o.arc(Ze.cx,Ze.cy,rt,ao(Ze.y11,Ze.x11),ao(Ze.y01,Ze.x01),!ie))):o.arc(0,0,M,he,se,ie)}if(o.closePath(),_)return o=null,_+""||null}return p.centroid=function(){var _=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,C=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-vm/2;return[Qh(C)*_,$A(C)*_]},p.innerRadius=function(_){return arguments.length?(t=typeof _=="function"?_:Wc(+_),p):t},p.outerRadius=function(_){return arguments.length?(e=typeof _=="function"?_:Wc(+_),p):e},p.cornerRadius=function(_){return arguments.length?(n=typeof _=="function"?_:Wc(+_),p):n},p.padRadius=function(_){return arguments.length?(r=_==null?null:typeof _=="function"?_:Wc(+_),p):r},p.startAngle=function(_){return arguments.length?(i=typeof _=="function"?_:Wc(+_),p):i},p.endAngle=function(_){return arguments.length?(s=typeof _=="function"?_:Wc(+_),p):s},p.padAngle=function(_){return arguments.length?(l=typeof _=="function"?_:Wc(+_),p):l},p.context=function(_){return arguments.length?(o=_??null,p):o},p}function O2(){this._=null}function Nv(t){t.U=t.C=t.L=t.R=t.P=t.N=null}O2.prototype={constructor:O2,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=y8(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(jp(this,n),t=n,n=t.U),n.C=!1,r.C=!0,Hp(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(Hp(this,n),t=n,n=t.U),n.C=!1,r.C=!0,jp(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e=t.U,n,r=t.L,i=t.R,s,l;if(r?i?s=y8(i):s=r:s=i,e?e.L===t?e.L=s:e.R=s:this._=s,r&&i?(l=s.C,s.C=t.C,s.L=r,r.U=s,s!==i?(e=s.U,s.U=t.U,t=s.R,e.L=t,s.R=i,i.U=s):(s.U=e,e=s,t=s.R)):(l=t.C,t=s),t&&(t.U=e),!l){if(t&&t.C){t.C=!1;return}do{if(t===this._)break;if(t===e.L){if(n=e.R,n.C&&(n.C=!1,e.C=!0,jp(this,e),n=e.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,Hp(this,n),n=e.R),n.C=e.C,e.C=n.R.C=!1,jp(this,e),t=this._;break}}else if(n=e.L,n.C&&(n.C=!1,e.C=!0,Hp(this,e),n=e.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,jp(this,n),n=e.L),n.C=e.C,e.C=n.L.C=!1,Hp(this,e),t=this._;break}n.C=!0,t=e,e=e.U}while(!t.C);t&&(t.C=!1)}}};function jp(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Hp(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function y8(t){for(;t.L;)t=t.L;return t}function ug(t,e,n,r){var i=[null,null],s=uo.push(i)-1;return i.left=t,i.right=e,n&&F2(i,t,e,n),r&&F2(i,e,t,r),za[t.index].halfedges.push(s),za[e.index].halfedges.push(s),i}function Wp(t,e,n){var r=[e,n];return r.left=t,r}function F2(t,e,n,r){!t[0]&&!t[1]?(t[0]=r,t.left=e,t.right=n):t.left===n?t[1]=r:t[0]=r}function rge(t,e,n,r,i){var s=t[0],l=t[1],o=s[0],p=s[1],_=l[0],C=l[1],M=0,k=1,F=_-o,j=C-p,H;if(H=e-o,!(!F&&H>0)){if(H/=F,F<0){if(H<M)return;H<k&&(k=H)}else if(F>0){if(H>k)return;H>M&&(M=H)}if(H=r-o,!(!F&&H<0)){if(H/=F,F<0){if(H>k)return;H>M&&(M=H)}else if(F>0){if(H<M)return;H<k&&(k=H)}if(H=n-p,!(!j&&H>0)){if(H/=j,j<0){if(H<M)return;H<k&&(k=H)}else if(j>0){if(H>k)return;H>M&&(M=H)}if(H=i-p,!(!j&&H<0)){if(H/=j,j<0){if(H>k)return;H>M&&(M=H)}else if(j>0){if(H<M)return;H<k&&(k=H)}return!(M>0)&&!(k<1)||(M>0&&(t[0]=[o+M*F,p+M*j]),k<1&&(t[1]=[o+k*F,p+k*j])),!0}}}}}function ige(t,e,n,r,i){var s=t[1];if(s)return!0;var l=t[0],o=t.left,p=t.right,_=o[0],C=o[1],M=p[0],k=p[1],F=(_+M)/2,j=(C+k)/2,H,ie;if(k===C){if(F<e||F>=r)return;if(_>M){if(!l)l=[F,n];else if(l[1]>=i)return;s=[F,i]}else{if(!l)l=[F,i];else if(l[1]<n)return;s=[F,n]}}else if(H=(_-M)/(k-C),ie=j-H*F,H<-1||H>1)if(_>M){if(!l)l=[(n-ie)/H,n];else if(l[1]>=i)return;s=[(i-ie)/H,i]}else{if(!l)l=[(i-ie)/H,i];else if(l[1]<n)return;s=[(n-ie)/H,n]}else if(C<k){if(!l)l=[e,H*e+ie];else if(l[0]>=r)return;s=[r,H*r+ie]}else{if(!l)l=[r,H*r+ie];else if(l[0]<e)return;s=[e,H*e+ie]}return t[0]=l,t[1]=s,!0}function sge(t,e,n,r){for(var i=uo.length,s;i--;)(!ige(s=uo[i],t,e,n,r)||!rge(s,t,e,n,r)||!(Math.abs(s[0][0]-s[1][0])>gi||Math.abs(s[0][1]-s[1][1])>gi))&&delete uo[i]}function oge(t){return za[t.index]={site:t,halfedges:[]}}function age(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function _7(t,e){return e[+(e.left!==t.site)]}function lge(t,e){return e[+(e.left===t.site)]}function Age(){for(var t=0,e=za.length,n,r,i,s;t<e;++t)if((n=za[t])&&(s=(r=n.halfedges).length)){var l=new Array(s),o=new Array(s);for(i=0;i<s;++i)l[i]=i,o[i]=age(n,uo[r[i]]);for(l.sort(function(p,_){return o[_]-o[p]}),i=0;i<s;++i)o[i]=r[l[i]];for(i=0;i<s;++i)r[i]=o[i]}}function uge(t,e,n,r){var i=za.length,s,l,o,p,_,C,M,k,F,j,H,ie,Y=!0;for(s=0;s<i;++s)if(l=za[s]){for(o=l.site,_=l.halfedges,p=_.length;p--;)uo[_[p]]||_.splice(p,1);for(p=0,C=_.length;p<C;)j=lge(l,uo[_[p]]),H=j[0],ie=j[1],M=_7(l,uo[_[++p%C]]),k=M[0],F=M[1],(Math.abs(H-k)>gi||Math.abs(ie-F)>gi)&&(_.splice(p,0,uo.push(Wp(o,j,Math.abs(H-t)<gi&&r-ie>gi?[t,Math.abs(k-t)<gi?F:r]:Math.abs(ie-r)<gi&&n-H>gi?[Math.abs(F-r)<gi?k:n,r]:Math.abs(H-n)<gi&&ie-e>gi?[n,Math.abs(k-n)<gi?F:e]:Math.abs(ie-e)<gi&&H-t>gi?[Math.abs(F-e)<gi?k:t,e]:null))-1),++C);C&&(Y=!1)}if(Y){var J,se,he,pe=1/0;for(s=0,Y=null;s<i;++s)(l=za[s])&&(o=l.site,J=o[0]-t,se=o[1]-e,he=J*J+se*se,he<pe&&(pe=he,Y=l));if(Y){var be=[t,e],Ge=[t,r],We=[n,r],Xe=[n,e];Y.halfedges.push(uo.push(Wp(o=Y.site,be,Ge))-1,uo.push(Wp(o,Ge,We))-1,uo.push(Wp(o,We,Xe))-1,uo.push(Wp(o,Xe,be))-1)}}for(s=0;s<i;++s)(l=za[s])&&(l.halfedges.length||delete za[s])}var v7=[],m4;function cge(){Nv(this),this.x=this.y=this.arc=this.site=this.cy=null}function q0(t){var e=t.P,n=t.N;if(!(!e||!n)){var r=e.site,i=t.site,s=n.site;if(r!==s){var l=i[0],o=i[1],p=r[0]-l,_=r[1]-o,C=s[0]-l,M=s[1]-o,k=2*(p*M-_*C);if(!(k>=-gge)){var F=p*p+_*_,j=C*C+M*M,H=(M*F-_*j)/k,ie=(p*j-C*F)/k,Y=v7.pop()||new cge;Y.arc=t,Y.site=i,Y.x=H+l,Y.y=(Y.cy=ie+o)+Math.sqrt(H*H+ie*ie),t.circle=Y;for(var J=null,se=xm._;se;)if(Y.y<se.y||Y.y===se.y&&Y.x<=se.x)if(se.L)se=se.L;else{J=se.P;break}else if(se.R)se=se.R;else{J=se;break}xm.insert(J,Y),J||(m4=Y)}}}}function cd(t){var e=t.circle;e&&(e.P||(m4=e.N),xm.remove(e),v7.push(e),Nv(e),t.circle=null)}var x7=[];function hge(){Nv(this),this.edge=this.site=this.circle=null}function _8(t){var e=x7.pop()||new hge;return e.site=t,e}function wb(t){cd(t),hd.remove(t),x7.push(t),Nv(t)}function fge(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],s=t.P,l=t.N,o=[t];wb(t);for(var p=s;p.circle&&Math.abs(n-p.circle.x)<gi&&Math.abs(r-p.circle.cy)<gi;)s=p.P,o.unshift(p),wb(p),p=s;o.unshift(p),cd(p);for(var _=l;_.circle&&Math.abs(n-_.circle.x)<gi&&Math.abs(r-_.circle.cy)<gi;)l=_.N,o.push(_),wb(_),_=l;o.push(_),cd(_);var C=o.length,M;for(M=1;M<C;++M)_=o[M],p=o[M-1],F2(_.edge,p.site,_.site,i);p=o[0],_=o[C-1],_.edge=ug(p.site,_.site,null,i),q0(p),q0(_)}function dge(t){for(var e=t[0],n=t[1],r,i,s,l,o=hd._;o;)if(s=w7(o,n)-e,s>gi)o=o.L;else if(l=e-pge(o,n),l>gi){if(!o.R){r=o;break}o=o.R}else{s>-gi?(r=o.P,i=o):l>-gi?(r=o,i=o.N):r=i=o;break}oge(t);var p=_8(t);if(hd.insert(r,p),!(!r&&!i)){if(r===i){cd(r),i=_8(r.site),hd.insert(p,i),p.edge=i.edge=ug(r.site,p.site),q0(r),q0(i);return}if(!i){p.edge=ug(r.site,p.site);return}cd(r),cd(i);var _=r.site,C=_[0],M=_[1],k=t[0]-C,F=t[1]-M,j=i.site,H=j[0]-C,ie=j[1]-M,Y=2*(k*ie-F*H),J=k*k+F*F,se=H*H+ie*ie,he=[(ie*J-F*se)/Y+C,(k*se-H*J)/Y+M];F2(i.edge,_,j,he),p.edge=ug(_,t,null,he),i.edge=ug(t,j,null,he),q0(r),q0(i)}}function w7(t,e){var n=t.site,r=n[0],i=n[1],s=i-e;if(!s)return r;var l=t.P;if(!l)return-1/0;n=l.site;var o=n[0],p=n[1],_=p-e;if(!_)return o;var C=o-r,M=1/s-1/_,k=C/_;return M?(-k+Math.sqrt(k*k-2*M*(C*C/(-2*_)-p+_/2+i-s/2)))/M+r:(r+o)/2}function pge(t,e){var n=t.N;if(n)return w7(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var gi=1e-6,gge=1e-12,hd,za,xm,uo;function mge(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function yge(t,e){return e[1]-t[1]||e[0]-t[0]}function v8(t,e){var n=t.sort(yge).pop(),r,i,s;for(uo=[],za=new Array(t.length),hd=new O2,xm=new O2;;)if(s=m4,n&&(!s||n[1]<s.y||n[1]===s.y&&n[0]<s.x))(n[0]!==r||n[1]!==i)&&(dge(n),r=n[0],i=n[1]),n=t.pop();else if(s)fge(s.arc);else break;if(Age(),e){var l=+e[0][0],o=+e[0][1],p=+e[1][0],_=+e[1][1];sge(l,o,p,_),uge(l,o,p,_)}this.edges=uo,this.cells=za,hd=xm=uo=za=null}v8.prototype={constructor:v8,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(r){return _7(e,t[r])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,r){if(o=(s=n.halfedges).length)for(var i=n.site,s,l=-1,o,p,_=e[s[o-1]],C=_.left===i?_.right:_.left;++l<o;)p=C,_=e[s[l]],C=_.left===i?_.right:_.left,p&&C&&r<p.index&&r<C.index&&mge(i,p,C)<0&&t.push([i.data,p.data,C.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var r=this,i,s=r._found||0,l=r.cells.length,o;!(o=r.cells[s]);)if(++s>=l)return null;var p=t-o.site[0],_=e-o.site[1],C=p*p+_*_;do o=r.cells[i=s],s=null,o.halfedges.forEach(function(M){var k=r.edges[M],F=k.left;if(!((F===o.site||!F)&&!(F=k.right))){var j=t-F[0],H=e-F[1],ie=j*j+H*H;ie<C&&(C=ie,s=F.index)}});while(s!==null);return r._found=i,n==null||C<=n*n?o.site:null}};function cg(t,e,n){this.k=t,this.x=e,this.y=n}cg.prototype={constructor:cg,scale:function(t){return t===1?this:new cg(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new cg(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};cg.prototype;function b7(t,e,n,r,i,s){var l=i||0,o=s||0,p=n||0,_=e||function(){return"#fff"},C=r,M;function k(F){k.el=F,k.setProperties()}return k.setProperties=function(){this.el&&(k.svgGroup||(k.svgGroup=k.el.append("g")),k.svgGroup.attr("transform","translate("+l+","+o+")"),k.svgGroup.selectAll("g").data(t).enter().append("g").selectAll("rect").data(function(F,j){return F.map(function(H){return{r:j,v:H}})}).enter().append("rect").datum(function(F,j){return F.c=j,F}),k.svgGroup.selectAll("g").selectAll("rect").attr("x",function(F){return p/t[F.r].length*F.c}).attr("y",function(F){return F.r*M}).attr("width",function(F){return p/t[F.r].length}).attr("height",M).attr("fill",function(F){return _(F.v)}),C&&k.svgGroup.attr("id",C))},k.data=function(F){return arguments.length?(t=F,M=p/t.length,k.setProperties(),k):t},k.x=function(F){return arguments.length?(l=F,k.setProperties(),k):l},k.y=function(F){return arguments.length?(o=F,k.setProperties(),k):o},k.size=function(F){return arguments.length?(p=F,t&&(M=p/t.length,k.setProperties()),k):p},k.scale=function(F){return arguments.length?(_=F,t&&k.setProperties(),k):_},k.id=function(F){return arguments.length?(C=F,k.setProperties(),k):C},k}function _ge(t,e,n,r,i,s){var l=b7(t,e,n,r,i,s);function o(p,_,C,M){var k=lA().domain([0,M]).range([-Math.PI/6,Math.PI/6]),F=lA().domain([0,C]).range([_,0]),j=y7().innerRadius(F(p.r+1)).outerRadius(F(p.r)).startAngle(k(p.c)).endAngle(k(p.c+1));return j()}return l.setProperties=function(){var p=l.data(),_=l.size(),C=l.scale(),M=l.id(),k=l.x(),F=l.y();l.el&&(l.svgGroup||(l.svgGroup=l.el.append("g")),l.svgGroup.attr("transform","translate("+k+","+F+")"),l.svgGroup.selectAll("g").data(p).enter().append("g").selectAll("path").data(function(j,H){return j.map(function(ie){return{r:H,v:ie}})}).enter().append("path").datum(function(j,H){return j.c=H,j}),l.svgGroup.selectAll("g").selectAll("path").attr("transform","translate("+_/2+","+_+")").attr("d",function(j){return o(j,_,p.length,p[j.r].length)}).attr("fill",function(j){return C(j.v)}),M&&l.svgGroup.attr("id",M))},l}var vge=1e-9;function xge(t,e){var n=t||2,r=e||2,i=lA(),s=lA(),l=p();function o(_,C){for(var M=C??_.u,k=C!=null?_:_.v,F=0;F<l.length-1&&i(M)<1-(F+1)/r-vge;)F++;for(var j=l[F].length>1?(l[F][1].v-l[F][0].v)/2:0,H=0;H<l[F].length-1&&k>l[F][H].v+j;)H++;return l[F][H]}function p(){var _=[],C;s.nice(Math.pow(n,r-1)),i.nice(r),_[0]=[],_[0].push({u:i.invert((r-1)/r),v:s.invert(.5)});for(var M=1;M<r;M++){_[M]=[],C=2*Math.pow(n,M);for(var k=1;k<C;k+=2)_[M].push({u:i.invert(1-(M+1)/r),v:s.invert(k/C)})}return _}return o.range=function(){return[].concat.apply([],l)},o.tree=function(){return l},o.data=o.tree,o.branching=function(_){return arguments.length?(n=Math.max(1,_),l=p(),o):n},o.layers=function(_){return arguments.length?(r=Math.max(1,_),l=p(),o):r},o.uncertaintyDomain=function(_){return arguments.length?(i.domain(_),l=p(),o):i.domain()},o.valueDomain=function(_){return arguments.length?(s.domain(_),l=p(),o):s.domain()},o}function wge(t,e,n){var r=e||Qpe,i=n||function(p,_){var C=_!=null?{v:p,u:_}:{v:p.v,u:p.u};return C},s=t;function l(p,_){var C=pm(kf(p)),M=pm(kf(_));return Math.sqrt(Math.pow(C.l-M.l,2)+Math.pow(C.a-M.a,2)+Math.pow(C.b-M.b,2))}function o(p,_){var C=i(p,_),M=[0,1],k=[0,1];i.uncertaintyDomain&&(M=i.uncertaintyDomain()),i.valueDomain&&(k=i.valueDomain());var F=lA().domain(M).range([0,1]),j=lA().domain(k).range([0,1]),H=r(j(C.v));switch(s){case"usl":default:H=P0e(H,"#fff")(F(C.u));break;case"us":H=ME(H);var ie=lA().domain([0,1]).range([H.s,0]);H.s=ie(F(C.u));break;case"ul":H=ME(H);var Y=lA().domain([0,1]).range([H.l,1]);H.l=Y(F(C.u));break}return H}return o.colorList=function(){return this.quantize().range().map(function(p){return o(p)})},o.colorDists=function(){for(var p=this.colorList(),_=new Array(p.length),C,M=new Array(2),k,F=0;F<_.length;F++){_[F]=new Array(p.length);for(var j=0;j<_[F].length;j++)k=l(p[F],p[j]),_[F][j]=k,F!=j&&(F==0&&j==1||k<C)&&(C=k,M=[p[F],p[j]])}return _.minDist=C,_.minPair=M,_},o.mode=function(p){return arguments.length?(s=p,o):s},o.range=function(p){return arguments.length?(r=p,o):r},o.quantize=function(p){return arguments.length?(i=p,o):i},o}function bge(t,e,n,r,i,s,l){var o=null,p=i,_=t||null,C=e||200,M=n||30,k=r||null,F=s||0,j=l||0;function H(ie){o=ie,H.setProperties()}return H.setProperties=function(){if(o){var ie=_.domain?_.domain():[0,1],Y=C/_.range().length,J=(ie[1]-ie[0])/_.range().length,se=hm(ie[0],ie[1]+J,J),he=I2().range([0,C]).domain(se).round(!0);o.attr("class","legend").attr("transform","translate("+F+","+j+")");var pe=o.selectAll("rect").data(_.range());pe.enter().append("rect").merge(pe).attr("x",function(We,Xe){return Xe*Y}).attr("y",0).attr("height",M).attr("width",Y).attr("fill",function(We){return We});var be=o.select("g.legend > g");be.empty()&&(be=o.append("g")),be.attr("transform","translate(0, "+M+")").call(zhe(he).tickFormat(Bd(k||"")));var Ge=o.select("g.legend > text");Ge.empty()&&(Ge=o.append("text")),Ge.style("text-anchor","middle").style("font-size",13).attr("transform","translate("+C/2+", "+(M+30)+")").text(p)}},H.title=function(ie){return arguments.length?(p=ie,H.setProperties(),H):p},H.scale=function(ie){return arguments.length?(_=ie,H.setProperties(),H):_},H.size=function(ie){return arguments.length?(C=ie,H.setProperties(),H):C},H.height=function(ie){return arguments.length?(M=ie,H.setProperties(),H):M},H.format=function(ie){return arguments.length?(k=ie,H.setProperties(),H):k},H.x=function(ie){return arguments.length?(F=ie,H.setProperties(),H):F},H.y=function(ie){return arguments.length?(j=ie,H.setProperties(),H):j},H}function Ege(t,e,n,r,i,s,l){var o=null,p=r||"Uncertainty",_=i||"Value",C=t||null,M=e||200,k=n||null,F=s||0,j=l||0,H=null,ie=b7(),Y=function(J){o=J,Y.setProperties(),o.call(ie)};return Y.setProperties=function(){if(o){var J=H;J||(J=C.quantize().data());for(var se=[],he=0;he<J.length;he++)se[he]=J[J.length-he-1];ie.y(1),ie.data(se),ie.scale(C),ie.size(M),o.attr("class","legend").attr("transform","translate("+F+","+j+")");var pe=C&&C.quantize?C.quantize().uncertaintyDomain():[0,1],be=(pe[1]-pe[0])/se.length,Ge=hm(pe[0],pe[1]+be,be),We=C&&C.quantize?C.quantize().valueDomain():[0,1],Xe=(We[1]-We[0])/se.length,rt=hm(We[0],We[1]+Xe,Xe),Oe=I2().range([0,M]).domain(rt);o.append("g").call(Bhe(Oe).tickFormat(Bd(k||""))),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+M/2+", -25)").text(_);var nt=I2().range([0,M]).domain(Ge);o.append("g").attr("transform","translate("+M+", 0)").call(SF(nt).tickFormat(Bd(k||""))),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(M+40)+", "+M/2+")rotate(90)").text(p)}},Y.data=function(J){return arguments.length?(H=J,Y.setProperties(),Y):H},Y.scale=function(J){return arguments.length?(C=J,Y.setProperties(),Y):C},Y.size=function(J){return arguments.length?(M=J,Y.setProperties(),Y):M},Y.format=function(J){return arguments.length?(k=J,Y.setProperties(),Y):k},Y.x=function(J){return arguments.length?(F=J,Y.setProperties(),Y):F},Y.y=function(J){return arguments.length?(j=J,Y.setProperties(),Y):j},Y.utitle=function(J){return arguments.length?(p=J,Y.setProperties(),Y):p},Y.vtitle=function(J){return arguments.length?(_=J,Y.setProperties(),Y):_},Y}function Tge(t,e,n,r,i,s,l){var o=null,p=r||"Uncertainty",_=i||"Value",C=t||null,M=e||200,k=n||null,F=s||0,j=l||0,H=null,ie=_ge(),Y=function(J){o=J,Y.setProperties(),o.call(ie)};return Y.setProperties=function(){if(o){var J=H;J||(J=C.quantize().data());for(var se=[],he=0;he<J.length;he++)se[he]=J[J.length-he-1];ie.data(se),ie.scale(C),ie.size(M),o.attr("class","legend").attr("transform","translate("+F+","+j+")");var pe=C&&C.quantize?C.quantize().uncertaintyDomain():[0,1],be=(pe[1]-pe[0])/se.length,Ge=hm(pe[0],pe[1]+be,be),We=I2().range([0,M]).domain(Ge),Xe=M/180;o.append("g").attr("transform","translate("+(M+6*Xe)+","+28*Xe+")rotate(30)").call(SF(We).tickFormat(Bd(k||""))),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(M+10*Xe)+","+(40*Xe+M/2)+")rotate(-60)").text(p);var rt=C&&C.quantize?C.quantize().valueDomain():[0,1],Oe=(rt[1]-rt[0])/se[0].length,nt=hm(rt[0],rt[1]+Oe,Oe),Ze=lA().range([0,M]).domain(rt),pt=k?Bd(k):Ze.tickFormat(nt.length),Yt=lA().domain(rt).range([-30,30]),Et=3*Xe,un=y7().innerRadius(M+Et).outerRadius(M+Et+1).startAngle(-Math.PI/6).endAngle(Math.PI/6),_t=o.append("g").attr("transform","translate("+M/2+","+(M-Et)+")");_t.append("path").attr("fill","black").attr("stroke","transparent").attr("d",un);var Tt=_t.selectAll(".arc-label").data(nt).enter().append("g").attr("class","arc-label").attr("transform",function(Jt){return"rotate("+Yt(Jt)+")translate(0,"+(-M-Et)+")"});Tt.append("text").style("font-size","11").style("text-anchor","middle").attr("y",-10).text(pt),Tt.append("line").attr("x1",.5).attr("x2",.5).attr("y1",-6).attr("y2",0).attr("stroke","#000"),o.append("text").style("text-anchor","middle").style("font-size",13).attr("x",M/2).attr("y",-30).text(_)}},Y.data=function(J){return arguments.length?(H=J,Y.setProperties(),Y):H},Y.scale=function(J){return arguments.length?(C=J,Y.setProperties(),Y):C},Y.size=function(J){return arguments.length?(M=J,Y.setProperties(),Y):M},Y.format=function(J){return arguments.length?(k=J,Y.setProperties(),Y):k},Y.x=function(J){return arguments.length?(F=J,Y.setProperties(),Y):F},Y.y=function(J){return arguments.length?(j=J,Y.setProperties(),Y):j},Y.utitle=function(J){return arguments.length?(p=J,Y.setProperties(),Y):p},Y.vtitle=function(J){return arguments.length?(_=J,Y.setProperties(),Y):_},Y}const Sge=Object.freeze(Object.defineProperty({__proto__:null,arcmapLegend:Tge,heatmapLegend:Ege,simpleLegend:bge},Symbol.toStringTag,{value:"Module"}));var $a=Sge;function Od(t,e){return t+e}function AA(t,e=1,n=1){if(typeof t=="function")return l=>AA(t(l),e,n);Array.isArray(t)&&(t=Sf(...t).toString());const{l:r,c:i,h:s}=lI(t);return lI(r+18*n,i+18*e,s).toString()}function E7(t,e,n){let r={};return n||(n=[]),Object.keys(t).forEach(i=>{if(n.includes(i))return;let s=t[i],l={};Object.keys(s).forEach(o=>{e(s[o])&&(l[o]=s[o])}),r[i]=l}),r}function T7(t,e){return t.reduce(function(n,r){return n[e(r)]=r,n},{})}const Ym=t=>!!(t.properties||{}).id,Th=t=>!Ym(t),N2=t=>t.toLocaleString("default",{month:"long"})+" "+t.toLocaleString("default",{year:"numeric"}),fd=t=>Bge[t.properties.LandUse.constructor===Array?t.properties.LandUse[0]:t.properties.LandUse],Cge=1e-9;function Mge(t,e){let n=t||2,r=e||2;const i=ur(),s=ur();let l=p();function o(_,C){var M=C??_.u,k=C!=null?_:_.v;let F=0;for(;F<l.length-1&&i(M)<1-(F+1)/r-Cge;)F++;const j=l[F].length>1?(l[F][1].v-l[F][0].v)/2:0;let H=0;for(;H<l[F].length-1&&k>l[F][H].v+j;)H++;return l[F][H]}function p(){const _=[];let C;s.nice(Math.pow(n,r-1)),i.nice(r),_[0]=[],_[0].push({u:i.invert((r-1)/r),v:s.invert(.5)});for(let M=1;M<=r;M++){_[M-1]=[],C=2*Math.pow(n,M);for(let k=1;k<C;k+=2)_[M-1].push({u:i.invert(1-M/r),v:s.invert(k/C)})}return _}return o.range=()=>[].concat.apply([],l),o.tree=()=>l,o.data=o.tree,o.branching=function(_){return arguments.length?(n=Math.max(1,_),l=p(),o):n},o.layers=function(_){return arguments.length?(r=Math.max(1,_),l=p(),o):r},o.uncertaintyDomain=function(_){return arguments.length?(i.domain(_),l=p(),o):i.domain()},o.valueDomain=function(_){return arguments.length?(s.domain(_),l=p(),o):s.domain()},o}const bb=t=>t.replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),HA=7,Eb=(t,e=0,n=1/HA)=>{let r=e==0?n:n/2;return Math.abs(t-e)<r?0:1},y4=(t,e,n=!0,r=!0)=>{const i=Object.keys(t);for(const s of i){const l=t[s],o=l.value.range||[0,1],p=l.variance.range||[1,0],_=l.value.color||zI,C=l.variance.color||zI;if(typeof l.value.domain=="function")if(n){const H=Object.values(e).slice(-1)[0];l.value.domain=jc(Object.values(H).map(l.value.domain))}else l.value.domain=jc(e.features.map(l.value.domain));if(typeof l.value.domain=="string")if(n){const H=Object.values(e).slice(-1)[0];l.value.domain=jc(Object.values(H).map(ie=>ie[l.value.domain]))}else l.value.domain=jc(e.features.map(H=>H.properties[l.value.domain]));if(typeof l.variance.domain=="function")if(n){const H=Object.values(e).slice(-1)[0];l.variance.domain=jc(Object.values(H).map(l.variance.domain))}else l.variance.domain=jc(e.features.map(l.variance.domain));if(typeof l.variance.domain=="string")if(n){const H=Object.values(e).slice(-1)[0];l.variance.domain=jc(Object.values(H).map(ie=>ie[l.variance.domain]))}else l.variance.domain=jc(e.features.map(H=>H.properties[l.variance.domain]));const M=ur().domain(l.value.domain).range(o),k=ur().domain(l.variance.domain).range(p);l.scaleLinear=M.copy().clamp(!0);const F=ss().domain(l.value.domain).range(wh(HA).map(H=>H/(HA-1)*(o[1]-o[0])+o[0]));l.scaleLinearVar=k.copy().clamp(!0);const j=ss().domain(l.variance.domain).range(wh(HA).map(H=>H/(HA-1)*(p[1]-p[0])+p[0]));l.colorsLinear=H=>_(M(H)),l.colorsStepped=ss().domain(l.value.domain).range(uI(H=>_(ur([0,1]).range(o)(H)),HA)),l.colorsLinearVar=H=>C(k(H)),l.colorsSteppedVar=ss().domain(l.variance.domain).range(uI(H=>C(ur([0,1]).range(p)(H)),HA)),l.vsup=wge().quantize((r?xge():Mge()).branching(2).layers(r?4:3).valueDomain(l.value.domain).uncertaintyDomain(l.variance.domain)).range(_),l.interpColor=(H,ie=!1,Y=!0,J=1/HA)=>[...bb((Y?l.colorsStepped:l.colorsLinear)(H)),...ie?[Eb(F(H),l.value.zero||0,J)*255]:[]],l.interpColorVar=(H,ie=!1,Y=!0,J=1/HA)=>[...bb((Y?l.colorsSteppedVar:l.colorsLinearVar)(H)),...ie?[Eb(j(H),l.variance.zero||0,J)*255]:[]],l.interpVsup=(H,ie,Y=!1,J=1/HA)=>[...bb(l.vsup(H,ie)),...Y?[Eb(l.scaleStepped(H),l.value.zero||0,J)*255]:[]]}return t},Xm=(t,e,n,r)=>{const i=Math.sqrt(3)/2,s=n,l=t,o=e,p=[[s+l,0+o],[s/2+l,s*i+o],[-s/2+l,s*i+o],[-s+l,0+o],[-s/2+l,-s*i+o],[s/2+l,-s*i+o]];return function(_){_.selectAll("path.area").data([p]).enter().append("path").attr("d",_2()).attr("fill",r)}},S7=(t,e,n,r,i=.2)=>{const s=Math.sqrt(3)/2;let l=n;const o=t,p=e,_=[[l+o,0+p],[l/2+o,l*s+p],[-l/2+o,l*s+p],[-l+o,0+p],[-l/2+o,-l*s+p],[l/2+o,-l*s+p]];l=n*(1-i);const C=[[l/2+o,-l*s+p],[-l/2+o,-l*s+p],[-l+o,0+p],[-l/2+o,l*s+p],[l/2+o,l*s+p],[l+o,0+p]],M=_2()(_),k=_2()(C);return function(F){F.append("path").attr("d",M+" "+k).attr("fill",r)}};function _4(t,e,n="Title"){return ur().range([55/255,1]),r=>r.call(i=>{const s=t.scaleLinear.invert;i.selectAll(".some").data(aa).enter().append("g").attr("transform",(l,o)=>`translate(${o*60},0)`).each(function(l){Ai(this).selectAll(".others").data(l.filter(o=>o[2]>-1)).enter().append("svg:image").attr("xlink:href",e).attr("x",(o,p)=>o[0]*20).attr("y",(o,p)=>-o[1]*20+15).attr("width",16).attr("height",16)}).append("text").attr("x",8).attr("y",0).style("font-size","10px").attr("text-anchor","middle").text((l,o)=>o==0?`<${ci(".2s")(s((o+1)/aa.length))}`:o==aa.length-1?`>${ci(".2s")(s(o/aa.length))}`:`${ci(".2s")(s(o/aa.length))} — ${ci(".2s")(s((o+1)/aa.length))}`),i.append("text").attr("text-anchor","middle").attr("x",60*3.5+(30-20)*2).attr("y",-15).style("font-weight","bold").text(n)})}function C7(t,e){const n=ur().range([.21568627450980393,1]);return r=>r.call(i=>{t.scaleLinearVar.invert,i.selectAll(".budy").data(aa).enter().append("g").attr("transform",(s,l)=>`translate(${l*60},0)`).call(s=>{s.append("g").each(function(l){Ai(this).selectAll(".others").data(aa[1].filter(o=>o[2]>-1)).enter().append("svg:image").attr("xlink:href",e).attr("x",(o,p)=>o[0]*20).attr("y",(o,p)=>-o[1]*20).attr("width",16).attr("height",16)}).attr("opacity",(l,o)=>n(1-o/(aa.length-1)))}).append("text").attr("x",8).attr("y",25).style("font-size","10px").attr("text-anchor","middle").text((s,l)=>l==0?"Low":l==aa.length-1?"High":""),i.append("text").attr("text-anchor","middle").attr("x",60*3.5+(30-20)*2).attr("y",40).text("Variance")})}function v4(t,e="Title"){const n=[.4,.65],r=[.3,1],i=_=>ur().range([0,(n[1]-n[0])/n[1]])(ur().range(r)(_)),s=7,l=20,o=l*2+10,p=ur().range([i(0),i(1)]);return _=>_.call(C=>{const M=ur().range(t.scaleLinear.domain());let k=ur().range([M(1/(s*2)),M(1-1/(s*2))]);C.append("g").selectAll(".asdf").data(wh(s).map(F=>F/(s-1))).enter().append("g").attr("transform",(F,j)=>`translate(${j*o},0)`).each(function(F,j){Ai(this).call(S7(0,20,l,Sf(...t.interpColor(k(F))),p(1)))}).append("text").style("font-size","10px").attr("text-anchor","middle").attr("x",0).attr("y",0).text((F,j)=>j==0?`<${ci(".2s")(M((j+1)/s))}`:j==s-1?`>${ci(".2s")(M(j/s))}`:`${ci(".2s")(M(j/s))} — ${ci(".2s")(M((j+1)/s))}`),C.append("text").attr("text-anchor","middle").attr("x",l*3+o*2).attr("y",-15).style("font-weight","bold").text(e)})}function M7(t){const e=[.4,.65],n=[.3,1],r=p=>ur().range([0,(e[1]-e[0])/e[1]])(ur().range(n)(p)),i=7,s=20,l=s*2+10,o=ur().range([r(0),r(1)]);return p=>p.call(_=>{const C=t.scaleLinear.invert;t.scaleLinearVar.invert;let M=ur().range([C(1/(i*2)),C(1-1/(i*2))]);_.append("g").selectAll(".asdf").data(wh(i).map(k=>k/(i-1))).enter().append("g").attr("transform",(k,F)=>`translate(${F*l},${s*2})`).each(function(k,F){Ai(this).call(S7(0,0,s,Sf(...t.interpColor(M(0))),o(1-k)))}).append("text").style("font-size","10px").attr("text-anchor","middle").attr("x",0).attr("y",s+10).text((k,F)=>F==0?"Low":F==i-1?"High":""),_.append("text").attr("text-anchor","middle").attr("x",s*3+l*2).attr("y",s*4).text("Variance")})}function Pge(t,e,n,r,i,s){let l=i||0,o=s||0,p=n||0,_=e||(()=>"#fff"),C=r,M;function k(F){k.el=F,k.setProperties()}return k.setProperties=function(){this.el&&(k.svgGroup||(k.svgGroup=k.el.append("g")),k.svgGroup.attr("transform",`translate(${l},${o})`),k.svgGroup.selectAll("g").data(t).enter().append("g").selectAll("rect").data((F,j)=>F.map(H=>({r:j,v:H}))).enter().append("rect").datum(function(F,j){return F.c=j,F}),k.svgGroup.selectAll("g").selectAll("rect").attr("x",F=>p/t[F.r].length*F.c).attr("y",F=>F.r*M).attr("width",F=>p/t[F.r].length).attr("height",M).attr("fill",F=>_(F.v)),C&&k.svgGroup.attr("id",C))},k.data=function(F){return arguments.length?(t=F,M=p/t.length,k.setProperties(),k):t},k.x=function(F){return arguments.length?(l=F,k.setProperties(),k):l},k.y=function(F){return arguments.length?(o=F,k.setProperties(),k):o},k.size=function(F){return arguments.length?(p=F,t&&(M=p/t.length,k.setProperties()),k):p},k.scale=function(F){return arguments.length?(_=F,t&&k.setProperties(),k):_},k.id=function(F){return arguments.length?(C=F,k.setProperties(),k):C},k}function kge(t,e,n,r,i,s){const l=Pge(t,e,n,r,i,s);function o(p,_,C,M){const k=ur().domain([0,M]).range([-Math.PI/6,Math.PI/6]),F=ur().domain([0,C]).range([_,0]);return y2().innerRadius(F(p.r+1)).outerRadius(F(p.r)).startAngle(k(p.c)).endAngle(k(p.c+1))()}return l.setProperties=function(){var p=l.data(),_=l.size(),C=l.scale(),M=l.id(),k=l.x(),F=l.y();l.el&&(l.svgGroup||(l.svgGroup=l.el.append("g")),l.svgGroup.attr("transform",`translate(${k},${F})`),l.svgGroup.selectAll("g").data(p).enter().append("g").selectAll("path").data((j,H)=>j.map(ie=>({r:H,v:ie}))).enter().append("path").datum(function(j,H){return j.c=H,j}),l.svgGroup.selectAll("g").selectAll("path").attr("transform",`translate(${_/2},${_})`).attr("d",j=>o(j,_,p.length,p[j.r].length)).attr("fill",j=>C(j.v)),M&&l.svgGroup.attr("id",M))},l}function P7(t,e,n,r,i,s,l){let o=null,p=r||"Uncertainty",_=i||"Value",C=t||null,M=e||200,k=n||".2s",F=s||0,j=l||0,H=null;const ie=kge();var Y=function(J){o=J,Y.setProperties(),o.call(ie)};return Y.setProperties=function(){if(!o)return;let J=H;J||(J=C.quantize().data());const se=[];for(let _t=0;_t<J.length;_t++)se[_t]=J[J.length-_t-1];ie.data(se),ie.scale(C),ie.size(M),o.attr("class","legend").attr("transform",`translate(${F},${j})`);var he=C&&C.quantize?C.quantize().uncertaintyDomain():[0,1];const pe=(he[1]-he[0])/se.length;wh(he[0],he[1]+pe,pe);const be=Qu().range([0,M]).domain(["Low","","High"]),Ge=M/180;o.append("g").attr("transform",`translate(${M+6*Ge},${28*Ge})rotate(30)`).call(nm(be)),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(M+10*Ge)+","+(40*Ge+M/2)+")rotate(-60)").text(p);var We=C&&C.quantize?C.quantize().valueDomain():[0,1];const Xe=(We[1]-We[0])/se[0].length,rt=wh(We[0],We[1]+Xe,Xe),Oe=ur().range([0,M]).domain(We),nt=k?ci(k):Oe.tickFormat(rt.length),Ze=ur().domain(We).range([-30,30]),pt=3*Ge,Yt=y2().innerRadius(M+pt).outerRadius(M+pt+1).startAngle(-Math.PI/6).endAngle(Math.PI/6),Et=o.append("g").attr("transform",`translate(${M/2},${M-pt})`);Et.append("path").attr("fill","black").attr("stroke","transparent").attr("d",Yt);const un=Et.selectAll(".arc-label").data(rt).enter().append("g").attr("class","arc-label").attr("transform",_t=>"rotate("+Ze(_t)+")translate(0,"+(-M-pt)+")");un.append("text").style("font-size","11").style("text-anchor","middle").attr("y",-10).text(nt),un.append("line").attr("x1",.5).attr("x2",.5).attr("y1",-6).attr("y2",0).attr("stroke","#000"),o.append("text").style("text-anchor","middle").style("font-size",13).attr("x",M/2).attr("y",-30).text(_)},Y.data=function(J){return arguments.length?(H=J,Y.setProperties(),Y):H},Y.scale=function(J){return arguments.length?(C=J,Y.setProperties(),Y):C},Y.size=function(J){return arguments.length?(M=J,Y.setProperties(),Y):M},Y.format=function(J){return arguments.length?(k=J,Y.setProperties(),Y):k},Y.x=function(J){return arguments.length?(F=J,Y.setProperties(),Y):F},Y.y=function(J){return arguments.length?(j=J,Y.setProperties(),Y):j},Y.utitle=function(J){return arguments.length?(p=J,Y.setProperties(),Y):p},Y.vtitle=function(J){return arguments.length?(_=J,Y.setProperties(),Y):_},Y}function Ige(t,e){const n=e,r=JSON.stringify(t,null,2),i=new Blob([r],{type:"application/json"}),s=URL.createObjectURL(i),l=document.createElement("a");l.href=s,l.download=n+".json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s)}function Lge(){let t=new Date,e=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),i=t.getHours(),s=t.getMinutes(),l=t.getSeconds();return e+"-"+n+"-"+r+"-"+i+"-"+s+"-"+l}const aa=[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,0],[-.67,0,0],[.67,0,0],[-.33,.58,0],[.33,.58,0],[-.33,-.58,0],[.33,-.58,0]]],Fd={longitude:-121.046040643251,latitude:37.53320315272563,zoom:7.3252675985610685,minZoom:7,maxZoom:15,pitch:50.85,bearing:32.58};new xh;new xh;new xh;new xh;new xh;new xh;const Dge=new XB({color:[255,255,255],intensity:1.7}),Rge=new zJ({timestamp:Date.UTC(2019,6,1,22),color:[255,255,255],intensity:.8}),Bge={0:"Settlement",1:"Exchange",2:"Project",3:"Non-Project"},mr={0:"bl_h000",1:"CS3_ALT3_2022med_L2020ADV",2:"LTO_BA_EXP1_2022MED"},U2={0:"Scenario 1",1:"Scenario 2",2:"Scenario 3"},bA=new TS({ambientLight:Dge,dirLight:Rge}),zge={longitude:-119.99582643167989,latitude:37.88453894208306,zoom:10.364947995424346,pitch:49.903969287830776,bearing:28.126875},Oge={party:{value:{domain:[-100,100],color:AA(pO(["red","purple","blue"]),-1,.2)},variance:{domain:[0,2e3]}},votes:{value:{domain:[0,42508]},variance:{domain:[0,1]}},population:{value:{domain:[0,200],color:rAe},variance:{domain:[0,8e5]}},poc:{value:{domain:[0,50],color:AA(Jle,.5,-.3)},variance:{domain:[0,100]}}},Fge={power:{value:{domain:[0,300]},variance:{domain:[0,100],range:[0,1]}},personnel:{value:{domain:[0,100]},variance:{domain:[0,1]}}},Nge={groundwater:{value:{domain:[-300,700],color:AA(t=>tAe(ur([.75,1])(t)),-.5,.5)},variance:{domain:[0,1e4]}},demand:{value:{domain:[0,150],color:AA(OI,1,1)},variance:{domain:[0,650]}},unmetDemand:{value:{domain:[-150,0],range:[1,0],color:AA(OI,0,0)},variance:{domain:[0,650]}},difference:{value:{domain:[-30,30],color:AA(Xle,0,0),zero:.5},variance:{domain:[0,650]}}},Nd=E7(await(await fetch("./assets/hex_5_6.json")).json(),t=>t.DemandBaseline),Uge=E7(await(await fetch("./assets/square_5_6.json")).json(),t=>t.DemandBaseline),Tb=await(await fetch("./assets/averages.json")).json(),Tl=await(await fetch("./assets/demand_geo.json")).json(),yA=await(async()=>{let t=await(await fetch("./assets/election_hex_3_4.json")).json();return delete t[3],t})(),Km=await(await fetch("./assets/election_square_3_4.json")).json(),Xd=await(await fetch("./assets/precinct_geo.json")).json(),x4=await(await fetch("./assets/groundwater_geo.json")).json(),Vge=await(await fetch("./assets/fire_hex_7_9.json")).json(),k7=await(await fetch("./assets/precinct_geo.json")).json(),WE=await(await fetch("./assets/county_geo.json")).json();function Uv(){const[t,e]=De.useState(1027),[n,r]=De.useState(!1),[i,s]=De.useState(1);return De.useEffect(()=>{if(n){let l=setTimeout(()=>e(o=>o%1199+1),33.333333333333336);return function(){clearTimeout(l)}}},[t,n]),{speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r,curOption:i,setCurOption:s}}function Gge(t,e){var n,r,i,s,l,o,p,_,C,M,k=0,F=t.type==="FeatureCollection",j=t.type==="Feature",H=F?t.features.length:1;for(n=0;n<H;n++){for(o=F?t.features[n].geometry:j?t.geometry:t,_=F?t.features[n].properties:j?t.properties:{},C=F?t.features[n].bbox:j?t.bbox:void 0,M=F?t.features[n].id:j?t.id:void 0,p=o?o.type==="GeometryCollection":!1,l=p?o.geometries.length:1,i=0;i<l;i++){if(s=p?o.geometries[i]:o,s===null){if(e(null,k,_,C,M)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,k,_,C,M)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(e(s.geometries[r],k,_,C,M)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}k++}}function $ge(t,e,n){var r=n;return Gge(t,function(i,s,l,o,p){s===0&&n===void 0?r=i:r=e(r,i,s,l,o,p)}),r}var x8=6378137;function V2(t){return $ge(t,function(e,n){return e+jge(n)},0)}function jge(t){var e=0,n;switch(t.type){case"Polygon":return w8(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)e+=w8(t.coordinates[n]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function w8(t){var e=0;if(t&&t.length>0){e+=Math.abs(b8(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(b8(t[n]))}return e}function b8(t){var e,n,r,i,s,l,o,p=0,_=t.length;if(_>2){for(o=0;o<_;o++)o===_-2?(i=_-2,s=_-1,l=0):o===_-1?(i=_-1,s=0,l=1):(i=o,s=o+1,l=o+2),e=t[i],n=t[s],r=t[l],p+=(Sb(r[0])-Sb(e[0]))*Math.sin(Sb(n[1]));p=p*x8*x8/2}return p}function Sb(t){return t*Math.PI/180}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Hge(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function o(_){return function(C){return p([_,C])}}function p(_){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=_[0]&2?i.return:_[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,_[1])).done)return s;switch(i=0,s&&(_=[_[0]&2,s.value]),_[0]){case 0:case 1:s=_;break;case 4:return n.label++,{value:_[1],done:!1};case 5:n.label++,i=_[1],_=[0];continue;case 7:_=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(_[0]===6||_[0]===2)){n=0;continue}if(_[0]===3&&(!s||_[1]>s[0]&&_[1]<s[3])){n.label=_[1];break}if(_[0]===6&&n.label<s[1]){n.label=s[1],s=_;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(_);break}s[2]&&n.ops.pop(),n.trys.pop();continue}_=e.call(t,n)}catch(C){_=[6,C],i=0}finally{r=s=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}}var Sh=function(){function t(e,n){this.next=null,this.key=e,this.data=n,this.left=null,this.right=null}return t}();function Wge(t,e){return t>e?1:t<e?-1:0}function Kc(t,e,n){for(var r=new Sh(null,null),i=r,s=r;;){var l=n(t,e.key);if(l<0){if(e.left===null)break;if(n(t,e.left.key)<0){var o=e.left;if(e.left=o.right,o.right=e,e=o,e.left===null)break}s.left=e,s=e,e=e.left}else if(l>0){if(e.right===null)break;if(n(t,e.right.key)>0){var o=e.right;if(e.right=o.left,o.left=e,e=o,e.right===null)break}i.right=e,i=e,e=e.right}else break}return i.right=e.left,s.left=e.right,e.left=r.right,e.right=r.left,e}function Cb(t,e,n,r){var i=new Sh(t,e);if(n===null)return i.left=i.right=null,i;n=Kc(t,n,r);var s=r(t,n.key);return s<0?(i.left=n.left,i.right=n,n.left=null):s>=0&&(i.right=n.right,i.left=n,n.right=null),i}function E8(t,e,n){var r=null,i=null;if(e){e=Kc(t,e,n);var s=n(e.key,t);s===0?(r=e.left,i=e.right):s<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function Qge(t,e,n){return e===null?t:(t===null||(e=Kc(t.key,e,n),e.left=t),e)}function QE(t,e,n,r,i){if(t){r(""+e+(n?"└── ":"├── ")+i(t)+`
`);var s=e+(n?"    ":"│   ");t.left&&QE(t.left,s,!1,r,i),t.right&&QE(t.right,s,!0,r,i)}}var w4=function(){function t(e){e===void 0&&(e=Wge),this._root=null,this._size=0,this._comparator=e}return t.prototype.insert=function(e,n){return this._size++,this._root=Cb(e,n,this._root,this._comparator)},t.prototype.add=function(e,n){var r=new Sh(e,n);this._root===null&&(r.left=r.right=null,this._size++,this._root=r);var i=this._comparator,s=Kc(e,this._root,i),l=i(e,s.key);return l===0?this._root=s:(l<0?(r.left=s.left,r.right=s,s.left=null):l>0&&(r.right=s.right,r.left=s,s.right=null),this._size++,this._root=r),this._root},t.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},t.prototype._remove=function(e,n,r){var i;if(n===null)return null;n=Kc(e,n,r);var s=r(e,n.key);return s===0?(n.left===null?i=n.right:(i=Kc(e,n.left,r),i.right=n.right),this._size--,i):n},t.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=Kc(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},t.prototype.findStatic=function(e){for(var n=this._root,r=this._comparator;n;){var i=r(e,n.key);if(i===0)return n;i<0?n=n.left:n=n.right}return null},t.prototype.find=function(e){return this._root&&(this._root=Kc(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},t.prototype.contains=function(e){for(var n=this._root,r=this._comparator;n;){var i=r(e,n.key);if(i===0)return!0;i<0?n=n.left:n=n.right}return!1},t.prototype.forEach=function(e,n){for(var r=this._root,i=[],s=!1;!s;)r!==null?(i.push(r),r=r.left):i.length!==0?(r=i.pop(),e.call(n,r),r=r.right):s=!0;return this},t.prototype.range=function(e,n,r,i){for(var s=[],l=this._comparator,o=this._root,p;s.length!==0||o;)if(o)s.push(o),o=o.left;else{if(o=s.pop(),p=l(o.key,n),p>0)break;if(l(o.key,e)>=0&&r.call(i,o))return this;o=o.right}return this},t.prototype.keys=function(){var e=[];return this.forEach(function(n){var r=n.key;return e.push(r)}),e},t.prototype.values=function(){var e=[];return this.forEach(function(n){var r=n.data;return e.push(r)}),e},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},t.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},t.prototype.at=function(e){for(var n=this._root,r=!1,i=0,s=[];!r;)if(n)s.push(n),n=n.left;else if(s.length>0){if(n=s.pop(),i===e)return n;i++,n=n.right}else r=!0;return null},t.prototype.next=function(e){var n=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var i=this._comparator;n;){var s=i(e.key,n.key);if(s===0)break;s<0?(r=n,n=n.left):n=n.right}return r},t.prototype.prev=function(e){var n=this._root,r=null;if(e.left!==null){for(r=e.left;r.right;)r=r.right;return r}for(var i=this._comparator;n;){var s=i(e.key,n.key);if(s===0)break;s<0?n=n.left:(r=n,n=n.right)}return r},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return Zge(this._root)},t.prototype.load=function(e,n,r){n===void 0&&(n=[]),r===void 0&&(r=!1);var i=e.length,s=this._comparator;if(r&&YE(e,n,0,i-1,s),this._root===null)this._root=qE(e,n,0,i),this._size=i;else{var l=Yge(this.toList(),qge(e,n),s);i=this._size+i,this._root=ZE({head:l},0,i)}return this},t.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){e===void 0&&(e=function(r){return String(r.key)});var n=[];return QE(this._root,"",!0,function(r){return n.push(r)},e),n.join("")},t.prototype.update=function(e,n,r){var i=this._comparator,s=E8(e,this._root,i),l=s.left,o=s.right;i(e,n)<0?o=Cb(n,r,o,i):l=Cb(n,r,l,i),this._root=Qge(l,o,i)},t.prototype.split=function(e){return E8(e,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var e,n,r;return Hge(this,function(i){switch(i.label){case 0:e=this._root,n=[],r=!1,i.label=1;case 1:return r?[3,6]:e===null?[3,2]:(n.push(e),e=e.left,[3,5]);case 2:return n.length===0?[3,4]:(e=n.pop(),[4,e]);case 3:return i.sent(),e=e.right,[3,5];case 4:r=!0,i.label=5;case 5:return[3,1];case 6:return[2]}})},t}();function qE(t,e,n,r){var i=r-n;if(i>0){var s=n+Math.floor(i/2),l=t[s],o=e[s],p=new Sh(l,o);return p.left=qE(t,e,n,s),p.right=qE(t,e,s+1,r),p}return null}function qge(t,e){for(var n=new Sh(null,null),r=n,i=0;i<t.length;i++)r=r.next=new Sh(t[i],e[i]);return r.next=null,n.next}function Zge(t){for(var e=t,n=[],r=!1,i=new Sh(null,null),s=i;!r;)e?(n.push(e),e=e.left):n.length>0?(e=s=s.next=n.pop(),e=e.right):r=!0;return s.next=null,i.next}function ZE(t,e,n){var r=n-e;if(r>0){var i=e+Math.floor(r/2),s=ZE(t,e,i),l=t.head;return l.left=s,t.head=t.head.next,l.right=ZE(t,i+1,n),l}return null}function Yge(t,e,n){for(var r=new Sh(null,null),i=r,s=t,l=e;s!==null&&l!==null;)n(s.key,l.key)<0?(i.next=s,s=s.next):(i.next=l,l=l.next),i=i.next;return s!==null?i.next=s:l!==null&&(i.next=l),r.next}function YE(t,e,n,r,i){if(!(n>=r)){for(var s=t[n+r>>1],l=n-1,o=r+1;;){do l++;while(i(t[l],s)<0);do o--;while(i(t[o],s)>0);if(l>=o)break;var p=t[l];t[l]=t[o],t[o]=p,p=e[l],e[l]=e[o],e[o]=p}YE(t,e,n,o,i),YE(t,e,o+1,r,i)}}const Qp=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,XE=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;const n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x,i=t.ll.y<e.ll.y?e.ll.y:t.ll.y,s=t.ur.y<e.ur.y?t.ur.y:e.ur.y;return{ll:{x:n,y:i},ur:{x:r,y:s}}};let sh=Number.EPSILON;sh===void 0&&(sh=Math.pow(2,-52));const Xge=sh*sh,T8=(t,e)=>{if(-sh<t&&t<sh&&-sh<e&&e<sh)return 0;const n=t-e;return n*n<Xge*t*e?0:t<e?-1:1};class Kge{constructor(){this.reset()}reset(){this.xRounder=new S8,this.yRounder=new S8}round(e,n){return{x:this.xRounder.round(e),y:this.yRounder.round(n)}}}class S8{constructor(){this.tree=new w4,this.round(0)}round(e){const n=this.tree.add(e),r=this.tree.prev(n);if(r!==null&&T8(n.key,r.key)===0)return this.tree.remove(e),r.key;const i=this.tree.next(n);return i!==null&&T8(n.key,i.key)===0?(this.tree.remove(e),i.key):e}}const wm=new Kge,u_=(t,e)=>t.x*e.y-t.y*e.x,I7=(t,e)=>t.x*e.x+t.y*e.y,C8=(t,e,n)=>{const r=cae(t.x,t.y,e.x,e.y,n.x,n.y);return r>0?-1:r<0?1:0},G2=t=>Math.sqrt(I7(t,t)),Jge=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return u_(i,r)/G2(i)/G2(r)},eme=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return I7(i,r)/G2(i)/G2(r)},M8=(t,e,n)=>e.y===0?null:{x:t.x+e.x/e.y*(n-t.y),y:n},P8=(t,e,n)=>e.x===0?null:{x:n,y:t.y+e.y/e.x*(n-t.x)},tme=(t,e,n,r)=>{if(e.x===0)return P8(n,r,t.x);if(r.x===0)return P8(t,e,n.x);if(e.y===0)return M8(n,r,t.y);if(r.y===0)return M8(t,e,n.y);const i=u_(e,r);if(i==0)return null;const s={x:n.x-t.x,y:n.y-t.y},l=u_(s,e)/i,o=u_(s,r)/i,p=t.x+o*e.x,_=n.x+l*r.x,C=t.y+o*e.y,M=n.y+l*r.y,k=(p+_)/2,F=(C+M)/2;return{x:k,y:F}};class gl{static compare(e,n){const r=gl.comparePoints(e.point,n.point);return r!==0?r:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:mh.compare(e.segment,n.segment))}static comparePoints(e,n){return e.x<n.x?-1:e.x>n.x?1:e.y<n.y?-1:e.y>n.y?1:0}constructor(e,n){e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const n=e.point.events;for(let r=0,i=n.length;r<i;r++){const s=n[r];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let n=0;n<e;n++){const r=this.point.events[n];if(r.segment.consumedBy===void 0)for(let i=n+1;i<e;i++){const s=this.point.events[i];s.consumedBy===void 0&&r.otherSE.point.events===s.otherSE.point.events&&r.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const e=[];for(let n=0,r=this.point.events.length;n<r;n++){const i=this.point.events[n];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&e.push(i)}return e}getLeftmostComparator(e){const n=new Map,r=i=>{const s=i.otherSE;n.set(i,{sine:Jge(this.point,e.point,s.point),cosine:eme(this.point,e.point,s.point)})};return(i,s)=>{n.has(i)||r(i),n.has(s)||r(s);const{sine:l,cosine:o}=n.get(i),{sine:p,cosine:_}=n.get(s);return l>=0&&p>=0?o<_?1:o>_?-1:0:l<0&&p<0?o<_?-1:o>_?1:0:p<l?-1:p>l?1:0}}}let nme=0;class mh{static compare(e,n){const r=e.leftSE.point.x,i=n.leftSE.point.x,s=e.rightSE.point.x,l=n.rightSE.point.x;if(l<r)return 1;if(s<i)return-1;const o=e.leftSE.point.y,p=n.leftSE.point.y,_=e.rightSE.point.y,C=n.rightSE.point.y;if(r<i){if(p<o&&p<_)return 1;if(p>o&&p>_)return-1;const M=e.comparePoint(n.leftSE.point);if(M<0)return 1;if(M>0)return-1;const k=n.comparePoint(e.rightSE.point);return k!==0?k:-1}if(r>i){if(o<p&&o<C)return-1;if(o>p&&o>C)return 1;const M=n.comparePoint(e.leftSE.point);if(M!==0)return M;const k=e.comparePoint(n.rightSE.point);return k<0?1:k>0?-1:1}if(o<p)return-1;if(o>p)return 1;if(s<l){const M=n.comparePoint(e.rightSE.point);if(M!==0)return M}if(s>l){const M=e.comparePoint(n.rightSE.point);if(M<0)return 1;if(M>0)return-1}if(s!==l){const M=_-o,k=s-r,F=C-p,j=l-i;if(M>k&&F<j)return 1;if(M<k&&F>j)return-1}return s>l?1:s<l||_<C?-1:_>C?1:e.id<n.id?-1:e.id>n.id?1:0}constructor(e,n,r,i){this.id=++nme,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=r,this.windings=i}static fromRing(e,n,r){let i,s,l;const o=gl.comparePoints(e,n);if(o<0)i=e,s=n,l=1;else if(o>0)i=n,s=e,l=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const p=new gl(i,!0),_=new gl(s,!1);return new mh(p,_,[r],[l])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<n?e:n},ur:{x:this.rightSE.point.x,y:e>n?e:n}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}comparePoint(e){if(this.isAnEndpoint(e))return 0;const n=this.leftSE.point,r=this.rightSE.point,i=this.vector();if(n.x===r.x)return e.x===n.x?0:e.x<n.x?1:-1;const s=(e.y-n.y)/i.y,l=n.x+s*i.x;if(e.x===l)return 0;const o=(e.x-n.x)/i.x,p=n.y+o*i.y;return e.y===p?0:e.y<p?-1:1}getIntersection(e){const n=this.bbox(),r=e.bbox(),i=XE(n,r);if(i===null)return null;const s=this.leftSE.point,l=this.rightSE.point,o=e.leftSE.point,p=e.rightSE.point,_=Qp(n,o)&&this.comparePoint(o)===0,C=Qp(r,s)&&e.comparePoint(s)===0,M=Qp(n,p)&&this.comparePoint(p)===0,k=Qp(r,l)&&e.comparePoint(l)===0;if(C&&_)return k&&!M?l:!k&&M?p:null;if(C)return M&&s.x===p.x&&s.y===p.y?null:s;if(_)return k&&l.x===o.x&&l.y===o.y?null:o;if(k&&M)return null;if(k)return l;if(M)return p;const F=tme(s,this.vector(),o,e.vector());return F===null||!Qp(i,F)?null:wm.round(F.x,F.y)}split(e){const n=[],r=e.events!==void 0,i=new gl(e,!0),s=new gl(e,!1),l=this.rightSE;this.replaceRightSE(s),n.push(s),n.push(i);const o=new mh(i,l,this.rings.slice(),this.windings.slice());return gl.comparePoints(o.leftSE.point,o.rightSE.point)>0&&o.swapEvents(),gl.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),s.checkForConsuming()),n}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,r=this.windings.length;n<r;n++)this.windings[n]*=-1}consume(e){let n=this,r=e;for(;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;const i=mh.compare(n,r);if(i!==0){if(i>0){const s=n;n=r,r=s}if(n.prev===r){const s=n;n=r,r=s}for(let s=0,l=r.rings.length;s<l;s++){const o=r.rings[s],p=r.windings[s],_=n.rings.indexOf(o);_===-1?(n.rings.push(o),n.windings.push(p)):n.windings[_]+=p}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,r=this._afterState.windings,i=this._afterState.multiPolys;for(let o=0,p=this.rings.length;o<p;o++){const _=this.rings[o],C=this.windings[o],M=n.indexOf(_);M===-1?(n.push(_),r.push(C)):r[M]+=C}const s=[],l=[];for(let o=0,p=n.length;o<p;o++){if(r[o]===0)continue;const _=n[o],C=_.poly;if(l.indexOf(C)===-1)if(_.isExterior)s.push(C);else{l.indexOf(C)===-1&&l.push(C);const M=s.indexOf(_.poly);M!==-1&&s.splice(M,1)}}for(let o=0,p=s.length;o<p;o++){const _=s[o].multiPoly;i.indexOf(_)===-1&&i.push(_)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(uA.type){case"union":{const r=e.length===0,i=n.length===0;this._isInResult=r!==i;break}case"intersection":{let r,i;e.length<n.length?(r=e.length,i=n.length):(r=n.length,i=e.length),this._isInResult=i===uA.numMultiPolys&&r<i;break}case"xor":{const r=Math.abs(e.length-n.length);this._isInResult=r%2===1;break}case"difference":{const r=i=>i.length===1&&i[0].isSubject;this._isInResult=r(e)!==r(n);break}default:throw new Error(`Unrecognized operation type found ${uA.type}`)}return this._isInResult}}class k8{constructor(e,n,r){if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=wm.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let s=i;for(let l=1,o=e.length;l<o;l++){if(typeof e[l][0]!="number"||typeof e[l][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let p=wm.round(e[l][0],e[l][1]);p.x===s.x&&p.y===s.y||(this.segments.push(mh.fromRing(s,p,this)),p.x<this.bbox.ll.x&&(this.bbox.ll.x=p.x),p.y<this.bbox.ll.y&&(this.bbox.ll.y=p.y),p.x>this.bbox.ur.x&&(this.bbox.ur.x=p.x),p.y>this.bbox.ur.y&&(this.bbox.ur.y=p.y),s=p)}(i.x!==s.x||i.y!==s.y)&&this.segments.push(mh.fromRing(s,i,this))}getSweepEvents(){const e=[];for(let n=0,r=this.segments.length;n<r;n++){const i=this.segments[n];e.push(i.leftSE),e.push(i.rightSE)}return e}}class rme{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new k8(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let r=1,i=e.length;r<i;r++){const s=new k8(e[r],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,r=this.interiorRings.length;n<r;n++){const i=this.interiorRings[n].getSweepEvents();for(let s=0,l=i.length;s<l;s++)e.push(i[s])}return e}}class I8{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let r=0,i=e.length;r<i;r++){const s=new rme(e[r],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,r=this.polys.length;n<r;n++){const i=this.polys[n].getSweepEvents();for(let s=0,l=i.length;s<l;s++)e.push(i[s])}return e}}class $2{static factory(e){const n=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s.isInResult()||s.ringOut)continue;let l=null,o=s.leftSE,p=s.rightSE;const _=[o],C=o.point,M=[];for(;l=o,o=p,_.push(o),o.point!==C;)for(;;){const k=o.getAvailableLinkedEvents();if(k.length===0){const H=_[0].point,ie=_[_.length-1].point;throw new Error(`Unable to complete output ring starting at [${H.x}, ${H.y}]. Last matching segment found ends at [${ie.x}, ${ie.y}].`)}if(k.length===1){p=k[0].otherSE;break}let F=null;for(let H=0,ie=M.length;H<ie;H++)if(M[H].point===o.point){F=H;break}if(F!==null){const H=M.splice(F)[0],ie=_.splice(H.index);ie.unshift(ie[0].otherSE),n.push(new $2(ie.reverse()));continue}M.push({index:_.length,point:o.point});const j=o.getLeftmostComparator(l);p=k.sort(j)[0].otherSE;break}n.push(new $2(_))}return n}constructor(e){this.events=e;for(let n=0,r=e.length;n<r;n++)e[n].segment.ringOut=this;this.poly=null}getGeom(){let e=this.events[0].point;const n=[e];for(let _=1,C=this.events.length-1;_<C;_++){const M=this.events[_].point,k=this.events[_+1].point;C8(M,e,k)!==0&&(n.push(M),e=M)}if(n.length===1)return null;const r=n[0],i=n[1];C8(r,e,i)===0&&n.shift(),n.push(n[0]);const s=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:n.length-1,o=this.isExteriorRing()?n.length:-1,p=[];for(let _=l;_!=o;_+=s)p.push([n[_].x,n[_].y]);return p}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let e=this.events[0];for(let i=1,s=this.events.length;i<s;i++){const l=this.events[i];gl.compare(e,l)>0&&(e=l)}let n=e.segment.prevInResult(),r=n?n.prevInResult():null;for(;;){if(!n)return null;if(!r)return n.ringOut;if(r.ringOut!==n.ringOut)return r.ringOut.enclosingRing()!==n.ringOut?n.ringOut:n.ringOut.enclosingRing();n=r.prevInResult(),r=n?n.prevInResult():null}}}class L8{constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(let n=0,r=this.interiorRings.length;n<r;n++){const i=this.interiorRings[n].getGeom();i!==null&&e.push(i)}return e}}class ime{constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,r=this.polys.length;n<r;n++){const i=this.polys[n].getGeom();i!==null&&e.push(i)}return e}_composePolys(e){const n=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s.poly)if(s.isExteriorRing())n.push(new L8(s));else{const l=s.enclosingRing();l.poly||n.push(new L8(l)),l.poly.addInterior(s)}}return n}}class sme{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mh.compare;this.queue=e,this.tree=new w4(n),this.segments=[]}process(e){const n=e.segment,r=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(n),r;const i=e.isLeft?this.tree.add(n):this.tree.find(n);if(!i)throw new Error(`Unable to find segment #${n.id} [${n.leftSE.point.x}, ${n.leftSE.point.y}] -> [${n.rightSE.point.x}, ${n.rightSE.point.y}] in SweepLine tree.`);let s=i,l=i,o,p;for(;o===void 0;)s=this.tree.prev(s),s===null?o=null:s.key.consumedBy===void 0&&(o=s.key);for(;p===void 0;)l=this.tree.next(l),l===null?p=null:l.key.consumedBy===void 0&&(p=l.key);if(e.isLeft){let _=null;if(o){const M=o.getIntersection(n);if(M!==null&&(n.isAnEndpoint(M)||(_=M),!o.isAnEndpoint(M))){const k=this._splitSafely(o,M);for(let F=0,j=k.length;F<j;F++)r.push(k[F])}}let C=null;if(p){const M=p.getIntersection(n);if(M!==null&&(n.isAnEndpoint(M)||(C=M),!p.isAnEndpoint(M))){const k=this._splitSafely(p,M);for(let F=0,j=k.length;F<j;F++)r.push(k[F])}}if(_!==null||C!==null){let M=null;_===null?M=C:C===null?M=_:M=gl.comparePoints(_,C)<=0?_:C,this.queue.remove(n.rightSE),r.push(n.rightSE);const k=n.split(M);for(let F=0,j=k.length;F<j;F++)r.push(k[F])}r.length>0?(this.tree.remove(n),r.push(e)):(this.segments.push(n),n.prev=o)}else{if(o&&p){const _=o.getIntersection(p);if(_!==null){if(!o.isAnEndpoint(_)){const C=this._splitSafely(o,_);for(let M=0,k=C.length;M<k;M++)r.push(C[M])}if(!p.isAnEndpoint(_)){const C=this._splitSafely(p,_);for(let M=0,k=C.length;M<k;M++)r.push(C[M])}}}this.tree.remove(n)}return r}_splitSafely(e,n){this.tree.remove(e);const r=e.rightSE;this.queue.remove(r);const i=e.split(n);return i.push(r),e.consumedBy===void 0&&this.tree.add(e),i}}const D8=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,ome=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class ame{run(e,n,r){uA.type=e,wm.reset();const i=[new I8(n,!0)];for(let M=0,k=r.length;M<k;M++)i.push(new I8(r[M],!1));if(uA.numMultiPolys=i.length,uA.type==="difference"){const M=i[0];let k=1;for(;k<i.length;)XE(i[k].bbox,M.bbox)!==null?k++:i.splice(k,1)}if(uA.type==="intersection")for(let M=0,k=i.length;M<k;M++){const F=i[M];for(let j=M+1,H=i.length;j<H;j++)if(XE(F.bbox,i[j].bbox)===null)return[]}const s=new w4(gl.compare);for(let M=0,k=i.length;M<k;M++){const F=i[M].getSweepEvents();for(let j=0,H=F.length;j<H;j++)if(s.insert(F[j]),s.size>D8)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const l=new sme(s);let o=s.size,p=s.pop();for(;p;){const M=p.key;if(s.size===o){const F=M.segment;throw new Error(`Unable to pop() ${M.isLeft?"left":"right"} SweepEvent [${M.point.x}, ${M.point.y}] from segment #${F.id} [${F.leftSE.point.x}, ${F.leftSE.point.y}] -> [${F.rightSE.point.x}, ${F.rightSE.point.y}] from queue.`)}if(s.size>D8)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(l.segments.length>ome)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const k=l.process(M);for(let F=0,j=k.length;F<j;F++){const H=k[F];H.consumedBy===void 0&&s.insert(H)}o=s.size,p=s.pop()}wm.reset();const _=$2.factory(l.segments);return new ime(_).getGeom()}}const uA=new ame,lme=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return uA.run("union",t,n)},Ame=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return uA.run("intersection",t,n)},ume=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return uA.run("xor",t,n)},cme=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return uA.run("difference",t,n)};var hme={union:lme,intersection:Ame,xor:ume,difference:cme};function L7(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function fme(t,e,n){n===void 0&&(n={});for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<s[s.length-1].length;l++)if(s[s.length-1][l]!==s[0][l])throw new Error("First and last Position are not equivalent.")}var o={type:"Polygon",coordinates:t};return L7(o,e,n)}function dme(t,e,n){n===void 0&&(n={});var r={type:"MultiPolygon",coordinates:t};return L7(r,e,n)}function R8(t){return t.type==="Feature"?t.geometry:t}function j2(t,e,n){n===void 0&&(n={});var r=R8(t),i=R8(e),s=hme.intersection(r.coordinates,i.coordinates);return s.length===0?null:s.length===1?fme(s[0],n.properties):dme(s,n.properties)}var kt=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(K){return e.locateFile?e.locateFile(K,i):i+K}var l;document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",l=function(Q,te,fe){var a=new XMLHttpRequest;a.open("GET",Q,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status==200||a.status==0&&a.response){te(a.response);return}var Le=Rr(Q);if(Le){te(Le.buffer);return}fe()},a.onerror=fe,a.send(null)};var o=e.print||console.log.bind(console),p=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var _=0,C=function(K){_=K},M=function(){return _},k=8;function F(K,Q,te,fe){switch(te=te||"i8",te.charAt(te.length-1)==="*"&&(te="i32"),te){case"i1":nt[K>>0]=Q;break;case"i8":nt[K>>0]=Q;break;case"i16":pt[K>>1]=Q;break;case"i32":Yt[K>>2]=Q;break;case"i64":Li=[Q>>>0,($r=Q,+nr($r)>=1?$r>0?(cr(+br($r/4294967296),4294967295)|0)>>>0:~~+Qn(($r-+(~~$r>>>0))/4294967296)>>>0:0)],Yt[K>>2]=Li[0],Yt[K+4>>2]=Li[1];break;case"float":Et[K>>2]=Q;break;case"double":un[K>>3]=Q;break;default:Nr("invalid type for setValue: "+te)}}function j(K,Q,te){switch(Q=Q||"i8",Q.charAt(Q.length-1)==="*"&&(Q="i32"),Q){case"i1":return nt[K>>0];case"i8":return nt[K>>0];case"i16":return pt[K>>1];case"i32":return Yt[K>>2];case"i64":return Yt[K>>2];case"float":return Et[K>>2];case"double":return un[K>>3];default:Nr("invalid type for getValue: "+Q)}return null}var H=!1;function ie(K,Q){K||Nr("Assertion failed: "+Q)}function Y(K){var Q=e["_"+K];return ie(Q,"Cannot call unknown function "+K+", make sure it is exported"),Q}function J(K,Q,te,fe,a){var G={string:function(dt){var Dt=0;if(dt!=null&&dt!==0){var Rt=(dt.length<<2)+1;Dt=Gs(Rt),We(dt,Dt,Rt)}return Dt},array:function(dt){var Dt=Gs(dt.length);return Xe(dt,Dt),Dt}};function Le(dt){return Q==="string"?be(dt):Q==="boolean"?!!dt:dt}var ke=Y(K),Pe=[],Ie=0;if(fe)for(var qe=0;qe<fe.length;qe++){var At=G[te[qe]];At?(Ie===0&&(Ie=hi()),Pe[qe]=At(fe[qe])):Pe[qe]=fe[qe]}var Qe=ke.apply(null,Pe);return Qe=Le(Qe),Ie!==0&&Fr(Ie),Qe}function se(K,Q,te,fe){te=te||[];var a=te.every(function(Le){return Le==="number"}),G=Q!=="string";return G&&a&&!fe?Y(K):function(){return J(K,Q,te,arguments)}}var he=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function pe(K,Q,te){for(var fe=Q+te,a=Q;K[a]&&!(a>=fe);)++a;if(a-Q>16&&K.subarray&&he)return he.decode(K.subarray(Q,a));for(var G="";Q<a;){var Le=K[Q++];if(!(Le&128)){G+=String.fromCharCode(Le);continue}var ke=K[Q++]&63;if((Le&224)==192){G+=String.fromCharCode((Le&31)<<6|ke);continue}var Pe=K[Q++]&63;if((Le&240)==224?Le=(Le&15)<<12|ke<<6|Pe:Le=(Le&7)<<18|ke<<12|Pe<<6|K[Q++]&63,Le<65536)G+=String.fromCharCode(Le);else{var Ie=Le-65536;G+=String.fromCharCode(55296|Ie>>10,56320|Ie&1023)}}return G}function be(K,Q){return K?pe(Ze,K,Q):""}function Ge(K,Q,te,fe){if(!(fe>0))return 0;for(var a=te,G=te+fe-1,Le=0;Le<K.length;++Le){var ke=K.charCodeAt(Le);if(ke>=55296&&ke<=57343){var Pe=K.charCodeAt(++Le);ke=65536+((ke&1023)<<10)|Pe&1023}if(ke<=127){if(te>=G)break;Q[te++]=ke}else if(ke<=2047){if(te+1>=G)break;Q[te++]=192|ke>>6,Q[te++]=128|ke&63}else if(ke<=65535){if(te+2>=G)break;Q[te++]=224|ke>>12,Q[te++]=128|ke>>6&63,Q[te++]=128|ke&63}else{if(te+3>=G)break;Q[te++]=240|ke>>18,Q[te++]=128|ke>>12&63,Q[te++]=128|ke>>6&63,Q[te++]=128|ke&63}}return Q[te]=0,te-a}function We(K,Q,te){return Ge(K,Ze,Q,te)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Xe(K,Q){nt.set(K,Q)}function rt(K,Q){return K%Q>0&&(K+=Q-K%Q),K}var Oe,nt,Ze,pt,Yt,Et,un;function _t(K){Oe=K,e.HEAP8=nt=new Int8Array(K),e.HEAP16=pt=new Int16Array(K),e.HEAP32=Yt=new Int32Array(K),e.HEAPU8=Ze=new Uint8Array(K),e.HEAPU16=new Uint16Array(K),e.HEAPU32=new Uint32Array(K),e.HEAPF32=Et=new Float32Array(K),e.HEAPF64=un=new Float64Array(K)}var Tt=5266928,Jt=24016,Ln=e.TOTAL_MEMORY||33554432;e.buffer?Oe=e.buffer:Oe=new ArrayBuffer(Ln),Ln=Oe.byteLength,_t(Oe),Yt[Jt>>2]=Tt;function Tn(K){for(;K.length>0;){var Q=K.shift();if(typeof Q=="function"){Q();continue}var te=Q.func;typeof te=="number"?Q.arg===void 0?e.dynCall_v(te):e.dynCall_vi(te,Q.arg):te(Q.arg===void 0?null:Q.arg)}}var Ir=[],tr=[],ar=[],pr=[];function Gn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Pn(e.preRun.shift());Tn(Ir)}function Mr(){Tn(tr)}function wt(){Tn(ar)}function rn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)xt(e.postRun.shift());Tn(pr)}function Pn(K){Ir.unshift(K)}function xt(K){pr.unshift(K)}var nr=Math.abs,Qn=Math.ceil,br=Math.floor,cr=Math.min,rr=0,ni=null;function $n(K){rr++,e.monitorRunDependencies&&e.monitorRunDependencies(rr)}function Ii(K){if(rr--,e.monitorRunDependencies&&e.monitorRunDependencies(rr),rr==0&&ni){var Q=ni;ni=null,Q()}}e.preloadedImages={},e.preloadedAudios={};var qn=null,Gi="data:application/octet-stream;base64,";function vo(K){return String.prototype.startsWith?K.startsWith(Gi):K.indexOf(Gi)===0}var $r,Li;qn="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var Ho=24032;function As(K){return K}function ht(K){var Q=/\b__Z[\w\d_]+/g;return K.replace(Q,function(te){var fe=te;return te===fe?te:fe+" ["+te+"]"})}function It(){var K=new Error;if(!K.stack){try{throw new Error(0)}catch(Q){K=Q}if(!K.stack)return"(no stack trace available)"}return K.stack.toString()}function Vs(){var K=It();return e.extraStackTrace&&(K+=`
`+e.extraStackTrace()),ht(K)}function Ei(K,Q,te,fe){Nr("Assertion failed: "+be(K)+", at: "+[Q?be(Q):"unknown filename",te,fe?be(fe):"unknown function"])}function zn(){return nt.length}function $i(K,Q,te){Ze.set(Ze.subarray(Q,Q+te),K)}function Di(K){return e.___errno_location&&(Yt[e.___errno_location()>>2]=K),K}function Ri(K){Nr("OOM")}function us(K){try{var Q=new ArrayBuffer(K);return Q.byteLength!=K?void 0:(new Int8Array(Q).set(nt),qr(Q),_t(Q),1)}catch{}}function Lt(K){var Q=zn(),te=16777216,fe=2147483648-te;if(K>fe)return!1;for(var a=16777216,G=Math.max(Q,a);G<K;)G<=536870912?G=rt(2*G,te):G=Math.min(rt((3*G+2147483648)/4,te),fe);var Le=us(G);return!!Le}var Sn=typeof atob=="function"?atob:function(K){var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",te="",fe,a,G,Le,ke,Pe,Ie,qe=0;K=K.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Le=Q.indexOf(K.charAt(qe++)),ke=Q.indexOf(K.charAt(qe++)),Pe=Q.indexOf(K.charAt(qe++)),Ie=Q.indexOf(K.charAt(qe++)),fe=Le<<2|ke>>4,a=(ke&15)<<4|Pe>>2,G=(Pe&3)<<6|Ie,te=te+String.fromCharCode(fe),Pe!==64&&(te=te+String.fromCharCode(a)),Ie!==64&&(te=te+String.fromCharCode(G));while(qe<K.length);return te};function bn(K){try{for(var Q=Sn(K),te=new Uint8Array(Q.length),fe=0;fe<Q.length;++fe)te[fe]=Q.charCodeAt(fe);return te}catch{throw new Error("Converting base64 string to bytes failed.")}}function Rr(K){if(vo(K))return bn(K.slice(Gi.length))}var Ss={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},yn={a:Nr,b:C,c:M,d:Ei,e:Di,f:zn,g:$i,h:Lt,i:Ri,j:As,k:ht,l:us,m:It,n:Vs,o:Ho,p:Jt},Ke=function(K,Q,te){"almost asm";var fe=new K.Int8Array(te),a=new K.Int32Array(te);new K.Uint8Array(te),new K.Float32Array(te);var G=new K.Float64Array(te),Le=Q.p|0,ke=K.Math.floor,Pe=K.Math.abs,Ie=K.Math.sqrt,qe=K.Math.pow,At=K.Math.cos,Qe=K.Math.sin,dt=K.Math.tan,Dt=K.Math.acos,Rt=K.Math.asin,sn=K.Math.atan,jt=K.Math.atan2,pn=K.Math.ceil,qt=K.Math.imul,an=K.Math.min,xn=K.Math.clz32,Ft=Q.b,Ne=Q.c,Mt=Q.d,Ce=Q.e,cn=Q.f,fi=Q.g,ir=Q.h,pa=Q.i,Re=24048;function Qa(A){return fe=new Int8Array(A),a=new Int32Array(A),G=new Float64Array(A),te=A,!0}function we(A){A=A|0;var h=0;return h=Re,Re=Re+A|0,Re=Re+15&-16,h|0}function Wo(){return Re|0}function Cs(A){A=A|0,Re=A}function qa(A,h){A=A|0,Re=A}function Za(A){return A=A|0,(qt(A*3|0,A+1|0)|0)+1|0}function ga(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0;ma(A,h,d,w,0)|0&&(S=(qt(d*3|0,d+1|0)|0)+1|0,L(w|0,0,S<<3|0)|0,b=es(S,4)|0,b&&(ri(A,h,d,w,b,S,0),fn(b)))}function Ml(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var S=0;if(ma(A,h,d,w,b)|0){if(S=(qt(d*3|0,d+1|0)|0)+1|0,L(w|0,0,S<<3|0)|0,b|0){L(b|0,0,S<<2|0)|0,ri(A,h,d,w,b,S,0);return}b=es(S,4)|0,b&&(ri(A,h,d,w,b,S,0),fn(b))}}function ma(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0;if(ue=Re,Re=Re+16|0,ne=ue,S=w,a[S>>2]=A,a[S+4>>2]=h,S=(b|0)!=0,S&&(a[b>>2]=0),zr(A,h)|0)return ne=1,Re=ue,ne|0;a[ne>>2]=0;e:do if((d|0)>=1)if(S)for(W=0,X=1,ae=1,P=0,S=A;;){if(!(P|W)){if(S=me(S,h,4,ne)|0,h=Ne()|0,(S|0)==0&(h|0)==0){S=2;break e}if(zr(S,h)|0){S=1;break e}}if(S=me(S,h,a[16+(W<<2)>>2]|0,ne)|0,h=Ne()|0,(S|0)==0&(h|0)==0){S=2;break e}if(A=w+(ae<<3)|0,a[A>>2]=S,a[A+4>>2]=h,a[b+(ae<<2)>>2]=X,P=P+1|0,A=(P|0)==(X|0),B=W+1|0,V=(B|0)==6,zr(S,h)|0){S=1;break e}if(X=X+(V&A&1)|0,(X|0)>(d|0)){S=0;break}else W=A?V?0:B:W,ae=ae+1|0,P=A?0:P}else for(W=0,X=1,ae=1,P=0,S=A;;){if(!(P|W)){if(S=me(S,h,4,ne)|0,h=Ne()|0,(S|0)==0&(h|0)==0){S=2;break e}if(zr(S,h)|0){S=1;break e}}if(S=me(S,h,a[16+(W<<2)>>2]|0,ne)|0,h=Ne()|0,(S|0)==0&(h|0)==0){S=2;break e}if(A=w+(ae<<3)|0,a[A>>2]=S,a[A+4>>2]=h,P=P+1|0,A=(P|0)==(X|0),B=W+1|0,V=(B|0)==6,zr(S,h)|0){S=1;break e}if(X=X+(V&A&1)|0,(X|0)>(d|0)){S=0;break}else W=A?V?0:B:W,ae=ae+1|0,P=A?0:P}else S=0;while(0);return ne=S,Re=ue,ne|0}function ri(A,h,d,w,b,S,P){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0,S=S|0,P=P|0;var B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0;if(ae=Re,Re=Re+16|0,X=ae,(A|0)==0&(h|0)==0){Re=ae;return}if(B=Xs(A|0,h|0,S|0,((S|0)<0)<<31>>31|0)|0,Ne()|0,V=w+(B<<3)|0,ne=V,ue=a[ne>>2]|0,ne=a[ne+4>>2]|0,W=(ue|0)==(A|0)&(ne|0)==(h|0),!((ue|0)==0&(ne|0)==0|W))do B=(B+1|0)%(S|0)|0,V=w+(B<<3)|0,ue=V,ne=a[ue>>2]|0,ue=a[ue+4>>2]|0,W=(ne|0)==(A|0)&(ue|0)==(h|0);while(!((ne|0)==0&(ue|0)==0|W));if(B=b+(B<<2)|0,W&&(a[B>>2]|0)<=(P|0)){Re=ae;return}if(ue=V,a[ue>>2]=A,a[ue+4>>2]=h,a[B>>2]=P,(P|0)>=(d|0)){Re=ae;return}ue=P+1|0,a[X>>2]=0,ne=me(A,h,2,X)|0,ri(ne,Ne()|0,d,w,b,S,ue),a[X>>2]=0,ne=me(A,h,3,X)|0,ri(ne,Ne()|0,d,w,b,S,ue),a[X>>2]=0,ne=me(A,h,1,X)|0,ri(ne,Ne()|0,d,w,b,S,ue),a[X>>2]=0,ne=me(A,h,5,X)|0,ri(ne,Ne()|0,d,w,b,S,ue),a[X>>2]=0,ne=me(A,h,4,X)|0,ri(ne,Ne()|0,d,w,b,S,ue),a[X>>2]=0,ne=me(A,h,6,X)|0,ri(ne,Ne()|0,d,w,b,S,ue),Re=ae}function me(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0;if((a[w>>2]|0)>0){b=0;do d=Wi(d)|0,b=b+1|0;while((b|0)<(a[w>>2]|0))}B=Ct(A|0,h|0,45)|0,Ne()|0,V=B&127,S=di(A,h)|0,b=Ct(A|0,h|0,52)|0,Ne()|0,b=b&15;e:do if(!b)P=6;else for(;;){if(ae=(15-b|0)*3|0,ne=Ct(A|0,h|0,ae|0)|0,Ne()|0,ne=ne&7,ue=(yi(b)|0)==0,b=b+-1|0,X=Pt(7,0,ae|0)|0,h=h&~(Ne()|0),ae=Pt(a[(ue?464:48)+(ne*28|0)+(d<<2)>>2]|0,0,ae|0)|0,W=Ne()|0,d=a[(ue?672:256)+(ne*28|0)+(d<<2)>>2]|0,A=ae|A&~X,h=W|h,!d){d=0;break e}if(!b){P=6;break}}while(0);(P|0)==6&&(ue=a[880+(V*28|0)+(d<<2)>>2]|0,ne=Pt(ue|0,0,45)|0,A=ne|A,h=Ne()|0|h&-1040385,d=a[4304+(V*28|0)+(d<<2)>>2]|0,(ue&127|0)==127&&(ue=Pt(a[880+(V*28|0)+20>>2]|0,0,45)|0,h=Ne()|0|h&-1040385,d=a[4304+(V*28|0)+20>>2]|0,A=fs(ue|A,h)|0,h=Ne()|0,a[w>>2]=(a[w>>2]|0)+1)),P=Ct(A|0,h|0,45)|0,Ne()|0,P=P&127;e:do if(en(P)|0){t:do if((di(A,h)|0)==1){if((V|0)!=(P|0))if(au(P,a[7728+(V*28|0)>>2]|0)|0){A=Ki(A,h)|0,S=1,h=Ne()|0;break}else{A=fs(A,h)|0,S=1,h=Ne()|0;break}switch(S|0){case 5:{A=Ki(A,h)|0,h=Ne()|0,a[w>>2]=(a[w>>2]|0)+5,S=0;break t}case 3:{A=fs(A,h)|0,h=Ne()|0,a[w>>2]=(a[w>>2]|0)+1,S=0;break t}default:return ne=0,ue=0,Ft(ne|0),ue|0}}else S=0;while(0);if((d|0)>0){b=0;do A=Ti(A,h)|0,h=Ne()|0,b=b+1|0;while((b|0)!=(d|0))}if((V|0)!=(P|0)){if(!(Br(P)|0)){if((S|0)!=0|(di(A,h)|0)!=5)break;a[w>>2]=(a[w>>2]|0)+1;break}switch(B&127){case 8:case 118:break e}(di(A,h)|0)!=3&&(a[w>>2]=(a[w>>2]|0)+1)}}else if((d|0)>0){b=0;do A=fs(A,h)|0,h=Ne()|0,b=b+1|0;while((b|0)!=(d|0))}while(0);return a[w>>2]=((a[w>>2]|0)+d|0)%6|0,ne=h,ue=A,Ft(ne|0),ue|0}function Te(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0;if(ae=Re,Re=Re+16|0,X=ae,!d)return X=w,a[X>>2]=A,a[X+4>>2]=h,X=0,Re=ae,X|0;a[X>>2]=0;e:do if(zr(A,h)|0)A=1;else{if(S=(d|0)>0,S){b=0,W=A;do{if(W=me(W,h,4,X)|0,h=Ne()|0,(W|0)==0&(h|0)==0){A=2;break e}if(b=b+1|0,zr(W,h)|0){A=1;break e}}while((b|0)<(d|0));if(V=w,a[V>>2]=W,a[V+4>>2]=h,V=d+-1|0,S){S=0,P=1,b=W,A=h;do{if(b=me(b,A,2,X)|0,A=Ne()|0,(b|0)==0&(A|0)==0){A=2;break e}if(B=w+(P<<3)|0,a[B>>2]=b,a[B+4>>2]=A,P=P+1|0,zr(b,A)|0){A=1;break e}S=S+1|0}while((S|0)<(d|0));B=0,S=P;do{if(b=me(b,A,3,X)|0,A=Ne()|0,(b|0)==0&(A|0)==0){A=2;break e}if(P=w+(S<<3)|0,a[P>>2]=b,a[P+4>>2]=A,S=S+1|0,zr(b,A)|0){A=1;break e}B=B+1|0}while((B|0)<(d|0));P=0;do{if(b=me(b,A,1,X)|0,A=Ne()|0,(b|0)==0&(A|0)==0){A=2;break e}if(B=w+(S<<3)|0,a[B>>2]=b,a[B+4>>2]=A,S=S+1|0,zr(b,A)|0){A=1;break e}P=P+1|0}while((P|0)<(d|0));P=0;do{if(b=me(b,A,5,X)|0,A=Ne()|0,(b|0)==0&(A|0)==0){A=2;break e}if(B=w+(S<<3)|0,a[B>>2]=b,a[B+4>>2]=A,S=S+1|0,zr(b,A)|0){A=1;break e}P=P+1|0}while((P|0)<(d|0));P=0;do{if(b=me(b,A,4,X)|0,A=Ne()|0,(b|0)==0&(A|0)==0){A=2;break e}if(B=w+(S<<3)|0,a[B>>2]=b,a[B+4>>2]=A,S=S+1|0,zr(b,A)|0){A=1;break e}P=P+1|0}while((P|0)<(d|0));for(P=0;;){if(b=me(b,A,6,X)|0,A=Ne()|0,(b|0)==0&(A|0)==0){A=2;break e}if((P|0)!=(V|0))if(B=w+(S<<3)|0,a[B>>2]=b,a[B+4>>2]=A,!(zr(b,A)|0))S=S+1|0;else{A=1;break e}if(P=P+1|0,(P|0)>=(d|0)){P=W,S=h;break}}}else P=W,b=W,S=h,A=h}else P=w,a[P>>2]=A,a[P+4>>2]=h,P=A,b=A,S=h,A=h;A=((P|0)!=(b|0)|(S|0)!=(A|0))&1}while(0);return X=A,Re=ae,X|0}function Ue(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0;if(S=Re,Re=Re+48|0,b=S+8|0,w=S,B=A,P=a[B+4>>2]|0,d=w,a[d>>2]=a[B>>2],a[d+4>>2]=P,sl(w,b),b=Kn(b,h)|0,h=a[w>>2]|0,w=a[A+8>>2]|0,(w|0)<=0)return B=h,P=(b|0)<(B|0),B=P?B:b,B=B+12|0,Re=S,B|0;d=a[A+12>>2]|0,A=0;do h=(a[d+(A<<3)>>2]|0)+h|0,A=A+1|0;while((A|0)<(w|0));return B=(b|0)<(h|0),B=B?h:b,B=B+12|0,Re=S,B|0}function lt(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0,V=0;if(B=Re,Re=Re+48|0,w=B+8|0,b=B,!(bt(A,h,d)|0)){Re=B;return}if(V=A,S=a[V+4>>2]|0,P=b,a[P>>2]=a[V>>2],a[P+4>>2]=S,sl(b,w),P=Kn(w,h)|0,h=a[b>>2]|0,S=a[A+8>>2]|0,(S|0)>0){b=a[A+12>>2]|0,w=0;do h=(a[b+(w<<3)>>2]|0)+h|0,w=w+1|0;while((w|0)!=(S|0))}if(h=(P|0)<(h|0)?h:P,(h|0)<=-12){Re=B;return}V=h+11|0,L(d|0,0,(((V|0)>0?V:0)<<3)+8|0)|0,Re=B}function bt(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0,Me=0,ve=0,je=0,Se=0,$e=0,xe=0,y=0,m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0;if(de=Re,Re=Re+112|0,U=de+80|0,V=de+72|0,q=de,ee=de+56|0,W=A+8|0,le=Kt((a[W>>2]<<5)+32|0)|0,le||Mt(22848,22448,800,22456),qs(A,le),S=A,w=a[S+4>>2]|0,B=V,a[B>>2]=a[S>>2],a[B+4>>2]=w,sl(V,U),B=Kn(U,h)|0,w=a[V>>2]|0,S=a[W>>2]|0,(S|0)>0){P=a[A+12>>2]|0,b=0;do w=(a[P+(b<<3)>>2]|0)+w|0,b=b+1|0;while((b|0)!=(S|0))}if(B=(B|0)<(w|0)?w:B,O=B+12|0,b=es(O,8)|0,X=es(O,8)|0,a[U>>2]=0,I=A,R=a[I+4>>2]|0,w=V,a[w>>2]=a[I>>2],a[w+4>>2]=R,w=Qt(V,O,h,U,b,X)|0,w|0)return fn(b),fn(X),fn(le),le=w,Re=de,le|0;e:do if((a[W>>2]|0)>0){for(S=A+12|0,w=0;P=Qt((a[S>>2]|0)+(w<<3)|0,O,h,U,b,X)|0,w=w+1|0,!(P|0);)if((w|0)>=(a[W>>2]|0))break e;return fn(b),fn(X),fn(le),le=P,Re=de,le|0}while(0);(B|0)>-12&&L(X|0,0,((O|0)>1?O:1)<<3|0)|0;e:do if((a[U>>2]|0)>0){R=((O|0)<0)<<31>>31,xe=b,y=X,m=b,x=b,E=X,I=b,w=b,ve=b,je=X,Se=X,$e=X,b=X;t:for(;;){for(Me=a[U>>2]|0,ue=0,Ee=0,S=0;;){P=q,B=P+56|0;do a[P>>2]=0,P=P+4|0;while((P|0)<(B|0));if(h=xe+(ue<<3)|0,V=a[h>>2]|0,h=a[h+4>>2]|0,ma(V,h,1,q,0)|0){P=q,B=P+56|0;do a[P>>2]=0,P=P+4|0;while((P|0)<(B|0));P=es(7,4)|0,P|0&&(ri(V,h,1,q,P,7,0),fn(P))}ne=0;do{ae=q+(ne<<3)|0,X=a[ae>>2]|0,ae=a[ae+4>>2]|0;n:do if(!((X|0)==0&(ae|0)==0)){if(V=Xs(X|0,ae|0,O|0,R|0)|0,Ne()|0,P=d+(V<<3)|0,B=P,h=a[B>>2]|0,B=a[B+4>>2]|0,!((h|0)==0&(B|0)==0))for(W=0;;){if((W|0)>(O|0))break t;if((h|0)==(X|0)&(B|0)==(ae|0))break n;if(V=(V+1|0)%(O|0)|0,P=d+(V<<3)|0,B=P,h=a[B>>2]|0,B=a[B+4>>2]|0,(h|0)==0&(B|0)==0)break;W=W+1|0}(X|0)==0&(ae|0)==0||(Qs(X,ae,ee),xu(A,le,ee)|0&&(W=P,a[W>>2]=X,a[W+4>>2]=ae,W=y+(S<<3)|0,a[W>>2]=X,a[W+4>>2]=ae,S=S+1|0))}while(0);ne=ne+1|0}while(ne>>>0<7);if(Ee=Ee+1|0,(Ee|0)>=(Me|0))break;ue=ue+1|0}if((Me|0)>0&&L(m|0,0,Me<<3|0)|0,a[U>>2]=S,(S|0)>0)X=b,ae=$e,ne=I,ue=Se,Ee=je,Me=y,b=ve,$e=w,Se=x,je=m,ve=X,w=ae,I=E,E=ne,x=ue,m=Ee,y=xe,xe=Me;else break e}return fn(x),fn(E),fn(le),le=-1,Re=de,le|0}else w=X;while(0);return fn(le),fn(b),fn(w),le=0,Re=de,le|0}function Qt(A,h,d,w,b,S){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0,S=S|0;var P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0,Me=0,ve=0,je=0,Se=0,$e=0,xe=0,y=0,m=0,x=0,E=0,I=0,R=0,O=0,U=0;if(R=Re,Re=Re+48|0,m=R+32|0,x=R+16|0,E=R,P=a[A>>2]|0,(P|0)<=0)return I=0,Re=R,I|0;je=A+4|0,Se=m+8|0,$e=x+8|0,xe=E+8|0,y=((h|0)<0)<<31>>31,ve=0;e:for(;;){B=a[je>>2]|0,Ee=B+(ve<<4)|0,a[m>>2]=a[Ee>>2],a[m+4>>2]=a[Ee+4>>2],a[m+8>>2]=a[Ee+8>>2],a[m+12>>2]=a[Ee+12>>2],(ve|0)==(P+-1|0)?(a[x>>2]=a[B>>2],a[x+4>>2]=a[B+4>>2],a[x+8>>2]=a[B+8>>2],a[x+12>>2]=a[B+12>>2]):(Ee=B+(ve+1<<4)|0,a[x>>2]=a[Ee>>2],a[x+4>>2]=a[Ee+4>>2],a[x+8>>2]=a[Ee+8>>2],a[x+12>>2]=a[Ee+12>>2]),Ee=Au(m,x,d)|0;t:do if((Ee|0)>0){Me=+(Ee|0),ue=0;n:for(;;){U=+(Ee-ue|0),O=+(ue|0),G[E>>3]=+G[m>>3]*U/Me+ +G[x>>3]*O/Me,G[xe>>3]=+G[Se>>3]*U/Me+ +G[$e>>3]*O/Me,ae=el(E,d)|0,ne=Ne()|0,B=Xs(ae|0,ne|0,h|0,y|0)|0,Ne()|0,P=S+(B<<3)|0,V=P,W=a[V>>2]|0,V=a[V+4>>2]|0;r:do if((W|0)==0&(V|0)==0)I=14;else for(X=0;;){if((X|0)>(h|0)){P=1;break r}if((W|0)==(ae|0)&(V|0)==(ne|0)){P=7;break r}if(B=(B+1|0)%(h|0)|0,P=S+(B<<3)|0,V=P,W=a[V>>2]|0,V=a[V+4>>2]|0,(W|0)==0&(V|0)==0){I=14;break}else X=X+1|0}while(0);switch((I|0)==14&&(I=0,(ae|0)==0&(ne|0)==0?P=7:(a[P>>2]=ae,a[P+4>>2]=ne,P=a[w>>2]|0,X=b+(P<<3)|0,a[X>>2]=ae,a[X+4>>2]=ne,a[w>>2]=P+1,P=0)),P&7){case 7:case 0:break;default:break n}if(ue=ue+1|0,(Ee|0)<=(ue|0)){I=8;break t}}if(P|0){P=-1,I=20;break e}}else I=8;while(0);if((I|0)==8&&(I=0),ve=ve+1|0,P=a[A>>2]|0,(ve|0)>=(P|0)){P=0,I=20;break}}return(I|0)==20?(Re=R,P|0):0}function Dn(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0,V=0,W=0;if(W=Re,Re=Re+176|0,V=W,(h|0)<1){Pr(d,0,0),Re=W;return}P=A,P=Ct(a[P>>2]|0,a[P+4>>2]|0,52)|0,Ne()|0,Pr(d,(h|0)>6?h:6,P&15),P=0;do{if(w=A+(P<<3)|0,ds(a[w>>2]|0,a[w+4>>2]|0,V),w=a[V>>2]|0,(w|0)>0){B=0;do S=V+8+(B<<4)|0,B=B+1|0,w=V+8+(((B|0)%(w|0)|0)<<4)|0,b=Cu(d,w,S)|0,b?Su(d,b)|0:Ic(d,S,w)|0,w=a[V>>2]|0;while((B|0)<(w|0))}P=P+1|0}while((P|0)!=(h|0));Re=W}function Dr(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0;if(S=Re,Re=Re+32|0,w=S,b=S+16|0,Dn(A,h,b),a[d>>2]=0,a[d+4>>2]=0,a[d+8>>2]=0,A=Hl(b)|0,!A){Ea(d)|0,ol(b),Re=S;return}do{h=Dh(d)|0;do Rh(h,A)|0,P=A+16|0,a[w>>2]=a[P>>2],a[w+4>>2]=a[P+4>>2],a[w+8>>2]=a[P+8>>2],a[w+12>>2]=a[P+12>>2],Su(b,A)|0,A=Lc(b,w)|0;while(A|0);A=Hl(b)|0}while(A|0);Ea(d)|0,ol(b),Re=S}function en(A){return A=A|0,a[7728+(A*28|0)+16>>2]|0}function Br(A){return A=A|0,(A|0)==4|(A|0)==117|0}function jn(A){return A=A|0,a[11152+((a[A>>2]|0)*216|0)+((a[A+4>>2]|0)*72|0)+((a[A+8>>2]|0)*24|0)+(a[A+12>>2]<<3)>>2]|0}function TA(A){return A=A|0,a[11152+((a[A>>2]|0)*216|0)+((a[A+4>>2]|0)*72|0)+((a[A+8>>2]|0)*24|0)+(a[A+12>>2]<<3)+4>>2]|0}function SA(A,h){A=A|0,h=h|0,A=7728+(A*28|0)|0,a[h>>2]=a[A>>2],a[h+4>>2]=a[A+4>>2],a[h+8>>2]=a[A+8>>2],a[h+12>>2]=a[A+12>>2]}function CA(A,h){A=A|0,h=h|0;var d=0,w=0;if(h>>>0>20)return h=-1,h|0;do if((a[11152+(h*216|0)>>2]|0)!=(A|0))if((a[11152+(h*216|0)+8>>2]|0)!=(A|0))if((a[11152+(h*216|0)+16>>2]|0)!=(A|0))if((a[11152+(h*216|0)+24>>2]|0)!=(A|0))if((a[11152+(h*216|0)+32>>2]|0)!=(A|0))if((a[11152+(h*216|0)+40>>2]|0)!=(A|0))if((a[11152+(h*216|0)+48>>2]|0)!=(A|0))if((a[11152+(h*216|0)+56>>2]|0)!=(A|0))if((a[11152+(h*216|0)+64>>2]|0)!=(A|0))if((a[11152+(h*216|0)+72>>2]|0)!=(A|0))if((a[11152+(h*216|0)+80>>2]|0)!=(A|0))if((a[11152+(h*216|0)+88>>2]|0)!=(A|0))if((a[11152+(h*216|0)+96>>2]|0)!=(A|0))if((a[11152+(h*216|0)+104>>2]|0)!=(A|0))if((a[11152+(h*216|0)+112>>2]|0)!=(A|0))if((a[11152+(h*216|0)+120>>2]|0)!=(A|0))if((a[11152+(h*216|0)+128>>2]|0)!=(A|0))if((a[11152+(h*216|0)+136>>2]|0)==(A|0))A=2,d=1,w=2;else{if((a[11152+(h*216|0)+144>>2]|0)==(A|0)){A=0,d=2,w=0;break}if((a[11152+(h*216|0)+152>>2]|0)==(A|0)){A=0,d=2,w=1;break}if((a[11152+(h*216|0)+160>>2]|0)==(A|0)){A=0,d=2,w=2;break}if((a[11152+(h*216|0)+168>>2]|0)==(A|0)){A=1,d=2,w=0;break}if((a[11152+(h*216|0)+176>>2]|0)==(A|0)){A=1,d=2,w=1;break}if((a[11152+(h*216|0)+184>>2]|0)==(A|0)){A=1,d=2,w=2;break}if((a[11152+(h*216|0)+192>>2]|0)==(A|0)){A=2,d=2,w=0;break}if((a[11152+(h*216|0)+200>>2]|0)==(A|0)){A=2,d=2,w=1;break}if((a[11152+(h*216|0)+208>>2]|0)==(A|0)){A=2,d=2,w=2;break}else A=-1;return A|0}else A=2,d=1,w=1;else A=2,d=1,w=0;else A=1,d=1,w=2;else A=1,d=1,w=1;else A=1,d=1,w=0;else A=0,d=1,w=2;else A=0,d=1,w=1;else A=0,d=1,w=0;else A=2,d=0,w=2;else A=2,d=0,w=1;else A=2,d=0,w=0;else A=1,d=0,w=2;else A=1,d=0,w=1;else A=1,d=0,w=0;else A=0,d=0,w=2;else A=0,d=0,w=1;else A=0,d=0,w=0;while(0);return h=a[11152+(h*216|0)+(d*72|0)+(A*24|0)+(w<<3)+4>>2]|0,h|0}function au(A,h){return A=A|0,h=h|0,(a[7728+(A*28|0)+20>>2]|0)==(h|0)?(h=1,h|0):(h=(a[7728+(A*28|0)+24>>2]|0)==(h|0),h|0)}function lu(A,h){return A=A|0,h=h|0,a[880+(A*28|0)+(h<<2)>>2]|0}function MA(A,h){return A=A|0,h=h|0,(a[880+(A*28|0)>>2]|0)==(h|0)?(h=0,h|0):(a[880+(A*28|0)+4>>2]|0)==(h|0)?(h=1,h|0):(a[880+(A*28|0)+8>>2]|0)==(h|0)?(h=2,h|0):(a[880+(A*28|0)+12>>2]|0)==(h|0)?(h=3,h|0):(a[880+(A*28|0)+16>>2]|0)==(h|0)?(h=4,h|0):(a[880+(A*28|0)+20>>2]|0)==(h|0)?(h=5,h|0):((a[880+(A*28|0)+24>>2]|0)==(h|0)?6:7)|0}function Pl(){return 122}function kl(A){A=A|0;var h=0,d=0,w=0;h=0;do Pt(h|0,0,45)|0,w=Ne()|0|134225919,d=A+(h<<3)|0,a[d>>2]=-1,a[d+4>>2]=w,h=h+1|0;while((h|0)!=122)}function PA(A){return A=A|0,+G[A+16>>3]<+G[A+24>>3]|0}function kA(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;return d=+G[h>>3],!(d>=+G[A+8>>3])||!(d<=+G[A>>3])?(h=0,h|0):(w=+G[A+16>>3],d=+G[A+24>>3],b=+G[h+8>>3],h=b>=d,A=b<=w&1,w<d?h&&(A=1):h||(A=0),h=(A|0)!=0,h|0)}function Kn(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0,V=0,W=0;P=Re,Re=Re+288|0,d=P+264|0,w=P+96|0,b=P,S=b,B=S+96|0;do a[S>>2]=0,S=S+4|0;while((S|0)<(B|0));return oi(h,b),S=b,B=a[S>>2]|0,S=a[S+4>>2]|0,Qs(B,S,d),ds(B,S,w),V=+Zn(d,w+8|0),G[d>>3]=+G[A>>3],S=d+8|0,G[S>>3]=+G[A+16>>3],G[w>>3]=+G[A+8>>3],B=w+8|0,G[B>>3]=+G[A+24>>3],W=+Zn(d,w),B=~~+pn(+(W*W/+Hr(+ +Pe(+((+G[S>>3]-+G[B>>3])/(+G[d>>3]-+G[w>>3]))),3)/(V*(V*2.59807621135)*.8))),Re=P,(B|0?B:1)|0}function Au(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0,V=0,W=0;B=Re,Re=Re+288|0,w=B+264|0,b=B+96|0,S=B,P=S,V=P+96|0;do a[P>>2]=0,P=P+4|0;while((P|0)<(V|0));return oi(d,S),V=S,P=a[V>>2]|0,V=a[V+4>>2]|0,Qs(P,V,w),ds(P,V,b),W=+Zn(w,b+8|0),V=~~+pn(+(+Zn(A,h)/(W*2))),Re=B,(V|0?V:1)|0}function xc(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0,a[A>>2]=h,a[A+4>>2]=d,a[A+8>>2]=w}function Il(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0;ae=h+8|0,a[ae>>2]=0,V=+G[A>>3],P=+Pe(+V),W=+G[A+8>>3],B=+Pe(+W)/.8660254037844386,P=P+B*.5,d=~~P,A=~~B,P=P-+(d|0),B=B-+(A|0);do if(P<.5)if(P<.3333333333333333)if(a[h>>2]=d,B<(P+1)*.5){a[h+4>>2]=A;break}else{A=A+1|0,a[h+4>>2]=A;break}else if(ne=1-P,A=(!(B<ne)&1)+A|0,a[h+4>>2]=A,ne<=B&B<P*2){d=d+1|0,a[h>>2]=d;break}else{a[h>>2]=d;break}else{if(!(P<.6666666666666666))if(d=d+1|0,a[h>>2]=d,B<P*.5){a[h+4>>2]=A;break}else{A=A+1|0,a[h+4>>2]=A;break}if(B<1-P){if(a[h+4>>2]=A,P*2+-1<B){a[h>>2]=d;break}}else A=A+1|0,a[h+4>>2]=A;d=d+1|0,a[h>>2]=d}while(0);do if(V<0)if(A&1){X=(A+1|0)/2|0,X=jr(d|0,((d|0)<0)<<31>>31|0,X|0,((X|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-((+(X>>>0)+4294967296*+(Ne()|0))*2+1)),a[h>>2]=d;break}else{X=(A|0)/2|0,X=jr(d|0,((d|0)<0)<<31>>31|0,X|0,((X|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-(+(X>>>0)+4294967296*+(Ne()|0))*2),a[h>>2]=d;break}while(0);X=h+4|0,W<0&&(d=d-((A<<1|1|0)/2|0)|0,a[h>>2]=d,A=0-A|0,a[X>>2]=A),w=A-d|0,(d|0)<0?(b=0-d|0,a[X>>2]=w,a[ae>>2]=b,a[h>>2]=0,A=w,d=0):b=0,(A|0)<0&&(d=d-A|0,a[h>>2]=d,b=b-A|0,a[ae>>2]=b,a[X>>2]=0,A=0),S=d-b|0,w=A-b|0,(b|0)<0&&(a[h>>2]=S,a[X>>2]=w,a[ae>>2]=0,A=w,d=S,b=0),w=(A|0)<(d|0)?A:d,w=(b|0)<(w|0)?b:w,!((w|0)<=0)&&(a[h>>2]=d-w,a[X>>2]=A-w,a[ae>>2]=b-w)}function Zr(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0;h=a[A>>2]|0,P=A+4|0,d=a[P>>2]|0,(h|0)<0&&(d=d-h|0,a[P>>2]=d,S=A+8|0,a[S>>2]=(a[S>>2]|0)-h,a[A>>2]=0,h=0),(d|0)<0?(h=h-d|0,a[A>>2]=h,S=A+8|0,b=(a[S>>2]|0)-d|0,a[S>>2]=b,a[P>>2]=0,d=0):(b=A+8|0,S=b,b=a[b>>2]|0),(b|0)<0&&(h=h-b|0,a[A>>2]=h,d=d-b|0,a[P>>2]=d,a[S>>2]=0,b=0),w=(d|0)<(h|0)?d:h,w=(b|0)<(w|0)?b:w,!((w|0)<=0)&&(a[A>>2]=h-w,a[P>>2]=d-w,a[S>>2]=b-w)}function Qo(A,h){A=A|0,h=h|0;var d=0,w=0;w=a[A+8>>2]|0,d=+((a[A+4>>2]|0)-w|0),G[h>>3]=+((a[A>>2]|0)-w|0)-d*.5,G[h+8>>3]=d*.8660254037844386}function On(A,h,d){A=A|0,h=h|0,d=d|0,a[d>>2]=(a[h>>2]|0)+(a[A>>2]|0),a[d+4>>2]=(a[h+4>>2]|0)+(a[A+4>>2]|0),a[d+8>>2]=(a[h+8>>2]|0)+(a[A+8>>2]|0)}function Ms(A,h,d){A=A|0,h=h|0,d=d|0,a[d>>2]=(a[A>>2]|0)-(a[h>>2]|0),a[d+4>>2]=(a[A+4>>2]|0)-(a[h+4>>2]|0),a[d+8>>2]=(a[A+8>>2]|0)-(a[h+8>>2]|0)}function ii(A,h){A=A|0,h=h|0;var d=0,w=0;d=qt(a[A>>2]|0,h)|0,a[A>>2]=d,d=A+4|0,w=qt(a[d>>2]|0,h)|0,a[d>>2]=w,A=A+8|0,h=qt(a[A>>2]|0,h)|0,a[A>>2]=h}function xo(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0;P=a[A>>2]|0,B=(P|0)<0,w=(a[A+4>>2]|0)-(B?P:0)|0,S=(w|0)<0,b=(S?0-w|0:0)+((a[A+8>>2]|0)-(B?P:0))|0,d=(b|0)<0,A=d?0:b,h=(S?0:w)-(d?b:0)|0,b=(B?0:P)-(S?w:0)-(d?b:0)|0,d=(h|0)<(b|0)?h:b,d=(A|0)<(d|0)?A:d,w=(d|0)>0,A=A-(w?d:0)|0,h=h-(w?d:0)|0;e:do switch(b-(w?d:0)|0){case 0:switch(h|0){case 0:return B=A|0?(A|0)==1?1:7:0,B|0;case 1:return B=A|0?(A|0)==1?3:7:2,B|0;default:break e}case 1:switch(h|0){case 0:return B=A|0?(A|0)==1?5:7:4,B|0;case 1:{if(!A)A=6;else break e;return A|0}default:break e}}while(0);return B=7,B|0}function Ll(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0;P=A+8|0,d=a[P>>2]|0,h=(a[A>>2]|0)-d|0,B=A+4|0,d=(a[B>>2]|0)-d|0,w=Xt(+((h*3|0)-d|0)/7)|0,a[A>>2]=w,h=Xt(+((d<<1)+h|0)/7)|0,a[B>>2]=h,a[P>>2]=0,d=h-w|0,(w|0)<0?(S=0-w|0,a[B>>2]=d,a[P>>2]=S,a[A>>2]=0,h=d,w=0,d=S):d=0,(h|0)<0&&(w=w-h|0,a[A>>2]=w,d=d-h|0,a[P>>2]=d,a[B>>2]=0,h=0),S=w-d|0,b=h-d|0,(d|0)<0?(a[A>>2]=S,a[B>>2]=b,a[P>>2]=0,h=b,b=S,d=0):b=w,w=(h|0)<(b|0)?h:b,w=(d|0)<(w|0)?d:w,!((w|0)<=0)&&(a[A>>2]=b-w,a[B>>2]=h-w,a[P>>2]=d-w)}function qo(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0;P=A+8|0,d=a[P>>2]|0,h=(a[A>>2]|0)-d|0,B=A+4|0,d=(a[B>>2]|0)-d|0,w=Xt(+((h<<1)+d|0)/7)|0,a[A>>2]=w,h=Xt(+((d*3|0)-h|0)/7)|0,a[B>>2]=h,a[P>>2]=0,d=h-w|0,(w|0)<0?(S=0-w|0,a[B>>2]=d,a[P>>2]=S,a[A>>2]=0,h=d,w=0,d=S):d=0,(h|0)<0&&(w=w-h|0,a[A>>2]=w,d=d-h|0,a[P>>2]=d,a[B>>2]=0,h=0),S=w-d|0,b=h-d|0,(d|0)<0?(a[A>>2]=S,a[B>>2]=b,a[P>>2]=0,h=b,b=S,d=0):b=w,w=(h|0)<(b|0)?h:b,w=(d|0)<(w|0)?d:w,!((w|0)<=0)&&(a[A>>2]=b-w,a[B>>2]=h-w,a[P>>2]=d-w)}function ya(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0;h=a[A>>2]|0,P=A+4|0,d=a[P>>2]|0,B=A+8|0,w=a[B>>2]|0,b=d+(h*3|0)|0,a[A>>2]=b,d=w+(d*3|0)|0,a[P>>2]=d,h=(w*3|0)+h|0,a[B>>2]=h,w=d-b|0,(b|0)<0?(h=h-b|0,a[P>>2]=w,a[B>>2]=h,a[A>>2]=0,d=w,w=0):w=b,(d|0)<0&&(w=w-d|0,a[A>>2]=w,h=h-d|0,a[B>>2]=h,a[P>>2]=0,d=0),S=w-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=S,a[P>>2]=b,a[B>>2]=0,w=S,h=0):b=d,d=(b|0)<(w|0)?b:w,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=w-d,a[P>>2]=b-d,a[B>>2]=h-d)}function wo(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0;b=a[A>>2]|0,P=A+4|0,h=a[P>>2]|0,B=A+8|0,d=a[B>>2]|0,w=(h*3|0)+b|0,b=d+(b*3|0)|0,a[A>>2]=b,a[P>>2]=w,h=(d*3|0)+h|0,a[B>>2]=h,d=w-b|0,(b|0)<0?(h=h-b|0,a[P>>2]=d,a[B>>2]=h,a[A>>2]=0,b=0):d=w,(d|0)<0&&(b=b-d|0,a[A>>2]=b,h=h-d|0,a[B>>2]=h,a[P>>2]=0,d=0),S=b-h|0,w=d-h|0,(h|0)<0?(a[A>>2]=S,a[P>>2]=w,a[B>>2]=0,b=S,h=0):w=d,d=(w|0)<(b|0)?w:b,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=b-d,a[P>>2]=w-d,a[B>>2]=h-d)}function IA(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0;(h+-1|0)>>>0>=6||(b=(a[15472+(h*12|0)>>2]|0)+(a[A>>2]|0)|0,a[A>>2]=b,B=A+4|0,w=(a[15472+(h*12|0)+4>>2]|0)+(a[B>>2]|0)|0,a[B>>2]=w,P=A+8|0,h=(a[15472+(h*12|0)+8>>2]|0)+(a[P>>2]|0)|0,a[P>>2]=h,d=w-b|0,(b|0)<0?(h=h-b|0,a[B>>2]=d,a[P>>2]=h,a[A>>2]=0,w=0):(d=w,w=b),(d|0)<0&&(w=w-d|0,a[A>>2]=w,h=h-d|0,a[P>>2]=h,a[B>>2]=0,d=0),S=w-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=S,a[B>>2]=b,a[P>>2]=0,w=S,h=0):b=d,d=(b|0)<(w|0)?b:w,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=w-d,a[B>>2]=b-d,a[P>>2]=h-d))}function Ya(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0;b=a[A>>2]|0,P=A+4|0,h=a[P>>2]|0,B=A+8|0,d=a[B>>2]|0,w=h+b|0,b=d+b|0,a[A>>2]=b,a[P>>2]=w,h=d+h|0,a[B>>2]=h,d=w-b|0,(b|0)<0?(h=h-b|0,a[P>>2]=d,a[B>>2]=h,a[A>>2]=0,w=0):(d=w,w=b),(d|0)<0&&(w=w-d|0,a[A>>2]=w,h=h-d|0,a[B>>2]=h,a[P>>2]=0,d=0),S=w-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=S,a[P>>2]=b,a[B>>2]=0,w=S,h=0):b=d,d=(b|0)<(w|0)?b:w,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=w-d,a[P>>2]=b-d,a[B>>2]=h-d)}function Zo(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0;h=a[A>>2]|0,P=A+4|0,w=a[P>>2]|0,B=A+8|0,d=a[B>>2]|0,b=w+h|0,a[A>>2]=b,w=d+w|0,a[P>>2]=w,h=d+h|0,a[B>>2]=h,d=w-b|0,(b|0)<0?(h=h-b|0,a[P>>2]=d,a[B>>2]=h,a[A>>2]=0,w=0):(d=w,w=b),(d|0)<0&&(w=w-d|0,a[A>>2]=w,h=h-d|0,a[B>>2]=h,a[P>>2]=0,d=0),S=w-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=S,a[P>>2]=b,a[B>>2]=0,w=S,h=0):b=d,d=(b|0)<(w|0)?b:w,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=w-d,a[P>>2]=b-d,a[B>>2]=h-d)}function Wi(A){switch(A=A|0,A|0){case 1:{A=5;break}case 5:{A=4;break}case 4:{A=6;break}case 6:{A=2;break}case 2:{A=3;break}case 3:{A=1;break}}return A|0}function Qi(A){switch(A=A|0,A|0){case 1:{A=3;break}case 3:{A=2;break}case 2:{A=6;break}case 6:{A=4;break}case 4:{A=5;break}case 5:{A=1;break}}return A|0}function uu(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0;h=a[A>>2]|0,P=A+4|0,d=a[P>>2]|0,B=A+8|0,w=a[B>>2]|0,b=d+(h<<1)|0,a[A>>2]=b,d=w+(d<<1)|0,a[P>>2]=d,h=(w<<1)+h|0,a[B>>2]=h,w=d-b|0,(b|0)<0?(h=h-b|0,a[P>>2]=w,a[B>>2]=h,a[A>>2]=0,d=w,w=0):w=b,(d|0)<0&&(w=w-d|0,a[A>>2]=w,h=h-d|0,a[B>>2]=h,a[P>>2]=0,d=0),S=w-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=S,a[P>>2]=b,a[B>>2]=0,w=S,h=0):b=d,d=(b|0)<(w|0)?b:w,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=w-d,a[P>>2]=b-d,a[B>>2]=h-d)}function Dl(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0;b=a[A>>2]|0,P=A+4|0,h=a[P>>2]|0,B=A+8|0,d=a[B>>2]|0,w=(h<<1)+b|0,b=d+(b<<1)|0,a[A>>2]=b,a[P>>2]=w,h=(d<<1)+h|0,a[B>>2]=h,d=w-b|0,(b|0)<0?(h=h-b|0,a[P>>2]=d,a[B>>2]=h,a[A>>2]=0,b=0):d=w,(d|0)<0&&(b=b-d|0,a[A>>2]=b,h=h-d|0,a[B>>2]=h,a[P>>2]=0,d=0),S=b-h|0,w=d-h|0,(h|0)<0?(a[A>>2]=S,a[P>>2]=w,a[B>>2]=0,b=S,h=0):w=d,d=(w|0)<(b|0)?w:b,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=b-d,a[P>>2]=w-d,a[B>>2]=h-d)}function bo(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0;return P=(a[A>>2]|0)-(a[h>>2]|0)|0,B=(P|0)<0,w=(a[A+4>>2]|0)-(a[h+4>>2]|0)-(B?P:0)|0,S=(w|0)<0,b=(B?0-P|0:0)+(a[A+8>>2]|0)-(a[h+8>>2]|0)+(S?0-w|0:0)|0,A=(b|0)<0,h=A?0:b,d=(S?0:w)-(A?b:0)|0,b=(B?0:P)-(S?w:0)-(A?b:0)|0,A=(d|0)<(b|0)?d:b,A=(h|0)<(A|0)?h:A,w=(A|0)>0,h=h-(w?A:0)|0,d=d-(w?A:0)|0,A=b-(w?A:0)|0,A=(A|0)>-1?A:0-A|0,d=(d|0)>-1?d:0-d|0,h=(h|0)>-1?h:0-h|0,h=(d|0)>(h|0)?d:h,((A|0)>(h|0)?A:h)|0}function Yo(A,h){A=A|0,h=h|0;var d=0;d=a[A+8>>2]|0,a[h>>2]=(a[A>>2]|0)-d,a[h+4>>2]=(a[A+4>>2]|0)-d}function wc(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0;w=a[A>>2]|0,a[h>>2]=w,A=a[A+4>>2]|0,P=h+4|0,a[P>>2]=A,B=h+8|0,a[B>>2]=0,d=A-w|0,(w|0)<0?(A=0-w|0,a[P>>2]=d,a[B>>2]=A,a[h>>2]=0,w=0):(d=A,A=0),(d|0)<0&&(w=w-d|0,a[h>>2]=w,A=A-d|0,a[B>>2]=A,a[P>>2]=0,d=0),S=w-A|0,b=d-A|0,(A|0)<0?(a[h>>2]=S,a[P>>2]=b,a[B>>2]=0,d=b,b=S,A=0):b=w,w=(d|0)<(b|0)?d:b,w=(A|0)<(w|0)?A:w,!((w|0)<=0)&&(a[h>>2]=b-w,a[P>>2]=d-w,a[B>>2]=A-w)}function cu(A){A=A|0;var h=0,d=0,w=0,b=0;h=A+8|0,b=a[h>>2]|0,d=b-(a[A>>2]|0)|0,a[A>>2]=d,w=A+4|0,A=(a[w>>2]|0)-b|0,a[w>>2]=A,a[h>>2]=0-(A+d)}function Rl(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0;d=a[A>>2]|0,h=0-d|0,a[A>>2]=h,P=A+8|0,a[P>>2]=0,B=A+4|0,w=a[B>>2]|0,b=w+d|0,(d|0)>0?(a[B>>2]=b,a[P>>2]=d,a[A>>2]=0,h=0,w=b):d=0,(w|0)<0?(S=h-w|0,a[A>>2]=S,d=d-w|0,a[P>>2]=d,a[B>>2]=0,b=S-d|0,h=0-d|0,(d|0)<0?(a[A>>2]=b,a[B>>2]=h,a[P>>2]=0,w=h,d=0):(w=0,b=S)):b=h,h=(w|0)<(b|0)?w:b,h=(d|0)<(h|0)?d:h,!((h|0)<=0)&&(a[A>>2]=b-h,a[B>>2]=w-h,a[P>>2]=d-h)}function LA(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;w=Re,Re=Re+16|0,b=w,hu(A,h,d,b),Il(b,d+4|0),Re=w}function hu(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0,P=0,B=0,V=0;if(V=Re,Re=Re+32|0,S=V,jl(A,S),a[d>>2]=0,b=+Ur(15888,S),P=+Ur(15912,S),P<b&&(a[d>>2]=1,b=P),P=+Ur(15936,S),P<b&&(a[d>>2]=2,b=P),P=+Ur(15960,S),P<b&&(a[d>>2]=3,b=P),P=+Ur(15984,S),P<b&&(a[d>>2]=4,b=P),P=+Ur(16008,S),P<b&&(a[d>>2]=5,b=P),P=+Ur(16032,S),P<b&&(a[d>>2]=6,b=P),P=+Ur(16056,S),P<b&&(a[d>>2]=7,b=P),P=+Ur(16080,S),P<b&&(a[d>>2]=8,b=P),P=+Ur(16104,S),P<b&&(a[d>>2]=9,b=P),P=+Ur(16128,S),P<b&&(a[d>>2]=10,b=P),P=+Ur(16152,S),P<b&&(a[d>>2]=11,b=P),P=+Ur(16176,S),P<b&&(a[d>>2]=12,b=P),P=+Ur(16200,S),P<b&&(a[d>>2]=13,b=P),P=+Ur(16224,S),P<b&&(a[d>>2]=14,b=P),P=+Ur(16248,S),P<b&&(a[d>>2]=15,b=P),P=+Ur(16272,S),P<b&&(a[d>>2]=16,b=P),P=+Ur(16296,S),P<b&&(a[d>>2]=17,b=P),P=+Ur(16320,S),P<b&&(a[d>>2]=18,b=P),P=+Ur(16344,S),P<b&&(a[d>>2]=19,b=P),P=+Dt(+(1-b*.5)),P<1e-16){a[w>>2]=0,a[w+4>>2]=0,a[w+8>>2]=0,a[w+12>>2]=0,Re=V;return}if(d=a[d>>2]|0,b=+G[16368+(d*24|0)>>3],b=+gr(b-+gr(+_r(15568+(d<<4)|0,A))),yi(h)|0?B=+gr(b+-.3334731722518321):B=b,b=+dt(+P)/.381966011250105,(h|0)>0){S=0;do b=b*2.6457513110645907,S=S+1|0;while((S|0)!=(h|0))}P=+At(+B)*b,G[w>>3]=P,B=+Qe(+B)*b,G[w+8>>3]=B,Re=V}function Xo(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var S=0,P=0;if(S=+Co(A),S<1e-16){h=15568+(h<<4)|0,a[b>>2]=a[h>>2],a[b+4>>2]=a[h+4>>2],a[b+8>>2]=a[h+8>>2],a[b+12>>2]=a[h+12>>2];return}if(P=+jt(+ +G[A+8>>3],+ +G[A>>3]),(d|0)>0){A=0;do S=S/2.6457513110645907,A=A+1|0;while((A|0)!=(d|0))}w?(S=S/3,d=(yi(d)|0)==0,S=+sn(+((d?S:S/2.6457513110645907)*.381966011250105))):(S=+sn(+(S*.381966011250105)),yi(d)|0&&(P=+gr(P+.3334731722518321))),Bl(15568+(h<<4)|0,+gr(+G[16368+(h*24|0)>>3]-P),S,b)}function Xa(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;w=Re,Re=Re+16|0,b=w,Qo(A+4|0,b),Xo(b,a[A>>2]|0,h,0,d),Re=w}function fu(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0,Me=0,ve=0,je=0,Se=0,$e=0,xe=0,y=0,m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0;if(ee=Re,Re=Re+272|0,S=ee+256|0,Se=ee+240|0,O=ee,U=ee+224|0,q=ee+208|0,$e=ee+176|0,xe=ee+160|0,y=ee+192|0,m=ee+144|0,x=ee+128|0,E=ee+112|0,I=ee+96|0,R=ee+80|0,a[S>>2]=h,a[Se>>2]=a[A>>2],a[Se+4>>2]=a[A+4>>2],a[Se+8>>2]=a[A+8>>2],a[Se+12>>2]=a[A+12>>2],du(Se,S,O),a[b>>2]=0,Se=w+d+((w|0)==5&1)|0,(Se|0)<=(d|0)){Re=ee;return}V=a[S>>2]|0,W=U+4|0,X=$e+4|0,ae=d+5|0,ne=16848+(V<<2)|0,ue=16928+(V<<2)|0,Ee=x+8|0,Me=E+8|0,ve=I+8|0,je=q+4|0,B=d;e:for(;;){P=O+(((B|0)%5|0)<<4)|0,a[q>>2]=a[P>>2],a[q+4>>2]=a[P+4>>2],a[q+8>>2]=a[P+8>>2],a[q+12>>2]=a[P+12>>2];do;while((Eo(q,V,0,1)|0)==2);if((B|0)>(d|0)&(yi(h)|0)!=0){if(a[$e>>2]=a[q>>2],a[$e+4>>2]=a[q+4>>2],a[$e+8>>2]=a[q+8>>2],a[$e+12>>2]=a[q+12>>2],Qo(W,xe),w=a[$e>>2]|0,S=a[17008+(w*80|0)+(a[U>>2]<<2)>>2]|0,a[$e>>2]=a[18608+(w*80|0)+(S*20|0)>>2],P=a[18608+(w*80|0)+(S*20|0)+16>>2]|0,(P|0)>0){A=0;do Ya(X),A=A+1|0;while((A|0)<(P|0))}switch(P=18608+(w*80|0)+(S*20|0)+4|0,a[y>>2]=a[P>>2],a[y+4>>2]=a[P+4>>2],a[y+8>>2]=a[P+8>>2],ii(y,(a[ne>>2]|0)*3|0),On(X,y,X),Zr(X),Qo(X,m),le=+(a[ue>>2]|0),G[x>>3]=le*3,G[Ee>>3]=0,de=le*-1.5,G[E>>3]=de,G[Me>>3]=le*2.598076211353316,G[I>>3]=de,G[ve>>3]=le*-2.598076211353316,a[17008+((a[$e>>2]|0)*80|0)+(a[q>>2]<<2)>>2]|0){case 1:{A=E,w=x;break}case 3:{A=I,w=E;break}case 2:{A=x,w=I;break}default:{A=12;break e}}Tu(xe,m,w,A,R),Xo(R,a[$e>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1}if((B|0)<(ae|0)&&(Qo(je,$e),Xo($e,a[q>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1),a[U>>2]=a[q>>2],a[U+4>>2]=a[q+4>>2],a[U+8>>2]=a[q+8>>2],a[U+12>>2]=a[q+12>>2],B=B+1|0,(B|0)>=(Se|0)){A=3;break}}if((A|0)==3){Re=ee;return}else(A|0)==12&&Mt(22474,22521,581,22531)}function du(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0,V=0;V=Re,Re=Re+128|0,w=V+64|0,b=V,S=w,P=20208,B=S+60|0;do a[S>>2]=a[P>>2],S=S+4|0,P=P+4|0;while((S|0)<(B|0));S=b,P=20272,B=S+60|0;do a[S>>2]=a[P>>2],S=S+4|0,P=P+4|0;while((S|0)<(B|0));B=(yi(a[h>>2]|0)|0)==0,w=B?w:b,b=A+4|0,uu(b),Dl(b),yi(a[h>>2]|0)|0&&(wo(b),a[h>>2]=(a[h>>2]|0)+1),a[d>>2]=a[A>>2],h=d+4|0,On(b,w,h),Zr(h),a[d+16>>2]=a[A>>2],h=d+20|0,On(b,w+12|0,h),Zr(h),a[d+32>>2]=a[A>>2],h=d+36|0,On(b,w+24|0,h),Zr(h),a[d+48>>2]=a[A>>2],h=d+52|0,On(b,w+36|0,h),Zr(h),a[d+64>>2]=a[A>>2],d=d+68|0,On(b,w+48|0,d),Zr(d),Re=V}function Eo(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0;if(Ee=Re,Re=Re+32|0,ne=Ee+12|0,B=Ee,ue=A+4|0,ae=a[16928+(h<<2)>>2]|0,X=(w|0)!=0,ae=X?ae*3|0:ae,b=a[ue>>2]|0,W=A+8|0,P=a[W>>2]|0,X){if(S=A+12|0,w=a[S>>2]|0,b=P+b+w|0,(b|0)==(ae|0))return ue=1,Re=Ee,ue|0;V=S}else V=A+12|0,w=a[V>>2]|0,b=P+b+w|0;if((b|0)<=(ae|0))return ue=0,Re=Ee,ue|0;do if((w|0)>0){if(w=a[A>>2]|0,(P|0)>0){S=18608+(w*80|0)+60|0,w=A;break}w=18608+(w*80|0)+40|0,d?(xc(ne,ae,0,0),Ms(ue,ne,B),Zo(B),On(B,ne,ue),S=w,w=A):(S=w,w=A)}else S=18608+((a[A>>2]|0)*80|0)+20|0,w=A;while(0);if(a[w>>2]=a[S>>2],b=S+16|0,(a[b>>2]|0)>0){w=0;do Ya(ue),w=w+1|0;while((w|0)<(a[b>>2]|0))}return A=S+4|0,a[ne>>2]=a[A>>2],a[ne+4>>2]=a[A+4>>2],a[ne+8>>2]=a[A+8>>2],h=a[16848+(h<<2)>>2]|0,ii(ne,X?h*3|0:h),On(ue,ne,ue),Zr(ue),X?w=((a[W>>2]|0)+(a[ue>>2]|0)+(a[V>>2]|0)|0)==(ae|0)?1:2:w=2,ue=w,Re=Ee,ue|0}function _a(A,h){A=A|0,h=h|0;var d=0;do d=Eo(A,h,0,1)|0;while((d|0)==2);return d|0}function pu(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0,Me=0,ve=0,je=0,Se=0,$e=0,xe=0,y=0,m=0,x=0,E=0,I=0,R=0,O=0;if(I=Re,Re=Re+240|0,S=I+224|0,y=I+208|0,m=I,x=I+192|0,E=I+176|0,ve=I+160|0,je=I+144|0,Se=I+128|0,$e=I+112|0,xe=I+96|0,a[S>>2]=h,a[y>>2]=a[A>>2],a[y+4>>2]=a[A+4>>2],a[y+8>>2]=a[A+8>>2],a[y+12>>2]=a[A+12>>2],va(y,S,m),a[b>>2]=0,Me=w+d+((w|0)==6&1)|0,(Me|0)<=(d|0)){Re=I;return}V=a[S>>2]|0,W=d+6|0,X=16928+(V<<2)|0,ae=je+8|0,ne=Se+8|0,ue=$e+8|0,Ee=x+4|0,P=0,B=d,w=-1;e:for(;;){if(S=(B|0)%6|0,A=m+(S<<4)|0,a[x>>2]=a[A>>2],a[x+4>>2]=a[A+4>>2],a[x+8>>2]=a[A+8>>2],a[x+12>>2]=a[A+12>>2],A=P,P=Eo(x,V,0,1)|0,(B|0)>(d|0)&(yi(h)|0)!=0&&(A|0)!=1&&(a[x>>2]|0)!=(w|0)){switch(Qo(m+(((S+5|0)%6|0)<<4)+4|0,E),Qo(m+(S<<4)+4|0,ve),R=+(a[X>>2]|0),G[je>>3]=R*3,G[ae>>3]=0,O=R*-1.5,G[Se>>3]=O,G[ne>>3]=R*2.598076211353316,G[$e>>3]=O,G[ue>>3]=R*-2.598076211353316,S=a[y>>2]|0,a[17008+(S*80|0)+(((w|0)==(S|0)?a[x>>2]|0:w)<<2)>>2]|0){case 1:{A=Se,w=je;break}case 3:{A=$e,w=Se;break}case 2:{A=je,w=$e;break}default:{A=8;break e}}Tu(E,ve,w,A,xe),!(Sa(E,xe)|0)&&!(Sa(ve,xe)|0)&&(Xo(xe,a[y>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1)}if((B|0)<(W|0)&&(Qo(Ee,E),Xo(E,a[x>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1),B=B+1|0,(B|0)>=(Me|0)){A=3;break}else w=a[x>>2]|0}if((A|0)==3){Re=I;return}else(A|0)==8&&Mt(22557,22521,746,22602)}function va(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0,V=0;V=Re,Re=Re+160|0,w=V+80|0,b=V,S=w,P=20336,B=S+72|0;do a[S>>2]=a[P>>2],S=S+4|0,P=P+4|0;while((S|0)<(B|0));S=b,P=20416,B=S+72|0;do a[S>>2]=a[P>>2],S=S+4|0,P=P+4|0;while((S|0)<(B|0));B=(yi(a[h>>2]|0)|0)==0,w=B?w:b,b=A+4|0,uu(b),Dl(b),yi(a[h>>2]|0)|0&&(wo(b),a[h>>2]=(a[h>>2]|0)+1),a[d>>2]=a[A>>2],h=d+4|0,On(b,w,h),Zr(h),a[d+16>>2]=a[A>>2],h=d+20|0,On(b,w+12|0,h),Zr(h),a[d+32>>2]=a[A>>2],h=d+36|0,On(b,w+24|0,h),Zr(h),a[d+48>>2]=a[A>>2],h=d+52|0,On(b,w+36|0,h),Zr(h),a[d+64>>2]=a[A>>2],h=d+68|0,On(b,w+48|0,h),Zr(h),a[d+80>>2]=a[A>>2],d=d+84|0,On(b,w+60|0,d),Zr(d),Re=V}function gr(A){A=+A;var h=0;return h=A<0?A+6.283185307179586:A,+(A>=6.283185307179586?h+-6.283185307179586:h)}function js(A,h){return A=A|0,h=h|0,+Pe(+(+G[A>>3]-+G[h>>3]))<17453292519943298e-27?(h=+Pe(+(+G[A+8>>3]-+G[h+8>>3]))<17453292519943298e-27,h|0):(h=0,h|0)}function Hn(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0;return b=+G[h>>3],w=+G[A>>3],S=+Qe(+((b-w)*.5)),d=+Qe(+((+G[h+8>>3]-+G[A+8>>3])*.5)),d=S*S+d*(+At(+b)*+At(+w)*d),+(+jt(+ +Ie(+d),+ +Ie(+(1-d)))*2)}function Zn(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0;return b=+G[h>>3],w=+G[A>>3],S=+Qe(+((b-w)*.5)),d=+Qe(+((+G[h+8>>3]-+G[A+8>>3])*.5)),d=S*S+d*(+At(+b)*+At(+w)*d),+(+jt(+ +Ie(+d),+ +Ie(+(1-d)))*2*6371.007180918475)}function Tr(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0;return b=+G[h>>3],w=+G[A>>3],S=+Qe(+((b-w)*.5)),d=+Qe(+((+G[h+8>>3]-+G[A+8>>3])*.5)),d=S*S+d*(+At(+b)*+At(+w)*d),+(+jt(+ +Ie(+d),+ +Ie(+(1-d)))*2*6371.007180918475*1e3)}function _r(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0;return S=+G[h>>3],w=+At(+S),b=+G[h+8>>3]-+G[A+8>>3],P=w*+Qe(+b),d=+G[A>>3],+ +jt(+P,+(+Qe(+S)*+At(+d)-+At(+b)*(w*+Qe(+d))))}function Bl(A,h,d,w){A=A|0,h=+h,d=+d,w=w|0;var b=0,S=0,P=0,B=0;if(d<1e-16){a[w>>2]=a[A>>2],a[w+4>>2]=a[A+4>>2],a[w+8>>2]=a[A+8>>2],a[w+12>>2]=a[A+12>>2];return}S=h<0?h+6.283185307179586:h,S=h>=6.283185307179586?S+-6.283185307179586:S;do if(S<1e-16)h=+G[A>>3]+d,G[w>>3]=h,b=w;else{if(b=+Pe(+(S+-3.141592653589793))<1e-16,h=+G[A>>3],b){h=h-d,G[w>>3]=h,b=w;break}if(P=+At(+d),d=+Qe(+d),h=P*+Qe(+h)+ +At(+S)*(d*+At(+h)),h=h>1?1:h,h=+Rt(+(h<-1?-1:h)),G[w>>3]=h,+Pe(+(h+-1.5707963267948966))<1e-16){G[w>>3]=1.5707963267948966,G[w+8>>3]=0;return}if(+Pe(+(h+1.5707963267948966))<1e-16){G[w>>3]=-1.5707963267948966,G[w+8>>3]=0;return}if(B=+At(+h),S=d*+Qe(+S)/B,d=+G[A>>3],h=(P-+Qe(+h)*+Qe(+d))/+At(+d)/B,P=S>1?1:S,h=h>1?1:h,h=+G[A+8>>3]+ +jt(+(P<-1?-1:P),+(h<-1?-1:h)),h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);G[w+8>>3]=h;return}while(0);if(+Pe(+(h+-1.5707963267948966))<1e-16){G[b>>3]=1.5707963267948966,G[w+8>>3]=0;return}if(+Pe(+(h+1.5707963267948966))<1e-16){G[b>>3]=-1.5707963267948966,G[w+8>>3]=0;return}if(h=+G[A+8>>3],h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);G[w+8>>3]=h}function Ko(A){return A=A|0,+ +G[20496+(A<<3)>>3]}function bc(A){return A=A|0,+ +G[20624+(A<<3)>>3]}function Ka(A){return A=A|0,+ +G[20752+(A<<3)>>3]}function Ec(A){return A=A|0,+ +G[20880+(A<<3)>>3]}function gu(A){A=A|0;var h=0;return h=21008+(A<<3)|0,A=a[h>>2]|0,Ft(a[h+4>>2]|0),A|0}function Hs(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0;return ne=+G[h>>3],X=+G[A>>3],V=+Qe(+((ne-X)*.5)),S=+G[h+8>>3],W=+G[A+8>>3],P=+Qe(+((S-W)*.5)),B=+At(+X),ae=+At(+ne),P=V*V+P*(ae*B*P),P=+jt(+ +Ie(+P),+ +Ie(+(1-P)))*2,V=+G[d>>3],ne=+Qe(+((V-ne)*.5)),w=+G[d+8>>3],S=+Qe(+((w-S)*.5)),b=+At(+V),S=ne*ne+S*(ae*b*S),S=+jt(+ +Ie(+S),+ +Ie(+(1-S)))*2,V=+Qe(+((X-V)*.5)),w=+Qe(+((W-w)*.5)),w=V*V+w*(B*b*w),w=+jt(+ +Ie(+w),+ +Ie(+(1-w)))*2,b=(P+S+w)*.5,+(+sn(+ +Ie(+(+dt(+(b*.5))*+dt(+((b-P)*.5))*+dt(+((b-S)*.5))*+dt(+((b-w)*.5)))))*4)}function zl(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0;if(S=Re,Re=Re+192|0,w=S+168|0,b=S,Qs(A,h,w),ds(A,h,b),h=a[b>>2]|0,(h|0)<=0)return d=0,Re=S,+d;if(d=+Hs(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,w)+0,(h|0)==1)return Re=S,+d;A=1;do P=A,A=A+1|0,d=d+ +Hs(b+8+(P<<4)|0,b+8+(((A|0)%(h|0)|0)<<4)|0,w);while((A|0)<(h|0));return Re=S,+d}function Ja(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0;if(S=Re,Re=Re+192|0,w=S+168|0,b=S,Qs(A,h,w),ds(A,h,b),h=a[b>>2]|0,(h|0)>0){if(d=+Hs(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,w)+0,(h|0)!=1){A=1;do P=A,A=A+1|0,d=d+ +Hs(b+8+(P<<4)|0,b+8+(((A|0)%(h|0)|0)<<4)|0,w);while((A|0)<(h|0))}}else d=0;return Re=S,+(d*6371.007180918475*6371.007180918475)}function xa(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0;if(S=Re,Re=Re+192|0,w=S+168|0,b=S,Qs(A,h,w),ds(A,h,b),h=a[b>>2]|0,(h|0)>0){if(d=+Hs(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,w)+0,(h|0)!=1){A=1;do P=A,A=A+1|0,d=d+ +Hs(b+8+(P<<4)|0,b+8+(((A|0)%(h|0)|0)<<4)|0,w);while((A|0)<(h|0))}}else d=0;return Re=S,+(d*6371.007180918475*6371.007180918475*1e3*1e3)}function Ol(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0,V=0,W=0;if(P=Re,Re=Re+176|0,S=P,rl(A,h,S),A=a[S>>2]|0,(A|0)<=1)return b=0,Re=P,+b;h=A+-1|0,A=0,d=0,w=+G[S+8>>3],b=+G[S+16>>3];do A=A+1|0,V=w,w=+G[S+8+(A<<4)>>3],W=+Qe(+((w-V)*.5)),B=b,b=+G[S+8+(A<<4)+8>>3],B=+Qe(+((b-B)*.5)),B=W*W+B*(+At(+w)*+At(+V)*B),d=d+ +jt(+ +Ie(+B),+ +Ie(+(1-B)))*2;while((A|0)<(h|0));return Re=P,+d}function Fl(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0,V=0,W=0;if(P=Re,Re=Re+176|0,S=P,rl(A,h,S),A=a[S>>2]|0,(A|0)<=1)return b=0,Re=P,+b;h=A+-1|0,A=0,d=0,w=+G[S+8>>3],b=+G[S+16>>3];do A=A+1|0,V=w,w=+G[S+8+(A<<4)>>3],W=+Qe(+((w-V)*.5)),B=b,b=+G[S+8+(A<<4)+8>>3],B=+Qe(+((b-B)*.5)),B=W*W+B*(+At(+V)*+At(+w)*B),d=d+ +jt(+ +Ie(+B),+ +Ie(+(1-B)))*2;while((A|0)!=(h|0));return W=d*6371.007180918475,Re=P,+W}function vr(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0,V=0,W=0;if(P=Re,Re=Re+176|0,S=P,rl(A,h,S),A=a[S>>2]|0,(A|0)<=1)return b=0,Re=P,+b;h=A+-1|0,A=0,d=0,w=+G[S+8>>3],b=+G[S+16>>3];do A=A+1|0,V=w,w=+G[S+8+(A<<4)>>3],W=+Qe(+((w-V)*.5)),B=b,b=+G[S+8+(A<<4)+8>>3],B=+Qe(+((b-B)*.5)),B=W*W+B*(+At(+V)*+At(+w)*B),d=d+ +jt(+ +Ie(+B),+ +Ie(+(1-B)))*2;while((A|0)!=(h|0));return W=d*6371.007180918475*1e3,Re=P,+W}function DA(A,h){return A=A|0,h=h|0,h=Ct(A|0,h|0,52)|0,Ne()|0,h&15|0}function hs(A,h){return A=A|0,h=h|0,h=Ct(A|0,h|0,45)|0,Ne()|0,h&127|0}function mu(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0;if(!(!0&(h&-16777216|0)==134217728)||(P=Ct(A|0,h|0,45)|0,Ne()|0,P=P&127,P>>>0>121))return h=0,h|0;d=Ct(A|0,h|0,52)|0,Ne()|0,d=d&15;do if(d|0){for(b=1,w=0;;){if(S=Ct(A|0,h|0,(15-b|0)*3|0)|0,Ne()|0,S=S&7,(S|0)!=0&(w^1))if((S|0)==1&(en(P)|0)!=0){B=0,w=13;break}else w=1;if((S|0)==7){B=0,w=13;break}if(b>>>0<d>>>0)b=b+1|0;else{w=9;break}}if((w|0)==9){if((d|0)==15)B=1;else break;return B|0}else if((w|0)==13)return B|0}while(0);for(;;){if(B=Ct(A|0,h|0,(14-d|0)*3|0)|0,Ne()|0,!((B&7|0)==7&!0)){B=0,w=13;break}if(d>>>0<14)d=d+1|0;else{B=1,w=13;break}}return(w|0)==13?B|0:0}function Nl(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;if(w=Ct(A|0,h|0,52)|0,Ne()|0,w=w&15,(w|0)>=(d|0)){if((w|0)!=(d|0))if(d>>>0<=15){if(b=Pt(d|0,0,52)|0,A=b|A,h=Ne()|0|h&-15728641,(w|0)>(d|0))do b=Pt(7,0,(14-d|0)*3|0)|0,d=d+1|0,A=b|A,h=Ne()|0|h;while((d|0)<(w|0))}else h=0,A=0}else h=0,A=0;return Ft(h|0),A|0}function Tc(A,h,d){return A=A|0,h=h|0,d=d|0,A=Ct(A|0,h|0,52)|0,Ne()|0,A=A&15,(d|0)<16&(A|0)<=(d|0)?(d=$l(7,d-A|0)|0,d|0):(d=0,d|0)}function Yr(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0,P=0,B=0,V=0,W=0,X=0;if(P=Ct(A|0,h|0,52)|0,Ne()|0,P=P&15,!!((d|0)<16&(P|0)<=(d|0))){if((P|0)==(d|0)){d=w,a[d>>2]=A,a[d+4>>2]=h;return}if(V=$l(7,d-P|0)|0,W=(V|0)/7|0,B=Ct(A|0,h|0,45)|0,Ne()|0,!(en(B&127)|0))S=0;else{e:do if(!P)b=0;else for(S=1;;){if(b=Ct(A|0,h|0,(15-S|0)*3|0)|0,Ne()|0,b=b&7,b|0)break e;if(S>>>0<P>>>0)S=S+1|0;else{b=0;break}}while(0);S=(b|0)==0}if(X=Pt(P+1|0,0,52)|0,b=Ne()|0|h&-15728641,B=(14-P|0)*3|0,h=Pt(7,0,B|0)|0,h=(X|A)&~h,P=b&~(Ne()|0),Yr(h,P,d,w),b=w+(W<<3)|0,!S){X=Pt(1,0,B|0)|0,Yr(X|h,Ne()|0|P,d,b),X=b+(W<<3)|0,V=Pt(2,0,B|0)|0,Yr(V|h,Ne()|0|P,d,X),X=X+(W<<3)|0,V=Pt(3,0,B|0)|0,Yr(V|h,Ne()|0|P,d,X),X=X+(W<<3)|0,V=Pt(4,0,B|0)|0,Yr(V|h,Ne()|0|P,d,X),X=X+(W<<3)|0,V=Pt(5,0,B|0)|0,Yr(V|h,Ne()|0|P,d,X),V=Pt(6,0,B|0)|0,Yr(V|h,Ne()|0|P,d,X+(W<<3)|0);return}S=b+(W<<3)|0,(V|0)>6&&(V=b+8|0,X=(S>>>0>V>>>0?S:V)+-1+(0-b)|0,L(b|0,0,X+8&-8|0)|0,b=V+(X>>>3<<3)|0),X=Pt(2,0,B|0)|0,Yr(X|h,Ne()|0|P,d,b),X=b+(W<<3)|0,V=Pt(3,0,B|0)|0,Yr(V|h,Ne()|0|P,d,X),X=X+(W<<3)|0,V=Pt(4,0,B|0)|0,Yr(V|h,Ne()|0|P,d,X),X=X+(W<<3)|0,V=Pt(5,0,B|0)|0,Yr(V|h,Ne()|0|P,d,X),V=Pt(6,0,B|0)|0,Yr(V|h,Ne()|0|P,d,X+(W<<3)|0)}}function zr(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;if(b=Ct(A|0,h|0,45)|0,Ne()|0,!(en(b&127)|0))return b=0,b|0;b=Ct(A|0,h|0,52)|0,Ne()|0,b=b&15;e:do if(!b)d=0;else for(w=1;;){if(d=Ct(A|0,h|0,(15-w|0)*3|0)|0,Ne()|0,d=d&7,d|0)break e;if(w>>>0<b>>>0)w=w+1|0;else{d=0;break}}while(0);return b=(d|0)==0&1,b|0}function si(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;if(w=Ct(A|0,h|0,52)|0,Ne()|0,w=w&15,(d|0)<16&(w|0)<=(d|0)){if((w|0)!=(d|0)&&(b=Pt(d|0,0,52)|0,A=b|A,h=Ne()|0|h&-15728641,(w|0)<(d|0)))do b=Pt(7,0,(14-w|0)*3|0)|0,w=w+1|0,A=A&~b,h=h&~(Ne()|0);while((w|0)<(d|0))}else h=0,A=0;return Ft(h|0),A|0}function yu(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0,Me=0,ve=0,je=0,Se=0,$e=0,xe=0,y=0,m=0,x=0,E=0;if(!d)return x=0,x|0;if(b=A,w=a[b>>2]|0,b=a[b+4>>2]|0,!0&(b&15728640|0)==0){if((d|0)<=0||(x=h,a[x>>2]=w,a[x+4>>2]=b,(d|0)==1))return x=0,x|0;w=1;do y=A+(w<<3)|0,m=a[y+4>>2]|0,x=h+(w<<3)|0,a[x>>2]=a[y>>2],a[x+4>>2]=m,w=w+1|0;while((w|0)!=(d|0));return w=0,w|0}if(y=d<<3,m=Kt(y)|0,!m)return x=-3,x|0;if(Ks(m|0,A|0,y|0)|0,xe=es(d,8)|0,!xe)return fn(m),x=-3,x|0;w=d;e:for(;;){P=m,X=a[P>>2]|0,P=a[P+4>>2]|0,Se=Ct(X|0,P|0,52)|0,Ne()|0,Se=Se&15,$e=Se+-1|0,je=(w|0)>0;t:do if(je){if(ve=((w|0)<0)<<31>>31,Ee=Pt($e|0,0,52)|0,Me=Ne()|0,$e>>>0>15)for(b=0,A=X,d=P;;){if(!((A|0)==0&(d|0)==0)){if(S=Ct(A|0,d|0,52)|0,Ne()|0,S=S&15,B=(S|0)<($e|0),S=(S|0)==($e|0),W=B?0:S?A:0,A=B?0:S?d:0,d=Xs(W|0,A|0,w|0,ve|0)|0,Ne()|0,S=xe+(d<<3)|0,B=S,V=a[B>>2]|0,B=a[B+4>>2]|0,(V|0)==0&(B|0)==0)d=W;else for(Ee=0,ue=d,ne=B,d=W;;){if((Ee|0)>(w|0)){x=41;break e}if((V|0)==(d|0)&(ne&-117440513|0)==(A|0)){W=Ct(V|0,ne|0,56)|0,Ne()|0,W=W&7,ae=W+1|0,Me=Ct(V|0,ne|0,45)|0,Ne()|0;n:do if(!(en(Me&127)|0))B=7;else{if(V=Ct(V|0,ne|0,52)|0,Ne()|0,V=V&15,!V){B=6;break}for(B=1;;){if(Me=Pt(7,0,(15-B|0)*3|0)|0,!((Me&d|0)==0&((Ne()|0)&A|0)==0)){B=7;break n}if(B>>>0<V>>>0)B=B+1|0;else{B=6;break}}}while(0);if((W+2|0)>>>0>B>>>0){x=51;break e}Me=Pt(ae|0,0,56)|0,A=Ne()|0|A&-117440513,B=S,a[B>>2]=0,a[B+4>>2]=0,B=ue,d=Me|d}else B=(ue+1|0)%(w|0)|0;if(S=xe+(B<<3)|0,ne=S,V=a[ne>>2]|0,ne=a[ne+4>>2]|0,(V|0)==0&(ne|0)==0)break;Ee=Ee+1|0,ue=B}Me=S,a[Me>>2]=d,a[Me+4>>2]=A}if(b=b+1|0,(b|0)>=(w|0))break t;d=m+(b<<3)|0,A=a[d>>2]|0,d=a[d+4>>2]|0}for(b=0,A=X,d=P;;){if(!((A|0)==0&(d|0)==0)){if(B=Ct(A|0,d|0,52)|0,Ne()|0,B=B&15,(B|0)>=($e|0)){if((B|0)!=($e|0)&&(A=A|Ee,d=d&-15728641|Me,B>>>0>=Se>>>0)){S=$e;do ue=Pt(7,0,(14-S|0)*3|0)|0,S=S+1|0,A=ue|A,d=Ne()|0|d;while(S>>>0<B>>>0)}}else A=0,d=0;if(B=Xs(A|0,d|0,w|0,ve|0)|0,Ne()|0,S=xe+(B<<3)|0,V=S,W=a[V>>2]|0,V=a[V+4>>2]|0,!((W|0)==0&(V|0)==0))for(ue=0;;){if((ue|0)>(w|0)){x=41;break e}if((W|0)==(A|0)&(V&-117440513|0)==(d|0)){ae=Ct(W|0,V|0,56)|0,Ne()|0,ae=ae&7,ne=ae+1|0,E=Ct(W|0,V|0,45)|0,Ne()|0;n:do if(!(en(E&127)|0))V=7;else{if(W=Ct(W|0,V|0,52)|0,Ne()|0,W=W&15,!W){V=6;break}for(V=1;;){if(E=Pt(7,0,(15-V|0)*3|0)|0,!((E&A|0)==0&((Ne()|0)&d|0)==0)){V=7;break n}if(V>>>0<W>>>0)V=V+1|0;else{V=6;break}}}while(0);if((ae+2|0)>>>0>V>>>0){x=51;break e}E=Pt(ne|0,0,56)|0,d=Ne()|0|d&-117440513,ne=S,a[ne>>2]=0,a[ne+4>>2]=0,A=E|A}else B=(B+1|0)%(w|0)|0;if(S=xe+(B<<3)|0,V=S,W=a[V>>2]|0,V=a[V+4>>2]|0,(W|0)==0&(V|0)==0)break;ue=ue+1|0}E=S,a[E>>2]=A,a[E+4>>2]=d}if(b=b+1|0,(b|0)>=(w|0))break t;d=m+(b<<3)|0,A=a[d>>2]|0,d=a[d+4>>2]|0}}while(0);if((w+5|0)>>>0<11){x=99;break}if(Me=es((w|0)/6|0,8)|0,!Me){x=58;break}t:do if(je){ue=0,ne=0;do{if(B=xe+(ue<<3)|0,A=B,b=a[A>>2]|0,A=a[A+4>>2]|0,!((b|0)==0&(A|0)==0)){V=Ct(b|0,A|0,56)|0,Ne()|0,V=V&7,d=V+1|0,W=A&-117440513,E=Ct(b|0,A|0,45)|0,Ne()|0;n:do if(en(E&127)|0){if(ae=Ct(b|0,A|0,52)|0,Ne()|0,ae=ae&15,ae|0)for(S=1;;){if(E=Pt(7,0,(15-S|0)*3|0)|0,!((b&E|0)==0&(W&(Ne()|0)|0)==0))break n;if(S>>>0<ae>>>0)S=S+1|0;else break}A=Pt(d|0,0,56)|0,b=A|b,A=Ne()|0|W,d=B,a[d>>2]=b,a[d+4>>2]=A,d=V+2|0}while(0);(d|0)==7&&(E=Me+(ne<<3)|0,a[E>>2]=b,a[E+4>>2]=A&-117440513,ne=ne+1|0)}ue=ue+1|0}while((ue|0)!=(w|0));if(je){if(Ee=((w|0)<0)<<31>>31,ae=Pt($e|0,0,52)|0,ue=Ne()|0,$e>>>0>15)for(A=0,b=0;;){do if(!((X|0)==0&(P|0)==0)){for(V=Ct(X|0,P|0,52)|0,Ne()|0,V=V&15,S=(V|0)<($e|0),V=(V|0)==($e|0),B=S?0:V?X:0,V=S?0:V?P:0,S=Xs(B|0,V|0,w|0,Ee|0)|0,Ne()|0,d=0;;){if((d|0)>(w|0)){x=98;break e}if(E=xe+(S<<3)|0,W=a[E+4>>2]|0,(W&-117440513|0)==(V|0)&&(a[E>>2]|0)==(B|0)){x=70;break}if(S=(S+1|0)%(w|0)|0,E=xe+(S<<3)|0,(a[E>>2]|0)==(B|0)&&(a[E+4>>2]|0)==(V|0))break;d=d+1|0}if((x|0)==70&&(x=0,!0&(W&117440512|0)==100663296))break;E=h+(b<<3)|0,a[E>>2]=X,a[E+4>>2]=P,b=b+1|0}while(0);if(A=A+1|0,(A|0)>=(w|0)){w=ne;break t}P=m+(A<<3)|0,X=a[P>>2]|0,P=a[P+4>>2]|0}for(A=0,b=0;;){do if(!((X|0)==0&(P|0)==0)){if(V=Ct(X|0,P|0,52)|0,Ne()|0,V=V&15,(V|0)>=($e|0))if((V|0)!=($e|0))if(d=X|ae,S=P&-15728641|ue,V>>>0<Se>>>0)V=S;else{B=$e;do E=Pt(7,0,(14-B|0)*3|0)|0,B=B+1|0,d=E|d,S=Ne()|0|S;while(B>>>0<V>>>0);V=S}else d=X,V=P;else d=0,V=0;for(B=Xs(d|0,V|0,w|0,Ee|0)|0,Ne()|0,S=0;;){if((S|0)>(w|0)){x=98;break e}if(E=xe+(B<<3)|0,W=a[E+4>>2]|0,(W&-117440513|0)==(V|0)&&(a[E>>2]|0)==(d|0)){x=93;break}if(B=(B+1|0)%(w|0)|0,E=xe+(B<<3)|0,(a[E>>2]|0)==(d|0)&&(a[E+4>>2]|0)==(V|0))break;S=S+1|0}if((x|0)==93&&(x=0,!0&(W&117440512|0)==100663296))break;E=h+(b<<3)|0,a[E>>2]=X,a[E+4>>2]=P,b=b+1|0}while(0);if(A=A+1|0,(A|0)>=(w|0)){w=ne;break t}P=m+(A<<3)|0,X=a[P>>2]|0,P=a[P+4>>2]|0}}else b=0,w=ne}else b=0,w=0;while(0);if(L(xe|0,0,y|0)|0,Ks(m|0,Me|0,w<<3|0)|0,fn(Me),w)h=h+(b<<3)|0;else break}return(x|0)==41?(fn(m),fn(xe),E=-1,E|0):(x|0)==51?(fn(m),fn(xe),E=-2,E|0):(x|0)==58?(fn(m),fn(xe),E=-3,E|0):(x|0)==98?(fn(Me),fn(m),fn(xe),E=-1,E|0):((x|0)==99&&Ks(h|0,m|0,w<<3|0)|0,fn(m),fn(xe),E=0,E|0)}function Ws(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var S=0,P=0,B=0,V=0,W=0,X=0;if((h|0)<=0)return b=0,b|0;if((b|0)>=16){for(S=0;;){if(X=A+(S<<3)|0,!((a[X>>2]|0)==0&(a[X+4>>2]|0)==0)){S=14;break}if(S=S+1|0,(S|0)>=(h|0)){P=0,S=16;break}}if((S|0)==14)return((w|0)>0?-2:-1)|0;if((S|0)==16)return P|0}S=0,X=0;e:for(;;){W=A+(X<<3)|0,B=W,P=a[B>>2]|0,B=a[B+4>>2]|0;do if(!((P|0)==0&(B|0)==0)){if((S|0)>=(w|0)){P=-1,S=16;break e}if(V=Ct(P|0,B|0,52)|0,Ne()|0,V=V&15,(V|0)>(b|0)){P=-2,S=16;break e}if((V|0)==(b|0)){W=d+(S<<3)|0,a[W>>2]=P,a[W+4>>2]=B,S=S+1|0;break}if(P=($l(7,b-V|0)|0)+S|0,(P|0)>(w|0)){P=-1,S=16;break e}Yr(a[W>>2]|0,a[W+4>>2]|0,b,d+(S<<3)|0),S=P}while(0);if(X=X+1|0,(X|0)>=(h|0)){P=0,S=16;break}}return(S|0)==16?P|0:0}function Sc(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0;if((h|0)<=0)return d=0,d|0;if((d|0)>=16){for(w=0;;){if(P=A+(w<<3)|0,!((a[P>>2]|0)==0&(a[P+4>>2]|0)==0)){w=-1,b=13;break}if(w=w+1|0,(w|0)>=(h|0)){w=0,b=13;break}}if((b|0)==13)return w|0}w=0,P=0;e:for(;;){b=A+(P<<3)|0,S=a[b>>2]|0,b=a[b+4>>2]|0;do if(!((S|0)==0&(b|0)==0)){if(b=Ct(S|0,b|0,52)|0,Ne()|0,b=b&15,(b|0)>(d|0)){w=-1,b=13;break e}if((b|0)==(d|0)){w=w+1|0;break}else{w=($l(7,d-b|0)|0)+w|0;break}}while(0);if(P=P+1|0,(P|0)>=(h|0)){b=13;break}}return(b|0)==13?w|0:0}function RA(A,h){return A=A|0,h=h|0,h=Ct(A|0,h|0,52)|0,Ne()|0,h&1|0}function di(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;if(b=Ct(A|0,h|0,52)|0,Ne()|0,b=b&15,!b)return b=0,b|0;for(w=1;;){if(d=Ct(A|0,h|0,(15-w|0)*3|0)|0,Ne()|0,d=d&7,d|0){w=5;break}if(w>>>0<b>>>0)w=w+1|0;else{d=0,w=5;break}}return(w|0)==5?d|0:0}function Ti(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0,V=0;if(V=Ct(A|0,h|0,52)|0,Ne()|0,V=V&15,!V)return B=h,V=A,Ft(B|0),V|0;for(B=1,d=0;;){S=(15-B|0)*3|0,w=Pt(7,0,S|0)|0,b=Ne()|0,P=Ct(A|0,h|0,S|0)|0,Ne()|0,S=Pt(Wi(P&7)|0,0,S|0)|0,P=Ne()|0,A=S|A&~w,h=P|h&~b;e:do if(!d)if((S&w|0)==0&(P&b|0)==0)d=0;else if(w=Ct(A|0,h|0,52)|0,Ne()|0,w=w&15,!w)d=1;else{d=1;t:for(;;){switch(P=Ct(A|0,h|0,(15-d|0)*3|0)|0,Ne()|0,P&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<w>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(P=(15-d|0)*3|0,b=Ct(A|0,h|0,P|0)|0,Ne()|0,S=Pt(7,0,P|0)|0,h=h&~(Ne()|0),P=Pt(Wi(b&7)|0,0,P|0)|0,A=A&~S|P,h=h|(Ne()|0),d>>>0<w>>>0)d=d+1|0;else{d=1;break}}while(0);if(B>>>0<V>>>0)B=B+1|0;else break}return Ft(h|0),A|0}function fs(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0;if(w=Ct(A|0,h|0,52)|0,Ne()|0,w=w&15,!w)return d=h,w=A,Ft(d|0),w|0;for(d=1;S=(15-d|0)*3|0,P=Ct(A|0,h|0,S|0)|0,Ne()|0,b=Pt(7,0,S|0)|0,h=h&~(Ne()|0),S=Pt(Wi(P&7)|0,0,S|0)|0,A=S|A&~b,h=Ne()|0|h,d>>>0<w>>>0;)d=d+1|0;return Ft(h|0),A|0}function wa(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0,V=0;if(V=Ct(A|0,h|0,52)|0,Ne()|0,V=V&15,!V)return B=h,V=A,Ft(B|0),V|0;for(B=1,d=0;;){S=(15-B|0)*3|0,w=Pt(7,0,S|0)|0,b=Ne()|0,P=Ct(A|0,h|0,S|0)|0,Ne()|0,S=Pt(Qi(P&7)|0,0,S|0)|0,P=Ne()|0,A=S|A&~w,h=P|h&~b;e:do if(!d)if((S&w|0)==0&(P&b|0)==0)d=0;else if(w=Ct(A|0,h|0,52)|0,Ne()|0,w=w&15,!w)d=1;else{d=1;t:for(;;){switch(P=Ct(A|0,h|0,(15-d|0)*3|0)|0,Ne()|0,P&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<w>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(b=(15-d|0)*3|0,S=Pt(7,0,b|0)|0,P=h&~(Ne()|0),h=Ct(A|0,h|0,b|0)|0,Ne()|0,h=Pt(Qi(h&7)|0,0,b|0)|0,A=A&~S|h,h=P|(Ne()|0),d>>>0<w>>>0)d=d+1|0;else{d=1;break}}while(0);if(B>>>0<V>>>0)B=B+1|0;else break}return Ft(h|0),A|0}function Ki(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0;if(w=Ct(A|0,h|0,52)|0,Ne()|0,w=w&15,!w)return d=h,w=A,Ft(d|0),w|0;for(d=1;P=(15-d|0)*3|0,S=Pt(7,0,P|0)|0,b=h&~(Ne()|0),h=Ct(A|0,h|0,P|0)|0,Ne()|0,h=Pt(Qi(h&7)|0,0,P|0)|0,A=h|A&~S,h=Ne()|0|b,d>>>0<w>>>0;)d=d+1|0;return Ft(h|0),A|0}function To(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0;if(V=Re,Re=Re+64|0,B=V+40|0,w=V+24|0,b=V+12|0,S=V,Pt(h|0,0,52)|0,d=Ne()|0|134225919,!h)return(a[A+4>>2]|0)>2||(a[A+8>>2]|0)>2||(a[A+12>>2]|0)>2?(P=0,B=0,Ft(P|0),Re=V,B|0):(Pt(jn(A)|0,0,45)|0,P=Ne()|0|d,B=-1,Ft(P|0),Re=V,B|0);if(a[B>>2]=a[A>>2],a[B+4>>2]=a[A+4>>2],a[B+8>>2]=a[A+8>>2],a[B+12>>2]=a[A+12>>2],P=B+4|0,(h|0)>0)for(A=-1;a[w>>2]=a[P>>2],a[w+4>>2]=a[P+4>>2],a[w+8>>2]=a[P+8>>2],h&1?(Ll(P),a[b>>2]=a[P>>2],a[b+4>>2]=a[P+4>>2],a[b+8>>2]=a[P+8>>2],ya(b)):(qo(P),a[b>>2]=a[P>>2],a[b+4>>2]=a[P+4>>2],a[b+8>>2]=a[P+8>>2],wo(b)),Ms(w,b,S),Zr(S),X=(15-h|0)*3|0,W=Pt(7,0,X|0)|0,d=d&~(Ne()|0),X=Pt(xo(S)|0,0,X|0)|0,A=X|A&~W,d=Ne()|0|d,(h|0)>1;)h=h+-1|0;else A=-1;e:do if((a[P>>2]|0)<=2&&(a[B+8>>2]|0)<=2&&(a[B+12>>2]|0)<=2){if(w=jn(B)|0,h=Pt(w|0,0,45)|0,h=h|A,A=Ne()|0|d&-1040385,S=TA(B)|0,!(en(w)|0)){if((S|0)<=0)break;for(b=0;;){if(w=Ct(h|0,A|0,52)|0,Ne()|0,w=w&15,w)for(d=1;X=(15-d|0)*3|0,B=Ct(h|0,A|0,X|0)|0,Ne()|0,W=Pt(7,0,X|0)|0,A=A&~(Ne()|0),X=Pt(Wi(B&7)|0,0,X|0)|0,h=h&~W|X,A=A|(Ne()|0),d>>>0<w>>>0;)d=d+1|0;if(b=b+1|0,(b|0)==(S|0))break e}}b=Ct(h|0,A|0,52)|0,Ne()|0,b=b&15;t:do if(b){d=1;n:for(;;){switch(X=Ct(h|0,A|0,(15-d|0)*3|0)|0,Ne()|0,X&7){case 1:break n;case 0:break;default:break t}if(d>>>0<b>>>0)d=d+1|0;else break t}if(au(w,a[B>>2]|0)|0)for(d=1;B=(15-d|0)*3|0,W=Pt(7,0,B|0)|0,X=A&~(Ne()|0),A=Ct(h|0,A|0,B|0)|0,Ne()|0,A=Pt(Qi(A&7)|0,0,B|0)|0,h=h&~W|A,A=X|(Ne()|0),d>>>0<b>>>0;)d=d+1|0;else for(d=1;X=(15-d|0)*3|0,B=Ct(h|0,A|0,X|0)|0,Ne()|0,W=Pt(7,0,X|0)|0,A=A&~(Ne()|0),X=Pt(Wi(B&7)|0,0,X|0)|0,h=h&~W|X,A=A|(Ne()|0),d>>>0<b>>>0;)d=d+1|0}while(0);if((S|0)>0){d=0;do h=Ti(h,A)|0,A=Ne()|0,d=d+1|0;while((d|0)!=(S|0))}}else h=0,A=0;while(0);return W=A,X=h,Ft(W|0),Re=V,X|0}function yi(A){return A=A|0,(A|0)%2|0|0}function el(A,h){A=A|0,h=h|0;var d=0,w=0;return w=Re,Re=Re+16|0,d=w,h>>>0<=15&&(a[A+4>>2]&2146435072|0)!=2146435072&&(a[A+8+4>>2]&2146435072|0)!=2146435072?(LA(A,h,d),h=To(d,h)|0,A=Ne()|0):(A=0,h=0),Ft(A|0),Re=w,h|0}function Ul(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0;if(b=d+4|0,S=Ct(A|0,h|0,52)|0,Ne()|0,S=S&15,P=Ct(A|0,h|0,45)|0,Ne()|0,w=(S|0)==0,en(P&127)|0){if(w)return P=1,P|0;w=1}else{if(w)return P=0,P|0;!(a[b>>2]|0)&&!(a[d+8>>2]|0)?w=(a[d+12>>2]|0)!=0&1:w=1}for(d=1;d&1?ya(b):wo(b),P=Ct(A|0,h|0,(15-d|0)*3|0)|0,Ne()|0,IA(b,P&7),d>>>0<S>>>0;)d=d+1|0;return w|0}function tl(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0;X=Re,Re=Re+16|0,V=X,W=Ct(A|0,h|0,45)|0,Ne()|0,W=W&127;e:do if(en(W)|0&&(S=Ct(A|0,h|0,52)|0,Ne()|0,S=S&15,(S|0)!=0)){w=1;t:for(;;){switch(B=Ct(A|0,h|0,(15-w|0)*3|0)|0,Ne()|0,B&7){case 5:break t;case 0:break;default:{w=h;break e}}if(w>>>0<S>>>0)w=w+1|0;else{w=h;break e}}for(b=1,w=h;h=(15-b|0)*3|0,P=Pt(7,0,h|0)|0,B=w&~(Ne()|0),w=Ct(A|0,w|0,h|0)|0,Ne()|0,w=Pt(Qi(w&7)|0,0,h|0)|0,A=A&~P|w,w=B|(Ne()|0),b>>>0<S>>>0;)b=b+1|0}else w=h;while(0);if(B=7728+(W*28|0)|0,a[d>>2]=a[B>>2],a[d+4>>2]=a[B+4>>2],a[d+8>>2]=a[B+8>>2],a[d+12>>2]=a[B+12>>2],!(Ul(A,w,d)|0)){Re=X;return}if(P=d+4|0,a[V>>2]=a[P>>2],a[V+4>>2]=a[P+4>>2],a[V+8>>2]=a[P+8>>2],S=Ct(A|0,w|0,52)|0,Ne()|0,B=S&15,S&1?(wo(P),S=B+1|0):S=B,!(en(W)|0))w=0;else{e:do if(!B)w=0;else for(h=1;;){if(b=Ct(A|0,w|0,(15-h|0)*3|0)|0,Ne()|0,b=b&7,b|0){w=b;break e}if(h>>>0<B>>>0)h=h+1|0;else{w=0;break}}while(0);w=(w|0)==4&1}if(!(Eo(d,S,w,0)|0))(S|0)!=(B|0)&&(a[P>>2]=a[V>>2],a[P+4>>2]=a[V+4>>2],a[P+8>>2]=a[V+8>>2]);else{if(en(W)|0)do;while(Eo(d,S,0,0)|0);(S|0)!=(B|0)&&qo(P)}Re=X}function Qs(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;w=Re,Re=Re+16|0,b=w,tl(A,h,b),h=Ct(A|0,h|0,52)|0,Ne()|0,Xa(b,h&15,d),Re=w}function ds(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0;P=Re,Re=Re+16|0,S=P,tl(A,h,S),w=Ct(A|0,h|0,45)|0,Ne()|0,w=(en(w&127)|0)==0,b=Ct(A|0,h|0,52)|0,Ne()|0,b=b&15;e:do if(!w){if(b|0)for(w=1;;){if(B=Pt(7,0,(15-w|0)*3|0)|0,!((B&A|0)==0&((Ne()|0)&h|0)==0))break e;if(w>>>0<b>>>0)w=w+1|0;else break}fu(S,b,0,5,d),Re=P;return}while(0);pu(S,b,0,6,d),Re=P}function Cc(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;if(w=Ct(A|0,h|0,45)|0,Ne()|0,!(en(w&127)|0))return w=2,w|0;if(w=Ct(A|0,h|0,52)|0,Ne()|0,w=w&15,!w)return w=5,w|0;for(d=1;;){if(b=Pt(7,0,(15-d|0)*3|0)|0,!((b&A|0)==0&((Ne()|0)&h|0)==0)){d=2,A=6;break}if(d>>>0<w>>>0)d=d+1|0;else{d=5,A=6;break}}return(A|0)==6?d|0:0}function ba(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0;ae=Re,Re=Re+128|0,W=ae+112|0,S=ae+96|0,X=ae,b=Ct(A|0,h|0,52)|0,Ne()|0,B=b&15,a[W>>2]=B,P=Ct(A|0,h|0,45)|0,Ne()|0,P=P&127;e:do if(en(P)|0){if(B|0)for(w=1;;){if(V=Pt(7,0,(15-w|0)*3|0)|0,!((V&A|0)==0&((Ne()|0)&h|0)==0)){b=0;break e}if(w>>>0<B>>>0)w=w+1|0;else break}if(b&1)b=1;else{V=Pt(B+1|0,0,52)|0,X=Ne()|0|h&-15728641,W=Pt(7,0,(14-B|0)*3|0)|0,ba((V|A)&~W,X&~(Ne()|0),d),Re=ae;return}}else b=0;while(0);tl(A,h,S),b?(du(S,W,X),V=5):(va(S,W,X),V=6);e:do if(en(P)|0)if(!B)w=20;else for(w=1;;){if(P=Pt(7,0,(15-w|0)*3|0)|0,!((P&A|0)==0&((Ne()|0)&h|0)==0)){w=8;break e}if(w>>>0<B>>>0)w=w+1|0;else{w=20;break}}else w=8;while(0);if(L(d|0,-1,w|0)|0,b){b=0;do{for(S=X+(b<<4)|0,_a(S,a[W>>2]|0)|0,S=a[S>>2]|0,w=0;P=d+(w<<2)|0,B=a[P>>2]|0,!((B|0)==-1|(B|0)==(S|0));)w=w+1|0;a[P>>2]=S,b=b+1|0}while((b|0)!=(V|0))}else{b=0;do{for(S=X+(b<<4)|0,Eo(S,a[W>>2]|0,0,1)|0,S=a[S>>2]|0,w=0;P=d+(w<<2)|0,B=a[P>>2]|0,!((B|0)==-1|(B|0)==(S|0));)w=w+1|0;a[P>>2]=S,b=b+1|0}while((b|0)!=(V|0))}Re=ae}function nl(){return 12}function oi(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0,V=0;if(Pt(A|0,0,52)|0,B=Ne()|0|134225919,(A|0)<1){w=0,d=0;do en(w)|0&&(Pt(w|0,0,45)|0,P=B|(Ne()|0),A=h+(d<<3)|0,a[A>>2]=-1,a[A+4>>2]=P,d=d+1|0),w=w+1|0;while((w|0)!=122);return}P=0,d=0;do{if(en(P)|0){for(Pt(P|0,0,45)|0,w=1,b=-1,S=B|(Ne()|0);V=Pt(7,0,(15-w|0)*3|0)|0,b=b&~V,S=S&~(Ne()|0),(w|0)!=(A|0);)w=w+1|0;V=h+(d<<3)|0,a[V>>2]=b,a[V+4>>2]=S,d=d+1|0}P=P+1|0}while((P|0)!=122)}function Ps(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0,P=0,B=0,V=0,W=0;if(B=Re,Re=Re+64|0,P=B,(A|0)==(d|0)&(h|0)==(w|0)|(!1|(h&2013265920|0)!=134217728|(!1|(w&2013265920|0)!=134217728))||(b=Ct(A|0,h|0,52)|0,Ne()|0,b=b&15,S=Ct(d|0,w|0,52)|0,Ne()|0,(b|0)!=(S&15|0)))return P=0,Re=B,P|0;if(S=b+-1|0,b>>>0>1&&(W=Nl(A,h,S)|0,V=Ne()|0,S=Nl(d,w,S)|0,(W|0)==(S|0)&(V|0)==(Ne()|0))&&(S=(b^15)*3|0,b=Ct(A|0,h|0,S|0)|0,Ne()|0,b=b&7,S=Ct(d|0,w|0,S|0)|0,Ne()|0,S=S&7,(b|0)==0|(S|0)==0||(a[21136+(b<<2)>>2]|0)==(S|0)||(a[21168+(b<<2)>>2]|0)==(S|0)))return W=1,Re=B,W|0;b=P,S=b+56|0;do a[b>>2]=0,b=b+4|0;while((b|0)<(S|0));return ga(A,h,1,P),W=P,!((a[W>>2]|0)==(d|0)&&(a[W+4>>2]|0)==(w|0))&&(W=P+8|0,!((a[W>>2]|0)==(d|0)&&(a[W+4>>2]|0)==(w|0)))&&(W=P+16|0,!((a[W>>2]|0)==(d|0)&&(a[W+4>>2]|0)==(w|0)))&&(W=P+24|0,!((a[W>>2]|0)==(d|0)&&(a[W+4>>2]|0)==(w|0)))&&(W=P+32|0,!((a[W>>2]|0)==(d|0)&&(a[W+4>>2]|0)==(w|0)))&&(W=P+40|0,!((a[W>>2]|0)==(d|0)&&(a[W+4>>2]|0)==(w|0)))?(b=P+48|0,b=((a[b>>2]|0)==(d|0)?(a[b+4>>2]|0)==(w|0):0)&1):b=1,W=b,Re=B,W|0}function Ji(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0,P=0,B=0,V=0,W=0,X=0;if(W=Re,Re=Re+16|0,P=W,!(Ps(A,h,d,w)|0))return B=0,V=0,Ft(B|0),Re=W,V|0;for(B=h&-2130706433,b=(zr(A,h)|0)==0,b=b?1:2;a[P>>2]=0,X=me(A,h,b,P)|0,S=b+1|0,!((X|0)==(d|0)&(Ne()|0)==(w|0));)if(S>>>0<7)b=S;else{b=0,A=0,V=6;break}return(V|0)==6?(Ft(b|0),Re=W,A|0):(X=Pt(b|0,0,56)|0,V=B|(Ne()|0)|268435456,X=A|X,Ft(V|0),Re=W,X|0)}function Vl(A,h){A=A|0,h=h|0;var d=0;return d=!0&(h&2013265920|0)==268435456,Ft((d?h&-2130706433|134217728:0)|0),(d?A:0)|0}function Jo(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;return w=Re,Re=Re+16|0,d=w,!0&(h&2013265920|0)==268435456?(b=Ct(A|0,h|0,56)|0,Ne()|0,a[d>>2]=0,d=me(A,h&-2130706433|134217728,b&7,d)|0,h=Ne()|0,Ft(h|0),Re=w,d|0):(h=0,d=0,Ft(h|0),Re=w,d|0)}function Mc(A,h){A=A|0,h=h|0;var d=0;if(!(!0&(h&2013265920|0)==268435456))return d=0,d|0;switch(d=Ct(A|0,h|0,56)|0,Ne()|0,d&7){case 0:case 7:return d=0,d|0}return d=h&-2130706433|134217728,!0&(h&117440512|0)==16777216&(zr(A,d)|0)!=0?(d=0,d|0):(d=mu(A,d)|0,d|0)}function So(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0;S=Re,Re=Re+16|0,w=S,P=!0&(h&2013265920|0)==268435456,b=h&-2130706433|134217728,B=d,a[B>>2]=P?A:0,a[B+4>>2]=P?b:0,P?(h=Ct(A|0,h|0,56)|0,Ne()|0,a[w>>2]=0,A=me(A,b,h&7,w)|0,h=Ne()|0):(A=0,h=0),B=d+8|0,a[B>>2]=A,a[B+4>>2]=h,Re=S}function Gl(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;b=(zr(A,h)|0)==0,h=h&-2130706433,w=d,a[w>>2]=b?A:0,a[w+4>>2]=b?h|285212672:0,w=d+8|0,a[w>>2]=A,a[w+4>>2]=h|301989888,w=d+16|0,a[w>>2]=A,a[w+4>>2]=h|318767104,w=d+24|0,a[w>>2]=A,a[w+4>>2]=h|335544320,w=d+32|0,a[w>>2]=A,a[w+4>>2]=h|352321536,d=d+40|0,a[d>>2]=A,a[d+4>>2]=h|369098752}function rl(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0;if(P=Re,Re=Re+16|0,S=P,w=Ct(A|0,h|0,56)|0,Ne()|0,B=!0&(h&2013265920|0)==268435456,b=B?A:0,A=B?h&-2130706433|134217728:0,h=gs(b,A,w&7)|0,(h|0)==-1){a[d>>2]=0,Re=P;return}tl(b,A,S),w=Ct(b|0,A|0,52)|0,Ne()|0,w=w&15,zr(b,A)|0?fu(S,w,h,2,d):pu(S,w,h,2,d),Re=P}function Dh(A){A=A|0;var h=0,d=0,w=0;return h=es(1,12)|0,h||Mt(22691,22646,49,22704),d=A+4|0,w=a[d>>2]|0,w|0?(w=w+8|0,a[w>>2]=h,a[d>>2]=h,h|0):(a[A>>2]|0&&Mt(22721,22646,61,22744),w=A,a[w>>2]=h,a[d>>2]=h,h|0)}function Rh(A,h){A=A|0,h=h|0;var d=0,w=0;return w=Kt(24)|0,w||Mt(22758,22646,78,22772),a[w>>2]=a[h>>2],a[w+4>>2]=a[h+4>>2],a[w+8>>2]=a[h+8>>2],a[w+12>>2]=a[h+12>>2],a[w+16>>2]=0,h=A+4|0,d=a[h>>2]|0,d|0?(a[d+16>>2]=w,a[h>>2]=w,w|0):(a[A>>2]|0&&Mt(22787,22646,82,22772),a[A>>2]=w,a[h>>2]=w,w|0)}function il(A){A=A|0;var h=0,d=0,w=0,b=0;if(A)for(w=1;;){if(h=a[A>>2]|0,h|0)do{if(d=a[h>>2]|0,d|0)do b=d,d=a[d+16>>2]|0,fn(b);while(d|0);b=h,h=a[h+8>>2]|0,fn(b)}while(h|0);if(h=A,A=a[A+8>>2]|0,w||fn(h),A)w=0;else break}}function Ea(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0,Me=0,ve=0,je=0,Se=0,$e=0,xe=0,y=0,m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0;if(b=A+8|0,a[b>>2]|0)return de=1,de|0;if(w=a[A>>2]|0,!w)return de=0,de|0;h=w,d=0;do d=d+1|0,h=a[h+8>>2]|0;while(h|0);if(d>>>0<2)return de=0,de|0;ee=Kt(d<<2)|0,ee||Mt(22807,22646,317,22826),q=Kt(d<<5)|0,q||Mt(22848,22646,321,22826),a[A>>2]=0,m=A+4|0,a[m>>2]=0,a[b>>2]=0,d=0,U=0,y=0,ae=0;e:for(;;){if(X=a[w>>2]|0,X){S=0,P=X;do{if(V=+G[P+8>>3],h=P,P=a[P+16>>2]|0,W=(P|0)==0,b=W?X:P,B=+G[b+8>>3],+Pe(+(V-B))>3.141592653589793){de=14;break}S=S+(B-V)*(+G[h>>3]+ +G[b>>3])}while(!W);if((de|0)==14){de=0,S=0,h=X;do xe=+G[h+8>>3],O=h+16|0,R=a[O>>2]|0,R=R|0?R:X,$e=+G[R+8>>3],S=S+(+G[h>>3]+ +G[R>>3])*(($e<0?$e+6.283185307179586:$e)-(xe<0?xe+6.283185307179586:xe)),h=a[(h|0?O:w)>>2]|0;while(h|0)}S>0?(a[ee+(U<<2)>>2]=w,U=U+1|0,b=y,h=ae):de=19}else de=19;if((de|0)==19){de=0;do if(d){if(h=d+8|0,a[h>>2]|0){de=21;break e}if(d=es(1,12)|0,!d){de=23;break e}a[h>>2]=d,b=d+4|0,P=d,h=ae}else if(ae){b=m,P=ae+8|0,h=w,d=A;break}else if(a[A>>2]|0){de=27;break e}else{b=m,P=A,h=w,d=A;break}while(0);if(a[P>>2]=w,a[b>>2]=w,P=q+(y<<5)|0,W=a[w>>2]|0,W){for(X=q+(y<<5)+8|0,G[X>>3]=17976931348623157e292,ae=q+(y<<5)+24|0,G[ae>>3]=17976931348623157e292,G[P>>3]=-17976931348623157e292,ne=q+(y<<5)+16|0,G[ne>>3]=-17976931348623157e292,je=17976931348623157e292,Se=-17976931348623157e292,b=0,ue=W,V=17976931348623157e292,Me=17976931348623157e292,ve=-17976931348623157e292,B=-17976931348623157e292;S=+G[ue>>3],xe=+G[ue+8>>3],ue=a[ue+16>>2]|0,Ee=(ue|0)==0,$e=+G[(Ee?W:ue)+8>>3],S<V&&(G[X>>3]=S,V=S),xe<Me&&(G[ae>>3]=xe,Me=xe),S>ve?G[P>>3]=S:S=ve,xe>B&&(G[ne>>3]=xe,B=xe),je=xe>0&xe<je?xe:je,Se=xe<0&xe>Se?xe:Se,b=b|+Pe(+(xe-$e))>3.141592653589793,!Ee;)ve=S;b&&(G[ne>>3]=Se,G[ae>>3]=je)}else a[P>>2]=0,a[P+4>>2]=0,a[P+8>>2]=0,a[P+12>>2]=0,a[P+16>>2]=0,a[P+20>>2]=0,a[P+24>>2]=0,a[P+28>>2]=0;b=y+1|0}if(O=w+8|0,w=a[O>>2]|0,a[O>>2]=0,w)y=b,ae=h;else{de=45;break}}if((de|0)==21)Mt(22624,22646,35,22658);else if((de|0)==23)Mt(22678,22646,37,22658);else if((de|0)==27)Mt(22721,22646,61,22744);else if((de|0)==45){e:do if((U|0)>0){for(O=(b|0)==0,I=b<<2,R=(A|0)==0,E=0,h=0;;){if(x=a[ee+(E<<2)>>2]|0,O)de=73;else{if(y=Kt(I)|0,!y){de=50;break}if(m=Kt(I)|0,!m){de=52;break}t:do if(R)d=0;else{for(b=0,d=0,P=A;w=q+(b<<5)|0,ps(a[P>>2]|0,w,a[x>>2]|0)|0?(a[y+(d<<2)>>2]=P,a[m+(d<<2)>>2]=w,Ee=d+1|0):Ee=d,P=a[P+8>>2]|0,P;)b=b+1|0,d=Ee;if((Ee|0)>0)if(w=a[y>>2]|0,(Ee|0)==1)d=w;else for(ne=0,ue=-1,d=w,ae=w;;){for(W=a[ae>>2]|0,w=0,P=0;b=a[a[y+(P<<2)>>2]>>2]|0,(b|0)==(W|0)?X=w:X=w+((ps(b,a[m+(P<<2)>>2]|0,a[W>>2]|0)|0)&1)|0,P=P+1|0,(P|0)!=(Ee|0);)w=X;if(b=(X|0)>(ue|0),d=b?ae:d,w=ne+1|0,(w|0)==(Ee|0))break t;ne=w,ue=b?X:ue,ae=a[y+(w<<2)>>2]|0}else d=0}while(0);if(fn(y),fn(m),d){if(b=d+4|0,w=a[b>>2]|0,w)d=w+8|0;else if(a[d>>2]|0){de=70;break}a[d>>2]=x,a[b>>2]=x}else de=73}if((de|0)==73){if(de=0,h=a[x>>2]|0,h|0)do m=h,h=a[h+16>>2]|0,fn(m);while(h|0);fn(x),h=2}if(E=E+1|0,(E|0)>=(U|0)){le=h;break e}}(de|0)==50?Mt(22863,22646,249,22882):(de|0)==52?Mt(22901,22646,252,22882):(de|0)==70&&Mt(22721,22646,61,22744)}else le=0;while(0);return fn(ee),fn(q),de=le,de|0}return 0}function ps(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0;if(!(kA(h,d)|0)||(h=PA(h)|0,W=+G[d>>3],w=+G[d+8>>3],w=h&w<0?w+6.283185307179586:w,A=a[A>>2]|0,!A))return A=0,A|0;if(h){h=0,d=A;e:for(;;){for(;P=+G[d>>3],V=+G[d+8>>3],d=d+16|0,X=a[d>>2]|0,X=X|0?X:A,S=+G[X>>3],b=+G[X+8>>3],P>S?(B=P,P=V):(B=S,S=P,P=b,b=V),!!(W<S|W>B);)if(d=a[d>>2]|0,!d){d=22;break e}if(V=b<0?b+6.283185307179586:b,P=P<0?P+6.283185307179586:P,w=P==w|V==w?w+-2220446049250313e-31:w,V=V+(W-S)/(B-S)*(P-V),(V<0?V+6.283185307179586:V)>w&&(h=h^1),d=a[d>>2]|0,!d){d=22;break}}if((d|0)==22)return h|0}else{h=0,d=A;e:for(;;){for(;P=+G[d>>3],V=+G[d+8>>3],d=d+16|0,X=a[d>>2]|0,X=X|0?X:A,S=+G[X>>3],b=+G[X+8>>3],P>S?(B=P,P=V):(B=S,S=P,P=b,b=V),!!(W<S|W>B);)if(d=a[d>>2]|0,!d){d=22;break e}if(w=P==w|b==w?w+-2220446049250313e-31:w,b+(W-S)/(B-S)*(P-b)>w&&(h=h^1),d=a[d>>2]|0,!d){d=22;break}}if((d|0)==22)return h|0}return 0}function Nt(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0,Me=0,ve=0,je=0,Se=0;if(Se=Re,Re=Re+32|0,je=Se+16|0,ve=Se,S=Ct(A|0,h|0,52)|0,Ne()|0,S=S&15,ue=Ct(d|0,w|0,52)|0,Ne()|0,(S|0)!=(ue&15|0))return je=1,Re=Se,je|0;if(W=Ct(A|0,h|0,45)|0,Ne()|0,W=W&127,X=Ct(d|0,w|0,45)|0,Ne()|0,X=X&127,ue=(W|0)!=(X|0),ue){if(B=MA(W,X)|0,(B|0)==7)return je=2,Re=Se,je|0;V=MA(X,W)|0,(V|0)==7?Mt(22925,22949,151,22959):(Ee=B,P=V)}else Ee=0,P=0;ae=en(W)|0,ne=en(X)|0,a[je>>2]=0,a[je+4>>2]=0,a[je+8>>2]=0,a[je+12>>2]=0;do if(Ee){if(X=a[4304+(W*28|0)+(Ee<<2)>>2]|0,B=(X|0)>0,ne)if(B){W=0,V=d,B=w;do V=wa(V,B)|0,B=Ne()|0,P=Qi(P)|0,(P|0)==1&&(P=Qi(1)|0),W=W+1|0;while((W|0)!=(X|0));X=P,W=V,V=B}else X=P,W=d,V=w;else if(B){W=0,V=d,B=w;do V=Ki(V,B)|0,B=Ne()|0,P=Qi(P)|0,W=W+1|0;while((W|0)!=(X|0));X=P,W=V,V=B}else X=P,W=d,V=w;if(Ul(W,V,je)|0,ue||Mt(22972,22949,181,22959),B=(ae|0)!=0,P=(ne|0)!=0,B&P&&Mt(22999,22949,182,22959),B){if(P=di(A,h)|0,fe[22032+(P*7|0)+Ee>>0]|0){S=3;break}V=a[21200+(P*28|0)+(Ee<<2)>>2]|0,W=V,Me=26}else if(P){if(P=di(W,V)|0,fe[22032+(P*7|0)+X>>0]|0){S=4;break}W=0,V=a[21200+(X*28|0)+(P<<2)>>2]|0,Me=26}else P=0;if((Me|0)==26)if((V|0)<=-1&&Mt(23030,22949,212,22959),(W|0)<=-1&&Mt(23053,22949,213,22959),(V|0)>0){B=je+4|0,P=0;do Zo(B),P=P+1|0;while((P|0)!=(V|0));P=W}else P=W;if(a[ve>>2]=0,a[ve+4>>2]=0,a[ve+8>>2]=0,IA(ve,Ee),S|0)for(;yi(S)|0?ya(ve):wo(ve),(S|0)>1;)S=S+-1|0;if((P|0)>0){S=0;do Zo(ve),S=S+1|0;while((S|0)!=(P|0))}Me=je+4|0,On(Me,ve,Me),Zr(Me),Me=50}else if(Ul(d,w,je)|0,(ae|0)!=0&(ne|0)!=0)if((X|0)!=(W|0)&&Mt(23077,22949,243,22959),P=di(A,h)|0,S=di(d,w)|0,fe[22032+(P*7|0)+S>>0]|0)S=5;else if(P=a[21200+(P*28|0)+(S<<2)>>2]|0,(P|0)>0){B=je+4|0,S=0;do Zo(B),S=S+1|0;while((S|0)!=(P|0));Me=50}else Me=50;else Me=50;while(0);return(Me|0)==50&&(S=je+4|0,a[b>>2]=a[S>>2],a[b+4>>2]=a[S+4>>2],a[b+8>>2]=a[S+8>>2],S=0),je=S,Re=Se,je|0}function _u(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0,Me=0,ve=0,je=0,Se=0;if(Ee=Re,Re=Re+48|0,P=Ee+36|0,B=Ee+24|0,V=Ee+12|0,W=Ee,S=Ct(A|0,h|0,52)|0,Ne()|0,S=S&15,ne=Ct(A|0,h|0,45)|0,Ne()|0,ne=ne&127,X=en(ne)|0,Pt(S|0,0,52)|0,ve=Ne()|0|134225919,Me=w,a[Me>>2]=-1,a[Me+4>>2]=ve,!S)return(a[d>>2]|0)>1||(a[d+4>>2]|0)>1||(a[d+8>>2]|0)>1||(b=lu(ne,xo(d)|0)|0,(b|0)==127)?(ve=1,Re=Ee,ve|0):(ue=Pt(b|0,0,45)|0,Me=Ne()|0,ne=w,Me=a[ne+4>>2]&-1040385|Me,ve=w,a[ve>>2]=a[ne>>2]|ue,a[ve+4>>2]=Me,ve=0,Re=Ee,ve|0);for(a[P>>2]=a[d>>2],a[P+4>>2]=a[d+4>>2],a[P+8>>2]=a[d+8>>2];a[B>>2]=a[P>>2],a[B+4>>2]=a[P+4>>2],a[B+8>>2]=a[P+8>>2],yi(S)|0?(Ll(P),a[V>>2]=a[P>>2],a[V+4>>2]=a[P+4>>2],a[V+8>>2]=a[P+8>>2],ya(V)):(qo(P),a[V>>2]=a[P>>2],a[V+4>>2]=a[P+4>>2],a[V+8>>2]=a[P+8>>2],wo(V)),Ms(B,V,W),Zr(W),Me=w,je=a[Me>>2]|0,Me=a[Me+4>>2]|0,Se=(15-S|0)*3|0,d=Pt(7,0,Se|0)|0,Me=Me&~(Ne()|0),Se=Pt(xo(W)|0,0,Se|0)|0,Me=Ne()|0|Me,ve=w,a[ve>>2]=Se|je&~d,a[ve+4>>2]=Me,(S|0)>1;)S=S+-1|0;e:do if((a[P>>2]|0)<=1&&(a[P+4>>2]|0)<=1&&(a[P+8>>2]|0)<=1){S=xo(P)|0,B=lu(ne,S)|0,(B|0)==127?W=0:W=en(B)|0;t:do if(S){if(X){if(P=21408+((di(A,h)|0)*28|0)+(S<<2)|0,P=a[P>>2]|0,(P|0)>0){d=0;do S=Wi(S)|0,d=d+1|0;while((d|0)!=(P|0))}if((S|0)==1){b=3;break e}d=lu(ne,S)|0,(d|0)==127&&Mt(23104,22949,376,23134),en(d)|0?Mt(23147,22949,377,23134):(ue=P,ae=S,b=d)}else ue=0,ae=S,b=B;if(V=a[4304+(ne*28|0)+(ae<<2)>>2]|0,(V|0)<=-1&&Mt(23178,22949,384,23134),!W){if((ue|0)<=-1&&Mt(23030,22949,417,23134),ue|0){P=w,S=0,d=a[P>>2]|0,P=a[P+4>>2]|0;do d=fs(d,P)|0,P=Ne()|0,Se=w,a[Se>>2]=d,a[Se+4>>2]=P,S=S+1|0;while((S|0)<(ue|0))}if((V|0)<=0){S=54;break}for(P=w,S=0,d=a[P>>2]|0,P=a[P+4>>2]|0;;)if(d=fs(d,P)|0,P=Ne()|0,Se=w,a[Se>>2]=d,a[Se+4>>2]=P,S=S+1|0,(S|0)==(V|0)){S=54;break t}}if(B=MA(b,ne)|0,(B|0)==7&&Mt(22925,22949,393,23134),S=w,d=a[S>>2]|0,S=a[S+4>>2]|0,(V|0)>0){P=0;do d=fs(d,S)|0,S=Ne()|0,Se=w,a[Se>>2]=d,a[Se+4>>2]=S,P=P+1|0;while((P|0)!=(V|0))}if(d=di(d,S)|0,Se=Br(b)|0,d=a[(Se?21824:21616)+(B*28|0)+(d<<2)>>2]|0,(d|0)<=-1&&Mt(23030,22949,412,23134),!d)S=54;else{B=w,S=0,P=a[B>>2]|0,B=a[B+4>>2]|0;do P=Ti(P,B)|0,B=Ne()|0,Se=w,a[Se>>2]=P,a[Se+4>>2]=B,S=S+1|0;while((S|0)<(d|0));S=54}}else if((X|0)!=0&(W|0)!=0)if(Se=di(A,h)|0,S=w,S=21408+(Se*28|0)+((di(a[S>>2]|0,a[S+4>>2]|0)|0)<<2)|0,S=a[S>>2]|0,(S|0)<=-1&&Mt(23201,22949,433,23134),!S)b=B,S=55;else{P=w,b=0,d=a[P>>2]|0,P=a[P+4>>2]|0;do d=fs(d,P)|0,P=Ne()|0,Se=w,a[Se>>2]=d,a[Se+4>>2]=P,b=b+1|0;while((b|0)<(S|0));b=B,S=54}else b=B,S=54;while(0);if((S|0)==54&&W&&(S=55),(S|0)==55&&(Se=w,(di(a[Se>>2]|0,a[Se+4>>2]|0)|0)==1)){b=4;break}Se=w,ve=a[Se>>2]|0,Se=a[Se+4>>2]&-1040385,je=Pt(b|0,0,45)|0,Se=Se|(Ne()|0),b=w,a[b>>2]=ve|je,a[b+4>>2]=Se,b=0}else b=2;while(0);return Se=b,Re=Ee,Se|0}function Ta(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var S=0,P=0;return P=Re,Re=Re+16|0,S=P,A=Nt(A,h,d,w,S)|0,A||(Yo(S,b),A=0),Re=P,A|0}function ea(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0;return b=Re,Re=Re+16|0,S=b,wc(d,S),w=_u(A,h,S,w)|0,Re=b,w|0}function vu(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0,P=0;return P=Re,Re=Re+32|0,b=P+12|0,S=P,!(Nt(A,h,A,h,b)|0)&&!(Nt(A,h,d,w,S)|0)?A=bo(b,S)|0:A=-1,Re=P,A|0}function Vt(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0,P=0;return P=Re,Re=Re+32|0,b=P+12|0,S=P,!(Nt(A,h,A,h,b)|0)&&!(Nt(A,h,d,w,S)|0)?A=bo(b,S)|0:A=-1,Re=P,(A>>>31^1)+A|0}function BA(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0,Me=0,ve=0,je=0,Se=0,$e=0,xe=0,y=0,m=0;if(y=Re,Re=Re+48|0,S=y+24|0,P=y+12|0,xe=y,!(Nt(A,h,A,h,S)|0)&&!(Nt(A,h,d,w,P)|0)){if($e=bo(S,P)|0,($e|0)<0)return xe=$e,Re=y,xe|0;for(a[S>>2]=0,a[S+4>>2]=0,a[S+8>>2]=0,a[P>>2]=0,a[P+4>>2]=0,a[P+8>>2]=0,Nt(A,h,A,h,S)|0,Nt(A,h,d,w,P)|0,cu(S),cu(P),$e?(X=a[S>>2]|0,ue=+($e|0),ve=S+4|0,ae=a[ve>>2]|0,je=S+8|0,ne=a[je>>2]|0,Se=S,d=X,w=ae,S=ne,Ee=+((a[P>>2]|0)-X|0)/ue,Me=+((a[P+4>>2]|0)-ae|0)/ue,ue=+((a[P+8>>2]|0)-ne|0)/ue):(w=S+4|0,ne=S+8|0,ve=w,je=ne,Se=S,d=a[S>>2]|0,w=a[w>>2]|0,S=a[ne>>2]|0,Ee=0,Me=0,ue=0),a[xe>>2]=d,ne=xe+4|0,a[ne>>2]=w,ae=xe+8|0,a[ae>>2]=S,X=0;;){V=+(X|0),m=Ee*V+ +(d|0),B=Me*V+ +(a[ve>>2]|0),V=ue*V+ +(a[je>>2]|0),w=~~+al(+m),P=~~+al(+B),d=~~+al(+V),m=+Pe(+(+(w|0)-m)),B=+Pe(+(+(P|0)-B)),V=+Pe(+(+(d|0)-V));do if(m>B&m>V)w=0-(P+d)|0,S=P;else if(W=0-w|0,B>V){S=W-d|0;break}else{S=P,d=W-P|0;break}while(0);if(a[xe>>2]=w,a[ne>>2]=S,a[ae>>2]=d,Rl(xe),_u(A,h,xe,b+(X<<3)|0)|0,(X|0)==($e|0))break;X=X+1|0,d=a[Se>>2]|0}return xe=0,Re=y,xe|0}return xe=-1,Re=y,xe|0}function $l(A,h){A=A|0,h=h|0;var d=0;if(!h)return d=1,d|0;d=A,A=1;do A=qt(h&1|0?d:1,A)|0,h=h>>1,d=qt(d,d)|0;while(h|0);return A|0}function zA(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0;if(!(kA(h,d)|0)||(h=PA(h)|0,ne=+G[d>>3],w=+G[d+8>>3],w=h&w<0?w+6.283185307179586:w,ae=a[A>>2]|0,(ae|0)<=0))return ae=0,ae|0;if(X=a[A+4>>2]|0,h){h=0,d=-1,A=0;e:for(;;){for(W=A;P=+G[X+(W<<4)>>3],V=+G[X+(W<<4)+8>>3],A=(d+2|0)%(ae|0)|0,S=+G[X+(A<<4)>>3],b=+G[X+(A<<4)+8>>3],P>S?(B=P,P=V):(B=S,S=P,P=b,b=V),!!(ne<S|ne>B);)if(d=W+1|0,(d|0)<(ae|0))A=W,W=d,d=A;else{d=22;break e}if(V=b<0?b+6.283185307179586:b,P=P<0?P+6.283185307179586:P,w=P==w|V==w?w+-2220446049250313e-31:w,V=V+(ne-S)/(B-S)*(P-V),(V<0?V+6.283185307179586:V)>w&&(h=h^1),A=W+1|0,(A|0)>=(ae|0)){d=22;break}else d=W}if((d|0)==22)return h|0}else{h=0,d=-1,A=0;e:for(;;){for(W=A;P=+G[X+(W<<4)>>3],V=+G[X+(W<<4)+8>>3],A=(d+2|0)%(ae|0)|0,S=+G[X+(A<<4)>>3],b=+G[X+(A<<4)+8>>3],P>S?(B=P,P=V):(B=S,S=P,P=b,b=V),!!(ne<S|ne>B);)if(d=W+1|0,(d|0)<(ae|0))A=W,W=d,d=A;else{d=22;break e}if(w=P==w|b==w?w+-2220446049250313e-31:w,b+(ne-S)/(B-S)*(P-b)>w&&(h=h^1),A=W+1|0,(A|0)>=(ae|0)){d=22;break}else d=W}if((d|0)==22)return h|0}return 0}function sl(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0,Me=0,ve=0,je=0,Se=0;if(Ee=a[A>>2]|0,!Ee){a[h>>2]=0,a[h+4>>2]=0,a[h+8>>2]=0,a[h+12>>2]=0,a[h+16>>2]=0,a[h+20>>2]=0,a[h+24>>2]=0,a[h+28>>2]=0;return}if(Me=h+8|0,G[Me>>3]=17976931348623157e292,ve=h+24|0,G[ve>>3]=17976931348623157e292,G[h>>3]=-17976931348623157e292,je=h+16|0,G[je>>3]=-17976931348623157e292,!((Ee|0)<=0)){for(ne=a[A+4>>2]|0,W=17976931348623157e292,X=-17976931348623157e292,ae=0,A=-1,S=17976931348623157e292,P=17976931348623157e292,V=-17976931348623157e292,w=-17976931348623157e292,ue=0;d=+G[ne+(ue<<4)>>3],B=+G[ne+(ue<<4)+8>>3],A=A+2|0,b=+G[ne+(((A|0)==(Ee|0)?0:A)<<4)+8>>3],d<S&&(G[Me>>3]=d,S=d),B<P&&(G[ve>>3]=B,P=B),d>V?G[h>>3]=d:d=V,B>w&&(G[je>>3]=B,w=B),W=B>0&B<W?B:W,X=B<0&B>X?B:X,ae=ae|+Pe(+(B-b))>3.141592653589793,A=ue+1|0,(A|0)!=(Ee|0);)Se=ue,V=d,ue=A,A=Se;ae&&(G[je>>3]=X,G[ve>>3]=W)}}function qs(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0,Me=0,ve=0,je=0,Se=0,$e=0,xe=0,y=0,m=0,x=0;if(Ee=a[A>>2]|0,Ee){if(Me=h+8|0,G[Me>>3]=17976931348623157e292,ve=h+24|0,G[ve>>3]=17976931348623157e292,G[h>>3]=-17976931348623157e292,je=h+16|0,G[je>>3]=-17976931348623157e292,(Ee|0)>0){for(b=a[A+4>>2]|0,ne=17976931348623157e292,ue=-17976931348623157e292,w=0,d=-1,V=17976931348623157e292,W=17976931348623157e292,ae=-17976931348623157e292,P=-17976931348623157e292,Se=0;S=+G[b+(Se<<4)>>3],X=+G[b+(Se<<4)+8>>3],m=d+2|0,B=+G[b+(((m|0)==(Ee|0)?0:m)<<4)+8>>3],S<V&&(G[Me>>3]=S,V=S),X<W&&(G[ve>>3]=X,W=X),S>ae?G[h>>3]=S:S=ae,X>P&&(G[je>>3]=X,P=X),ne=X>0&X<ne?X:ne,ue=X<0&X>ue?X:ue,w=w|+Pe(+(X-B))>3.141592653589793,d=Se+1|0,(d|0)!=(Ee|0);)m=Se,ae=S,Se=d,d=m;w&&(G[je>>3]=ue,G[ve>>3]=ne)}}else a[h>>2]=0,a[h+4>>2]=0,a[h+8>>2]=0,a[h+12>>2]=0,a[h+16>>2]=0,a[h+20>>2]=0,a[h+24>>2]=0,a[h+28>>2]=0;if(m=A+8|0,d=a[m>>2]|0,!((d|0)<=0)){y=A+12|0,xe=0;do if(b=a[y>>2]|0,w=xe,xe=xe+1|0,ve=h+(xe<<5)|0,je=a[b+(w<<3)>>2]|0,je){if(Se=h+(xe<<5)+8|0,G[Se>>3]=17976931348623157e292,A=h+(xe<<5)+24|0,G[A>>3]=17976931348623157e292,G[ve>>3]=-17976931348623157e292,$e=h+(xe<<5)+16|0,G[$e>>3]=-17976931348623157e292,(je|0)>0){for(Ee=a[b+(w<<3)+4>>2]|0,ne=17976931348623157e292,ue=-17976931348623157e292,b=0,w=-1,Me=0,V=17976931348623157e292,W=17976931348623157e292,X=-17976931348623157e292,P=-17976931348623157e292;S=+G[Ee+(Me<<4)>>3],ae=+G[Ee+(Me<<4)+8>>3],w=w+2|0,B=+G[Ee+(((w|0)==(je|0)?0:w)<<4)+8>>3],S<V&&(G[Se>>3]=S,V=S),ae<W&&(G[A>>3]=ae,W=ae),S>X?G[ve>>3]=S:S=X,ae>P&&(G[$e>>3]=ae,P=ae),ne=ae>0&ae<ne?ae:ne,ue=ae<0&ae>ue?ae:ue,b=b|+Pe(+(ae-B))>3.141592653589793,w=Me+1|0,(w|0)!=(je|0);)x=Me,Me=w,X=S,w=x;b&&(G[$e>>3]=ue,G[A>>3]=ne)}}else a[ve>>2]=0,a[ve+4>>2]=0,a[ve+8>>2]=0,a[ve+12>>2]=0,a[ve+16>>2]=0,a[ve+20>>2]=0,a[ve+24>>2]=0,a[ve+28>>2]=0,d=a[m>>2]|0;while((xe|0)<(d|0))}}function xu(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0;if(!(zA(A,h,d)|0))return b=0,b|0;if(b=A+8|0,(a[b>>2]|0)<=0)return b=1,b|0;for(w=A+12|0,A=0;;){if(S=A,A=A+1|0,zA((a[w>>2]|0)+(S<<3)|0,h+(A<<5)|0,d)|0){A=0,w=6;break}if((A|0)>=(a[b>>2]|0)){A=1,w=6;break}}return(w|0)==6?A|0:0}function Bh(){return 8}function Pc(){return 16}function wu(){return 168}function bu(){return 8}function Eu(){return 16}function Zs(){return 12}function zi(){return 8}function Co(A){A=A|0;var h=0,d=0;return d=+G[A>>3],h=+G[A+8>>3],+ +Ie(+(d*d+h*h))}function Tu(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0;W=+G[A>>3],V=+G[h>>3]-W,B=+G[A+8>>3],P=+G[h+8>>3]-B,ae=+G[d>>3],S=+G[w>>3]-ae,ne=+G[d+8>>3],X=+G[w+8>>3]-ne,S=(S*(B-ne)-(W-ae)*X)/(V*X-P*S),G[b>>3]=W+V*S,G[b+8>>3]=B+P*S}function Sa(A,h){return A=A|0,h=h|0,+G[A>>3]!=+G[h>>3]?(h=0,h|0):(h=+G[A+8>>3]==+G[h+8>>3],h|0)}function Ur(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;return b=+G[A>>3]-+G[h>>3],w=+G[A+8>>3]-+G[h+8>>3],d=+G[A+16>>3]-+G[h+16>>3],+(b*b+w*w+d*d)}function jl(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;d=+G[A>>3],w=+At(+d),d=+Qe(+d),G[h+16>>3]=d,d=+G[A+8>>3],b=w*+At(+d),G[h>>3]=b,d=w*+Qe(+d),G[h+8>>3]=d}function kc(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0,P=0,B=0,V=0,W=0;if(W=Re,Re=Re+32|0,b=W+16|0,S=W,tl(A,h,b),P=hs(A,h)|0,V=di(A,h)|0,SA(P,S),h=CA(P,a[b>>2]|0)|0,!(en(P)|0))return V=h,Re=W,V|0;do switch(P|0){case 4:{A=0,d=14;break}case 14:{A=1,d=14;break}case 24:{A=2,d=14;break}case 38:{A=3,d=14;break}case 49:{A=4,d=14;break}case 58:{A=5,d=14;break}case 63:{A=6,d=14;break}case 72:{A=7,d=14;break}case 83:{A=8,d=14;break}case 97:{A=9,d=14;break}case 107:{A=10,d=14;break}case 117:{A=11,d=14;break}default:B=0,w=0}while(0);return(d|0)==14&&(B=a[22096+(A*24|0)+8>>2]|0,w=a[22096+(A*24|0)+16>>2]|0),A=a[b>>2]|0,(A|0)!=(a[S>>2]|0)&&(P=Br(P)|0,A=a[b>>2]|0,P|(A|0)==(w|0)&&(h=(h+1|0)%6|0)),(V|0)==3&(A|0)==(w|0)?(V=(h+5|0)%6|0,Re=W,V|0):(V|0)==5&(A|0)==(B|0)?(V=(h+1|0)%6|0,Re=W,V|0):(V=h,Re=W,V|0)}function gs(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;return w=zr(A,h)|0,(d+-1|0)>>>0>5||(b=(w|0)!=0,(d|0)==1&b)?(d=-1,d|0):(w=kc(A,h)|0,b?(d=(5-w+(a[22384+(d<<2)>>2]|0)|0)%5|0,d|0):(d=(6-w+(a[22416+(d<<2)>>2]|0)|0)%6|0,d|0))}function Pr(A,h,d){A=A|0,h=h|0,d=d|0;var w=0;(h|0)>0?(w=es(h,4)|0,a[A>>2]=w,w||Mt(23230,23253,40,23267)):a[A>>2]=0,a[A+4>>2]=h,a[A+8>>2]=0,a[A+12>>2]=d}function ol(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0;b=A+4|0,S=A+12|0,P=A+8|0;e:for(;;){for(d=a[b>>2]|0,h=0;;){if((h|0)>=(d|0))break e;if(w=a[A>>2]|0,B=a[w+(h<<2)>>2]|0,!B)h=h+1|0;else break}h=w+(~~(+Pe(+(+qe(10,+ +(15-(a[S>>2]|0)|0))*(+G[B>>3]+ +G[B+8>>3])))%+(d|0))>>>0<<2)|0,d=a[h>>2]|0;t:do if(d|0){if(w=B+32|0,(d|0)==(B|0))a[h>>2]=a[w>>2];else{if(d=d+32|0,h=a[d>>2]|0,!h)break;for(;(h|0)!=(B|0);)if(d=h+32|0,h=a[d>>2]|0,!h)break t;a[d>>2]=a[w>>2]}fn(B),a[P>>2]=(a[P>>2]|0)+-1}while(0)}fn(a[A>>2]|0)}function Hl(A){A=A|0;var h=0,d=0,w=0;for(w=a[A+4>>2]|0,d=0;;){if((d|0)>=(w|0)){h=0,d=4;break}if(h=a[(a[A>>2]|0)+(d<<2)>>2]|0,!h)d=d+1|0;else{d=4;break}}return(d|0)==4?h|0:0}function Su(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,S=0;if(d=~~(+Pe(+(+qe(10,+ +(15-(a[A+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[A+4>>2]|0))>>>0,d=(a[A>>2]|0)+(d<<2)|0,w=a[d>>2]|0,!w)return S=1,S|0;S=h+32|0;do if((w|0)!=(h|0)){if(d=a[w+32>>2]|0,!d)return S=1,S|0;for(b=d;;){if((b|0)==(h|0)){b=8;break}if(d=a[b+32>>2]|0,d)w=b,b=d;else{d=1,b=10;break}}if((b|0)==8){a[w+32>>2]=a[S>>2];break}else if((b|0)==10)return d|0}else a[d>>2]=a[S>>2];while(0);return fn(h),S=A+8|0,a[S>>2]=(a[S>>2]|0)+-1,S=0,S|0}function Ic(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0;S=Kt(40)|0,S||Mt(23283,23253,98,23296),a[S>>2]=a[h>>2],a[S+4>>2]=a[h+4>>2],a[S+8>>2]=a[h+8>>2],a[S+12>>2]=a[h+12>>2],b=S+16|0,a[b>>2]=a[d>>2],a[b+4>>2]=a[d+4>>2],a[b+8>>2]=a[d+8>>2],a[b+12>>2]=a[d+12>>2],a[S+32>>2]=0,b=~~(+Pe(+(+qe(10,+ +(15-(a[A+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[A+4>>2]|0))>>>0,b=(a[A>>2]|0)+(b<<2)|0,w=a[b>>2]|0;do if(!w)a[b>>2]=S;else{for(;!(js(w,h)|0&&js(w+16|0,d)|0);)if(b=a[w+32>>2]|0,w=b|0?b:w,!(a[w+32>>2]|0)){P=10;break}if((P|0)==10){a[w+32>>2]=S;break}return fn(S),P=w,P|0}while(0);return P=A+8|0,a[P>>2]=(a[P>>2]|0)+1,P=S,P|0}function Cu(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;if(b=~~(+Pe(+(+qe(10,+ +(15-(a[A+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[A+4>>2]|0))>>>0,b=a[(a[A>>2]|0)+(b<<2)>>2]|0,!b)return d=0,d|0;if(!d){for(A=b;;){if(js(A,h)|0){w=10;break}if(A=a[A+32>>2]|0,!A){A=0,w=10;break}}if((w|0)==10)return A|0}for(A=b;;){if(js(A,h)|0&&js(A+16|0,d)|0){w=10;break}if(A=a[A+32>>2]|0,!A){A=0,w=10;break}}return(w|0)==10?A|0:0}function Lc(A,h){A=A|0,h=h|0;var d=0;if(d=~~(+Pe(+(+qe(10,+ +(15-(a[A+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[A+4>>2]|0))>>>0,A=a[(a[A>>2]|0)+(d<<2)>>2]|0,!A)return d=0,d|0;for(;;){if(js(A,h)|0){h=5;break}if(A=a[A+32>>2]|0,!A){A=0,h=5;break}}return(h|0)==5?A|0:0}function xr(){return 23312}function Wl(A){return A=+A,+ +c(+A)}function Xt(A){return A=+A,~~+Wl(A)|0}function Kt(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0,Me=0,ve=0,je=0,Se=0,$e=0,xe=0,y=0;y=Re,Re=Re+16|0,ne=y;do if(A>>>0<245){if(W=A>>>0<11?16:A+11&-8,A=W>>>3,ae=a[5829]|0,d=ae>>>A,d&3|0)return h=(d&1^1)+A|0,A=23356+(h<<1<<2)|0,d=A+8|0,w=a[d>>2]|0,b=w+8|0,S=a[b>>2]|0,(S|0)==(A|0)?a[5829]=ae&~(1<<h):(a[S+12>>2]=A,a[d>>2]=S),xe=h<<3,a[w+4>>2]=xe|3,xe=w+xe+4|0,a[xe>>2]=a[xe>>2]|1,xe=b,Re=y,xe|0;if(X=a[5831]|0,W>>>0>X>>>0){if(d|0)return h=2<<A,h=d<<A&(h|0-h),h=(h&0-h)+-1|0,B=h>>>12&16,h=h>>>B,d=h>>>5&8,h=h>>>d,S=h>>>2&4,h=h>>>S,A=h>>>1&2,h=h>>>A,w=h>>>1&1,w=(d|B|S|A|w)+(h>>>w)|0,h=23356+(w<<1<<2)|0,A=h+8|0,S=a[A>>2]|0,B=S+8|0,d=a[B>>2]|0,(d|0)==(h|0)?(A=ae&~(1<<w),a[5829]=A):(a[d+12>>2]=h,a[A>>2]=d,A=ae),xe=w<<3,P=xe-W|0,a[S+4>>2]=W|3,b=S+W|0,a[b+4>>2]=P|1,a[S+xe>>2]=P,X|0&&(w=a[5834]|0,h=X>>>3,d=23356+(h<<1<<2)|0,h=1<<h,A&h?(A=d+8|0,h=a[A>>2]|0):(a[5829]=A|h,h=d,A=d+8|0),a[A>>2]=w,a[h+12>>2]=w,a[w+8>>2]=h,a[w+12>>2]=d),a[5831]=P,a[5834]=b,xe=B,Re=y,xe|0;if(S=a[5830]|0,S){for(d=(S&0-S)+-1|0,b=d>>>12&16,d=d>>>b,w=d>>>5&8,d=d>>>w,P=d>>>2&4,d=d>>>P,B=d>>>1&2,d=d>>>B,V=d>>>1&1,V=a[23620+((w|b|P|B|V)+(d>>>V)<<2)>>2]|0,d=V,B=V,V=(a[V+4>>2]&-8)-W|0;A=a[d+16>>2]|0,!(!A&&(A=a[d+20>>2]|0,!A));)P=(a[A+4>>2]&-8)-W|0,b=P>>>0<V>>>0,d=A,B=b?A:B,V=b?P:V;if(P=B+W|0,P>>>0>B>>>0){b=a[B+24>>2]|0,h=a[B+12>>2]|0;do if((h|0)==(B|0)){if(A=B+20|0,h=a[A>>2]|0,!h&&(A=B+16|0,h=a[A>>2]|0,!h)){d=0;break}for(;;)if(w=h+20|0,d=a[w>>2]|0,d)h=d,A=w;else if(w=h+16|0,d=a[w>>2]|0,d)h=d,A=w;else break;a[A>>2]=0,d=h}else d=a[B+8>>2]|0,a[d+12>>2]=h,a[h+8>>2]=d,d=h;while(0);do if(b|0){if(h=a[B+28>>2]|0,A=23620+(h<<2)|0,(B|0)==(a[A>>2]|0)){if(a[A>>2]=d,!d){a[5830]=S&~(1<<h);break}}else if(xe=b+16|0,a[((a[xe>>2]|0)==(B|0)?xe:b+20|0)>>2]=d,!d)break;a[d+24>>2]=b,h=a[B+16>>2]|0,h|0&&(a[d+16>>2]=h,a[h+24>>2]=d),h=a[B+20>>2]|0,h|0&&(a[d+20>>2]=h,a[h+24>>2]=d)}while(0);return V>>>0<16?(xe=V+W|0,a[B+4>>2]=xe|3,xe=B+xe+4|0,a[xe>>2]=a[xe>>2]|1):(a[B+4>>2]=W|3,a[P+4>>2]=V|1,a[P+V>>2]=V,X|0&&(w=a[5834]|0,h=X>>>3,d=23356+(h<<1<<2)|0,h=1<<h,h&ae?(A=d+8|0,h=a[A>>2]|0):(a[5829]=h|ae,h=d,A=d+8|0),a[A>>2]=w,a[h+12>>2]=w,a[w+8>>2]=h,a[w+12>>2]=d),a[5831]=V,a[5834]=P),xe=B+8|0,Re=y,xe|0}else ae=W}else ae=W}else ae=W}else if(A>>>0<=4294967231)if(A=A+11|0,W=A&-8,w=a[5830]|0,w){b=0-W|0,A=A>>>8,A?W>>>0>16777215?V=31:(ae=(A+1048320|0)>>>16&8,Me=A<<ae,B=(Me+520192|0)>>>16&4,Me=Me<<B,V=(Me+245760|0)>>>16&2,V=14-(B|ae|V)+(Me<<V>>>15)|0,V=W>>>(V+7|0)&1|V<<1):V=0,d=a[23620+(V<<2)>>2]|0;e:do if(!d)d=0,A=0,Me=61;else for(A=0,B=W<<((V|0)==31?0:25-(V>>>1)|0),S=0;;){if(P=(a[d+4>>2]&-8)-W|0,P>>>0<b>>>0)if(P)A=d,b=P;else{A=d,b=0,Me=65;break e}if(Me=a[d+20>>2]|0,d=a[d+16+(B>>>31<<2)>>2]|0,S=(Me|0)==0|(Me|0)==(d|0)?S:Me,d)B=B<<1;else{d=S,Me=61;break}}while(0);if((Me|0)==61){if((d|0)==0&(A|0)==0){if(A=2<<V,A=(A|0-A)&w,!A){ae=W;break}ae=(A&0-A)+-1|0,P=ae>>>12&16,ae=ae>>>P,S=ae>>>5&8,ae=ae>>>S,B=ae>>>2&4,ae=ae>>>B,V=ae>>>1&2,ae=ae>>>V,d=ae>>>1&1,A=0,d=a[23620+((S|P|B|V|d)+(ae>>>d)<<2)>>2]|0}d?Me=65:(B=A,P=b)}if((Me|0)==65)for(S=d;;)if(ae=(a[S+4>>2]&-8)-W|0,d=ae>>>0<b>>>0,b=d?ae:b,A=d?S:A,d=a[S+16>>2]|0,d||(d=a[S+20>>2]|0),d)S=d;else{B=A,P=b;break}if(B|0&&P>>>0<((a[5831]|0)-W|0)>>>0&&(X=B+W|0,X>>>0>B>>>0)){S=a[B+24>>2]|0,h=a[B+12>>2]|0;do if((h|0)==(B|0)){if(A=B+20|0,h=a[A>>2]|0,!h&&(A=B+16|0,h=a[A>>2]|0,!h)){h=0;break}for(;;)if(b=h+20|0,d=a[b>>2]|0,d)h=d,A=b;else if(b=h+16|0,d=a[b>>2]|0,d)h=d,A=b;else break;a[A>>2]=0}else xe=a[B+8>>2]|0,a[xe+12>>2]=h,a[h+8>>2]=xe;while(0);do if(S){if(A=a[B+28>>2]|0,d=23620+(A<<2)|0,(B|0)==(a[d>>2]|0)){if(a[d>>2]=h,!h){w=w&~(1<<A),a[5830]=w;break}}else if(xe=S+16|0,a[((a[xe>>2]|0)==(B|0)?xe:S+20|0)>>2]=h,!h)break;a[h+24>>2]=S,A=a[B+16>>2]|0,A|0&&(a[h+16>>2]=A,a[A+24>>2]=h),A=a[B+20>>2]|0,A&&(a[h+20>>2]=A,a[A+24>>2]=h)}while(0);e:do if(P>>>0<16)xe=P+W|0,a[B+4>>2]=xe|3,xe=B+xe+4|0,a[xe>>2]=a[xe>>2]|1;else{if(a[B+4>>2]=W|3,a[X+4>>2]=P|1,a[X+P>>2]=P,h=P>>>3,P>>>0<256){d=23356+(h<<1<<2)|0,A=a[5829]|0,h=1<<h,A&h?(A=d+8|0,h=a[A>>2]|0):(a[5829]=A|h,h=d,A=d+8|0),a[A>>2]=X,a[h+12>>2]=X,a[X+8>>2]=h,a[X+12>>2]=d;break}if(h=P>>>8,h?P>>>0>16777215?d=31:($e=(h+1048320|0)>>>16&8,xe=h<<$e,Se=(xe+520192|0)>>>16&4,xe=xe<<Se,d=(xe+245760|0)>>>16&2,d=14-(Se|$e|d)+(xe<<d>>>15)|0,d=P>>>(d+7|0)&1|d<<1):d=0,h=23620+(d<<2)|0,a[X+28>>2]=d,A=X+16|0,a[A+4>>2]=0,a[A>>2]=0,A=1<<d,!(w&A)){a[5830]=w|A,a[h>>2]=X,a[X+24>>2]=h,a[X+12>>2]=X,a[X+8>>2]=X;break}h=a[h>>2]|0;t:do if((a[h+4>>2]&-8|0)!=(P|0)){for(w=P<<((d|0)==31?0:25-(d>>>1)|0);d=h+16+(w>>>31<<2)|0,A=a[d>>2]|0,!!A;)if((a[A+4>>2]&-8|0)==(P|0)){h=A;break t}else w=w<<1,h=A;a[d>>2]=X,a[X+24>>2]=h,a[X+12>>2]=X,a[X+8>>2]=X;break e}while(0);$e=h+8|0,xe=a[$e>>2]|0,a[xe+12>>2]=X,a[$e>>2]=X,a[X+8>>2]=xe,a[X+12>>2]=h,a[X+24>>2]=0}while(0);return xe=B+8|0,Re=y,xe|0}else ae=W}else ae=W;else ae=-1;while(0);if(d=a[5831]|0,d>>>0>=ae>>>0)return h=d-ae|0,A=a[5834]|0,h>>>0>15?(xe=A+ae|0,a[5834]=xe,a[5831]=h,a[xe+4>>2]=h|1,a[A+d>>2]=h,a[A+4>>2]=ae|3):(a[5831]=0,a[5834]=0,a[A+4>>2]=d|3,xe=A+d+4|0,a[xe>>2]=a[xe>>2]|1),xe=A+8|0,Re=y,xe|0;if(P=a[5832]|0,P>>>0>ae>>>0)return Se=P-ae|0,a[5832]=Se,xe=a[5835]|0,$e=xe+ae|0,a[5835]=$e,a[$e+4>>2]=Se|1,a[xe+4>>2]=ae|3,xe=xe+8|0,Re=y,xe|0;if(a[5947]|0?A=a[5949]|0:(a[5949]=4096,a[5948]=4096,a[5950]=-1,a[5951]=-1,a[5952]=0,a[5940]=0,a[5947]=ne&-16^1431655768,A=4096),B=ae+48|0,V=ae+47|0,S=A+V|0,b=0-A|0,W=S&b,W>>>0<=ae>>>0||(A=a[5939]|0,A|0&&(X=a[5937]|0,ne=X+W|0,ne>>>0<=X>>>0|ne>>>0>A>>>0)))return xe=0,Re=y,xe|0;e:do if(a[5940]&4)h=0,Me=143;else{d=a[5835]|0;t:do if(d){for(w=23764;ne=a[w>>2]|0,!(ne>>>0<=d>>>0&&(ne+(a[w+4>>2]|0)|0)>>>0>d>>>0);)if(A=a[w+8>>2]|0,A)w=A;else{Me=128;break t}if(h=S-P&b,h>>>0<2147483647)if(A=v(h|0)|0,(A|0)==((a[w>>2]|0)+(a[w+4>>2]|0)|0)){if((A|0)!=-1){P=h,S=A,Me=145;break e}}else w=A,Me=136;else h=0}else Me=128;while(0);do if((Me|0)==128)if(d=v(0)|0,(d|0)!=-1&&(h=d,ue=a[5948]|0,Ee=ue+-1|0,h=(Ee&h|0?(Ee+h&0-ue)-h|0:0)+W|0,ue=a[5937]|0,Ee=h+ue|0,h>>>0>ae>>>0&h>>>0<2147483647)){if(ne=a[5939]|0,ne|0&&Ee>>>0<=ue>>>0|Ee>>>0>ne>>>0){h=0;break}if(A=v(h|0)|0,(A|0)==(d|0)){P=h,S=d,Me=145;break e}else w=A,Me=136}else h=0;while(0);do if((Me|0)==136){if(d=0-h|0,!(B>>>0>h>>>0&(h>>>0<2147483647&(w|0)!=-1)))if((w|0)==-1){h=0;break}else{P=h,S=w,Me=145;break e}if(A=a[5949]|0,A=V-h+A&0-A,A>>>0>=2147483647){P=h,S=w,Me=145;break e}if((v(A|0)|0)==-1){v(d|0)|0,h=0;break}else{P=A+h|0,S=w,Me=145;break e}}while(0);a[5940]=a[5940]|4,Me=143}while(0);if((Me|0)==143&&W>>>0<2147483647&&(Se=v(W|0)|0,Ee=v(0)|0,ve=Ee-Se|0,je=ve>>>0>(ae+40|0)>>>0,!((Se|0)==-1|je^1|Se>>>0<Ee>>>0&((Se|0)!=-1&(Ee|0)!=-1)^1))&&(P=je?ve:h,S=Se,Me=145),(Me|0)==145){h=(a[5937]|0)+P|0,a[5937]=h,h>>>0>(a[5938]|0)>>>0&&(a[5938]=h),V=a[5835]|0;e:do if(V){for(h=23764;;){if(A=a[h>>2]|0,d=a[h+4>>2]|0,(S|0)==(A+d|0)){Me=154;break}if(w=a[h+8>>2]|0,w)h=w;else break}if((Me|0)==154&&($e=h+4|0,(a[h+12>>2]&8|0)==0)&&S>>>0>V>>>0&A>>>0<=V>>>0){a[$e>>2]=d+P,xe=(a[5832]|0)+P|0,Se=V+8|0,Se=Se&7|0?0-Se&7:0,$e=V+Se|0,Se=xe-Se|0,a[5835]=$e,a[5832]=Se,a[$e+4>>2]=Se|1,a[V+xe+4>>2]=40,a[5836]=a[5951];break}for(S>>>0<(a[5833]|0)>>>0&&(a[5833]=S),d=S+P|0,h=23764;;){if((a[h>>2]|0)==(d|0)){Me=162;break}if(A=a[h+8>>2]|0,A)h=A;else break}if((Me|0)==162&&!(a[h+12>>2]&8|0)){a[h>>2]=S,X=h+4|0,a[X>>2]=(a[X>>2]|0)+P,X=S+8|0,X=S+(X&7|0?0-X&7:0)|0,h=d+8|0,h=d+(h&7|0?0-h&7:0)|0,W=X+ae|0,B=h-X-ae|0,a[X+4>>2]=ae|3;t:do if((V|0)==(h|0))xe=(a[5832]|0)+B|0,a[5832]=xe,a[5835]=W,a[W+4>>2]=xe|1;else{if((a[5834]|0)==(h|0)){xe=(a[5831]|0)+B|0,a[5831]=xe,a[5834]=W,a[W+4>>2]=xe|1,a[W+xe>>2]=xe;break}if(A=a[h+4>>2]|0,(A&3|0)==1){P=A&-8,w=A>>>3;n:do if(A>>>0<256)if(A=a[h+8>>2]|0,d=a[h+12>>2]|0,(d|0)==(A|0)){a[5829]=a[5829]&~(1<<w);break}else{a[A+12>>2]=d,a[d+8>>2]=A;break}else{S=a[h+24>>2]|0,A=a[h+12>>2]|0;do if((A|0)==(h|0)){if(d=h+16|0,w=d+4|0,A=a[w>>2]|0,A)d=w;else if(A=a[d>>2]|0,!A){A=0;break}for(;;)if(b=A+20|0,w=a[b>>2]|0,w)A=w,d=b;else if(b=A+16|0,w=a[b>>2]|0,w)A=w,d=b;else break;a[d>>2]=0}else xe=a[h+8>>2]|0,a[xe+12>>2]=A,a[A+8>>2]=xe;while(0);if(!S)break;d=a[h+28>>2]|0,w=23620+(d<<2)|0;do if((a[w>>2]|0)!=(h|0)){if(xe=S+16|0,a[((a[xe>>2]|0)==(h|0)?xe:S+20|0)>>2]=A,!A)break n}else{if(a[w>>2]=A,A|0)break;a[5830]=a[5830]&~(1<<d);break n}while(0);if(a[A+24>>2]=S,d=h+16|0,w=a[d>>2]|0,w|0&&(a[A+16>>2]=w,a[w+24>>2]=A),d=a[d+4>>2]|0,!d)break;a[A+20>>2]=d,a[d+24>>2]=A}while(0);h=h+P|0,b=P+B|0}else b=B;if(h=h+4|0,a[h>>2]=a[h>>2]&-2,a[W+4>>2]=b|1,a[W+b>>2]=b,h=b>>>3,b>>>0<256){d=23356+(h<<1<<2)|0,A=a[5829]|0,h=1<<h,A&h?(A=d+8|0,h=a[A>>2]|0):(a[5829]=A|h,h=d,A=d+8|0),a[A>>2]=W,a[h+12>>2]=W,a[W+8>>2]=h,a[W+12>>2]=d;break}h=b>>>8;do if(!h)w=0;else{if(b>>>0>16777215){w=31;break}$e=(h+1048320|0)>>>16&8,xe=h<<$e,Se=(xe+520192|0)>>>16&4,xe=xe<<Se,w=(xe+245760|0)>>>16&2,w=14-(Se|$e|w)+(xe<<w>>>15)|0,w=b>>>(w+7|0)&1|w<<1}while(0);if(h=23620+(w<<2)|0,a[W+28>>2]=w,A=W+16|0,a[A+4>>2]=0,a[A>>2]=0,A=a[5830]|0,d=1<<w,!(A&d)){a[5830]=A|d,a[h>>2]=W,a[W+24>>2]=h,a[W+12>>2]=W,a[W+8>>2]=W;break}h=a[h>>2]|0;n:do if((a[h+4>>2]&-8|0)!=(b|0)){for(w=b<<((w|0)==31?0:25-(w>>>1)|0);d=h+16+(w>>>31<<2)|0,A=a[d>>2]|0,!!A;)if((a[A+4>>2]&-8|0)==(b|0)){h=A;break n}else w=w<<1,h=A;a[d>>2]=W,a[W+24>>2]=h,a[W+12>>2]=W,a[W+8>>2]=W;break t}while(0);$e=h+8|0,xe=a[$e>>2]|0,a[xe+12>>2]=W,a[$e>>2]=W,a[W+8>>2]=xe,a[W+12>>2]=h,a[W+24>>2]=0}while(0);return xe=X+8|0,Re=y,xe|0}for(h=23764;A=a[h>>2]|0,!(A>>>0<=V>>>0&&(xe=A+(a[h+4>>2]|0)|0,xe>>>0>V>>>0));)h=a[h+8>>2]|0;b=xe+-47|0,A=b+8|0,A=b+(A&7|0?0-A&7:0)|0,b=V+16|0,A=A>>>0<b>>>0?V:A,h=A+8|0,d=P+-40|0,Se=S+8|0,Se=Se&7|0?0-Se&7:0,$e=S+Se|0,Se=d-Se|0,a[5835]=$e,a[5832]=Se,a[$e+4>>2]=Se|1,a[S+d+4>>2]=40,a[5836]=a[5951],d=A+4|0,a[d>>2]=27,a[h>>2]=a[5941],a[h+4>>2]=a[5942],a[h+8>>2]=a[5943],a[h+12>>2]=a[5944],a[5941]=S,a[5942]=P,a[5944]=0,a[5943]=h,h=A+24|0;do $e=h,h=h+4|0,a[h>>2]=7;while(($e+8|0)>>>0<xe>>>0);if((A|0)!=(V|0)){if(S=A-V|0,a[d>>2]=a[d>>2]&-2,a[V+4>>2]=S|1,a[A>>2]=S,h=S>>>3,S>>>0<256){d=23356+(h<<1<<2)|0,A=a[5829]|0,h=1<<h,A&h?(A=d+8|0,h=a[A>>2]|0):(a[5829]=A|h,h=d,A=d+8|0),a[A>>2]=V,a[h+12>>2]=V,a[V+8>>2]=h,a[V+12>>2]=d;break}if(h=S>>>8,h?S>>>0>16777215?w=31:($e=(h+1048320|0)>>>16&8,xe=h<<$e,Se=(xe+520192|0)>>>16&4,xe=xe<<Se,w=(xe+245760|0)>>>16&2,w=14-(Se|$e|w)+(xe<<w>>>15)|0,w=S>>>(w+7|0)&1|w<<1):w=0,d=23620+(w<<2)|0,a[V+28>>2]=w,a[V+20>>2]=0,a[b>>2]=0,h=a[5830]|0,A=1<<w,!(h&A)){a[5830]=h|A,a[d>>2]=V,a[V+24>>2]=d,a[V+12>>2]=V,a[V+8>>2]=V;break}h=a[d>>2]|0;t:do if((a[h+4>>2]&-8|0)!=(S|0)){for(w=S<<((w|0)==31?0:25-(w>>>1)|0);d=h+16+(w>>>31<<2)|0,A=a[d>>2]|0,!!A;)if((a[A+4>>2]&-8|0)==(S|0)){h=A;break t}else w=w<<1,h=A;a[d>>2]=V,a[V+24>>2]=h,a[V+12>>2]=V,a[V+8>>2]=V;break e}while(0);$e=h+8|0,xe=a[$e>>2]|0,a[xe+12>>2]=V,a[$e>>2]=V,a[V+8>>2]=xe,a[V+12>>2]=h,a[V+24>>2]=0}}else xe=a[5833]|0,(xe|0)==0|S>>>0<xe>>>0&&(a[5833]=S),a[5941]=S,a[5942]=P,a[5944]=0,a[5838]=a[5947],a[5837]=-1,a[5842]=23356,a[5841]=23356,a[5844]=23364,a[5843]=23364,a[5846]=23372,a[5845]=23372,a[5848]=23380,a[5847]=23380,a[5850]=23388,a[5849]=23388,a[5852]=23396,a[5851]=23396,a[5854]=23404,a[5853]=23404,a[5856]=23412,a[5855]=23412,a[5858]=23420,a[5857]=23420,a[5860]=23428,a[5859]=23428,a[5862]=23436,a[5861]=23436,a[5864]=23444,a[5863]=23444,a[5866]=23452,a[5865]=23452,a[5868]=23460,a[5867]=23460,a[5870]=23468,a[5869]=23468,a[5872]=23476,a[5871]=23476,a[5874]=23484,a[5873]=23484,a[5876]=23492,a[5875]=23492,a[5878]=23500,a[5877]=23500,a[5880]=23508,a[5879]=23508,a[5882]=23516,a[5881]=23516,a[5884]=23524,a[5883]=23524,a[5886]=23532,a[5885]=23532,a[5888]=23540,a[5887]=23540,a[5890]=23548,a[5889]=23548,a[5892]=23556,a[5891]=23556,a[5894]=23564,a[5893]=23564,a[5896]=23572,a[5895]=23572,a[5898]=23580,a[5897]=23580,a[5900]=23588,a[5899]=23588,a[5902]=23596,a[5901]=23596,a[5904]=23604,a[5903]=23604,xe=P+-40|0,Se=S+8|0,Se=Se&7|0?0-Se&7:0,$e=S+Se|0,Se=xe-Se|0,a[5835]=$e,a[5832]=Se,a[$e+4>>2]=Se|1,a[S+xe+4>>2]=40,a[5836]=a[5951];while(0);if(h=a[5832]|0,h>>>0>ae>>>0)return Se=h-ae|0,a[5832]=Se,xe=a[5835]|0,$e=xe+ae|0,a[5835]=$e,a[$e+4>>2]=Se|1,a[xe+4>>2]=ae|3,xe=xe+8|0,Re=y,xe|0}return xe=xr()|0,a[xe>>2]=12,xe=0,Re=y,xe|0}function fn(A){A=A|0;var h=0,d=0,w=0,b=0,S=0,P=0,B=0,V=0;if(A){d=A+-8|0,b=a[5833]|0,A=a[A+-4>>2]|0,h=A&-8,V=d+h|0;do if(A&1)B=d,P=d;else{if(w=a[d>>2]|0,!(A&3)||(P=d+(0-w)|0,S=w+h|0,P>>>0<b>>>0))return;if((a[5834]|0)==(P|0)){if(A=V+4|0,h=a[A>>2]|0,(h&3|0)!=3){B=P,h=S;break}a[5831]=S,a[A>>2]=h&-2,a[P+4>>2]=S|1,a[P+S>>2]=S;return}if(d=w>>>3,w>>>0<256)if(A=a[P+8>>2]|0,h=a[P+12>>2]|0,(h|0)==(A|0)){a[5829]=a[5829]&~(1<<d),B=P,h=S;break}else{a[A+12>>2]=h,a[h+8>>2]=A,B=P,h=S;break}b=a[P+24>>2]|0,A=a[P+12>>2]|0;do if((A|0)==(P|0)){if(h=P+16|0,d=h+4|0,A=a[d>>2]|0,A)h=d;else if(A=a[h>>2]|0,!A){A=0;break}for(;;)if(w=A+20|0,d=a[w>>2]|0,d)A=d,h=w;else if(w=A+16|0,d=a[w>>2]|0,d)A=d,h=w;else break;a[h>>2]=0}else B=a[P+8>>2]|0,a[B+12>>2]=A,a[A+8>>2]=B;while(0);if(b){if(h=a[P+28>>2]|0,d=23620+(h<<2)|0,(a[d>>2]|0)==(P|0)){if(a[d>>2]=A,!A){a[5830]=a[5830]&~(1<<h),B=P,h=S;break}}else if(B=b+16|0,a[((a[B>>2]|0)==(P|0)?B:b+20|0)>>2]=A,!A){B=P,h=S;break}a[A+24>>2]=b,h=P+16|0,d=a[h>>2]|0,d|0&&(a[A+16>>2]=d,a[d+24>>2]=A),h=a[h+4>>2]|0,h?(a[A+20>>2]=h,a[h+24>>2]=A,B=P,h=S):(B=P,h=S)}else B=P,h=S}while(0);if(!(P>>>0>=V>>>0)&&(A=V+4|0,w=a[A>>2]|0,!!(w&1))){if(w&2)a[A>>2]=w&-2,a[B+4>>2]=h|1,a[P+h>>2]=h,b=h;else{if((a[5835]|0)==(V|0)){if(V=(a[5832]|0)+h|0,a[5832]=V,a[5835]=B,a[B+4>>2]=V|1,(B|0)!=(a[5834]|0))return;a[5834]=0,a[5831]=0;return}if((a[5834]|0)==(V|0)){V=(a[5831]|0)+h|0,a[5831]=V,a[5834]=P,a[B+4>>2]=V|1,a[P+V>>2]=V;return}b=(w&-8)+h|0,d=w>>>3;do if(w>>>0<256)if(h=a[V+8>>2]|0,A=a[V+12>>2]|0,(A|0)==(h|0)){a[5829]=a[5829]&~(1<<d);break}else{a[h+12>>2]=A,a[A+8>>2]=h;break}else{S=a[V+24>>2]|0,A=a[V+12>>2]|0;do if((A|0)==(V|0)){if(h=V+16|0,d=h+4|0,A=a[d>>2]|0,A)h=d;else if(A=a[h>>2]|0,!A){d=0;break}for(;;)if(w=A+20|0,d=a[w>>2]|0,d)A=d,h=w;else if(w=A+16|0,d=a[w>>2]|0,d)A=d,h=w;else break;a[h>>2]=0,d=A}else d=a[V+8>>2]|0,a[d+12>>2]=A,a[A+8>>2]=d,d=A;while(0);if(S|0){if(A=a[V+28>>2]|0,h=23620+(A<<2)|0,(a[h>>2]|0)==(V|0)){if(a[h>>2]=d,!d){a[5830]=a[5830]&~(1<<A);break}}else if(w=S+16|0,a[((a[w>>2]|0)==(V|0)?w:S+20|0)>>2]=d,!d)break;a[d+24>>2]=S,A=V+16|0,h=a[A>>2]|0,h|0&&(a[d+16>>2]=h,a[h+24>>2]=d),A=a[A+4>>2]|0,A|0&&(a[d+20>>2]=A,a[A+24>>2]=d)}}while(0);if(a[B+4>>2]=b|1,a[P+b>>2]=b,(B|0)==(a[5834]|0)){a[5831]=b;return}}if(A=b>>>3,b>>>0<256){d=23356+(A<<1<<2)|0,h=a[5829]|0,A=1<<A,h&A?(h=d+8|0,A=a[h>>2]|0):(a[5829]=h|A,A=d,h=d+8|0),a[h>>2]=B,a[A+12>>2]=B,a[B+8>>2]=A,a[B+12>>2]=d;return}A=b>>>8,A?b>>>0>16777215?w=31:(P=(A+1048320|0)>>>16&8,V=A<<P,S=(V+520192|0)>>>16&4,V=V<<S,w=(V+245760|0)>>>16&2,w=14-(S|P|w)+(V<<w>>>15)|0,w=b>>>(w+7|0)&1|w<<1):w=0,A=23620+(w<<2)|0,a[B+28>>2]=w,a[B+20>>2]=0,a[B+16>>2]=0,h=a[5830]|0,d=1<<w;e:do if(!(h&d))a[5830]=h|d,a[A>>2]=B,a[B+24>>2]=A,a[B+12>>2]=B,a[B+8>>2]=B;else{A=a[A>>2]|0;t:do if((a[A+4>>2]&-8|0)!=(b|0)){for(w=b<<((w|0)==31?0:25-(w>>>1)|0);d=A+16+(w>>>31<<2)|0,h=a[d>>2]|0,!!h;)if((a[h+4>>2]&-8|0)==(b|0)){A=h;break t}else w=w<<1,A=h;a[d>>2]=B,a[B+24>>2]=A,a[B+12>>2]=B,a[B+8>>2]=B;break e}while(0);P=A+8|0,V=a[P>>2]|0,a[V+12>>2]=B,a[P>>2]=B,a[B+8>>2]=V,a[B+12>>2]=A,a[B+24>>2]=0}while(0);if(V=(a[5837]|0)+-1|0,a[5837]=V,!(V|0)){for(A=23772;A=a[A>>2]|0,A;)A=A+8|0;a[5837]=-1}}}}function es(A,h){A=A|0,h=h|0;var d=0;return A?(d=qt(h,A)|0,(h|A)>>>0>65535&&(d=((d>>>0)/(A>>>0)|0|0)==(h|0)?d:-1)):d=0,A=Kt(d)|0,!A||!(a[A+-4>>2]&3)||L(A|0,0,d|0)|0,A|0}function ta(A,h,d,w){return A=A|0,h=h|0,d=d|0,w=w|0,d=A+d>>>0,Ft(h+w+(d>>>0<A>>>0|0)>>>0|0),d|0|0}function jr(A,h,d,w){return A=A|0,h=h|0,d=d|0,w=w|0,w=h-w-(d>>>0>A>>>0|0)>>>0,Ft(w|0),A-d>>>0|0|0}function Ys(A){return A=A|0,(A?31-(xn(A^A-1)|0)|0:32)|0}function ks(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var S=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,Ee=0;if(X=A,V=h,W=V,P=d,ne=w,B=ne,!W)return S=(b|0)!=0,B?S?(a[b>>2]=A|0,a[b+4>>2]=h&0,ne=0,b=0,Ft(ne|0),b|0):(ne=0,b=0,Ft(ne|0),b|0):(S&&(a[b>>2]=(X>>>0)%(P>>>0),a[b+4>>2]=0),ne=0,b=(X>>>0)/(P>>>0)>>>0,Ft(ne|0),b|0);S=(B|0)==0;do if(P){if(!S){if(S=(xn(B|0)|0)-(xn(W|0)|0)|0,S>>>0<=31){ae=S+1|0,B=31-S|0,h=S-31>>31,P=ae,A=X>>>(ae>>>0)&h|W<<B,h=W>>>(ae>>>0)&h,S=0,B=X<<B;break}return b?(a[b>>2]=A|0,a[b+4>>2]=V|h&0,ne=0,b=0,Ft(ne|0),b|0):(ne=0,b=0,Ft(ne|0),b|0)}if(S=P-1|0,S&P|0){B=(xn(P|0)|0)+33-(xn(W|0)|0)|0,Ee=64-B|0,ae=32-B|0,V=ae>>31,ue=B-32|0,h=ue>>31,P=B,A=ae-1>>31&W>>>(ue>>>0)|(W<<ae|X>>>(B>>>0))&h,h=h&W>>>(B>>>0),S=X<<Ee&V,B=(W<<Ee|X>>>(ue>>>0))&V|X<<ae&B-33>>31;break}return b|0&&(a[b>>2]=S&X,a[b+4>>2]=0),(P|0)==1?(ue=V|h&0,Ee=A|0|0,Ft(ue|0),Ee|0):(Ee=Ys(P|0)|0,ue=W>>>(Ee>>>0)|0,Ee=W<<32-Ee|X>>>(Ee>>>0)|0,Ft(ue|0),Ee|0)}else{if(S)return b|0&&(a[b>>2]=(W>>>0)%(P>>>0),a[b+4>>2]=0),ue=0,Ee=(W>>>0)/(P>>>0)>>>0,Ft(ue|0),Ee|0;if(!X)return b|0&&(a[b>>2]=0,a[b+4>>2]=(W>>>0)%(B>>>0)),ue=0,Ee=(W>>>0)/(B>>>0)>>>0,Ft(ue|0),Ee|0;if(S=B-1|0,!(S&B))return b|0&&(a[b>>2]=A|0,a[b+4>>2]=S&W|h&0),ue=0,Ee=W>>>((Ys(B|0)|0)>>>0),Ft(ue|0),Ee|0;if(S=(xn(B|0)|0)-(xn(W|0)|0)|0,S>>>0<=30){h=S+1|0,B=31-S|0,P=h,A=W<<B|X>>>(h>>>0),h=W>>>(h>>>0),S=0,B=X<<B;break}return b?(a[b>>2]=A|0,a[b+4>>2]=V|h&0,ue=0,Ee=0,Ft(ue|0),Ee|0):(ue=0,Ee=0,Ft(ue|0),Ee|0)}while(0);if(!P)W=B,V=0,B=0;else{ae=d|0|0,X=ne|w&0,W=ta(ae|0,X|0,-1,-1)|0,d=Ne()|0,V=B,B=0;do w=V,V=S>>>31|V<<1,S=B|S<<1,w=A<<1|w>>>31|0,ne=A>>>31|h<<1|0,jr(W|0,d|0,w|0,ne|0)|0,Ee=Ne()|0,ue=Ee>>31|((Ee|0)<0?-1:0)<<1,B=ue&1,A=jr(w|0,ne|0,ue&ae|0,(((Ee|0)<0?-1:0)>>31|((Ee|0)<0?-1:0)<<1)&X|0)|0,h=Ne()|0,P=P-1|0;while(P|0);W=V,V=0}return P=0,b|0&&(a[b>>2]=A,a[b+4>>2]=h),ue=(S|0)>>>31|(W|P)<<1|(P<<1|S>>>31)&0|V,Ee=(S<<1|0)&-2|B,Ft(ue|0),Ee|0}function Xs(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,S=0;return S=Re,Re=Re+16|0,b=S|0,ks(A,h,d,w,b)|0,Re=S,Ft(a[b+4>>2]|0),a[b>>2]|0|0}function Ct(A,h,d){return A=A|0,h=h|0,d=d|0,(d|0)<32?(Ft(h>>>d|0),A>>>d|(h&(1<<d)-1)<<32-d):(Ft(0),h>>>d-32|0)}function Pt(A,h,d){return A=A|0,h=h|0,d=d|0,(d|0)<32?(Ft(h<<d|(A&(1<<d)-1<<32-d)>>>32-d|0),A<<d):(Ft(A<<d-32|0),0)}function Hr(A,h){return A=+A,h=+h,A!=A?+h:h!=h?+A:+an(+A,+h)}function al(A){return A=+A,A>=0?+ke(A+.5):+pn(A-.5)}function Ks(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0;if((d|0)>=8192)return fi(A|0,h|0,d|0)|0,A|0;if(S=A|0,b=A+d|0,(A&3)==(h&3)){for(;A&3;){if(!d)return S|0;fe[A>>0]=fe[h>>0]|0,A=A+1|0,h=h+1|0,d=d-1|0}for(d=b&-4|0,w=d-64|0;(A|0)<=(w|0);)a[A>>2]=a[h>>2],a[A+4>>2]=a[h+4>>2],a[A+8>>2]=a[h+8>>2],a[A+12>>2]=a[h+12>>2],a[A+16>>2]=a[h+16>>2],a[A+20>>2]=a[h+20>>2],a[A+24>>2]=a[h+24>>2],a[A+28>>2]=a[h+28>>2],a[A+32>>2]=a[h+32>>2],a[A+36>>2]=a[h+36>>2],a[A+40>>2]=a[h+40>>2],a[A+44>>2]=a[h+44>>2],a[A+48>>2]=a[h+48>>2],a[A+52>>2]=a[h+52>>2],a[A+56>>2]=a[h+56>>2],a[A+60>>2]=a[h+60>>2],A=A+64|0,h=h+64|0;for(;(A|0)<(d|0);)a[A>>2]=a[h>>2],A=A+4|0,h=h+4|0}else for(d=b-4|0;(A|0)<(d|0);)fe[A>>0]=fe[h>>0]|0,fe[A+1>>0]=fe[h+1>>0]|0,fe[A+2>>0]=fe[h+2>>0]|0,fe[A+3>>0]=fe[h+3>>0]|0,A=A+4|0,h=h+4|0;for(;(A|0)<(b|0);)fe[A>>0]=fe[h>>0]|0,A=A+1|0,h=h+1|0;return S|0}function L(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,S=0,P=0;if(S=A+d|0,h=h&255,(d|0)>=67){for(;A&3;)fe[A>>0]=h,A=A+1|0;for(w=S&-4|0,P=h|h<<8|h<<16|h<<24,b=w-64|0;(A|0)<=(b|0);)a[A>>2]=P,a[A+4>>2]=P,a[A+8>>2]=P,a[A+12>>2]=P,a[A+16>>2]=P,a[A+20>>2]=P,a[A+24>>2]=P,a[A+28>>2]=P,a[A+32>>2]=P,a[A+36>>2]=P,a[A+40>>2]=P,a[A+44>>2]=P,a[A+48>>2]=P,a[A+52>>2]=P,a[A+56>>2]=P,a[A+60>>2]=P,A=A+64|0;for(;(A|0)<(w|0);)a[A>>2]=P,A=A+4|0}for(;(A|0)<(S|0);)fe[A>>0]=h,A=A+1|0;return S-d|0}function c(A){return A=+A,A>=0?+ke(A+.5):+pn(A-.5)}function v(A){A=A|0;var h=0,d=0,w=0;return w=cn()|0,d=a[Le>>2]|0,h=d+A|0,(A|0)>0&(h|0)<(d|0)|(h|0)<0?(pa(h|0)|0,Ce(12),-1):(h|0)>(w|0)&&!(ir(h|0)|0)?(Ce(12),-1):(a[Le>>2]=h,d|0)}return{___uremdi3:Xs,_bitshift64Lshr:Ct,_bitshift64Shl:Pt,_calloc:es,_cellAreaKm2:Ja,_cellAreaM2:xa,_cellAreaRads2:zl,_compact:yu,_destroyLinkedPolygon:il,_edgeLengthKm:Ka,_edgeLengthM:Ec,_emscripten_replace_memory:Qa,_exactEdgeLengthKm:Fl,_exactEdgeLengthM:vr,_exactEdgeLengthRads:Ol,_experimentalH3ToLocalIj:Ta,_experimentalLocalIjToH3:ea,_free:fn,_geoToH3:el,_getDestinationH3IndexFromUnidirectionalEdge:Jo,_getH3IndexesFromUnidirectionalEdge:So,_getH3UnidirectionalEdge:Ji,_getH3UnidirectionalEdgeBoundary:rl,_getH3UnidirectionalEdgesFromHexagon:Gl,_getOriginH3IndexFromUnidirectionalEdge:Vl,_getPentagonIndexes:oi,_getRes0Indexes:kl,_h3Distance:vu,_h3GetBaseCell:hs,_h3GetFaces:ba,_h3GetResolution:DA,_h3IndexesAreNeighbors:Ps,_h3IsPentagon:zr,_h3IsResClassIII:RA,_h3IsValid:mu,_h3Line:BA,_h3LineSize:Vt,_h3SetToLinkedGeo:Dr,_h3ToCenterChild:si,_h3ToChildren:Yr,_h3ToGeo:Qs,_h3ToGeoBoundary:ds,_h3ToParent:Nl,_h3UnidirectionalEdgeIsValid:Mc,_hexAreaKm2:Ko,_hexAreaM2:bc,_hexRing:Te,_i64Subtract:jr,_kRing:ga,_kRingDistances:Ml,_llvm_minnum_f64:Hr,_llvm_round_f64:al,_malloc:Kt,_maxFaceCount:Cc,_maxH3ToChildrenSize:Tc,_maxKringSize:Za,_maxPolyfillSize:Ue,_maxUncompactSize:Sc,_memcpy:Ks,_memset:L,_numHexagons:gu,_pentagonIndexCount:nl,_pointDistKm:Zn,_pointDistM:Tr,_pointDistRads:Hn,_polyfill:lt,_res0IndexCount:Pl,_round:c,_sbrk:v,_sizeOfCoordIJ:zi,_sizeOfGeoBoundary:wu,_sizeOfGeoCoord:Pc,_sizeOfGeoPolygon:Eu,_sizeOfGeofence:bu,_sizeOfH3Index:Bh,_sizeOfLinkedGeoPolygon:Zs,_uncompact:Ws,establishStackSpace:qa,stackAlloc:we,stackRestore:Cs,stackSave:Wo}}(Ss,yn,Oe);e.___uremdi3=Ke.___uremdi3,e._bitshift64Lshr=Ke._bitshift64Lshr,e._bitshift64Shl=Ke._bitshift64Shl,e._calloc=Ke._calloc,e._cellAreaKm2=Ke._cellAreaKm2,e._cellAreaM2=Ke._cellAreaM2,e._cellAreaRads2=Ke._cellAreaRads2,e._compact=Ke._compact,e._destroyLinkedPolygon=Ke._destroyLinkedPolygon,e._edgeLengthKm=Ke._edgeLengthKm,e._edgeLengthM=Ke._edgeLengthM;var qr=e._emscripten_replace_memory=Ke._emscripten_replace_memory;e._exactEdgeLengthKm=Ke._exactEdgeLengthKm,e._exactEdgeLengthM=Ke._exactEdgeLengthM,e._exactEdgeLengthRads=Ke._exactEdgeLengthRads,e._experimentalH3ToLocalIj=Ke._experimentalH3ToLocalIj,e._experimentalLocalIjToH3=Ke._experimentalLocalIjToH3,e._free=Ke._free,e._geoToH3=Ke._geoToH3,e._getDestinationH3IndexFromUnidirectionalEdge=Ke._getDestinationH3IndexFromUnidirectionalEdge,e._getH3IndexesFromUnidirectionalEdge=Ke._getH3IndexesFromUnidirectionalEdge,e._getH3UnidirectionalEdge=Ke._getH3UnidirectionalEdge,e._getH3UnidirectionalEdgeBoundary=Ke._getH3UnidirectionalEdgeBoundary,e._getH3UnidirectionalEdgesFromHexagon=Ke._getH3UnidirectionalEdgesFromHexagon,e._getOriginH3IndexFromUnidirectionalEdge=Ke._getOriginH3IndexFromUnidirectionalEdge,e._getPentagonIndexes=Ke._getPentagonIndexes,e._getRes0Indexes=Ke._getRes0Indexes,e._h3Distance=Ke._h3Distance,e._h3GetBaseCell=Ke._h3GetBaseCell,e._h3GetFaces=Ke._h3GetFaces,e._h3GetResolution=Ke._h3GetResolution,e._h3IndexesAreNeighbors=Ke._h3IndexesAreNeighbors,e._h3IsPentagon=Ke._h3IsPentagon,e._h3IsResClassIII=Ke._h3IsResClassIII,e._h3IsValid=Ke._h3IsValid,e._h3Line=Ke._h3Line,e._h3LineSize=Ke._h3LineSize,e._h3SetToLinkedGeo=Ke._h3SetToLinkedGeo,e._h3ToCenterChild=Ke._h3ToCenterChild,e._h3ToChildren=Ke._h3ToChildren,e._h3ToGeo=Ke._h3ToGeo,e._h3ToGeoBoundary=Ke._h3ToGeoBoundary,e._h3ToParent=Ke._h3ToParent,e._h3UnidirectionalEdgeIsValid=Ke._h3UnidirectionalEdgeIsValid,e._hexAreaKm2=Ke._hexAreaKm2,e._hexAreaM2=Ke._hexAreaM2,e._hexRing=Ke._hexRing,e._i64Subtract=Ke._i64Subtract,e._kRing=Ke._kRing,e._kRingDistances=Ke._kRingDistances,e._llvm_minnum_f64=Ke._llvm_minnum_f64,e._llvm_round_f64=Ke._llvm_round_f64,e._malloc=Ke._malloc,e._maxFaceCount=Ke._maxFaceCount,e._maxH3ToChildrenSize=Ke._maxH3ToChildrenSize,e._maxKringSize=Ke._maxKringSize,e._maxPolyfillSize=Ke._maxPolyfillSize,e._maxUncompactSize=Ke._maxUncompactSize,e._memcpy=Ke._memcpy,e._memset=Ke._memset,e._numHexagons=Ke._numHexagons,e._pentagonIndexCount=Ke._pentagonIndexCount,e._pointDistKm=Ke._pointDistKm,e._pointDistM=Ke._pointDistM,e._pointDistRads=Ke._pointDistRads,e._polyfill=Ke._polyfill,e._res0IndexCount=Ke._res0IndexCount,e._round=Ke._round,e._sbrk=Ke._sbrk,e._sizeOfCoordIJ=Ke._sizeOfCoordIJ,e._sizeOfGeoBoundary=Ke._sizeOfGeoBoundary,e._sizeOfGeoCoord=Ke._sizeOfGeoCoord,e._sizeOfGeoPolygon=Ke._sizeOfGeoPolygon,e._sizeOfGeofence=Ke._sizeOfGeofence,e._sizeOfH3Index=Ke._sizeOfH3Index,e._sizeOfLinkedGeoPolygon=Ke._sizeOfLinkedGeoPolygon,e._uncompact=Ke._uncompact,e.establishStackSpace=Ke.establishStackSpace;var Gs=e.stackAlloc=Ke.stackAlloc,Fr=e.stackRestore=Ke.stackRestore,hi=e.stackSave=Ke.stackSave;if(e.asm=Ke,e.cwrap=se,e.setValue=F,e.getValue=j,e.getTempRet0=M,qn){vo(qn)||(qn=s(qn));{$n();var Xn=function(K){K.byteLength&&(K=new Uint8Array(K)),Ze.set(K,k),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Ii()},$s=function(){l(qn,Xn,function(){throw"could not load memory initializer "+qn})},ji=Rr(qn);if(ji)Xn(ji.buffer);else if(e.memoryInitializerRequest){var Hi=function(){var K=e.memoryInitializerRequest,Q=K.response;if(K.status!==200&&K.status!==0){var te=Rr(e.memoryInitializerRequestURL);if(te)Q=te.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+K.status+", retrying "+qn),$s();return}}Xn(Q)};e.memoryInitializerRequest.response?setTimeout(Hi,0):e.memoryInitializerRequest.addEventListener("load",Hi)}else $s()}}var Bi;ni=function K(){Bi||cs(),Bi||(ni=K)};function cs(K){if(rr>0||(Gn(),rr>0))return;function Q(){Bi||(Bi=!0,!H&&(Mr(),wt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),rn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),Q()},1)):Q()}e.run=cs;function Nr(K){throw e.onAbort&&e.onAbort(K),K+="",o(K),p(K),H=!0,"abort("+K+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Nr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return cs(),t}(typeof kt=="object"?kt:{}),Cn="number",qp=Cn,Fn=Cn,er=Cn,ra=Cn,Er=Cn,pme=[["sizeOfH3Index",Cn],["sizeOfGeoCoord",Cn],["sizeOfGeoBoundary",Cn],["sizeOfGeoPolygon",Cn],["sizeOfGeofence",Cn],["sizeOfLinkedGeoPolygon",Cn],["sizeOfCoordIJ",Cn],["h3IsValid",qp,[Fn,er]],["geoToH3",Fn,[Cn,Cn,ra]],["h3ToGeo",null,[Fn,er,Er]],["h3ToGeoBoundary",null,[Fn,er,Er]],["maxKringSize",Cn,[Cn]],["kRing",null,[Fn,er,Cn,Er]],["kRingDistances",null,[Fn,er,Cn,Er,Er]],["hexRing",null,[Fn,er,Cn,Er]],["maxPolyfillSize",Cn,[Er,ra]],["polyfill",null,[Er,ra,Er]],["h3SetToLinkedGeo",null,[Er,Cn,Er]],["destroyLinkedPolygon",null,[Er]],["compact",Cn,[Er,Er,Cn]],["uncompact",Cn,[Er,Cn,Er,Cn,ra]],["maxUncompactSize",Cn,[Er,Cn,ra]],["h3IsPentagon",qp,[Fn,er]],["h3IsResClassIII",qp,[Fn,er]],["h3GetBaseCell",Cn,[Fn,er]],["h3GetResolution",Cn,[Fn,er]],["maxFaceCount",Cn,[Fn,er]],["h3GetFaces",null,[Fn,er,Er]],["h3ToParent",Fn,[Fn,er,ra]],["h3ToChildren",null,[Fn,er,ra,Er]],["h3ToCenterChild",Fn,[Fn,er,ra]],["maxH3ToChildrenSize",Cn,[Fn,er,ra]],["h3IndexesAreNeighbors",qp,[Fn,er,Fn,er]],["getH3UnidirectionalEdge",Fn,[Fn,er,Fn,er]],["getOriginH3IndexFromUnidirectionalEdge",Fn,[Fn,er]],["getDestinationH3IndexFromUnidirectionalEdge",Fn,[Fn,er]],["h3UnidirectionalEdgeIsValid",qp,[Fn,er]],["getH3IndexesFromUnidirectionalEdge",null,[Fn,er,Er]],["getH3UnidirectionalEdgesFromHexagon",null,[Fn,er,Er]],["getH3UnidirectionalEdgeBoundary",null,[Fn,er,Er]],["h3Distance",Cn,[Fn,er,Fn,er]],["h3Line",Cn,[Fn,er,Fn,er,Er]],["h3LineSize",Cn,[Fn,er,Fn,er]],["experimentalH3ToLocalIj",Cn,[Fn,er,Fn,er,Er]],["experimentalLocalIjToH3",Cn,[Fn,er,Er,Er]],["hexAreaM2",Cn,[ra]],["hexAreaKm2",Cn,[ra]],["edgeLengthM",Cn,[ra]],["edgeLengthKm",Cn,[ra]],["pointDistM",Cn,[Er,Er]],["pointDistKm",Cn,[Er,Er]],["pointDistRads",Cn,[Er,Er]],["cellAreaM2",Cn,[Fn,er]],["cellAreaKm2",Cn,[Fn,er]],["cellAreaRads2",Cn,[Fn,er]],["exactEdgeLengthM",Cn,[Fn,er]],["exactEdgeLengthKm",Cn,[Fn,er]],["exactEdgeLengthRads",Cn,[Fn,er]],["numHexagons",Cn,[ra]],["getRes0Indexes",null,[Er]],["res0IndexCount",Cn],["getPentagonIndexes",null,[Cn,Er]],["pentagonIndexCount",Cn]],on={};pme.forEach(function(e){on[e[0]]=kt.cwrap.apply(kt,e)});var Z0=16,No=4,B8=4,Ch=8,_o=on.sizeOfH3Index(),Vv=on.sizeOfGeoCoord(),D7=on.sizeOfGeoBoundary(),gme=on.sizeOfGeoPolygon(),Mg=on.sizeOfGeofence(),mme=on.sizeOfLinkedGeoPolygon(),R7=on.sizeOfCoordIJ(),fa={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function Kd(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var yme=/[^0-9a-fA-F]/;function wr(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||yme.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),Z0),n=parseInt(t.substring(t.length-8),Z0);return[n,e]}function z8(t){if(t>=0)return t.toString(Z0);t=t&2147483647;var e=B7(8,t.toString(Z0)),n=(parseInt(e[0],Z0)+8).toString(Z0);return e=n+e.substring(1),e}function Gv(t,e){return z8(e)+B7(8,z8(t))}function B7(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function O8(t,e,n){for(var r=t.length,i=kt._calloc(r,Vv),s=n?1:0,l=n?0:1,o=0;o<r*2;o+=2)kt.HEAPF64.set([t[o/2][s],t[o/2][l]].map($v),i/Ch+o);return kt.HEAPU32.set([r,i],e/No),e}function _me(t,e){var n=t.length-1,r=kt._calloc(gme),i=0,s=i+Mg,l=s+No;O8(t[0],r+i,e);var o;if(n>0){o=kt._calloc(n,Mg);for(var p=0;p<n;p++)O8(t[p+1],o+Mg*p,e)}return kt.setValue(r+s,n,"i32"),kt.setValue(r+l,o,"i32"),r}function vme(t){var e=0,n=e+Mg,r=n+No,i=No;kt._free(kt.getValue(t+e+i,"i8*"));var s=kt.getValue(t+n,"i32");if(s>0){for(var l=kt.getValue(t+r,"i32"),o=0;o<s;o++)kt._free(kt.getValue(l+Mg*o+i,"i8*"));kt._free(l)}kt._free(t)}function z7(t){var e=kt.getTempRet0();return[t,e]}function Jd(t){var e=z7(t),n=e[0],r=e[1];return r?Gv(n,r):null}function O7(t,e){e===void 0&&(e=0);var n=kt.getValue(t+No*e*2,"i32"),r=kt.getValue(t+No*(e*2+1),"i32");return r?Gv(n,r):null}function xme(t,e,n){kt.HEAPU32.set(wr(t),e/No+2*n)}function EA(t,e){for(var n=[],r=0;r<e;r++){var i=O7(t,r);i!==null&&n.push(i)}return n}function b4(t,e){for(var n=e.length,r=0;r<n;r++)xme(e[r],t,r)}function F8(t,e){var n=kt._calloc(1,Vv);return kt.HEAPF64.set([t,e].map($v),n/Ch),n}function H2(t){return V7(kt.getValue(t,"double"))}function E4(t){return[H2(t),H2(t+Ch)]}function F7(t){return[H2(t+Ch),H2(t)]}function N7(t,e,n){for(var r=kt.getValue(t,"i32"),i=t+Ch,s=[],l=e?F7:E4,o=0;o<r*2;o+=2)s.push(l(i+Ch*o));return n&&s.push(s[0]),s}function wme(t,e){for(var n=[],r=e?F7:E4,i,s,l,o;t;){for(n.push(i=[]),s=kt.getValue(t,"i8*");s;){for(i.push(l=[]),o=kt.getValue(s,"i8*");o;)l.push(r(o)),o=kt.getValue(o+Ch*2,"i8*");e&&l.push(l[0]),s=kt.getValue(s+B8*2,"i8*")}t=kt.getValue(t+B8*2,"i8*")}return n}function bme(t){return{i:kt.getValue(t,"i32"),j:kt.getValue(t+No,"i32")}}function Eme(t,e){var n=e.i,r=e.j;kt.setValue(t,n,"i32"),kt.setValue(t+No,r,"i32")}function Tme(t,e){for(var n=[],r=0;r<e;r++){var i=kt.getValue(t+No*r,"i32");i>=0&&n.push(i)}return n}function U7(t){var e=wr(t),n=e[0],r=e[1];return!!on.h3IsValid(n,r)}function Sme(t){var e=wr(t),n=e[0],r=e[1];return!!on.h3IsPentagon(n,r)}function Cme(t){var e=wr(t),n=e[0],r=e[1];return!!on.h3IsResClassIII(n,r)}function Mme(t){var e=wr(t),n=e[0],r=e[1];return on.h3GetBaseCell(n,r)}function Pme(t){var e=wr(t),n=e[0],r=e[1],i=on.maxFaceCount(n,r),s=kt._malloc(No*i);on.h3GetFaces(n,r,s);var l=Tme(s,i);return kt._free(s),l}function kme(t){var e=wr(t),n=e[0],r=e[1];return on.h3IsValid(n,r)?on.h3GetResolution(n,r):-1}function Ime(t,e,n){var r=kt._malloc(Vv);kt.HEAPF64.set([t,e].map($v),r/Ch);var i=Jd(on.geoToH3(r,n));return kt._free(r),i}function Lme(t){var e=kt._malloc(Vv),n=wr(t),r=n[0],i=n[1];on.h3ToGeo(r,i,e);var s=E4(e);return kt._free(e),s}function Dme(t,e){var n=kt._malloc(D7),r=wr(t),i=r[0],s=r[1];on.h3ToGeoBoundary(i,s,n);var l=N7(n,e,e);return kt._free(n),l}function Rme(t,e){var n=wr(t),r=n[0],i=n[1];return Jd(on.h3ToParent(r,i,e))}function Bme(t,e){if(!U7(t))return[];var n=wr(t),r=n[0],i=n[1],s=on.maxH3ToChildrenSize(r,i,e),l=kt._calloc(s,_o);on.h3ToChildren(r,i,e,l);var o=EA(l,s);return kt._free(l),o}function zme(t,e){var n=wr(t),r=n[0],i=n[1];return Jd(on.h3ToCenterChild(r,i,e))}function Ome(t,e){var n=wr(t),r=n[0],i=n[1],s=on.maxKringSize(e),l=kt._calloc(s,_o);on.kRing(r,i,e,l);var o=EA(l,s);return kt._free(l),o}function Fme(t,e){var n=wr(t),r=n[0],i=n[1],s=on.maxKringSize(e),l=kt._calloc(s,_o),o=kt._calloc(s,No);on.kRingDistances(r,i,e,l,o);for(var p=[],_=0;_<e+1;_++)p.push([]);for(var C=0;C<s*2;C+=2){var M=kt.getValue(l+No*C,"i32"),k=kt.getValue(l+No*(C+1),"i32"),F=kt.getValue(o+No*(C/2),"i32");(M!==0||k!==0)&&p[F].push(Gv(M,k))}return kt._free(l),kt._free(o),p}function Nme(t,e){var n=e===0?1:6*e,r=kt._calloc(n,_o),i=on.hexRing.apply(on,wr(t).concat([e],[r]));if(i!==0)throw kt._free(r),new Error("Failed to get hexRing (encountered a pentagon?)");var s=EA(r,n);return kt._free(r),s}function Ume(t,e,n){if(Kd(e),n=!!n,t.length===0||t[0].length===0)return[];typeof t[0][0]=="number"&&(t=[t]);var r=_me(t,n),i=on.maxPolyfillSize(r,e),s=kt._calloc(i,_o);on.polyfill(r,e,s);var l=EA(s,i);return kt._free(s),vme(r),l}function Vme(t,e){if(!t||!t.length)return[];var n=t.length,r=kt._calloc(n,_o);b4(r,t);var i=kt._calloc(mme),s=i;on.h3SetToLinkedGeo(r,n,i);var l=wme(i,e);return on.destroyLinkedPolygon(s),kt._free(s),kt._free(r),l}function Gme(t){if(!t||!t.length)return[];var e=t.length,n=kt._calloc(e,_o);b4(n,t);var r=kt._calloc(e,_o),i=on.compact(n,r,e);if(i!==0)throw kt._free(n),kt._free(r),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var s=EA(r,e);return kt._free(n),kt._free(r),s}function $me(t,e){if(Kd(e),!t||!t.length)return[];var n=t.length,r=kt._calloc(n,_o);b4(r,t);var i=on.maxUncompactSize(r,n,e),s=kt._calloc(i,_o),l=on.uncompact(r,n,s,i,e);if(l!==0)throw kt._free(r),kt._free(s),new Error("Failed to uncompact (bad resolution?)");var o=EA(s,i);return kt._free(r),kt._free(s),o}function jme(t,e){var n=wr(t),r=n[0],i=n[1],s=wr(e),l=s[0],o=s[1];return!!on.h3IndexesAreNeighbors(r,i,l,o)}function Hme(t,e){var n=wr(t),r=n[0],i=n[1],s=wr(e),l=s[0],o=s[1];return Jd(on.getH3UnidirectionalEdge(r,i,l,o))}function Wme(t){var e=wr(t),n=e[0],r=e[1];return Jd(on.getOriginH3IndexFromUnidirectionalEdge(n,r))}function Qme(t){var e=wr(t),n=e[0],r=e[1];return Jd(on.getDestinationH3IndexFromUnidirectionalEdge(n,r))}function qme(t){var e=wr(t),n=e[0],r=e[1];return!!on.h3UnidirectionalEdgeIsValid(n,r)}function Zme(t){var e=wr(t),n=e[0],r=e[1],i=2,s=kt._calloc(i,_o);on.getH3IndexesFromUnidirectionalEdge(n,r,s);var l=EA(s,i);return kt._free(s),l}function Yme(t){var e=wr(t),n=e[0],r=e[1],i=6,s=kt._calloc(i,_o);on.getH3UnidirectionalEdgesFromHexagon(n,r,s);var l=EA(s,i);return kt._free(s),l}function Xme(t,e){var n=kt._malloc(D7),r=wr(t),i=r[0],s=r[1];on.getH3UnidirectionalEdgeBoundary(i,s,n);var l=N7(n,e);return kt._free(n),l}function Kme(t,e){var n=wr(t),r=n[0],i=n[1],s=wr(e),l=s[0],o=s[1];return on.h3Distance(r,i,l,o)}function Jme(t,e){var n=wr(t),r=n[0],i=n[1],s=wr(e),l=s[0],o=s[1],p=on.h3LineSize(r,i,l,o);if(p<0)throw new Error("Line cannot be calculated");var _=kt._calloc(p,_o);on.h3Line(r,i,l,o,_);var C=EA(_,p);return kt._free(_),C}function e1e(t,e){var n=kt._malloc(R7),r=on.experimentalH3ToLocalIj.apply(on,wr(t).concat(wr(e),[n])),i=bme(n);switch(kt._free(n),r){case 0:return i;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function t1e(t,e){if(!e||typeof e.i!="number"||typeof e.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var n=kt._malloc(R7),r=kt._malloc(_o);Eme(n,e);var i=on.experimentalLocalIjToH3.apply(on,wr(t).concat([n],[r])),s=O7(r);if(kt._free(n),kt._free(r),i!==0)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return s}function n1e(t,e,n){var r=F8(t[0],t[1]),i=F8(e[0],e[1]),s;switch(n){case fa.m:s=on.pointDistM(r,i);break;case fa.km:s=on.pointDistKm(r,i);break;case fa.rads:s=on.pointDistRads(r,i);break;default:s=null}if(kt._free(r),kt._free(i),s===null)throw new Error("Unknown unit: "+n);return s}function r1e(t,e){var n=wr(t),r=n[0],i=n[1];switch(e){case fa.m2:return on.cellAreaM2(r,i);case fa.km2:return on.cellAreaKm2(r,i);case fa.rads2:return on.cellAreaRads2(r,i);default:throw new Error("Unknown unit: "+e)}}function i1e(t,e){var n=wr(t),r=n[0],i=n[1];switch(e){case fa.m:return on.exactEdgeLengthM(r,i);case fa.km:return on.exactEdgeLengthKm(r,i);case fa.rads:return on.exactEdgeLengthRads(r,i);default:throw new Error("Unknown unit: "+e)}}function s1e(t,e){switch(Kd(t),e){case fa.m2:return on.hexAreaM2(t);case fa.km2:return on.hexAreaKm2(t);default:throw new Error("Unknown unit: "+e)}}function o1e(t,e){switch(Kd(t),e){case fa.m:return on.edgeLengthM(t);case fa.km:return on.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function a1e(t){Kd(t);var e=z7(on.numHexagons(t)),n=e[0],r=e[1];return r?r*Math.pow(2,32)+n:n}function l1e(){var t=on.res0IndexCount(),e=kt._malloc(_o*t);on.getRes0Indexes(e);var n=EA(e,t);return kt._free(e),n}function A1e(t){Kd(t);var e=on.pentagonIndexCount(),n=kt._malloc(_o*e);on.getPentagonIndexes(t,n);var r=EA(n,e);return kt._free(n),r}function $v(t){return t*Math.PI/180}function V7(t){return t*180/Math.PI}const u1e=Object.freeze(Object.defineProperty({__proto__:null,UNITS:fa,cellArea:r1e,compact:Gme,degsToRads:$v,edgeLength:o1e,exactEdgeLength:i1e,experimentalH3ToLocalIj:e1e,experimentalLocalIjToH3:t1e,geoToH3:Ime,getDestinationH3IndexFromUnidirectionalEdge:Qme,getH3IndexesFromUnidirectionalEdge:Zme,getH3UnidirectionalEdge:Hme,getH3UnidirectionalEdgeBoundary:Xme,getH3UnidirectionalEdgesFromHexagon:Yme,getOriginH3IndexFromUnidirectionalEdge:Wme,getPentagonIndexes:A1e,getRes0Indexes:l1e,h3Distance:Kme,h3GetBaseCell:Mme,h3GetFaces:Pme,h3GetResolution:kme,h3IndexToSplitLong:wr,h3IndexesAreNeighbors:jme,h3IsPentagon:Sme,h3IsResClassIII:Cme,h3IsValid:U7,h3Line:Jme,h3SetToMultiPolygon:Vme,h3ToCenterChild:zme,h3ToChildren:Bme,h3ToGeo:Lme,h3ToGeoBoundary:Dme,h3ToParent:Rme,h3UnidirectionalEdgeIsValid:qme,hexArea:s1e,hexRing:Nme,kRing:Ome,kRingDistances:Fme,numHexagons:a1e,pointDist:n1e,polyfill:Ume,radsToDegs:V7,splitLongToh3Index:Gv,uncompact:$me},Symbol.toStringTag,{value:"Module"})),c1e=Z9(u1e);var bm=c1e,jv="Feature",G7="FeatureCollection",W2="Polygon",T4="MultiPolygon";function $7(t){for(var e=null,n=0;n<t.length;n++)if(e!==null)for(var r=0;r<t[n].length;r++)e.push(t[n][r]);else e=t[n];return Array.from(new Set(e))}function h1e(t){for(var e=0,n=0,r=0,i=t[0],s=0;s<i.length;s++)e+=i[s][0],n+=i[s][1],r++;return[e/r,n/r]}function f1e(t,e){var n=t.features;if(!n)throw new Error("No features found");return $7(n.map(function(r){return j7(r,e)}))}function j7(t,e,n){n===void 0&&(n={});var r=t.type,i=t.geometry,s=i&&i.type;if(r===G7)return f1e(t,e);if(r!==jv)throw new Error("Unhandled type: "+r);if(s!==W2&&s!==T4)throw new Error("Unhandled geometry type: "+s);var l=s===W2?[i.coordinates]:i.coordinates;return $7(l.map(function(o){var p=bm.polyfill(o,e,!0);if(p.length||!n.ensureOutput)return p;var _=h1e(o),C=_[0],M=_[1];return[bm.geoToH3(M,C,e)]}))}function H7(t,e){e===void 0&&(e={});var n=[bm.h3ToGeoBoundary(t,!0)];return{type:jv,id:t,properties:e,geometry:{type:W2,coordinates:n}}}function d1e(t,e){e===void 0&&(e={});var n=bm.h3SetToMultiPolygon(t,!0),r=n.length>1,i=r?T4:W2,s=r?n:n[0]||[];return{type:jv,properties:e,geometry:{type:i,coordinates:s}}}function p1e(t,e){e===void 0&&(e={});var n=t.map(function(r){return[bm.h3ToGeoBoundary(r,{geoJson:!0})]});return{type:jv,properties:e,geometry:{type:T4,coordinates:n}}}function g1e(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r],s=e?e(i):{};n.push(H7(i,s))}return{type:G7,features:n}}var m1e={featureToH3Set:j7,h3ToFeature:H7,h3SetToFeature:d1e,h3SetToMultiPolygonFeature:p1e,h3SetToFeatureCollection:g1e},Q2=m1e;function Yf({dataDeag:t,disabled:e=!1,deagKey:n}){const{current:r}=De.useRef(T7(t.features,he=>he.properties.id)),[i,s]=De.useState(null),[l,o]=De.useState({}),[p,_]=De.useState([]),[C,M]=De.useState({}),[k,F]=De.useState({type:"FeatureCollection",features:[]}),[j,H]=De.useState({}),[ie,Y]=De.useState(!1),J=De.useCallback(({object:he})=>{if(!he){s(null),o({}),_([]);return}if(!e){if(ie)s(null),o({}),_(he.properties.id);else if(he.properties[n]){const pe=Q2.h3ToFeature(he.hexId),be={};for(const Ge of he.properties[n]){const We=r[Ge],Xe=j2(pe,We.geometry);be[We.properties.id]=V2(Xe)/V2(pe)}o(be),s(he.hexId)}return!0}},[C,ie,e,n]),se=De.useCallback(({object:he},pe)=>{if(he.properties.id==p)return F({type:"FeatureCollection",features:[]}),H({}),M({}),Y(!1),!0;if(he.properties[n]==null)return;if(pe.srcEvent.shiftKey)return M(Xe=>({...Xe,[he.hexId]:he.properties[n]})),!0;Y(!0),s(null),o({}),_(he.properties.id),M({});const be={...C,[he.hexId]:he.properties[n]};M(be);const Ge={},We={type:"FeatureCollection",features:[]};for(const Xe in be)for(const rt of be[Xe]){const Oe=r[rt],nt=Q2.h3ToFeature(Xe),Ze=j2(nt,Oe.geometry);We.features.push({...Ze,properties:{...Oe.properties}}),Ge[Oe.properties.id]={...Oe.properties}}return H(Ge),F(We),!0},[C,p,ie,n]);return{hoveredHex:i,clickedHexes:C,hoveredGeos:l,selectedGeoJSON:k,selectedGeos:j,hoveredGeoActive:p,onHover:J,onClick:se,selectionFinalized:ie}}const hr=y4(Nge,Nd),Mn=y4(Oge,yA,!0,!1),Zp=y4(Fge,{});ur().domain([9,14]).range([0,1]).clamp(!0);const cf=Zle().domain([new Date("10/31/1921"),new Date("9/30/2021")]).range([0,1199]).invert,Nu=0;function S4({speedyCounter:t,curOption:e}){const n=De.useRef(),r=De.useRef(),i=De.useRef({});De.useEffect(()=>{n.current=document.querySelector("#main-tooltip"),r.current=document.querySelector("#secondary-tooltip")},[]);const s=De.useCallback(_=>{const C=_.properties.Demand[mr[Nu]][t],M=-_.properties.UnmetDemand[mr[Nu]][t],k=-M-_.properties.UnmetDemandBaseline[t];n.current.classList.add("active"),r.current.classList.add("active"),r.current.innerHTML=`        <div><b>Region ID</b> ${_.properties.id}</div>
        <div><b>Scenario Demand</b> ${C}</div>
        <div><b>Scen. Unmet Demand</b> ${M}</div>
        <div><b>Difference in Unmet Demand</b> ${k}</div>
        <div><b>Land Holder</b> ${fd(_)}</div>
      `},[t]),l=De.useCallback(_=>{if(r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${N2(cf(t))}</i></div>
      `,_.properties.Demand){const C=_.properties.Demand[mr[Nu]][t],M=-_.properties.UnmetDemand[mr[Nu]][t],k=-M-_.properties.UnmetDemandBaseline[t];n.current.innerHTML+=`        
          <div><i>${U2[Nu]}</i></div>
          <div><b>Region ID</b> ${_.properties.id}</div>
          <div><b>Scenario Demand</b> ${C}</div>
          <div><b>Scen. Unmet Demand</b> ${M}</div>
          <div><b>Difference in Unmet Demand</b> ${k}</div>
          <div><b>Land Holder</b> ${fd(_)}</div>
        `}else{const C=_.properties.Groundwater[t];n.current.innerHTML+=`     
          <div><b>Elem ID</b> ${_.properties.id}</div>
          <div><b>Groundwater</b> ${C}</div>
      `}},[t]),o=De.useCallback(_=>{const C=_.properties.Demand[mr[Nu]][t],M=-_.properties.UnmetDemand[mr[Nu]][t],k=-M-_.properties.UnmetDemandBaseline[t],F=_.properties.Groundwater[t],j=_.properties.GroundwaterVar[t],H=_.properties.UnmetDemandVar[mr[Nu]][t],ie=Od(_.properties.UnmetDemandBaselineVar[t],H),Y=_.properties.DURgs.join(", "),J=_.properties.GWRgs.join(", ");r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${N2(cf(t))}</i></div>
        <div><i>${U2[Nu]}</i></div>
        <div><b>Groundwater</b> ${F}</div>
        <div><b>Scenario Demand</b> ${C}</div>
        <div><b>Scen. Unmet Demand</b> ${M}</div>
        <div><b>Difference in Unmet Demand</b> ${k}</div>
        <div><b>Land Holder</b> ${fd(_)}</div>
        <div><b>Variance (GW)</b> ${j}</div>
        <div><b>Var. (Scen. UnmetDem)</b> ${H}</div>
        <div><b>Var. (Difference)</b> ${ie}</div>
        <div><b>Demand Regions</b> ${Y}</div>
        <div><b>GW Regions</b> ${J}</div>
      `},[t]);return{getTooltip:De.useCallback(({object:_})=>{if(!_){i.current&&(r.current.classList.remove("active"),Th(i.current)&&n.current.classList.remove("active"),i.current=_),e>1&&(r.current.classList.remove("active"),n.current.classList.remove("active"));return}e<=1&&Th(_)?o(_):e<=1&&Ym(_)?s(_):l(_),i.current=_},[t,e])}}let Jm=class extends Vn{renderLayers(){return[new Eh({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new bh(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}};Jm.layerName="BaseTerrainLayer";Jm.defaultProps={...Vn.defaultProps};const N8=0;let W7=class extends Vn{renderLayers(){const{curOption:e,speedyCounter:n}=this.props;return[new as({id:"GroundwaterGeo",data:x4,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...hr.groundwater.interpColor(r.properties.Groundwater[n]),255],visible:e==2,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new as({id:"UDemGeo",data:Tl,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...hr.unmetDemand.interpColor(r.properties.UnmetDemand[mr[N8]][n]),255],visible:e==3,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new as({id:"DemDiffGeo",data:Tl,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...hr.difference.interpColor(r.properties.UnmetDemand[mr[N8]][n]-r.properties.UnmetDemandBaseline[n]),255],visible:e==4,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0})]}};W7.layerName="BasicGeoLayer";W7.defaultProps={...Vn.defaultProps,autoHighlight:!0};const U8=AA("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),V8=AA("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),G8=AA("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),$8=AA("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t));function Hv({counter:t,displayMonth:e,dataset:n}){const r=(t+9)%12+1,i=De.useRef();De.useEffect(()=>{i.current=Object.groupBy(Tb[n],(_,C)=>cf(C).toLocaleString("default",{year:"numeric"}))},[n]);const s=ur().domain([0,bre(Tb[n],_=>_)]).range([40,90]),l=ur().domain([1,12]).range([0,2*Math.PI]),o=UI().radius(_=>s(_)).curve(GI).angle((_,C)=>l((C+9)%12+1)),p=UI().radius(_=>s(_)).curve(GI).angle((_,C)=>l(C%12+1));De.useEffect(()=>(Ai("#clockContainer").style("visibility","visible"),Ai("#pieOutline path").attr("d",y2().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*2)).attr("fill","none").attr("stroke",n=="averageGroundwater"?`rgb(${U8})`:`rgba(${G8}, 1)`),Ai("#demandLine path").data([Tb[n]]).join("path").attr("d",_=>o(_)).attr("stroke",n=="averageGroundwater"?`rgba(${V8}, 0.3)`:`rgba(${$8}, 0.3)`).attr("stroke-width","0.2").attr("fill","none"),function(){Ai("#clockContainer").style("visibility","hidden"),Ai("#pie path").attr("d",""),Ai("#pieOutline path").attr("d",""),Ai("#demandLine path").attr("d",""),Ai("#demandLineCur path").attr("d",""),Ai("#date").text("")}),[n]),De.useEffect(()=>{Ai("#pie path").attr("d",y2().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*r/12*2)).attr("fill",n=="averageGroundwater"?`rgb(${U8})`:`rgba(${G8}, 1)`);let _=cf(t);e?Ai("#date").html("<b>"+_.toLocaleString("default",{year:"numeric"})+"</b><br/>"+_.toLocaleString("default",{month:"long"})):Ai("#date").html("<b>"+_.toLocaleString("default",{year:"numeric"})+"</b>"),nA("#demandLineCur path").data([i.current[cf(t).toLocaleString("default",{year:"numeric"})]]).join("path").attr("d",C=>p(C)).attr("stroke",n=="averageGroundwater"?`rgba(${V8}, 1)`:`rgba(${$8}, 1)`).attr("stroke-width","2").attr("fill","none")},[n,t])}var Vi=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(K){return e.locateFile?e.locateFile(K,i):i+K}var l;typeof document<"u"&&document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",l=function(Q,te,fe){var a=new XMLHttpRequest;a.open("GET",Q,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status==200||a.status==0&&a.response){te(a.response);return}var Le=Rr(Q);if(Le){te(Le.buffer);return}fe()},a.onerror=fe,a.send(null)};var o=e.print||console.log.bind(console),p=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var _=0,C=function(K){_=K},M=function(){return _},k=8;function F(K,Q,te,fe){switch(te=te||"i8",te.charAt(te.length-1)==="*"&&(te="i32"),te){case"i1":nt[K>>0]=Q;break;case"i8":nt[K>>0]=Q;break;case"i16":pt[K>>1]=Q;break;case"i32":Yt[K>>2]=Q;break;case"i64":Li=[Q>>>0,($r=Q,+nr($r)>=1?$r>0?(cr(+br($r/4294967296),4294967295)|0)>>>0:~~+Qn(($r-+(~~$r>>>0))/4294967296)>>>0:0)],Yt[K>>2]=Li[0],Yt[K+4>>2]=Li[1];break;case"float":Et[K>>2]=Q;break;case"double":un[K>>3]=Q;break;default:Nr("invalid type for setValue: "+te)}}function j(K,Q,te){switch(Q=Q||"i8",Q.charAt(Q.length-1)==="*"&&(Q="i32"),Q){case"i1":return nt[K>>0];case"i8":return nt[K>>0];case"i16":return pt[K>>1];case"i32":return Yt[K>>2];case"i64":return Yt[K>>2];case"float":return Et[K>>2];case"double":return un[K>>3];default:Nr("invalid type for getValue: "+Q)}return null}var H=!1;function ie(K,Q){K||Nr("Assertion failed: "+Q)}function Y(K){var Q=e["_"+K];return ie(Q,"Cannot call unknown function "+K+", make sure it is exported"),Q}function J(K,Q,te,fe,a){var G={string:function(dt){var Dt=0;if(dt!=null&&dt!==0){var Rt=(dt.length<<2)+1;Dt=Gs(Rt),We(dt,Dt,Rt)}return Dt},array:function(dt){var Dt=Gs(dt.length);return Xe(dt,Dt),Dt}};function Le(dt){return Q==="string"?be(dt):Q==="boolean"?!!dt:dt}var ke=Y(K),Pe=[],Ie=0;if(fe)for(var qe=0;qe<fe.length;qe++){var At=G[te[qe]];At?(Ie===0&&(Ie=hi()),Pe[qe]=At(fe[qe])):Pe[qe]=fe[qe]}var Qe=ke.apply(null,Pe);return Qe=Le(Qe),Ie!==0&&Fr(Ie),Qe}function se(K,Q,te,fe){te=te||[];var a=te.every(function(Le){return Le==="number"}),G=Q!=="string";return G&&a&&!fe?Y(K):function(){return J(K,Q,te,arguments)}}var he=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function pe(K,Q,te){for(var fe=Q+te,a=Q;K[a]&&!(a>=fe);)++a;if(a-Q>16&&K.subarray&&he)return he.decode(K.subarray(Q,a));for(var G="";Q<a;){var Le=K[Q++];if(!(Le&128)){G+=String.fromCharCode(Le);continue}var ke=K[Q++]&63;if((Le&224)==192){G+=String.fromCharCode((Le&31)<<6|ke);continue}var Pe=K[Q++]&63;if((Le&240)==224?Le=(Le&15)<<12|ke<<6|Pe:Le=(Le&7)<<18|ke<<12|Pe<<6|K[Q++]&63,Le<65536)G+=String.fromCharCode(Le);else{var Ie=Le-65536;G+=String.fromCharCode(55296|Ie>>10,56320|Ie&1023)}}return G}function be(K,Q){return K?pe(Ze,K,Q):""}function Ge(K,Q,te,fe){if(!(fe>0))return 0;for(var a=te,G=te+fe-1,Le=0;Le<K.length;++Le){var ke=K.charCodeAt(Le);if(ke>=55296&&ke<=57343){var Pe=K.charCodeAt(++Le);ke=65536+((ke&1023)<<10)|Pe&1023}if(ke<=127){if(te>=G)break;Q[te++]=ke}else if(ke<=2047){if(te+1>=G)break;Q[te++]=192|ke>>6,Q[te++]=128|ke&63}else if(ke<=65535){if(te+2>=G)break;Q[te++]=224|ke>>12,Q[te++]=128|ke>>6&63,Q[te++]=128|ke&63}else{if(te+3>=G)break;Q[te++]=240|ke>>18,Q[te++]=128|ke>>12&63,Q[te++]=128|ke>>6&63,Q[te++]=128|ke&63}}return Q[te]=0,te-a}function We(K,Q,te){return Ge(K,Ze,Q,te)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Xe(K,Q){nt.set(K,Q)}function rt(K,Q){return K%Q>0&&(K+=Q-K%Q),K}var Oe,nt,Ze,pt,Yt,Et,un;function _t(K){Oe=K,e.HEAP8=nt=new Int8Array(K),e.HEAP16=pt=new Int16Array(K),e.HEAP32=Yt=new Int32Array(K),e.HEAPU8=Ze=new Uint8Array(K),e.HEAPU16=new Uint16Array(K),e.HEAPU32=new Uint32Array(K),e.HEAPF32=Et=new Float32Array(K),e.HEAPF64=un=new Float64Array(K)}var Tt=5267040,Jt=24128,Ln=e.TOTAL_MEMORY||33554432;e.buffer?Oe=e.buffer:Oe=new ArrayBuffer(Ln),Ln=Oe.byteLength,_t(Oe),Yt[Jt>>2]=Tt;function Tn(K){for(;K.length>0;){var Q=K.shift();if(typeof Q=="function"){Q();continue}var te=Q.func;typeof te=="number"?Q.arg===void 0?e.dynCall_v(te):e.dynCall_vi(te,Q.arg):te(Q.arg===void 0?null:Q.arg)}}var Ir=[],tr=[],ar=[],pr=[];function Gn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Pn(e.preRun.shift());Tn(Ir)}function Mr(){Tn(tr)}function wt(){Tn(ar)}function rn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)xt(e.postRun.shift());Tn(pr)}function Pn(K){Ir.unshift(K)}function xt(K){pr.unshift(K)}var nr=Math.abs,Qn=Math.ceil,br=Math.floor,cr=Math.min,rr=0,ni=null;function $n(K){rr++,e.monitorRunDependencies&&e.monitorRunDependencies(rr)}function Ii(K){if(rr--,e.monitorRunDependencies&&e.monitorRunDependencies(rr),rr==0&&ni){var Q=ni;ni=null,Q()}}e.preloadedImages={},e.preloadedAudios={};var qn=null,Gi="data:application/octet-stream;base64,";function vo(K){return String.prototype.startsWith?K.startsWith(Gi):K.indexOf(Gi)===0}var $r,Li;qn="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var Ho=24144;function As(K){return K}function ht(K){var Q=/\b__Z[\w\d_]+/g;return K.replace(Q,function(te){var fe=te;return te===fe?te:fe+" ["+te+"]"})}function It(){var K=new Error;if(!K.stack){try{throw new Error(0)}catch(Q){K=Q}if(!K.stack)return"(no stack trace available)"}return K.stack.toString()}function Vs(){var K=It();return e.extraStackTrace&&(K+=`
`+e.extraStackTrace()),ht(K)}function Ei(K,Q,te,fe){Nr("Assertion failed: "+be(K)+", at: "+[Q?be(Q):"unknown filename",te,fe?be(fe):"unknown function"])}function zn(){return nt.length}function $i(K,Q,te){Ze.set(Ze.subarray(Q,Q+te),K)}function Di(K){return e.___errno_location&&(Yt[e.___errno_location()>>2]=K),K}function Ri(K){Nr("OOM")}function us(K){try{var Q=new ArrayBuffer(K);return Q.byteLength!=K?void 0:(new Int8Array(Q).set(nt),qr(Q),_t(Q),1)}catch{}}function Lt(K){var Q=zn(),te=16777216,fe=2147483648-te;if(K>fe)return!1;for(var a=16777216,G=Math.max(Q,a);G<K;)G<=536870912?G=rt(2*G,te):G=Math.min(rt((3*G+2147483648)/4,te),fe);var Le=us(G);return!!Le}var Sn=typeof atob=="function"?atob:function(K){var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",te="",fe,a,G,Le,ke,Pe,Ie,qe=0;K=K.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Le=Q.indexOf(K.charAt(qe++)),ke=Q.indexOf(K.charAt(qe++)),Pe=Q.indexOf(K.charAt(qe++)),Ie=Q.indexOf(K.charAt(qe++)),fe=Le<<2|ke>>4,a=(ke&15)<<4|Pe>>2,G=(Pe&3)<<6|Ie,te=te+String.fromCharCode(fe),Pe!==64&&(te=te+String.fromCharCode(a)),Ie!==64&&(te=te+String.fromCharCode(G));while(qe<K.length);return te};function bn(K){try{for(var Q=Sn(K),te=new Uint8Array(Q.length),fe=0;fe<Q.length;++fe)te[fe]=Q.charCodeAt(fe);return te}catch{throw new Error("Converting base64 string to bytes failed.")}}function Rr(K){if(vo(K))return bn(K.slice(Gi.length))}var Ss={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},yn={a:Nr,b:C,c:M,d:Ei,e:Di,f:zn,g:$i,h:Lt,i:Ri,j:As,k:ht,l:us,m:It,n:Vs,o:Ho,p:Jt},Ke=function(K,Q,te){"almost asm";var fe=new K.Int8Array(te),a=new K.Int32Array(te);new K.Uint8Array(te),new K.Float32Array(te);var G=new K.Float64Array(te),Le=Q.o|0,ke=Q.p|0,Pe=K.Math.floor,Ie=K.Math.abs,qe=K.Math.sqrt,At=K.Math.pow,Qe=K.Math.cos,dt=K.Math.sin,Dt=K.Math.tan,Rt=K.Math.acos,sn=K.Math.asin,jt=K.Math.atan,pn=K.Math.atan2,qt=K.Math.ceil,an=K.Math.imul,xn=K.Math.min,Ft=K.Math.max,Ne=K.Math.clz32,Mt=Q.b,Ce=Q.c,cn=Q.d,fi=Q.e,ir=Q.f,pa=Q.g,Re=Q.h,Qa=Q.i,we=24160;function Wo(y){return fe=new Int8Array(y),a=new Int32Array(y),G=new Float64Array(y),te=y,!0}function Cs(y){y=y|0;var m=0;return m=we,we=we+y|0,we=we+15&-16,m|0}function qa(){return we|0}function Za(y){y=y|0,we=y}function ga(y,m){y=y|0,we=y}function Ml(y,m){y=y|0,m=m|0;var x=0,E=0,I=0;return(y|0)<0?(m=2,m|0):(y|0)>13780509?(m=il(15,m)|0,m|0):(x=((y|0)<0)<<31>>31,I=V(y|0,x|0,3,0)|0,E=Ce()|0,x=d(y|0,x|0,1,0)|0,x=V(I|0,E|0,x|0,Ce()|0)|0,x=d(x|0,Ce()|0,1,0)|0,y=Ce()|0,a[m>>2]=x,a[m+4>>2]=y,m=0,m|0)}function ma(y,m,x,E){return y=y|0,m=m|0,x=x|0,E=E|0,ri(y,m,x,E,0)|0}function ri(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0;if(q=we,we=we+16|0,O=q,!(me(y,m,x,E,I)|0))return E=0,we=q,E|0;do if((x|0)>=0){if((x|0)>13780509){if(R=il(15,O)|0,R|0)break;U=O,O=a[U>>2]|0,U=a[U+4>>2]|0}else R=((x|0)<0)<<31>>31,ee=V(x|0,R|0,3,0)|0,U=Ce()|0,R=d(x|0,R|0,1,0)|0,R=V(ee|0,U|0,R|0,Ce()|0)|0,R=d(R|0,Ce()|0,1,0)|0,U=Ce()|0,a[O>>2]=R,a[O+4>>2]=U,O=R;if(Se(E|0,0,O<<3|0)|0,I|0){Se(I|0,0,O<<2|0)|0,R=Te(y,m,x,E,I,O,U,0)|0;break}R=h(O,4)|0,R?(ee=Te(y,m,x,E,R,O,U,0)|0,A(R),R=ee):R=13}else R=2;while(0);return ee=R,we=q,ee|0}function me(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0;if(Je=we,we=we+16|0,He=Je,ze=Je+8|0,Be=He,a[Be>>2]=y,a[Be+4>>2]=m,(x|0)<0)return ze=2,we=Je,ze|0;if(R=E,a[R>>2]=y,a[R+4>>2]=m,R=(I|0)!=0,R&&(a[I>>2]=0),vr(y,m)|0)return ze=9,we=Je,ze|0;a[ze>>2]=0;e:do if((x|0)>=1)if(R)for(le=1,ee=0,de=0,Be=1,R=y;;){if(!(ee|de)){if(R=Ue(R,m,4,ze,He)|0,R|0)break e;if(m=He,R=a[m>>2]|0,m=a[m+4>>2]|0,vr(R,m)|0){R=9;break e}}if(R=Ue(R,m,a[22384+(de<<2)>>2]|0,ze,He)|0,R|0)break e;if(m=He,R=a[m>>2]|0,m=a[m+4>>2]|0,y=E+(le<<3)|0,a[y>>2]=R,a[y+4>>2]=m,a[I+(le<<2)>>2]=Be,y=ee+1|0,O=(y|0)==(Be|0),U=de+1|0,q=(U|0)==6,vr(R,m)|0){R=9;break e}if(Be=Be+(q&O&1)|0,(Be|0)>(x|0)){R=0;break}else le=le+1|0,ee=O?0:y,de=O?q?0:U:de}else for(le=1,ee=0,de=0,Be=1,R=y;;){if(!(ee|de)){if(R=Ue(R,m,4,ze,He)|0,R|0)break e;if(m=He,R=a[m>>2]|0,m=a[m+4>>2]|0,vr(R,m)|0){R=9;break e}}if(R=Ue(R,m,a[22384+(de<<2)>>2]|0,ze,He)|0,R|0)break e;if(m=He,R=a[m>>2]|0,m=a[m+4>>2]|0,y=E+(le<<3)|0,a[y>>2]=R,a[y+4>>2]=m,y=ee+1|0,O=(y|0)==(Be|0),U=de+1|0,q=(U|0)==6,vr(R,m)|0){R=9;break e}if(Be=Be+(q&O&1)|0,(Be|0)>(x|0)){R=0;break}else le=le+1|0,ee=O?0:y,de=O?q?0:U:de}else R=0;while(0);return ze=R,we=Je,ze|0}function Te(y,m,x,E,I,R,O,U){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0,R=R|0,O=O|0,U=U|0;var q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0;if(Je=we,we=we+16|0,He=Je+8|0,ze=Je,q=X(y|0,m|0,R|0,O|0)|0,le=Ce()|0,de=E+(q<<3)|0,ft=de,ct=a[ft>>2]|0,ft=a[ft+4>>2]|0,ee=(ct|0)==(y|0)&(ft|0)==(m|0),!((ct|0)==0&(ft|0)==0|ee))do q=d(q|0,le|0,1,0)|0,q=W(q|0,Ce()|0,R|0,O|0)|0,le=Ce()|0,de=E+(q<<3)|0,ct=de,ft=a[ct>>2]|0,ct=a[ct+4>>2]|0,ee=(ft|0)==(y|0)&(ct|0)==(m|0);while(!((ft|0)==0&(ct|0)==0|ee));if(q=I+(q<<2)|0,ee&&(a[q>>2]|0)<=(U|0)||(ct=de,a[ct>>2]=y,a[ct+4>>2]=m,a[q>>2]=U,(U|0)>=(x|0)))return ct=0,we=Je,ct|0;switch(ee=U+1|0,a[He>>2]=0,q=Ue(y,m,2,He,ze)|0,q|0){case 9:{Be=9;break}case 0:{q=ze,q=Te(a[q>>2]|0,a[q+4>>2]|0,x,E,I,R,O,ee)|0,q||(Be=9);break}}e:do if((Be|0)==9){switch(a[He>>2]=0,q=Ue(y,m,3,He,ze)|0,q|0){case 9:break;case 0:{if(q=ze,q=Te(a[q>>2]|0,a[q+4>>2]|0,x,E,I,R,O,ee)|0,q|0)break e;break}default:break e}switch(a[He>>2]=0,q=Ue(y,m,1,He,ze)|0,q|0){case 9:break;case 0:{if(q=ze,q=Te(a[q>>2]|0,a[q+4>>2]|0,x,E,I,R,O,ee)|0,q|0)break e;break}default:break e}switch(a[He>>2]=0,q=Ue(y,m,5,He,ze)|0,q|0){case 9:break;case 0:{if(q=ze,q=Te(a[q>>2]|0,a[q+4>>2]|0,x,E,I,R,O,ee)|0,q|0)break e;break}default:break e}switch(a[He>>2]=0,q=Ue(y,m,4,He,ze)|0,q|0){case 9:break;case 0:{if(q=ze,q=Te(a[q>>2]|0,a[q+4>>2]|0,x,E,I,R,O,ee)|0,q|0)break e;break}default:break e}switch(a[He>>2]=0,q=Ue(y,m,6,He,ze)|0,q|0){case 9:break;case 0:{if(q=ze,q=Te(a[q>>2]|0,a[q+4>>2]|0,x,E,I,R,O,ee)|0,q|0)break e;break}default:break e}return ct=0,we=Je,ct|0}while(0);return ct=q,we=Je,ct|0}function Ue(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0;if(x>>>0>6)return I=1,I|0;if(de=(a[E>>2]|0)%6|0,a[E>>2]=de,(de|0)>0){R=0;do x=bo(x)|0,R=R+1|0;while((R|0)<(a[E>>2]|0))}if(de=ne(y|0,m|0,45)|0,Ce()|0,le=de&127,le>>>0>121)return I=5,I|0;q=si(y,m)|0,R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15;e:do if(!R)ee=8;else{for(;;){if(O=(15-R|0)*3|0,U=ne(y|0,m|0,O|0)|0,Ce()|0,U=U&7,(U|0)==7){m=5;break}if(ze=(Ti(R)|0)==0,R=R+-1|0,Be=ue(7,0,O|0)|0,m=m&~(Ce()|0),He=ue(a[(ze?432:16)+(U*28|0)+(x<<2)>>2]|0,0,O|0)|0,O=Ce()|0,x=a[(ze?640:224)+(U*28|0)+(x<<2)>>2]|0,y=He|y&~Be,m=O|m,!x){x=0;break e}if(!R){ee=8;break e}}return m|0}while(0);(ee|0)==8&&(ze=a[848+(le*28|0)+(x<<2)>>2]|0,He=ue(ze|0,0,45)|0,y=He|y,m=Ce()|0|m&-1040385,x=a[4272+(le*28|0)+(x<<2)>>2]|0,(ze&127|0)==127&&(ze=ue(a[848+(le*28|0)+20>>2]|0,0,45)|0,m=Ce()|0|m&-1040385,x=a[4272+(le*28|0)+20>>2]|0,y=Ws(ze|y,m)|0,m=Ce()|0,a[E>>2]=(a[E>>2]|0)+1)),U=ne(y|0,m|0,45)|0,Ce()|0,U=U&127;e:do if(jn(U)|0){t:do if((si(y,m)|0)==1){if((le|0)!=(U|0))if(MA(U,a[7696+(le*28|0)>>2]|0)|0){y=RA(y,m)|0,O=1,m=Ce()|0;break}else cn(23313,22416,436,22424);switch(q|0){case 3:{y=Ws(y,m)|0,m=Ce()|0,a[E>>2]=(a[E>>2]|0)+1,O=0;break t}case 5:{y=RA(y,m)|0,m=Ce()|0,a[E>>2]=(a[E>>2]|0)+5,O=0;break t}case 0:return ze=9,ze|0;default:return ze=1,ze|0}}else O=0;while(0);if((x|0)>0){R=0;do y=yu(y,m)|0,m=Ce()|0,R=R+1|0;while((R|0)!=(x|0))}if((le|0)!=(U|0)){if(!(TA(U)|0)){if((O|0)!=0|(si(y,m)|0)!=5)break;a[E>>2]=(a[E>>2]|0)+1;break}switch(de&127){case 8:case 118:break e}(si(y,m)|0)!=3&&(a[E>>2]=(a[E>>2]|0)+1)}}else if((x|0)>0){R=0;do y=Ws(y,m)|0,m=Ce()|0,R=R+1|0;while((R|0)!=(x|0))}while(0);return a[E>>2]=((a[E>>2]|0)+x|0)%6|0,ze=I,a[ze>>2]=y,a[ze+4>>2]=m,ze=0,ze|0}function lt(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0;for(U=we,we=we+16|0,R=U,O=U+8|0,I=(vr(y,m)|0)==0,I=I?1:2;;){if(a[O>>2]=0,ee=(Ue(y,m,I,O,R)|0)==0,q=R,ee&((a[q>>2]|0)==(x|0)?(a[q+4>>2]|0)==(E|0):0)){y=4;break}if(I=I+1|0,I>>>0>=7){I=7,y=4;break}}return(y|0)==4?(we=U,I|0):0}function bt(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0;if(ze=we,we=we+16|0,Be=ze,He=ze+8|0,de=Be,a[de>>2]=y,a[de+4>>2]=m,!x)return He=E,a[He>>2]=y,a[He+4>>2]=m,He=0,we=ze,He|0;a[He>>2]=0;e:do if(vr(y,m)|0)y=9;else{if(R=(x|0)>0,R){I=0,de=y;do{if(y=Ue(de,m,4,He,Be)|0,y|0)break e;if(m=Be,de=a[m>>2]|0,m=a[m+4>>2]|0,I=I+1|0,vr(de,m)|0){y=9;break e}}while((I|0)<(x|0));if(le=E,a[le>>2]=de,a[le+4>>2]=m,le=x+-1|0,R){ee=0,y=1;do{if(I=22384+(ee<<2)|0,(ee|0)==5)for(O=a[I>>2]|0,R=0,I=y;;){if(y=Be,y=Ue(a[y>>2]|0,a[y+4>>2]|0,O,He,Be)|0,y|0)break e;if((R|0)!=(le|0))if(q=Be,U=a[q>>2]|0,q=a[q+4>>2]|0,y=E+(I<<3)|0,a[y>>2]=U,a[y+4>>2]=q,!(vr(U,q)|0))y=I+1|0;else{y=9;break e}else y=I;if(R=R+1|0,(R|0)>=(x|0))break;I=y}else for(O=Be,q=a[I>>2]|0,U=0,I=y,R=a[O>>2]|0,O=a[O+4>>2]|0;;){if(y=Ue(R,O,q,He,Be)|0,y|0)break e;if(O=Be,R=a[O>>2]|0,O=a[O+4>>2]|0,y=E+(I<<3)|0,a[y>>2]=R,a[y+4>>2]=O,y=I+1|0,vr(R,O)|0){y=9;break e}if(U=U+1|0,(U|0)>=(x|0))break;I=y}ee=ee+1|0}while(ee>>>0<6);y=Be,O=de,I=a[y>>2]|0,R=m,y=a[y+4>>2]|0}else O=de,I=de,R=m,y=m}else O=E,a[O>>2]=y,a[O+4>>2]=m,O=y,I=y,R=m,y=m;y=(O|0)==(I|0)&(R|0)==(y|0)?0:9}while(0);return He=y,we=ze,He|0}function Qt(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0;if(U=we,we=we+48|0,I=U+16|0,R=U+8|0,O=U,x|0)return O=15,we=U,O|0;if(ee=y,q=a[ee+4>>2]|0,x=R,a[x>>2]=a[ee>>2],a[x+4>>2]=q,Co(R,I),m=xc(I,m,O)|0,!m){if(x=a[R>>2]|0,R=a[y+8>>2]|0,(R|0)>0){I=a[y+12>>2]|0,m=0;do x=(a[I+(m<<3)>>2]|0)+x|0,m=m+1|0;while((m|0)<(R|0))}m=O,I=a[m>>2]|0,m=a[m+4>>2]|0,R=((x|0)<0)<<31>>31,(m|0)<(R|0)|(m|0)==(R|0)&I>>>0<x>>>0?(m=O,a[m>>2]=x,a[m+4>>2]=R,m=R):x=I,q=d(x|0,m|0,12,0)|0,ee=Ce()|0,m=O,a[m>>2]=q,a[m+4>>2]=ee,m=E,a[m>>2]=q,a[m+4>>2]=ee,m=0}return ee=m,we=U,ee|0}function Dn(y,m,x,E,I,R,O){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0,R=R|0,O=O|0;var U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0,ot=0,et=0,Gt=0,zt=0,gt=0,vt=0,kn=0,wn=0,mn=0,_n=0,En=0,Rn=0,lr=0,In=0,Sr=0,Xr=0,ll=0;if(lr=we,we=we+64|0,mn=lr+48|0,_n=lr+32|0,En=lr+24|0,Gt=lr+8|0,zt=lr,q=a[y>>2]|0,(q|0)<=0)return Rn=0,we=lr,Rn|0;for(gt=y+4|0,vt=mn+8|0,kn=_n+8|0,wn=Gt+8|0,U=0,ot=0;;){ee=a[gt>>2]|0,st=ee+(ot<<4)|0,a[mn>>2]=a[st>>2],a[mn+4>>2]=a[st+4>>2],a[mn+8>>2]=a[st+8>>2],a[mn+12>>2]=a[st+12>>2],(ot|0)==(q+-1|0)?(a[_n>>2]=a[ee>>2],a[_n+4>>2]=a[ee+4>>2],a[_n+8>>2]=a[ee+8>>2],a[_n+12>>2]=a[ee+12>>2]):(st=ee+(ot+1<<4)|0,a[_n>>2]=a[st>>2],a[_n+4>>2]=a[st+4>>2],a[_n+8>>2]=a[st+8>>2],a[_n+12>>2]=a[st+12>>2]),q=Il(mn,_n,E,En)|0;e:do if(q)ee=0,U=q;else if(ee=En,q=a[ee>>2]|0,ee=a[ee+4>>2]|0,(ee|0)>0|(ee|0)==0&q>>>0>0){ct=0,st=0;t:for(;;){if(ll=+G[mn>>3],ft=w(q|0,ee|0,ct|0,st|0)|0,Xr=+(ft>>>0)+4294967296*+(Ce()|0),In=+(q>>>0)+4294967296*+(ee|0),Sr=+(ct>>>0)+4294967296*+(st|0),G[Gt>>3]=ll*Xr/In+ +G[_n>>3]*Sr/In,G[wn>>3]=+G[vt>>3]*Xr/In+ +G[kn>>3]*Sr/In,q=fs(Gt,E,zt)|0,q|0){U=q;break}ft=zt,Je=a[ft>>2]|0,ft=a[ft+4>>2]|0,Be=X(Je|0,ft|0,m|0,x|0)|0,le=Ce()|0,q=O+(Be<<3)|0,de=q,ee=a[de>>2]|0,de=a[de+4>>2]|0;n:do if((ee|0)==0&(de|0)==0)et=q,Rn=16;else for(He=0,ze=0;;){if((He|0)>(x|0)|(He|0)==(x|0)&ze>>>0>m>>>0){U=1;break t}if((ee|0)==(Je|0)&(de|0)==(ft|0))break n;if(q=d(Be|0,le|0,1,0)|0,Be=W(q|0,Ce()|0,m|0,x|0)|0,le=Ce()|0,ze=d(ze|0,He|0,1,0)|0,He=Ce()|0,q=O+(Be<<3)|0,de=q,ee=a[de>>2]|0,de=a[de+4>>2]|0,(ee|0)==0&(de|0)==0){et=q,Rn=16;break}}while(0);if((Rn|0)==16&&(Rn=0,!((Je|0)==0&(ft|0)==0))&&(ze=et,a[ze>>2]=Je,a[ze+4>>2]=ft,ze=R+(a[I>>2]<<3)|0,a[ze>>2]=Je,a[ze+4>>2]=ft,ze=I,ze=d(a[ze>>2]|0,a[ze+4>>2]|0,1,0)|0,Je=Ce()|0,ft=I,a[ft>>2]=ze,a[ft+4>>2]=Je),ct=d(ct|0,st|0,1,0)|0,st=Ce()|0,ee=En,q=a[ee>>2]|0,ee=a[ee+4>>2]|0,!((ee|0)>(st|0)|(ee|0)==(st|0)&q>>>0>ct>>>0)){ee=1;break e}}ee=0}else ee=1;while(0);if(ot=ot+1|0,!ee){Rn=21;break}if(q=a[y>>2]|0,(ot|0)>=(q|0)){U=0,Rn=21;break}}return(Rn|0)==21?(we=lr,U|0):0}function Dr(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0,ot=0,et=0,Gt=0,zt=0,gt=0,vt=0,kn=0,wn=0,mn=0,_n=0,En=0,Rn=0,lr=0,In=0,Sr=0,Xr=0;if(Xr=we,we=we+112|0,Rn=Xr+80|0,q=Xr+72|0,lr=Xr,In=Xr+56|0,x|0)return Sr=15,we=Xr,Sr|0;if(ee=y+8|0,Sr=v((a[ee>>2]<<5)+32|0)|0,!Sr)return Sr=13,we=Xr,Sr|0;if(Tu(y,Sr),_n=y,En=a[_n+4>>2]|0,x=q,a[x>>2]=a[_n>>2],a[x+4>>2]=En,Co(q,Rn),x=xc(Rn,m,lr)|0,x)_n=0,En=0;else{if(x=a[q>>2]|0,R=a[ee>>2]|0,(R|0)>0){O=a[y+12>>2]|0,I=0;do x=(a[O+(I<<3)>>2]|0)+x|0,I=I+1|0;while((I|0)!=(R|0));I=x}else I=x;x=lr,R=a[x>>2]|0,x=a[x+4>>2]|0,O=((I|0)<0)<<31>>31,(x|0)<(O|0)|(x|0)==(O|0)&R>>>0<I>>>0?(x=lr,a[x>>2]=I,a[x+4>>2]=O,x=O):I=R,_n=d(I|0,x|0,12,0)|0,En=Ce()|0,x=lr,a[x>>2]=_n,a[x+4>>2]=En,x=0}if(x|0)return A(Sr),Sr=x,we=Xr,Sr|0;if(I=h(_n,8)|0,!I)return A(Sr),Sr=13,we=Xr,Sr|0;if(U=h(_n,8)|0,!U)return A(Sr),A(I),Sr=13,we=Xr,Sr|0;wn=Rn,a[wn>>2]=0,a[wn+4>>2]=0,wn=y,mn=a[wn+4>>2]|0,x=q,a[x>>2]=a[wn>>2],a[x+4>>2]=mn,x=Dn(q,_n,En,m,Rn,I,U)|0;e:do if(x)A(I),A(U),A(Sr);else{t:do if((a[ee>>2]|0)>0){for(O=y+12|0,R=0;x=Dn((a[O>>2]|0)+(R<<3)|0,_n,En,m,Rn,I,U)|0,R=R+1|0,!(x|0);)if((R|0)>=(a[ee>>2]|0))break t;A(I),A(U),A(Sr);break e}while(0);(En|0)>0|(En|0)==0&_n>>>0>0&&Se(U|0,0,_n<<3|0)|0,mn=Rn,wn=a[mn+4>>2]|0;t:do if((wn|0)>0|(wn|0)==0&(a[mn>>2]|0)>>>0>0){gt=I,vt=U,kn=I,wn=U,mn=I,x=I,et=I,Gt=U,zt=U,I=U;n:for(;;){for(ft=0,ct=0,st=0,ot=0,R=0,O=0;;){U=lr,q=U+56|0;do a[U>>2]=0,U=U+4|0;while((U|0)<(q|0));if(m=gt+(ft<<3)|0,ee=a[m>>2]|0,m=a[m+4>>2]|0,me(ee,m,1,lr,0)|0){U=lr,q=U+56|0;do a[U>>2]=0,U=U+4|0;while((U|0)<(q|0));U=h(7,4)|0,U|0&&(Te(ee,m,1,lr,U,7,0,0)|0,A(U))}for(Je=0;;){ze=lr+(Je<<3)|0,He=a[ze>>2]|0,ze=a[ze+4>>2]|0;r:do if((He|0)==0&(ze|0)==0)U=R,q=O;else{if(le=X(He|0,ze|0,_n|0,En|0)|0,ee=Ce()|0,U=E+(le<<3)|0,m=U,q=a[m>>2]|0,m=a[m+4>>2]|0,!((q|0)==0&(m|0)==0)){de=0,Be=0;do{if((de|0)>(En|0)|(de|0)==(En|0)&Be>>>0>_n>>>0)break n;if((q|0)==(He|0)&(m|0)==(ze|0)){U=R,q=O;break r}U=d(le|0,ee|0,1,0)|0,le=W(U|0,Ce()|0,_n|0,En|0)|0,ee=Ce()|0,Be=d(Be|0,de|0,1,0)|0,de=Ce()|0,U=E+(le<<3)|0,m=U,q=a[m>>2]|0,m=a[m+4>>2]|0}while(!((q|0)==0&(m|0)==0))}(He|0)==0&(ze|0)==0?(U=R,q=O):(To(He,ze,In)|0,Sa(y,Sr,In)|0&&(Be=d(R|0,O|0,1,0)|0,O=Ce()|0,de=U,a[de>>2]=He,a[de+4>>2]=ze,R=vt+(R<<3)|0,a[R>>2]=He,a[R+4>>2]=ze,R=Be),U=R,q=O)}while(0);if(Je=Je+1|0,Je>>>0>=7)break;R=U,O=q}if(ft=d(ft|0,ct|0,1,0)|0,ct=Ce()|0,st=d(st|0,ot|0,1,0)|0,ot=Ce()|0,O=Rn,R=a[O>>2]|0,O=a[O+4>>2]|0,(ot|0)<(O|0)|(ot|0)==(O|0)&st>>>0<R>>>0)R=U,O=q;else break}if((O|0)>0|(O|0)==0&R>>>0>0){R=0,O=0;do ot=gt+(R<<3)|0,a[ot>>2]=0,a[ot+4>>2]=0,R=d(R|0,O|0,1,0)|0,O=Ce()|0,ot=Rn,st=a[ot+4>>2]|0;while((O|0)<(st|0)|((O|0)==(st|0)?R>>>0<(a[ot>>2]|0)>>>0:0))}if(ot=Rn,a[ot>>2]=U,a[ot+4>>2]=q,(q|0)>0|(q|0)==0&U>>>0>0)Je=I,ft=zt,ct=mn,st=Gt,ot=vt,I=et,zt=x,Gt=kn,et=Je,x=ft,mn=wn,wn=ct,kn=st,vt=gt,gt=ot;else break t}A(kn),A(wn),A(Sr),x=1;break e}else x=U;while(0);A(Sr),A(I),A(x),x=0}while(0);return Sr=x,we=Xr,Sr|0}function en(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(le=we,we=we+176|0,q=le,(m|0)<1)return Ys(x,0,0),ee=0,we=le,ee|0;for(U=y,U=ne(a[U>>2]|0,a[U+4>>2]|0,52)|0,Ce()|0,Ys(x,(m|0)>6?m:6,U&15),U=0;E=y+(U<<3)|0,E=yi(a[E>>2]|0,a[E+4>>2]|0,q)|0,!(E|0);){if(E=a[q>>2]|0,(E|0)>0){O=0;do R=q+8+(O<<4)|0,O=O+1|0,E=q+8+(((O|0)%(E|0)|0)<<4)|0,I=Hr(x,E,R)|0,I?Ct(x,I)|0:Pt(x,R,E)|0,E=a[q>>2]|0;while((O|0)<(E|0))}if(U=U+1|0,(U|0)>=(m|0)){E=0,ee=13;break}}return(ee|0)==13?(we=le,E|0):(ks(x),ee=E,we=le,ee|0)}function Br(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0;if(R=we,we=we+32|0,E=R,I=R+16|0,y=en(y,m,I)|0,y|0)return x=y,we=R,x|0;if(a[x>>2]=0,a[x+4>>2]=0,a[x+8>>2]=0,y=Xs(I)|0,y|0)do{m=Vt(x)|0;do BA(m,y)|0,O=y+16|0,a[E>>2]=a[O>>2],a[E+4>>2]=a[O+4>>2],a[E+8>>2]=a[O+8>>2],a[E+12>>2]=a[O+12>>2],Ct(I,y)|0,y=al(I,E)|0;while(y|0);y=Xs(I)|0}while(y|0);return ks(I),y=zA(x)|0,y?($l(x),O=y,we=R,O|0):(O=0,we=R,O|0)}function jn(y){return y=y|0,y>>>0>121?(y=0,y|0):(y=a[7696+(y*28|0)+16>>2]|0,y|0)}function TA(y){return y=y|0,(y|0)==4|(y|0)==117|0}function SA(y){return y=y|0,a[11120+((a[y>>2]|0)*216|0)+((a[y+4>>2]|0)*72|0)+((a[y+8>>2]|0)*24|0)+(a[y+12>>2]<<3)>>2]|0}function CA(y){return y=y|0,a[11120+((a[y>>2]|0)*216|0)+((a[y+4>>2]|0)*72|0)+((a[y+8>>2]|0)*24|0)+(a[y+12>>2]<<3)+4>>2]|0}function au(y,m){y=y|0,m=m|0,y=7696+(y*28|0)|0,a[m>>2]=a[y>>2],a[m+4>>2]=a[y+4>>2],a[m+8>>2]=a[y+8>>2],a[m+12>>2]=a[y+12>>2]}function lu(y,m){y=y|0,m=m|0;var x=0,E=0;if(m>>>0>20)return m=-1,m|0;do if((a[11120+(m*216|0)>>2]|0)!=(y|0))if((a[11120+(m*216|0)+8>>2]|0)!=(y|0))if((a[11120+(m*216|0)+16>>2]|0)!=(y|0))if((a[11120+(m*216|0)+24>>2]|0)!=(y|0))if((a[11120+(m*216|0)+32>>2]|0)!=(y|0))if((a[11120+(m*216|0)+40>>2]|0)!=(y|0))if((a[11120+(m*216|0)+48>>2]|0)!=(y|0))if((a[11120+(m*216|0)+56>>2]|0)!=(y|0))if((a[11120+(m*216|0)+64>>2]|0)!=(y|0))if((a[11120+(m*216|0)+72>>2]|0)!=(y|0))if((a[11120+(m*216|0)+80>>2]|0)!=(y|0))if((a[11120+(m*216|0)+88>>2]|0)!=(y|0))if((a[11120+(m*216|0)+96>>2]|0)!=(y|0))if((a[11120+(m*216|0)+104>>2]|0)!=(y|0))if((a[11120+(m*216|0)+112>>2]|0)!=(y|0))if((a[11120+(m*216|0)+120>>2]|0)!=(y|0))if((a[11120+(m*216|0)+128>>2]|0)!=(y|0))if((a[11120+(m*216|0)+136>>2]|0)==(y|0))y=2,x=1,E=2;else{if((a[11120+(m*216|0)+144>>2]|0)==(y|0)){y=0,x=2,E=0;break}if((a[11120+(m*216|0)+152>>2]|0)==(y|0)){y=0,x=2,E=1;break}if((a[11120+(m*216|0)+160>>2]|0)==(y|0)){y=0,x=2,E=2;break}if((a[11120+(m*216|0)+168>>2]|0)==(y|0)){y=1,x=2,E=0;break}if((a[11120+(m*216|0)+176>>2]|0)==(y|0)){y=1,x=2,E=1;break}if((a[11120+(m*216|0)+184>>2]|0)==(y|0)){y=1,x=2,E=2;break}if((a[11120+(m*216|0)+192>>2]|0)==(y|0)){y=2,x=2,E=0;break}if((a[11120+(m*216|0)+200>>2]|0)==(y|0)){y=2,x=2,E=1;break}if((a[11120+(m*216|0)+208>>2]|0)==(y|0)){y=2,x=2,E=2;break}else y=-1;return y|0}else y=2,x=1,E=1;else y=2,x=1,E=0;else y=1,x=1,E=2;else y=1,x=1,E=1;else y=1,x=1,E=0;else y=0,x=1,E=2;else y=0,x=1,E=1;else y=0,x=1,E=0;else y=2,x=0,E=2;else y=2,x=0,E=1;else y=2,x=0,E=0;else y=1,x=0,E=2;else y=1,x=0,E=1;else y=1,x=0,E=0;else y=0,x=0,E=2;else y=0,x=0,E=1;else y=0,x=0,E=0;while(0);return m=a[11120+(m*216|0)+(x*72|0)+(y*24|0)+(E<<3)+4>>2]|0,m|0}function MA(y,m){return y=y|0,m=m|0,(a[7696+(y*28|0)+20>>2]|0)==(m|0)?(m=1,m|0):(m=(a[7696+(y*28|0)+24>>2]|0)==(m|0),m|0)}function Pl(y,m){return y=y|0,m=m|0,a[848+(y*28|0)+(m<<2)>>2]|0}function kl(y,m){return y=y|0,m=m|0,(a[848+(y*28|0)>>2]|0)==(m|0)?(m=0,m|0):(a[848+(y*28|0)+4>>2]|0)==(m|0)?(m=1,m|0):(a[848+(y*28|0)+8>>2]|0)==(m|0)?(m=2,m|0):(a[848+(y*28|0)+12>>2]|0)==(m|0)?(m=3,m|0):(a[848+(y*28|0)+16>>2]|0)==(m|0)?(m=4,m|0):(a[848+(y*28|0)+20>>2]|0)==(m|0)?(m=5,m|0):((a[848+(y*28|0)+24>>2]|0)==(m|0)?6:7)|0}function PA(){return 122}function kA(y){y=y|0;var m=0,x=0,E=0;m=0;do ue(m|0,0,45)|0,E=Ce()|0|134225919,x=y+(m<<3)|0,a[x>>2]=-1,a[x+4>>2]=E,m=m+1|0;while((m|0)!=122);return 0}function Kn(y){return y=y|0,+G[y+16>>3]<+G[y+24>>3]|0}function Au(y,m){y=y|0,m=m|0;var x=0,E=0,I=0;return x=+G[m>>3],!(x>=+G[y+8>>3])||!(x<=+G[y>>3])?(m=0,m|0):(E=+G[y+16>>3],x=+G[y+24>>3],I=+G[m+8>>3],m=I>=x,y=I<=E&1,E<x?m&&(y=1):m||(y=0),m=(y|0)!=0,m|0)}function xc(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0;ze=we,we=we+288|0,le=ze+264|0,de=ze+96|0,ee=ze,U=ee,q=U+96|0;do a[U>>2]=0,U=U+4|0;while((U|0)<(q|0));return m=Qs(m,ee)|0,m|0?(He=m,we=ze,He|0):(q=ee,ee=a[q>>2]|0,q=a[q+4>>2]|0,To(ee,q,le)|0,yi(ee,q,de)|0,O=+Vl(le,de+8|0),G[le>>3]=+G[y>>3],q=le+8|0,G[q>>3]=+G[y+16>>3],G[de>>3]=+G[y+8>>3],ee=de+8|0,G[ee>>3]=+G[y+24>>3],I=+Vl(le,de),ft=+G[q>>3]-+G[ee>>3],R=+Ie(+ft),Je=+G[le>>3]-+G[de>>3],E=+Ie(+Je),!(ft==0|Je==0)&&(ft=+Ee(+R,+E),ft=+qt(+(I*I/+Me(+(ft/+Me(+R,+E)),3)/(O*(O*2.59807621135)*.8))),G[Le>>3]=ft,Be=~~ft>>>0,He=+Ie(ft)>=1?ft>0?~~+xn(+Pe(ft/4294967296),4294967295)>>>0:~~+qt((ft-+(~~ft>>>0))/4294967296)>>>0:0,(a[Le+4>>2]&2146435072|0)!=2146435072)?(de=(Be|0)==0&(He|0)==0,m=x,a[m>>2]=de?1:Be,a[m+4>>2]=de?0:He,m=0):m=1,He=m,we=ze,He|0)}function Il(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0;ee=we,we=we+288|0,O=ee+264|0,U=ee+96|0,q=ee,I=q,R=I+96|0;do a[I>>2]=0,I=I+4|0;while((I|0)<(R|0));return x=Qs(x,q)|0,x|0?(E=x,we=ee,E|0):(x=q,I=a[x>>2]|0,x=a[x+4>>2]|0,To(I,x,O)|0,yi(I,x,U)|0,le=+Vl(O,U+8|0),le=+qt(+(+Vl(y,m)/(le*2))),G[Le>>3]=le,x=~~le>>>0,I=+Ie(le)>=1?le>0?~~+xn(+Pe(le/4294967296),4294967295)>>>0:~~+qt((le-+(~~le>>>0))/4294967296)>>>0:0,(a[Le+4>>2]&2146435072|0)==2146435072?(E=1,we=ee,E|0):(q=(x|0)==0&(I|0)==0,a[E>>2]=q?1:x,a[E+4>>2]=q?0:I,E=0,we=ee,E|0))}function Zr(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0,a[y>>2]=m,a[y+4>>2]=x,a[y+8>>2]=E}function Qo(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0;de=m+8|0,a[de>>2]=0,q=+G[y>>3],O=+Ie(+q),ee=+G[y+8>>3],U=+Ie(+ee)/.8660254037844386,O=O+U*.5,x=~~O,y=~~U,O=O-+(x|0),U=U-+(y|0);do if(O<.5)if(O<.3333333333333333)if(a[m>>2]=x,U<(O+1)*.5){a[m+4>>2]=y;break}else{y=y+1|0,a[m+4>>2]=y;break}else if(Be=1-O,y=(!(U<Be)&1)+y|0,a[m+4>>2]=y,Be<=U&U<O*2){x=x+1|0,a[m>>2]=x;break}else{a[m>>2]=x;break}else{if(!(O<.6666666666666666))if(x=x+1|0,a[m>>2]=x,U<O*.5){a[m+4>>2]=y;break}else{y=y+1|0,a[m+4>>2]=y;break}if(U<1-O){if(a[m+4>>2]=y,O*2+-1<U){a[m>>2]=x;break}}else y=y+1|0,a[m+4>>2]=y;x=x+1|0,a[m>>2]=x}while(0);do if(q<0)if(y&1){le=(y+1|0)/2|0,le=w(x|0,((x|0)<0)<<31>>31|0,le|0,((le|0)<0)<<31>>31|0)|0,x=~~(+(x|0)-((+(le>>>0)+4294967296*+(Ce()|0))*2+1)),a[m>>2]=x;break}else{le=(y|0)/2|0,le=w(x|0,((x|0)<0)<<31>>31|0,le|0,((le|0)<0)<<31>>31|0)|0,x=~~(+(x|0)-(+(le>>>0)+4294967296*+(Ce()|0))*2),a[m>>2]=x;break}while(0);le=m+4|0,ee<0&&(x=x-((y<<1|1|0)/2|0)|0,a[m>>2]=x,y=0-y|0,a[le>>2]=y),E=y-x|0,(x|0)<0?(I=0-x|0,a[le>>2]=E,a[de>>2]=I,a[m>>2]=0,y=E,x=0):I=0,(y|0)<0&&(x=x-y|0,a[m>>2]=x,I=I-y|0,a[de>>2]=I,a[le>>2]=0,y=0),R=x-I|0,E=y-I|0,(I|0)<0&&(a[m>>2]=R,a[le>>2]=E,a[de>>2]=0,y=E,x=R,I=0),E=(y|0)<(x|0)?y:x,E=(I|0)<(E|0)?I:E,!((E|0)<=0)&&(a[m>>2]=x-E,a[le>>2]=y-E,a[de>>2]=I-E)}function On(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0;m=a[y>>2]|0,O=y+4|0,x=a[O>>2]|0,(m|0)<0&&(x=x-m|0,a[O>>2]=x,R=y+8|0,a[R>>2]=(a[R>>2]|0)-m,a[y>>2]=0,m=0),(x|0)<0?(m=m-x|0,a[y>>2]=m,R=y+8|0,I=(a[R>>2]|0)-x|0,a[R>>2]=I,a[O>>2]=0,x=0):(I=y+8|0,R=I,I=a[I>>2]|0),(I|0)<0&&(m=m-I|0,a[y>>2]=m,x=x-I|0,a[O>>2]=x,a[R>>2]=0,I=0),E=(x|0)<(m|0)?x:m,E=(I|0)<(E|0)?I:E,!((E|0)<=0)&&(a[y>>2]=m-E,a[O>>2]=x-E,a[R>>2]=I-E)}function Ms(y,m){y=y|0,m=m|0;var x=0,E=0;E=a[y+8>>2]|0,x=+((a[y+4>>2]|0)-E|0),G[m>>3]=+((a[y>>2]|0)-E|0)-x*.5,G[m+8>>3]=x*.8660254037844386}function ii(y,m,x){y=y|0,m=m|0,x=x|0,a[x>>2]=(a[m>>2]|0)+(a[y>>2]|0),a[x+4>>2]=(a[m+4>>2]|0)+(a[y+4>>2]|0),a[x+8>>2]=(a[m+8>>2]|0)+(a[y+8>>2]|0)}function xo(y,m,x){y=y|0,m=m|0,x=x|0,a[x>>2]=(a[y>>2]|0)-(a[m>>2]|0),a[x+4>>2]=(a[y+4>>2]|0)-(a[m+4>>2]|0),a[x+8>>2]=(a[y+8>>2]|0)-(a[m+8>>2]|0)}function Ll(y,m){y=y|0,m=m|0;var x=0,E=0;x=an(a[y>>2]|0,m)|0,a[y>>2]=x,x=y+4|0,E=an(a[x>>2]|0,m)|0,a[x>>2]=E,y=y+8|0,m=an(a[y>>2]|0,m)|0,a[y>>2]=m}function qo(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;O=a[y>>2]|0,U=(O|0)<0,E=(a[y+4>>2]|0)-(U?O:0)|0,R=(E|0)<0,I=(R?0-E|0:0)+((a[y+8>>2]|0)-(U?O:0))|0,x=(I|0)<0,y=x?0:I,m=(R?0:E)-(x?I:0)|0,I=(U?0:O)-(R?E:0)-(x?I:0)|0,x=(m|0)<(I|0)?m:I,x=(y|0)<(x|0)?y:x,E=(x|0)>0,y=y-(E?x:0)|0,m=m-(E?x:0)|0;e:do switch(I-(E?x:0)|0){case 0:switch(m|0){case 0:return U=y|0?(y|0)==1?1:7:0,U|0;case 1:return U=y|0?(y|0)==1?3:7:2,U|0;default:break e}case 1:switch(m|0){case 0:return U=y|0?(y|0)==1?5:7:4,U|0;case 1:{if(!y)y=6;else break e;return y|0}default:break e}}while(0);return U=7,U|0}function ya(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;O=y+8|0,I=a[O>>2]|0,R=(a[y>>2]|0)-I|0,U=y+4|0,I=(a[U>>2]|0)-I|0;do if(R>>>0>715827881|I>>>0>715827881){if(x=(R|0)>0,x){if((2147483647-R|0)<(R|0)||(2147483647-(R<<1)|0)<(R|0))return U=1,U|0}else if((-2147483648-R|0)>(R|0)||(-2147483648-(R<<1)|0)>(R|0))return U=1,U|0;if(m=R*3|0,(I|0)>0){if((2147483647-I|0)<(I|0))return U=1,U|0}else if((-2147483648-I|0)>(I|0))return U=1,U|0;if(E=I<<1,(R|0)>-1){if((m|-2147483648|0)>=(I|0))return U=1,U|0}else if((m^-2147483648|0)<(I|0))return U=1,U|0;if(x){if((2147483647-R|0)<(E|0))m=1;else{x=E;break}return m|0}else{if((-2147483648-R|0)>(E|0))m=1;else{x=E;break}return m|0}}else x=I<<1,m=R*3|0;while(0);E=c(+(m-I|0)/7)|0,a[y>>2]=E,I=c(+(x+R|0)/7)|0,a[U>>2]=I,a[O>>2]=0,x=(I|0)<(E|0),m=x?E:I,x=x?I:E;do if((x|0)<0){if((m|0)>0){if((m|-2147483648|0)<(x|0)&((x|0)!=-2147483648&(2147483647-m|0)>=(x|0)))break;cn(23313,22444,355,22455)}if((x|0)==-2147483648|(-2147483648-m|0)>(x|0)&&cn(23313,22444,355,22455),(m|0)>-1){if((m|-2147483648|0)<(x|0))break;cn(23313,22444,355,22455)}else{if((m^-2147483648|0)>=(x|0))break;cn(23313,22444,355,22455)}}while(0);return m=I-E|0,(E|0)<0?(x=0-E|0,a[U>>2]=m,a[O>>2]=x,a[y>>2]=0,E=0):(m=I,x=0),(m|0)<0&&(E=E-m|0,a[y>>2]=E,x=x-m|0,a[O>>2]=x,a[U>>2]=0,m=0),R=E-x|0,I=m-x|0,(x|0)<0?(a[y>>2]=R,a[U>>2]=I,a[O>>2]=0,m=I,I=R,x=0):I=E,E=(m|0)<(I|0)?m:I,E=(x|0)<(E|0)?x:E,(E|0)<=0?(U=0,U|0):(a[y>>2]=I-E,a[U>>2]=m-E,a[O>>2]=x-E,U=0,U|0)}function wo(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;O=y+8|0,I=a[O>>2]|0,R=(a[y>>2]|0)-I|0,U=y+4|0,I=(a[U>>2]|0)-I|0;do if(R>>>0>715827881|I>>>0>715827881){if(x=(R|0)>0,x){if((2147483647-R|0)<(R|0))return U=1,U|0}else if((-2147483648-R|0)>(R|0))return U=1,U|0;if(m=R<<1,(I|0)>0){if((2147483647-I|0)<(I|0)||(2147483647-(I<<1)|0)<(I|0))return U=1,U|0}else if((-2147483648-I|0)>(I|0)||(-2147483648-(I<<1)|0)>(I|0))return U=1,U|0;if(E=I*3|0,x){if((2147483647-m|0)<(I|0))return U=1,U|0}else if((-2147483648-m|0)>(I|0))return U=1,U|0;if((I|0)>-1){if((E|-2147483648|0)<(R|0)){x=E;break}else m=1;return m|0}else{if((E^-2147483648|0)<(R|0))m=1;else{x=E;break}return m|0}}else x=I*3|0,m=R<<1;while(0);E=c(+(m+I|0)/7)|0,a[y>>2]=E,I=c(+(x-R|0)/7)|0,a[U>>2]=I,a[O>>2]=0,x=(I|0)<(E|0),m=x?E:I,x=x?I:E;do if((x|0)<0){if((m|0)>0){if((m|-2147483648|0)<(x|0)&((x|0)!=-2147483648&(2147483647-m|0)>=(x|0)))break;cn(23313,22444,404,22469)}if((x|0)==-2147483648|(-2147483648-m|0)>(x|0)&&cn(23313,22444,404,22469),(m|0)>-1){if((m|-2147483648|0)<(x|0))break;cn(23313,22444,404,22469)}else{if((m^-2147483648|0)>=(x|0))break;cn(23313,22444,404,22469)}}while(0);return m=I-E|0,(E|0)<0?(x=0-E|0,a[U>>2]=m,a[O>>2]=x,a[y>>2]=0,E=0):(m=I,x=0),(m|0)<0&&(E=E-m|0,a[y>>2]=E,x=x-m|0,a[O>>2]=x,a[U>>2]=0,m=0),R=E-x|0,I=m-x|0,(x|0)<0?(a[y>>2]=R,a[U>>2]=I,a[O>>2]=0,m=I,I=R,x=0):I=E,E=(m|0)<(I|0)?m:I,E=(x|0)<(E|0)?x:E,(E|0)<=0?(U=0,U|0):(a[y>>2]=I-E,a[U>>2]=m-E,a[O>>2]=x-E,U=0,U|0)}function IA(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;O=y+8|0,x=a[O>>2]|0,m=(a[y>>2]|0)-x|0,U=y+4|0,x=(a[U>>2]|0)-x|0,E=c(+((m*3|0)-x|0)/7)|0,a[y>>2]=E,m=c(+((x<<1)+m|0)/7)|0,a[U>>2]=m,a[O>>2]=0,x=m-E|0,(E|0)<0?(R=0-E|0,a[U>>2]=x,a[O>>2]=R,a[y>>2]=0,m=x,E=0,x=R):x=0,(m|0)<0&&(E=E-m|0,a[y>>2]=E,x=x-m|0,a[O>>2]=x,a[U>>2]=0,m=0),R=E-x|0,I=m-x|0,(x|0)<0?(a[y>>2]=R,a[U>>2]=I,a[O>>2]=0,m=I,I=R,x=0):I=E,E=(m|0)<(I|0)?m:I,E=(x|0)<(E|0)?x:E,!((E|0)<=0)&&(a[y>>2]=I-E,a[U>>2]=m-E,a[O>>2]=x-E)}function Ya(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;O=y+8|0,x=a[O>>2]|0,m=(a[y>>2]|0)-x|0,U=y+4|0,x=(a[U>>2]|0)-x|0,E=c(+((m<<1)+x|0)/7)|0,a[y>>2]=E,m=c(+((x*3|0)-m|0)/7)|0,a[U>>2]=m,a[O>>2]=0,x=m-E|0,(E|0)<0?(R=0-E|0,a[U>>2]=x,a[O>>2]=R,a[y>>2]=0,m=x,E=0,x=R):x=0,(m|0)<0&&(E=E-m|0,a[y>>2]=E,x=x-m|0,a[O>>2]=x,a[U>>2]=0,m=0),R=E-x|0,I=m-x|0,(x|0)<0?(a[y>>2]=R,a[U>>2]=I,a[O>>2]=0,m=I,I=R,x=0):I=E,E=(m|0)<(I|0)?m:I,E=(x|0)<(E|0)?x:E,!((E|0)<=0)&&(a[y>>2]=I-E,a[U>>2]=m-E,a[O>>2]=x-E)}function Zo(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;m=a[y>>2]|0,O=y+4|0,x=a[O>>2]|0,U=y+8|0,E=a[U>>2]|0,I=x+(m*3|0)|0,a[y>>2]=I,x=E+(x*3|0)|0,a[O>>2]=x,m=(E*3|0)+m|0,a[U>>2]=m,E=x-I|0,(I|0)<0?(m=m-I|0,a[O>>2]=E,a[U>>2]=m,a[y>>2]=0,x=E,E=0):E=I,(x|0)<0&&(E=E-x|0,a[y>>2]=E,m=m-x|0,a[U>>2]=m,a[O>>2]=0,x=0),R=E-m|0,I=x-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=I,a[U>>2]=0,E=R,m=0):I=x,x=(I|0)<(E|0)?I:E,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=E-x,a[O>>2]=I-x,a[U>>2]=m-x)}function Wi(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;I=a[y>>2]|0,O=y+4|0,m=a[O>>2]|0,U=y+8|0,x=a[U>>2]|0,E=(m*3|0)+I|0,I=x+(I*3|0)|0,a[y>>2]=I,a[O>>2]=E,m=(x*3|0)+m|0,a[U>>2]=m,x=E-I|0,(I|0)<0?(m=m-I|0,a[O>>2]=x,a[U>>2]=m,a[y>>2]=0,I=0):x=E,(x|0)<0&&(I=I-x|0,a[y>>2]=I,m=m-x|0,a[U>>2]=m,a[O>>2]=0,x=0),R=I-m|0,E=x-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=E,a[U>>2]=0,I=R,m=0):E=x,x=(E|0)<(I|0)?E:I,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=I-x,a[O>>2]=E-x,a[U>>2]=m-x)}function Qi(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0;(m+-1|0)>>>0>=6||(I=(a[15440+(m*12|0)>>2]|0)+(a[y>>2]|0)|0,a[y>>2]=I,U=y+4|0,E=(a[15440+(m*12|0)+4>>2]|0)+(a[U>>2]|0)|0,a[U>>2]=E,O=y+8|0,m=(a[15440+(m*12|0)+8>>2]|0)+(a[O>>2]|0)|0,a[O>>2]=m,x=E-I|0,(I|0)<0?(m=m-I|0,a[U>>2]=x,a[O>>2]=m,a[y>>2]=0,E=0):(x=E,E=I),(x|0)<0&&(E=E-x|0,a[y>>2]=E,m=m-x|0,a[O>>2]=m,a[U>>2]=0,x=0),R=E-m|0,I=x-m|0,(m|0)<0?(a[y>>2]=R,a[U>>2]=I,a[O>>2]=0,E=R,m=0):I=x,x=(I|0)<(E|0)?I:E,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=E-x,a[U>>2]=I-x,a[O>>2]=m-x))}function uu(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;I=a[y>>2]|0,O=y+4|0,m=a[O>>2]|0,U=y+8|0,x=a[U>>2]|0,E=m+I|0,I=x+I|0,a[y>>2]=I,a[O>>2]=E,m=x+m|0,a[U>>2]=m,x=E-I|0,(I|0)<0?(m=m-I|0,a[O>>2]=x,a[U>>2]=m,a[y>>2]=0,E=0):(x=E,E=I),(x|0)<0&&(E=E-x|0,a[y>>2]=E,m=m-x|0,a[U>>2]=m,a[O>>2]=0,x=0),R=E-m|0,I=x-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=I,a[U>>2]=0,E=R,m=0):I=x,x=(I|0)<(E|0)?I:E,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=E-x,a[O>>2]=I-x,a[U>>2]=m-x)}function Dl(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;m=a[y>>2]|0,O=y+4|0,E=a[O>>2]|0,U=y+8|0,x=a[U>>2]|0,I=E+m|0,a[y>>2]=I,E=x+E|0,a[O>>2]=E,m=x+m|0,a[U>>2]=m,x=E-I|0,(I|0)<0?(m=m-I|0,a[O>>2]=x,a[U>>2]=m,a[y>>2]=0,E=0):(x=E,E=I),(x|0)<0&&(E=E-x|0,a[y>>2]=E,m=m-x|0,a[U>>2]=m,a[O>>2]=0,x=0),R=E-m|0,I=x-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=I,a[U>>2]=0,E=R,m=0):I=x,x=(I|0)<(E|0)?I:E,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=E-x,a[O>>2]=I-x,a[U>>2]=m-x)}function bo(y){switch(y=y|0,y|0){case 1:{y=5;break}case 5:{y=4;break}case 4:{y=6;break}case 6:{y=2;break}case 2:{y=3;break}case 3:{y=1;break}}return y|0}function Yo(y){switch(y=y|0,y|0){case 1:{y=3;break}case 3:{y=2;break}case 2:{y=6;break}case 6:{y=4;break}case 4:{y=5;break}case 5:{y=1;break}}return y|0}function wc(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;m=a[y>>2]|0,O=y+4|0,x=a[O>>2]|0,U=y+8|0,E=a[U>>2]|0,I=x+(m<<1)|0,a[y>>2]=I,x=E+(x<<1)|0,a[O>>2]=x,m=(E<<1)+m|0,a[U>>2]=m,E=x-I|0,(I|0)<0?(m=m-I|0,a[O>>2]=E,a[U>>2]=m,a[y>>2]=0,x=E,E=0):E=I,(x|0)<0&&(E=E-x|0,a[y>>2]=E,m=m-x|0,a[U>>2]=m,a[O>>2]=0,x=0),R=E-m|0,I=x-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=I,a[U>>2]=0,E=R,m=0):I=x,x=(I|0)<(E|0)?I:E,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=E-x,a[O>>2]=I-x,a[U>>2]=m-x)}function cu(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;I=a[y>>2]|0,O=y+4|0,m=a[O>>2]|0,U=y+8|0,x=a[U>>2]|0,E=(m<<1)+I|0,I=x+(I<<1)|0,a[y>>2]=I,a[O>>2]=E,m=(x<<1)+m|0,a[U>>2]=m,x=E-I|0,(I|0)<0?(m=m-I|0,a[O>>2]=x,a[U>>2]=m,a[y>>2]=0,I=0):x=E,(x|0)<0&&(I=I-x|0,a[y>>2]=I,m=m-x|0,a[U>>2]=m,a[O>>2]=0,x=0),R=I-m|0,E=x-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=E,a[U>>2]=0,I=R,m=0):E=x,x=(E|0)<(I|0)?E:I,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=I-x,a[O>>2]=E-x,a[U>>2]=m-x)}function Rl(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0;return O=(a[y>>2]|0)-(a[m>>2]|0)|0,U=(O|0)<0,E=(a[y+4>>2]|0)-(a[m+4>>2]|0)-(U?O:0)|0,R=(E|0)<0,I=(U?0-O|0:0)+(a[y+8>>2]|0)-(a[m+8>>2]|0)+(R?0-E|0:0)|0,y=(I|0)<0,m=y?0:I,x=(R?0:E)-(y?I:0)|0,I=(U?0:O)-(R?E:0)-(y?I:0)|0,y=(x|0)<(I|0)?x:I,y=(m|0)<(y|0)?m:y,E=(y|0)>0,m=m-(E?y:0)|0,x=x-(E?y:0)|0,y=I-(E?y:0)|0,y=(y|0)>-1?y:0-y|0,x=(x|0)>-1?x:0-x|0,m=(m|0)>-1?m:0-m|0,m=(x|0)>(m|0)?x:m,((y|0)>(m|0)?y:m)|0}function LA(y,m){y=y|0,m=m|0;var x=0;x=a[y+8>>2]|0,a[m>>2]=(a[y>>2]|0)-x,a[m+4>>2]=(a[y+4>>2]|0)-x}function hu(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0;E=a[y>>2]|0,a[m>>2]=E,I=a[y+4>>2]|0,O=m+4|0,a[O>>2]=I,U=m+8|0,a[U>>2]=0,x=(I|0)<(E|0),y=x?E:I,x=x?I:E;do if((x|0)<0){if((y|0)>0){if((y|-2147483648|0)<(x|0)&((x|0)!=-2147483648&(2147483647-y|0)>=(x|0)))break;return y=1,y|0}if((x|0)==-2147483648|(-2147483648-y|0)>(x|0))return m=1,m|0;if((y|0)>-1){if((y|-2147483648|0)<(x|0))break;return y=1,y|0}else{if((y^-2147483648|0)<(x|0))y=1;else break;return y|0}}while(0);return y=I-E|0,(E|0)<0?(x=0-E|0,a[O>>2]=y,a[U>>2]=x,a[m>>2]=0,E=0):(y=I,x=0),(y|0)<0&&(E=E-y|0,a[m>>2]=E,x=x-y|0,a[U>>2]=x,a[O>>2]=0,y=0),R=E-x|0,I=y-x|0,(x|0)<0?(a[m>>2]=R,a[O>>2]=I,a[U>>2]=0,y=I,I=R,x=0):I=E,E=(y|0)<(I|0)?y:I,E=(x|0)<(E|0)?x:E,(E|0)<=0?(m=0,m|0):(a[m>>2]=I-E,a[O>>2]=y-E,a[U>>2]=x-E,m=0,m|0)}function Xo(y){y=y|0;var m=0,x=0,E=0,I=0;m=y+8|0,I=a[m>>2]|0,x=I-(a[y>>2]|0)|0,a[y>>2]=x,E=y+4|0,y=(a[E>>2]|0)-I|0,a[E>>2]=y,a[m>>2]=0-(y+x)}function Xa(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;x=a[y>>2]|0,m=0-x|0,a[y>>2]=m,O=y+8|0,a[O>>2]=0,U=y+4|0,E=a[U>>2]|0,I=E+x|0,(x|0)>0?(a[U>>2]=I,a[O>>2]=x,a[y>>2]=0,m=0,E=I):x=0,(E|0)<0?(R=m-E|0,a[y>>2]=R,x=x-E|0,a[O>>2]=x,a[U>>2]=0,I=R-x|0,m=0-x|0,(x|0)<0?(a[y>>2]=I,a[U>>2]=m,a[O>>2]=0,E=m,x=0):(E=0,I=R)):I=m,m=(E|0)<(I|0)?E:I,m=(x|0)<(m|0)?x:m,!((m|0)<=0)&&(a[y>>2]=I-m,a[U>>2]=E-m,a[O>>2]=x-m)}function fu(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0;if(de=we,we=we+64|0,le=de,U=de+56|0,!(!0&(m&2013265920|0)==134217728&(!0&(E&2013265920|0)==134217728)))return I=5,we=de,I|0;if((y|0)==(x|0)&(m|0)==(E|0))return a[I>>2]=0,I=0,we=de,I|0;if(O=ne(y|0,m|0,52)|0,Ce()|0,O=O&15,ee=ne(x|0,E|0,52)|0,Ce()|0,(O|0)!=(ee&15|0))return I=12,we=de,I|0;if(R=O+-1|0,O>>>0>1){Ol(y,m,R,le)|0,Ol(x,E,R,U)|0,ee=le,q=a[ee>>2]|0,ee=a[ee+4>>2]|0;e:do if((q|0)==(a[U>>2]|0)&&(ee|0)==(a[U+4>>2]|0)){O=(O^15)*3|0,R=ne(y|0,m|0,O|0)|0,Ce()|0,R=R&7,O=ne(x|0,E|0,O|0)|0,Ce()|0,O=O&7;do if((R|0)==0|(O|0)==0)a[I>>2]=1,R=0;else if((R|0)==7)R=5;else{if((R|0)==1|(O|0)==1&&vr(q,ee)|0){R=5;break}if((a[15536+(R<<2)>>2]|0)!=(O|0)&&(a[15568+(R<<2)>>2]|0)!=(O|0))break e;a[I>>2]=1,R=0}while(0);return I=R,we=de,I|0}while(0)}R=le,O=R+56|0;do a[R>>2]=0,R=R+4|0;while((R|0)<(O|0));return ma(y,m,1,le)|0,m=le,!((a[m>>2]|0)==(x|0)&&(a[m+4>>2]|0)==(E|0))&&(m=le+8|0,!((a[m>>2]|0)==(x|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+16|0,!((a[m>>2]|0)==(x|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+24|0,!((a[m>>2]|0)==(x|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+32|0,!((a[m>>2]|0)==(x|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+40|0,!((a[m>>2]|0)==(x|0)&&(a[m+4>>2]|0)==(E|0)))?(R=le+48|0,R=((a[R>>2]|0)==(x|0)?(a[R+4>>2]|0)==(E|0):0)&1):R=1,a[I>>2]=R,I=0,we=de,I|0}function du(y,m,x,E,I){return y=y|0,m=m|0,x=x|0,E=E|0,I=I|0,x=lt(y,m,x,E)|0,(x|0)==7?(I=11,I|0):(E=ue(x|0,0,56)|0,m=m&-2130706433|(Ce()|0)|268435456,a[I>>2]=y|E,a[I+4>>2]=m,I=0,I|0)}function Eo(y,m,x){return y=y|0,m=m|0,x=x|0,!0&(m&2013265920|0)==268435456?(a[x>>2]=y,a[x+4>>2]=m&-2130706433|134217728,x=0,x|0):(x=6,x|0)}function _a(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;return I=we,we=we+16|0,E=I,a[E>>2]=0,!0&(m&2013265920|0)==268435456?(R=ne(y|0,m|0,56)|0,Ce()|0,E=Ue(y,m&-2130706433|134217728,R&7,E,x)|0,we=I,E|0):(E=6,we=I,E|0)}function pu(y,m){y=y|0,m=m|0;var x=0;switch(x=ne(y|0,m|0,56)|0,Ce()|0,x&7){case 0:case 7:return x=0,x|0}return x=m&-2130706433|134217728,!(!0&(m&2013265920|0)==268435456)||!0&(m&117440512|0)==16777216&(vr(y,x)|0)!=0?(x=0,x|0):(x=xa(y,x)|0,x|0)}function va(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0;return I=we,we=we+16|0,E=I,!0&(m&2013265920|0)==268435456?(R=m&-2130706433|134217728,O=x,a[O>>2]=y,a[O+4>>2]=R,a[E>>2]=0,m=ne(y|0,m|0,56)|0,Ce()|0,E=Ue(y,R,m&7,E,x+8|0)|0,we=I,E|0):(E=6,we=I,E|0)}function gr(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0;return I=(vr(y,m)|0)==0,m=m&-2130706433,E=x,a[E>>2]=I?y:0,a[E+4>>2]=I?m|285212672:0,E=x+8|0,a[E>>2]=y,a[E+4>>2]=m|301989888,E=x+16|0,a[E>>2]=y,a[E+4>>2]=m|318767104,E=x+24|0,a[E>>2]=y,a[E+4>>2]=m|335544320,E=x+32|0,a[E>>2]=y,a[E+4>>2]=m|352321536,x=x+40|0,a[x>>2]=y,a[x+4>>2]=m|369098752,0}function js(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0;return O=we,we=we+16|0,I=O,R=m&-2130706433|134217728,!0&(m&2013265920|0)==268435456?(E=ne(y|0,m|0,56)|0,Ce()|0,E=Xt(y,R,E&7)|0,(E|0)==-1?(a[x>>2]=0,R=6,we=O,R|0):(Ki(y,R,I)|0&&cn(23313,22484,282,22499),m=ne(y|0,m|0,52)|0,Ce()|0,m=m&15,vr(y,R)|0?Ko(I,m,E,2,x):gu(I,m,E,2,x),R=0,we=O,R|0)):(R=6,we=O,R|0)}function Hn(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0;E=we,we=we+16|0,I=E,Zn(y,m,x,I),Qo(I,x+4|0),we=E}function Zn(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0;if(U=we,we=we+16|0,q=U,Tr(y,x,q),R=+Rt(+(1-+G[q>>3]*.5)),R<1e-16){a[E>>2]=0,a[E+4>>2]=0,a[E+8>>2]=0,a[E+12>>2]=0,we=U;return}if(q=a[x>>2]|0,I=+G[15920+(q*24|0)>>3],I=+oi(I-+oi(+Mc(15600+(q<<4)|0,y))),Ti(m)|0?O=+oi(I+-.3334731722518321):O=I,I=+Dt(+R)/.381966011250105,(m|0)>0){y=0;do I=I*2.6457513110645907,y=y+1|0;while((y|0)!=(m|0))}R=+Qe(+O)*I,G[E>>3]=R,O=+dt(+O)*I,G[E+8>>3]=O,we=U}function Tr(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;if(R=we,we=we+32|0,I=R,Wl(y,I),a[m>>2]=0,G[x>>3]=5,E=+xr(16400,I),E<+G[x>>3]&&(a[m>>2]=0,G[x>>3]=E),E=+xr(16424,I),E<+G[x>>3]&&(a[m>>2]=1,G[x>>3]=E),E=+xr(16448,I),E<+G[x>>3]&&(a[m>>2]=2,G[x>>3]=E),E=+xr(16472,I),E<+G[x>>3]&&(a[m>>2]=3,G[x>>3]=E),E=+xr(16496,I),E<+G[x>>3]&&(a[m>>2]=4,G[x>>3]=E),E=+xr(16520,I),E<+G[x>>3]&&(a[m>>2]=5,G[x>>3]=E),E=+xr(16544,I),E<+G[x>>3]&&(a[m>>2]=6,G[x>>3]=E),E=+xr(16568,I),E<+G[x>>3]&&(a[m>>2]=7,G[x>>3]=E),E=+xr(16592,I),E<+G[x>>3]&&(a[m>>2]=8,G[x>>3]=E),E=+xr(16616,I),E<+G[x>>3]&&(a[m>>2]=9,G[x>>3]=E),E=+xr(16640,I),E<+G[x>>3]&&(a[m>>2]=10,G[x>>3]=E),E=+xr(16664,I),E<+G[x>>3]&&(a[m>>2]=11,G[x>>3]=E),E=+xr(16688,I),E<+G[x>>3]&&(a[m>>2]=12,G[x>>3]=E),E=+xr(16712,I),E<+G[x>>3]&&(a[m>>2]=13,G[x>>3]=E),E=+xr(16736,I),E<+G[x>>3]&&(a[m>>2]=14,G[x>>3]=E),E=+xr(16760,I),E<+G[x>>3]&&(a[m>>2]=15,G[x>>3]=E),E=+xr(16784,I),E<+G[x>>3]&&(a[m>>2]=16,G[x>>3]=E),E=+xr(16808,I),E<+G[x>>3]&&(a[m>>2]=17,G[x>>3]=E),E=+xr(16832,I),E<+G[x>>3]&&(a[m>>2]=18,G[x>>3]=E),E=+xr(16856,I),!(E<+G[x>>3])){we=R;return}a[m>>2]=19,G[x>>3]=E,we=R}function _r(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0;if(R=+Ic(y),R<1e-16){m=15600+(m<<4)|0,a[I>>2]=a[m>>2],a[I+4>>2]=a[m+4>>2],a[I+8>>2]=a[m+8>>2],a[I+12>>2]=a[m+12>>2];return}if(O=+pn(+ +G[y+8>>3],+ +G[y>>3]),(x|0)>0){y=0;do R=R/2.6457513110645907,y=y+1|0;while((y|0)!=(x|0))}E?(R=R/3,x=(Ti(x)|0)==0,R=+jt(+((x?R:R/2.6457513110645907)*.381966011250105))):(R=+jt(+(R*.381966011250105)),Ti(x)|0&&(O=+oi(O+.3334731722518321))),So(15600+(m<<4)|0,+oi(+G[15920+(m*24|0)>>3]-O),R,I)}function Bl(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0;E=we,we=we+16|0,I=E,Ms(y+4|0,I),_r(I,a[y>>2]|0,m,0,x),we=E}function Ko(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0,ot=0,et=0,Gt=0,zt=0,gt=0,vt=0,kn=0,wn=0,mn=0,_n=0,En=0,Rn=0,lr=0,In=0;if(Rn=we,we=we+272|0,R=Rn+256|0,st=Rn+240|0,mn=Rn,_n=Rn+224|0,En=Rn+208|0,ot=Rn+176|0,et=Rn+160|0,Gt=Rn+192|0,zt=Rn+144|0,gt=Rn+128|0,vt=Rn+112|0,kn=Rn+96|0,wn=Rn+80|0,a[R>>2]=m,a[st>>2]=a[y>>2],a[st+4>>2]=a[y+4>>2],a[st+8>>2]=a[y+8>>2],a[st+12>>2]=a[y+12>>2],bc(st,R,mn),a[I>>2]=0,st=E+x+((E|0)==5&1)|0,(st|0)<=(x|0)){we=Rn;return}q=a[R>>2]|0,ee=_n+4|0,le=ot+4|0,de=x+5|0,Be=16880+(q<<2)|0,He=16960+(q<<2)|0,ze=gt+8|0,Je=vt+8|0,ft=kn+8|0,ct=En+4|0,U=x;e:for(;;){O=mn+(((U|0)%5|0)<<4)|0,a[En>>2]=a[O>>2],a[En+4>>2]=a[O+4>>2],a[En+8>>2]=a[O+8>>2],a[En+12>>2]=a[O+12>>2];do;while((Ka(En,q,0,1)|0)==2);if((U|0)>(x|0)&(Ti(m)|0)!=0){if(a[ot>>2]=a[En>>2],a[ot+4>>2]=a[En+4>>2],a[ot+8>>2]=a[En+8>>2],a[ot+12>>2]=a[En+12>>2],Ms(ee,et),E=a[ot>>2]|0,R=a[17040+(E*80|0)+(a[_n>>2]<<2)>>2]|0,a[ot>>2]=a[18640+(E*80|0)+(R*20|0)>>2],O=a[18640+(E*80|0)+(R*20|0)+16>>2]|0,(O|0)>0){y=0;do uu(le),y=y+1|0;while((y|0)<(O|0))}switch(O=18640+(E*80|0)+(R*20|0)+4|0,a[Gt>>2]=a[O>>2],a[Gt+4>>2]=a[O+4>>2],a[Gt+8>>2]=a[O+8>>2],Ll(Gt,(a[Be>>2]|0)*3|0),ii(le,Gt,le),On(le),Ms(le,zt),lr=+(a[He>>2]|0),G[gt>>3]=lr*3,G[ze>>3]=0,In=lr*-1.5,G[vt>>3]=In,G[Je>>3]=lr*2.598076211353316,G[kn>>3]=In,G[ft>>3]=lr*-2.598076211353316,a[17040+((a[ot>>2]|0)*80|0)+(a[En>>2]<<2)>>2]|0){case 1:{y=vt,E=gt;break}case 3:{y=kn,E=vt;break}case 2:{y=gt,E=kn;break}default:{y=12;break e}}Cu(et,zt,E,y,wn),_r(wn,a[ot>>2]|0,q,1,I+8+(a[I>>2]<<4)|0),a[I>>2]=(a[I>>2]|0)+1}if((U|0)<(de|0)&&(Ms(ct,ot),_r(ot,a[En>>2]|0,q,1,I+8+(a[I>>2]<<4)|0),a[I>>2]=(a[I>>2]|0)+1),a[_n>>2]=a[En>>2],a[_n+4>>2]=a[En+4>>2],a[_n+8>>2]=a[En+8>>2],a[_n+12>>2]=a[En+12>>2],U=U+1|0,(U|0)>=(st|0)){y=3;break}}if((y|0)==3){we=Rn;return}else(y|0)==12&&cn(22522,22569,571,22579)}function bc(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0;q=we,we=we+128|0,E=q+64|0,I=q,R=E,O=20240,U=R+60|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(U|0));R=I,O=20304,U=R+60|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(U|0));U=(Ti(a[m>>2]|0)|0)==0,E=U?E:I,I=y+4|0,wc(I),cu(I),Ti(a[m>>2]|0)|0&&(Wi(I),a[m>>2]=(a[m>>2]|0)+1),a[x>>2]=a[y>>2],m=x+4|0,ii(I,E,m),On(m),a[x+16>>2]=a[y>>2],m=x+20|0,ii(I,E+12|0,m),On(m),a[x+32>>2]=a[y>>2],m=x+36|0,ii(I,E+24|0,m),On(m),a[x+48>>2]=a[y>>2],m=x+52|0,ii(I,E+36|0,m),On(m),a[x+64>>2]=a[y>>2],x=x+68|0,ii(I,E+48|0,x),On(x),we=q}function Ka(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0;if(ze=we,we=we+32|0,Be=ze+12|0,U=ze,He=y+4|0,de=a[16960+(m<<2)>>2]|0,le=(E|0)!=0,de=le?de*3|0:de,I=a[He>>2]|0,ee=y+8|0,O=a[ee>>2]|0,le){if(R=y+12|0,E=a[R>>2]|0,I=O+I+E|0,(I|0)==(de|0))return He=1,we=ze,He|0;q=R}else q=y+12|0,E=a[q>>2]|0,I=O+I+E|0;if((I|0)<=(de|0))return He=0,we=ze,He|0;do if((E|0)>0){if(E=a[y>>2]|0,(O|0)>0){R=18640+(E*80|0)+60|0,E=y;break}E=18640+(E*80|0)+40|0,x?(Zr(Be,de,0,0),xo(He,Be,U),Dl(U),ii(U,Be,He),R=E,E=y):(R=E,E=y)}else R=18640+((a[y>>2]|0)*80|0)+20|0,E=y;while(0);if(a[E>>2]=a[R>>2],I=R+16|0,(a[I>>2]|0)>0){E=0;do uu(He),E=E+1|0;while((E|0)<(a[I>>2]|0))}return y=R+4|0,a[Be>>2]=a[y>>2],a[Be+4>>2]=a[y+4>>2],a[Be+8>>2]=a[y+8>>2],m=a[16880+(m<<2)>>2]|0,Ll(Be,le?m*3|0:m),ii(He,Be,He),On(He),le?E=((a[ee>>2]|0)+(a[He>>2]|0)+(a[q>>2]|0)|0)==(de|0)?1:2:E=2,He=E,we=ze,He|0}function Ec(y,m){y=y|0,m=m|0;var x=0;do x=Ka(y,m,0,1)|0;while((x|0)==2);return x|0}function gu(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0,ot=0,et=0,Gt=0,zt=0,gt=0,vt=0,kn=0,wn=0,mn=0;if(kn=we,we=we+240|0,R=kn+224|0,Gt=kn+208|0,zt=kn,gt=kn+192|0,vt=kn+176|0,ft=kn+160|0,ct=kn+144|0,st=kn+128|0,ot=kn+112|0,et=kn+96|0,a[R>>2]=m,a[Gt>>2]=a[y>>2],a[Gt+4>>2]=a[y+4>>2],a[Gt+8>>2]=a[y+8>>2],a[Gt+12>>2]=a[y+12>>2],Hs(Gt,R,zt),a[I>>2]=0,Je=E+x+((E|0)==6&1)|0,(Je|0)<=(x|0)){we=kn;return}q=a[R>>2]|0,ee=x+6|0,le=16960+(q<<2)|0,de=ct+8|0,Be=st+8|0,He=ot+8|0,ze=gt+4|0,O=0,U=x,E=-1;e:for(;;){if(R=(U|0)%6|0,y=zt+(R<<4)|0,a[gt>>2]=a[y>>2],a[gt+4>>2]=a[y+4>>2],a[gt+8>>2]=a[y+8>>2],a[gt+12>>2]=a[y+12>>2],y=O,O=Ka(gt,q,0,1)|0,(U|0)>(x|0)&(Ti(m)|0)!=0&&(y|0)!=1&&(a[gt>>2]|0)!=(E|0)){switch(Ms(zt+(((R+5|0)%6|0)<<4)+4|0,vt),Ms(zt+(R<<4)+4|0,ft),wn=+(a[le>>2]|0),G[ct>>3]=wn*3,G[de>>3]=0,mn=wn*-1.5,G[st>>3]=mn,G[Be>>3]=wn*2.598076211353316,G[ot>>3]=mn,G[He>>3]=wn*-2.598076211353316,R=a[Gt>>2]|0,a[17040+(R*80|0)+(((E|0)==(R|0)?a[gt>>2]|0:E)<<2)>>2]|0){case 1:{y=st,E=ct;break}case 3:{y=ot,E=st;break}case 2:{y=ct,E=ot;break}default:{y=8;break e}}Cu(vt,ft,E,y,et),!(Lc(vt,et)|0)&&!(Lc(ft,et)|0)&&(_r(et,a[Gt>>2]|0,q,1,I+8+(a[I>>2]<<4)|0),a[I>>2]=(a[I>>2]|0)+1)}if((U|0)<(ee|0)&&(Ms(ze,vt),_r(vt,a[gt>>2]|0,q,1,I+8+(a[I>>2]<<4)|0),a[I>>2]=(a[I>>2]|0)+1),U=U+1|0,(U|0)>=(Je|0)){y=3;break}else E=a[gt>>2]|0}if((y|0)==3){we=kn;return}else(y|0)==8&&cn(22606,22569,736,22651)}function Hs(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0;q=we,we=we+160|0,E=q+80|0,I=q,R=E,O=20368,U=R+72|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(U|0));R=I,O=20448,U=R+72|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(U|0));U=(Ti(a[m>>2]|0)|0)==0,E=U?E:I,I=y+4|0,wc(I),cu(I),Ti(a[m>>2]|0)|0&&(Wi(I),a[m>>2]=(a[m>>2]|0)+1),a[x>>2]=a[y>>2],m=x+4|0,ii(I,E,m),On(m),a[x+16>>2]=a[y>>2],m=x+20|0,ii(I,E+12|0,m),On(m),a[x+32>>2]=a[y>>2],m=x+36|0,ii(I,E+24|0,m),On(m),a[x+48>>2]=a[y>>2],m=x+52|0,ii(I,E+36|0,m),On(m),a[x+64>>2]=a[y>>2],m=x+68|0,ii(I,E+48|0,m),On(m),a[x+80>>2]=a[y>>2],x=x+84|0,ii(I,E+60|0,x),On(x),we=q}function zl(y,m){return y=y|0,m=m|0,m=ne(y|0,m|0,52)|0,Ce()|0,m&15|0}function Ja(y,m){return y=y|0,m=m|0,m=ne(y|0,m|0,45)|0,Ce()|0,m&127|0}function xa(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0;if(!(!0&(m&-16777216|0)==134217728)||(O=ne(y|0,m|0,45)|0,Ce()|0,O=O&127,O>>>0>121))return m=0,m|0;x=ne(y|0,m|0,52)|0,Ce()|0,x=x&15;do if(x|0){for(I=1,E=0;;){if(R=ne(y|0,m|0,(15-I|0)*3|0)|0,Ce()|0,R=R&7,(R|0)!=0&(E^1))if((R|0)==1&(jn(O)|0)!=0){U=0,E=13;break}else E=1;if((R|0)==7){U=0,E=13;break}if(I>>>0<x>>>0)I=I+1|0;else{E=9;break}}if((E|0)==9){if((x|0)==15)U=1;else break;return U|0}else if((E|0)==13)return U|0}while(0);for(;;){if(U=ne(y|0,m|0,(14-x|0)*3|0)|0,Ce()|0,!((U&7|0)==7&!0)){U=0,E=13;break}if(x>>>0<14)x=x+1|0;else{U=1,E=13;break}}return(E|0)==13?U|0:0}function Ol(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0;if(R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,x>>>0>15)return E=4,E|0;if((R|0)<(x|0))return E=12,E|0;if((R|0)==(x|0))return a[E>>2]=y,a[E+4>>2]=m,E=0,E|0;if(I=ue(x|0,0,52)|0,I=I|y,y=Ce()|0|m&-15728641,(R|0)>(x|0))do m=ue(7,0,(14-x|0)*3|0)|0,x=x+1|0,I=m|I,y=Ce()|0|y;while((x|0)<(R|0));return a[E>>2]=I,a[E+4>>2]=y,E=0,E|0}function Fl(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0;if(R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,!((x|0)<16&(R|0)<=(x|0)))return E=4,E|0;I=x-R|0,x=ne(y|0,m|0,45)|0,Ce()|0;e:do if(!(jn(x&127)|0))x=Zs(7,0,I,((I|0)<0)<<31>>31)|0,I=Ce()|0;else{t:do if(R|0){for(x=1;O=ue(7,0,(15-x|0)*3|0)|0,!!((O&y|0)==0&((Ce()|0)&m|0)==0);)if(x>>>0<R>>>0)x=x+1|0;else break t;x=Zs(7,0,I,((I|0)<0)<<31>>31)|0,I=Ce()|0;break e}while(0);x=Zs(7,0,I,((I|0)<0)<<31>>31)|0,x=V(x|0,Ce()|0,5,0)|0,x=d(x|0,Ce()|0,-5,-1)|0,x=P(x|0,Ce()|0,6,0)|0,x=d(x|0,Ce()|0,1,0)|0,I=Ce()|0}while(0);return O=E,a[O>>2]=x,a[O+4>>2]=I,O=0,O|0}function vr(y,m){y=y|0,m=m|0;var x=0,E=0,I=0;if(I=ne(y|0,m|0,45)|0,Ce()|0,!(jn(I&127)|0))return I=0,I|0;I=ne(y|0,m|0,52)|0,Ce()|0,I=I&15;e:do if(!I)x=0;else for(E=1;;){if(x=ne(y|0,m|0,(15-E|0)*3|0)|0,Ce()|0,x=x&7,x|0)break e;if(E>>>0<I>>>0)E=E+1|0;else{x=0;break}}while(0);return I=(x|0)==0&1,I|0}function DA(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0;if(O=we,we=we+16|0,R=O,ba(R,y,m,x),m=R,y=a[m>>2]|0,m=a[m+4>>2]|0,(y|0)==0&(m|0)==0)return we=O,0;I=0,x=0;do U=E+(I<<3)|0,a[U>>2]=y,a[U+4>>2]=m,I=d(I|0,x|0,1,0)|0,x=Ce()|0,nl(R),U=R,y=a[U>>2]|0,m=a[U+4>>2]|0;while(!((y|0)==0&(m|0)==0));return we=O,0}function hs(y,m,x,E){return y=y|0,m=m|0,x=x|0,E=E|0,(E|0)<(x|0)?(x=m,E=y,Mt(x|0),E|0):(x=ue(-1,-1,((E-x|0)*3|0)+3|0)|0,E=ue(~x|0,~(Ce()|0)|0,(15-E|0)*3|0)|0,x=~(Ce()|0)&m,E=~E&y,Mt(x|0),E|0)}function mu(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0;return I=ne(y|0,m|0,52)|0,Ce()|0,I=I&15,(x|0)<16&(I|0)<=(x|0)?((I|0)<(x|0)&&(I=ue(-1,-1,((x+-1-I|0)*3|0)+3|0)|0,I=ue(~I|0,~(Ce()|0)|0,(15-x|0)*3|0)|0,m=~(Ce()|0)&m,y=~I&y),I=ue(x|0,0,52)|0,x=m&-15728641|(Ce()|0),a[E>>2]=y|I,a[E+4>>2]=x,E=0,E|0):(E=4,E|0)}function Nl(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0,ot=0,et=0,Gt=0,zt=0,gt=0,vt=0;if((x|0)==0&(E|0)==0)return gt=0,gt|0;if(I=y,R=a[I>>2]|0,I=a[I+4>>2]|0,!0&(I&15728640|0)==0){if(!((E|0)>0|(E|0)==0&x>>>0>0)||(gt=m,a[gt>>2]=R,a[gt+4>>2]=I,(x|0)==1&(E|0)==0))return gt=0,gt|0;I=1;do Gt=y+(I<<3)|0,zt=a[Gt+4>>2]|0,gt=m+(I<<3)|0,a[gt>>2]=a[Gt>>2],a[gt+4>>2]=zt,I=I+1|0;while(0<(E|0)|(E|0)==0&I>>>0<x>>>0);return I=0,I|0}if(et=x<<3,zt=v(et)|0,!zt)return gt=13,gt|0;if(je(zt|0,y|0,et|0)|0,Gt=h(x,8)|0,!Gt)return A(zt),gt=13,gt|0;e:do if(x|0){t:for(;;){I=zt,ct=a[I>>2]|0,I=a[I+4>>2]|0,st=ne(ct|0,I|0,52)|0,Ce()|0,st=st&15,ot=st+-1|0,ft=(x|0)>0;n:do if((st|0)!=0&ft){if(He=((x|0)<0)<<31>>31,ze=ue(ot|0,0,52)|0,Je=Ce()|0,ot>>>0>15){if(!((ct|0)==0&(I|0)==0)){gt=17;break t}for(R=0;;){if(R=R+1|0,(R|0)>=(x|0))break n;if(E=zt+(R<<3)|0,Je=a[E>>2]|0,E=a[E+4>>2]|0,!((Je|0)==0&(E|0)==0)){I=E,gt=17;break t}}}for(R=0,y=ct,E=I;;){if(!((y|0)==0&(E|0)==0)){if(!(!0&(E&117440512|0)==0)){gt=22;break t}if(U=ne(y|0,E|0,52)|0,Ce()|0,U=U&15,(U|0)<(ot|0)){I=12,gt=28;break t}if((U|0)!=(ot|0)&&(y=y|ze,E=E&-15728641|Je,U>>>0>=st>>>0)){O=ot;do Be=ue(7,0,(14-O|0)*3|0)|0,O=O+1|0,y=Be|y,E=Ce()|0|E;while(O>>>0<U>>>0)}if(O=X(y|0,E|0,x|0,He|0)|0,Ce()|0,ee=Gt+(O<<3)|0,U=ee,q=a[U>>2]|0,U=a[U+4>>2]|0,(q|0)==0&(U|0)==0)O=ee;else for(Be=0;;){if((Be|0)>(x|0)){gt=32;break t}if((q|0)==(y|0)&(U&-117440513|0)==(E|0)){le=ne(q|0,U|0,56)|0,Ce()|0,le=le&7,de=le+1|0,vt=ne(q|0,U|0,45)|0,Ce()|0;r:do if(!(jn(vt&127)|0))U=7;else{if(q=ne(q|0,U|0,52)|0,Ce()|0,q=q&15,!q){U=6;break}for(U=1;;){if(vt=ue(7,0,(15-U|0)*3|0)|0,!((vt&y|0)==0&((Ce()|0)&E|0)==0)){U=7;break r}if(U>>>0<q>>>0)U=U+1|0;else{U=6;break}}}while(0);if((le+2|0)>>>0>U>>>0){gt=42;break t}vt=ue(de|0,0,56)|0,E=Ce()|0|E&-117440513,de=ee,a[de>>2]=0,a[de+4>>2]=0,y=vt|y}else O=(O+1|0)%(x|0)|0;if(ee=Gt+(O<<3)|0,U=ee,q=a[U>>2]|0,U=a[U+4>>2]|0,(q|0)==0&(U|0)==0){O=ee;break}else Be=Be+1|0}vt=O,a[vt>>2]=y,a[vt+4>>2]=E}if(R=R+1|0,(R|0)>=(x|0))break n;E=zt+(R<<3)|0,y=a[E>>2]|0,E=a[E+4>>2]|0}}while(0);if((x+5|0)>>>0<11){gt=85;break}if(Je=h((x|0)/6|0,8)|0,!Je){gt=49;break}n:do if(ft){Be=0,de=0;do{if(U=Gt+(Be<<3)|0,E=U,R=a[E>>2]|0,E=a[E+4>>2]|0,!((R|0)==0&(E|0)==0)){q=ne(R|0,E|0,56)|0,Ce()|0,q=q&7,y=q+1|0,ee=E&-117440513,vt=ne(R|0,E|0,45)|0,Ce()|0;r:do if(jn(vt&127)|0){if(le=ne(R|0,E|0,52)|0,Ce()|0,le=le&15,le|0)for(O=1;;){if(vt=ue(7,0,(15-O|0)*3|0)|0,!((R&vt|0)==0&(ee&(Ce()|0)|0)==0))break r;if(O>>>0<le>>>0)O=O+1|0;else break}E=ue(y|0,0,56)|0,R=E|R,E=Ce()|0|ee,y=U,a[y>>2]=R,a[y+4>>2]=E,y=q+2|0}while(0);(y|0)==7&&(vt=Je+(de<<3)|0,a[vt>>2]=R,a[vt+4>>2]=E&-117440513,de=de+1|0)}Be=Be+1|0}while((Be|0)!=(x|0));if(ft){if(Be=((x|0)<0)<<31>>31,He=ue(ot|0,0,52)|0,ze=Ce()|0,ot>>>0>15){if(!((ct|0)==0&(I|0)==0)){I=4,gt=84;break t}for(I=0;;){if(I=I+1|0,(I|0)>=(x|0)){R=0,I=de;break n}if(vt=zt+(I<<3)|0,!((a[vt>>2]|0)==0&(a[vt+4>>2]|0)==0)){I=4,gt=84;break t}}}for(le=0,R=0,ee=ct;;){do if(!((ee|0)==0&(I|0)==0)){if(U=ne(ee|0,I|0,52)|0,Ce()|0,U=U&15,(U|0)<(ot|0)){I=12,gt=84;break t}do if((U|0)==(ot|0))E=ee,U=I;else{if(E=ee|He,y=I&-15728641|ze,U>>>0<st>>>0){U=y;break}O=ot;do vt=ue(7,0,(14-O|0)*3|0)|0,O=O+1|0,E=vt|E,y=Ce()|0|y;while(O>>>0<U>>>0);U=y}while(0);for(O=X(E|0,U|0,x|0,Be|0)|0,Ce()|0,y=0;;){if((y|0)>(x|0)){gt=77;break t}if(vt=Gt+(O<<3)|0,q=a[vt+4>>2]|0,(q&-117440513|0)==(U|0)&&(a[vt>>2]|0)==(E|0)){gt=79;break}if(O=(O+1|0)%(x|0)|0,vt=Gt+(O<<3)|0,(a[vt>>2]|0)==(E|0)&&(a[vt+4>>2]|0)==(U|0))break;y=y+1|0}if((gt|0)==79&&(gt=0,!0&(q&117440512|0)==100663296))break;vt=m+(R<<3)|0,a[vt>>2]=ee,a[vt+4>>2]=I,R=R+1|0}while(0);if(I=le+1|0,(I|0)>=(x|0)){I=de;break n}vt=zt+(I<<3)|0,le=I,ee=a[vt>>2]|0,I=a[vt+4>>2]|0}}else R=0,I=de}else R=0,I=0;while(0);if(Se(Gt|0,0,et|0)|0,je(zt|0,Je|0,I<<3|0)|0,A(Je),I)m=m+(R<<3)|0,x=I;else break e}if((gt|0)==17)!0&(I&117440512|0)==0?(I=4,gt=28):gt=22;else if((gt|0)==32)cn(23313,22674,362,22684);else{if((gt|0)==42)return A(zt),A(Gt),vt=10,vt|0;if((gt|0)==49)return A(zt),A(Gt),vt=13,vt|0;if((gt|0)==77)cn(23313,22674,462,22684);else{if((gt|0)==84)return A(Je),A(zt),A(Gt),vt=I,vt|0;if((gt|0)==85){je(m|0,zt|0,x<<3|0)|0;break}}}if((gt|0)==22)return A(zt),A(Gt),vt=5,vt|0;if((gt|0)==28)return A(zt),A(Gt),vt=I,vt|0}while(0);return A(zt),A(Gt),vt=0,vt|0}function Tc(y,m,x,E,I,R,O){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0,R=R|0,O=O|0;var U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0;if(Je=we,we=we+16|0,ze=Je,!((x|0)>0|(x|0)==0&m>>>0>0))return ze=0,we=Je,ze|0;if((O|0)>=16)return ze=12,we=Je,ze|0;Be=0,He=0,de=0,U=0;e:for(;;){if(ee=y+(Be<<3)|0,q=a[ee>>2]|0,ee=a[ee+4>>2]|0,le=ne(q|0,ee|0,52)|0,Ce()|0,(le&15|0)>(O|0)){U=12,q=11;break}if(ba(ze,q,ee,O),le=ze,ee=a[le>>2]|0,le=a[le+4>>2]|0,(ee|0)==0&(le|0)==0)q=de;else{q=de;do{if(!((U|0)<(R|0)|(U|0)==(R|0)&q>>>0<I>>>0)){q=10;break e}de=E+(q<<3)|0,a[de>>2]=ee,a[de+4>>2]=le,q=d(q|0,U|0,1,0)|0,U=Ce()|0,nl(ze),de=ze,ee=a[de>>2]|0,le=a[de+4>>2]|0}while(!((ee|0)==0&(le|0)==0))}if(Be=d(Be|0,He|0,1,0)|0,He=Ce()|0,(He|0)<(x|0)|(He|0)==(x|0)&Be>>>0<m>>>0)de=q;else{U=0,q=11;break}}return(q|0)==10?(ze=14,we=Je,ze|0):(q|0)==11?(we=Je,U|0):0}function Yr(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0;Be=we,we=we+16|0,de=Be;e:do if((x|0)>0|(x|0)==0&m>>>0>0){for(ee=0,O=0,R=0,le=0;;){if(q=y+(ee<<3)|0,U=a[q>>2]|0,q=a[q+4>>2]|0,!((U|0)==0&(q|0)==0)&&(q=(Fl(U,q,E,de)|0)==0,U=de,O=d(a[U>>2]|0,a[U+4>>2]|0,O|0,R|0)|0,R=Ce()|0,!q)){R=12;break}if(ee=d(ee|0,le|0,1,0)|0,le=Ce()|0,!((le|0)<(x|0)|(le|0)==(x|0)&ee>>>0<m>>>0))break e}return we=Be,R|0}else O=0,R=0;while(0);return a[I>>2]=O,a[I+4>>2]=R,I=0,we=Be,I|0}function zr(y,m){return y=y|0,m=m|0,m=ne(y|0,m|0,52)|0,Ce()|0,m&1|0}function si(y,m){y=y|0,m=m|0;var x=0,E=0,I=0;if(I=ne(y|0,m|0,52)|0,Ce()|0,I=I&15,!I)return I=0,I|0;for(E=1;;){if(x=ne(y|0,m|0,(15-E|0)*3|0)|0,Ce()|0,x=x&7,x|0){E=5;break}if(E>>>0<I>>>0)E=E+1|0;else{x=0,E=5;break}}return(E|0)==5?x|0:0}function yu(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0;if(q=ne(y|0,m|0,52)|0,Ce()|0,q=q&15,!q)return U=m,q=y,Mt(U|0),q|0;for(U=1,x=0;;){R=(15-U|0)*3|0,E=ue(7,0,R|0)|0,I=Ce()|0,O=ne(y|0,m|0,R|0)|0,Ce()|0,R=ue(bo(O&7)|0,0,R|0)|0,O=Ce()|0,y=R|y&~E,m=O|m&~I;e:do if(!x)if((R&E|0)==0&(O&I|0)==0)x=0;else if(E=ne(y|0,m|0,52)|0,Ce()|0,E=E&15,!E)x=1;else{x=1;t:for(;;){switch(O=ne(y|0,m|0,(15-x|0)*3|0)|0,Ce()|0,O&7){case 1:break t;case 0:break;default:{x=1;break e}}if(x>>>0<E>>>0)x=x+1|0;else{x=1;break e}}for(x=1;;)if(O=(15-x|0)*3|0,I=ne(y|0,m|0,O|0)|0,Ce()|0,R=ue(7,0,O|0)|0,m=m&~(Ce()|0),O=ue(bo(I&7)|0,0,O|0)|0,y=y&~R|O,m=m|(Ce()|0),x>>>0<E>>>0)x=x+1|0;else{x=1;break}}while(0);if(U>>>0<q>>>0)U=U+1|0;else break}return Mt(m|0),y|0}function Ws(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0;if(E=ne(y|0,m|0,52)|0,Ce()|0,E=E&15,!E)return x=m,E=y,Mt(x|0),E|0;for(x=1;R=(15-x|0)*3|0,O=ne(y|0,m|0,R|0)|0,Ce()|0,I=ue(7,0,R|0)|0,m=m&~(Ce()|0),R=ue(bo(O&7)|0,0,R|0)|0,y=R|y&~I,m=Ce()|0|m,x>>>0<E>>>0;)x=x+1|0;return Mt(m|0),y|0}function Sc(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0;if(q=ne(y|0,m|0,52)|0,Ce()|0,q=q&15,!q)return U=m,q=y,Mt(U|0),q|0;for(U=1,x=0;;){R=(15-U|0)*3|0,E=ue(7,0,R|0)|0,I=Ce()|0,O=ne(y|0,m|0,R|0)|0,Ce()|0,R=ue(Yo(O&7)|0,0,R|0)|0,O=Ce()|0,y=R|y&~E,m=O|m&~I;e:do if(!x)if((R&E|0)==0&(O&I|0)==0)x=0;else if(E=ne(y|0,m|0,52)|0,Ce()|0,E=E&15,!E)x=1;else{x=1;t:for(;;){switch(O=ne(y|0,m|0,(15-x|0)*3|0)|0,Ce()|0,O&7){case 1:break t;case 0:break;default:{x=1;break e}}if(x>>>0<E>>>0)x=x+1|0;else{x=1;break e}}for(x=1;;)if(I=(15-x|0)*3|0,R=ue(7,0,I|0)|0,O=m&~(Ce()|0),m=ne(y|0,m|0,I|0)|0,Ce()|0,m=ue(Yo(m&7)|0,0,I|0)|0,y=y&~R|m,m=O|(Ce()|0),x>>>0<E>>>0)x=x+1|0;else{x=1;break}}while(0);if(U>>>0<q>>>0)U=U+1|0;else break}return Mt(m|0),y|0}function RA(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0;if(E=ne(y|0,m|0,52)|0,Ce()|0,E=E&15,!E)return x=m,E=y,Mt(x|0),E|0;for(x=1;O=(15-x|0)*3|0,R=ue(7,0,O|0)|0,I=m&~(Ce()|0),m=ne(y|0,m|0,O|0)|0,Ce()|0,m=ue(Yo(m&7)|0,0,O|0)|0,y=m|y&~R,m=Ce()|0|I,x>>>0<E>>>0;)x=x+1|0;return Mt(m|0),y|0}function di(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(q=we,we=we+64|0,U=q+40|0,E=q+24|0,I=q+12|0,R=q,ue(m|0,0,52)|0,x=Ce()|0|134225919,!m)return(a[y+4>>2]|0)>2||(a[y+8>>2]|0)>2||(a[y+12>>2]|0)>2?(O=0,U=0,Mt(O|0),we=q,U|0):(ue(SA(y)|0,0,45)|0,O=Ce()|0|x,U=-1,Mt(O|0),we=q,U|0);if(a[U>>2]=a[y>>2],a[U+4>>2]=a[y+4>>2],a[U+8>>2]=a[y+8>>2],a[U+12>>2]=a[y+12>>2],O=U+4|0,(m|0)>0)for(y=-1;a[E>>2]=a[O>>2],a[E+4>>2]=a[O+4>>2],a[E+8>>2]=a[O+8>>2],m&1?(IA(O),a[I>>2]=a[O>>2],a[I+4>>2]=a[O+4>>2],a[I+8>>2]=a[O+8>>2],Zo(I)):(Ya(O),a[I>>2]=a[O>>2],a[I+4>>2]=a[O+4>>2],a[I+8>>2]=a[O+8>>2],Wi(I)),xo(E,I,R),On(R),le=(15-m|0)*3|0,ee=ue(7,0,le|0)|0,x=x&~(Ce()|0),le=ue(qo(R)|0,0,le|0)|0,y=le|y&~ee,x=Ce()|0|x,(m|0)>1;)m=m+-1|0;else y=-1;e:do if((a[O>>2]|0)<=2&&(a[U+8>>2]|0)<=2&&(a[U+12>>2]|0)<=2){if(E=SA(U)|0,m=ue(E|0,0,45)|0,m=m|y,y=Ce()|0|x&-1040385,R=CA(U)|0,!(jn(E)|0)){if((R|0)<=0)break;for(I=0;;){if(E=ne(m|0,y|0,52)|0,Ce()|0,E=E&15,E)for(x=1;le=(15-x|0)*3|0,U=ne(m|0,y|0,le|0)|0,Ce()|0,ee=ue(7,0,le|0)|0,y=y&~(Ce()|0),le=ue(bo(U&7)|0,0,le|0)|0,m=m&~ee|le,y=y|(Ce()|0),x>>>0<E>>>0;)x=x+1|0;if(I=I+1|0,(I|0)==(R|0))break e}}I=ne(m|0,y|0,52)|0,Ce()|0,I=I&15;t:do if(I){x=1;n:for(;;){switch(le=ne(m|0,y|0,(15-x|0)*3|0)|0,Ce()|0,le&7){case 1:break n;case 0:break;default:break t}if(x>>>0<I>>>0)x=x+1|0;else break t}if(MA(E,a[U>>2]|0)|0)for(x=1;U=(15-x|0)*3|0,ee=ue(7,0,U|0)|0,le=y&~(Ce()|0),y=ne(m|0,y|0,U|0)|0,Ce()|0,y=ue(Yo(y&7)|0,0,U|0)|0,m=m&~ee|y,y=le|(Ce()|0),x>>>0<I>>>0;)x=x+1|0;else for(x=1;le=(15-x|0)*3|0,U=ne(m|0,y|0,le|0)|0,Ce()|0,ee=ue(7,0,le|0)|0,y=y&~(Ce()|0),le=ue(bo(U&7)|0,0,le|0)|0,m=m&~ee|le,y=y|(Ce()|0),x>>>0<I>>>0;)x=x+1|0}while(0);if((R|0)>0){x=0;do m=yu(m,y)|0,y=Ce()|0,x=x+1|0;while((x|0)!=(R|0))}}else m=0,y=0;while(0);return ee=y,le=m,Mt(ee|0),we=q,le|0}function Ti(y){return y=y|0,(y|0)%2|0|0}function fs(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0;return I=we,we=we+16|0,E=I,m>>>0>15?(E=4,we=I,E|0):(a[y+4>>2]&2146435072|0)==2146435072||(a[y+8+4>>2]&2146435072|0)==2146435072?(E=3,we=I,E|0):(Hn(y,m,E),m=di(E,m)|0,E=Ce()|0,a[x>>2]=m,a[x+4>>2]=E,(m|0)==0&(E|0)==0&&cn(23313,22674,786,22697),E=0,we=I,E|0)}function wa(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0;if(I=x+4|0,R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,O=ne(y|0,m|0,45)|0,Ce()|0,E=(R|0)==0,jn(O&127)|0){if(E)return O=1,O|0;E=1}else{if(E)return O=0,O|0;!(a[I>>2]|0)&&!(a[x+8>>2]|0)?E=(a[x+12>>2]|0)!=0&1:E=1}for(x=1;x&1?Zo(I):Wi(I),O=ne(y|0,m|0,(15-x|0)*3|0)|0,Ce()|0,Qi(I,O&7),x>>>0<R>>>0;)x=x+1|0;return E|0}function Ki(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(le=we,we=we+16|0,q=le,ee=ne(y|0,m|0,45)|0,Ce()|0,ee=ee&127,ee>>>0>121)return a[x>>2]=0,a[x+4>>2]=0,a[x+8>>2]=0,a[x+12>>2]=0,ee=5,we=le,ee|0;e:do if(jn(ee)|0&&(R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,(R|0)!=0)){E=1;t:for(;;){switch(U=ne(y|0,m|0,(15-E|0)*3|0)|0,Ce()|0,U&7){case 5:break t;case 0:break;default:{E=m;break e}}if(E>>>0<R>>>0)E=E+1|0;else{E=m;break e}}for(I=1,E=m;m=(15-I|0)*3|0,O=ue(7,0,m|0)|0,U=E&~(Ce()|0),E=ne(y|0,E|0,m|0)|0,Ce()|0,E=ue(Yo(E&7)|0,0,m|0)|0,y=y&~O|E,E=U|(Ce()|0),I>>>0<R>>>0;)I=I+1|0}else E=m;while(0);if(U=7696+(ee*28|0)|0,a[x>>2]=a[U>>2],a[x+4>>2]=a[U+4>>2],a[x+8>>2]=a[U+8>>2],a[x+12>>2]=a[U+12>>2],!(wa(y,E,x)|0))return ee=0,we=le,ee|0;if(O=x+4|0,a[q>>2]=a[O>>2],a[q+4>>2]=a[O+4>>2],a[q+8>>2]=a[O+8>>2],R=ne(y|0,E|0,52)|0,Ce()|0,U=R&15,R&1?(Wi(O),R=U+1|0):R=U,!(jn(ee)|0))E=0;else{e:do if(!U)E=0;else for(m=1;;){if(I=ne(y|0,E|0,(15-m|0)*3|0)|0,Ce()|0,I=I&7,I|0){E=I;break e}if(m>>>0<U>>>0)m=m+1|0;else{E=0;break}}while(0);E=(E|0)==4&1}if(!(Ka(x,R,E,0)|0))(R|0)!=(U|0)&&(a[O>>2]=a[q>>2],a[O+4>>2]=a[q+4>>2],a[O+8>>2]=a[q+8>>2]);else{if(jn(ee)|0)do;while(Ka(x,R,0,0)|0);(R|0)!=(U|0)&&Ya(O)}return ee=0,we=le,ee|0}function To(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;return R=we,we=we+16|0,E=R,I=Ki(y,m,E)|0,I|0?(we=R,I|0):(I=ne(y|0,m|0,52)|0,Ce()|0,Bl(E,I&15,x),I=0,we=R,I|0)}function yi(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0;if(O=we,we=we+16|0,R=O,E=Ki(y,m,R)|0,E|0)return R=E,we=O,R|0;E=ne(y|0,m|0,45)|0,Ce()|0,E=(jn(E&127)|0)==0,I=ne(y|0,m|0,52)|0,Ce()|0,I=I&15;e:do if(!E){if(I|0)for(E=1;;){if(U=ue(7,0,(15-E|0)*3|0)|0,!((U&y|0)==0&((Ce()|0)&m|0)==0))break e;if(E>>>0<I>>>0)E=E+1|0;else break}return Ko(R,I,0,5,x),U=0,we=O,U|0}while(0);return gu(R,I,0,6,x),U=0,we=O,U|0}function el(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;if(I=ne(y|0,m|0,45)|0,Ce()|0,!(jn(I&127)|0))return I=2,a[x>>2]=I,0;if(I=ne(y|0,m|0,52)|0,Ce()|0,I=I&15,!I)return I=5,a[x>>2]=I,0;for(E=1;;){if(R=ue(7,0,(15-E|0)*3|0)|0,!((R&y|0)==0&((Ce()|0)&m|0)==0)){E=2,y=6;break}if(E>>>0<I>>>0)E=E+1|0;else{E=5,y=6;break}}return(y|0)==6&&(a[x>>2]=E),0}function Ul(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0;de=we,we=we+128|0,ee=de+112|0,R=de+96|0,le=de,I=ne(y|0,m|0,52)|0,Ce()|0,U=I&15,a[ee>>2]=U,O=ne(y|0,m|0,45)|0,Ce()|0,O=O&127;e:do if(jn(O)|0){if(U|0)for(E=1;;){if(q=ue(7,0,(15-E|0)*3|0)|0,!((q&y|0)==0&((Ce()|0)&m|0)==0)){I=0;break e}if(E>>>0<U>>>0)E=E+1|0;else break}if(I&1)I=1;else return q=ue(U+1|0,0,52)|0,le=Ce()|0|m&-15728641,ee=ue(7,0,(14-U|0)*3|0)|0,le=Ul((q|y)&~ee,le&~(Ce()|0),x)|0,we=de,le|0}else I=0;while(0);if(E=Ki(y,m,R)|0,!E){I?(bc(R,ee,le),q=5):(Hs(R,ee,le),q=6);e:do if(jn(O)|0)if(!U)y=5;else for(E=1;;){if(O=ue(7,0,(15-E|0)*3|0)|0,!((O&y|0)==0&((Ce()|0)&m|0)==0)){y=2;break e}if(E>>>0<U>>>0)E=E+1|0;else{y=5;break}}else y=2;while(0);Se(x|0,-1,y<<2|0)|0;e:do if(I)for(R=0;;){if(O=le+(R<<4)|0,Ec(O,a[ee>>2]|0)|0,O=a[O>>2]|0,U=a[x>>2]|0,(U|0)==-1|(U|0)==(O|0))E=x;else{I=0;do{if(I=I+1|0,I>>>0>=y>>>0){E=1;break e}E=x+(I<<2)|0,U=a[E>>2]|0}while(!((U|0)==-1|(U|0)==(O|0)))}if(a[E>>2]=O,R=R+1|0,R>>>0>=q>>>0){E=0;break}}else for(R=0;;){if(O=le+(R<<4)|0,Ka(O,a[ee>>2]|0,0,1)|0,O=a[O>>2]|0,U=a[x>>2]|0,(U|0)==-1|(U|0)==(O|0))E=x;else{I=0;do{if(I=I+1|0,I>>>0>=y>>>0){E=1;break e}E=x+(I<<2)|0,U=a[E>>2]|0}while(!((U|0)==-1|(U|0)==(O|0)))}if(a[E>>2]=O,R=R+1|0,R>>>0>=q>>>0){E=0;break}}while(0)}return le=E,we=de,le|0}function tl(){return 12}function Qs(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0;if(y>>>0>15)return U=4,U|0;if(ue(y|0,0,52)|0,U=Ce()|0|134225919,!y){x=0,E=0;do jn(E)|0&&(ue(E|0,0,45)|0,O=U|(Ce()|0),y=m+(x<<3)|0,a[y>>2]=-1,a[y+4>>2]=O,x=x+1|0),E=E+1|0;while((E|0)!=122);return x=0,x|0}x=0,O=0;do{if(jn(O)|0){for(ue(O|0,0,45)|0,E=1,I=-1,R=U|(Ce()|0);q=ue(7,0,(15-E|0)*3|0)|0,I=I&~q,R=R&~(Ce()|0),(E|0)!=(y|0);)E=E+1|0;q=m+(x<<3)|0,a[q>>2]=I,a[q+4>>2]=R,x=x+1|0}O=O+1|0}while((O|0)!=122);return x=0,x|0}function ds(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0;if(st=we,we=we+16|0,ft=st,ct=ne(y|0,m|0,52)|0,Ce()|0,ct=ct&15,x>>>0>15)return ct=4,we=st,ct|0;if((ct|0)<(x|0))return ct=12,we=st,ct|0;if((ct|0)!=(x|0))if(R=ue(x|0,0,52)|0,R=R|y,U=Ce()|0|m&-15728641,(ct|0)>(x|0)){q=x;do Je=ue(7,0,(14-q|0)*3|0)|0,q=q+1|0,R=Je|R,U=Ce()|0|U;while((q|0)<(ct|0));Je=R}else Je=R;else Je=y,U=m;ze=ne(Je|0,U|0,45)|0,Ce()|0;e:do if(jn(ze&127)|0){if(q=ne(Je|0,U|0,52)|0,Ce()|0,q=q&15,q|0)for(R=1;;){if(ze=ue(7,0,(15-R|0)*3|0)|0,!((ze&Je|0)==0&((Ce()|0)&U|0)==0)){ee=33;break e}if(R>>>0<q>>>0)R=R+1|0;else break}if(ze=E,a[ze>>2]=0,a[ze+4>>2]=0,(ct|0)>(x|0)){for(ze=m&-15728641,He=ct;;){if(Be=He,He=He+-1|0,He>>>0>15|(ct|0)<(He|0)){ee=19;break}if((ct|0)!=(He|0))if(R=ue(He|0,0,52)|0,R=R|y,q=Ce()|0|ze,(ct|0)<(Be|0))de=R;else{ee=He;do de=ue(7,0,(14-ee|0)*3|0)|0,ee=ee+1|0,R=de|R,q=Ce()|0|q;while((ee|0)<(ct|0));de=R}else de=y,q=m;if(le=ne(de|0,q|0,45)|0,Ce()|0,!(jn(le&127)|0))R=0;else{le=ne(de|0,q|0,52)|0,Ce()|0,le=le&15;t:do if(!le)R=0;else for(ee=1;;){if(R=ne(de|0,q|0,(15-ee|0)*3|0)|0,Ce()|0,R=R&7,R|0)break t;if(ee>>>0<le>>>0)ee=ee+1|0;else{R=0;break}}while(0);R=(R|0)==0&1}if(q=ne(y|0,m|0,(15-Be|0)*3|0)|0,Ce()|0,q=q&7,(q|0)==7){I=5,ee=42;break}if(R=(R|0)!=0,(q|0)==1&R){I=5,ee=42;break}if(de=q+(((q|0)!=0&R)<<31>>31)|0,de|0&&(ee=ct-Be|0,ee=Zs(7,0,ee,((ee|0)<0)<<31>>31)|0,le=Ce()|0,R?(R=V(ee|0,le|0,5,0)|0,R=d(R|0,Ce()|0,-5,-1)|0,R=P(R|0,Ce()|0,6,0)|0,R=d(R|0,Ce()|0,1,0)|0,q=Ce()|0):(R=ee,q=le),Be=de+-1|0,Be=V(ee|0,le|0,Be|0,((Be|0)<0)<<31>>31|0)|0,Be=d(R|0,q|0,Be|0,Ce()|0)|0,de=Ce()|0,le=E,le=d(Be|0,de|0,a[le>>2]|0,a[le+4>>2]|0)|0,de=Ce()|0,Be=E,a[Be>>2]=le,a[Be+4>>2]=de),(He|0)<=(x|0)){ee=37;break}}if((ee|0)==19)cn(23313,22674,1099,22710);else if((ee|0)==37){O=E,I=a[O+4>>2]|0,O=a[O>>2]|0;break}else if((ee|0)==42)return we=st,I|0}else I=0,O=0}else ee=33;while(0);e:do if((ee|0)==33)if(ze=E,a[ze>>2]=0,a[ze+4>>2]=0,(ct|0)>(x|0)){for(R=ct;;){if(I=ne(y|0,m|0,(15-R|0)*3|0)|0,Ce()|0,I=I&7,(I|0)==7){I=5;break}if(O=ct-R|0,O=Zs(7,0,O,((O|0)<0)<<31>>31)|0,I=V(O|0,Ce()|0,I|0,0)|0,O=Ce()|0,ze=E,O=d(a[ze>>2]|0,a[ze+4>>2]|0,I|0,O|0)|0,I=Ce()|0,ze=E,a[ze>>2]=O,a[ze+4>>2]=I,R=R+-1|0,(R|0)<=(x|0))break e}return we=st,I|0}else I=0,O=0;while(0);return Fl(Je,U,ct,ft)|0&&cn(23313,22674,1063,22725),ct=ft,ft=a[ct+4>>2]|0,((I|0)>-1|(I|0)==-1&O>>>0>4294967295)&((ft|0)>(I|0)|((ft|0)==(I|0)?(a[ct>>2]|0)>>>0>O>>>0:0))?(ct=0,we=st,ct|0):(cn(23313,22674,1139,22710),0)}function Cc(y,m,x,E,I,R){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0,R=R|0;var O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0;if(de=we,we=we+16|0,O=de,I>>>0>15)return R=4,we=de,R|0;if(U=ne(x|0,E|0,52)|0,Ce()|0,U=U&15,(U|0)>(I|0))return R=12,we=de,R|0;if(Fl(x,E,I,O)|0&&cn(23313,22674,1063,22725),le=O,ee=a[le+4>>2]|0,!(((m|0)>-1|(m|0)==-1&y>>>0>4294967295)&((ee|0)>(m|0)|((ee|0)==(m|0)?(a[le>>2]|0)>>>0>y>>>0:0))))return R=2,we=de,R|0;le=I-U|0,I=ue(I|0,0,52)|0,q=Ce()|0|E&-15728641,ee=R,a[ee>>2]=I|x,a[ee+4>>2]=q,ee=ne(x|0,E|0,45)|0,Ce()|0;e:do if(jn(ee&127)|0){if(U|0)for(O=1;;){if(ee=ue(7,0,(15-O|0)*3|0)|0,!((ee&x|0)==0&((Ce()|0)&E|0)==0))break e;if(O>>>0<U>>>0)O=O+1|0;else break}if((le|0)<1)return R=0,we=de,R|0;for(ee=U^15,E=-1,q=1,O=1;;){U=le-q|0,U=Zs(7,0,U,((U|0)<0)<<31>>31)|0,x=Ce()|0;do if(O)if(O=V(U|0,x|0,5,0)|0,O=d(O|0,Ce()|0,-5,-1)|0,O=P(O|0,Ce()|0,6,0)|0,I=Ce()|0,(m|0)>(I|0)|(m|0)==(I|0)&y>>>0>O>>>0){m=d(y|0,m|0,-1,-1)|0,m=w(m|0,Ce()|0,O|0,I|0)|0,O=Ce()|0,Be=R,ze=a[Be>>2]|0,Be=a[Be+4>>2]|0,Je=(ee+E|0)*3|0,He=ue(7,0,Je|0)|0,Be=Be&~(Ce()|0),E=P(m|0,O|0,U|0,x|0)|0,y=Ce()|0,I=d(E|0,y|0,2,0)|0,Je=ue(I|0,Ce()|0,Je|0)|0,Be=Ce()|0|Be,I=R,a[I>>2]=Je|ze&~He,a[I+4>>2]=Be,y=V(E|0,y|0,U|0,x|0)|0,y=w(m|0,O|0,y|0,Ce()|0)|0,O=0,m=Ce()|0;break}else{Je=R,He=a[Je>>2]|0,Je=a[Je+4>>2]|0,ze=ue(7,0,(ee+E|0)*3|0)|0,Je=Je&~(Ce()|0),O=R,a[O>>2]=He&~ze,a[O+4>>2]=Je,O=1;break}else He=R,I=a[He>>2]|0,He=a[He+4>>2]|0,E=(ee+E|0)*3|0,Be=ue(7,0,E|0)|0,He=He&~(Ce()|0),Je=P(y|0,m|0,U|0,x|0)|0,O=Ce()|0,E=ue(Je|0,O|0,E|0)|0,He=Ce()|0|He,ze=R,a[ze>>2]=E|I&~Be,a[ze+4>>2]=He,O=V(Je|0,O|0,U|0,x|0)|0,y=w(y|0,m|0,O|0,Ce()|0)|0,O=0,m=Ce()|0;while(0);if((le|0)>(q|0))E=~q,q=q+1|0;else{m=0;break}}return we=de,m|0}while(0);if((le|0)<1)return Je=0,we=de,Je|0;for(I=U^15,O=1;;)if(ze=le-O|0,ze=Zs(7,0,ze,((ze|0)<0)<<31>>31)|0,Je=Ce()|0,q=R,x=a[q>>2]|0,q=a[q+4>>2]|0,U=(I-O|0)*3|0,E=ue(7,0,U|0)|0,q=q&~(Ce()|0),Be=P(y|0,m|0,ze|0,Je|0)|0,He=Ce()|0,U=ue(Be|0,He|0,U|0)|0,q=Ce()|0|q,ee=R,a[ee>>2]=U|x&~E,a[ee+4>>2]=q,Je=V(Be|0,He|0,ze|0,Je|0)|0,y=w(y|0,m|0,Je|0,Ce()|0)|0,m=Ce()|0,(le|0)<=(O|0)){m=0;break}else O=O+1|0;return we=de,m|0}function ba(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0;I=ne(m|0,x|0,52)|0,Ce()|0,I=I&15,(m|0)==0&(x|0)==0|((E|0)>15|(I|0)>(E|0))?(E=-1,I=-1,m=0,x=0):(R=hs(m,x,I+1|0,E)|0,x=(Ce()|0)&-15728641,m=ue(E|0,0,52)|0,m=R|m,x=x|(Ce()|0),R=(vr(m,x)|0)==0,E=R?-1:E),R=y,a[R>>2]=m,a[R+4>>2]=x,a[y+8>>2]=I,a[y+12>>2]=E}function nl(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0;if(x=y,m=a[x>>2]|0,x=a[x+4>>2]|0,!((m|0)==0&(x|0)==0)&&(E=ne(m|0,x|0,52)|0,Ce()|0,E=E&15,U=ue(1,0,(E^15)*3|0)|0,m=d(U|0,Ce()|0,m|0,x|0)|0,x=Ce()|0,U=y,a[U>>2]=m,a[U+4>>2]=x,U=y+8|0,O=a[U>>2]|0,!((E|0)<(O|0)))){for(q=y+12|0,R=E;;){if((R|0)==(O|0)){E=5;break}if(ee=(R|0)==(a[q>>2]|0),I=(15-R|0)*3|0,E=ne(m|0,x|0,I|0)|0,Ce()|0,E=E&7,ee&((E|0)==1&!0)){E=7;break}if(!((E|0)==7&!0)){E=10;break}if(ee=ue(1,0,I|0)|0,m=d(m|0,x|0,ee|0,Ce()|0)|0,x=Ce()|0,ee=y,a[ee>>2]=m,a[ee+4>>2]=x,(R|0)>(O|0))R=R+-1|0;else{E=10;break}}if((E|0)==5){ee=y,a[ee>>2]=0,a[ee+4>>2]=0,a[U>>2]=-1,a[q>>2]=-1;return}else if((E|0)==7){O=ue(1,0,I|0)|0,O=d(m|0,x|0,O|0,Ce()|0)|0,U=Ce()|0,ee=y,a[ee>>2]=O,a[ee+4>>2]=U,a[q>>2]=R+-1;return}else if((E|0)==10)return}}function oi(y){y=+y;var m=0;return m=y<0?y+6.283185307179586:y,+(y>=6.283185307179586?m+-6.283185307179586:m)}function Ps(y,m){return y=y|0,m=m|0,+Ie(+(+G[y>>3]-+G[m>>3]))<17453292519943298e-27?(m=+Ie(+(+G[y+8>>3]-+G[m+8>>3]))<17453292519943298e-27,m|0):(m=0,m|0)}function Ji(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0;return I=+G[m>>3],E=+G[y>>3],R=+dt(+((I-E)*.5)),x=+dt(+((+G[m+8>>3]-+G[y+8>>3])*.5)),x=R*R+x*(+Qe(+I)*+Qe(+E)*x),+(+pn(+ +qe(+x),+ +qe(+(1-x)))*2)}function Vl(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0;return I=+G[m>>3],E=+G[y>>3],R=+dt(+((I-E)*.5)),x=+dt(+((+G[m+8>>3]-+G[y+8>>3])*.5)),x=R*R+x*(+Qe(+I)*+Qe(+E)*x),+(+pn(+ +qe(+x),+ +qe(+(1-x)))*2*6371.007180918475)}function Jo(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0;return I=+G[m>>3],E=+G[y>>3],R=+dt(+((I-E)*.5)),x=+dt(+((+G[m+8>>3]-+G[y+8>>3])*.5)),x=R*R+x*(+Qe(+I)*+Qe(+E)*x),+(+pn(+ +qe(+x),+ +qe(+(1-x)))*2*6371.007180918475*1e3)}function Mc(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0;return R=+G[m>>3],E=+Qe(+R),I=+G[m+8>>3]-+G[y+8>>3],O=E*+dt(+I),x=+G[y>>3],+ +pn(+O,+(+dt(+R)*+Qe(+x)-+Qe(+I)*(E*+dt(+x))))}function So(y,m,x,E){y=y|0,m=+m,x=+x,E=E|0;var I=0,R=0,O=0,U=0;if(x<1e-16){a[E>>2]=a[y>>2],a[E+4>>2]=a[y+4>>2],a[E+8>>2]=a[y+8>>2],a[E+12>>2]=a[y+12>>2];return}R=m<0?m+6.283185307179586:m,R=m>=6.283185307179586?R+-6.283185307179586:R;do if(R<1e-16)m=+G[y>>3]+x,G[E>>3]=m,I=E;else{if(I=+Ie(+(R+-3.141592653589793))<1e-16,m=+G[y>>3],I){m=m-x,G[E>>3]=m,I=E;break}if(O=+Qe(+x),x=+dt(+x),m=O*+dt(+m)+ +Qe(+R)*(x*+Qe(+m)),m=m>1?1:m,m=+sn(+(m<-1?-1:m)),G[E>>3]=m,+Ie(+(m+-1.5707963267948966))<1e-16){G[E>>3]=1.5707963267948966,G[E+8>>3]=0;return}if(+Ie(+(m+1.5707963267948966))<1e-16){G[E>>3]=-1.5707963267948966,G[E+8>>3]=0;return}if(U=+Qe(+m),R=x*+dt(+R)/U,x=+G[y>>3],m=(O-+dt(+m)*+dt(+x))/+Qe(+x)/U,O=R>1?1:R,m=m>1?1:m,m=+G[y+8>>3]+ +pn(+(O<-1?-1:O),+(m<-1?-1:m)),m>3.141592653589793)do m=m+-6.283185307179586;while(m>3.141592653589793);if(m<-3.141592653589793)do m=m+6.283185307179586;while(m<-3.141592653589793);G[E+8>>3]=m;return}while(0);if(+Ie(+(m+-1.5707963267948966))<1e-16){G[I>>3]=1.5707963267948966,G[E+8>>3]=0;return}if(+Ie(+(m+1.5707963267948966))<1e-16){G[I>>3]=-1.5707963267948966,G[E+8>>3]=0;return}if(m=+G[y+8>>3],m>3.141592653589793)do m=m+-6.283185307179586;while(m>3.141592653589793);if(m<-3.141592653589793)do m=m+6.283185307179586;while(m<-3.141592653589793);G[E+8>>3]=m}function Gl(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20528+(y<<3)>>3],m=0,m|0)}function rl(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20656+(y<<3)>>3],m=0,m|0)}function Dh(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20784+(y<<3)>>3],m=0,m|0)}function Rh(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20912+(y<<3)>>3],m=0,m|0)}function il(y,m){y=y|0,m=m|0;var x=0;return y>>>0>15?(m=4,m|0):(x=Zs(7,0,y,((y|0)<0)<<31>>31)|0,x=V(x|0,Ce()|0,120,0)|0,y=Ce()|0,a[m>>2]=x|2,a[m+4>>2]=y,m=0,m|0)}function Ea(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0;return Be=+G[m>>3],le=+G[y>>3],q=+dt(+((Be-le)*.5)),R=+G[m+8>>3],ee=+G[y+8>>3],O=+dt(+((R-ee)*.5)),U=+Qe(+le),de=+Qe(+Be),O=q*q+O*(de*U*O),O=+pn(+ +qe(+O),+ +qe(+(1-O)))*2,q=+G[x>>3],Be=+dt(+((q-Be)*.5)),E=+G[x+8>>3],R=+dt(+((E-R)*.5)),I=+Qe(+q),R=Be*Be+R*(de*I*R),R=+pn(+ +qe(+R),+ +qe(+(1-R)))*2,q=+dt(+((le-q)*.5)),E=+dt(+((ee-E)*.5)),E=q*q+E*(U*I*E),E=+pn(+ +qe(+E),+ +qe(+(1-E)))*2,I=(O+R+E)*.5,+(+jt(+ +qe(+(+Dt(+(I*.5))*+Dt(+((I-O)*.5))*+Dt(+((I-R)*.5))*+Dt(+((I-E)*.5)))))*4)}function ps(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0;if(U=we,we=we+192|0,R=U+168|0,O=U,I=To(y,m,R)|0,I|0)return x=I,we=U,x|0;if(yi(y,m,O)|0&&cn(23313,22742,386,22751),m=a[O>>2]|0,(m|0)>0){if(E=+Ea(O+8|0,O+8+(((m|0)!=1&1)<<4)|0,R)+0,(m|0)!=1){y=1;do I=y,y=y+1|0,E=E+ +Ea(O+8+(I<<4)|0,O+8+(((y|0)%(m|0)|0)<<4)|0,R);while((y|0)<(m|0))}}else E=0;return G[x>>3]=E,x=0,we=U,x|0}function Nt(y,m,x){return y=y|0,m=m|0,x=x|0,y=ps(y,m,x)|0,y|0||(G[x>>3]=+G[x>>3]*6371.007180918475*6371.007180918475),y|0}function _u(y,m,x){return y=y|0,m=m|0,x=x|0,y=ps(y,m,x)|0,y|0||(G[x>>3]=+G[x>>3]*6371.007180918475*6371.007180918475*1e3*1e3),y|0}function Ta(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(U=we,we=we+176|0,O=U,y=js(y,m,O)|0,y|0)return O=y,we=U,O|0;if(G[x>>3]=0,y=a[O>>2]|0,(y|0)<=1)return O=0,we=U,O|0;m=y+-1|0,y=0,E=+G[O+8>>3],I=+G[O+16>>3],R=0;do y=y+1|0,ee=E,E=+G[O+8+(y<<4)>>3],le=+dt(+((E-ee)*.5)),q=I,I=+G[O+8+(y<<4)+8>>3],q=+dt(+((I-q)*.5)),q=le*le+q*(+Qe(+E)*+Qe(+ee)*q),R=R+ +pn(+ +qe(+q),+ +qe(+(1-q)))*2;while((y|0)<(m|0));return G[x>>3]=R,O=0,we=U,O|0}function ea(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(U=we,we=we+176|0,O=U,y=js(y,m,O)|0,y|0)return O=y,R=+G[x>>3],R=R*6371.007180918475,G[x>>3]=R,we=U,O|0;if(G[x>>3]=0,y=a[O>>2]|0,(y|0)<=1)return O=0,R=0,R=R*6371.007180918475,G[x>>3]=R,we=U,O|0;m=y+-1|0,y=0,E=+G[O+8>>3],I=+G[O+16>>3],R=0;do y=y+1|0,ee=E,E=+G[O+8+(y<<4)>>3],le=+dt(+((E-ee)*.5)),q=I,I=+G[O+8+(y<<4)+8>>3],q=+dt(+((I-q)*.5)),q=le*le+q*(+Qe(+ee)*+Qe(+E)*q),R=R+ +pn(+ +qe(+q),+ +qe(+(1-q)))*2;while((y|0)!=(m|0));return G[x>>3]=R,O=0,le=R,le=le*6371.007180918475,G[x>>3]=le,we=U,O|0}function vu(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(U=we,we=we+176|0,O=U,y=js(y,m,O)|0,y|0)return O=y,R=+G[x>>3],R=R*6371.007180918475,R=R*1e3,G[x>>3]=R,we=U,O|0;if(G[x>>3]=0,y=a[O>>2]|0,(y|0)<=1)return O=0,R=0,R=R*6371.007180918475,R=R*1e3,G[x>>3]=R,we=U,O|0;m=y+-1|0,y=0,E=+G[O+8>>3],I=+G[O+16>>3],R=0;do y=y+1|0,ee=E,E=+G[O+8+(y<<4)>>3],le=+dt(+((E-ee)*.5)),q=I,I=+G[O+8+(y<<4)+8>>3],q=+dt(+((I-q)*.5)),q=le*le+q*(+Qe(+ee)*+Qe(+E)*q),R=R+ +pn(+ +qe(+q),+ +qe(+(1-q)))*2;while((y|0)!=(m|0));return G[x>>3]=R,O=0,le=R,le=le*6371.007180918475,le=le*1e3,G[x>>3]=le,we=U,O|0}function Vt(y){y=y|0;var m=0,x=0,E=0;return m=h(1,12)|0,m||cn(22832,22787,49,22845),x=y+4|0,E=a[x>>2]|0,E|0?(E=E+8|0,a[E>>2]=m,a[x>>2]=m,m|0):(a[y>>2]|0&&cn(22862,22787,61,22885),E=y,a[E>>2]=m,a[x>>2]=m,m|0)}function BA(y,m){y=y|0,m=m|0;var x=0,E=0;return E=v(24)|0,E||cn(22899,22787,78,22913),a[E>>2]=a[m>>2],a[E+4>>2]=a[m+4>>2],a[E+8>>2]=a[m+8>>2],a[E+12>>2]=a[m+12>>2],a[E+16>>2]=0,m=y+4|0,x=a[m>>2]|0,x|0?(a[x+16>>2]=E,a[m>>2]=E,E|0):(a[y>>2]|0&&cn(22928,22787,82,22913),a[y>>2]=E,a[m>>2]=E,E|0)}function $l(y){y=y|0;var m=0,x=0,E=0,I=0;if(y)for(E=1;;){if(m=a[y>>2]|0,m|0)do{if(x=a[m>>2]|0,x|0)do I=x,x=a[x+16>>2]|0,A(I);while(x|0);I=m,m=a[m+8>>2]|0,A(I)}while(m|0);if(m=y,y=a[y+8>>2]|0,E||A(m),y)E=0;else break}}function zA(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0,ot=0,et=0,Gt=0,zt=0,gt=0,vt=0,kn=0,wn=0,mn=0,_n=0,En=0,Rn=0,lr=0,In=0;if(I=y+8|0,a[I>>2]|0)return In=1,In|0;if(E=a[y>>2]|0,!E)return In=0,In|0;m=E,x=0;do x=x+1|0,m=a[m+8>>2]|0;while(m|0);if(x>>>0<2)return In=0,In|0;Rn=v(x<<2)|0,Rn||cn(22948,22787,317,22967),En=v(x<<5)|0,En||cn(22989,22787,321,22967),a[y>>2]=0,zt=y+4|0,a[zt>>2]=0,a[I>>2]=0,x=0,_n=0,Gt=0,de=0;e:for(;;){if(le=a[E>>2]|0,le){R=0,O=le;do{if(q=+G[O+8>>3],m=O,O=a[O+16>>2]|0,ee=(O|0)==0,I=ee?le:O,U=+G[I+8>>3],+Ie(+(q-U))>3.141592653589793){In=14;break}R=R+(U-q)*(+G[m>>3]+ +G[I>>3])}while(!ee);if((In|0)==14){In=0,R=0,m=le;do et=+G[m+8>>3],mn=m+16|0,wn=a[mn>>2]|0,wn=wn|0?wn:le,ot=+G[wn+8>>3],R=R+(+G[m>>3]+ +G[wn>>3])*((ot<0?ot+6.283185307179586:ot)-(et<0?et+6.283185307179586:et)),m=a[(m|0?mn:E)>>2]|0;while(m|0)}R>0?(a[Rn+(_n<<2)>>2]=E,_n=_n+1|0,I=Gt,m=de):In=19}else In=19;if((In|0)==19){In=0;do if(x){if(m=x+8|0,a[m>>2]|0){In=21;break e}if(x=h(1,12)|0,!x){In=23;break e}a[m>>2]=x,I=x+4|0,O=x,m=de}else if(de){I=zt,O=de+8|0,m=E,x=y;break}else if(a[y>>2]|0){In=27;break e}else{I=zt,O=y,m=E,x=y;break}while(0);if(a[O>>2]=E,a[I>>2]=E,O=En+(Gt<<5)|0,ee=a[E>>2]|0,ee){for(le=En+(Gt<<5)+8|0,G[le>>3]=17976931348623157e292,de=En+(Gt<<5)+24|0,G[de>>3]=17976931348623157e292,G[O>>3]=-17976931348623157e292,Be=En+(Gt<<5)+16|0,G[Be>>3]=-17976931348623157e292,ct=17976931348623157e292,st=-17976931348623157e292,I=0,He=ee,q=17976931348623157e292,Je=17976931348623157e292,ft=-17976931348623157e292,U=-17976931348623157e292;R=+G[He>>3],et=+G[He+8>>3],He=a[He+16>>2]|0,ze=(He|0)==0,ot=+G[(ze?ee:He)+8>>3],R<q&&(G[le>>3]=R,q=R),et<Je&&(G[de>>3]=et,Je=et),R>ft?G[O>>3]=R:R=ft,et>U&&(G[Be>>3]=et,U=et),ct=et>0&et<ct?et:ct,st=et<0&et>st?et:st,I=I|+Ie(+(et-ot))>3.141592653589793,!ze;)ft=R;I&&(G[Be>>3]=st,G[de>>3]=ct)}else a[O>>2]=0,a[O+4>>2]=0,a[O+8>>2]=0,a[O+12>>2]=0,a[O+16>>2]=0,a[O+20>>2]=0,a[O+24>>2]=0,a[O+28>>2]=0;I=Gt+1|0}if(mn=E+8|0,E=a[mn>>2]|0,a[mn>>2]=0,E)Gt=I,de=m;else{In=45;break}}if((In|0)==21)cn(22765,22787,35,22799);else if((In|0)==23)cn(22819,22787,37,22799);else if((In|0)==27)cn(22862,22787,61,22885);else if((In|0)==45){e:do if((_n|0)>0){for(mn=(I|0)==0,kn=I<<2,wn=(y|0)==0,vt=0,m=0;;){if(gt=a[Rn+(vt<<2)>>2]|0,mn)In=73;else{if(Gt=v(kn)|0,!Gt){In=50;break}if(zt=v(kn)|0,!zt){In=52;break}t:do if(wn)x=0;else{for(I=0,x=0,O=y;E=En+(I<<5)|0,sl(a[O>>2]|0,E,a[gt>>2]|0)|0?(a[Gt+(x<<2)>>2]=O,a[zt+(x<<2)>>2]=E,ze=x+1|0):ze=x,O=a[O+8>>2]|0,O;)I=I+1|0,x=ze;if((ze|0)>0)if(E=a[Gt>>2]|0,(ze|0)==1)x=E;else for(Be=0,He=-1,x=E,de=E;;){for(ee=a[de>>2]|0,E=0,O=0;I=a[a[Gt+(O<<2)>>2]>>2]|0,(I|0)==(ee|0)?le=E:le=E+((sl(I,a[zt+(O<<2)>>2]|0,a[ee>>2]|0)|0)&1)|0,O=O+1|0,(O|0)!=(ze|0);)E=le;if(I=(le|0)>(He|0),x=I?de:x,E=Be+1|0,(E|0)==(ze|0))break t;Be=E,He=I?le:He,de=a[Gt+(E<<2)>>2]|0}else x=0}while(0);if(A(Gt),A(zt),x){if(I=x+4|0,E=a[I>>2]|0,E)x=E+8|0;else if(a[x>>2]|0){In=70;break}a[x>>2]=gt,a[I>>2]=gt}else In=73}if((In|0)==73){if(In=0,m=a[gt>>2]|0,m|0)do zt=m,m=a[m+16>>2]|0,A(zt);while(m|0);A(gt),m=1}if(vt=vt+1|0,(vt|0)>=(_n|0)){lr=m;break e}}(In|0)==50?cn(23004,22787,249,23023):(In|0)==52?cn(23042,22787,252,23023):(In|0)==70&&cn(22862,22787,61,22885)}else lr=0;while(0);return A(Rn),A(En),In=lr,In|0}return 0}function sl(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(!(Au(m,x)|0)||(m=Kn(m)|0,E=+G[x>>3],I=+G[x+8>>3],I=m&I<0?I+6.283185307179586:I,y=a[y>>2]|0,!y))return y=0,y|0;if(m){m=0,ee=I,x=y;e:for(;;){for(;O=+G[x>>3],I=+G[x+8>>3],x=x+16|0,le=a[x>>2]|0,le=le|0?le:y,R=+G[le>>3],U=+G[le+8>>3],O>R?(q=O,O=U):(q=R,R=O,O=I,I=U),E=E==R|E==q?E+2220446049250313e-31:E,!!(E<R|E>q);)if(x=a[x>>2]|0,!x){x=22;break e}if(U=O<0?O+6.283185307179586:O,O=I<0?I+6.283185307179586:I,ee=U==ee|O==ee?ee+-2220446049250313e-31:ee,q=U+(O-U)*((E-R)/(q-R)),(q<0?q+6.283185307179586:q)>ee&&(m=m^1),x=a[x>>2]|0,!x){x=22;break}}if((x|0)==22)return m|0}else{m=0,ee=I,x=y;e:for(;;){for(;O=+G[x>>3],I=+G[x+8>>3],x=x+16|0,le=a[x>>2]|0,le=le|0?le:y,R=+G[le>>3],U=+G[le+8>>3],O>R?(q=O,O=U):(q=R,R=O,O=I,I=U),E=E==R|E==q?E+2220446049250313e-31:E,!!(E<R|E>q);)if(x=a[x>>2]|0,!x){x=22;break e}if(ee=O==ee|I==ee?ee+-2220446049250313e-31:ee,O+(I-O)*((E-R)/(q-R))>ee&&(m=m^1),x=a[x>>2]|0,!x){x=22;break}}if((x|0)==22)return m|0}return 0}function qs(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0;if(st=we,we=we+32|0,ct=st+16|0,ft=st,R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,He=ne(x|0,E|0,52)|0,Ce()|0,(R|0)!=(He&15|0))return ct=12,we=st,ct|0;if(ee=ne(y|0,m|0,45)|0,Ce()|0,ee=ee&127,le=ne(x|0,E|0,45)|0,Ce()|0,le=le&127,ee>>>0>121|le>>>0>121)return ct=5,we=st,ct|0;if(He=(ee|0)!=(le|0),He){if(U=kl(ee,le)|0,(U|0)==7)return ct=1,we=st,ct|0;q=kl(le,ee)|0,(q|0)==7?cn(23066,23090,161,23100):(ze=U,O=q)}else ze=0,O=0;de=jn(ee)|0,Be=jn(le)|0,a[ct>>2]=0,a[ct+4>>2]=0,a[ct+8>>2]=0,a[ct+12>>2]=0;do if(ze){if(le=a[4272+(ee*28|0)+(ze<<2)>>2]|0,U=(le|0)>0,Be)if(U){ee=0,q=x,U=E;do q=Sc(q,U)|0,U=Ce()|0,O=Yo(O)|0,(O|0)==1&&(O=Yo(1)|0),ee=ee+1|0;while((ee|0)!=(le|0));le=O,ee=q,q=U}else le=O,ee=x,q=E;else if(U){ee=0,q=x,U=E;do q=RA(q,U)|0,U=Ce()|0,O=Yo(O)|0,ee=ee+1|0;while((ee|0)!=(le|0));le=O,ee=q,q=U}else le=O,ee=x,q=E;if(wa(ee,q,ct)|0,He||cn(23115,23090,191,23100),U=(de|0)!=0,O=(Be|0)!=0,U&O&&cn(23142,23090,192,23100),U){if(O=si(y,m)|0,(O|0)==7){R=5;break}if(fe[21872+(O*7|0)+ze>>0]|0){R=1;break}q=a[21040+(O*28|0)+(ze<<2)>>2]|0,ee=q}else if(O){if(O=si(ee,q)|0,(O|0)==7){R=5;break}if(fe[21872+(O*7|0)+le>>0]|0){R=1;break}ee=0,q=a[21040+(le*28|0)+(O<<2)>>2]|0}else ee=0,q=0;if((ee|q|0)<0)R=5;else{if((q|0)>0){U=ct+4|0,O=0;do Dl(U),O=O+1|0;while((O|0)!=(q|0))}if(a[ft>>2]=0,a[ft+4>>2]=0,a[ft+8>>2]=0,Qi(ft,ze),R|0)for(;Ti(R)|0?Zo(ft):Wi(ft),(R|0)>1;)R=R+-1|0;if((ee|0)>0){R=0;do Dl(ft),R=R+1|0;while((R|0)!=(ee|0))}Je=ct+4|0,ii(Je,ft,Je),On(Je),Je=51}}else if(wa(x,E,ct)|0,(de|0)!=0&(Be|0)!=0)if((le|0)!=(ee|0)&&cn(23173,23090,261,23100),O=si(y,m)|0,R=si(x,E)|0,(O|0)==7|(R|0)==7)R=5;else if(fe[21872+(O*7|0)+R>>0]|0)R=1;else if(O=a[21040+(O*28|0)+(R<<2)>>2]|0,(O|0)>0){U=ct+4|0,R=0;do Dl(U),R=R+1|0;while((R|0)!=(O|0));Je=51}else Je=51;else Je=51;while(0);return(Je|0)==51&&(R=ct+4|0,a[I>>2]=a[R>>2],a[I+4>>2]=a[R+4>>2],a[I+8>>2]=a[R+8>>2],R=0),ct=R,we=st,ct|0}function xu(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0,ot=0;if(Je=we,we=we+48|0,ee=Je+36|0,O=Je+24|0,U=Je+12|0,q=Je,I=ne(y|0,m|0,52)|0,Ce()|0,I=I&15,Be=ne(y|0,m|0,45)|0,Ce()|0,Be=Be&127,Be>>>0>121)return E=5,we=Je,E|0;if(le=jn(Be)|0,ue(I|0,0,52)|0,ft=Ce()|0|134225919,R=E,a[R>>2]=-1,a[R+4>>2]=ft,!I)return I=qo(x)|0,(I|0)==7||(I=Pl(Be,I)|0,(I|0)==127)?(ft=1,we=Je,ft|0):(He=ue(I|0,0,45)|0,ze=Ce()|0,Be=E,ze=a[Be+4>>2]&-1040385|ze,ft=E,a[ft>>2]=a[Be>>2]|He,a[ft+4>>2]=ze,ft=0,we=Je,ft|0);for(a[ee>>2]=a[x>>2],a[ee+4>>2]=a[x+4>>2],a[ee+8>>2]=a[x+8>>2],x=I;;){if(R=x,x=x+-1|0,a[O>>2]=a[ee>>2],a[O+4>>2]=a[ee+4>>2],a[O+8>>2]=a[ee+8>>2],Ti(R)|0){if(I=ya(ee)|0,I|0){x=13;break}a[U>>2]=a[ee>>2],a[U+4>>2]=a[ee+4>>2],a[U+8>>2]=a[ee+8>>2],Zo(U)}else{if(I=wo(ee)|0,I|0){x=13;break}a[U>>2]=a[ee>>2],a[U+4>>2]=a[ee+4>>2],a[U+8>>2]=a[ee+8>>2],Wi(U)}if(xo(O,U,q),On(q),I=E,st=a[I>>2]|0,I=a[I+4>>2]|0,ot=(15-R|0)*3|0,ct=ue(7,0,ot|0)|0,I=I&~(Ce()|0),ot=ue(qo(q)|0,0,ot|0)|0,I=Ce()|0|I,ft=E,a[ft>>2]=ot|st&~ct,a[ft+4>>2]=I,(R|0)<=1){x=14;break}}e:do if((x|0)!=13&&(x|0)==14)if((a[ee>>2]|0)<=1&&(a[ee+4>>2]|0)<=1&&(a[ee+8>>2]|0)<=1){x=qo(ee)|0,I=Pl(Be,x)|0,(I|0)==127?q=0:q=jn(I)|0;t:do if(x){if(le){if(I=si(y,m)|0,(I|0)==7){I=5;break e}if(R=a[21248+(I*28|0)+(x<<2)>>2]|0,(R|0)>0){I=x,x=0;do I=bo(I)|0,x=x+1|0;while((x|0)!=(R|0))}else I=x;if((I|0)==1){I=9;break e}x=Pl(Be,I)|0,(x|0)==127&&cn(23200,23090,411,23230),jn(x)|0?cn(23245,23090,412,23230):(ze=x,He=R,de=I)}else ze=I,He=0,de=x;if(U=a[4272+(Be*28|0)+(de<<2)>>2]|0,(U|0)<=-1&&cn(23276,23090,419,23230),!q){if((He|0)<0){I=5;break e}if(He|0){R=E,I=0,x=a[R>>2]|0,R=a[R+4>>2]|0;do x=Ws(x,R)|0,R=Ce()|0,ot=E,a[ot>>2]=x,a[ot+4>>2]=R,I=I+1|0;while((I|0)<(He|0))}if((U|0)<=0){I=ze,x=58;break}for(R=E,I=0,x=a[R>>2]|0,R=a[R+4>>2]|0;;)if(x=Ws(x,R)|0,R=Ce()|0,ot=E,a[ot>>2]=x,a[ot+4>>2]=R,I=I+1|0,(I|0)==(U|0)){I=ze,x=58;break t}}if(O=kl(ze,Be)|0,(O|0)==7&&cn(23066,23090,428,23230),I=E,x=a[I>>2]|0,I=a[I+4>>2]|0,(U|0)>0){R=0;do x=Ws(x,I)|0,I=Ce()|0,ot=E,a[ot>>2]=x,a[ot+4>>2]=I,R=R+1|0;while((R|0)!=(U|0))}if(I=si(x,I)|0,(I|0)==7&&cn(23313,23090,440,23230),x=TA(ze)|0,x=a[(x?21664:21456)+(O*28|0)+(I<<2)>>2]|0,(x|0)<0&&cn(23313,23090,454,23230),!x)I=ze,x=58;else{O=E,I=0,R=a[O>>2]|0,O=a[O+4>>2]|0;do R=yu(R,O)|0,O=Ce()|0,ot=E,a[ot>>2]=R,a[ot+4>>2]=O,I=I+1|0;while((I|0)<(x|0));I=ze,x=58}}else if((le|0)!=0&(q|0)!=0){if(x=si(y,m)|0,R=E,R=si(a[R>>2]|0,a[R+4>>2]|0)|0,(x|0)==7|(R|0)==7){I=5;break e}if(R=a[21248+(x*28|0)+(R<<2)>>2]|0,(R|0)<0){I=5;break e}if(!R)x=59;else{U=E,x=0,O=a[U>>2]|0,U=a[U+4>>2]|0;do O=Ws(O,U)|0,U=Ce()|0,ot=E,a[ot>>2]=O,a[ot+4>>2]=U,x=x+1|0;while((x|0)<(R|0));x=58}}else x=58;while(0);if((x|0)==58&&q&&(x=59),(x|0)==59&&(ot=E,(si(a[ot>>2]|0,a[ot+4>>2]|0)|0)==1)){I=9;break}ot=E,ct=a[ot>>2]|0,ot=a[ot+4>>2]&-1040385,st=ue(I|0,0,45)|0,ot=ot|(Ce()|0),I=E,a[I>>2]=ct|st,a[I+4>>2]=ot,I=0}else I=1;while(0);return ot=I,we=Je,ot|0}function Bh(y,m,x,E,I,R){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0,R=R|0;var O=0,U=0;return U=we,we=we+16|0,O=U,I?y=15:(y=qs(y,m,x,E,O)|0,y||(LA(O,R),y=0)),we=U,y|0}function Pc(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0;return O=we,we=we+16|0,R=O,E?x=15:(x=hu(x,R)|0,x||(x=xu(y,m,R,I)|0)),we=O,x|0}function wu(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0;return q=we,we=we+32|0,O=q+12|0,U=q,R=qs(y,m,y,m,O)|0,R|0?(U=R,we=q,U|0):(y=qs(y,m,x,E,U)|0,y|0?(U=y,we=q,U|0):(O=Rl(O,U)|0,U=I,a[U>>2]=O,a[U+4>>2]=((O|0)<0)<<31>>31,U=0,we=q,U|0))}function bu(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0;return q=we,we=we+32|0,O=q+12|0,U=q,R=qs(y,m,y,m,O)|0,!R&&(R=qs(y,m,x,E,U)|0,!R)?(E=Rl(O,U)|0,E=d(E|0,((E|0)<0)<<31>>31|0,1,0)|0,O=Ce()|0,U=I,a[U>>2]=E,a[U+4>>2]=O,U=0,we=q,U|0):(U=R,we=q,U|0)}function Eu(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0,ot=0,et=0,Gt=0,zt=0,gt=0,vt=0;if(gt=we,we=we+48|0,O=gt+24|0,U=gt+12|0,zt=gt,R=qs(y,m,y,m,O)|0,!R&&(R=qs(y,m,x,E,U)|0,!R)){et=Rl(O,U)|0,Gt=((et|0)<0)<<31>>31,a[O>>2]=0,a[O+4>>2]=0,a[O+8>>2]=0,a[U>>2]=0,a[U+4>>2]=0,a[U+8>>2]=0,qs(y,m,y,m,O)|0&&cn(23313,23090,691,23299),qs(y,m,x,E,U)|0&&cn(23313,23090,696,23299),Xo(O),Xo(U),et?(de=a[O>>2]|0,ze=+(et|0),ct=O+4|0,Be=a[ct>>2]|0,st=O+8|0,He=a[st>>2]|0,ot=O,E=de,R=Be,x=He,Je=+((a[U>>2]|0)-de|0)/ze,ft=+((a[U+4>>2]|0)-Be|0)/ze,ze=+((a[U+8>>2]|0)-He|0)/ze):(R=O+4|0,x=O+8|0,ct=R,st=x,ot=O,E=a[O>>2]|0,R=a[R>>2]|0,x=a[x>>2]|0,Je=0,ft=0,ze=0),a[zt>>2]=E,He=zt+4|0,a[He>>2]=R,Be=zt+8|0,a[Be>>2]=x;e:do if((et|0)<0)R=0;else for(le=0,de=0,R=E;;){ee=+(de>>>0)+4294967296*+(le|0),vt=Je*ee+ +(R|0),q=ft*ee+ +(a[ct>>2]|0),ee=ze*ee+ +(a[st>>2]|0),x=~~+ve(+vt),O=~~+ve(+q),R=~~+ve(+ee),vt=+Ie(+(+(x|0)-vt)),q=+Ie(+(+(O|0)-q)),ee=+Ie(+(+(R|0)-ee));do if(vt>q&vt>ee)x=0-(O+R)|0,E=O;else if(U=0-x|0,q>ee){E=U-R|0;break}else{E=O,R=U-O|0;break}while(0);if(a[zt>>2]=x,a[He>>2]=E,a[Be>>2]=R,Xa(zt),R=xu(y,m,zt,I+(de<<3)|0)|0,R|0)break e;if(!((le|0)<(Gt|0)|(le|0)==(Gt|0)&de>>>0<et>>>0)){R=0;break e}R=d(de|0,le|0,1,0)|0,U=Ce()|0,le=U,de=R,R=a[ot>>2]|0}while(0);return zt=R,we=gt,zt|0}return zt=R,we=gt,zt|0}function Zs(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0;if((x|0)==0&(E|0)==0)return I=0,R=1,Mt(I|0),R|0;R=y,I=m,y=1,m=0;do O=(x&1|0)==0&!0,y=V((O?1:R)|0,(O?0:I)|0,y|0,m|0)|0,m=Ce()|0,x=ae(x|0,E|0,1)|0,E=Ce()|0,R=V(R|0,I|0,R|0,I|0)|0,I=Ce()|0;while(!((x|0)==0&(E|0)==0));return Mt(m|0),y|0}function zi(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0;if(!(Au(m,x)|0)||(m=Kn(m)|0,E=+G[x>>3],I=+G[x+8>>3],I=m&I<0?I+6.283185307179586:I,Be=a[y>>2]|0,(Be|0)<=0))return Be=0,Be|0;if(de=a[y+4>>2]|0,m){m=0,le=I,x=-1,y=0;e:for(;;){for(ee=y;O=+G[de+(ee<<4)>>3],I=+G[de+(ee<<4)+8>>3],y=(x+2|0)%(Be|0)|0,R=+G[de+(y<<4)>>3],U=+G[de+(y<<4)+8>>3],O>R?(q=O,O=U):(q=R,R=O,O=I,I=U),E=E==R|E==q?E+2220446049250313e-31:E,!!(E<R|E>q);)if(x=ee+1|0,(x|0)>=(Be|0)){x=22;break e}else y=ee,ee=x,x=y;if(U=O<0?O+6.283185307179586:O,O=I<0?I+6.283185307179586:I,le=U==le|O==le?le+-2220446049250313e-31:le,q=U+(O-U)*((E-R)/(q-R)),(q<0?q+6.283185307179586:q)>le&&(m=m^1),y=ee+1|0,(y|0)>=(Be|0)){x=22;break}else x=ee}if((x|0)==22)return m|0}else{m=0,le=I,x=-1,y=0;e:for(;;){for(ee=y;O=+G[de+(ee<<4)>>3],I=+G[de+(ee<<4)+8>>3],y=(x+2|0)%(Be|0)|0,R=+G[de+(y<<4)>>3],U=+G[de+(y<<4)+8>>3],O>R?(q=O,O=U):(q=R,R=O,O=I,I=U),E=E==R|E==q?E+2220446049250313e-31:E,!!(E<R|E>q);)if(x=ee+1|0,(x|0)>=(Be|0)){x=22;break e}else y=ee,ee=x,x=y;if(le=O==le|I==le?le+-2220446049250313e-31:le,O+(I-O)*((E-R)/(q-R))>le&&(m=m^1),y=ee+1|0,(y|0)>=(Be|0)){x=22;break}else x=ee}if((x|0)==22)return m|0}return 0}function Co(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0;if(ze=a[y>>2]|0,!ze){a[m>>2]=0,a[m+4>>2]=0,a[m+8>>2]=0,a[m+12>>2]=0,a[m+16>>2]=0,a[m+20>>2]=0,a[m+24>>2]=0,a[m+28>>2]=0;return}if(Je=m+8|0,G[Je>>3]=17976931348623157e292,ft=m+24|0,G[ft>>3]=17976931348623157e292,G[m>>3]=-17976931348623157e292,ct=m+16|0,G[ct>>3]=-17976931348623157e292,!((ze|0)<=0)){for(Be=a[y+4>>2]|0,ee=17976931348623157e292,le=-17976931348623157e292,de=0,y=-1,R=17976931348623157e292,O=17976931348623157e292,q=-17976931348623157e292,E=-17976931348623157e292,He=0;x=+G[Be+(He<<4)>>3],U=+G[Be+(He<<4)+8>>3],y=y+2|0,I=+G[Be+(((y|0)==(ze|0)?0:y)<<4)+8>>3],x<R&&(G[Je>>3]=x,R=x),U<O&&(G[ft>>3]=U,O=U),x>q?G[m>>3]=x:x=q,U>E&&(G[ct>>3]=U,E=U),ee=U>0&U<ee?U:ee,le=U<0&U>le?U:le,de=de|+Ie(+(U-I))>3.141592653589793,y=He+1|0,(y|0)!=(ze|0);)st=He,q=x,He=y,y=st;de&&(G[ct>>3]=le,G[ft>>3]=ee)}}function Tu(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0,ot=0,et=0,Gt=0,zt=0,gt=0;if(ze=a[y>>2]|0,ze){if(Je=m+8|0,G[Je>>3]=17976931348623157e292,ft=m+24|0,G[ft>>3]=17976931348623157e292,G[m>>3]=-17976931348623157e292,ct=m+16|0,G[ct>>3]=-17976931348623157e292,(ze|0)>0){for(I=a[y+4>>2]|0,Be=17976931348623157e292,He=-17976931348623157e292,E=0,x=-1,q=17976931348623157e292,ee=17976931348623157e292,de=-17976931348623157e292,O=-17976931348623157e292,st=0;R=+G[I+(st<<4)>>3],le=+G[I+(st<<4)+8>>3],zt=x+2|0,U=+G[I+(((zt|0)==(ze|0)?0:zt)<<4)+8>>3],R<q&&(G[Je>>3]=R,q=R),le<ee&&(G[ft>>3]=le,ee=le),R>de?G[m>>3]=R:R=de,le>O&&(G[ct>>3]=le,O=le),Be=le>0&le<Be?le:Be,He=le<0&le>He?le:He,E=E|+Ie(+(le-U))>3.141592653589793,x=st+1|0,(x|0)!=(ze|0);)zt=st,de=R,st=x,x=zt;E&&(G[ct>>3]=He,G[ft>>3]=Be)}}else a[m>>2]=0,a[m+4>>2]=0,a[m+8>>2]=0,a[m+12>>2]=0,a[m+16>>2]=0,a[m+20>>2]=0,a[m+24>>2]=0,a[m+28>>2]=0;if(zt=y+8|0,x=a[zt>>2]|0,!((x|0)<=0)){Gt=y+12|0,et=0;do if(I=a[Gt>>2]|0,E=et,et=et+1|0,ft=m+(et<<5)|0,ct=a[I+(E<<3)>>2]|0,ct){if(st=m+(et<<5)+8|0,G[st>>3]=17976931348623157e292,y=m+(et<<5)+24|0,G[y>>3]=17976931348623157e292,G[ft>>3]=-17976931348623157e292,ot=m+(et<<5)+16|0,G[ot>>3]=-17976931348623157e292,(ct|0)>0){for(ze=a[I+(E<<3)+4>>2]|0,Be=17976931348623157e292,He=-17976931348623157e292,I=0,E=-1,Je=0,q=17976931348623157e292,ee=17976931348623157e292,le=-17976931348623157e292,O=-17976931348623157e292;R=+G[ze+(Je<<4)>>3],de=+G[ze+(Je<<4)+8>>3],E=E+2|0,U=+G[ze+(((E|0)==(ct|0)?0:E)<<4)+8>>3],R<q&&(G[st>>3]=R,q=R),de<ee&&(G[y>>3]=de,ee=de),R>le?G[ft>>3]=R:R=le,de>O&&(G[ot>>3]=de,O=de),Be=de>0&de<Be?de:Be,He=de<0&de>He?de:He,I=I|+Ie(+(de-U))>3.141592653589793,E=Je+1|0,(E|0)!=(ct|0);)gt=Je,Je=E,le=R,E=gt;I&&(G[ot>>3]=He,G[y>>3]=Be)}}else a[ft>>2]=0,a[ft+4>>2]=0,a[ft+8>>2]=0,a[ft+12>>2]=0,a[ft+16>>2]=0,a[ft+20>>2]=0,a[ft+24>>2]=0,a[ft+28>>2]=0,x=a[zt>>2]|0;while((et|0)<(x|0))}}function Sa(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;if(!(zi(y,m,x)|0))return I=0,I|0;if(I=y+8|0,(a[I>>2]|0)<=0)return I=1,I|0;for(E=y+12|0,y=0;;){if(R=y,y=y+1|0,zi((a[E>>2]|0)+(R<<3)|0,m+(y<<5)|0,x)|0){y=0,E=6;break}if((y|0)>=(a[I>>2]|0)){y=1,E=6;break}}return(E|0)==6?y|0:0}function Ur(){return 8}function jl(){return 16}function kc(){return 168}function gs(){return 8}function Pr(){return 16}function ol(){return 12}function Hl(){return 8}function Su(y){return y=y|0,+(+((a[y>>2]|0)>>>0)+4294967296*+(a[y+4>>2]|0))}function Ic(y){y=y|0;var m=0,x=0;return x=+G[y>>3],m=+G[y+8>>3],+ +qe(+(x*x+m*m))}function Cu(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0;ee=+G[y>>3],q=+G[m>>3]-ee,U=+G[y+8>>3],O=+G[m+8>>3]-U,de=+G[x>>3],R=+G[E>>3]-de,Be=+G[x+8>>3],le=+G[E+8>>3]-Be,R=(R*(U-Be)-(ee-de)*le)/(q*le-O*R),G[I>>3]=ee+q*R,G[I+8>>3]=U+O*R}function Lc(y,m){return y=y|0,m=m|0,+Ie(+(+G[y>>3]-+G[m>>3]))<11920928955078125e-23?(m=+Ie(+(+G[y+8>>3]-+G[m+8>>3]))<11920928955078125e-23,m|0):(m=0,m|0)}function xr(y,m){y=y|0,m=m|0;var x=0,E=0,I=0;return I=+G[y>>3]-+G[m>>3],E=+G[y+8>>3]-+G[m+8>>3],x=+G[y+16>>3]-+G[m+16>>3],+(I*I+E*E+x*x)}function Wl(y,m){y=y|0,m=m|0;var x=0,E=0,I=0;x=+G[y>>3],E=+Qe(+x),x=+dt(+x),G[m+16>>3]=x,x=+G[y+8>>3],I=E*+Qe(+x),G[m>>3]=I,x=E*+dt(+x),G[m+8>>3]=x}function Xt(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;if(R=we,we=we+16|0,I=R,E=vr(y,m)|0,(x+-1|0)>>>0>5||(E=(E|0)!=0,(x|0)==1&E))return I=-1,we=R,I|0;do if(Kt(y,m,I)|0)E=-1;else if(E){E=((a[21936+(x<<2)>>2]|0)+5-(a[I>>2]|0)|0)%5|0;break}else{E=((a[21968+(x<<2)>>2]|0)+6-(a[I>>2]|0)|0)%6|0;break}while(0);return I=E,we=R,I|0}function Kt(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0;if(ee=we,we=we+32|0,O=ee+16|0,U=ee,E=Ki(y,m,O)|0,E|0)return x=E,we=ee,x|0;R=Ja(y,m)|0,q=si(y,m)|0,au(R,U),E=lu(R,a[O>>2]|0)|0;e:do if(jn(R)|0){do switch(R|0){case 4:{y=0;break}case 14:{y=1;break}case 24:{y=2;break}case 38:{y=3;break}case 49:{y=4;break}case 58:{y=5;break}case 63:{y=6;break}case 72:{y=7;break}case 83:{y=8;break}case 97:{y=9;break}case 107:{y=10;break}case 117:{y=11;break}default:{E=1;break e}}while(0);if(I=a[22e3+(y*24|0)+8>>2]|0,m=a[22e3+(y*24|0)+16>>2]|0,y=a[O>>2]|0,(y|0)!=(a[U>>2]|0)&&(U=TA(R)|0,y=a[O>>2]|0,U|(y|0)==(m|0)&&(E=(E+1|0)%6|0)),(q|0)==3&(y|0)==(m|0)){E=(E+5|0)%6|0,I=22;break}(q|0)==5&(y|0)==(I|0)&&(E=(E+1|0)%6|0),I=22}else I=22;while(0);return(I|0)==22&&(a[x>>2]=E,E=0),x=E,we=ee,x|0}function fn(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0,ot=0;if(ot=we,we=we+32|0,st=ot+24|0,ft=ot+20|0,ze=ot+8|0,He=ot+16|0,Be=ot,q=(vr(y,m)|0)==0,q=q?6:5,le=ne(y|0,m|0,52)|0,Ce()|0,le=le&15,q>>>0<=x>>>0)return E=2,we=ot,E|0;de=(le|0)==0,!de&&(Je=ue(7,0,(le^15)*3|0)|0,(Je&y|0)==0&((Ce()|0)&m|0)==0)?I=x:R=4;e:do if((R|0)==4){if(I=(vr(y,m)|0)!=0,((I?4:5)|0)<(x|0)||Kt(y,m,st)|0||(R=(a[st>>2]|0)+x|0,I?I=22288+(((R|0)%5|0)<<2)|0:I=22320+(((R|0)%6|0)<<2)|0,Je=a[I>>2]|0,(Je|0)==7))return E=1,we=ot,E|0;a[ft>>2]=0,I=Ue(y,m,Je,ft,ze)|0;do if(!I){if(U=ze,ee=a[U>>2]|0,U=a[U+4>>2]|0,O=U>>>0<m>>>0|(U|0)==(m|0)&ee>>>0<y>>>0,R=O?ee:y,O=O?U:m,!de&&(de=ue(7,0,(le^15)*3|0)|0,(ee&de|0)==0&(U&(Ce()|0)|0)==0))I=x;else{if(U=(x+-1+q|0)%(q|0)|0,I=vr(y,m)|0,(U|0)<0&&cn(23313,23315,245,23324),q=(I|0)!=0,((q?4:5)|0)<(U|0)&&cn(23313,23315,245,23324),Kt(y,m,st)|0&&cn(23313,23315,245,23324),I=(a[st>>2]|0)+U|0,q?I=22288+(((I|0)%5|0)<<2)|0:I=22320+(((I|0)%6|0)<<2)|0,U=a[I>>2]|0,(U|0)==7&&cn(23313,23315,245,23324),a[He>>2]=0,I=Ue(y,m,U,He,Be)|0,I|0)break;ee=Be,q=a[ee>>2]|0,ee=a[ee+4>>2]|0;do if(ee>>>0<O>>>0|(ee|0)==(O|0)&q>>>0<R>>>0){if(vr(q,ee)|0?R=lt(q,ee,y,m)|0:R=a[22384+((((a[He>>2]|0)+(a[22352+(U<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,I=vr(q,ee)|0,(R+-1|0)>>>0>5){I=-1,R=q,O=ee;break}if(I=(I|0)!=0,(R|0)==1&I){I=-1,R=q,O=ee;break}do if(Kt(q,ee,st)|0)I=-1;else if(I){I=((a[21936+(R<<2)>>2]|0)+5-(a[st>>2]|0)|0)%5|0;break}else{I=((a[21968+(R<<2)>>2]|0)+6-(a[st>>2]|0)|0)%6|0;break}while(0);R=q,O=ee}else I=x;while(0);U=ze,ee=a[U>>2]|0,U=a[U+4>>2]|0}if((R|0)==(ee|0)&(O|0)==(U|0)){if(q=(vr(ee,U)|0)!=0,q?y=lt(ee,U,y,m)|0:y=a[22384+((((a[ft>>2]|0)+(a[22352+(Je<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,I=vr(ee,U)|0,(y+-1|0)>>>0<=5&&(ct=(I|0)!=0,!((y|0)==1&ct)))do if(Kt(ee,U,st)|0)I=-1;else if(ct){I=((a[21936+(y<<2)>>2]|0)+5-(a[st>>2]|0)|0)%5|0;break}else{I=((a[21968+(y<<2)>>2]|0)+6-(a[st>>2]|0)|0)%6|0;break}while(0);else I=-1;I=I+1|0,I=(I|0)==6|q&(I|0)==5?0:I}m=O,y=R;break e}while(0);return E=I,we=ot,E|0}while(0);return ct=ue(I|0,0,56)|0,st=Ce()|0|m&-2130706433|536870912,a[E>>2]=ct|y,a[E+4>>2]=st,E=0,we=ot,E|0}function es(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;return R=(vr(y,m)|0)==0,E=fn(y,m,0,x)|0,I=(E|0)==0,R?!I||(E=fn(y,m,1,x+8|0)|0,E|0)||(E=fn(y,m,2,x+16|0)|0,E|0)||(E=fn(y,m,3,x+24|0)|0,E|0)||(E=fn(y,m,4,x+32|0)|0,E)?(R=E,R|0):fn(y,m,5,x+40|0)|0:!I||(E=fn(y,m,1,x+8|0)|0,E|0)||(E=fn(y,m,2,x+16|0)|0,E|0)||(E=fn(y,m,3,x+24|0)|0,E|0)||(E=fn(y,m,4,x+32|0)|0,E|0)?(R=E,R|0):(R=x+40|0,a[R>>2]=0,a[R+4>>2]=0,R=0,R|0)}function ta(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0;return q=we,we=we+192|0,I=q,R=q+168|0,O=ne(y|0,m|0,56)|0,Ce()|0,O=O&7,U=m&-2130706433|134217728,E=Ki(y,U,R)|0,E|0?(U=E,we=q,U|0):(m=ne(y|0,m|0,52)|0,Ce()|0,m=m&15,vr(y,U)|0?Ko(R,m,O,1,I):gu(R,m,O,1,I),U=I+8|0,a[x>>2]=a[U>>2],a[x+4>>2]=a[U+4>>2],a[x+8>>2]=a[U+8>>2],a[x+12>>2]=a[U+12>>2],U=0,we=q,U|0)}function jr(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0;return I=we,we=we+16|0,x=I,!(!0&(m&2013265920|0)==536870912)||(E=m&-2130706433|134217728,!(xa(y,E)|0))?(E=0,we=I,E|0):(R=ne(y|0,m|0,56)|0,Ce()|0,R=(fn(y,E,R&7,x)|0)==0,E=x,E=R&((a[E>>2]|0)==(y|0)?(a[E+4>>2]|0)==(m|0):0)&1,we=I,E|0)}function Ys(y,m,x){y=y|0,m=m|0,x=x|0;var E=0;(m|0)>0?(E=h(m,4)|0,a[y>>2]=E,E||cn(23337,23360,40,23374)):a[y>>2]=0,a[y+4>>2]=m,a[y+8>>2]=0,a[y+12>>2]=x}function ks(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;I=y+4|0,R=y+12|0,O=y+8|0;e:for(;;){for(x=a[I>>2]|0,m=0;;){if((m|0)>=(x|0))break e;if(E=a[y>>2]|0,U=a[E+(m<<2)>>2]|0,!U)m=m+1|0;else break}m=E+(~~(+Ie(+(+At(10,+ +(15-(a[R>>2]|0)|0))*(+G[U>>3]+ +G[U+8>>3])))%+(x|0))>>>0<<2)|0,x=a[m>>2]|0;t:do if(x|0){if(E=U+32|0,(x|0)==(U|0))a[m>>2]=a[E>>2];else{if(x=x+32|0,m=a[x>>2]|0,!m)break;for(;(m|0)!=(U|0);)if(x=m+32|0,m=a[x>>2]|0,!m)break t;a[x>>2]=a[E>>2]}A(U),a[O>>2]=(a[O>>2]|0)+-1}while(0)}A(a[y>>2]|0)}function Xs(y){y=y|0;var m=0,x=0,E=0;for(E=a[y+4>>2]|0,x=0;;){if((x|0)>=(E|0)){m=0,x=4;break}if(m=a[(a[y>>2]|0)+(x<<2)>>2]|0,!m)x=x+1|0;else{x=4;break}}return(x|0)==4?m|0:0}function Ct(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0;if(x=~~(+Ie(+(+At(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,x=(a[y>>2]|0)+(x<<2)|0,E=a[x>>2]|0,!E)return R=1,R|0;R=m+32|0;do if((E|0)!=(m|0)){if(x=a[E+32>>2]|0,!x)return R=1,R|0;for(I=x;;){if((I|0)==(m|0)){I=8;break}if(x=a[I+32>>2]|0,x)E=I,I=x;else{x=1,I=10;break}}if((I|0)==8){a[E+32>>2]=a[R>>2];break}else if((I|0)==10)return x|0}else a[x>>2]=a[R>>2];while(0);return A(m),R=y+8|0,a[R>>2]=(a[R>>2]|0)+-1,R=0,R|0}function Pt(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0;R=v(40)|0,R||cn(23390,23360,98,23403),a[R>>2]=a[m>>2],a[R+4>>2]=a[m+4>>2],a[R+8>>2]=a[m+8>>2],a[R+12>>2]=a[m+12>>2],I=R+16|0,a[I>>2]=a[x>>2],a[I+4>>2]=a[x+4>>2],a[I+8>>2]=a[x+8>>2],a[I+12>>2]=a[x+12>>2],a[R+32>>2]=0,I=~~(+Ie(+(+At(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,I=(a[y>>2]|0)+(I<<2)|0,E=a[I>>2]|0;do if(!E)a[I>>2]=R;else{for(;!(Ps(E,m)|0&&Ps(E+16|0,x)|0);)if(I=a[E+32>>2]|0,E=I|0?I:E,!(a[E+32>>2]|0)){O=10;break}if((O|0)==10){a[E+32>>2]=R;break}return A(R),O=E,O|0}while(0);return O=y+8|0,a[O>>2]=(a[O>>2]|0)+1,O=R,O|0}function Hr(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0;if(I=~~(+Ie(+(+At(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,I=a[(a[y>>2]|0)+(I<<2)>>2]|0,!I)return x=0,x|0;if(!x){for(y=I;;){if(Ps(y,m)|0){E=10;break}if(y=a[y+32>>2]|0,!y){y=0,E=10;break}}if((E|0)==10)return y|0}for(y=I;;){if(Ps(y,m)|0&&Ps(y+16|0,x)|0){E=10;break}if(y=a[y+32>>2]|0,!y){y=0,E=10;break}}return(E|0)==10?y|0:0}function al(y,m){y=y|0,m=m|0;var x=0;if(x=~~(+Ie(+(+At(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,y=a[(a[y>>2]|0)+(x<<2)>>2]|0,!y)return x=0,x|0;for(;;){if(Ps(y,m)|0){m=5;break}if(y=a[y+32>>2]|0,!y){y=0,m=5;break}}return(m|0)==5?y|0:0}function Ks(){return 23424}function L(y){return y=+y,+ +$e(+y)}function c(y){return y=+y,~~+L(y)|0}function v(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0,Je=0,ft=0,ct=0,st=0,ot=0,et=0,Gt=0;Gt=we,we=we+16|0,Be=Gt;do if(y>>>0<245){if(ee=y>>>0<11?16:y+11&-8,y=ee>>>3,de=a[5857]|0,x=de>>>y,x&3|0)return m=(x&1^1)+y|0,y=23468+(m<<1<<2)|0,x=y+8|0,E=a[x>>2]|0,I=E+8|0,R=a[I>>2]|0,(R|0)==(y|0)?a[5857]=de&~(1<<m):(a[R+12>>2]=y,a[x>>2]=R),et=m<<3,a[E+4>>2]=et|3,et=E+et+4|0,a[et>>2]=a[et>>2]|1,et=I,we=Gt,et|0;if(le=a[5859]|0,ee>>>0>le>>>0){if(x|0)return m=2<<y,m=x<<y&(m|0-m),m=(m&0-m)+-1|0,U=m>>>12&16,m=m>>>U,x=m>>>5&8,m=m>>>x,R=m>>>2&4,m=m>>>R,y=m>>>1&2,m=m>>>y,E=m>>>1&1,E=(x|U|R|y|E)+(m>>>E)|0,m=23468+(E<<1<<2)|0,y=m+8|0,R=a[y>>2]|0,U=R+8|0,x=a[U>>2]|0,(x|0)==(m|0)?(y=de&~(1<<E),a[5857]=y):(a[x+12>>2]=m,a[y>>2]=x,y=de),et=E<<3,O=et-ee|0,a[R+4>>2]=ee|3,I=R+ee|0,a[I+4>>2]=O|1,a[R+et>>2]=O,le|0&&(E=a[5862]|0,m=le>>>3,x=23468+(m<<1<<2)|0,m=1<<m,y&m?(y=x+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=x,y=x+8|0),a[y>>2]=E,a[m+12>>2]=E,a[E+8>>2]=m,a[E+12>>2]=x),a[5859]=O,a[5862]=I,et=U,we=Gt,et|0;if(R=a[5858]|0,R){for(x=(R&0-R)+-1|0,I=x>>>12&16,x=x>>>I,E=x>>>5&8,x=x>>>E,O=x>>>2&4,x=x>>>O,U=x>>>1&2,x=x>>>U,q=x>>>1&1,q=a[23732+((E|I|O|U|q)+(x>>>q)<<2)>>2]|0,x=q,U=q,q=(a[q+4>>2]&-8)-ee|0;y=a[x+16>>2]|0,!(!y&&(y=a[x+20>>2]|0,!y));)O=(a[y+4>>2]&-8)-ee|0,I=O>>>0<q>>>0,x=y,U=I?y:U,q=I?O:q;if(O=U+ee|0,O>>>0>U>>>0){I=a[U+24>>2]|0,m=a[U+12>>2]|0;do if((m|0)==(U|0)){if(y=U+20|0,m=a[y>>2]|0,!m&&(y=U+16|0,m=a[y>>2]|0,!m)){x=0;break}for(;;)if(E=m+20|0,x=a[E>>2]|0,x)m=x,y=E;else if(E=m+16|0,x=a[E>>2]|0,x)m=x,y=E;else break;a[y>>2]=0,x=m}else x=a[U+8>>2]|0,a[x+12>>2]=m,a[m+8>>2]=x,x=m;while(0);do if(I|0){if(m=a[U+28>>2]|0,y=23732+(m<<2)|0,(U|0)==(a[y>>2]|0)){if(a[y>>2]=x,!x){a[5858]=R&~(1<<m);break}}else if(et=I+16|0,a[((a[et>>2]|0)==(U|0)?et:I+20|0)>>2]=x,!x)break;a[x+24>>2]=I,m=a[U+16>>2]|0,m|0&&(a[x+16>>2]=m,a[m+24>>2]=x),m=a[U+20>>2]|0,m|0&&(a[x+20>>2]=m,a[m+24>>2]=x)}while(0);return q>>>0<16?(et=q+ee|0,a[U+4>>2]=et|3,et=U+et+4|0,a[et>>2]=a[et>>2]|1):(a[U+4>>2]=ee|3,a[O+4>>2]=q|1,a[O+q>>2]=q,le|0&&(E=a[5862]|0,m=le>>>3,x=23468+(m<<1<<2)|0,m=1<<m,m&de?(y=x+8|0,m=a[y>>2]|0):(a[5857]=m|de,m=x,y=x+8|0),a[y>>2]=E,a[m+12>>2]=E,a[E+8>>2]=m,a[E+12>>2]=x),a[5859]=q,a[5862]=O),et=U+8|0,we=Gt,et|0}else de=ee}else de=ee}else de=ee}else if(y>>>0<=4294967231)if(y=y+11|0,ee=y&-8,E=a[5858]|0,E){I=0-ee|0,y=y>>>8,y?ee>>>0>16777215?q=31:(de=(y+1048320|0)>>>16&8,Je=y<<de,U=(Je+520192|0)>>>16&4,Je=Je<<U,q=(Je+245760|0)>>>16&2,q=14-(U|de|q)+(Je<<q>>>15)|0,q=ee>>>(q+7|0)&1|q<<1):q=0,x=a[23732+(q<<2)>>2]|0;e:do if(!x)x=0,y=0,Je=61;else for(y=0,U=ee<<((q|0)==31?0:25-(q>>>1)|0),R=0;;){if(O=(a[x+4>>2]&-8)-ee|0,O>>>0<I>>>0)if(O)y=x,I=O;else{y=x,I=0,Je=65;break e}if(Je=a[x+20>>2]|0,x=a[x+16+(U>>>31<<2)>>2]|0,R=(Je|0)==0|(Je|0)==(x|0)?R:Je,x)U=U<<1;else{x=R,Je=61;break}}while(0);if((Je|0)==61){if((x|0)==0&(y|0)==0){if(y=2<<q,y=(y|0-y)&E,!y){de=ee;break}de=(y&0-y)+-1|0,O=de>>>12&16,de=de>>>O,R=de>>>5&8,de=de>>>R,U=de>>>2&4,de=de>>>U,q=de>>>1&2,de=de>>>q,x=de>>>1&1,y=0,x=a[23732+((R|O|U|q|x)+(de>>>x)<<2)>>2]|0}x?Je=65:(U=y,O=I)}if((Je|0)==65)for(R=x;;)if(de=(a[R+4>>2]&-8)-ee|0,x=de>>>0<I>>>0,I=x?de:I,y=x?R:y,x=a[R+16>>2]|0,x||(x=a[R+20>>2]|0),x)R=x;else{U=y,O=I;break}if(U|0&&O>>>0<((a[5859]|0)-ee|0)>>>0&&(le=U+ee|0,le>>>0>U>>>0)){R=a[U+24>>2]|0,m=a[U+12>>2]|0;do if((m|0)==(U|0)){if(y=U+20|0,m=a[y>>2]|0,!m&&(y=U+16|0,m=a[y>>2]|0,!m)){m=0;break}for(;;)if(I=m+20|0,x=a[I>>2]|0,x)m=x,y=I;else if(I=m+16|0,x=a[I>>2]|0,x)m=x,y=I;else break;a[y>>2]=0}else et=a[U+8>>2]|0,a[et+12>>2]=m,a[m+8>>2]=et;while(0);do if(R){if(y=a[U+28>>2]|0,x=23732+(y<<2)|0,(U|0)==(a[x>>2]|0)){if(a[x>>2]=m,!m){E=E&~(1<<y),a[5858]=E;break}}else if(et=R+16|0,a[((a[et>>2]|0)==(U|0)?et:R+20|0)>>2]=m,!m)break;a[m+24>>2]=R,y=a[U+16>>2]|0,y|0&&(a[m+16>>2]=y,a[y+24>>2]=m),y=a[U+20>>2]|0,y&&(a[m+20>>2]=y,a[y+24>>2]=m)}while(0);e:do if(O>>>0<16)et=O+ee|0,a[U+4>>2]=et|3,et=U+et+4|0,a[et>>2]=a[et>>2]|1;else{if(a[U+4>>2]=ee|3,a[le+4>>2]=O|1,a[le+O>>2]=O,m=O>>>3,O>>>0<256){x=23468+(m<<1<<2)|0,y=a[5857]|0,m=1<<m,y&m?(y=x+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=x,y=x+8|0),a[y>>2]=le,a[m+12>>2]=le,a[le+8>>2]=m,a[le+12>>2]=x;break}if(m=O>>>8,m?O>>>0>16777215?x=31:(ot=(m+1048320|0)>>>16&8,et=m<<ot,st=(et+520192|0)>>>16&4,et=et<<st,x=(et+245760|0)>>>16&2,x=14-(st|ot|x)+(et<<x>>>15)|0,x=O>>>(x+7|0)&1|x<<1):x=0,m=23732+(x<<2)|0,a[le+28>>2]=x,y=le+16|0,a[y+4>>2]=0,a[y>>2]=0,y=1<<x,!(E&y)){a[5858]=E|y,a[m>>2]=le,a[le+24>>2]=m,a[le+12>>2]=le,a[le+8>>2]=le;break}m=a[m>>2]|0;t:do if((a[m+4>>2]&-8|0)!=(O|0)){for(E=O<<((x|0)==31?0:25-(x>>>1)|0);x=m+16+(E>>>31<<2)|0,y=a[x>>2]|0,!!y;)if((a[y+4>>2]&-8|0)==(O|0)){m=y;break t}else E=E<<1,m=y;a[x>>2]=le,a[le+24>>2]=m,a[le+12>>2]=le,a[le+8>>2]=le;break e}while(0);ot=m+8|0,et=a[ot>>2]|0,a[et+12>>2]=le,a[ot>>2]=le,a[le+8>>2]=et,a[le+12>>2]=m,a[le+24>>2]=0}while(0);return et=U+8|0,we=Gt,et|0}else de=ee}else de=ee;else de=-1;while(0);if(x=a[5859]|0,x>>>0>=de>>>0)return m=x-de|0,y=a[5862]|0,m>>>0>15?(et=y+de|0,a[5862]=et,a[5859]=m,a[et+4>>2]=m|1,a[y+x>>2]=m,a[y+4>>2]=de|3):(a[5859]=0,a[5862]=0,a[y+4>>2]=x|3,et=y+x+4|0,a[et>>2]=a[et>>2]|1),et=y+8|0,we=Gt,et|0;if(O=a[5860]|0,O>>>0>de>>>0)return st=O-de|0,a[5860]=st,et=a[5863]|0,ot=et+de|0,a[5863]=ot,a[ot+4>>2]=st|1,a[et+4>>2]=de|3,et=et+8|0,we=Gt,et|0;if(a[5975]|0?y=a[5977]|0:(a[5977]=4096,a[5976]=4096,a[5978]=-1,a[5979]=-1,a[5980]=0,a[5968]=0,a[5975]=Be&-16^1431655768,y=4096),U=de+48|0,q=de+47|0,R=y+q|0,I=0-y|0,ee=R&I,ee>>>0<=de>>>0||(y=a[5967]|0,y|0&&(le=a[5965]|0,Be=le+ee|0,Be>>>0<=le>>>0|Be>>>0>y>>>0)))return et=0,we=Gt,et|0;e:do if(a[5968]&4)m=0,Je=143;else{x=a[5863]|0;t:do if(x){for(E=23876;Be=a[E>>2]|0,!(Be>>>0<=x>>>0&&(Be+(a[E+4>>2]|0)|0)>>>0>x>>>0);)if(y=a[E+8>>2]|0,y)E=y;else{Je=128;break t}if(m=R-O&I,m>>>0<2147483647)if(y=xe(m|0)|0,(y|0)==((a[E>>2]|0)+(a[E+4>>2]|0)|0)){if((y|0)!=-1){O=m,R=y,Je=145;break e}}else E=y,Je=136;else m=0}else Je=128;while(0);do if((Je|0)==128)if(x=xe(0)|0,(x|0)!=-1&&(m=x,He=a[5976]|0,ze=He+-1|0,m=(ze&m|0?(ze+m&0-He)-m|0:0)+ee|0,He=a[5965]|0,ze=m+He|0,m>>>0>de>>>0&m>>>0<2147483647)){if(Be=a[5967]|0,Be|0&&ze>>>0<=He>>>0|ze>>>0>Be>>>0){m=0;break}if(y=xe(m|0)|0,(y|0)==(x|0)){O=m,R=x,Je=145;break e}else E=y,Je=136}else m=0;while(0);do if((Je|0)==136){if(x=0-m|0,!(U>>>0>m>>>0&(m>>>0<2147483647&(E|0)!=-1)))if((E|0)==-1){m=0;break}else{O=m,R=E,Je=145;break e}if(y=a[5977]|0,y=q-m+y&0-y,y>>>0>=2147483647){O=m,R=E,Je=145;break e}if((xe(y|0)|0)==-1){xe(x|0)|0,m=0;break}else{O=y+m|0,R=E,Je=145;break e}}while(0);a[5968]=a[5968]|4,Je=143}while(0);if((Je|0)==143&&ee>>>0<2147483647&&(st=xe(ee|0)|0,ze=xe(0)|0,ft=ze-st|0,ct=ft>>>0>(de+40|0)>>>0,!((st|0)==-1|ct^1|st>>>0<ze>>>0&((st|0)!=-1&(ze|0)!=-1)^1))&&(O=ct?ft:m,R=st,Je=145),(Je|0)==145){m=(a[5965]|0)+O|0,a[5965]=m,m>>>0>(a[5966]|0)>>>0&&(a[5966]=m),q=a[5863]|0;e:do if(q){for(m=23876;;){if(y=a[m>>2]|0,x=a[m+4>>2]|0,(R|0)==(y+x|0)){Je=154;break}if(E=a[m+8>>2]|0,E)m=E;else break}if((Je|0)==154&&(ot=m+4|0,(a[m+12>>2]&8|0)==0)&&R>>>0>q>>>0&y>>>0<=q>>>0){a[ot>>2]=x+O,et=(a[5860]|0)+O|0,st=q+8|0,st=st&7|0?0-st&7:0,ot=q+st|0,st=et-st|0,a[5863]=ot,a[5860]=st,a[ot+4>>2]=st|1,a[q+et+4>>2]=40,a[5864]=a[5979];break}for(R>>>0<(a[5861]|0)>>>0&&(a[5861]=R),x=R+O|0,m=23876;;){if((a[m>>2]|0)==(x|0)){Je=162;break}if(y=a[m+8>>2]|0,y)m=y;else break}if((Je|0)==162&&!(a[m+12>>2]&8|0)){a[m>>2]=R,le=m+4|0,a[le>>2]=(a[le>>2]|0)+O,le=R+8|0,le=R+(le&7|0?0-le&7:0)|0,m=x+8|0,m=x+(m&7|0?0-m&7:0)|0,ee=le+de|0,U=m-le-de|0,a[le+4>>2]=de|3;t:do if((q|0)==(m|0))et=(a[5860]|0)+U|0,a[5860]=et,a[5863]=ee,a[ee+4>>2]=et|1;else{if((a[5862]|0)==(m|0)){et=(a[5859]|0)+U|0,a[5859]=et,a[5862]=ee,a[ee+4>>2]=et|1,a[ee+et>>2]=et;break}if(y=a[m+4>>2]|0,(y&3|0)==1){O=y&-8,E=y>>>3;n:do if(y>>>0<256)if(y=a[m+8>>2]|0,x=a[m+12>>2]|0,(x|0)==(y|0)){a[5857]=a[5857]&~(1<<E);break}else{a[y+12>>2]=x,a[x+8>>2]=y;break}else{R=a[m+24>>2]|0,y=a[m+12>>2]|0;do if((y|0)==(m|0)){if(x=m+16|0,E=x+4|0,y=a[E>>2]|0,y)x=E;else if(y=a[x>>2]|0,!y){y=0;break}for(;;)if(I=y+20|0,E=a[I>>2]|0,E)y=E,x=I;else if(I=y+16|0,E=a[I>>2]|0,E)y=E,x=I;else break;a[x>>2]=0}else et=a[m+8>>2]|0,a[et+12>>2]=y,a[y+8>>2]=et;while(0);if(!R)break;x=a[m+28>>2]|0,E=23732+(x<<2)|0;do if((a[E>>2]|0)!=(m|0)){if(et=R+16|0,a[((a[et>>2]|0)==(m|0)?et:R+20|0)>>2]=y,!y)break n}else{if(a[E>>2]=y,y|0)break;a[5858]=a[5858]&~(1<<x);break n}while(0);if(a[y+24>>2]=R,x=m+16|0,E=a[x>>2]|0,E|0&&(a[y+16>>2]=E,a[E+24>>2]=y),x=a[x+4>>2]|0,!x)break;a[y+20>>2]=x,a[x+24>>2]=y}while(0);m=m+O|0,I=O+U|0}else I=U;if(m=m+4|0,a[m>>2]=a[m>>2]&-2,a[ee+4>>2]=I|1,a[ee+I>>2]=I,m=I>>>3,I>>>0<256){x=23468+(m<<1<<2)|0,y=a[5857]|0,m=1<<m,y&m?(y=x+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=x,y=x+8|0),a[y>>2]=ee,a[m+12>>2]=ee,a[ee+8>>2]=m,a[ee+12>>2]=x;break}m=I>>>8;do if(!m)E=0;else{if(I>>>0>16777215){E=31;break}ot=(m+1048320|0)>>>16&8,et=m<<ot,st=(et+520192|0)>>>16&4,et=et<<st,E=(et+245760|0)>>>16&2,E=14-(st|ot|E)+(et<<E>>>15)|0,E=I>>>(E+7|0)&1|E<<1}while(0);if(m=23732+(E<<2)|0,a[ee+28>>2]=E,y=ee+16|0,a[y+4>>2]=0,a[y>>2]=0,y=a[5858]|0,x=1<<E,!(y&x)){a[5858]=y|x,a[m>>2]=ee,a[ee+24>>2]=m,a[ee+12>>2]=ee,a[ee+8>>2]=ee;break}m=a[m>>2]|0;n:do if((a[m+4>>2]&-8|0)!=(I|0)){for(E=I<<((E|0)==31?0:25-(E>>>1)|0);x=m+16+(E>>>31<<2)|0,y=a[x>>2]|0,!!y;)if((a[y+4>>2]&-8|0)==(I|0)){m=y;break n}else E=E<<1,m=y;a[x>>2]=ee,a[ee+24>>2]=m,a[ee+12>>2]=ee,a[ee+8>>2]=ee;break t}while(0);ot=m+8|0,et=a[ot>>2]|0,a[et+12>>2]=ee,a[ot>>2]=ee,a[ee+8>>2]=et,a[ee+12>>2]=m,a[ee+24>>2]=0}while(0);return et=le+8|0,we=Gt,et|0}for(m=23876;y=a[m>>2]|0,!(y>>>0<=q>>>0&&(et=y+(a[m+4>>2]|0)|0,et>>>0>q>>>0));)m=a[m+8>>2]|0;I=et+-47|0,y=I+8|0,y=I+(y&7|0?0-y&7:0)|0,I=q+16|0,y=y>>>0<I>>>0?q:y,m=y+8|0,x=O+-40|0,st=R+8|0,st=st&7|0?0-st&7:0,ot=R+st|0,st=x-st|0,a[5863]=ot,a[5860]=st,a[ot+4>>2]=st|1,a[R+x+4>>2]=40,a[5864]=a[5979],x=y+4|0,a[x>>2]=27,a[m>>2]=a[5969],a[m+4>>2]=a[5970],a[m+8>>2]=a[5971],a[m+12>>2]=a[5972],a[5969]=R,a[5970]=O,a[5972]=0,a[5971]=m,m=y+24|0;do ot=m,m=m+4|0,a[m>>2]=7;while((ot+8|0)>>>0<et>>>0);if((y|0)!=(q|0)){if(R=y-q|0,a[x>>2]=a[x>>2]&-2,a[q+4>>2]=R|1,a[y>>2]=R,m=R>>>3,R>>>0<256){x=23468+(m<<1<<2)|0,y=a[5857]|0,m=1<<m,y&m?(y=x+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=x,y=x+8|0),a[y>>2]=q,a[m+12>>2]=q,a[q+8>>2]=m,a[q+12>>2]=x;break}if(m=R>>>8,m?R>>>0>16777215?E=31:(ot=(m+1048320|0)>>>16&8,et=m<<ot,st=(et+520192|0)>>>16&4,et=et<<st,E=(et+245760|0)>>>16&2,E=14-(st|ot|E)+(et<<E>>>15)|0,E=R>>>(E+7|0)&1|E<<1):E=0,x=23732+(E<<2)|0,a[q+28>>2]=E,a[q+20>>2]=0,a[I>>2]=0,m=a[5858]|0,y=1<<E,!(m&y)){a[5858]=m|y,a[x>>2]=q,a[q+24>>2]=x,a[q+12>>2]=q,a[q+8>>2]=q;break}m=a[x>>2]|0;t:do if((a[m+4>>2]&-8|0)!=(R|0)){for(E=R<<((E|0)==31?0:25-(E>>>1)|0);x=m+16+(E>>>31<<2)|0,y=a[x>>2]|0,!!y;)if((a[y+4>>2]&-8|0)==(R|0)){m=y;break t}else E=E<<1,m=y;a[x>>2]=q,a[q+24>>2]=m,a[q+12>>2]=q,a[q+8>>2]=q;break e}while(0);ot=m+8|0,et=a[ot>>2]|0,a[et+12>>2]=q,a[ot>>2]=q,a[q+8>>2]=et,a[q+12>>2]=m,a[q+24>>2]=0}}else et=a[5861]|0,(et|0)==0|R>>>0<et>>>0&&(a[5861]=R),a[5969]=R,a[5970]=O,a[5972]=0,a[5866]=a[5975],a[5865]=-1,a[5870]=23468,a[5869]=23468,a[5872]=23476,a[5871]=23476,a[5874]=23484,a[5873]=23484,a[5876]=23492,a[5875]=23492,a[5878]=23500,a[5877]=23500,a[5880]=23508,a[5879]=23508,a[5882]=23516,a[5881]=23516,a[5884]=23524,a[5883]=23524,a[5886]=23532,a[5885]=23532,a[5888]=23540,a[5887]=23540,a[5890]=23548,a[5889]=23548,a[5892]=23556,a[5891]=23556,a[5894]=23564,a[5893]=23564,a[5896]=23572,a[5895]=23572,a[5898]=23580,a[5897]=23580,a[5900]=23588,a[5899]=23588,a[5902]=23596,a[5901]=23596,a[5904]=23604,a[5903]=23604,a[5906]=23612,a[5905]=23612,a[5908]=23620,a[5907]=23620,a[5910]=23628,a[5909]=23628,a[5912]=23636,a[5911]=23636,a[5914]=23644,a[5913]=23644,a[5916]=23652,a[5915]=23652,a[5918]=23660,a[5917]=23660,a[5920]=23668,a[5919]=23668,a[5922]=23676,a[5921]=23676,a[5924]=23684,a[5923]=23684,a[5926]=23692,a[5925]=23692,a[5928]=23700,a[5927]=23700,a[5930]=23708,a[5929]=23708,a[5932]=23716,a[5931]=23716,et=O+-40|0,st=R+8|0,st=st&7|0?0-st&7:0,ot=R+st|0,st=et-st|0,a[5863]=ot,a[5860]=st,a[ot+4>>2]=st|1,a[R+et+4>>2]=40,a[5864]=a[5979];while(0);if(m=a[5860]|0,m>>>0>de>>>0)return st=m-de|0,a[5860]=st,et=a[5863]|0,ot=et+de|0,a[5863]=ot,a[ot+4>>2]=st|1,a[et+4>>2]=de|3,et=et+8|0,we=Gt,et|0}return et=Ks()|0,a[et>>2]=12,et=0,we=Gt,et|0}function A(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0;if(y){x=y+-8|0,I=a[5861]|0,y=a[y+-4>>2]|0,m=y&-8,q=x+m|0;do if(y&1)U=x,O=x;else{if(E=a[x>>2]|0,!(y&3)||(O=x+(0-E)|0,R=E+m|0,O>>>0<I>>>0))return;if((a[5862]|0)==(O|0)){if(y=q+4|0,m=a[y>>2]|0,(m&3|0)!=3){U=O,m=R;break}a[5859]=R,a[y>>2]=m&-2,a[O+4>>2]=R|1,a[O+R>>2]=R;return}if(x=E>>>3,E>>>0<256)if(y=a[O+8>>2]|0,m=a[O+12>>2]|0,(m|0)==(y|0)){a[5857]=a[5857]&~(1<<x),U=O,m=R;break}else{a[y+12>>2]=m,a[m+8>>2]=y,U=O,m=R;break}I=a[O+24>>2]|0,y=a[O+12>>2]|0;do if((y|0)==(O|0)){if(m=O+16|0,x=m+4|0,y=a[x>>2]|0,y)m=x;else if(y=a[m>>2]|0,!y){y=0;break}for(;;)if(E=y+20|0,x=a[E>>2]|0,x)y=x,m=E;else if(E=y+16|0,x=a[E>>2]|0,x)y=x,m=E;else break;a[m>>2]=0}else U=a[O+8>>2]|0,a[U+12>>2]=y,a[y+8>>2]=U;while(0);if(I){if(m=a[O+28>>2]|0,x=23732+(m<<2)|0,(a[x>>2]|0)==(O|0)){if(a[x>>2]=y,!y){a[5858]=a[5858]&~(1<<m),U=O,m=R;break}}else if(U=I+16|0,a[((a[U>>2]|0)==(O|0)?U:I+20|0)>>2]=y,!y){U=O,m=R;break}a[y+24>>2]=I,m=O+16|0,x=a[m>>2]|0,x|0&&(a[y+16>>2]=x,a[x+24>>2]=y),m=a[m+4>>2]|0,m?(a[y+20>>2]=m,a[m+24>>2]=y,U=O,m=R):(U=O,m=R)}else U=O,m=R}while(0);if(!(O>>>0>=q>>>0)&&(y=q+4|0,E=a[y>>2]|0,!!(E&1))){if(E&2)a[y>>2]=E&-2,a[U+4>>2]=m|1,a[O+m>>2]=m,I=m;else{if((a[5863]|0)==(q|0)){if(q=(a[5860]|0)+m|0,a[5860]=q,a[5863]=U,a[U+4>>2]=q|1,(U|0)!=(a[5862]|0))return;a[5862]=0,a[5859]=0;return}if((a[5862]|0)==(q|0)){q=(a[5859]|0)+m|0,a[5859]=q,a[5862]=O,a[U+4>>2]=q|1,a[O+q>>2]=q;return}I=(E&-8)+m|0,x=E>>>3;do if(E>>>0<256)if(m=a[q+8>>2]|0,y=a[q+12>>2]|0,(y|0)==(m|0)){a[5857]=a[5857]&~(1<<x);break}else{a[m+12>>2]=y,a[y+8>>2]=m;break}else{R=a[q+24>>2]|0,y=a[q+12>>2]|0;do if((y|0)==(q|0)){if(m=q+16|0,x=m+4|0,y=a[x>>2]|0,y)m=x;else if(y=a[m>>2]|0,!y){x=0;break}for(;;)if(E=y+20|0,x=a[E>>2]|0,x)y=x,m=E;else if(E=y+16|0,x=a[E>>2]|0,x)y=x,m=E;else break;a[m>>2]=0,x=y}else x=a[q+8>>2]|0,a[x+12>>2]=y,a[y+8>>2]=x,x=y;while(0);if(R|0){if(y=a[q+28>>2]|0,m=23732+(y<<2)|0,(a[m>>2]|0)==(q|0)){if(a[m>>2]=x,!x){a[5858]=a[5858]&~(1<<y);break}}else if(E=R+16|0,a[((a[E>>2]|0)==(q|0)?E:R+20|0)>>2]=x,!x)break;a[x+24>>2]=R,y=q+16|0,m=a[y>>2]|0,m|0&&(a[x+16>>2]=m,a[m+24>>2]=x),y=a[y+4>>2]|0,y|0&&(a[x+20>>2]=y,a[y+24>>2]=x)}}while(0);if(a[U+4>>2]=I|1,a[O+I>>2]=I,(U|0)==(a[5862]|0)){a[5859]=I;return}}if(y=I>>>3,I>>>0<256){x=23468+(y<<1<<2)|0,m=a[5857]|0,y=1<<y,m&y?(m=x+8|0,y=a[m>>2]|0):(a[5857]=m|y,y=x,m=x+8|0),a[m>>2]=U,a[y+12>>2]=U,a[U+8>>2]=y,a[U+12>>2]=x;return}y=I>>>8,y?I>>>0>16777215?E=31:(O=(y+1048320|0)>>>16&8,q=y<<O,R=(q+520192|0)>>>16&4,q=q<<R,E=(q+245760|0)>>>16&2,E=14-(R|O|E)+(q<<E>>>15)|0,E=I>>>(E+7|0)&1|E<<1):E=0,y=23732+(E<<2)|0,a[U+28>>2]=E,a[U+20>>2]=0,a[U+16>>2]=0,m=a[5858]|0,x=1<<E;e:do if(!(m&x))a[5858]=m|x,a[y>>2]=U,a[U+24>>2]=y,a[U+12>>2]=U,a[U+8>>2]=U;else{y=a[y>>2]|0;t:do if((a[y+4>>2]&-8|0)!=(I|0)){for(E=I<<((E|0)==31?0:25-(E>>>1)|0);x=y+16+(E>>>31<<2)|0,m=a[x>>2]|0,!!m;)if((a[m+4>>2]&-8|0)==(I|0)){y=m;break t}else E=E<<1,y=m;a[x>>2]=U,a[U+24>>2]=y,a[U+12>>2]=U,a[U+8>>2]=U;break e}while(0);O=y+8|0,q=a[O>>2]|0,a[q+12>>2]=U,a[O>>2]=U,a[U+8>>2]=q,a[U+12>>2]=y,a[U+24>>2]=0}while(0);if(q=(a[5865]|0)+-1|0,a[5865]=q,!(q|0)){for(y=23884;y=a[y>>2]|0,y;)y=y+8|0;a[5865]=-1}}}}function h(y,m){y=y|0,m=m|0;var x=0;return y?(x=an(m,y)|0,(m|y)>>>0>65535&&(x=((x>>>0)/(y>>>0)|0|0)==(m|0)?x:-1)):x=0,y=v(x)|0,!y||!(a[y+-4>>2]&3)||Se(y|0,0,x|0)|0,y|0}function d(y,m,x,E){return y=y|0,m=m|0,x=x|0,E=E|0,x=y+x>>>0,Mt(m+E+(x>>>0<y>>>0|0)>>>0|0),x|0|0}function w(y,m,x,E){return y=y|0,m=m|0,x=x|0,E=E|0,E=m-E-(x>>>0>y>>>0|0)>>>0,Mt(E|0),y-x>>>0|0|0}function b(y){return y=y|0,(y?31-(Ne(y^y-1)|0)|0:32)|0}function S(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Be=0,He=0,ze=0;if(le=y,q=m,ee=q,O=x,Be=E,U=Be,!ee)return R=(I|0)!=0,U?R?(a[I>>2]=y|0,a[I+4>>2]=m&0,Be=0,I=0,Mt(Be|0),I|0):(Be=0,I=0,Mt(Be|0),I|0):(R&&(a[I>>2]=(le>>>0)%(O>>>0),a[I+4>>2]=0),Be=0,I=(le>>>0)/(O>>>0)>>>0,Mt(Be|0),I|0);R=(U|0)==0;do if(O){if(!R){if(R=(Ne(U|0)|0)-(Ne(ee|0)|0)|0,R>>>0<=31){de=R+1|0,U=31-R|0,m=R-31>>31,O=de,y=le>>>(de>>>0)&m|ee<<U,m=ee>>>(de>>>0)&m,R=0,U=le<<U;break}return I?(a[I>>2]=y|0,a[I+4>>2]=q|m&0,Be=0,I=0,Mt(Be|0),I|0):(Be=0,I=0,Mt(Be|0),I|0)}if(R=O-1|0,R&O|0){U=(Ne(O|0)|0)+33-(Ne(ee|0)|0)|0,ze=64-U|0,de=32-U|0,q=de>>31,He=U-32|0,m=He>>31,O=U,y=de-1>>31&ee>>>(He>>>0)|(ee<<de|le>>>(U>>>0))&m,m=m&ee>>>(U>>>0),R=le<<ze&q,U=(ee<<ze|le>>>(He>>>0))&q|le<<de&U-33>>31;break}return I|0&&(a[I>>2]=R&le,a[I+4>>2]=0),(O|0)==1?(He=q|m&0,ze=y|0|0,Mt(He|0),ze|0):(ze=b(O|0)|0,He=ee>>>(ze>>>0)|0,ze=ee<<32-ze|le>>>(ze>>>0)|0,Mt(He|0),ze|0)}else{if(R)return I|0&&(a[I>>2]=(ee>>>0)%(O>>>0),a[I+4>>2]=0),He=0,ze=(ee>>>0)/(O>>>0)>>>0,Mt(He|0),ze|0;if(!le)return I|0&&(a[I>>2]=0,a[I+4>>2]=(ee>>>0)%(U>>>0)),He=0,ze=(ee>>>0)/(U>>>0)>>>0,Mt(He|0),ze|0;if(R=U-1|0,!(R&U))return I|0&&(a[I>>2]=y|0,a[I+4>>2]=R&ee|m&0),He=0,ze=ee>>>((b(U|0)|0)>>>0),Mt(He|0),ze|0;if(R=(Ne(U|0)|0)-(Ne(ee|0)|0)|0,R>>>0<=30){m=R+1|0,U=31-R|0,O=m,y=ee<<U|le>>>(m>>>0),m=ee>>>(m>>>0),R=0,U=le<<U;break}return I?(a[I>>2]=y|0,a[I+4>>2]=q|m&0,He=0,ze=0,Mt(He|0),ze|0):(He=0,ze=0,Mt(He|0),ze|0)}while(0);if(!O)ee=U,q=0,U=0;else{de=x|0|0,le=Be|E&0,ee=d(de|0,le|0,-1,-1)|0,x=Ce()|0,q=U,U=0;do E=q,q=R>>>31|q<<1,R=U|R<<1,E=y<<1|E>>>31|0,Be=y>>>31|m<<1|0,w(ee|0,x|0,E|0,Be|0)|0,ze=Ce()|0,He=ze>>31|((ze|0)<0?-1:0)<<1,U=He&1,y=w(E|0,Be|0,He&de|0,(((ze|0)<0?-1:0)>>31|((ze|0)<0?-1:0)<<1)&le|0)|0,m=Ce()|0,O=O-1|0;while(O|0);ee=q,q=0}return O=0,I|0&&(a[I>>2]=y,a[I+4>>2]=m),He=(R|0)>>>31|(ee|O)<<1|(O<<1|R>>>31)&0|q,ze=(R<<1|0)&-2|U,Mt(He|0),ze|0}function P(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0;return ee=m>>31|((m|0)<0?-1:0)<<1,q=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,R=E>>31|((E|0)<0?-1:0)<<1,I=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,U=w(ee^y|0,q^m|0,ee|0,q|0)|0,O=Ce()|0,y=R^ee,m=I^q,w((S(U,O,w(R^x|0,I^E|0,R|0,I|0)|0,Ce()|0,0)|0)^y|0,(Ce()|0)^m|0,y|0,m|0)|0}function B(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0;return R=y&65535,I=m&65535,x=an(I,R)|0,E=y>>>16,y=(x>>>16)+(an(I,E)|0)|0,I=m>>>16,m=an(I,R)|0,Mt((y>>>16)+(an(I,E)|0)+(((y&65535)+m|0)>>>16)|0),y+m<<16|x&65535|0|0}function V(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0;return I=y,R=x,x=B(I,R)|0,y=Ce()|0,Mt((an(m,R)|0)+(an(E,I)|0)+y|y&0|0),x|0|0|0}function W(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0;return I=we,we=we+16|0,U=I|0,O=m>>31|((m|0)<0?-1:0)<<1,R=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,ee=E>>31|((E|0)<0?-1:0)<<1,q=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,y=w(O^y|0,R^m|0,O|0,R|0)|0,m=Ce()|0,S(y,m,w(ee^x|0,q^E|0,ee|0,q|0)|0,Ce()|0,U)|0,E=w(a[U>>2]^O|0,a[U+4>>2]^R|0,O|0,R|0)|0,x=Ce()|0,we=I,Mt(x|0),E|0}function X(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0;return R=we,we=we+16|0,I=R|0,S(y,m,x,E,I)|0,we=R,Mt(a[I+4>>2]|0),a[I>>2]|0|0}function ae(y,m,x){return y=y|0,m=m|0,x=x|0,(x|0)<32?(Mt(m>>x|0),y>>>x|(m&(1<<x)-1)<<32-x):(Mt(((m|0)<0?-1:0)|0),m>>x-32|0)}function ne(y,m,x){return y=y|0,m=m|0,x=x|0,(x|0)<32?(Mt(m>>>x|0),y>>>x|(m&(1<<x)-1)<<32-x):(Mt(0),m>>>x-32|0)}function ue(y,m,x){return y=y|0,m=m|0,x=x|0,(x|0)<32?(Mt(m<<x|(y&(1<<x)-1<<32-x)>>>32-x|0),y<<x):(Mt(y<<x-32|0),0)}function Ee(y,m){return y=+y,m=+m,y!=y?+m:m!=m?+y:+Ft(+y,+m)}function Me(y,m){return y=+y,m=+m,y!=y?+m:m!=m?+y:+xn(+y,+m)}function ve(y){return y=+y,y>=0?+Pe(y+.5):+qt(y-.5)}function je(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;if((x|0)>=8192)return pa(y|0,m|0,x|0)|0,y|0;if(R=y|0,I=y+x|0,(y&3)==(m&3)){for(;y&3;){if(!x)return R|0;fe[y>>0]=fe[m>>0]|0,y=y+1|0,m=m+1|0,x=x-1|0}for(x=I&-4|0,E=x-64|0;(y|0)<=(E|0);)a[y>>2]=a[m>>2],a[y+4>>2]=a[m+4>>2],a[y+8>>2]=a[m+8>>2],a[y+12>>2]=a[m+12>>2],a[y+16>>2]=a[m+16>>2],a[y+20>>2]=a[m+20>>2],a[y+24>>2]=a[m+24>>2],a[y+28>>2]=a[m+28>>2],a[y+32>>2]=a[m+32>>2],a[y+36>>2]=a[m+36>>2],a[y+40>>2]=a[m+40>>2],a[y+44>>2]=a[m+44>>2],a[y+48>>2]=a[m+48>>2],a[y+52>>2]=a[m+52>>2],a[y+56>>2]=a[m+56>>2],a[y+60>>2]=a[m+60>>2],y=y+64|0,m=m+64|0;for(;(y|0)<(x|0);)a[y>>2]=a[m>>2],y=y+4|0,m=m+4|0}else for(x=I-4|0;(y|0)<(x|0);)fe[y>>0]=fe[m>>0]|0,fe[y+1>>0]=fe[m+1>>0]|0,fe[y+2>>0]=fe[m+2>>0]|0,fe[y+3>>0]=fe[m+3>>0]|0,y=y+4|0,m=m+4|0;for(;(y|0)<(I|0);)fe[y>>0]=fe[m>>0]|0,y=y+1|0,m=m+1|0;return R|0}function Se(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0;if(R=y+x|0,m=m&255,(x|0)>=67){for(;y&3;)fe[y>>0]=m,y=y+1|0;for(E=R&-4|0,O=m|m<<8|m<<16|m<<24,I=E-64|0;(y|0)<=(I|0);)a[y>>2]=O,a[y+4>>2]=O,a[y+8>>2]=O,a[y+12>>2]=O,a[y+16>>2]=O,a[y+20>>2]=O,a[y+24>>2]=O,a[y+28>>2]=O,a[y+32>>2]=O,a[y+36>>2]=O,a[y+40>>2]=O,a[y+44>>2]=O,a[y+48>>2]=O,a[y+52>>2]=O,a[y+56>>2]=O,a[y+60>>2]=O,y=y+64|0;for(;(y|0)<(E|0);)a[y>>2]=O,y=y+4|0}for(;(y|0)<(R|0);)fe[y>>0]=m,y=y+1|0;return R-x|0}function $e(y){return y=+y,y>=0?+Pe(y+.5):+qt(y-.5)}function xe(y){y=y|0;var m=0,x=0,E=0;return E=ir()|0,x=a[ke>>2]|0,m=x+y|0,(y|0)>0&(m|0)<(x|0)|(m|0)<0?(Qa(m|0)|0,fi(12),-1):(m|0)>(E|0)&&!(Re(m|0)|0)?(fi(12),-1):(a[ke>>2]=m,x|0)}return{___divdi3:P,___muldi3:V,___remdi3:W,___uremdi3:X,_areNeighborCells:fu,_bitshift64Ashr:ae,_bitshift64Lshr:ne,_bitshift64Shl:ue,_calloc:h,_cellAreaKm2:Nt,_cellAreaM2:_u,_cellAreaRads2:ps,_cellToBoundary:yi,_cellToCenterChild:mu,_cellToChildPos:ds,_cellToChildren:DA,_cellToChildrenSize:Fl,_cellToLatLng:To,_cellToLocalIj:Bh,_cellToParent:Ol,_cellToVertex:fn,_cellToVertexes:es,_cellsToDirectedEdge:du,_cellsToLinkedMultiPolygon:Br,_childPosToCell:Cc,_compactCells:Nl,_destroyLinkedMultiPolygon:$l,_directedEdgeToBoundary:js,_directedEdgeToCells:va,_edgeLengthKm:ea,_edgeLengthM:vu,_edgeLengthRads:Ta,_emscripten_replace_memory:Wo,_free:A,_getBaseCellNumber:Ja,_getDirectedEdgeDestination:_a,_getDirectedEdgeOrigin:Eo,_getHexagonAreaAvgKm2:Gl,_getHexagonAreaAvgM2:rl,_getHexagonEdgeLengthAvgKm:Dh,_getHexagonEdgeLengthAvgM:Rh,_getIcosahedronFaces:Ul,_getNumCells:il,_getPentagons:Qs,_getRes0Cells:kA,_getResolution:zl,_greatCircleDistanceKm:Vl,_greatCircleDistanceM:Jo,_greatCircleDistanceRads:Ji,_gridDisk:ma,_gridDiskDistances:ri,_gridDistance:wu,_gridPathCells:Eu,_gridPathCellsSize:bu,_gridRingUnsafe:bt,_i64Add:d,_i64Subtract:w,_isPentagon:vr,_isResClassIII:zr,_isValidCell:xa,_isValidDirectedEdge:pu,_isValidVertex:jr,_latLngToCell:fs,_llvm_maxnum_f64:Ee,_llvm_minnum_f64:Me,_llvm_round_f64:ve,_localIjToCell:Pc,_malloc:v,_maxFaceCount:el,_maxGridDiskSize:Ml,_maxPolygonToCellsSize:Qt,_memcpy:je,_memset:Se,_originToDirectedEdges:gr,_pentagonCount:tl,_polygonToCells:Dr,_readInt64AsDoubleFromPointer:Su,_res0CellCount:PA,_round:$e,_sbrk:xe,_sizeOfCellBoundary:kc,_sizeOfCoordIJ:Hl,_sizeOfGeoLoop:gs,_sizeOfGeoPolygon:Pr,_sizeOfH3Index:Ur,_sizeOfLatLng:jl,_sizeOfLinkedGeoPolygon:ol,_uncompactCells:Tc,_uncompactCellsSize:Yr,_vertexToLatLng:ta,establishStackSpace:ga,stackAlloc:Cs,stackRestore:Za,stackSave:qa}}(Ss,yn,Oe);e.___divdi3=Ke.___divdi3,e.___muldi3=Ke.___muldi3,e.___remdi3=Ke.___remdi3,e.___uremdi3=Ke.___uremdi3,e._areNeighborCells=Ke._areNeighborCells,e._bitshift64Ashr=Ke._bitshift64Ashr,e._bitshift64Lshr=Ke._bitshift64Lshr,e._bitshift64Shl=Ke._bitshift64Shl,e._calloc=Ke._calloc,e._cellAreaKm2=Ke._cellAreaKm2,e._cellAreaM2=Ke._cellAreaM2,e._cellAreaRads2=Ke._cellAreaRads2,e._cellToBoundary=Ke._cellToBoundary,e._cellToCenterChild=Ke._cellToCenterChild,e._cellToChildPos=Ke._cellToChildPos,e._cellToChildren=Ke._cellToChildren,e._cellToChildrenSize=Ke._cellToChildrenSize,e._cellToLatLng=Ke._cellToLatLng,e._cellToLocalIj=Ke._cellToLocalIj,e._cellToParent=Ke._cellToParent,e._cellToVertex=Ke._cellToVertex,e._cellToVertexes=Ke._cellToVertexes,e._cellsToDirectedEdge=Ke._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=Ke._cellsToLinkedMultiPolygon,e._childPosToCell=Ke._childPosToCell,e._compactCells=Ke._compactCells,e._destroyLinkedMultiPolygon=Ke._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=Ke._directedEdgeToBoundary,e._directedEdgeToCells=Ke._directedEdgeToCells,e._edgeLengthKm=Ke._edgeLengthKm,e._edgeLengthM=Ke._edgeLengthM,e._edgeLengthRads=Ke._edgeLengthRads;var qr=e._emscripten_replace_memory=Ke._emscripten_replace_memory;e._free=Ke._free,e._getBaseCellNumber=Ke._getBaseCellNumber,e._getDirectedEdgeDestination=Ke._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=Ke._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=Ke._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=Ke._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=Ke._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=Ke._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=Ke._getIcosahedronFaces,e._getNumCells=Ke._getNumCells,e._getPentagons=Ke._getPentagons,e._getRes0Cells=Ke._getRes0Cells,e._getResolution=Ke._getResolution,e._greatCircleDistanceKm=Ke._greatCircleDistanceKm,e._greatCircleDistanceM=Ke._greatCircleDistanceM,e._greatCircleDistanceRads=Ke._greatCircleDistanceRads,e._gridDisk=Ke._gridDisk,e._gridDiskDistances=Ke._gridDiskDistances,e._gridDistance=Ke._gridDistance,e._gridPathCells=Ke._gridPathCells,e._gridPathCellsSize=Ke._gridPathCellsSize,e._gridRingUnsafe=Ke._gridRingUnsafe,e._i64Add=Ke._i64Add,e._i64Subtract=Ke._i64Subtract,e._isPentagon=Ke._isPentagon,e._isResClassIII=Ke._isResClassIII,e._isValidCell=Ke._isValidCell,e._isValidDirectedEdge=Ke._isValidDirectedEdge,e._isValidVertex=Ke._isValidVertex,e._latLngToCell=Ke._latLngToCell,e._llvm_maxnum_f64=Ke._llvm_maxnum_f64,e._llvm_minnum_f64=Ke._llvm_minnum_f64,e._llvm_round_f64=Ke._llvm_round_f64,e._localIjToCell=Ke._localIjToCell,e._malloc=Ke._malloc,e._maxFaceCount=Ke._maxFaceCount,e._maxGridDiskSize=Ke._maxGridDiskSize,e._maxPolygonToCellsSize=Ke._maxPolygonToCellsSize,e._memcpy=Ke._memcpy,e._memset=Ke._memset,e._originToDirectedEdges=Ke._originToDirectedEdges,e._pentagonCount=Ke._pentagonCount,e._polygonToCells=Ke._polygonToCells,e._readInt64AsDoubleFromPointer=Ke._readInt64AsDoubleFromPointer,e._res0CellCount=Ke._res0CellCount,e._round=Ke._round,e._sbrk=Ke._sbrk,e._sizeOfCellBoundary=Ke._sizeOfCellBoundary,e._sizeOfCoordIJ=Ke._sizeOfCoordIJ,e._sizeOfGeoLoop=Ke._sizeOfGeoLoop,e._sizeOfGeoPolygon=Ke._sizeOfGeoPolygon,e._sizeOfH3Index=Ke._sizeOfH3Index,e._sizeOfLatLng=Ke._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=Ke._sizeOfLinkedGeoPolygon,e._uncompactCells=Ke._uncompactCells,e._uncompactCellsSize=Ke._uncompactCellsSize,e._vertexToLatLng=Ke._vertexToLatLng,e.establishStackSpace=Ke.establishStackSpace;var Gs=e.stackAlloc=Ke.stackAlloc,Fr=e.stackRestore=Ke.stackRestore,hi=e.stackSave=Ke.stackSave;if(e.asm=Ke,e.cwrap=se,e.setValue=F,e.getValue=j,qn){vo(qn)||(qn=s(qn));{$n();var Xn=function(K){K.byteLength&&(K=new Uint8Array(K)),Ze.set(K,k),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Ii()},$s=function(){l(qn,Xn,function(){throw"could not load memory initializer "+qn})},ji=Rr(qn);if(ji)Xn(ji.buffer);else if(e.memoryInitializerRequest){var Hi=function(){var K=e.memoryInitializerRequest,Q=K.response;if(K.status!==200&&K.status!==0){var te=Rr(e.memoryInitializerRequestURL);if(te)Q=te.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+K.status+", retrying "+qn),$s();return}}Xn(Q)};e.memoryInitializerRequest.response?setTimeout(Hi,0):e.memoryInitializerRequest.addEventListener("load",Hi)}else $s()}}var Bi;ni=function K(){Bi||cs(),Bi||(ni=K)};function cs(K){if(rr>0||(Gn(),rr>0))return;function Q(){Bi||(Bi=!0,!H&&(Mr(),wt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),rn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),Q()},1)):Q()}e.run=cs;function Nr(K){throw e.onAbort&&e.onAbort(K),K+="",o(K),p(K),H=!0,"abort("+K+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Nr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return cs(),t}(typeof Vi=="object"?Vi:{}),Yn="number",Bn=Yn,Yp=Yn,Nn=Yn,Un=Yn,lo=Yn,dn=Yn,y1e=[["sizeOfH3Index",Yn],["sizeOfLatLng",Yn],["sizeOfCellBoundary",Yn],["sizeOfGeoLoop",Yn],["sizeOfGeoPolygon",Yn],["sizeOfLinkedGeoPolygon",Yn],["sizeOfCoordIJ",Yn],["readInt64AsDoubleFromPointer",Yn],["isValidCell",Yp,[Nn,Un]],["latLngToCell",Bn,[Yn,Yn,lo,dn]],["cellToLatLng",Bn,[Nn,Un,dn]],["cellToBoundary",Bn,[Nn,Un,dn]],["maxGridDiskSize",Bn,[Yn,dn]],["gridDisk",Bn,[Nn,Un,Yn,dn]],["gridDiskDistances",Bn,[Nn,Un,Yn,dn,dn]],["gridRingUnsafe",Bn,[Nn,Un,Yn,dn]],["maxPolygonToCellsSize",Bn,[dn,lo,Yn,dn]],["polygonToCells",Bn,[dn,lo,Yn,dn]],["cellsToLinkedMultiPolygon",Bn,[dn,Yn,dn]],["destroyLinkedMultiPolygon",null,[dn]],["compactCells",Bn,[dn,dn,Yn,Yn]],["uncompactCells",Bn,[dn,Yn,Yn,dn,Yn,lo]],["uncompactCellsSize",Bn,[dn,Yn,Yn,lo,dn]],["isPentagon",Yp,[Nn,Un]],["isResClassIII",Yp,[Nn,Un]],["getBaseCellNumber",Yn,[Nn,Un]],["getResolution",Yn,[Nn,Un]],["maxFaceCount",Bn,[Nn,Un,dn]],["getIcosahedronFaces",Bn,[Nn,Un,dn]],["cellToParent",Bn,[Nn,Un,lo,dn]],["cellToChildren",Bn,[Nn,Un,lo,dn]],["cellToCenterChild",Bn,[Nn,Un,lo,dn]],["cellToChildrenSize",Bn,[Nn,Un,lo,dn]],["cellToChildPos",Bn,[Nn,Un,lo,dn]],["childPosToCell",Bn,[Yn,Yn,Nn,Un,lo,dn]],["areNeighborCells",Bn,[Nn,Un,Nn,Un,dn]],["cellsToDirectedEdge",Bn,[Nn,Un,Nn,Un,dn]],["getDirectedEdgeOrigin",Bn,[Nn,Un,dn]],["getDirectedEdgeDestination",Bn,[Nn,Un,dn]],["isValidDirectedEdge",Yp,[Nn,Un]],["directedEdgeToCells",Bn,[Nn,Un,dn]],["originToDirectedEdges",Bn,[Nn,Un,dn]],["directedEdgeToBoundary",Bn,[Nn,Un,dn]],["gridDistance",Bn,[Nn,Un,Nn,Un,dn]],["gridPathCells",Bn,[Nn,Un,Nn,Un,dn]],["gridPathCellsSize",Bn,[Nn,Un,Nn,Un,dn]],["cellToLocalIj",Bn,[Nn,Un,Nn,Un,Yn,dn]],["localIjToCell",Bn,[Nn,Un,dn,Yn,dn]],["getHexagonAreaAvgM2",Bn,[lo,dn]],["getHexagonAreaAvgKm2",Bn,[lo,dn]],["getHexagonEdgeLengthAvgM",Bn,[lo,dn]],["getHexagonEdgeLengthAvgKm",Bn,[lo,dn]],["greatCircleDistanceM",Yn,[dn,dn]],["greatCircleDistanceKm",Yn,[dn,dn]],["greatCircleDistanceRads",Yn,[dn,dn]],["cellAreaM2",Bn,[Nn,Un,dn]],["cellAreaKm2",Bn,[Nn,Un,dn]],["cellAreaRads2",Bn,[Nn,Un,dn]],["edgeLengthM",Bn,[Nn,Un,dn]],["edgeLengthKm",Bn,[Nn,Un,dn]],["edgeLengthRads",Bn,[Nn,Un,dn]],["getNumCells",Bn,[lo,dn]],["getRes0Cells",Bn,[dn]],["res0CellCount",Yn],["getPentagons",Bn,[Yn,dn]],["pentagonCount",Yn],["cellToVertex",Bn,[Nn,Un,Yn,dn]],["cellToVertexes",Bn,[Nn,Un,dn]],["vertexToLatLng",Bn,[Nn,Un,dn]],["isValidVertex",Yp,[Nn,Un]]],_1e=0,v1e=1,x1e=2,w1e=3,Q7=4,b1e=5,E1e=6,T1e=7,S1e=8,C1e=9,M1e=10,P1e=11,k1e=12,I1e=13,L1e=14,D1e=15,Us={};Us[_1e]="Success";Us[v1e]="The operation failed but a more specific error is not available";Us[x1e]="Argument was outside of acceptable range";Us[w1e]="Latitude or longitude arguments were outside of acceptable range";Us[Q7]="Resolution argument was outside of acceptable range";Us[b1e]="Cell argument was not valid";Us[E1e]="Directed edge argument was not valid";Us[T1e]="Undirected edge argument was not valid";Us[S1e]="Vertex argument was not valid";Us[C1e]="Pentagon distortion was encountered";Us[M1e]="Duplicate input";Us[P1e]="Cell arguments were not neighbors";Us[k1e]="Cell arguments had incompatible resolutions";Us[I1e]="Memory allocation failed";Us[L1e]="Bounds of provided memory were insufficient";Us[D1e]="Mode or flags argument was not valid";var Wv=1e3,R1e=1001,B1e=1002,Qv={};Qv[Wv]="Unknown unit";Qv[R1e]="Array length out of bounds";Qv[B1e]="Got unexpected null value for H3 index";var z1e="Unknown error";function q7(t,e,n){var r=n&&"value"in n,i=new Error((t[e]||z1e)+" (code: "+e+(r?", value: "+n.value:"")+")");return i.code=e,i}function Z7(t,e){var n=arguments.length===2?{value:e}:{};return q7(Us,t,n)}function C4(t,e){var n=arguments.length===2?{value:e}:{};return q7(Qv,t,n)}function su(t){if(t!==0)throw Z7(t)}var Es={};y1e.forEach(function(e){Es[e[0]]=Vi.cwrap.apply(Vi,e)});var Y0=16,O1e=4,Mh=8,KE=Es.sizeOfH3Index(),F1e=Es.sizeOfLatLng(),N1e=Es.sizeOfCellBoundary();Es.sizeOfGeoPolygon();Es.sizeOfGeoLoop();Es.sizeOfLinkedGeoPolygon();Es.sizeOfCoordIJ();var Ar={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function Y7(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw Z7(Q7,t);return t}var U1e=/[^0-9a-fA-F]/;function qv(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||U1e.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),Y0),n=parseInt(t.substring(t.length-8),Y0);return[n,e]}function j8(t){if(t>=0)return t.toString(Y0);t=t&2147483647;var e=X7(8,t.toString(Y0)),n=(parseInt(e[0],Y0)+8).toString(Y0);return e=n+e.substring(1),e}function V1e(t,e){return j8(e)+X7(8,j8(t))}function X7(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function G1e(t,e){e===void 0&&(e=0);var n=Vi.getValue(t+KE*e,"i32"),r=Vi.getValue(t+KE*e+O1e,"i32");return r?V1e(n,r):null}function M4(t,e){return e===void 0&&(e=0),Vi.getValue(t+Mh*e,"double")}function $1e(t,e){for(var n=[],r=0;r<e;r++){var i=G1e(t,r);i!==null&&n.push(i)}return n}function q2(t){return Q1e(Vi.getValue(t,"double"))}function K7(t){return[q2(t),q2(t+Mh)]}function j1e(t){return[q2(t+Mh),q2(t)]}function H1e(t,e,n){for(var r=Vi.getValue(t,"i32"),i=t+Mh,s=[],l=e?j1e:K7,o=0;o<r*2;o+=2)s.push(l(i+Mh*o));return n&&s.push(s[0]),s}function P4(t){var e=Vi._malloc(F1e),n=qv(t),r=n[0],i=n[1];try{return su(Es.cellToLatLng(r,i,e)),K7(e)}finally{Vi._free(e)}}function W1e(t,e){var n=Vi._malloc(N1e),r=qv(t),i=r[0],s=r[1];try{return su(Es.cellToBoundary(i,s,n)),H1e(n,e,e)}finally{Vi._free(n)}}function H8(t){var e=qv(t),n=e[0],r=e[1],i=6,s=Vi._calloc(i,KE);try{return su(Es.originToDirectedEdges(n,r,s)),$1e(s,i)}finally{Vi._free(s)}}function W8(t,e){var n=qv(t),r=n[0],i=n[1],s=Vi._malloc(Mh);try{switch(e){case Ar.m:su(Es.edgeLengthM(r,i,s));break;case Ar.km:su(Es.edgeLengthKm(r,i,s));break;case Ar.rads:su(Es.edgeLengthRads(r,i,s));break;default:throw C4(Wv,e)}return M4(s)}finally{Vi._free(s)}}function _A(t,e){Y7(t);var n=Vi._malloc(Mh);try{switch(e){case Ar.m2:su(Es.getHexagonAreaAvgM2(t,n));break;case Ar.km2:su(Es.getHexagonAreaAvgKm2(t,n));break;default:throw C4(Wv,e)}return M4(n)}finally{Vi._free(n)}}function ws(t,e){Y7(t);var n=Vi._malloc(Mh);try{switch(e){case Ar.m:su(Es.getHexagonEdgeLengthAvgM(t,n));break;case Ar.km:su(Es.getHexagonEdgeLengthAvgKm(t,n));break;default:throw C4(Wv,e)}return M4(n)}finally{Vi._free(n)}}function Q1e(t){return t*180/Math.PI}function q1e({res:t}){const e=De.useRef(),n=De.useRef();return De.useLayoutEffect(()=>{const r=window.innerHeight,i=800,s=Ai(e.current).attr("width",i).attr("height",r);s.append("g").call($a.arcmapLegend().vtitle("Groundwater").utitle("Variance").scale(hr.groundwater.vsup).size(150).x(i-180).y(r-470));let l=i-600,o=r-150;s.append("g").attr("transform",`translate(${l},${o})`).call(v4(hr.difference)),l=i-600,o=r-275,s.append("g").attr("transform",`translate(${l},${o})`).call(_4(hr.unmetDemand)),s.append("g").call(Xm(i-100,r-100,70,"rgba(146, 146, 146, 0.5)")).call(function(p){n.current=[p.append("text").attr("x",i-100).attr("y",r-92).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${Math.round(_A(t,Ar.km2))} km²`),p.append("text").attr("x",i-100).attr("y",r-50).attr("text-anchor","middle").style("font-size","11px").text(`← ${Math.round(ws(t,Ar.km))} km →;`)]})},[]),De.useEffect(()=>{let[r,i]=n.current;r.text(`${Math.round(_A(t,Ar.km2))} km²`),i.text(`← ${Math.round(ws(t,Ar.km))} km →;`)},[t]),Ye.createElement("svg",{className:"legend-area",ref:e})}function Z1e({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s,res:l}){return Ye.createElement(Ye.Fragment,null,Ye.createElement(Hv,{counter:n,displayMonth:!1,dataset:"averageDemandBaseline"}),Ye.createElement(q1e,{res:l}),Ye.createElement("div",{className:"styled-input"},Ye.createElement("button",{onClick:()=>{s(o=>!o)}},i?"Pause":"Play"),Ye.createElement("div",null,Ye.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:n,onChange:function(o){r(parseInt(o.target.value))}}),Ye.createElement("input",{onChange:function(o){s(!1),r(parseInt(o.target.value))},onInput:function(o){r(parseInt(o.target.value))},value:n,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))))}const Y1e=/^[og]\s*(.+)?/,X1e=/^mtllib /,K1e=/^usemtl /;class k4{constructor(e){let{index:n,name:r="",mtllib:i,smooth:s,groupStart:l}=e;this.index=n,this.name=r,this.mtllib=i,this.smooth=s,this.groupStart=l,this.groupEnd=-1,this.groupCount=-1,this.inherited=!1}clone(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.index;return new k4({index:e,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0})}}class J1e{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.name=e,this.geometry={vertices:[],normals:[],colors:[],uvs:[]},this.materials=[],this.smooth=!0,this.fromDeclaration=null}startMaterial(e,n){const r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);const i=new k4({index:this.materials.length,name:e,mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:r!==void 0?r.smooth:this.smooth,groupStart:r!==void 0?r.groupEnd:0});return this.materials.push(i),i}currentMaterial(){if(this.materials.length>0)return this.materials[this.materials.length-1]}_finalize(e){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),e&&this.materials.length>1)for(let r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}}class eye{constructor(){this.objects=[],this.object=null,this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.materialLibraries=[],this.startObject("",!1)}startObject(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.object&&!this.object.fromDeclaration){this.object.name=e,this.object.fromDeclaration=n;return}const r=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object=new J1e(e),this.object.fromDeclaration=n,r&&r.name&&typeof r.clone=="function"){const i=r.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)}finalize(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)}parseVertexIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/3)*3}parseNormalIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/3)*3}parseUVIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/2)*2}addVertex(e,n,r){const i=this.vertices,s=this.object.geometry.vertices;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addVertexPoint(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addVertexLine(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addNormal(e,n,r){const i=this.normals,s=this.object.geometry.normals;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addColor(e,n,r){const i=this.colors,s=this.object.geometry.colors;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addUV(e,n,r){const i=this.uvs,s=this.object.geometry.uvs;s.push(i[e+0],i[e+1]),s.push(i[n+0],i[n+1]),s.push(i[r+0],i[r+1])}addUVLine(e){const n=this.uvs;this.object.geometry.uvs.push(n[e+0],n[e+1])}addFace(e,n,r,i,s,l,o,p,_){const C=this.vertices.length;let M=this.parseVertexIndex(e,C),k=this.parseVertexIndex(n,C),F=this.parseVertexIndex(r,C);if(this.addVertex(M,k,F),i!==void 0&&i!==""){const j=this.uvs.length;M=this.parseUVIndex(i,j),k=this.parseUVIndex(s,j),F=this.parseUVIndex(l,j),this.addUV(M,k,F)}if(o!==void 0&&o!==""){const j=this.normals.length;M=this.parseNormalIndex(o,j),k=o===p?M:this.parseNormalIndex(p,j),F=o===_?M:this.parseNormalIndex(_,j),this.addNormal(M,k,F)}this.colors.length>0&&this.addColor(M,k,F)}addPointGeometry(e){this.object.geometry.type="Points";const n=this.vertices.length;for(const r of e)this.addVertexPoint(this.parseVertexIndex(r,n))}addLineGeometry(e,n){this.object.geometry.type="Line";const r=this.vertices.length,i=this.uvs.length;for(const s of e)this.addVertexLine(this.parseVertexIndex(s,r));for(const s of n)this.addUVLine(this.parseUVIndex(s,i))}}function tye(t){const e=new eye;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let r="",i="",s=0,l=[];const o=typeof"".trimLeft=="function";for(let C=0,M=n.length;C<M;C++)if(r=n[C],r=o?r.trimLeft():r.trim(),s=r.length,s!==0&&(i=r.charAt(0),i!=="#"))if(i==="v"){const k=r.split(/\s+/);switch(k[0]){case"v":e.vertices.push(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])),k.length>=7&&e.colors.push(parseFloat(k[4]),parseFloat(k[5]),parseFloat(k[6]));break;case"vn":e.normals.push(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3]));break;case"vt":e.uvs.push(parseFloat(k[1]),parseFloat(k[2]));break}}else if(i==="f"){const F=r.substr(1).trim().split(/\s+/),j=[];for(let ie=0,Y=F.length;ie<Y;ie++){const J=F[ie];if(J.length>0){const se=J.split("/");j.push(se)}}const H=j[0];for(let ie=1,Y=j.length-1;ie<Y;ie++){const J=j[ie],se=j[ie+1];e.addFace(H[0],J[0],se[0],H[1],J[1],se[1],H[2],J[2],se[2])}}else if(i==="l"){const k=r.substring(1).trim().split(" ");let F;const j=[];if(r.indexOf("/")===-1)F=k;else{F=[];for(let H=0,ie=k.length;H<ie;H++){const Y=k[H].split("/");Y[0]!==""&&F.push(Y[0]),Y[1]!==""&&j.push(Y[1])}}e.addLineGeometry(F,j)}else if(i==="p"){const F=r.substr(1).trim().split(" ");e.addPointGeometry(F)}else if((l=Y1e.exec(r))!==null){const k=(" "+l[0].substr(1).trim()).substr(1);e.startObject(k)}else if(K1e.test(r))e.object.startMaterial(r.substring(7).trim(),e.materialLibraries);else if(X1e.test(r))e.materialLibraries.push(r.substring(7).trim());else if(i==="s"){if(l=r.split(" "),l.length>1){const F=l[1].trim().toLowerCase();e.object.smooth=F!=="0"&&F!=="off"}else e.object.smooth=!0;const k=e.object.currentMaterial();k&&(k.smooth=e.object.smooth)}else{if(r==="\0")continue;throw new Error('Unexpected line: "'.concat(r,'"'))}e.finalize();const p=[],_=[];for(const C of e.objects){const{geometry:M}=C;if(M.vertices.length===0)continue;const k={header:{vertexCount:M.vertices.length/3},attributes:{}};switch(M.type){case"Points":k.mode=0;break;case"Line":k.mode=1;break;default:k.mode=4;break}k.attributes.POSITION={value:new Float32Array(M.vertices),size:3},M.normals.length>0&&(k.attributes.NORMAL={value:new Float32Array(M.normals),size:3}),M.colors.length>0&&(k.attributes.COLOR_0={value:new Float32Array(M.colors),size:3}),M.uvs.length>0&&(k.attributes.TEXCOORD_0={value:new Float32Array(M.uvs),size:2}),k.materials=[];for(const F of C.materials){const j={name:F.name,flatShading:!F.smooth};k.materials.push(j),_.push(j)}k.name=C.name,p.push(k)}return{meshes:p,materials:_}}function nye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;for(const i in e)n=n||new Map,i!=="value"&&n.set(i,JSON.stringify(e[i]));const r=[];for(const i in t){const s=t[i],l=rye(i,s);r.push(l)}return new j0(r,n)}function rye(t,e){const n=new Map;for(const s in e)s!=="value"&&n.set(s,JSON.stringify(e[s]));const r=xhe(e.value);return!("size"in e)||e.size===1?new Cg(t,r,!1,n):new Cg(t,new vhe(e.size,new Cg("value",r)),!1,n)}function Q8(t,e){const{meshes:n}=tye(t),r=n.reduce((o,p)=>o+p.header.vertexCount,0),i=iye(n,r),s={vertexCount:r,boundingBox:_F(i)},l=nye(i,{mode:4,boundingBox:s.boundingBox});return{loaderData:{header:{}},schema:l,header:s,mode:4,attributes:i}}function iye(t,e){const n=new Float32Array(e*3);let r,i,s,l=0;for(const p of t){const{POSITION:_,NORMAL:C,COLOR_0:M,TEXCOORD_0:k}=p.attributes;n.set(_.value,l*3),C&&(r=r||new Float32Array(e*3),r.set(C.value,l*3)),M&&(i=i||new Float32Array(e*3),i.set(M.value,l*3)),k&&(s=s||new Float32Array(e*2),s.set(k.value,l*2)),l+=_.value.length/3}const o={};return o.POSITION={value:n,size:3},r&&(o.NORMAL={value:r,size:3}),i&&(o.COLOR_0={value:i,size:3}),s&&(o.TEXCOORD_0={value:s,size:2}),o}const sye="3.4.14",oye={name:"OBJ",id:"obj",module:"obj",version:sye,worker:!0,extensions:["obj"],mimeTypes:["text/plain"],testText:aye,options:{obj:{}}};function aye(t){return t[0]==="v"}const ep={...oye,parse:async(t,e)=>Q8(new TextDecoder().decode(t)),parseTextSync:(t,e)=>Q8(t)},lye=ss().domain([0,1]).range(wh(0,aa.length)),Aye=aa[0];class Lh extends Vn{initializeState(){super.initializeState();const{zoom:e}=this.context.viewport,n=Object.keys(this.props.data).map(s=>parseInt(s)),r=ur().domain(this.props.zoomRange).range([0,1]).clamp(!0),i=ss().domain([0,1]).range(n)(r(e));this.setState({hextiles:this.props.data,resRange:n,lastResolution:i,valueInterpResolution:r}),this.createPolygons()}createPolygons(){const{hextiles:e,lastResolution:n}=this.state,r=[],i=e[n],[s,l]=this.props.offset;Object.keys(i).forEach(o=>{const p=i[o],_=W8(H8(o)[0],Ar.km)*.48,[C,M]=P4(o);let k=0;const F=ws(n,Ar.km)/ws(5,Ar.km);for(let[j,H,ie]of this.props.getValue?Aye:[[0,0,0]])r.push({position:[M+(j+s)*_/(111.32*Math.cos(C*Math.PI/180)),C+(H+l)*_/110.574,(typeof this.props.getElevation=="function"?this.props.getElevation({properties:p}):this.props.getElevation)+ie*1e5*F],properties:p,polyIdx:k++,hexID:o})}),this.setState({...this.state,polygons:r})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:l,changeFlags:o,context:p}=e;if(s.getElevation!=l.getElevation||o.viewportChanged){const _=ss().domain([0,1]).range(n)(i(p.viewport.zoom));(_!=r||s.getElevation!=l.getElevation)&&(this.setState({...this.state,lastResolution:_}),this.createPolygons())}}renderLayers(){const{polygons:e,lastResolution:n,resRange:r}=this.state,i=ws(n,Ar.km)/ws(5,Ar.km);return[new Iv(this.getSubLayerProps({data:this.props.data,mesh:this.props.mesh,texture:this.props.texture,textureParameters:this.props.textureParameters,getPosition:this.props.getPosition,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,sizeScale:this.props.sizeScale,_useMeshColors:this.props._useMeshColors,_instanced:this.props._instanced,wireframe:this.props.wireframe,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,id:"IconHexTileLayer",data:e,getPosition:s=>s.position,sizeScale:this.props.sizeScale*i,getTranslation:this.props.getValue===null?[0,0,0]:s=>{const l=aa[lye(this.props.getValue(s))][s.polyIdx],o=aa[0][s.polyIdx],p=W8(H8(s.hexID)[0],Ar.m)*.5;return[(l[0]-o[0])*p,(l[1]-o[1])*p,(l[2]-o[2])*1e5*i]}}))]}}Lh.layerName="IconHexTileLayer";Lh.defaultProps={...Vn.defaultProps,...Iv.defaultProps,thicknessRange:[.7,.9],getValue:null,getElevation:()=>0,offset:[0,0],zoomRange:[7,9]};function q8(t,e,n=1){const r=n,[i,s]=P4(t);return e.map(o=>{let p=wl(s,o[0],r),_=wl(i,o[1],r);return[p,_]})}function uye(t,[e,n]){let r=W1e(t).map(l=>[l[1],l[0]]),i=q8(t,r,n),s=q8(t,r,e);return[i,s]}class mo extends Vn{initializeState(){super.initializeState();const e=Object.keys(this.props.data).map(i=>parseInt(i)),n=ur().domain(this.props.zoomRange).range([0,1]).clamp(!0),r=ss().domain([0,1]).range(e)(n(this.context.viewport.zoom));this.setState({...this.state,resRange:e,lastResolution:r,valueInterpResolution:n}),this.createPolygons()}createPolygons(){const{lastResolution:e}=this.state,n=[],r=this.props.data[e];Object.keys(r).forEach((i,s)=>{let l=r[i];const o=this.props.getValue?ur().domain([0,1]).range([this.props.thicknessRange[1],this.props.thicknessRange[0]])(this.props.getValue({properties:l})):this.props.thicknessRange[0];let p=uye(i,[o,this.props.thicknessRange[1]]);this.props.raised?n.push({polygon:p.map(_=>_.map(([C,M])=>[C,M,typeof this.props.getElevation=="function"?this.props.getElevation({hexId:i,properties:l}):this.props.getElevation])),hexId:i,properties:l}):n.push({hexId:i,polygon:p,properties:l})}),this.setState({...this.state,polygons:n})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:l,changeFlags:o,context:p}=e;if(s.getElevation!=l.getElevation||s.getValue!=l.getValue||o.viewportChanged){const _=ss().domain([0,1]).range(n)(i(p.viewport.zoom));(_!=r||s.getValue!=l.getValue||s.getElevation!=l.getElevation)&&(this.setState({...this.state,lastResolution:_}),this.createPolygons())}}renderLayers(){return[new Qf(this.getSubLayerProps({data:this.props.data,filled:this.props.filled,stroked:this.props.stroked,extruded:this.props.extruded,wireframe:this.props.wireframe,lineWidthUnits:this.props.lineWidthUnits,_normalize:this.props._normalize,_windingOrder:this.props._windingOrder,_full3d:this.props._full3d,elevationScale:this.props.elevationScale,getPolygon:this.props.getPolygon,getElevation:this.props.getElevation,getFillColor:this.props.getFillColor,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,onClick:this.props.onClick,id:"SolidHexTileLayer",data:this.state.polygons,getPolygon:e=>e.polygon,pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,extensions:this.props.extensions,getOffset:this.props.getOffset,lineJointRounded:this.props.lineJointRounded}))]}}mo.layerName="SolidHexTileLayer";mo.defaultProps={...Vn.defaultProps,...Qf.defaultProps,thicknessRange:[.7,.9],getValue:void 0,raised:!1,zoomRange:[7,9]};class tp extends Vn{renderLayers(){const{data:e,deagData:n,curOption:r,hoveredHex:i,visible:s,clickedHexes:l,hoveredGeoActive:o,hoveredGeos:p,selectedGeoJSON:_,selectedGeos:C,selectionFinalized:M,zoomRange:k,getFillColor:F}=this.props;return[new as({id:"GeoJsonGray",data:n,opacity:.3,stroked:!1,getFillColor:j=>!M&&j.properties.id in p?[100,100,100,205*p[j.properties.id]+50]:[0,0,0,0],visible:s&&!M,updateTriggers:{getFillColor:[i,M]}}),new as({id:"GeoJsonColor",data:n,opacity:1,pickable:!0,visible:s,getLineWidth:j=>j.properties.id in C?j.properties.id==o?100:20:0,getFillColor:j=>{if(j.properties.id in C){if(j.properties.id==o){const H=[0,0,.5019607843137255,.5019607843137255],ie=[...F({properties:C[j.properties.id]}),255];return[(H[0]*H[3]+ie[0]/255*(1-H[3]))*255,(H[1]*H[3]+ie[1]/255*(1-H[3]))*255,(H[2]*H[3]+ie[2]/255*(1-H[3]))*255,(H[3]*H[3]+ie[3]/255*(1-H[3]))*255]}return[...F({properties:C[j.properties.id]}),255]}return[0,0,0,0]},getLineColor:[0,0,0],updateTriggers:{getFillColor:[...this.props.updateTriggers.getFillColor||[],o,r,M],getLineWidth:[o,r,M]}}),new mo({id:"HoveringTiles",data:e,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:!M,autoHighlight:!M,visible:s,zoomRange:k})]}}tp.layerName="DeaggregatedLayer";tp.defaultProps={...Vn.defaultProps,autoHighlight:!0};const qh=0;let I4=class extends Vn{renderLayers(){const{data:e,curOption:n,speedyCounter:r,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new mo({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:p=>hr.groundwater.interpVsup(p.properties.Groundwater[r],p.properties.GroundwaterVar[r]),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o}),new mo({id:"DiffRings",data:e,thicknessRange:[.4,.65],getFillColor:p=>n==0?hr.difference.interpVsup(p.properties.UnmetDemand[mr[qh]][r]-p.properties.UnmetDemandBaseline[r],Od(p.properties.UnmetDemandBaselineVar[r],p.properties.UnmetDemandVar[mr[qh]][r]),!0):hr.difference.interpColor(p.properties.UnmetDemand[mr[qh]][r]-p.properties.UnmetDemandBaseline[r],!0),getValue:p=>n==0?1:hr.difference.scaleLinearVar(Od(p.properties.UnmetDemandBaselineVar[r],p.properties.UnmetDemandVar[mr[qh]][r]))*.8+.2,raised:!0,visible:l,getElevation:p=>p.hexId in i?5e3:0,getLineWidth:p=>p.hexId in i?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new qf({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r],getElevation:[s],getLineWidth:[s]},zoomRange:o}),new Lh({id:"ScenarioUnmet",data:e,loaders:[ep],mesh:"./assets/drop.obj",raised:!0,getColor:p=>[255,130,35,hr.unmetDemand.scaleLinearVar(p.properties.UnmetDemandVar[mr[qh]][r])*200+55],getValue:p=>hr.unmetDemand.scaleLinear(p.properties.UnmetDemand[mr[qh]][r]),visible:l,sizeScale:3e3,opacity:1,updateTriggers:{getTranslation:[r]},zoomRange:o}),new tp({...this.props,id:"DeagLayer",data:e,deagData:Tl,getFillColor:p=>hr.unmetDemand.interpColor(p.properties.UnmetDemand[mr[qh]][r],!1,!1),updateTriggers:{getFillColor:[r]}})]}};I4.layerName="MultivariableHextileLayer";I4.defaultProps={...Vn.defaultProps,autoHighlight:!0};function cye(){const{current:t}=De.useRef(Object.keys(Nd).map(o=>parseInt(o))),[e,n]=De.useState(Fd.zoom),r=Uv(),i=Yf({disabled:r.curOption>1,dataDeag:Tl,deagKey:"DURgs"}),{getTooltip:s}=S4(r),l={data:Nd,...r,...i};return Ye.createElement(Ye.Fragment,null,Ye.createElement(_c,{controller:!0,effects:[bA],initialViewState:Fd,getTooltip:s,onViewStateChange:({viewState:o})=>{n(o.zoom)}},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga}),Ye.createElement(Jm,{id:"slide-terrain",...l}),Ye.createElement(I4,{id:"slide-waters",...l,zoomRange:[7,9],visible:!0})),Ye.createElement(Z1e,{...l,res:ss().domain([0,1]).range(t)(ur().domain([7,9]).range([0,1]).clamp(!0)(e))}))}function hye(){const[t,e]=De.useState(1027),[n,r]=De.useState(!1),[i,s]=De.useState(1);return De.useEffect(()=>{if(n){let l=setTimeout(()=>e(o=>o%1199+1),33.333333333333336);return function(){clearTimeout(l)}}},[t,n]),{speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r,curOption:i,setCurOption:s}}function fye({dataDeag:t,disabled:e=!1,deagKey:n}){const{current:r}=De.useRef(T7(t.features,he=>he.properties.id)),[i,s]=De.useState(null),[l,o]=De.useState({}),[p,_]=De.useState([]),[C,M]=De.useState({}),[k,F]=De.useState({type:"FeatureCollection",features:[]}),[j,H]=De.useState({}),[ie,Y]=De.useState(!1),J=De.useCallback(({object:he})=>{if(!he){s(null),o({}),_([]);return}if(!e){if(ie)s(null),o({}),_(he.properties.id);else if(he.properties[n]){const pe=Q2.h3ToFeature(he.hexId),be={};for(const Ge of he.properties[n]){const We=r[Ge],Xe=j2(pe,We.geometry);be[We.properties.id]=V2(Xe)/V2(pe)}o(be),s(he.hexId)}return!0}},[C,ie,e,n]),se=De.useCallback(({object:he},pe)=>{if(he.properties.id==p)return F({type:"FeatureCollection",features:[]}),H({}),M({}),Y(!1),!0;if(he.properties[n]==null)return;if(pe.srcEvent.shiftKey)return M(Xe=>({...Xe,[he.hexId]:he.properties[n]})),!0;Y(!0),s(null),o({}),_(he.properties.id),M({});const be={...C,[he.hexId]:he.properties[n]};M(be);const Ge={},We={type:"FeatureCollection",features:[]};for(const Xe in be)for(const rt of be[Xe]){const Oe=r[rt],nt=Q2.h3ToFeature(Xe),Ze=j2(nt,Oe.geometry);We.features.push({...Ze,properties:{...Oe.properties}}),Ge[Oe.properties.id]={...Oe.properties}}return H(Ge),F(We),!0},[C,p,ie,n]);return{hoveredHex:i,clickedHexes:C,hoveredGeos:l,selectedGeoJSON:k,selectedGeos:j,hoveredGeoActive:p,onHover:J,onClick:se,selectionFinalized:ie}}const Uu=0;function dye({speedyCounter:t,curOption:e}){const n=De.useRef(),r=De.useRef(),i=De.useRef({});De.useEffect(()=>{n.current=document.querySelector("#main-tooltip"),r.current=document.querySelector("#secondary-tooltip")},[]);const s=De.useCallback(_=>{const C=_.properties.Demand[mr[Uu]][t],M=-_.properties.UnmetDemand[mr[Uu]][t],k=-M-_.properties.UnmetDemandBaseline[t];n.current.classList.add("active"),r.current.classList.add("active"),r.current.innerHTML=`        <div><b>Region ID</b> ${_.properties.id}</div>
        <div><b>Scenario Demand</b> ${C}</div>
        <div><b>Scen. Unmet Demand</b> ${M}</div>
        <div><b>Difference in Unmet Demand</b> ${k}</div>
        <div><b>Land Holder</b> ${fd(_)}</div>
      `},[t]),l=De.useCallback(_=>{if(r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${N2(cf(t))}</i></div>
      `,_.properties.Demand){const C=_.properties.Demand[mr[Uu]][t],M=-_.properties.UnmetDemand[mr[Uu]][t],k=-M-_.properties.UnmetDemandBaseline[t];n.current.innerHTML+=`        
          <div><i>${U2[Uu]}</i></div>
          <div><b>Region ID</b> ${_.properties.id}</div>
          <div><b>Scenario Demand</b> ${C}</div>
          <div><b>Scen. Unmet Demand</b> ${M}</div>
          <div><b>Difference in Unmet Demand</b> ${k}</div>
          <div><b>Land Holder</b> ${fd(_)}</div>
        `}else{const C=_.properties.Groundwater[t];n.current.innerHTML+=`     
          <div><b>Elem ID</b> ${_.properties.id}</div>
          <div><b>Groundwater</b> ${C}</div>
      `}},[t]),o=De.useCallback(_=>{const C=_.properties.Demand[mr[Uu]][t],M=-_.properties.UnmetDemand[mr[Uu]][t],k=-M-_.properties.UnmetDemandBaseline[t],F=_.properties.Groundwater[t],j=_.properties.GroundwaterVar[t],H=_.properties.UnmetDemandVar[mr[Uu]][t],ie=Od(_.properties.UnmetDemandBaselineVar[t],H),Y=_.properties.DURgs.join(", "),J=_.properties.GWRgs.join(", ");r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${N2(cf(t))}</i></div>
        <div><i>${U2[Uu]}</i></div>
        <div><b>Groundwater</b> ${F}</div>
        <div><b>Scenario Demand</b> ${C}</div>
        <div><b>Scen. Unmet Demand</b> ${M}</div>
        <div><b>Difference in Unmet Demand</b> ${k}</div>
        <div><b>Land Holder</b> ${fd(_)}</div>
        <div><b>Variance (GW)</b> ${j}</div>
        <div><b>Var. (Scen. UnmetDem)</b> ${H}</div>
        <div><b>Var. (Difference)</b> ${ie}</div>
        <div><b>Demand Regions</b> ${Y}</div>
        <div><b>GW Regions</b> ${J}</div>
      `},[t]);return{getTooltip:De.useCallback(({object:_})=>{if(!_){i.current&&(r.current.classList.remove("active"),Th(i.current)&&n.current.classList.remove("active"),i.current=_),e>1&&(r.current.classList.remove("active"),n.current.classList.remove("active"));return}e<=1&&Th(_)?o(_):e<=1&&Ym(_)?s(_):l(_),i.current=_},[t,e])}}let L4=class extends Vn{renderLayers(){return[new Eh({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new bh(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}};L4.layerName="BaseTerrainLayer";L4.defaultProps={...Vn.defaultProps};const Z8=0;let D4=class extends Vn{renderLayers(){const{curOption:e,speedyCounter:n}=this.props;return[new as({id:"GroundwaterGeo",data:x4,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...hr.groundwater.interpColor(r.properties.Groundwater[n]),255],visible:e==2,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new as({id:"UDemGeo",data:Tl,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...hr.unmetDemand.interpColor(r.properties.UnmetDemand[mr[Z8]][n]),255],visible:e==3,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new as({id:"DemDiffGeo",data:Tl,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...hr.difference.interpColor(r.properties.UnmetDemand[mr[Z8]][n]-r.properties.UnmetDemandBaseline[n]),255],visible:e==4,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0})]}};D4.layerName="BasicGeoLayer";D4.defaultProps={...Vn.defaultProps,autoHighlight:!0};function pye({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s}){return Ye.createElement(Ye.Fragment,null,Ye.createElement(Hv,{counter:n,displayMonth:!1,dataset:"averageDemandBaseline"}),Ye.createElement("div",{className:"styled-input"},Ye.createElement("button",{onClick:()=>{s(l=>!l)}},i?"Pause":"Play"),Ye.createElement("div",null,Ye.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:n,onChange:function(l){r(parseInt(l.target.value))}}),Ye.createElement("input",{onChange:function(l){s(!1),r(parseInt(l.target.value))},onInput:function(l){r(parseInt(l.target.value))},value:n,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))))}function J7(t){const[e,n,r]=t.split("/"),i=R4(r);return[parseFloat(e)+i/2,parseFloat(n)+i/2]}function gye(t,e,n=1,r){const i=n,[s,l]=J7(t),o=eN(t),p=R4(o)/4*i;return e.map(C=>{let M=wl(l,C[0],i),k=wl(s,C[1],i);return[M+p*r[0],k+p*r[1]]})}function eN(t){const[e,n,r]=t.split("/");return parseInt(r)}function mye(t){const[e,n]=J7(t),r=eN(t),i=R4(r)/4;return[[e+i,n-i],[e+i,n+i],[e-i,n+i],[e-i,n-i]]}function yye(t){return t/111.1}function _ye(t){return ws(parseInt(t),Ar.km)*2}function R4(t){return yye(_ye(t))}function vye(t,[e,n],r){let i=mye(t).map(l=>[l[1],l[0]]);return[gye(t,i,1-e,r)]}class zs extends Vn{initializeState(){super.initializeState();const e=Object.keys(this.props.data).map(i=>parseInt(i)),n=ur().domain(this.props.zoomRange).range([0,1]).clamp(!0),r=ss().domain([0,1]).range(e)(n(this.context.viewport.zoom));this.setState({...this.state,resRange:e,lastResolution:r,valueInterpResolution:n}),this.createPolygons()}createPolygons(){const{lastResolution:e}=this.state,n=[],r=this.props.data[e];Object.keys(r).forEach((i,s)=>{let l=r[i];const o=this.props.getValue?ur().domain([0,1]).range([this.props.thicknessRange[1],this.props.thicknessRange[0]])(this.props.getValue({properties:l})):this.props.thicknessRange[0];let p=vye(i,[o,this.props.thicknessRange[1]],this.props.offset);this.props.raised?n.push({polygon:p.map(_=>_.map(([C,M])=>[C,M,typeof this.props.getElevation=="function"?this.props.getElevation({hexId:i,properties:l}):this.props.getElevation])),hexId:i,properties:l}):n.push({hexId:i,polygon:p,properties:l})}),this.setState({...this.state,polygons:n})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:l,changeFlags:o,context:p}=e;if(s.getElevation!=l.getElevation||s.getValue!=l.getValue||o.viewportChanged){const _=ss().domain([0,1]).range(n)(i(p.viewport.zoom));(_!=r||s.getValue!=l.getValue||s.getElevation!=l.getElevation)&&(this.setState({...this.state,lastResolution:_}),this.createPolygons())}}renderLayers(){return[new Qf(this.getSubLayerProps({data:this.props.data,filled:this.props.filled,stroked:this.props.stroked,lineWidthUnits:this.props.lineWidthUnits,extruded:this.props.extruded,wireframe:this.props.wireframe,_normalize:this.props._normalize,_windingOrder:this.props._windingOrder,_full3d:this.props._full3d,elevationScale:this.props.elevationScale,getPolygon:this.props.getPolygon,getElevation:this.props.getElevation,getFillColor:this.props.getFillColor,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,onClick:this.props.onClick,id:"SolidSquareTileLayer",data:this.state.polygons,getPolygon:e=>e.polygon,pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,extensions:this.props.extensions,getOffset:this.props.getOffset,lineJointRounded:this.props.lineJointRounded}))]}}zs.layerName="SolidSquareTileLayer";zs.defaultProps={...Vn.defaultProps,...Qf.defaultProps,thicknessRange:[0,1],getValue:void 0,raised:!1,zoomRange:[7,9],offset:[0,0]};const Y8=0;let B4=class extends Vn{renderLayers(){const{data:e,curOption:n,speedyCounter:r,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new zs({id:"SquareBorders",data:e,getFillColor:[0,0,0,0],getLineColor:[80,80,80,100],stroked:!0,lineWidthUnits:"pixels",getValue:p=>2,visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[0,0]}),new zs({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:p=>hr.groundwater.interpColor(450),getValue:p=>hr.groundwater.scaleLinear(p.properties.Groundwater[r]),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o,offset:[1,1]}),new zs({id:"Difference",data:e,thicknessRange:[0,1],getFillColor:p=>hr.difference.interpColor(18,!1),getValue:p=>hr.difference.scaleLinear(p.properties.UnmetDemand[mr[Y8]][r]-p.properties.UnmetDemandBaseline[r]),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o,offset:[1,-1]}),new zs({id:"UnmetDemand",data:e,thicknessRange:[0,1],getFillColor:p=>hr.difference.interpColor(-18,!1),getValue:p=>hr.unmetDemand.scaleLinear(p.properties.UnmetDemand[mr[Y8]][r]),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o,offset:[-1,-1]})]}};B4.layerName="MultivariableHextileLayer";B4.defaultProps={...Vn.defaultProps,autoHighlight:!0};function xye(){const t=hye(),e=fye({disabled:t.curOption>1,dataDeag:Tl,deagKey:"DURgs"}),{getTooltip:n}=dye(t),r={data:Uge,...t,...e};return Ye.createElement(Ye.Fragment,null,Ye.createElement(_c,{controller:!0,effects:[bA],initialViewState:Fd,getTooltip:n},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga}),Ye.createElement(L4,{id:"slide-terrain",...r}),Ye.createElement(B4,{id:"slide-waters",...r,zoomRange:[7,9],visible:!0}),Ye.createElement(D4,{id:"slide-basic",...r})),Ye.createElement(pye,{...r}))}const Mb=512,wye=Math.PI/180;function tN({map:t,gl:e,deck:n}){if(t.__deck)return t.__deck;const r=n?.props._customRender,i=n?.props.onLoad,s=rN({...n?.props,_customRender:()=>{t.triggerRepaint(),r?.("")}});let l;return(!n||n.props.gl===e)&&(Object.assign(s,{gl:e,width:null,height:null,touchAction:"unset",viewState:Em(t)}),n!=null&&n.isInitialized?X8(n,t):s.onLoad=()=>{i?.(),X8(l,t)}),n?(l=n,n.setProps(s),n.userData.isExternal=!0):(l=new Ef(s),t.on("remove",()=>{nN(t)})),l.userData.mapboxLayers=new Set,t.__deck=l,t.on("render",()=>{l.isInitialized&&Mye(l,t)}),l}function X8(t,e){const n=()=>{t.isInitialized?Pye(t,e):e.off("move",n)};e.on("move",n)}function nN(t){var e;(e=t.__deck)===null||e===void 0||e.finalize(),t.__deck=null}function rN(t){return{...t,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...t.parameters},views:t.views||[new tc({id:"mapbox"})]}}function bye(t,e){t.userData.mapboxLayers.add(e),z4(t)}function Eye(t,e){t.userData.mapboxLayers.delete(e),z4(t)}function Tye(t,e){z4(t)}function Sye(t,e,n){let{currentViewport:r}=t.userData,i=!1;r||(r=iN(t,e,!0),t.userData.currentViewport=r,i=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[r],layerFilter:({layer:s})=>n.id===s.id||s.props.operation.includes("terrain"),clearStack:i,clearCanvas:!1})}function Em(t){var e;const{lng:n,lat:r}=t.getCenter(),i={longitude:(n+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return(e=t.getTerrain)!==null&&e!==void 0&&e.call(t)&&Cye(t,i),i}function Cye(t,e){if(t.getFreeCameraOptions){const{position:n}=t.getFreeCameraOptions();if(!n||n.z===void 0)return;const r=t.transform.height,{longitude:i,latitude:s,pitch:l}=e,o=n.x*Mb,p=(1-n.y)*Mb,_=n.z*Mb,C=gA([i,s]),M=o-C[0],k=p-C[1],F=Math.sqrt(M*M+k*k),j=l*wye,H=1.5*r,ie=j<.001?H*Math.cos(j)/_:H*Math.sin(j)/F;e.zoom=Math.log2(ie);const Y=H*Math.cos(j)/ie,J=_-Y;e.position=[0,0,J/Hy(s)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function iN(t,e,n=!0){return new cc({id:"mapbox",x:0,y:0,width:t.width,height:t.height,...Em(e),nearZMultiplier:n?.02:.1,nearZ:e.transform._nearZ/e.transform.height,farZ:e.transform._farZ/e.transform.height})}function Mye(t,e){const{mapboxLayers:n,isExternal:r}=t.userData;if(r){const i=Array.from(n,C=>C.id),l=bf(t.props.layers,Boolean).some(C=>C&&!i.includes(C.id));let o=t.getViewports();const p=o.findIndex(C=>C.id==="mapbox"),_=o.length>1||p<0;(l||_)&&(p>=0&&(o=o.slice(),o[p]=iN(t,e,!1)),t._drawLayers("mapbox-repaint",{viewports:o,layerFilter:C=>(!t.props.layerFilter||t.props.layerFilter(C))&&(C.viewport.id!=="mapbox"||!i.includes(C.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function Pye(t,e){t.setProps({viewState:Em(e)}),t.needsRedraw({clearRedrawFlags:!0})}function z4(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(n=>{const r=n.props.type,i=new r(n.props);e.push(i)}),t.setProps({layers:e})}class kye{constructor(e){if(oe(this,"id",void 0),oe(this,"type",void 0),oe(this,"renderingMode",void 0),oe(this,"map",void 0),oe(this,"deck",void 0),oe(this,"props",void 0),!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}onAdd(e,n){this.map=e,this.deck=tN({map:e,gl:n,deck:this.props.deck}),bye(this.deck,this)}onRemove(){this.deck&&Eye(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&Tye(this.deck)}render(){Sye(this.deck,this.map,this)}}const Pb="__UNDEFINED__";function Ty(t,e,n,r){if(!t||!e||!t.style||!t.style._loaded)return;const i=bf(r,Boolean);if(n!==r){const o=bf(n,Boolean),p=new Set(o.map(_=>_.id));for(const _ of i)p.delete(_.id);for(const _ of p)t.getLayer(_)&&t.removeLayer(_)}for(const o of i){const p=t.getLayer(o.id);p?p.implementation.setProps(o.props):t.addLayer(new kye({id:o.id,deck:e}),o.props.beforeId)}const s=t.style._order,l={};for(const o of i){let{beforeId:p}=o.props;(!p||!s.includes(p))&&(p=Pb),l[p]=l[p]||[],l[p].push(o.id)}for(const o in l){const p=l[o];let _=o===Pb?s.length:s.indexOf(o),C=o===Pb?void 0:o;for(let M=p.length-1;M>=0;M--){const k=p[M],F=s.indexOf(k);F!==_-1&&(t.moveLayer(k,C),F>_&&_++),_--,C=k}}}class Iye{constructor(e){oe(this,"_props",void 0),oe(this,"_deck",void 0),oe(this,"_map",void 0),oe(this,"_container",void 0),oe(this,"_interleaved",void 0),oe(this,"_lastMouseDownPoint",void 0),oe(this,"_handleStyleChange",()=>{Ty(this._map,this._deck,this._props.layers,this._props.layers)}),oe(this,"_updateContainerSize",()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:s}=this._map.getContainer();Object.assign(this._container.style,{width:"".concat(i,"px"),height:"".concat(s,"px")})}}),oe(this,"_updateViewState",()=>{const i=this._deck;i&&(i.setProps({viewState:Em(this._map)}),i.isInitialized&&i.redraw())}),oe(this,"_handleMouseEvent",i=>{const s=this._deck;if(!s||!s.isInitialized)return;const l={type:i.type,offsetCenter:i.point,srcEvent:i},o=this._lastMouseDownPoint;switch(!i.point&&o&&(l.deltaX=i.originalEvent.clientX-o.clientX,l.deltaY=i.originalEvent.clientY-o.clientY,l.offsetCenter={x:o.x+l.deltaX,y:o.y+l.deltaY}),l.type){case"mousedown":s._onPointerDown(l),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":l.type="panstart",s._onEvent(l);break;case"drag":l.type="panmove",s._onEvent(l);break;case"dragend":l.type="panend",s._onEvent(l);break;case"click":l.tapCount=1,s._onEvent(l);break;case"dblclick":l.type="click",l.tapCount=2,s._onEvent(l);break;case"mousemove":l.type="pointermove",s._onPointerMove(l);break;case"mouseout":l.type="pointerleave",s._onPointerMove(l);break;default:return}});const{interleaved:n=!1,...r}=e;this._interleaved=n,this._props=r}setProps(e){this._interleaved&&e.layers&&Ty(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._deck.setProps(this._interleaved?rN(this._props):this._props)}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const n=document.createElement("div");return Object.assign(n.style,{position:"absolute",left:0,top:0,pointerEvents:"none"}),this._container=n,this._deck=new Ef({...this._props,parent:n,viewState:Em(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),n}_onAddInterleaved(e){return this._deck=tN({map:e,gl:e.painter.context.gl,deck:new Ef({...this._props,gl:e.painter.context.gl})}),e.on("styledata",this._handleStyleChange),Ty(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){var n;e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),(n=this._deck)===null||n===void 0||n.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),Ty(e,this._deck,this._props.layers,[]),nN(e)}getDefaultPosition(){return"top-left"}pickObject(e){return Ui(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return Ui(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return Ui(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}const Lye=Uz(()=>Promise.resolve().then(()=>Ine),void 0),Dye=(()=>De.forwardRef(function(e,n){return Gz(e,n,Lye)}))();function Rye(){const t=Uv(),{getTooltip:e}=zye(t);return Ye.createElement(Dye,{getTooltip:e,id:"mymap",style:{width:1200,height:800},effects:[bA],light:{anchor:"viewport",color:"yellow",intensity:1},antialias:!0,interleaved:!0,initialViewState:zge,mapLib:Vo,mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",preventStyleDiffing:!0},Ye.createElement(Bye,{curInput:t}))}function Bye({curInput:t}){const{current:e}=tre();De.useEffect(()=>{if(!e)return;const n={data:Vge,...t};e.on("load",()=>{const r=new Iye({interleaved:!0,effects:[bA],layers:[new Eh({id:"carto",data:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:i=>{const{bbox:{west:s,south:l,east:o,north:p}}=i.tile;return new bh(i,{data:null,image:i.data,bounds:[s,l,o,p]})},beforeId:"waterway"}),new Eh({id:"supply",data:"http://infovis.cs.ucdavis.edu/mapProxy/wmts/fbfm40/webmercator/{z}/{x}/{y}.png",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:i=>{const{bbox:{west:s,south:l,east:o,north:p}}=i.tile;if(-(s- -119.94742725262628)<p-37.90192590898632)return new bh(i,{data:null,image:i.data,bounds:[s,l,o,p]})},beforeId:"waterway"}),new Qf({id:"ground",data:[[[-120.99582643167989,36.88453894208306],[-120.99582643167989,38.88453894208306],[-118.99582643167989,38.88453894208306],[-118.99582643167989,36.88453894208306]]],stroked:!1,getPolygon:i=>i,getFillColor:[0,0,0,0],getPolygonOffset:({layerIndex:i})=>[0,i*1e3],beforeId:"background"}),new O4({id:"slide-fire",...n,zoomRange:[9,14]})]});e.getMap().addControl(r).setLight({anchor:"viewport",color:"yellow",intensity:1})})},[])}class O4 extends Vn{renderLayers(){const{data:e,visible:n,zoomRange:r}=this.props;return[new mo({id:"DiffRings",data:e,thicknessRange:[0,1],getFillColor:i=>Zp.power.interpColor(i.properties.power,!1,!1),extruded:!0,getElevation:i=>3e3*Math.pow(Zp.power.scaleLinearVar(i.properties.confidence),4),stroked:!1,getValue:i=>Zp.power.scaleLinearVar(i.properties.confidence),visible:n,zoomRange:r}),new Lh({id:"ScenarioUnmet",raised:!0,getElevation:i=>3e3*Math.pow(Zp.power.scaleLinearVar(i.properties.confidence),4),data:e,loaders:[ep],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",getColor:[0,188,242],getValue:i=>Zp.personnel.scaleLinear(i.properties.personnel),visible:n,sizeScale:400,zoomRange:r}),new F4({...this.props,id:"DeagLayer",data:e})]}}O4.layerName="WildfireLayer";O4.defaultProps={...Vn.defaultProps,autoHighlight:!0};class F4 extends Vn{renderLayers(){const{data:e,visible:n,zoomRange:r,selectionFinalized:i=!1}=this.props;return[new mo({id:"HoveringTiles",data:e,stroked:!1,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:!i,autoHighlight:!i,visible:n,zoomRange:r})]}}F4.layerName="DeaggregatedLayer";F4.defaultProps={...Vn.defaultProps,autoHighlight:!0};function zye({speedyCounter:t,curOption:e}){const n=De.useRef(),r=De.useRef(),i=De.useRef({});De.useEffect(()=>{n.current=document.querySelector("#main-tooltip"),r.current=document.querySelector("#secondary-tooltip")},[]);const s=De.useCallback(o=>{const p=o.properties.power,_=o.properties.confidence,C=o.properties.personnel;r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`      <div><b>Power</b> ${p}</div>
      <div><b>Confidence</b> ${_}</div>
      <div><b>Personnel</b> ${C}</div>
      `},[t]);return{getTooltip:De.useCallback(({object:o})=>{if(!o){r.current.classList.remove("active"),n.current.classList.remove("active");return}s(o),i.current=o},[t,e])}}function Zv(){const[t,e]=De.useState(1);return{curOption:t,setCurOption:e}}function Yv({curOption:t}){const e=De.useRef(),n=De.useRef(),r=De.useRef({});De.useEffect(()=>{e.current=document.querySelector("#main-tooltip"),n.current=document.querySelector("#secondary-tooltip")},[]);const i=De.useCallback(p=>{e.current.classList.add("active"),n.current.classList.add("active"),n.current.innerHTML=`      <div><b>GEOID</b> ${p.properties.GEOID}</div>
      <div><b>Votes / Km2</b> ${p.properties.votes_per_sqkm}</div>
      <div><b>Percent Dem. Lead</b> ${p.properties.pct_dem_lead}</div>
    `},[]),s=De.useCallback(p=>{n.current.classList.remove("active"),e.current.classList.add("active"),p.properties.pct_dem_lead?e.current.innerHTML=`        <div><b>GEOID</b> ${p.properties.GEOID}</div>
        <div><b>Votes / Km2</b> ${p.properties.votes_per_sqkm}</div>
        <div><b>% Dem. Lead</b> ${p.properties.pct_dem_lead}</div>
      `:e.current.innerHTML=`        <div><b>County Subdiv.</b> ${p.properties["county_subdivision_dec_Geographic Area Name"]}</div>
        <div><b>GEOID</b> ${p.properties.GEOID}</div>
        <div><b>% PoC</b> ${100-p.properties["county_subdivision_dec_Percent White"]}</div>
        <div><b>Pop. / Km2</b> ${p.properties["Population per Sqkm"]}</div>
      `},[]),l=De.useCallback(p=>{n.current.classList.remove("active"),e.current.classList.add("active"),e.current.innerHTML=`    <div><b>% PoC</b> ${p.properties.PoC}</div>
    <div><b>% PoC Var</b> ${p.properties.PoCVar}</div>
      <div><b>Pop. Den</b> ${p.properties.PopSqKm}</div>
      <div><b>Pop. Den Var</b> ${p.properties.PopSqKmVar}</div>
      <div><b>% Dem. Lead</b> ${p.properties.DemLead}</div>
      <div><b>% Dem. Lead Var</b> ${p.properties.DemLeadVar}</div>
      <div><b>Num. of County Subdivs</b> ${p.properties.CountyRgs.length}</div>
      <div><b>Num. of Precincts</b> ${p.properties.PrecinctRgs.length}</div>
      `},[]);return{getTooltip:De.useCallback(({object:p})=>{if(!p){r.current&&(n.current.classList.remove("active"),Th(r.current)&&e.current.classList.remove("active"),r.current=p),t>1&&(n.current.classList.remove("active"),e.current.classList.remove("active"));return}t<=1&&Th(p)?l(p):t<=1&&Ym(p)?i(p):s(p),r.current=p},[t])}}let np=class extends Vn{renderLayers(){return[new Eh({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:2,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new bh(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}};np.layerName="BaseTerrainLayer";np.defaultProps={...Vn.defaultProps};let N4=class extends Vn{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o,useVsup:p}=this.props;return[new mo({id:"Party",data:e,thicknessRange:[0,1],getFillColor:_=>p?Mn.party.interpVsup(_.properties.DemLead||0,_.properties.DemLeadVar||0):Mn.party.interpColor(_.properties.DemLead||0),opacity:1,visible:l,updateTriggers:{getFillColor:[r,p]},zoomRange:o}),new mo({id:"White",data:e,thicknessRange:[.4,.65],getFillColor:_=>Mn.poc.interpColor(_.properties.PoC,!1),getValue:_=>p?Mn.poc.scaleLinearVar(_.properties.PoCVar)*.7+.3:1,raised:!0,visible:l,getElevation:_=>_.hexId in i?5e3:0,getLineWidth:_=>_.hexId in i?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new qf({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r,p],getElevation:[s],getLineWidth:[s]},zoomRange:o}),new Lh({id:"Population",data:e,loaders:[ep],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",raised:!0,getColor:_=>[255,255,7,(p?Mn.population.scaleLinearVar(_.properties.PopSqKmVar):1)*200+55],getValue:_=>Mn.population.scaleLinear(_.properties.PopSqKm),visible:l,sizeScale:400,opacity:1,updateTriggers:{getTranslation:[r],getColor:[p]},zoomRange:o}),new tp({...this.props,id:"DeagLayer",data:e,deagData:Xd,getFillColor:_=>Mn.party.interpColor(_.properties.pct_dem_lead,!1,!1)})]}};N4.layerName="MultivariableHextileLayer";N4.defaultProps={...Vn.defaultProps,autoHighlight:!0};function Oye(){const{current:t}=De.useRef(Object.keys(yA).map(_=>parseInt(_))),[e,n]=De.useState(5),[r,i]=De.useState(5),s=Zv(),l=Yf({disabled:s.curOption>1,dataDeag:Xd,deagKey:"PrecinctRgs"}),{getTooltip:o}=Yv(s),p={data:yA,...s,...l};return Ye.createElement(Ye.Fragment,null,Ye.createElement(_c,{controller:!0,effects:[bA],initialViewState:{longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:15,pitch:50.85,bearing:32.58},onViewStateChange:({viewState:_})=>{n(_.zoom)},getTooltip:o},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga}),Ye.createElement(np,{id:"slide-terrain",...p}),Ye.createElement(N4,{id:"slide-election",...p,zoomRange:[5,8],visible:s.curOption==1,useVsup:r})),Ye.createElement(Fye,{res:ss().domain([0,1]).range(t)(ur().domain([5,8]).range([0,1]).clamp(!0)(e)),useVsup:r,setUseVsup:i}))}function Fye({res:t,useVsup:e,setUseVsup:n}){const r=De.useRef(),i=De.useRef();return De.useEffect(()=>{nA(".lin-legend").style("visibility",e?"hidden":"visible"),nA(".vsup-legend-u").style("visibility",e?"visible":"hidden"),nA(".vsup-legend-v").attr("transform",`translate(0,${e?0:50})`),nA(".box1").attr("transform",`translate(0,${e?0:150})`).attr("height",e?250:100).attr("width",e?250:300),nA(".box2").attr("transform",`translate(0,${e?0:60})`).attr("height",e?170:110)},[e]),De.useLayoutEffect(()=>{const s=Ai(r.current).attr("width",window.innerWidth).attr("height",window.innerHeight),l=200,o=window.innerWidth,p=s.append("g").attr("transform",`translate(0,${window.innerHeight-l})`);p.append("g").attr("transform",`translate(0,${l-250})`).append("rect").attr("class","box1").attr("height",250).attr("width",250).attr("fill","white"),p.append("g").attr("transform",`translate(0,${l-170})`).append("rect").attr("class","box2").attr("height",170).attr("width",920).attr("x",350).attr("fill","white"),p.append("g").attr("class","vsup-legend-u").append("g").call(P7().vtitle("% Dem. Lead").utitle("Variance").scale(Mn.party.vsup).size(150).x(40).y(l-150-40)),p.append("g").attr("class","lin-legend").append("g").call($a.simpleLegend(null,250,20,".2s").title("% Dem. Lead").size(250).height(20).scale(Mn.party.colorsStepped).x(20).y(l-70));let _=400,C=l-120;p.append("g").attr("transform",`translate(${_},${C})`).append("g").attr("class","vsup-legend-v").call(v4(Mn.poc,"% PoC")),p.append("g").attr("transform",`translate(${_},${C+20})`).append("g").attr("class","vsup-legend-u").call(M7(Mn.poc)),_=750,C=l-120,p.append("g").attr("transform",`translate(${_},${C})`).append("g").attr("class","vsup-legend-v").call(_4(Mn.population,"assets/human.png","Pop. / Km2")),p.append("g").attr("transform",`translate(${_},${C+55})`).append("g").attr("class","vsup-legend-u").call(C7(Mn.population,"assets/human.png")),p.append("g").attr("transform",`translate(${o-60},${l-80})`).call(Xm(0,0,50,"rgba(146, 146, 146, 0.5)")).call(function(M){i.current=[M.append("text").attr("x",0).attr("y",8).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${ci(".2s")(_A(t,Ar.km2))} km²`),M.append("text").attr("x",0).attr("y",55).attr("text-anchor","middle").style("font-size","11px").text(`← ${ci(".2s")(ws(t,Ar.km))} km →;`)]})},[]),Ye.createElement(Ye.Fragment,null,Ye.createElement("svg",{className:"legend-area",ref:r}),Ye.createElement("div",{className:"study-input"},Ye.createElement("input",{type:"checkbox",checked:e,onChange:()=>n(s=>!s)}),Ye.createElement("span",null,"Use VSUP")))}const K8=0;function Nye(){const t=Uv(),e=Yf({disabled:t.curOption>1,dataDeag:Tl,deagKey:"DURgs"}),{getTooltip:n}=S4({...t,curOption:100}),r={data:Nd,...t,...e},[i,s]=De.useState(Fd),l=De.useCallback(({viewId:o,viewState:p})=>{s({one:p,two:p,three:p})},[]);return Ye.createElement(Ye.Fragment,null,Ye.createElement(_c,{controller:!0,effects:[bA],viewState:i,onViewStateChange:l,getTooltip:n,layerFilter:({layer:o,viewport:p})=>o.id=="slide-terrain"||o.id=="GroundwaterGeo"&&p.id=="one"||o.id=="UDemGeo"&&p.id=="two"||o.id=="DemDiffGeo"&&p.id=="three",views:[new tc({id:"one",x:"0%",y:"0%",height:"50%",width:"50%",controller:!0}),new tc({id:"two",x:"50%",y:"0%",height:"50%",width:"50%",controller:!0}),new tc({id:"three",x:"25%",y:"50%",height:"50%",width:"50%",controller:!0})]},Ye.createElement(El,{id:"one"},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga})),Ye.createElement(El,{id:"two"},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga})),Ye.createElement(El,{id:"three"},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga})),Ye.createElement(Jm,{id:"slide-terrain",...r}),Ye.createElement(as,{id:"GroundwaterGeo",data:x4,opacity:1,stroked:!1,filled:!0,getFillColor:o=>[...hr.groundwater.interpColor(o.properties.Groundwater[t.speedyCounter]),255],updateTriggers:{getFillColor:[t.speedyCounter]},pickable:!0,autoHighlight:!0}),Ye.createElement(as,{id:"UDemGeo",data:Tl,opacity:1,stroked:!1,filled:!0,getFillColor:o=>[...hr.unmetDemand.interpColor(o.properties.UnmetDemand[mr[K8]][t.speedyCounter]),255],updateTriggers:{getFillColor:[t.speedyCounter]},pickable:!0,autoHighlight:!0}),Ye.createElement(as,{id:"DemDiffGeo",data:Tl,opacity:1,stroked:!1,filled:!0,getFillColor:o=>[...hr.difference.interpColor(o.properties.UnmetDemand[mr[K8]][t.speedyCounter]-o.properties.UnmetDemandBaseline[t.speedyCounter]),255],updateTriggers:{getFillColor:[t.speedyCounter]},pickable:!0,autoHighlight:!0})),Ye.createElement(Uye,{...r}))}function Uye({speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r}){return Ye.createElement(Ye.Fragment,null,Ye.createElement(Hv,{counter:t,displayMonth:!1,dataset:"averageDemandBaseline"}),Ye.createElement(Vye,null),Ye.createElement("div",{className:"styled-input"},Ye.createElement("button",{onClick:()=>{r(i=>!i)}},n?"Pause":"Play"),Ye.createElement("div",null,Ye.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:t,onChange:function(i){e(parseInt(i.target.value))}}),Ye.createElement("input",{onChange:function(i){r(!1),e(parseInt(i.target.value))},onInput:function(i){e(parseInt(i.target.value))},value:t,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))))}function Vye({}){const t=De.useRef();return De.useLayoutEffect(()=>{Ai(t.current).attr("width",400).attr("height",500).call(function(r){r.append("g").call($a.simpleLegend().title("Groundwater").size(250).height(20).scale(hr.groundwater.colorsStepped).x(400-280).y(500-240))}).call(function(r){r.append("g").call($a.simpleLegend().title("Scenario Unmet Demand").size(250).height(20).scale(hr.unmetDemand.colorsStepped).x(400-280).y(500-170))}).call(function(r){r.append("g").call($a.simpleLegend().title("Difference w/ Baseline").size(250).height(20).scale(hr.difference.colorsStepped).x(400-280).y(500-100))})},[]),Ye.createElement("svg",{className:"legend-area",ref:t})}const Gye=Object.keys(Km).map(t=>parseInt(t));function $ye(){const[t,e]=De.useState(5),n=Zv(),r=Yf({disabled:n.curOption>1,dataDeag:Xd,deagKey:"PrecinctRgs"}),{getTooltip:i}=Yv(n),s={data:Km,...n,...r};return Ye.createElement(Ye.Fragment,null,Ye.createElement(_c,{controller:!0,effects:[bA],initialViewState:{longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:15,pitch:50.85,bearing:32.58},getTooltip:i,onViewStateChange:({viewState:l})=>{e(l.zoom)}},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga}),Ye.createElement(np,{id:"slide-terrain",...s}),Ye.createElement(U4,{id:"slide-election",...s,zoomRange:[5,8],visible:!0})),Ye.createElement(jye,{res:ss().domain([0,1]).range(Gye)(ur().domain([5,8]).range([0,1]).clamp(!0)(t)),...s}))}class U4 extends Vn{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new zs({id:"SquareBorders",data:e,getFillColor:[0,0,0,0],getLineColor:[80,80,80,100],stroked:!0,lineWidthUnits:"pixels",getValue:p=>2,visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[0,0]}),new zs({id:"PoC",data:e,getFillColor:[0,121,42],getValue:p=>Mn.poc.scaleLinear(p.properties.PoC),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[-1,-1]}),new zs({id:"Dem",data:e,getFillColor:[72,30,197],getValue:p=>Mn.party.scaleLinear(p.properties.DemLead>0?p.properties.DemLead*2-100:-100),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[-1,1]}),new zs({id:"Repub",data:e,getFillColor:[165,0,38],getValue:p=>Mn.party.scaleLinear(p.properties.DemLead<0?-p.properties.DemLead*2-100:-100),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[1,1]}),new zs({id:"Pop",data:e,getFillColor:[156,156,156],getValue:p=>Mn.population.scaleLinear(p.properties.PopSqKm),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[1,-1]})]}}U4.layerName="MultivariableSquareTileLayer";U4.defaultProps={...Vn.defaultProps,autoHighlight:!0};function J8(t){return ws(parseInt(t),Ar.km)*2}function jye({res:t}){const e=De.useRef(),n=De.useRef();return De.useLayoutEffect(()=>{const r=window.innerHeight,i=window.innerWidth,s=Ai(e.current).attr("width",i).attr("height",r);s.append("g").attr("transform",`translate(${i-60},${r-170})`).call(l=>{l.append("rect").attr("x",-50).attr("y",-50).attr("width",100).attr("height",100).attr("fill","rgba(146, 146, 146, 0.5)")}).call(function(l){n.current=[l.append("text").attr("x",0).attr("y",8).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${ci(".2s")(_A(t,Ar.km2))} km²`),l.append("text").attr("x",0).attr("y",55).attr("text-anchor","middle").style("font-size","11px").text(`← ${ci(".2s")(ws(t,Ar.km))} km →;`)]}),s.append("g").attr("transform",`translate(120,${r-140})`).call(l=>{l.append("rect").attr("x",-120).attr("y",-140).attr("width",459).attr("height",240).attr("fill","rgba(255, 255, 255, 1)");const o=75;l.append("text").attr("x",o).attr("y",-o-15).style("font-weight","bold").attr("text-anchor","middle").text("Measure Type"),l.append("rect").attr("x",0).attr("y",-o).attr("width",o).attr("height",o).attr("fill","rgba(72, 30, 197, 0.7)"),l.append("rect").attr("x",o).attr("y",-o).attr("width",o).attr("height",o).attr("fill","rgba(165, 0, 38, 0.7)"),l.append("rect").attr("x",o).attr("y",0).attr("width",o).attr("height",o).attr("fill","rgba(156, 156, 156, 0.7)"),l.append("rect").attr("x",0).attr("y",0).attr("width",o).attr("height",o).attr("fill","rgba(0, 121, 42, 0.7)");let p,_;p=[100,0],_=Qu().range([0,o]).domain([p[0],-(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(0,${-o})`).call(r2(_)),p=Mn.poc.scaleLinear.domain(),_=Qu().range([0,o]).domain([p[0],(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform","translate(0,0)").call(r2(_)),p=[-100,0],_=Qu().range([0,o]).domain([p[0],-(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(${o*2},${-o})`).call(nm(_)),p=Mn.population.scaleLinear.domain(),_=Qu().range([0,o]).domain([p[0],(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(${o*2},0)`).call(nm(_)),l.append("text").attr("x",-20).attr("y",-18).attr("text-anchor","end").text("% Dem. Lead"),l.append("text").attr("x",o*2+20).attr("y",-18).attr("text-anchor","start").text("% Rep. Lead"),l.append("text").attr("x",o*2+20).attr("y",0+12).attr("text-anchor","start").text("Pop. / Km2"),l.append("text").attr("x",-20).attr("y",0+12).attr("text-anchor","end").text("% PoC")})},[]),De.useEffect(()=>{let[r,i]=n.current;r.text(`${ci(".2s")(Math.pow(J8(t),2))} km²`),i.text(`← ${ci(".2s")(J8(t))} km →;`)},[t]),Ye.createElement(Ye.Fragment,null,Ye.createElement("svg",{className:"legend-area",ref:e}))}function Hye(){const t=Zv(),e=Yf({disabled:t.curOption>1,dataDeag:Xd,deagKey:"PrecinctRgs"}),{getTooltip:n}=Yv({...t,curOption:100}),r={data:yA,...t,...e},[i,s]=De.useState({longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:15,pitch:50.85,bearing:32.58}),l=De.useCallback(({viewId:o,viewState:p})=>{s({one:p,two:p,three:p})},[]);return Ye.createElement(Ye.Fragment,null,Ye.createElement(_c,{controller:!0,effects:[bA],viewState:i,onViewStateChange:l,getTooltip:n,layerFilter:({layer:o,viewport:p})=>o.id=="slide-terrain"||o.id=="Pop"&&p.id=="one"||o.id=="Votes"&&p.id=="two"||o.id=="Demog"&&p.id=="three",views:[new tc({id:"one",x:"0%",y:"0%",height:"50%",width:"50%",controller:!0}),new tc({id:"two",x:"50%",y:"0%",height:"50%",width:"50%",controller:!0}),new tc({id:"three",x:"25%",y:"50%",height:"50%",width:"50%",controller:!0})]},Ye.createElement(El,{id:"one"},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga})),Ye.createElement(El,{id:"two"},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga})),Ye.createElement(El,{id:"three"},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga})),Ye.createElement(np,{id:"slide-terrain",...r}),Ye.createElement(as,{id:"Pop",data:WE,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,getFillColor:o=>Mn.population.interpColor(o.properties["Population per Sqkm"],!1,!1),pickable:!0,autoHighlight:!0}),Ye.createElement(as,{id:"Votes",data:k7,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,getFillColor:o=>Mn.party.interpColor(o.properties.DemLeadCount,!1,!1),pickable:!0,autoHighlight:!0}),Ye.createElement(as,{id:"Demog",data:WE,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,getFillColor:o=>Mn.poc.interpColor(o.properties.PoCCount||0,!1,!1),pickable:!0,autoHighlight:!0})),Ye.createElement(Wye,{...r}))}function Wye({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s}){return Ye.createElement(Ye.Fragment,null,Ye.createElement(Qye,null))}function Qye({}){const t=De.useRef();return De.useLayoutEffect(()=>{Ai(t.current).attr("width",400).attr("height",500).call(function(r){r.append("g").call($a.simpleLegend().title("Population / Km2").size(250).height(20).scale(Mn.population.colorsStepped).x(400-280).y(500-240))}).call(function(r){r.append("g").call($a.simpleLegend().title("Percent Democrat Lead").size(250).height(20).scale(Mn.party.colorsStepped).x(400-280).y(500-170))}).call(function(r){r.append("g").call($a.simpleLegend().title("Percent PoC").size(250).height(20).scale(Mn.poc.colorsStepped).x(400-280).y(500-100))})},[]),Ye.createElement("svg",{className:"legend-area",ref:t})}function qye(){const{current:t}=De.useRef(Object.keys(yA).map(o=>parseInt(o))),[e,n]=De.useState(5),r=Zv(),i=Yf({disabled:r.curOption>1,dataDeag:Xd,deagKey:"PrecinctRgs"}),{getTooltip:s}=Yv(r),l={data:yA,...r,...i};return Ye.createElement(Ye.Fragment,null,Ye.createElement(_c,{controller:!0,effects:[bA],initialViewState:{longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:15,pitch:50.85,bearing:32.58},onViewStateChange:({viewState:o})=>{n(o.zoom)},getTooltip:s},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga}),Ye.createElement(np,{id:"slide-terrain",...l}),Ye.createElement(V4,{id:"slide-election",...l,zoomRange:[5,8],visible:r.curOption==1})),Ye.createElement(Zye,{res:ss().domain([0,1]).range(t)(ur().domain([5,8]).range([0,1]).clamp(!0)(e))}))}let V4=class extends Vn{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new mo({id:"Party",data:e,thicknessRange:[0,1],getFillColor:p=>Mn.party.interpColor(p.properties.DemLead||0),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o}),new mo({id:"White",data:e,thicknessRange:[.4,.65],getFillColor:p=>Mn.poc.interpColor(p.properties.PoC,!0),getValue:p=>1,raised:!0,visible:l,getElevation:p=>p.hexId in i?5e3:0,getLineWidth:p=>p.hexId in i?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new qf({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r],getElevation:[s],getLineWidth:[s]},zoomRange:o}),new Lh({id:"Population",data:e,loaders:[ep],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",raised:!0,getColor:p=>[255,255,7,255],getValue:p=>Mn.population.scaleLinear(p.properties.PopSqKm),visible:l,sizeScale:400,opacity:1,updateTriggers:{getTranslation:[r]},zoomRange:o}),new tp({...this.props,id:"DeagLayer",data:e,deagData:Xd,getFillColor:p=>Mn.party.interpColor(p.properties.pct_dem_lead,!1,!1)})]}};V4.layerName="MultivariableHextileLayer";V4.defaultProps={...Vn.defaultProps,autoHighlight:!0};function Zye(t){return Ye.createElement(Ye.Fragment,null,Ye.createElement(Yye,{...t}))}function Yye({res:t}){const e=De.useRef(),n=De.useRef();return De.useLayoutEffect(()=>{const r=window.innerHeight,i=400,s=Ai(e.current).attr("width",i).attr("height",r);s.append("g").call($a.simpleLegend().title("Percent Dem").size(250).height(20).scale(Mn.party.colorsStepped).x(i-280).y(r-370)),s.append("g").call($a.simpleLegend().title("Percent PoC").size(250).height(20).scale(Mn.poc.colorsStepped).x(i-280).y(r-300)),s.append("g").call(Xm(i-100,r-100,70,"rgba(146, 146, 146, 0.5)")).call(function(l){n.current=[l.append("text").attr("x",i-100).attr("y",r-92).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${Math.round(_A(t,Ar.km2))} km²`),l.append("text").attr("x",i-100).attr("y",r-50).attr("text-anchor","middle").style("font-size","11px").text(`← ${Math.round(ws(t,Ar.km))} km →;`)]})},[]),De.useEffect(()=>{let[r,i]=n.current;r.text(`${Math.round(_A(t,Ar.km2))} km²`),i.text(`← ${Math.round(ws(t,Ar.km))} km →;`)},[t]),Ye.createElement("svg",{className:"legend-area",ref:e})}function Xye(){const{current:t}=De.useRef(Object.keys(Nd).map(o=>parseInt(o))),[e,n]=De.useState(Fd.zoom),r=Uv(),i=Yf({disabled:r.curOption>1,dataDeag:Tl,deagKey:"DURgs"}),{getTooltip:s}=S4(r),l={data:Nd,...r,...i};return Ye.createElement(Ye.Fragment,null,Ye.createElement(_c,{controller:!0,effects:[bA],initialViewState:Fd,getTooltip:s,onViewStateChange:({viewState:o})=>{n(o.zoom)}},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga}),Ye.createElement(Jm,{id:"slide-terrain",...l}),Ye.createElement(G4,{id:"slide-waters",...l,zoomRange:[7,9],visible:!0})),Ye.createElement(Kye,{...l,res:ss().domain([0,1]).range(t)(ur().domain([7,9]).range([0,1]).clamp(!0)(e))}))}const Zh=0;class G4 extends Vn{renderLayers(){const{data:e,curOption:n,speedyCounter:r,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new mo({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:p=>hr.groundwater.interpColor(p.properties.Groundwater[r]),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o}),new mo({id:"DiffRings",data:e,thicknessRange:[.4,.65],getFillColor:p=>n==0?hr.difference.interpVsup(p.properties.UnmetDemand[mr[Zh]][r]-p.properties.UnmetDemandBaseline[r],Od(p.properties.UnmetDemandBaselineVar[r],p.properties.UnmetDemandVar[mr[Zh]][r]),!0):hr.difference.interpColor(p.properties.UnmetDemand[mr[Zh]][r]-p.properties.UnmetDemandBaseline[r],!0),getValue:p=>n==0?1:hr.difference.scaleLinearVar(Od(p.properties.UnmetDemandBaselineVar[r],p.properties.UnmetDemandVar[mr[Zh]][r]))*.8+.2,raised:!0,visible:l,getElevation:p=>p.hexId in i?5e3:0,getLineWidth:p=>p.hexId in i?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new qf({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r],getElevation:[s],getLineWidth:[s]},zoomRange:o}),new Lh({id:"ScenarioUnmet",data:e,loaders:[ep],mesh:"./assets/drop.obj",raised:!0,getColor:p=>[255,130,35,hr.unmetDemand.scaleLinearVar(p.properties.UnmetDemandVar[mr[Zh]][r])*200+55],getValue:p=>hr.unmetDemand.scaleLinear(p.properties.UnmetDemand[mr[Zh]][r]),visible:l,sizeScale:3e3,opacity:1,updateTriggers:{getTranslation:[r]},zoomRange:o}),new tp({...this.props,id:"DeagLayer",data:e,deagData:Tl,getFillColor:p=>hr.unmetDemand.interpColor(p.properties.UnmetDemand[mr[Zh]][r],!1,!1),updateTriggers:{getFillColor:[r]}})]}}G4.layerName="MultivariableHextileLayer";G4.defaultProps={...Vn.defaultProps,autoHighlight:!0};function Kye({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s,res:l}){return Ye.createElement(Ye.Fragment,null,Ye.createElement(Hv,{counter:n,displayMonth:!1,dataset:"averageDemandBaseline"}),Ye.createElement(Jye,{res:l}),Ye.createElement("div",{className:"styled-input"},Ye.createElement("button",{onClick:()=>{s(o=>!o)}},i?"Pause":"Play"),Ye.createElement("div",null,Ye.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:n,onChange:function(o){r(parseInt(o.target.value))}}),Ye.createElement("input",{onChange:function(o){s(!1),r(parseInt(o.target.value))},onInput:function(o){r(parseInt(o.target.value))},value:n,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))))}function Jye({res:t}){const e=De.useRef(),n=De.useRef();return De.useLayoutEffect(()=>{Ai(e.current).attr("width",400).attr("height",500).call(function(s){s.append("g").call($a.simpleLegend().title("Groundwater").size(250).height(20).scale(hr.groundwater.colorsStepped).x(400-280).y(500-320))}).call(function(s){s.append("g").call($a.simpleLegend().title("Difference w/ Baseline").size(250).height(20).scale(hr.difference.colorsStepped).x(400-280).y(500-250))}).call(function(s){s.append("g").call(Xm(400-100,500-100,70,"rgba(146, 146, 146, 0.5)")).call(function(l){n.current=[l.append("text").attr("x",400-100).attr("y",500-92).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${Math.round(_A(t,Ar.km2))} km²`),l.append("text").attr("x",400-100).attr("y",500-50).attr("text-anchor","middle").style("font-size","11px").text(`← ${Math.round(ws(t,Ar.km))} km →;`)]})})},[]),De.useEffect(()=>{let[r,i]=n.current;r.text(`${Math.round(_A(t,Ar.km2))} km²`),i.text(`← ${Math.round(ws(t,Ar.km))} km →;`)},[t]),Ye.createElement("svg",{className:"legend-area",ref:e})}function e_e(){const[t,e]=De.useState(1);return{curOption:t,setCurOption:e}}function t_e({curOption:t}){const e=De.useRef(),n=De.useRef(),r=De.useRef({});De.useEffect(()=>{e.current=document.querySelector("#main-tooltip"),n.current=document.querySelector("#secondary-tooltip")},[]);const i=De.useCallback(p=>{e.current.classList.add("active"),n.current.classList.add("active"),n.current.innerHTML=`      <div><b>GEOID</b> ${p.properties.GEOID}</div>
      <div><b>Votes / Km2</b> ${p.properties.votes_per_sqkm}</div>
      <div><b>Percent Dem. Lead</b> ${p.properties.pct_dem_lead}</div>
    `},[]),s=De.useCallback(p=>{n.current.classList.remove("active"),e.current.classList.add("active"),p.properties.pct_dem_lead?e.current.innerHTML=`        <div><b>GEOID</b> ${p.properties.GEOID}</div>
        <div><b>Votes / Km2</b> ${p.properties.votes_per_sqkm}</div>
        <div><b>% Dem. Lead</b> ${p.properties.pct_dem_lead}</div>
      `:e.current.innerHTML=`        <div><b>County Subdiv.</b> ${p.properties["county_subdivision_dec_Geographic Area Name"]}</div>
        <div><b>GEOID</b> ${p.properties.GEOID}</div>
        <div><b>% PoC</b> ${100-p.properties["county_subdivision_dec_Percent White"]}</div>
        <div><b>Pop. / Km2</b> ${p.properties["Population per Sqkm"]}</div>
      `},[]),l=De.useCallback(p=>{n.current.classList.remove("active"),e.current.classList.add("active"),e.current.innerHTML=`    <div><b>% PoC</b> ${p.properties.PoC}</div>
    <div><b>% PoC Var</b> ${p.properties.PoCVar}</div>
      <div><b>Pop. Den</b> ${p.properties.PopSqKm}</div>
      <div><b>Pop. Den Var</b> ${p.properties.PopSqKmVar}</div>
      <div><b>% Dem. Lead</b> ${p.properties.DemLead}</div>
      <div><b>% Dem. Lead Var</b> ${p.properties.DemLeadVar}</div>
      <div><b>Num. of County Subdivs</b> ${p.properties.CountyRgs.length}</div>
      <div><b>Num. of Precincts</b> ${p.properties.PrecinctRgs.length}</div>
      `},[]);return{getTooltip:De.useCallback(({object:p})=>{if(!p){r.current&&(n.current.classList.remove("active"),Th(r.current)&&e.current.classList.remove("active"),r.current=p),t>1&&(n.current.classList.remove("active"),e.current.classList.remove("active"));return}t<=1&&Th(p)?l(p):t<=1&&Ym(p)?i(p):s(p),r.current=p},[t])}}class $4 extends Vn{renderLayers(){return[new Eh({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:2,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new bh(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}}$4.layerName="BaseTerrainLayer";$4.defaultProps={...Vn.defaultProps};class j4 extends Vn{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o,useVsup:p,highlighted:_=null}=this.props;return[new mo({id:"HexParty",data:e,thicknessRange:[0,1],getFillColor:C=>p?Mn.party.interpVsup(C.properties.DemLead||0,C.properties.DemLeadVar||0):Mn.party.interpColor(C.properties.DemLead||0),opacity:1,visible:l,updateTriggers:{getFillColor:[r,p]},zoomRange:o}),new mo({id:"HexWhite",data:e,thicknessRange:[.4,.65],getFillColor:C=>Mn.poc.interpColor(C.properties.PoC,!1),getValue:C=>p?Mn.poc.scaleLinearVar(C.properties.PoCVar)*.7+.3:1,visible:l,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new qf({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r,p],getElevation:[s],getLineWidth:[s]},zoomRange:o}),new Lh({id:"HexPopulation",data:e,loaders:[ep],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",getColor:C=>[255,255,7,(p?Mn.population.scaleLinearVar(C.properties.PopSqKmVar):1)*200+55],getValue:C=>Mn.population.scaleLinear(C.properties.PopSqKm),visible:l,sizeScale:400,opacity:1,updateTriggers:{getTranslation:[r],getColor:[p]},zoomRange:o}),new mo({id:"HexHoveringTiles",data:e,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,stroked:!0,getLineWidth:C=>C.hexId==_?5:0,lineWidthUnits:"pixels",visible:l,zoomRange:o,updateTriggers:{getLineWidth:[_]}})]}}j4.layerName="MultivariableHextileLayer";j4.defaultProps={...Vn.defaultProps,autoHighlight:!0,pickable:!0};const kb={width:1286,height:703,latitude:28.758769832242674,longitude:-101.33351900443955,zoom:5.5,bearing:32.58,pitch:50.85,altitude:1.5,maxZoom:15,minZoom:3,maxPitch:60,minPitch:0,normalize:!0,position:[0,0,0]};class sN extends Vn{renderLayers(){const{curOption:e,speedyCounter:n=1026}=this.props;return[new as({id:"Votes",data:k7,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,extruded:!0,getElevation:r=>Mn.votes.scaleLinear(r.properties.votes_per_sqkm)*3e5,getFillColor:r=>Mn.party.interpColor(r.properties.pct_dem_lead,!1,!1),visible:e==2,pickable:!0,autoHighlight:!0}),new as({id:"Demog",data:WE,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,extruded:!0,getElevation:r=>Mn.population.scaleLinear(r.properties["county_subdivision_dec_Total population"]/(r.properties.area/1e6)||0)*3e4,getFillColor:r=>Mn.poc.interpColor(100-(r.properties["county_subdivision_dec_Percent White"]||100),!1,!1),visible:e==3,pickable:!0,autoHighlight:!0})]}}sN.layerName="BasicGeoLayer";sN.defaultProps={...Vn.defaultProps,autoHighlight:!0};class H4 extends Vn{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o,highlighted:p}=this.props;return[new zs({id:"SquareBorders",data:e,getFillColor:[0,0,0,0],getLineColor:[80,80,80,100],stroked:!0,lineWidthUnits:"pixels",getValue:_=>2,visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[0,0]}),new zs({id:"SquarePoC",data:e,getFillColor:[0,121,42],getValue:_=>Mn.poc.scaleLinear(_.properties.PoC),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[-1,-1]}),new zs({id:"SquareDem",data:e,getFillColor:[72,30,197],getValue:_=>Mn.party.scaleLinear(_.properties.DemLead>0?_.properties.DemLead*2-100:-100),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[-1,1]}),new zs({id:"SquareRepub",data:e,getFillColor:[165,0,38],getValue:_=>Mn.party.scaleLinear(_.properties.DemLead<0?-_.properties.DemLead*2-100:-100),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[1,1]}),new zs({id:"SquarePop",data:e,getFillColor:[156,156,156],getValue:_=>Mn.population.scaleLinear(_.properties.PopSqKm),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[1,-1]}),new zs({id:"SquareHoveringTiles",data:e,getFillColor:[0,0,0,0],pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,getValue:_=>2,stroked:!0,getLineWidth:_=>_.hexId==p?2e3:1,visible:l,zoomRange:o,opacity:1,offset:[0,0]})]}}H4.layerName="MultivariableSquareTileLayer";H4.defaultProps={...Vn.defaultProps,autoHighlight:!0,pickable:!0};const Pg=Object.keys(yA[4]).map(t=>n_e(t)),kg=Object.keys(Km[4]).map(t=>r_e(t));function n_e(t){const{CountyRgs:e,PrecinctRgs:n,...r}=yA[4][t];return{id:t,...r}}function r_e(t){const{CountyRgs:e,PrecinctRgs:n,...r}=Km[4][t];return{id:t,...r}}function Ig(t,e){let n=[];do{let r=i_e(t);n=n.indexOf(r)>-1?n:n.concat(r)}while(n.length<e);return n}function eL(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}function i_e(t){return Math.floor(Math.random()*t)}function s_e(){return Ig(Pg.length,15).map(e=>Pg[e])}function o_e(){return Ig(kg.length,15).map(e=>kg[e])}function a_e(){const t=[],e=s_e(),n=o_e();for(let r=0;r<5;r++){const i=eL(["population density","person of color","dem. lead"]);for(let s of i){const l=eL(["hex","square"]);for(let o of l)t.push({type:"text",q:`What is your best estimate for ${s} in this tile?`,a:(o=="hex"?e[r]:n[r]).id,map:o})}}return t}const l_e=(t,e)=>t.sort((n,r)=>n[e]-r[e]),A_e=(t,e,n)=>{const r=l_e(t,n),i=(r.length-1)*e,s=Math.floor(i),l=i-s;return r[s+1]!==void 0?r[s][n]+l*(r[s+1][n]-r[s][n]):r[s][n]};function Ro(t,e,n){return A_e(Array.from(t),e/100,n)}const x0={PopSqKm:"population density",DemLead:"dem. lead",PoC:"person of color"};function u_e(){let t=[],e=[[0,25],[25,100],[100,150],[150,1e8]],n="PopSqKm",r="DemLead",i=[];for(let[s,l]of e)for(let o of["hex","square"]){let p=o=="hex"?Pg:kg;p=p.filter(H=>H[n]<=l&&H[n]>=s),console.log(p);const _=Ro(p,0,r),C=Ro(p,25,r),M=Ro(p,50,r),k=Ro(p,75,r),F=Ro(p,100,r),j=[[Math.round(_),Math.round(C)],[Math.round(C),Math.round(M)],[Math.round(M),Math.round(k)],[Math.round(k),Math.round(F)]];for(let[H,ie]of j)i.push({type:"click",q:`Which tile has ${x0[n]} in range [${s},${l}] and ${x0[r]} in [${H},${ie}]?`,a:p.filter(Y=>Y[r]<=ie&&Y[r]>=H).map(Y=>Y.id),map:o})}t=[...t,...Ig(16,10).map(s=>i[s])],i=[],n="PopSqKm",r="PoC";for(let[s,l]of e)for(let o of["hex","square"]){let p=o=="hex"?Pg:kg;p=p.filter(H=>H[n]<=l&&H[n]>=s);const _=Ro(p,0,r),C=Ro(p,25,r),M=Ro(p,50,r),k=Ro(p,75,r),F=Ro(p,100,r),j=[[Math.round(_),Math.round(C)],[Math.round(C),Math.round(M)],[Math.round(M),Math.round(k)],[Math.round(k),Math.round(F)]];for(let[H,ie]of j)i.push({type:"click",q:`Which tile has ${x0[n]} in range [${s},${l}] and ${x0[r]} in [${H},${ie}]?`,a:p.filter(Y=>Y[r]<=ie&&Y[r]>=H).map(Y=>Y.id),map:o})}t=[...t,...Ig(16,10).map(s=>i[s])],e=[[-100,-50],[-50,0],[0,20],[20,100]],i=[],n="DemLead",r="PoC";for(let[s,l]of e)for(let o of["hex","square"]){let p=o=="hex"?Pg:kg;p=p.filter(H=>H[n]<=l&&H[n]>=s);const _=Ro(p,0,r),C=Ro(p,25,r),M=Ro(p,50,r),k=Ro(p,75,r),F=Ro(p,100,r),j=[[Math.round(_),Math.round(C)],[Math.round(C),Math.round(M)],[Math.round(M),Math.round(k)],[Math.round(k),Math.round(F)]];for(let[H,ie]of j)i.push({type:"click",q:`Which tile has ${x0[n]} in range [${s},${l}] and ${x0[r]} in [${H},${ie}]?`,a:p.filter(Y=>Y[r]<=ie&&Y[r]>=H).map(Y=>Y.id),map:o})}return t=[...t,...Ig(16,10).map(s=>i[s])],t}function c_e(){let t=[...a_e(),...u_e()];return console.log(t),console.log("gen functions"),t}const tL=Object.keys(yA).map(t=>parseInt(t)),sr=c_e();function h_e(){const[t,e]=De.useState(5),n=e_e(),r=De.useRef([]);t_e(n);const[i,s]=De.useState(-1),[l,o]=De.useState(""),[p,_]=De.useState(),[C,M]=De.useState(!1),[k,F]=De.useState(!1),{curViewState:j,zoomInHex:H,zoomInSquare:ie}=y_e(),Y={data:yA,...n},J=()=>{s(pe=>(sr[pe+1].map=="hex"?H(sr[pe+1].a,()=>{_(Date.now())}):ie(sr[pe+1].a,()=>{_(Date.now())}),pe+1))},se=De.useCallback(()=>{if(k)o(""),F(!1),s(pe=>(pe+1<sr.length&&(sr[pe+1].type=="text"?sr[pe+1].map=="hex"?H(sr[pe+1].a,()=>{_(Date.now())}):ie(sr[pe+1].a,()=>{_(Date.now())}):_(Date.now())),pe+1));else{const pe={...sr[i],user:l,time:Date.now()-p};console.log(pe),r.current.push(pe),o(""),i==29?F(!0):s(be=>(be+1<sr.length&&(sr[be+1].type=="text"?sr[be+1].map=="hex"?H(sr[be+1].a,()=>{_(Date.now())}):ie(sr[be+1].a,()=>{_(Date.now())}):_(Date.now())),be+1))}}),he=De.useCallback(({object:pe})=>{const be={...sr[i],user:pe.hexId,time:Date.now()-p};console.log(be),r.current.push(be),s(Ge=>(Ge+1<sr.length&&(sr[Ge+1].type=="text"?sr[Ge+1].map=="hex"?H(sr[Ge+1].a,()=>{_(Date.now())}):ie(sr[Ge+1].a,()=>{_(Date.now())}):_(Date.now())),Ge+1))},[p,i]);return De.useEffect(()=>{if(i==sr.length){console.log(r.current);let pe=new XMLHttpRequest;pe.open("POST",`https://userstudy-4f273-default-rtdb.firebaseio.com/${Lge()}.json`,!0),pe.setRequestHeader("Content-Type","application/json; charset=UTF-8"),pe.send(JSON.stringify(r.current))}},[i]),Ye.createElement(Ye.Fragment,null,Ye.createElement(_c,{controller:!0,effects:[bA],initialViewState:j,onViewStateChange:({viewState:pe})=>{e(pe.zoom)}},Ye.createElement(Va,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:Vo,mapStyle:Ga}),Ye.createElement($4,{id:"slide-terrain",...Y}),Ye.createElement(j4,{pickable:(sr[i]||{}).type==="click"&&!k,autoHighlight:(sr[i]||{}).type==="click"&&!k,id:"slide-hex",data:yA,...n,zoomRange:[0,1],visible:(sr[i]||{}).map=="hex",onClick:he,useVsup:C,highlighted:sr[i]&&sr[i].type=="text"?sr[i].a:null}),Ye.createElement(H4,{pickable:(sr[i]||{}).type==="click"&&!k,autoHighlight:(sr[i]||{}).type==="click"&&!k,id:"slide-elec-square",data:Km,...n,zoomRange:[0,1],visible:(sr[i]||{}).map=="square",onClick:he,highlighted:sr[i]&&sr[i].type=="text"?sr[i].a:null})),i<sr.length&&Ye.createElement("div",{className:"study-area"},i==-1&&Ye.createElement(Ye.Fragment,null,Ye.createElement("p",null,"Press button to start."),Ye.createElement("button",{onClick:J},"Next")),i>-1&&!k&&Ye.createElement(Ye.Fragment,null,Ye.createElement("p",null,sr[i].q),sr[i].type=="text"&&Ye.createElement(Ye.Fragment,null,Ye.createElement("input",{type:"text",value:l,onChange:pe=>o(pe.target.value)}),Ye.createElement("button",{onClick:se},"Next"))),k&&Ye.createElement(Ye.Fragment,null,Ye.createElement("p",null,"Starting next part."),Ye.createElement("button",{onClick:se},"Next")),i>-1&&!k&&Ye.createElement(Ye.Fragment,null,Ye.createElement("p",{style:{"font-size":"12px","margin-top":"0.3em"}},i+1," / 60"))),(sr[i]||{}).map=="hex"&&Ye.createElement(f_e,{res:ss().domain([0,1]).range(tL)(ur().domain([5,8]).range([0,1]).clamp(!0)(t)),useVsup:C,setUseVsup:M}),(sr[i]||{}).map=="square"&&Ye.createElement(d_e,{res:ss().domain([0,1]).range(tL)(ur().domain([5,8]).range([0,1]).clamp(!0)(t))}),i>=sr.length&&Ye.createElement("button",{style:{position:"absolute",left:"20px",bottom:"20px"},onClick:()=>Ige(r.current,"user-data")},"Download results"))}function f_e({res:t,useVsup:e,setUseVsup:n}){const r=De.useRef(),i=De.useRef();return De.useEffect(()=>{nA(".lin-legend").style("visibility",e?"hidden":"visible"),nA(".vsup-legend-u").style("visibility",e?"visible":"hidden"),nA(".vsup-legend-v").attr("transform",`translate(0,${e?0:50})`),nA(".box1").attr("transform",`translate(0,${e?0:150})`).attr("height",e?250:100).attr("width",e?250:300),nA(".box2").attr("transform",`translate(0,${e?0:60})`).attr("height",e?170:110)},[e]),De.useLayoutEffect(()=>{const s=Ai(r.current).attr("width",window.innerWidth).attr("height",window.innerHeight),l=200,o=window.innerWidth,p=s.append("g").attr("transform",`translate(0,${window.innerHeight-l-100})`);p.append("g").attr("transform",`translate(0,${l-250})`).append("rect").attr("class","box1").attr("height",250).attr("width",250).attr("fill","white"),p.append("g").attr("transform",`translate(0,${l-170})`).append("rect").attr("class","box2").attr("height",170).attr("width",920).attr("x",350).attr("fill","white"),p.append("g").attr("class","vsup-legend-u").append("g").call(P7().vtitle("% Dem. Lead").utitle("Variance").scale(Mn.party.vsup).size(150).x(40).y(l-150-40)),p.append("g").attr("class","lin-legend").append("g").call($a.simpleLegend(null,250,20,".2s").title("% Dem. Lead").size(250).height(20).scale(Mn.party.colorsStepped).x(20).y(l-70));let _=400,C=l-120;p.append("g").attr("transform",`translate(${_},${C})`).append("g").attr("class","vsup-legend-v").call(v4(Mn.poc,"% PoC")),p.append("g").attr("transform",`translate(${_},${C+20})`).append("g").attr("class","vsup-legend-u").call(M7(Mn.poc)),_=750,C=l-120,p.append("g").attr("transform",`translate(${_},${C})`).append("g").attr("class","vsup-legend-v").call(_4(Mn.population,"assets/human.png","Pop. / Km2")),p.append("g").attr("transform",`translate(${_},${C+55})`).append("g").attr("class","vsup-legend-u").call(C7(Mn.population,"assets/human.png")),p.append("g").attr("transform",`translate(${o-60},${l-80})`).call(Xm(0,0,50,"rgba(146, 146, 146, 0.5)")).call(function(M){i.current=[M.append("text").attr("x",0).attr("y",8).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${ci(".2s")(_A(t,Ar.km2))} km²`),M.append("text").attr("x",0).attr("y",55).attr("text-anchor","middle").style("font-size","11px").text(`← ${ci(".2s")(ws(t,Ar.km))} km →;`)]})},[]),De.useEffect(()=>{let[s,l]=i.current;s.text(`${ci(".2s")(_A(t,Ar.km2))} km²`),l.text(`← ${ci(".2s")(ws(t,Ar.km))} km →;`)},[t]),Ye.createElement(Ye.Fragment,null,Ye.createElement("svg",{className:"legend-area",ref:r}),Ye.createElement("div",{className:"study-input"},Ye.createElement("input",{type:"checkbox",checked:e,onChange:()=>n(s=>!s)}),Ye.createElement("span",null,"Use VSUP")))}function JE(t){return ws(parseInt(t),Ar.km)*2}function d_e({res:t}){const e=De.useRef(),n=De.useRef();return De.useLayoutEffect(()=>{const r=window.innerHeight,i=window.innerWidth,s=Ai(e.current).attr("width",i).attr("height",r);s.append("g").attr("transform",`translate(${i-60},${r-170})`).call(l=>{l.append("rect").attr("x",-50).attr("y",-50).attr("width",100).attr("height",100).attr("fill","rgba(146, 146, 146, 0.5)")}).call(function(l){n.current=[l.append("text").attr("x",0).attr("y",8).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${ci(".2s")(_A(t,Ar.km2))} km²`),l.append("text").attr("x",0).attr("y",55).attr("text-anchor","middle").style("font-size","11px").text(`← ${ci(".2s")(ws(t,Ar.km))} km →;`)]}),s.append("g").attr("transform",`translate(120,${r-200})`).call(l=>{l.append("rect").attr("x",-120).attr("y",-140).attr("width",459).attr("height",240).attr("fill","rgba(255, 255, 255, 1)");const o=75;l.append("text").attr("x",o).attr("y",-o-15).style("font-weight","bold").attr("text-anchor","middle").text("Measure Type"),l.append("rect").attr("x",0).attr("y",-o).attr("width",o).attr("height",o).attr("fill","rgba(72, 30, 197, 0.7)"),l.append("rect").attr("x",o).attr("y",-o).attr("width",o).attr("height",o).attr("fill","rgba(165, 0, 38, 0.7)"),l.append("rect").attr("x",o).attr("y",0).attr("width",o).attr("height",o).attr("fill","rgba(156, 156, 156, 0.7)"),l.append("rect").attr("x",0).attr("y",0).attr("width",o).attr("height",o).attr("fill","rgba(0, 121, 42, 0.7)");let p,_;p=[100,0],_=Qu().range([0,o]).domain([p[0],-(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(0,${-o})`).call(r2(_)),p=Mn.poc.scaleLinear.domain(),_=Qu().range([0,o]).domain([p[0],(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform","translate(0,0)").call(r2(_)),p=[-100,0],_=Qu().range([0,o]).domain([p[0],-(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(${o*2},${-o})`).call(nm(_)),p=Mn.population.scaleLinear.domain(),_=Qu().range([0,o]).domain([p[0],(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(${o*2},0)`).call(nm(_)),l.append("text").attr("x",-20).attr("y",-18).attr("text-anchor","end").text("% Dem. Lead"),l.append("text").attr("x",o*2+20).attr("y",-18).attr("text-anchor","start").text("% Rep. Lead"),l.append("text").attr("x",o*2+20).attr("y",0+12).attr("text-anchor","start").text("Pop. / Km2"),l.append("text").attr("x",-20).attr("y",0+12).attr("text-anchor","end").text("% PoC")})},[]),De.useEffect(()=>{let[r,i]=n.current;r.text(`${ci(".2s")(Math.pow(JE(t),2))} km²`),i.text(`← ${ci(".2s")(JE(t))} km →;`)},[t]),Ye.createElement(Ye.Fragment,null,Ye.createElement("svg",{className:"legend-area",ref:e}))}function p_e(t){return t/111.1}function g_e(t){return p_e(JE(t))}function m_e(t){const[e,n,r]=t.split("/"),i=g_e(r);return[parseFloat(e)+i/2,parseFloat(n)+i/2]}function y_e(){const[t,e]=De.useState(kb),[n,r]=De.useState(!1),i=De.useCallback((l,o)=>{const[p,_]=P4(l);r(!0),e({...kb,zoom:7.45,latitude:p,longitude:_,transitionDuration:500,transitionInterpolator:new xh,onTransitionEnd:()=>{r(!1),o()}})},[]),s=De.useCallback((l,o)=>{const[p,_]=m_e(l);r(!0),e({...kb,zoom:7.45,latitude:p,longitude:_,transitionDuration:500,transitionInterpolator:new xh,onTransitionEnd:()=>{r(!1),o()}})},[]);return{curViewState:t,transitioning:n,zoomInHex:i,zoomInSquare:s}}function __e(t){fR(t).render(Ye.createElement(h$,null,Ye.createElement(s$,null,Ye.createElement(cl,{path:"/",element:Ye.createElement(v_e,null)}),Ye.createElement(cl,{path:"user",element:Ye.createElement(h_e,null)}),Ye.createElement(cl,{path:"water/hex",element:Ye.createElement(cye,null)}),Ye.createElement(cl,{path:"water/hex-no-vsup",element:Ye.createElement(Xye,null)}),Ye.createElement(cl,{path:"water/square",element:Ye.createElement(xye,null)}),Ye.createElement(cl,{path:"water/mult",element:Ye.createElement(Nye,null)}),Ye.createElement(cl,{path:"election/hex",element:Ye.createElement(Oye,null)}),Ye.createElement(cl,{path:"election/hex-no-vsup",element:Ye.createElement(qye,null)}),Ye.createElement(cl,{path:"election/square",element:Ye.createElement($ye,null)}),Ye.createElement(cl,{path:"election/mult",element:Ye.createElement(Hye,null)}),Ye.createElement(cl,{path:"fire",element:Ye.createElement(Rye,null)}))))}function v_e(){return Ye.createElement(Ye.Fragment,null,Ye.createElement(Bu,{className:"toc-link",to:"water/mult"},"Water Small Multiples"),Ye.createElement(Bu,{className:"toc-link",to:"water/square"},"Water Square Tiles"),Ye.createElement(Bu,{className:"toc-link",to:"water/hex"},"Water HexTiles"),Ye.createElement(Bu,{className:"toc-link",to:"water/hex-no-vsup"},"Water HexTiles (No VSUP)"),Ye.createElement(Bu,{className:"toc-link",to:"election/mult"},"Election Small Multiples"),Ye.createElement(Bu,{className:"toc-link",to:"election/square"},"Election Square Tiles"),Ye.createElement(Bu,{className:"toc-link",to:"election/hex"},"Election HexTiles"),Ye.createElement(Bu,{className:"toc-link",to:"election/hex-no-vsup"},"Election HexTiles (No VSUP)"),Ye.createElement(Bu,{className:"toc-link",to:"fire"},"Wildfire"))}__e(document.getElementById("app"));
