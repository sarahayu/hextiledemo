function gN(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var mN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Z_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function yN(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var Dk={exports:{}},fi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rg=Symbol.for("react.element"),_N=Symbol.for("react.portal"),vN=Symbol.for("react.fragment"),xN=Symbol.for("react.strict_mode"),wN=Symbol.for("react.profiler"),bN=Symbol.for("react.provider"),EN=Symbol.for("react.context"),TN=Symbol.for("react.forward_ref"),SN=Symbol.for("react.suspense"),MN=Symbol.for("react.memo"),CN=Symbol.for("react.lazy"),s5=Symbol.iterator;function PN(t){return t===null||typeof t!="object"?null:(t=s5&&t[s5]||t["@@iterator"],typeof t=="function"?t:null)}var Rk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bk=Object.assign,zk={};function sd(t,e,n){this.props=t,this.context=e,this.refs=zk,this.updater=n||Rk}sd.prototype.isReactComponent={};sd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};sd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Ok(){}Ok.prototype=sd.prototype;function Y3(t,e,n){this.props=t,this.context=e,this.refs=zk,this.updater=n||Rk}var X3=Y3.prototype=new Ok;X3.constructor=Y3;Bk(X3,sd.prototype);X3.isPureReactComponent=!0;var o5=Array.isArray,Fk=Object.prototype.hasOwnProperty,K3={current:null},Nk={key:!0,ref:!0,__self:!0,__source:!0};function Uk(t,e,n){var i,r={},s=null,u=null;if(e!=null)for(i in e.ref!==void 0&&(u=e.ref),e.key!==void 0&&(s=""+e.key),e)Fk.call(e,i)&&!Nk.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var y=Array(a),w=0;w<a;w++)y[w]=arguments[w+2];r.children=y}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Rg,type:t,key:s,ref:u,props:r,_owner:K3.current}}function IN(t,e){return{$$typeof:Rg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function J3(t){return typeof t=="object"&&t!==null&&t.$$typeof===Rg}function kN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var a5=/\/+/g;function Ov(t,e){return typeof t=="object"&&t!==null&&t.key!=null?kN(""+t.key):e.toString(36)}function R1(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var u=!1;if(t===null)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(t.$$typeof){case Rg:case _N:u=!0}}if(u)return u=t,r=r(u),t=i===""?"."+Ov(u,0):i,o5(r)?(n="",t!=null&&(n=t.replace(a5,"$&/")+"/"),R1(r,e,n,"",function(w){return w})):r!=null&&(J3(r)&&(r=IN(r,n+(!r.key||u&&u.key===r.key?"":(""+r.key).replace(a5,"$&/")+"/")+t)),e.push(r)),1;if(u=0,i=i===""?".":i+":",o5(t))for(var a=0;a<t.length;a++){s=t[a];var y=i+Ov(s,a);u+=R1(s,e,n,y,r)}else if(y=PN(t),typeof y=="function")for(t=y.call(t),a=0;!(s=t.next()).done;)s=s.value,y=i+Ov(s,a++),u+=R1(s,e,n,y,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return u}function Im(t,e,n){if(t==null)return t;var i=[],r=0;return R1(t,i,"","",function(s){return e.call(n,s,r++)}),i}function LN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var zo={current:null},B1={transition:null},DN={ReactCurrentDispatcher:zo,ReactCurrentBatchConfig:B1,ReactCurrentOwner:K3};fi.Children={map:Im,forEach:function(t,e,n){Im(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Im(t,function(){e++}),e},toArray:function(t){return Im(t,function(e){return e})||[]},only:function(t){if(!J3(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fi.Component=sd;fi.Fragment=vN;fi.Profiler=wN;fi.PureComponent=Y3;fi.StrictMode=xN;fi.Suspense=SN;fi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DN;fi.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=Bk({},t.props),r=t.key,s=t.ref,u=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,u=K3.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(y in e)Fk.call(e,y)&&!Nk.hasOwnProperty(y)&&(i[y]=e[y]===void 0&&a!==void 0?a[y]:e[y])}var y=arguments.length-2;if(y===1)i.children=n;else if(1<y){a=Array(y);for(var w=0;w<y;w++)a[w]=arguments[w+2];i.children=a}return{$$typeof:Rg,type:t.type,key:r,ref:s,props:i,_owner:u}};fi.createContext=function(t){return t={$$typeof:EN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:bN,_context:t},t.Consumer=t};fi.createElement=Uk;fi.createFactory=function(t){var e=Uk.bind(null,t);return e.type=t,e};fi.createRef=function(){return{current:null}};fi.forwardRef=function(t){return{$$typeof:TN,render:t}};fi.isValidElement=J3;fi.lazy=function(t){return{$$typeof:CN,_payload:{_status:-1,_result:t},_init:LN}};fi.memo=function(t,e){return{$$typeof:MN,type:t,compare:e===void 0?null:e}};fi.startTransition=function(t){var e=B1.transition;B1.transition={};try{t()}finally{B1.transition=e}};fi.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};fi.useCallback=function(t,e){return zo.current.useCallback(t,e)};fi.useContext=function(t){return zo.current.useContext(t)};fi.useDebugValue=function(){};fi.useDeferredValue=function(t){return zo.current.useDeferredValue(t)};fi.useEffect=function(t,e){return zo.current.useEffect(t,e)};fi.useId=function(){return zo.current.useId()};fi.useImperativeHandle=function(t,e,n){return zo.current.useImperativeHandle(t,e,n)};fi.useInsertionEffect=function(t,e){return zo.current.useInsertionEffect(t,e)};fi.useLayoutEffect=function(t,e){return zo.current.useLayoutEffect(t,e)};fi.useMemo=function(t,e){return zo.current.useMemo(t,e)};fi.useReducer=function(t,e,n){return zo.current.useReducer(t,e,n)};fi.useRef=function(t){return zo.current.useRef(t)};fi.useState=function(t){return zo.current.useState(t)};fi.useSyncExternalStore=function(t,e,n){return zo.current.useSyncExternalStore(t,e,n)};fi.useTransition=function(){return zo.current.useTransition()};fi.version="18.2.0";Dk.exports=fi;var _t=Dk.exports;const Ci=Z_(_t);var Vk={exports:{}},za={},Gk={exports:{}},jk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(mt,bt){var Kt=mt.length;mt.push(bt);e:for(;0<Kt;){var In=Kt-1>>>1,En=mt[In];if(0<r(En,bt))mt[In]=bt,mt[Kt]=En,Kt=In;else break e}}function n(mt){return mt.length===0?null:mt[0]}function i(mt){if(mt.length===0)return null;var bt=mt[0],Kt=mt.pop();if(Kt!==bt){mt[0]=Kt;e:for(var In=0,En=mt.length,Si=En>>>1;In<Si;){var Jn=2*(In+1)-1,oi=mt[Jn],ci=Jn+1,Nn=mt[ci];if(0>r(oi,Kt))ci<En&&0>r(Nn,oi)?(mt[In]=Nn,mt[ci]=Kt,In=ci):(mt[In]=oi,mt[Jn]=Kt,In=Jn);else if(ci<En&&0>r(Nn,Kt))mt[In]=Nn,mt[ci]=Kt,In=ci;else break e}}return bt}function r(mt,bt){var Kt=mt.sortIndex-bt.sortIndex;return Kt!==0?Kt:mt.id-bt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var u=Date,a=u.now();t.unstable_now=function(){return u.now()-a}}var y=[],w=[],I=1,P=null,L=3,U=!1,Q=!1,Z=!1,ae=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function re(mt){for(var bt=n(w);bt!==null;){if(bt.callback===null)i(w);else if(bt.startTime<=mt)i(w),bt.sortIndex=bt.expirationTime,e(y,bt);else break;bt=n(w)}}function de(mt){if(Z=!1,re(mt),!Q)if(n(y)!==null)Q=!0,Et(ve);else{var bt=n(w);bt!==null&&fn(de,bt.startTime-mt)}}function ve(mt,bt){Q=!1,Z&&(Z=!1,Y(Qe),Qe=-1),U=!0;var Kt=L;try{for(re(bt),P=n(y);P!==null&&(!(P.expirationTime>bt)||mt&&!Ve());){var In=P.callback;if(typeof In=="function"){P.callback=null,L=P.priorityLevel;var En=In(P.expirationTime<=bt);bt=t.unstable_now(),typeof En=="function"?P.callback=En:P===n(y)&&i(y),re(bt)}else i(y);P=n(y)}if(P!==null)var Si=!0;else{var Jn=n(w);Jn!==null&&fn(de,Jn.startTime-bt),Si=!1}return Si}finally{P=null,L=Kt,U=!1}}var Me=!1,He=null,Qe=-1,et=5,tt=-1;function Ve(){return!(t.unstable_now()-tt<et)}function nt(){if(He!==null){var mt=t.unstable_now();tt=mt;var bt=!0;try{bt=He(!0,mt)}finally{bt?Ye():(Me=!1,He=null)}}else Me=!1}var Ye;if(typeof te=="function")Ye=function(){te(nt)};else if(typeof MessageChannel<"u"){var gt=new MessageChannel,Xt=gt.port2;gt.port1.onmessage=nt,Ye=function(){Xt.postMessage(null)}}else Ye=function(){ae(nt,0)};function Et(mt){He=mt,Me||(Me=!0,Ye())}function fn(mt,bt){Qe=ae(function(){mt(t.unstable_now())},bt)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(mt){mt.callback=null},t.unstable_continueExecution=function(){Q||U||(Q=!0,Et(ve))},t.unstable_forceFrameRate=function(mt){0>mt||125<mt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):et=0<mt?Math.floor(1e3/mt):5},t.unstable_getCurrentPriorityLevel=function(){return L},t.unstable_getFirstCallbackNode=function(){return n(y)},t.unstable_next=function(mt){switch(L){case 1:case 2:case 3:var bt=3;break;default:bt=L}var Kt=L;L=bt;try{return mt()}finally{L=Kt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(mt,bt){switch(mt){case 1:case 2:case 3:case 4:case 5:break;default:mt=3}var Kt=L;L=mt;try{return bt()}finally{L=Kt}},t.unstable_scheduleCallback=function(mt,bt,Kt){var In=t.unstable_now();switch(typeof Kt=="object"&&Kt!==null?(Kt=Kt.delay,Kt=typeof Kt=="number"&&0<Kt?In+Kt:In):Kt=In,mt){case 1:var En=-1;break;case 2:En=250;break;case 5:En=1073741823;break;case 4:En=1e4;break;default:En=5e3}return En=Kt+En,mt={id:I++,callback:bt,priorityLevel:mt,startTime:Kt,expirationTime:En,sortIndex:-1},Kt>In?(mt.sortIndex=Kt,e(w,mt),n(y)===null&&mt===n(w)&&(Z?(Y(Qe),Qe=-1):Z=!0,fn(de,Kt-In))):(mt.sortIndex=En,e(y,mt),Q||U||(Q=!0,Et(ve))),mt},t.unstable_shouldYield=Ve,t.unstable_wrapCallback=function(mt){var bt=L;return function(){var Kt=L;L=bt;try{return mt.apply(this,arguments)}finally{L=Kt}}}})(jk);Gk.exports=jk;var RN=Gk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $k=_t,Ba=RN;function Rt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Hk=new Set,$p={};function e0(t,e){Lf(t,e),Lf(t+"Capture",e)}function Lf(t,e){for($p[t]=e,t=0;t<e.length;t++)Hk.add(e[t])}var zu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pw=Object.prototype.hasOwnProperty,BN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,l5={},A5={};function zN(t){return Pw.call(A5,t)?!0:Pw.call(l5,t)?!1:BN.test(t)?A5[t]=!0:(l5[t]=!0,!1)}function ON(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function FN(t,e,n,i){if(e===null||typeof e>"u"||ON(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Oo(t,e,n,i,r,s,u){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=u}var Ds={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ds[t]=new Oo(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ds[e]=new Oo(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ds[t]=new Oo(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ds[t]=new Oo(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ds[t]=new Oo(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ds[t]=new Oo(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ds[t]=new Oo(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ds[t]=new Oo(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ds[t]=new Oo(t,5,!1,t.toLowerCase(),null,!1,!1)});var eE=/[\-:]([a-z])/g;function tE(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(eE,tE);Ds[e]=new Oo(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(eE,tE);Ds[e]=new Oo(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(eE,tE);Ds[e]=new Oo(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ds[t]=new Oo(t,1,!1,t.toLowerCase(),null,!1,!1)});Ds.xlinkHref=new Oo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ds[t]=new Oo(t,1,!1,t.toLowerCase(),null,!0,!0)});function nE(t,e,n,i){var r=Ds.hasOwnProperty(e)?Ds[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(FN(e,n,r,i)&&(n=null),i||r===null?zN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var Zu=$k.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,km=Symbol.for("react.element"),U0=Symbol.for("react.portal"),V0=Symbol.for("react.fragment"),iE=Symbol.for("react.strict_mode"),Iw=Symbol.for("react.profiler"),Wk=Symbol.for("react.provider"),Qk=Symbol.for("react.context"),rE=Symbol.for("react.forward_ref"),kw=Symbol.for("react.suspense"),Lw=Symbol.for("react.suspense_list"),sE=Symbol.for("react.memo"),bc=Symbol.for("react.lazy"),qk=Symbol.for("react.offscreen"),u5=Symbol.iterator;function zd(t){return t===null||typeof t!="object"?null:(t=u5&&t[u5]||t["@@iterator"],typeof t=="function"?t:null)}var vr=Object.assign,Fv;function fp(t){if(Fv===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Fv=e&&e[1]||""}return`
`+Fv+t}var Nv=!1;function Uv(t,e){if(!t||Nv)return"";Nv=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(w){var i=w}Reflect.construct(t,[],e)}else{try{e.call()}catch(w){i=w}t.call(e.prototype)}else{try{throw Error()}catch(w){i=w}t()}}catch(w){if(w&&i&&typeof w.stack=="string"){for(var r=w.stack.split(`
`),s=i.stack.split(`
`),u=r.length-1,a=s.length-1;1<=u&&0<=a&&r[u]!==s[a];)a--;for(;1<=u&&0<=a;u--,a--)if(r[u]!==s[a]){if(u!==1||a!==1)do if(u--,a--,0>a||r[u]!==s[a]){var y=`
`+r[u].replace(" at new "," at ");return t.displayName&&y.includes("<anonymous>")&&(y=y.replace("<anonymous>",t.displayName)),y}while(1<=u&&0<=a);break}}}finally{Nv=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?fp(t):""}function NN(t){switch(t.tag){case 5:return fp(t.type);case 16:return fp("Lazy");case 13:return fp("Suspense");case 19:return fp("SuspenseList");case 0:case 2:case 15:return t=Uv(t.type,!1),t;case 11:return t=Uv(t.type.render,!1),t;case 1:return t=Uv(t.type,!0),t;default:return""}}function Dw(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case V0:return"Fragment";case U0:return"Portal";case Iw:return"Profiler";case iE:return"StrictMode";case kw:return"Suspense";case Lw:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Qk:return(t.displayName||"Context")+".Consumer";case Wk:return(t._context.displayName||"Context")+".Provider";case rE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case sE:return e=t.displayName||null,e!==null?e:Dw(t.type)||"Memo";case bc:e=t._payload,t=t._init;try{return Dw(t(e))}catch{}}return null}function UN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dw(e);case 8:return e===iE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function qc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Zk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function VN(t){var e=Zk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(u){i=""+u,s.call(this,u)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(u){i=""+u},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Lm(t){t._valueTracker||(t._valueTracker=VN(t))}function Yk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=Zk(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function my(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Rw(t,e){var n=e.checked;return vr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function c5(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=qc(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Xk(t,e){e=e.checked,e!=null&&nE(t,"checked",e,!1)}function Bw(t,e){Xk(t,e);var n=qc(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?zw(t,e.type,n):e.hasOwnProperty("defaultValue")&&zw(t,e.type,qc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function h5(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function zw(t,e,n){(e!=="number"||my(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var dp=Array.isArray;function pf(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+qc(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Ow(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Rt(91));return vr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function f5(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Rt(92));if(dp(n)){if(1<n.length)throw Error(Rt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:qc(n)}}function Kk(t,e){var n=qc(e.value),i=qc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function d5(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Jk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fw(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Jk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Dm,e8=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Dm=Dm||document.createElement("div"),Dm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Dm.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Hp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Mp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},GN=["Webkit","ms","Moz","O"];Object.keys(Mp).forEach(function(t){GN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Mp[e]=Mp[t]})});function t8(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Mp.hasOwnProperty(t)&&Mp[t]?(""+e).trim():e+"px"}function n8(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=t8(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var jN=vr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nw(t,e){if(e){if(jN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Rt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Rt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Rt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Rt(62))}}function Uw(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vw=null;function oE(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Gw=null,gf=null,mf=null;function p5(t){if(t=Og(t)){if(typeof Gw!="function")throw Error(Rt(280));var e=t.stateNode;e&&(e=e2(e),Gw(t.stateNode,t.type,e))}}function i8(t){gf?mf?mf.push(t):mf=[t]:gf=t}function r8(){if(gf){var t=gf,e=mf;if(mf=gf=null,p5(t),e)for(t=0;t<e.length;t++)p5(e[t])}}function s8(t,e){return t(e)}function o8(){}var Vv=!1;function a8(t,e,n){if(Vv)return t(e,n);Vv=!0;try{return s8(t,e,n)}finally{Vv=!1,(gf!==null||mf!==null)&&(o8(),r8())}}function Wp(t,e){var n=t.stateNode;if(n===null)return null;var i=e2(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Rt(231,e,typeof n));return n}var jw=!1;if(zu)try{var Od={};Object.defineProperty(Od,"passive",{get:function(){jw=!0}}),window.addEventListener("test",Od,Od),window.removeEventListener("test",Od,Od)}catch{jw=!1}function $N(t,e,n,i,r,s,u,a,y){var w=Array.prototype.slice.call(arguments,3);try{e.apply(n,w)}catch(I){this.onError(I)}}var Cp=!1,yy=null,_y=!1,$w=null,HN={onError:function(t){Cp=!0,yy=t}};function WN(t,e,n,i,r,s,u,a,y){Cp=!1,yy=null,$N.apply(HN,arguments)}function QN(t,e,n,i,r,s,u,a,y){if(WN.apply(this,arguments),Cp){if(Cp){var w=yy;Cp=!1,yy=null}else throw Error(Rt(198));_y||(_y=!0,$w=w)}}function t0(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function l8(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function g5(t){if(t0(t)!==t)throw Error(Rt(188))}function qN(t){var e=t.alternate;if(!e){if(e=t0(t),e===null)throw Error(Rt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return g5(r),t;if(s===i)return g5(r),e;s=s.sibling}throw Error(Rt(188))}if(n.return!==i.return)n=r,i=s;else{for(var u=!1,a=r.child;a;){if(a===n){u=!0,n=r,i=s;break}if(a===i){u=!0,i=r,n=s;break}a=a.sibling}if(!u){for(a=s.child;a;){if(a===n){u=!0,n=s,i=r;break}if(a===i){u=!0,i=s,n=r;break}a=a.sibling}if(!u)throw Error(Rt(189))}}if(n.alternate!==i)throw Error(Rt(190))}if(n.tag!==3)throw Error(Rt(188));return n.stateNode.current===n?t:e}function A8(t){return t=qN(t),t!==null?u8(t):null}function u8(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=u8(t);if(e!==null)return e;t=t.sibling}return null}var c8=Ba.unstable_scheduleCallback,m5=Ba.unstable_cancelCallback,ZN=Ba.unstable_shouldYield,YN=Ba.unstable_requestPaint,zr=Ba.unstable_now,XN=Ba.unstable_getCurrentPriorityLevel,aE=Ba.unstable_ImmediatePriority,h8=Ba.unstable_UserBlockingPriority,vy=Ba.unstable_NormalPriority,KN=Ba.unstable_LowPriority,f8=Ba.unstable_IdlePriority,Y_=null,DA=null;function JN(t){if(DA&&typeof DA.onCommitFiberRoot=="function")try{DA.onCommitFiberRoot(Y_,t,void 0,(t.current.flags&128)===128)}catch{}}var Xl=Math.clz32?Math.clz32:n9,e9=Math.log,t9=Math.LN2;function n9(t){return t>>>=0,t===0?32:31-(e9(t)/t9|0)|0}var Rm=64,Bm=4194304;function pp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function xy(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,u=n&268435455;if(u!==0){var a=u&~r;a!==0?i=pp(a):(s&=u,s!==0&&(i=pp(s)))}else u=n&~r,u!==0?i=pp(u):s!==0&&(i=pp(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Xl(e),r=1<<n,i|=t[n],e&=~r;return i}function i9(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function r9(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var u=31-Xl(s),a=1<<u,y=r[u];y===-1?(!(a&n)||a&i)&&(r[u]=i9(a,e)):y<=e&&(t.expiredLanes|=a),s&=~a}}function Hw(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function d8(){var t=Rm;return Rm<<=1,!(Rm&4194240)&&(Rm=64),t}function Gv(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Bg(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Xl(e),t[e]=n}function s9(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Xl(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function lE(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Xl(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var Di=0;function p8(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var g8,AE,m8,y8,_8,Ww=!1,zm=[],Bc=null,zc=null,Oc=null,Qp=new Map,qp=new Map,Sc=[],o9="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function y5(t,e){switch(t){case"focusin":case"focusout":Bc=null;break;case"dragenter":case"dragleave":zc=null;break;case"mouseover":case"mouseout":Oc=null;break;case"pointerover":case"pointerout":Qp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":qp.delete(e.pointerId)}}function Fd(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Og(e),e!==null&&AE(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function a9(t,e,n,i,r){switch(e){case"focusin":return Bc=Fd(Bc,t,e,n,i,r),!0;case"dragenter":return zc=Fd(zc,t,e,n,i,r),!0;case"mouseover":return Oc=Fd(Oc,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return Qp.set(s,Fd(Qp.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,qp.set(s,Fd(qp.get(s)||null,t,e,n,i,r)),!0}return!1}function v8(t){var e=Eh(t.target);if(e!==null){var n=t0(e);if(n!==null){if(e=n.tag,e===13){if(e=l8(n),e!==null){t.blockedOn=e,_8(t.priority,function(){m8(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function z1(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Qw(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);Vw=i,n.target.dispatchEvent(i),Vw=null}else return e=Og(n),e!==null&&AE(e),t.blockedOn=n,!1;e.shift()}return!0}function _5(t,e,n){z1(t)&&n.delete(e)}function l9(){Ww=!1,Bc!==null&&z1(Bc)&&(Bc=null),zc!==null&&z1(zc)&&(zc=null),Oc!==null&&z1(Oc)&&(Oc=null),Qp.forEach(_5),qp.forEach(_5)}function Nd(t,e){t.blockedOn===e&&(t.blockedOn=null,Ww||(Ww=!0,Ba.unstable_scheduleCallback(Ba.unstable_NormalPriority,l9)))}function Zp(t){function e(r){return Nd(r,t)}if(0<zm.length){Nd(zm[0],t);for(var n=1;n<zm.length;n++){var i=zm[n];i.blockedOn===t&&(i.blockedOn=null)}}for(Bc!==null&&Nd(Bc,t),zc!==null&&Nd(zc,t),Oc!==null&&Nd(Oc,t),Qp.forEach(e),qp.forEach(e),n=0;n<Sc.length;n++)i=Sc[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<Sc.length&&(n=Sc[0],n.blockedOn===null);)v8(n),n.blockedOn===null&&Sc.shift()}var yf=Zu.ReactCurrentBatchConfig,wy=!0;function A9(t,e,n,i){var r=Di,s=yf.transition;yf.transition=null;try{Di=1,uE(t,e,n,i)}finally{Di=r,yf.transition=s}}function u9(t,e,n,i){var r=Di,s=yf.transition;yf.transition=null;try{Di=4,uE(t,e,n,i)}finally{Di=r,yf.transition=s}}function uE(t,e,n,i){if(wy){var r=Qw(t,e,n,i);if(r===null)Kv(t,e,i,by,n),y5(t,i);else if(a9(r,t,e,n,i))i.stopPropagation();else if(y5(t,i),e&4&&-1<o9.indexOf(t)){for(;r!==null;){var s=Og(r);if(s!==null&&g8(s),s=Qw(t,e,n,i),s===null&&Kv(t,e,i,by,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else Kv(t,e,i,null,n)}}var by=null;function Qw(t,e,n,i){if(by=null,t=oE(i),t=Eh(t),t!==null)if(e=t0(t),e===null)t=null;else if(n=e.tag,n===13){if(t=l8(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return by=t,null}function x8(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XN()){case aE:return 1;case h8:return 4;case vy:case KN:return 16;case f8:return 536870912;default:return 16}default:return 16}}var Pc=null,cE=null,O1=null;function w8(){if(O1)return O1;var t,e=cE,n=e.length,i,r="value"in Pc?Pc.value:Pc.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var u=n-t;for(i=1;i<=u&&e[n-i]===r[s-i];i++);return O1=r.slice(t,1<i?1-i:void 0)}function F1(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Om(){return!0}function v5(){return!1}function Oa(t){function e(n,i,r,s,u){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=u,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Om:v5,this.isPropagationStopped=v5,this}return vr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Om)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Om)},persist:function(){},isPersistent:Om}),e}var od={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hE=Oa(od),zg=vr({},od,{view:0,detail:0}),c9=Oa(zg),jv,$v,Ud,X_=vr({},zg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fE,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ud&&(Ud&&t.type==="mousemove"?(jv=t.screenX-Ud.screenX,$v=t.screenY-Ud.screenY):$v=jv=0,Ud=t),jv)},movementY:function(t){return"movementY"in t?t.movementY:$v}}),x5=Oa(X_),h9=vr({},X_,{dataTransfer:0}),f9=Oa(h9),d9=vr({},zg,{relatedTarget:0}),Hv=Oa(d9),p9=vr({},od,{animationName:0,elapsedTime:0,pseudoElement:0}),g9=Oa(p9),m9=vr({},od,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),y9=Oa(m9),_9=vr({},od,{data:0}),w5=Oa(_9),v9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},x9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},w9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function b9(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=w9[t])?!!e[t]:!1}function fE(){return b9}var E9=vr({},zg,{key:function(t){if(t.key){var e=v9[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=F1(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?x9[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fE,charCode:function(t){return t.type==="keypress"?F1(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?F1(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),T9=Oa(E9),S9=vr({},X_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),b5=Oa(S9),M9=vr({},zg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fE}),C9=Oa(M9),P9=vr({},od,{propertyName:0,elapsedTime:0,pseudoElement:0}),I9=Oa(P9),k9=vr({},X_,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),L9=Oa(k9),D9=[9,13,27,32],dE=zu&&"CompositionEvent"in window,Pp=null;zu&&"documentMode"in document&&(Pp=document.documentMode);var R9=zu&&"TextEvent"in window&&!Pp,b8=zu&&(!dE||Pp&&8<Pp&&11>=Pp),E5=String.fromCharCode(32),T5=!1;function E8(t,e){switch(t){case"keyup":return D9.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function T8(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var G0=!1;function B9(t,e){switch(t){case"compositionend":return T8(e);case"keypress":return e.which!==32?null:(T5=!0,E5);case"textInput":return t=e.data,t===E5&&T5?null:t;default:return null}}function z9(t,e){if(G0)return t==="compositionend"||!dE&&E8(t,e)?(t=w8(),O1=cE=Pc=null,G0=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return b8&&e.locale!=="ko"?null:e.data;default:return null}}var O9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function S5(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!O9[t.type]:e==="textarea"}function S8(t,e,n,i){i8(i),e=Ey(e,"onChange"),0<e.length&&(n=new hE("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Ip=null,Yp=null;function F9(t){O8(t,0)}function K_(t){var e=H0(t);if(Yk(e))return t}function N9(t,e){if(t==="change")return e}var M8=!1;if(zu){var Wv;if(zu){var Qv="oninput"in document;if(!Qv){var M5=document.createElement("div");M5.setAttribute("oninput","return;"),Qv=typeof M5.oninput=="function"}Wv=Qv}else Wv=!1;M8=Wv&&(!document.documentMode||9<document.documentMode)}function C5(){Ip&&(Ip.detachEvent("onpropertychange",C8),Yp=Ip=null)}function C8(t){if(t.propertyName==="value"&&K_(Yp)){var e=[];S8(e,Yp,t,oE(t)),a8(F9,e)}}function U9(t,e,n){t==="focusin"?(C5(),Ip=e,Yp=n,Ip.attachEvent("onpropertychange",C8)):t==="focusout"&&C5()}function V9(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return K_(Yp)}function G9(t,e){if(t==="click")return K_(e)}function j9(t,e){if(t==="input"||t==="change")return K_(e)}function $9(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var eA=typeof Object.is=="function"?Object.is:$9;function Xp(t,e){if(eA(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!Pw.call(e,r)||!eA(t[r],e[r]))return!1}return!0}function P5(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function I5(t,e){var n=P5(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=P5(n)}}function P8(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?P8(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function I8(){for(var t=window,e=my();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=my(t.document)}return e}function pE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function H9(t){var e=I8(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&P8(n.ownerDocument.documentElement,n)){if(i!==null&&pE(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=I5(n,s);var u=I5(n,i);r&&u&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==u.node||t.focusOffset!==u.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(u.node,u.offset)):(e.setEnd(u.node,u.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var W9=zu&&"documentMode"in document&&11>=document.documentMode,j0=null,qw=null,kp=null,Zw=!1;function k5(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Zw||j0==null||j0!==my(i)||(i=j0,"selectionStart"in i&&pE(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),kp&&Xp(kp,i)||(kp=i,i=Ey(qw,"onSelect"),0<i.length&&(e=new hE("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=j0)))}function Fm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var $0={animationend:Fm("Animation","AnimationEnd"),animationiteration:Fm("Animation","AnimationIteration"),animationstart:Fm("Animation","AnimationStart"),transitionend:Fm("Transition","TransitionEnd")},qv={},k8={};zu&&(k8=document.createElement("div").style,"AnimationEvent"in window||(delete $0.animationend.animation,delete $0.animationiteration.animation,delete $0.animationstart.animation),"TransitionEvent"in window||delete $0.transitionend.transition);function J_(t){if(qv[t])return qv[t];if(!$0[t])return t;var e=$0[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in k8)return qv[t]=e[n];return t}var L8=J_("animationend"),D8=J_("animationiteration"),R8=J_("animationstart"),B8=J_("transitionend"),z8=new Map,L5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function th(t,e){z8.set(t,e),e0(e,[t])}for(var Zv=0;Zv<L5.length;Zv++){var Yv=L5[Zv],Q9=Yv.toLowerCase(),q9=Yv[0].toUpperCase()+Yv.slice(1);th(Q9,"on"+q9)}th(L8,"onAnimationEnd");th(D8,"onAnimationIteration");th(R8,"onAnimationStart");th("dblclick","onDoubleClick");th("focusin","onFocus");th("focusout","onBlur");th(B8,"onTransitionEnd");Lf("onMouseEnter",["mouseout","mouseover"]);Lf("onMouseLeave",["mouseout","mouseover"]);Lf("onPointerEnter",["pointerout","pointerover"]);Lf("onPointerLeave",["pointerout","pointerover"]);e0("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));e0("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));e0("onBeforeInput",["compositionend","keypress","textInput","paste"]);e0("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));e0("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));e0("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Z9=new Set("cancel close invalid load scroll toggle".split(" ").concat(gp));function D5(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,QN(i,e,void 0,t),t.currentTarget=null}function O8(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var u=i.length-1;0<=u;u--){var a=i[u],y=a.instance,w=a.currentTarget;if(a=a.listener,y!==s&&r.isPropagationStopped())break e;D5(r,a,w),s=y}else for(u=0;u<i.length;u++){if(a=i[u],y=a.instance,w=a.currentTarget,a=a.listener,y!==s&&r.isPropagationStopped())break e;D5(r,a,w),s=y}}}if(_y)throw t=$w,_y=!1,$w=null,t}function rr(t,e){var n=e[eb];n===void 0&&(n=e[eb]=new Set);var i=t+"__bubble";n.has(i)||(F8(e,t,2,!1),n.add(i))}function Xv(t,e,n){var i=0;e&&(i|=4),F8(n,t,i,e)}var Nm="_reactListening"+Math.random().toString(36).slice(2);function Kp(t){if(!t[Nm]){t[Nm]=!0,Hk.forEach(function(n){n!=="selectionchange"&&(Z9.has(n)||Xv(n,!1,t),Xv(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Nm]||(e[Nm]=!0,Xv("selectionchange",!1,e))}}function F8(t,e,n,i){switch(x8(e)){case 1:var r=A9;break;case 4:r=u9;break;default:r=uE}n=r.bind(null,e,n,t),r=void 0,!jw||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Kv(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var u=i.tag;if(u===3||u===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(u===4)for(u=i.return;u!==null;){var y=u.tag;if((y===3||y===4)&&(y=u.stateNode.containerInfo,y===r||y.nodeType===8&&y.parentNode===r))return;u=u.return}for(;a!==null;){if(u=Eh(a),u===null)return;if(y=u.tag,y===5||y===6){i=s=u;continue e}a=a.parentNode}}i=i.return}a8(function(){var w=s,I=oE(n),P=[];e:{var L=z8.get(t);if(L!==void 0){var U=hE,Q=t;switch(t){case"keypress":if(F1(n)===0)break e;case"keydown":case"keyup":U=T9;break;case"focusin":Q="focus",U=Hv;break;case"focusout":Q="blur",U=Hv;break;case"beforeblur":case"afterblur":U=Hv;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":U=x5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":U=f9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":U=C9;break;case L8:case D8:case R8:U=g9;break;case B8:U=I9;break;case"scroll":U=c9;break;case"wheel":U=L9;break;case"copy":case"cut":case"paste":U=y9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":U=b5}var Z=(e&4)!==0,ae=!Z&&t==="scroll",Y=Z?L!==null?L+"Capture":null:L;Z=[];for(var te=w,re;te!==null;){re=te;var de=re.stateNode;if(re.tag===5&&de!==null&&(re=de,Y!==null&&(de=Wp(te,Y),de!=null&&Z.push(Jp(te,de,re)))),ae)break;te=te.return}0<Z.length&&(L=new U(L,Q,null,n,I),P.push({event:L,listeners:Z}))}}if(!(e&7)){e:{if(L=t==="mouseover"||t==="pointerover",U=t==="mouseout"||t==="pointerout",L&&n!==Vw&&(Q=n.relatedTarget||n.fromElement)&&(Eh(Q)||Q[Ou]))break e;if((U||L)&&(L=I.window===I?I:(L=I.ownerDocument)?L.defaultView||L.parentWindow:window,U?(Q=n.relatedTarget||n.toElement,U=w,Q=Q?Eh(Q):null,Q!==null&&(ae=t0(Q),Q!==ae||Q.tag!==5&&Q.tag!==6)&&(Q=null)):(U=null,Q=w),U!==Q)){if(Z=x5,de="onMouseLeave",Y="onMouseEnter",te="mouse",(t==="pointerout"||t==="pointerover")&&(Z=b5,de="onPointerLeave",Y="onPointerEnter",te="pointer"),ae=U==null?L:H0(U),re=Q==null?L:H0(Q),L=new Z(de,te+"leave",U,n,I),L.target=ae,L.relatedTarget=re,de=null,Eh(I)===w&&(Z=new Z(Y,te+"enter",Q,n,I),Z.target=re,Z.relatedTarget=ae,de=Z),ae=de,U&&Q)t:{for(Z=U,Y=Q,te=0,re=Z;re;re=T0(re))te++;for(re=0,de=Y;de;de=T0(de))re++;for(;0<te-re;)Z=T0(Z),te--;for(;0<re-te;)Y=T0(Y),re--;for(;te--;){if(Z===Y||Y!==null&&Z===Y.alternate)break t;Z=T0(Z),Y=T0(Y)}Z=null}else Z=null;U!==null&&R5(P,L,U,Z,!1),Q!==null&&ae!==null&&R5(P,ae,Q,Z,!0)}}e:{if(L=w?H0(w):window,U=L.nodeName&&L.nodeName.toLowerCase(),U==="select"||U==="input"&&L.type==="file")var ve=N9;else if(S5(L))if(M8)ve=j9;else{ve=V9;var Me=U9}else(U=L.nodeName)&&U.toLowerCase()==="input"&&(L.type==="checkbox"||L.type==="radio")&&(ve=G9);if(ve&&(ve=ve(t,w))){S8(P,ve,n,I);break e}Me&&Me(t,L,w),t==="focusout"&&(Me=L._wrapperState)&&Me.controlled&&L.type==="number"&&zw(L,"number",L.value)}switch(Me=w?H0(w):window,t){case"focusin":(S5(Me)||Me.contentEditable==="true")&&(j0=Me,qw=w,kp=null);break;case"focusout":kp=qw=j0=null;break;case"mousedown":Zw=!0;break;case"contextmenu":case"mouseup":case"dragend":Zw=!1,k5(P,n,I);break;case"selectionchange":if(W9)break;case"keydown":case"keyup":k5(P,n,I)}var He;if(dE)e:{switch(t){case"compositionstart":var Qe="onCompositionStart";break e;case"compositionend":Qe="onCompositionEnd";break e;case"compositionupdate":Qe="onCompositionUpdate";break e}Qe=void 0}else G0?E8(t,n)&&(Qe="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(Qe="onCompositionStart");Qe&&(b8&&n.locale!=="ko"&&(G0||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&G0&&(He=w8()):(Pc=I,cE="value"in Pc?Pc.value:Pc.textContent,G0=!0)),Me=Ey(w,Qe),0<Me.length&&(Qe=new w5(Qe,t,null,n,I),P.push({event:Qe,listeners:Me}),He?Qe.data=He:(He=T8(n),He!==null&&(Qe.data=He)))),(He=R9?B9(t,n):z9(t,n))&&(w=Ey(w,"onBeforeInput"),0<w.length&&(I=new w5("onBeforeInput","beforeinput",null,n,I),P.push({event:I,listeners:w}),I.data=He))}O8(P,e)})}function Jp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ey(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Wp(t,n),s!=null&&i.unshift(Jp(t,s,r)),s=Wp(t,e),s!=null&&i.push(Jp(t,s,r))),t=t.return}return i}function T0(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function R5(t,e,n,i,r){for(var s=e._reactName,u=[];n!==null&&n!==i;){var a=n,y=a.alternate,w=a.stateNode;if(y!==null&&y===i)break;a.tag===5&&w!==null&&(a=w,r?(y=Wp(n,s),y!=null&&u.unshift(Jp(n,y,a))):r||(y=Wp(n,s),y!=null&&u.push(Jp(n,y,a)))),n=n.return}u.length!==0&&t.push({event:e,listeners:u})}var Y9=/\r\n?/g,X9=/\u0000|\uFFFD/g;function B5(t){return(typeof t=="string"?t:""+t).replace(Y9,`
`).replace(X9,"")}function Um(t,e,n){if(e=B5(e),B5(t)!==e&&n)throw Error(Rt(425))}function Ty(){}var Yw=null,Xw=null;function Kw(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Jw=typeof setTimeout=="function"?setTimeout:void 0,K9=typeof clearTimeout=="function"?clearTimeout:void 0,z5=typeof Promise=="function"?Promise:void 0,J9=typeof queueMicrotask=="function"?queueMicrotask:typeof z5<"u"?function(t){return z5.resolve(null).then(t).catch(eU)}:Jw;function eU(t){setTimeout(function(){throw t})}function Jv(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),Zp(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);Zp(e)}function Fc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function O5(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ad=Math.random().toString(36).slice(2),CA="__reactFiber$"+ad,eg="__reactProps$"+ad,Ou="__reactContainer$"+ad,eb="__reactEvents$"+ad,tU="__reactListeners$"+ad,nU="__reactHandles$"+ad;function Eh(t){var e=t[CA];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ou]||n[CA]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=O5(t);t!==null;){if(n=t[CA])return n;t=O5(t)}return e}t=n,n=t.parentNode}return null}function Og(t){return t=t[CA]||t[Ou],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function H0(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Rt(33))}function e2(t){return t[eg]||null}var tb=[],W0=-1;function nh(t){return{current:t}}function sr(t){0>W0||(t.current=tb[W0],tb[W0]=null,W0--)}function Xi(t,e){W0++,tb[W0]=t.current,t.current=e}var Zc={},co=nh(Zc),ta=nh(!1),Rh=Zc;function Df(t,e){var n=t.type.contextTypes;if(!n)return Zc;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function na(t){return t=t.childContextTypes,t!=null}function Sy(){sr(ta),sr(co)}function F5(t,e,n){if(co.current!==Zc)throw Error(Rt(168));Xi(co,e),Xi(ta,n)}function N8(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(Rt(108,UN(t)||"Unknown",r));return vr({},n,i)}function My(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Zc,Rh=co.current,Xi(co,t),Xi(ta,ta.current),!0}function N5(t,e,n){var i=t.stateNode;if(!i)throw Error(Rt(169));n?(t=N8(t,e,Rh),i.__reactInternalMemoizedMergedChildContext=t,sr(ta),sr(co),Xi(co,t)):sr(ta),Xi(ta,n)}var wu=null,t2=!1,ex=!1;function U8(t){wu===null?wu=[t]:wu.push(t)}function iU(t){t2=!0,U8(t)}function ih(){if(!ex&&wu!==null){ex=!0;var t=0,e=Di;try{var n=wu;for(Di=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}wu=null,t2=!1}catch(r){throw wu!==null&&(wu=wu.slice(t+1)),c8(aE,ih),r}finally{Di=e,ex=!1}}return null}var Q0=[],q0=0,Cy=null,Py=0,ll=[],Al=0,Bh=null,Tu=1,Su="";function _h(t,e){Q0[q0++]=Py,Q0[q0++]=Cy,Cy=t,Py=e}function V8(t,e,n){ll[Al++]=Tu,ll[Al++]=Su,ll[Al++]=Bh,Bh=t;var i=Tu;t=Su;var r=32-Xl(i)-1;i&=~(1<<r),n+=1;var s=32-Xl(e)+r;if(30<s){var u=r-r%5;s=(i&(1<<u)-1).toString(32),i>>=u,r-=u,Tu=1<<32-Xl(e)+r|n<<r|i,Su=s+t}else Tu=1<<s|n<<r|i,Su=t}function gE(t){t.return!==null&&(_h(t,1),V8(t,1,0))}function mE(t){for(;t===Cy;)Cy=Q0[--q0],Q0[q0]=null,Py=Q0[--q0],Q0[q0]=null;for(;t===Bh;)Bh=ll[--Al],ll[Al]=null,Su=ll[--Al],ll[Al]=null,Tu=ll[--Al],ll[Al]=null}var Da=null,ka=null,cr=!1,jl=null;function G8(t,e){var n=ul(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function U5(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Da=t,ka=Fc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Da=t,ka=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Bh!==null?{id:Tu,overflow:Su}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ul(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Da=t,ka=null,!0):!1;default:return!1}}function nb(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ib(t){if(cr){var e=ka;if(e){var n=e;if(!U5(t,e)){if(nb(t))throw Error(Rt(418));e=Fc(n.nextSibling);var i=Da;e&&U5(t,e)?G8(i,n):(t.flags=t.flags&-4097|2,cr=!1,Da=t)}}else{if(nb(t))throw Error(Rt(418));t.flags=t.flags&-4097|2,cr=!1,Da=t}}}function V5(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Da=t}function Vm(t){if(t!==Da)return!1;if(!cr)return V5(t),cr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Kw(t.type,t.memoizedProps)),e&&(e=ka)){if(nb(t))throw j8(),Error(Rt(418));for(;e;)G8(t,e),e=Fc(e.nextSibling)}if(V5(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Rt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ka=Fc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ka=null}}else ka=Da?Fc(t.stateNode.nextSibling):null;return!0}function j8(){for(var t=ka;t;)t=Fc(t.nextSibling)}function Rf(){ka=Da=null,cr=!1}function yE(t){jl===null?jl=[t]:jl.push(t)}var rU=Zu.ReactCurrentBatchConfig;function Vl(t,e){if(t&&t.defaultProps){e=vr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Iy=nh(null),ky=null,Z0=null,_E=null;function vE(){_E=Z0=ky=null}function xE(t){var e=Iy.current;sr(Iy),t._currentValue=e}function rb(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function _f(t,e){ky=t,_E=Z0=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ea=!0),t.firstContext=null)}function pl(t){var e=t._currentValue;if(_E!==t)if(t={context:t,memoizedValue:e,next:null},Z0===null){if(ky===null)throw Error(Rt(308));Z0=t,ky.dependencies={lanes:0,firstContext:t}}else Z0=Z0.next=t;return e}var Th=null;function wE(t){Th===null?Th=[t]:Th.push(t)}function $8(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,wE(e)):(n.next=r.next,r.next=n),e.interleaved=n,Fu(t,i)}function Fu(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ec=!1;function bE(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function H8(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Lu(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Nc(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,wi&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Fu(t,n)}return r=i.interleaved,r===null?(e.next=e,wE(i)):(e.next=r.next,r.next=e),i.interleaved=e,Fu(t,n)}function N1(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,lE(t,n)}}function G5(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var u={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=u:s=s.next=u,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ly(t,e,n,i){var r=t.updateQueue;Ec=!1;var s=r.firstBaseUpdate,u=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var y=a,w=y.next;y.next=null,u===null?s=w:u.next=w,u=y;var I=t.alternate;I!==null&&(I=I.updateQueue,a=I.lastBaseUpdate,a!==u&&(a===null?I.firstBaseUpdate=w:a.next=w,I.lastBaseUpdate=y))}if(s!==null){var P=r.baseState;u=0,I=w=y=null,a=s;do{var L=a.lane,U=a.eventTime;if((i&L)===L){I!==null&&(I=I.next={eventTime:U,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var Q=t,Z=a;switch(L=e,U=n,Z.tag){case 1:if(Q=Z.payload,typeof Q=="function"){P=Q.call(U,P,L);break e}P=Q;break e;case 3:Q.flags=Q.flags&-65537|128;case 0:if(Q=Z.payload,L=typeof Q=="function"?Q.call(U,P,L):Q,L==null)break e;P=vr({},P,L);break e;case 2:Ec=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,L=r.effects,L===null?r.effects=[a]:L.push(a))}else U={eventTime:U,lane:L,tag:a.tag,payload:a.payload,callback:a.callback,next:null},I===null?(w=I=U,y=P):I=I.next=U,u|=L;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;L=a,a=L.next,L.next=null,r.lastBaseUpdate=L,r.shared.pending=null}}while(1);if(I===null&&(y=P),r.baseState=y,r.firstBaseUpdate=w,r.lastBaseUpdate=I,e=r.shared.interleaved,e!==null){r=e;do u|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Oh|=u,t.lanes=u,t.memoizedState=P}}function j5(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(Rt(191,r));r.call(i)}}}var W8=new $k.Component().refs;function sb(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:vr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var n2={isMounted:function(t){return(t=t._reactInternals)?t0(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Ro(),r=Vc(t),s=Lu(i,r);s.payload=e,n!=null&&(s.callback=n),e=Nc(t,s,r),e!==null&&(Kl(e,t,r,i),N1(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Ro(),r=Vc(t),s=Lu(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Nc(t,s,r),e!==null&&(Kl(e,t,r,i),N1(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ro(),i=Vc(t),r=Lu(n,i);r.tag=2,e!=null&&(r.callback=e),e=Nc(t,r,i),e!==null&&(Kl(e,t,i,n),N1(e,t,i))}};function $5(t,e,n,i,r,s,u){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,u):e.prototype&&e.prototype.isPureReactComponent?!Xp(n,i)||!Xp(r,s):!0}function Q8(t,e,n){var i=!1,r=Zc,s=e.contextType;return typeof s=="object"&&s!==null?s=pl(s):(r=na(e)?Rh:co.current,i=e.contextTypes,s=(i=i!=null)?Df(t,r):Zc),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=n2,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function H5(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&n2.enqueueReplaceState(e,e.state,null)}function ob(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=W8,bE(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=pl(s):(s=na(e)?Rh:co.current,r.context=Df(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(sb(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&n2.enqueueReplaceState(r,r.state,null),Ly(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Vd(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Rt(309));var i=n.stateNode}if(!i)throw Error(Rt(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(u){var a=r.refs;a===W8&&(a=r.refs={}),u===null?delete a[s]:a[s]=u},e._stringRef=s,e)}if(typeof t!="string")throw Error(Rt(284));if(!n._owner)throw Error(Rt(290,t))}return t}function Gm(t,e){throw t=Object.prototype.toString.call(e),Error(Rt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function W5(t){var e=t._init;return e(t._payload)}function q8(t){function e(Y,te){if(t){var re=Y.deletions;re===null?(Y.deletions=[te],Y.flags|=16):re.push(te)}}function n(Y,te){if(!t)return null;for(;te!==null;)e(Y,te),te=te.sibling;return null}function i(Y,te){for(Y=new Map;te!==null;)te.key!==null?Y.set(te.key,te):Y.set(te.index,te),te=te.sibling;return Y}function r(Y,te){return Y=Gc(Y,te),Y.index=0,Y.sibling=null,Y}function s(Y,te,re){return Y.index=re,t?(re=Y.alternate,re!==null?(re=re.index,re<te?(Y.flags|=2,te):re):(Y.flags|=2,te)):(Y.flags|=1048576,te)}function u(Y){return t&&Y.alternate===null&&(Y.flags|=2),Y}function a(Y,te,re,de){return te===null||te.tag!==6?(te=ax(re,Y.mode,de),te.return=Y,te):(te=r(te,re),te.return=Y,te)}function y(Y,te,re,de){var ve=re.type;return ve===V0?I(Y,te,re.props.children,de,re.key):te!==null&&(te.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===bc&&W5(ve)===te.type)?(de=r(te,re.props),de.ref=Vd(Y,te,re),de.return=Y,de):(de=H1(re.type,re.key,re.props,null,Y.mode,de),de.ref=Vd(Y,te,re),de.return=Y,de)}function w(Y,te,re,de){return te===null||te.tag!==4||te.stateNode.containerInfo!==re.containerInfo||te.stateNode.implementation!==re.implementation?(te=lx(re,Y.mode,de),te.return=Y,te):(te=r(te,re.children||[]),te.return=Y,te)}function I(Y,te,re,de,ve){return te===null||te.tag!==7?(te=kh(re,Y.mode,de,ve),te.return=Y,te):(te=r(te,re),te.return=Y,te)}function P(Y,te,re){if(typeof te=="string"&&te!==""||typeof te=="number")return te=ax(""+te,Y.mode,re),te.return=Y,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case km:return re=H1(te.type,te.key,te.props,null,Y.mode,re),re.ref=Vd(Y,null,te),re.return=Y,re;case U0:return te=lx(te,Y.mode,re),te.return=Y,te;case bc:var de=te._init;return P(Y,de(te._payload),re)}if(dp(te)||zd(te))return te=kh(te,Y.mode,re,null),te.return=Y,te;Gm(Y,te)}return null}function L(Y,te,re,de){var ve=te!==null?te.key:null;if(typeof re=="string"&&re!==""||typeof re=="number")return ve!==null?null:a(Y,te,""+re,de);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case km:return re.key===ve?y(Y,te,re,de):null;case U0:return re.key===ve?w(Y,te,re,de):null;case bc:return ve=re._init,L(Y,te,ve(re._payload),de)}if(dp(re)||zd(re))return ve!==null?null:I(Y,te,re,de,null);Gm(Y,re)}return null}function U(Y,te,re,de,ve){if(typeof de=="string"&&de!==""||typeof de=="number")return Y=Y.get(re)||null,a(te,Y,""+de,ve);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case km:return Y=Y.get(de.key===null?re:de.key)||null,y(te,Y,de,ve);case U0:return Y=Y.get(de.key===null?re:de.key)||null,w(te,Y,de,ve);case bc:var Me=de._init;return U(Y,te,re,Me(de._payload),ve)}if(dp(de)||zd(de))return Y=Y.get(re)||null,I(te,Y,de,ve,null);Gm(te,de)}return null}function Q(Y,te,re,de){for(var ve=null,Me=null,He=te,Qe=te=0,et=null;He!==null&&Qe<re.length;Qe++){He.index>Qe?(et=He,He=null):et=He.sibling;var tt=L(Y,He,re[Qe],de);if(tt===null){He===null&&(He=et);break}t&&He&&tt.alternate===null&&e(Y,He),te=s(tt,te,Qe),Me===null?ve=tt:Me.sibling=tt,Me=tt,He=et}if(Qe===re.length)return n(Y,He),cr&&_h(Y,Qe),ve;if(He===null){for(;Qe<re.length;Qe++)He=P(Y,re[Qe],de),He!==null&&(te=s(He,te,Qe),Me===null?ve=He:Me.sibling=He,Me=He);return cr&&_h(Y,Qe),ve}for(He=i(Y,He);Qe<re.length;Qe++)et=U(He,Y,Qe,re[Qe],de),et!==null&&(t&&et.alternate!==null&&He.delete(et.key===null?Qe:et.key),te=s(et,te,Qe),Me===null?ve=et:Me.sibling=et,Me=et);return t&&He.forEach(function(Ve){return e(Y,Ve)}),cr&&_h(Y,Qe),ve}function Z(Y,te,re,de){var ve=zd(re);if(typeof ve!="function")throw Error(Rt(150));if(re=ve.call(re),re==null)throw Error(Rt(151));for(var Me=ve=null,He=te,Qe=te=0,et=null,tt=re.next();He!==null&&!tt.done;Qe++,tt=re.next()){He.index>Qe?(et=He,He=null):et=He.sibling;var Ve=L(Y,He,tt.value,de);if(Ve===null){He===null&&(He=et);break}t&&He&&Ve.alternate===null&&e(Y,He),te=s(Ve,te,Qe),Me===null?ve=Ve:Me.sibling=Ve,Me=Ve,He=et}if(tt.done)return n(Y,He),cr&&_h(Y,Qe),ve;if(He===null){for(;!tt.done;Qe++,tt=re.next())tt=P(Y,tt.value,de),tt!==null&&(te=s(tt,te,Qe),Me===null?ve=tt:Me.sibling=tt,Me=tt);return cr&&_h(Y,Qe),ve}for(He=i(Y,He);!tt.done;Qe++,tt=re.next())tt=U(He,Y,Qe,tt.value,de),tt!==null&&(t&&tt.alternate!==null&&He.delete(tt.key===null?Qe:tt.key),te=s(tt,te,Qe),Me===null?ve=tt:Me.sibling=tt,Me=tt);return t&&He.forEach(function(nt){return e(Y,nt)}),cr&&_h(Y,Qe),ve}function ae(Y,te,re,de){if(typeof re=="object"&&re!==null&&re.type===V0&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case km:e:{for(var ve=re.key,Me=te;Me!==null;){if(Me.key===ve){if(ve=re.type,ve===V0){if(Me.tag===7){n(Y,Me.sibling),te=r(Me,re.props.children),te.return=Y,Y=te;break e}}else if(Me.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===bc&&W5(ve)===Me.type){n(Y,Me.sibling),te=r(Me,re.props),te.ref=Vd(Y,Me,re),te.return=Y,Y=te;break e}n(Y,Me);break}else e(Y,Me);Me=Me.sibling}re.type===V0?(te=kh(re.props.children,Y.mode,de,re.key),te.return=Y,Y=te):(de=H1(re.type,re.key,re.props,null,Y.mode,de),de.ref=Vd(Y,te,re),de.return=Y,Y=de)}return u(Y);case U0:e:{for(Me=re.key;te!==null;){if(te.key===Me)if(te.tag===4&&te.stateNode.containerInfo===re.containerInfo&&te.stateNode.implementation===re.implementation){n(Y,te.sibling),te=r(te,re.children||[]),te.return=Y,Y=te;break e}else{n(Y,te);break}else e(Y,te);te=te.sibling}te=lx(re,Y.mode,de),te.return=Y,Y=te}return u(Y);case bc:return Me=re._init,ae(Y,te,Me(re._payload),de)}if(dp(re))return Q(Y,te,re,de);if(zd(re))return Z(Y,te,re,de);Gm(Y,re)}return typeof re=="string"&&re!==""||typeof re=="number"?(re=""+re,te!==null&&te.tag===6?(n(Y,te.sibling),te=r(te,re),te.return=Y,Y=te):(n(Y,te),te=ax(re,Y.mode,de),te.return=Y,Y=te),u(Y)):n(Y,te)}return ae}var Bf=q8(!0),Z8=q8(!1),Fg={},RA=nh(Fg),tg=nh(Fg),ng=nh(Fg);function Sh(t){if(t===Fg)throw Error(Rt(174));return t}function EE(t,e){switch(Xi(ng,e),Xi(tg,t),Xi(RA,Fg),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fw(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Fw(e,t)}sr(RA),Xi(RA,e)}function zf(){sr(RA),sr(tg),sr(ng)}function Y8(t){Sh(ng.current);var e=Sh(RA.current),n=Fw(e,t.type);e!==n&&(Xi(tg,t),Xi(RA,n))}function TE(t){tg.current===t&&(sr(RA),sr(tg))}var pr=nh(0);function Dy(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var tx=[];function SE(){for(var t=0;t<tx.length;t++)tx[t]._workInProgressVersionPrimary=null;tx.length=0}var U1=Zu.ReactCurrentDispatcher,nx=Zu.ReactCurrentBatchConfig,zh=0,_r=null,Kr=null,ps=null,Ry=!1,Lp=!1,ig=0,sU=0;function Ys(){throw Error(Rt(321))}function ME(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!eA(t[n],e[n]))return!1;return!0}function CE(t,e,n,i,r,s){if(zh=s,_r=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,U1.current=t===null||t.memoizedState===null?AU:uU,t=n(i,r),Lp){s=0;do{if(Lp=!1,ig=0,25<=s)throw Error(Rt(301));s+=1,ps=Kr=null,e.updateQueue=null,U1.current=cU,t=n(i,r)}while(Lp)}if(U1.current=By,e=Kr!==null&&Kr.next!==null,zh=0,ps=Kr=_r=null,Ry=!1,e)throw Error(Rt(300));return t}function PE(){var t=ig!==0;return ig=0,t}function MA(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ps===null?_r.memoizedState=ps=t:ps=ps.next=t,ps}function gl(){if(Kr===null){var t=_r.alternate;t=t!==null?t.memoizedState:null}else t=Kr.next;var e=ps===null?_r.memoizedState:ps.next;if(e!==null)ps=e,Kr=t;else{if(t===null)throw Error(Rt(310));Kr=t,t={memoizedState:Kr.memoizedState,baseState:Kr.baseState,baseQueue:Kr.baseQueue,queue:Kr.queue,next:null},ps===null?_r.memoizedState=ps=t:ps=ps.next=t}return ps}function rg(t,e){return typeof e=="function"?e(t):e}function ix(t){var e=gl(),n=e.queue;if(n===null)throw Error(Rt(311));n.lastRenderedReducer=t;var i=Kr,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var u=r.next;r.next=s.next,s.next=u}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=u=null,y=null,w=s;do{var I=w.lane;if((zh&I)===I)y!==null&&(y=y.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),i=w.hasEagerState?w.eagerState:t(i,w.action);else{var P={lane:I,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};y===null?(a=y=P,u=i):y=y.next=P,_r.lanes|=I,Oh|=I}w=w.next}while(w!==null&&w!==s);y===null?u=i:y.next=a,eA(i,e.memoizedState)||(ea=!0),e.memoizedState=i,e.baseState=u,e.baseQueue=y,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,_r.lanes|=s,Oh|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function rx(t){var e=gl(),n=e.queue;if(n===null)throw Error(Rt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var u=r=r.next;do s=t(s,u.action),u=u.next;while(u!==r);eA(s,e.memoizedState)||(ea=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function X8(){}function K8(t,e){var n=_r,i=gl(),r=e(),s=!eA(i.memoizedState,r);if(s&&(i.memoizedState=r,ea=!0),i=i.queue,IE(tL.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||ps!==null&&ps.memoizedState.tag&1){if(n.flags|=2048,sg(9,eL.bind(null,n,i,r,e),void 0,null),ms===null)throw Error(Rt(349));zh&30||J8(n,e,r)}return r}function J8(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=_r.updateQueue,e===null?(e={lastEffect:null,stores:null},_r.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function eL(t,e,n,i){e.value=n,e.getSnapshot=i,nL(e)&&iL(t)}function tL(t,e,n){return n(function(){nL(e)&&iL(t)})}function nL(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!eA(t,n)}catch{return!0}}function iL(t){var e=Fu(t,1);e!==null&&Kl(e,t,1,-1)}function Q5(t){var e=MA();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rg,lastRenderedState:t},e.queue=t,t=t.dispatch=lU.bind(null,_r,t),[e.memoizedState,t]}function sg(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=_r.updateQueue,e===null?(e={lastEffect:null,stores:null},_r.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function rL(){return gl().memoizedState}function V1(t,e,n,i){var r=MA();_r.flags|=t,r.memoizedState=sg(1|e,n,void 0,i===void 0?null:i)}function i2(t,e,n,i){var r=gl();i=i===void 0?null:i;var s=void 0;if(Kr!==null){var u=Kr.memoizedState;if(s=u.destroy,i!==null&&ME(i,u.deps)){r.memoizedState=sg(e,n,s,i);return}}_r.flags|=t,r.memoizedState=sg(1|e,n,s,i)}function q5(t,e){return V1(8390656,8,t,e)}function IE(t,e){return i2(2048,8,t,e)}function sL(t,e){return i2(4,2,t,e)}function oL(t,e){return i2(4,4,t,e)}function aL(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function lL(t,e,n){return n=n!=null?n.concat([t]):null,i2(4,4,aL.bind(null,e,t),n)}function kE(){}function AL(t,e){var n=gl();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&ME(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function uL(t,e){var n=gl();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&ME(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function cL(t,e,n){return zh&21?(eA(n,e)||(n=d8(),_r.lanes|=n,Oh|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ea=!0),t.memoizedState=n)}function oU(t,e){var n=Di;Di=n!==0&&4>n?n:4,t(!0);var i=nx.transition;nx.transition={};try{t(!1),e()}finally{Di=n,nx.transition=i}}function hL(){return gl().memoizedState}function aU(t,e,n){var i=Vc(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},fL(t))dL(e,n);else if(n=$8(t,e,n,i),n!==null){var r=Ro();Kl(n,t,i,r),pL(n,e,i)}}function lU(t,e,n){var i=Vc(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(fL(t))dL(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var u=e.lastRenderedState,a=s(u,n);if(r.hasEagerState=!0,r.eagerState=a,eA(a,u)){var y=e.interleaved;y===null?(r.next=r,wE(e)):(r.next=y.next,y.next=r),e.interleaved=r;return}}catch{}finally{}n=$8(t,e,r,i),n!==null&&(r=Ro(),Kl(n,t,i,r),pL(n,e,i))}}function fL(t){var e=t.alternate;return t===_r||e!==null&&e===_r}function dL(t,e){Lp=Ry=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function pL(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,lE(t,n)}}var By={readContext:pl,useCallback:Ys,useContext:Ys,useEffect:Ys,useImperativeHandle:Ys,useInsertionEffect:Ys,useLayoutEffect:Ys,useMemo:Ys,useReducer:Ys,useRef:Ys,useState:Ys,useDebugValue:Ys,useDeferredValue:Ys,useTransition:Ys,useMutableSource:Ys,useSyncExternalStore:Ys,useId:Ys,unstable_isNewReconciler:!1},AU={readContext:pl,useCallback:function(t,e){return MA().memoizedState=[t,e===void 0?null:e],t},useContext:pl,useEffect:q5,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,V1(4194308,4,aL.bind(null,e,t),n)},useLayoutEffect:function(t,e){return V1(4194308,4,t,e)},useInsertionEffect:function(t,e){return V1(4,2,t,e)},useMemo:function(t,e){var n=MA();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=MA();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=aU.bind(null,_r,t),[i.memoizedState,t]},useRef:function(t){var e=MA();return t={current:t},e.memoizedState=t},useState:Q5,useDebugValue:kE,useDeferredValue:function(t){return MA().memoizedState=t},useTransition:function(){var t=Q5(!1),e=t[0];return t=oU.bind(null,t[1]),MA().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=_r,r=MA();if(cr){if(n===void 0)throw Error(Rt(407));n=n()}else{if(n=e(),ms===null)throw Error(Rt(349));zh&30||J8(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,q5(tL.bind(null,i,s,t),[t]),i.flags|=2048,sg(9,eL.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=MA(),e=ms.identifierPrefix;if(cr){var n=Su,i=Tu;n=(i&~(1<<32-Xl(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=ig++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=sU++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},uU={readContext:pl,useCallback:AL,useContext:pl,useEffect:IE,useImperativeHandle:lL,useInsertionEffect:sL,useLayoutEffect:oL,useMemo:uL,useReducer:ix,useRef:rL,useState:function(){return ix(rg)},useDebugValue:kE,useDeferredValue:function(t){var e=gl();return cL(e,Kr.memoizedState,t)},useTransition:function(){var t=ix(rg)[0],e=gl().memoizedState;return[t,e]},useMutableSource:X8,useSyncExternalStore:K8,useId:hL,unstable_isNewReconciler:!1},cU={readContext:pl,useCallback:AL,useContext:pl,useEffect:IE,useImperativeHandle:lL,useInsertionEffect:sL,useLayoutEffect:oL,useMemo:uL,useReducer:rx,useRef:rL,useState:function(){return rx(rg)},useDebugValue:kE,useDeferredValue:function(t){var e=gl();return Kr===null?e.memoizedState=t:cL(e,Kr.memoizedState,t)},useTransition:function(){var t=rx(rg)[0],e=gl().memoizedState;return[t,e]},useMutableSource:X8,useSyncExternalStore:K8,useId:hL,unstable_isNewReconciler:!1};function Of(t,e){try{var n="",i=e;do n+=NN(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function sx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ab(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var hU=typeof WeakMap=="function"?WeakMap:Map;function gL(t,e,n){n=Lu(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Oy||(Oy=!0,mb=i),ab(t,e)},n}function mL(t,e,n){n=Lu(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){ab(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){ab(t,e),typeof i!="function"&&(Uc===null?Uc=new Set([this]):Uc.add(this));var u=e.stack;this.componentDidCatch(e.value,{componentStack:u!==null?u:""})}),n}function Z5(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new hU;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=SU.bind(null,t,e,n),e.then(t,t))}function Y5(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function X5(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Lu(-1,1),e.tag=2,Nc(n,e,1))),n.lanes|=1),t)}var fU=Zu.ReactCurrentOwner,ea=!1;function Co(t,e,n,i){e.child=t===null?Z8(e,null,n,i):Bf(e,t.child,n,i)}function K5(t,e,n,i,r){n=n.render;var s=e.ref;return _f(e,r),i=CE(t,e,n,i,s,r),n=PE(),t!==null&&!ea?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Nu(t,e,r)):(cr&&n&&gE(e),e.flags|=1,Co(t,e,i,r),e.child)}function J5(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!NE(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,yL(t,e,s,i,r)):(t=H1(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var u=s.memoizedProps;if(n=n.compare,n=n!==null?n:Xp,n(u,i)&&t.ref===e.ref)return Nu(t,e,r)}return e.flags|=1,t=Gc(s,i),t.ref=e.ref,t.return=e,e.child=t}function yL(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(Xp(s,i)&&t.ref===e.ref)if(ea=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(ea=!0);else return e.lanes=t.lanes,Nu(t,e,r)}return lb(t,e,n,i,r)}function _L(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xi(X0,Ca),Ca|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Xi(X0,Ca),Ca|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,Xi(X0,Ca),Ca|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,Xi(X0,Ca),Ca|=i;return Co(t,e,r,n),e.child}function vL(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function lb(t,e,n,i,r){var s=na(n)?Rh:co.current;return s=Df(e,s),_f(e,r),n=CE(t,e,n,i,s,r),i=PE(),t!==null&&!ea?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Nu(t,e,r)):(cr&&i&&gE(e),e.flags|=1,Co(t,e,n,r),e.child)}function eM(t,e,n,i,r){if(na(n)){var s=!0;My(e)}else s=!1;if(_f(e,r),e.stateNode===null)G1(t,e),Q8(e,n,i),ob(e,n,i,r),i=!0;else if(t===null){var u=e.stateNode,a=e.memoizedProps;u.props=a;var y=u.context,w=n.contextType;typeof w=="object"&&w!==null?w=pl(w):(w=na(n)?Rh:co.current,w=Df(e,w));var I=n.getDerivedStateFromProps,P=typeof I=="function"||typeof u.getSnapshotBeforeUpdate=="function";P||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(a!==i||y!==w)&&H5(e,u,i,w),Ec=!1;var L=e.memoizedState;u.state=L,Ly(e,i,u,r),y=e.memoizedState,a!==i||L!==y||ta.current||Ec?(typeof I=="function"&&(sb(e,n,I,i),y=e.memoizedState),(a=Ec||$5(e,n,a,i,L,y,w))?(P||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(e.flags|=4194308)):(typeof u.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=y),u.props=i,u.state=y,u.context=w,i=a):(typeof u.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{u=e.stateNode,H8(t,e),a=e.memoizedProps,w=e.type===e.elementType?a:Vl(e.type,a),u.props=w,P=e.pendingProps,L=u.context,y=n.contextType,typeof y=="object"&&y!==null?y=pl(y):(y=na(n)?Rh:co.current,y=Df(e,y));var U=n.getDerivedStateFromProps;(I=typeof U=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(a!==P||L!==y)&&H5(e,u,i,y),Ec=!1,L=e.memoizedState,u.state=L,Ly(e,i,u,r);var Q=e.memoizedState;a!==P||L!==Q||ta.current||Ec?(typeof U=="function"&&(sb(e,n,U,i),Q=e.memoizedState),(w=Ec||$5(e,n,w,i,L,Q,y)||!1)?(I||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(i,Q,y),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(i,Q,y)),typeof u.componentDidUpdate=="function"&&(e.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof u.componentDidUpdate!="function"||a===t.memoizedProps&&L===t.memoizedState||(e.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&L===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=Q),u.props=i,u.state=Q,u.context=y,i=w):(typeof u.componentDidUpdate!="function"||a===t.memoizedProps&&L===t.memoizedState||(e.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&L===t.memoizedState||(e.flags|=1024),i=!1)}return Ab(t,e,n,i,s,r)}function Ab(t,e,n,i,r,s){vL(t,e);var u=(e.flags&128)!==0;if(!i&&!u)return r&&N5(e,n,!1),Nu(t,e,s);i=e.stateNode,fU.current=e;var a=u&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&u?(e.child=Bf(e,t.child,null,s),e.child=Bf(e,null,a,s)):Co(t,e,a,s),e.memoizedState=i.state,r&&N5(e,n,!0),e.child}function xL(t){var e=t.stateNode;e.pendingContext?F5(t,e.pendingContext,e.pendingContext!==e.context):e.context&&F5(t,e.context,!1),EE(t,e.containerInfo)}function tM(t,e,n,i,r){return Rf(),yE(r),e.flags|=256,Co(t,e,n,i),e.child}var ub={dehydrated:null,treeContext:null,retryLane:0};function cb(t){return{baseLanes:t,cachePool:null,transitions:null}}function wL(t,e,n){var i=e.pendingProps,r=pr.current,s=!1,u=(e.flags&128)!==0,a;if((a=u)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Xi(pr,r&1),t===null)return ib(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(u=i.children,t=i.fallback,s?(i=e.mode,s=e.child,u={mode:"hidden",children:u},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=u):s=o2(u,i,0,null),t=kh(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=cb(n),e.memoizedState=ub,t):LE(e,u));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return dU(t,e,u,i,a,r,n);if(s){s=i.fallback,u=e.mode,r=t.child,a=r.sibling;var y={mode:"hidden",children:i.children};return!(u&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=y,e.deletions=null):(i=Gc(r,y),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Gc(a,s):(s=kh(s,u,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,u=t.child.memoizedState,u=u===null?cb(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=t.childLanes&~n,e.memoizedState=ub,i}return s=t.child,t=s.sibling,i=Gc(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function LE(t,e){return e=o2({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function jm(t,e,n,i){return i!==null&&yE(i),Bf(e,t.child,null,n),t=LE(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function dU(t,e,n,i,r,s,u){if(n)return e.flags&256?(e.flags&=-257,i=sx(Error(Rt(422))),jm(t,e,u,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=o2({mode:"visible",children:i.children},r,0,null),s=kh(s,r,u,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Bf(e,t.child,null,u),e.child.memoizedState=cb(u),e.memoizedState=ub,s);if(!(e.mode&1))return jm(t,e,u,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(Rt(419)),i=sx(s,i,void 0),jm(t,e,u,i)}if(a=(u&t.childLanes)!==0,ea||a){if(i=ms,i!==null){switch(u&-u){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|u)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Fu(t,r),Kl(i,t,r,-1))}return FE(),i=sx(Error(Rt(421))),jm(t,e,u,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=MU.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,ka=Fc(r.nextSibling),Da=e,cr=!0,jl=null,t!==null&&(ll[Al++]=Tu,ll[Al++]=Su,ll[Al++]=Bh,Tu=t.id,Su=t.overflow,Bh=e),e=LE(e,i.children),e.flags|=4096,e)}function nM(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),rb(t.return,e,n)}function ox(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function bL(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Co(t,e,i.children,n),i=pr.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&nM(t,n,e);else if(t.tag===19)nM(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Xi(pr,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Dy(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),ox(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Dy(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}ox(e,!0,n,null,s);break;case"together":ox(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function G1(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Nu(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Oh|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Rt(153));if(e.child!==null){for(t=e.child,n=Gc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Gc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function pU(t,e,n){switch(e.tag){case 3:xL(e),Rf();break;case 5:Y8(e);break;case 1:na(e.type)&&My(e);break;case 4:EE(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Xi(Iy,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Xi(pr,pr.current&1),e.flags|=128,null):n&e.child.childLanes?wL(t,e,n):(Xi(pr,pr.current&1),t=Nu(t,e,n),t!==null?t.sibling:null);Xi(pr,pr.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return bL(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Xi(pr,pr.current),i)break;return null;case 22:case 23:return e.lanes=0,_L(t,e,n)}return Nu(t,e,n)}var EL,hb,TL,SL;EL=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};hb=function(){};TL=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Sh(RA.current);var s=null;switch(n){case"input":r=Rw(t,r),i=Rw(t,i),s=[];break;case"select":r=vr({},r,{value:void 0}),i=vr({},i,{value:void 0}),s=[];break;case"textarea":r=Ow(t,r),i=Ow(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=Ty)}Nw(n,i);var u;n=null;for(w in r)if(!i.hasOwnProperty(w)&&r.hasOwnProperty(w)&&r[w]!=null)if(w==="style"){var a=r[w];for(u in a)a.hasOwnProperty(u)&&(n||(n={}),n[u]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&($p.hasOwnProperty(w)?s||(s=[]):(s=s||[]).push(w,null));for(w in i){var y=i[w];if(a=r?.[w],i.hasOwnProperty(w)&&y!==a&&(y!=null||a!=null))if(w==="style")if(a){for(u in a)!a.hasOwnProperty(u)||y&&y.hasOwnProperty(u)||(n||(n={}),n[u]="");for(u in y)y.hasOwnProperty(u)&&a[u]!==y[u]&&(n||(n={}),n[u]=y[u])}else n||(s||(s=[]),s.push(w,n)),n=y;else w==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,a=a?a.__html:void 0,y!=null&&a!==y&&(s=s||[]).push(w,y)):w==="children"?typeof y!="string"&&typeof y!="number"||(s=s||[]).push(w,""+y):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&($p.hasOwnProperty(w)?(y!=null&&w==="onScroll"&&rr("scroll",t),s||a===y||(s=[])):(s=s||[]).push(w,y))}n&&(s=s||[]).push("style",n);var w=s;(e.updateQueue=w)&&(e.flags|=4)}};SL=function(t,e,n,i){n!==i&&(e.flags|=4)};function Gd(t,e){if(!cr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Xs(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function gU(t,e,n){var i=e.pendingProps;switch(mE(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xs(e),null;case 1:return na(e.type)&&Sy(),Xs(e),null;case 3:return i=e.stateNode,zf(),sr(ta),sr(co),SE(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Vm(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,jl!==null&&(vb(jl),jl=null))),hb(t,e),Xs(e),null;case 5:TE(e);var r=Sh(ng.current);if(n=e.type,t!==null&&e.stateNode!=null)TL(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(Rt(166));return Xs(e),null}if(t=Sh(RA.current),Vm(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[CA]=e,i[eg]=s,t=(e.mode&1)!==0,n){case"dialog":rr("cancel",i),rr("close",i);break;case"iframe":case"object":case"embed":rr("load",i);break;case"video":case"audio":for(r=0;r<gp.length;r++)rr(gp[r],i);break;case"source":rr("error",i);break;case"img":case"image":case"link":rr("error",i),rr("load",i);break;case"details":rr("toggle",i);break;case"input":c5(i,s),rr("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},rr("invalid",i);break;case"textarea":f5(i,s),rr("invalid",i)}Nw(n,s),r=null;for(var u in s)if(s.hasOwnProperty(u)){var a=s[u];u==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Um(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Um(i.textContent,a,t),r=["children",""+a]):$p.hasOwnProperty(u)&&a!=null&&u==="onScroll"&&rr("scroll",i)}switch(n){case"input":Lm(i),h5(i,s,!0);break;case"textarea":Lm(i),d5(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Ty)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{u=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Jk(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=u.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=u.createElement(n,{is:i.is}):(t=u.createElement(n),n==="select"&&(u=t,i.multiple?u.multiple=!0:i.size&&(u.size=i.size))):t=u.createElementNS(t,n),t[CA]=e,t[eg]=i,EL(t,e,!1,!1),e.stateNode=t;e:{switch(u=Uw(n,i),n){case"dialog":rr("cancel",t),rr("close",t),r=i;break;case"iframe":case"object":case"embed":rr("load",t),r=i;break;case"video":case"audio":for(r=0;r<gp.length;r++)rr(gp[r],t);r=i;break;case"source":rr("error",t),r=i;break;case"img":case"image":case"link":rr("error",t),rr("load",t),r=i;break;case"details":rr("toggle",t),r=i;break;case"input":c5(t,i),r=Rw(t,i),rr("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=vr({},i,{value:void 0}),rr("invalid",t);break;case"textarea":f5(t,i),r=Ow(t,i),rr("invalid",t);break;default:r=i}Nw(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var y=a[s];s==="style"?n8(t,y):s==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,y!=null&&e8(t,y)):s==="children"?typeof y=="string"?(n!=="textarea"||y!=="")&&Hp(t,y):typeof y=="number"&&Hp(t,""+y):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&($p.hasOwnProperty(s)?y!=null&&s==="onScroll"&&rr("scroll",t):y!=null&&nE(t,s,y,u))}switch(n){case"input":Lm(t),h5(t,i,!1);break;case"textarea":Lm(t),d5(t);break;case"option":i.value!=null&&t.setAttribute("value",""+qc(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?pf(t,!!i.multiple,s,!1):i.defaultValue!=null&&pf(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Ty)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Xs(e),null;case 6:if(t&&e.stateNode!=null)SL(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Rt(166));if(n=Sh(ng.current),Sh(RA.current),Vm(e)){if(i=e.stateNode,n=e.memoizedProps,i[CA]=e,(s=i.nodeValue!==n)&&(t=Da,t!==null))switch(t.tag){case 3:Um(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Um(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[CA]=e,e.stateNode=i}return Xs(e),null;case 13:if(sr(pr),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(cr&&ka!==null&&e.mode&1&&!(e.flags&128))j8(),Rf(),e.flags|=98560,s=!1;else if(s=Vm(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(Rt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Rt(317));s[CA]=e}else Rf(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xs(e),s=!1}else jl!==null&&(vb(jl),jl=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||pr.current&1?Jr===0&&(Jr=3):FE())),e.updateQueue!==null&&(e.flags|=4),Xs(e),null);case 4:return zf(),hb(t,e),t===null&&Kp(e.stateNode.containerInfo),Xs(e),null;case 10:return xE(e.type._context),Xs(e),null;case 17:return na(e.type)&&Sy(),Xs(e),null;case 19:if(sr(pr),s=e.memoizedState,s===null)return Xs(e),null;if(i=(e.flags&128)!==0,u=s.rendering,u===null)if(i)Gd(s,!1);else{if(Jr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(u=Dy(t),u!==null){for(e.flags|=128,Gd(s,!1),i=u.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,u=s.alternate,u===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,t=u.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Xi(pr,pr.current&1|2),e.child}t=t.sibling}s.tail!==null&&zr()>Ff&&(e.flags|=128,i=!0,Gd(s,!1),e.lanes=4194304)}else{if(!i)if(t=Dy(u),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Gd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!u.alternate&&!cr)return Xs(e),null}else 2*zr()-s.renderingStartTime>Ff&&n!==1073741824&&(e.flags|=128,i=!0,Gd(s,!1),e.lanes=4194304);s.isBackwards?(u.sibling=e.child,e.child=u):(n=s.last,n!==null?n.sibling=u:e.child=u,s.last=u)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=zr(),e.sibling=null,n=pr.current,Xi(pr,i?n&1|2:n&1),e):(Xs(e),null);case 22:case 23:return OE(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Ca&1073741824&&(Xs(e),e.subtreeFlags&6&&(e.flags|=8192)):Xs(e),null;case 24:return null;case 25:return null}throw Error(Rt(156,e.tag))}function mU(t,e){switch(mE(e),e.tag){case 1:return na(e.type)&&Sy(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return zf(),sr(ta),sr(co),SE(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return TE(e),null;case 13:if(sr(pr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Rt(340));Rf()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return sr(pr),null;case 4:return zf(),null;case 10:return xE(e.type._context),null;case 22:case 23:return OE(),null;case 24:return null;default:return null}}var $m=!1,ao=!1,yU=typeof WeakSet=="function"?WeakSet:Set,un=null;function Y0(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Mr(t,e,i)}else n.current=null}function fb(t,e,n){try{n()}catch(i){Mr(t,e,i)}}var iM=!1;function _U(t,e){if(Yw=wy,t=I8(),pE(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var u=0,a=-1,y=-1,w=0,I=0,P=t,L=null;t:for(;;){for(var U;P!==n||r!==0&&P.nodeType!==3||(a=u+r),P!==s||i!==0&&P.nodeType!==3||(y=u+i),P.nodeType===3&&(u+=P.nodeValue.length),(U=P.firstChild)!==null;)L=P,P=U;for(;;){if(P===t)break t;if(L===n&&++w===r&&(a=u),L===s&&++I===i&&(y=u),(U=P.nextSibling)!==null)break;P=L,L=P.parentNode}P=U}n=a===-1||y===-1?null:{start:a,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xw={focusedElem:t,selectionRange:n},wy=!1,un=e;un!==null;)if(e=un,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,un=t;else for(;un!==null;){e=un;try{var Q=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(Q!==null){var Z=Q.memoizedProps,ae=Q.memoizedState,Y=e.stateNode,te=Y.getSnapshotBeforeUpdate(e.elementType===e.type?Z:Vl(e.type,Z),ae);Y.__reactInternalSnapshotBeforeUpdate=te}break;case 3:var re=e.stateNode.containerInfo;re.nodeType===1?re.textContent="":re.nodeType===9&&re.documentElement&&re.removeChild(re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Rt(163))}}catch(de){Mr(e,e.return,de)}if(t=e.sibling,t!==null){t.return=e.return,un=t;break}un=e.return}return Q=iM,iM=!1,Q}function Dp(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&fb(e,n,s)}r=r.next}while(r!==i)}}function r2(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function db(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ML(t){var e=t.alternate;e!==null&&(t.alternate=null,ML(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[CA],delete e[eg],delete e[eb],delete e[tU],delete e[nU])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function CL(t){return t.tag===5||t.tag===3||t.tag===4}function rM(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||CL(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function pb(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ty));else if(i!==4&&(t=t.child,t!==null))for(pb(t,e,n),t=t.sibling;t!==null;)pb(t,e,n),t=t.sibling}function gb(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(gb(t,e,n),t=t.sibling;t!==null;)gb(t,e,n),t=t.sibling}var Ps=null,Gl=!1;function pc(t,e,n){for(n=n.child;n!==null;)PL(t,e,n),n=n.sibling}function PL(t,e,n){if(DA&&typeof DA.onCommitFiberUnmount=="function")try{DA.onCommitFiberUnmount(Y_,n)}catch{}switch(n.tag){case 5:ao||Y0(n,e);case 6:var i=Ps,r=Gl;Ps=null,pc(t,e,n),Ps=i,Gl=r,Ps!==null&&(Gl?(t=Ps,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ps.removeChild(n.stateNode));break;case 18:Ps!==null&&(Gl?(t=Ps,n=n.stateNode,t.nodeType===8?Jv(t.parentNode,n):t.nodeType===1&&Jv(t,n),Zp(t)):Jv(Ps,n.stateNode));break;case 4:i=Ps,r=Gl,Ps=n.stateNode.containerInfo,Gl=!0,pc(t,e,n),Ps=i,Gl=r;break;case 0:case 11:case 14:case 15:if(!ao&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,u=s.destroy;s=s.tag,u!==void 0&&(s&2||s&4)&&fb(n,e,u),r=r.next}while(r!==i)}pc(t,e,n);break;case 1:if(!ao&&(Y0(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Mr(n,e,a)}pc(t,e,n);break;case 21:pc(t,e,n);break;case 22:n.mode&1?(ao=(i=ao)||n.memoizedState!==null,pc(t,e,n),ao=i):pc(t,e,n);break;default:pc(t,e,n)}}function sM(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new yU),e.forEach(function(i){var r=CU.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function Ul(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,u=e,a=u;e:for(;a!==null;){switch(a.tag){case 5:Ps=a.stateNode,Gl=!1;break e;case 3:Ps=a.stateNode.containerInfo,Gl=!0;break e;case 4:Ps=a.stateNode.containerInfo,Gl=!0;break e}a=a.return}if(Ps===null)throw Error(Rt(160));PL(s,u,r),Ps=null,Gl=!1;var y=r.alternate;y!==null&&(y.return=null),r.return=null}catch(w){Mr(r,e,w)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)IL(e,t),e=e.sibling}function IL(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ul(e,t),vA(t),i&4){try{Dp(3,t,t.return),r2(3,t)}catch(Z){Mr(t,t.return,Z)}try{Dp(5,t,t.return)}catch(Z){Mr(t,t.return,Z)}}break;case 1:Ul(e,t),vA(t),i&512&&n!==null&&Y0(n,n.return);break;case 5:if(Ul(e,t),vA(t),i&512&&n!==null&&Y0(n,n.return),t.flags&32){var r=t.stateNode;try{Hp(r,"")}catch(Z){Mr(t,t.return,Z)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,u=n!==null?n.memoizedProps:s,a=t.type,y=t.updateQueue;if(t.updateQueue=null,y!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Xk(r,s),Uw(a,u);var w=Uw(a,s);for(u=0;u<y.length;u+=2){var I=y[u],P=y[u+1];I==="style"?n8(r,P):I==="dangerouslySetInnerHTML"?e8(r,P):I==="children"?Hp(r,P):nE(r,I,P,w)}switch(a){case"input":Bw(r,s);break;case"textarea":Kk(r,s);break;case"select":var L=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var U=s.value;U!=null?pf(r,!!s.multiple,U,!1):L!==!!s.multiple&&(s.defaultValue!=null?pf(r,!!s.multiple,s.defaultValue,!0):pf(r,!!s.multiple,s.multiple?[]:"",!1))}r[eg]=s}catch(Z){Mr(t,t.return,Z)}}break;case 6:if(Ul(e,t),vA(t),i&4){if(t.stateNode===null)throw Error(Rt(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(Z){Mr(t,t.return,Z)}}break;case 3:if(Ul(e,t),vA(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Zp(e.containerInfo)}catch(Z){Mr(t,t.return,Z)}break;case 4:Ul(e,t),vA(t);break;case 13:Ul(e,t),vA(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(BE=zr())),i&4&&sM(t);break;case 22:if(I=n!==null&&n.memoizedState!==null,t.mode&1?(ao=(w=ao)||I,Ul(e,t),ao=w):Ul(e,t),vA(t),i&8192){if(w=t.memoizedState!==null,(t.stateNode.isHidden=w)&&!I&&t.mode&1)for(un=t,I=t.child;I!==null;){for(P=un=I;un!==null;){switch(L=un,U=L.child,L.tag){case 0:case 11:case 14:case 15:Dp(4,L,L.return);break;case 1:Y0(L,L.return);var Q=L.stateNode;if(typeof Q.componentWillUnmount=="function"){i=L,n=L.return;try{e=i,Q.props=e.memoizedProps,Q.state=e.memoizedState,Q.componentWillUnmount()}catch(Z){Mr(i,n,Z)}}break;case 5:Y0(L,L.return);break;case 22:if(L.memoizedState!==null){aM(P);continue}}U!==null?(U.return=L,un=U):aM(P)}I=I.sibling}e:for(I=null,P=t;;){if(P.tag===5){if(I===null){I=P;try{r=P.stateNode,w?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=P.stateNode,y=P.memoizedProps.style,u=y!=null&&y.hasOwnProperty("display")?y.display:null,a.style.display=t8("display",u))}catch(Z){Mr(t,t.return,Z)}}}else if(P.tag===6){if(I===null)try{P.stateNode.nodeValue=w?"":P.memoizedProps}catch(Z){Mr(t,t.return,Z)}}else if((P.tag!==22&&P.tag!==23||P.memoizedState===null||P===t)&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===t)break e;for(;P.sibling===null;){if(P.return===null||P.return===t)break e;I===P&&(I=null),P=P.return}I===P&&(I=null),P.sibling.return=P.return,P=P.sibling}}break;case 19:Ul(e,t),vA(t),i&4&&sM(t);break;case 21:break;default:Ul(e,t),vA(t)}}function vA(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(CL(n)){var i=n;break e}n=n.return}throw Error(Rt(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Hp(r,""),i.flags&=-33);var s=rM(t);gb(t,s,r);break;case 3:case 4:var u=i.stateNode.containerInfo,a=rM(t);pb(t,a,u);break;default:throw Error(Rt(161))}}catch(y){Mr(t,t.return,y)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function vU(t,e,n){un=t,kL(t)}function kL(t,e,n){for(var i=(t.mode&1)!==0;un!==null;){var r=un,s=r.child;if(r.tag===22&&i){var u=r.memoizedState!==null||$m;if(!u){var a=r.alternate,y=a!==null&&a.memoizedState!==null||ao;a=$m;var w=ao;if($m=u,(ao=y)&&!w)for(un=r;un!==null;)u=un,y=u.child,u.tag===22&&u.memoizedState!==null?lM(r):y!==null?(y.return=u,un=y):lM(r);for(;s!==null;)un=s,kL(s),s=s.sibling;un=r,$m=a,ao=w}oM(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,un=s):oM(t)}}function oM(t){for(;un!==null;){var e=un;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ao||r2(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!ao)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Vl(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&j5(e,s,i);break;case 3:var u=e.updateQueue;if(u!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}j5(e,u,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var y=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":y.autoFocus&&n.focus();break;case"img":y.src&&(n.src=y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var w=e.alternate;if(w!==null){var I=w.memoizedState;if(I!==null){var P=I.dehydrated;P!==null&&Zp(P)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Rt(163))}ao||e.flags&512&&db(e)}catch(L){Mr(e,e.return,L)}}if(e===t){un=null;break}if(n=e.sibling,n!==null){n.return=e.return,un=n;break}un=e.return}}function aM(t){for(;un!==null;){var e=un;if(e===t){un=null;break}var n=e.sibling;if(n!==null){n.return=e.return,un=n;break}un=e.return}}function lM(t){for(;un!==null;){var e=un;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{r2(4,e)}catch(y){Mr(e,n,y)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(y){Mr(e,r,y)}}var s=e.return;try{db(e)}catch(y){Mr(e,s,y)}break;case 5:var u=e.return;try{db(e)}catch(y){Mr(e,u,y)}}}catch(y){Mr(e,e.return,y)}if(e===t){un=null;break}var a=e.sibling;if(a!==null){a.return=e.return,un=a;break}un=e.return}}var xU=Math.ceil,zy=Zu.ReactCurrentDispatcher,DE=Zu.ReactCurrentOwner,hl=Zu.ReactCurrentBatchConfig,wi=0,ms=null,Wr=null,Ls=0,Ca=0,X0=nh(0),Jr=0,og=null,Oh=0,s2=0,RE=0,Rp=null,Jo=null,BE=0,Ff=1/0,xu=null,Oy=!1,mb=null,Uc=null,Hm=!1,Ic=null,Fy=0,Bp=0,yb=null,j1=-1,$1=0;function Ro(){return wi&6?zr():j1!==-1?j1:j1=zr()}function Vc(t){return t.mode&1?wi&2&&Ls!==0?Ls&-Ls:rU.transition!==null?($1===0&&($1=d8()),$1):(t=Di,t!==0||(t=window.event,t=t===void 0?16:x8(t.type)),t):1}function Kl(t,e,n,i){if(50<Bp)throw Bp=0,yb=null,Error(Rt(185));Bg(t,n,i),(!(wi&2)||t!==ms)&&(t===ms&&(!(wi&2)&&(s2|=n),Jr===4&&Mc(t,Ls)),ia(t,i),n===1&&wi===0&&!(e.mode&1)&&(Ff=zr()+500,t2&&ih()))}function ia(t,e){var n=t.callbackNode;r9(t,e);var i=xy(t,t===ms?Ls:0);if(i===0)n!==null&&m5(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&m5(n),e===1)t.tag===0?iU(AM.bind(null,t)):U8(AM.bind(null,t)),J9(function(){!(wi&6)&&ih()}),n=null;else{switch(p8(i)){case 1:n=aE;break;case 4:n=h8;break;case 16:n=vy;break;case 536870912:n=f8;break;default:n=vy}n=NL(n,LL.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function LL(t,e){if(j1=-1,$1=0,wi&6)throw Error(Rt(327));var n=t.callbackNode;if(vf()&&t.callbackNode!==n)return null;var i=xy(t,t===ms?Ls:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Ny(t,i);else{e=i;var r=wi;wi|=2;var s=RL();(ms!==t||Ls!==e)&&(xu=null,Ff=zr()+500,Ih(t,e));do try{EU();break}catch(a){DL(t,a)}while(1);vE(),zy.current=s,wi=r,Wr!==null?e=0:(ms=null,Ls=0,e=Jr)}if(e!==0){if(e===2&&(r=Hw(t),r!==0&&(i=r,e=_b(t,r))),e===1)throw n=og,Ih(t,0),Mc(t,i),ia(t,zr()),n;if(e===6)Mc(t,i);else{if(r=t.current.alternate,!(i&30)&&!wU(r)&&(e=Ny(t,i),e===2&&(s=Hw(t),s!==0&&(i=s,e=_b(t,s))),e===1))throw n=og,Ih(t,0),Mc(t,i),ia(t,zr()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(Rt(345));case 2:vh(t,Jo,xu);break;case 3:if(Mc(t,i),(i&130023424)===i&&(e=BE+500-zr(),10<e)){if(xy(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){Ro(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Jw(vh.bind(null,t,Jo,xu),e);break}vh(t,Jo,xu);break;case 4:if(Mc(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var u=31-Xl(i);s=1<<u,u=e[u],u>r&&(r=u),i&=~s}if(i=r,i=zr()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*xU(i/1960))-i,10<i){t.timeoutHandle=Jw(vh.bind(null,t,Jo,xu),i);break}vh(t,Jo,xu);break;case 5:vh(t,Jo,xu);break;default:throw Error(Rt(329))}}}return ia(t,zr()),t.callbackNode===n?LL.bind(null,t):null}function _b(t,e){var n=Rp;return t.current.memoizedState.isDehydrated&&(Ih(t,e).flags|=256),t=Ny(t,e),t!==2&&(e=Jo,Jo=n,e!==null&&vb(e)),t}function vb(t){Jo===null?Jo=t:Jo.push.apply(Jo,t)}function wU(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!eA(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Mc(t,e){for(e&=~RE,e&=~s2,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Xl(e),i=1<<n;t[n]=-1,e&=~i}}function AM(t){if(wi&6)throw Error(Rt(327));vf();var e=xy(t,0);if(!(e&1))return ia(t,zr()),null;var n=Ny(t,e);if(t.tag!==0&&n===2){var i=Hw(t);i!==0&&(e=i,n=_b(t,i))}if(n===1)throw n=og,Ih(t,0),Mc(t,e),ia(t,zr()),n;if(n===6)throw Error(Rt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,vh(t,Jo,xu),ia(t,zr()),null}function zE(t,e){var n=wi;wi|=1;try{return t(e)}finally{wi=n,wi===0&&(Ff=zr()+500,t2&&ih())}}function Fh(t){Ic!==null&&Ic.tag===0&&!(wi&6)&&vf();var e=wi;wi|=1;var n=hl.transition,i=Di;try{if(hl.transition=null,Di=1,t)return t()}finally{Di=i,hl.transition=n,wi=e,!(wi&6)&&ih()}}function OE(){Ca=X0.current,sr(X0)}function Ih(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,K9(n)),Wr!==null)for(n=Wr.return;n!==null;){var i=n;switch(mE(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Sy();break;case 3:zf(),sr(ta),sr(co),SE();break;case 5:TE(i);break;case 4:zf();break;case 13:sr(pr);break;case 19:sr(pr);break;case 10:xE(i.type._context);break;case 22:case 23:OE()}n=n.return}if(ms=t,Wr=t=Gc(t.current,null),Ls=Ca=e,Jr=0,og=null,RE=s2=Oh=0,Jo=Rp=null,Th!==null){for(e=0;e<Th.length;e++)if(n=Th[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var u=s.next;s.next=r,i.next=u}n.pending=i}Th=null}return t}function DL(t,e){do{var n=Wr;try{if(vE(),U1.current=By,Ry){for(var i=_r.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Ry=!1}if(zh=0,ps=Kr=_r=null,Lp=!1,ig=0,DE.current=null,n===null||n.return===null){Jr=1,og=e,Wr=null;break}e:{var s=t,u=n.return,a=n,y=e;if(e=Ls,a.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){var w=y,I=a,P=I.tag;if(!(I.mode&1)&&(P===0||P===11||P===15)){var L=I.alternate;L?(I.updateQueue=L.updateQueue,I.memoizedState=L.memoizedState,I.lanes=L.lanes):(I.updateQueue=null,I.memoizedState=null)}var U=Y5(u);if(U!==null){U.flags&=-257,X5(U,u,a,s,e),U.mode&1&&Z5(s,w,e),e=U,y=w;var Q=e.updateQueue;if(Q===null){var Z=new Set;Z.add(y),e.updateQueue=Z}else Q.add(y);break e}else{if(!(e&1)){Z5(s,w,e),FE();break e}y=Error(Rt(426))}}else if(cr&&a.mode&1){var ae=Y5(u);if(ae!==null){!(ae.flags&65536)&&(ae.flags|=256),X5(ae,u,a,s,e),yE(Of(y,a));break e}}s=y=Of(y,a),Jr!==4&&(Jr=2),Rp===null?Rp=[s]:Rp.push(s),s=u;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var Y=gL(s,y,e);G5(s,Y);break e;case 1:a=y;var te=s.type,re=s.stateNode;if(!(s.flags&128)&&(typeof te.getDerivedStateFromError=="function"||re!==null&&typeof re.componentDidCatch=="function"&&(Uc===null||!Uc.has(re)))){s.flags|=65536,e&=-e,s.lanes|=e;var de=mL(s,a,e);G5(s,de);break e}}s=s.return}while(s!==null)}zL(n)}catch(ve){e=ve,Wr===n&&n!==null&&(Wr=n=n.return);continue}break}while(1)}function RL(){var t=zy.current;return zy.current=By,t===null?By:t}function FE(){(Jr===0||Jr===3||Jr===2)&&(Jr=4),ms===null||!(Oh&268435455)&&!(s2&268435455)||Mc(ms,Ls)}function Ny(t,e){var n=wi;wi|=2;var i=RL();(ms!==t||Ls!==e)&&(xu=null,Ih(t,e));do try{bU();break}catch(r){DL(t,r)}while(1);if(vE(),wi=n,zy.current=i,Wr!==null)throw Error(Rt(261));return ms=null,Ls=0,Jr}function bU(){for(;Wr!==null;)BL(Wr)}function EU(){for(;Wr!==null&&!ZN();)BL(Wr)}function BL(t){var e=FL(t.alternate,t,Ca);t.memoizedProps=t.pendingProps,e===null?zL(t):Wr=e,DE.current=null}function zL(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=mU(n,e),n!==null){n.flags&=32767,Wr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Jr=6,Wr=null;return}}else if(n=gU(n,e,Ca),n!==null){Wr=n;return}if(e=e.sibling,e!==null){Wr=e;return}Wr=e=t}while(e!==null);Jr===0&&(Jr=5)}function vh(t,e,n){var i=Di,r=hl.transition;try{hl.transition=null,Di=1,TU(t,e,n,i)}finally{hl.transition=r,Di=i}return null}function TU(t,e,n,i){do vf();while(Ic!==null);if(wi&6)throw Error(Rt(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Rt(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(s9(t,s),t===ms&&(Wr=ms=null,Ls=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Hm||(Hm=!0,NL(vy,function(){return vf(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=hl.transition,hl.transition=null;var u=Di;Di=1;var a=wi;wi|=4,DE.current=null,_U(t,n),IL(n,t),H9(Xw),wy=!!Yw,Xw=Yw=null,t.current=n,vU(n),YN(),wi=a,Di=u,hl.transition=s}else t.current=n;if(Hm&&(Hm=!1,Ic=t,Fy=r),s=t.pendingLanes,s===0&&(Uc=null),JN(n.stateNode),ia(t,zr()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Oy)throw Oy=!1,t=mb,mb=null,t;return Fy&1&&t.tag!==0&&vf(),s=t.pendingLanes,s&1?t===yb?Bp++:(Bp=0,yb=t):Bp=0,ih(),null}function vf(){if(Ic!==null){var t=p8(Fy),e=hl.transition,n=Di;try{if(hl.transition=null,Di=16>t?16:t,Ic===null)var i=!1;else{if(t=Ic,Ic=null,Fy=0,wi&6)throw Error(Rt(331));var r=wi;for(wi|=4,un=t.current;un!==null;){var s=un,u=s.child;if(un.flags&16){var a=s.deletions;if(a!==null){for(var y=0;y<a.length;y++){var w=a[y];for(un=w;un!==null;){var I=un;switch(I.tag){case 0:case 11:case 15:Dp(8,I,s)}var P=I.child;if(P!==null)P.return=I,un=P;else for(;un!==null;){I=un;var L=I.sibling,U=I.return;if(ML(I),I===w){un=null;break}if(L!==null){L.return=U,un=L;break}un=U}}}var Q=s.alternate;if(Q!==null){var Z=Q.child;if(Z!==null){Q.child=null;do{var ae=Z.sibling;Z.sibling=null,Z=ae}while(Z!==null)}}un=s}}if(s.subtreeFlags&2064&&u!==null)u.return=s,un=u;else e:for(;un!==null;){if(s=un,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Dp(9,s,s.return)}var Y=s.sibling;if(Y!==null){Y.return=s.return,un=Y;break e}un=s.return}}var te=t.current;for(un=te;un!==null;){u=un;var re=u.child;if(u.subtreeFlags&2064&&re!==null)re.return=u,un=re;else e:for(u=te;un!==null;){if(a=un,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:r2(9,a)}}catch(ve){Mr(a,a.return,ve)}if(a===u){un=null;break e}var de=a.sibling;if(de!==null){de.return=a.return,un=de;break e}un=a.return}}if(wi=r,ih(),DA&&typeof DA.onPostCommitFiberRoot=="function")try{DA.onPostCommitFiberRoot(Y_,t)}catch{}i=!0}return i}finally{Di=n,hl.transition=e}}return!1}function uM(t,e,n){e=Of(n,e),e=gL(t,e,1),t=Nc(t,e,1),e=Ro(),t!==null&&(Bg(t,1,e),ia(t,e))}function Mr(t,e,n){if(t.tag===3)uM(t,t,n);else for(;e!==null;){if(e.tag===3){uM(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Uc===null||!Uc.has(i))){t=Of(n,t),t=mL(e,t,1),e=Nc(e,t,1),t=Ro(),e!==null&&(Bg(e,1,t),ia(e,t));break}}e=e.return}}function SU(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=Ro(),t.pingedLanes|=t.suspendedLanes&n,ms===t&&(Ls&n)===n&&(Jr===4||Jr===3&&(Ls&130023424)===Ls&&500>zr()-BE?Ih(t,0):RE|=n),ia(t,e)}function OL(t,e){e===0&&(t.mode&1?(e=Bm,Bm<<=1,!(Bm&130023424)&&(Bm=4194304)):e=1);var n=Ro();t=Fu(t,e),t!==null&&(Bg(t,e,n),ia(t,n))}function MU(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),OL(t,n)}function CU(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(Rt(314))}i!==null&&i.delete(e),OL(t,n)}var FL;FL=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ta.current)ea=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ea=!1,pU(t,e,n);ea=!!(t.flags&131072)}else ea=!1,cr&&e.flags&1048576&&V8(e,Py,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;G1(t,e),t=e.pendingProps;var r=Df(e,co.current);_f(e,n),r=CE(null,e,i,t,r,n);var s=PE();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,na(i)?(s=!0,My(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,bE(e),r.updater=n2,e.stateNode=r,r._reactInternals=e,ob(e,i,t,n),e=Ab(null,e,i,!0,s,n)):(e.tag=0,cr&&s&&gE(e),Co(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(G1(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=IU(i),t=Vl(i,t),r){case 0:e=lb(null,e,i,t,n);break e;case 1:e=eM(null,e,i,t,n);break e;case 11:e=K5(null,e,i,t,n);break e;case 14:e=J5(null,e,i,Vl(i.type,t),n);break e}throw Error(Rt(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Vl(i,r),lb(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Vl(i,r),eM(t,e,i,r,n);case 3:e:{if(xL(e),t===null)throw Error(Rt(387));i=e.pendingProps,s=e.memoizedState,r=s.element,H8(t,e),Ly(e,i,null,n);var u=e.memoizedState;if(i=u.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Of(Error(Rt(423)),e),e=tM(t,e,i,n,r);break e}else if(i!==r){r=Of(Error(Rt(424)),e),e=tM(t,e,i,n,r);break e}else for(ka=Fc(e.stateNode.containerInfo.firstChild),Da=e,cr=!0,jl=null,n=Z8(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Rf(),i===r){e=Nu(t,e,n);break e}Co(t,e,i,n)}e=e.child}return e;case 5:return Y8(e),t===null&&ib(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,u=r.children,Kw(i,r)?u=null:s!==null&&Kw(i,s)&&(e.flags|=32),vL(t,e),Co(t,e,u,n),e.child;case 6:return t===null&&ib(e),null;case 13:return wL(t,e,n);case 4:return EE(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=Bf(e,null,i,n):Co(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Vl(i,r),K5(t,e,i,r,n);case 7:return Co(t,e,e.pendingProps,n),e.child;case 8:return Co(t,e,e.pendingProps.children,n),e.child;case 12:return Co(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,u=r.value,Xi(Iy,i._currentValue),i._currentValue=u,s!==null)if(eA(s.value,u)){if(s.children===r.children&&!ta.current){e=Nu(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){u=s.child;for(var y=a.firstContext;y!==null;){if(y.context===i){if(s.tag===1){y=Lu(-1,n&-n),y.tag=2;var w=s.updateQueue;if(w!==null){w=w.shared;var I=w.pending;I===null?y.next=y:(y.next=I.next,I.next=y),w.pending=y}}s.lanes|=n,y=s.alternate,y!==null&&(y.lanes|=n),rb(s.return,n,e),a.lanes|=n;break}y=y.next}}else if(s.tag===10)u=s.type===e.type?null:s.child;else if(s.tag===18){if(u=s.return,u===null)throw Error(Rt(341));u.lanes|=n,a=u.alternate,a!==null&&(a.lanes|=n),rb(u,n,e),u=s.sibling}else u=s.child;if(u!==null)u.return=s;else for(u=s;u!==null;){if(u===e){u=null;break}if(s=u.sibling,s!==null){s.return=u.return,u=s;break}u=u.return}s=u}Co(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,_f(e,n),r=pl(r),i=i(r),e.flags|=1,Co(t,e,i,n),e.child;case 14:return i=e.type,r=Vl(i,e.pendingProps),r=Vl(i.type,r),J5(t,e,i,r,n);case 15:return yL(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Vl(i,r),G1(t,e),e.tag=1,na(i)?(t=!0,My(e)):t=!1,_f(e,n),Q8(e,i,r),ob(e,i,r,n),Ab(null,e,i,!0,t,n);case 19:return bL(t,e,n);case 22:return _L(t,e,n)}throw Error(Rt(156,e.tag))};function NL(t,e){return c8(t,e)}function PU(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ul(t,e,n,i){return new PU(t,e,n,i)}function NE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function IU(t){if(typeof t=="function")return NE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===rE)return 11;if(t===sE)return 14}return 2}function Gc(t,e){var n=t.alternate;return n===null?(n=ul(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function H1(t,e,n,i,r,s){var u=2;if(i=t,typeof t=="function")NE(t)&&(u=1);else if(typeof t=="string")u=5;else e:switch(t){case V0:return kh(n.children,r,s,e);case iE:u=8,r|=8;break;case Iw:return t=ul(12,n,e,r|2),t.elementType=Iw,t.lanes=s,t;case kw:return t=ul(13,n,e,r),t.elementType=kw,t.lanes=s,t;case Lw:return t=ul(19,n,e,r),t.elementType=Lw,t.lanes=s,t;case qk:return o2(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Wk:u=10;break e;case Qk:u=9;break e;case rE:u=11;break e;case sE:u=14;break e;case bc:u=16,i=null;break e}throw Error(Rt(130,t==null?t:typeof t,""))}return e=ul(u,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function kh(t,e,n,i){return t=ul(7,t,i,e),t.lanes=n,t}function o2(t,e,n,i){return t=ul(22,t,i,e),t.elementType=qk,t.lanes=n,t.stateNode={isHidden:!1},t}function ax(t,e,n){return t=ul(6,t,null,e),t.lanes=n,t}function lx(t,e,n){return e=ul(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function kU(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gv(0),this.expirationTimes=Gv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gv(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function UE(t,e,n,i,r,s,u,a,y){return t=new kU(t,e,n,a,y),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ul(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},bE(s),t}function LU(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U0,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function UL(t){if(!t)return Zc;t=t._reactInternals;e:{if(t0(t)!==t||t.tag!==1)throw Error(Rt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(na(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Rt(171))}if(t.tag===1){var n=t.type;if(na(n))return N8(t,n,e)}return e}function VL(t,e,n,i,r,s,u,a,y){return t=UE(n,i,!0,t,r,s,u,a,y),t.context=UL(null),n=t.current,i=Ro(),r=Vc(n),s=Lu(i,r),s.callback=e??null,Nc(n,s,r),t.current.lanes=r,Bg(t,r,i),ia(t,i),t}function a2(t,e,n,i){var r=e.current,s=Ro(),u=Vc(r);return n=UL(n),e.context===null?e.context=n:e.pendingContext=n,e=Lu(s,u),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Nc(r,e,u),t!==null&&(Kl(t,r,u,s),N1(t,r,u)),u}function Uy(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function cM(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function VE(t,e){cM(t,e),(t=t.alternate)&&cM(t,e)}function DU(){return null}var GL=typeof reportError=="function"?reportError:function(t){console.error(t)};function GE(t){this._internalRoot=t}l2.prototype.render=GE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Rt(409));a2(t,e,null,null)};l2.prototype.unmount=GE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Fh(function(){a2(null,t,null,null)}),e[Ou]=null}};function l2(t){this._internalRoot=t}l2.prototype.unstable_scheduleHydration=function(t){if(t){var e=y8();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Sc.length&&e!==0&&e<Sc[n].priority;n++);Sc.splice(n,0,t),n===0&&v8(t)}};function jE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function A2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function hM(){}function RU(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var w=Uy(u);s.call(w)}}var u=VL(e,i,t,0,null,!1,!1,"",hM);return t._reactRootContainer=u,t[Ou]=u.current,Kp(t.nodeType===8?t.parentNode:t),Fh(),u}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var w=Uy(y);a.call(w)}}var y=UE(t,0,!1,null,null,!1,!1,"",hM);return t._reactRootContainer=y,t[Ou]=y.current,Kp(t.nodeType===8?t.parentNode:t),Fh(function(){a2(e,y,n,i)}),y}function u2(t,e,n,i,r){var s=n._reactRootContainer;if(s){var u=s;if(typeof r=="function"){var a=r;r=function(){var y=Uy(u);a.call(y)}}a2(e,u,t,r)}else u=RU(n,e,t,r,i);return Uy(u)}g8=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=pp(e.pendingLanes);n!==0&&(lE(e,n|1),ia(e,zr()),!(wi&6)&&(Ff=zr()+500,ih()))}break;case 13:Fh(function(){var i=Fu(t,1);if(i!==null){var r=Ro();Kl(i,t,1,r)}}),VE(t,1)}};AE=function(t){if(t.tag===13){var e=Fu(t,134217728);if(e!==null){var n=Ro();Kl(e,t,134217728,n)}VE(t,134217728)}};m8=function(t){if(t.tag===13){var e=Vc(t),n=Fu(t,e);if(n!==null){var i=Ro();Kl(n,t,e,i)}VE(t,e)}};y8=function(){return Di};_8=function(t,e){var n=Di;try{return Di=t,e()}finally{Di=n}};Gw=function(t,e,n){switch(e){case"input":if(Bw(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=e2(i);if(!r)throw Error(Rt(90));Yk(i),Bw(i,r)}}}break;case"textarea":Kk(t,n);break;case"select":e=n.value,e!=null&&pf(t,!!n.multiple,e,!1)}};s8=zE;o8=Fh;var BU={usingClientEntryPoint:!1,Events:[Og,H0,e2,i8,r8,zE]},jd={findFiberByHostInstance:Eh,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},zU={bundleType:jd.bundleType,version:jd.version,rendererPackageName:jd.rendererPackageName,rendererConfig:jd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zu.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=A8(t),t===null?null:t.stateNode},findFiberByHostInstance:jd.findFiberByHostInstance||DU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wm.isDisabled&&Wm.supportsFiber)try{Y_=Wm.inject(zU),DA=Wm}catch{}}za.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BU;za.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jE(e))throw Error(Rt(200));return LU(t,e,null,n)};za.createRoot=function(t,e){if(!jE(t))throw Error(Rt(299));var n=!1,i="",r=GL;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=UE(t,1,!1,null,null,n,!1,i,r),t[Ou]=e.current,Kp(t.nodeType===8?t.parentNode:t),new GE(e)};za.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Rt(188)):(t=Object.keys(t).join(","),Error(Rt(268,t)));return t=A8(e),t=t===null?null:t.stateNode,t};za.flushSync=function(t){return Fh(t)};za.hydrate=function(t,e,n){if(!A2(e))throw Error(Rt(200));return u2(null,t,e,!0,n)};za.hydrateRoot=function(t,e,n){if(!jE(t))throw Error(Rt(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",u=GL;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(u=n.onRecoverableError)),e=VL(e,null,t,1,n??null,r,!1,s,u),t[Ou]=e.current,Kp(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new l2(e)};za.render=function(t,e,n){if(!A2(e))throw Error(Rt(200));return u2(null,t,e,!1,n)};za.unmountComponentAtNode=function(t){if(!A2(t))throw Error(Rt(40));return t._reactRootContainer?(Fh(function(){u2(null,null,t,!1,function(){t._reactRootContainer=null,t[Ou]=null})}),!0):!1};za.unstable_batchedUpdates=zE;za.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!A2(n))throw Error(Rt(200));if(t==null||t._reactInternals===void 0)throw Error(Rt(38));return u2(t,e,n,!1,i)};za.version="18.2.0-next-9e3b772b8-20220608";function jL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jL)}catch(t){console.error(t)}}jL(),Vk.exports=za;var $E=Vk.exports,$L,fM=$E;$L=fM.createRoot,fM.hydrateRoot;function Vy(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const HE=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),dM=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);dM&&parseFloat(dM[1]);const OU="3.4.14";function Uu(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const W1=typeof process!="object"||String(process)!=="[object process]"||process.browser,FU=typeof window<"u"&&typeof window.orientation<"u",pM=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);pM&&parseFloat(pM[1]);function ag(t){"@babel/helpers - typeof";return ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ag(t)}function NU(t,e){if(ag(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(ag(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UU(t){var e=NU(t,"string");return ag(e)==="symbol"?e:String(e)}function oe(t,e,n){return e=UU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class VU{constructor(e,n){oe(this,"name",void 0),oe(this,"workerThread",void 0),oe(this,"isRunning",!0),oe(this,"result",void 0),oe(this,"_resolve",()=>{}),oe(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){Uu(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Uu(this.isRunning),this.isRunning=!1,this._reject(e)}}let Ax=class{terminate(){}};const ux=new Map;function GU(t){Uu(t.source&&!t.url||!t.source&&t.url);let e=ux.get(t.source||t.url);return e||(t.url&&(e=jU(t.url),ux.set(t.url,e)),t.source&&(e=HL(t.source),ux.set(t.source,e))),Uu(e),e}function jU(t){if(!t.startsWith("http"))return t;const e=$U(t);return HL(e)}function HL(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function $U(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function WL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const i=n||new Set;if(t){if(gM(t))i.add(t);else if(gM(t.buffer))i.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const r in t)WL(t[r],e,i)}}return n===void 0?Array.from(i):[]}function gM(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const cx=()=>{};class xb{static isSupported(){return typeof Worker<"u"&&W1||typeof Ax<"u"&&!W1}constructor(e){oe(this,"name",void 0),oe(this,"source",void 0),oe(this,"url",void 0),oe(this,"terminated",!1),oe(this,"worker",void 0),oe(this,"onMessage",void 0),oe(this,"onError",void 0),oe(this,"_loadableURL","");const{name:n,source:i,url:r}=e;Uu(i||r),this.name=n,this.source=i,this.url=r,this.onMessage=cx,this.onError=s=>console.log(s),this.worker=W1?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=cx,this.onError=cx,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||WL(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=GU({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const i=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Ax(i,{eval:!1})}else if(this.source)e=new Ax(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class HU{static isSupported(){return xb.isSupported()}constructor(e){oe(this,"name","unnamed"),oe(this,"source",void 0),oe(this,"url",void 0),oe(this,"maxConcurrency",1),oe(this,"maxMobileConcurrency",1),oe(this,"onDebug",()=>{}),oe(this,"reuseWorkers",!0),oe(this,"props",{}),oe(this,"jobQueue",[]),oe(this,"idleQueue",[]),oe(this,"count",0),oe(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,u,a)=>s.done(a),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,u)=>s.error(u);const r=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:i,onStart:s}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const i=new VU(n.name,e);e.onMessage=r=>n.onMessage(i,r.type,r.payload),e.onError=r=>n.onError(i,r),n.onStart(i);try{await i.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new xb({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return FU?this.maxMobileConcurrency:this.maxConcurrency}}const WU={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class bu{static isSupported(){return xb.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return bu._workerFarm=bu._workerFarm||new bu({}),bu._workerFarm.setProps(e),bu._workerFarm}constructor(e){oe(this,"props",void 0),oe(this,"workerPools",new Map),this.props={...WU},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:i,url:r}=e;let s=this.workerPools.get(n);return s||(s=new HU({name:n,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}oe(bu,"_workerFarm",void 0);const QU="latest";function qU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(!r&&t.id==="compression"&&(r=e.workerUrl),e._workerType==="test"&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let s=t.version;s==="latest"&&(s=QU);const u=s?"@".concat(s):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(u,"/dist/").concat(i)}return Uu(r),r}function ZU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:OU;Uu(t,"no worker provided");const n=t.version;return!(!e||!n)}function YU(t,e){return!bu.isSupported()||!W1&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&e?.worker}async function XU(t,e,n,i,r){const s=t.id,u=qU(t,n),y=bu.getWorkerFarm(n).getWorkerPool({name:s,url:u});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const w=await y.startJob("process-on-worker",KU.bind(null,r));return w.postMessage("process",{input:e,options:n,context:i}),await(await w.result).result}async function KU(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:s,options:u}=i;try{const a=await t(s,u);e.postMessage("done",{id:r,result:a})}catch(a){const y=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:y})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function JU(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}function eV(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),r=i.reduce((a,y)=>a+y.byteLength,0),s=new Uint8Array(r);let u=0;for(const a of i)s.set(a,u),u+=a.byteLength;return s.buffer}async function tV(t){const e=[];for await(const n of t)e.push(n);return eV(...e)}function mM(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let yM=class{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=mM(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(mM()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},nV=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:i}=e;let r=this.stats[n];return r||(e instanceof yM?r=e:r=new yM(n,i),this.stats[n]=r),r}};const iV="Queued Requests",rV="Active Requests",sV="Cancelled Requests",oV="Queued Requests Ever",aV="Active Requests Ever",lV={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class AV{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};oe(this,"props",void 0),oe(this,"stats",void 0),oe(this,"activeRequestCount",0),oe(this,"requestQueue",[]),oe(this,"requestMap",new Map),oe(this,"deferredUpdate",null),this.props={...lV,...e},this.stats=new nV({id:this.props.id}),this.stats.get(iV),this.stats.get(rV),this.stats.get(sV),this.stats.get(oV),this.stats.get(aV)}scheduleRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const i={handle:e,priority:0,getPriority:n},r=new Promise(s=>(i.resolve=s,i));return this.requestQueue.push(i),this.requestMap.set(e,r),this._issueNewRequests(),r}_issueRequest(e){const{handle:n,resolve:i}=e;let r=!1;const s=()=>{r||(r=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,i?i({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const i=this.requestQueue.shift();i&&this._issueRequest(i)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const i=e[n];this._updateRequest(i)||(e.splice(n,1),this.requestMap.delete(i.handle),n--)}e.sort((n,i)=>n.priority-i.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let uV="";const _M={};function cV(t){for(const e in _M)if(t.startsWith(e)){const n=_M[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(uV).concat(t)),t}function hV(t){return t&&typeof t=="object"&&t.isBuffer}function QL(t){if(hV(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function qL(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function fV(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const dV=t=>typeof t=="boolean",zp=t=>typeof t=="function",Ng=t=>t!==null&&typeof t=="object",vM=t=>Ng(t)&&t.constructor==={}.constructor,pV=t=>t&&typeof t[Symbol.iterator]=="function",gV=t=>t&&typeof t[Symbol.asyncIterator]=="function",n0=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,i0=t=>typeof Blob<"u"&&t instanceof Blob,mV=t=>t&&typeof t=="object"&&t.isBuffer,yV=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Ng(t)&&zp(t.tee)&&zp(t.cancel)&&zp(t.getReader),_V=t=>Ng(t)&&zp(t.read)&&zp(t.pipe)&&dV(t.readable),ZL=t=>yV(t)||_V(t),vV=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,xV=/^([-\w.]+\/[-\w.+]+)/;function wV(t){const e=xV.exec(t);return e?e[1]:t}function xM(t){const e=vV.exec(t);return e?e[1]:""}const YL=/\?.*/;function bV(t){const e=t.match(YL);return e&&e[0]}function WE(t){return t.replace(YL,"")}function c2(t){return n0(t)?t.url:i0(t)?t.name||"":typeof t=="string"?t:""}function QE(t){if(n0(t)){const e=t,n=e.headers.get("content-type")||"",i=WE(e.url);return wV(n)||xM(i)}return i0(t)?t.type||"":typeof t=="string"?xM(t):""}function EV(t){return n0(t)?t.headers["content-length"]||-1:i0(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function XL(t){if(n0(t))return t;const e={},n=EV(t);n>=0&&(e["content-length"]=String(n));const i=c2(t),r=QE(t);r&&(e["content-type"]=r);const s=await MV(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const u=new Response(t,{headers:e});return Object.defineProperty(u,"url",{value:i}),u}async function TV(t){if(!t.ok){const e=await SV(t);throw new Error(e)}}async function SV(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(await t.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function MV(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(i=>{const r=new FileReader;r.onload=s=>{var u;return i(s==null||(u=s.target)===null||u===void 0?void 0:u.result)},r.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),i=CV(n);return"data:base64,".concat(i)}return null}function CV(t){let e="";const n=new Uint8Array(t);for(let i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return btoa(e)}async function wM(t,e){if(typeof t=="string"){t=cV(t);let n=e;return e!=null&&e.fetch&&typeof e?.fetch!="function"&&(n=e.fetch),await fetch(t,n)}return await XL(t)}function PV(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Ug(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||PV()}const Qm=globalThis.window||globalThis.self||globalThis.global,$d=globalThis.process||{},KL=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Ug();function IV(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let kV=class{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=IV(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function LV(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function DV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function hx(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const s=t.width*n,u=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(u/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(u,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(u,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Gy;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Gy||(Gy={}));const RV=10;function bM(t){return typeof t!="string"?t:(t=t.toUpperCase(),Gy[t]||Gy.WHITE)}function BV(t,e,n){if(!Ug&&typeof t=="string"){if(e){const i=bM(e);t="\x1B[".concat(i,"m").concat(t,"\x1B[39m")}if(n){const i=bM(n);t="\x1B[".concat(i+RV,"m").concat(t,"\x1B[49m")}}return t}function zV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n),r=t;for(const s of i){const u=r[s];typeof u=="function"&&(e.find(a=>s===a)||(r[s]=u.bind(t)))}}function jy(t,e){if(!t)throw new Error(e||"Assertion failed")}function S0(){let t;if(Ug()&&Qm.performance){var e,n;t=Qm==null||(e=Qm.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in $d){var i;const r=$d==null||(i=$d.hrtime)===null||i===void 0?void 0:i.call($d);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const M0={debug:Ug()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},OV={enabled:!0,level:0};function rl(){}const EM={},TM={once:!0};let qE=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=KL,this._startTs=S0(),this._deltaTs=S0(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new kV("__probe-".concat(this.id,"__"),OV),this.timeStamp("".concat(this.id," started")),zV(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((S0()-this._startTs).toPrecision(10))}getDelta(){return Number((S0()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){jy(e,n)}warn(e){return this._getLogFunction(0,e,M0.warn,arguments,TM)}error(e){return this._getLogFunction(0,e,M0.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,M0.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,M0.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,M0.debug||M0.info,arguments,TM)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||rl,i&&[i],{tag:VV(n)}):rl}image(e){let{logLevel:n,priority:i,image:r,message:s="",scale:u=1}=e;return this._shouldLog(n||i)?Ug()?UV({image:r,message:s,scale:u}):NV():rl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||rl)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=SM({logLevel:e,message:n,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||rl)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=JL(e)}_getLogFunction(e,n,i,r,s){if(this._shouldLog(e)){s=SM({logLevel:e,message:n,args:r,opts:s}),i=i||s.method,jy(i),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=S0();const u=s.tag||s.message;if(s.once&&u)if(!EM[u])EM[u]=S0();else return rl;return n=FV(this.id,s.message,s),i.bind(console,n,...s.args)}return rl}};qE.VERSION=KL;function JL(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return jy(Number.isFinite(e)&&e>=0),e}function SM(t){const{logLevel:e,message:n}=t;t.logLevel=JL(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return jy(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function FV(t,e,n){if(typeof e=="string"){const i=n.time?DV(LV(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=BV(e,n.color,n.background)}return e}function NV(t){return console.warn("removed"),rl}function UV(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const u=hx(s,n,i);console.log(...u)},s.src=e,rl}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...hx(e,n,i)),rl;if(r.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...hx(s,n,i)),s.src=e.toDataURL(),rl}return rl}function VV(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const MM=new qE({id:"loaders.gl"});class GV{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class jV{constructor(){oe(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.error.bind(this.console,...n)}}const eD={fetch:null,mimeType:void 0,nothrow:!1,log:new jV,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:HE,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},$V={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function tD(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const nD=()=>{const t=tD();return t.globalOptions=t.globalOptions||{...eD},t.globalOptions};function HV(t,e,n,i){return n=n||[],n=Array.isArray(n)?n:[n],WV(t,n),qV(e,t,i)}function WV(t,e){CM(t,null,eD,$V,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};CM(i,n.id,r,s,e)}}function CM(t,e,n,i,r){const s=e||"Top level",u=e?"".concat(e,"."):"";for(const a in t){const y=!e&&Ng(t[a]),w=a==="baseUri"&&!e,I=a==="workerUrl"&&e;if(!(a in n)&&!w&&!I){if(a in i)MM.warn("".concat(s," loader option '").concat(u).concat(a,"' no longer supported, use '").concat(i[a],"'"))();else if(!y){const P=QV(a,r);MM.warn("".concat(s," loader option '").concat(u).concat(a,"' not recognized. ").concat(P))()}}}}function QV(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(t===s)return"Did you mean '".concat(r.id,".").concat(s,"'?");const u=s.toLowerCase();(n.startsWith(u)||u.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(s,"'?"))}return i}function qV(t,e,n){const r={...t.options||{}};return ZV(r,n),r.log===null&&(r.log=new GV),PM(r,nD()),PM(r,e),r}function PM(t,e){for(const n in e)if(n in e){const i=e[n];vM(i)&&vM(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function ZV(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function ZE(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function YE(t){var e,n;Vy(t,"null loader"),Vy(ZE(t),"invalid loader");let i;return Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const iD=()=>{const t=tD();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function YV(t){const e=iD();t=Array.isArray(t)?t:[t];for(const n of t){const i=YE(n);e.find(r=>i===r)||e.unshift(i)}}function XV(){return iD()}const KV=new qE({id:"loaders.gl"}),JV=/\.([^.]+)$/;async function eG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!rD(t))return null;let r=IM(t,e,{...n,nothrow:!0},i);if(r)return r;if(i0(t)&&(t=await t.slice(0,10).arrayBuffer(),r=IM(t,e,n,i)),!r&&!(n!=null&&n.nothrow))throw new Error(sD(t));return r}function IM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!rD(t))return null;if(e&&!Array.isArray(e))return YE(e);let r=[];e&&(r=r.concat(e)),n!=null&&n.ignoreRegisteredLoaders||r.push(...XV()),nG(r);const s=tG(t,r,n,i);if(!s&&!(n!=null&&n.nothrow))throw new Error(sD(t));return s}function tG(t,e,n,i){const r=c2(t),s=QE(t),u=WE(r)||i?.url;let a=null,y="";if(n!=null&&n.mimeType&&(a=fx(e,n?.mimeType),y="match forced by supplied MIME type ".concat(n?.mimeType)),a=a||iG(e,u),y=y||(a?"matched url ".concat(u):""),a=a||fx(e,s),y=y||(a?"matched MIME type ".concat(s):""),a=a||sG(e,t),y=y||(a?"matched initial data ".concat(oD(t)):""),a=a||fx(e,n?.fallbackMimeType),y=y||(a?"matched fallback MIME type ".concat(s):""),y){var w;KV.log(1,"selectLoader selected ".concat((w=a)===null||w===void 0?void 0:w.name,": ").concat(y,"."))}return a}function rD(t){return!(t instanceof Response&&t.status===204)}function sD(t){const e=c2(t),n=QE(t);let i="No valid loader found (";i+=e?"".concat(qL(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?oD(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function nG(t){for(const e of t)YE(e)}function iG(t,e){const n=e&&JV.exec(e),i=n&&n[1];return i?rG(t,i):null}function rG(t,e){e=e.toLowerCase();for(const n of t)for(const i of n.extensions)if(i.toLowerCase()===e)return n;return null}function fx(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function sG(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(oG(e,n))return n}else if(ArrayBuffer.isView(e)){if(kM(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&kM(e,0,n))return n;return null}function oG(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>t.startsWith(i))}function kM(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(r=>aG(t,e,n,r))}function aG(t,e,n,i){if(i instanceof ArrayBuffer)return JU(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":const r=wb(t,e,i.length);return i===r;default:return!1}}function oD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?wb(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?wb(t,0,e):""}function wb(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let s=0;s<n;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}const lG=256*1024;function*AG(t,e){const n=e?.chunkSize||lG;let i=0;const r=new TextEncoder;for(;i<t.length;){const s=Math.min(t.length-i,n),u=t.slice(i,i+s);i+=s,yield r.encode(u)}}const uG=256*1024;function cG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=uG}=e;let i=0;for(;i<t.byteLength;){const r=Math.min(t.byteLength-i,n),s=new ArrayBuffer(r),u=new Uint8Array(t,i,r);new Uint8Array(s).set(u),i+=r,yield s}}()}const hG=1024*1024;async function*fG(t,e){const n=e?.chunkSize||hG;let i=0;for(;i<t.size;){const r=i+n,s=await t.slice(i,r).arrayBuffer();i=r,yield s}}function LM(t,e){return HE?dG(t,e):pG(t)}async function*dG(t,e){const n=t.getReader();let i;try{for(;;){const r=i||n.read();e!=null&&e._streamReadAhead&&(i=n.read());const{done:s,value:u}=await r;if(s)return;yield QL(u)}}catch{n.releaseLock()}}async function*pG(t,e){for await(const n of t)yield QL(n)}function gG(t,e){if(typeof t=="string")return AG(t,e);if(t instanceof ArrayBuffer)return cG(t,e);if(i0(t))return fG(t,e);if(ZL(t))return LM(t,e);if(n0(t))return LM(t.body,e);throw new Error("makeIterator")}const aD="Cannot convert supplied data type";function mG(t,e,n){if(e.text&&typeof t=="string")return t;if(mV(t)&&(t=t.buffer),t instanceof ArrayBuffer){const i=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let i=t.buffer;const r=t.byteLength||t.length;return(t.byteOffset!==0||r!==i.byteLength)&&(i=i.slice(t.byteOffset,t.byteOffset+r)),i}throw new Error(aD)}async function yG(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||i)return mG(t,e);if(i0(t)&&(t=await XL(t)),n0(t)){const r=t;return await TV(r),e.binary?await r.arrayBuffer():await r.text()}if(ZL(t)&&(t=gG(t,n)),pV(t)||gV(t))return tV(t);throw new Error(aD)}function lD(t,e){const n=nD(),i=t||n;return typeof i.fetch=="function"?i.fetch:Ng(i.fetch)?r=>wM(r,i):e!=null&&e.fetch?e?.fetch:wM}function _G(t,e,n){if(n)return n;const i={fetch:lD(e,t),...t};if(i.url){const r=WE(i.url);i.baseUrl=r,i.queryString=bV(i.url),i.filename=qL(r),i.baseUrl=fV(r)}return Array.isArray(i.loaders)||(i.loaders=null),i}function vG(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...i]:i}return n&&n.length?n:null}async function XE(t,e,n,i){Uu(!i||typeof i=="object"),e&&!Array.isArray(e)&&!ZE(e)&&(i=void 0,n=e,e=void 0),t=await t,n=n||{};const r=c2(t),u=vG(e,i),a=await eG(t,u,n);return a?(n=HV(n,a,u,r),i=_G({url:r,parse:XE,loaders:u},n,i||null),await xG(a,t,n,i)):null}async function xG(t,e,n,i){if(ZU(t),n0(e)){const r=e,{ok:s,redirected:u,status:a,statusText:y,type:w,url:I}=r,P=Object.fromEntries(r.headers.entries());i.response={headers:P,ok:s,redirected:u,status:a,statusText:y,type:w,url:I}}if(e=await yG(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,i,t);if(YU(t,n))return await XU(t,e,n,i,XE);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,i,t);if(t.parse)return await t.parse(e,n,i,t);throw Uu(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function $y(t,e,n,i){!Array.isArray(e)&&!ZE(e)&&(n=e,e=void 0);const r=lD(n);let s=t;return typeof t=="string"&&(s=await r(t)),i0(t)&&(s=await r(t)),await XE(s,e,n)}const wG="3.4.14",{_parseImageNode:bG}=globalThis,bb=typeof Image<"u",Eb=typeof ImageBitmap<"u",EG=!!bG,Tb=HE?!0:EG;function TG(t){switch(t){case"auto":return Eb||bb||Tb;case"imagebitmap":return Eb;case"image":return bb;case"data":return Tb;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function SG(){if(Eb)return"imagebitmap";if(bb)return"image";if(Tb)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function MG(t){const e=PG(t);if(!e)throw new Error("Not an image");return e}function CG(t){switch(MG(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function PG(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const IG=/^data:image\/svg\+xml/,kG=/\.svg((\?|#).*)?$/;function KE(t){return t&&(IG.test(t)||kG.test(t))}function LG(t,e){if(KE(e)){let i=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(i))}return AD(t,e)}function AD(t,e){if(KE(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function uD(t,e,n){const i=LG(t,n),r=self.URL||self.webkitURL,s=typeof i!="string"&&r.createObjectURL(i);try{return await DG(s||i,e)}finally{s&&r.revokeObjectURL(s)}}async function DG(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((i,r)=>{try{n.onload=()=>i(n),n.onerror=s=>r(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){r(s)}})}const RG={};let DM=!0;async function BG(t,e,n){let i;KE(n)?i=await uD(t,e,n):i=AD(t,n);const r=e&&e.imagebitmap;return await zG(i,r)}async function zG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((OG(e)||!DM)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),DM=!1}return await createImageBitmap(t)}function OG(t){for(const e in t||RG)return!1;return!0}function FG(t){return!GG(t,"ftyp",4)||!(t[8]&96)?null:NG(t)}function NG(t){switch(UG(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function UG(t,e,n){return String.fromCharCode(...t.slice(e,n))}function VG(t){return[...t].map(e=>e.charCodeAt(0))}function GG(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=VG(e);for(let r=0;r<i.length;++r)if(i[r]!==t[r+n])return!1;return!0}const PA=!1,Op=!0;function cD(t){const e=Vg(t);return $G(e)||QG(e)||HG(e)||WG(e)||jG(e)}function jG(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=FG(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function $G(t){const e=Vg(t);return e.byteLength>=24&&e.getUint32(0,PA)===2303741511?{mimeType:"image/png",width:e.getUint32(16,PA),height:e.getUint32(20,PA)}:null}function HG(t){const e=Vg(t);return e.byteLength>=10&&e.getUint32(0,PA)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Op),height:e.getUint16(8,Op)}:null}function WG(t){const e=Vg(t);return e.byteLength>=14&&e.getUint16(0,PA)===16973&&e.getUint32(2,Op)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Op),height:e.getUint32(22,Op)}:null}function QG(t){const e=Vg(t);if(!(e.byteLength>=3&&e.getUint16(0,PA)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:i,sofMarkers:r}=qG();let s=2;for(;s+9<e.byteLength;){const u=e.getUint16(s,PA);if(r.has(u))return{mimeType:"image/jpeg",height:e.getUint16(s+5,PA),width:e.getUint16(s+7,PA)};if(!i.has(u))return null;s+=2,s+=e.getUint16(s,PA)}return null}function qG(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Vg(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function ZG(t,e){const{mimeType:n}=cD(t)||{},i=globalThis._parseImageNode;return Vy(i),await i(t,n)}async function YG(t,e,n){e=e||{};const r=(e.image||{}).type||"auto",{url:s}=n||{},u=XG(r);let a;switch(u){case"imagebitmap":a=await BG(t,e,s);break;case"image":a=await uD(t,e,s);break;case"data":a=await ZG(t);break;default:Vy(!1)}return r==="data"&&(a=CG(a)),a}function XG(t){switch(t){case"auto":case"data":return SG();default:return TG(t),t}}const KG=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],JG=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],ej={image:{type:"auto",decode:!0}},tj={id:"image",module:"images",name:"Images",version:wG,mimeTypes:JG,extensions:KG,parse:YG,tests:[t=>!!cD(new DataView(t))],options:ej};function hD(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function ld(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||hD()}const Q1={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},qm=Q1.window||Q1.self||Q1.global,Hd=Q1.process||{},fD=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";ld();const dx=globalThis;function nj(t){if(!t&&!ld())return"Node";if(hD(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r?"IE":dx.chrome?"Chrome":dx.safari?"Safari":dx.mozInnerScreenX?"Firefox":"Unknown"}function ij(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let rj=class{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";oe(this,"storage",void 0),oe(this,"id",void 0),oe(this,"config",void 0),this.storage=ij(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function sj(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function oj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function px(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const s=t.width*n,u=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(u/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(u,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(u,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Hy;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Hy||(Hy={}));function RM(t){return typeof t=="string"?Hy[t.toUpperCase()]||Hy.WHITE:t}function aj(t,e,n){return!ld&&typeof t=="string"&&(e&&(e=RM(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=RM(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function lj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)typeof t[r]=="function"&&(e.find(s=>r===s)||(t[r]=t[r].bind(t)))}function Wy(t,e){if(!t)throw new Error(e||"Assertion failed")}function C0(){let t;if(ld&&"performance"in qm){var e,n;t=qm==null||(e=qm.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Hd){var i;const r=Hd==null||(i=Hd.hrtime)===null||i===void 0?void 0:i.call(Hd);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const P0={debug:ld&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Aj={enabled:!0,level:0};function sl(){}const BM={},zM={once:!0};let dD=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};oe(this,"id",void 0),oe(this,"VERSION",fD),oe(this,"_startTs",C0()),oe(this,"_deltaTs",C0()),oe(this,"_storage",void 0),oe(this,"userData",{}),oe(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new rj("__probe-".concat(this.id,"__"),Aj),this.timeStamp("".concat(this.id," started")),lj(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((C0()-this._startTs).toPrecision(10))}getDelta(){return Number((C0()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Wy(e,n)}warn(e){return this._getLogFunction(0,e,P0.warn,arguments,zM)}error(e){return this._getLogFunction(0,e,P0.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,P0.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,P0.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return this._getLogFunction(e,n,P0.debug||P0.info,arguments,zM)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||sl,i&&[i],{tag:fj(n)}):sl}image(e){let{logLevel:n,priority:i,image:r,message:s="",scale:u=1}=e;return this._shouldLog(n||i)?ld?hj({image:r,message:s,scale:u}):cj():sl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||sl)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=OM({logLevel:e,message:n,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||sl)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=pD(e)}_getLogFunction(e,n,i,r,s){if(this._shouldLog(e)){s=OM({logLevel:e,message:n,args:r,opts:s}),i=i||s.method,Wy(i),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=C0();const u=s.tag||s.message;if(s.once)if(!BM[u])BM[u]=C0();else return sl;return n=uj(this.id,s.message,s),i.bind(console,n,...s.args)}return sl}};oe(dD,"VERSION",fD);function pD(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Wy(Number.isFinite(e)&&e>=0),e}function OM(t){const{logLevel:e,message:n}=t;t.logLevel=pD(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return Wy(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function uj(t,e,n){if(typeof e=="string"){const i=n.time?oj(sj(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=aj(e,n.color,n.background)}return e}function cj(t){return console.warn("removed"),sl}function hj(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const u=px(s,n,i);console.log(...u)},s.src=e,sl}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...px(e,n,i)),sl;if(r.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...px(s,n,i)),s.src=e.toDataURL(),sl}return sl}function fj(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const si=new dD({id:"deck"});let Sb={};function dj(t){Sb=t}function so(t,e,n,i){si.level>0&&Sb[t]&&Sb[t].call(null,e,n,i)}function pj(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const gj={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:pj,parseTextSync:JSON.parse};function mj(){const t="8.9.32",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(si.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:si,_registerLoggers:dj},YV([gj,[tj,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const yj=mj(),Ai={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Ai,"IDENTITY",{get:()=>(si.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Wl={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Nh={common:0,meters:1,pixels:2},FM={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};function _j(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Ad(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||_j()}const q1={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Zm=q1.window||q1.self||q1.global,Wd=q1.process||{},gD=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Ad();function vj(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class xj{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";oe(this,"storage",void 0),oe(this,"id",void 0),oe(this,"config",void 0),this.storage=vj(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function wj(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function bj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function gx(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const s=t.width*n,u=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(u/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(u,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(u,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Qy;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Qy||(Qy={}));function NM(t){return typeof t=="string"?Qy[t.toUpperCase()]||Qy.WHITE:t}function Ej(t,e,n){return!Ad&&typeof t=="string"&&(e&&(e=NM(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=NM(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function Tj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)typeof t[r]=="function"&&(e.find(s=>r===s)||(t[r]=t[r].bind(t)))}function qy(t,e){if(!t)throw new Error(e||"Assertion failed")}function I0(){let t;if(Ad&&"performance"in Zm){var e,n;t=Zm==null||(e=Zm.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Wd){var i;const r=Wd==null||(i=Wd.hrtime)===null||i===void 0?void 0:i.call(Wd);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const k0={debug:Ad&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Sj={enabled:!0,level:0};function ol(){}const UM={},VM={once:!0};class mD{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};oe(this,"id",void 0),oe(this,"VERSION",gD),oe(this,"_startTs",I0()),oe(this,"_deltaTs",I0()),oe(this,"_storage",void 0),oe(this,"userData",{}),oe(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new xj("__probe-".concat(this.id,"__"),Sj),this.timeStamp("".concat(this.id," started")),Tj(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((I0()-this._startTs).toPrecision(10))}getDelta(){return Number((I0()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){qy(e,n)}warn(e){return this._getLogFunction(0,e,k0.warn,arguments,VM)}error(e){return this._getLogFunction(0,e,k0.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,k0.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,k0.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return this._getLogFunction(e,n,k0.debug||k0.info,arguments,VM)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||ol,i&&[i],{tag:Ij(n)}):ol}image(e){let{logLevel:n,priority:i,image:r,message:s="",scale:u=1}=e;return this._shouldLog(n||i)?Ad?Pj({image:r,message:s,scale:u}):Cj():ol}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||ol)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=GM({logLevel:e,message:n,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||ol)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=yD(e)}_getLogFunction(e,n,i,r,s){if(this._shouldLog(e)){s=GM({logLevel:e,message:n,args:r,opts:s}),i=i||s.method,qy(i),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=I0();const u=s.tag||s.message;if(s.once)if(!UM[u])UM[u]=I0();else return ol;return n=Mj(this.id,s.message,s),i.bind(console,n,...s.args)}return ol}}oe(mD,"VERSION",gD);function yD(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return qy(Number.isFinite(e)&&e>=0),e}function GM(t){const{logLevel:e,message:n}=t;t.logLevel=yD(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return qy(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function Mj(t,e,n){if(typeof e=="string"){const i=n.time?bj(wj(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=Ej(e,n.color,n.background)}return e}function Cj(t){return console.warn("removed"),ol}function Pj(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const u=gx(s,n,i);console.log(...u)},s.src=e,ol}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...gx(e,n,i)),ol;if(r.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...gx(s,n,i)),s.src=e.toDataURL(),ol}return ol}function Ij(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const _n=new mD({id:"luma.gl"});function Po(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const kj="Invalid WebGLRenderingContext",Lj="Requires WebGL2";function h2(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function ui(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function Dj(t){return ui(t)?t:null}function f2(t){return Po(h2(t),kj),t}function lo(t){return Po(ui(t),Lj),t}const mp={};function Rj(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function Bj(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function zj(t,e){mp[t]=!0,e!==void 0&&Rj(e)}function Oj(t){const e=t.getError;t.getError=function(){let i;do i=e.apply(t),i!==0&&(mp[i]=!0);while(i!==0);for(i in mp)if(mp[i])return delete mp[i],parseInt(i,10);return 0}}const Gg=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new t.VertexAttrib(n);this.attribs[i]=r}this.maxAttrib=0};Gg.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Gg.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const r0=function(e){const n=this;this.gl=e,Oj(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const u=n.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,s);const a=u.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const u=n.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,s);const a=u.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,u){switch(s){case 34962:n.currentArrayBuffer=u;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=u;break}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,u){const y=n.currentVertexArrayObject.attribs[s];switch(u){case 34975:return y.buffer;case 34338:return y.enabled;case 34339:return y.size;case 34340:return y.stride;case 34341:return y.type;case 34922:return y.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,u,a,y,w,I){const P=n.currentVertexArrayObject;P.maxAttrib=Math.max(P.maxAttrib,s);const L=P.attribs[s];return L.buffer=n.currentArrayBuffer,L.size=u,L.type=a,L.normalized=y,L.stride=w,L.offset=I,L.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{Bj("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};r0.prototype.VERTEX_ARRAY_BINDING_OES=34229;r0.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Gg(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};r0.prototype.createVertexArrayOES=function(){const e=new Gg(this);return this.vertexArrayObjects.push(e),e};r0.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};r0.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Gg&&e.hasBeenBound&&e.ext===this)};r0.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){zj(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(n,34963,s.elementArrayBuffer);let u=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let y=0;y<=a;y++){const w=s.attribs[y],I=r?r.attribs[y]:null;if((!r||w.enabled!==I.enabled)&&(w.enabled?i.enableVertexAttribArray.call(n,y):i.disableVertexAttribArray.call(n,y)),w.enabled){let P=!1;(!r||w.buffer!==I.buffer)&&(u!==w.buffer&&(i.bindBuffer.call(n,34962,w.buffer),u=w.buffer),P=!0),(P||w.cached!==I.cached)&&i.vertexAttribPointer.call(n,y,w.size,w.type,w.normalized,w.stride,w.offset)}}this.currentArrayBuffer!==u&&i.bindBuffer.call(n,34962,this.currentArrayBuffer)};function Fj(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const n=t.getExtension;t.getExtension=function(r){const s=n.call(this,r);return s||(r!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new r0(this)),this.__OESVertexArrayObject))}}const jM="OES_element_index",$M="WEBGL_draw_buffers",Nj="EXT_disjoint_timer_query",Uj="EXT_disjoint_timer_query_webgl2",Vj="EXT_texture_filter_anisotropic",HM="WEBGL_debug_renderer_info",Gj=35723,jj=4352,$j=36795,Hj=34047,Wj=37445,Qj=37446,Zi=t=>ui(t)?void 0:0,qj={3074:t=>ui(t)?void 0:36064,[Gj]:t=>ui(t)?void 0:jj,35977:Zi,32937:Zi,[$j]:(t,e)=>{const n=ui(t)?t.getExtension(Uj):t.getExtension(Nj);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[Wj]:(t,e)=>{const n=t.getExtension(HM);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[Qj]:(t,e)=>{const n=t.getExtension(HM);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[Hj]:(t,e)=>{const n=t.luma.extensions[Vj];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Zi,35071:Zi,37447:Zi,36063:(t,e)=>{if(!ui(t)){const n=t.getExtension($M);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Zi,35374:Zi,35377:Zi,34852:t=>{if(!ui(t)){const e=t.getExtension($M);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(jM)?2147483647:65535,33001:t=>t.getExtension(jM)?16777216:65535,33e3:t=>16777216,37157:Zi,35373:Zi,35657:Zi,36183:Zi,37137:Zi,34045:Zi,35978:Zi,35979:Zi,35968:Zi,35376:Zi,35375:Zi,35659:Zi,37154:Zi,35371:Zi,35658:Zi,35076:Zi,35077:Zi,35380:Zi};function Zj(t,e,n){const i=qj[n],r=typeof i=="function"?i(t,e,n):i;return r!==void 0?r:e(n)}const Yj="OES_vertex_array_object",_D="ANGLE_instanced_arrays",Xj="WEBGL_draw_buffers",Kj="EXT_disjoint_timer_query",Jj="EXT_texture_filter_anisotropic",e$="VertexArray requires WebGL2 or OES_vertex_array_object extension";function t$(t,e){return{webgl2:ui(t),ext:t.getExtension(e)}}const vD={[Yj]:{meta:{suffix:"OES"},createVertexArray:()=>{Po(!1,e$)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[_D]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Po(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[Xj]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Po(!1)}},[Kj]:{meta:{suffix:"EXT"},createQuery:()=>{Po(!1)},deleteQuery:()=>{Po(!1)},beginQuery:()=>{Po(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},mx={readBuffer:(t,e,n)=>{ui(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:s}=t$(t,_D);let u;switch(i){case 35069:u=r?void 0:!1;break;case 35070:u=!r&&!s?0:void 0;break}return u!==void 0?u:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!ui(t))switch(i){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>{if(!ui(t))switch(r){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,i,r)},getTexParameter(t,e,n,i){switch(i){case 34046:const{extensions:r}=t.luma,s=r[Jj];i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,i)},getParameter:Zj,hint(t,e,n,i){return e(n,i)}};function n$(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(Fj(t),i$(t),s$(t,vD),r$(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=n$;function i$(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function r$(t,e){let{target:n,target2:i}=e;Object.keys(mx).forEach(r=>{if(typeof mx[r]=="function"){const s=t[r]?t[r].bind(t):()=>{},u=mx[r].bind(null,t,s);n[r]=u,i[r]=u}})}function s$(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&o$(t,{extension:n,target:t.luma,target2:t})}function o$(t,e){let{extension:n,target:i,target2:r}=e;const s=vD[n];Po(s);const{meta:u={}}=s,{suffix:a=""}=u,y=t.getExtension(n);for(const w of Object.keys(s)){const I="".concat(w).concat(a);let P=null;w==="meta"||typeof t[w]=="function"||(y&&typeof y[I]=="function"?P=function(){return y[I](...arguments)}:typeof s[w]=="function"&&(P=s[w].bind(i))),P&&(i[w]=P,r[w]=P)}}const JE={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},gc=(t,e,n)=>e?t.enable(n):t.disable(n),WM=(t,e,n)=>t.hint(n,e),Ea=(t,e,n)=>t.pixelStorei(n,e),a$=(t,e)=>{const n=ui(t)?36009:36160;return t.bindFramebuffer(n,e)},l$=(t,e)=>t.bindFramebuffer(36008,e);function Qd(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const A$={3042:gc,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:gc,2885:(t,e)=>t.cullFace(e),2929:gc,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:gc,35723:WM,36006:a$,2886:(t,e)=>t.frontFace(e),33170:WM,2849:(t,e)=>t.lineWidth(e),32823:gc,32824:"polygonOffset",10752:"polygonOffset",35977:gc,32938:"sampleCoverage",32939:"sampleCoverage",3089:gc,3088:(t,e)=>t.scissor(...e),2960:gc,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:Ea,3317:Ea,37440:Ea,37441:Ea,37443:Ea,3330:Ea,3332:Ea,3331:Ea,36010:l$,3314:Ea,32878:Ea,3316:Ea,3315:Ea,32877:Ea,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Qd(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Qd(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Qd(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=Qd(e)&&e.length===3?[...e,...e]:e;const[n,i,r,s,u,a]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,s,u,a)},stencilOp:(t,e)=>{e=Qd(e)&&e.length===3?[...e,...e]:e;const[n,i,r,s,u,a]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,s,u,a)},viewport:(t,e)=>t.viewport(...e)};function Tr(t,e,n){return e[t]!==void 0?e[t]:n[t]}const u$={blendEquation:(t,e,n)=>t.blendEquationSeparate(Tr(32777,e,n),Tr(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Tr(32969,e,n),Tr(32968,e,n),Tr(32971,e,n),Tr(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Tr(32824,e,n),Tr(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Tr(32938,e,n),Tr(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Tr(2962,e,n),Tr(2967,e,n),Tr(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Tr(34816,e,n),Tr(36003,e,n),Tr(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Tr(2964,e,n),Tr(2965,e,n),Tr(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Tr(34817,e,n),Tr(34818,e,n),Tr(34819,e,n))},QM={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:i,[e===1028?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:i,[e===1028?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},xA=(t,e)=>t.isEnabled(e),qM={3042:xA,2884:xA,2929:xA,3024:xA,32823:xA,32926:xA,32928:xA,3089:xA,2960:xA,35977:xA};function xD(t){for(const e in t)return!1;return!0}function c$(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}return!1}function ZM(t,e){const n=t[e].bind(t);t[e]=function(){const r=arguments.length<=0?void 0:arguments[0];return r in t.state.cache?t.state.enable?t.state.cache[r]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function h$(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var s=arguments.length,u=new Array(s),a=0;a<s;a++)u[a]=arguments[a];const{valueChanged:y,oldValue:w}=n(t.state._updateCache,...u);return y&&i(...u),w},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function f$(t){const e=t.useProgram.bind(t);t.useProgram=function(i){t.state.program!==i&&(e(i),t.state.program=i)}}class d${constructor(e){let{copyState:n=!1,log:i=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?g$(e):Object.assign({},JE),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Po(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];Vu(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,i;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Po(s!==void 0);const u=e[s],a=this.cache[s];c$(u,a)||(n=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=u)}return{valueChanged:n,oldValue:i}}}function wD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:i}=e;if(Po(i!==void 0),!t.state){const{polyfillContext:r}=globalThis;r&&r(t),t.state=new d$(t,{copyState:i}),f$(t);for(const s in QM){const u=QM[s];h$(t,s,u)}ZM(t,"getParameter"),ZM(t,"isEnabled")}return t.state.enable=n,t}function p$(t){t.state||wD(t,{copyState:!1}),t.state.push()}function YM(t){Po(t.state),t.state.pop()}function Vu(t,e){if(Po(h2(t),"setParameters requires a WebGL context"),xD(e))return;const n={};for(const r in e){const s=Number(r),u=A$[r];u&&(typeof u=="string"?n[u]=!0:u(t,e[r],s))}const i=t.state&&t.state.cache;if(i)for(const r in n){const s=u$[r];s(t,e,i)}}function g$(t,e){if(e=e||JE,typeof e=="number"){const r=e,s=qM[r];return s?s(t,r):t.getParameter(r)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const r of n){const s=qM[r];i[r]=s?s(t,Number(r)):t.getParameter(Number(r))}return i}function m$(t){Vu(t,JE)}function Jl(t,e,n){if(xD(e))return n(t);const{nocatch:i=!0}=e;p$(t),Vu(t,e);let r;if(i)r=n(t),YM(t);else try{r=n(t)}finally{YM(t)}return r}function Nf(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,i="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return i?t.drawingBufferWidth/i:1}return 1}function yx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=Nf(t),r=t.drawingBufferWidth,s=t.drawingBufferHeight;return _$(e,i,r,s,n)}function y$(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function _$(t,e,n,i,r){const s=XM(t[0],e,n);let u=KM(t[1],e,i,r),a=XM(t[0]+1,e,n);const y=a===n-1?a:a-1;a=KM(t[1]+1,e,i,r);let w;return r?(a=a===0?a:a+1,w=u,u=a):w=a===i-1?a:a-1,{x:s,y:u,width:Math.max(y-s+1,1),height:Math.max(w-u+1,1)}}function XM(t,e,n){return Math.min(Math.round(t*e),n-1)}function KM(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const eT=Ad(),v$=eT&&typeof document<"u",bD={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function ED(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Po(eT,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},bD,t);const{width:e,height:n}=t;function i(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=i;let r;const{canvas:s}=t,u=E$({canvas:s,width:e,height:n,onError:i});return r=b$(u,t),r?(r=tT(r,t),T$(r),r):null}function tT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||S$(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},bD,e);const{manageState:n,debug:i}=e;return n&&wD(t,{copyState:!1,log:function(){for(var r=arguments.length,s=new Array(r),u=0;u<r;u++)s[u]=arguments[u];return _n.log(1,...s)()}}),eT&&i&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),_n.level=Math.max(_n.level,1)):_n.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function x$(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info"),r=i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936),s=i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937);return{vendor:r||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function w$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const i=y$(e.useDevicePixels);M$(t,i,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function b$(t,e){const{onError:n}=e;let i=null;const r=y=>i=y.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:u=!0}=e;let a=null;return u&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(u&&!s?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}function E$(t){let{canvas:e,width:n=800,height:i=600,onError:r}=t,s;return typeof e=="string"?(v$&&document.readyState==="complete"||r("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function T$(t){const e=ui(t)?"WebGL2":"WebGL1",n=x$(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=t.debug?" debug":"";_n.info(1,"".concat(e).concat(r," context ").concat(i))()}function S$(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function M$(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,r="height"in n?n.height:t.canvas.clientHeight;(!i||!r)&&(_n.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,r=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let u=e;const a=Math.floor(i*u),y=Math.floor(r*u);t.canvas.width=a,t.canvas.height=y,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==y)&&(_n.warn("Device pixel ratio clamped")(),u=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/r),t.canvas.width=Math.floor(i*u),t.canvas.height=Math.floor(r*u)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}function JM(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let eC=class{constructor(e,n){oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"sampleSize",1),oe(this,"time",void 0),oe(this,"count",void 0),oe(this,"samples",void 0),oe(this,"lastTiming",void 0),oe(this,"lastSampleTime",void 0),oe(this,"lastSampleCount",void 0),oe(this,"_count",0),oe(this,"_time",0),oe(this,"_samples",0),oe(this,"_startTime",0),oe(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=JM(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(JM()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},C$=class{constructor(e){oe(this,"id",void 0),oe(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:i}=e;return this.stats[n]||(e instanceof eC?this.stats[n]=e:this.stats[n]=new eC(n,i)),this.stats[n]}};function TD(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function SD(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||TD()}const _x=globalThis;function P$(t){if(!t&&!SD())return"Node";if(TD(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r?"IE":_x.chrome?"Chrome":_x.safari?"Safari":_x.mozInnerScreenX?"Firefox":"Unknown"}const Fp="8.5.21",I$="set luma.log.level=1 (or higher) to trace rendering";class k${constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new C$({id:e})),this.stats.get(e)}}const Mh=new k$;if(globalThis.luma&&globalThis.luma.VERSION!==Fp)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Fp));globalThis.luma||(SD()&&_n.log(1,"luma.gl ".concat(Fp," - ").concat(I$))(),globalThis.luma=globalThis.luma||{VERSION:Fp,version:Fp,log:_n,stats:Mh,globals:{modules:{},nodeIO:{}}});function L$(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function D$(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function tn(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function vx(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const i=t[e];return tn(i!==void 0,"Accessing undefined constant GL.".concat(e)),i}function jc(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const xx={};function Yc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";xx[t]=xx[t]||1;const e=xx[t]++;return"".concat(t,"-").concat(e)}function tC(t){return tn(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function Uf(t){let e=!0;for(const n in t){e=!1;break}return e}function MD(t,e,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);i.forEach(u=>{s.methodName||(s[u]=()=>{throw _n.removed("Calling removed method ".concat(e,".").concat(u,": "),r)(),new Error(u)})})}const L0="Resource subclass must define virtual methods";let Yu=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f2(e);const{id:i,userData:r={}}=n;this.gl=e,this.gl2=e,this.id=i||Yc(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(i=>i.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=vx(this.gl,e),tn(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=ui(this.gl);if(!((!("webgl2"in r)||s)&&(!("extension"in r)||this.gl.getExtension(r.extension)))){const a=r.webgl1,y="webgl2"in r?r.webgl2:r.webgl1;return s?y:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:i}=e,r=this.constructor.PARAMETERS||{},s=ui(this.gl),u={},a=n||Object.keys(r);for(const y of a){const w=r[y];if(w&&(!("webgl2"in w)||s)&&(!("extension"in w)||this.gl.getExtension(w.extension))){const P=i?jc(this.gl,y):y;u[P]=this.getParameter(y,e),i&&w.type==="GLenum"&&(u[P]=jc(this.gl,u[P]))}}return u}setParameter(e,n){e=vx(this.gl,e),tn(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=ui(this.gl);if(!((!("webgl2"in r)||s)&&(!("extension"in r)||this.gl.getExtension(r.extension))))throw new Error("Parameter not available on this platform");r.type==="GLenum"&&(n=vx(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,i){return MD(this,e,n,i)}initialize(e){}_createHandle(){throw new Error(L0)}_deleteHandle(){throw new Error(L0)}_bindHandle(e){throw new Error(L0)}_getOptsFromHandle(){throw new Error(L0)}_getParameter(e,n){throw new Error(L0)}_setParameter(e,n){throw new Error(L0)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=Mh.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Mh.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const r=Mh.get("Memory Usage".concat(i));r.get("GPU Memory").addCount(e),r.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=Mh.get("Memory Usage".concat(n));i.get("GPU Memory").subtractCount(this.byteLength),i.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const R$="Failed to deduce GL constant from typed array";function Mb(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(R$)}}function lg(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function B$(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:s}=t;const u=n*r;s=s||new Uint8Array(u);for(let a=0;a<i/2;++a){const y=a*u,w=(i-a-1)*u;s.set(e.subarray(y,y+u)),e.copyWithin(y,w,w+u),e.set(s,w)}}function z$(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),s=Math.round(i/2),u=new Uint8Array(r*s*4);for(let a=0;a<s;a++)for(let y=0;y<r;y++)for(let w=0;w<4;w++)u[(a*r+y)*4+w]=e[(a*2*n+y*2)*4+w];return{data:u,width:r,height:s}}function Cb(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=n;for(const a in i)if(a in e){const w=i[a]?"".concat(t,".").concat(i[a]):"N/A";_n.removed("".concat(t,".").concat(a),w)()}for(const a in r)if(a in e){const y=r[a];_n.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(y))()}let u=null;for(const a in s)if(a in e){const y=s[a];_n.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(y))(),u=u||Object.assign({},e),u[y]=e[a],delete u[a]}return u||e}const O$={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},F$={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Pa{static getBytesPerElement(e){return lg(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return tn(e.size),lg(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new Pa(O$,...n)}constructor(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Pa.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Pa.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=Cb("Accessor",e,F$),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const nC=10,CD={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},N$={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:CD},U$={removedProps:CD};class Fi extends Yu{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Pa.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Pa.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=Cb("Buffer",e,N$),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=Cb("Buffer",e,U$),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Pa(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;tn(n);const u=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(u,this.handle),r!==0||s!==void 0?(lo(this.gl),this.gl.bufferSubData(this.target,i,n,r,s)):this.gl.bufferSubData(u,i,n),this.gl.bindBuffer(u,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:i=0,writeOffset:r=0,size:s}=e;const{gl:u}=this;return lo(u),u.bindBuffer(36662,n.handle),u.bindBuffer(36663,this.handle),u.copyBufferSubData(36662,36663,i,r,s),u.bindBuffer(36662,null),u.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:i=0,length:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};lo(this.gl);const s=lg(this.accessor.type||5126,{clamped:!1}),u=this._getAvailableElementCount(n),a=i;let y,w;e?(w=e.length,y=w-a):(y=Math.min(u,r||u),w=a+y);const I=Math.min(u,y);return r=r||I,tn(r<=I),e=e||new s(w),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,i,r),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:i=0,size:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?r!==void 0?this.gl.bindBufferRange(e,n,this.handle,i,r):(tn(i===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(nC,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;tn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,n,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,nC),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=Mb(e);return tn(s),this.setAccessor(new Pa(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;tn(e>=0),this._trackDeallocatedMemory();let i=e;e===0&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,n),this.gl.bindBuffer(r,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=lg(this.accessor.type||5126,{clamped:!1}),i=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new Pa(this.accessor,{type:Mb(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return _n.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return _n.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return _n.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return _n.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Pa(this.accessor,e),this}}const nT={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},PD={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},ID={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function V$(t,e){const n=nT[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const i=ui(t)&&n.gl2||n.gl1;return typeof i=="string"?t.getExtension(i):i}function G$(t,e){const n=nT[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const j$=[9729,9728],iC=globalThis.WebGLBuffer||function(){};class Uh extends Yu{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:i,linearFiltering:r}=n;let s=!0;return i&&(s=s&&V$(e,i),s=s&&(!r||G$(e,i))),s}constructor(e,n){const{id:i=Yc("texture"),handle:r,target:s}=n;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(te=>this.initialize(Object.assign({},e,{pixels:te,data:te}))),this;const i=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(i&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:u=0,recreate:a=!1,parameters:y={},pixelStore:w={},textureUnit:I=void 0}=e;n||(n=r);let{width:P,height:L,dataFormat:U,type:Q,compressed:Z=!1,mipmaps:ae=!0}=e;const{depth:Y=0}=e;return{width:P,height:L,compressed:Z,dataFormat:U,type:Q}=this._deduceParameters({format:s,type:Q,dataFormat:U,compressed:Z,data:n,width:P,height:L}),this.width=P,this.height=L,this.depth=Y,this.format=s,this.type=Q,this.dataFormat=U,this.border=u,this.textureUnit=I,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),ae&&this._isNPOT()&&(_n.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),ae=!1,this._updateForNPOT(y)),this.mipmaps=ae,this.setImageData({data:n,width:P,height:L,depth:Y,format:s,type:Q,dataFormat:U,border:u,mipmaps:ae,parameters:w,compressed:Z}),ae&&this.generateMipmap(),this.setParameters(y),a&&(this.data=n),i&&(this._video={video:n,parameters:y,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:i,mipmaps:r=!1}=e;return i!==this.width||n!==this.height?this.initialize({width:i,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(_n.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Jl(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:i=null,level:r=0,format:s=this.format,border:u=this.border,offset:a=0,parameters:y={}}=e;let{data:w=null,type:I=this.type,width:P=this.width,height:L=this.height,dataFormat:U=this.dataFormat,compressed:Q=!1}=e;w||(w=i),{type:I,dataFormat:U,compressed:Q,width:P,height:L}=this._deduceParameters({format:s,type:I,dataFormat:U,compressed:Q,data:w,width:P,height:L});const{gl:Z}=this;Z.bindTexture(this.target,this.handle);let ae=null;({data:w,dataType:ae}=this._getDataType({data:w,compressed:Q}));let Y,te=0;if(Jl(this.gl,y,()=>{switch(ae){case"null":Z.texImage2D(n,r,s,P,L,u,U,I,w);break;case"typed-array":Z.texImage2D(n,r,s,P,L,u,U,I,w,a);break;case"buffer":Y=lo(Z),Y.bindBuffer(35052,w.handle||w),Y.texImage2D(n,r,s,P,L,u,U,I,a),Y.bindBuffer(35052,null);break;case"browser-object":ui(Z)?Z.texImage2D(n,r,s,P,L,u,U,I,w):Z.texImage2D(n,r,s,U,I,w);break;case"compressed":for(const[re,de]of w.entries())Z.compressedTexImage2D(n,re,de.format,de.width,de.height,u,de.data),te+=de.levelSize;break;default:tn(!1,"Unknown image data type")}}),ae==="compressed")this._trackAllocatedMemory(te,"Texture");else if(w&&w.byteLength)this._trackAllocatedMemory(w.byteLength,"Texture");else{const re=PD[this.dataFormat]||4,de=ID[this.type]||1;this._trackAllocatedMemory(this.width*this.height*re*de,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:i=null,data:r=null,x:s=0,y:u=0,width:a=this.width,height:y=this.height,level:w=0,format:I=this.format,type:P=this.type,dataFormat:L=this.dataFormat,compressed:U=!1,offset:Q=0,border:Z=this.border,parameters:ae={}}=e;if({type:P,dataFormat:L,compressed:U,width:a,height:y}=this._deduceParameters({format:I,type:P,dataFormat:L,compressed:U,data:r,width:a,height:y}),tn(this.depth===0,"texSubImage not supported for 3D textures"),r||(r=i),r&&r.data){const Y=r;r=Y.data,a=Y.shape[0],y=Y.shape[1]}r instanceof Fi&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),Jl(this.gl,ae,()=>{if(U)this.gl.compressedTexSubImage2D(n,w,s,u,a,y,I,r);else if(r===null)this.gl.texSubImage2D(n,w,s,u,a,y,L,P,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(n,w,s,u,a,y,L,P,r,Q);else if(r instanceof iC){const Y=lo(this.gl);Y.bindBuffer(35052,r),Y.texSubImage2D(n,w,s,u,a,y,L,P,Q),Y.bindBuffer(35052,null)}else ui(this.gl)?lo(this.gl).texSubImage2D(n,w,s,u,a,y,L,P,r):this.gl.texSubImage2D(n,w,s,u,L,P,r)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return _n.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:i=!1}=e;return i?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof Fi?{data:n.handle,dataType:"buffer"}:n instanceof iC?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:i}=e;let{width:r,height:s,dataFormat:u,type:a,compressed:y}=e;const w=nT[n];return u=u||w&&w.dataFormat,a=a||w&&w.types[0],y=y||w&&w.compressed,{width:r,height:s}=this._deduceImageSize(i,r,s),{dataFormat:u,type:a,compressed:y,width:r,height:s,format:n,data:i}}_deduceImageSize(e,n,i){let r;return typeof ImageData<"u"&&e instanceof ImageData?r={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?r={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?r={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?r={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?r={width:e.videoWidth,height:e.videoHeight}:e?r={width:n,height:i}:r={width:n>=0?n:1,height:i>=0?i:1},tn(r,"Could not deduced texture size"),tn(n===void 0||r.width===n,"Deduced texture width does not match supplied width"),tn(i===void 0||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:tn(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return ui(this.gl)||!this.width||!this.height?!1:!tC(this.width)||!tC(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:j$.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let $$="";function H$(t,e){return tn(typeof t=="string"),t=$$+t,new Promise((n,i)=>{try{const r=new Image;r.onload=()=>n(r),r.onerror=()=>i(new Error("Could not load image ".concat(t,"."))),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=t}catch(r){i(r)}})}class oa extends Uh{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Uh.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f2(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:H$(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const Pb=[34069,34070,34071,34072,34073,34074];class kD extends Uh{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f2(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:i={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(i)}),this}subImage(e){let{face:n,data:i,x:r=0,y:s=0,mipmapLevel:u=0}=e;return this._subImage({target:n,data:i,x:r,y:s,mipmapLevel:u})}async setCubeMapImageData(e){let{width:n,height:i,pixels:r,data:s,border:u=0,format:a=6408,type:y=5121}=e;const{gl:w}=this,I=r||s,P=await Promise.all(Pb.map(L=>{const U=I[L];return Promise.all(Array.isArray(U)?U:[U])}));this.bind(),Pb.forEach((L,U)=>{P[U].length>1&&this.opts.mipmaps!==!1&&_n.warn("".concat(this.id," has mipmap and multiple LODs."))(),P[U].forEach((Q,Z)=>{n&&i?w.texImage2D(L,Z,a,n,i,u,a,y,Q):w.texImage2D(L,Z,a,a,y,Q)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:i,height:r,pixels:s,data:u,border:a=0,format:y=6408,type:w=5121}=e,{gl:I}=this,P=s||u;return this.bind(),P instanceof Promise?P.then(L=>this.setImageDataForFace(Object.assign({},e,{face:n,data:L,pixels:L}))):this.width||this.height?I.texImage2D(n,0,y,i,r,a,y,w,P):I.texImage2D(n,0,y,y,w,P),this}}kD.FACES=Pb;class W$ extends Uh{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return ui(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};lo(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:i=6408,width:r,height:s,depth:u=1,border:a=0,format:y,type:w=5121,offset:I=0,data:P,parameters:L={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Jl(this.gl,L,()=>{ArrayBuffer.isView(P)&&this.gl.texImage3D(this.target,n,i,r,s,u,a,y,w,P),P instanceof Fi&&(this.gl.bindBuffer(35052,P.handle),this.gl.texImage3D(this.target,n,i,r,s,u,a,y,w,I))}),P&&P.byteLength)this._trackAllocatedMemory(P.byteLength,"Texture");else{const U=PD[this.dataFormat]||4,Q=ID[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*U*Q,"Texture")}return this.loaded=!0,this}}const fh="EXT_color_buffer_float",rC={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:fh,bpp:2},33327:{gl2:fh,bpp:4},34842:{gl2:fh,bpp:8},33326:{gl2:fh,bpp:4},33328:{gl2:fh,bpp:8},34836:{gl2:fh,bpp:16},35898:{gl2:fh,bpp:4}};function Q$(t,e,n){const i=n[e];if(!i)return!1;const r=ui(t)&&i.gl2||i.gl1;return typeof r=="string"?t.getExtension(r):r}class K0 extends Yu{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||Q$(e,n,rC)}static getSamplesForFormat(e,n){let{format:i}=n;return e.getInternalformatParameter(36161,i,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:i=1,height:r=1,samples:s=0}=e;return tn(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&ui(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,i,r):this.gl.renderbufferStorage(36161,n,i,r),this.format=n,this.width=i,this.height=r,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*rC[this.format].bpp),this}resize(e){let{width:n,height:i}=e;return n!==this.width||i!==this.height?this.initialize({width:n,height:i,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const q$=256,Z$=1024,Y$=16384,sC=6144,oC=6145,aC=6146,lC=34041,LD="clear: bad arguments";function iT(t){let{framebuffer:e=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let u=0;n&&(u|=Y$,n!==!0&&(s.clearColor=n)),i&&(u|=q$,i!==!0&&(s.clearDepth=i)),r&&(u|=Z$,i!==!0&&(s.clearStencil=i)),tn(u!==0,LD),Jl(t,s,()=>{t.clear(u)})}function X$(t){let{framebuffer:e=null,buffer:n=sC,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};lo(t),Jl(t,{framebuffer:e},()=>{switch(n){case sC:switch(r.constructor){case Int32Array:t.clearBufferiv(n,i,r);break;case Uint32Array:t.clearBufferuiv(n,i,r);break;case Float32Array:default:t.clearBufferfv(n,i,r)}break;case oC:t.clearBufferfv(oC,0,[r]);break;case aC:t.clearBufferiv(aC,0,[r]);break;case lC:const[s,u]=r;t.clearBufferfi(lC,0,s,u);break;default:tn(!1,LD)}})}function K$(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return tn(!1),0}}function d2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:u=null,sourceWidth:a,sourceHeight:y,sourceType:w}=e;const{framebuffer:I,deleteFramebuffer:P}=DD(t);tn(I);const{gl:L,handle:U,attachments:Q}=I;a=a||I.width,y=y||I.height,s===36064&&U===null&&(s=1028),tn(Q[s]),w=w||Q[s].type,u=eH(u,w,r,a,y),w=w||Mb(u);const Z=L.bindFramebuffer(36160,U);return L.readPixels(n,i,a,y,r,w,u),L.bindFramebuffer(36160,Z||null),P&&I.delete(),u}function AC(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=d2(t,{sourceAttachment:e}),{width:r,height:s}=t;for(;s>n;)({data:i,width:r,height:s}=z$({data:i,width:r,height:s}));B$({data:i,width:r,height:s});const u=document.createElement("canvas");u.width=r,u.height=s;const a=u.getContext("2d"),y=a.createImageData(r,s);return y.data.set(i),a.putImageData(y,0,0),u.toDataURL()}function J$(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:s=0,targetInternalFormat:u=6408}=n;let{targetX:a,targetY:y,targetZ:w,width:I,height:P}=n;const{framebuffer:L,deleteFramebuffer:U}=DD(t);tn(L);const{gl:Q,handle:Z}=L,ae=typeof a<"u"||typeof y<"u"||typeof w<"u";a=a||0,y=y||0,w=w||0;const Y=Q.bindFramebuffer(36160,Z);tn(e);let te=null;if(e instanceof Uh&&(te=e,I=Number.isFinite(I)?I:te.width,P=Number.isFinite(P)?P:te.height,te.bind(0),e=te.target),!ae)Q.copyTexImage2D(e,s,u,i,r,I,P,0);else switch(e){case 3553:case 34067:Q.copyTexSubImage2D(e,s,a,y,i,r,I,P);break;case 35866:case 32879:lo(Q).copyTexSubImage3D(e,s,a,y,w,i,r,I,P);break}return te&&te.unbind(),Q.bindFramebuffer(36160,Y||null),U&&L.delete(),te}function DD(t){return t instanceof es?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:AH(t),deleteFramebuffer:!0}}function eH(t,e,n,i,r){if(t)return t;e=e||5121;const s=lg(e,{clamped:!1}),u=K$(n);return new s(i*r*u)}const Yi={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function tH(t){const e=new oa(t,{format:6408,type:5126,dataFormat:6408}),n=new es(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=n.getStatus();return e.delete(),n.delete(),i===36053}const RD={[Yi.WEBGL2]:[!1,!0],[Yi.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Yi.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Yi.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Yi.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Yi.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Yi.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Yi.FLOAT_BLEND]:["EXT_float_blend"],[Yi.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Yi.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Yi.TEXTURE_FLOAT]:["OES_texture_float",!0],[Yi.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Yi.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Yi.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Yi.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Yi.COLOR_ATTACHMENT_RGBA32F]:[tH,"EXT_color_buffer_float"],[Yi.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Yi.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Yi.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Yi.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Yi.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Yi.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},nH=2;function BD(t,e){return rT(t,e)}function rT(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>zD(t,n))}function iH(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in RD)t.luma.caps[e]===void 0&&(t.luma.caps[e]=zD(t,e));return t.luma.caps}function zD(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=rH(t,e)),t.luma.caps[e]||_n.log(nH,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function rH(t,e){const n=RD[e];tn(n,e);let i;const r=ui(t)&&n[1]||n[0];if(typeof r=="function")i=r(t);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&!!t.getExtension(s)}else typeof r=="string"?i=!!t.getExtension(r):typeof r=="boolean"?i=r:tn(!1);return i}const uC="Multiple render targets not supported";class es extends Yu{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:i,colorBufferHalfFloat:r}=n;let s=!0;return i&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new es(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=lo(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=lo(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:i=1,attachments:r=null,color:s=!0,depth:u=!0,stencil:a=!1,check:y=!0,readBuffer:w=void 0,drawBuffers:I=void 0}=e;if(tn(n>=0&&i>=0,"Width and height need to be integers"),this.width=n,this.height=i,r)for(const P in r){const L=r[P];(Array.isArray(L)?L[0]:L).resize({width:n,height:i})}else r=this._createDefaultAttachments(s,u,a,n,i);this.update({clearAttachments:!0,attachments:r,readBuffer:w,drawBuffers:I}),r&&y&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:i,drawBuffers:r,clearAttachments:s=!1,resizeAttachments:u=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:u});const{gl:a}=this,y=a.bindFramebuffer(36160,this.handle);return i&&this._setReadBuffer(i),r&&this._setDrawBuffers(r),a.bindFramebuffer(36160,y||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:i}=e;if(this.handle===null)return tn(n===void 0&&i===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),i===void 0&&(i=this.gl.drawingBufferHeight),n!==this.width&&i!==this.height&&_n.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(i))();for(const r in this.attachments)this.attachments[r].resize({width:n,height:i});return this.width=n,this.height=i,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:i=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={};n&&Object.keys(this.attachments).forEach(u=>{r[u]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const u in r){tn(u!==void 0,"Misspelled framebuffer binding point?");const a=Number(u),y=r[a];let w=y;if(!w)this._unattach(a);else if(w instanceof K0)this._attachRenderbuffer({attachment:a,renderbuffer:w});else if(Array.isArray(y)){const[I,P=0,L=0]=y;w=I,this._attachTexture({attachment:a,texture:I,layer:P,level:L})}else this._attachTexture({attachment:a,texture:w,layer:0,level:0});i&&w&&w.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(u=>!this.attachments[u]).forEach(u=>{delete this.attachments[u]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(oH(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),i}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:i,stencil:r,drawBuffers:s=[]}=e,u=this.gl.bindFramebuffer(36160,this.handle);return(n||i||r)&&iT(this.gl,{color:n,depth:i,stencil:r}),s.forEach((a,y)=>{X$(this.gl,{drawBuffer:y,value:a})}),this.gl.bindFramebuffer(36160,u||null),this}readPixels(){return _n.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return _n.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return _n.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return _n.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return _n.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return _n.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:i=0,y:r=0,width:s,height:u}=e;const a=lo(this.gl),y=a.bindFramebuffer(36008,this.handle);return i===0&&r===0&&s===void 0&&u===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,i,r,s,u),a.bindFramebuffer(36008,y),this}getAttachmentParameter(e,n,i){let r=this._getAttachmentParameterFallback(n);return r===null&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=jc(this.gl,r)),r}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const r={};for(const s of i){const u=n?jc(this.gl,s):s;r[u]=this.getAttachmentParameter(e,s,n)}return r}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),i={};for(const r of n){const s=Number(r),u=e?jc(this.gl,s):s;i[u]=this.getAttachmentParameters(s,e)}return i}show(){return typeof window<"u"&&window.open(AC(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>_n.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const i=AC(this,{targetMaxHeight:100});return _n.image({logLevel:e,message:n,image:i},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,i,r,s){let u=null;return e&&(u=u||{},u[36064]=new oa(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(u[36064])),n&&i?(u=u||{},u[33306]=new K0(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(u[33306])):n?(u=u||{},u[36096]=new K0(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:s}),this.ownResources.push(u[36096])):i&&tn(!1),u}_unattach(e){const n=this.attachments[e];n&&(n instanceof K0?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:i}=e;const{gl:r}=this;r.framebufferRenderbuffer(36160,n,36161,i.handle),this.attachments[n]=i}_attachTexture(e){let{attachment:n=36064,texture:i,layer:r,level:s}=e;const{gl:u}=this;switch(u.bindTexture(i.target,i.handle),i.target){case 35866:case 32879:lo(u).framebufferTextureLayer(36160,n,i.target,s,r);break;case 34067:const y=sH(r);u.framebufferTexture2D(36160,n,y,i.handle,s);break;case 3553:u.framebufferTexture2D(36160,n,3553,i.handle,s);break;default:tn(!1,"Illegal texture type")}u.bindTexture(i.target,null),this.attachments[n]=i}_setReadBuffer(e){const n=Dj(this.gl);n?n.readBuffer(e):tn(e===36064||e===1029,uC),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,i=lo(n);if(i)i.drawBuffers(e);else{const r=n.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):tn(e.length===1&&(e[0]===36064||e[0]===1029),uC)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=iH(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function sH(t){return t<34069?t+34069:t}function oH(t){return(es.STATUS||{})[t]||"Framebuffer error ".concat(t)}const aH=[36049,36048,33296,33298,33299,33300,33301,33302,33303];es.ATTACHMENT_PARAMETERS=aH;function lH(t,e){tn(t instanceof oa||t instanceof kD||t instanceof W$);const n=t.constructor,{gl:i,width:r,height:s,format:u,type:a,dataFormat:y,border:w,mipmaps:I}=t,P=Object.assign({width:r,height:s,format:u,type:a,dataFormat:y,border:w,mipmaps:I},e);return new n(i,P)}function AH(t,e){const{gl:n,width:i,height:r,id:s}=t;return new es(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:i,height:r,attachments:{36064:t}}))}function Z1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,i=t.match(n);return i?i[1]:e}const uH=35632,cH=35633;function hH(t){switch(t){case uH:return"fragment";case cH:return"vertex";default:return"unknown type"}}function fH(t,e,n,i){const r=t.split(/\r?\n/),s={},u={},a=i||Z1(e)||"(unnamed)",y="".concat(hH(n)," shader ").concat(a);for(let I=0;I<r.length;I++){const P=r[I];if(P.length<=1)continue;const L=P.split(":"),U=L[0],Q=parseInt(L[2],10);if(isNaN(Q))throw new Error("GLSL compilation error in ".concat(y,": ").concat(t));U!=="WARNING"?s[Q]=P:u[Q]=P}const w=dH(e);return{shaderName:y,errors:cC(s,w),warnings:cC(u,w)}}function cC(t,e){let n="";for(let i=0;i<e.length;i++){const r=e[i];if(!(!t[i+3]&&!t[i+2]&&!t[i+1])&&(n+="".concat(r,`
`),t[i+1])){const s=t[i+1],u=s.split(":",3),a=u[0],y=parseInt(u[1],10)||0,w=s.substring(u.join(":").length+1).trim();n+=OD("^^^ ".concat(a,": ").concat(w,`

`),y)}}return n}function dH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,u)=>{const a=String(u+e),y=a.length;return OD(a,r-y)+n+s})}function OD(t,e){let n="";for(let i=0;i<e;++i)n+=" ";return"".concat(n).concat(t)}function FD(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const i=parseInt(n[1],10);Number.isFinite(i)&&(e=i)}return e}const pH="Shader: GLSL source code must be a JavaScript string";class Ag extends Yu{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return tn(!1),"unknown"}}constructor(e,n){f2(e),tn(typeof n.source=="string",pH);const i=Z1(n.source,null)||n.id||Yc("unnamed ".concat(Ag.getTypeName(n.shaderType)));super(e,{id:i}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const i=Z1(n,null);i&&(this.id=Yc(i)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Ag.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Z1(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:u}=fH(i,this.source,this.shaderType,this.id);throw _n.error("GLSL compilation errors in ".concat(r,`
`).concat(s))(),_n.warn("GLSL compilation warnings in ".concat(r,`
`).concat(u))(),new Error("GLSL compilation errors in ".concat(r))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class wx extends Ag{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class bx extends Ag{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const gH={5126:ir.bind(null,"uniform1fv",Ta,1,Ks),35664:ir.bind(null,"uniform2fv",Ta,2,Ks),35665:ir.bind(null,"uniform3fv",Ta,3,Ks),35666:ir.bind(null,"uniform4fv",Ta,4,Ks),5124:ir.bind(null,"uniform1iv",mc,1,Ks),35667:ir.bind(null,"uniform2iv",mc,2,Ks),35668:ir.bind(null,"uniform3iv",mc,3,Ks),35669:ir.bind(null,"uniform4iv",mc,4,Ks),35670:ir.bind(null,"uniform1iv",mc,1,Ks),35671:ir.bind(null,"uniform2iv",mc,2,Ks),35672:ir.bind(null,"uniform3iv",mc,3,Ks),35673:ir.bind(null,"uniform4iv",mc,4,Ks),35674:ir.bind(null,"uniformMatrix2fv",Ta,4,yu),35675:ir.bind(null,"uniformMatrix3fv",Ta,9,yu),35676:ir.bind(null,"uniformMatrix4fv",Ta,16,yu),35678:Cs,35680:Cs,5125:ir.bind(null,"uniform1uiv",Ym,1,Ks),36294:ir.bind(null,"uniform2uiv",Ym,2,Ks),36295:ir.bind(null,"uniform3uiv",Ym,3,Ks),36296:ir.bind(null,"uniform4uiv",Ym,4,Ks),35685:ir.bind(null,"uniformMatrix2x3fv",Ta,6,yu),35686:ir.bind(null,"uniformMatrix2x4fv",Ta,8,yu),35687:ir.bind(null,"uniformMatrix3x2fv",Ta,6,yu),35688:ir.bind(null,"uniformMatrix3x4fv",Ta,12,yu),35689:ir.bind(null,"uniformMatrix4x2fv",Ta,8,yu),35690:ir.bind(null,"uniformMatrix4x3fv",Ta,12,yu),35678:Cs,35680:Cs,35679:Cs,35682:Cs,36289:Cs,36292:Cs,36293:Cs,36298:Cs,36299:Cs,36300:Cs,36303:Cs,36306:Cs,36307:Cs,36308:Cs,36311:Cs},mH={},yH={},_H={},hC=[0];function sT(t,e,n,i){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(hC[0]=t,t=hC);const r=t.length;if(r%e&&_n.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=i[r];s||(s=new n(r),i[r]=s);for(let u=0;u<r;u++)s[u]=t[u];return s}function Ta(t,e){return sT(t,e,Float32Array,mH)}function mc(t,e){return sT(t,e,Int32Array,yH)}function Ym(t,e){return sT(t,e,Uint32Array,_H)}function fC(t,e,n){const i=gH[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function vH(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function xH(t,e,n){for(const i in t){const r=t[i];if((!n||!!n[i])&&!wH(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}return!0}function wH(t){return Array.isArray(t)||ArrayBuffer.isView(t)?EH(t):isFinite(t)||t===!0||t===!1||t instanceof Uh||t instanceof K0?!0:t instanceof es?!!t.texture:!1}function bH(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let r=0,s=n.length;r<s;++r)i[r]=n[r]}else t[e]=n.slice();else t[e]=n}function EH(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Cs(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function ir(t,e,n,i){let r=null,s=null;return(u,a,y)=>{const w=e(y,n),I=w.length;let P=!1;if(r===null)r=new Float32Array(I),s=I,P=!0;else{tn(s===I,"Uniform length cannot change.");for(let L=0;L<I;++L)if(w[L]!==r[L]){P=!0;break}}return P&&(i(u,t,a,w),r.set(w)),P}}function Ks(t,e,n,i){t[e](n,i)}function yu(t,e,n,i){t[e](n,!1,i)}const TH=5120,SH=5121,MH=5122,CH=5123,dC=0,Xm=1,PH=2,IH=3,Km=4,kH=5,LH=6,Xr=5126,DH=35664,RH=35665,BH=35666,qd=5124,zH=35667,OH=35668,FH=35669,Zd=5125,NH=36294,UH=36295,VH=36296,GH=35670,jH=35671,$H=35672,HH=35673,WH=35674,QH=35675,qH=35676,ZH=35685,YH=35686,XH=35687,KH=35688,JH=35689,eW=35690,Ib={[Xr]:[Xr,1,"float"],[DH]:[Xr,2,"vec2"],[RH]:[Xr,3,"vec3"],[BH]:[Xr,4,"vec4"],[qd]:[qd,1,"int"],[zH]:[qd,2,"ivec2"],[OH]:[qd,3,"ivec3"],[FH]:[qd,4,"ivec4"],[Zd]:[Zd,1,"uint"],[NH]:[Zd,2,"uvec2"],[UH]:[Zd,3,"uvec3"],[VH]:[Zd,4,"uvec4"],[GH]:[Xr,1,"bool"],[jH]:[Xr,2,"bvec2"],[$H]:[Xr,3,"bvec3"],[HH]:[Xr,4,"bvec4"],[WH]:[Xr,8,"mat2"],[ZH]:[Xr,8,"mat2x3"],[YH]:[Xr,8,"mat2x4"],[QH]:[Xr,12,"mat3"],[XH]:[Xr,12,"mat3x2"],[KH]:[Xr,12,"mat3x4"],[qH]:[Xr,16,"mat4"],[JH]:[Xr,16,"mat4x2"],[eW]:[Xr,16,"mat4x3"]};function tW(t){switch(t){case dC:return dC;case Xm:return Xm;case IH:return Xm;case PH:return Xm;case Km:return Km;case kH:return Km;case LH:return Km;default:return tn(!1),0}}function pC(t){const e=Ib[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function ND(t,e){switch(t){case TH:case SH:case MH:case CH:t=Xr;break}for(const n in Ib){const[i,r,s]=Ib[n];if(i===t&&r===e)return{glType:n,name:s}}return null}class nW{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,i=n.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:u,size:a}=n.getActiveAttrib(e.handle,r),y=n.getAttribLocation(e.handle,s);y>=0&&this._addAttribute(y,s,u,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!ui(n))return;const i=n.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:u,size:a}=n.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,u,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,n,i,r){const{type:s,components:u}=pC(i),a={type:s,size:r*u};this._inferProperties(e,n,a);const y={location:e,name:n,accessor:new Pa(a)};this.attributeInfos.push(y),this.attributeInfosByLocation[e]=y,this.attributeInfosByName[y.name]=y}_inferProperties(e,n,i){/instance/i.test(n)&&(i.divisor=1)}_addVarying(e,n,i,r){const{type:s,components:u}=pC(i),a=new Pa({type:s,size:r*u}),y={location:e,name:n,accessor:a};this.varyingInfos.push(y),this.varyingInfosByName[y.name]=y}}const gC=4,iW=35981,rW=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class UD extends Yu{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",rW),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:i,fs:r,varyings:s,bufferMode:u=iW}=e;return this.hash=n||"",this.vs=typeof i=="string"?new wx(this.gl,{id:"".concat(e.id,"-vs"),source:i}):i,this.fs=typeof r=="string"?new bx(this.gl,{id:"".concat(e.id,"-fs"),source:r}):r,tn(this.vs instanceof wx),tn(this.fs instanceof bx),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(lo(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,u)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new nW(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:i=4,vertexCount:r,offset:s=0,start:u,end:a,isIndexed:y=!1,indexType:w=5123,instanceCount:I=0,isInstanced:P=I>0,vertexArray:L=null,transformFeedback:U,framebuffer:Q,parameters:Z={},uniforms:ae,samplers:Y}=e;if((ae||Y)&&(_n.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(ae||{})),_n.priority>=n){const te=Q?Q.id:"default",re="mode=".concat(jc(this.gl,i)," verts=").concat(r," ")+"instances=".concat(I," indexType=").concat(jc(this.gl,w)," ")+"isInstanced=".concat(P," isIndexed=").concat(y," ")+"Framebuffer=".concat(te);_n.log(n,re)()}return tn(L),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||r===0||P&&I===0?!1:(L.bindForDraw(r,I,()=>{if(Q!==void 0&&(Z=Object.assign({},Z,{framebuffer:Q})),U){const te=tW(i);U.begin(te)}this._bindTextures(),Jl(this.gl,Z,()=>{y&&P?this.gl2.drawElementsInstanced(i,r,w,s,I):y&&ui(this.gl)&&!isNaN(u)&&!isNaN(a)?this.gl2.drawRangeElements(i,u,a,r,w,s):y?this.gl.drawElements(i,r,w,s):P?this.gl2.drawArraysInstanced(i,s,r,I):this.gl.drawArrays(i,s,r)}),U&&U.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_n.priority>=2&&xH(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const i=e[n],r=this._uniformSetters[n];if(r){let s=i,u=!1;if(s instanceof es&&(s=s.texture),s instanceof Uh)if(u=this.uniforms[n]!==i,u){r.textureIndex===void 0&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:y}=r;a.bind(y),s=y,this._textureUniforms[n]=a}else s=r.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(r(s)||u)&&bH(this.uniforms,n,i)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const i=this._textureUniforms[n];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),i={};for(const r of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new wx({handle:r});break;case 35632:i.fs=new bx({handle:r});break}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Yc(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),_n.time(gC,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),_n.timeEnd(gC,"linkProgram for ".concat(this._getName()))(),e.debug||_n.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const i=this.gl.getActiveUniform(this.handle,n),{name:r}=vH(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=fC(e,s,i),i.size>1)for(let u=0;u<i.size;u++)s=e.getUniformLocation(this.handle,"".concat(r,"[").concat(u,"]")),this._uniformSetters["".concat(r,"[").concat(u,"]")]=fC(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const sW=34918,oW=34919,aW=35007,lW=36795,AW=35976,uW=35887,cW=36202;class Zy extends Yu{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=ui(e),r=rT(e,Yi.TIMER_QUERY);let s=i||r;for(const u of n)switch(u){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:tn(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(aW)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?cW:uW)}beginTransformFeedbackQuery(){return this.begin(AW)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,oW);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(lW)}getResult(){return this.gl2.getQueryParameter(this.handle,sW)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):n++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Zy.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class VD extends Yu{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return ui(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};lo(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Uf(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:u}=this._getBufferParams(n);return i<0?(this.unused[e]=r,_n.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[i]=n,this.bindOnUse||this._bindBuffer(i,r,u,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,i,r;return e instanceof Fi?r=e:(r=e.buffer,i=e.byteSize,n=e.byteOffset),(n!==void 0||i!==void 0)&&(n=n||0,i=i||r.byteLength-n),{buffer:r,byteOffset:n,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||r===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,i,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let Jm=null;function hW(t){return(!Jm||Jm.byteLength<t)&&(Jm=new ArrayBuffer(t)),Jm}function fW(t,e){const n=hW(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function dW(t){let{target:e,source:n,start:i=0,count:r=1}=t;const s=n.length,u=r*s;let a=0;for(let y=i;a<s;a++)e[y++]=n[a];for(;a<u;)a<u-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+u-a),a=u);return e}const pW="elements must be GL.ELEMENT_ARRAY_BUFFER";class Ma extends Yu{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?ui(e)||P$()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Ma(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Ma.MAX_ATTRIBUTES=Ma.MAX_ATTRIBUTES||e.getParameter(34921),Ma.MAX_ATTRIBUTES}static setConstant(e,n,i){switch(i.constructor){case Float32Array:Ma._setConstantFloatArray(e,n,i);break;case Int32Array:Ma._setConstantIntArray(e,n,i);break;case Uint32Array:Ma._setConstantUintArray(e,n,i);break;default:tn(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:i})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Ma.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return tn(!e||e.target===34963,pW),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,i){if(n.target===34963)return this.setElementBuffer(n,i);const{size:r,type:s,stride:u,offset:a,normalized:y,integer:w,divisor:I}=i,{gl:P,gl2:L}=this;return e=Number(e),this.bind(()=>{P.bindBuffer(34962,n.handle),w?(tn(ui(P)),L.vertexAttribIPointer(e,r,s,u,a)):P.vertexAttribPointer(e,r,s,y,u,a),P.enableVertexAttribArray(e),L.vertexAttribDivisor(e,I||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Ma.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const i=this._normalizeConstantArrayValue(n),r=i.byteLength*e,s=i.length*e;let u=!this.buffer;if(this.buffer=this.buffer||new Fi(this.gl,r),u=u||this.buffer.reallocate(r),u=u||!this._compareConstantArrayValues(i,this.bufferValue),u){const a=fW(n.constructor,s);dW({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==n[i])return!1;return!0}static _setConstantFloatArray(e,n,i){switch(i.length){case 1:e.vertexAttrib1fv(n,i);break;case 2:e.vertexAttrib2fv(n,i);break;case 3:e.vertexAttrib3fv(n,i);break;case 4:e.vertexAttrib4fv(n,i);break;default:tn(!1)}}static _setConstantIntArray(e,n,i){switch(tn(ui(e)),i.length){case 1:e.vertexAttribI1iv(n,i);break;case 2:e.vertexAttribI2iv(n,i);break;case 3:e.vertexAttribI3iv(n,i);break;case 4:e.vertexAttribI4iv(n,i);break;default:tn(!1)}}static _setConstantUintArray(e,n,i){switch(tn(ui(e)),i.length){case 1:e.vertexAttribI1uiv(n,i);break;case 2:e.vertexAttribI2uiv(n,i);break;case 3:e.vertexAttribI3uiv(n,i);break;case 4:e.vertexAttribI4uiv(n,i);break;default:tn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:i}=n;return tn(Number.isFinite(i)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(i,e);default:return this.gl.getVertexAttrib(i,e)}})}}const gW="VertexArray: attributes must be Buffers or constants (i.e. typed array)",mW=/^(.+)__LOCATION_([0-9]+)$/,yW=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class _W{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;this.id=i,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Ma(e),MD(this,"VertexArray","v6.0",yW),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const i=e[n];this._setAttribute(n,i)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,i);return r>=0&&(this.values[r]=n,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,n,s)),this}setConstant(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},i));return r>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[r]=n,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Fi(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Fi&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof Fi&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),r=i()}),r}_resolveLocationAndAccessor(e,n,i,r){const s={location:-1,accessor:null},{location:u,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(u)||u<0)return this.unused[e]=n,_n.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const y=this._getAttributeInfo(a||u);if(!y)return s;const w=this.accessors[u]||{},I=Pa.resolve(y.accessor,w,i,r),{size:P,type:L}=I;return tn(Number.isFinite(P)&&Number.isFinite(L)),{location:u,accessor:I}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const i=mW.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,n){if(n instanceof Fi)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof Fi){const i=n[0],r=n[1];this.setBuffer(e,i,r)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const i=n;this.setConstant(e,i)}else if(n.buffer instanceof Fi){const i=n;this.setBuffer(e,i.buffer,i)}else throw new Error(gW)}_setConstantAttributes(e,n){const i=Math.max(e|0,n|0);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,n){if(Ma.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const i=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,n){Ma.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const i=this.values[n],r=this.accessors[n];if(!i)return;const{divisor:s}=r,u=s>0;if(e.isInstanced=e.isInstanced||u,i instanceof Fi){const a=i;if(u){const y=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,y)}else{const y=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,y)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _n.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function vW(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let u=0;u<t.length&&u<n;++u)u>0&&(r+=",".concat(u%i===0?" ":"")),r+=ug(t[u],e);const s=t.length>n?"...":"]";return"".concat(r).concat(s)}function ug(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:i=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return vW(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return i?"0":"0.";if(i||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function mC(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;tn(n);const s=".*_.*",u=".*Matrix",a=n._uniformSetters,y={},w=Object.keys(a).sort();let I=0;for(const U of w)!U.match(s)&&!U.match(u)&&Ex({table:y,header:e,uniforms:i,uniformName:U,undefinedOnly:r})&&I++;for(const U of w)U.match(u)&&Ex({table:y,header:e,uniforms:i,uniformName:U,undefinedOnly:r})&&I++;for(const U of w)y[U]||Ex({table:y,header:e,uniforms:i,uniformName:U,undefinedOnly:r})&&I++;let P=0;const L={};if(!r)for(const U in i){const Q=i[U];y[U]||(P++,L[U]={Type:"NOT USED: ".concat(Q),[e]:ug(Q)})}return{table:y,count:I,unusedTable:L,unusedCount:P}}function Ex(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:s}=t;const u=i[r],a=xW(u);return!s||!a?(e[r]={[n]:a?ug(u):"N/A","Uniform Type":a?u:"NOT PROVIDED"},!0):!1}function xW(t){return t!=null}function wW(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=yC(e,e.elements,null,n));const r=e.values;for(const s in r){const u=e._getAttributeInfo(s);if(u){let a="".concat(s,": ").concat(u.name);const y=e.accessors[u.location];y&&(a="".concat(s,": ").concat(bW(u.name,y))),i[a]=yC(e,r[s],y,n)}}return i}function yC(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let s="NOT PROVIDED",u=1,a=0,y=0,w,I,P;if(n&&(s=n.type,u=n.size,s=String(s).replace("Array",""),w=s.indexOf("nt")!==-1),e instanceof Fi){const L=e,{data:U,changed:Q}=L.getDebugData();I=Q?"*":"",P=U,y=L.byteLength,a=y/U.BYTES_PER_ELEMENT/u;let Z;if(n){const ae=n.divisor>0;Z="".concat(ae?"I ":"P "," ").concat(a," (x").concat(u,"=").concat(y," bytes ").concat(jc(r,s),")")}else w=!0,Z="".concat(y," bytes");return{[i]:"".concat(I).concat(ug(P,{size:u,isInteger:w})),"Format ":Z}}return P=e,u=e.length,s=String(e.constructor.name).replace("Array",""),w=s.indexOf("nt")!==-1,{[i]:"".concat(ug(P,{size:u,isInteger:w})," (constant)"),"Format ":"".concat(u,"x").concat(s," (constant)")}}function bW(t,e){const{type:n,size:i}=e,r=ND(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function EW(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const r=_C(i);e["in ".concat(r)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const r=_C(i);e["out ".concat(r)]={[n]:JSON.stringify(i.accessor)}}return e}function _C(t){const{type:e,size:n}=t.accessor,i=ND(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}function TW(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function SW(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||TW()}const vC=SW()&&typeof document<"u";let MW=0;class CW{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=ae=>ED(ae),onAddHTML:i=null,onInitialize:r=()=>{},onRender:s=()=>{},onFinalize:u=()=>{},onError:a,gl:y=null,glOptions:w={},debug:I=!1,createFramebuffer:P=!1,autoResizeViewport:L=!0,autoResizeDrawingBuffer:U=!0,stats:Q=Mh.get("animation-loop-".concat(MW++))}=e;let{useDevicePixels:Z=!0}=e;"useDevicePixelRatio"in e&&(_n.deprecated("useDevicePixelRatio","useDevicePixels")(),Z=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:u,onError:a,gl:y,glOptions:w,debug:I,createFramebuffer:P},this.gl=y,this.needsRedraw=null,this.timeline=null,this.stats=Q,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:L,autoResizeDrawingBuffer:U,useDevicePixels:Z}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return tn(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Zy.isSupported(this.gl,["timers"])?new Zy(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),i!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=document.getElementById(e);return i?Number(i.value):n}setViewParameters(){return _n.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=vC?new Promise((e,n)=>{if(vC&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):D$(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):L$(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?tT(this.props.gl,e):this.onCreateContext(e),!h2(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");m$(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const i=this.props.onAddHTML(n);i&&(n.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&n>0&&(i=e/n),{width:e,height:n,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&w$(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new es(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const jg="vs",oT="fs";function Ra(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Tx={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function PW(t){const e={};for(const n in t){const i=t[n],r=IW(i);e[n]=r}return e}function IW(t){let e=xC(t);return e==="object"?t?"type"in t?Object.assign({},t,Tx[t.type]):"value"in t?(e=xC(t.value),Object.assign({type:e},t,Tx[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Tx[e])}function xC(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const kW="vs",LW="fs";class wC{constructor(e){let{name:n,vs:i,fs:r,dependencies:s=[],uniforms:u,getUniforms:a,deprecations:y=[],defines:w={},inject:I={},vertexShader:P,fragmentShader:L}=e;Ra(typeof n=="string"),this.name=n,this.vs=i||P,this.fs=r||L,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(y),this.defines=w,this.injections=DW(I),u&&(this.uniforms=PW(u))}getModuleSource(e){let n;switch(e){case kW:n=this.vs||"";break;case LW:n=this.fs||"";break;default:Ra(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?n.deprecated(i.old,i.new)():n.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&Ra(s.validate(e[r],s),"".concat(this.name,": invalid ").concat(r)),n[r]=e[r]):n[r]=s.value}return n}}function DW(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];const r=n.slice(0,2);typeof i=="string"&&(i={order:0,injection:i}),e[r][n]=i}return e}function RW(t){return BW(jD(t))}function BW(t){const e={},n={};return GD({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((i,r)=>n[r]-n[i]).map(i=>e[i])}function GD(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)i[s.name]=s,(r[s.name]===void 0||r[s.name]<n)&&(r[s.name]=n);for(const s of e)s.dependencies&&GD({modules:s.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function jD(t,e){return t.map(n=>(n instanceof wC||(Ra(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Ra(n.name,"shader module has no name"),n=new wC(n),n.dependencies=jD(n.dependencies)),n))}function zW(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r}const OW=7936,FW=7937,NW=7938,UW=35724,aT={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},xh={};Object.keys(aT).forEach(t=>{xh[t]=t});function VW(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function GW(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||OW),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||FW);return{gpuVendor:jW(n,i),vendor:n,renderer:i,version:t.getParameter(NW),shadingLanguageVersion:t.getParameter(UW)}}function jW(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const Sx={};function bC(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=aT[e];if(Ra(i,e),!zW(n))return!0;if(e in Sx)return Sx[e];const r=i[0],s=n.behavior||"enable",u="#extension GL_".concat(r," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,u),t.compileShader(a);const y=t.getShaderParameter(a,35713);return t.deleteShader(a),Sx[e]=y,y}function $W(t,e){const n=aT[e];Ra(n,e);const i=VW(t)&&n[1]||n[0],r=typeof i=="string"?!!t.getExtension(i):i;return Ra(r===!1||r===!0),r}function e1(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>$W(t,n))}function HW(t){switch(GW(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function WW(t,e,n){let i=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return e1(t,xh.GLSL_FRAG_DEPTH)&&(i+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),e1(t,xh.GLSL_DERIVATIVES)&&bC(t,xh.GLSL_DERIVATIVES)&&(i+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),e1(t,xh.GLSL_FRAG_DATA)&&bC(t,xh.GLSL_FRAG_DATA,{behavior:"require"})&&(i+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),e1(t,xh.GLSL_TEXTURE_LOD)&&(i+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),i}const QW=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,qW=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,ZW={[jg]:QW,[oT]:qW},Y1="__LUMA_INJECT_DECLARATIONS__",EC=/void\s+main\s*\([^)]*\)\s*\{\n?/,TC=/}\n?[^{}]*$/,Mx=[];function SC(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const r=e===jg;for(const s in n){const u=n[s];u.sort((y,w)=>y.order-w.order),Mx.length=u.length;for(let y=0,w=u.length;y<w;++y)Mx[y]=u[y].injection;const a="".concat(Mx.join(`
`),`
`);switch(s){case"vs:#decl":r&&(t=t.replace(Y1,a));break;case"vs:#main-start":r&&(t=t.replace(EC,y=>y+a));break;case"vs:#main-end":r&&(t=t.replace(TC,y=>a+y));break;case"fs:#decl":r||(t=t.replace(Y1,a));break;case"fs:#main-start":r||(t=t.replace(EC,y=>y+a));break;case"fs:#main-end":r||(t=t.replace(TC,y=>a+y));break;default:t=t.replace(s,y=>y+a)}}return t=t.replace(Y1,""),i&&(t=t.replace(/\}\s*$/,s=>s+ZW[e])),t}function kb(t){const e={};return Ra(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const i in n)e[i]=e[i]?"".concat(e[i],`
`).concat(n[i]):n[i]}),e}function Vf(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const $D=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],YW=[...$D,[Vf("attribute"),"in $1"],[Vf("varying"),"out $1"]],XW=[...$D,[Vf("varying"),"in $1"]],HD=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],KW=[...HD,[Vf("in"),"attribute $1"],[Vf("out"),"varying $1"]],JW=[...HD,[Vf("in"),"varying $1"]],Lb="gl_FragColor",Db=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,eQ=/void\s+main\s*\([^)]*\)\s*\{\n?/;function tQ(t,e,n){switch(e){case 300:return n?Yy(t,YW):nQ(t);case 100:return n?Yy(t,KW):iQ(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Yy(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}function nQ(t){t=Yy(t,XW);const e=t.match(Db);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(Lb,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(eQ,i=>"out vec4 ".concat(n,`;
`).concat(i)).replace(new RegExp("\\b".concat(Lb,"\\b"),"g"),n)}return t}function iQ(t){t=Yy(t,JW);const e=t.match(Db);if(e){const n=e[1];t=t.replace(Db,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),Lb)}return t}const rQ=`

`.concat(Y1,`

`),WD={[jg]:"vertex",[oT]:"fragment"},sQ=`precision highp float;

`;function oQ(t,e){const{vs:n,fs:i}=e,r=RW(e.modules||[]);return{gl:t,vs:MC(t,Object.assign({},e,{source:n,type:jg,modules:r})),fs:MC(t,Object.assign({},e,{source:i,type:oT,modules:r})),getUniforms:aQ(r)}}function MC(t,e){let{id:n,source:i,type:r,modules:s,defines:u={},hookFunctions:a=[],inject:y={},transpileToGLSL100:w=!1,prologue:I=!0,log:P}=e;Ra(typeof i=="string","shader source must be a string");const L=r===jg,U=i.split(`
`);let Q=100,Z="",ae=i;U[0].indexOf("#version ")===0?(Q=300,Z=U[0],ae=U.slice(1).join(`
`)):Z="#version ".concat(Q);const Y={};s.forEach(He=>{Object.assign(Y,He.getDefines())}),Object.assign(Y,u);let te=I?"".concat(Z,`
`).concat(AQ({id:n,source:i,type:r}),`
`).concat(lQ({type:r}),`
`).concat(HW(t),`
`).concat(WW(t),`
`).concat(uQ(Y),`
`).concat(L?"":sQ,`
`):"".concat(Z,`
`);const re=hQ(a),de={},ve={},Me={};for(const He in y){const Qe=typeof y[He]=="string"?{injection:y[He],order:0}:y[He],et=He.match(/^(v|f)s:(#)?([\w-]+)$/);if(et){const tt=et[2],Ve=et[3];tt?Ve==="decl"?ve[He]=[Qe]:Me[He]=[Qe]:de[He]=[Qe]}else Me[He]=[Qe]}for(const He of s){P&&He.checkDeprecations(ae,P);const Qe=He.getModuleSource(r,Q);te+=Qe;const et=He.injections[r];for(const tt in et){const Ve=tt.match(/^(v|f)s:#([\w-]+)$/);if(Ve){const Ye=Ve[2]==="decl"?ve:Me;Ye[tt]=Ye[tt]||[],Ye[tt].push(et[tt])}else de[tt]=de[tt]||[],de[tt].push(et[tt])}}return te+=rQ,te=SC(te,r,ve),te+=cQ(re[r],de),te+=ae,te=SC(te,r,Me),te=tQ(te,w?100:Q,L),te}function aQ(t){return function(n){const i={};for(const r of t){const s=r.getUniforms(n,i);Object.assign(i,s)}return i}}function lQ(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(WD[e].toUpperCase(),`
`)}function AQ(t){let{id:e,source:n,type:i}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(WD[i],`

`):""}function uQ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const i in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],`
`))}return e===0&&(n+=`
`),n}function cQ(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature,` {
`),r.header&&(n+="  ".concat(r.header)),e[i]){const s=e[i];s.sort((u,a)=>u.order-a.order);for(const u of s)n+="  ".concat(u.injection,`
`)}r.footer&&(n+="  ".concat(r.footer)),n+=`}
`}return n}function hQ(t){const e={vs:{},fs:{}};return t.forEach(n=>{let i;typeof n!="string"?(i=n,n=i.hook):i={},n=n.trim();const[r,s]=n.split(":"),u=n.replace(/\(.+/,"");e[r][u]=Object.assign(i,{signature:s})}),e}const fQ="void main() {gl_FragColor = vec4(0);}",QD=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,dQ=`#version 300 es
`.concat(QD);function qD(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,s]=n;if(!e.includes(i)||!r||!s)return null;const u=s.split(";")[0];return{qualifier:i,type:r,name:u}}function ZD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return e===300?dQ:e>300?"#version ".concat(e,`
`).concat(QD):fQ;const s=mQ(n,i);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(i," ").concat(n,`;
out vec4 `).concat(r,`;
void main() {
  `).concat(r," = ").concat(s,`;
}`):"varying ".concat(i," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function pQ(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ra(!1),null}}function gQ(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ra(!1),null}}function mQ(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Ra(!1),null}}const yQ=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,_Q={name:"fp32",vs:yQ,fs:null};function cg(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Io={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function vQ(t,{precision:e=Io.precision}={}){return t=xQ(t),"".concat(parseFloat(t.toPrecision(e)))}function Vh(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function kc(t,e,n){return bQ(t,i=>Math.max(e,Math.min(n,i)))}function BA(t,e,n){return Vh(t)?t.map((i,r)=>BA(i,e[r],n)):n*e+(1-n)*t}function Du(t,e,n){const i=Io.EPSILON;n&&(Io.EPSILON=n);try{if(t===e)return!0;if(Vh(t)&&Vh(e)){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!Du(t[r],e[r]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Io.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Io.EPSILON=i}}function xQ(t){return Math.round(t/Io.EPSILON)*Io.EPSILON}function wQ(t){return t.clone?t.clone():new Array(t.length)}function bQ(t,e,n){if(Vh(t)){const i=t;n=n||wQ(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}function EQ(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class lT extends EQ(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+n];return this.check()}toArray(e=[],n=0){for(let i=0;i<this.ELEMENTS;++i)e[n+i]=this[i];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Vh(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Io)}formatString(e){let n="";for(let i=0;i<this.ELEMENTS;++i)n+=(i>0?", ":"")+vQ(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Du(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,i){if(i===void 0)return this.lerp(this,e,n);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(n[r]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),n[i]);return this.check()}add(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=n[i];return this.check()}subtract(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=n[i];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Io.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),n);return this.check()}get elements(){return this}}function TQ(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function ji(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Np(t,e,n=""){if(Io.debug&&!TQ(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class YD extends lT{get x(){return this[0]}set x(e){this[0]=ji(e)}get y(){return this[1]}set y(e){this[1]=ji(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];n+=r*r}return ji(n)}dot(e){let n=0;for(let i=0;i<this.ELEMENTS;++i)n+=this[i]*e[i];return ji(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=n[i];return this.check()}divide(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=n[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return cg(e>=0&&e<this.ELEMENTS,"index is out of range"),ji(this[e])}setComponent(e,n){return cg(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var Up=1e-6,tA=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function SQ(){var t=new tA(2);return tA!=Float32Array&&(t[0]=0,t[1]=0),t}function Rb(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function MQ(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function CQ(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function PQ(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function IQ(t,e){return t[0]=-e[0],t[1]=-e[1],t}function XD(t,e,n,i){var r=e[0],s=e[1];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t}function kQ(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}function LQ(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}var DQ=MQ;(function(){var t=SQ();return function(e,n,i,r,s,u){var a,y;for(n||(n=2),i||(i=0),r?y=Math.min(r*n+i,e.length):y=e.length,a=i;a<y;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,u),e[a]=t[0],e[a+1]=t[1];return e}})();function RQ(t,e,n){const i=e[0],r=e[1],s=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/s,t[1]=(n[1]*i+n[5]*r)/s,t}function KD(t,e,n){const i=e[0],r=e[1],s=e[2],u=n[3]*i+n[7]*r+n[11]*s||1;return t[0]=(n[0]*i+n[4]*r+n[8]*s)/u,t[1]=(n[1]*i+n[5]*r+n[9]*s)/u,t[2]=(n[2]*i+n[6]*r+n[10]*s)/u,t}function BQ(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t}function zQ(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t[3]=e[3],t}function JD(t,e,n){const i=e[0],r=e[1],s=e[2];return t[0]=n[0]*i+n[3]*r+n[6]*s,t[1]=n[1]*i+n[4]*r+n[7]*s,t[2]=n[2]*i+n[5]*r+n[8]*s,t[3]=e[3],t}function eR(){var t=new tA(3);return tA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function OQ(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function CC(t,e,n){var i=new tA(3);return i[0]=t,i[1]=e,i[2]=n,i}function FQ(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function NQ(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.hypot(n,i,r)}function UQ(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function VQ(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function GQ(t,e){var n=e[0],i=e[1],r=e[2],s=n*n+i*i+r*r;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function tR(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function X1(t,e,n){var i=e[0],r=e[1],s=e[2],u=n[0],a=n[1],y=n[2];return t[0]=r*y-s*a,t[1]=s*u-i*y,t[2]=i*a-r*u,t}function jQ(t,e,n,i){var r=e[0],s=e[1],u=e[2];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=u+i*(n[2]-u),t}function AT(t,e,n){var i=e[0],r=e[1],s=e[2],u=n[3]*i+n[7]*r+n[11]*s+n[15];return u=u||1,t[0]=(n[0]*i+n[4]*r+n[8]*s+n[12])/u,t[1]=(n[1]*i+n[5]*r+n[9]*s+n[13])/u,t[2]=(n[2]*i+n[6]*r+n[10]*s+n[14])/u,t}function nR(t,e,n){var i=e[0],r=e[1],s=e[2];return t[0]=i*n[0]+r*n[3]+s*n[6],t[1]=i*n[1]+r*n[4]+s*n[7],t[2]=i*n[2]+r*n[5]+s*n[8],t}function iR(t,e,n){var i=n[0],r=n[1],s=n[2],u=n[3],a=e[0],y=e[1],w=e[2],I=r*w-s*y,P=s*a-i*w,L=i*y-r*a,U=r*L-s*P,Q=s*I-i*L,Z=i*P-r*I,ae=u*2;return I*=ae,P*=ae,L*=ae,U*=2,Q*=2,Z*=2,t[0]=a+I+U,t[1]=y+P+Q,t[2]=w+L+Z,t}function $Q(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function HQ(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function WQ(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function QQ(t,e){var n=t[0],i=t[1],r=t[2],s=e[0],u=e[1],a=e[2],y=Math.sqrt(n*n+i*i+r*r),w=Math.sqrt(s*s+u*u+a*a),I=y*w,P=I&&tR(t,e)/I;return Math.acos(Math.min(Math.max(P,-1),1))}var rR=FQ,qQ=NQ,sR=OQ,Cx=UQ;(function(){var t=eR();return function(e,n,i,r,s,u){var a,y;for(n||(n=3),i||(i=0),r?y=Math.min(r*n+i,e.length):y=e.length,a=i;a<y;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,u),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const Px=[0,0,0];let t1;class ln extends YD{static get ZERO(){return t1||(t1=new ln(0,0,0),Object.freeze(t1)),t1}constructor(e=0,n=0,i=0){super(-0,-0,-0),arguments.length===1&&Vh(e)?this.copy(e):(Io.debug&&(ji(e),ji(n),ji(i)),this[0]=e,this[1]=n,this[2]=i)}set(e,n,i){return this[0]=e,this[1]=n,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Io.debug&&(ji(e.x),ji(e.y),ji(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=ji(e)}angle(e){return QQ(this,e)}cross(e){return X1(this,this,e),this.check()}rotateX({radians:e,origin:n=Px}){return $Q(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Px}){return HQ(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Px}){return WQ(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return AT(this,this,e),this.check()}transformAsVector(e){return KD(this,this,e),this.check()}transformByMatrix3(e){return nR(this,this,e),this.check()}transformByMatrix2(e){return BQ(this,this,e),this.check()}transformByQuaternion(e){return iR(this,this,e),this.check()}}let n1;class uT extends YD{static get ZERO(){return n1||(n1=new uT(0,0,0,0),Object.freeze(n1)),n1}constructor(e=0,n=0,i=0,r=0){super(-0,-0,-0,-0),Vh(e)&&arguments.length===1?this.copy(e):(Io.debug&&(ji(e),ji(n),ji(i),ji(r)),this[0]=e,this[1]=n,this[2]=i,this[3]=r)}set(e,n,i,r){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Io.debug&&(ji(e.x),ji(e.y),ji(e.z),ji(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=ji(e)}get w(){return this[3]}set w(e){this[3]=ji(e)}transform(e){return AT(this,this,e),this.check()}transformByMatrix3(e){return JD(this,this,e),this.check()}transformByMatrix2(e){return zQ(this,this,e),this.check()}transformByQuaternion(e){return iR(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class oR extends lT{toString(){let e="[";if(Io.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,i){return this[n*this.RANK+e]=ji(i),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)n[r]=this[i+r];return n}setColumn(e,n){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=n[r];return this}}function ZQ(){var t=new tA(9);return tA!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function YQ(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function XQ(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=e[4],a=e[5],y=e[6],w=e[7],I=e[8],P=I*u-a*w,L=-I*s+a*y,U=w*s-u*y,Q=n*P+i*L+r*U;return Q?(Q=1/Q,t[0]=P*Q,t[1]=(-I*i+r*w)*Q,t[2]=(a*i-r*u)*Q,t[3]=L*Q,t[4]=(I*n-r*y)*Q,t[5]=(-a*n+r*s)*Q,t[6]=U*Q,t[7]=(-w*n+i*y)*Q,t[8]=(u*n-i*s)*Q,t):null}function KQ(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],u=t[5],a=t[6],y=t[7],w=t[8];return e*(w*s-u*y)+n*(-w*r+u*a)+i*(y*r-s*a)}function PC(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=e[4],y=e[5],w=e[6],I=e[7],P=e[8],L=n[0],U=n[1],Q=n[2],Z=n[3],ae=n[4],Y=n[5],te=n[6],re=n[7],de=n[8];return t[0]=L*i+U*u+Q*w,t[1]=L*r+U*a+Q*I,t[2]=L*s+U*y+Q*P,t[3]=Z*i+ae*u+Y*w,t[4]=Z*r+ae*a+Y*I,t[5]=Z*s+ae*y+Y*P,t[6]=te*i+re*u+de*w,t[7]=te*r+re*a+de*I,t[8]=te*s+re*y+de*P,t}function JQ(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=e[4],y=e[5],w=e[6],I=e[7],P=e[8],L=n[0],U=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=u,t[4]=a,t[5]=y,t[6]=L*i+U*u+w,t[7]=L*r+U*a+I,t[8]=L*s+U*y+P,t}function eq(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=e[4],y=e[5],w=e[6],I=e[7],P=e[8],L=Math.sin(n),U=Math.cos(n);return t[0]=U*i+L*u,t[1]=U*r+L*a,t[2]=U*s+L*y,t[3]=U*u-L*i,t[4]=U*a-L*r,t[5]=U*y-L*s,t[6]=w,t[7]=I,t[8]=P,t}function IC(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function tq(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=n+n,a=i+i,y=r+r,w=n*u,I=i*u,P=i*a,L=r*u,U=r*a,Q=r*y,Z=s*u,ae=s*a,Y=s*y;return t[0]=1-P-Q,t[3]=I-Y,t[6]=L+ae,t[1]=I+Y,t[4]=1-w-Q,t[7]=U-Z,t[2]=L-ae,t[5]=U+Z,t[8]=1-w-P,t}var Bb;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(Bb||(Bb={}));const nq=Object.freeze([1,0,0,0,1,0,0,0,1]);class Is extends oR{static get IDENTITY(){return rq()}static get ZERO(){return iq()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Bb}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(nq)}fromObject(e){return this.check()}fromQuaternion(e){return tq(this,e),this.check()}set(e,n,i,r,s,u,a,y,w){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=s,this[5]=u,this[6]=a,this[7]=y,this[8]=w,this.check()}setRowMajor(e,n,i,r,s,u,a,y,w){return this[0]=e,this[1]=r,this[2]=a,this[3]=n,this[4]=s,this[5]=y,this[6]=i,this[7]=u,this[8]=w,this.check()}determinant(){return KQ(this)}transpose(){return YQ(this,this),this.check()}invert(){return XQ(this,this),this.check()}multiplyLeft(e){return PC(this,e,this),this.check()}multiplyRight(e){return PC(this,this,e),this.check()}rotate(e){return eq(this,this,e),this.check()}scale(e){return Array.isArray(e)?IC(this,this,e):IC(this,this,[e,e]),this.check()}translate(e){return JQ(this,this,e),this.check()}transform(e,n){let i;switch(e.length){case 2:i=kQ(n||[-0,-0],e,this);break;case 3:i=nR(n||[-0,-0,-0],e,this);break;case 4:i=JD(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Np(i,e.length),i}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let i1,r1;function iq(){return i1||(i1=new Is([0,0,0,0,0,0,0,0,0]),Object.freeze(i1)),i1}function rq(){return r1||(r1=new Is,Object.freeze(r1)),r1}function sq(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function oq(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],s=e[6],u=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=s,t[11]=e[14],t[12]=r,t[13]=u,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function zb(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=e[4],a=e[5],y=e[6],w=e[7],I=e[8],P=e[9],L=e[10],U=e[11],Q=e[12],Z=e[13],ae=e[14],Y=e[15],te=n*a-i*u,re=n*y-r*u,de=n*w-s*u,ve=i*y-r*a,Me=i*w-s*a,He=r*w-s*y,Qe=I*Z-P*Q,et=I*ae-L*Q,tt=I*Y-U*Q,Ve=P*ae-L*Z,nt=P*Y-U*Z,Ye=L*Y-U*ae,gt=te*Ye-re*nt+de*Ve+ve*tt-Me*et+He*Qe;return gt?(gt=1/gt,t[0]=(a*Ye-y*nt+w*Ve)*gt,t[1]=(r*nt-i*Ye-s*Ve)*gt,t[2]=(Z*He-ae*Me+Y*ve)*gt,t[3]=(L*Me-P*He-U*ve)*gt,t[4]=(y*tt-u*Ye-w*et)*gt,t[5]=(n*Ye-r*tt+s*et)*gt,t[6]=(ae*de-Q*He-Y*re)*gt,t[7]=(I*He-L*de+U*re)*gt,t[8]=(u*nt-a*tt+w*Qe)*gt,t[9]=(i*tt-n*nt-s*Qe)*gt,t[10]=(Q*Me-Z*de+Y*te)*gt,t[11]=(P*de-I*Me-U*te)*gt,t[12]=(a*et-u*Ve-y*Qe)*gt,t[13]=(n*Ve-i*et+r*Qe)*gt,t[14]=(Z*re-Q*ve-ae*te)*gt,t[15]=(I*ve-P*re+L*te)*gt,t):null}function aq(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],u=t[5],a=t[6],y=t[7],w=t[8],I=t[9],P=t[10],L=t[11],U=t[12],Q=t[13],Z=t[14],ae=t[15],Y=e*u-n*s,te=e*a-i*s,re=e*y-r*s,de=n*a-i*u,ve=n*y-r*u,Me=i*y-r*a,He=w*Q-I*U,Qe=w*Z-P*U,et=w*ae-L*U,tt=I*Z-P*Q,Ve=I*ae-L*Q,nt=P*ae-L*Z;return Y*nt-te*Ve+re*tt+de*et-ve*Qe+Me*He}function Lh(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=e[4],y=e[5],w=e[6],I=e[7],P=e[8],L=e[9],U=e[10],Q=e[11],Z=e[12],ae=e[13],Y=e[14],te=e[15],re=n[0],de=n[1],ve=n[2],Me=n[3];return t[0]=re*i+de*a+ve*P+Me*Z,t[1]=re*r+de*y+ve*L+Me*ae,t[2]=re*s+de*w+ve*U+Me*Y,t[3]=re*u+de*I+ve*Q+Me*te,re=n[4],de=n[5],ve=n[6],Me=n[7],t[4]=re*i+de*a+ve*P+Me*Z,t[5]=re*r+de*y+ve*L+Me*ae,t[6]=re*s+de*w+ve*U+Me*Y,t[7]=re*u+de*I+ve*Q+Me*te,re=n[8],de=n[9],ve=n[10],Me=n[11],t[8]=re*i+de*a+ve*P+Me*Z,t[9]=re*r+de*y+ve*L+Me*ae,t[10]=re*s+de*w+ve*U+Me*Y,t[11]=re*u+de*I+ve*Q+Me*te,re=n[12],de=n[13],ve=n[14],Me=n[15],t[12]=re*i+de*a+ve*P+Me*Z,t[13]=re*r+de*y+ve*L+Me*ae,t[14]=re*s+de*w+ve*U+Me*Y,t[15]=re*u+de*I+ve*Q+Me*te,t}function Xy(t,e,n){var i=n[0],r=n[1],s=n[2],u,a,y,w,I,P,L,U,Q,Z,ae,Y;return e===t?(t[12]=e[0]*i+e[4]*r+e[8]*s+e[12],t[13]=e[1]*i+e[5]*r+e[9]*s+e[13],t[14]=e[2]*i+e[6]*r+e[10]*s+e[14],t[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(u=e[0],a=e[1],y=e[2],w=e[3],I=e[4],P=e[5],L=e[6],U=e[7],Q=e[8],Z=e[9],ae=e[10],Y=e[11],t[0]=u,t[1]=a,t[2]=y,t[3]=w,t[4]=I,t[5]=P,t[6]=L,t[7]=U,t[8]=Q,t[9]=Z,t[10]=ae,t[11]=Y,t[12]=u*i+I*r+Q*s+e[12],t[13]=a*i+P*r+Z*s+e[13],t[14]=y*i+L*r+ae*s+e[14],t[15]=w*i+U*r+Y*s+e[15]),t}function cT(t,e,n){var i=n[0],r=n[1],s=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function lq(t,e,n,i){var r=i[0],s=i[1],u=i[2],a=Math.hypot(r,s,u),y,w,I,P,L,U,Q,Z,ae,Y,te,re,de,ve,Me,He,Qe,et,tt,Ve,nt,Ye,gt,Xt;return a<Up?null:(a=1/a,r*=a,s*=a,u*=a,y=Math.sin(n),w=Math.cos(n),I=1-w,P=e[0],L=e[1],U=e[2],Q=e[3],Z=e[4],ae=e[5],Y=e[6],te=e[7],re=e[8],de=e[9],ve=e[10],Me=e[11],He=r*r*I+w,Qe=s*r*I+u*y,et=u*r*I-s*y,tt=r*s*I-u*y,Ve=s*s*I+w,nt=u*s*I+r*y,Ye=r*u*I+s*y,gt=s*u*I-r*y,Xt=u*u*I+w,t[0]=P*He+Z*Qe+re*et,t[1]=L*He+ae*Qe+de*et,t[2]=U*He+Y*Qe+ve*et,t[3]=Q*He+te*Qe+Me*et,t[4]=P*tt+Z*Ve+re*nt,t[5]=L*tt+ae*Ve+de*nt,t[6]=U*tt+Y*Ve+ve*nt,t[7]=Q*tt+te*Ve+Me*nt,t[8]=P*Ye+Z*gt+re*Xt,t[9]=L*Ye+ae*gt+de*Xt,t[10]=U*Ye+Y*gt+ve*Xt,t[11]=Q*Ye+te*gt+Me*Xt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function aR(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[4],u=e[5],a=e[6],y=e[7],w=e[8],I=e[9],P=e[10],L=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*r+w*i,t[5]=u*r+I*i,t[6]=a*r+P*i,t[7]=y*r+L*i,t[8]=w*r-s*i,t[9]=I*r-u*i,t[10]=P*r-a*i,t[11]=L*r-y*i,t}function Aq(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],u=e[1],a=e[2],y=e[3],w=e[8],I=e[9],P=e[10],L=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r-w*i,t[1]=u*r-I*i,t[2]=a*r-P*i,t[3]=y*r-L*i,t[8]=s*i+w*r,t[9]=u*i+I*r,t[10]=a*i+P*r,t[11]=y*i+L*r,t}function lR(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],u=e[1],a=e[2],y=e[3],w=e[4],I=e[5],P=e[6],L=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r+w*i,t[1]=u*r+I*i,t[2]=a*r+P*i,t[3]=y*r+L*i,t[4]=w*r-s*i,t[5]=I*r-u*i,t[6]=P*r-a*i,t[7]=L*r-y*i,t}function uq(t,e){var n=e[0],i=e[1],r=e[2],s=e[4],u=e[5],a=e[6],y=e[8],w=e[9],I=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(s,u,a),t[2]=Math.hypot(y,w,I),t}function cq(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=n+n,a=i+i,y=r+r,w=n*u,I=i*u,P=i*a,L=r*u,U=r*a,Q=r*y,Z=s*u,ae=s*a,Y=s*y;return t[0]=1-P-Q,t[1]=I+Y,t[2]=L-ae,t[3]=0,t[4]=I-Y,t[5]=1-w-Q,t[6]=U+Z,t[7]=0,t[8]=L+ae,t[9]=U-Z,t[10]=1-w-P,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function hq(t,e,n,i,r,s,u){var a=1/(n-e),y=1/(r-i),w=1/(s-u);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*y,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*y,t[10]=(u+s)*w,t[11]=-1,t[12]=0,t[13]=0,t[14]=u*s*2*w,t[15]=0,t}function fq(t,e,n,i,r){var s=1/Math.tan(e/2),u;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0?(u=1/(i-r),t[10]=(r+i)*u,t[14]=2*r*i*u):(t[10]=-1,t[14]=-2*i),t}var dq=fq;function pq(t,e,n,i,r,s,u){var a=1/(e-n),y=1/(i-r),w=1/(s-u);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*w,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*y,t[14]=(u+s)*w,t[15]=1,t}var gq=pq;function mq(t,e,n,i){var r,s,u,a,y,w,I,P,L,U,Q=e[0],Z=e[1],ae=e[2],Y=i[0],te=i[1],re=i[2],de=n[0],ve=n[1],Me=n[2];return Math.abs(Q-de)<Up&&Math.abs(Z-ve)<Up&&Math.abs(ae-Me)<Up?sq(t):(I=Q-de,P=Z-ve,L=ae-Me,U=1/Math.hypot(I,P,L),I*=U,P*=U,L*=U,r=te*L-re*P,s=re*I-Y*L,u=Y*P-te*I,U=Math.hypot(r,s,u),U?(U=1/U,r*=U,s*=U,u*=U):(r=0,s=0,u=0),a=P*u-L*s,y=L*r-I*u,w=I*s-P*r,U=Math.hypot(a,y,w),U?(U=1/U,a*=U,y*=U,w*=U):(a=0,y=0,w=0),t[0]=r,t[1]=a,t[2]=I,t[3]=0,t[4]=s,t[5]=y,t[6]=P,t[7]=0,t[8]=u,t[9]=w,t[10]=L,t[11]=0,t[12]=-(r*Q+s*Z+u*ae),t[13]=-(a*Q+y*Z+w*ae),t[14]=-(I*Q+P*Z+L*ae),t[15]=1,t)}function yq(){var t=new tA(4);return tA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function _q(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function hT(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function vq(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)}function xq(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}function wq(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=n*n+i*i+r*r+s*s;return u>0&&(u=1/Math.sqrt(u)),t[0]=n*u,t[1]=i*u,t[2]=r*u,t[3]=s*u,t}function bq(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Eq(t,e,n,i){var r=e[0],s=e[1],u=e[2],a=e[3];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=u+i*(n[2]-u),t[3]=a+i*(n[3]-a),t}function ud(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*s+n[12]*u,t[1]=n[1]*i+n[5]*r+n[9]*s+n[13]*u,t[2]=n[2]*i+n[6]*r+n[10]*s+n[14]*u,t[3]=n[3]*i+n[7]*r+n[11]*s+n[15]*u,t}function Tq(t,e,n){var i=e[0],r=e[1],s=e[2],u=n[0],a=n[1],y=n[2],w=n[3],I=w*i+a*s-y*r,P=w*r+y*i-u*s,L=w*s+u*r-a*i,U=-u*i-a*r-y*s;return t[0]=I*w+U*-u+P*-y-L*-a,t[1]=P*w+U*-a+L*-u-I*-y,t[2]=L*w+U*-y+I*-a-P*-u,t[3]=e[3],t}(function(){var t=yq();return function(e,n,i,r,s,u){var a,y;for(n||(n=4),i||(i=0),r?y=Math.min(r*n+i,e.length):y=e.length,a=i;a<y;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,u),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var Ob;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Ob||(Ob={}));const Sq=45*Math.PI/180,Mq=1,Ix=.1,kx=500,Cq=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class ra extends oR{static get IDENTITY(){return Iq()}static get ZERO(){return Pq()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Ob}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,i,r,s,u,a,y,w,I,P,L,U,Q,Z,ae){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=s,this[5]=u,this[6]=a,this[7]=y,this[8]=w,this[9]=I,this[10]=P,this[11]=L,this[12]=U,this[13]=Q,this[14]=Z,this[15]=ae,this.check()}setRowMajor(e,n,i,r,s,u,a,y,w,I,P,L,U,Q,Z,ae){return this[0]=e,this[1]=s,this[2]=w,this[3]=U,this[4]=n,this[5]=u,this[6]=I,this[7]=Q,this[8]=i,this[9]=a,this[10]=P,this[11]=Z,this[12]=r,this[13]=y,this[14]=L,this[15]=ae,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Cq)}fromObject(e){return this.check()}fromQuaternion(e){return cq(this,e),this.check()}frustum(e){const{left:n,right:i,bottom:r,top:s,near:u=Ix,far:a=kx}=e;return a===1/0?kq(this,n,i,r,s,u):hq(this,n,i,r,s,u,a),this.check()}lookAt(e){const{eye:n,center:i=[0,0,0],up:r=[0,1,0]}=e;return mq(this,n,i,r),this.check()}ortho(e){const{left:n,right:i,bottom:r,top:s,near:u=Ix,far:a=kx}=e;return gq(this,n,i,r,s,u,a),this.check()}orthographic(e){const{fovy:n=Sq,aspect:i=Mq,focalDistance:r=1,near:s=Ix,far:u=kx}=e;kC(n);const a=n/2,y=r*Math.tan(a),w=y*i;return this.ortho({left:-w,right:w,bottom:-y,top:y,near:s,far:u})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}=e;return kC(n),dq(this,n,i,r,s),this.check()}determinant(){return aq(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],s=1/i[1],u=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*u,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*u,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],s=1/i[1],u=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*u,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*u,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*u,e}transpose(){return oq(this,this),this.check()}invert(){return zb(this,this),this.check()}multiplyLeft(e){return Lh(this,e,this),this.check()}multiplyRight(e){return Lh(this,this,e),this.check()}rotateX(e){return aR(this,this,e),this.check()}rotateY(e){return Aq(this,this,e),this.check()}rotateZ(e){return lR(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return lq(this,this,e,n),this.check()}scale(e){return cT(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Xy(this,this,e),this.check()}transform(e,n){return e.length===4?(n=ud(n||[-0,-0,-0,-0],e,this),Np(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:i}=e;let r;switch(i){case 2:r=LQ(n||[-0,-0],e,this);break;case 3:r=AT(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Np(r,e.length),r}transformAsVector(e,n){let i;switch(e.length){case 2:i=RQ(n||[-0,-0],e,this);break;case 3:i=KD(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Np(i,e.length),i}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,i){return this.identity().translate([e,n,i])}}let s1,o1;function Pq(){return s1||(s1=new ra([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(s1)),s1}function Iq(){return o1||(o1=new ra,Object.freeze(o1)),o1}function kC(t){if(t>Math.PI*2)throw Error("expected radians")}function kq(t,e,n,i,r,s){const u=2*s/(n-e),a=2*s/(r-i),y=(n+e)/(n-e),w=(r+i)/(r-i),I=-1,P=-1,L=-2*s;return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=y,t[9]=w,t[10]=I,t[11]=P,t[12]=0,t[13]=0,t[14]=L,t[15]=0,t}function LC(){var t=new tA(4);return tA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Lq(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function AR(t,e,n){n=n*.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function DC(t,e,n){var i=e[0],r=e[1],s=e[2],u=e[3],a=n[0],y=n[1],w=n[2],I=n[3];return t[0]=i*I+u*a+r*w-s*y,t[1]=r*I+u*y+s*a-i*w,t[2]=s*I+u*w+i*y-r*a,t[3]=u*I-i*a-r*y-s*w,t}function Dq(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],u=e[3],a=Math.sin(n),y=Math.cos(n);return t[0]=i*y+u*a,t[1]=r*y+s*a,t[2]=s*y-r*a,t[3]=u*y-i*a,t}function Rq(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],u=e[3],a=Math.sin(n),y=Math.cos(n);return t[0]=i*y-s*a,t[1]=r*y+u*a,t[2]=s*y+i*a,t[3]=u*y-r*a,t}function Bq(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],u=e[3],a=Math.sin(n),y=Math.cos(n);return t[0]=i*y+r*a,t[1]=r*y-i*a,t[2]=s*y+u*a,t[3]=u*y-s*a,t}function zq(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t}function K1(t,e,n,i){var r=e[0],s=e[1],u=e[2],a=e[3],y=n[0],w=n[1],I=n[2],P=n[3],L,U,Q,Z,ae;return U=r*y+s*w+u*I+a*P,U<0&&(U=-U,y=-y,w=-w,I=-I,P=-P),1-U>Up?(L=Math.acos(U),Q=Math.sin(L),Z=Math.sin((1-i)*L)/Q,ae=Math.sin(i*L)/Q):(Z=1-i,ae=i),t[0]=Z*r+ae*y,t[1]=Z*s+ae*w,t[2]=Z*u+ae*I,t[3]=Z*a+ae*P,t}function Oq(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],u=n*n+i*i+r*r+s*s,a=u?1/u:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=s*a,t}function Fq(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function uR(t,e){var n=e[0]+e[4]+e[8],i;if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[r*3+r]&&(r=2);var s=(r+1)%3,u=(r+2)%3;i=Math.sqrt(e[r*3+r]-e[s*3+s]-e[u*3+u]+1),t[r]=.5*i,i=.5/i,t[3]=(e[s*3+u]-e[u*3+s])*i,t[s]=(e[s*3+r]+e[r*3+s])*i,t[u]=(e[u*3+r]+e[r*3+u])*i}return t}var Nq=_q,Uq=hT,Vq=bq,Gq=Eq,jq=vq,$q=xq,cR=wq,Hq=function(){var t=eR(),e=CC(1,0,0),n=CC(0,1,0);return function(i,r,s){var u=tR(r,s);return u<-.999999?(X1(t,e,r),sR(t)<1e-6&&X1(t,n,r),GQ(t,t),AR(i,t,Math.PI),i):u>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(X1(t,r,s),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+u,cR(i,i))}}();(function(){var t=LC(),e=LC();return function(n,i,r,s,u,a){return K1(t,i,u,a),K1(e,r,s,a),K1(n,t,e,2*a*(1-a)),n}})();(function(){var t=ZQ();return function(e,n,i,r){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],cR(e,uR(e,t))}})();const Wq=[0,0,0,1];class RC extends lT{constructor(e=0,n=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,i,r){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return uR(this,e),this.check()}fromAxisRotation(e,n){return AR(this,e,n),this.check()}identity(){return Lq(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=ji(e)}get y(){return this[1]}set y(e){this[1]=ji(e)}get z(){return this[2]}set z(e){this[2]=ji(e)}get w(){return this[3]}set w(e){this[3]=ji(e)}len(){return jq(this)}lengthSquared(){return $q(this)}dot(e){return Vq(this,e)}rotationTo(e,n){return Hq(this,e,n),this.check()}add(e){return Nq(this,this,e),this.check()}calculateW(){return zq(this,this),this.check()}conjugate(){return Fq(this,this),this.check()}invert(){return Oq(this,this),this.check()}lerp(e,n,i){return i===void 0?this.lerp(this,e,n):(Gq(this,e,n,i),this.check())}multiplyRight(e){return DC(this,this,e),this.check()}multiplyLeft(e){return DC(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return Dq(this,this,e),this.check()}rotateY(e){return Rq(this,this,e),this.check()}rotateZ(e){return Bq(this,this,e),this.check()}scale(e){return Uq(this,this,e),this.check()}slerp(e,n,i){let r,s,u;switch(arguments.length){case 1:({start:r=Wq,target:s,ratio:u}=e);break;case 2:r=this,s=e,u=n;break;default:r=e,s=n,u=i}return K1(this,r,s,u),this.check()}transformVector4(e,n=new uT){return Tq(n,e,this),Np(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const hR={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},BC=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,Qq={lightSources:{}};function Lx(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function qq(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return e?r["lighting_uAmbientLight.color"]=Lx(e):r["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,u)=>{r["lighting_uPointLight[".concat(u,"].color")]=Lx(s),r["lighting_uPointLight[".concat(u,"].position")]=s.position,r["lighting_uPointLight[".concat(u,"].attenuation")]=s.attenuation||[1,0,0]}),r.lighting_uPointLightCount=n.length,i.forEach((s,u)=>{r["lighting_uDirectionalLight[".concat(u,"].color")]=Lx(s),r["lighting_uDirectionalLight[".concat(u,"].direction")]=s.direction}),r.lighting_uDirectionalLightCount=i.length,r}function fR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Qq;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:i}=t.lightSources||{};return e||n&&n.length>0||i&&i.length>0?Object.assign({},qq({ambientLight:e,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return fR({lightSources:e})}return{}}const dR={name:"lights",vs:BC,fs:BC,getUniforms:fR,defines:{MAX_LIGHTS:3}},Zq=new Uint8Array([0,255,255,255]),Yq={pickingSelectedColor:null,pickingHighlightColor:Zq,pickingActive:!1,pickingAttribute:!1};function Xq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yq;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const Kq=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,Jq=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,eZ={name:"picking",vs:Kq,fs:Jq,getUniforms:Xq},pR=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,tZ={};function nZ(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}function gR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:tZ;if(!("material"in t))return{};const{material:e}=t;return e?nZ(e):{lighting_uEnabled:!1}}const iZ={name:"gouraud-lighting",dependencies:[dR],vs:pR,defines:{LIGHTING_VERTEX:1},getUniforms:gR},rZ={name:"phong-lighting",dependencies:[dR],fs:pR,defines:{LIGHTING_FRAGMENT:1},getUniforms:gR},sZ=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,oZ={name:"transform",vs:sZ,fs:null};class $g{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new $g(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:i="",defines:r={},inject:s={},varyings:u=[],bufferMode:a=35981,transpileToGLSL100:y=!1}=e,w=this._getModuleList(e.modules),I=this._getHash(n),P=this._getHash(i),L=w.map(re=>this._getHash(re.name)).sort(),U=u.map(re=>this._getHash(re)),Q=Object.keys(r).sort(),Z=Object.keys(s).sort(),ae=[],Y=[];for(const re of Q)ae.push(this._getHash(re)),ae.push(this._getHash(r[re]));for(const re of Z)Y.push(this._getHash(re)),Y.push(this._getHash(s[re]));const te="".concat(I,"/").concat(P,"D").concat(ae.join("/"),"M").concat(L.join("/"),"I").concat(Y.join("/"),"V").concat(U.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(y?"T":"");if(!this._programCache[te]){const re=oQ(this.gl,{vs:n,fs:i,modules:w,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:y});this._programCache[te]=new UD(this.gl,{hash:te,vs:re.vs,fs:re.fs,varyings:u,bufferMode:a}),this._getUniforms[te]=re.getUniforms||(de=>{}),this._useCounts[te]=0}return this._useCounts[te]++,this._programCache[te]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,u=this._defaultModules.length;s<u;++s){const a=this._defaultModules[s],y=a.name;n[r++]=a,i[y]=!0}for(let s=0,u=e.length;s<u;++s){const a=e[s],y=a.name;i[y]||(n[r++]=a,i[y]=!0)}return n.length=r,n}}const aZ={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function lZ(t,e,n){const i={};let r=e.indices;for(const s in e.attributes){const u=e.attributes[s],a=AZ(s,n);if(s==="indices")r=u;else if(u.constant)i[a]=u.value;else{const y=u.value,w={...u};delete w.value,i[a]=[new Fi(t,y),w],uZ(s,w)}}if(r){const s=r.value||r;tn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const u={size:1,isIndexed:r.isIndexed===void 0?!0:r.isIndexed};i.indices=[new Fi(t,{data:s,target:34963}),u]}return i}function AZ(t,e){const{attributeMap:n=aZ}=e||{};return n&&n[t]||t}function uZ(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}tn(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const D0=2,cZ=1e4,hZ="Model needs drawMode and vertexCount",zC=()=>{},fZ={};class Gu{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:i=Yc("model")}=n;tn(h2(e)),this.id=i,this.gl=e,this.id=n.id||Yc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||$g.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:i,fs:r,modules:s,defines:u,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:I}=e;this.programProps={program:n,vs:i,fs:r,modules:s,defines:u,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:I},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},tn(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),hZ)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:i,fs:r,modules:s,defines:u,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:I}=e;this.programProps={program:n,vs:i,fs:r,modules:s,defines:u,inject:a,varyings:y,bufferMode:w,transpileToGLSL100:I},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return tn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return tn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=lZ(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Uf(e))return this;const n={};for(const i in e){const r=e[i];n[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return iT(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:u=this.transformFeedback,parameters:a={},vertexArray:y=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(r);let w;_n.priority>=D0&&(w=this._logDrawCallStart(D0));const I=this.vertexArray.getDrawParams(),{isIndexed:P=I.isIndexed,indexType:L=I.indexType,indexOffset:U=I.indexOffset,vertexArrayInstanced:Q=I.isInstanced}=this.props;Q&&!this.isInstanced&&_n.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:Z,instanceCount:ae}=this,{onBeforeRender:Y=zC,onAfterRender:te=zC}=this.props;Y(),this.program.setUniforms(this.uniforms);const re=this.program.draw(Object.assign(fZ,e,{logPriority:w,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:y,transformFeedback:u,isIndexed:P,indexType:L,isInstanced:Z,instanceCount:ae,offset:P?U:0}));return te(),_n.priority>=D0&&this._logDrawCallEnd(w,y,i),re}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),n&&(s=Object.assign({},s,{35977:n})),r.forEach(u=>u.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(u=>u.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return _n.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:u,defines:a,varyings:y,bufferMode:w,transpileToGLSL100:I}=this.programProps;n=this.programManager.get({vs:i,fs:r,modules:s,inject:u,defines:a,varyings:y,bufferMode:w,transpileToGLSL100:I}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}tn(n instanceof UD,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new _W(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof Fi&&n.delete()}}_setAnimationProps(e){this.animated&&tn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Uf(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new VD(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:cZ;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),_n.group(D0,">>> DRAWING MODEL ".concat(this.id),{collapsed:_n.level<=2})(),e}_logDrawCallEnd(e,n,i,r){if(e===void 0)return;const s=wW({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:u,unusedTable:a,unusedCount:y}=mC({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:w,count:I}=mC({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});I>0&&_n.log("MISSING UNIFORMS",Object.keys(w))(),y>0&&_n.log("UNUSED UNIFORMS",Object.keys(a))();const P=EW(this.vertexArray.configuration);_n.table(e,s)(),_n.table(e,u)(),_n.table(e+1,P)(),r&&r.log({logLevel:D0,message:"Rendered to ".concat(r.id)}),_n.groupEnd(D0)()}}class dZ{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=n;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],i=e?n[e]:null;return i?i instanceof Fi?i:i.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,i=this.getBuffer(n);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&tn(ui(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in n&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if(typeof s=="string"){const u=n[s],{byteLength:a,usage:y,accessor:w}=u;i[r]=this._createNewBuffer(r,{byteLength:a,usage:y,accessor:w})}}return i}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:i})}_setupTransformFeedback(e,n){let{model:i}=n;const{program:r}=i;e.transformFeedback=new VD(this.gl,{program:r,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:n,feedbackBuffers:i})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];n[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],tn(i[s]instanceof Fi)}return{sourceBuffers:n,feedbackBuffers:i}}_createNewBuffer(e,n){const i=new Fi(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}const pZ="transform_uSampler_",Ky="transform_uSize_",OC="transform_position";function gZ(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t,u=Object.keys(n).length,a=null;const y={};let w=e,I={};if(u>0||i){const P=w.split(`
`),L=P.slice();if(P.forEach((U,Q,Z)=>{if(u>0){const ae=xZ(U,n);if(ae){const{updatedLine:Y,inject:te}=ae;L[Q]=Y,I=kb([I,te]),Object.assign(y,ae.samplerTextureMap),u--}}i&&!a&&(a=vZ(U,i))}),i){tn(r);const U="".concat(Ky).concat(i),Q="uniform vec2 ".concat(U,`;
`),Z="     vec2 ".concat(OC," = transform_getPos(").concat(U,`);
     gl_Position = vec4(`).concat(OC,`, 0, 1.);
`);I=kb([I,{"vs:#decl":Q,"vs:#main-start":Z}])}w=L.join(`
`)}return{vs:w,targetTextureType:a,inject:I,samplerTextureMap:y}}function mZ(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let s,u;n&&({width:s,height:u}=i,r["".concat(Ky).concat(n)]=[s,u]);for(const a in e)({width:s,height:u}=e[a]),r["".concat(Ky).concat(a)]=[s,u];return r}function yZ(t){return qD(t,["attribute","in"])}function _Z(t){const e="".concat(pZ).concat(t),n="".concat(Ky).concat(t),i="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:i}}function vZ(t,e){const n=qD(t,["varying","out"]);return n&&n.name===e?n.type:null}function xZ(t,e){const n={},i=yZ(t);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const u="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:y,uniformDeclerations:w}=_Z(s),I=pQ(r),P="  ".concat(r," ").concat(s," = transform_getInput(").concat(a,", ").concat(y,").").concat(I,`;
`);return n[a]=s,{updatedLine:u,inject:{"vs:#decl":w,"vs:#main-start":P},samplerTextureMap:n}}return null}const wZ={10241:9728,10240:9728,10242:33071,10243:33071},bZ="transform_output";class EZ{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],u=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),y=Object.assign({},e.parameters);let w=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){u.transform_elementID=this.elementIDBuffer;for(const P in this.samplerTextureMap){const L=this.samplerTextureMap[P];a[P]=i[L]}this._setSourceTextureParameters();const I=mZ({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,I)}return this.hasTargetTexture&&(w=!1,y.viewport=[0,0,r.width,r.height]),{attributes:u,framebuffer:r,uniforms:a,discard:w,parameters:y}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],i=d2(n);if(!e)return i;const r=i.constructor,s=gQ(this.targetTextureType),u=new r(i.length*s/4);let a=0;for(let y=0;y<i.length;y+=4)for(let w=0;w<s;w++)u[a++]=i[y+w];return u}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:i}=e;if(i instanceof oa)return i;const r=n[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new Fi(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:n,targetTexture:i})}}_updateBinding(e,n){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:u,height:a}=s,{framebuffer:y}=e;y?(y.update({attachments:{36064:s},resizeAttachments:!1}),y.resize({width:u,height:a})):e.framebuffer=new es(this.gl,{id:"transform-framebuffer",width:u,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const i in n)n[i].setParameters(wZ)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const i=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:i}}_createNewTexture(e){const n=lH(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:u,inject:a,samplerTextureMap:y}=gZ({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),w=kb([e.inject||{},a]);this.targetTextureType=u,this.samplerTextureMap=y;const I=e._fs||ZD({version:FD(r),input:this.targetTextureVarying,inputType:u,output:bZ}),P=this.hasSourceTextures||this.targetTextureVarying?[oZ].concat(e.modules||[]):e.modules;return{vs:r,fs:I,modules:P,uniforms:s,inject:w}}}let fT=class{static isSupported(e){return ui(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:i}=this;e&&e.delete(),n&&n.delete(),i&&i.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,i=this._updateDrawOptions(e);n&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=e||i.swap();tn(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)i.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Gu(n,Object.assign({},e,{fs:e.fs||ZD({version:FD(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=r.updateModelProps(n);return n}_buildResourceTransforms(e,n){TZ(n)&&(this.bufferTransform=new dZ(e,n)),SZ(n)&&(this.textureTransform=new EZ(e,n)),tn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=Object.assign(n,r.getDrawOptions(n));return n}};function TZ(t){return!!(!Uf(t.feedbackBuffers)||!Uf(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function SZ(t){return!!(!Uf(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const FC={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Ru{static get DRAW_MODE(){return FC}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Yc("geometry"),drawMode:i=FC.TRIANGLES,attributes:r={},indices:s=null,vertexCount:u=null}=e;this.id=n,this.drawMode=i|0,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=u||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,tn(ArrayBuffer.isView(r.value),"".concat(this._print(i),": must be typed array or object with value as typed array")),(i==="POSITION"||i==="positions")&&!r.size&&(r.size=3),i==="indices"?(tn(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let i=1/0;for(const r in e){const s=e[r],{value:u,size:a,constant:y}=s;!y&&u&&a>=1&&(i=Math.min(i,u.length/a))}return tn(Number.isFinite(i)),i}}let MZ=1,CZ=1;class mR{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,u=MZ++,a={time:0,delay:n,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(u,a),u}removeChannel(e){this.channels.delete(e);for(const[n,i]of this.animations)i.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const r of n)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:u}=r;s.setTime(this.getTime(u))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const i=CZ++;return this.animations.set(i,{animation:e,channel:n}),e.setTime(this.getTime(n)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const i=n-e.delay,r=e.duration*e.repeat;i>=r?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}const PZ=[255,255,255],IZ=1;let kZ=0;class yR{constructor(e={}){oe(this,"id",void 0),oe(this,"color",void 0),oe(this,"intensity",void 0),oe(this,"type","ambient");const{color:n=PZ}=e,{intensity:i=IZ}=e;this.id=e.id||"ambient-".concat(kZ++),this.color=n,this.intensity=i}}const LZ=[255,255,255],DZ=1,RZ=[0,0,-1];let BZ=0;class Fb{constructor(e={}){oe(this,"id",void 0),oe(this,"color",void 0),oe(this,"intensity",void 0),oe(this,"type","directional"),oe(this,"direction",void 0),oe(this,"shadow",void 0);const{color:n=LZ}=e,{intensity:i=DZ}=e,{direction:r=RZ}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(BZ++),this.color=n,this.intensity=i,this.type="directional",this.direction=new ln(r).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class zZ{constructor(e,n={id:"pass"}){oe(this,"id",void 0),oe(this,"gl",void 0),oe(this,"props",void 0);const{id:i}=n;this.id=i,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class dT extends zZ{constructor(...e){super(...e),oe(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return Vu(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:i,viewports:r,views:s,onViewportActive:u,clearStack:a=!0,clearCanvas:y=!0}=e;e.pass=e.pass||"unknown";const w=this.gl;y&&FZ(w,n),a&&(this._lastRenderIndex=-1);const I=[];for(const P of r){const L=s&&s[P.id];u?.(P);const U=this._getDrawLayerParams(P,e),Q=P.subViewports||[P];for(const Z of Q){const ae=this._drawLayersInViewport(w,{target:n,moduleParameters:i,viewport:Z,view:L,pass:e.pass,layers:e.layers},U);I.push(ae)}}return I}_getDrawLayerParams(e,{layers:n,pass:i,isPicking:r=!1,layerFilter:s,cullRect:u,effects:a,moduleParameters:y},w=!1){const I=[],P=_R(this._lastRenderIndex+1),L={layer:n[0],viewport:e,isPicking:r,renderPass:i,cullRect:u},U={};for(let Q=0;Q<n.length;Q++){const Z=n[Q],ae=this._shouldDrawLayer(Z,L,s,U),Y={shouldDrawLayer:ae};ae&&!w&&(Y.layerRenderIndex=P(Z,ae),Y.moduleParameters=this._getModuleParameters(Z,a,i,y),Y.layerParameters=this.getLayerParameters(Z,Q,e)),I[Q]=Y}return I}_drawLayersInViewport(e,{layers:n,moduleParameters:i,pass:r,target:s,viewport:u,view:a},y){const w=OZ(e,{moduleParameters:i,target:s,viewport:u});if(a&&a.props.clear){const P=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;Jl(e,{scissorTest:!0,scissor:w},()=>iT(e,P))}const I={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};Vu(e,{viewport:w});for(let P=0;P<n.length;P++){const L=n[P],{shouldDrawLayer:U,layerRenderIndex:Q,moduleParameters:Z,layerParameters:ae}=y[P];if(U&&L.props.pickable&&I.pickableCount++,L.isComposite)I.compositeCount++;else if(U){I.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,Q),Z.viewport=u;try{L._drawLayer({moduleParameters:Z,uniforms:{layerIndex:Q},parameters:ae})}catch(Y){L.raiseError(Y,"drawing ".concat(L," to ").concat(r))}}}return I}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,i){return e.props.parameters}_shouldDrawLayer(e,n,i,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let u=e.parent;for(;u;){if(!u.props.visible||!u.filterSubLayer(n))return!1;n.layer=u,u=u.parent}if(i){const a=n.layer.id;if(a in r||(r[a]=i(n)),!r[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,i,r){var s;const u=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:Nf(this.gl)});if(n)for(const y of n){var a;Object.assign(u,(a=y.getModuleParameters)===null||a===void 0?void 0:a.call(y,e))}return Object.assign(u,this.getModuleParameters(e,n),r)}}function _R(t=0,e={}){const n={},i=(r,s)=>{const u=r.props._offset,a=r.id,y=r.parent&&r.parent.id;let w;if(y&&!(y in e)&&i(r.parent,!1),y in n){const I=n[y]=n[y]||_R(e[y],e);w=I(r,s),n[a]=I}else Number.isFinite(u)?(w=u+(e[y]||0),n[a]=null):w=t;return s&&w>=t&&(t=w+1),e[a]=w,w};return i}function OZ(t,{moduleParameters:e,target:n,viewport:i}){const r=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||Nf(t),u=r?n.height:t.drawingBufferHeight,a=i;return[a.x*s,u-(a.y+a.height)*s,a.width*s,a.height*s]}function FZ(t,e){const n=e?e.width:t.drawingBufferWidth,i=e?e.height:t.drawingBufferHeight;Vu(t,{viewport:[0,0,n,i]}),t.clear(16640)}class NZ extends dT{constructor(e,n){super(e,n),oe(this,"shadowMap",void 0),oe(this,"depthBuffer",void 0),oe(this,"fbo",void 0),this.shadowMap=new oa(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new K0(e,{format:33189,width:1,height:1}),this.fbo=new es(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;Jl(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=Nf(this.gl),s=i.width*r,u=i.height*r;(s!==n.width||u!==n.height)&&n.resize({width:s,height:u}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const vR="#define SMOOTH_EDGE_RADIUS 0.5",UZ=`
`.concat(vR,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),VZ=`
`.concat(vR,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),GZ={name:"geometry",vs:UZ,fs:VZ},jZ=Object.keys(Ai).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Ai[t],";")).join(""),$Z=Object.keys(Wl).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(Wl[t],";")).join(""),HZ=Object.keys(Nh).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Nh[t],";")).join(""),WZ="".concat(jZ,`
`).concat($Z,`
`).concat(HZ,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function QZ(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function Hg(t){let e={},n;return i=>{for(const r in i)if(!QZ(i[r],e[r])){n=t(i),e=i;break}return n}}const NC=[0,0,0,0],qZ=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],xR=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ZZ=[0,0,0],wR=[0,0,0],YZ=Hg(JZ);function bR(t,e,n=wR){n.length<3&&(n=[n[0],n[1],0]);let i=n,r,s=!0;switch(e===Ai.LNGLAT_OFFSETS||e===Ai.METER_OFFSETS?r=n:r=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Wl.WEB_MERCATOR:(e===Ai.LNGLAT||e===Ai.CARTESIAN)&&(r=[0,0,0],s=!1);break;case Wl.WEB_MERCATOR_AUTO_OFFSET:e===Ai.LNGLAT?i=r:e===Ai.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case Wl.IDENTITY:i=t.position.map(Math.fround),i[2]=i[2]||0;break;case Wl.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}function XZ(t,e,n){const{viewMatrixUncentered:i,projectionMatrix:r}=t;let{viewMatrix:s,viewProjectionMatrix:u}=t,a=NC,y=NC,w=t.cameraPosition;const{geospatialOrigin:I,shaderCoordinateOrigin:P,offsetMode:L}=bR(t,e,n);return L&&(y=t.projectPosition(I||P),w=[w[0]-y[0],w[1]-y[1],w[2]-y[2]],y[3]=1,a=ud([],y,u),s=i||s,u=Lh([],r,s),u=Lh([],u,qZ)),{viewMatrix:s,viewProjectionMatrix:u,projectionCenter:a,originCommon:y,cameraPosCommon:w,shaderCoordinateOrigin:P,geospatialOrigin:I}}function KZ({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=Ai.DEFAULT,coordinateOrigin:r=wR,autoWrapLongitude:s=!1}){i===Ai.DEFAULT&&(i=t.isGeospatial?Ai.LNGLAT:Ai.CARTESIAN);const u=YZ({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return u.project_uWrapLongitude=s,u.project_uModelMatrix=n||xR,u}function JZ({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:u,cameraPosCommon:a,shaderCoordinateOrigin:y,geospatialOrigin:w}=XZ(t,n,i),I=t.getDistanceScales(),P=[t.width*e,t.height*e],L=ud([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,U={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:y,project_uCommonOrigin:u.slice(0,3),project_uCenter:r,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:P,project_uDevicePixelRatio:e,project_uFocalDistance:L,project_uCommonUnitsPerMeter:I.unitsPerMeter,project_uCommonUnitsPerWorldUnit:I.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:ZZ,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:xR,project_uCameraPosition:a};if(w){const Q=t.getDistanceScales(w);switch(n){case Ai.METER_OFFSETS:U.project_uCommonUnitsPerWorldUnit=Q.unitsPerMeter,U.project_uCommonUnitsPerWorldUnit2=Q.unitsPerMeter2;break;case Ai.LNGLAT:case Ai.LNGLAT_OFFSETS:t._pseudoMeters||(U.project_uCommonUnitsPerMeter=Q.unitsPerMeter),U.project_uCommonUnitsPerWorldUnit=Q.unitsPerDegree,U.project_uCommonUnitsPerWorldUnit2=Q.unitsPerDegree2;break;case Ai.CARTESIAN:U.project_uCommonUnitsPerWorldUnit=[1,1,Q.unitsPerMeter[2]],U.project_uCommonUnitsPerWorldUnit2=[0,0,Q.unitsPerMeter2[2]];break}}return U}const eY={};function tY(t=eY){return"viewport"in t?KZ(t):{}}const pT={name:"project",dependencies:[_Q,GZ],vs:WZ,getUniforms:tY};function nY(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function xf(t,e){const n=ud([],e,t);return hT(n,n,1/n[3]),n}function UC(t,e){const n=t%e;return n<0?e+n:n}function iY(t,e,n){return n*e+(1-n)*t}function Nb(t,e,n){return t<e?e:t>n?n:t}function rY(t){return Math.log(t)*Math.LOG2E}const gT=Math.log2||rY;function ju(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Ql=Math.PI,ER=Ql/4,fl=Ql/180,Ub=180/Ql,Gf=512,Jy=4003e4,a1=85.051129,sY=1.5;function VC(t){return Math.pow(2,t)}function TR(t){return gT(t)}function GA(t){const[e,n]=t;ju(Number.isFinite(e)),ju(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=e*fl,r=n*fl,s=Gf*(i+Ql)/(2*Ql),u=Gf*(Ql+Math.log(Math.tan(ER+r*.5)))/(2*Ql);return[s,u]}function Gh(t){const[e,n]=t,i=e/Gf*(2*Ql)-Ql,r=2*(Math.atan(Math.exp(n/Gf*(2*Ql)-Ql))-ER);return[i*Ub,r*Ub]}function oY(t){const{latitude:e}=t;ju(Number.isFinite(e));const n=Math.cos(e*fl);return TR(Jy*n)-9}function Dx(t){const e=Math.cos(t*fl);return Gf/Jy/e}function Vb(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;ju(Number.isFinite(e)&&Number.isFinite(n));const r=Gf,s=Math.cos(e*fl),u=r/360,a=u/s,y=r/Jy/s,w={unitsPerMeter:[y,y,y],metersPerUnit:[1/y,1/y,1/y],unitsPerDegree:[u,a,y],degreesPerUnit:[1/u,1/a,1/y]};if(i){const I=fl*Math.tan(e*fl)/s,P=u*I/2,L=r/Jy*I,U=L/a*y;w.unitsPerDegree2=[0,P,L],w.unitsPerMeter2=[U,0,U]}return w}function SR(t,e){const[n,i,r]=t,[s,u,a]=e,{unitsPerMeter:y,unitsPerMeter2:w}=Vb({longitude:n,latitude:i,highPrecision:!0}),I=GA(t);I[0]+=s*(y[0]+w[0]*u),I[1]+=u*(y[1]+w[1]*u);const P=Gh(I),L=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[P[0],P[1],L]:P}function aY(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:s,center:u}=t,a=nY();Xy(a,a,[0,0,-r]),aR(a,a,-n*fl),lR(a,a,i*fl);const y=s/e;return cT(a,a,[y,y,y]),u&&Xy(a,a,VQ([],u)),a}function lY(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:s,center:u,scale:a,nearZMultiplier:y=1,farZMultiplier:w=1}=t;let{fovy:I=e_(sY)}=t;i!==void 0&&(I=e_(i));const P=I*fl,L=r*fl,U=MR(I);let Q=U;u&&(Q+=u[2]*a/Math.cos(L)/n);const Z=P*(.5+(s?s[1]:0)/n),ae=Math.sin(Z)*Q/Math.sin(Nb(Math.PI/2-L-Z,.01,Math.PI-.01)),Y=Math.sin(L)*ae+Q,te=Q*10,re=Math.min(Y*w,te);return{fov:P,aspect:e/n,focalDistance:U,near:y,far:re}}function e_(t){return 2*Math.atan(.5/t)*Ub}function MR(t){return .5/Math.tan(.5*t*fl)}function CR(t,e){const[n,i,r=0]=t;return ju(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),xf(e,[n,i,r,1])}function mT(t,e,n=0){const[i,r,s]=t;if(ju(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return xf(e,[i,r,s,1]);const u=xf(e,[i,r,0,1]),a=xf(e,[i,r,1,1]),y=u[2],w=a[2],I=y===w?0:((n||0)-y)/(w-y);return XD([],u,a,I)}function AY(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:s=24,offset:u=[0,0]}=t,[[a,y],[w,I]]=i,P=uY(t.padding),L=GA([a,Nb(I,-a1,a1)]),U=GA([w,Nb(y,-a1,a1)]),Q=[Math.max(Math.abs(U[0]-L[0]),r),Math.max(Math.abs(U[1]-L[1]),r)],Z=[e-P.left-P.right-Math.abs(u[0])*2,n-P.top-P.bottom-Math.abs(u[1])*2];ju(Z[0]>0&&Z[1]>0);const ae=Z[0]/Q[0],Y=Z[1]/Q[1],te=(P.right-P.left)/2/ae,re=(P.top-P.bottom)/2/Y,de=[(U[0]+L[0])/2+te,(U[1]+L[1])/2+re],ve=Gh(de),Me=Math.min(s,gT(Math.abs(Math.min(ae,Y))));return ju(Number.isFinite(Me)),{longitude:ve[0],latitude:ve[1],zoom:Me}}function uY(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(ju(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const GC=Math.PI/180;function cY(t,e=0){const{width:n,height:i,unproject:r}=t,s={targetZ:e},u=r([0,i],s),a=r([n,i],s);let y,w;const I=t.fovy?.5*t.fovy*GC:Math.atan(.5/t.altitude),P=(90-t.pitch)*GC;return I>P-.01?(y=jC(t,0,e),w=jC(t,n,e)):(y=r([0,0],s),w=r([n,0],s)),[u,a,w,y]}function jC(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=xf(i,[e,0,1,1]),s=xf(i,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2]),y=XD([],r,s,a),w=Gh(y);return w.push(n),w}const $C=512;function hY(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:s,zoom:u,bearing:a=0}=t;(r<-180||r>180)&&(r=UC(r+180,360)-180),(a<-180||a>180)&&(a=UC(a+180,360)-180);const y=gT(n/$C);if(u<=y)u=y,s=0;else{const w=n/2/Math.pow(2,u),I=Gh([0,w])[1];if(s<I)s=I;else{const P=Gh([0,$C-w])[1];s>P&&(s=P)}}return{width:e,height:n,longitude:r,latitude:s,zoom:u,pitch:i,bearing:a}}const PR=.01,fY=["longitude","latitude","zoom"],IR={curve:1.414,speed:1.2};function dY(t,e,n,i){const{startZoom:r,startCenterXY:s,uDelta:u,w0:a,u1:y,S:w,rho:I,rho2:P,r0:L}=kR(t,e,i);if(y<PR){const de={};for(const ve of fY){const Me=t[ve],He=e[ve];de[ve]=iY(Me,He,n)}return de}const U=n*w,Q=Math.cosh(L)/Math.cosh(L+I*U),Z=a*((Math.cosh(L)*Math.tanh(L+I*U)-Math.sinh(L))/P)/y,ae=1/Q,Y=r+TR(ae),te=CQ([],u,Z);Rb(te,te,s);const re=Gh(te);return{longitude:re[0],latitude:re[1],zoom:Y}}function pY(t,e,n){const i={...IR,...n},{screenSpeed:r,speed:s,maxDuration:u}=i,{S:a,rho:y}=kR(t,e,i),w=1e3*a;let I;return Number.isFinite(r)?I=w/(r/y):I=w/s,Number.isFinite(u)&&I>u?0:I}function kR(t,e,n){n=Object.assign({},IR,n);const i=n.curve,r=t.zoom,s=[t.longitude,t.latitude],u=VC(r),a=e.zoom,y=[e.longitude,e.latitude],w=VC(a-r),I=GA(s),P=GA(y),L=DQ([],P,I),U=Math.max(t.width,t.height),Q=U/w,Z=PQ(L)*u,ae=Math.max(Z,PR),Y=i*i,te=(Q*Q-U*U+Y*Y*ae*ae)/(2*U*Y*ae),re=(Q*Q-U*U-Y*Y*ae*ae)/(2*Q*Y*ae),de=Math.log(Math.sqrt(te*te+1)-te),ve=Math.log(Math.sqrt(re*re+1)-re),Me=(ve-de)/i;return{startZoom:r,startCenterXY:I,uDelta:L,w0:U,u1:Z,S:Me,rho:i,rho2:Y,r0:de,r1:ve}}const gY=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,mY=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,yY=Hg(bY),_Y=Hg(EY),vY=[0,0,0,1],xY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function wY(t,e){const[n,i,r]=t,s=mT([n,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}function bY({viewport:t,center:e}){return new ra(t.viewProjectionMatrix).invert().transform(e)}function EY({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,s=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(u=>wY(u,i));for(const u of e){const a=u.clone().translate(new ln(t.center).negate()),y=s.map(I=>a.transform(I)),w=new ra().ortho({left:Math.min(...y.map(I=>I[0])),right:Math.max(...y.map(I=>I[0])),bottom:Math.min(...y.map(I=>I[1])),top:Math.max(...y.map(I=>I[1])),near:Math.min(...y.map(I=>-I[2])),far:Math.max(...y.map(I=>-I[2]))});n.push(w.multiplyRight(u))}return n}function TY(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||vY,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=yY({viewport:t.viewport,center:e.project_uCenter}),s=[],u=_Y({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const y=u[a],w=y.clone().translate(new ln(t.viewport.center).negate());e.project_uCoordinateSystem===Ai.LNGLAT&&e.project_uProjectionMode===Wl.WEB_MERCATOR?(u[a]=w,s[a]=r):(u[a]=y.clone().multiplyRight(xY),s[a]=w.transform(r))}for(let a=0;a<u.length;a++)i["shadow_uViewProjectionMatrices[".concat(a,"]")]=u[a],i["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?i["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:i["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return i}const Rx={name:"shadow",dependencies:[pT],vs:gY,fs:mY,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?TY(t,e):{}},SY={color:[255,255,255],intensity:1},HC=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],MY=[0,0,0,200/255];class yT{constructor(e={}){oe(this,"id","lighting-effect"),oe(this,"props",void 0),oe(this,"shadowColor",MY),oe(this,"shadow",void 0),oe(this,"ambientLight",void 0),oe(this,"directionalLights",void 0),oe(this,"pointLights",void 0),oe(this,"shadowPasses",[]),oe(this,"shadowMaps",[]),oe(this,"dummyShadowMap",null),oe(this,"programManager",void 0),oe(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const i=e[n];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:i,viewports:r,onViewportActive:s,views:u}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=$g.getDefaultProgramManager(e),Rx&&this.programManager.addDefaultModule(Rx)),this.dummyShadowMap||(this.dummyShadowMap=new oa(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:i,viewports:r,onViewportActive:s,views:u,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Rx),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const i=new ra().lookAt({eye:new ln(n.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const i=new NZ(e);this.shadowPasses[n]=i,this.shadowMaps[n]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:i}=this;!e&&n.length===0&&i.length===0&&(this.ambientLight=new yR(SY),this.directionalLights.push(new Fb(HC[0]),new Fb(HC[1])))}}class CY{constructor(e={}){oe(this,"_pool",[]),oe(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:i=1,type:r,padding:s=0,copy:u=!1,initialize:a=!1,maxCount:y}){const w=r||e&&e.constructor||Float32Array,I=n*i+s;if(ArrayBuffer.isView(e)){if(I<=e.length)return e;if(I*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new w(e.buffer,0,I)}let P=1/0;y&&(P=y*i+s);const L=this._allocate(w,I,a,P);return e&&u?L.set(e):a||L.fill(0,0,4),this._release(e),L}release(e){this._release(e)}_allocate(e,n,i,r){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>r&&(s=r);const u=this._pool,a=e.BYTES_PER_ELEMENT*s,y=u.findIndex(w=>w.byteLength>=a);if(y>=0){const w=new e(u.splice(y,1)[0],0,s);return i&&w.fill(0),w}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:i}=e,{byteLength:r}=i,s=n.findIndex(u=>u.byteLength>=r);s<0?n.push(i):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,i),n.length>this.opts.poolSize&&n.shift()}}const jf=new CY;function yp(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function PY(t){return[t[12],t[13],t[14]]}function IY(t){return{left:R0(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:R0(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:R0(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:R0(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:R0(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:R0(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const WC=new ln;function R0(t,e,n,i){WC.set(t,e,n);const r=WC.len();return{distance:i/r,normal:new ln(-t/r,-e/r,-n/r)}}function kY(t){return t-Math.fround(t)}let Yd;function Bx(t,e){const{size:n=1,startIndex:i=0}=e,r=e.endIndex!==void 0?e.endIndex:t.length,s=(r-i)/n;Yd=jf.allocate(Yd,s,{type:Float32Array,size:n*2});let u=i,a=0;for(;u<r;){for(let y=0;y<n;y++){const w=t[u++];Yd[a+y]=w,Yd[a+y+n]=kY(w)}a+=n*2}return Yd.subarray(0,s*n*2)}function LY(t){let e=null,n=!1;for(const i of t)i&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}const DY=Math.PI/180,RY=yp(),QC=[0,0,0],BY={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function zY({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:s,near:u,far:a}){const y=t/e,w=n?new ra().orthographic({fovy:i,aspect:y,focalDistance:r,near:u,far:a}):new ra().perspective({fovy:i,aspect:y,near:u,far:a});if(s){const{left:I=0,right:P=0,top:L=0,bottom:U=0}=s,Q=kc((I+t-P)/2,0,t)-t/2,Z=kc((L+e-U)/2,0,e)-e/2;w[8]-=Q*2/t,w[9]+=Z*2/e}return w}class s0{constructor(e={}){oe(this,"id",void 0),oe(this,"x",void 0),oe(this,"y",void 0),oe(this,"width",void 0),oe(this,"height",void 0),oe(this,"padding",void 0),oe(this,"isGeospatial",void 0),oe(this,"zoom",void 0),oe(this,"focalDistance",void 0),oe(this,"position",void 0),oe(this,"modelMatrix",void 0),oe(this,"distanceScales",void 0),oe(this,"scale",void 0),oe(this,"center",void 0),oe(this,"cameraPosition",void 0),oe(this,"projectionMatrix",void 0),oe(this,"viewMatrix",void 0),oe(this,"viewMatrixUncentered",void 0),oe(this,"viewMatrixInverse",void 0),oe(this,"viewProjectionMatrix",void 0),oe(this,"pixelProjectionMatrix",void 0),oe(this,"pixelUnprojectionMatrix",void 0),oe(this,"resolution",void 0),oe(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||BY,this.focalDistance=e.focalDistance||1,this.position=e.position||QC,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Wl.WEB_MERCATOR:Wl.WEB_MERCATOR_AUTO_OFFSET:Wl.IDENTITY}equals(e){return e instanceof s0?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Du(e.projectionMatrix,this.projectionMatrix)&&Du(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const i=this.projectPosition(e),r=CR(i,this.pixelProjectionMatrix),[s,u]=r,a=n?u:this.height-u;return e.length===2?[s,a]:[s,a,r[2]]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,s,u]=e,a=n?s:this.height-s,y=i&&i*this.distanceScales.unitsPerMeter[2],w=mT([r,a,u],this.pixelUnprojectionMatrix,y),[I,P,L]=this.unprojectPosition(w);return Number.isFinite(u)?[I,P,L]:Number.isFinite(i)?[I,P,i]:[I,P]}projectPosition(e){const[n,i]=this.projectFlat(e),r=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,i,r]}unprojectPosition(e){const[n,i]=this.unprojectFlat(e),r=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,i,r]}projectFlat(e){if(this.isGeospatial){const n=GA(e);return n[1]=kc(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?Gh(e):e}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,0],n),r=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),u=this.unproject([this.width,this.height],n);return[Math.min(i[0],r[0],s[0],u[0]),Math.min(i[1],r[1],s[1],u[1]),Math.max(i[0],r[0],s[0],u[0]),Math.max(i[1],r[1],s[1],u[1])]}getDistanceScales(e){return e?Vb({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:i=1,height:r=1}){return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+r}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,IY(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=oY({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Vb({latitude:i,longitude:n}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:s,modelMatrix:u}=e;let a=QC;if(s&&(a=u?new ra(u).transformAsVector(s,[]):s),this.isGeospatial){const y=this.projectPosition([n,i,0]);this.center=new ln(a).scale(this.distanceScales.unitsPerMeter).add(y)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=RY,projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:u=75,near:a=.1,far:y=1e3,padding:w=null,focalDistance:I=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new ra().multiplyRight(n).translate(new ln(this.center).negate()),this.projectionMatrix=i||zY({width:this.width,height:this.height,orthographic:r,fovyRadians:s||u*DY,focalDistance:I,padding:w,near:a,far:y});const P=yp();Lh(P,P,this.projectionMatrix),Lh(P,P,this.viewMatrix),this.viewProjectionMatrix=P,this.viewMatrixInverse=zb([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=PY(this.viewMatrixInverse);const L=yp(),U=yp();cT(L,L,[this.width/2,-this.height/2,1]),Xy(L,L,[1,-1,0]),Lh(U,L,this.viewProjectionMatrix),this.pixelProjectionMatrix=U,this.pixelUnprojectionMatrix=zb(yp(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||si.warn("Pixel project matrix not invertible")()}}oe(s0,"displayName","Viewport");class Xc extends s0{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,pitch:s=0,bearing:u=0,nearZMultiplier:a=.1,farZMultiplier:y=1.01,nearZ:w,farZ:I,orthographic:P=!1,projectionMatrix:L,repeat:U=!1,worldOffset:Q=0,position:Z,padding:ae,legacyMeterSizes:Y=!1}=e;let{width:te,height:re,altitude:de=1.5}=e;const ve=Math.pow(2,r);te=te||1,re=re||1;let Me,He=null;if(L)de=L[5]/2,Me=e_(de);else{e.fovy?(Me=e.fovy,de=MR(Me)):Me=e_(de);let et;if(ae){const{top:tt=0,bottom:Ve=0}=ae;et=[0,kc((tt+re-Ve)/2,0,re)-re/2]}He=lY({width:te,height:re,scale:ve,center:Z&&[0,0,Z[2]*Dx(n)],offset:et,pitch:s,fovy:Me,nearZMultiplier:a,farZMultiplier:y}),Number.isFinite(w)&&(He.near=w),Number.isFinite(I)&&(He.far=I)}let Qe=aY({height:re,pitch:s,bearing:u,scale:ve,altitude:de});Q&&(Qe=new ra().translate([512*Q,0,0]).multiplyLeft(Qe)),super({...e,width:te,height:re,viewMatrix:Qe,longitude:i,latitude:n,zoom:r,...He,fovy:Me,focalDistance:de}),oe(this,"longitude",void 0),oe(this,"latitude",void 0),oe(this,"pitch",void 0),oe(this,"bearing",void 0),oe(this,"altitude",void 0),oe(this,"fovy",void 0),oe(this,"orthographic",void 0),oe(this,"_subViewports",void 0),oe(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=i,this.zoom=r,this.pitch=s,this.bearing=u,this.altitude=de,this.fovy=Me,this.orthographic=P,this._subViewports=U?[]:null,this._pseudoMeters=Y,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let r=n;r<=i;r++){const s=r?new Xc({...this,worldOffset:r}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,i]=this.projectFlat(e),r=(e[2]||0)*Dx(e[1]);return[n,i,r]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,i]=this.unprojectFlat(e),r=(e[2]||0)/Dx(i);return[n,i,r]}addMetersToLngLat(e,n){return SR(e,n)}panByPosition(e,n){const i=mT(n,this.pixelUnprojectionMatrix),r=this.projectFlat(e),s=Rb([],r,IQ([],i)),u=Rb([],this.center,s),[a,y]=this.unprojectFlat(u);return{longitude:a,latitude:y}}getBounds(e={}){const n=cY(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:i,height:r}=this,{longitude:s,latitude:u,zoom:a}=AY({width:i,height:r,bounds:e,...n});return new Xc({width:i,height:r,longitude:s,latitude:u,zoom:a})}}oe(Xc,"displayName","WebMercatorViewport");const qC=[0,0,0];function zx(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof Xc){const[r,s,u=0]=t,a=e.getDistanceScales([r,s]);i[2]=u*a.unitsPerMeter[2]}return i}function OY(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:r,fromCoordinateSystem:s,fromCoordinateOrigin:u}=t;return r===Ai.DEFAULT&&(r=e.isGeospatial?Ai.LNGLAT:Ai.CARTESIAN),s===void 0&&(s=r),u===void 0&&(u=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:u}}function LR(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[u,a,y=0]=t;switch(n&&([u,a,y]=ud([],[u,a,y,1],n)),i){case Ai.LNGLAT:return zx([u,a,y],e,s);case Ai.LNGLAT_OFFSETS:return zx([u+r[0],a+r[1],y+(r[2]||0)],e,s);case Ai.METER_OFFSETS:return zx(SR(r,[u,a,y]),e,s);case Ai.CARTESIAN:default:return e.isGeospatial?[u+r[0],a+r[1],y+r[2]]:e.projectPosition([u,a,y])}}function FY(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:u,fromCoordinateOrigin:a}=OY(e),{autoOffset:y=!0}=e,{geospatialOrigin:w=qC,shaderCoordinateOrigin:I=qC,offsetMode:P=!1}=y?bR(n,i,r):{},L=LR(t,{viewport:n,modelMatrix:s,coordinateSystem:u,coordinateOrigin:a,offsetMode:P});if(P){const U=n.projectPosition(w||I);rR(L,L,U)}return L}const jh=Math.PI/180,NY=1e3*60*60*24,UY=2440588,VY=2451545,t_=jh*23.4397,GY=357.5291,jY=.98560028,$Y=280.147,HY=360.9856235;function WY(t,e,n){const i=jh*-n,r=jh*e,s=qY(t),u=nX(s),a=JY(s,i)-u.rightAscension;return{azimuth:XY(a,r,u.declination),altitude:KY(a,r,u.declination)}}function ZC(t,e,n){const{azimuth:i,altitude:r}=WY(t,e,n);return[Math.sin(i)*Math.cos(r),Math.cos(i)*Math.cos(r),-Math.sin(r)]}function QY(t){return(typeof t=="number"?t:t.getTime())/NY-.5+UY}function qY(t){return QY(t)-VY}function ZY(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(t_)-Math.tan(e)*Math.sin(t_),Math.cos(n))}function YY(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(t_)+Math.cos(e)*Math.sin(t_)*Math.sin(n))}function XY(t,e,n){const i=t,r=e,s=n;return Math.atan2(Math.sin(i),Math.cos(i)*Math.sin(r)-Math.tan(s)*Math.cos(r))}function KY(t,e,n){const i=t,r=e,s=n;return Math.asin(Math.sin(r)*Math.sin(s)+Math.cos(r)*Math.cos(s)*Math.cos(i))}function JY(t,e){return jh*($Y+HY*t)-e}function eX(t){return jh*(GY+jY*t)}function tX(t){const e=t,n=jh*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e)),i=jh*102.9372;return e+n+i+Math.PI}function nX(t){const e=eX(t),n=tX(e);return{declination:YY(n,0),rightAscension:ZY(n,0)}}class iX extends Fb{constructor(e){super(e),oe(this,"timestamp",void 0),this.timestamp=e.timestamp}getProjectedLight({layer:e}){const{viewport:n}=e.context;if(n.resolution&&n.resolution>0){const[r,s,u]=ZC(this.timestamp,0,0);this.direction=[r,-u,s]}else{const{latitude:r,longitude:s}=n;this.direction=ZC(this.timestamp,r,s)}return this}}const YC={blendFunc:[1,0,32771,0],blendEquation:32774};class DR extends dT{constructor(...e){super(...e),oe(this,"pickZ",void 0),oe(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:s,pickingFBO:u,deviceRect:{x:a,y,width:w,height:I},cullRect:P,effects:L,pass:U="picking",pickZ:Q,moduleParameters:Z}){const ae=this.gl;this.pickZ=Q;const Y=this._resetColorEncoder(Q),te=Jl(ae,{scissorTest:!0,scissor:[a,y,w,I],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...YC,blend:!Q},()=>super.render({target:u,layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:s,cullRect:P,effects:L?.filter(de=>de.useInPicking),pass:U,isPicking:!0,moduleParameters:Z}));return this._colorEncoderState=null,{decodePickingColor:Y&&sX.bind(null,Y),stats:te}}shouldDrawLayer(e){const{pickable:n,operation:i}=e.props;return n&&i.includes("draw")||i.includes("terrain")||i.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,i){const r={...e.props.parameters},{pickable:s,operation:u}=e.props;return this._colorEncoderState?s&&u.includes("draw")&&(Object.assign(r,YC),r.blend=!0,r.blendColor=rX(this._colorEncoderState,e,i)):r.blend=!1,u.includes("terrain")&&(r.blend=!1),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function rX(t,e,n){const{byLayer:i,byAlpha:r}=t;let s,u=i.get(e);return u?(u.viewports.push(n),s=u.a):(s=i.size+1,s<=255?(u={a:s,layer:e,viewports:[n]},i.set(e,u),r[s]=u):(si.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function sX(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const N0={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},n_=Symbol.for("component"),$c=Symbol.for("propTypes"),Ox=Symbol.for("deprecatedProps"),wf=Symbol.for("asyncPropDefaults"),$h=Symbol.for("asyncPropOriginal"),Lc=Symbol.for("asyncPropResolved");function p2(t,e=()=>!0){return Array.isArray(t)?RR(t,e,[]):e(t)?[t]:[]}function RR(t,e,n){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?RR(r,e,n):e(r)&&n.push(r)}return n}function oX({target:t,source:e,start:n=0,count:i=1}){const r=e.length,s=i*r;let u=0;for(let a=n;u<r;u++)t[a++]=e[u];for(;u<s;)u<s-u?(t.copyWithin(n+u,n,n+u),u*=2):(t.copyWithin(n+u,n,n+s-u),u=s);return t}function XC(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class KC{constructor(e,n){oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"sampleSize",1),oe(this,"time",void 0),oe(this,"count",void 0),oe(this,"samples",void 0),oe(this,"lastTiming",void 0),oe(this,"lastSampleTime",void 0),oe(this,"lastSampleCount",void 0),oe(this,"_count",0),oe(this,"_time",0),oe(this,"_samples",0),oe(this,"_startTime",0),oe(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=XC(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(XC()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class BR{constructor(e){oe(this,"id",void 0),oe(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:i}=e;return this.stats[n]||(e instanceof KC?this.stats[n]=e:this.stats[n]=new KC(n,i)),this.stats[n]}}class aX{constructor(e,n,i){oe(this,"id",void 0),oe(this,"context",void 0),oe(this,"isLoaded",void 0),oe(this,"persistent",void 0),oe(this,"_loadCount",0),oe(this,"_subscribers",new Set),oe(this,"_data",void 0),oe(this,"_loader",void 0),oe(this,"_error",void 0),oe(this,"_content",void 0),this.id=e,this.context=i,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const i=++this._loadCount;let r=e;typeof e=="string"&&(r=$y(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class lX{constructor({gl:e,protocol:n}){oe(this,"protocol",void 0),oe(this,"_context",void 0),oe(this,"_resources",void 0),oe(this,"_consumers",void 0),oe(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(n,i):(s=new aX(e,n,this._context),this._resources[e]=s),s.persistent=r}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const i in n){const r=n[i],s=this._resources[r.resourceId];s&&s.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:u}=this;e.startsWith(u)&&(e=e.replace(u,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,i,r){const s=this._consumers,u=s[e]=s[e]||{},a=u[n]||{},y=a.resourceId&&this._resources[a.resourceId];y&&(y.unsubscribe(a),this.prune()),i&&(u[n]=a,a.onChange=r,a.resourceId=i.id,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const AX=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,o0={name:"project32",dependencies:[pT],vs:AX},a0={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...eZ},uX=[pT],cX=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function hX(t){const e=$g.getDefaultProgramManager(t);for(const n of uX)e.addDefaultModule(n);for(const n of cX)e.addShaderHook(n);return e}const fX="layerManager.setLayers",dX="layerManager.activateViewport";class pX{constructor(e,{deck:n,stats:i,viewport:r,timeline:s}={}){oe(this,"layers",void 0),oe(this,"context",void 0),oe(this,"resourceManager",void 0),oe(this,"_lastRenderedLayers",[]),oe(this,"_needsRedraw",!1),oe(this,"_needsUpdate",!1),oe(this,"_nextLayers",null),oe(this,"_debug",!1),oe(this,"activateViewport",u=>{so(dX,this,u),u&&(this.context.viewport=u)}),this.layers=[],this.resourceManager=new lX({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&hX(e),stats:i||new BR({id:"deck.gl"}),viewport:r||new s0({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new mR,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);n=n||r}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(i=>n.id.indexOf(i)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){so(fX,this,n,e),this._lastRenderedLayers=e;const i=p2(e,Boolean);for(const r of i)r.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,i){i.raiseError(n,"".concat(e," of ").concat(i))}_updateLayers(e,n){const i={};for(const u of e)i[u.id]?si.warn("Multiple old layers with same id ".concat(u.id))():i[u.id]=u;const r=[];this._updateSublayersRecursively(n,i,r),this._finalizeOldLayers(i);let s=!1;for(const u of r)if(u.hasUniformTransition()){s="Uniform transition in ".concat(u);break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,n,i){for(const r of e){r.context=this.context;const s=n[r.id];s===null&&si.warn("Multiple new layers with same id ".concat(r.id))(),n[r.id]=null;let u=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),u=r.isComposite?r.getSubLayers():null}catch(a){this._handleError("matching",a,r)}u&&this._updateSublayersRecursively(u,n,i)}}_finalizeOldLayers(e){for(const n in e){const i=e[n];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=N0.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=N0.MATCHED,n!==e&&(e.lifecycle=N0.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=N0.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=N0.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function ql(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!ql(t[i],e[i],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(const s of i)if(!e.hasOwnProperty(s)||!ql(t[s],e[s],n-1))return!1;return!0}return!1}class gX{constructor(e){oe(this,"width",void 0),oe(this,"height",void 0),oe(this,"views",void 0),oe(this,"viewState",void 0),oe(this,"controllers",void 0),oe(this,"timeline",void 0),oe(this,"_viewports",void 0),oe(this,"_viewportMap",void 0),oe(this,"_isUpdating",void 0),oe(this,"_needsRedraw",void 0),oe(this,"_needsUpdate",void 0),oe(this,"_eventManager",void 0),oe(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,i=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,n){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const u=i[s];if(u.containsPixel(r)){const a=e.slice();return a[0]-=u.x,a[1]-=u.y,u.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=p2(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!ql(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):si.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const i=n.type;return new i({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var u;return(u=this.getView(e.id))===null||u===void 0?void 0:u.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,i,r){const s=e.controller;if(s&&i){const u={...n,...s,id:e.id,x:i.x,y:i.y,width:i.width,height:i.height};return(!r||r.constructor!==s.type)&&(r=this._createController(e,u)),r&&r.setProps(u),r}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let r=e.length;r--;){const s=e[r],u=this.getViewState(s),a=s.makeViewport({viewState:u,width:this.width,height:this.height});let y=n[s.id];const w=!!s.controller;w&&!y&&(i=!0),(i||!w)&&y&&(y.finalize(),y=null),this.controllers[s.id]=this._updateController(s,u,a,y),a&&this._viewports.unshift(a)}for(const r in n){const s=n[r];s&&!this.controllers[r]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((i,r)=>!e[r].equals(n[r]))}}const mX=/([0-9]+\.?[0-9]*)(%|px)/;function yc(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=mX.exec(t);if(e&&e.length>=3){const n=e[2]==="%",i=parseFloat(e[1]);return{position:n?i/100:i,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function _c(t,e){return t.relative?Math.round(t.position*e):t.position}function gs(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class $f{constructor(e){oe(this,"id",void 0),oe(this,"viewportInstance",void 0),oe(this,"_x",void 0),oe(this,"_y",void 0),oe(this,"_width",void 0),oe(this,"_height",void 0),oe(this,"_padding",void 0),oe(this,"props",void 0);const{id:n,x:i=0,y:r=0,width:s="100%",height:u="100%",padding:a=null,viewportInstance:y}=e||{};gs(!y||y instanceof s0),this.viewportInstance=y,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=yc(i),this._y=yc(r),this._width=yc(s),this._height=yc(u),this._padding=a&&{left:yc(a.left||0),right:yc(a.right||0),top:yc(a.top||0),bottom:yc(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&ql(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:n});return!r.height||!r.width?null:new this.ViewportType({...i,...this.props,...r})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const i in this.props.viewState)i!=="id"&&(n[i]=this.props.viewState[i]);return n}return e}getDimensions({width:e,height:n}){const i={x:_c(this._x,e),y:_c(this._y,n),width:_c(this._width,e),height:_c(this._height,n)};return this._padding&&(i.padding={left:_c(this._padding.left,e),top:_c(this._padding.top,n),right:_c(this._padding.right,e),bottom:_c(this._padding.bottom,n)}),i}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let Wg=class{constructor(e){oe(this,"_inProgress",void 0),oe(this,"_handle",void 0),oe(this,"_timeline",void 0),oe(this,"time",void 0),oe(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,i;this.cancel(),this.settings=e,this._inProgress=!0,(n=(i=this.settings).onStart)===null||n===void 0||n.call(i,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:i,settings:r}=this;this._handle=i.addChannel({delay:i.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const JC=()=>{},Gb={BREAK:1,SNAP_TO_END:2,IGNORE:3},yX=t=>t,_X=Gb.BREAK;class vX{constructor(e){oe(this,"getControllerState",void 0),oe(this,"props",void 0),oe(this,"propsInTransition",void 0),oe(this,"transition",void 0),oe(this,"onViewStateChange",void 0),oe(this,"onStateChange",void 0),oe(this,"_onTransitionUpdate",n=>{const{time:i,settings:{interpolator:r,startProps:s,endProps:u,duration:a,easing:y}}=n,w=y(i/a),I=r.interpolateProps(s,u,w);this.propsInTransition=this.getControllerState({...this.props,...I}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Wg(e.timeline),this.onViewStateChange=e.onViewStateChange||JC,this.onStateChange=e.onStateChange||JC}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let r=i;if(this.transition.inProgress){const{interruption:s,endProps:u}=this.transition.settings;r={...i,...s===Gb.SNAP_TO_END?u:this.propsInTransition||i}}this._triggerTransition(r,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:i}=e;return(n>0||n==="auto")&&!!i}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Gb.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const i=this.getControllerState(e),r=this.getControllerState(n).shortestPathFrom(i),s=n.transitionInterpolator,u=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(u===0)return;const a=s.initializeProps(e,r);this.propsInTransition={};const y={duration:u,easing:n.transitionEasing||yX,interpolator:s,interruption:n.transitionInterruption||_X,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(y),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(n)}}}class zR{constructor(e){oe(this,"_propsToCompare",void 0),oe(this,"_propsToExtract",void 0),oe(this,"_requiredProps",void 0);const{compare:n,extract:i,required:r}=e;this._propsToCompare=n,this._propsToExtract=i||n,this._requiredProps=r}arePropsEqual(e,n){for(const i of this._propsToCompare)if(!(i in e)||!(i in n)||!Du(e[i],n[i]))return!1;return!0}initializeProps(e,n){const i={},r={};for(const s of this._propsToExtract)(s in e||s in n)&&(i[s]=e[s],r[s]=n[s]);return this._checkRequiredProps(i),this._checkRequiredProps(r),{start:i,end:r}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const i=e[n];gs(Number.isFinite(i)||Array.isArray(i),"".concat(n," is required for transition"))})}}const xX=["longitude","latitude","zoom","bearing","pitch"],wX=["longitude","latitude","zoom"];class OR extends zR{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:xX,required:wX},super(i.transitionProps),oe(this,"opts",void 0),this.opts=i}initializeProps(e,n){const i=super.initializeProps(e,n),{makeViewport:r,around:s}=this.opts;if(r&&s){const u=r(e),a=r(n),y=u.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(y),aroundPosition:y,width:n.width,height:n.height})}return i}interpolateProps(e,n,i){const r={};for(const s of this._propsToExtract)r[s]=BA(e[s]||0,n[s]||0,i);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...r});Object.assign(r,s.panByPosition(n.aroundPosition,BA(e.around,n.around,i)))}return r}}const vc={transitionDuration:0},bX=300,l1=t=>1-(1-t)*(1-t),B0={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},dh={};class EX{constructor(e){oe(this,"props",void 0),oe(this,"state",{}),oe(this,"transitionManager",void 0),oe(this,"eventManager",void 0),oe(this,"onViewStateChange",void 0),oe(this,"onStateChange",void 0),oe(this,"makeViewport",void 0),oe(this,"_controllerState",void 0),oe(this,"_events",{}),oe(this,"_interactionState",{isDragging:!1}),oe(this,"_customEvents",[]),oe(this,"_eventStartBlocked",null),oe(this,"_panMove",!1),oe(this,"invertPan",!1),oe(this,"dragMode","rotate"),oe(this,"inertia",0),oe(this,"scrollZoom",!0),oe(this,"dragPan",!0),oe(this,"dragRotate",!0),oe(this,"doubleClickZoom",!0),oe(this,"touchZoom",!0),oe(this,"touchRotate",!1),oe(this,"keyboard",!0),this.transitionManager=new vX({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:i}=this.props,{offsetCenter:r}=e;return[r.x-n,r.y-i]}isPointInBounds(e,n){const{width:i,height:r}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?bX:0;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:u=!0,touchZoom:a=!0,touchRotate:y=!1,keyboard:w=!0}=e,I=!!this.onViewStateChange;this.toggleEvents(B0.WHEEL,I&&i),this.toggleEvents(B0.PAN,I),this.toggleEvents(B0.PINCH,I&&(a||y)),this.toggleEvents(B0.TRIPLE_PAN,I&&y),this.toggleEvents(B0.DOUBLE_TAP,I&&u),this.toggleEvents(B0.KEYBOARD,I&&w),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=u,this.touchZoom=a,this.touchRotate=y,this.keyboard=w}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(i=>{this._events[i]!==n&&(this._events[i]=n,n?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,n=null,i={}){const r={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),s){const u=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:u})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:n});return this._panMove=i,this.updateViewport(r,vc,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),i=this.controllerState.pan({pos:n});return this.updateViewport(i,vc,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:l1},{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),i=this.controllerState.rotate({pos:n});return this.updateViewport(i,vc,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:l1},{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:i=.01,smooth:r=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let u=2/(1+Math.exp(-Math.abs(s*i)));s<0&&u!==0&&(u=1/u);const a=this.controllerState.zoom({pos:n,scale:u});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.rotateStart({pos:n});return this.updateViewport(i,vc,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const i=this.controllerState.rotate({pos:n});return this.updateViewport(i,vc,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:l1},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return dh._startPinchRotation=e.rotation,dh._lastPinchEvent=e,this.updateViewport(i,vc,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);n=n.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;n=n.rotate({deltaAngleX:dh._startPinchRotation-i})}return this.updateViewport(n,vc,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),dh._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:i}=dh;if(this.touchZoom&&n&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const u=Math.log2(e.scale),a=(u-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),y=Math.pow(2,u+a*n/2);s=s.zoom({pos:r,scale:y}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:r}),transitionDuration:n,transitionEasing:l1},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return dh._startPinchRotation=null,dh._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:n,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:u}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let y;const w={};switch(e.srcEvent.code){case"Minus":y=n?a.zoomOut(i).zoomOut(i):a.zoomOut(i),w.isZooming=!0;break;case"Equal":y=n?a.zoomIn(i).zoomIn(i):a.zoomIn(i),w.isZooming=!0;break;case"ArrowLeft":n?(y=a.rotateLeft(s),w.isRotating=!0):(y=a.moveLeft(r),w.isPanning=!0);break;case"ArrowRight":n?(y=a.rotateRight(s),w.isRotating=!0):(y=a.moveRight(r),w.isPanning=!0);break;case"ArrowUp":n?(y=a.rotateUp(u),w.isRotating=!0):(y=a.moveUp(r),w.isPanning=!0);break;case"ArrowDown":n?(y=a.rotateDown(u),w.isRotating=!0):(y=a.moveDown(r),w.isPanning=!0);break;default:return!1}return this.updateViewport(y,this._getTransitionProps(),w),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?vc:e?{...n,transitionInterpolator:new OR({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class TX{constructor(e,n){oe(this,"_viewportProps",void 0),oe(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const eP=5,SX=1.2;class MX extends TX{constructor(e){const{width:n,height:i,latitude:r,longitude:s,zoom:u,bearing:a=0,pitch:y=0,altitude:w=1.5,position:I=[0,0,0],maxZoom:P=20,minZoom:L=0,maxPitch:U=60,minPitch:Q=0,startPanLngLat:Z,startZoomLngLat:ae,startRotatePos:Y,startBearing:te,startPitch:re,startZoom:de,normalize:ve=!0}=e;gs(Number.isFinite(s)),gs(Number.isFinite(r)),gs(Number.isFinite(u)),super({width:n,height:i,latitude:r,longitude:s,zoom:u,bearing:a,pitch:y,altitude:w,maxZoom:P,minZoom:L,maxPitch:U,minPitch:Q,normalize:ve,position:I},{startPanLngLat:Z,startZoomLngLat:ae,startRotatePos:Y,startBearing:te,startPitch:re,startZoom:de}),oe(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:u}=this.getState();if(!r||s===void 0||u===void 0)return this;let a;return e?a=this._getNewRotation(e,r,u,s):a={bearing:s+n,pitch:u+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:i}){let{startZoom:r,startZoomLngLat:s}=this.getState();if(s||(r=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:u,minZoom:a}=this.getViewportProps();let y=r+Math.log2(i);y=kc(y,a,u);const w=this.makeViewport({...this.getViewportProps(),zoom:y});return this._getUpdatedState({zoom:y,...w.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),i={...this.getViewportProps()},{bearing:r,longitude:s}=i;return Math.abs(r-n.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-n.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}applyConstraints(e){const{maxZoom:n,minZoom:i,zoom:r}=e;e.zoom=kc(r,i,n);const{maxPitch:s,minPitch:u,pitch:a}=e;e.pitch=kc(a,u,s);const{normalize:y=!0}=e;return y&&Object.assign(e,hY(e)),e}_zoomFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.zoom({pos:[n/2,i/2],scale:e})}_panFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.pan({startPos:[n/2,i/2],pos:[n/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,i,r){const s=e[0]-n[0],u=e[1]-n[1],a=e[1],y=n[1],{width:w,height:I}=this.getViewportProps(),P=s/w;let L=0;u>0?Math.abs(I-y)>eP&&(L=u/(y-I)*SX):u<0&&y>eP&&(L=1-a/y),L=kc(L,-1,1);const{minPitch:U,maxPitch:Q}=this.getViewportProps(),Z=r+180*P;let ae=i;return L>0?ae=i+L*(Q-i):L<0&&(ae=i-L*(U-i)),{pitch:ae,bearing:Z}}}class CX extends EX{constructor(...e){super(...e),oe(this,"ControllerState",MX),oe(this,"transition",{transitionDuration:300,transitionInterpolator:new OR({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),oe(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class FR extends $f{get ViewportType(){return Xc}get ControllerType(){return CX}}oe(FR,"displayName","MapView");const PX=new yT;function IX(t,e){var n,i;const r=(n=t.order)!==null&&n!==void 0?n:1/0,s=(i=e.order)!==null&&i!==void 0?i:1/0;return r-s}class kX{constructor(){oe(this,"effects",void 0),oe(this,"_resolvedEffects",[]),oe(this,"_defaultEffects",[]),oe(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(i=>i.id===e.id)){const i=n.findIndex(r=>IX(r,e)>0);i<0?n.push(e):n.splice(i,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(ql(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const r of this.effects)n[r.id]=r;const i=[];for(const r of e){const s=n[r.id];s&&s!==r?s.setProps?(s.setProps(r.props),i.push(s)):(s.cleanup(),i.push(r)):i.push(r),delete n[r.id]}for(const r in n)n[r].cleanup();this.effects=i,this._resolvedEffects=i.concat(this._defaultEffects),e.some(r=>r instanceof yT)||this._resolvedEffects.push(PX),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class LX extends dT{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const DX="deckRenderer.renderLayers";class RX{constructor(e){oe(this,"gl",void 0),oe(this,"layerFilter",void 0),oe(this,"drawPickingColors",void 0),oe(this,"drawLayersPass",void 0),oe(this,"pickLayersPass",void 0),oe(this,"renderCount",void 0),oe(this,"_needsRedraw",void 0),oe(this,"renderBuffers",void 0),oe(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new LX(e),this.pickLayersPass=new DR(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,i={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||es.getDefaultFramebuffer(this.gl)};i.effects&&this._preRender(i.effects,i);const r=this.lastPostProcessEffect?this.renderBuffers[0]:i.target,s=n.render({...i,target:r});i.effects&&this._postRender(i.effects,i),this.renderCount++,so(DX,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const i of e)n.preRenderStats[i.id]=i.preRender(this.gl,n),i.postRender&&(this.lastPostProcessEffect=i.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new es(this.gl),new es(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:i}=this,r={...n,inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){r.target=n.target,s.postRender(this.gl,r);break}const u=s.postRender(this.gl,r);r.inputBuffer=u,r.swapBuffer=u===i[0]?i[1]:i[0]}}}const BX={pickedColor:null,pickedObjectIndex:-1};function zX({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:s}){const{x:u,y:a,width:y,height:w}=s;let I=r*r,P=-1,L=0;for(let U=0;U<w;U++){const Q=U+a-i,Z=Q*Q;if(Z>I)L+=4*y;else for(let ae=0;ae<y;ae++){if(t[L+3]-1>=0){const te=ae+u-n,re=te*te+Z;re<=I&&(I=re,P=L)}L+=4}}if(P>=0){const U=t.slice(P,P+4),Q=e(U);if(Q){const Z=Math.floor(P/4/y),ae=P/4-Z*y;return{...Q,pickedColor:U,pickedX:u+ae,pickedY:a+Z}}si.error("Picked non-existent layer. Is picking buffer corrupt?")()}return BX}function OX({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const s=t.slice(i,i+4),u=s.join(",");if(!n.has(u)){const a=e(s);a?n.set(u,{...a,color:s}):si.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function NR({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:s}){let u=e[0];e.length>1&&(u=NX(t?.pickedViewports||e,{x:i,y:r}));let a;if(u){const y=[i-u.x,r-u.y];s!==void 0&&(y[2]=s),a=u.unproject(y)}return{color:null,layer:null,viewport:u,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function FX(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:s,pickedLayer:u,pickedObjectIndex:a}=e,y=u?[u]:[];if(i==="hover"){const P=n.index,L=n.layerId,U=u?u.props.id:null;if(U!==L||a!==P){if(U!==L){const Q=r.find(Z=>Z.props.id===L);Q&&y.unshift(Q)}n.layerId=U,n.index=a,n.info=null}}const w=NR(t),I=new Map;return I.set(null,w),y.forEach(P=>{let L={...w};P===u&&(L.color=s,L.index=a,L.picked=!0),L=UR({layer:P,info:L,mode:i});const U=L.layer;P===u&&i==="hover"&&(n.info=L),I.set(U.id,L),i==="hover"&&U.updateAutoHighlight(L)}),I}function UR({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}function NX(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}class UX{constructor(e){oe(this,"gl",void 0),oe(this,"pickingFBO",void 0),oe(this,"depthFBO",void 0),oe(this,"pickLayersPass",void 0),oe(this,"layerFilter",void 0),oe(this,"lastPickedInfo",void 0),oe(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new DR(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:i,viewports:r},s=this.lastPickedInfo.info){const u=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,y=u?i.find(L=>L.id===u):null,w=a&&r.find(L=>L.id===a)||r[0],I=w&&w.unproject([e-w.x,n-w.y]);return{...s,...{x:e,y:n,viewport:w,coordinate:I,layer:y}}}_resizeBuffer(){var e,n;const{gl:i}=this;if(!this.pickingFBO&&(this.pickingFBO=new es(i),es.isSupported(i,{colorBufferFloat:!0}))){const r=new es(i);r.attach({36064:new oa(i,{format:ui(i)?34836:6408,type:5126})}),this.depthFBO=r}(e=this.pickingFBO)===null||e===void 0||e.resize({width:i.canvas.width,height:i.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:i.canvas.width,height:i.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(i=>this.pickLayersPass.shouldDrawLayer(i)&&!i.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:i,x:r,y:s,radius:u=0,depth:a=1,mode:y="query",unproject3D:w,onViewportActive:I,effects:P}){const L=this._getPickable(e),U=Nf(this.gl);if(!L)return{result:[],emptyInfo:NR({viewports:i,x:r,y:s,pixelRatio:U})};this._resizeBuffer();const Q=yx(this.gl,[r,s],!0),Z=[Q.x+Math.floor(Q.width/2),Q.y+Math.floor(Q.height/2)],ae=Math.round(u*U),{width:Y,height:te}=this.pickingFBO,re=this._getPickingRect({deviceX:Z[0],deviceY:Z[1],deviceRadius:ae,deviceWidth:Y,deviceHeight:te}),de={x:r-u,y:s-u,width:u*2+1,height:u*2+1};let ve;const Me=[],He=new Set;for(let Qe=0;Qe<a;Qe++){let et;if(re){const Ve=this._drawAndSample({layers:L,views:n,viewports:i,onViewportActive:I,deviceRect:re,cullRect:de,effects:P,pass:"picking:".concat(y)});et=zX({...Ve,deviceX:Z[0],deviceY:Z[1],deviceRadius:ae,deviceRect:re})}else et={pickedColor:null,pickedObjectIndex:-1};let tt;if(et.pickedLayer&&w&&this.depthFBO){const{pickedColors:Ve}=this._drawAndSample({layers:[et.pickedLayer],views:n,viewports:i,onViewportActive:I,deviceRect:{x:et.pickedX,y:et.pickedY,width:1,height:1},cullRect:de,effects:P,pass:"picking:".concat(y,":z")},!0);Ve[3]&&(tt=Ve[0])}et.pickedLayer&&Qe+1<a&&(He.add(et.pickedLayer),et.pickedLayer.disablePickingIndex(et.pickedObjectIndex)),ve=FX({pickInfo:et,lastPickedInfo:this.lastPickedInfo,mode:y,layers:L,viewports:i,x:r,y:s,z:tt,pixelRatio:U});for(const Ve of ve.values())Ve.layer&&Me.push(Ve);if(!et.pickedColor)break}for(const Qe of He)Qe.restorePickingColors();return{result:Me,emptyInfo:ve.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:i,x:r,y:s,width:u=1,height:a=1,mode:y="query",maxObjects:w=null,onViewportActive:I,effects:P}){const L=this._getPickable(e);if(!L)return[];this._resizeBuffer();const U=Nf(this.gl),Q=yx(this.gl,[r,s],!0),Z=Q.x,ae=Q.y+Q.height,Y=yx(this.gl,[r+u,s+a],!0),te=Y.x+Y.width,re=Y.y,de={x:Z,y:re,width:te-Z,height:ae-re},ve=this._drawAndSample({layers:L,views:n,viewports:i,onViewportActive:I,deviceRect:de,cullRect:{x:r,y:s,width:u,height:a},effects:P,pass:"picking:".concat(y)}),Me=OX(ve),He=new Map,Qe=Number.isFinite(w);for(let et=0;et<Me.length&&!(Qe&&w&&He.size>=w);et++){const tt=Me[et];let Ve={color:tt.pickedColor,layer:null,index:tt.pickedObjectIndex,picked:!0,x:r,y:s,pixelRatio:U};Ve=UR({layer:tt.pickedLayer,info:Ve,mode:y}),He.has(Ve.object)||He.set(Ve.object,Ve)}return Array.from(He.values())}_drawAndSample({layers:e,views:n,viewports:i,onViewportActive:r,deviceRect:s,cullRect:u,effects:a,pass:y},w=!1){const I=w?this.depthFBO:this.pickingFBO,P={layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:r,pickingFBO:I,deviceRect:s,cullRect:u,effects:a,pass:y,pickZ:w,preRenderStats:{}};for(const te of a)te.useInPicking&&(P.preRenderStats[te.id]=te.preRender(this.gl,P));const{decodePickingColor:L}=this.pickLayersPass.render(P),{x:U,y:Q,width:Z,height:ae}=s,Y=new(w?Float32Array:Uint8Array)(Z*ae*4);return d2(I,{sourceX:U,sourceY:Q,sourceWidth:Z,sourceHeight:ae,target:Y}),{pickedColors:Y,decodePickingColor:L}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const u=Math.max(0,e-i),a=Math.max(0,n-i),y=Math.min(r,e+i+1)-u,w=Math.min(s,n+i+1)-a;return y<=0||w<=0?null:{x:u,y:a,width:y,height:w}}}const VX={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class GX{constructor(e){oe(this,"el",null),oe(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,VX),n.appendChild(this.el))}setTooltip(e,n,i){const r=this.el;if(r){if(typeof e=="string")r.innerText=e;else if(e)e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className);else{this.isVisible=!1,r.style.display="none";return}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(n,"px, ").concat(i,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(r.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var VR={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,i,r){var s=["","webkit","Moz","MS","ms","o"],u=n.createElement("div"),a="function",y=Math.round,w=Math.abs,I=Date.now;function P(ge,Ee,Fe){return setTimeout(re(ge,Fe),Ee)}function L(ge,Ee,Fe){return Array.isArray(ge)?(U(ge,Fe[Ee],Fe),!0):!1}function U(ge,Ee,Fe){var ot;if(ge)if(ge.forEach)ge.forEach(Ee,Fe);else if(ge.length!==r)for(ot=0;ot<ge.length;)Ee.call(Fe,ge[ot],ot,ge),ot++;else for(ot in ge)ge.hasOwnProperty(ot)&&Ee.call(Fe,ge[ot],ot,ge)}function Q(ge,Ee,Fe){var ot="DEPRECATED METHOD: "+Ee+`
`+Fe+` AT 
`;return function(){var wt=new Error("get-stack-trace"),Wt=wt&&wt.stack?wt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",kn=e.console&&(e.console.warn||e.console.log);return kn&&kn.call(e.console,ot,Wt),ge.apply(this,arguments)}}var Z;typeof Object.assign!="function"?Z=function(Ee){if(Ee===r||Ee===null)throw new TypeError("Cannot convert undefined or null to object");for(var Fe=Object(Ee),ot=1;ot<arguments.length;ot++){var wt=arguments[ot];if(wt!==r&&wt!==null)for(var Wt in wt)wt.hasOwnProperty(Wt)&&(Fe[Wt]=wt[Wt])}return Fe}:Z=Object.assign;var ae=Q(function(Ee,Fe,ot){for(var wt=Object.keys(Fe),Wt=0;Wt<wt.length;)(!ot||ot&&Ee[wt[Wt]]===r)&&(Ee[wt[Wt]]=Fe[wt[Wt]]),Wt++;return Ee},"extend","Use `assign`."),Y=Q(function(Ee,Fe){return ae(Ee,Fe,!0)},"merge","Use `assign`.");function te(ge,Ee,Fe){var ot=Ee.prototype,wt;wt=ge.prototype=Object.create(ot),wt.constructor=ge,wt._super=ot,Fe&&Z(wt,Fe)}function re(ge,Ee){return function(){return ge.apply(Ee,arguments)}}function de(ge,Ee){return typeof ge==a?ge.apply(Ee&&Ee[0]||r,Ee):ge}function ve(ge,Ee){return ge===r?Ee:ge}function Me(ge,Ee,Fe){U(tt(Ee),function(ot){ge.addEventListener(ot,Fe,!1)})}function He(ge,Ee,Fe){U(tt(Ee),function(ot){ge.removeEventListener(ot,Fe,!1)})}function Qe(ge,Ee){for(;ge;){if(ge==Ee)return!0;ge=ge.parentNode}return!1}function et(ge,Ee){return ge.indexOf(Ee)>-1}function tt(ge){return ge.trim().split(/\s+/g)}function Ve(ge,Ee,Fe){if(ge.indexOf&&!Fe)return ge.indexOf(Ee);for(var ot=0;ot<ge.length;){if(Fe&&ge[ot][Fe]==Ee||!Fe&&ge[ot]===Ee)return ot;ot++}return-1}function nt(ge){return Array.prototype.slice.call(ge,0)}function Ye(ge,Ee,Fe){for(var ot=[],wt=[],Wt=0;Wt<ge.length;){var kn=Ee?ge[Wt][Ee]:ge[Wt];Ve(wt,kn)<0&&ot.push(ge[Wt]),wt[Wt]=kn,Wt++}return Fe&&(Ee?ot=ot.sort(function(Jt,ki){return Jt[Ee]>ki[Ee]}):ot=ot.sort()),ot}function gt(ge,Ee){for(var Fe,ot,wt=Ee[0].toUpperCase()+Ee.slice(1),Wt=0;Wt<s.length;){if(Fe=s[Wt],ot=Fe?Fe+wt:Ee,ot in ge)return ot;Wt++}return r}var Xt=1;function Et(){return Xt++}function fn(ge){var Ee=ge.ownerDocument||ge;return Ee.defaultView||Ee.parentWindow||e}var mt=/mobile|tablet|ip(ad|hone|od)|android/i,bt="ontouchstart"in e,Kt=gt(e,"PointerEvent")!==r,In=bt&&mt.test(navigator.userAgent),En="touch",Si="pen",Jn="mouse",oi="kinect",ci=25,Nn=1,bi=2,xt=4,nn=8,Mn=1,vt=2,ei=4,$n=8,yi=16,li=vt|ei,ti=$n|yi,Ki=li|ti,Un=["x","y"],Cr=["clientX","clientY"];function Hn(ge,Ee){var Fe=this;this.manager=ge,this.callback=Ee,this.element=ge.element,this.target=ge.options.inputTarget,this.domHandler=function(ot){de(ge.options.enable,[ge])&&Fe.handler(ot)},this.init()}Hn.prototype={handler:function(){},init:function(){this.evEl&&Me(this.element,this.evEl,this.domHandler),this.evTarget&&Me(this.target,this.evTarget,this.domHandler),this.evWin&&Me(fn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&He(this.element,this.evEl,this.domHandler),this.evTarget&&He(this.target,this.evTarget,this.domHandler),this.evWin&&He(fn(this.element),this.evWin,this.domHandler)}};function Fr(ge){var Ee,Fe=ge.options.inputClass;return Fe?Ee=Fe:Kt?Ee=qe:In?Ee=Vr:bt?Ee=K:Ee=Tn,new Ee(ge,fo)}function fo(ge,Ee,Fe){var ot=Fe.pointers.length,wt=Fe.changedPointers.length,Wt=Ee&Nn&&ot-wt===0,kn=Ee&(xt|nn)&&ot-wt===0;Fe.isFirst=!!Wt,Fe.isFinal=!!kn,Wt&&(ge.session={}),Fe.eventType=Ee,Ni(ge,Fe),ge.emit("hammer.input",Fe),ge.recognize(Fe),ge.session.prevInput=Fe}function Ni(ge,Ee){var Fe=ge.session,ot=Ee.pointers,wt=ot.length;Fe.firstInput||(Fe.firstInput=is(Ee)),wt>1&&!Fe.firstMultiple?Fe.firstMultiple=is(Ee):wt===1&&(Fe.firstMultiple=!1);var Wt=Fe.firstInput,kn=Fe.firstMultiple,Pi=kn?kn.center:Wt.center,Jt=Ee.center=ut(ot);Ee.timeStamp=I(),Ee.deltaTime=Ee.timeStamp-Wt.timeStamp,Ee.angle=Rn(Pi,Jt),Ee.distance=xr(Pi,Jt),Pr(Fe,Ee),Ee.offsetDirection=Bs(Ee.deltaX,Ee.deltaY);var ki=It(Ee.deltaTime,Ee.deltaX,Ee.deltaY);Ee.overallVelocityX=ki.x,Ee.overallVelocityY=ki.y,Ee.overallVelocity=w(ki.x)>w(ki.y)?ki.x:ki.y,Ee.scale=kn?Ir(kn.pointers,ot):1,Ee.rotation=kn?Nr(kn.pointers,ot):0,Ee.maxPointers=Fe.prevInput?Ee.pointers.length>Fe.prevInput.maxPointers?Ee.pointers.length:Fe.prevInput.maxPointers:Ee.pointers.length,Fo(Fe,Ee);var Vn=ge.element;Qe(Ee.srcEvent.target,Vn)&&(Vn=Ee.srcEvent.target),Ee.target=Vn}function Pr(ge,Ee){var Fe=Ee.center,ot=ge.offsetDelta||{},wt=ge.prevDelta||{},Wt=ge.prevInput||{};(Ee.eventType===Nn||Wt.eventType===xt)&&(wt=ge.prevDelta={x:Wt.deltaX||0,y:Wt.deltaY||0},ot=ge.offsetDelta={x:Fe.x,y:Fe.y}),Ee.deltaX=wt.x+(Fe.x-ot.x),Ee.deltaY=wt.y+(Fe.y-ot.y)}function Fo(ge,Ee){var Fe=ge.lastInterval||Ee,ot=Ee.timeStamp-Fe.timeStamp,wt,Wt,kn,Pi;if(Ee.eventType!=nn&&(ot>ci||Fe.velocity===r)){var Jt=Ee.deltaX-Fe.deltaX,ki=Ee.deltaY-Fe.deltaY,Vn=It(ot,Jt,ki);Wt=Vn.x,kn=Vn.y,wt=w(Vn.x)>w(Vn.y)?Vn.x:Vn.y,Pi=Bs(Jt,ki),ge.lastInterval=Ee}else wt=Fe.velocity,Wt=Fe.velocityX,kn=Fe.velocityY,Pi=Fe.direction;Ee.velocity=wt,Ee.velocityX=Wt,Ee.velocityY=kn,Ee.direction=Pi}function is(ge){for(var Ee=[],Fe=0;Fe<ge.pointers.length;)Ee[Fe]={clientX:y(ge.pointers[Fe].clientX),clientY:y(ge.pointers[Fe].clientY)},Fe++;return{timeStamp:I(),pointers:Ee,center:ut(Ee),deltaX:ge.deltaX,deltaY:ge.deltaY}}function ut(ge){var Ee=ge.length;if(Ee===1)return{x:y(ge[0].clientX),y:y(ge[0].clientY)};for(var Fe=0,ot=0,wt=0;wt<Ee;)Fe+=ge[wt].clientX,ot+=ge[wt].clientY,wt++;return{x:y(Fe/Ee),y:y(ot/Ee)}}function It(ge,Ee,Fe){return{x:Ee/ge||0,y:Fe/ge||0}}function Bs(ge,Ee){return ge===Ee?Mn:w(ge)>=w(Ee)?ge<0?vt:ei:Ee<0?$n:yi}function xr(ge,Ee,Fe){Fe||(Fe=Un);var ot=Ee[Fe[0]]-ge[Fe[0]],wt=Ee[Fe[1]]-ge[Fe[1]];return Math.sqrt(ot*ot+wt*wt)}function Rn(ge,Ee,Fe){Fe||(Fe=Un);var ot=Ee[Fe[0]]-ge[Fe[0]],wt=Ee[Fe[1]]-ge[Fe[1]];return Math.atan2(wt,ot)*180/Math.PI}function Nr(ge,Ee){return Rn(Ee[1],Ee[0],Cr)+Rn(ge[1],ge[0],Cr)}function Ir(ge,Ee){return xr(Ee[0],Ee[1],Cr)/xr(ge[0],ge[1],Cr)}var kr={mousedown:Nn,mousemove:bi,mouseup:xt},rs="mousedown",kt="mousemove mouseup";function Tn(){this.evEl=rs,this.evWin=kt,this.pressed=!1,Hn.apply(this,arguments)}te(Tn,Hn,{handler:function(Ee){var Fe=kr[Ee.type];Fe&Nn&&Ee.button===0&&(this.pressed=!0),Fe&bi&&Ee.which!==1&&(Fe=xt),this.pressed&&(Fe&xt&&(this.pressed=!1),this.callback(this.manager,Fe,{pointers:[Ee],changedPointers:[Ee],pointerType:Jn,srcEvent:Ee}))}});var wn={pointerdown:Nn,pointermove:bi,pointerup:xt,pointercancel:nn,pointerout:nn},Ii={2:En,3:Si,4:Jn,5:oi},vs="pointerdown",mn="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(vs="MSPointerDown",mn="MSPointerMove MSPointerUp MSPointerCancel");function qe(){this.evEl=vs,this.evWin=mn,Hn.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}te(qe,Hn,{handler:function(Ee){var Fe=this.store,ot=!1,wt=Ee.type.toLowerCase().replace("ms",""),Wt=wn[wt],kn=Ii[Ee.pointerType]||Ee.pointerType,Pi=kn==En,Jt=Ve(Fe,Ee.pointerId,"pointerId");Wt&Nn&&(Ee.button===0||Pi)?Jt<0&&(Fe.push(Ee),Jt=Fe.length-1):Wt&(xt|nn)&&(ot=!0),!(Jt<0)&&(Fe[Jt]=Ee,this.callback(this.manager,Wt,{pointers:Fe,changedPointers:[Ee],pointerType:kn,srcEvent:Ee}),ot&&Fe.splice(Jt,1))}});var $i={touchstart:Nn,touchmove:bi,touchend:xt,touchcancel:nn},zs="touchstart",Ri="touchstart touchmove touchend touchcancel";function or(){this.evTarget=zs,this.evWin=Ri,this.started=!1,Hn.apply(this,arguments)}te(or,Hn,{handler:function(Ee){var Fe=$i[Ee.type];if(Fe===Nn&&(this.started=!0),!!this.started){var ot=qn.call(this,Ee,Fe);Fe&(xt|nn)&&ot[0].length-ot[1].length===0&&(this.started=!1),this.callback(this.manager,Fe,{pointers:ot[0],changedPointers:ot[1],pointerType:En,srcEvent:Ee})}}});function qn(ge,Ee){var Fe=nt(ge.touches),ot=nt(ge.changedTouches);return Ee&(xt|nn)&&(Fe=Ye(Fe.concat(ot),"identifier",!0)),[Fe,ot]}var Os={touchstart:Nn,touchmove:bi,touchend:xt,touchcancel:nn},Ur="touchstart touchmove touchend touchcancel";function Vr(){this.evTarget=Ur,this.targetIds={},Hn.apply(this,arguments)}te(Vr,Hn,{handler:function(Ee){var Fe=Os[Ee.type],ot=Lr.call(this,Ee,Fe);ot&&this.callback(this.manager,Fe,{pointers:ot[0],changedPointers:ot[1],pointerType:En,srcEvent:Ee})}});function Lr(ge,Ee){var Fe=nt(ge.touches),ot=this.targetIds;if(Ee&(Nn|bi)&&Fe.length===1)return ot[Fe[0].identifier]=!0,[Fe,Fe];var wt,Wt,kn=nt(ge.changedTouches),Pi=[],Jt=this.target;if(Wt=Fe.filter(function(ki){return Qe(ki.target,Jt)}),Ee===Nn)for(wt=0;wt<Wt.length;)ot[Wt[wt].identifier]=!0,wt++;for(wt=0;wt<kn.length;)ot[kn[wt].identifier]&&Pi.push(kn[wt]),Ee&(xt|nn)&&delete ot[kn[wt].identifier],wt++;if(Pi.length)return[Ye(Wt.concat(Pi),"identifier",!0),Pi]}var ss=2500,Bi=25;function K(){Hn.apply(this,arguments);var ge=re(this.handler,this);this.touch=new Vr(this.manager,ge),this.mouse=new Tn(this.manager,ge),this.primaryTouch=null,this.lastTouches=[]}te(K,Hn,{handler:function(Ee,Fe,ot){var wt=ot.pointerType==En,Wt=ot.pointerType==Jn;if(!(Wt&&ot.sourceCapabilities&&ot.sourceCapabilities.firesTouchEvents)){if(wt)H.call(this,Fe,ot);else if(Wt&&he.call(this,ot))return;this.callback(Ee,Fe,ot)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function H(ge,Ee){ge&Nn?(this.primaryTouch=Ee.changedPointers[0].identifier,ee.call(this,Ee)):ge&(xt|nn)&&ee.call(this,Ee)}function ee(ge){var Ee=ge.changedPointers[0];if(Ee.identifier===this.primaryTouch){var Fe={x:Ee.clientX,y:Ee.clientY};this.lastTouches.push(Fe);var ot=this.lastTouches,wt=function(){var Wt=ot.indexOf(Fe);Wt>-1&&ot.splice(Wt,1)};setTimeout(wt,ss)}}function he(ge){for(var Ee=ge.srcEvent.clientX,Fe=ge.srcEvent.clientY,ot=0;ot<this.lastTouches.length;ot++){var wt=this.lastTouches[ot],Wt=Math.abs(Ee-wt.x),kn=Math.abs(Fe-wt.y);if(Wt<=Bi&&kn<=Bi)return!0}return!1}var o=gt(u.style,"touchAction"),G=o!==r,Le="compute",Ie="auto",Pe="manipulation",ke="none",We="pan-x",at="pan-y",$e=Dt();function ht(ge,Ee){this.manager=ge,this.set(Ee)}ht.prototype={set:function(ge){ge==Le&&(ge=this.compute()),G&&this.manager.element.style&&$e[ge]&&(this.manager.element.style[o]=ge),this.actions=ge.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ge=[];return U(this.manager.recognizers,function(Ee){de(Ee.options.enable,[Ee])&&(ge=ge.concat(Ee.getTouchAction()))}),Lt(ge.join(" "))},preventDefaults:function(ge){var Ee=ge.srcEvent,Fe=ge.offsetDirection;if(this.manager.session.prevented){Ee.preventDefault();return}var ot=this.actions,wt=et(ot,ke)&&!$e[ke],Wt=et(ot,at)&&!$e[at],kn=et(ot,We)&&!$e[We];if(wt){var Pi=ge.pointers.length===1,Jt=ge.distance<2,ki=ge.deltaTime<250;if(Pi&&Jt&&ki)return}if(!(kn&&Wt)&&(wt||Wt&&Fe&li||kn&&Fe&ti))return this.preventSrc(Ee)},preventSrc:function(ge){this.manager.session.prevented=!0,ge.preventDefault()}};function Lt(ge){if(et(ge,ke))return ke;var Ee=et(ge,We),Fe=et(ge,at);return Ee&&Fe?ke:Ee||Fe?Ee?We:at:et(ge,Pe)?Pe:Ie}function Dt(){if(!G)return!1;var ge={},Ee=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Fe){ge[Fe]=Ee?e.CSS.supports("touch-action",Fe):!0}),ge}var rn=1,jt=2,dn=4,Qt=8,on=Qt,vn=16,Ot=32;function Oe(ge){this.options=Z({},this.defaults,ge||{}),this.id=Et(),this.manager=null,this.options.enable=ve(this.options.enable,!0),this.state=rn,this.simultaneous={},this.requireFail=[]}Oe.prototype={defaults:{},set:function(ge){return Z(this.options,ge),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ge){if(L(ge,"recognizeWith",this))return this;var Ee=this.simultaneous;return ge=An(ge,this),Ee[ge.id]||(Ee[ge.id]=ge,ge.recognizeWith(this)),this},dropRecognizeWith:function(ge){return L(ge,"dropRecognizeWith",this)?this:(ge=An(ge,this),delete this.simultaneous[ge.id],this)},requireFailure:function(ge){if(L(ge,"requireFailure",this))return this;var Ee=this.requireFail;return ge=An(ge,this),Ve(Ee,ge)===-1&&(Ee.push(ge),ge.requireFailure(this)),this},dropRequireFailure:function(ge){if(L(ge,"dropRequireFailure",this))return this;ge=An(ge,this);var Ee=Ve(this.requireFail,ge);return Ee>-1&&this.requireFail.splice(Ee,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ge){return!!this.simultaneous[ge.id]},emit:function(ge){var Ee=this,Fe=this.state;function ot(wt){Ee.manager.emit(wt,ge)}Fe<Qt&&ot(Ee.options.event+Mt(Fe)),ot(Ee.options.event),ge.additionalEvent&&ot(ge.additionalEvent),Fe>=Qt&&ot(Ee.options.event+Mt(Fe))},tryEmit:function(ge){if(this.canEmit())return this.emit(ge);this.state=Ot},canEmit:function(){for(var ge=0;ge<this.requireFail.length;){if(!(this.requireFail[ge].state&(Ot|rn)))return!1;ge++}return!0},recognize:function(ge){var Ee=Z({},ge);if(!de(this.options.enable,[this,Ee])){this.reset(),this.state=Ot;return}this.state&(on|vn|Ot)&&(this.state=rn),this.state=this.process(Ee),this.state&(jt|dn|Qt|vn)&&this.tryEmit(Ee)},process:function(ge){},getTouchAction:function(){},reset:function(){}};function Mt(ge){return ge&vn?"cancel":ge&Qt?"end":ge&dn?"move":ge&jt?"start":""}function Se(ge){return ge==yi?"down":ge==$n?"up":ge==vt?"left":ge==ei?"right":""}function An(ge,Ee){var Fe=Ee.manager;return Fe?Fe.get(ge):ge}function ar(){Oe.apply(this,arguments)}te(ar,Oe,{defaults:{pointers:1},attrTest:function(ge){var Ee=this.options.pointers;return Ee===0||ge.pointers.length===Ee},process:function(ge){var Ee=this.state,Fe=ge.eventType,ot=Ee&(jt|dn),wt=this.attrTest(ge);return ot&&(Fe&nn||!wt)?Ee|vn:ot||wt?Fe&xt?Ee|Qt:Ee&jt?Ee|dn:jt:Ot}});function ni(){ar.apply(this,arguments),this.pX=null,this.pY=null}te(ni,ar,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ki},getTouchAction:function(){var ge=this.options.direction,Ee=[];return ge&li&&Ee.push(at),ge&ti&&Ee.push(We),Ee},directionTest:function(ge){var Ee=this.options,Fe=!0,ot=ge.distance,wt=ge.direction,Wt=ge.deltaX,kn=ge.deltaY;return wt&Ee.direction||(Ee.direction&li?(wt=Wt===0?Mn:Wt<0?vt:ei,Fe=Wt!=this.pX,ot=Math.abs(ge.deltaX)):(wt=kn===0?Mn:kn<0?$n:yi,Fe=kn!=this.pY,ot=Math.abs(ge.deltaY))),ge.direction=wt,Fe&&ot>Ee.threshold&&wt&Ee.direction},attrTest:function(ge){return ar.prototype.attrTest.call(this,ge)&&(this.state&jt||!(this.state&jt)&&this.directionTest(ge))},emit:function(ge){this.pX=ge.deltaX,this.pY=ge.deltaY;var Ee=Se(ge.direction);Ee&&(ge.additionalEvent=this.options.event+Ee),this._super.emit.call(this,ge)}});function la(){ar.apply(this,arguments)}te(la,ar,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ke]},attrTest:function(ge){return this._super.attrTest.call(this,ge)&&(Math.abs(ge.scale-1)>this.options.threshold||this.state&jt)},emit:function(ge){if(ge.scale!==1){var Ee=ge.scale<1?"in":"out";ge.additionalEvent=this.options.event+Ee}this._super.emit.call(this,ge)}});function De(){Oe.apply(this,arguments),this._timer=null,this._input=null}te(De,Oe,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ie]},process:function(ge){var Ee=this.options,Fe=ge.pointers.length===Ee.pointers,ot=ge.distance<Ee.threshold,wt=ge.deltaTime>Ee.time;if(this._input=ge,!ot||!Fe||ge.eventType&(xt|nn)&&!wt)this.reset();else if(ge.eventType&Nn)this.reset(),this._timer=P(function(){this.state=on,this.tryEmit()},Ee.time,this);else if(ge.eventType&xt)return on;return Ot},reset:function(){clearTimeout(this._timer)},emit:function(ge){this.state===on&&(ge&&ge.eventType&xt?this.manager.emit(this.options.event+"up",ge):(this._input.timeStamp=I(),this.manager.emit(this.options.event,this._input)))}});function Na(){ar.apply(this,arguments)}te(Na,ar,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ke]},attrTest:function(ge){return this._super.attrTest.call(this,ge)&&(Math.abs(ge.rotation)>this.options.threshold||this.state&jt)}});function we(){ar.apply(this,arguments)}te(we,ar,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:li|ti,pointers:1},getTouchAction:function(){return ni.prototype.getTouchAction.call(this)},attrTest:function(ge){var Ee=this.options.direction,Fe;return Ee&(li|ti)?Fe=ge.overallVelocity:Ee&li?Fe=ge.overallVelocityX:Ee&ti&&(Fe=ge.overallVelocityY),this._super.attrTest.call(this,ge)&&Ee&ge.offsetDirection&&ge.distance>this.options.threshold&&ge.maxPointers==this.options.pointers&&w(Fe)>this.options.velocity&&ge.eventType&xt},emit:function(ge){var Ee=Se(ge.offsetDirection);Ee&&this.manager.emit(this.options.event+Ee,ge),this.manager.emit(this.options.event,ge)}});function No(){Oe.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}te(No,Oe,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Pe]},process:function(ge){var Ee=this.options,Fe=ge.pointers.length===Ee.pointers,ot=ge.distance<Ee.threshold,wt=ge.deltaTime<Ee.time;if(this.reset(),ge.eventType&Nn&&this.count===0)return this.failTimeout();if(ot&&wt&&Fe){if(ge.eventType!=xt)return this.failTimeout();var Wt=this.pTime?ge.timeStamp-this.pTime<Ee.interval:!0,kn=!this.pCenter||xr(this.pCenter,ge.center)<Ee.posThreshold;this.pTime=ge.timeStamp,this.pCenter=ge.center,!kn||!Wt?this.count=1:this.count+=1,this._input=ge;var Pi=this.count%Ee.taps;if(Pi===0)return this.hasRequireFailures()?(this._timer=P(function(){this.state=on,this.tryEmit()},Ee.interval,this),jt):on}return Ot},failTimeout:function(){return this._timer=P(function(){this.state=Ot},this.options.interval,this),Ot},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==on&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function xs(ge,Ee){return Ee=Ee||{},Ee.recognizers=ve(Ee.recognizers,xs.defaults.preset),new Aa(ge,Ee)}xs.VERSION="2.0.7",xs.defaults={domEvents:!1,touchAction:Le,enable:!0,inputTarget:null,inputClass:null,preset:[[Na,{enable:!1}],[la,{enable:!1},["rotate"]],[we,{direction:li}],[ni,{direction:li},["swipe"]],[No],[No,{event:"doubletap",taps:2},["tap"]],[De]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Ua=1,Va=2;function Aa(ge,Ee){this.options=Z({},xs.defaults,Ee||{}),this.options.inputTarget=this.options.inputTarget||ge,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ge,this.input=Fr(this),this.touchAction=new ht(this,this.options.touchAction),ml(this,!0),U(this.options.recognizers,function(Fe){var ot=this.add(new Fe[0](Fe[1]));Fe[2]&&ot.recognizeWith(Fe[2]),Fe[3]&&ot.requireFailure(Fe[3])},this)}Aa.prototype={set:function(ge){return Z(this.options,ge),ge.touchAction&&this.touchAction.update(),ge.inputTarget&&(this.input.destroy(),this.input.target=ge.inputTarget,this.input.init()),this},stop:function(ge){this.session.stopped=ge?Va:Ua},recognize:function(ge){var Ee=this.session;if(!Ee.stopped){this.touchAction.preventDefaults(ge);var Fe,ot=this.recognizers,wt=Ee.curRecognizer;(!wt||wt&&wt.state&on)&&(wt=Ee.curRecognizer=null);for(var Wt=0;Wt<ot.length;)Fe=ot[Wt],Ee.stopped!==Va&&(!wt||Fe==wt||Fe.canRecognizeWith(wt))?Fe.recognize(ge):Fe.reset(),!wt&&Fe.state&(jt|dn|Qt)&&(wt=Ee.curRecognizer=Fe),Wt++}},get:function(ge){if(ge instanceof Oe)return ge;for(var Ee=this.recognizers,Fe=0;Fe<Ee.length;Fe++)if(Ee[Fe].options.event==ge)return Ee[Fe];return null},add:function(ge){if(L(ge,"add",this))return this;var Ee=this.get(ge.options.event);return Ee&&this.remove(Ee),this.recognizers.push(ge),ge.manager=this,this.touchAction.update(),ge},remove:function(ge){if(L(ge,"remove",this))return this;if(ge=this.get(ge),ge){var Ee=this.recognizers,Fe=Ve(Ee,ge);Fe!==-1&&(Ee.splice(Fe,1),this.touchAction.update())}return this},on:function(ge,Ee){if(ge!==r&&Ee!==r){var Fe=this.handlers;return U(tt(ge),function(ot){Fe[ot]=Fe[ot]||[],Fe[ot].push(Ee)}),this}},off:function(ge,Ee){if(ge!==r){var Fe=this.handlers;return U(tt(ge),function(ot){Ee?Fe[ot]&&Fe[ot].splice(Ve(Fe[ot],Ee),1):delete Fe[ot]}),this}},emit:function(ge,Ee){this.options.domEvents&&ua(ge,Ee);var Fe=this.handlers[ge]&&this.handlers[ge].slice();if(!(!Fe||!Fe.length)){Ee.type=ge,Ee.preventDefault=function(){Ee.srcEvent.preventDefault()};for(var ot=0;ot<Fe.length;)Fe[ot](Ee),ot++}},destroy:function(){this.element&&ml(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ml(ge,Ee){var Fe=ge.element;if(Fe.style){var ot;U(ge.options.cssProps,function(wt,Wt){ot=gt(Fe.style,Wt),Ee?(ge.oldCssProps[ot]=Fe.style[ot],Fe.style[ot]=wt):Fe.style[ot]=ge.oldCssProps[ot]||""}),Ee||(ge.oldCssProps={})}}function ua(ge,Ee){var Fe=n.createEvent("Event");Fe.initEvent(ge,!0,!0),Fe.gesture=Ee,Ee.target.dispatchEvent(Fe)}Z(xs,{INPUT_START:Nn,INPUT_MOVE:bi,INPUT_END:xt,INPUT_CANCEL:nn,STATE_POSSIBLE:rn,STATE_BEGAN:jt,STATE_CHANGED:dn,STATE_ENDED:Qt,STATE_RECOGNIZED:on,STATE_CANCELLED:vn,STATE_FAILED:Ot,DIRECTION_NONE:Mn,DIRECTION_LEFT:vt,DIRECTION_RIGHT:ei,DIRECTION_UP:$n,DIRECTION_DOWN:yi,DIRECTION_HORIZONTAL:li,DIRECTION_VERTICAL:ti,DIRECTION_ALL:Ki,Manager:Aa,Input:Hn,TouchAction:ht,TouchInput:Vr,MouseInput:Tn,PointerEventInput:qe,TouchMouseInput:K,SingleTouchInput:or,Recognizer:Oe,AttrRecognizer:ar,Tap:No,Pan:ni,Swipe:we,Pinch:la,Rotate:Na,Press:De,on:Me,off:He,each:U,merge:Y,extend:ae,assign:Z,inherit:te,bindFn:re,prefixed:gt});var Ji=typeof e<"u"?e:typeof self<"u"?self:{};Ji.Hammer=xs,typeof r=="function"&&r.amd?r(function(){return xs}):t.exports?t.exports=xs:e[i]=xs})(window,document,"Hammer")})(VR);var Qg=VR.exports;const jX=Z_(Qg),wA=gN({__proto__:null,default:jX},[Qg]),GR=1,jR=2,jb=4,$X={mousedown:GR,mousemove:jR,mouseup:jb};function HX(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function WX(t){const e=t.prototype.handler;t.prototype.handler=function(i){const r=this.store;i.button>0&&i.type==="pointerdown"&&(HX(r,s=>s.pointerId===i.pointerId)||r.push(i)),e.call(this,i)}}function QX(t){t.prototype.handler=function(n){let i=$X[n.type];i&GR&&n.button>=0&&(this.pressed=!0),i&jR&&n.which===0&&(i=jb),this.pressed&&(i&jb&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}WX(Qg.PointerEventInput);QX(Qg.MouseInput);const qX=Qg.Manager;class g2{constructor(e,n,i){this.element=e,this.callback=n,this.options={enable:!0,...i}}}const ZX=wA?[[wA.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[wA.Rotate,{enable:!1}],[wA.Pinch,{enable:!1}],[wA.Swipe,{enable:!1}],[wA.Pan,{threshold:0,enable:!1}],[wA.Press,{enable:!1}],[wA.Tap,{event:"doubletap",taps:2,enable:!1}],[wA.Tap,{event:"anytap",enable:!1}],[wA.Tap,{enable:!1}]]:null,tP={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},YX={doubletap:["tap"]},XX={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},_T={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},KX={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},nP={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},JX=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",J0=typeof window<"u"?window:global;let $b=!1;try{const t={get passive(){return $b=!0,!0}};J0.addEventListener("test",null,t),J0.removeEventListener("test",null)}catch{$b=!1}const eK=JX.indexOf("firefox")!==-1,{WHEEL_EVENTS:tK}=_T,iP="wheel",rP=4.000244140625,nK=40,iK=.25;class rK extends g2{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{if(!this.options.enable)return;let s=r.deltaY;J0.WheelEvent&&(eK&&r.deltaMode===J0.WheelEvent.DOM_DELTA_PIXEL&&(s/=J0.devicePixelRatio),r.deltaMode===J0.WheelEvent.DOM_DELTA_LINE&&(s*=nK)),s!==0&&s%rP===0&&(s=Math.floor(s/rP)),r.shiftKey&&s&&(s=s*iK),this.callback({type:iP,center:{x:r.clientX,y:r.clientY},delta:-s,srcEvent:r,pointerType:"mouse",target:r.target})},this.events=(this.options.events||[]).concat(tK),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,$b?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===iP&&(this.options.enable=n)}}const{MOUSE_EVENTS:sK}=_T,sP="pointermove",oP="pointerover",aP="pointerout",lP="pointerenter",AP="pointerleave";class oK extends g2{constructor(e,n,i){super(e,n,i),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(sK),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===sP&&(this.enableMoveEvent=n),e===oP&&(this.enableOverEvent=n),e===aP&&(this.enableOutEvent=n),e===lP&&(this.enableEnterEvent=n),e===AP&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(oP,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(aP,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(lP,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(AP,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(sP,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:aK}=_T,uP="keydown",cP="keyup";class lK extends g2{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{const s=r.target||r.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&r.type==="keydown"&&this.callback({type:uP,srcEvent:r,key:r.key,target:r.target}),this.enableUpEvent&&r.type==="keyup"&&this.callback({type:cP,srcEvent:r,key:r.key,target:r.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(aK),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===uP&&(this.enableDownEvent=n),e===cP&&(this.enableUpEvent=n)}}const hP="contextmenu";class AK extends g2{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{this.options.enable&&this.callback({type:hP,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===hP&&(this.options.enable=n)}}const Hb=1,i_=2,Wb=4,uK={pointerdown:Hb,pointermove:i_,pointerup:Wb,mousedown:Hb,mousemove:i_,mouseup:Wb},cK=1,hK=2,fK=3,dK=0,pK=1,gK=2,mK=1,yK=2,_K=4;function vK(t){const e=uK[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i,which:r}=t.srcEvent;let s=!1,u=!1,a=!1;return e===Wb||e===i_&&!Number.isFinite(n)?(s=r===cK,u=r===hK,a=r===fK):e===i_?(s=!!(n&mK),u=!!(n&_K),a=!!(n&yK)):e===Hb&&(s=i===dK,u=i===pK,a=i===gK),{leftButton:s,middleButton:u,rightButton:a}}function xK(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,s=i.height/e.offsetHeight||1,u={x:(n.x-i.left-e.clientLeft)/r,y:(n.y-i.top-e.clientTop)/s};return{center:n,offsetCenter:u}}const Fx={srcElement:"root",priority:0};class wK{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let r=n.srcEvent.target;for(;r&&r!==i.rootElement;){if(this._emit(i,r),i.handled)return;r=r.parentNode}this._emit(i,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,i,r=!1,s=!1){const{handlers:u,handlersByElement:a}=this;let y=Fx;typeof i=="string"||i&&i.addEventListener?y={...Fx,srcElement:i}:i&&(y={...Fx,...i});let w=a.get(y.srcElement);w||(w=[],a.set(y.srcElement,w));const I={type:e,handler:n,srcElement:y.srcElement,priority:y.priority};r&&(I.once=!0),s&&(I.passive=!0),u.push(I),this._active=this._active||!I.passive;let P=w.length-1;for(;P>=0&&!(w[P].priority>=I.priority);)P--;w.splice(P+1,0,I)}remove(e,n){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const u=i[s];if(u.type===e&&u.handler===n){i.splice(s,1);const a=r.get(u.srcElement);a.splice(a.indexOf(u),1),a.length===0&&r.delete(u.srcElement)}}this._active=i.some(s=>!s.passive)}_emit(e,n){const i=this.handlersByElement.get(n);if(i){let r=!1;const s=()=>{e.handled=!0},u=()=>{e.handled=!0,r=!0},a=[];for(let y=0;y<i.length;y++){const{type:w,handler:I,once:P}=i[y];if(I({...e,type:w,stopPropagation:s,stopImmediatePropagation:u}),P&&a.push(i[y]),r)break}for(let y=0;y<a.length;y++){const{type:w,handler:I}=a[y];this.remove(w,I)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...vK(e),...xK(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const bK={events:null,recognizers:null,recognizerOptions:{},Manager:qX,touchAction:"none",tabIndex:0};class EK{constructor(e=null,n){this._onBasicInput=r=>{const{srcEvent:s}=r,u=XX[s.type];u&&this.manager.emit(u,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={...bK,...n},this.events=new Map,this.setElement(e);const{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,i=n.Manager;this.manager=new i(e,{touchAction:n.touchAction,recognizers:n.recognizers||ZX}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(tP).forEach(r=>{const s=this.manager.get(r);s&&tP[r].forEach(u=>{s.recognizeWith(u)})});for(const r in n.recognizerOptions){const s=this.manager.get(r);if(s){const u=n.recognizerOptions[r];delete u.enable,s.set(u)}}this.wheelInput=new rK(e,this._onOtherEvent,{enable:!1}),this.moveInput=new oK(e,this._onOtherEvent,{enable:!1}),this.keyInput=new lK(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new AK(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,i){this._addEventHandler(e,n,i,!1)}once(e,n,i){this._addEventHandler(e,n,i,!0)}watch(e,n,i){this._addEventHandler(e,n,i,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==n){r.set({enable:n});const s=YX[e];s&&!this.options.recognizers&&s.forEach(u=>{const a=i.get(u);n?(a.requireFailure(e),r.dropRequireFailure(u)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,i,r,s){if(typeof e!="string"){i=n;for(const I in e)this._addEventHandler(I,e[I],i,r,s);return}const{manager:u,events:a}=this,y=nP[e]||e;let w=a.get(y);w||(w=new wK(this),a.set(y,w),w.recognizerName=KX[y]||y,u&&u.on(y,w.handleEvent)),w.add(e,n,i,r,s),w.isEmpty()||this._toggleRecognizer(w.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const u in e)this._removeEventHandler(u,e[u]);return}const{events:i}=this,r=nP[e]||e,s=i.get(r);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:u}=s;let a=!1;for(const y of i.values())if(y.recognizerName===u&&!y.isEmpty()){a=!0;break}a||this._toggleRecognizer(u,!1)}}}function ph(){}const TK=({isDragging:t})=>t?"grabbing":"grab",$R={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:ph,onResize:ph,onViewStateChange:ph,onInteractionStateChange:ph,onBeforeRender:ph,onAfterRender:ph,onLoad:ph,onError:t=>si.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:TK,getTooltip:null,debug:!1,drawPickingColors:!1};class m2{constructor(e){oe(this,"props",void 0),oe(this,"width",0),oe(this,"height",0),oe(this,"userData",{}),oe(this,"canvas",null),oe(this,"viewManager",null),oe(this,"layerManager",null),oe(this,"effectManager",null),oe(this,"deckRenderer",null),oe(this,"deckPicker",null),oe(this,"eventManager",null),oe(this,"tooltip",null),oe(this,"metrics",void 0),oe(this,"animationLoop",void 0),oe(this,"stats",void 0),oe(this,"viewState",void 0),oe(this,"cursorState",void 0),oe(this,"_needsRedraw",void 0),oe(this,"_pickRequest",void 0),oe(this,"_lastPointerDownInfo",null),oe(this,"_metricsCounter",void 0),oe(this,"_onPointerMove",n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const r=n.offsetCenter;if(!r)return;i.x=r.x,i.y=r.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n}),oe(this,"_onEvent",n=>{const i=FM[n.type],r=n.offsetCenter;if(!i||!r||!this.layerManager)return;const s=this.layerManager.getLayers(),u=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:s,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:a}=u,y=a&&(a[i.handler]||a.props[i.handler]),w=this.props[i.handler];let I=!1;y&&(I=y.call(a,u,n)),!I&&w&&w(u,n)}),oe(this,"_onPointerDown",n=>{const i=n.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo}),this.props={...$R,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&si.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),nj()==="IE"&&si.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new BR({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&jf.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,i,r,s,u,a,y;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(i=this.viewManager)===null||i===void 0||i.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(u=this.deckPicker)===null||u===void 0||u.finalize(),this.deckPicker=null,(a=this.eventManager)===null||a===void 0||a.destroy(),this.eventManager=null,(y=this.tooltip)===null||y===void 0||y.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var w;(w=this.canvas.parentElement)===null||w===void 0||w.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&si.removed("onLayerHover","onHover")(),"onLayerClick"in e&&si.removed("onLayerClick","onClick")(),e.initialViewState&&!ql(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),u=this.deckRenderer.needsRedraw(e);return n=n||i||r||s||u,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return gs(this.viewManager),this.viewManager.views}getViewports(e){return gs(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,i){gs(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return r.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),gs(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:i}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(i||i===0){var r;const s=Number.isFinite(i)?"".concat(i,"px"):i;this.canvas.style.position=((r=e.style)===null||r===void 0?void 0:r.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:i}=this;if(!i)return;const r=(e=i.clientWidth)!==null&&e!==void 0?e:i.width,s=(n=i.clientHeight)!==null&&n!==void 0?n:i.height;if(r!==this.width||s!==this.height){var u,a;this.width=r,this.height=s,(u=this.viewManager)===null||u===void 0||u.setProps({width:r,height:s}),(a=this.layerManager)===null||a===void 0||a.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:s})}}_createAnimationLoop(e){const{width:n,height:i,gl:r,glOptions:s,debug:u,onError:a,onBeforeRender:y,onAfterRender:w,useDevicePixels:I}=e;return new CW({width:n,height:i,useDevicePixels:I,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,gl:r,onCreateContext:P=>ED({...s,...P,canvas:this.canvas,debug:u,onContextLost:()=>this._onContextLost()}),onInitialize:P=>this._setGLContext(P.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:y,onAfterRender:w,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new FR({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:r}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let s=r,u=!1;for(const a of i){var n;s=a,u=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||u}if(!u&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,tT(e,{enable:!0,copyState:!0})),this.tooltip=new GX(this.canvas),Vu(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new mR;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new EK(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in FM)this.eventManager.on(r,this._onEvent);this.viewManager=new gX({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new pX(e,{deck:this,stats:this.stats,viewport:i,timeline:n}),this.effectManager=new kX,this.deckRenderer=new RX(e),this.deckPicker=new UX(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:i}=this.layerManager.context;Vu(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),si.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const i=Mh.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}oe(m2,"defaultProps",$R);oe(m2,"VERSION",yj);class Nx{constructor(e,n){oe(this,"opts",void 0),oe(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:i}=this.source,{size:r}=n;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const u=n.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[u+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function SK(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function J1(t){return t.stride||t.size*t.bytesPerElement}function HR(t,e){e.offset&&si.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=J1(t),i=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,r=e.elementOffset||0,s=i*n+r*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function MK(t,e){const n=HR(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class CK{constructor(e,n,i){oe(this,"gl",void 0),oe(this,"id",void 0),oe(this,"size",void 0),oe(this,"settings",void 0),oe(this,"value",void 0),oe(this,"doublePrecision",void 0),oe(this,"_buffer",void 0),oe(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const r=n.logicalType||n.type,s=r===5130;let{defaultValue:u}=n;u=Number.isFinite(u)?[u]:u||new Array(this.size).fill(0);let a;s?a=5126:!r&&n.isIndexed?a=e&&BD(e,Yi.ELEMENT_INDEX_UINT32)?5125:5123:a=r||5126;let y=SK(r||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(y=Float32Array),this.value=null,this.settings={...n,defaultType:y,defaultValue:u,logicalType:r,type:a,size:this.size,bytesPerElement:y.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new Fi(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*J1(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),jf.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=MK(this.getAccessor(),n||{});return i[e]=new Nx(this,s.high),i["".concat(e,"64Low")]=r?new Nx(this,s.low):new Float32Array(this.size),i}if(n){const i=HR(this.getAccessor(),n);return{[e]:new Nx(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:i,size:r}=this,s=i*r;if(n&&s&&n.length>=s){const u=new Array(r).fill(1/0),a=new Array(r).fill(-1/0);for(let y=0;y<s;)for(let w=0;w<r;w++){const I=n[y++];I<u[w]&&(u[w]=I),I>a[w]&&(a[w]=I)}e=[u,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let i;ArrayBuffer.isView(e)?i={value:e}:e instanceof Fi?i={buffer:e}:i=e;const r={...this.settings,...i};if(n.bufferAccessor=r,n.bounds=null,i.constant){let s=i.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(i.buffer){const s=i.buffer;n.externalBuffer=s,n.constant=!1,this.value=i.value||null;const u=i.value instanceof Float64Array;r.type=i.type||s.accessor.type,r.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(u?2:1),r.stride=J1(r)}else if(i.value){this._checkExternalBuffer(i);let s=i.value;n.externalBuffer=null,n.constant=!1,this.value=s,r.bytesPerElement=s.BYTES_PER_ELEMENT,r.stride=J1(r);const{buffer:u,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Bx(s,r));const y=s.byteLength+a+r.stride*2;u.byteLength<y&&u.reallocate(y),u.setAccessor(null),u.subData({data:s,offset:a}),r.type=i.type||u.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Bx(n,{size:this.size,startIndex:i,endIndex:r}):n.subarray(i,r),offset:i*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:i}=this,r=i.allocatedValue,s=jf.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:u,byteOffset:a}=this;return u.byteLength<s.byteLength+a&&(u.reallocate(s.byteLength+a),n&&r&&u.subData({data:r instanceof Float64Array?Bx(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const i=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=n.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof i)&&this.settings.normalized&&!("normalized"in e)&&si.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return n[i]=e,n;if(!e){let u=s;for(;--u>=0;)n[i+u]=r[u];return n}switch(s){case 4:n[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:n[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:n[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:n[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let u=s;for(;--u>=0;)n[i+u]=Number.isFinite(e[u])?e[u]:r[u]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==n[r])return!1;return!0}}const fP=[],dP=[];function cd(t,e=0,n=1/0){let i=fP;const r={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?i=t:t.length>0&&(dP.length=t.length,i=dP):i=fP,(e>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,n),r.index=e-1),{iterable:i,objectInfo:r}}function WR(t){return t&&t[Symbol.asyncIterator]}function QR(t,e){const{size:n,stride:i,offset:r,startIndices:s,nested:u}=e,a=t.BYTES_PER_ELEMENT,y=i?i/a:n,w=r?r/a:0,I=Math.floor((t.length-w)/y);return(P,{index:L,target:U})=>{if(!s){const Y=L*y+w;for(let te=0;te<n;te++)U[te]=t[Y+te];return U}const Q=s[L],Z=s[L+1]||I;let ae;if(u){ae=new Array(Z-Q);for(let Y=Q;Y<Z;Y++){const te=Y*y+w;U=new Array(n);for(let re=0;re<n;re++)U[re]=t[te+re];ae[Y-Q]=U}}else if(y===n)ae=t.subarray(Q*n+w,Z*n+w);else{ae=new t.constructor((Z-Q)*n);let Y=0;for(let te=Q;te<Z;te++){const re=te*y+w;for(let de=0;de<n;de++)ae[Y++]=t[re+de]}}return ae}}const PK=[],ey=[[0,1/0]];function IK(t,e){if(t===ey||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],i=t.length;let r=0;for(let s=0;s<i;s++){const u=t[s];u[1]<e[0]?(n.push(u),r=s+1):u[0]>e[1]?n.push(u):e=[Math.min(u[0],e[0]),Math.max(u[1],e[1])]}return n.splice(r,0,e),n}function Ux(t){const{source:e,target:n,start:i=0,size:r,getData:s}=t,u=t.end||n.length,a=e.length,y=u-i;if(a>y){n.set(e.subarray(0,y),i);return}if(n.set(e,i),!s)return;let w=a;for(;w<y;){const I=s(w,e);for(let P=0;P<r;P++)n[i+w]=I[P]||0,w++}}function kK({source:t,target:e,size:n,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return Ux({source:t,target:e,size:n,getData:i}),e;let u=0,a=0;const y=i&&((I,P)=>i(I+a,P)),w=Math.min(r.length,s.length);for(let I=1;I<w;I++){const P=r[I]*n,L=s[I]*n;Ux({source:t.subarray(u,P),target:e,start:a,end:L,size:n,getData:y}),u=P,a=L}return a<e.length&&Ux({source:[],target:e,start:a,size:n,getData:y}),e}const LK={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function qR(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...LK[n],...e,...t,type:n}}function ZR(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function YR(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function XR(t){t.push(t.shift())}function vT(t,e){const{doublePrecision:n,settings:i,value:r,size:s}=t,u=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*u}function KR({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:r,getData:s=u=>u}){const u=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*u,y=n.byteOffset,w=n.startIndices,I=r&&w,P=vT(n,e),L=n.isConstant;if(!I&&i>=P)return;const U=L?n.value:n.getBuffer().getData({srcByteOffset:y});if(n.settings.normalized&&!L){const Y=s;s=(te,re)=>n.normalizeConstant(Y(te,re))}const Q=L?(Y,te)=>s(U,te):(Y,te)=>s(U.subarray(Y,Y+a),te),Z=t.getData({length:i}),ae=new Float32Array(P);kK({source:Z,target:ae,sourceStartIndices:r,targetStartIndices:w,size:a,getData:Q}),t.byteLength<ae.byteLength+y&&t.reallocate(ae.byteLength+y),t.subData({data:ae,offset:y})}class xT extends CK{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:ey}),oe(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,i=this.settings.transition,r=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return qR(r,i)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:i=0,endRow:r=1/0}=n;this.state.updateRanges=IK(this.state.updateRanges,[i,r])}else this.state.updateRanges=ey}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=PK}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:i}=this;return i.noAlloc?!1:i.update?(super.allocate(e,n.updateRanges!==ey),!0):!1}updateBuffer({numInstances:e,data:n,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:u,noAlloc:a}}=this;let y=!0;if(u){for(const[w,I]of s)u.call(r,this,{data:n,startRow:w,endRow:I,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[w,I]of s){const P=Number.isFinite(w)?this.getVertexOffset(w):0,L=Number.isFinite(I)?this.getVertexOffset(I):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:P,endOffset:L})}this._checkAttributeArray()}else y=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),y}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:i,settings:r}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),r.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const u=e;gs(ArrayBuffer.isView(u.value),"invalid ".concat(r.accessor));const a=!!u.size&&u.size!==this.size;return i.binaryAccessor=QR(u.value,{size:u.size||this.size,stride:u.stride,offset:u.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const i in e)Object.assign(n,super.getShaderAttributes(i,e[i]));return n}_autoUpdater(e,{data:n,startRow:i,endRow:r,props:s,numInstances:u}){if(e.constant)return;const{settings:a,state:y,value:w,size:I,startIndices:P}=e,{accessor:L,transform:U}=a,Q=y.binaryAccessor||(typeof L=="function"?L:s[L]);gs(typeof Q=="function",'accessor "'.concat(L,'" is not a function'));let Z=e.getVertexOffset(i);const{iterable:ae,objectInfo:Y}=cd(n,i,r);for(const te of ae){Y.index++;let re=Q(te,Y);if(U&&(re=U.call(this,re)),P){const de=(Y.index<P.length-1?P[Y.index+1]:u)-P[Y.index];if(re&&Array.isArray(re[0])){let ve=Z;for(const Me of re)e._normalizeValue(Me,w,ve),ve+=I}else re&&re.length>I?w.set(re,Z):(e._normalizeValue(re,Y.target,0),oX({target:w,source:Y.target,start:Z,count:de}));Z+=de*I}else e._normalizeValue(re,w,Z),Z+=I}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let i=!0;switch(n){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class DK{constructor({gl:e,attribute:n,timeline:i}){oe(this,"gl",void 0),oe(this,"type","interpolation"),oe(this,"attributeInTransition",void 0),oe(this,"settings",void 0),oe(this,"attribute",void 0),oe(this,"transition",void 0),oe(this,"currentStartIndices",void 0),oe(this,"currentLength",void 0),oe(this,"transform",void 0),oe(this,"buffers",void 0),this.gl=e,this.transition=new Wg(i),this.attribute=n,this.attributeInTransition=new xT(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=BK(e,n);const r={byteLength:0,usage:35050};this.buffers=[new Fi(e,r),new Fi(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:i,buffers:r,attribute:s}=this;XR(r);const u={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)KR({buffer:a,...u});this.currentStartIndices=s.startIndices,this.currentLength=vT(s,n),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:ZR(i,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:i}=this.settings,{time:r}=this.transition;let s=r/n;i&&(s=i(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const RK=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function BK(t,e){const n=YR(e.size);return new fT(t,{vs:RK,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class zK{constructor({gl:e,attribute:n,timeline:i}){oe(this,"gl",void 0),oe(this,"type","spring"),oe(this,"attributeInTransition",void 0),oe(this,"settings",void 0),oe(this,"attribute",void 0),oe(this,"transition",void 0),oe(this,"currentStartIndices",void 0),oe(this,"currentLength",void 0),oe(this,"texture",void 0),oe(this,"framebuffer",void 0),oe(this,"transform",void 0),oe(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Wg(i),this.attribute=n,this.attributeInTransition=new xT(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=FK(e),this.framebuffer=NK(e,this.texture),this.transform=OK(e,n,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new Fi(e,r),new Fi(e,r),new Fi(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:i,buffers:r,attribute:s}=this,u={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)KR({buffer:a,...u});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=vT(s,n),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:ZR(i,s)}})}update(){const{buffers:e,transform:n,framebuffer:i,transition:r}=this;if(!r.update())return!1;const u=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:u.stiffness,damping:u.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),XR(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),d2(i)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function OK(t,e,n){const i=YR(e.size);return new fT(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}function FK(t){return new oa(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function NK(t,e){return new es(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const UK={interpolation:DK,spring:zK};class VK{constructor(e,{id:n,timeline:i}){oe(this,"id",void 0),oe(this,"isSupported",void 0),oe(this,"gl",void 0),oe(this,"timeline",void 0),oe(this,"transitions",void 0),oe(this,"needsRedraw",void 0),oe(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=fT.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],u=s.getTransitionSetting(n);u&&this._updateAttribute(r,s,u)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(n))&&this._removeTransition(r)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const i=this.transitions[n];i.inProgress&&(e[n]=i.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported){si.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}r&&this._removeTransition(e);const u=UK[i.type];u?this.transitions[e]=new u({attribute:n,timeline:this.timeline,gl:this.gl}):(si.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const pP="attributeManager.invalidate",GK="attributeManager.updateStart",jK="attributeManager.updateEnd",$K="attribute.updateStart",HK="attribute.allocate",WK="attribute.updateEnd";class QK{constructor(e,{id:n="attribute-manager",stats:i,timeline:r}={}){oe(this,"id",void 0),oe(this,"gl",void 0),oe(this,"attributes",void 0),oe(this,"updateTriggers",void 0),oe(this,"needsRedraw",void 0),oe(this,"userData",void 0),oe(this,"stats",void 0),oe(this,"attributeTransitionManager",void 0),oe(this,"mergeBoundsMemoized",Hg(LY)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new VK(e,{id:"".concat(n,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const i=this._invalidateTrigger(e,n);so(pP,this,e,i)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);so(pP,this,"all")}update({data:e,numInstances:n,startIndices:i=null,transitions:r,props:s={},buffers:u={},context:a={}}){let y=!1;so(GK,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const w in this.attributes){const I=this.attributes[w],P=I.settings.accessor;I.startIndices=i,I.numInstances=n,s[w]&&si.removed("props.".concat(w),"data.attributes.".concat(w))(),I.setExternalBuffer(u[w])||I.setBinaryValue(typeof P=="string"?u[P]:void 0,e.startIndices)||typeof P=="string"&&!u[P]&&I.setConstantValue(s[P])||I.needsUpdate()&&(y=!0,this._updateAttribute({attribute:I,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||I.needsRedraw()}y&&so(jK,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(i=>{var r;return(r=this.attributes[i])===null||r===void 0?void 0:r.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:i}=this,r={...i.getAttributes()};for(const s in n){const u=n[s];u.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=u)}return r}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const i={};for(const r in e)n[r]||Object.assign(i,e[r].getShaderAttributes());return i}_add(e,n={}){for(const i in e){const r=e[i];this.attributes[i]=this._createAttribute(i,r,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,i){const r={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:i.instanced?1:n.divisor||0};return new xT(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(u=>{const a=i[u];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:i}=e;if(so($K,n),n.constant){n.setConstantValue(n.value);return}n.allocate(i)&&so(HK,n,i),n.updateBuffer(e)&&(this.needsRedraw=!0,so(WK,n,i))}}class qK extends Wg{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:i,duration:r,easing:s}}=this,u=s(e/r);this._value=BA(n,i,u)}}const gP=1e-5;function mP(t,e,n,i,r){const s=e-t,a=(n-e)*r,y=-s*i;return a+y+s+e}function ZK(t,e,n,i,r){if(Array.isArray(n)){const s=[];for(let u=0;u<n.length;u++)s[u]=mP(t[u],e[u],n[u],i,r);return s}return mP(t,e,n,i,r)}function yP(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}class YK extends Wg{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:u=e}=this;let a=ZK(s,u,n,i,r);const y=yP(a,n),w=yP(a,u);y<gP&&w<gP&&(a=n,this.end()),this._prevValue=u,this._currValue=a}}const XK={interpolation:qK,spring:YK};class KK{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,i,r){const{transitions:s}=this;if(s.has(e)){const y=s.get(e),{value:w=y.settings.fromValue}=y;n=w,this.remove(e)}if(r=qR(r),!r)return;const u=XK[r.type];if(!u){si.error("unsupported transition type '".concat(r.type,"'"))();return}const a=new u(this.timeline);a.start({...r,fromValue:n,toValue:i}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,i]of this.transitions)i.update(),e[n]=i.value,i.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function JK(t){const e=t[$c];for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function eJ(t,e){const n=JR({newProps:t,oldProps:e,propTypes:t[$c],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=nJ(t,e);let r=!1;return i||(r=iJ(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:rJ(t,e),transitionsChanged:tJ(t,e)}}function tJ(t,e){if(!t.transitions)return!1;const n={},i=t[$c];let r=!1;for(const s in t.transitions){const u=i[s],a=u&&u.type;(a==="number"||a==="color"||a==="array")&&Qb(t[s],e[s],u)&&(n[s]=!0,r=!0)}return r?n:!1}function JR({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(r," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(r,".").concat(s," added");const u=Qb(t[s],e[s],i[s]);if(u)return"".concat(r,".").concat(s," ").concat(u)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const u=Qb(t[s],e[s],i[s]);if(u)return"".concat(r,".").concat(s," ").concat(u)}}return!1}function Qb(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)||!i&&(i=t&&e&&t.equals,i&&!i.call(t,e))?"changed deeply":!i&&e!==t?"changed shallowly":null}function nJ(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;return i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&r&&(n=r(t.data,e.data)||n),n}function iJ(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&_P(t,e,"all"))return{all:!0};const n={};let i=!1;for(const r in t.updateTriggers)r!=="all"&&_P(t,e,r)&&(n[r]=!0,i=!0);return i?n:!1}function rJ(t,e){if(e===null)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i||i.length!==n.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(n[r]))return!0;return!1}function _P(t,e,n){let i=t.updateTriggers[n];i=i??{};let r=e.updateTriggers[n];return r=r??{},JR({oldProps:r,newProps:i,triggerName:n})}const sJ="count(): argument not an object",oJ="count(): argument not a container";function aJ(t){if(!AJ(t))throw new Error(sJ);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(lJ(t))return Object.keys(t).length;throw new Error(oJ)}function lJ(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function AJ(t){return t!==null&&typeof t=="object"}function qb(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(i=>i.name==="project64"))){const i=n.modules.findIndex(r=>r.name==="project32");i>=0&&n.modules.splice(i,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const i={...t.inject};for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];n.inject=i}return n}const uJ={10241:9987,10240:9729,10242:33071,10243:33071},Zb={};function cJ(t,e,n,i){if(n instanceof oa)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let r=null;n.compressed&&(r={10241:n.data.length>1?9985:9729});const s=new oa(e,{...n,parameters:{...uJ,...r,...i}});return Zb[s.id]=t,s}function hJ(t,e){!e||!(e instanceof oa)||Zb[e.id]===t&&(e.delete(),delete Zb[e.id])}const fJ={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Yb(t)&&(t.length===3||t.length===4)},equal(t,e,n){return ql(t,e,1)}},accessor:{validate(t,e){const n=r_(t);return n==="function"||n===r_(e.value)},equal(t,e,n){return typeof e=="function"?!0:ql(t,e,1)}},array:{validate(t,e){return e.optional&&!t||Yb(t)},equal(t,e,n){const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?ql(t,e,r):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?ql(t,e,r):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>{const i=n.context;return!i||!i.gl?null:cJ(n.id,i.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{hJ(n.id,t)}}};function dJ(t){const e={},n={},i={};for(const[r,s]of Object.entries(t)){const u=s?.deprecatedFor;if(u)i[r]=Array.isArray(u)?u:[u];else{const a=pJ(r,s);e[r]=a,n[r]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}function pJ(t,e){switch(r_(e)){case"object":return Xd(t,e);case"array":return Xd(t,{type:"array",value:e,compare:!1});case"boolean":return Xd(t,{type:"boolean",value:e});case"number":return Xd(t,{type:"number",value:e});case"function":return Xd(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Xd(t,e){return"type"in e?{name:t,...fJ[e.type],...e}:"value"in e?{name:t,type:r_(e.value),...e}:{name:t,type:"object",value:e}}function Yb(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function r_(t){return Yb(t)?"array":t===null?"null":typeof t}function gJ(t,e){let n;for(let s=e.length-1;s>=0;s--){const u=e[s];"extensions"in u&&(n=u.extensions)}const i=Xb(t.constructor,n),r=Object.create(i);r[n_]=t,r[$h]={},r[Lc]={};for(let s=0;s<e.length;++s){const u=e[s];for(const a in u)r[a]=u[a]}return Object.freeze(r),r}const mJ="_mergedDefaultProps";function Xb(t,e){let n=mJ;if(e)for(const r of e){const s=r.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const i=eB(t,n);return i||(t[n]=yJ(t,e||[]))}function yJ(t,e){if(!t.prototype)return null;const i=Object.getPrototypeOf(t),r=Xb(i),s=eB(t,"defaultProps")||{},u=dJ(s),a=Object.assign(Object.create(null),r,u.defaultProps),y=Object.assign(Object.create(null),r?.[$c],u.propTypes),w=Object.assign(Object.create(null),r?.[Ox],u.deprecatedProps);for(const I of e){const P=Xb(I.constructor);P&&(Object.assign(a,P),Object.assign(y,P[$c]),Object.assign(w,P[Ox]))}return _J(a,t),xJ(a,y),vJ(a,w),a[$c]=y,a[Ox]=w,e.length===0&&!wT(t,"_propTypes")&&(t._propTypes=y),a}function _J(t,e){const n=bJ(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function vJ(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(n);for(const s of e[n])wT(this,s)||(this[s]=i);si.deprecated(r,e[n].join("/"))()}})}function xJ(t,e){const n={},i={};for(const r in e){const s=e[r],{name:u,value:a}=s;s.async&&(n[u]=a,i[u]=wJ(u))}t[wf]=n,t[$h]={},Object.defineProperties(t,i)}function wJ(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||WR(e)?this[$h][t]=e:this[Lc][t]=e},get(){if(this[Lc]){if(t in this[Lc])return this[Lc][t]||this[wf][t];if(t in this[$h]){const e=this[n_]&&this[n_].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[wf][t]}}return this[wf][t]}}}function wT(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function eB(t,e){return wT(t,e)&&t[e]}function bJ(t){const e=t.componentName;return e||si.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let EJ=0;class bT{constructor(...e){oe(this,"id",void 0),oe(this,"props",void 0),oe(this,"count",void 0),this.props=gJ(this,e),this.id=this.props.id,this.count=EJ++}clone(e){const{props:n}=this,i={};for(const r in n[wf])r in n[Lc]?i[r]=n[Lc][r]:r in n[$h]&&(i[r]=n[$h][r]);return new this.constructor({...n,...i,...e})}}oe(bT,"componentName","Component");oe(bT,"defaultProps",{});const TJ=Object.freeze({});class SJ{constructor(e){oe(this,"component",void 0),oe(this,"onAsyncPropUpdated",void 0),oe(this,"asyncProps",void 0),oe(this,"oldProps",void 0),oe(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||TJ}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[n_]||this.component;const n=e[Lc]||{},i=e[$h]||e,r=e[wf]||{};for(const s in n){const u=n[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,u),n[s]=this.getAsyncProp(s)}for(const s in i){const u=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,u)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(WR(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const i=this.asyncProps[e];return n===i.resolvedValue||n===i.lastValue?!1:(i.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(n=this._postProcessValue(i,n),i.resolvedValue=n,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,n,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),r.resolvedValue=n,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const r=i.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const i=this.asyncProps[e];if(!i)return;i.pendingLoadCount++;const r=i.pendingLoadCount;let s=[],u=0;for await(const a of n){if(!this.component)return;const{dataTransform:y}=this.component.props;y?s=y(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:u,endRow:s.length}]}),u=s.length,this._setAsyncPropValue(e,s,r)}this._onResolve(e,s)}_postProcessValue(e,n){const i=e.type;return i&&this.component&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(n,i,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const r=this.component&&this.component.props[$c];this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class MJ extends SJ{constructor({attributeManager:e,layer:n}){super(n),oe(this,"attributeManager",void 0),oe(this,"needsRedraw",void 0),oe(this,"needsUpdate",void 0),oe(this,"subLayers",void 0),oe(this,"usesPickingColorCache",void 0),oe(this,"hasPickingBuffer",void 0),oe(this,"changeFlags",void 0),oe(this,"viewport",void 0),oe(this,"uniformTransitions",void 0),oe(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const i=this.layer,r=i?.props.fetch;return r?r(n,{propName:e,layer:i}):super._fetch(e,n)}_onResolve(e,n){const i=this.layer;if(i){const r=i.props.onDataLoad;e==="data"&&r&&r(n,{propName:e,layer:i})}}_onError(e,n){const i=this.layer;i&&i.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const CJ="layer.changeFlag",PJ="layer.initialize",IJ="layer.update",kJ="layer.finalize",LJ="layer.matched",vP=2**24-1,DJ=Object.freeze([]),RJ=Hg(({oldViewport:t,viewport:e})=>t.equals(e));let bA=new Uint8ClampedArray(0);const BJ={data:{type:"data",value:DJ,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:u}=n.context;if(r=r||n.getLoadOptions(),i=i||n.props.loaders,s){var a;r={...r,fetch:{...(a=r)===null||a===void 0?void 0:a.fetch,signal:s}}}let y=u.contains(t);return!y&&!r&&(u.add({resourceId:t,data:$y(t,i),persistent:!1}),y=!0),y?u.subscribe({resourceId:t,onChange:w=>{var I;return(I=n.internalState)===null||I===void 0?void 0:I.reloadAsyncProp(e,w)},consumerId:n.id,requestId:e}):$y(t,i,r)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Ai.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class iA extends bT{constructor(...e){super(...e),oe(this,"internalState",null),oe(this,"lifecycle",N0.NO_STATE),oe(this,"context",void 0),oe(this,"state",void 0),oe(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){gs(this.internalState);const n=this.internalState.viewport||this.context.viewport,i=LR(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,s,u]=CR(i,n.pixelProjectionMatrix);return e.length===2?[r,s]:[r,s,u]}unproject(e){return gs(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){gs(this.internalState);const i=this.internalState.viewport||this.context.viewport;return FY(e,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Ai.DEFAULT||e===Ai.LNGLAT||e===Ai.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){gs(e instanceof Uint8Array);const[n,i,r]=e;return n+i*256+r*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:aJ(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=qb(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&n)if(Array.isArray(i))for(const r of i)n.invalidateAll(r);else n.invalidateAll();if(n){const{props:r}=e,s=this.internalState.hasPickingBuffer,u=Number.isInteger(r.highlightedObjectIndex)||r.pickable||r.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==u){this.internalState.hasPickingBuffer=u;const{pickingColors:a,instancePickingColors:y}=n.attributes,w=a||y;w&&(u&&w.constant&&(w.constant=!1,n.invalidate(w.id)),!w.value&&!u&&(w.constant=!0,w.value=[0,0,0]))}}}finalizeState(e){for(const i of this.getModels())i.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:i}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,n){var i,r;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((i=(r=this.props).onError)!==null&&i!==void 0&&i.call(r,e))){var s,u;(s=this.context)===null||s===void 0||(u=s.onError)===null||u===void 0||u.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!RJ({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,i=this.getNumInstances(),r=this.getStartIndices();e.update({data:n.data,numInstances:i,startIndices:r,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),i=Object.create(this.props);for(const r in n)Object.defineProperty(i,r,{value:n[r]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const i=Math.floor(bA.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>vP&&si.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),bA=jf.allocate(bA,n,{size:3,copy:!0,maxCount:Math.max(n,vP)});const r=Math.floor(bA.length/3),s=[];for(let u=i;u<r;u++)this.encodePickingColor(u,s),bA[u*3+0]=s[0],bA[u*3+1]=s[1],bA[u*3+2]=s[2]}e.value=bA.subarray(0,n*3)}_setModelAttributes(e,n){const i=this.getAttributeManager(),r=e.userData.excludeAttributes||{},s=i.getShaderAttributes(n,r);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,u=s&&n.attributes&&n.attributes[s.id];if(u&&u.value){const a=u.value,y=this.encodePickingColor(e);for(let w=0;w<n.length;w++){const I=s.getVertexOffset(w);a[I]===y[0]&&a[I+1]===y[1]&&a[I+2]===y[2]&&this._disablePickingIndex(w)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,r=n||i;if(!r)return;const s=r.getVertexOffset(e),u=r.getVertexOffset(e+1);r.buffer.subData({data:new Uint8Array(u-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==bA.buffer&&(i.value=bA.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){gs(!this.internalState),gs(Number.isFinite(this.props.coordinateSystem)),so(PJ,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new MJ({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(si.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new KK(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){so(LJ,this,this===e);const{state:n,internalState:i}=e;this!==e&&(this.internalState=i,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(so(IJ,this,e),!e)return;const n=this.props,i=this.context,r=this.internalState,s=i.viewport,u=this._updateUniformTransition();r.propsInTransition=u,i.viewport=r.viewport||s,this.props=u;try{const a=this._getUpdateParams(),y=this.getModels();if(i.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const I of this.props.extensions)I.updateState.call(this,a,I);const w=this.getModels()[0]!==y[0];this._postUpdate(a,w)}finally{i.viewport=s,this.props=n,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){so(kJ,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const r=this.props,s=this.context;this.props=this.internalState.propsInTransition||r;const u=this.props.opacity;n.opacity=Math.pow(u,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,y=a&&a(n)||[0,0];Vu(s.gl,{polygonOffset:y}),Jl(s.gl,i,()=>{const w={moduleParameters:e,uniforms:n,parameters:i,context:s};for(const I of this.props.extensions)I.draw.call(this,w,I);this.draw(w)})}finally{this.props=r}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const r in e)if(e[r]){let s=!1;switch(r){case"dataChanged":const u=e[r],a=n[r];u&&Array.isArray(a)&&(n.dataChanged=Array.isArray(u)?a.concat(u):u,s=!0);default:n[r]||(n[r]=e[r],s=!0)}s&&so(CJ,this,r,e)}const i=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=i,n.somethingChanged=i||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const i=eJ(e,n);if(i.updateTriggersChanged)for(const s in i.updateTriggersChanged)i.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(i.transitionsChanged)for(const s in i.transitionsChanged){var r;this.internalState.uniformTransitions.add(s,n[s],e[s],(r=e.transitions)===null||r===void 0?void 0:r[s])}return this.setChangeFlags(i)}validateProps(){JK(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&typeof i=="function"&&(n.pickingHighlightColor=i(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new QK(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:i,oldProps:r}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s?.setInstanceCount(this.getNumInstances());const{autoHighlight:u,highlightedObjectIndex:a,highlightColor:y}=i;if(n||r.autoHighlight!==u||r.highlightedObjectIndex!==a||r.highlightColor!==y){const w={};u||(w.pickingSelectedColor=null),Array.isArray(y)&&(w.pickingHighlightColor=y),(n||a!==r.highlightedObjectIndex)&&(w.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(w)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const i=this.getAttributeManager(),r=i?i.getNeedsRedraw(e):!1;if(n=n||r,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}oe(iA,"defaultProps",BJ);oe(iA,"layerName","Layer");const zJ="compositeLayer.renderLayers";class Kn extends iA{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||n}getSubLayerRow(e,n,i){return e.__source={parent:this,object:n,index:i},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(i,r)=>i&&i.__source?(n.index=i.__source.index,e(i.__source.object,n)):e(i,r)}return e}getSubLayerProps(e={}){var n;const{opacity:i,pickable:r,visible:s,parameters:u,getPolygonOffset:a,highlightedObjectIndex:y,autoHighlight:w,highlightColor:I,coordinateSystem:P,coordinateOrigin:L,wrapLongitude:U,positionFormat:Q,modelMatrix:Z,extensions:ae,fetch:Y,operation:te,_subLayerProps:re}=this.props,de={id:"",updateTriggers:{},opacity:i,pickable:r,visible:s,parameters:u,getPolygonOffset:a,highlightedObjectIndex:y,autoHighlight:w,highlightColor:I,coordinateSystem:P,coordinateOrigin:L,wrapLongitude:U,positionFormat:Q,modelMatrix:Z,extensions:ae,fetch:Y,operation:te},ve=re&&e.id&&re[e.id],Me=ve&&ve.updateTriggers,He=e.id||"sublayer";if(ve){const Qe=this.props[$c],et=e.type?e.type._propTypes:{};for(const tt in ve){const Ve=et[tt]||Qe[tt];Ve&&Ve.type==="accessor"&&(ve[tt]=this.getSubLayerAccessor(ve[tt]))}}Object.assign(de,e,ve),de.id="".concat(this.props.id,"-").concat(He),de.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...Me};for(const Qe of ae){const et=Qe.getSubLayerProps.call(this,Qe);et&&Object.assign(de,et,{updateTriggers:Object.assign(de.updateTriggers,et.updateTriggers)})}return de}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let i=this.internalState.subLayers;const r=!i||this.needsUpdate();if(r){const s=this.renderLayers();i=p2(s,Boolean),this.internalState.subLayers=i}so(zJ,this,r,i);for(const s of i)s.parent=this}}oe(Kn,"layerName","CompositeLayer");const A1=Math.PI/180,xP=180/Math.PI,ty=6370972,ef=256;function OJ(){const t=ef/ty,e=Math.PI/180*ef;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class FJ extends s0{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,nearZMultiplier:s=.1,farZMultiplier:u=2,resolution:a=10}=e;let{height:y,altitude:w=1.5}=e;y=y||1,w=Math.max(.75,w);const I=new ra().lookAt({eye:[0,-w,0],up:[0,0,1]}),P=Math.pow(2,r);I.rotateX(n*A1),I.rotateZ(-i*A1),I.scale(P/y);const L=Math.atan(.5/w),U=ef*2*P/y;super({...e,height:y,viewMatrix:I,longitude:i,latitude:n,zoom:r,distanceScales:OJ(),fovyRadians:L*2,focalDistance:w,near:s,far:Math.min(2,1/U+1)*w*u}),oe(this,"longitude",void 0),oe(this,"latitude",void 0),oe(this,"resolution",void 0),this.latitude=n,this.longitude=i,this.resolution=a}get projectionMode(){return Wl.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,this.height/2],n),r=this.unproject([this.width/2,0],n),s=this.unproject([this.width,this.height/2],n),u=this.unproject([this.width/2,this.height],n);return s[0]<this.longitude&&(s[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],s[0],r[0],u[0]),Math.min(i[1],s[1],r[1],u[1]),Math.max(i[0],s[0],r[0],u[0]),Math.max(i[1],s[1],r[1],u[1])]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,s,u]=e,a=n?s:this.height-s,{pixelUnprojectionMatrix:y}=this;let w;if(Number.isFinite(u))w=Vx(y,[r,a,u,1]);else{const U=Vx(y,[r,a,-1,1]),Q=Vx(y,[r,a,1,1]),Z=((i||0)/ty+1)*ef,ae=Cx(rR([],U,Q)),Y=Cx(U),te=Cx(Q),de=4*((4*Y*te-(ae-Y-te)**2)/16)/ae,ve=Math.sqrt(Y-de),Me=Math.sqrt(Math.max(0,Z*Z-de)),He=(ve-Me)/Math.sqrt(ae);w=jQ([],U,Q,He)}const[I,P,L]=this.unprojectPosition(w);return Number.isFinite(u)?[I,P,L]:Number.isFinite(i)?[I,P,i]:[I,P]}projectPosition(e){const[n,i,r=0]=e,s=n*A1,u=i*A1,a=Math.cos(u),y=(r/ty+1)*ef;return[Math.sin(s)*a*y,-Math.cos(s)*a*y,Math.sin(u)*y]}unprojectPosition(e){const[n,i,r]=e,s=sR(e),u=Math.asin(r/s),y=Math.atan2(n,-i)*xP,w=u*xP,I=(s/ef-1)*ty;return[y,w,I]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const i=this.unproject(n);return{longitude:e[0]-i[0]+this.longitude,latitude:e[1]-i[1]+this.latitude}}}function Vx(t,e){const n=ud([],e,t);return hT(n,n,1/n[3]),n}class y2{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){oe(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&ql(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,i={updateTriggers:{}};for(const r in n)if(r in this.props){const s=n[r],u=this.props[r];i[r]=u,s&&s.type==="accessor"&&(i.updateTriggers[r]=this.props.updateTriggers[r],typeof u=="function"&&(i[r]=this.getSubLayerAccessor(u)))}return i}initializeState(e,n){}updateState(e,n){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,n){}finalizeState(e,n){}}oe(y2,"defaultProps",{});oe(y2,"extensionName","LayerExtension");const Gx={bearing:0,pitch:0,position:[0,0,0]},NJ={speed:1.2,curve:1.414};class hd extends zR{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),oe(this,"opts",void 0),this.opts={...NJ,...e}}interpolateProps(e,n,i){const r=dY(e,n,i,this.opts);for(const s in Gx)r[s]=BA(e[s]||Gx[s],n[s]||Gx[s],i);return r}getDuration(e,n){let{transitionDuration:i}=n;return i==="auto"&&(i=pY(e,n,this.opts)),i}}class tB{constructor(e){oe(this,"opts",void 0),oe(this,"typedArrayManager",void 0),oe(this,"indexStarts",[0]),oe(this,"vertexStarts",[0]),oe(this,"vertexCount",0),oe(this,"instanceCount",0),oe(this,"attributes",void 0),oe(this,"_attributeDefs",void 0),oe(this,"data",void 0),oe(this,"getGeometry",void 0),oe(this,"geometryBuffer",void 0),oe(this,"buffers",void 0),oe(this,"positionSize",void 0),oe(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=jf,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:i={},getGeometry:r,geometryBuffer:s,positionFormat:u,dataChanged:a,normalize:y=!0}=this.opts;if(this.data=n,this.getGeometry=r,this.positionSize=s&&s.size||(u==="XY"?2:3),this.buffers=i,this.normalize=y,s&&(gs(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),y||(i.positions=s)),this.geometryBuffer=i.positions,Array.isArray(a))for(const w of a)this._rebuildGeometry(w);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?QR(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:i,buffers:r,_attributeDefs:s,typedArrayManager:u}=this;for(const a in s)if(a in r)u.release(i[a]),i[a]=null;else{const y=s[a];y.copy=n,i[a]=u.allocate(i[a],e,y)}}_forEachGeometry(e,n,i){const{data:r,getGeometry:s}=this,{iterable:u,objectInfo:a}=cd(r,n,i);for(const y of u){a.index++;const w=s?s(y,a):null;e(w,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:i,instanceCount:r}=this;const{data:s,geometryBuffer:u}=this,{startRow:a=0,endRow:y=1/0}=e||{},w={};if(e||(n=[0],i=[0]),this.normalize||!u)this._forEachGeometry((P,L)=>{const U=P&&this.normalizeGeometry(P);w[L]=U,i[L+1]=i[L]+(U?this.getGeometrySize(U):0)},a,y),r=i[i.length-1];else if(i=s.startIndices,r=i[s.length]||0,ArrayBuffer.isView(u))r=r||u.length/this.positionSize;else if(u instanceof Fi){const P=u.accessor.stride||this.positionSize*4;r=r||u.byteLength/P}else if(u.buffer){const P=u.stride||this.positionSize*4;r=r||u.buffer.byteLength/P}else if(u.value){const P=u.value,L=u.stride/P.BYTES_PER_ELEMENT||this.positionSize;r=r||P.length/L}this._allocate(r,!!e),this.indexStarts=n,this.vertexStarts=i,this.instanceCount=r;const I={};this._forEachGeometry((P,L)=>{const U=w[L]||P;I.vertexStart=i[L],I.indexStart=n[L];const Q=L<i.length-1?i[L+1]:r;I.geometrySize=Q-i[L],I.geometryIndex=L,this.updateGeometryAttributes(U,I)},a,y),this.vertexCount=n[n.length-1]}}const UJ=typeof window<"u"?_t.useLayoutEffect:_t.useEffect,VJ=UJ;function s_(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const GJ={position:"absolute",zIndex:-1};function nB(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>nB(n,e));if(_2(t)){if(jJ(t))return e.style=GJ,_t.cloneElement(t,e);if($J(t))return _t.cloneElement(t,e)}return t}function _2(t){return t&&typeof t=="object"&&"type"in t||!1}function jJ(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function $J(t){const e=t.type;return e&&e.deckGLViewProps}function Kb(t){if(typeof t=="function")return _t.createElement($f,{},t);if(Array.isArray(t))return t.map(Kb);if(_2(t)){if(t.type===_t.Fragment)return Kb(t.props.children);if(s_(t.type,$f))return t}return t}function HJ({children:t,layers:e=[],views:n=null}){const i=[],r=[],s={};return _t.Children.forEach(Kb(t),u=>{if(_2(u)){const a=u.type;if(s_(a,iA)){const y=WJ(a,u.props);r.push(y)}else i.push(u);if(s_(a,$f)&&a!==$f&&u.props.id){const y=new a(u.props);s[y.id]=y}}else u&&i.push(u)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(u=>{s[u.id]=u}):n&&(s[n.id]=n),n=Object.values(s)),e=r.length>0?[...r,...e]:e,{layers:e,children:i,views:n}}function WJ(t,e){const n={},i=t.defaultProps||{};for(const r in e)i[r]!==e[r]&&(n[r]=e[r]);return new t(n)}function QJ({children:t,deck:e,ContextProvider:n}){const{viewManager:i}=e||{};if(!i||!i.views.length)return[];const r={},s=i.views[0].id;for(const u of t){let a=s,y=u;_2(u)&&s_(u.type,$f)&&(a=u.props.id||s,y=u.props.children);const w=i.getViewport(a),I=i.getViewState(a);if(w){I.padding=w.padding;const{x:P,y:L,width:U,height:Q}=w;y=nB(y,{x:P,y:L,width:U,height:Q,viewport:w,viewState:I}),r[a]||(r[a]={viewport:w,children:[]}),r[a].children.push(y)}}return Object.keys(r).map(u=>{const{viewport:a,children:y}=r[u],{x:w,y:I,width:P,height:L}=a,U={position:"absolute",left:w,top:I,width:P,height:L},Q="view-".concat(u),Z=_t.createElement("div",{key:Q,id:Q,style:U},...y);if(n){const ae={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:Y=>{Y.viewId=u,e._onViewStateChange(Y)}};return _t.createElement(n,{key:Q,value:ae},Z)}return Z})}const qJ={mixBlendMode:null};function ZJ({width:t,height:e,style:n}){const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},r={left:0,top:0};if(n)for(const s in n)s in qJ?r[s]=n[s]:i[s]=n[s];return{containerStyle:i,canvasStyle:r}}function YJ(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function iB(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function XJ(t,e,n){const i=new e({...n,_customRender:r=>{t.redrawReason=r;const s=i.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():iB(t)}});return i}const rB=_t.forwardRef((t,e)=>{const[n,i]=_t.useState(0),s=_t.useRef({control:null,version:n,forceUpdate:()=>i(ve=>ve+1)}).current,u=_t.useRef(null),a=_t.useRef(null),y=_t.useMemo(()=>HJ(t),[t.layers,t.views,t.children]);let w=!0;const I=ve=>{var Me;return w&&t.viewState?(s.viewStateUpdateRequested=ve,null):(s.viewStateUpdateRequested=null,(Me=t.onViewStateChange)===null||Me===void 0?void 0:Me.call(t,ve))},P=ve=>{if(w)s.interactionStateUpdateRequested=ve;else{var Me;s.interactionStateUpdateRequested=null,(Me=t.onInteractionStateChange)===null||Me===void 0||Me.call(t,ve)}},L=_t.useMemo(()=>{const ve={...t,style:null,width:"100%",height:"100%",parent:u.current,canvas:a.current,layers:y.layers,views:y.views,onViewStateChange:I,onInteractionStateChange:P};return delete ve._customRender,s.deck&&s.deck.setProps(ve),ve},[t]);_t.useEffect(()=>{const ve=t.Deck||m2;return s.deck=XJ(s,ve,{...L,parent:u.current,canvas:a.current}),()=>{var Me;return(Me=s.deck)===null||Me===void 0?void 0:Me.finalize()}},[]),VJ(()=>{iB(s);const{viewStateUpdateRequested:ve,interactionStateUpdateRequested:Me}=s;ve&&I(ve),Me&&P(Me)}),_t.useImperativeHandle(e,()=>YJ(s),[]);const U=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:Q,width:Z,height:ae,id:Y,style:te}=t,{containerStyle:re,canvasStyle:de}=_t.useMemo(()=>ZJ({width:Z,height:ae,style:te}),[Z,ae,te]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===U||s.version!==n){s.lastRenderedViewports=U,s.version=n;const ve=QJ({children:y.children,deck:s.deck,ContextProvider:Q}),Me=_t.createElement("canvas",{key:"canvas",id:Y||"deckgl-overlay",ref:a,style:de});s.control=_t.createElement("div",{id:"".concat(Y||"deckgl","-wrapper"),ref:u,style:re},[Me,ve])}return w=!1,s.control});rB.defaultProps=m2.defaultProps;const KJ=rB;var sB={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(mN,function(){var n,i,r;function s(a,y){if(!n)n=y;else if(!i)i=y;else{var w="var sharedChunk = {}; ("+n+")(sharedChunk); ("+i+")(sharedChunk);",I={};n(I),r=y(I),typeof window<"u"&&(r.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}s(["exports"],function(a){var y=w;function w(f,A,p,T){this.cx=3*f,this.bx=3*(p-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*A,this.by=3*(T-A)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=A,this.p2x=p,this.p2y=T}function I(f,A,p,T){const D=new y(f,A,p,T);return function(z){return D.solve(z)}}w.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,A){if(A===void 0&&(A=1e-6),f<0)return 0;if(f>1)return 1;for(var p=f,T=0;T<8;T++){var D=this.sampleCurveX(p)-f;if(Math.abs(D)<A)return p;var z=this.sampleCurveDerivativeX(p);if(Math.abs(z)<1e-6)break;p-=D/z}var F=0,j=1;for(p=f,T=0;T<20&&(D=this.sampleCurveX(p),!(Math.abs(D-f)<A));T++)f>D?F=p:j=p,p=.5*(j-F)+F;return p},solve:function(f,A){return this.sampleCurveY(this.solveCurveX(f,A))}};const P=I(.25,.1,.25,1);function L(f,A,p){return Math.min(p,Math.max(A,f))}function U(f,A,p){const T=p-A,D=((f-A)%T+T)%T+A;return D===A?p:D}function Q(f,...A){for(const p of A)for(const T in p)f[T]=p[T];return f}let Z=1;function ae(f,A){f.forEach(p=>{A[p]&&(A[p]=A[p].bind(A))})}function Y(f,A,p){const T={};for(const D in f)T[D]=A.call(p||this,f[D],D,f);return T}function te(f,A,p){const T={};for(const D in f)A.call(p||this,f[D],D,f)&&(T[D]=f[D]);return T}function re(f){return Array.isArray(f)?f.map(re):typeof f=="object"&&f?Y(f,re):f}const de={};function ve(f){de[f]||(typeof console<"u"&&console.warn(f),de[f]=!0)}function Me(f,A,p){return(p.y-f.y)*(A.x-f.x)>(A.y-f.y)*(p.x-f.x)}function He(f){let A=0;for(let p,T,D=0,z=f.length,F=z-1;D<z;F=D++)p=f[D],T=f[F],A+=(T.x-p.x)*(p.y+T.y);return A}function Qe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function et(f){const A={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(p,T,D,z)=>{const F=D||z;return A[T]=!F||F.toLowerCase(),""}),A["max-age"]){const p=parseInt(A["max-age"],10);isNaN(p)?delete A["max-age"]:A["max-age"]=p}return A}let tt,Ve,nt=null;function Ye(f){if(nt==null){const A=f.navigator?f.navigator.userAgent:null;nt=!!f.safari||!(!A||!(/\b(iPad|iPhone|iPod)\b/.test(A)||A.match("Safari")&&!A.match("Chrome")))}return nt}function gt(f){return typeof ImageBitmap<"u"&&f instanceof ImageBitmap}const Xt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f){const A=requestAnimationFrame(f);return{cancel:()=>cancelAnimationFrame(A)}},getImageData(f,A=0){const p=window.document.createElement("canvas"),T=p.getContext("2d");if(!T)throw new Error("failed to create canvas 2d context");return p.width=f.width,p.height=f.height,T.drawImage(f,0,0,f.width,f.height),T.getImageData(-A,-A,f.width+2*A,f.height+2*A)},resolveURL:f=>(tt||(tt=document.createElement("a")),tt.href=f,tt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ve==null&&(Ve=matchMedia("(prefers-reduced-motion: reduce)")),Ve.matches)}};var Et=fn;function fn(f,A){this.x=f,this.y=A}fn.prototype={clone:function(){return new fn(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,A){return this.clone()._rotateAround(f,A)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var A=f.x-this.x,p=f.y-this.y;return A*A+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,A){return Math.atan2(this.x*A-this.y*f,this.x*f+this.y*A)},_matMult:function(f){var A=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=A,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var A=Math.cos(f),p=Math.sin(f),T=p*this.x+A*this.y;return this.x=A*this.x-p*this.y,this.y=T,this},_rotateAround:function(f,A){var p=Math.cos(f),T=Math.sin(f),D=A.y+T*(this.x-A.x)+p*(this.y-A.y);return this.x=A.x+p*(this.x-A.x)-T*(this.y-A.y),this.y=D,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},fn.convert=function(f){return f instanceof fn?f:Array.isArray(f)?new fn(f[0],f[1]):f};const mt={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},bt="mapbox-tiles";let Kt,In,En=500,Si=50;function Jn(){typeof caches>"u"||Kt||(Kt=caches.open(bt))}let oi=1/0;const ci={supported:!1,testSupport:function(f){!xt&&bi&&(nn?Mn(f):Nn=f)}};let Nn,bi,xt=!1,nn=!1;function Mn(f){const A=f.createTexture();f.bindTexture(f.TEXTURE_2D,A);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,bi),f.isContextLost())return;ci.supported=!0}catch{}f.deleteTexture(A),xt=!0}typeof document<"u"&&(bi=document.createElement("img"),bi.onload=function(){Nn&&Mn(Nn),Nn=null,nn=!0},bi.onerror=function(){xt=!0,Nn=null},bi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const vt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(vt);class ei extends Error{constructor(A,p,T,D){super(`AJAXError: ${p} (${A}): ${T}`),this.status=A,this.statusText=p,this.url=T,this.body=D}}const $n=Qe()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function yi(f,A){const p=new AbortController,T=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:$n(),signal:p.signal});let D=!1,z=!1;return f.type==="json"&&T.headers.set("Accept","application/json"),((F,j,q)=>{if(z)return;const ie=Date.now();fetch(T).then(Ae=>Ae.ok?((ce,pe,me)=>{(f.type==="arrayBuffer"?ce.arrayBuffer():f.type==="json"?ce.json():ce.text()).then(ye=>{z||(pe&&me&&function(Ne,ze,Je){if(Jn(),!Kt)return;const lt={status:ze.status,statusText:ze.statusText,headers:new Headers};ze.headers.forEach((st,pt)=>lt.headers.set(pt,st));const Ke=et(ze.headers.get("Cache-Control")||"");Ke["no-store"]||(Ke["max-age"]&&lt.headers.set("Expires",new Date(Je+1e3*Ke["max-age"]).toUTCString()),new Date(lt.headers.get("Expires")).getTime()-Je<42e4||function(st,pt){if(In===void 0)try{new Response(new ReadableStream),In=!0}catch{In=!1}In?pt(st.body):st.blob().then(pt)}(ze,st=>{const pt=new Response(st,lt);Jn(),Kt&&Kt.then(dt=>dt.put(function(qt){const en=qt.indexOf("?");return en<0?qt:qt.slice(0,en)}(Ne.url),pt)).catch(dt=>ve(dt.message))}))}(T,pe,me),D=!0,A(null,ye,ce.headers.get("Cache-Control"),ce.headers.get("Expires")))}).catch(ye=>{z||A(new Error(ye.message))})})(Ae,null,ie):Ae.blob().then(ce=>A(new ei(Ae.status,Ae.statusText,f.url,ce)))).catch(Ae=>{Ae.code!==20&&A(new Error(Ae.message))})})(),{cancel:()=>{z=!0,D||p.abort()}}}const li=function(f,A){if(/:\/\//.test(f.url)&&!/^https?:|^file:/.test(f.url)){if(Qe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,A);if(!Qe()){const T=f.url.substring(0,f.url.indexOf("://"));return(mt.REGISTERED_PROTOCOLS[T]||yi)(f,A)}}if(!(/^file:/.test(p=f.url)||/^file:/.test($n())&&!/^\w+:/.test(p))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return yi(f,A);if(Qe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,A,void 0,!0)}var p;return function(T,D){const z=new XMLHttpRequest;z.open(T.method||"GET",T.url,!0),T.type==="arrayBuffer"&&(z.responseType="arraybuffer");for(const F in T.headers)z.setRequestHeader(F,T.headers[F]);return T.type==="json"&&(z.responseType="text",z.setRequestHeader("Accept","application/json")),z.withCredentials=T.credentials==="include",z.onerror=()=>{D(new Error(z.statusText))},z.onload=()=>{if((z.status>=200&&z.status<300||z.status===0)&&z.response!==null){let F=z.response;if(T.type==="json")try{F=JSON.parse(z.response)}catch(j){return D(j)}D(null,F,z.getResponseHeader("Cache-Control"),z.getResponseHeader("Expires"))}else{const F=new Blob([z.response],{type:z.getResponseHeader("Content-Type")});D(new ei(z.status,z.statusText,T.url,F))}},z.send(T.body),{cancel:()=>z.abort()}}(f,A)},ti=function(f,A){return li(Q(f,{type:"arrayBuffer"}),A)};function Ki(f){const A=window.document.createElement("a");return A.href=f,A.protocol===window.document.location.protocol&&A.host===window.document.location.host}const Un="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Cr,Hn;Cr=[],Hn=0;const Fr=function(f,A){if(ci.supported&&(f.headers||(f.headers={}),f.headers.accept="image/webp,*/*"),Hn>=mt.MAX_PARALLEL_IMAGE_REQUESTS){const z={requestParameters:f,callback:A,cancelled:!1,cancel(){this.cancelled=!0}};return Cr.push(z),z}Hn++;let p=!1;const T=()=>{if(!p)for(p=!0,Hn--;Cr.length&&Hn<mt.MAX_PARALLEL_IMAGE_REQUESTS;){const z=Cr.shift(),{requestParameters:F,callback:j,cancelled:q}=z;q||(z.cancel=Fr(F,j).cancel)}},D=ti(f,(z,F,j,q)=>{T(),z?A(z):F&&function(ie,Ae){typeof createImageBitmap=="function"?function(ce,pe){const me=new Blob([new Uint8Array(ce)],{type:"image/png"});createImageBitmap(me).then(ye=>{pe(null,ye)}).catch(ye=>{pe(new Error(`Could not load image because of ${ye.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(ie,Ae):function(ce,pe){const me=new Image;me.onload=()=>{pe(null,me),URL.revokeObjectURL(me.src),me.onload=null,window.requestAnimationFrame(()=>{me.src=Un})},me.onerror=()=>pe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const ye=new Blob([new Uint8Array(ce)],{type:"image/png"});me.src=ce.byteLength?URL.createObjectURL(ye):Un}(ie,Ae)}(F,(ie,Ae)=>{ie!=null?A(ie):Ae!=null&&A(null,Ae,{cacheControl:j,expires:q})})});return{cancel:()=>{D.cancel(),T()}}};function fo(f,A,p){p[f]&&p[f].indexOf(A)!==-1||(p[f]=p[f]||[],p[f].push(A))}function Ni(f,A,p){if(p&&p[f]){const T=p[f].indexOf(A);T!==-1&&p[f].splice(T,1)}}class Pr{constructor(A,p={}){Q(this,p),this.type=A}}class Fo extends Pr{constructor(A,p={}){super("error",Q({error:A},p))}}class is{on(A,p){return this._listeners=this._listeners||{},fo(A,p,this._listeners),this}off(A,p){return Ni(A,p,this._listeners),Ni(A,p,this._oneTimeListeners),this}once(A,p){return this._oneTimeListeners=this._oneTimeListeners||{},fo(A,p,this._oneTimeListeners),this}fire(A,p){typeof A=="string"&&(A=new Pr(A,p||{}));const T=A.type;if(this.listens(T)){A.target=this;const D=this._listeners&&this._listeners[T]?this._listeners[T].slice():[];for(const j of D)j.call(this,A);const z=this._oneTimeListeners&&this._oneTimeListeners[T]?this._oneTimeListeners[T].slice():[];for(const j of z)Ni(T,j,this._oneTimeListeners),j.call(this,A);const F=this._eventedParent;F&&(Q(A,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),F.fire(A))}else A instanceof Fo&&console.error(A.error);return this}listens(A){return this._listeners&&this._listeners[A]&&this._listeners[A].length>0||this._oneTimeListeners&&this._oneTimeListeners[A]&&this._oneTimeListeners[A].length>0||this._eventedParent&&this._eventedParent.listens(A)}setEventedParent(A,p){return this._eventedParent=A,this._eventedParentData=p,this}}var ut={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class It{constructor(A,p,T,D){this.message=(A?`${A}: `:"")+T,D&&(this.identifier=D),p!=null&&p.__line__&&(this.line=p.__line__)}}function Bs(f){const A=f.value;return A?[new It(f.key,A,"constants have been deprecated as of v8")]:[]}function xr(f,...A){for(const p of A)for(const T in p)f[T]=p[T];return f}function Rn(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function Nr(f){if(Array.isArray(f))return f.map(Nr);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const A={};for(const p in f)A[p]=Nr(f[p]);return A}return Rn(f)}class Ir extends Error{constructor(A,p){super(p),this.message=p,this.key=A}}class kr{constructor(A,p=[]){this.parent=A,this.bindings={};for(const[T,D]of p)this.bindings[T]=D}concat(A){return new kr(this,A)}get(A){if(this.bindings[A])return this.bindings[A];if(this.parent)return this.parent.get(A);throw new Error(`${A} not found in scope.`)}has(A){return!!this.bindings[A]||!!this.parent&&this.parent.has(A)}}const rs={kind:"null"},kt={kind:"number"},Tn={kind:"string"},wn={kind:"boolean"},Ii={kind:"color"},vs={kind:"object"},mn={kind:"value"},qe={kind:"collator"},$i={kind:"formatted"},zs={kind:"padding"},Ri={kind:"resolvedImage"};function or(f,A){return{kind:"array",itemType:f,N:A}}function qn(f){if(f.kind==="array"){const A=qn(f.itemType);return typeof f.N=="number"?`array<${A}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${A}>`}return f.kind}const Os=[rs,kt,Tn,wn,Ii,$i,vs,or(mn),zs,Ri];function Ur(f,A){if(A.kind==="error")return null;if(f.kind==="array"){if(A.kind==="array"&&(A.N===0&&A.itemType.kind==="value"||!Ur(f.itemType,A.itemType))&&(typeof f.N!="number"||f.N===A.N))return null}else{if(f.kind===A.kind)return null;if(f.kind==="value"){for(const p of Os)if(!Ur(p,A))return null}}return`Expected ${qn(f)} but found ${qn(A)} instead.`}function Vr(f,A){return A.some(p=>p.kind===f.kind)}function Lr(f,A){return A.some(p=>p==="null"?f===null:p==="array"?Array.isArray(f):p==="object"?f&&!Array.isArray(f)&&typeof f=="object":p===typeof f)}var ss,Bi={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function K(f){return(f=Math.round(f))<0?0:f>255?255:f}function H(f){return K(f[f.length-1]==="%"?parseFloat(f)/100*255:parseInt(f))}function ee(f){return(A=f[f.length-1]==="%"?parseFloat(f)/100:parseFloat(f))<0?0:A>1?1:A;var A}function he(f,A,p){return p<0?p+=1:p>1&&(p-=1),6*p<1?f+(A-f)*p*6:2*p<1?A:3*p<2?f+(A-f)*(2/3-p)*6:f}try{ss={}.parseCSSColor=function(f){var A,p=f.replace(/ /g,"").toLowerCase();if(p in Bi)return Bi[p].slice();if(p[0]==="#")return p.length===4?(A=parseInt(p.substr(1),16))>=0&&A<=4095?[(3840&A)>>4|(3840&A)>>8,240&A|(240&A)>>4,15&A|(15&A)<<4,1]:null:p.length===7&&(A=parseInt(p.substr(1),16))>=0&&A<=16777215?[(16711680&A)>>16,(65280&A)>>8,255&A,1]:null;var T=p.indexOf("("),D=p.indexOf(")");if(T!==-1&&D+1===p.length){var z=p.substr(0,T),F=p.substr(T+1,D-(T+1)).split(","),j=1;switch(z){case"rgba":if(F.length!==4)return null;j=ee(F.pop());case"rgb":return F.length!==3?null:[H(F[0]),H(F[1]),H(F[2]),j];case"hsla":if(F.length!==4)return null;j=ee(F.pop());case"hsl":if(F.length!==3)return null;var q=(parseFloat(F[0])%360+360)%360/360,ie=ee(F[1]),Ae=ee(F[2]),ce=Ae<=.5?Ae*(ie+1):Ae+ie-Ae*ie,pe=2*Ae-ce;return[K(255*he(pe,ce,q+1/3)),K(255*he(pe,ce,q)),K(255*he(pe,ce,q-1/3)),j];default:return null}}return null}}catch{}class o{constructor(A,p,T,D=1){this.r=A,this.g=p,this.b=T,this.a=D}static parse(A){if(!A)return;if(A instanceof o)return A;if(typeof A!="string")return;const p=ss(A);return p?new o(p[0]/255*p[3],p[1]/255*p[3],p[2]/255*p[3],p[3]):void 0}toString(){const[A,p,T,D]=this.toArray();return`rgba(${Math.round(A)},${Math.round(p)},${Math.round(T)},${D})`}toArray(){const{r:A,g:p,b:T,a:D}=this;return D===0?[0,0,0,0]:[255*A/D,255*p/D,255*T/D,D]}}o.black=new o(0,0,0,1),o.white=new o(1,1,1,1),o.transparent=new o(0,0,0,0),o.red=new o(1,0,0,1);class G{constructor(A,p,T){this.sensitivity=A?p?"variant":"case":p?"accent":"base",this.locale=T,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(A,p){return this.collator.compare(A,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Le{constructor(A,p,T,D,z){this.text=A,this.image=p,this.scale=T,this.fontStack=D,this.textColor=z}}class Ie{constructor(A){this.sections=A}static fromString(A){return new Ie([new Le(A,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(A=>A.text.length!==0||A.image&&A.image.name.length!==0)}static factory(A){return A instanceof Ie?A:Ie.fromString(A)}toString(){return this.sections.length===0?"":this.sections.map(A=>A.text).join("")}}class Pe{constructor(A){this.values=A.slice()}static parse(A){if(A instanceof Pe)return A;if(typeof A=="number")return new Pe([A,A,A,A]);if(Array.isArray(A)&&!(A.length<1||A.length>4)){for(const p of A)if(typeof p!="number")return;switch(A.length){case 1:A=[A[0],A[0],A[0],A[0]];break;case 2:A=[A[0],A[1],A[0],A[1]];break;case 3:A=[A[0],A[1],A[2],A[1]]}return new Pe(A)}}toString(){return JSON.stringify(this.values)}}class ke{constructor(A){this.name=A.name,this.available=A.available}toString(){return this.name}static fromString(A){return A?new ke({name:A,available:!1}):null}}function We(f,A,p,T){return typeof f=="number"&&f>=0&&f<=255&&typeof A=="number"&&A>=0&&A<=255&&typeof p=="number"&&p>=0&&p<=255?T===void 0||typeof T=="number"&&T>=0&&T<=1?null:`Invalid rgba value [${[f,A,p,T].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof T=="number"?[f,A,p,T]:[f,A,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function at(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof o||f instanceof G||f instanceof Ie||f instanceof Pe||f instanceof ke)return!0;if(Array.isArray(f)){for(const A of f)if(!at(A))return!1;return!0}if(typeof f=="object"){for(const A in f)if(!at(f[A]))return!1;return!0}return!1}function $e(f){if(f===null)return rs;if(typeof f=="string")return Tn;if(typeof f=="boolean")return wn;if(typeof f=="number")return kt;if(f instanceof o)return Ii;if(f instanceof G)return qe;if(f instanceof Ie)return $i;if(f instanceof Pe)return zs;if(f instanceof ke)return Ri;if(Array.isArray(f)){const A=f.length;let p;for(const T of f){const D=$e(T);if(p){if(p===D)continue;p=mn;break}p=D}return or(p||mn,A)}return vs}function ht(f){const A=typeof f;return f===null?"":A==="string"||A==="number"||A==="boolean"?String(f):f instanceof o||f instanceof Ie||f instanceof Pe||f instanceof ke?f.toString():JSON.stringify(f)}class Lt{constructor(A,p){this.type=A,this.value=p}static parse(A,p){if(A.length!==2)return p.error(`'literal' expression requires exactly one argument, but found ${A.length-1} instead.`);if(!at(A[1]))return p.error("invalid value");const T=A[1];let D=$e(T);const z=p.expectedType;return D.kind!=="array"||D.N!==0||!z||z.kind!=="array"||typeof z.N=="number"&&z.N!==0||(D=z),new Lt(D,T)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Dt{constructor(A){this.name="ExpressionEvaluationError",this.message=A}toJSON(){return this.message}}const rn={string:Tn,number:kt,boolean:wn,object:vs};class jt{constructor(A,p){this.type=A,this.args=p}static parse(A,p){if(A.length<2)return p.error("Expected at least one argument.");let T,D=1;const z=A[0];if(z==="array"){let j,q;if(A.length>2){const ie=A[1];if(typeof ie!="string"||!(ie in rn)||ie==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);j=rn[ie],D++}else j=mn;if(A.length>3){if(A[2]!==null&&(typeof A[2]!="number"||A[2]<0||A[2]!==Math.floor(A[2])))return p.error('The length argument to "array" must be a positive integer literal',2);q=A[2],D++}T=or(j,q)}else{if(!rn[z])throw new Error(`Types doesn't contain name = ${z}`);T=rn[z]}const F=[];for(;D<A.length;D++){const j=p.parse(A[D],D,mn);if(!j)return null;F.push(j)}return new jt(T,F)}evaluate(A){for(let p=0;p<this.args.length;p++){const T=this.args[p].evaluate(A);if(!Ur(this.type,$e(T)))return T;if(p===this.args.length-1)throw new Dt(`Expected value to be of type ${qn(this.type)}, but found ${qn($e(T))} instead.`)}throw new Error}eachChild(A){this.args.forEach(A)}outputDefined(){return this.args.every(A=>A.outputDefined())}}const dn={"to-boolean":wn,"to-color":Ii,"to-number":kt,"to-string":Tn};class Qt{constructor(A,p){this.type=A,this.args=p}static parse(A,p){if(A.length<2)return p.error("Expected at least one argument.");const T=A[0];if(!dn[T])throw new Error(`Can't parse ${T} as it is not part of the known types`);if((T==="to-boolean"||T==="to-string")&&A.length!==2)return p.error("Expected one argument.");const D=dn[T],z=[];for(let F=1;F<A.length;F++){const j=p.parse(A[F],F,mn);if(!j)return null;z.push(j)}return new Qt(D,z)}evaluate(A){if(this.type.kind==="boolean")return!!this.args[0].evaluate(A);if(this.type.kind==="color"){let p,T;for(const D of this.args){if(p=D.evaluate(A),T=null,p instanceof o)return p;if(typeof p=="string"){const z=A.parseColor(p);if(z)return z}else if(Array.isArray(p)&&(T=p.length<3||p.length>4?`Invalid rbga value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:We(p[0],p[1],p[2],p[3]),!T))return new o(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new Dt(T||`Could not parse color from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}if(this.type.kind==="padding"){let p;for(const T of this.args){p=T.evaluate(A);const D=Pe.parse(p);if(D)return D}throw new Dt(`Could not parse padding from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}if(this.type.kind==="number"){let p=null;for(const T of this.args){if(p=T.evaluate(A),p===null)return 0;const D=Number(p);if(!isNaN(D))return D}throw new Dt(`Could not convert ${JSON.stringify(p)} to number.`)}return this.type.kind==="formatted"?Ie.fromString(ht(this.args[0].evaluate(A))):this.type.kind==="resolvedImage"?ke.fromString(ht(this.args[0].evaluate(A))):ht(this.args[0].evaluate(A))}eachChild(A){this.args.forEach(A)}outputDefined(){return this.args.every(A=>A.outputDefined())}}const on=["Unknown","Point","LineString","Polygon"];class vn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?on[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(A){let p=this._parseColorCache[A];return p||(p=this._parseColorCache[A]=o.parse(A)),p}}class Ot{constructor(A,p,T,D){this.name=A,this.type=p,this._evaluate=T,this.args=D}evaluate(A){return this._evaluate(A,this.args)}eachChild(A){this.args.forEach(A)}outputDefined(){return!1}static parse(A,p){const T=A[0],D=Ot.definitions[T];if(!D)return p.error(`Unknown expression "${T}". If you wanted a literal array, use ["literal", [...]].`,0);const z=Array.isArray(D)?D[0]:D.type,F=Array.isArray(D)?[[D[1],D[2]]]:D.overloads,j=F.filter(([ie])=>!Array.isArray(ie)||ie.length===A.length-1);let q=null;for(const[ie,Ae]of j){q=new wt(p.registry,p.path,null,p.scope);const ce=[];let pe=!1;for(let me=1;me<A.length;me++){const ye=A[me],Ne=Array.isArray(ie)?ie[me-1]:ie.type,ze=q.parse(ye,1+ce.length,Ne);if(!ze){pe=!0;break}ce.push(ze)}if(!pe)if(Array.isArray(ie)&&ie.length!==ce.length)q.error(`Expected ${ie.length} arguments, but found ${ce.length} instead.`);else{for(let me=0;me<ce.length;me++){const ye=Array.isArray(ie)?ie[me]:ie.type,Ne=ce[me];q.concat(me+1).checkSubtype(ye,Ne.type)}if(q.errors.length===0)return new Ot(T,z,Ae,ce)}}if(j.length===1)p.errors.push(...q.errors);else{const ie=(j.length?j:F).map(([ce])=>{return pe=ce,Array.isArray(pe)?`(${pe.map(qn).join(", ")})`:`(${qn(pe.type)}...)`;var pe}).join(" | "),Ae=[];for(let ce=1;ce<A.length;ce++){const pe=p.parse(A[ce],1+Ae.length);if(!pe)return null;Ae.push(qn(pe.type))}p.error(`Expected arguments of type ${ie}, but found (${Ae.join(", ")}) instead.`)}return null}static register(A,p){Ot.definitions=p;for(const T in p)A[T]=Ot}}class Oe{constructor(A,p,T){this.type=qe,this.locale=T,this.caseSensitive=A,this.diacriticSensitive=p}static parse(A,p){if(A.length!==2)return p.error("Expected one argument.");const T=A[1];if(typeof T!="object"||Array.isArray(T))return p.error("Collator options argument must be an object.");const D=p.parse(T["case-sensitive"]!==void 0&&T["case-sensitive"],1,wn);if(!D)return null;const z=p.parse(T["diacritic-sensitive"]!==void 0&&T["diacritic-sensitive"],1,wn);if(!z)return null;let F=null;return T.locale&&(F=p.parse(T.locale,1,Tn),!F)?null:new Oe(D,z,F)}evaluate(A){return new G(this.caseSensitive.evaluate(A),this.diacriticSensitive.evaluate(A),this.locale?this.locale.evaluate(A):null)}eachChild(A){A(this.caseSensitive),A(this.diacriticSensitive),this.locale&&A(this.locale)}outputDefined(){return!1}}const Mt=8192;function Se(f,A){f[0]=Math.min(f[0],A[0]),f[1]=Math.min(f[1],A[1]),f[2]=Math.max(f[2],A[0]),f[3]=Math.max(f[3],A[1])}function An(f,A){return!(f[0]<=A[0]||f[2]>=A[2]||f[1]<=A[1]||f[3]>=A[3])}function ar(f,A){const p=(180+f[0])/360,T=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,D=Math.pow(2,A.z);return[Math.round(p*D*Mt),Math.round(T*D*Mt)]}function ni(f,A,p){const T=f[0]-A[0],D=f[1]-A[1],z=f[0]-p[0],F=f[1]-p[1];return T*F-z*D==0&&T*z<=0&&D*F<=0}function la(f,A){let p=!1;for(let F=0,j=A.length;F<j;F++){const q=A[F];for(let ie=0,Ae=q.length;ie<Ae-1;ie++){if(ni(f,q[ie],q[ie+1]))return!1;(D=q[ie])[1]>(T=f)[1]!=(z=q[ie+1])[1]>T[1]&&T[0]<(z[0]-D[0])*(T[1]-D[1])/(z[1]-D[1])+D[0]&&(p=!p)}}var T,D,z;return p}function De(f,A){for(let p=0;p<A.length;p++)if(la(f,A[p]))return!0;return!1}function Na(f,A,p,T){const D=T[0]-p[0],z=T[1]-p[1],F=(f[0]-p[0])*z-D*(f[1]-p[1]),j=(A[0]-p[0])*z-D*(A[1]-p[1]);return F>0&&j<0||F<0&&j>0}function we(f,A,p){for(const ie of p)for(let Ae=0;Ae<ie.length-1;++Ae)if((j=[(F=ie[Ae+1])[0]-(z=ie[Ae])[0],F[1]-z[1]])[0]*(q=[(D=A)[0]-(T=f)[0],D[1]-T[1]])[1]-j[1]*q[0]!=0&&Na(T,D,z,F)&&Na(z,F,T,D))return!0;var T,D,z,F,j,q;return!1}function No(f,A){for(let p=0;p<f.length;++p)if(!la(f[p],A))return!1;for(let p=0;p<f.length-1;++p)if(we(f[p],f[p+1],A))return!1;return!0}function xs(f,A){for(let p=0;p<A.length;p++)if(No(f,A[p]))return!0;return!1}function Ua(f,A,p){const T=[];for(let D=0;D<f.length;D++){const z=[];for(let F=0;F<f[D].length;F++){const j=ar(f[D][F],p);Se(A,j),z.push(j)}T.push(z)}return T}function Va(f,A,p){const T=[];for(let D=0;D<f.length;D++){const z=Ua(f[D],A,p);T.push(z)}return T}function Aa(f,A,p,T){if(f[0]<p[0]||f[0]>p[2]){const D=.5*T;let z=f[0]-p[0]>D?-T:p[0]-f[0]>D?T:0;z===0&&(z=f[0]-p[2]>D?-T:p[2]-f[0]>D?T:0),f[0]+=z}Se(A,f)}function ml(f,A,p,T){const D=Math.pow(2,T.z)*Mt,z=[T.x*Mt,T.y*Mt],F=[];for(const j of f)for(const q of j){const ie=[q.x+z[0],q.y+z[1]];Aa(ie,A,p,D),F.push(ie)}return F}function ua(f,A,p,T){const D=Math.pow(2,T.z)*Mt,z=[T.x*Mt,T.y*Mt],F=[];for(const q of f){const ie=[];for(const Ae of q){const ce=[Ae.x+z[0],Ae.y+z[1]];Se(A,ce),ie.push(ce)}F.push(ie)}if(A[2]-A[0]<=D/2){(j=A)[0]=j[1]=1/0,j[2]=j[3]=-1/0;for(const q of F)for(const ie of q)Aa(ie,A,p,D)}var j;return F}class Ji{constructor(A,p){this.type=wn,this.geojson=A,this.geometries=p}static parse(A,p){if(A.length!==2)return p.error(`'within' expression requires exactly one argument, but found ${A.length-1} instead.`);if(at(A[1])){const T=A[1];if(T.type==="FeatureCollection")for(let D=0;D<T.features.length;++D){const z=T.features[D].geometry.type;if(z==="Polygon"||z==="MultiPolygon")return new Ji(T,T.features[D].geometry)}else if(T.type==="Feature"){const D=T.geometry.type;if(D==="Polygon"||D==="MultiPolygon")return new Ji(T,T.geometry)}else if(T.type==="Polygon"||T.type==="MultiPolygon")return new Ji(T,T)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(A){if(A.geometry()!=null&&A.canonicalID()!=null){if(A.geometryType()==="Point")return function(p,T){const D=[1/0,1/0,-1/0,-1/0],z=[1/0,1/0,-1/0,-1/0],F=p.canonicalID();if(T.type==="Polygon"){const j=Ua(T.coordinates,z,F),q=ml(p.geometry(),D,z,F);if(!An(D,z))return!1;for(const ie of q)if(!la(ie,j))return!1}if(T.type==="MultiPolygon"){const j=Va(T.coordinates,z,F),q=ml(p.geometry(),D,z,F);if(!An(D,z))return!1;for(const ie of q)if(!De(ie,j))return!1}return!0}(A,this.geometries);if(A.geometryType()==="LineString")return function(p,T){const D=[1/0,1/0,-1/0,-1/0],z=[1/0,1/0,-1/0,-1/0],F=p.canonicalID();if(T.type==="Polygon"){const j=Ua(T.coordinates,z,F),q=ua(p.geometry(),D,z,F);if(!An(D,z))return!1;for(const ie of q)if(!No(ie,j))return!1}if(T.type==="MultiPolygon"){const j=Va(T.coordinates,z,F),q=ua(p.geometry(),D,z,F);if(!An(D,z))return!1;for(const ie of q)if(!xs(ie,j))return!1}return!0}(A,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function ge(f){if(f instanceof Ot&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof Ji)return!1;let A=!0;return f.eachChild(p=>{A&&!ge(p)&&(A=!1)}),A}function Ee(f){if(f instanceof Ot&&f.name==="feature-state")return!1;let A=!0;return f.eachChild(p=>{A&&!Ee(p)&&(A=!1)}),A}function Fe(f,A){if(f instanceof Ot&&A.indexOf(f.name)>=0)return!1;let p=!0;return f.eachChild(T=>{p&&!Fe(T,A)&&(p=!1)}),p}class ot{constructor(A,p){this.type=p.type,this.name=A,this.boundExpression=p}static parse(A,p){if(A.length!==2||typeof A[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");const T=A[1];return p.scope.has(T)?new ot(T,p.scope.get(T)):p.error(`Unknown variable "${T}". Make sure "${T}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(A){return this.boundExpression.evaluate(A)}eachChild(){}outputDefined(){return!1}}class wt{constructor(A,p=[],T,D=new kr,z=[]){this.registry=A,this.path=p,this.key=p.map(F=>`[${F}]`).join(""),this.scope=D,this.errors=z,this.expectedType=T}parse(A,p,T,D,z={}){return p?this.concat(p,T,D)._parse(A,z):this._parse(A,z)}_parse(A,p){function T(D,z,F){return F==="assert"?new jt(z,[D]):F==="coerce"?new Qt(z,[D]):D}if(A!==null&&typeof A!="string"&&typeof A!="boolean"&&typeof A!="number"||(A=["literal",A]),Array.isArray(A)){if(A.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const D=A[0];if(typeof D!="string")return this.error(`Expression name must be a string, but found ${typeof D} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const z=this.registry[D];if(z){let F=z.parse(A,this);if(!F)return null;if(this.expectedType){const j=this.expectedType,q=F.type;if(j.kind!=="string"&&j.kind!=="number"&&j.kind!=="boolean"&&j.kind!=="object"&&j.kind!=="array"||q.kind!=="value")if(j.kind!=="color"&&j.kind!=="formatted"&&j.kind!=="resolvedImage"||q.kind!=="value"&&q.kind!=="string")if(j.kind!=="padding"||q.kind!=="value"&&q.kind!=="number"&&q.kind!=="array"){if(this.checkSubtype(j,q))return null}else F=T(F,j,p.typeAnnotation||"coerce");else F=T(F,j,p.typeAnnotation||"coerce");else F=T(F,j,p.typeAnnotation||"assert")}if(!(F instanceof Lt)&&F.type.kind!=="resolvedImage"&&Wt(F)){const j=new vn;try{F=new Lt(F.type,F.evaluate(j))}catch(q){return this.error(q.message),null}}return F}return this.error(`Unknown expression "${D}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(A===void 0?"'undefined' value invalid. Use null instead.":typeof A=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof A} instead.`)}concat(A,p,T){const D=typeof A=="number"?this.path.concat(A):this.path,z=T?this.scope.concat(T):this.scope;return new wt(this.registry,D,p||null,z,this.errors)}error(A,...p){const T=`${this.key}${p.map(D=>`[${D}]`).join("")}`;this.errors.push(new Ir(T,A))}checkSubtype(A,p){const T=Ur(A,p);return T&&this.error(T),T}}function Wt(f){if(f instanceof ot)return Wt(f.boundExpression);if(f instanceof Ot&&f.name==="error"||f instanceof Oe||f instanceof Ji)return!1;const A=f instanceof Qt||f instanceof jt;let p=!0;return f.eachChild(T=>{p=A?p&&Wt(T):p&&T instanceof Lt}),!!p&&ge(f)&&Fe(f,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function kn(f,A){const p=f.length-1;let T,D,z=0,F=p,j=0;for(;z<=F;)if(j=Math.floor((z+F)/2),T=f[j],D=f[j+1],T<=A){if(j===p||A<D)return j;z=j+1}else{if(!(T>A))throw new Dt("Input is not a number.");F=j-1}return 0}class Pi{constructor(A,p,T){this.type=A,this.input=p,this.labels=[],this.outputs=[];for(const[D,z]of T)this.labels.push(D),this.outputs.push(z)}static parse(A,p){if(A.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${A.length-1}.`);if((A.length-1)%2!=0)return p.error("Expected an even number of arguments.");const T=p.parse(A[1],1,kt);if(!T)return null;const D=[];let z=null;p.expectedType&&p.expectedType.kind!=="value"&&(z=p.expectedType);for(let F=1;F<A.length;F+=2){const j=F===1?-1/0:A[F],q=A[F+1],ie=F,Ae=F+1;if(typeof j!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ie);if(D.length&&D[D.length-1][0]>=j)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ie);const ce=p.parse(q,Ae,z);if(!ce)return null;z=z||ce.type,D.push([j,ce])}return new Pi(z,T,D)}evaluate(A){const p=this.labels,T=this.outputs;if(p.length===1)return T[0].evaluate(A);const D=this.input.evaluate(A);if(D<=p[0])return T[0].evaluate(A);const z=p.length;return D>=p[z-1]?T[z-1].evaluate(A):T[kn(p,D)].evaluate(A)}eachChild(A){A(this.input);for(const p of this.outputs)A(p)}outputDefined(){return this.outputs.every(A=>A.outputDefined())}}function Jt(f,A,p){return f*(1-p)+A*p}var ki=Object.freeze({__proto__:null,number:Jt,color:function(f,A,p){return new o(Jt(f.r,A.r,p),Jt(f.g,A.g,p),Jt(f.b,A.b,p),Jt(f.a,A.a,p))},array:function(f,A,p){return f.map((T,D)=>Jt(T,A[D],p))},padding:function(f,A,p){const T=f.values,D=A.values;return new Pe([Jt(T[0],D[0],p),Jt(T[1],D[1],p),Jt(T[2],D[2],p),Jt(T[3],D[3],p)])}});const Vn=.95047,aA=1.08883,lA=4/29,AA=6/29,$A=3*AA*AA,HA=Math.PI/180,uA=180/Math.PI;function yl(f){return f>.008856451679035631?Math.pow(f,1/3):f/$A+lA}function _l(f){return f>AA?f*f*f:$A*(f-lA)}function cA(f){return 255*(f<=.0031308?12.92*f:1.055*Math.pow(f,1/2.4)-.055)}function hA(f){return(f/=255)<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function Zn(f){const A=hA(f.r),p=hA(f.g),T=hA(f.b),D=yl((.4124564*A+.3575761*p+.1804375*T)/Vn),z=yl((.2126729*A+.7151522*p+.072175*T)/1);return{l:116*z-16,a:500*(D-z),b:200*(z-yl((.0193339*A+.119192*p+.9503041*T)/aA)),alpha:f.a}}function WA(f){let A=(f.l+16)/116,p=isNaN(f.a)?A:A+f.a/500,T=isNaN(f.b)?A:A-f.b/200;return A=1*_l(A),p=Vn*_l(p),T=aA*_l(T),new o(cA(3.2404542*p-1.5371385*A-.4985314*T),cA(-.969266*p+1.8760108*A+.041556*T),cA(.0556434*p-.2040259*A+1.0572252*T),f.alpha)}function Ku(f,A,p){const T=A-f;return f+p*(T>180||T<-180?T-360*Math.round(T/360):T)}const vl={forward:Zn,reverse:WA,interpolate:function(f,A,p){return{l:Jt(f.l,A.l,p),a:Jt(f.a,A.a,p),b:Jt(f.b,A.b,p),alpha:Jt(f.alpha,A.alpha,p)}}},Hi={forward:function(f){const{l:A,a:p,b:T}=Zn(f),D=Math.atan2(T,p)*uA;return{h:D<0?D+360:D,c:Math.sqrt(p*p+T*T),l:A,alpha:f.a}},reverse:function(f){const A=f.h*HA,p=f.c;return WA({l:f.l,a:Math.cos(A)*p,b:Math.sin(A)*p,alpha:f.alpha})},interpolate:function(f,A,p){return{h:Ku(f.h,A.h,p),c:Jt(f.c,A.c,p),l:Jt(f.l,A.l,p),alpha:Jt(f.alpha,A.alpha,p)}}};var Uo=Object.freeze({__proto__:null,lab:vl,hcl:Hi});class Bn{constructor(A,p,T,D,z){this.type=A,this.operator=p,this.interpolation=T,this.input=D,this.labels=[],this.outputs=[];for(const[F,j]of z)this.labels.push(F),this.outputs.push(j)}static interpolationFactor(A,p,T,D){let z=0;if(A.name==="exponential")z=ws(p,A.base,T,D);else if(A.name==="linear")z=ws(p,1,T,D);else if(A.name==="cubic-bezier"){const F=A.controlPoints;z=new y(F[0],F[1],F[2],F[3]).solve(ws(p,1,T,D))}return z}static parse(A,p){let[T,D,z,...F]=A;if(!Array.isArray(D)||D.length===0)return p.error("Expected an interpolation type expression.",1);if(D[0]==="linear")D={name:"linear"};else if(D[0]==="exponential"){const ie=D[1];if(typeof ie!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);D={name:"exponential",base:ie}}else{if(D[0]!=="cubic-bezier")return p.error(`Unknown interpolation type ${String(D[0])}`,1,0);{const ie=D.slice(1);if(ie.length!==4||ie.some(Ae=>typeof Ae!="number"||Ae<0||Ae>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);D={name:"cubic-bezier",controlPoints:ie}}}if(A.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${A.length-1}.`);if((A.length-1)%2!=0)return p.error("Expected an even number of arguments.");if(z=p.parse(z,2,kt),!z)return null;const j=[];let q=null;T==="interpolate-hcl"||T==="interpolate-lab"?q=Ii:p.expectedType&&p.expectedType.kind!=="value"&&(q=p.expectedType);for(let ie=0;ie<F.length;ie+=2){const Ae=F[ie],ce=F[ie+1],pe=ie+3,me=ie+4;if(typeof Ae!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',pe);if(j.length&&j[j.length-1][0]>=Ae)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',pe);const ye=p.parse(ce,me,q);if(!ye)return null;q=q||ye.type,j.push([Ae,ye])}return q.kind==="number"||q.kind==="color"||q.kind==="padding"||q.kind==="array"&&q.itemType.kind==="number"&&typeof q.N=="number"?new Bn(q,T,D,z,j):p.error(`Type ${qn(q)} is not interpolatable.`)}evaluate(A){const p=this.labels,T=this.outputs;if(p.length===1)return T[0].evaluate(A);const D=this.input.evaluate(A);if(D<=p[0])return T[0].evaluate(A);const z=p.length;if(D>=p[z-1])return T[z-1].evaluate(A);const F=kn(p,D),j=Bn.interpolationFactor(this.interpolation,D,p[F],p[F+1]),q=T[F].evaluate(A),ie=T[F+1].evaluate(A);return this.operator==="interpolate"?ki[this.type.kind.toLowerCase()](q,ie,j):this.operator==="interpolate-hcl"?Hi.reverse(Hi.interpolate(Hi.forward(q),Hi.forward(ie),j)):vl.reverse(vl.interpolate(vl.forward(q),vl.forward(ie),j))}eachChild(A){A(this.input);for(const p of this.outputs)A(p)}outputDefined(){return this.outputs.every(A=>A.outputDefined())}}function ws(f,A,p,T){const D=T-p,z=f-p;return D===0?0:A===1?z/D:(Math.pow(A,z)-1)/(Math.pow(A,D)-1)}class er{constructor(A,p){this.type=A,this.args=p}static parse(A,p){if(A.length<2)return p.error("Expectected at least one argument.");let T=null;const D=p.expectedType;D&&D.kind!=="value"&&(T=D);const z=[];for(const j of A.slice(1)){const q=p.parse(j,1+z.length,T,void 0,{typeAnnotation:"omit"});if(!q)return null;T=T||q.type,z.push(q)}if(!T)throw new Error("No output type");const F=D&&z.some(j=>Ur(D,j.type));return new er(F?mn:T,z)}evaluate(A){let p,T=null,D=0;for(const z of this.args)if(D++,T=z.evaluate(A),T&&T instanceof ke&&!T.available&&(p||(p=T.name),T=null,D===this.args.length&&(T=p)),T!==null)break;return T}eachChild(A){this.args.forEach(A)}outputDefined(){return this.args.every(A=>A.outputDefined())}}class po{constructor(A,p){this.type=p.type,this.bindings=[].concat(A),this.result=p}evaluate(A){return this.result.evaluate(A)}eachChild(A){for(const p of this.bindings)A(p[1]);A(this.result)}static parse(A,p){if(A.length<4)return p.error(`Expected at least 3 arguments, but found ${A.length-1} instead.`);const T=[];for(let z=1;z<A.length-1;z+=2){const F=A[z];if(typeof F!="string")return p.error(`Expected string, but found ${typeof F} instead.`,z);if(/[^a-zA-Z0-9_]/.test(F))return p.error("Variable names must contain only alphanumeric characters or '_'.",z);const j=p.parse(A[z+1],z+1);if(!j)return null;T.push([F,j])}const D=p.parse(A[A.length-1],A.length-1,p.expectedType,T);return D?new po(T,D):null}outputDefined(){return this.result.outputDefined()}}class xl{constructor(A,p,T){this.type=A,this.index=p,this.input=T}static parse(A,p){if(A.length!==3)return p.error(`Expected 2 arguments, but found ${A.length-1} instead.`);const T=p.parse(A[1],1,kt),D=p.parse(A[2],2,or(p.expectedType||mn));return T&&D?new xl(D.type.itemType,T,D):null}evaluate(A){const p=this.index.evaluate(A),T=this.input.evaluate(A);if(p<0)throw new Dt(`Array index out of bounds: ${p} < 0.`);if(p>=T.length)throw new Dt(`Array index out of bounds: ${p} > ${T.length-1}.`);if(p!==Math.floor(p))throw new Dt(`Array index must be an integer, but found ${p} instead.`);return T[p]}eachChild(A){A(this.index),A(this.input)}outputDefined(){return!1}}class Vo{constructor(A,p){this.type=wn,this.needle=A,this.haystack=p}static parse(A,p){if(A.length!==3)return p.error(`Expected 2 arguments, but found ${A.length-1} instead.`);const T=p.parse(A[1],1,mn),D=p.parse(A[2],2,mn);return T&&D?Vr(T.type,[wn,Tn,kt,rs,mn])?new Vo(T,D):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${qn(T.type)} instead`):null}evaluate(A){const p=this.needle.evaluate(A),T=this.haystack.evaluate(A);if(!T)return!1;if(!Lr(p,["boolean","string","number","null"]))throw new Dt(`Expected first argument to be of type boolean, string, number or null, but found ${qn($e(p))} instead.`);if(!Lr(T,["string","array"]))throw new Dt(`Expected second argument to be of type array or string, but found ${qn($e(T))} instead.`);return T.indexOf(p)>=0}eachChild(A){A(this.needle),A(this.haystack)}outputDefined(){return!0}}class ca{constructor(A,p,T){this.type=kt,this.needle=A,this.haystack=p,this.fromIndex=T}static parse(A,p){if(A.length<=2||A.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${A.length-1} instead.`);const T=p.parse(A[1],1,mn),D=p.parse(A[2],2,mn);if(!T||!D)return null;if(!Vr(T.type,[wn,Tn,kt,rs,mn]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${qn(T.type)} instead`);if(A.length===4){const z=p.parse(A[3],3,kt);return z?new ca(T,D,z):null}return new ca(T,D)}evaluate(A){const p=this.needle.evaluate(A),T=this.haystack.evaluate(A);if(!Lr(p,["boolean","string","number","null"]))throw new Dt(`Expected first argument to be of type boolean, string, number or null, but found ${qn($e(p))} instead.`);if(!Lr(T,["string","array"]))throw new Dt(`Expected second argument to be of type array or string, but found ${qn($e(T))} instead.`);if(this.fromIndex){const D=this.fromIndex.evaluate(A);return T.indexOf(p,D)}return T.indexOf(p)}eachChild(A){A(this.needle),A(this.haystack),this.fromIndex&&A(this.fromIndex)}outputDefined(){return!1}}class go{constructor(A,p,T,D,z,F){this.inputType=A,this.type=p,this.input=T,this.cases=D,this.outputs=z,this.otherwise=F}static parse(A,p){if(A.length<5)return p.error(`Expected at least 4 arguments, but found only ${A.length-1}.`);if(A.length%2!=1)return p.error("Expected an even number of arguments.");let T,D;p.expectedType&&p.expectedType.kind!=="value"&&(D=p.expectedType);const z={},F=[];for(let ie=2;ie<A.length-1;ie+=2){let Ae=A[ie];const ce=A[ie+1];Array.isArray(Ae)||(Ae=[Ae]);const pe=p.concat(ie);if(Ae.length===0)return pe.error("Expected at least one branch label.");for(const ye of Ae){if(typeof ye!="number"&&typeof ye!="string")return pe.error("Branch labels must be numbers or strings.");if(typeof ye=="number"&&Math.abs(ye)>Number.MAX_SAFE_INTEGER)return pe.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ye=="number"&&Math.floor(ye)!==ye)return pe.error("Numeric branch labels must be integer values.");if(T){if(pe.checkSubtype(T,$e(ye)))return null}else T=$e(ye);if(z[String(ye)]!==void 0)return pe.error("Branch labels must be unique.");z[String(ye)]=F.length}const me=p.parse(ce,ie,D);if(!me)return null;D=D||me.type,F.push(me)}const j=p.parse(A[1],1,mn);if(!j)return null;const q=p.parse(A[A.length-1],A.length-1,D);return q?j.type.kind!=="value"&&p.concat(1).checkSubtype(T,j.type)?null:new go(T,D,j,z,F,q):null}evaluate(A){const p=this.input.evaluate(A);return($e(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(A)}eachChild(A){A(this.input),this.outputs.forEach(A),A(this.otherwise)}outputDefined(){return this.outputs.every(A=>A.outputDefined())&&this.otherwise.outputDefined()}}class fA{constructor(A,p,T){this.type=A,this.branches=p,this.otherwise=T}static parse(A,p){if(A.length<4)return p.error(`Expected at least 3 arguments, but found only ${A.length-1}.`);if(A.length%2!=0)return p.error("Expected an odd number of arguments.");let T;p.expectedType&&p.expectedType.kind!=="value"&&(T=p.expectedType);const D=[];for(let F=1;F<A.length-1;F+=2){const j=p.parse(A[F],F,wn);if(!j)return null;const q=p.parse(A[F+1],F+1,T);if(!q)return null;D.push([j,q]),T=T||q.type}const z=p.parse(A[A.length-1],A.length-1,T);if(!z)return null;if(!T)throw new Error("Can't infer output type");return new fA(T,D,z)}evaluate(A){for(const[p,T]of this.branches)if(p.evaluate(A))return T.evaluate(A);return this.otherwise.evaluate(A)}eachChild(A){for(const[p,T]of this.branches)A(p),A(T);A(this.otherwise)}outputDefined(){return this.branches.every(([A,p])=>p.outputDefined())&&this.otherwise.outputDefined()}}class Ga{constructor(A,p,T,D){this.type=A,this.input=p,this.beginIndex=T,this.endIndex=D}static parse(A,p){if(A.length<=2||A.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${A.length-1} instead.`);const T=p.parse(A[1],1,mn),D=p.parse(A[2],2,kt);if(!T||!D)return null;if(!Vr(T.type,[or(mn),Tn,mn]))return p.error(`Expected first argument to be of type array or string, but found ${qn(T.type)} instead`);if(A.length===4){const z=p.parse(A[3],3,kt);return z?new Ga(T.type,T,D,z):null}return new Ga(T.type,T,D)}evaluate(A){const p=this.input.evaluate(A),T=this.beginIndex.evaluate(A);if(!Lr(p,["string","array"]))throw new Dt(`Expected first argument to be of type array or string, but found ${qn($e(p))} instead.`);if(this.endIndex){const D=this.endIndex.evaluate(A);return p.slice(T,D)}return p.slice(T)}eachChild(A){A(this.input),A(this.beginIndex),this.endIndex&&A(this.endIndex)}outputDefined(){return!1}}function Go(f,A){return f==="=="||f==="!="?A.kind==="boolean"||A.kind==="string"||A.kind==="number"||A.kind==="null"||A.kind==="value":A.kind==="string"||A.kind==="number"||A.kind==="value"}function Gr(f,A,p,T){return T.compare(A,p)===0}function jr(f,A,p){const T=f!=="=="&&f!=="!=";return class oB{constructor(z,F,j){this.type=wn,this.lhs=z,this.rhs=F,this.collator=j,this.hasUntypedArgument=z.type.kind==="value"||F.type.kind==="value"}static parse(z,F){if(z.length!==3&&z.length!==4)return F.error("Expected two or three arguments.");const j=z[0];let q=F.parse(z[1],1,mn);if(!q)return null;if(!Go(j,q.type))return F.concat(1).error(`"${j}" comparisons are not supported for type '${qn(q.type)}'.`);let ie=F.parse(z[2],2,mn);if(!ie)return null;if(!Go(j,ie.type))return F.concat(2).error(`"${j}" comparisons are not supported for type '${qn(ie.type)}'.`);if(q.type.kind!==ie.type.kind&&q.type.kind!=="value"&&ie.type.kind!=="value")return F.error(`Cannot compare types '${qn(q.type)}' and '${qn(ie.type)}'.`);T&&(q.type.kind==="value"&&ie.type.kind!=="value"?q=new jt(ie.type,[q]):q.type.kind!=="value"&&ie.type.kind==="value"&&(ie=new jt(q.type,[ie])));let Ae=null;if(z.length===4){if(q.type.kind!=="string"&&ie.type.kind!=="string"&&q.type.kind!=="value"&&ie.type.kind!=="value")return F.error("Cannot use collator to compare non-string types.");if(Ae=F.parse(z[3],3,qe),!Ae)return null}return new oB(q,ie,Ae)}evaluate(z){const F=this.lhs.evaluate(z),j=this.rhs.evaluate(z);if(T&&this.hasUntypedArgument){const q=$e(F),ie=$e(j);if(q.kind!==ie.kind||q.kind!=="string"&&q.kind!=="number")throw new Dt(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${q.kind}, ${ie.kind}) instead.`)}if(this.collator&&!T&&this.hasUntypedArgument){const q=$e(F),ie=$e(j);if(q.kind!=="string"||ie.kind!=="string")return A(z,F,j)}return this.collator?p(z,F,j,this.collator.evaluate(z)):A(z,F,j)}eachChild(z){z(this.lhs),z(this.rhs),this.collator&&z(this.collator)}outputDefined(){return!0}}}const QA=jr("==",function(f,A,p){return A===p},Gr),wl=jr("!=",function(f,A,p){return A!==p},function(f,A,p,T){return!Gr(0,A,p,T)}),mo=jr("<",function(f,A,p){return A<p},function(f,A,p,T){return T.compare(A,p)<0}),jo=jr(">",function(f,A,p){return A>p},function(f,A,p,T){return T.compare(A,p)>0}),Ju=jr("<=",function(f,A,p){return A<=p},function(f,A,p,T){return T.compare(A,p)<=0}),qA=jr(">=",function(f,A,p){return A>=p},function(f,A,p,T){return T.compare(A,p)>=0});class bl{constructor(A,p,T,D,z){this.type=Tn,this.number=A,this.locale=p,this.currency=T,this.minFractionDigits=D,this.maxFractionDigits=z}static parse(A,p){if(A.length!==3)return p.error("Expected two arguments.");const T=p.parse(A[1],1,kt);if(!T)return null;const D=A[2];if(typeof D!="object"||Array.isArray(D))return p.error("NumberFormat options argument must be an object.");let z=null;if(D.locale&&(z=p.parse(D.locale,1,Tn),!z))return null;let F=null;if(D.currency&&(F=p.parse(D.currency,1,Tn),!F))return null;let j=null;if(D["min-fraction-digits"]&&(j=p.parse(D["min-fraction-digits"],1,kt),!j))return null;let q=null;return D["max-fraction-digits"]&&(q=p.parse(D["max-fraction-digits"],1,kt),!q)?null:new bl(T,z,F,j,q)}evaluate(A){return new Intl.NumberFormat(this.locale?this.locale.evaluate(A):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(A):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(A):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(A):void 0}).format(this.number.evaluate(A))}eachChild(A){A(this.number),this.locale&&A(this.locale),this.currency&&A(this.currency),this.minFractionDigits&&A(this.minFractionDigits),this.maxFractionDigits&&A(this.maxFractionDigits)}outputDefined(){return!1}}class dA{constructor(A){this.type=$i,this.sections=A}static parse(A,p){if(A.length<2)return p.error("Expected at least one argument.");const T=A[1];if(!Array.isArray(T)&&typeof T=="object")return p.error("First argument must be an image or text section.");const D=[];let z=!1;for(let F=1;F<=A.length-1;++F){const j=A[F];if(z&&typeof j=="object"&&!Array.isArray(j)){z=!1;let q=null;if(j["font-scale"]&&(q=p.parse(j["font-scale"],1,kt),!q))return null;let ie=null;if(j["text-font"]&&(ie=p.parse(j["text-font"],1,or(Tn)),!ie))return null;let Ae=null;if(j["text-color"]&&(Ae=p.parse(j["text-color"],1,Ii),!Ae))return null;const ce=D[D.length-1];ce.scale=q,ce.font=ie,ce.textColor=Ae}else{const q=p.parse(A[F],1,mn);if(!q)return null;const ie=q.type.kind;if(ie!=="string"&&ie!=="value"&&ie!=="null"&&ie!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");z=!0,D.push({content:q,scale:null,font:null,textColor:null})}}return new dA(D)}evaluate(A){return new Ie(this.sections.map(p=>{const T=p.content.evaluate(A);return $e(T)===Ri?new Le("",T,null,null,null):new Le(ht(T),null,p.scale?p.scale.evaluate(A):null,p.font?p.font.evaluate(A).join(","):null,p.textColor?p.textColor.evaluate(A):null)}))}eachChild(A){for(const p of this.sections)A(p.content),p.scale&&A(p.scale),p.font&&A(p.font),p.textColor&&A(p.textColor)}outputDefined(){return!1}}class ZA{constructor(A){this.type=Ri,this.input=A}static parse(A,p){if(A.length!==2)return p.error("Expected two arguments.");const T=p.parse(A[1],1,Tn);return T?new ZA(T):p.error("No image name provided.")}evaluate(A){const p=this.input.evaluate(A),T=ke.fromString(p);return T&&A.availableImages&&(T.available=A.availableImages.indexOf(p)>-1),T}eachChild(A){A(this.input)}outputDefined(){return!1}}class $o{constructor(A){this.type=kt,this.input=A}static parse(A,p){if(A.length!==2)return p.error(`Expected 1 argument, but found ${A.length-1} instead.`);const T=p.parse(A[1],1);return T?T.type.kind!=="array"&&T.type.kind!=="string"&&T.type.kind!=="value"?p.error(`Expected argument of type string or array, but found ${qn(T.type)} instead.`):new $o(T):null}evaluate(A){const p=this.input.evaluate(A);if(typeof p=="string"||Array.isArray(p))return p.length;throw new Dt(`Expected value to be of type string or array, but found ${qn($e(p))} instead.`)}eachChild(A){A(this.input)}outputDefined(){return!1}}const ja={"==":QA,"!=":wl,">":jo,"<":mo,">=":qA,"<=":Ju,array:jt,at:xl,boolean:jt,case:fA,coalesce:er,collator:Oe,format:dA,image:ZA,in:Vo,"index-of":ca,interpolate:Bn,"interpolate-hcl":Bn,"interpolate-lab":Bn,length:$o,let:po,literal:Lt,match:go,number:jt,"number-format":bl,object:jt,slice:Ga,step:Pi,string:jt,"to-boolean":Qt,"to-color":Qt,"to-number":Qt,"to-string":Qt,var:ot,within:Ji};function YA(f,[A,p,T,D]){A=A.evaluate(f),p=p.evaluate(f),T=T.evaluate(f);const z=D?D.evaluate(f):1,F=We(A,p,T,z);if(F)throw new Dt(F);return new o(A/255*z,p/255*z,T/255*z,z)}function XA(f,A){return f in A}function yo(f,A){const p=A[f];return p===void 0?null:p}function ha(f){return{type:f}}function KA(f){return{result:"success",value:f}}function fa(f){return{result:"error",value:f}}function hi(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function Fs(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function Gn(f){return!!f.expression&&f.expression.interpolated}function Wn(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function vi(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function di(f){return f}function El(f,A){const p=A.type==="color",T=f.stops&&typeof f.stops[0][0]=="object",D=T||!(T||f.property!==void 0),z=f.type||(Gn(A)?"exponential":"interval");if(p||A.type==="padding"){const ie=p?o.parse:Pe.parse;(f=xr({},f)).stops&&(f.stops=f.stops.map(Ae=>[Ae[0],ie(Ae[1])])),f.default=ie(f.default?f.default:A.default)}if(f.colorSpace&&f.colorSpace!=="rgb"&&!Uo[f.colorSpace])throw new Error(`Unknown color space: ${f.colorSpace}`);let F,j,q;if(z==="exponential")F=tc;else if(z==="interval")F=$a;else if(z==="categorical"){F=ec,j=Object.create(null);for(const ie of f.stops)j[ie[0]]=ie[1];q=typeof f.stops[0][0]}else{if(z!=="identity")throw new Error(`Unknown function type "${z}"`);F=JA}if(T){const ie={},Ae=[];for(let me=0;me<f.stops.length;me++){const ye=f.stops[me],Ne=ye[0].zoom;ie[Ne]===void 0&&(ie[Ne]={zoom:Ne,type:f.type,property:f.property,default:f.default,stops:[]},Ae.push(Ne)),ie[Ne].stops.push([ye[0].value,ye[1]])}const ce=[];for(const me of Ae)ce.push([ie[me].zoom,El(ie[me],A)]);const pe={name:"linear"};return{kind:"composite",interpolationType:pe,interpolationFactor:Bn.interpolationFactor.bind(void 0,pe),zoomStops:ce.map(me=>me[0]),evaluate:({zoom:me},ye)=>tc({stops:ce,base:f.base},A,me).evaluate(me,ye)}}if(D){const ie=z==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:ie,interpolationFactor:Bn.interpolationFactor.bind(void 0,ie),zoomStops:f.stops.map(Ae=>Ae[0]),evaluate:({zoom:Ae})=>F(f,A,Ae,j,q)}}return{kind:"source",evaluate(ie,Ae){const ce=Ae&&Ae.properties?Ae.properties[f.property]:void 0;return ce===void 0?Ho(f.default,A.default):F(f,A,ce,j,q)}}}function Ho(f,A,p){return f!==void 0?f:A!==void 0?A:p!==void 0?p:void 0}function ec(f,A,p,T,D){return Ho(typeof p===D?T[p]:void 0,f.default,A.default)}function $a(f,A,p){if(Wn(p)!=="number")return Ho(f.default,A.default);const T=f.stops.length;if(T===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[T-1][0])return f.stops[T-1][1];const D=kn(f.stops.map(z=>z[0]),p);return f.stops[D][1]}function tc(f,A,p){const T=f.base!==void 0?f.base:1;if(Wn(p)!=="number")return Ho(f.default,A.default);const D=f.stops.length;if(D===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[D-1][0])return f.stops[D-1][1];const z=kn(f.stops.map(Ae=>Ae[0]),p),F=function(Ae,ce,pe,me){const ye=me-pe,Ne=Ae-pe;return ye===0?0:ce===1?Ne/ye:(Math.pow(ce,Ne)-1)/(Math.pow(ce,ye)-1)}(p,T,f.stops[z][0],f.stops[z+1][0]),j=f.stops[z][1],q=f.stops[z+1][1];let ie=ki[A.type]||di;if(f.colorSpace&&f.colorSpace!=="rgb"){const Ae=Uo[f.colorSpace];ie=(ce,pe)=>Ae.reverse(Ae.interpolate(Ae.forward(ce),Ae.forward(pe),F))}return typeof j.evaluate=="function"?{evaluate(...Ae){const ce=j.evaluate.apply(void 0,Ae),pe=q.evaluate.apply(void 0,Ae);if(ce!==void 0&&pe!==void 0)return ie(ce,pe,F)}}:ie(j,q,F)}function JA(f,A,p){switch(A.type){case"color":p=o.parse(p);break;case"formatted":p=Ie.fromString(p.toString());break;case"resolvedImage":p=ke.fromString(p.toString());break;case"padding":p=Pe.parse(p);break;default:Wn(p)===A.type||A.type==="enum"&&A.values[p]||(p=void 0)}return Ho(p,f.default,A.default)}Ot.register(ja,{error:[{kind:"error"},[Tn],(f,[A])=>{throw new Dt(A.evaluate(f))}],typeof:[Tn,[mn],(f,[A])=>qn($e(A.evaluate(f)))],"to-rgba":[or(kt,4),[Ii],(f,[A])=>A.evaluate(f).toArray()],rgb:[Ii,[kt,kt,kt],YA],rgba:[Ii,[kt,kt,kt,kt],YA],has:{type:wn,overloads:[[[Tn],(f,[A])=>XA(A.evaluate(f),f.properties())],[[Tn,vs],(f,[A,p])=>XA(A.evaluate(f),p.evaluate(f))]]},get:{type:mn,overloads:[[[Tn],(f,[A])=>yo(A.evaluate(f),f.properties())],[[Tn,vs],(f,[A,p])=>yo(A.evaluate(f),p.evaluate(f))]]},"feature-state":[mn,[Tn],(f,[A])=>yo(A.evaluate(f),f.featureState||{})],properties:[vs,[],f=>f.properties()],"geometry-type":[Tn,[],f=>f.geometryType()],id:[mn,[],f=>f.id()],zoom:[kt,[],f=>f.globals.zoom],"heatmap-density":[kt,[],f=>f.globals.heatmapDensity||0],"line-progress":[kt,[],f=>f.globals.lineProgress||0],accumulated:[mn,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[kt,ha(kt),(f,A)=>{let p=0;for(const T of A)p+=T.evaluate(f);return p}],"*":[kt,ha(kt),(f,A)=>{let p=1;for(const T of A)p*=T.evaluate(f);return p}],"-":{type:kt,overloads:[[[kt,kt],(f,[A,p])=>A.evaluate(f)-p.evaluate(f)],[[kt],(f,[A])=>-A.evaluate(f)]]},"/":[kt,[kt,kt],(f,[A,p])=>A.evaluate(f)/p.evaluate(f)],"%":[kt,[kt,kt],(f,[A,p])=>A.evaluate(f)%p.evaluate(f)],ln2:[kt,[],()=>Math.LN2],pi:[kt,[],()=>Math.PI],e:[kt,[],()=>Math.E],"^":[kt,[kt,kt],(f,[A,p])=>Math.pow(A.evaluate(f),p.evaluate(f))],sqrt:[kt,[kt],(f,[A])=>Math.sqrt(A.evaluate(f))],log10:[kt,[kt],(f,[A])=>Math.log(A.evaluate(f))/Math.LN10],ln:[kt,[kt],(f,[A])=>Math.log(A.evaluate(f))],log2:[kt,[kt],(f,[A])=>Math.log(A.evaluate(f))/Math.LN2],sin:[kt,[kt],(f,[A])=>Math.sin(A.evaluate(f))],cos:[kt,[kt],(f,[A])=>Math.cos(A.evaluate(f))],tan:[kt,[kt],(f,[A])=>Math.tan(A.evaluate(f))],asin:[kt,[kt],(f,[A])=>Math.asin(A.evaluate(f))],acos:[kt,[kt],(f,[A])=>Math.acos(A.evaluate(f))],atan:[kt,[kt],(f,[A])=>Math.atan(A.evaluate(f))],min:[kt,ha(kt),(f,A)=>Math.min(...A.map(p=>p.evaluate(f)))],max:[kt,ha(kt),(f,A)=>Math.max(...A.map(p=>p.evaluate(f)))],abs:[kt,[kt],(f,[A])=>Math.abs(A.evaluate(f))],round:[kt,[kt],(f,[A])=>{const p=A.evaluate(f);return p<0?-Math.round(-p):Math.round(p)}],floor:[kt,[kt],(f,[A])=>Math.floor(A.evaluate(f))],ceil:[kt,[kt],(f,[A])=>Math.ceil(A.evaluate(f))],"filter-==":[wn,[Tn,mn],(f,[A,p])=>f.properties()[A.value]===p.value],"filter-id-==":[wn,[mn],(f,[A])=>f.id()===A.value],"filter-type-==":[wn,[Tn],(f,[A])=>f.geometryType()===A.value],"filter-<":[wn,[Tn,mn],(f,[A,p])=>{const T=f.properties()[A.value],D=p.value;return typeof T==typeof D&&T<D}],"filter-id-<":[wn,[mn],(f,[A])=>{const p=f.id(),T=A.value;return typeof p==typeof T&&p<T}],"filter->":[wn,[Tn,mn],(f,[A,p])=>{const T=f.properties()[A.value],D=p.value;return typeof T==typeof D&&T>D}],"filter-id->":[wn,[mn],(f,[A])=>{const p=f.id(),T=A.value;return typeof p==typeof T&&p>T}],"filter-<=":[wn,[Tn,mn],(f,[A,p])=>{const T=f.properties()[A.value],D=p.value;return typeof T==typeof D&&T<=D}],"filter-id-<=":[wn,[mn],(f,[A])=>{const p=f.id(),T=A.value;return typeof p==typeof T&&p<=T}],"filter->=":[wn,[Tn,mn],(f,[A,p])=>{const T=f.properties()[A.value],D=p.value;return typeof T==typeof D&&T>=D}],"filter-id->=":[wn,[mn],(f,[A])=>{const p=f.id(),T=A.value;return typeof p==typeof T&&p>=T}],"filter-has":[wn,[mn],(f,[A])=>A.value in f.properties()],"filter-has-id":[wn,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[wn,[or(Tn)],(f,[A])=>A.value.indexOf(f.geometryType())>=0],"filter-id-in":[wn,[or(mn)],(f,[A])=>A.value.indexOf(f.id())>=0],"filter-in-small":[wn,[Tn,or(mn)],(f,[A,p])=>p.value.indexOf(f.properties()[A.value])>=0],"filter-in-large":[wn,[Tn,or(mn)],(f,[A,p])=>function(T,D,z,F){for(;z<=F;){const j=z+F>>1;if(D[j]===T)return!0;D[j]>T?F=j-1:z=j+1}return!1}(f.properties()[A.value],p.value,0,p.value.length-1)],all:{type:wn,overloads:[[[wn,wn],(f,[A,p])=>A.evaluate(f)&&p.evaluate(f)],[ha(wn),(f,A)=>{for(const p of A)if(!p.evaluate(f))return!1;return!0}]]},any:{type:wn,overloads:[[[wn,wn],(f,[A,p])=>A.evaluate(f)||p.evaluate(f)],[ha(wn),(f,A)=>{for(const p of A)if(p.evaluate(f))return!0;return!1}]]},"!":[wn,[wn],(f,[A])=>!A.evaluate(f)],"is-supported-script":[wn,[Tn],(f,[A])=>{const p=f.globals&&f.globals.isSupportedScript;return!p||p(A.evaluate(f))}],upcase:[Tn,[Tn],(f,[A])=>A.evaluate(f).toUpperCase()],downcase:[Tn,[Tn],(f,[A])=>A.evaluate(f).toLowerCase()],concat:[Tn,ha(mn),(f,A)=>A.map(p=>ht(p.evaluate(f))).join("")],"resolved-locale":[Tn,[qe],(f,[A])=>A.evaluate(f).resolvedLocale()]});class Ns{constructor(A,p){this.expression=A,this._warningHistory={},this._evaluator=new vn,this._defaultValue=p?function(T){return T.type==="color"&&vi(T.default)?new o(0,0,0,0):T.type==="color"?o.parse(T.default)||null:T.type==="padding"?Pe.parse(T.default)||null:T.default===void 0?null:T.default}(p):null,this._enumValues=p&&p.type==="enum"?p.values:null}evaluateWithoutErrorHandling(A,p,T,D,z,F){return this._evaluator.globals=A,this._evaluator.feature=p,this._evaluator.featureState=T,this._evaluator.canonical=D,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=F,this.expression.evaluate(this._evaluator)}evaluate(A,p,T,D,z,F){this._evaluator.globals=A,this._evaluator.feature=p||null,this._evaluator.featureState=T||null,this._evaluator.canonical=D,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=F||null;try{const j=this.expression.evaluate(this._evaluator);if(j==null||typeof j=="number"&&j!=j)return this._defaultValue;if(this._enumValues&&!(j in this._enumValues))throw new Dt(`Expected value to be one of ${Object.keys(this._enumValues).map(q=>JSON.stringify(q)).join(", ")}, but found ${JSON.stringify(j)} instead.`);return j}catch(j){return this._warningHistory[j.message]||(this._warningHistory[j.message]=!0,typeof console<"u"&&console.warn(j.message)),this._defaultValue}}}function Tl(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in ja}function Ha(f,A){const p=new wt(ja,[],A?function(D){const z={color:Ii,string:Tn,number:kt,enum:Tn,boolean:wn,formatted:$i,padding:zs,resolvedImage:Ri};return D.type==="array"?or(z[D.value]||mn,D.length):z[D.type]}(A):void 0),T=p.parse(f,void 0,void 0,void 0,A&&A.type==="string"?{typeAnnotation:"coerce"}:void 0);return T?KA(new Ns(T,A)):fa(p.errors)}class da{constructor(A,p){this.kind=A,this._styleExpression=p,this.isStateDependent=A!=="constant"&&!Ee(p.expression)}evaluateWithoutErrorHandling(A,p,T,D,z,F){return this._styleExpression.evaluateWithoutErrorHandling(A,p,T,D,z,F)}evaluate(A,p,T,D,z,F){return this._styleExpression.evaluate(A,p,T,D,z,F)}}class Sl{constructor(A,p,T,D){this.kind=A,this.zoomStops=T,this._styleExpression=p,this.isStateDependent=A!=="camera"&&!Ee(p.expression),this.interpolationType=D}evaluateWithoutErrorHandling(A,p,T,D,z,F){return this._styleExpression.evaluateWithoutErrorHandling(A,p,T,D,z,F)}evaluate(A,p,T,D,z,F){return this._styleExpression.evaluate(A,p,T,D,z,F)}interpolationFactor(A,p,T){return this.interpolationType?Bn.interpolationFactor(this.interpolationType,A,p,T):0}}function Ml(f,A){const p=Ha(f,A);if(p.result==="error")return p;const T=p.value.expression,D=ge(T);if(!D&&!hi(A))return fa([new Ir("","data expressions not supported")]);const z=Fe(T,["zoom"]);if(!z&&!Fs(A))return fa([new Ir("","zoom expressions not supported")]);const F=pA(T);return F||z?F instanceof Ir?fa([F]):F instanceof Bn&&!Gn(A)?fa([new Ir("",'"interpolate" expressions cannot be used with this property')]):KA(F?new Sl(D?"camera":"composite",p.value,F.labels,F instanceof Bn?F.interpolation:void 0):new da(D?"constant":"source",p.value)):fa([new Ir("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class pi{constructor(A,p){this._parameters=A,this._specification=p,xr(this,El(this._parameters,this._specification))}static deserialize(A){return new pi(A._parameters,A._specification)}static serialize(A){return{_parameters:A._parameters,_specification:A._specification}}}function pA(f){let A=null;if(f instanceof po)A=pA(f.result);else if(f instanceof er){for(const p of f.args)if(A=pA(p),A)break}else(f instanceof Pi||f instanceof Bn)&&f.input instanceof Ot&&f.input.name==="zoom"&&(A=f);return A instanceof Ir||f.eachChild(p=>{const T=pA(p);T instanceof Ir?A=T:!A&&T?A=new Ir("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):A&&T&&A!==T&&(A=new Ir("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),A}function os(f){const A=f.key,p=f.value,T=f.valueSpec||{},D=f.objectElementValidators||{},z=f.style,F=f.styleSpec;let j=[];const q=Wn(p);if(q!=="object")return[new It(A,p,`object expected, ${q} found`)];for(const ie in p){const Ae=ie.split(".")[0],ce=T[Ae]||T["*"];let pe;if(D[Ae])pe=D[Ae];else if(T[Ae])pe=qr;else if(D["*"])pe=D["*"];else{if(!T["*"]){j.push(new It(A,p[ie],`unknown property "${ie}"`));continue}pe=qr}j=j.concat(pe({key:(A&&`${A}.`)+ie,value:p[ie],valueSpec:ce,style:z,styleSpec:F,object:p,objectKey:ie},p))}for(const ie in T)D[ie]||T[ie].required&&T[ie].default===void 0&&p[ie]===void 0&&j.push(new It(A,p,`missing required property "${ie}"`));return j}function eu(f){const A=f.value,p=f.valueSpec,T=f.style,D=f.styleSpec,z=f.key,F=f.arrayElementValidator||qr;if(Wn(A)!=="array")return[new It(z,A,`array expected, ${Wn(A)} found`)];if(p.length&&A.length!==p.length)return[new It(z,A,`array length ${p.length} expected, length ${A.length} found`)];if(p["min-length"]&&A.length<p["min-length"])return[new It(z,A,`array length at least ${p["min-length"]} expected, length ${A.length} found`)];let j={type:p.value,values:p.values};D.$version<7&&(j.function=p.function),Wn(p.value)==="object"&&(j=p.value);let q=[];for(let ie=0;ie<A.length;ie++)q=q.concat(F({array:A,arrayIndex:ie,value:A[ie],valueSpec:j,style:T,styleSpec:D,key:`${z}[${ie}]`}));return q}function Cl(f){const A=f.key,p=f.value,T=f.valueSpec;let D=Wn(p);return D==="number"&&p!=p&&(D="NaN"),D!=="number"?[new It(A,p,`number expected, ${D} found`)]:"minimum"in T&&p<T.minimum?[new It(A,p,`${p} is less than the minimum value ${T.minimum}`)]:"maximum"in T&&p>T.maximum?[new It(A,p,`${p} is greater than the maximum value ${T.maximum}`)]:[]}function nc(f){const A=f.valueSpec,p=Rn(f.value.type);let T,D,z,F={};const j=p!=="categorical"&&f.value.property===void 0,q=!j,ie=Wn(f.value.stops)==="array"&&Wn(f.value.stops[0])==="array"&&Wn(f.value.stops[0][0])==="object",Ae=os({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(me){if(p==="identity")return[new It(me.key,me.value,'identity function may not have a "stops" property')];let ye=[];const Ne=me.value;return ye=ye.concat(eu({key:me.key,value:Ne,valueSpec:me.valueSpec,style:me.style,styleSpec:me.styleSpec,arrayElementValidator:ce})),Wn(Ne)==="array"&&Ne.length===0&&ye.push(new It(me.key,Ne,"array must have at least one stop")),ye},default:function(me){return qr({key:me.key,value:me.value,valueSpec:A,style:me.style,styleSpec:me.styleSpec})}}});return p==="identity"&&j&&Ae.push(new It(f.key,f.value,'missing required property "property"')),p==="identity"||f.value.stops||Ae.push(new It(f.key,f.value,'missing required property "stops"')),p==="exponential"&&f.valueSpec.expression&&!Gn(f.valueSpec)&&Ae.push(new It(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(q&&!hi(f.valueSpec)?Ae.push(new It(f.key,f.value,"property functions not supported")):j&&!Fs(f.valueSpec)&&Ae.push(new It(f.key,f.value,"zoom functions not supported"))),p!=="categorical"&&!ie||f.value.property!==void 0||Ae.push(new It(f.key,f.value,'"property" property is required')),Ae;function ce(me){let ye=[];const Ne=me.value,ze=me.key;if(Wn(Ne)!=="array")return[new It(ze,Ne,`array expected, ${Wn(Ne)} found`)];if(Ne.length!==2)return[new It(ze,Ne,`array length 2 expected, length ${Ne.length} found`)];if(ie){if(Wn(Ne[0])!=="object")return[new It(ze,Ne,`object expected, ${Wn(Ne[0])} found`)];if(Ne[0].zoom===void 0)return[new It(ze,Ne,"object stop key must have zoom")];if(Ne[0].value===void 0)return[new It(ze,Ne,"object stop key must have value")];if(z&&z>Rn(Ne[0].zoom))return[new It(ze,Ne[0].zoom,"stop zoom values must appear in ascending order")];Rn(Ne[0].zoom)!==z&&(z=Rn(Ne[0].zoom),D=void 0,F={}),ye=ye.concat(os({key:`${ze}[0]`,value:Ne[0],valueSpec:{zoom:{}},style:me.style,styleSpec:me.styleSpec,objectElementValidators:{zoom:Cl,value:pe}}))}else ye=ye.concat(pe({key:`${ze}[0]`,value:Ne[0],valueSpec:{},style:me.style,styleSpec:me.styleSpec},Ne));return Tl(Nr(Ne[1]))?ye.concat([new It(`${ze}[1]`,Ne[1],"expressions are not allowed in function stops.")]):ye.concat(qr({key:`${ze}[1]`,value:Ne[1],valueSpec:A,style:me.style,styleSpec:me.styleSpec}))}function pe(me,ye){const Ne=Wn(me.value),ze=Rn(me.value),Je=me.value!==null?me.value:ye;if(T){if(Ne!==T)return[new It(me.key,Je,`${Ne} stop domain type must match previous stop domain type ${T}`)]}else T=Ne;if(Ne!=="number"&&Ne!=="string"&&Ne!=="boolean")return[new It(me.key,Je,"stop domain value must be a number, string, or boolean")];if(Ne!=="number"&&p!=="categorical"){let lt=`number expected, ${Ne} found`;return hi(A)&&p===void 0&&(lt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new It(me.key,Je,lt)]}return p!=="categorical"||Ne!=="number"||isFinite(ze)&&Math.floor(ze)===ze?p!=="categorical"&&Ne==="number"&&D!==void 0&&ze<D?[new It(me.key,Je,"stop domain values must appear in ascending order")]:(D=ze,p==="categorical"&&ze in F?[new It(me.key,Je,"stop domain values must be unique")]:(F[ze]=!0,[])):[new It(me.key,Je,`integer expected, found ${ze}`)]}}function Wi(f){const A=(f.expressionContext==="property"?Ml:Ha)(Nr(f.value),f.valueSpec);if(A.result==="error")return A.value.map(T=>new It(`${f.key}${T.key}`,f.value,T.message));const p=A.value.expression||A.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!p.outputDefined())return[new It(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!Ee(p))return[new It(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!Ee(p))return[new It(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!Fe(p,["zoom","feature-state"]))return[new It(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!ge(p))return[new It(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Li(f){const A=f.key,p=f.value,T=f.valueSpec,D=[];return Array.isArray(T.values)?T.values.indexOf(Rn(p))===-1&&D.push(new It(A,p,`expected one of [${T.values.join(", ")}], ${JSON.stringify(p)} found`)):Object.keys(T.values).indexOf(Rn(p))===-1&&D.push(new It(A,p,`expected one of [${Object.keys(T.values).join(", ")}], ${JSON.stringify(p)} found`)),D}function tr(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const A of f.slice(1))if(!tr(A)&&typeof A!="boolean")return!1;return!0;default:return!0}}const tu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Us(f){if(f==null)return{filter:()=>!0,needGeometry:!1};tr(f)||(f=lr(f));const A=Ha(f,tu);if(A.result==="error")throw new Error(A.value.map(p=>`${p.key}: ${p.message}`).join(", "));return{filter:(p,T,D)=>A.value.evaluate(p,T,{},D),needGeometry:gA(f)}}function ic(f,A){return f<A?-1:f>A?1:0}function gA(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(let A=1;A<f.length;A++)if(gA(f[A]))return!0;return!1}function lr(f){if(!f)return!0;const A=f[0];return f.length<=1?A!=="any":A==="=="?wr(f[1],f[2],"=="):A==="!="?Qr(wr(f[1],f[2],"==")):A==="<"||A===">"||A==="<="||A===">="?wr(f[1],f[2],A):A==="any"?(p=f.slice(1),["any"].concat(p.map(lr))):A==="all"?["all"].concat(f.slice(1).map(lr)):A==="none"?["all"].concat(f.slice(1).map(lr).map(Qr)):A==="in"?as(f[1],f.slice(2)):A==="!in"?Qr(as(f[1],f.slice(2))):A==="has"?pa(f[1]):A==="!has"?Qr(pa(f[1])):A!=="within"||f;var p}function wr(f,A,p){switch(f){case"$type":return[`filter-type-${p}`,A];case"$id":return[`filter-id-${p}`,A];default:return[`filter-${p}`,f,A]}}function as(f,A){if(A.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",A]];case"$id":return["filter-id-in",["literal",A]];default:return A.length>200&&!A.some(p=>typeof p!=typeof A[0])?["filter-in-large",f,["literal",A.sort(ic)]]:["filter-in-small",f,["literal",A]]}}function pa(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function Qr(f){return["!",f]}function _o(f){return tr(Nr(f.value))?Wi(xr({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):fr(f)}function fr(f){const A=f.value,p=f.key;if(Wn(A)!=="array")return[new It(p,A,`array expected, ${Wn(A)} found`)];const T=f.styleSpec;let D,z=[];if(A.length<1)return[new It(p,A,"filter array must have at least 1 element")];switch(z=z.concat(Li({key:`${p}[0]`,value:A[0],valueSpec:T.filter_operator,style:f.style,styleSpec:f.styleSpec})),Rn(A[0])){case"<":case"<=":case">":case">=":A.length>=2&&Rn(A[1])==="$type"&&z.push(new It(p,A,`"$type" cannot be use with operator "${A[0]}"`));case"==":case"!=":A.length!==3&&z.push(new It(p,A,`filter array for operator "${A[0]}" must have 3 elements`));case"in":case"!in":A.length>=2&&(D=Wn(A[1]),D!=="string"&&z.push(new It(`${p}[1]`,A[1],`string expected, ${D} found`)));for(let F=2;F<A.length;F++)D=Wn(A[F]),Rn(A[1])==="$type"?z=z.concat(Li({key:`${p}[${F}]`,value:A[F],valueSpec:T.geometry_type,style:f.style,styleSpec:f.styleSpec})):D!=="string"&&D!=="number"&&D!=="boolean"&&z.push(new It(`${p}[${F}]`,A[F],`string, number, or boolean expected, ${D} found`));break;case"any":case"all":case"none":for(let F=1;F<A.length;F++)z=z.concat(fr({key:`${p}[${F}]`,value:A[F],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":D=Wn(A[1]),A.length!==2?z.push(new It(p,A,`filter array for "${A[0]}" operator must have 2 elements`)):D!=="string"&&z.push(new It(`${p}[1]`,A[1],`string expected, ${D} found`));break;case"within":D=Wn(A[1]),A.length!==2?z.push(new It(p,A,`filter array for "${A[0]}" operator must have 2 elements`)):D!=="object"&&z.push(new It(`${p}[1]`,A[1],`object expected, ${D} found`))}return z}function Wa(f,A){const p=f.key,T=f.style,D=f.styleSpec,z=f.value,F=f.objectKey,j=D[`${A}_${f.layerType}`];if(!j)return[];const q=F.match(/^(.*)-transition$/);if(A==="paint"&&q&&j[q[1]]&&j[q[1]].transition)return qr({key:p,value:z,valueSpec:D.transition,style:T,styleSpec:D});const ie=f.valueSpec||j[F];if(!ie)return[new It(p,z,`unknown property "${F}"`)];let Ae;if(Wn(z)==="string"&&hi(ie)&&!ie.tokens&&(Ae=/^{([^}]+)}$/.exec(z)))return[new It(p,z,`"${F}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Ae[1])} }\`.`)];const ce=[];return f.layerType==="symbol"&&(F==="text-field"&&T&&!T.glyphs&&ce.push(new It(p,z,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&vi(Nr(z))&&Rn(z.type)==="identity"&&ce.push(new It(p,z,'"text-font" does not support identity functions'))),ce.concat(qr({key:f.key,value:z,valueSpec:ie,style:T,styleSpec:D,expressionContext:"property",propertyType:A,propertyKey:F}))}function Pl(f){return Wa(f,"paint")}function Qa(f){return Wa(f,"layout")}function Vs(f){let A=[];const p=f.value,T=f.key,D=f.style,z=f.styleSpec;p.type||p.ref||A.push(new It(T,p,'either "type" or "ref" is required'));let F=Rn(p.type);const j=Rn(p.ref);if(p.id){const q=Rn(p.id);for(let ie=0;ie<f.arrayIndex;ie++){const Ae=D.layers[ie];Rn(Ae.id)===q&&A.push(new It(T,p.id,`duplicate layer id "${p.id}", previously used at line ${Ae.id.__line__}`))}}if("ref"in p){let q;["type","source","source-layer","filter","layout"].forEach(ie=>{ie in p&&A.push(new It(T,p[ie],`"${ie}" is prohibited for ref layers`))}),D.layers.forEach(ie=>{Rn(ie.id)===j&&(q=ie)}),q?q.ref?A.push(new It(T,p.ref,"ref cannot reference another ref layer")):F=Rn(q.type):A.push(new It(T,p.ref,`ref layer "${j}" not found`))}else if(F!=="background")if(p.source){const q=D.sources&&D.sources[p.source],ie=q&&Rn(q.type);q?ie==="vector"&&F==="raster"?A.push(new It(T,p.source,`layer "${p.id}" requires a raster source`)):ie==="raster"&&F!=="raster"?A.push(new It(T,p.source,`layer "${p.id}" requires a vector source`)):ie!=="vector"||p["source-layer"]?ie==="raster-dem"&&F!=="hillshade"?A.push(new It(T,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):F!=="line"||!p.paint||!p.paint["line-gradient"]||ie==="geojson"&&q.lineMetrics||A.push(new It(T,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):A.push(new It(T,p,`layer "${p.id}" must specify a "source-layer"`)):A.push(new It(T,p.source,`source "${p.source}" not found`))}else A.push(new It(T,p,'missing required property "source"'));return A=A.concat(os({key:T,value:p,valueSpec:z.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>qr({key:`${T}.type`,value:p.type,valueSpec:z.layer.type,style:f.style,styleSpec:f.styleSpec,object:p,objectKey:"type"}),filter:_o,layout:q=>os({layer:p,key:q.key,value:q.value,style:q.style,styleSpec:q.styleSpec,objectElementValidators:{"*":ie=>Qa(xr({layerType:F},ie))}}),paint:q=>os({layer:p,key:q.key,value:q.value,style:q.style,styleSpec:q.styleSpec,objectElementValidators:{"*":ie=>Pl(xr({layerType:F},ie))}})}})),A}function ls(f){const A=f.value,p=f.key,T=Wn(A);return T!=="string"?[new It(p,A,`string expected, ${T} found`)]:[]}const rc={promoteId:function({key:f,value:A}){if(Wn(A)==="string")return ls({key:f,value:A});{const p=[];for(const T in A)p.push(...ls({key:`${f}.${T}`,value:A[T]}));return p}}};function ga(f){const A=f.value,p=f.key,T=f.styleSpec,D=f.style;if(!A.type)return[new It(p,A,'"type" is required')];const z=Rn(A.type);let F;switch(z){case"vector":case"raster":case"raster-dem":return F=os({key:p,value:A,valueSpec:T[`source_${z.replace("-","_")}`],style:f.style,styleSpec:T,objectElementValidators:rc}),F;case"geojson":if(F=os({key:p,value:A,valueSpec:T.source_geojson,style:D,styleSpec:T,objectElementValidators:rc}),A.cluster)for(const j in A.clusterProperties){const[q,ie]=A.clusterProperties[j],Ae=typeof q=="string"?[q,["accumulated"],["get",j]]:q;F.push(...Wi({key:`${p}.${j}.map`,value:ie,expressionContext:"cluster-map"})),F.push(...Wi({key:`${p}.${j}.reduce`,value:Ae,expressionContext:"cluster-reduce"}))}return F;case"video":return os({key:p,value:A,valueSpec:T.source_video,style:D,styleSpec:T});case"image":return os({key:p,value:A,valueSpec:T.source_image,style:D,styleSpec:T});case"canvas":return[new It(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Li({key:`${p}.type`,value:A.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:D,styleSpec:T})}}function qa(f){const A=f.value,p=f.styleSpec,T=p.light,D=f.style;let z=[];const F=Wn(A);if(A===void 0)return z;if(F!=="object")return z=z.concat([new It("light",A,`object expected, ${F} found`)]),z;for(const j in A){const q=j.match(/^(.*)-transition$/);z=z.concat(q&&T[q[1]]&&T[q[1]].transition?qr({key:j,value:A[j],valueSpec:p.transition,style:D,styleSpec:p}):T[j]?qr({key:j,value:A[j],valueSpec:T[j],style:D,styleSpec:p}):[new It(j,A[j],`unknown property "${j}"`)])}return z}function nr(f){const A=f.value,p=f.styleSpec,T=p.terrain,D=f.style;let z=[];const F=Wn(A);if(A===void 0)return z;if(F!=="object")return z=z.concat([new It("terrain",A,`object expected, ${F} found`)]),z;for(const j in A)z=z.concat(T[j]?qr({key:j,value:A[j],valueSpec:T[j],style:D,styleSpec:p}):[new It(j,A[j],`unknown property "${j}"`)]);return z}const bs={"*":()=>[],array:eu,boolean:function(f){const A=f.value,p=f.key,T=Wn(A);return T!=="boolean"?[new It(p,A,`boolean expected, ${T} found`)]:[]},number:Cl,color:function(f){const A=f.key,p=f.value,T=Wn(p);return T!=="string"?[new It(A,p,`color expected, ${T} found`)]:ss(p)===null?[new It(A,p,`color expected, "${p}" found`)]:[]},constants:Bs,enum:Li,filter:_o,function:nc,layer:Vs,object:os,source:ga,light:qa,terrain:nr,string:ls,formatted:function(f){return ls(f).length===0?[]:Wi(f)},resolvedImage:function(f){return ls(f).length===0?[]:Wi(f)},padding:function(f){const A=f.key,p=f.value;if(Wn(p)==="array"){if(p.length<1||p.length>4)return[new It(A,p,`padding requires 1 to 4 values; ${p.length} values found`)];const T={type:"number"};let D=[];for(let z=0;z<p.length;z++)D=D.concat(qr({key:`${A}[${z}]`,value:p[z],valueSpec:T}));return D}return Cl({key:A,value:p,valueSpec:{}})}};function qr(f){const A=f.value,p=f.valueSpec,T=f.styleSpec;return p.expression&&vi(Rn(A))?nc(f):p.expression&&Tl(Nr(A))?Wi(f):p.type&&bs[p.type]?bs[p.type](f):os(xr({},f,{valueSpec:p.type?T[p.type]:p}))}function Il(f){const A=f.value,p=f.key,T=ls(f);return T.length||(A.indexOf("{fontstack}")===-1&&T.push(new It(p,A,'"glyphs" url must include a "{fontstack}" token')),A.indexOf("{range}")===-1&&T.push(new It(p,A,'"glyphs" url must include a "{range}" token'))),T}function Wo(f,A=ut){let p=[];return p=p.concat(qr({key:"",value:f,valueSpec:A.$root,styleSpec:A,style:f,objectElementValidators:{glyphs:Il,"*":()=>[]}})),f.constants&&(p=p.concat(Bs({key:"constants",value:f.constants,style:f,styleSpec:A}))),sc(p)}function sc(f){return[].concat(f).sort((A,p)=>A.line-p.line)}function vo(f){return function(...A){return sc(f.apply(this,A))}}Wo.source=vo(ga),Wo.light=vo(qa),Wo.terrain=vo(nr),Wo.layer=vo(Vs),Wo.filter=vo(_o),Wo.paintProperty=vo(Pl),Wo.layoutProperty=vo(Qa);const kl=Wo,Za=kl.light,rh=kl.paintProperty,sh=kl.layoutProperty;function Ya(f,A){let p=!1;if(A&&A.length)for(const T of A)f.fire(new Fo(new Error(T.message))),p=!0;return p}class ma{constructor(A,p,T){const D=this.cells=[];if(A instanceof ArrayBuffer){this.arrayBuffer=A;const F=new Int32Array(this.arrayBuffer);A=F[0],this.d=(p=F[1])+2*(T=F[2]);for(let q=0;q<this.d*this.d;q++){const ie=F[3+q],Ae=F[3+q+1];D.push(ie===Ae?null:F.subarray(ie,Ae))}const j=F[3+D.length+1];this.keys=F.subarray(F[3+D.length],j),this.bboxes=F.subarray(j),this.insert=this._insertReadonly}else{this.d=p+2*T;for(let F=0;F<this.d*this.d;F++)D.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=A,this.padding=T,this.scale=p/A,this.uid=0;const z=T/p*A;this.min=-z,this.max=A+z}insert(A,p,T,D,z){this._forEachCell(p,T,D,z,this._insertCell,this.uid++,void 0,void 0),this.keys.push(A),this.bboxes.push(p),this.bboxes.push(T),this.bboxes.push(D),this.bboxes.push(z)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(A,p,T,D,z,F){this.cells[z].push(F)}query(A,p,T,D,z){const F=this.min,j=this.max;if(A<=F&&p<=F&&j<=T&&j<=D&&!z)return Array.prototype.slice.call(this.keys);{const q=[];return this._forEachCell(A,p,T,D,this._queryCell,q,{},z),q}}_queryCell(A,p,T,D,z,F,j,q){const ie=this.cells[z];if(ie!==null){const Ae=this.keys,ce=this.bboxes;for(let pe=0;pe<ie.length;pe++){const me=ie[pe];if(j[me]===void 0){const ye=4*me;(q?q(ce[ye+0],ce[ye+1],ce[ye+2],ce[ye+3]):A<=ce[ye+2]&&p<=ce[ye+3]&&T>=ce[ye+0]&&D>=ce[ye+1])?(j[me]=!0,F.push(Ae[me])):j[me]=!1}}}}_forEachCell(A,p,T,D,z,F,j,q){const ie=this._convertToCellCoord(A),Ae=this._convertToCellCoord(p),ce=this._convertToCellCoord(T),pe=this._convertToCellCoord(D);for(let me=ie;me<=ce;me++)for(let ye=Ae;ye<=pe;ye++){const Ne=this.d*ye+me;if((!q||q(this._convertFromCellCoord(me),this._convertFromCellCoord(ye),this._convertFromCellCoord(me+1),this._convertFromCellCoord(ye+1)))&&z.call(this,A,p,T,D,Ne,F,j,q))return}}_convertFromCellCoord(A){return(A-this.padding)/this.scale}_convertToCellCoord(A){return Math.max(0,Math.min(this.d-1,Math.floor(A*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const A=this.cells,p=3+this.cells.length+1+1;let T=0;for(let F=0;F<this.cells.length;F++)T+=this.cells[F].length;const D=new Int32Array(p+T+this.keys.length+this.bboxes.length);D[0]=this.extent,D[1]=this.n,D[2]=this.padding;let z=p;for(let F=0;F<A.length;F++){const j=A[F];D[3+F]=z,D.set(j,z),z+=j.length}return D[3+A.length]=z,D.set(this.keys,z),z+=this.keys.length,D[3+A.length+1]=z,D.set(this.bboxes,z),z+=this.bboxes.length,D.buffer}static serialize(A,p){const T=A.toArrayBuffer();return p&&p.push(T),{buffer:T}}static deserialize(A){return new ma(A.buffer)}}const As={};function Ft(f,A,p={}){if(As[f])throw new Error(`${f} is already registered.`);Object.defineProperty(A,"_classRegistryKey",{value:f,writeable:!1}),As[f]={klass:A,omit:p.omit||[],shallow:p.shallow||[]}}Ft("Object",Object),Ft("TransferableGridIndex",ma),Ft("Color",o),Ft("Error",Error),Ft("AJAXError",ei),Ft("ResolvedImage",ke),Ft("StylePropertyFunction",pi),Ft("StyleExpression",Ns,{omit:["_evaluator"]}),Ft("ZoomDependentExpression",Sl),Ft("ZoomConstantExpression",da),Ft("CompoundExpression",Ot,{omit:["_evaluate"]});for(const f in ja)ja[f]._classRegistryKey||Ft(`Expression_${f}`,ja[f]);function nu(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function ya(f,A){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob)return f;if(nu(f)||gt(f))return A&&A.push(f),f;if(ArrayBuffer.isView(f)){const p=f;return A&&A.push(p.buffer),p}if(f instanceof ImageData)return A&&A.push(f.data.buffer),f;if(Array.isArray(f)){const p=[];for(const T of f)p.push(ya(T,A));return p}if(typeof f=="object"){const p=f.constructor,T=p._classRegistryKey;if(!T)throw new Error("can't serialize object of unregistered class");if(!As[T])throw new Error(`${T} is not registered.`);const D=p.serialize?p.serialize(f,A):{};if(p.serialize){if(A&&D===A[A.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const z in f){if(!f.hasOwnProperty(z)||As[T].omit.indexOf(z)>=0)continue;const F=f[z];D[z]=As[T].shallow.indexOf(z)>=0?F:ya(F,A)}f instanceof Error&&(D.message=f.message)}if(D.$name)throw new Error("$name property is reserved for worker serialization logic.");return T!=="Object"&&(D.$name=T),D}throw new Error("can't serialize object of type "+typeof f)}function Qo(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob||nu(f)||gt(f)||ArrayBuffer.isView(f)||f instanceof ImageData)return f;if(Array.isArray(f))return f.map(Qo);if(typeof f=="object"){const A=f.$name||"Object";if(!As[A])throw new Error(`can't deserialize unregistered class ${A}`);const{klass:p}=As[A];if(!p)throw new Error(`can't deserialize unregistered class ${A}`);if(p.deserialize)return p.deserialize(f);const T=Object.create(p.prototype);for(const D of Object.keys(f)){if(D==="$name")continue;const z=f[D];T[D]=As[A].shallow.indexOf(D)>=0?z:Qo(z)}return T}throw new Error("can't deserialize object of type "+typeof f)}class iu{constructor(){this.first=!0}update(A,p){const T=Math.floor(A);return this.first?(this.first=!1,this.lastIntegerZoom=T,this.lastIntegerZoomTime=0,this.lastZoom=A,this.lastFloorZoom=T,!0):(this.lastFloorZoom>T?(this.lastIntegerZoom=T+1,this.lastIntegerZoomTime=p):this.lastFloorZoom<T&&(this.lastIntegerZoom=T,this.lastIntegerZoomTime=p),A!==this.lastZoom&&(this.lastZoom=A,this.lastFloorZoom=T,!0))}}const Ut={"Latin-1 Supplement":f=>f>=128&&f<=255,Arabic:f=>f>=1536&&f<=1791,"Arabic Supplement":f=>f>=1872&&f<=1919,"Arabic Extended-A":f=>f>=2208&&f<=2303,"Hangul Jamo":f=>f>=4352&&f<=4607,"Unified Canadian Aboriginal Syllabics":f=>f>=5120&&f<=5759,Khmer:f=>f>=6016&&f<=6143,"Unified Canadian Aboriginal Syllabics Extended":f=>f>=6320&&f<=6399,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"CJK Radicals Supplement":f=>f>=11904&&f<=12031,"Kangxi Radicals":f=>f>=12032&&f<=12255,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Bopomofo:f=>f>=12544&&f<=12591,"Hangul Compatibility Jamo":f=>f>=12592&&f<=12687,Kanbun:f=>f>=12688&&f<=12703,"Bopomofo Extended":f=>f>=12704&&f<=12735,"CJK Strokes":f=>f>=12736&&f<=12783,"Katakana Phonetic Extensions":f=>f>=12784&&f<=12799,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"CJK Unified Ideographs Extension A":f=>f>=13312&&f<=19903,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Yi Syllables":f=>f>=40960&&f<=42127,"Yi Radicals":f=>f>=42128&&f<=42191,"Hangul Jamo Extended-A":f=>f>=43360&&f<=43391,"Hangul Syllables":f=>f>=44032&&f<=55215,"Hangul Jamo Extended-B":f=>f>=55216&&f<=55295,"Private Use Area":f=>f>=57344&&f<=63743,"CJK Compatibility Ideographs":f=>f>=63744&&f<=64255,"Arabic Presentation Forms-A":f=>f>=64336&&f<=65023,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Arabic Presentation Forms-B":f=>f>=65136&&f<=65279,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519};function mA(f){for(const A of f)if(Xa(A.charCodeAt(0)))return!0;return!1}function Ll(f){for(const A of f)if(!yA(A.charCodeAt(0)))return!1;return!0}function yA(f){return!(Ut.Arabic(f)||Ut["Arabic Supplement"](f)||Ut["Arabic Extended-A"](f)||Ut["Arabic Presentation Forms-A"](f)||Ut["Arabic Presentation Forms-B"](f))}function Xa(f){return!(f!==746&&f!==747&&(f<4352||!(Ut["Bopomofo Extended"](f)||Ut.Bopomofo(f)||Ut["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Ut["CJK Compatibility Ideographs"](f)||Ut["CJK Compatibility"](f)||Ut["CJK Radicals Supplement"](f)||Ut["CJK Strokes"](f)||!(!Ut["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Ut["CJK Unified Ideographs Extension A"](f)||Ut["CJK Unified Ideographs"](f)||Ut["Enclosed CJK Letters and Months"](f)||Ut["Hangul Compatibility Jamo"](f)||Ut["Hangul Jamo Extended-A"](f)||Ut["Hangul Jamo Extended-B"](f)||Ut["Hangul Jamo"](f)||Ut["Hangul Syllables"](f)||Ut.Hiragana(f)||Ut["Ideographic Description Characters"](f)||Ut.Kanbun(f)||Ut["Kangxi Radicals"](f)||Ut["Katakana Phonetic Extensions"](f)||Ut.Katakana(f)&&f!==12540||!(!Ut["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Ut["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Ut["Unified Canadian Aboriginal Syllabics"](f)||Ut["Unified Canadian Aboriginal Syllabics Extended"](f)||Ut["Vertical Forms"](f)||Ut["Yijing Hexagram Symbols"](f)||Ut["Yi Syllables"](f)||Ut["Yi Radicals"](f))))}function Gs(f){return!(Xa(f)||function(A){return!!(Ut["Latin-1 Supplement"](A)&&(A===167||A===169||A===174||A===177||A===188||A===189||A===190||A===215||A===247)||Ut["General Punctuation"](A)&&(A===8214||A===8224||A===8225||A===8240||A===8241||A===8251||A===8252||A===8258||A===8263||A===8264||A===8265||A===8273)||Ut["Letterlike Symbols"](A)||Ut["Number Forms"](A)||Ut["Miscellaneous Technical"](A)&&(A>=8960&&A<=8967||A>=8972&&A<=8991||A>=8996&&A<=9e3||A===9003||A>=9085&&A<=9114||A>=9150&&A<=9165||A===9167||A>=9169&&A<=9179||A>=9186&&A<=9215)||Ut["Control Pictures"](A)&&A!==9251||Ut["Optical Character Recognition"](A)||Ut["Enclosed Alphanumerics"](A)||Ut["Geometric Shapes"](A)||Ut["Miscellaneous Symbols"](A)&&!(A>=9754&&A<=9759)||Ut["Miscellaneous Symbols and Arrows"](A)&&(A>=11026&&A<=11055||A>=11088&&A<=11097||A>=11192&&A<=11243)||Ut["CJK Symbols and Punctuation"](A)||Ut.Katakana(A)||Ut["Private Use Area"](A)||Ut["CJK Compatibility Forms"](A)||Ut["Small Form Variants"](A)||Ut["Halfwidth and Fullwidth Forms"](A)||A===8734||A===8756||A===8757||A>=9984&&A<=10087||A>=10102&&A<=10131||A===65532||A===65533)}(f))}function ru(f){return f>=1424&&f<=2303||Ut["Arabic Presentation Forms-A"](f)||Ut["Arabic Presentation Forms-B"](f)}function oh(f,A){return!(!A&&ru(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Ut.Khmer(f))}function oc(f){for(const A of f)if(ru(A.charCodeAt(0)))return!0;return!1}const su="deferred",ou="loading",au="loaded";let js=null,Dr="unavailable",xo=null;const lu=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(Dr="error"),js&&js(f)};function _a(){zi.fire(new Pr("pluginStateChange",{pluginStatus:Dr,pluginURL:xo}))}const zi=new is,Dl=function(){return Dr},ac=function(){if(Dr!==su||!xo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Dr=ou,_a(),xo&&ti({url:xo},f=>{f?lu(f):(Dr=au,_a())})},us={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Dr===au||us.applyArabicShaping!=null,isLoading:()=>Dr===ou,setState(f){if(!Qe())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Dr=f.pluginStatus,xo=f.pluginURL},isParsed(){if(!Qe())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return us.applyArabicShaping!=null&&us.processBidirectionalText!=null&&us.processStyledBidirectionalText!=null},getPluginURL(){if(!Qe())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return xo}};class Ei{constructor(A,p){this.zoom=A,p?(this.now=p.now,this.fadeDuration=p.fadeDuration,this.zoomHistory=p.zoomHistory,this.transition=p.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new iu,this.transition={})}isSupportedScript(A){return function(p,T){for(const D of p)if(!oh(D.charCodeAt(0),T))return!1;return!0}(A,us.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const A=this.zoom,p=A-Math.floor(A),T=this.crossFadingFactor();return A>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:p+(1-p)*T}:{fromScale:.5,toScale:1,t:1-(1-T)*p}}}class Ka{constructor(A,p){this.property=A,this.value=p,this.expression=function(T,D){if(vi(T))return new pi(T,D);if(Tl(T)){const z=Ml(T,D);if(z.result==="error")throw new Error(z.value.map(F=>`${F.key}: ${F.message}`).join(", "));return z.value}{let z=T;return D.type==="color"&&typeof T=="string"?z=o.parse(T):D.type!=="padding"||typeof T!="number"&&!Array.isArray(T)||(z=Pe.parse(T)),{kind:"constant",evaluate:()=>z}}}(p===void 0?A.specification.default:p,A.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(A,p,T){return this.property.possiblyEvaluate(this,A,p,T)}}class Rl{constructor(A){this.property=A,this.value=new Ka(A,void 0)}transitioned(A,p){return new lc(this.property,this.value,p,Q({},A.transition,this.transition),A.now)}untransitioned(){return new lc(this.property,this.value,null,{},0)}}class Au{constructor(A){this._properties=A,this._values=Object.create(A.defaultTransitionablePropertyValues)}getValue(A){return re(this._values[A].value.value)}setValue(A,p){Object.prototype.hasOwnProperty.call(this._values,A)||(this._values[A]=new Rl(this._values[A].property)),this._values[A].value=new Ka(this._values[A].property,p===null?void 0:re(p))}getTransition(A){return re(this._values[A].transition)}setTransition(A,p){Object.prototype.hasOwnProperty.call(this._values,A)||(this._values[A]=new Rl(this._values[A].property)),this._values[A].transition=re(p)||void 0}serialize(){const A={};for(const p of Object.keys(this._values)){const T=this.getValue(p);T!==void 0&&(A[p]=T);const D=this.getTransition(p);D!==void 0&&(A[`${p}-transition`]=D)}return A}transitioned(A,p){const T=new uu(this._properties);for(const D of Object.keys(this._values))T._values[D]=this._values[D].transitioned(A,p._values[D]);return T}untransitioned(){const A=new uu(this._properties);for(const p of Object.keys(this._values))A._values[p]=this._values[p].untransitioned();return A}}class lc{constructor(A,p,T,D,z){this.property=A,this.value=p,this.begin=z+D.delay||0,this.end=this.begin+D.duration||0,A.specification.transition&&(D.delay||D.duration)&&(this.prior=T)}possiblyEvaluate(A,p,T){const D=A.now||0,z=this.value.possiblyEvaluate(A,p,T),F=this.prior;if(F){if(D>this.end)return this.prior=null,z;if(this.value.isDataDriven())return this.prior=null,z;if(D<this.begin)return F.possiblyEvaluate(A,p,T);{const j=(D-this.begin)/(this.end-this.begin);return this.property.interpolate(F.possiblyEvaluate(A,p,T),z,function(q){if(q<=0)return 0;if(q>=1)return 1;const ie=q*q,Ae=ie*q;return 4*(q<.5?Ae:3*(q-ie)+Ae-.75)}(j))}}return z}}class uu{constructor(A){this._properties=A,this._values=Object.create(A.defaultTransitioningPropertyValues)}possiblyEvaluate(A,p,T){const D=new Bl(this._properties);for(const z of Object.keys(this._values))D._values[z]=this._values[z].possiblyEvaluate(A,p,T);return D}hasTransition(){for(const A of Object.keys(this._values))if(this._values[A].prior)return!0;return!1}}class Ac{constructor(A){this._properties=A,this._values=Object.create(A.defaultPropertyValues)}getValue(A){return re(this._values[A].value)}setValue(A,p){this._values[A]=new Ka(this._values[A].property,p===null?void 0:re(p))}serialize(){const A={};for(const p of Object.keys(this._values)){const T=this.getValue(p);T!==void 0&&(A[p]=T)}return A}possiblyEvaluate(A,p,T){const D=new Bl(this._properties);for(const z of Object.keys(this._values))D._values[z]=this._values[z].possiblyEvaluate(A,p,T);return D}}class gi{constructor(A,p,T){this.property=A,this.value=p,this.parameters=T}isConstant(){return this.value.kind==="constant"}constantOr(A){return this.value.kind==="constant"?this.value.value:A}evaluate(A,p,T,D){return this.property.evaluate(this.value,this.parameters,A,p,T,D)}}class Bl{constructor(A){this._properties=A,this._values=Object.create(A.defaultPossiblyEvaluatedValues)}get(A){return this._values[A]}}class Zt{constructor(A){this.specification=A}possiblyEvaluate(A,p){if(A.isDataDriven())throw new Error("Value should not be data driven");return A.expression.evaluate(p)}interpolate(A,p,T){const D=ki[this.specification.type];return D?D(A,p,T):A}}class Yt{constructor(A,p){this.specification=A,this.overrides=p}possiblyEvaluate(A,p,T,D){return new gi(this,A.expression.kind==="constant"||A.expression.kind==="camera"?{kind:"constant",value:A.expression.evaluate(p,null,{},T,D)}:A.expression,p)}interpolate(A,p,T){if(A.value.kind!=="constant"||p.value.kind!=="constant")return A;if(A.value.value===void 0||p.value.value===void 0)return new gi(this,{kind:"constant",value:void 0},A.parameters);const D=ki[this.specification.type];return D?new gi(this,{kind:"constant",value:D(A.value.value,p.value.value,T)},A.parameters):A}evaluate(A,p,T,D,z,F){return A.kind==="constant"?A.value:A.evaluate(p,T,D,z,F)}}class cn extends Yt{possiblyEvaluate(A,p,T,D){if(A.value===void 0)return new gi(this,{kind:"constant",value:void 0},p);if(A.expression.kind==="constant"){const z=A.expression.evaluate(p,null,{},T,D),F=A.property.specification.type==="resolvedImage"&&typeof z!="string"?z.name:z,j=this._calculate(F,F,F,p);return new gi(this,{kind:"constant",value:j},p)}if(A.expression.kind==="camera"){const z=this._calculate(A.expression.evaluate({zoom:p.zoom-1}),A.expression.evaluate({zoom:p.zoom}),A.expression.evaluate({zoom:p.zoom+1}),p);return new gi(this,{kind:"constant",value:z},p)}return new gi(this,A.expression,p)}evaluate(A,p,T,D,z,F){if(A.kind==="source"){const j=A.evaluate(p,T,D,z,F);return this._calculate(j,j,j,p)}return A.kind==="composite"?this._calculate(A.evaluate({zoom:Math.floor(p.zoom)-1},T,D),A.evaluate({zoom:Math.floor(p.zoom)},T,D),A.evaluate({zoom:Math.floor(p.zoom)+1},T,D),p):A.value}_calculate(A,p,T,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:A,to:p}:{from:T,to:p}}interpolate(A){return A}}class Zr{constructor(A){this.specification=A}possiblyEvaluate(A,p,T,D){if(A.value!==void 0){if(A.expression.kind==="constant"){const z=A.expression.evaluate(p,null,{},T,D);return this._calculate(z,z,z,p)}return this._calculate(A.expression.evaluate(new Ei(Math.floor(p.zoom-1),p)),A.expression.evaluate(new Ei(Math.floor(p.zoom),p)),A.expression.evaluate(new Ei(Math.floor(p.zoom+1),p)),p)}}_calculate(A,p,T,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:A,to:p}:{from:T,to:p}}interpolate(A){return A}}class qo{constructor(A){this.specification=A}possiblyEvaluate(A,p,T,D){return!!A.expression.evaluate(p,null,{},T,D)}interpolate(){return!1}}class Ui{constructor(A){this.properties=A,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const p in A){const T=A[p];T.specification.overridable&&this.overridableProperties.push(p);const D=this.defaultPropertyValues[p]=new Ka(T,void 0),z=this.defaultTransitionablePropertyValues[p]=new Rl(T);this.defaultTransitioningPropertyValues[p]=z.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=D.possiblyEvaluate({})}}}Ft("DataDrivenProperty",Yt),Ft("DataConstantProperty",Zt),Ft("CrossFadedDataDrivenProperty",cn),Ft("CrossFadedProperty",Zr),Ft("ColorRampProperty",qo);const $s="-transition";class Es extends is{constructor(A,p){if(super(),this.id=A.id,this.type=A.type,this._featureFilter={filter:()=>!0,needGeometry:!1},A.type!=="custom"&&(this.metadata=A.metadata,this.minzoom=A.minzoom,this.maxzoom=A.maxzoom,A.type!=="background"&&(this.source=A.source,this.sourceLayer=A["source-layer"],this.filter=A.filter),p.layout&&(this._unevaluatedLayout=new Ac(p.layout)),p.paint)){this._transitionablePaint=new Au(p.paint);for(const T in A.paint)this.setPaintProperty(T,A.paint[T],{validate:!1});for(const T in A.layout)this.setLayoutProperty(T,A.layout[T],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Bl(p.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(A){return A==="visibility"?this.visibility:this._unevaluatedLayout.getValue(A)}setLayoutProperty(A,p,T={}){p!=null&&this._validate(sh,`layers.${this.id}.layout.${A}`,A,p,T)||(A!=="visibility"?this._unevaluatedLayout.setValue(A,p):this.visibility=p)}getPaintProperty(A){return A.endsWith($s)?this._transitionablePaint.getTransition(A.slice(0,-$s.length)):this._transitionablePaint.getValue(A)}setPaintProperty(A,p,T={}){if(p!=null&&this._validate(rh,`layers.${this.id}.paint.${A}`,A,p,T))return!1;if(A.endsWith($s))return this._transitionablePaint.setTransition(A.slice(0,-$s.length),p||void 0),!1;{const D=this._transitionablePaint._values[A],z=D.property.specification["property-type"]==="cross-faded-data-driven",F=D.value.isDataDriven(),j=D.value;this._transitionablePaint.setValue(A,p),this._handleSpecialPaintPropertyUpdate(A);const q=this._transitionablePaint._values[A].value;return q.isDataDriven()||F||z||this._handleOverridablePaintPropertyUpdate(A,j,q)}}_handleSpecialPaintPropertyUpdate(A){}_handleOverridablePaintPropertyUpdate(A,p,T){return!1}isHidden(A){return!!(this.minzoom&&A<this.minzoom)||!!(this.maxzoom&&A>=this.maxzoom)||this.visibility==="none"}updateTransitions(A){this._transitioningPaint=this._transitionablePaint.transitioned(A,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(A,p){A.getCrossfadeParameters&&(this._crossfadeParameters=A.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(A,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(A,void 0,p)}serialize(){const A={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(A.layout=A.layout||{},A.layout.visibility=this.visibility),te(A,(p,T)=>!(p===void 0||T==="layout"&&!Object.keys(p).length||T==="paint"&&!Object.keys(p).length))}_validate(A,p,T,D,z={}){return(!z||z.validate!==!1)&&Ya(this,A.call(kl,{key:p,layerType:this.type,objectKey:T,value:D,styleSpec:ut,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const A in this.paint._values){const p=this.paint.get(A);if(p instanceof gi&&hi(p.property.specification)&&(p.value.kind==="source"||p.value.kind==="composite")&&p.value.isStateDependent)return!0}return!1}}const Hs={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class St{constructor(A,p){this._structArray=A,this._pos1=p*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ct{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(A,p){return A._trim(),p&&(A.isTransferred=!0,p.push(A.arrayBuffer)),{length:A.length,arrayBuffer:A.arrayBuffer}}static deserialize(A){const p=Object.create(this.prototype);return p.arrayBuffer=A.arrayBuffer,p.length=A.length,p.capacity=A.arrayBuffer.byteLength/p.bytesPerElement,p._refreshViews(),p}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(A){this.reserve(A),this.length=A}reserve(A){if(A>this.capacity){this.capacity=Math.max(A,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const p=this.uint8;this._refreshViews(),p&&this.uint8.set(p)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Vi(f,A=1){let p=0,T=0;return{members:f.map(D=>{const z=Hs[D.type].BYTES_PER_ELEMENT,F=p=Ja(p,Math.max(A,z)),j=D.components||1;return T=Math.max(T,z),p+=z*j,{name:D.name,type:D.type,components:j,offset:F}}),size:Ja(p,Math.max(T,A)),alignment:A}}function Ja(f,A){return Math.ceil(f/A)*A}class Ws extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(A,p){const T=this.length;return this.resize(T+1),this.emplace(T,A,p)}emplace(A,p,T){const D=2*A;return this.int16[D+0]=p,this.int16[D+1]=T,A}}Ws.prototype.bytesPerElement=4,Ft("StructArrayLayout2i4",Ws);class k extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(A,p,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,A,p,T,D)}emplace(A,p,T,D,z){const F=4*A;return this.int16[F+0]=p,this.int16[F+1]=T,this.int16[F+2]=D,this.int16[F+3]=z,A}}k.prototype.bytesPerElement=8,Ft("StructArrayLayout4i8",k);class c extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(A,p,T,D,z,F){const j=this.length;return this.resize(j+1),this.emplace(j,A,p,T,D,z,F)}emplace(A,p,T,D,z,F,j){const q=6*A;return this.int16[q+0]=p,this.int16[q+1]=T,this.int16[q+2]=D,this.int16[q+3]=z,this.int16[q+4]=F,this.int16[q+5]=j,A}}c.prototype.bytesPerElement=12,Ft("StructArrayLayout2i4i12",c);class _ extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(A,p,T,D,z,F){const j=this.length;return this.resize(j+1),this.emplace(j,A,p,T,D,z,F)}emplace(A,p,T,D,z,F,j){const q=4*A,ie=8*A;return this.int16[q+0]=p,this.int16[q+1]=T,this.uint8[ie+4]=D,this.uint8[ie+5]=z,this.uint8[ie+6]=F,this.uint8[ie+7]=j,A}}_.prototype.bytesPerElement=8,Ft("StructArrayLayout2i4ub8",_);class l extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(A,p){const T=this.length;return this.resize(T+1),this.emplace(T,A,p)}emplace(A,p,T){const D=2*A;return this.float32[D+0]=p,this.float32[D+1]=T,A}}l.prototype.bytesPerElement=8,Ft("StructArrayLayout2f8",l);class h extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(A,p,T,D,z,F,j,q,ie,Ae){const ce=this.length;return this.resize(ce+1),this.emplace(ce,A,p,T,D,z,F,j,q,ie,Ae)}emplace(A,p,T,D,z,F,j,q,ie,Ae,ce){const pe=10*A;return this.uint16[pe+0]=p,this.uint16[pe+1]=T,this.uint16[pe+2]=D,this.uint16[pe+3]=z,this.uint16[pe+4]=F,this.uint16[pe+5]=j,this.uint16[pe+6]=q,this.uint16[pe+7]=ie,this.uint16[pe+8]=Ae,this.uint16[pe+9]=ce,A}}h.prototype.bytesPerElement=20,Ft("StructArrayLayout10ui20",h);class d extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(A,p,T,D,z,F,j,q,ie,Ae,ce,pe){const me=this.length;return this.resize(me+1),this.emplace(me,A,p,T,D,z,F,j,q,ie,Ae,ce,pe)}emplace(A,p,T,D,z,F,j,q,ie,Ae,ce,pe,me){const ye=12*A;return this.int16[ye+0]=p,this.int16[ye+1]=T,this.int16[ye+2]=D,this.int16[ye+3]=z,this.uint16[ye+4]=F,this.uint16[ye+5]=j,this.uint16[ye+6]=q,this.uint16[ye+7]=ie,this.int16[ye+8]=Ae,this.int16[ye+9]=ce,this.int16[ye+10]=pe,this.int16[ye+11]=me,A}}d.prototype.bytesPerElement=24,Ft("StructArrayLayout4i4ui4i24",d);class x extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(A,p,T){const D=this.length;return this.resize(D+1),this.emplace(D,A,p,T)}emplace(A,p,T,D){const z=3*A;return this.float32[z+0]=p,this.float32[z+1]=T,this.float32[z+2]=D,A}}x.prototype.bytesPerElement=12,Ft("StructArrayLayout3f12",x);class b extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(A){const p=this.length;return this.resize(p+1),this.emplace(p,A)}emplace(A,p){return this.uint32[1*A+0]=p,A}}b.prototype.bytesPerElement=4,Ft("StructArrayLayout1ul4",b);class S extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(A,p,T,D,z,F,j,q,ie){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,A,p,T,D,z,F,j,q,ie)}emplace(A,p,T,D,z,F,j,q,ie,Ae){const ce=10*A,pe=5*A;return this.int16[ce+0]=p,this.int16[ce+1]=T,this.int16[ce+2]=D,this.int16[ce+3]=z,this.int16[ce+4]=F,this.int16[ce+5]=j,this.uint32[pe+3]=q,this.uint16[ce+8]=ie,this.uint16[ce+9]=Ae,A}}S.prototype.bytesPerElement=20,Ft("StructArrayLayout6i1ul2ui20",S);class M extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(A,p,T,D,z,F){const j=this.length;return this.resize(j+1),this.emplace(j,A,p,T,D,z,F)}emplace(A,p,T,D,z,F,j){const q=6*A;return this.int16[q+0]=p,this.int16[q+1]=T,this.int16[q+2]=D,this.int16[q+3]=z,this.int16[q+4]=F,this.int16[q+5]=j,A}}M.prototype.bytesPerElement=12,Ft("StructArrayLayout2i2i2i12",M);class B extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(A,p,T,D,z){const F=this.length;return this.resize(F+1),this.emplace(F,A,p,T,D,z)}emplace(A,p,T,D,z,F){const j=4*A,q=8*A;return this.float32[j+0]=p,this.float32[j+1]=T,this.float32[j+2]=D,this.int16[q+6]=z,this.int16[q+7]=F,A}}B.prototype.bytesPerElement=16,Ft("StructArrayLayout2f1f2i16",B);class V extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(A,p,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,A,p,T,D)}emplace(A,p,T,D,z){const F=12*A,j=3*A;return this.uint8[F+0]=p,this.uint8[F+1]=T,this.float32[j+1]=D,this.float32[j+2]=z,A}}V.prototype.bytesPerElement=12,Ft("StructArrayLayout2ub2f12",V);class $ extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(A,p,T){const D=this.length;return this.resize(D+1),this.emplace(D,A,p,T)}emplace(A,p,T,D){const z=3*A;return this.uint16[z+0]=p,this.uint16[z+1]=T,this.uint16[z+2]=D,A}}$.prototype.bytesPerElement=6,Ft("StructArrayLayout3ui6",$);class X extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(A,p,T,D,z,F,j,q,ie,Ae,ce,pe,me,ye,Ne,ze,Je){const lt=this.length;return this.resize(lt+1),this.emplace(lt,A,p,T,D,z,F,j,q,ie,Ae,ce,pe,me,ye,Ne,ze,Je)}emplace(A,p,T,D,z,F,j,q,ie,Ae,ce,pe,me,ye,Ne,ze,Je,lt){const Ke=24*A,st=12*A,pt=48*A;return this.int16[Ke+0]=p,this.int16[Ke+1]=T,this.uint16[Ke+2]=D,this.uint16[Ke+3]=z,this.uint32[st+2]=F,this.uint32[st+3]=j,this.uint32[st+4]=q,this.uint16[Ke+10]=ie,this.uint16[Ke+11]=Ae,this.uint16[Ke+12]=ce,this.float32[st+7]=pe,this.float32[st+8]=me,this.uint8[pt+36]=ye,this.uint8[pt+37]=Ne,this.uint8[pt+38]=ze,this.uint32[st+10]=Je,this.int16[Ke+22]=lt,A}}X.prototype.bytesPerElement=48,Ft("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",X);class se extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(A,p,T,D,z,F,j,q,ie,Ae,ce,pe,me,ye,Ne,ze,Je,lt,Ke,st,pt,dt,qt,en,$t,Nt,zt,Ht){const Gt=this.length;return this.resize(Gt+1),this.emplace(Gt,A,p,T,D,z,F,j,q,ie,Ae,ce,pe,me,ye,Ne,ze,Je,lt,Ke,st,pt,dt,qt,en,$t,Nt,zt,Ht)}emplace(A,p,T,D,z,F,j,q,ie,Ae,ce,pe,me,ye,Ne,ze,Je,lt,Ke,st,pt,dt,qt,en,$t,Nt,zt,Ht,Gt){const Tt=34*A,pn=17*A;return this.int16[Tt+0]=p,this.int16[Tt+1]=T,this.int16[Tt+2]=D,this.int16[Tt+3]=z,this.int16[Tt+4]=F,this.int16[Tt+5]=j,this.int16[Tt+6]=q,this.int16[Tt+7]=ie,this.uint16[Tt+8]=Ae,this.uint16[Tt+9]=ce,this.uint16[Tt+10]=pe,this.uint16[Tt+11]=me,this.uint16[Tt+12]=ye,this.uint16[Tt+13]=Ne,this.uint16[Tt+14]=ze,this.uint16[Tt+15]=Je,this.uint16[Tt+16]=lt,this.uint16[Tt+17]=Ke,this.uint16[Tt+18]=st,this.uint16[Tt+19]=pt,this.uint16[Tt+20]=dt,this.uint16[Tt+21]=qt,this.uint16[Tt+22]=en,this.uint32[pn+12]=$t,this.float32[pn+13]=Nt,this.float32[pn+14]=zt,this.float32[pn+15]=Ht,this.float32[pn+16]=Gt,A}}se.prototype.bytesPerElement=68,Ft("StructArrayLayout8i15ui1ul4f68",se);class ne extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(A){const p=this.length;return this.resize(p+1),this.emplace(p,A)}emplace(A,p){return this.float32[1*A+0]=p,A}}ne.prototype.bytesPerElement=4,Ft("StructArrayLayout1f4",ne);class ue extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(A,p,T){const D=this.length;return this.resize(D+1),this.emplace(D,A,p,T)}emplace(A,p,T,D){const z=3*A;return this.int16[z+0]=p,this.int16[z+1]=T,this.int16[z+2]=D,A}}ue.prototype.bytesPerElement=6,Ft("StructArrayLayout3i6",ue);class be extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(A,p,T){const D=this.length;return this.resize(D+1),this.emplace(D,A,p,T)}emplace(A,p,T,D){const z=4*A;return this.uint32[2*A+0]=p,this.uint16[z+2]=T,this.uint16[z+3]=D,A}}be.prototype.bytesPerElement=8,Ft("StructArrayLayout1ul2ui8",be);class Ce extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(A,p){const T=this.length;return this.resize(T+1),this.emplace(T,A,p)}emplace(A,p,T){const D=2*A;return this.uint16[D+0]=p,this.uint16[D+1]=T,A}}Ce.prototype.bytesPerElement=4,Ft("StructArrayLayout2ui4",Ce);class _e extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(A){const p=this.length;return this.resize(p+1),this.emplace(p,A)}emplace(A,p){return this.uint16[1*A+0]=p,A}}_e.prototype.bytesPerElement=2,Ft("StructArrayLayout1ui2",_e);class Ge extends Ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(A,p,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,A,p,T,D)}emplace(A,p,T,D,z){const F=4*A;return this.float32[F+0]=p,this.float32[F+1]=T,this.float32[F+2]=D,this.float32[F+3]=z,A}}Ge.prototype.bytesPerElement=16,Ft("StructArrayLayout4f16",Ge);class Te extends St{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Et(this.anchorPointX,this.anchorPointY)}}Te.prototype.size=20;class Ue extends S{get(A){return new Te(this,A)}}Ft("CollisionBoxArray",Ue);class xe extends St{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(A){this._structArray.uint8[this._pos1+37]=A}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(A){this._structArray.uint8[this._pos1+38]=A}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(A){this._structArray.uint32[this._pos4+10]=A}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}xe.prototype.size=48;class m extends X{get(A){return new xe(this,A)}}Ft("PlacedSymbolArray",m);class g extends St{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(A){this._structArray.uint32[this._pos4+12]=A}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}g.prototype.size=68;class v extends se{get(A){return new g(this,A)}}Ft("SymbolInstanceArray",v);class E extends ne{getoffsetX(A){return this.float32[1*A+0]}}Ft("GlyphOffsetArray",E);class C extends ue{getx(A){return this.int16[3*A+0]}gety(A){return this.int16[3*A+1]}gettileUnitDistanceFromAnchor(A){return this.int16[3*A+2]}}Ft("SymbolLineVertexArray",C);class R extends St{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}R.prototype.size=8;class O extends be{get(A){return new R(this,A)}}Ft("FeatureIndexArray",O);class N extends Ws{}class W extends Ws{}class J extends Ws{}class le extends c{}class fe extends _{}class Re extends l{}class je extends h{}class Be extends d{}class Ze extends x{}class ct extends b{}class At extends M{}class it extends V{}class rt extends ${}class Xe extends Ce{}const Vt=Vi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Bt}=Vt;class ft{constructor(A=[]){this.segments=A}prepareSegment(A,p,T,D){let z=this.segments[this.segments.length-1];return A>ft.MAX_VERTEX_ARRAY_LENGTH&&ve(`Max vertices per segment is ${ft.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${A}`),(!z||z.vertexLength+A>ft.MAX_VERTEX_ARRAY_LENGTH||z.sortKey!==D)&&(z={vertexOffset:p.length,primitiveOffset:T.length,vertexLength:0,primitiveLength:0},D!==void 0&&(z.sortKey=D),this.segments.push(z)),z}get(){return this.segments}destroy(){for(const A of this.segments)for(const p in A.vaos)A.vaos[p].destroy()}static simpleSegment(A,p,T,D){return new ft([{vertexOffset:A,primitiveOffset:p,vertexLength:T,primitiveLength:D,vaos:{},sortKey:0}])}}function yt(f,A){return 256*(f=L(Math.floor(f),0,255))+L(Math.floor(A),0,255)}ft.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ft("SegmentVector",ft);const Cn=Vi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var xn={exports:{}},gn={exports:{}};gn.exports=function(f,A){var p,T,D,z,F,j,q,ie;for(T=f.length-(p=3&f.length),D=A,F=3432918353,j=461845907,ie=0;ie<T;)q=255&f.charCodeAt(ie)|(255&f.charCodeAt(++ie))<<8|(255&f.charCodeAt(++ie))<<16|(255&f.charCodeAt(++ie))<<24,++ie,D=27492+(65535&(z=5*(65535&(D=(D^=q=(65535&(q=(q=(65535&q)*F+(((q>>>16)*F&65535)<<16)&4294967295)<<15|q>>>17))*j+(((q>>>16)*j&65535)<<16)&4294967295)<<13|D>>>19))+((5*(D>>>16)&65535)<<16)&4294967295))+((58964+(z>>>16)&65535)<<16);switch(q=0,p){case 3:q^=(255&f.charCodeAt(ie+2))<<16;case 2:q^=(255&f.charCodeAt(ie+1))<<8;case 1:D^=q=(65535&(q=(q=(65535&(q^=255&f.charCodeAt(ie)))*F+(((q>>>16)*F&65535)<<16)&4294967295)<<15|q>>>17))*j+(((q>>>16)*j&65535)<<16)&4294967295}return D^=f.length,D=2246822507*(65535&(D^=D>>>16))+((2246822507*(D>>>16)&65535)<<16)&4294967295,D=3266489909*(65535&(D^=D>>>13))+((3266489909*(D>>>16)&65535)<<16)&4294967295,(D^=D>>>16)>>>0};var yn={exports:{}};yn.exports=function(f,A){for(var p,T=f.length,D=A^T,z=0;T>=4;)p=1540483477*(65535&(p=255&f.charCodeAt(z)|(255&f.charCodeAt(++z))<<8|(255&f.charCodeAt(++z))<<16|(255&f.charCodeAt(++z))<<24))+((1540483477*(p>>>16)&65535)<<16),D=1540483477*(65535&D)+((1540483477*(D>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),T-=4,++z;switch(T){case 3:D^=(255&f.charCodeAt(z+2))<<16;case 2:D^=(255&f.charCodeAt(z+1))<<8;case 1:D=1540483477*(65535&(D^=255&f.charCodeAt(z)))+((1540483477*(D>>>16)&65535)<<16)}return D=1540483477*(65535&(D^=D>>>13))+((1540483477*(D>>>16)&65535)<<16),(D^=D>>>15)>>>0};var bn=gn.exports,Ln=yn.exports;xn.exports=bn,xn.exports.murmur3=bn,xn.exports.murmur2=Ln;class ai{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(A,p,T,D){this.ids.push(Pn(A)),this.positions.push(p,T,D)}getPositions(A){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const p=Pn(A);let T=0,D=this.ids.length-1;for(;T<D;){const F=T+D>>1;this.ids[F]>=p?D=F:T=F+1}const z=[];for(;this.ids[T]===p;)z.push({index:this.positions[3*T],start:this.positions[3*T+1],end:this.positions[3*T+2]}),T++;return z}static serialize(A,p){const T=new Float64Array(A.ids),D=new Uint32Array(A.positions);return xi(T,D,0,T.length-1),p&&p.push(T.buffer,D.buffer),{ids:T,positions:D}}static deserialize(A){const p=new ai;return p.ids=A.ids,p.positions=A.positions,p.indexed=!0,p}}function Pn(f){const A=+f;return!isNaN(A)&&A<=Number.MAX_SAFE_INTEGER?A:xn.exports(String(f))}function xi(f,A,p,T){for(;p<T;){const D=f[p+T>>1];let z=p-1,F=T+1;for(;;){do z++;while(f[z]<D);do F--;while(f[F]>D);if(z>=F)break;Qi(f,z,F),Qi(A,3*z,3*F),Qi(A,3*z+1,3*F+1),Qi(A,3*z+2,3*F+2)}F-p<T-F?(xi(f,A,p,F),p=F+1):(xi(f,A,F+1,T),T=F)}}function Qi(f,A,p){const T=f[A];f[A]=f[p],f[p]=T}Ft("FeaturePositionMap",ai);class el{constructor(A,p){this.gl=A.gl,this.location=p}}class cu extends el{constructor(A,p){super(A,p),this.current=0}set(A){this.current!==A&&(this.current=A,this.gl.uniform1f(this.location,A))}}class p0 extends el{constructor(A,p){super(A,p),this.current=[0,0,0,0]}set(A){A[0]===this.current[0]&&A[1]===this.current[1]&&A[2]===this.current[2]&&A[3]===this.current[3]||(this.current=A,this.gl.uniform4f(this.location,A[0],A[1],A[2],A[3]))}}class OS extends el{constructor(A,p){super(A,p),this.current=o.transparent}set(A){A.r===this.current.r&&A.g===this.current.g&&A.b===this.current.b&&A.a===this.current.a||(this.current=A,this.gl.uniform4f(this.location,A.r,A.g,A.b,A.a))}}const C7=new Float32Array(16);function J2(f){return[yt(255*f.r,255*f.g),yt(255*f.b,255*f.a)]}class _d{constructor(A,p,T){this.value=A,this.uniformNames=p.map(D=>`u_${D}`),this.type=T}setUniform(A,p,T){A.set(T.constantOr(this.value))}getBinding(A,p,T){return this.type==="color"?new OS(A,p):new cu(A,p)}}class g0{constructor(A,p){this.uniformNames=p.map(T=>`u_${T}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(A,p){this.pixelRatioFrom=p.pixelRatio,this.pixelRatioTo=A.pixelRatio,this.patternFrom=p.tlbr,this.patternTo=A.tlbr}setUniform(A,p,T,D){const z=D==="u_pattern_to"?this.patternTo:D==="u_pattern_from"?this.patternFrom:D==="u_pixel_ratio_to"?this.pixelRatioTo:D==="u_pixel_ratio_from"?this.pixelRatioFrom:null;z&&A.set(z)}getBinding(A,p,T){return T.substr(0,9)==="u_pattern"?new p0(A,p):new cu(A,p)}}class hu{constructor(A,p,T,D){this.expression=A,this.type=T,this.maxValue=0,this.paintVertexAttributes=p.map(z=>({name:`a_${z}`,type:"Float32",components:T==="color"?2:1,offset:0})),this.paintVertexArray=new D}populatePaintArray(A,p,T,D,z){const F=this.paintVertexArray.length,j=this.expression.evaluate(new Ei(0),p,{},D,[],z);this.paintVertexArray.resize(A),this._setPaintValue(F,A,j)}updatePaintArray(A,p,T,D){const z=this.expression.evaluate({zoom:0},T,D);this._setPaintValue(A,p,z)}_setPaintValue(A,p,T){if(this.type==="color"){const D=J2(T);for(let z=A;z<p;z++)this.paintVertexArray.emplace(z,D[0],D[1])}else{for(let D=A;D<p;D++)this.paintVertexArray.emplace(D,T);this.maxValue=Math.max(this.maxValue,Math.abs(T))}}upload(A){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=A.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class zl{constructor(A,p,T,D,z,F){this.expression=A,this.uniformNames=p.map(j=>`u_${j}_t`),this.type=T,this.useIntegerZoom=D,this.zoom=z,this.maxValue=0,this.paintVertexAttributes=p.map(j=>({name:`a_${j}`,type:"Float32",components:T==="color"?4:2,offset:0})),this.paintVertexArray=new F}populatePaintArray(A,p,T,D,z){const F=this.expression.evaluate(new Ei(this.zoom),p,{},D,[],z),j=this.expression.evaluate(new Ei(this.zoom+1),p,{},D,[],z),q=this.paintVertexArray.length;this.paintVertexArray.resize(A),this._setPaintValue(q,A,F,j)}updatePaintArray(A,p,T,D){const z=this.expression.evaluate({zoom:this.zoom},T,D),F=this.expression.evaluate({zoom:this.zoom+1},T,D);this._setPaintValue(A,p,z,F)}_setPaintValue(A,p,T,D){if(this.type==="color"){const z=J2(T),F=J2(D);for(let j=A;j<p;j++)this.paintVertexArray.emplace(j,z[0],z[1],F[0],F[1])}else{for(let z=A;z<p;z++)this.paintVertexArray.emplace(z,T,D);this.maxValue=Math.max(this.maxValue,Math.abs(T),Math.abs(D))}}upload(A){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=A.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(A,p){const T=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,D=L(this.expression.interpolationFactor(T,this.zoom,this.zoom+1),0,1);A.set(D)}getBinding(A,p,T){return new cu(A,p)}}class uc{constructor(A,p,T,D,z,F){this.expression=A,this.type=p,this.useIntegerZoom=T,this.zoom=D,this.layerId=F,this.zoomInPaintVertexArray=new z,this.zoomOutPaintVertexArray=new z}populatePaintArray(A,p,T){const D=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(A),this.zoomOutPaintVertexArray.resize(A),this._setPaintValues(D,A,p.patterns&&p.patterns[this.layerId],T)}updatePaintArray(A,p,T,D,z){this._setPaintValues(A,p,T.patterns&&T.patterns[this.layerId],z)}_setPaintValues(A,p,T,D){if(!D||!T)return;const{min:z,mid:F,max:j}=T,q=D[z],ie=D[F],Ae=D[j];if(q&&ie&&Ae)for(let ce=A;ce<p;ce++)this.zoomInPaintVertexArray.emplace(ce,ie.tl[0],ie.tl[1],ie.br[0],ie.br[1],q.tl[0],q.tl[1],q.br[0],q.br[1],ie.pixelRatio,q.pixelRatio),this.zoomOutPaintVertexArray.emplace(ce,ie.tl[0],ie.tl[1],ie.br[0],ie.br[1],Ae.tl[0],Ae.tl[1],Ae.br[0],Ae.br[1],ie.pixelRatio,Ae.pixelRatio)}upload(A){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=A.createVertexBuffer(this.zoomInPaintVertexArray,Cn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=A.createVertexBuffer(this.zoomOutPaintVertexArray,Cn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class FS{constructor(A,p,T){this.binders={},this._buffers=[];const D=[];for(const z in A.paint._values){if(!T(z))continue;const F=A.paint.get(z);if(!(F instanceof gi&&hi(F.property.specification)))continue;const j=P7(z,A.type),q=F.value,ie=F.property.specification.type,Ae=F.property.useIntegerZoom,ce=F.property.specification["property-type"],pe=ce==="cross-faded"||ce==="cross-faded-data-driven";if(q.kind==="constant")this.binders[z]=pe?new g0(q.value,j):new _d(q.value,j,ie),D.push(`/u_${z}`);else if(q.kind==="source"||pe){const me=NS(z,ie,"source");this.binders[z]=pe?new uc(q,ie,Ae,p,me,A.id):new hu(q,j,ie,me),D.push(`/a_${z}`)}else{const me=NS(z,ie,"composite");this.binders[z]=new zl(q,j,ie,Ae,p,me),D.push(`/z_${z}`)}}this.cacheKey=D.sort().join("")}getMaxValue(A){const p=this.binders[A];return p instanceof hu||p instanceof zl?p.maxValue:0}populatePaintArrays(A,p,T,D,z){for(const F in this.binders){const j=this.binders[F];(j instanceof hu||j instanceof zl||j instanceof uc)&&j.populatePaintArray(A,p,T,D,z)}}setConstantPatternPositions(A,p){for(const T in this.binders){const D=this.binders[T];D instanceof g0&&D.setConstantPatternPositions(A,p)}}updatePaintArrays(A,p,T,D,z){let F=!1;for(const j in A){const q=p.getPositions(j);for(const ie of q){const Ae=T.feature(ie.index);for(const ce in this.binders){const pe=this.binders[ce];if((pe instanceof hu||pe instanceof zl||pe instanceof uc)&&pe.expression.isStateDependent===!0){const me=D.paint.get(ce);pe.expression=me.value,pe.updatePaintArray(ie.start,ie.end,Ae,A[j],z),F=!0}}}}return F}defines(){const A=[];for(const p in this.binders){const T=this.binders[p];(T instanceof _d||T instanceof g0)&&A.push(...T.uniformNames.map(D=>`#define HAS_UNIFORM_${D}`))}return A}getBinderAttributes(){const A=[];for(const p in this.binders){const T=this.binders[p];if(T instanceof hu||T instanceof zl)for(let D=0;D<T.paintVertexAttributes.length;D++)A.push(T.paintVertexAttributes[D].name);else if(T instanceof uc)for(let D=0;D<Cn.members.length;D++)A.push(Cn.members[D].name)}return A}getBinderUniforms(){const A=[];for(const p in this.binders){const T=this.binders[p];if(T instanceof _d||T instanceof g0||T instanceof zl)for(const D of T.uniformNames)A.push(D)}return A}getPaintVertexBuffers(){return this._buffers}getUniforms(A,p){const T=[];for(const D in this.binders){const z=this.binders[D];if(z instanceof _d||z instanceof g0||z instanceof zl){for(const F of z.uniformNames)if(p[F]){const j=z.getBinding(A,p[F],F);T.push({name:F,property:D,binding:j})}}}return T}setUniforms(A,p,T,D){for(const{name:z,property:F,binding:j}of p)this.binders[F].setUniform(j,D,T.get(F),z)}updatePaintBuffers(A){this._buffers=[];for(const p in this.binders){const T=this.binders[p];if(A&&T instanceof uc){const D=A.fromScale===2?T.zoomInPaintVertexBuffer:T.zoomOutPaintVertexBuffer;D&&this._buffers.push(D)}else(T instanceof hu||T instanceof zl)&&T.paintVertexBuffer&&this._buffers.push(T.paintVertexBuffer)}}upload(A){for(const p in this.binders){const T=this.binders[p];(T instanceof hu||T instanceof zl||T instanceof uc)&&T.upload(A)}this.updatePaintBuffers()}destroy(){for(const A in this.binders){const p=this.binders[A];(p instanceof hu||p instanceof zl||p instanceof uc)&&p.destroy()}}}class ah{constructor(A,p,T=()=>!0){this.programConfigurations={};for(const D of A)this.programConfigurations[D.id]=new FS(D,p,T);this.needsUpload=!1,this._featureMap=new ai,this._bufferOffset=0}populatePaintArrays(A,p,T,D,z,F){for(const j in this.programConfigurations)this.programConfigurations[j].populatePaintArrays(A,p,D,z,F);p.id!==void 0&&this._featureMap.add(p.id,T,this._bufferOffset,A),this._bufferOffset=A,this.needsUpload=!0}updatePaintArrays(A,p,T,D){for(const z of T)this.needsUpload=this.programConfigurations[z.id].updatePaintArrays(A,this._featureMap,p,z,D)||this.needsUpload}get(A){return this.programConfigurations[A]}upload(A){if(this.needsUpload){for(const p in this.programConfigurations)this.programConfigurations[p].upload(A);this.needsUpload=!1}}destroy(){for(const A in this.programConfigurations)this.programConfigurations[A].destroy()}}function P7(f,A){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(`${A}-`,"").replace(/-/g,"_")]}function NS(f,A,p){const T={color:{source:l,composite:Ge},number:{source:ne,composite:l}},D=function(z){return{"line-pattern":{source:je,composite:je},"fill-pattern":{source:je,composite:je},"fill-extrusion-pattern":{source:je,composite:je}}[z]}(f);return D&&D[p]||T[A][p]}Ft("ConstantBinder",_d),Ft("CrossFadedConstantBinder",g0),Ft("SourceExpressionBinder",hu),Ft("CrossFadedCompositeBinder",uc),Ft("CompositeExpressionBinder",zl),Ft("ProgramConfiguration",FS,{omit:["_buffers"]}),Ft("ProgramConfigurationSet",ah);var Rr=8192;const ev=Math.pow(2,14)-1,US=-ev-1;function lh(f){const A=Rr/f.extent,p=f.loadGeometry();for(let T=0;T<p.length;T++){const D=p[T];for(let z=0;z<D.length;z++){const F=D[z],j=Math.round(F.x*A),q=Math.round(F.y*A);F.x=L(j,US,ev),F.y=L(q,US,ev),(j<F.x||j>F.x+1||q<F.y||q>F.y+1)&&ve("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return p}function Ah(f,A){return{type:f.type,id:f.id,properties:f.properties,geometry:A?lh(f):[]}}function lm(f,A,p,T,D){f.emplaceBack(2*A+(T+1)/2,2*p+(D+1)/2)}class tv{constructor(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(p=>p.id),this.index=A.index,this.hasPattern=!1,this.layoutVertexArray=new W,this.indexArray=new rt,this.segments=new ft,this.programConfigurations=new ah(A.layers,A.zoom),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(A,p,T){const D=this.layers[0],z=[];let F=null,j=!1;D.type==="circle"&&(F=D.layout.get("circle-sort-key"),j=!F.isConstant());for(const{feature:q,id:ie,index:Ae,sourceLayerIndex:ce}of A){const pe=this.layers[0]._featureFilter.needGeometry,me=Ah(q,pe);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),me,T))continue;const ye=j?F.evaluate(me,{},T):void 0,Ne={id:ie,properties:q.properties,type:q.type,sourceLayerIndex:ce,index:Ae,geometry:pe?me.geometry:lh(q),patterns:{},sortKey:ye};z.push(Ne)}j&&z.sort((q,ie)=>q.sortKey-ie.sortKey);for(const q of z){const{geometry:ie,index:Ae,sourceLayerIndex:ce}=q,pe=A[Ae].feature;this.addFeature(q,ie,Ae,T),p.featureIndex.insert(pe,ie,Ae,ce,this.index)}}update(A,p,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,p,this.stateDependentLayers,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,Bt),this.indexBuffer=A.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(A),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(A,p,T,D){for(const z of p)for(const F of z){const j=F.x,q=F.y;if(j<0||j>=Rr||q<0||q>=Rr)continue;const ie=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,A.sortKey),Ae=ie.vertexLength;lm(this.layoutVertexArray,j,q,-1,-1),lm(this.layoutVertexArray,j,q,1,-1),lm(this.layoutVertexArray,j,q,1,1),lm(this.layoutVertexArray,j,q,-1,1),this.indexArray.emplaceBack(Ae,Ae+1,Ae+2),this.indexArray.emplaceBack(Ae,Ae+3,Ae+2),ie.vertexLength+=4,ie.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,T,{},D)}}function VS(f,A){for(let p=0;p<f.length;p++)if(m0(A,f[p]))return!0;for(let p=0;p<A.length;p++)if(m0(f,A[p]))return!0;return!!nv(f,A)}function I7(f,A,p){return!!m0(f,A)||!!iv(A,f,p)}function GS(f,A){if(f.length===1)return $S(A,f[0]);for(let p=0;p<A.length;p++){const T=A[p];for(let D=0;D<T.length;D++)if(m0(f,T[D]))return!0}for(let p=0;p<f.length;p++)if($S(A,f[p]))return!0;for(let p=0;p<A.length;p++)if(nv(f,A[p]))return!0;return!1}function k7(f,A,p){if(f.length>1){if(nv(f,A))return!0;for(let T=0;T<A.length;T++)if(iv(A[T],f,p))return!0}for(let T=0;T<f.length;T++)if(iv(f[T],A,p))return!0;return!1}function nv(f,A){if(f.length===0||A.length===0)return!1;for(let p=0;p<f.length-1;p++){const T=f[p],D=f[p+1];for(let z=0;z<A.length-1;z++)if(L7(T,D,A[z],A[z+1]))return!0}return!1}function L7(f,A,p,T){return Me(f,p,T)!==Me(A,p,T)&&Me(f,A,p)!==Me(f,A,T)}function iv(f,A,p){const T=p*p;if(A.length===1)return f.distSqr(A[0])<T;for(let D=1;D<A.length;D++)if(jS(f,A[D-1],A[D])<T)return!0;return!1}function jS(f,A,p){const T=A.distSqr(p);if(T===0)return f.distSqr(A);const D=((f.x-A.x)*(p.x-A.x)+(f.y-A.y)*(p.y-A.y))/T;return f.distSqr(D<0?A:D>1?p:p.sub(A)._mult(D)._add(A))}function $S(f,A){let p,T,D,z=!1;for(let F=0;F<f.length;F++){p=f[F];for(let j=0,q=p.length-1;j<p.length;q=j++)T=p[j],D=p[q],T.y>A.y!=D.y>A.y&&A.x<(D.x-T.x)*(A.y-T.y)/(D.y-T.y)+T.x&&(z=!z)}return z}function m0(f,A){let p=!1;for(let T=0,D=f.length-1;T<f.length;D=T++){const z=f[T],F=f[D];z.y>A.y!=F.y>A.y&&A.x<(F.x-z.x)*(A.y-z.y)/(F.y-z.y)+z.x&&(p=!p)}return p}function D7(f,A,p){const T=p[0],D=p[2];if(f.x<T.x&&A.x<T.x||f.x>D.x&&A.x>D.x||f.y<T.y&&A.y<T.y||f.y>D.y&&A.y>D.y)return!1;const z=Me(f,A,p[0]);return z!==Me(f,A,p[1])||z!==Me(f,A,p[2])||z!==Me(f,A,p[3])}function vd(f,A,p){const T=A.paint.get(f).value;return T.kind==="constant"?T.value:p.programConfigurations.get(A.id).getMaxValue(f)}function Am(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function um(f,A,p,T,D){if(!A[0]&&!A[1])return f;const z=Et.convert(A)._mult(D);p==="viewport"&&z._rotate(-T);const F=[];for(let j=0;j<f.length;j++)F.push(f[j].sub(z));return F}Ft("CircleBucket",tv,{omit:["layers"]});const R7=new Ui({"circle-sort-key":new Yt(ut.layout_circle["circle-sort-key"])});var B7={paint:new Ui({"circle-radius":new Yt(ut.paint_circle["circle-radius"]),"circle-color":new Yt(ut.paint_circle["circle-color"]),"circle-blur":new Yt(ut.paint_circle["circle-blur"]),"circle-opacity":new Yt(ut.paint_circle["circle-opacity"]),"circle-translate":new Zt(ut.paint_circle["circle-translate"]),"circle-translate-anchor":new Zt(ut.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Zt(ut.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Zt(ut.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Yt(ut.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Yt(ut.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Yt(ut.paint_circle["circle-stroke-opacity"])}),layout:R7},Qs=1e-6,qs=typeof Float32Array<"u"?Float32Array:Array;function HS(){var f=new qs(9);return qs!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[5]=0,f[6]=0,f[7]=0),f[0]=1,f[4]=1,f[8]=1,f}function rv(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function WS(f,A,p){var T=A[0],D=A[1],z=A[2],F=A[3],j=A[4],q=A[5],ie=A[6],Ae=A[7],ce=A[8],pe=A[9],me=A[10],ye=A[11],Ne=A[12],ze=A[13],Je=A[14],lt=A[15],Ke=p[0],st=p[1],pt=p[2],dt=p[3];return f[0]=Ke*T+st*j+pt*ce+dt*Ne,f[1]=Ke*D+st*q+pt*pe+dt*ze,f[2]=Ke*z+st*ie+pt*me+dt*Je,f[3]=Ke*F+st*Ae+pt*ye+dt*lt,f[4]=(Ke=p[4])*T+(st=p[5])*j+(pt=p[6])*ce+(dt=p[7])*Ne,f[5]=Ke*D+st*q+pt*pe+dt*ze,f[6]=Ke*z+st*ie+pt*me+dt*Je,f[7]=Ke*F+st*Ae+pt*ye+dt*lt,f[8]=(Ke=p[8])*T+(st=p[9])*j+(pt=p[10])*ce+(dt=p[11])*Ne,f[9]=Ke*D+st*q+pt*pe+dt*ze,f[10]=Ke*z+st*ie+pt*me+dt*Je,f[11]=Ke*F+st*Ae+pt*ye+dt*lt,f[12]=(Ke=p[12])*T+(st=p[13])*j+(pt=p[14])*ce+(dt=p[15])*Ne,f[13]=Ke*D+st*q+pt*pe+dt*ze,f[14]=Ke*z+st*ie+pt*me+dt*Je,f[15]=Ke*F+st*Ae+pt*ye+dt*lt,f}Math.hypot||(Math.hypot=function(){for(var f=0,A=arguments.length;A--;)f+=arguments[A]*arguments[A];return Math.sqrt(f)});var xd,z7=WS;function QS(){var f=new qs(3);return qs!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f}function qS(f,A,p){var T=new qs(3);return T[0]=f,T[1]=A,T[2]=p,T}function cm(f,A,p){var T=A[0],D=A[1],z=A[2],F=A[3];return f[0]=p[0]*T+p[4]*D+p[8]*z+p[12]*F,f[1]=p[1]*T+p[5]*D+p[9]*z+p[13]*F,f[2]=p[2]*T+p[6]*D+p[10]*z+p[14]*F,f[3]=p[3]*T+p[7]*D+p[11]*z+p[15]*F,f}function ZS(){var f=new qs(4);return qs!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f[3]=1,f}function YS(f,A){const p=cm([],[f.x,f.y,0,1],A);return new Et(p[0]/p[3],p[1]/p[3])}QS(),xd=new qs(4),qs!=Float32Array&&(xd[0]=0,xd[1]=0,xd[2]=0,xd[3]=0),QS(),qS(1,0,0),qS(0,1,0),ZS(),ZS(),HS(),function(){var f;f=new qs(2),qs!=Float32Array&&(f[0]=0,f[1]=0)}();class XS extends tv{}Ft("HeatmapBucket",XS,{omit:["layers"]});var O7={paint:new Ui({"heatmap-radius":new Yt(ut.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Yt(ut.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Zt(ut.paint_heatmap["heatmap-intensity"]),"heatmap-color":new qo(ut.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Zt(ut.paint_heatmap["heatmap-opacity"])})};function sv(f,{width:A,height:p},T,D){if(D){if(D instanceof Uint8ClampedArray)D=new Uint8Array(D.buffer);else if(D.length!==A*p*T)throw new RangeError(`mismatched image size. expected: ${D.length} but got: ${A*p*T}`)}else D=new Uint8Array(A*p*T);return f.width=A,f.height=p,f.data=D,f}function KS(f,{width:A,height:p},T){if(A===f.width&&p===f.height)return;const D=sv({},{width:A,height:p},T);ov(f,D,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,A),height:Math.min(f.height,p)},T),f.width=A,f.height=p,f.data=D.data}function ov(f,A,p,T,D,z){if(D.width===0||D.height===0)return A;if(D.width>f.width||D.height>f.height||p.x>f.width-D.width||p.y>f.height-D.height)throw new RangeError("out of range source coordinates for image copy");if(D.width>A.width||D.height>A.height||T.x>A.width-D.width||T.y>A.height-D.height)throw new RangeError("out of range destination coordinates for image copy");const F=f.data,j=A.data;if(F===j)throw new Error("srcData equals dstData, so image is already copied");for(let q=0;q<D.height;q++){const ie=((p.y+q)*f.width+p.x)*z,Ae=((T.y+q)*A.width+T.x)*z;for(let ce=0;ce<D.width*z;ce++)j[Ae+ce]=F[ie+ce]}return A}class wd{constructor(A,p){sv(this,A,1,p)}resize(A){KS(this,A,1)}clone(){return new wd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(A,p,T,D,z){ov(A,p,T,D,z,1)}}class va{constructor(A,p){sv(this,A,4,p)}resize(A){KS(this,A,4)}replace(A,p){p?this.data.set(A):this.data=A instanceof Uint8ClampedArray?new Uint8Array(A.buffer):A}clone(){return new va({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(A,p,T,D,z){ov(A,p,T,D,z,4)}}function JS(f){const A={},p=f.resolution||256,T=f.clips?f.clips.length:1,D=f.image||new va({width:p,height:T});if(Math.log(p)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${p}`);const z=(F,j,q)=>{A[f.evaluationKey]=q;const ie=f.expression.evaluate(A);D.data[F+j+0]=Math.floor(255*ie.r/ie.a),D.data[F+j+1]=Math.floor(255*ie.g/ie.a),D.data[F+j+2]=Math.floor(255*ie.b/ie.a),D.data[F+j+3]=Math.floor(255*ie.a)};if(f.clips)for(let F=0,j=0;F<T;++F,j+=4*p)for(let q=0,ie=0;q<p;q++,ie+=4){const Ae=q/(p-1),{start:ce,end:pe}=f.clips[F];z(j,ie,ce*(1-Ae)+pe*Ae)}else for(let F=0,j=0;F<p;F++,j+=4)z(0,j,F/(p-1));return D}Ft("AlphaImage",wd),Ft("RGBAImage",va);var F7={paint:new Ui({"hillshade-illumination-direction":new Zt(ut.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Zt(ut.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Zt(ut.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Zt(ut.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Zt(ut.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Zt(ut.paint_hillshade["hillshade-accent-color"])})};const N7=Vi([{name:"a_pos",components:2,type:"Int16"}],4),{members:U7}=N7;var hm={exports:{}};function fm(f,A,p){p=p||2;var T,D,z,F,j,q,ie,Ae=A&&A.length,ce=Ae?A[0]*p:f.length,pe=e4(f,0,ce,p,!0),me=[];if(!pe||pe.next===pe.prev)return me;if(Ae&&(pe=function(Ne,ze,Je,lt){var Ke,st,pt,dt=[];for(Ke=0,st=ze.length;Ke<st;Ke++)(pt=e4(Ne,ze[Ke]*lt,Ke<st-1?ze[Ke+1]*lt:Ne.length,lt,!1))===pt.next&&(pt.steiner=!0),dt.push(q7(pt));for(dt.sort(H7),Ke=0;Ke<dt.length;Ke++)Je=W7(dt[Ke],Je);return Je}(f,A,pe,p)),f.length>80*p){T=z=f[0],D=F=f[1];for(var ye=p;ye<ce;ye+=p)(j=f[ye])<T&&(T=j),(q=f[ye+1])<D&&(D=q),j>z&&(z=j),q>F&&(F=q);ie=(ie=Math.max(z-T,F-D))!==0?32767/ie:0}return bd(pe,me,p,T,D,ie,0),me}function e4(f,A,p,T,D){var z,F;if(D===Av(f,A,p,T)>0)for(z=A;z<p;z+=T)F=i4(z,f[z],f[z+1],F);else for(z=p-T;z>=A;z-=T)F=i4(z,f[z],f[z+1],F);return F&&dm(F,F.next)&&(Td(F),F=F.next),F}function uh(f,A){if(!f)return f;A||(A=f);var p,T=f;do if(p=!1,T.steiner||!dm(T,T.next)&&dr(T.prev,T,T.next)!==0)T=T.next;else{if(Td(T),(T=A=T.prev)===T.next)break;p=!0}while(p||T!==A);return A}function bd(f,A,p,T,D,z,F){if(f){!F&&z&&function(Ae,ce,pe,me){var ye=Ae;do ye.z===0&&(ye.z=av(ye.x,ye.y,ce,pe,me)),ye.prevZ=ye.prev,ye.nextZ=ye.next,ye=ye.next;while(ye!==Ae);ye.prevZ.nextZ=null,ye.prevZ=null,function(Ne){var ze,Je,lt,Ke,st,pt,dt,qt,en=1;do{for(Je=Ne,Ne=null,st=null,pt=0;Je;){for(pt++,lt=Je,dt=0,ze=0;ze<en&&(dt++,lt=lt.nextZ);ze++);for(qt=en;dt>0||qt>0&&lt;)dt!==0&&(qt===0||!lt||Je.z<=lt.z)?(Ke=Je,Je=Je.nextZ,dt--):(Ke=lt,lt=lt.nextZ,qt--),st?st.nextZ=Ke:Ne=Ke,Ke.prevZ=st,st=Ke;Je=lt}st.nextZ=null,en*=2}while(pt>1)}(ye)}(f,T,D,z);for(var j,q,ie=f;f.prev!==f.next;)if(j=f.prev,q=f.next,z?G7(f,T,D,z):V7(f))A.push(j.i/p|0),A.push(f.i/p|0),A.push(q.i/p|0),Td(f),f=q.next,ie=q.next;else if((f=q)===ie){F?F===1?bd(f=j7(uh(f),A,p),A,p,T,D,z,2):F===2&&$7(f,A,p,T,D,z):bd(uh(f),A,p,T,D,z,1);break}}}function V7(f){var A=f.prev,p=f,T=f.next;if(dr(A,p,T)>=0)return!1;for(var D=A.x,z=p.x,F=T.x,j=A.y,q=p.y,ie=T.y,Ae=D<z?D<F?D:F:z<F?z:F,ce=j<q?j<ie?j:ie:q<ie?q:ie,pe=D>z?D>F?D:F:z>F?z:F,me=j>q?j>ie?j:ie:q>ie?q:ie,ye=T.next;ye!==A;){if(ye.x>=Ae&&ye.x<=pe&&ye.y>=ce&&ye.y<=me&&y0(D,j,z,q,F,ie,ye.x,ye.y)&&dr(ye.prev,ye,ye.next)>=0)return!1;ye=ye.next}return!0}function G7(f,A,p,T){var D=f.prev,z=f,F=f.next;if(dr(D,z,F)>=0)return!1;for(var j=D.x,q=z.x,ie=F.x,Ae=D.y,ce=z.y,pe=F.y,me=j<q?j<ie?j:ie:q<ie?q:ie,ye=Ae<ce?Ae<pe?Ae:pe:ce<pe?ce:pe,Ne=j>q?j>ie?j:ie:q>ie?q:ie,ze=Ae>ce?Ae>pe?Ae:pe:ce>pe?ce:pe,Je=av(me,ye,A,p,T),lt=av(Ne,ze,A,p,T),Ke=f.prevZ,st=f.nextZ;Ke&&Ke.z>=Je&&st&&st.z<=lt;){if(Ke.x>=me&&Ke.x<=Ne&&Ke.y>=ye&&Ke.y<=ze&&Ke!==D&&Ke!==F&&y0(j,Ae,q,ce,ie,pe,Ke.x,Ke.y)&&dr(Ke.prev,Ke,Ke.next)>=0||(Ke=Ke.prevZ,st.x>=me&&st.x<=Ne&&st.y>=ye&&st.y<=ze&&st!==D&&st!==F&&y0(j,Ae,q,ce,ie,pe,st.x,st.y)&&dr(st.prev,st,st.next)>=0))return!1;st=st.nextZ}for(;Ke&&Ke.z>=Je;){if(Ke.x>=me&&Ke.x<=Ne&&Ke.y>=ye&&Ke.y<=ze&&Ke!==D&&Ke!==F&&y0(j,Ae,q,ce,ie,pe,Ke.x,Ke.y)&&dr(Ke.prev,Ke,Ke.next)>=0)return!1;Ke=Ke.prevZ}for(;st&&st.z<=lt;){if(st.x>=me&&st.x<=Ne&&st.y>=ye&&st.y<=ze&&st!==D&&st!==F&&y0(j,Ae,q,ce,ie,pe,st.x,st.y)&&dr(st.prev,st,st.next)>=0)return!1;st=st.nextZ}return!0}function j7(f,A,p){var T=f;do{var D=T.prev,z=T.next.next;!dm(D,z)&&t4(D,T,T.next,z)&&Ed(D,z)&&Ed(z,D)&&(A.push(D.i/p|0),A.push(T.i/p|0),A.push(z.i/p|0),Td(T),Td(T.next),T=f=z),T=T.next}while(T!==f);return uh(T)}function $7(f,A,p,T,D,z){var F=f;do{for(var j=F.next.next;j!==F.prev;){if(F.i!==j.i&&Z7(F,j)){var q=n4(F,j);return F=uh(F,F.next),q=uh(q,q.next),bd(F,A,p,T,D,z,0),void bd(q,A,p,T,D,z,0)}j=j.next}F=F.next}while(F!==f)}function H7(f,A){return f.x-A.x}function W7(f,A){var p=function(D,z){var F,j=z,q=D.x,ie=D.y,Ae=-1/0;do{if(ie<=j.y&&ie>=j.next.y&&j.next.y!==j.y){var ce=j.x+(ie-j.y)*(j.next.x-j.x)/(j.next.y-j.y);if(ce<=q&&ce>Ae&&(Ae=ce,F=j.x<j.next.x?j:j.next,ce===q))return F}j=j.next}while(j!==z);if(!F)return null;var pe,me=F,ye=F.x,Ne=F.y,ze=1/0;j=F;do q>=j.x&&j.x>=ye&&q!==j.x&&y0(ie<Ne?q:Ae,ie,ye,Ne,ie<Ne?Ae:q,ie,j.x,j.y)&&(pe=Math.abs(ie-j.y)/(q-j.x),Ed(j,D)&&(pe<ze||pe===ze&&(j.x>F.x||j.x===F.x&&Q7(F,j)))&&(F=j,ze=pe)),j=j.next;while(j!==me);return F}(f,A);if(!p)return A;var T=n4(p,f);return uh(T,T.next),uh(p,p.next)}function Q7(f,A){return dr(f.prev,f,A.prev)<0&&dr(A.next,f,f.next)<0}function av(f,A,p,T,D){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-p)*D|0)|f<<8))|f<<4))|f<<2))|f<<1))|(A=1431655765&((A=858993459&((A=252645135&((A=16711935&((A=(A-T)*D|0)|A<<8))|A<<4))|A<<2))|A<<1))<<1}function q7(f){var A=f,p=f;do(A.x<p.x||A.x===p.x&&A.y<p.y)&&(p=A),A=A.next;while(A!==f);return p}function y0(f,A,p,T,D,z,F,j){return(D-F)*(A-j)>=(f-F)*(z-j)&&(f-F)*(T-j)>=(p-F)*(A-j)&&(p-F)*(z-j)>=(D-F)*(T-j)}function Z7(f,A){return f.next.i!==A.i&&f.prev.i!==A.i&&!function(p,T){var D=p;do{if(D.i!==p.i&&D.next.i!==p.i&&D.i!==T.i&&D.next.i!==T.i&&t4(D,D.next,p,T))return!0;D=D.next}while(D!==p);return!1}(f,A)&&(Ed(f,A)&&Ed(A,f)&&function(p,T){var D=p,z=!1,F=(p.x+T.x)/2,j=(p.y+T.y)/2;do D.y>j!=D.next.y>j&&D.next.y!==D.y&&F<(D.next.x-D.x)*(j-D.y)/(D.next.y-D.y)+D.x&&(z=!z),D=D.next;while(D!==p);return z}(f,A)&&(dr(f.prev,f,A.prev)||dr(f,A.prev,A))||dm(f,A)&&dr(f.prev,f,f.next)>0&&dr(A.prev,A,A.next)>0)}function dr(f,A,p){return(A.y-f.y)*(p.x-A.x)-(A.x-f.x)*(p.y-A.y)}function dm(f,A){return f.x===A.x&&f.y===A.y}function t4(f,A,p,T){var D=gm(dr(f,A,p)),z=gm(dr(f,A,T)),F=gm(dr(p,T,f)),j=gm(dr(p,T,A));return D!==z&&F!==j||!(D!==0||!pm(f,p,A))||!(z!==0||!pm(f,T,A))||!(F!==0||!pm(p,f,T))||!(j!==0||!pm(p,A,T))}function pm(f,A,p){return A.x<=Math.max(f.x,p.x)&&A.x>=Math.min(f.x,p.x)&&A.y<=Math.max(f.y,p.y)&&A.y>=Math.min(f.y,p.y)}function gm(f){return f>0?1:f<0?-1:0}function Ed(f,A){return dr(f.prev,f,f.next)<0?dr(f,A,f.next)>=0&&dr(f,f.prev,A)>=0:dr(f,A,f.prev)<0||dr(f,f.next,A)<0}function n4(f,A){var p=new lv(f.i,f.x,f.y),T=new lv(A.i,A.x,A.y),D=f.next,z=A.prev;return f.next=A,A.prev=f,p.next=D,D.prev=p,T.next=p,p.prev=T,z.next=T,T.prev=z,T}function i4(f,A,p,T){var D=new lv(f,A,p);return T?(D.next=T.next,D.prev=T,T.next.prev=D,T.next=D):(D.prev=D,D.next=D),D}function Td(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function lv(f,A,p){this.i=f,this.x=A,this.y=p,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Av(f,A,p,T){for(var D=0,z=A,F=p-T;z<p;z+=T)D+=(f[F]-f[z])*(f[z+1]+f[F+1]),F=z;return D}function Y7(f,A,p,T,D){r4(f,A,p||0,T||f.length-1,D||X7)}function r4(f,A,p,T,D){for(;T>p;){if(T-p>600){var z=T-p+1,F=A-p+1,j=Math.log(z),q=.5*Math.exp(2*j/3),ie=.5*Math.sqrt(j*q*(z-q)/z)*(F-z/2<0?-1:1);r4(f,A,Math.max(p,Math.floor(A-F*q/z+ie)),Math.min(T,Math.floor(A+(z-F)*q/z+ie)),D)}var Ae=f[A],ce=p,pe=T;for(Sd(f,p,A),D(f[T],Ae)>0&&Sd(f,p,T);ce<pe;){for(Sd(f,ce,pe),ce++,pe--;D(f[ce],Ae)<0;)ce++;for(;D(f[pe],Ae)>0;)pe--}D(f[p],Ae)===0?Sd(f,p,pe):Sd(f,++pe,T),pe<=A&&(p=pe+1),A<=pe&&(T=pe-1)}}function Sd(f,A,p){var T=f[A];f[A]=f[p],f[p]=T}function X7(f,A){return f<A?-1:f>A?1:0}function uv(f,A){const p=f.length;if(p<=1)return[f];const T=[];let D,z;for(let F=0;F<p;F++){const j=He(f[F]);j!==0&&(f[F].area=Math.abs(j),z===void 0&&(z=j<0),z===j<0?(D&&T.push(D),D=[f[F]]):D.push(f[F]))}if(D&&T.push(D),A>1)for(let F=0;F<T.length;F++)T[F].length<=A||(Y7(T[F],A,1,T[F].length-1,K7),T[F]=T[F].slice(0,A));return T}function K7(f,A){return A.area-f.area}function cv(f,A,p){const T=p.patternDependencies;let D=!1;for(const z of A){const F=z.paint.get(`${f}-pattern`);F.isConstant()||(D=!0);const j=F.constantOr(null);j&&(D=!0,T[j.to]=!0,T[j.from]=!0)}return D}function hv(f,A,p,T,D){const z=D.patternDependencies;for(const F of A){const j=F.paint.get(`${f}-pattern`).value;if(j.kind!=="constant"){let q=j.evaluate({zoom:T-1},p,{},D.availableImages),ie=j.evaluate({zoom:T},p,{},D.availableImages),Ae=j.evaluate({zoom:T+1},p,{},D.availableImages);q=q&&q.name?q.name:q,ie=ie&&ie.name?ie.name:ie,Ae=Ae&&Ae.name?Ae.name:Ae,z[q]=!0,z[ie]=!0,z[Ae]=!0,p.patterns[F.id]={min:q,mid:ie,max:Ae}}}return p}hm.exports=fm,hm.exports.default=fm,fm.deviation=function(f,A,p,T){var D=A&&A.length,z=Math.abs(Av(f,0,D?A[0]*p:f.length,p));if(D)for(var F=0,j=A.length;F<j;F++)z-=Math.abs(Av(f,A[F]*p,F<j-1?A[F+1]*p:f.length,p));var q=0;for(F=0;F<T.length;F+=3){var ie=T[F]*p,Ae=T[F+1]*p,ce=T[F+2]*p;q+=Math.abs((f[ie]-f[ce])*(f[Ae+1]-f[ie+1])-(f[ie]-f[Ae])*(f[ce+1]-f[ie+1]))}return z===0&&q===0?0:Math.abs((q-z)/z)},fm.flatten=function(f){for(var A=f[0][0].length,p={vertices:[],holes:[],dimensions:A},T=0,D=0;D<f.length;D++){for(var z=0;z<f[D].length;z++)for(var F=0;F<A;F++)p.vertices.push(f[D][z][F]);D>0&&p.holes.push(T+=f[D-1].length)}return p};class fv{constructor(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(p=>p.id),this.index=A.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new J,this.indexArray=new rt,this.indexArray2=new Xe,this.programConfigurations=new ah(A.layers,A.zoom),this.segments=new ft,this.segments2=new ft,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(A,p,T){this.hasPattern=cv("fill",this.layers,p);const D=this.layers[0].layout.get("fill-sort-key"),z=!D.isConstant(),F=[];for(const{feature:j,id:q,index:ie,sourceLayerIndex:Ae}of A){const ce=this.layers[0]._featureFilter.needGeometry,pe=Ah(j,ce);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),pe,T))continue;const me=z?D.evaluate(pe,{},T,p.availableImages):void 0,ye={id:q,properties:j.properties,type:j.type,sourceLayerIndex:Ae,index:ie,geometry:ce?pe.geometry:lh(j),patterns:{},sortKey:me};F.push(ye)}z&&F.sort((j,q)=>j.sortKey-q.sortKey);for(const j of F){const{geometry:q,index:ie,sourceLayerIndex:Ae}=j;if(this.hasPattern){const ce=hv("fill",this.layers,j,this.zoom,p);this.patternFeatures.push(ce)}else this.addFeature(j,q,ie,T,{});p.featureIndex.insert(A[ie].feature,q,ie,Ae,this.index)}}update(A,p,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,p,this.stateDependentLayers,T)}addFeatures(A,p,T){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,p,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,U7),this.indexBuffer=A.createIndexBuffer(this.indexArray),this.indexBuffer2=A.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(A),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(A,p,T,D,z){for(const F of uv(p,500)){let j=0;for(const me of F)j+=me.length;const q=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray),ie=q.vertexLength,Ae=[],ce=[];for(const me of F){if(me.length===0)continue;me!==F[0]&&ce.push(Ae.length/2);const ye=this.segments2.prepareSegment(me.length,this.layoutVertexArray,this.indexArray2),Ne=ye.vertexLength;this.layoutVertexArray.emplaceBack(me[0].x,me[0].y),this.indexArray2.emplaceBack(Ne+me.length-1,Ne),Ae.push(me[0].x),Ae.push(me[0].y);for(let ze=1;ze<me.length;ze++)this.layoutVertexArray.emplaceBack(me[ze].x,me[ze].y),this.indexArray2.emplaceBack(Ne+ze-1,Ne+ze),Ae.push(me[ze].x),Ae.push(me[ze].y);ye.vertexLength+=me.length,ye.primitiveLength+=me.length}const pe=hm.exports(Ae,ce);for(let me=0;me<pe.length;me+=3)this.indexArray.emplaceBack(ie+pe[me],ie+pe[me+1],ie+pe[me+2]);q.vertexLength+=j,q.primitiveLength+=pe.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,T,z,D)}}Ft("FillBucket",fv,{omit:["layers","patternFeatures"]});const J7=new Ui({"fill-sort-key":new Yt(ut.layout_fill["fill-sort-key"])});var eF={paint:new Ui({"fill-antialias":new Zt(ut.paint_fill["fill-antialias"]),"fill-opacity":new Yt(ut.paint_fill["fill-opacity"]),"fill-color":new Yt(ut.paint_fill["fill-color"]),"fill-outline-color":new Yt(ut.paint_fill["fill-outline-color"]),"fill-translate":new Zt(ut.paint_fill["fill-translate"]),"fill-translate-anchor":new Zt(ut.paint_fill["fill-translate-anchor"]),"fill-pattern":new cn(ut.paint_fill["fill-pattern"])}),layout:J7};const tF=Vi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),nF=Vi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:iF}=tF;var cc={},rF=Et,s4=_0;function _0(f,A,p,T,D){this.properties={},this.extent=p,this.type=0,this._pbf=f,this._geometry=-1,this._keys=T,this._values=D,f.readFields(sF,this,A)}function sF(f,A,p){f==1?A.id=p.readVarint():f==2?function(T,D){for(var z=T.readVarint()+T.pos;T.pos<z;){var F=D._keys[T.readVarint()],j=D._values[T.readVarint()];D.properties[F]=j}}(p,A):f==3?A.type=p.readVarint():f==4&&(A._geometry=p.pos)}function oF(f){for(var A,p,T=0,D=0,z=f.length,F=z-1;D<z;F=D++)T+=((p=f[F]).x-(A=f[D]).x)*(A.y+p.y);return T}_0.types=["Unknown","Point","LineString","Polygon"],_0.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var A,p=f.readVarint()+f.pos,T=1,D=0,z=0,F=0,j=[];f.pos<p;){if(D<=0){var q=f.readVarint();T=7&q,D=q>>3}if(D--,T===1||T===2)z+=f.readSVarint(),F+=f.readSVarint(),T===1&&(A&&j.push(A),A=[]),A.push(new rF(z,F));else{if(T!==7)throw new Error("unknown command "+T);A&&A.push(A[0].clone())}}return A&&j.push(A),j},_0.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var A=f.readVarint()+f.pos,p=1,T=0,D=0,z=0,F=1/0,j=-1/0,q=1/0,ie=-1/0;f.pos<A;){if(T<=0){var Ae=f.readVarint();p=7&Ae,T=Ae>>3}if(T--,p===1||p===2)(D+=f.readSVarint())<F&&(F=D),D>j&&(j=D),(z+=f.readSVarint())<q&&(q=z),z>ie&&(ie=z);else if(p!==7)throw new Error("unknown command "+p)}return[F,q,j,ie]},_0.prototype.toGeoJSON=function(f,A,p){var T,D,z=this.extent*Math.pow(2,p),F=this.extent*f,j=this.extent*A,q=this.loadGeometry(),ie=_0.types[this.type];function Ae(me){for(var ye=0;ye<me.length;ye++){var Ne=me[ye];me[ye]=[360*(Ne.x+F)/z-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ne.y+j)/z)*Math.PI/180))-90]}}switch(this.type){case 1:var ce=[];for(T=0;T<q.length;T++)ce[T]=q[T][0];Ae(q=ce);break;case 2:for(T=0;T<q.length;T++)Ae(q[T]);break;case 3:for(q=function(me){var ye=me.length;if(ye<=1)return[me];for(var Ne,ze,Je=[],lt=0;lt<ye;lt++){var Ke=oF(me[lt]);Ke!==0&&(ze===void 0&&(ze=Ke<0),ze===Ke<0?(Ne&&Je.push(Ne),Ne=[me[lt]]):Ne.push(me[lt]))}return Ne&&Je.push(Ne),Je}(q),T=0;T<q.length;T++)for(D=0;D<q[T].length;D++)Ae(q[T][D])}q.length===1?q=q[0]:ie="Multi"+ie;var pe={type:"Feature",geometry:{type:ie,coordinates:q},properties:this.properties};return"id"in this&&(pe.id=this.id),pe};var aF=s4,o4=a4;function a4(f,A){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(lF,this,A),this.length=this._features.length}function lF(f,A,p){f===15?A.version=p.readVarint():f===1?A.name=p.readString():f===5?A.extent=p.readVarint():f===2?A._features.push(p.pos):f===3?A._keys.push(p.readString()):f===4&&A._values.push(function(T){for(var D=null,z=T.readVarint()+T.pos;T.pos<z;){var F=T.readVarint()>>3;D=F===1?T.readString():F===2?T.readFloat():F===3?T.readDouble():F===4?T.readVarint64():F===5?T.readVarint():F===6?T.readSVarint():F===7?T.readBoolean():null}return D}(p))}a4.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var A=this._pbf.readVarint()+this._pbf.pos;return new aF(this._pbf,A,this.extent,this._keys,this._values)};var AF=o4;function uF(f,A,p){if(f===3){var T=new AF(p,p.readVarint()+p.pos);T.length&&(A[T.name]=T)}}cc.VectorTile=function(f,A){this.layers=f.readFields(uF,{},A)},cc.VectorTileFeature=s4,cc.VectorTileLayer=o4;const cF=cc.VectorTileFeature.types,dv=Math.pow(2,13);function Md(f,A,p,T,D,z,F,j){f.emplaceBack(A,p,2*Math.floor(T*dv)+F,D*dv*2,z*dv*2,Math.round(j))}class pv{constructor(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(p=>p.id),this.index=A.index,this.hasPattern=!1,this.layoutVertexArray=new le,this.centroidVertexArray=new N,this.indexArray=new rt,this.programConfigurations=new ah(A.layers,A.zoom),this.segments=new ft,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(A,p,T){this.features=[],this.hasPattern=cv("fill-extrusion",this.layers,p);for(const{feature:D,id:z,index:F,sourceLayerIndex:j}of A){const q=this.layers[0]._featureFilter.needGeometry,ie=Ah(D,q);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),ie,T))continue;const Ae={id:z,sourceLayerIndex:j,index:F,geometry:q?ie.geometry:lh(D),properties:D.properties,type:D.type,patterns:{}};this.hasPattern?this.features.push(hv("fill-extrusion",this.layers,Ae,this.zoom,p)):this.addFeature(Ae,Ae.geometry,F,T,{}),p.featureIndex.insert(D,Ae.geometry,F,j,this.index,!0)}}addFeatures(A,p,T){for(const D of this.features){const{geometry:z}=D;this.addFeature(D,z,D.index,p,T)}}update(A,p,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,p,this.stateDependentLayers,T)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,iF),this.centroidVertexBuffer=A.createVertexBuffer(this.centroidVertexArray,nF.members,!0),this.indexBuffer=A.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(A),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(A,p,T,D,z){const F={x:0,y:0,vertexCount:0};for(const j of uv(p,500)){let q=0;for(const ye of j)q+=ye.length;let ie=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const ye of j){if(ye.length===0||fF(ye))continue;let Ne=0;for(let ze=0;ze<ye.length;ze++){const Je=ye[ze];if(ze>=1){const lt=ye[ze-1];if(!hF(Je,lt)){ie.vertexLength+4>ft.MAX_VERTEX_ARRAY_LENGTH&&(ie=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ke=Je.sub(lt)._perp()._unit(),st=lt.dist(Je);Ne+st>32768&&(Ne=0),Md(this.layoutVertexArray,Je.x,Je.y,Ke.x,Ke.y,0,0,Ne),Md(this.layoutVertexArray,Je.x,Je.y,Ke.x,Ke.y,0,1,Ne),F.x+=2*Je.x,F.y+=2*Je.y,F.vertexCount+=2,Ne+=st,Md(this.layoutVertexArray,lt.x,lt.y,Ke.x,Ke.y,0,0,Ne),Md(this.layoutVertexArray,lt.x,lt.y,Ke.x,Ke.y,0,1,Ne),F.x+=2*lt.x,F.y+=2*lt.y,F.vertexCount+=2;const pt=ie.vertexLength;this.indexArray.emplaceBack(pt,pt+2,pt+1),this.indexArray.emplaceBack(pt+1,pt+2,pt+3),ie.vertexLength+=4,ie.primitiveLength+=2}}}}if(ie.vertexLength+q>ft.MAX_VERTEX_ARRAY_LENGTH&&(ie=this.segments.prepareSegment(q,this.layoutVertexArray,this.indexArray)),cF[A.type]!=="Polygon")continue;const Ae=[],ce=[],pe=ie.vertexLength;for(const ye of j)if(ye.length!==0){ye!==j[0]&&ce.push(Ae.length/2);for(let Ne=0;Ne<ye.length;Ne++){const ze=ye[Ne];Md(this.layoutVertexArray,ze.x,ze.y,0,0,1,1,0),F.x+=ze.x,F.y+=ze.y,F.vertexCount+=1,Ae.push(ze.x),Ae.push(ze.y)}}const me=hm.exports(Ae,ce);for(let ye=0;ye<me.length;ye+=3)this.indexArray.emplaceBack(pe+me[ye],pe+me[ye+2],pe+me[ye+1]);ie.primitiveLength+=me.length/3,ie.vertexLength+=q}for(let j=0;j<F.vertexCount;j++)this.centroidVertexArray.emplaceBack(Math.floor(F.x/F.vertexCount),Math.floor(F.y/F.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,T,z,D)}}function hF(f,A){return f.x===A.x&&(f.x<0||f.x>Rr)||f.y===A.y&&(f.y<0||f.y>Rr)}function fF(f){return f.every(A=>A.x<0)||f.every(A=>A.x>Rr)||f.every(A=>A.y<0)||f.every(A=>A.y>Rr)}Ft("FillExtrusionBucket",pv,{omit:["layers","features"]});var dF={paint:new Ui({"fill-extrusion-opacity":new Zt(ut["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Yt(ut["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Zt(ut["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Zt(ut["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new cn(ut["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Yt(ut["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Yt(ut["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Zt(ut["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Cd(f,A){return f.x*A.x+f.y*A.y}function l4(f,A){if(f.length===1){let p=0;const T=A[p++];let D;for(;!D||T.equals(D);)if(D=A[p++],!D)return 1/0;for(;p<A.length;p++){const z=A[p],F=f[0],j=D.sub(T),q=z.sub(T),ie=F.sub(T),Ae=Cd(j,j),ce=Cd(j,q),pe=Cd(q,q),me=Cd(ie,j),ye=Cd(ie,q),Ne=Ae*pe-ce*ce,ze=(pe*me-ce*ye)/Ne,Je=(Ae*ye-ce*me)/Ne,lt=T.z*(1-ze-Je)+D.z*ze+z.z*Je;if(isFinite(lt))return lt}return 1/0}{let p=1/0;for(const T of A)p=Math.min(p,T.z);return p}}const pF=Vi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:gF}=pF,mF=Vi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:yF}=mF,_F=cc.VectorTileFeature.types,vF=Math.cos(Math.PI/180*37.5),A4=Math.pow(2,14)/.5;class gv{constructor(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(p=>p.id),this.index=A.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(p=>{this.gradients[p.id]={}}),this.layoutVertexArray=new fe,this.layoutVertexArray2=new Re,this.indexArray=new rt,this.programConfigurations=new ah(A.layers,A.zoom),this.segments=new ft,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(A,p,T){this.hasPattern=cv("line",this.layers,p);const D=this.layers[0].layout.get("line-sort-key"),z=!D.isConstant(),F=[];for(const{feature:j,id:q,index:ie,sourceLayerIndex:Ae}of A){const ce=this.layers[0]._featureFilter.needGeometry,pe=Ah(j,ce);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),pe,T))continue;const me=z?D.evaluate(pe,{},T):void 0,ye={id:q,properties:j.properties,type:j.type,sourceLayerIndex:Ae,index:ie,geometry:ce?pe.geometry:lh(j),patterns:{},sortKey:me};F.push(ye)}z&&F.sort((j,q)=>j.sortKey-q.sortKey);for(const j of F){const{geometry:q,index:ie,sourceLayerIndex:Ae}=j;if(this.hasPattern){const ce=hv("line",this.layers,j,this.zoom,p);this.patternFeatures.push(ce)}else this.addFeature(j,q,ie,T,{});p.featureIndex.insert(A[ie].feature,q,ie,Ae,this.index)}}update(A,p,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,p,this.stateDependentLayers,T)}addFeatures(A,p,T){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,p,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(A){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=A.createVertexBuffer(this.layoutVertexArray2,yF)),this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,gF),this.indexBuffer=A.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(A),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(A){if(A.properties&&Object.prototype.hasOwnProperty.call(A.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(A.properties,"mapbox_clip_end"))return{start:+A.properties.mapbox_clip_start,end:+A.properties.mapbox_clip_end}}addFeature(A,p,T,D,z){const F=this.layers[0].layout,j=F.get("line-join").evaluate(A,{}),q=F.get("line-cap"),ie=F.get("line-miter-limit"),Ae=F.get("line-round-limit");this.lineClips=this.lineFeatureClips(A);for(const ce of p)this.addLine(ce,A,j,q,ie,Ae);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,T,z,D)}addLine(A,p,T,D,z,F){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Je=0;Je<A.length-1;Je++)this.totalDistance+=A[Je].dist(A[Je+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const j=_F[p.type]==="Polygon";let q=A.length;for(;q>=2&&A[q-1].equals(A[q-2]);)q--;let ie=0;for(;ie<q-1&&A[ie].equals(A[ie+1]);)ie++;if(q<(j?3:2))return;T==="bevel"&&(z=1.05);const Ae=this.overscaling<=16?122880/(512*this.overscaling):0,ce=this.segments.prepareSegment(10*q,this.layoutVertexArray,this.indexArray);let pe,me,ye,Ne,ze;this.e1=this.e2=-1,j&&(pe=A[q-2],ze=A[ie].sub(pe)._unit()._perp());for(let Je=ie;Je<q;Je++){if(ye=Je===q-1?j?A[ie+1]:void 0:A[Je+1],ye&&A[Je].equals(ye))continue;ze&&(Ne=ze),pe&&(me=pe),pe=A[Je],ze=ye?ye.sub(pe)._unit()._perp():Ne,Ne=Ne||ze;let lt=Ne.add(ze);lt.x===0&&lt.y===0||lt._unit();const Ke=Ne.x*ze.x+Ne.y*ze.y,st=lt.x*ze.x+lt.y*ze.y,pt=st!==0?1/st:1/0,dt=2*Math.sqrt(2-2*st),qt=st<vF&&me&&ye,en=Ne.x*ze.y-Ne.y*ze.x>0;if(qt&&Je>ie){const zt=pe.dist(me);if(zt>2*Ae){const Ht=pe.sub(pe.sub(me)._mult(Ae/zt)._round());this.updateDistance(me,Ht),this.addCurrentVertex(Ht,Ne,0,0,ce),me=Ht}}const $t=me&&ye;let Nt=$t?T:j?"butt":D;if($t&&Nt==="round"&&(pt<F?Nt="miter":pt<=2&&(Nt="fakeround")),Nt==="miter"&&pt>z&&(Nt="bevel"),Nt==="bevel"&&(pt>2&&(Nt="flipbevel"),pt<z&&(Nt="miter")),me&&this.updateDistance(me,pe),Nt==="miter")lt._mult(pt),this.addCurrentVertex(pe,lt,0,0,ce);else if(Nt==="flipbevel"){if(pt>100)lt=ze.mult(-1);else{const zt=pt*Ne.add(ze).mag()/Ne.sub(ze).mag();lt._perp()._mult(zt*(en?-1:1))}this.addCurrentVertex(pe,lt,0,0,ce),this.addCurrentVertex(pe,lt.mult(-1),0,0,ce)}else if(Nt==="bevel"||Nt==="fakeround"){const zt=-Math.sqrt(pt*pt-1),Ht=en?zt:0,Gt=en?0:zt;if(me&&this.addCurrentVertex(pe,Ne,Ht,Gt,ce),Nt==="fakeround"){const Tt=Math.round(180*dt/Math.PI/20);for(let pn=1;pn<Tt;pn++){let an=pn/Tt;if(an!==.5){const Oi=an-.5;an+=an*Oi*(an-1)*((1.0904+Ke*(Ke*(3.55645-1.43519*Ke)-3.2452))*Oi*Oi+(.848013+Ke*(.215638*Ke-1.06021)))}const jn=ze.sub(Ne)._mult(an)._add(Ne)._unit()._mult(en?-1:1);this.addHalfVertex(pe,jn.x,jn.y,!1,en,0,ce)}}ye&&this.addCurrentVertex(pe,ze,-Ht,-Gt,ce)}else if(Nt==="butt")this.addCurrentVertex(pe,lt,0,0,ce);else if(Nt==="square"){const zt=me?1:-1;this.addCurrentVertex(pe,lt,zt,zt,ce)}else Nt==="round"&&(me&&(this.addCurrentVertex(pe,Ne,0,0,ce),this.addCurrentVertex(pe,Ne,1,1,ce,!0)),ye&&(this.addCurrentVertex(pe,ze,-1,-1,ce,!0),this.addCurrentVertex(pe,ze,0,0,ce)));if(qt&&Je<q-1){const zt=pe.dist(ye);if(zt>2*Ae){const Ht=pe.add(ye.sub(pe)._mult(Ae/zt)._round());this.updateDistance(pe,Ht),this.addCurrentVertex(Ht,ze,0,0,ce),pe=Ht}}}}addCurrentVertex(A,p,T,D,z,F=!1){const j=p.y*D-p.x,q=-p.y-p.x*D;this.addHalfVertex(A,p.x+p.y*T,p.y-p.x*T,F,!1,T,z),this.addHalfVertex(A,j,q,F,!0,-D,z),this.distance>A4/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(A,p,T,D,z,F))}addHalfVertex({x:A,y:p},T,D,z,F,j,q){const ie=.5*(this.lineClips?this.scaledDistance*(A4-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((A<<1)+(z?1:0),(p<<1)+(F?1:0),Math.round(63*T)+128,Math.round(63*D)+128,1+(j===0?0:j<0?-1:1)|(63&ie)<<2,ie>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Ae=q.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Ae),q.primitiveLength++),F?this.e2=Ae:this.e1=Ae}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(A,p){this.distance+=A.dist(p),this.updateScaledDistance()}}Ft("LineBucket",gv,{omit:["layers","patternFeatures"]});const xF=new Ui({"line-cap":new Zt(ut.layout_line["line-cap"]),"line-join":new Yt(ut.layout_line["line-join"]),"line-miter-limit":new Zt(ut.layout_line["line-miter-limit"]),"line-round-limit":new Zt(ut.layout_line["line-round-limit"]),"line-sort-key":new Yt(ut.layout_line["line-sort-key"])});var u4={paint:new Ui({"line-opacity":new Yt(ut.paint_line["line-opacity"]),"line-color":new Yt(ut.paint_line["line-color"]),"line-translate":new Zt(ut.paint_line["line-translate"]),"line-translate-anchor":new Zt(ut.paint_line["line-translate-anchor"]),"line-width":new Yt(ut.paint_line["line-width"]),"line-gap-width":new Yt(ut.paint_line["line-gap-width"]),"line-offset":new Yt(ut.paint_line["line-offset"]),"line-blur":new Yt(ut.paint_line["line-blur"]),"line-dasharray":new Zr(ut.paint_line["line-dasharray"]),"line-pattern":new cn(ut.paint_line["line-pattern"]),"line-gradient":new qo(ut.paint_line["line-gradient"])}),layout:xF};const c4=new class extends Yt{possiblyEvaluate(f,A){return A=new Ei(Math.floor(A.zoom),{now:A.now,fadeDuration:A.fadeDuration,zoomHistory:A.zoomHistory,transition:A.transition}),super.possiblyEvaluate(f,A)}evaluate(f,A,p,T){return A=Q({},A,{zoom:Math.floor(A.zoom)}),super.evaluate(f,A,p,T)}}(u4.paint.properties["line-width"].specification);function h4(f,A){return A>0?A+2*f:f}c4.useIntegerZoom=!0;const wF=Vi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),bF=Vi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Vi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const EF=Vi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Vi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const f4=Vi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),TF=Vi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function SF(f,A,p){return f.sections.forEach(T=>{T.text=function(D,z,F){const j=z.layout.get("text-transform").evaluate(F,{});return j==="uppercase"?D=D.toLocaleUpperCase():j==="lowercase"&&(D=D.toLocaleLowerCase()),us.applyArabicShaping&&(D=us.applyArabicShaping(D)),D}(T.text,A,p)}),f}Vi([{name:"triangle",components:3,type:"Uint16"}]),Vi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Vi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Vi([{type:"Float32",name:"offsetX"}]),Vi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Pd={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Yr=24,mv=Mi,d4=function(f,A,p,T,D){var z,F,j=8*D-T-1,q=(1<<j)-1,ie=q>>1,Ae=-7,ce=p?D-1:0,pe=p?-1:1,me=f[A+ce];for(ce+=pe,z=me&(1<<-Ae)-1,me>>=-Ae,Ae+=j;Ae>0;z=256*z+f[A+ce],ce+=pe,Ae-=8);for(F=z&(1<<-Ae)-1,z>>=-Ae,Ae+=T;Ae>0;F=256*F+f[A+ce],ce+=pe,Ae-=8);if(z===0)z=1-ie;else{if(z===q)return F?NaN:1/0*(me?-1:1);F+=Math.pow(2,T),z-=ie}return(me?-1:1)*F*Math.pow(2,z-T)},p4=function(f,A,p,T,D,z){var F,j,q,ie=8*z-D-1,Ae=(1<<ie)-1,ce=Ae>>1,pe=D===23?Math.pow(2,-24)-Math.pow(2,-77):0,me=T?0:z-1,ye=T?1:-1,Ne=A<0||A===0&&1/A<0?1:0;for(A=Math.abs(A),isNaN(A)||A===1/0?(j=isNaN(A)?1:0,F=Ae):(F=Math.floor(Math.log(A)/Math.LN2),A*(q=Math.pow(2,-F))<1&&(F--,q*=2),(A+=F+ce>=1?pe/q:pe*Math.pow(2,1-ce))*q>=2&&(F++,q/=2),F+ce>=Ae?(j=0,F=Ae):F+ce>=1?(j=(A*q-1)*Math.pow(2,D),F+=ce):(j=A*Math.pow(2,ce-1)*Math.pow(2,D),F=0));D>=8;f[p+me]=255&j,me+=ye,j/=256,D-=8);for(F=F<<D|j,ie+=D;ie>0;f[p+me]=255&F,me+=ye,F/=256,ie-=8);f[p+me-ye]|=128*Ne};function Mi(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}Mi.Varint=0,Mi.Fixed64=1,Mi.Bytes=2,Mi.Fixed32=5;var hc,yv=4294967296,g4=1/yv,m4=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function fu(f){return f.type===Mi.Bytes?f.readVarint()+f.pos:f.pos+1}function v0(f,A,p){return p?4294967296*A+(f>>>0):4294967296*(A>>>0)+(f>>>0)}function y4(f,A,p){var T=A<=16383?1:A<=2097151?2:A<=268435455?3:Math.floor(Math.log(A)/(7*Math.LN2));p.realloc(T);for(var D=p.pos-1;D>=f;D--)p.buf[D+T]=p.buf[D]}function MF(f,A){for(var p=0;p<f.length;p++)A.writeVarint(f[p])}function CF(f,A){for(var p=0;p<f.length;p++)A.writeSVarint(f[p])}function PF(f,A){for(var p=0;p<f.length;p++)A.writeFloat(f[p])}function IF(f,A){for(var p=0;p<f.length;p++)A.writeDouble(f[p])}function kF(f,A){for(var p=0;p<f.length;p++)A.writeBoolean(f[p])}function LF(f,A){for(var p=0;p<f.length;p++)A.writeFixed32(f[p])}function DF(f,A){for(var p=0;p<f.length;p++)A.writeSFixed32(f[p])}function RF(f,A){for(var p=0;p<f.length;p++)A.writeFixed64(f[p])}function BF(f,A){for(var p=0;p<f.length;p++)A.writeSFixed64(f[p])}function mm(f,A){return(f[A]|f[A+1]<<8|f[A+2]<<16)+16777216*f[A+3]}function x0(f,A,p){f[p]=A,f[p+1]=A>>>8,f[p+2]=A>>>16,f[p+3]=A>>>24}function _4(f,A){return(f[A]|f[A+1]<<8|f[A+2]<<16)+(f[A+3]<<24)}function zF(f,A,p){f===1&&p.readMessage(OF,A)}function OF(f,A,p){if(f===3){const{id:T,bitmap:D,width:z,height:F,left:j,top:q,advance:ie}=p.readMessage(FF,{});A.push({id:T,bitmap:new wd({width:z+6,height:F+6},D),metrics:{width:z,height:F,left:j,top:q,advance:ie}})}}function FF(f,A,p){f===1?A.id=p.readVarint():f===2?A.bitmap=p.readBytes():f===3?A.width=p.readVarint():f===4?A.height=p.readVarint():f===5?A.left=p.readSVarint():f===6?A.top=p.readSVarint():f===7&&(A.advance=p.readVarint())}function v4(f){let A=0,p=0;for(const F of f)A+=F.w*F.h,p=Math.max(p,F.w);f.sort((F,j)=>j.h-F.h);const T=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(A/.95)),p),h:1/0}];let D=0,z=0;for(const F of f)for(let j=T.length-1;j>=0;j--){const q=T[j];if(!(F.w>q.w||F.h>q.h)){if(F.x=q.x,F.y=q.y,z=Math.max(z,F.y+F.h),D=Math.max(D,F.x+F.w),F.w===q.w&&F.h===q.h){const ie=T.pop();j<T.length&&(T[j]=ie)}else F.h===q.h?(q.x+=F.w,q.w-=F.w):F.w===q.w?(q.y+=F.h,q.h-=F.h):(T.push({x:q.x+F.w,y:q.y,w:q.w-F.w,h:F.h}),q.y+=F.h,q.h-=F.h);break}}return{w:D,h:z,fill:A/(D*z)||0}}Mi.prototype={destroy:function(){this.buf=null},readFields:function(f,A,p){for(p=p||this.length;this.pos<p;){var T=this.readVarint(),D=T>>3,z=this.pos;this.type=7&T,f(D,A,this),this.pos===z&&this.skip(T)}return A},readMessage:function(f,A){return this.readFields(f,A,this.readVarint()+this.pos)},readFixed32:function(){var f=mm(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=_4(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=mm(this.buf,this.pos)+mm(this.buf,this.pos+4)*yv;return this.pos+=8,f},readSFixed64:function(){var f=mm(this.buf,this.pos)+_4(this.buf,this.pos+4)*yv;return this.pos+=8,f},readFloat:function(){var f=d4(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=d4(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var A,p,T=this.buf;return A=127&(p=T[this.pos++]),p<128?A:(A|=(127&(p=T[this.pos++]))<<7,p<128?A:(A|=(127&(p=T[this.pos++]))<<14,p<128?A:(A|=(127&(p=T[this.pos++]))<<21,p<128?A:function(D,z,F){var j,q,ie=F.buf;if(j=(112&(q=ie[F.pos++]))>>4,q<128||(j|=(127&(q=ie[F.pos++]))<<3,q<128)||(j|=(127&(q=ie[F.pos++]))<<10,q<128)||(j|=(127&(q=ie[F.pos++]))<<17,q<128)||(j|=(127&(q=ie[F.pos++]))<<24,q<128)||(j|=(1&(q=ie[F.pos++]))<<31,q<128))return v0(D,j,z);throw new Error("Expected varint not more than 10 bytes")}(A|=(15&(p=T[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var f=this.readVarint()+this.pos,A=this.pos;return this.pos=f,f-A>=12&&m4?function(p,T,D){return m4.decode(p.subarray(T,D))}(this.buf,A,f):function(p,T,D){for(var z="",F=T;F<D;){var j,q,ie,Ae=p[F],ce=null,pe=Ae>239?4:Ae>223?3:Ae>191?2:1;if(F+pe>D)break;pe===1?Ae<128&&(ce=Ae):pe===2?(192&(j=p[F+1]))==128&&(ce=(31&Ae)<<6|63&j)<=127&&(ce=null):pe===3?(q=p[F+2],(192&(j=p[F+1]))==128&&(192&q)==128&&((ce=(15&Ae)<<12|(63&j)<<6|63&q)<=2047||ce>=55296&&ce<=57343)&&(ce=null)):pe===4&&(q=p[F+2],ie=p[F+3],(192&(j=p[F+1]))==128&&(192&q)==128&&(192&ie)==128&&((ce=(15&Ae)<<18|(63&j)<<12|(63&q)<<6|63&ie)<=65535||ce>=1114112)&&(ce=null)),ce===null?(ce=65533,pe=1):ce>65535&&(ce-=65536,z+=String.fromCharCode(ce>>>10&1023|55296),ce=56320|1023&ce),z+=String.fromCharCode(ce),F+=pe}return z}(this.buf,A,f)},readBytes:function(){var f=this.readVarint()+this.pos,A=this.buf.subarray(this.pos,f);return this.pos=f,A},readPackedVarint:function(f,A){if(this.type!==Mi.Bytes)return f.push(this.readVarint(A));var p=fu(this);for(f=f||[];this.pos<p;)f.push(this.readVarint(A));return f},readPackedSVarint:function(f){if(this.type!==Mi.Bytes)return f.push(this.readSVarint());var A=fu(this);for(f=f||[];this.pos<A;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==Mi.Bytes)return f.push(this.readBoolean());var A=fu(this);for(f=f||[];this.pos<A;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==Mi.Bytes)return f.push(this.readFloat());var A=fu(this);for(f=f||[];this.pos<A;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==Mi.Bytes)return f.push(this.readDouble());var A=fu(this);for(f=f||[];this.pos<A;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==Mi.Bytes)return f.push(this.readFixed32());var A=fu(this);for(f=f||[];this.pos<A;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==Mi.Bytes)return f.push(this.readSFixed32());var A=fu(this);for(f=f||[];this.pos<A;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==Mi.Bytes)return f.push(this.readFixed64());var A=fu(this);for(f=f||[];this.pos<A;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==Mi.Bytes)return f.push(this.readSFixed64());var A=fu(this);for(f=f||[];this.pos<A;)f.push(this.readSFixed64());return f},skip:function(f){var A=7&f;if(A===Mi.Varint)for(;this.buf[this.pos++]>127;);else if(A===Mi.Bytes)this.pos=this.readVarint()+this.pos;else if(A===Mi.Fixed32)this.pos+=4;else{if(A!==Mi.Fixed64)throw new Error("Unimplemented type: "+A);this.pos+=8}},writeTag:function(f,A){this.writeVarint(f<<3|A)},realloc:function(f){for(var A=this.length||16;A<this.pos+f;)A*=2;if(A!==this.length){var p=new Uint8Array(A);p.set(this.buf),this.buf=p,this.length=A}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),x0(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),x0(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),x0(this.buf,-1&f,this.pos),x0(this.buf,Math.floor(f*g4),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),x0(this.buf,-1&f,this.pos),x0(this.buf,Math.floor(f*g4),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(A,p){var T,D;if(A>=0?(T=A%4294967296|0,D=A/4294967296|0):(D=~(-A/4294967296),4294967295^(T=~(-A%4294967296))?T=T+1|0:(T=0,D=D+1|0)),A>=18446744073709552e3||A<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),function(z,F,j){j.buf[j.pos++]=127&z|128,z>>>=7,j.buf[j.pos++]=127&z|128,z>>>=7,j.buf[j.pos++]=127&z|128,z>>>=7,j.buf[j.pos++]=127&z|128,j.buf[j.pos]=127&(z>>>=7)}(T,0,p),function(z,F){var j=(7&z)<<4;F.buf[F.pos++]|=j|((z>>>=3)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z)))))}(D,p)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(!!f)},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var A=this.pos;this.pos=function(T,D,z){for(var F,j,q=0;q<D.length;q++){if((F=D.charCodeAt(q))>55295&&F<57344){if(!j){F>56319||q+1===D.length?(T[z++]=239,T[z++]=191,T[z++]=189):j=F;continue}if(F<56320){T[z++]=239,T[z++]=191,T[z++]=189,j=F;continue}F=j-55296<<10|F-56320|65536,j=null}else j&&(T[z++]=239,T[z++]=191,T[z++]=189,j=null);F<128?T[z++]=F:(F<2048?T[z++]=F>>6|192:(F<65536?T[z++]=F>>12|224:(T[z++]=F>>18|240,T[z++]=F>>12&63|128),T[z++]=F>>6&63|128),T[z++]=63&F|128)}return z}(this.buf,f,this.pos);var p=this.pos-A;p>=128&&y4(A,p,this),this.pos=A-1,this.writeVarint(p),this.pos+=p},writeFloat:function(f){this.realloc(4),p4(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),p4(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var A=f.length;this.writeVarint(A),this.realloc(A);for(var p=0;p<A;p++)this.buf[this.pos++]=f[p]},writeRawMessage:function(f,A){this.pos++;var p=this.pos;f(A,this);var T=this.pos-p;T>=128&&y4(p,T,this),this.pos=p-1,this.writeVarint(T),this.pos+=T},writeMessage:function(f,A,p){this.writeTag(f,Mi.Bytes),this.writeRawMessage(A,p)},writePackedVarint:function(f,A){A.length&&this.writeMessage(f,MF,A)},writePackedSVarint:function(f,A){A.length&&this.writeMessage(f,CF,A)},writePackedBoolean:function(f,A){A.length&&this.writeMessage(f,kF,A)},writePackedFloat:function(f,A){A.length&&this.writeMessage(f,PF,A)},writePackedDouble:function(f,A){A.length&&this.writeMessage(f,IF,A)},writePackedFixed32:function(f,A){A.length&&this.writeMessage(f,LF,A)},writePackedSFixed32:function(f,A){A.length&&this.writeMessage(f,DF,A)},writePackedFixed64:function(f,A){A.length&&this.writeMessage(f,RF,A)},writePackedSFixed64:function(f,A){A.length&&this.writeMessage(f,BF,A)},writeBytesField:function(f,A){this.writeTag(f,Mi.Bytes),this.writeBytes(A)},writeFixed32Field:function(f,A){this.writeTag(f,Mi.Fixed32),this.writeFixed32(A)},writeSFixed32Field:function(f,A){this.writeTag(f,Mi.Fixed32),this.writeSFixed32(A)},writeFixed64Field:function(f,A){this.writeTag(f,Mi.Fixed64),this.writeFixed64(A)},writeSFixed64Field:function(f,A){this.writeTag(f,Mi.Fixed64),this.writeSFixed64(A)},writeVarintField:function(f,A){this.writeTag(f,Mi.Varint),this.writeVarint(A)},writeSVarintField:function(f,A){this.writeTag(f,Mi.Varint),this.writeSVarint(A)},writeStringField:function(f,A){this.writeTag(f,Mi.Bytes),this.writeString(A)},writeFloatField:function(f,A){this.writeTag(f,Mi.Fixed32),this.writeFloat(A)},writeDoubleField:function(f,A){this.writeTag(f,Mi.Fixed64),this.writeDouble(A)},writeBooleanField:function(f,A){this.writeVarintField(f,!!A)}};class _v{constructor(A,{pixelRatio:p,version:T,stretchX:D,stretchY:z,content:F}){this.paddedRect=A,this.pixelRatio=p,this.stretchX=D,this.stretchY=z,this.content=F,this.version=T}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class x4{constructor(A,p){const T={},D={};this.haveRenderCallbacks=[];const z=[];this.addImages(A,T,z),this.addImages(p,D,z);const{w:F,h:j}=v4(z),q=new va({width:F||1,height:j||1});for(const ie in A){const Ae=A[ie],ce=T[ie].paddedRect;va.copy(Ae.data,q,{x:0,y:0},{x:ce.x+1,y:ce.y+1},Ae.data)}for(const ie in p){const Ae=p[ie],ce=D[ie].paddedRect,pe=ce.x+1,me=ce.y+1,ye=Ae.data.width,Ne=Ae.data.height;va.copy(Ae.data,q,{x:0,y:0},{x:pe,y:me},Ae.data),va.copy(Ae.data,q,{x:0,y:Ne-1},{x:pe,y:me-1},{width:ye,height:1}),va.copy(Ae.data,q,{x:0,y:0},{x:pe,y:me+Ne},{width:ye,height:1}),va.copy(Ae.data,q,{x:ye-1,y:0},{x:pe-1,y:me},{width:1,height:Ne}),va.copy(Ae.data,q,{x:0,y:0},{x:pe+ye,y:me},{width:1,height:Ne})}this.image=q,this.iconPositions=T,this.patternPositions=D}addImages(A,p,T){for(const D in A){const z=A[D],F={x:0,y:0,w:z.data.width+2,h:z.data.height+2};T.push(F),p[D]=new _v(F,z),z.hasRenderCallback&&this.haveRenderCallbacks.push(D)}}patchUpdatedImages(A,p){A.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const T in A.updatedImages)this.patchUpdatedImage(this.iconPositions[T],A.getImage(T),p),this.patchUpdatedImage(this.patternPositions[T],A.getImage(T),p)}patchUpdatedImage(A,p,T){if(!A||!p||A.version===p.version)return;A.version=p.version;const[D,z]=A.tl;T.update(p.data,void 0,{x:D,y:z})}}Ft("ImagePosition",_v),Ft("ImageAtlas",x4),a.WritingMode=void 0,(hc=a.WritingMode||(a.WritingMode={}))[hc.none=0]="none",hc[hc.horizontal=1]="horizontal",hc[hc.vertical=2]="vertical",hc[hc.horizontalOnly=3]="horizontalOnly";const ym=-17;class Id{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(A,p){const T=new Id;return T.scale=A||1,T.fontStack=p,T}static forImage(A){const p=new Id;return p.imageName=A,p}}class w0{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(A,p){const T=new w0;for(let D=0;D<A.sections.length;D++){const z=A.sections[D];z.image?T.addImageSection(z):T.addTextSection(z,p)}return T}length(){return this.text.length}getSection(A){return this.sections[this.sectionIndex[A]]}getSectionIndex(A){return this.sectionIndex[A]}getCharCode(A){return this.text.charCodeAt(A)}verticalizePunctuation(){this.text=function(A){let p="";for(let T=0;T<A.length;T++){const D=A.charCodeAt(T+1)||null,z=A.charCodeAt(T-1)||null;p+=D&&Gs(D)&&!Pd[A[T+1]]||z&&Gs(z)&&!Pd[A[T-1]]||!Pd[A[T]]?A[T]:Pd[A[T]]}return p}(this.text)}trim(){let A=0;for(let T=0;T<this.text.length&&vm[this.text.charCodeAt(T)];T++)A++;let p=this.text.length;for(let T=this.text.length-1;T>=0&&T>=A&&vm[this.text.charCodeAt(T)];T--)p--;this.text=this.text.substring(A,p),this.sectionIndex=this.sectionIndex.slice(A,p)}substring(A,p){const T=new w0;return T.text=this.text.substring(A,p),T.sectionIndex=this.sectionIndex.slice(A,p),T.sections=this.sections,T}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((A,p)=>Math.max(A,this.sections[p].scale),0)}addTextSection(A,p){this.text+=A.text,this.sections.push(Id.forText(A.scale,A.fontStack||p));const T=this.sections.length-1;for(let D=0;D<A.text.length;++D)this.sectionIndex.push(T)}addImageSection(A){const p=A.image?A.image.name:"";if(p.length===0)return void ve("Can't add FormattedSection with an empty image.");const T=this.getNextImageSectionCharCode();T?(this.text+=String.fromCharCode(T),this.sections.push(Id.forImage(p)),this.sectionIndex.push(this.sections.length-1)):ve("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function _m(f,A,p,T,D,z,F,j,q,ie,Ae,ce,pe,me,ye,Ne){const ze=w0.fromFeature(f,D);let Je;ce===a.WritingMode.vertical&&ze.verticalizePunctuation();const{processBidirectionalText:lt,processStyledBidirectionalText:Ke}=us;if(lt&&ze.sections.length===1){Je=[];const dt=lt(ze.toString(),vv(ze,ie,z,A,T,me,ye));for(const qt of dt){const en=new w0;en.text=qt,en.sections=ze.sections;for(let $t=0;$t<qt.length;$t++)en.sectionIndex.push(0);Je.push(en)}}else if(Ke){Je=[];const dt=Ke(ze.text,ze.sectionIndex,vv(ze,ie,z,A,T,me,ye));for(const qt of dt){const en=new w0;en.text=qt[0],en.sectionIndex=qt[1],en.sections=ze.sections,Je.push(en)}}else Je=function(dt,qt){const en=[],$t=dt.text;let Nt=0;for(const zt of qt)en.push(dt.substring(Nt,zt)),Nt=zt;return Nt<$t.length&&en.push(dt.substring(Nt,$t.length)),en}(ze,vv(ze,ie,z,A,T,me,ye));const st=[],pt={positionedLines:st,text:ze.toString(),top:Ae[1],bottom:Ae[1],left:Ae[0],right:Ae[0],writingMode:ce,iconsInText:!1,verticalizable:!1};return function(dt,qt,en,$t,Nt,zt,Ht,Gt,Tt,pn,an,jn){let Oi=0,Gi=ym,Br=0,wa=0;const cs=Gt==="right"?1:Gt==="left"?0:.5;let br=0;for(const Er of Nt){Er.trim();const fs=Er.getMaxScale(),Ss=(fs-1)*Yr,Zs={positionedGlyphs:[],lineOffset:0};dt.positionedLines[br]=Zs;const bo=Zs.positionedGlyphs;let Eo=0;if(!Er.length()){Gi+=zt,++br;continue}for(let Hr=0;Hr<Er.length();Hr++){const Yn=Er.getSection(Hr),Zo=Er.getSectionIndex(Hr),ds=Er.getCharCode(Hr);let Ms=0,tl=null,Ol=null,Fl=null,pu=Yr;const nl=!(Tt===a.WritingMode.horizontal||!an&&!Xa(ds)||an&&(vm[ds]||($r=ds,Ut.Arabic($r)||Ut["Arabic Supplement"]($r)||Ut["Arabic Extended-A"]($r)||Ut["Arabic Presentation Forms-A"]($r)||Ut["Arabic Presentation Forms-B"]($r))));if(Yn.imageName){const ba=$t[Yn.imageName];if(!ba)continue;Fl=Yn.imageName,dt.iconsInText=dt.iconsInText||!0,Ol=ba.paddedRect;const To=ba.displaySize;Yn.scale=Yn.scale*Yr/jn,tl={width:To[0],height:To[1],left:1,top:-3,advance:nl?To[1]:To[0]},Ms=Ss+(Yr-To[1]*Yn.scale),pu=tl.advance;const gu=nl?To[0]*Yn.scale-Yr*fs:To[1]*Yn.scale-Yr*fs;gu>0&&gu>Eo&&(Eo=gu)}else{const ba=en[Yn.fontStack],To=ba&&ba[ds];if(To&&To.rect)Ol=To.rect,tl=To.metrics;else{const gu=qt[Yn.fontStack],Dd=gu&&gu[ds];if(!Dd)continue;tl=Dd.metrics}Ms=(fs-Yn.scale)*Yr}nl?(dt.verticalizable=!0,bo.push({glyph:ds,imageName:Fl,x:Oi,y:Gi+Ms,vertical:nl,scale:Yn.scale,fontStack:Yn.fontStack,sectionIndex:Zo,metrics:tl,rect:Ol}),Oi+=pu*Yn.scale+pn):(bo.push({glyph:ds,imageName:Fl,x:Oi,y:Gi+Ms,vertical:nl,scale:Yn.scale,fontStack:Yn.fontStack,sectionIndex:Zo,metrics:tl,rect:Ol}),Oi+=tl.advance*Yn.scale+pn)}bo.length!==0&&(Br=Math.max(Oi-pn,Br),VF(bo,0,bo.length-1,cs,Eo)),Oi=0;const qi=zt*fs+Eo;Zs.lineOffset=Math.max(Eo,Ss),Gi+=qi,wa=Math.max(qi,wa),++br}var $r;const hs=Gi-ym,{horizontalAlign:Ts,verticalAlign:wo}=xv(Ht);(function(Er,fs,Ss,Zs,bo,Eo,qi,Hr,Yn){const Zo=(fs-Ss)*bo;let ds=0;ds=Eo!==qi?-Hr*Zs-ym:(-Zs*Yn+.5)*qi;for(const Ms of Er)for(const tl of Ms.positionedGlyphs)tl.x+=Zo,tl.y+=ds})(dt.positionedLines,cs,Ts,wo,Br,wa,zt,hs,Nt.length),dt.top+=-wo*hs,dt.bottom=dt.top+hs,dt.left+=-Ts*Br,dt.right=dt.left+Br}(pt,A,p,T,Je,F,j,q,ce,ie,pe,Ne),!function(dt){for(const qt of dt)if(qt.positionedGlyphs.length!==0)return!1;return!0}(st)&&pt}const vm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},NF={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function w4(f,A,p,T,D,z){if(A.imageName){const F=T[A.imageName];return F?F.displaySize[0]*A.scale*Yr/z+D:0}{const F=p[A.fontStack],j=F&&F[f];return j?j.metrics.advance*A.scale+D:0}}function b4(f,A,p,T){const D=Math.pow(f-A,2);return T?f<A?D/2:2*D:D+Math.abs(p)*p}function UF(f,A,p){let T=0;return f===10&&(T-=1e4),p&&(T+=150),f!==40&&f!==65288||(T+=50),A!==41&&A!==65289||(T+=50),T}function E4(f,A,p,T,D,z){let F=null,j=b4(A,p,D,z);for(const q of T){const ie=b4(A-q.x,p,D,z)+q.badness;ie<=j&&(F=q,j=ie)}return{index:f,x:A,priorBreak:F,badness:j}}function T4(f){return f?T4(f.priorBreak).concat(f.index):[]}function vv(f,A,p,T,D,z,F){if(z!=="point")return[];if(!f)return[];const j=[],q=function(pe,me,ye,Ne,ze,Je){let lt=0;for(let Ke=0;Ke<pe.length();Ke++){const st=pe.getSection(Ke);lt+=w4(pe.getCharCode(Ke),st,Ne,ze,me,Je)}return lt/Math.max(1,Math.ceil(lt/ye))}(f,A,p,T,D,F),ie=f.text.indexOf("")>=0;let Ae=0;for(let pe=0;pe<f.length();pe++){const me=f.getSection(pe),ye=f.getCharCode(pe);if(vm[ye]||(Ae+=w4(ye,me,T,D,A,F)),pe<f.length()-1){const Ne=!((ce=ye)<11904||!(Ut["Bopomofo Extended"](ce)||Ut.Bopomofo(ce)||Ut["CJK Compatibility Forms"](ce)||Ut["CJK Compatibility Ideographs"](ce)||Ut["CJK Compatibility"](ce)||Ut["CJK Radicals Supplement"](ce)||Ut["CJK Strokes"](ce)||Ut["CJK Symbols and Punctuation"](ce)||Ut["CJK Unified Ideographs Extension A"](ce)||Ut["CJK Unified Ideographs"](ce)||Ut["Enclosed CJK Letters and Months"](ce)||Ut["Halfwidth and Fullwidth Forms"](ce)||Ut.Hiragana(ce)||Ut["Ideographic Description Characters"](ce)||Ut["Kangxi Radicals"](ce)||Ut["Katakana Phonetic Extensions"](ce)||Ut.Katakana(ce)||Ut["Vertical Forms"](ce)||Ut["Yi Radicals"](ce)||Ut["Yi Syllables"](ce)));(NF[ye]||Ne||me.imageName)&&j.push(E4(pe+1,Ae,q,j,UF(ye,f.getCharCode(pe+1),Ne&&ie),!1))}}var ce;return T4(E4(f.length(),Ae,q,j,0,!0))}function xv(f){let A=.5,p=.5;switch(f){case"right":case"top-right":case"bottom-right":A=1;break;case"left":case"top-left":case"bottom-left":A=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":p=1;break;case"top":case"top-right":case"top-left":p=0}return{horizontalAlign:A,verticalAlign:p}}function VF(f,A,p,T,D){if(!T&&!D)return;const z=f[p],F=(f[p].x+z.metrics.advance*z.scale)*T;for(let j=A;j<=p;j++)f[j].x-=F,f[j].y+=D}function GF(f,A,p){const{horizontalAlign:T,verticalAlign:D}=xv(p),z=A[0]-f.displaySize[0]*T,F=A[1]-f.displaySize[1]*D;return{image:f,top:F,bottom:F+f.displaySize[1],left:z,right:z+f.displaySize[0]}}function S4(f,A,p,T,D,z){const F=f.image;let j;if(F.content){const ze=F.content,Je=F.pixelRatio||1;j=[ze[0]/Je,ze[1]/Je,F.displaySize[0]-ze[2]/Je,F.displaySize[1]-ze[3]/Je]}const q=A.left*z,ie=A.right*z;let Ae,ce,pe,me;p==="width"||p==="both"?(me=D[0]+q-T[3],ce=D[0]+ie+T[1]):(me=D[0]+(q+ie-F.displaySize[0])/2,ce=me+F.displaySize[0]);const ye=A.top*z,Ne=A.bottom*z;return p==="height"||p==="both"?(Ae=D[1]+ye-T[0],pe=D[1]+Ne+T[2]):(Ae=D[1]+(ye+Ne-F.displaySize[1])/2,pe=Ae+F.displaySize[1]),{image:F,top:Ae,right:ce,bottom:pe,left:me,collisionPadding:j}}const du=128;function M4(f,A){const{expression:p}=A;if(p.kind==="constant")return{kind:"constant",layoutSize:p.evaluate(new Ei(f+1))};if(p.kind==="source")return{kind:"source"};{const{zoomStops:T,interpolationType:D}=p;let z=0;for(;z<T.length&&T[z]<=f;)z++;z=Math.max(0,z-1);let F=z;for(;F<T.length&&T[F]<f+1;)F++;F=Math.min(T.length-1,F);const j=T[z],q=T[F];return p.kind==="composite"?{kind:"composite",minZoom:j,maxZoom:q,interpolationType:D}:{kind:"camera",minZoom:j,maxZoom:q,minSize:p.evaluate(new Ei(j)),maxSize:p.evaluate(new Ei(q)),interpolationType:D}}}class fc extends Et{constructor(A,p,T,D){super(A,p),this.angle=T,D!==void 0&&(this.segment=D)}clone(){return new fc(this.x,this.y,this.angle,this.segment)}}function C4(f,A,p,T,D){if(A.segment===void 0)return!0;let z=A,F=A.segment+1,j=0;for(;j>-p/2;){if(F--,F<0)return!1;j-=f[F].dist(z),z=f[F]}j+=f[F].dist(f[F+1]),F++;const q=[];let ie=0;for(;j<p/2;){const Ae=f[F],ce=f[F+1];if(!ce)return!1;let pe=f[F-1].angleTo(Ae)-Ae.angleTo(ce);for(pe=Math.abs((pe+3*Math.PI)%(2*Math.PI)-Math.PI),q.push({distance:j,angleDelta:pe}),ie+=pe;j-q[0].distance>T;)ie-=q.shift().angleDelta;if(ie>D)return!1;F++,j+=Ae.dist(ce)}return!0}function P4(f){let A=0;for(let p=0;p<f.length-1;p++)A+=f[p].dist(f[p+1]);return A}function I4(f,A,p){return f?.6*A*p:0}function k4(f,A){return Math.max(f?f.right-f.left:0,A?A.right-A.left:0)}function jF(f,A,p,T,D,z){const F=I4(p,D,z),j=k4(p,T)*z;let q=0;const ie=P4(f)/2;for(let Ae=0;Ae<f.length-1;Ae++){const ce=f[Ae],pe=f[Ae+1],me=ce.dist(pe);if(q+me>ie){const ye=(ie-q)/me,Ne=Jt(ce.x,pe.x,ye),ze=Jt(ce.y,pe.y,ye),Je=new fc(Ne,ze,pe.angleTo(ce),Ae);return Je._round(),!F||C4(f,Je,j,F,A)?Je:void 0}q+=me}}function $F(f,A,p,T,D,z,F,j,q){const ie=I4(T,z,F),Ae=k4(T,D),ce=Ae*F,pe=f[0].x===0||f[0].x===q||f[0].y===0||f[0].y===q;return A-ce<A/4&&(A=ce+A/4),L4(f,pe?A/2*j%A:(Ae/2+2*z)*F*j%A,A,ie,p,ce,pe,!1,q)}function L4(f,A,p,T,D,z,F,j,q){const ie=z/2,Ae=P4(f);let ce=0,pe=A-p,me=[];for(let ye=0;ye<f.length-1;ye++){const Ne=f[ye],ze=f[ye+1],Je=Ne.dist(ze),lt=ze.angleTo(Ne);for(;pe+p<ce+Je;){pe+=p;const Ke=(pe-ce)/Je,st=Jt(Ne.x,ze.x,Ke),pt=Jt(Ne.y,ze.y,Ke);if(st>=0&&st<q&&pt>=0&&pt<q&&pe-ie>=0&&pe+ie<=Ae){const dt=new fc(st,pt,lt,ye);dt._round(),T&&!C4(f,dt,z,T,D)||me.push(dt)}}ce+=Je}return j||me.length||F||(me=L4(f,ce/2,p,T,D,z,F,!0,q)),me}function D4(f,A,p,T,D){const z=[];for(let F=0;F<f.length;F++){const j=f[F];let q;for(let ie=0;ie<j.length-1;ie++){let Ae=j[ie],ce=j[ie+1];Ae.x<A&&ce.x<A||(Ae.x<A?Ae=new Et(A,Ae.y+(A-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round():ce.x<A&&(ce=new Et(A,Ae.y+(A-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round()),Ae.y<p&&ce.y<p||(Ae.y<p?Ae=new Et(Ae.x+(p-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),p)._round():ce.y<p&&(ce=new Et(Ae.x+(p-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),p)._round()),Ae.x>=T&&ce.x>=T||(Ae.x>=T?Ae=new Et(T,Ae.y+(T-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round():ce.x>=T&&(ce=new Et(T,Ae.y+(T-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round()),Ae.y>=D&&ce.y>=D||(Ae.y>=D?Ae=new Et(Ae.x+(D-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),D)._round():ce.y>=D&&(ce=new Et(Ae.x+(D-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),D)._round()),q&&Ae.equals(q[q.length-1])||(q=[Ae],z.push(q)),q.push(ce)))))}}return z}function R4(f,A,p,T){const D=[],z=f.image,F=z.pixelRatio,j=z.paddedRect.w-2,q=z.paddedRect.h-2,ie=f.right-f.left,Ae=f.bottom-f.top,ce=z.stretchX||[[0,j]],pe=z.stretchY||[[0,q]],me=(zt,Ht)=>zt+Ht[1]-Ht[0],ye=ce.reduce(me,0),Ne=pe.reduce(me,0),ze=j-ye,Je=q-Ne;let lt=0,Ke=ye,st=0,pt=Ne,dt=0,qt=ze,en=0,$t=Je;if(z.content&&T){const zt=z.content;lt=xm(ce,0,zt[0]),st=xm(pe,0,zt[1]),Ke=xm(ce,zt[0],zt[2]),pt=xm(pe,zt[1],zt[3]),dt=zt[0]-lt,en=zt[1]-st,qt=zt[2]-zt[0]-Ke,$t=zt[3]-zt[1]-pt}const Nt=(zt,Ht,Gt,Tt)=>{const pn=wm(zt.stretch-lt,Ke,ie,f.left),an=bm(zt.fixed-dt,qt,zt.stretch,ye),jn=wm(Ht.stretch-st,pt,Ae,f.top),Oi=bm(Ht.fixed-en,$t,Ht.stretch,Ne),Gi=wm(Gt.stretch-lt,Ke,ie,f.left),Br=bm(Gt.fixed-dt,qt,Gt.stretch,ye),wa=wm(Tt.stretch-st,pt,Ae,f.top),cs=bm(Tt.fixed-en,$t,Tt.stretch,Ne),br=new Et(pn,jn),$r=new Et(Gi,jn),hs=new Et(Gi,wa),Ts=new Et(pn,wa),wo=new Et(an/F,Oi/F),Er=new Et(Br/F,cs/F),fs=A*Math.PI/180;if(fs){const bo=Math.sin(fs),Eo=Math.cos(fs),qi=[Eo,-bo,bo,Eo];br._matMult(qi),$r._matMult(qi),Ts._matMult(qi),hs._matMult(qi)}const Ss=zt.stretch+zt.fixed,Zs=Ht.stretch+Ht.fixed;return{tl:br,tr:$r,bl:Ts,br:hs,tex:{x:z.paddedRect.x+1+Ss,y:z.paddedRect.y+1+Zs,w:Gt.stretch+Gt.fixed-Ss,h:Tt.stretch+Tt.fixed-Zs},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:wo,pixelOffsetBR:Er,minFontScaleX:qt/F/ie,minFontScaleY:$t/F/Ae,isSDF:p}};if(T&&(z.stretchX||z.stretchY)){const zt=B4(ce,ze,ye),Ht=B4(pe,Je,Ne);for(let Gt=0;Gt<zt.length-1;Gt++){const Tt=zt[Gt],pn=zt[Gt+1];for(let an=0;an<Ht.length-1;an++)D.push(Nt(Tt,Ht[an],pn,Ht[an+1]))}}else D.push(Nt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:j+1},{fixed:0,stretch:q+1}));return D}function xm(f,A,p){let T=0;for(const D of f)T+=Math.max(A,Math.min(p,D[1]))-Math.max(A,Math.min(p,D[0]));return T}function B4(f,A,p){const T=[{fixed:-1,stretch:0}];for(const[D,z]of f){const F=T[T.length-1];T.push({fixed:D-F.stretch,stretch:F.stretch}),T.push({fixed:D-F.stretch,stretch:F.stretch+(z-D)})}return T.push({fixed:A+1,stretch:p}),T}function wm(f,A,p,T){return f/A*p+T}function bm(f,A,p,T){return f-A*p/T}Ft("Anchor",fc);class Em{constructor(A,p,T,D,z,F,j,q,ie,Ae){if(this.boxStartIndex=A.length,ie){let ce=F.top,pe=F.bottom;const me=F.collisionPadding;me&&(ce-=me[1],pe+=me[3]);let ye=pe-ce;ye>0&&(ye=Math.max(10,ye),this.circleDiameter=ye)}else{let ce=F.top*j-q[0],pe=F.bottom*j+q[2],me=F.left*j-q[3],ye=F.right*j+q[1];const Ne=F.collisionPadding;if(Ne&&(me-=Ne[0]*j,ce-=Ne[1]*j,ye+=Ne[2]*j,pe+=Ne[3]*j),Ae){const ze=new Et(me,ce),Je=new Et(ye,ce),lt=new Et(me,pe),Ke=new Et(ye,pe),st=Ae*Math.PI/180;ze._rotate(st),Je._rotate(st),lt._rotate(st),Ke._rotate(st),me=Math.min(ze.x,Je.x,lt.x,Ke.x),ye=Math.max(ze.x,Je.x,lt.x,Ke.x),ce=Math.min(ze.y,Je.y,lt.y,Ke.y),pe=Math.max(ze.y,Je.y,lt.y,Ke.y)}A.emplaceBack(p.x,p.y,me,ce,ye,pe,T,D,z)}this.boxEndIndex=A.length}}class HF{constructor(A=[],p=WF){if(this.data=A,this.length=this.data.length,this.compare=p,this.length>0)for(let T=(this.length>>1)-1;T>=0;T--)this._down(T)}push(A){this.data.push(A),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const A=this.data[0],p=this.data.pop();return this.length--,this.length>0&&(this.data[0]=p,this._down(0)),A}peek(){return this.data[0]}_up(A){const{data:p,compare:T}=this,D=p[A];for(;A>0;){const z=A-1>>1,F=p[z];if(T(D,F)>=0)break;p[A]=F,A=z}p[A]=D}_down(A){const{data:p,compare:T}=this,D=this.length>>1,z=p[A];for(;A<D;){let F=1+(A<<1),j=p[F];const q=F+1;if(q<this.length&&T(p[q],j)<0&&(F=q,j=p[q]),T(j,z)>=0)break;p[A]=j,A=F}p[A]=z}}function WF(f,A){return f<A?-1:f>A?1:0}function QF(f,A=1,p=!1){let T=1/0,D=1/0,z=-1/0,F=-1/0;const j=f[0];for(let me=0;me<j.length;me++){const ye=j[me];(!me||ye.x<T)&&(T=ye.x),(!me||ye.y<D)&&(D=ye.y),(!me||ye.x>z)&&(z=ye.x),(!me||ye.y>F)&&(F=ye.y)}const q=Math.min(z-T,F-D);let ie=q/2;const Ae=new HF([],qF);if(q===0)return new Et(T,D);for(let me=T;me<z;me+=q)for(let ye=D;ye<F;ye+=q)Ae.push(new b0(me+ie,ye+ie,ie,f));let ce=function(me){let ye=0,Ne=0,ze=0;const Je=me[0];for(let lt=0,Ke=Je.length,st=Ke-1;lt<Ke;st=lt++){const pt=Je[lt],dt=Je[st],qt=pt.x*dt.y-dt.x*pt.y;Ne+=(pt.x+dt.x)*qt,ze+=(pt.y+dt.y)*qt,ye+=3*qt}return new b0(Ne/ye,ze/ye,0,me)}(f),pe=Ae.length;for(;Ae.length;){const me=Ae.pop();(me.d>ce.d||!ce.d)&&(ce=me,p&&console.log("found best %d after %d probes",Math.round(1e4*me.d)/1e4,pe)),me.max-ce.d<=A||(ie=me.h/2,Ae.push(new b0(me.p.x-ie,me.p.y-ie,ie,f)),Ae.push(new b0(me.p.x+ie,me.p.y-ie,ie,f)),Ae.push(new b0(me.p.x-ie,me.p.y+ie,ie,f)),Ae.push(new b0(me.p.x+ie,me.p.y+ie,ie,f)),pe+=4)}return p&&(console.log(`num probes: ${pe}`),console.log(`best distance: ${ce.d}`)),ce.p}function qF(f,A){return A.max-f.max}function b0(f,A,p,T){this.p=new Et(f,A),this.h=p,this.d=function(D,z){let F=!1,j=1/0;for(let q=0;q<z.length;q++){const ie=z[q];for(let Ae=0,ce=ie.length,pe=ce-1;Ae<ce;pe=Ae++){const me=ie[Ae],ye=ie[pe];me.y>D.y!=ye.y>D.y&&D.x<(ye.x-me.x)*(D.y-me.y)/(ye.y-me.y)+me.x&&(F=!F),j=Math.min(j,jS(D,me,ye))}}return(F?1:-1)*Math.sqrt(j)}(this.p,T),this.max=this.d+this.h*Math.SQRT2}const wv=Number.POSITIVE_INFINITY;function z4(f,A){return A[1]!==wv?function(p,T,D){let z=0,F=0;switch(T=Math.abs(T),D=Math.abs(D),p){case"top-right":case"top-left":case"top":F=D-7;break;case"bottom-right":case"bottom-left":case"bottom":F=7-D}switch(p){case"top-right":case"bottom-right":case"right":z=-T;break;case"top-left":case"bottom-left":case"left":z=T}return[z,F]}(f,A[0],A[1]):function(p,T){let D=0,z=0;T<0&&(T=0);const F=T/Math.sqrt(2);switch(p){case"top-right":case"top-left":z=F-7;break;case"bottom-right":case"bottom-left":z=7-F;break;case"bottom":z=7-T;break;case"top":z=T-7}switch(p){case"top-right":case"bottom-right":D=-F;break;case"top-left":case"bottom-left":D=F;break;case"left":D=T;break;case"right":D=-T}return[D,z]}(f,A[0])}function bv(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ZF(f,A,p,T,D,z,F,j,q,ie,Ae){let ce=z.textMaxSize.evaluate(A,{});ce===void 0&&(ce=F);const pe=f.layers[0].layout,me=pe.get("icon-offset").evaluate(A,{},Ae),ye=F4(p.horizontal),Ne=F/24,ze=f.tilePixelRatio*Ne,Je=f.tilePixelRatio*ce/24,lt=f.tilePixelRatio*j,Ke=f.tilePixelRatio*pe.get("symbol-spacing"),st=pe.get("text-padding")*f.tilePixelRatio,pt=function(Tt,pn,an,jn=1){const Oi=Tt.get("icon-padding").evaluate(pn,{},an),Gi=Oi&&Oi.values;return[Gi[0]*jn,Gi[1]*jn,Gi[2]*jn,Gi[3]*jn]}(pe,A,Ae,f.tilePixelRatio),dt=pe.get("text-max-angle")/180*Math.PI,qt=pe.get("text-rotation-alignment")!=="viewport"&&pe.get("symbol-placement")!=="point",en=pe.get("icon-rotation-alignment")==="map"&&pe.get("symbol-placement")!=="point",$t=pe.get("symbol-placement"),Nt=Ke/2,zt=pe.get("icon-text-fit");let Ht;T&&zt!=="none"&&(f.allowVerticalPlacement&&p.vertical&&(Ht=S4(T,p.vertical,zt,pe.get("icon-text-fit-padding"),me,Ne)),ye&&(T=S4(T,ye,zt,pe.get("icon-text-fit-padding"),me,Ne)));const Gt=(Tt,pn)=>{pn.x<0||pn.x>=Rr||pn.y<0||pn.y>=Rr||function(an,jn,Oi,Gi,Br,wa,cs,br,$r,hs,Ts,wo,Er,fs,Ss,Zs,bo,Eo,qi,Hr,Yn,Zo,ds,Ms,tl){const Ol=an.addToLineVertexArray(jn,Oi);let Fl,pu,nl,ba,To=0,gu=0,Dd=0,e5=0,Dv=-1,Rv=-1;const mu={};let t5=xn.exports(""),Bv=0,zv=0;if(br._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Bv,zv]=br.layout.get("text-offset").evaluate(Yn,{},Ms).map(So=>So*Yr):(Bv=br.layout.get("text-radial-offset").evaluate(Yn,{},Ms)*Yr,zv=wv),an.allowVerticalPlacement&&Gi.vertical){const So=br.layout.get("text-rotate").evaluate(Yn,{},Ms)+90;nl=new Em($r,jn,hs,Ts,wo,Gi.vertical,Er,fs,Ss,So),cs&&(ba=new Em($r,jn,hs,Ts,wo,cs,bo,Eo,Ss,So))}if(Br){const So=br.layout.get("icon-rotate").evaluate(Yn,{}),_A=br.layout.get("icon-text-fit")!=="none",Rd=R4(Br,So,ds,_A),Bd=cs?R4(cs,So,ds,_A):void 0;pu=new Em($r,jn,hs,Ts,wo,Br,bo,Eo,!1,So),To=4*Rd.length;const r5=an.iconSizeData;let hh=null;r5.kind==="source"?(hh=[du*br.layout.get("icon-size").evaluate(Yn,{})],hh[0]>dc&&ve(`${an.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):r5.kind==="composite"&&(hh=[du*Zo.compositeIconSizes[0].evaluate(Yn,{},Ms),du*Zo.compositeIconSizes[1].evaluate(Yn,{},Ms)],(hh[0]>dc||hh[1]>dc)&&ve(`${an.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),an.addSymbols(an.icon,Rd,hh,Hr,qi,Yn,a.WritingMode.none,jn,Ol.lineStartIndex,Ol.lineLength,-1,Ms),Dv=an.icon.placedSymbolArray.length-1,Bd&&(gu=4*Bd.length,an.addSymbols(an.icon,Bd,hh,Hr,qi,Yn,a.WritingMode.vertical,jn,Ol.lineStartIndex,Ol.lineLength,-1,Ms),Rv=an.icon.placedSymbolArray.length-1)}const n5=Object.keys(Gi.horizontal);for(const So of n5){const _A=Gi.horizontal[So];if(!Fl){t5=xn.exports(_A.text);const Bd=br.layout.get("text-rotate").evaluate(Yn,{},Ms);Fl=new Em($r,jn,hs,Ts,wo,_A,Er,fs,Ss,Bd)}const Rd=_A.positionedLines.length===1;if(Dd+=O4(an,jn,_A,wa,br,Ss,Yn,Zs,Ol,Gi.vertical?a.WritingMode.horizontal:a.WritingMode.horizontalOnly,Rd?n5:[So],mu,Dv,Zo,Ms),Rd)break}Gi.vertical&&(e5+=O4(an,jn,Gi.vertical,wa,br,Ss,Yn,Zs,Ol,a.WritingMode.vertical,["vertical"],mu,Rv,Zo,Ms));const lN=Fl?Fl.boxStartIndex:an.collisionBoxArray.length,AN=Fl?Fl.boxEndIndex:an.collisionBoxArray.length,uN=nl?nl.boxStartIndex:an.collisionBoxArray.length,cN=nl?nl.boxEndIndex:an.collisionBoxArray.length,hN=pu?pu.boxStartIndex:an.collisionBoxArray.length,fN=pu?pu.boxEndIndex:an.collisionBoxArray.length,dN=ba?ba.boxStartIndex:an.collisionBoxArray.length,pN=ba?ba.boxEndIndex:an.collisionBoxArray.length;let Nl=-1;const Pm=(So,_A)=>So&&So.circleDiameter?Math.max(So.circleDiameter,_A):_A;Nl=Pm(Fl,Nl),Nl=Pm(nl,Nl),Nl=Pm(pu,Nl),Nl=Pm(ba,Nl);const i5=Nl>-1?1:0;i5&&(Nl*=tl/Yr),an.glyphOffsetArray.length>=E0.MAX_GLYPHS&&ve("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Yn.sortKey!==void 0&&an.addToSortKeyRanges(an.symbolInstances.length,Yn.sortKey),an.symbolInstances.emplaceBack(jn.x,jn.y,mu.right>=0?mu.right:-1,mu.center>=0?mu.center:-1,mu.left>=0?mu.left:-1,mu.vertical||-1,Dv,Rv,t5,lN,AN,uN,cN,hN,fN,dN,pN,hs,Dd,e5,To,gu,i5,0,Er,Bv,zv,Nl)}(f,pn,Tt,p,T,D,Ht,f.layers[0],f.collisionBoxArray,A.index,A.sourceLayerIndex,f.index,ze,[st,st,st,st],qt,q,lt,pt,en,me,A,z,ie,Ae,F)};if($t==="line")for(const Tt of D4(A.geometry,0,0,Rr,Rr)){const pn=$F(Tt,Ke,dt,p.vertical||ye,T,24,Je,f.overscaling,Rr);for(const an of pn){const jn=ye;jn&&YF(f,jn.text,Nt,an)||Gt(Tt,an)}}else if($t==="line-center"){for(const Tt of A.geometry)if(Tt.length>1){const pn=jF(Tt,dt,p.vertical||ye,T,24,Je);pn&&Gt(Tt,pn)}}else if(A.type==="Polygon")for(const Tt of uv(A.geometry,0)){const pn=QF(Tt,16);Gt(Tt[0],new fc(pn.x,pn.y,0))}else if(A.type==="LineString")for(const Tt of A.geometry)Gt(Tt,new fc(Tt[0].x,Tt[0].y,0));else if(A.type==="Point")for(const Tt of A.geometry)for(const pn of Tt)Gt([pn],new fc(pn.x,pn.y,0))}const dc=32640;function O4(f,A,p,T,D,z,F,j,q,ie,Ae,ce,pe,me,ye){const Ne=function(lt,Ke,st,pt,dt,qt,en,$t){const Nt=pt.layout.get("text-rotate").evaluate(qt,{})*Math.PI/180,zt=[];for(const Ht of Ke.positionedLines)for(const Gt of Ht.positionedGlyphs){if(!Gt.rect)continue;const Tt=Gt.rect||{};let pn=4,an=!0,jn=1,Oi=0;const Gi=(dt||$t)&&Gt.vertical,Br=Gt.metrics.advance*Gt.scale/2;if($t&&Ke.verticalizable){const qi=(Gt.scale-1)*Yr,Hr=(Yr-Gt.metrics.width*Gt.scale)/2;Oi=Ht.lineOffset/2-(Gt.imageName?-Hr:qi)}if(Gt.imageName){const qi=en[Gt.imageName];an=qi.sdf,jn=qi.pixelRatio,pn=1/jn}const wa=dt?[Gt.x+Br,Gt.y]:[0,0];let cs=dt?[0,0]:[Gt.x+Br+st[0],Gt.y+st[1]-Oi],br=[0,0];Gi&&(br=cs,cs=[0,0]);const $r=(Gt.metrics.left-pn)*Gt.scale-Br+cs[0],hs=(-Gt.metrics.top-pn)*Gt.scale+cs[1],Ts=$r+Tt.w*Gt.scale/jn,wo=hs+Tt.h*Gt.scale/jn,Er=new Et($r,hs),fs=new Et(Ts,hs),Ss=new Et($r,wo),Zs=new Et(Ts,wo);if(Gi){const qi=new Et(-Br,Br-ym),Hr=-Math.PI/2,Yn=12-Br,Zo=new Et(22-Yn,-(Gt.imageName?Yn:0)),ds=new Et(...br);Er._rotateAround(Hr,qi)._add(Zo)._add(ds),fs._rotateAround(Hr,qi)._add(Zo)._add(ds),Ss._rotateAround(Hr,qi)._add(Zo)._add(ds),Zs._rotateAround(Hr,qi)._add(Zo)._add(ds)}if(Nt){const qi=Math.sin(Nt),Hr=Math.cos(Nt),Yn=[Hr,-qi,qi,Hr];Er._matMult(Yn),fs._matMult(Yn),Ss._matMult(Yn),Zs._matMult(Yn)}const bo=new Et(0,0),Eo=new Et(0,0);zt.push({tl:Er,tr:fs,bl:Ss,br:Zs,tex:Tt,writingMode:Ke.writingMode,glyphOffset:wa,sectionIndex:Gt.sectionIndex,isSDF:an,pixelOffsetTL:bo,pixelOffsetBR:Eo,minFontScaleX:0,minFontScaleY:0})}return zt}(0,p,j,D,z,F,T,f.allowVerticalPlacement),ze=f.textSizeData;let Je=null;ze.kind==="source"?(Je=[du*D.layout.get("text-size").evaluate(F,{})],Je[0]>dc&&ve(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ze.kind==="composite"&&(Je=[du*me.compositeTextSizes[0].evaluate(F,{},ye),du*me.compositeTextSizes[1].evaluate(F,{},ye)],(Je[0]>dc||Je[1]>dc)&&ve(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),f.addSymbols(f.text,Ne,Je,j,z,F,ie,A,q.lineStartIndex,q.lineLength,pe,ye);for(const lt of Ae)ce[lt]=f.text.placedSymbolArray.length-1;return 4*Ne.length}function F4(f){for(const A in f)return f[A];return null}function YF(f,A,p,T){const D=f.compareText;if(A in D){const z=D[A];for(let F=z.length-1;F>=0;F--)if(T.dist(z[F])<p)return!0}else D[A]=[];return D[A].push(T),!1}const XF=cc.VectorTileFeature.types,KF=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Tm(f,A,p,T,D,z,F,j,q,ie,Ae,ce,pe){const me=j?Math.min(dc,Math.round(j[0])):0,ye=j?Math.min(dc,Math.round(j[1])):0;f.emplaceBack(A,p,Math.round(32*T),Math.round(32*D),z,F,(me<<1)+(q?1:0),ye,16*ie,16*Ae,256*ce,256*pe)}function Ev(f,A,p){f.emplaceBack(A.x,A.y,p),f.emplaceBack(A.x,A.y,p),f.emplaceBack(A.x,A.y,p),f.emplaceBack(A.x,A.y,p)}function JF(f){for(const A of f.sections)if(oc(A.text))return!0;return!1}class Tv{constructor(A){this.layoutVertexArray=new Be,this.indexArray=new rt,this.programConfigurations=A,this.segments=new ft,this.dynamicLayoutVertexArray=new Ze,this.opacityVertexArray=new ct,this.placedSymbolArray=new m}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(A,p,T,D){this.isEmpty()||(T&&(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,wF.members),this.indexBuffer=A.createIndexBuffer(this.indexArray,p),this.dynamicLayoutVertexBuffer=A.createVertexBuffer(this.dynamicLayoutVertexArray,bF.members,!0),this.opacityVertexBuffer=A.createVertexBuffer(this.opacityVertexArray,KF,!0),this.opacityVertexBuffer.itemSize=1),(T||D)&&this.programConfigurations.upload(A))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ft("SymbolBuffers",Tv);class Sv{constructor(A,p,T){this.layoutVertexArray=new A,this.layoutAttributes=p,this.indexArray=new T,this.segments=new ft,this.collisionVertexArray=new it}upload(A){this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=A.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=A.createVertexBuffer(this.collisionVertexArray,EF.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ft("CollisionBuffers",Sv);class E0{constructor(A){this.collisionBoxArray=A.collisionBoxArray,this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(F=>F.id),this.index=A.index,this.pixelRatio=A.pixelRatio,this.sourceLayerIndex=A.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=rv([]),this.placementViewportMatrix=rv([]);const p=this.layers[0]._unevaluatedLayout._values;this.textSizeData=M4(this.zoom,p["text-size"]),this.iconSizeData=M4(this.zoom,p["icon-size"]);const T=this.layers[0].layout,D=T.get("symbol-sort-key"),z=T.get("symbol-z-order");this.canOverlap=Cv(T,"text-overlap","text-allow-overlap")!=="never"||Cv(T,"icon-overlap","icon-allow-overlap")!=="never"||T.get("text-ignore-placement")||T.get("icon-ignore-placement"),this.sortFeaturesByKey=z!=="viewport-y"&&!D.isConstant(),this.sortFeaturesByY=(z==="viewport-y"||z==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,T.get("symbol-placement")==="point"&&(this.writingModes=T.get("text-writing-mode").map(F=>a.WritingMode[F])),this.stateDependentLayerIds=this.layers.filter(F=>F.isStateDependent()).map(F=>F.id),this.sourceID=A.sourceID}createArrays(){this.text=new Tv(new ah(this.layers,this.zoom,A=>/^text/.test(A))),this.icon=new Tv(new ah(this.layers,this.zoom,A=>/^icon/.test(A))),this.glyphOffsetArray=new E,this.lineVertexArray=new C,this.symbolInstances=new v}calculateGlyphDependencies(A,p,T,D,z){for(let F=0;F<A.length;F++)if(p[A.charCodeAt(F)]=!0,(T||D)&&z){const j=Pd[A.charAt(F)];j&&(p[j.charCodeAt(0)]=!0)}}populate(A,p,T){const D=this.layers[0],z=D.layout,F=z.get("text-font"),j=z.get("text-field"),q=z.get("icon-image"),ie=(j.value.kind!=="constant"||j.value.value instanceof Ie&&!j.value.value.isEmpty()||j.value.value.toString().length>0)&&(F.value.kind!=="constant"||F.value.value.length>0),Ae=q.value.kind!=="constant"||!!q.value.value||Object.keys(q.parameters).length>0,ce=z.get("symbol-sort-key");if(this.features=[],!ie&&!Ae)return;const pe=p.iconDependencies,me=p.glyphDependencies,ye=p.availableImages,Ne=new Ei(this.zoom);for(const{feature:ze,id:Je,index:lt,sourceLayerIndex:Ke}of A){const st=D._featureFilter.needGeometry,pt=Ah(ze,st);if(!D._featureFilter.filter(Ne,pt,T))continue;let dt,qt;if(st||(pt.geometry=lh(ze)),ie){const $t=D.getValueAndResolveTokens("text-field",pt,T,ye),Nt=Ie.factory($t);JF(Nt)&&(this.hasRTLText=!0),(!this.hasRTLText||Dl()==="unavailable"||this.hasRTLText&&us.isParsed())&&(dt=SF(Nt,D,pt))}if(Ae){const $t=D.getValueAndResolveTokens("icon-image",pt,T,ye);qt=$t instanceof ke?$t:ke.fromString($t)}if(!dt&&!qt)continue;const en=this.sortFeaturesByKey?ce.evaluate(pt,{},T):void 0;if(this.features.push({id:Je,text:dt,icon:qt,index:lt,sourceLayerIndex:Ke,geometry:pt.geometry,properties:ze.properties,type:XF[ze.type],sortKey:en}),qt&&(pe[qt.name]=!0),dt){const $t=F.evaluate(pt,{},T).join(","),Nt=z.get("text-rotation-alignment")!=="viewport"&&z.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.WritingMode.vertical)>=0;for(const zt of dt.sections)if(zt.image)pe[zt.image.name]=!0;else{const Ht=mA(dt.toString()),Gt=zt.fontStack||$t,Tt=me[Gt]=me[Gt]||{};this.calculateGlyphDependencies(zt.text,Tt,Nt,this.allowVerticalPlacement,Ht)}}}z.get("symbol-placement")==="line"&&(this.features=function(ze){const Je={},lt={},Ke=[];let st=0;function pt($t){Ke.push(ze[$t]),st++}function dt($t,Nt,zt){const Ht=lt[$t];return delete lt[$t],lt[Nt]=Ht,Ke[Ht].geometry[0].pop(),Ke[Ht].geometry[0]=Ke[Ht].geometry[0].concat(zt[0]),Ht}function qt($t,Nt,zt){const Ht=Je[Nt];return delete Je[Nt],Je[$t]=Ht,Ke[Ht].geometry[0].shift(),Ke[Ht].geometry[0]=zt[0].concat(Ke[Ht].geometry[0]),Ht}function en($t,Nt,zt){const Ht=zt?Nt[0][Nt[0].length-1]:Nt[0][0];return`${$t}:${Ht.x}:${Ht.y}`}for(let $t=0;$t<ze.length;$t++){const Nt=ze[$t],zt=Nt.geometry,Ht=Nt.text?Nt.text.toString():null;if(!Ht){pt($t);continue}const Gt=en(Ht,zt),Tt=en(Ht,zt,!0);if(Gt in lt&&Tt in Je&&lt[Gt]!==Je[Tt]){const pn=qt(Gt,Tt,zt),an=dt(Gt,Tt,Ke[pn].geometry);delete Je[Gt],delete lt[Tt],lt[en(Ht,Ke[an].geometry,!0)]=an,Ke[pn].geometry=null}else Gt in lt?dt(Gt,Tt,zt):Tt in Je?qt(Gt,Tt,zt):(pt($t),Je[Gt]=st-1,lt[Tt]=st-1)}return Ke.filter($t=>$t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ze,Je)=>ze.sortKey-Je.sortKey)}update(A,p,T){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(A,p,this.layers,T),this.icon.programConfigurations.updatePaintArrays(A,p,this.layers,T))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(A){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(A),this.iconCollisionBox.upload(A)),this.text.upload(A,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(A,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(A,p){const T=this.lineVertexArray.length;if(A.segment!==void 0){let D=A.dist(p[A.segment+1]),z=A.dist(p[A.segment]);const F={};for(let j=A.segment+1;j<p.length;j++)F[j]={x:p[j].x,y:p[j].y,tileUnitDistanceFromAnchor:D},j<p.length-1&&(D+=p[j+1].dist(p[j]));for(let j=A.segment||0;j>=0;j--)F[j]={x:p[j].x,y:p[j].y,tileUnitDistanceFromAnchor:z},j>0&&(z+=p[j-1].dist(p[j]));for(let j=0;j<p.length;j++){const q=F[j];this.lineVertexArray.emplaceBack(q.x,q.y,q.tileUnitDistanceFromAnchor)}}return{lineStartIndex:T,lineLength:this.lineVertexArray.length-T}}addSymbols(A,p,T,D,z,F,j,q,ie,Ae,ce,pe){const me=A.indexArray,ye=A.layoutVertexArray,Ne=A.segments.prepareSegment(4*p.length,ye,me,this.canOverlap?F.sortKey:void 0),ze=this.glyphOffsetArray.length,Je=Ne.vertexLength,lt=this.allowVerticalPlacement&&j===a.WritingMode.vertical?Math.PI/2:0,Ke=F.text&&F.text.sections;for(let st=0;st<p.length;st++){const{tl:pt,tr:dt,bl:qt,br:en,tex:$t,pixelOffsetTL:Nt,pixelOffsetBR:zt,minFontScaleX:Ht,minFontScaleY:Gt,glyphOffset:Tt,isSDF:pn,sectionIndex:an}=p[st],jn=Ne.vertexLength,Oi=Tt[1];Tm(ye,q.x,q.y,pt.x,Oi+pt.y,$t.x,$t.y,T,pn,Nt.x,Nt.y,Ht,Gt),Tm(ye,q.x,q.y,dt.x,Oi+dt.y,$t.x+$t.w,$t.y,T,pn,zt.x,Nt.y,Ht,Gt),Tm(ye,q.x,q.y,qt.x,Oi+qt.y,$t.x,$t.y+$t.h,T,pn,Nt.x,zt.y,Ht,Gt),Tm(ye,q.x,q.y,en.x,Oi+en.y,$t.x+$t.w,$t.y+$t.h,T,pn,zt.x,zt.y,Ht,Gt),Ev(A.dynamicLayoutVertexArray,q,lt),me.emplaceBack(jn,jn+1,jn+2),me.emplaceBack(jn+1,jn+2,jn+3),Ne.vertexLength+=4,Ne.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Tt[0]),st!==p.length-1&&an===p[st+1].sectionIndex||A.programConfigurations.populatePaintArrays(ye.length,F,F.index,{},pe,Ke&&Ke[an])}A.placedSymbolArray.emplaceBack(q.x,q.y,ze,this.glyphOffsetArray.length-ze,Je,ie,Ae,q.segment,T?T[0]:0,T?T[1]:0,D[0],D[1],j,0,!1,0,ce)}_addCollisionDebugVertex(A,p,T,D,z,F){return p.emplaceBack(0,0),A.emplaceBack(T.x,T.y,D,z,Math.round(F.x),Math.round(F.y))}addCollisionDebugVertices(A,p,T,D,z,F,j){const q=z.segments.prepareSegment(4,z.layoutVertexArray,z.indexArray),ie=q.vertexLength,Ae=z.layoutVertexArray,ce=z.collisionVertexArray,pe=j.anchorX,me=j.anchorY;this._addCollisionDebugVertex(Ae,ce,F,pe,me,new Et(A,p)),this._addCollisionDebugVertex(Ae,ce,F,pe,me,new Et(T,p)),this._addCollisionDebugVertex(Ae,ce,F,pe,me,new Et(T,D)),this._addCollisionDebugVertex(Ae,ce,F,pe,me,new Et(A,D)),q.vertexLength+=4;const ye=z.indexArray;ye.emplaceBack(ie,ie+1),ye.emplaceBack(ie+1,ie+2),ye.emplaceBack(ie+2,ie+3),ye.emplaceBack(ie+3,ie),q.primitiveLength+=4}addDebugCollisionBoxes(A,p,T,D){for(let z=A;z<p;z++){const F=this.collisionBoxArray.get(z);this.addCollisionDebugVertices(F.x1,F.y1,F.x2,F.y2,D?this.textCollisionBox:this.iconCollisionBox,F.anchorPoint,T)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Sv(At,f4.members,Xe),this.iconCollisionBox=new Sv(At,f4.members,Xe);for(let A=0;A<this.symbolInstances.length;A++){const p=this.symbolInstances.get(A);this.addDebugCollisionBoxes(p.textBoxStartIndex,p.textBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.iconBoxStartIndex,p.iconBoxEndIndex,p,!1),this.addDebugCollisionBoxes(p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p,!1)}}_deserializeCollisionBoxesForSymbol(A,p,T,D,z,F,j,q,ie){const Ae={};for(let ce=p;ce<T;ce++){const pe=A.get(ce);Ae.textBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.textFeatureIndex=pe.featureIndex;break}for(let ce=D;ce<z;ce++){const pe=A.get(ce);Ae.verticalTextBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.verticalTextFeatureIndex=pe.featureIndex;break}for(let ce=F;ce<j;ce++){const pe=A.get(ce);Ae.iconBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.iconFeatureIndex=pe.featureIndex;break}for(let ce=q;ce<ie;ce++){const pe=A.get(ce);Ae.verticalIconBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.verticalIconFeatureIndex=pe.featureIndex;break}return Ae}deserializeCollisionBoxes(A){this.collisionArrays=[];for(let p=0;p<this.symbolInstances.length;p++){const T=this.symbolInstances.get(p);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(A,T.textBoxStartIndex,T.textBoxEndIndex,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T.iconBoxStartIndex,T.iconBoxEndIndex,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(A,p){const T=A.placedSymbolArray.get(p),D=T.vertexStartIndex+4*T.numGlyphs;for(let z=T.vertexStartIndex;z<D;z+=4)A.indexArray.emplaceBack(z,z+1,z+2),A.indexArray.emplaceBack(z+1,z+2,z+3)}getSortedSymbolIndexes(A){if(this.sortedAngle===A&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const p=Math.sin(A),T=Math.cos(A),D=[],z=[],F=[];for(let j=0;j<this.symbolInstances.length;++j){F.push(j);const q=this.symbolInstances.get(j);D.push(0|Math.round(p*q.anchorX+T*q.anchorY)),z.push(q.featureIndex)}return F.sort((j,q)=>D[j]-D[q]||z[q]-z[j]),F}addToSortKeyRanges(A,p){const T=this.sortKeyRanges[this.sortKeyRanges.length-1];T&&T.sortKey===p?T.symbolInstanceEnd=A+1:this.sortKeyRanges.push({sortKey:p,symbolInstanceStart:A,symbolInstanceEnd:A+1})}sortFeatures(A){if(this.sortFeaturesByY&&this.sortedAngle!==A&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(A),this.sortedAngle=A,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const p of this.symbolInstanceIndexes){const T=this.symbolInstances.get(p);this.featureSortOrder.push(T.featureIndex),[T.rightJustifiedTextSymbolIndex,T.centerJustifiedTextSymbolIndex,T.leftJustifiedTextSymbolIndex].forEach((D,z,F)=>{D>=0&&F.indexOf(D)===z&&this.addIndicesForPlacedSymbol(this.text,D)}),T.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,T.verticalPlacedTextSymbolIndex),T.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.placedIconSymbolIndex),T.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ft("SymbolBucket",E0,{omit:["layers","collisionBoxArray","features","compareText"]}),E0.MAX_GLYPHS=65535,E0.addDynamicAttributes=Ev;const eN=new Ui({"symbol-placement":new Zt(ut.layout_symbol["symbol-placement"]),"symbol-spacing":new Zt(ut.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Zt(ut.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Yt(ut.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Zt(ut.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Zt(ut.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Zt(ut.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Zt(ut.layout_symbol["icon-ignore-placement"]),"icon-optional":new Zt(ut.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Zt(ut.layout_symbol["icon-rotation-alignment"]),"icon-size":new Yt(ut.layout_symbol["icon-size"]),"icon-text-fit":new Zt(ut.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Zt(ut.layout_symbol["icon-text-fit-padding"]),"icon-image":new Yt(ut.layout_symbol["icon-image"]),"icon-rotate":new Yt(ut.layout_symbol["icon-rotate"]),"icon-padding":new Yt(ut.layout_symbol["icon-padding"]),"icon-keep-upright":new Zt(ut.layout_symbol["icon-keep-upright"]),"icon-offset":new Yt(ut.layout_symbol["icon-offset"]),"icon-anchor":new Yt(ut.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Zt(ut.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Zt(ut.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Zt(ut.layout_symbol["text-rotation-alignment"]),"text-field":new Yt(ut.layout_symbol["text-field"]),"text-font":new Yt(ut.layout_symbol["text-font"]),"text-size":new Yt(ut.layout_symbol["text-size"]),"text-max-width":new Yt(ut.layout_symbol["text-max-width"]),"text-line-height":new Zt(ut.layout_symbol["text-line-height"]),"text-letter-spacing":new Yt(ut.layout_symbol["text-letter-spacing"]),"text-justify":new Yt(ut.layout_symbol["text-justify"]),"text-radial-offset":new Yt(ut.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Zt(ut.layout_symbol["text-variable-anchor"]),"text-anchor":new Yt(ut.layout_symbol["text-anchor"]),"text-max-angle":new Zt(ut.layout_symbol["text-max-angle"]),"text-writing-mode":new Zt(ut.layout_symbol["text-writing-mode"]),"text-rotate":new Yt(ut.layout_symbol["text-rotate"]),"text-padding":new Zt(ut.layout_symbol["text-padding"]),"text-keep-upright":new Zt(ut.layout_symbol["text-keep-upright"]),"text-transform":new Yt(ut.layout_symbol["text-transform"]),"text-offset":new Yt(ut.layout_symbol["text-offset"]),"text-allow-overlap":new Zt(ut.layout_symbol["text-allow-overlap"]),"text-overlap":new Zt(ut.layout_symbol["text-overlap"]),"text-ignore-placement":new Zt(ut.layout_symbol["text-ignore-placement"]),"text-optional":new Zt(ut.layout_symbol["text-optional"])});var Mv={paint:new Ui({"icon-opacity":new Yt(ut.paint_symbol["icon-opacity"]),"icon-color":new Yt(ut.paint_symbol["icon-color"]),"icon-halo-color":new Yt(ut.paint_symbol["icon-halo-color"]),"icon-halo-width":new Yt(ut.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Yt(ut.paint_symbol["icon-halo-blur"]),"icon-translate":new Zt(ut.paint_symbol["icon-translate"]),"icon-translate-anchor":new Zt(ut.paint_symbol["icon-translate-anchor"]),"text-opacity":new Yt(ut.paint_symbol["text-opacity"]),"text-color":new Yt(ut.paint_symbol["text-color"],{runtimeType:Ii,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new Yt(ut.paint_symbol["text-halo-color"]),"text-halo-width":new Yt(ut.paint_symbol["text-halo-width"]),"text-halo-blur":new Yt(ut.paint_symbol["text-halo-blur"]),"text-translate":new Zt(ut.paint_symbol["text-translate"]),"text-translate-anchor":new Zt(ut.paint_symbol["text-translate-anchor"])}),layout:eN};class N4{constructor(A){if(A.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=A.property.overrides?A.property.overrides.runtimeType:rs,this.defaultValue=A}evaluate(A){if(A.formattedSection){const p=this.defaultValue.property.overrides;if(p&&p.hasOverride(A.formattedSection))return p.getOverride(A.formattedSection)}return A.feature&&A.featureState?this.defaultValue.evaluate(A.feature,A.featureState):this.defaultValue.property.specification.default}eachChild(A){this.defaultValue.isConstant()||A(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ft("FormatSectionOverride",N4,{omit:["defaultValue"]});class Sm extends Es{constructor(A){super(A,Mv)}recalculate(A,p){if(super.recalculate(A,p),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const T=this.layout.get("text-writing-mode");if(T){const D=[];for(const z of T)D.indexOf(z)<0&&D.push(z);this.layout._values["text-writing-mode"]=D}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(A,p,T,D){const z=this.layout.get(A).evaluate(p,{},T,D),F=this._unevaluatedLayout._values[A];return F.isDataDriven()||Tl(F.value)||!z?z:function(j,q){return q.replace(/{([^{}]+)}/g,(ie,Ae)=>Ae in j?String(j[Ae]):"")}(p.properties,z)}createBucket(A){return new E0(A)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const A of Mv.paint.overridableProperties){if(!Sm.hasPaintOverride(this.layout,A))continue;const p=this.paint.get(A),T=new N4(p),D=new Ns(T,p.property.specification);let z=null;z=p.value.kind==="constant"||p.value.kind==="source"?new da("source",D):new Sl("composite",D,p.value.zoomStops),this.paint._values[A]=new gi(p.property,z,p.parameters)}}_handleOverridablePaintPropertyUpdate(A,p,T){return!(!this.layout||p.isDataDriven()||T.isDataDriven())&&Sm.hasPaintOverride(this.layout,A)}static hasPaintOverride(A,p){const T=A.get("text-field"),D=Mv.paint.properties[p];let z=!1;const F=j=>{for(const q of j)if(D.overrides&&D.overrides.hasOverride(q))return void(z=!0)};if(T.value.kind==="constant"&&T.value.value instanceof Ie)F(T.value.value.sections);else if(T.value.kind==="source"){const j=ie=>{z||(ie instanceof Lt&&$e(ie.value)===$i?F(ie.value.sections):ie instanceof dA?F(ie.sections):ie.eachChild(j))},q=T.value;q._styleExpression&&j(q._styleExpression.expression)}return z}}function Cv(f,A,p){let T="never";const D=f.get(A);return D?T=D:f.get(p)&&(T="always"),T}var tN={paint:new Ui({"background-color":new Zt(ut.paint_background["background-color"]),"background-pattern":new Zr(ut.paint_background["background-pattern"]),"background-opacity":new Zt(ut.paint_background["background-opacity"])})},nN={paint:new Ui({"raster-opacity":new Zt(ut.paint_raster["raster-opacity"]),"raster-hue-rotate":new Zt(ut.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Zt(ut.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Zt(ut.paint_raster["raster-brightness-max"]),"raster-saturation":new Zt(ut.paint_raster["raster-saturation"]),"raster-contrast":new Zt(ut.paint_raster["raster-contrast"]),"raster-resampling":new Zt(ut.paint_raster["raster-resampling"]),"raster-fade-duration":new Zt(ut.paint_raster["raster-fade-duration"])})};class iN extends Es{constructor(A){super(A,{}),this.onAdd=p=>{this.implementation.onAdd&&this.implementation.onAdd(p,p.painter.context.gl)},this.onRemove=p=>{this.implementation.onRemove&&this.implementation.onRemove(p,p.painter.context.gl)},this.implementation=A}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const rN={circle:class extends Es{constructor(f){super(f,B7)}createBucket(f){return new tv(f)}queryRadius(f){const A=f;return vd("circle-radius",this,A)+vd("circle-stroke-width",this,A)+Am(this.paint.get("circle-translate"))}queryIntersectsFeature(f,A,p,T,D,z,F,j){const q=um(f,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),z.angle,F),ie=this.paint.get("circle-radius").evaluate(A,p)+this.paint.get("circle-stroke-width").evaluate(A,p),Ae=this.paint.get("circle-pitch-alignment")==="map",ce=Ae?q:function(me,ye){return me.map(Ne=>YS(Ne,ye))}(q,j),pe=Ae?ie*F:ie;for(const me of T)for(const ye of me){const Ne=Ae?ye:YS(ye,j);let ze=pe;const Je=cm([],[ye.x,ye.y,0,1],j);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ze*=Je[3]/z.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ze*=z.cameraToCenterDistance/Je[3]),I7(ce,Ne,ze))return!0}return!1}},heatmap:class extends Es{constructor(f){super(f,O7),this._updateColorRamp()}createBucket(f){return new XS(f)}_handleSpecialPaintPropertyUpdate(f){f==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=JS({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Es{constructor(f){super(f,F7)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Es{constructor(f){super(f,eF)}recalculate(f,A){super.recalculate(f,A);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(f){return new fv(f)}queryRadius(){return Am(this.paint.get("fill-translate"))}queryIntersectsFeature(f,A,p,T,D,z,F){return GS(um(f,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),z.angle,F),T)}isTileClipped(){return!0}},"fill-extrusion":class extends Es{constructor(f){super(f,dF)}createBucket(f){return new pv(f)}queryRadius(){return Am(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(f,A,p,T,D,z,F,j){const q=um(f,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),z.angle,F),ie=this.paint.get("fill-extrusion-height").evaluate(A,p),Ae=this.paint.get("fill-extrusion-base").evaluate(A,p),ce=function(me,ye,Ne,ze){const Je=[];for(const lt of me){const Ke=[lt.x,lt.y,0,1];cm(Ke,Ke,ye),Je.push(new Et(Ke[0]/Ke[3],Ke[1]/Ke[3]))}return Je}(q,j),pe=function(me,ye,Ne,ze){const Je=[],lt=[],Ke=ze[8]*ye,st=ze[9]*ye,pt=ze[10]*ye,dt=ze[11]*ye,qt=ze[8]*Ne,en=ze[9]*Ne,$t=ze[10]*Ne,Nt=ze[11]*Ne;for(const zt of me){const Ht=[],Gt=[];for(const Tt of zt){const pn=Tt.x,an=Tt.y,jn=ze[0]*pn+ze[4]*an+ze[12],Oi=ze[1]*pn+ze[5]*an+ze[13],Gi=ze[2]*pn+ze[6]*an+ze[14],Br=ze[3]*pn+ze[7]*an+ze[15],wa=Gi+pt,cs=Br+dt,br=jn+qt,$r=Oi+en,hs=Gi+$t,Ts=Br+Nt,wo=new Et((jn+Ke)/cs,(Oi+st)/cs);wo.z=wa/cs,Ht.push(wo);const Er=new Et(br/Ts,$r/Ts);Er.z=hs/Ts,Gt.push(Er)}Je.push(Ht),lt.push(Gt)}return[Je,lt]}(T,Ae,ie,j);return function(me,ye,Ne){let ze=1/0;GS(Ne,ye)&&(ze=l4(Ne,ye[0]));for(let Je=0;Je<ye.length;Je++){const lt=ye[Je],Ke=me[Je];for(let st=0;st<lt.length-1;st++){const pt=lt[st],dt=[pt,lt[st+1],Ke[st+1],Ke[st],pt];VS(Ne,dt)&&(ze=Math.min(ze,l4(Ne,dt)))}}return ze!==1/0&&ze}(pe[0],pe[1],ce)}},line:class extends Es{constructor(f){super(f,u4),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(f){f==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Pi,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(f,A){super.recalculate(f,A),this.paint._values["line-floorwidth"]=c4.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,f)}createBucket(f){return new gv(f)}queryRadius(f){const A=f,p=h4(vd("line-width",this,A),vd("line-gap-width",this,A)),T=vd("line-offset",this,A);return p/2+Math.abs(T)+Am(this.paint.get("line-translate"))}queryIntersectsFeature(f,A,p,T,D,z,F){const j=um(f,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),z.angle,F),q=F/2*h4(this.paint.get("line-width").evaluate(A,p),this.paint.get("line-gap-width").evaluate(A,p)),ie=this.paint.get("line-offset").evaluate(A,p);return ie&&(T=function(Ae,ce){const pe=[];for(let me=0;me<Ae.length;me++){const ye=Ae[me],Ne=[];for(let ze=0;ze<ye.length;ze++){const Je=ye[ze-1],lt=ye[ze],Ke=ye[ze+1],st=ze===0?new Et(0,0):lt.sub(Je)._unit()._perp(),pt=ze===ye.length-1?new Et(0,0):Ke.sub(lt)._unit()._perp(),dt=st._add(pt)._unit(),qt=dt.x*pt.x+dt.y*pt.y;qt!==0&&dt._mult(1/qt),Ne.push(dt._mult(ce)._add(lt))}pe.push(Ne)}return pe}(T,ie*F)),function(Ae,ce,pe){for(let me=0;me<ce.length;me++){const ye=ce[me];if(Ae.length>=3){for(let Ne=0;Ne<ye.length;Ne++)if(m0(Ae,ye[Ne]))return!0}if(k7(Ae,ye,pe))return!0}return!1}(j,T,q)}isTileClipped(){return!0}},symbol:Sm,background:class extends Es{constructor(f){super(f,tN)}},raster:class extends Es{constructor(f){super(f,nN)}}};class sN{constructor(A){this._callback=A,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const U4=63710088e-1;class Ar{constructor(A,p){if(isNaN(A)||isNaN(p))throw new Error(`Invalid LngLat object: (${A}, ${p})`);if(this.lng=+A,this.lat=+p,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ar(U(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(A){const p=Math.PI/180,T=this.lat*p,D=A.lat*p,z=Math.sin(T)*Math.sin(D)+Math.cos(T)*Math.cos(D)*Math.cos((A.lng-this.lng)*p);return U4*Math.acos(Math.min(z,1))}toBounds(A=0){const p=360*A/40075017,T=p/Math.cos(Math.PI/180*this.lat);return new ch(new Ar(this.lng-T,this.lat-p),new Ar(this.lng+T,this.lat+p))}static convert(A){if(A instanceof Ar)return A;if(Array.isArray(A)&&(A.length===2||A.length===3))return new Ar(Number(A[0]),Number(A[1]));if(!Array.isArray(A)&&typeof A=="object"&&A!==null)return new Ar(Number("lng"in A?A.lng:A.lon),Number(A.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ch{constructor(A,p){A&&(p?this.setSouthWest(A).setNorthEast(p):A.length===4?this.setSouthWest([A[0],A[1]]).setNorthEast([A[2],A[3]]):this.setSouthWest(A[0]).setNorthEast(A[1]))}setNorthEast(A){return this._ne=A instanceof Ar?new Ar(A.lng,A.lat):Ar.convert(A),this}setSouthWest(A){return this._sw=A instanceof Ar?new Ar(A.lng,A.lat):Ar.convert(A),this}extend(A){const p=this._sw,T=this._ne;let D,z;if(A instanceof Ar)D=A,z=A;else{if(!(A instanceof ch))return Array.isArray(A)?A.length===4||A.every(Array.isArray)?this.extend(ch.convert(A)):this.extend(Ar.convert(A)):this;if(D=A._sw,z=A._ne,!D||!z)return this}return p||T?(p.lng=Math.min(D.lng,p.lng),p.lat=Math.min(D.lat,p.lat),T.lng=Math.max(z.lng,T.lng),T.lat=Math.max(z.lat,T.lat)):(this._sw=new Ar(D.lng,D.lat),this._ne=new Ar(z.lng,z.lat)),this}getCenter(){return new Ar((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ar(this.getWest(),this.getNorth())}getSouthEast(){return new Ar(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(A){const{lng:p,lat:T}=Ar.convert(A);let D=this._sw.lng<=p&&p<=this._ne.lng;return this._sw.lng>this._ne.lng&&(D=this._sw.lng>=p&&p>=this._ne.lng),this._sw.lat<=T&&T<=this._ne.lat&&D}static convert(A){return A instanceof ch?A:A&&new ch(A)}}const V4=2*Math.PI*U4;function G4(f){return V4*Math.cos(f*Math.PI/180)}function j4(f){return(180+f)/360}function $4(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function H4(f,A){return f/G4(A)}function Pv(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}class Mm{constructor(A,p,T=0){this.x=+A,this.y=+p,this.z=+T}static fromLngLat(A,p=0){const T=Ar.convert(A);return new Mm(j4(T.lng),$4(T.lat),H4(p,T.lat))}toLngLat(){return new Ar(360*this.x-180,Pv(this.y))}toAltitude(){return this.z*G4(Pv(this.y))}meterInMercatorCoordinateUnits(){return 1/V4*(A=Pv(this.y),1/Math.cos(A*Math.PI/180));var A}}function W4(f,A,p){var T=2*Math.PI*6378137/256/Math.pow(2,p);return[f*T-2*Math.PI*6378137/2,A*T-2*Math.PI*6378137/2]}class Iv{constructor(A,p,T){if(A<0||A>25||T<0||T>=Math.pow(2,A)||p<0||p>=Math.pow(2,A))throw new Error(`x=${p}, y=${T}, z=${A} outside of bounds. 0<=x<${Math.pow(2,A)}, 0<=y<${Math.pow(2,A)} 0<=z<=25 `);this.z=A,this.x=p,this.y=T,this.key=kd(0,A,A,p,T)}equals(A){return this.z===A.z&&this.x===A.x&&this.y===A.y}url(A,p,T){const D=(F=this.y,j=this.z,q=W4(256*(z=this.x),256*(F=Math.pow(2,j)-F-1),j),ie=W4(256*(z+1),256*(F+1),j),q[0]+","+q[1]+","+ie[0]+","+ie[1]);var z,F,j,q,ie;const Ae=function(ce,pe,me){let ye,Ne="";for(let ze=ce;ze>0;ze--)ye=1<<ze-1,Ne+=(pe&ye?1:0)+(me&ye?2:0);return Ne}(this.z,this.x,this.y);return A[(this.x+this.y)%A.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(T==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,p>1?"@2x":"").replace(/{quadkey}/g,Ae).replace(/{bbox-epsg-3857}/g,D)}isChildOf(A){const p=this.z-A.z;return p>0&&A.x===this.x>>p&&A.y===this.y>>p}getTilePoint(A){const p=Math.pow(2,this.z);return new Et((A.x*p-this.x)*Rr,(A.y*p-this.y)*Rr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Q4{constructor(A,p){this.wrap=A,this.canonical=p,this.key=kd(A,p.z,p.z,p.x,p.y)}}class xa{constructor(A,p,T,D,z){if(A<T)throw new Error(`overscaledZ should be >= z; overscaledZ = ${A}; z = ${T}`);this.overscaledZ=A,this.wrap=p,this.canonical=new Iv(T,+D,+z),this.key=kd(p,A,T,D,z)}clone(){return new xa(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(A){return this.overscaledZ===A.overscaledZ&&this.wrap===A.wrap&&this.canonical.equals(A.canonical)}scaledTo(A){if(A>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${A}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-A;return A>this.canonical.z?new xa(A,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new xa(A,this.wrap,A,this.canonical.x>>p,this.canonical.y>>p)}calculateScaledKey(A,p){if(A>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${A}; overscaledZ = ${this.overscaledZ}`);const T=this.canonical.z-A;return A>this.canonical.z?kd(this.wrap*+p,A,this.canonical.z,this.canonical.x,this.canonical.y):kd(this.wrap*+p,A,A,this.canonical.x>>T,this.canonical.y>>T)}isChildOf(A){if(A.wrap!==this.wrap)return!1;const p=this.canonical.z-A.canonical.z;return A.overscaledZ===0||A.overscaledZ<this.overscaledZ&&A.canonical.x===this.canonical.x>>p&&A.canonical.y===this.canonical.y>>p}children(A){if(this.overscaledZ>=A)return[new xa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const p=this.canonical.z+1,T=2*this.canonical.x,D=2*this.canonical.y;return[new xa(p,this.wrap,p,T,D),new xa(p,this.wrap,p,T+1,D),new xa(p,this.wrap,p,T,D+1),new xa(p,this.wrap,p,T+1,D+1)]}isLessThan(A){return this.wrap<A.wrap||!(this.wrap>A.wrap)&&(this.overscaledZ<A.overscaledZ||!(this.overscaledZ>A.overscaledZ)&&(this.canonical.x<A.canonical.x||!(this.canonical.x>A.canonical.x)&&this.canonical.y<A.canonical.y))}wrapped(){return new xa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(A){return new xa(this.overscaledZ,A,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Q4(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(A){return this.canonical.getTilePoint(new Mm(A.x-this.wrap,A.y))}}function kd(f,A,p,T,D){(f*=2)<0&&(f=-1*f-1);const z=1<<p;return(z*z*f+z*D+T).toString(36)+p.toString(36)+A.toString(36)}Ft("CanonicalTileID",Iv),Ft("OverscaledTileID",xa,{omit:["posMatrix"]});class q4{constructor(A,p,T){if(this.uid=A,p.height!==p.width)throw new RangeError("DEM tiles must be square");if(T&&T!=="mapbox"&&T!=="terrarium")return void ve(`"${T}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=p.height;const D=this.dim=p.height-2;this.data=new Uint32Array(p.data.buffer),this.encoding=T||"mapbox";for(let z=0;z<D;z++)this.data[this._idx(-1,z)]=this.data[this._idx(0,z)],this.data[this._idx(D,z)]=this.data[this._idx(D-1,z)],this.data[this._idx(z,-1)]=this.data[this._idx(z,0)],this.data[this._idx(z,D)]=this.data[this._idx(z,D-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(D,-1)]=this.data[this._idx(D-1,0)],this.data[this._idx(-1,D)]=this.data[this._idx(0,D-1)],this.data[this._idx(D,D)]=this.data[this._idx(D-1,D-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let z=0;z<D;z++)for(let F=0;F<D;F++){const j=this.get(z,F);j>this.max&&(this.max=j),j<this.min&&(this.min=j)}}get(A,p){const T=new Uint8Array(this.data.buffer),D=4*this._idx(A,p);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(T[D],T[D+1],T[D+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(A,p){if(A<-1||A>=this.dim+1||p<-1||p>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(p+1)*this.stride+(A+1)}_unpackMapbox(A,p,T){return(256*A*256+256*p+T)/10-1e4}_unpackTerrarium(A,p,T){return 256*A+p+T/256-32768}getPixels(){return new va({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(A,p,T){if(this.dim!==A.dim)throw new Error("dem dimension mismatch");let D=p*this.dim,z=p*this.dim+this.dim,F=T*this.dim,j=T*this.dim+this.dim;switch(p){case-1:D=z-1;break;case 1:z=D+1}switch(T){case-1:F=j-1;break;case 1:j=F+1}const q=-p*this.dim,ie=-T*this.dim;for(let Ae=F;Ae<j;Ae++)for(let ce=D;ce<z;ce++)this.data[this._idx(ce,Ae)]=A.data[this._idx(ce+q,Ae+ie)]}}Ft("DEMData",q4);class Z4{constructor(A){this._stringToNumber={},this._numberToString=[];for(let p=0;p<A.length;p++){const T=A[p];this._stringToNumber[T]=p,this._numberToString[p]=T}}encode(A){return this._stringToNumber[A]}decode(A){if(A>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${A} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[A]}}class Y4{constructor(A,p,T,D,z){this.type="Feature",this._vectorTileFeature=A,A._z=p,A._x=T,A._y=D,this.properties=A.properties,this.id=z}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(A){this._geometry=A}toJSON(){const A={geometry:this.geometry};for(const p in this)p!=="_geometry"&&p!=="_vectorTileFeature"&&(A[p]=this[p]);return A}}class X4{constructor(A,p){this.tileID=A,this.x=A.canonical.x,this.y=A.canonical.y,this.z=A.canonical.z,this.grid=new ma(Rr,16,0),this.grid3D=new ma(Rr,16,0),this.featureIndexArray=new O,this.promoteId=p}insert(A,p,T,D,z,F){const j=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(T,D,z);const q=F?this.grid3D:this.grid;for(let ie=0;ie<p.length;ie++){const Ae=p[ie],ce=[1/0,1/0,-1/0,-1/0];for(let pe=0;pe<Ae.length;pe++){const me=Ae[pe];ce[0]=Math.min(ce[0],me.x),ce[1]=Math.min(ce[1],me.y),ce[2]=Math.max(ce[2],me.x),ce[3]=Math.max(ce[3],me.y)}ce[0]<Rr&&ce[1]<Rr&&ce[2]>=0&&ce[3]>=0&&q.insert(j,ce[0],ce[1],ce[2],ce[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new cc.VectorTile(new mv(this.rawTileData)).layers,this.sourceLayerCoder=new Z4(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(A,p,T,D){this.loadVTLayers();const z=A.params||{},F=Rr/A.tileSize/A.scale,j=Us(z.filter),q=A.queryGeometry,ie=A.queryPadding*F,Ae=J4(q),ce=this.grid.query(Ae.minX-ie,Ae.minY-ie,Ae.maxX+ie,Ae.maxY+ie),pe=J4(A.cameraQueryGeometry),me=this.grid3D.query(pe.minX-ie,pe.minY-ie,pe.maxX+ie,pe.maxY+ie,(ze,Je,lt,Ke)=>function(st,pt,dt,qt,en){for(const Nt of st)if(pt<=Nt.x&&dt<=Nt.y&&qt>=Nt.x&&en>=Nt.y)return!0;const $t=[new Et(pt,dt),new Et(pt,en),new Et(qt,en),new Et(qt,dt)];if(st.length>2){for(const Nt of $t)if(m0(st,Nt))return!0}for(let Nt=0;Nt<st.length-1;Nt++)if(D7(st[Nt],st[Nt+1],$t))return!0;return!1}(A.cameraQueryGeometry,ze-ie,Je-ie,lt+ie,Ke+ie));for(const ze of me)ce.push(ze);ce.sort(oN);const ye={};let Ne;for(let ze=0;ze<ce.length;ze++){const Je=ce[ze];if(Je===Ne)continue;Ne=Je;const lt=this.featureIndexArray.get(Je);let Ke=null;this.loadMatchingFeature(ye,lt.bucketIndex,lt.sourceLayerIndex,lt.featureIndex,j,z.layers,z.availableImages,p,T,D,(st,pt,dt)=>(Ke||(Ke=lh(st)),pt.queryIntersectsFeature(q,st,dt,Ke,this.z,A.transform,F,A.pixelPosMatrix)))}return ye}loadMatchingFeature(A,p,T,D,z,F,j,q,ie,Ae,ce){const pe=this.bucketLayerIDs[p];if(F&&!function(ze,Je){for(let lt=0;lt<ze.length;lt++)if(Je.indexOf(ze[lt])>=0)return!0;return!1}(F,pe))return;const me=this.sourceLayerCoder.decode(T),ye=this.vtLayers[me].feature(D);if(z.needGeometry){const ze=Ah(ye,!0);if(!z.filter(new Ei(this.tileID.overscaledZ),ze,this.tileID.canonical))return}else if(!z.filter(new Ei(this.tileID.overscaledZ),ye))return;const Ne=this.getId(ye,me);for(let ze=0;ze<pe.length;ze++){const Je=pe[ze];if(F&&F.indexOf(Je)<0)continue;const lt=q[Je];if(!lt)continue;let Ke={};Ne&&Ae&&(Ke=Ae.getState(lt.sourceLayer||"_geojsonTileLayer",Ne));const st=Q({},ie[Je]);st.paint=K4(st.paint,lt.paint,ye,Ke,j),st.layout=K4(st.layout,lt.layout,ye,Ke,j);const pt=!ce||ce(ye,lt,Ke);if(!pt)continue;const dt=new Y4(ye,this.z,this.x,this.y,Ne);dt.layer=st;let qt=A[Je];qt===void 0&&(qt=A[Je]=[]),qt.push({featureIndex:D,feature:dt,intersectionZ:pt})}}lookupSymbolFeatures(A,p,T,D,z,F,j,q){const ie={};this.loadVTLayers();const Ae=Us(z);for(const ce of A)this.loadMatchingFeature(ie,T,D,ce,Ae,F,j,q,p);return ie}hasLayer(A){for(const p of this.bucketLayerIDs)for(const T of p)if(A===T)return!0;return!1}getId(A,p){let T=A.id;return this.promoteId&&(T=A.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[p]],typeof T=="boolean"&&(T=Number(T))),T}}function K4(f,A,p,T,D){return Y(f,(z,F)=>{const j=A instanceof Bl?A.get(F):null;return j&&j.evaluate?j.evaluate(p,T,D):j})}function J4(f){let A=1/0,p=1/0,T=-1/0,D=-1/0;for(const z of f)A=Math.min(A,z.x),p=Math.min(p,z.y),T=Math.max(T,z.x),D=Math.max(D,z.y);return{minX:A,minY:p,maxX:T,maxY:D}}function oN(f,A){return A-f}var kv;Ft("FeatureIndex",X4,{omit:["rawTileData","sourceLayerCoder"]}),a.PerformanceMarkers=void 0,(kv=a.PerformanceMarkers||(a.PerformanceMarkers={})).create="create",kv.load="load",kv.fullLoad="fullLoad";let Cm=null,Ld=[];const Lv=1e3/30,aN={mark(f){performance.mark(f)},frame(f){const A=f;Cm!=null&&Ld.push(A-Cm),Cm=A},clearMetrics(){Cm=null,Ld=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const f in a.PerformanceMarkers)performance.clearMarks(a.PerformanceMarkers[f])},getPerformanceMetrics(){performance.measure("loadTime",a.PerformanceMarkers.create,a.PerformanceMarkers.load),performance.measure("fullLoadTime",a.PerformanceMarkers.create,a.PerformanceMarkers.fullLoad);const f=performance.getEntriesByName("loadTime")[0].duration,A=performance.getEntriesByName("fullLoadTime")[0].duration,p=Ld.length,T=1/(Ld.reduce((z,F)=>z+F,0)/p/1e3),D=Ld.filter(z=>z>Lv).reduce((z,F)=>z+(F-Lv)/Lv,0);return{loadTime:f,fullLoadTime:A,fps:T,percentDroppedFrames:D/(p+D)*100}}};a.AJAXError=ei,a.ARRAY_TYPE=qs,a.Actor=class{constructor(f,A,p){this.target=f,this.parent=A,this.mapId=p,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ae(["receive","process"],this),this.invoker=new sN(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Qe()?f:window}send(f,A,p,T,D=!1){const z=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(this.callbacks[z]=p);const F=Ye(this.globalScope)?void 0:[];return this.target.postMessage({id:z,type:f,hasCallback:!!p,targetMapId:T,mustQueue:D,sourceMapId:this.mapId,data:ya(A,F)},F),{cancel:()=>{p&&delete this.callbacks[z],this.target.postMessage({id:z,type:"<cancel>",targetMapId:T,sourceMapId:this.mapId})}}}receive(f){const A=f.data,p=A.id;if(p&&(!A.targetMapId||this.mapId===A.targetMapId))if(A.type==="<cancel>"){delete this.tasks[p];const T=this.cancelCallbacks[p];delete this.cancelCallbacks[p],T&&T()}else Qe()||A.mustQueue?(this.tasks[p]=A,this.taskQueue.push(p),this.invoker.trigger()):this.processTask(p,A)}process(){if(!this.taskQueue.length)return;const f=this.taskQueue.shift(),A=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),A&&this.processTask(f,A)}processTask(f,A){if(A.type==="<response>"){const p=this.callbacks[f];delete this.callbacks[f],p&&(A.error?p(Qo(A.error)):p(null,Qo(A.data)))}else{let p=!1;const T=Ye(this.globalScope)?void 0:[],D=A.hasCallback?(j,q)=>{p=!0,delete this.cancelCallbacks[f],this.target.postMessage({id:f,type:"<response>",sourceMapId:this.mapId,error:j?ya(j):null,data:ya(q,T)},T)}:j=>{p=!0};let z=null;const F=Qo(A.data);if(this.parent[A.type])z=this.parent[A.type](A.sourceMapId,F,D);else if(this.parent.getWorkerSource){const j=A.type.split(".");z=this.parent.getWorkerSource(A.sourceMapId,j[0],F.source)[j[1]](F,D)}else D(new Error(`Could not find function ${A.type}`));!p&&z&&z.cancel&&(this.cancelCallbacks[f]=z.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.AlphaImage=wd,a.CanonicalTileID=Iv,a.CollisionBoxArray=Ue,a.CollisionCircleLayoutArray=class extends B{},a.Color=o,a.DEMData=q4,a.DataConstantProperty=Zt,a.DictionaryCoder=Z4,a.EXTENT=Rr,a.ErrorEvent=Fo,a.EvaluationParameters=Ei,a.Event=Pr,a.Evented=is,a.FeatureIndex=X4,a.FillBucket=fv,a.FillExtrusionBucket=pv,a.GeoJSONFeature=Y4,a.ImageAtlas=x4,a.ImagePosition=_v,a.LineBucket=gv,a.LineStripIndexArray=class extends _e{},a.LngLat=Ar,a.LngLatBounds=ch,a.MercatorCoordinate=Mm,a.ONE_EM=Yr,a.OverscaledTileID=xa,a.PerformanceUtils=aN,a.PosArray=N,a.Properties=Ui,a.QuadTriangleArray=class extends ${},a.RGBAImage=va,a.RasterBoundsArray=class extends k{},a.RequestPerformance=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return f.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),f}},a.ResourceType=vt,a.SegmentVector=ft,a.SymbolBucket=E0,a.Transitionable=Au,a.TriangleIndexArray=rt,a.Uniform1f=cu,a.Uniform1i=class extends el{constructor(f,A){super(f,A),this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},a.Uniform2f=class extends el{constructor(f,A){super(f,A),this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}},a.Uniform3f=class extends el{constructor(f,A){super(f,A),this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}},a.Uniform4f=p0,a.UniformColor=OS,a.UniformMatrix4f=class extends el{constructor(f,A){super(f,A),this.current=C7}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let A=1;A<16;A++)if(f[A]!==this.current[A]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}},a.UnwrappedTileID=Q4,a.ValidationError=It,a.ZoomHistory=iu,a.add=function(f,A,p){return f[0]=A[0]+p[0],f[1]=A[1]+p[1],f[2]=A[2]+p[2],f},a.addDynamicAttributes=Ev,a.asyncAll=function(f,A,p){if(!f.length)return p(null,[]);let T=f.length;const D=new Array(f.length);let z=null;f.forEach((F,j)=>{A(F,(q,ie)=>{q&&(z=q),D[j]=ie,--T==0&&p(z,D)})})},a.bezier=I,a.bindAll=ae,a.cacheEntryPossiblyAdded=function(f){oi++,oi>Si&&(f.getActor().send("enforceCacheSizeLimit",En),oi=0)},a.clamp=L,a.clearTileCache=function(f){const A=caches.delete(bt);f&&A.catch(f).then(()=>f())},a.clipLine=D4,a.clone=function(f){var A=new qs(16);return A[0]=f[0],A[1]=f[1],A[2]=f[2],A[3]=f[3],A[4]=f[4],A[5]=f[5],A[6]=f[6],A[7]=f[7],A[8]=f[8],A[9]=f[9],A[10]=f[10],A[11]=f[11],A[12]=f[12],A[13]=f[13],A[14]=f[14],A[15]=f[15],A},a.clone$1=re,a.clone$2=function(f){var A=new qs(3);return A[0]=f[0],A[1]=f[1],A[2]=f[2],A},a.collisionCircleLayout=TF,a.config=mt,a.copy=function(f,A){return f[0]=A[0],f[1]=A[1],f[2]=A[2],f[3]=A[3],f[4]=A[4],f[5]=A[5],f[6]=A[6],f[7]=A[7],f[8]=A[8],f[9]=A[9],f[10]=A[10],f[11]=A[11],f[12]=A[12],f[13]=A[13],f[14]=A[14],f[15]=A[15],f},a.create=function(){var f=new qs(16);return qs!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},a.create$1=HS,a.createExpression=Ha,a.createFilter=Us,a.createLayout=Vi,a.createStyleLayer=function(f){return f.type==="custom"?new iN(f):new rN[f.type](f)},a.cross=function(f,A,p){var T=A[0],D=A[1],z=A[2],F=p[0],j=p[1],q=p[2];return f[0]=D*q-z*j,f[1]=z*F-T*q,f[2]=T*j-D*F,f},a.dot=function(f,A){return f[0]*A[0]+f[1]*A[1]+f[2]*A[2]},a.dot$1=function(f,A){return f[0]*A[0]+f[1]*A[1]+f[2]*A[2]+f[3]*A[3]},a.ease=P,a.emitValidationErrors=Ya,a.enforceCacheSizeLimit=function(f){Jn(),Kt&&Kt.then(A=>{A.keys().then(p=>{for(let T=0;T<p.length-f;T++)A.delete(p[T])})})},a.equals=function(f,A){var p=f[0],T=f[1],D=f[2],z=f[3],F=f[4],j=f[5],q=f[6],ie=f[7],Ae=f[8],ce=f[9],pe=f[10],me=f[11],ye=f[12],Ne=f[13],ze=f[14],Je=f[15],lt=A[0],Ke=A[1],st=A[2],pt=A[3],dt=A[4],qt=A[5],en=A[6],$t=A[7],Nt=A[8],zt=A[9],Ht=A[10],Gt=A[11],Tt=A[12],pn=A[13],an=A[14],jn=A[15];return Math.abs(p-lt)<=Qs*Math.max(1,Math.abs(p),Math.abs(lt))&&Math.abs(T-Ke)<=Qs*Math.max(1,Math.abs(T),Math.abs(Ke))&&Math.abs(D-st)<=Qs*Math.max(1,Math.abs(D),Math.abs(st))&&Math.abs(z-pt)<=Qs*Math.max(1,Math.abs(z),Math.abs(pt))&&Math.abs(F-dt)<=Qs*Math.max(1,Math.abs(F),Math.abs(dt))&&Math.abs(j-qt)<=Qs*Math.max(1,Math.abs(j),Math.abs(qt))&&Math.abs(q-en)<=Qs*Math.max(1,Math.abs(q),Math.abs(en))&&Math.abs(ie-$t)<=Qs*Math.max(1,Math.abs(ie),Math.abs($t))&&Math.abs(Ae-Nt)<=Qs*Math.max(1,Math.abs(Ae),Math.abs(Nt))&&Math.abs(ce-zt)<=Qs*Math.max(1,Math.abs(ce),Math.abs(zt))&&Math.abs(pe-Ht)<=Qs*Math.max(1,Math.abs(pe),Math.abs(Ht))&&Math.abs(me-Gt)<=Qs*Math.max(1,Math.abs(me),Math.abs(Gt))&&Math.abs(ye-Tt)<=Qs*Math.max(1,Math.abs(ye),Math.abs(Tt))&&Math.abs(Ne-pn)<=Qs*Math.max(1,Math.abs(Ne),Math.abs(pn))&&Math.abs(ze-an)<=Qs*Math.max(1,Math.abs(ze),Math.abs(an))&&Math.abs(Je-jn)<=Qs*Math.max(1,Math.abs(Je),Math.abs(jn))},a.evaluateSizeForFeature=function(f,{uSize:A,uSizeT:p},{lowerSize:T,upperSize:D}){return f.kind==="source"?T/du:f.kind==="composite"?Jt(T/du,D/du,p):A},a.evaluateSizeForZoom=function(f,A){let p=0,T=0;if(f.kind==="constant")T=f.layoutSize;else if(f.kind!=="source"){const{interpolationType:D,minZoom:z,maxZoom:F}=f,j=D?L(Bn.interpolationFactor(D,A,z,F),0,1):0;f.kind==="camera"?T=Jt(f.minSize,f.maxSize,j):p=j}return{uSizeT:p,uSize:T}},a.evaluateVariableOffset=z4,a.evented=zi,a.exported=Xt,a.exported$1=ci,a.extend=Q,a.filterObject=te,a.fromRotation=function(f,A){var p=Math.sin(A),T=Math.cos(A);return f[0]=T,f[1]=p,f[2]=0,f[3]=-p,f[4]=T,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},a.fromScaling=function(f,A){return f[0]=A[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=A[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=A[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},a.getAnchorAlignment=xv,a.getAnchorJustification=bv,a.getArrayBuffer=ti,a.getImage=Fr,a.getJSON=function(f,A){return li(Q(f,{type:"json"}),A)},a.getOverlapMode=Cv,a.getRTLTextPluginStatus=Dl,a.getReferrer=$n,a.getVideo=function(f,A){const p=window.document.createElement("video");p.muted=!0,p.onloadstart=function(){A(null,p)};for(let T=0;T<f.length;T++){const D=window.document.createElement("source");Ki(f[T])||(p.crossOrigin="Anonymous"),D.src=f[T],p.appendChild(D)}return{cancel:()=>{}}},a.identity=rv,a.invert=function(f,A){var p=A[0],T=A[1],D=A[2],z=A[3],F=A[4],j=A[5],q=A[6],ie=A[7],Ae=A[8],ce=A[9],pe=A[10],me=A[11],ye=A[12],Ne=A[13],ze=A[14],Je=A[15],lt=p*j-T*F,Ke=p*q-D*F,st=p*ie-z*F,pt=T*q-D*j,dt=T*ie-z*j,qt=D*ie-z*q,en=Ae*Ne-ce*ye,$t=Ae*ze-pe*ye,Nt=Ae*Je-me*ye,zt=ce*ze-pe*Ne,Ht=ce*Je-me*Ne,Gt=pe*Je-me*ze,Tt=lt*Gt-Ke*Ht+st*zt+pt*Nt-dt*$t+qt*en;return Tt?(f[0]=(j*Gt-q*Ht+ie*zt)*(Tt=1/Tt),f[1]=(D*Ht-T*Gt-z*zt)*Tt,f[2]=(Ne*qt-ze*dt+Je*pt)*Tt,f[3]=(pe*dt-ce*qt-me*pt)*Tt,f[4]=(q*Nt-F*Gt-ie*$t)*Tt,f[5]=(p*Gt-D*Nt+z*$t)*Tt,f[6]=(ze*st-ye*qt-Je*Ke)*Tt,f[7]=(Ae*qt-pe*st+me*Ke)*Tt,f[8]=(F*Ht-j*Nt+ie*en)*Tt,f[9]=(T*Nt-p*Ht-z*en)*Tt,f[10]=(ye*dt-Ne*st+Je*lt)*Tt,f[11]=(ce*st-Ae*dt-me*lt)*Tt,f[12]=(j*$t-F*zt-q*en)*Tt,f[13]=(p*zt-T*$t+D*en)*Tt,f[14]=(Ne*Ke-ye*pt-ze*lt)*Tt,f[15]=(Ae*pt-ce*Ke+pe*lt)*Tt,f):null},a.isImageBitmap=gt,a.isSafari=Ye,a.isWorker=Qe,a.keysDifference=function(f,A){const p=[];for(const T in f)T in A||p.push(T);return p},a.lazyLoadRTLTextPlugin=function(){us.isLoading()||us.isLoaded()||Dl()!=="deferred"||ac()},a.makeRequest=li,a.mapObject=Y,a.mercatorXfromLng=j4,a.mercatorYfromLat=$4,a.mercatorZfromAltitude=H4,a.mul=z7,a.mul$1=function(f,A,p){return f[0]=A[0]*p[0],f[1]=A[1]*p[1],f[2]=A[2]*p[2],f[3]=A[3]*p[3],f},a.multiply=WS,a.nextPowerOfTwo=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},a.normalize=function(f,A){var p=A[0],T=A[1],D=A[2],z=p*p+T*T+D*D;return z>0&&(z=1/Math.sqrt(z)),f[0]=A[0]*z,f[1]=A[1]*z,f[2]=A[2]*z,f},a.number=Jt,a.ortho=function(f,A,p,T,D,z,F){var j=1/(A-p),q=1/(T-D),ie=1/(z-F);return f[0]=-2*j,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*q,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*ie,f[11]=0,f[12]=(A+p)*j,f[13]=(D+T)*q,f[14]=(F+z)*ie,f[15]=1,f},a.parseCacheControl=et,a.parseGlyphPbf=function(f){return new mv(f).readFields(zF,[])},a.pbf=mv,a.performSymbolLayout=function(f){f.bucket.createArrays(),f.bucket.tilePixelRatio=Rr/(512*f.bucket.overscaling),f.bucket.compareText={},f.bucket.iconsNeedLinear=!1;const A=f.bucket.layers[0].layout,p=f.bucket.layers[0]._unevaluatedLayout._values,T={layoutIconSize:p["icon-size"].possiblyEvaluate(new Ei(f.bucket.zoom+1),f.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new Ei(f.bucket.zoom+1),f.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new Ei(18))};if(f.bucket.textSizeData.kind==="composite"){const{minZoom:q,maxZoom:ie}=f.bucket.textSizeData;T.compositeTextSizes=[p["text-size"].possiblyEvaluate(new Ei(q),f.canonical),p["text-size"].possiblyEvaluate(new Ei(ie),f.canonical)]}if(f.bucket.iconSizeData.kind==="composite"){const{minZoom:q,maxZoom:ie}=f.bucket.iconSizeData;T.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new Ei(q),f.canonical),p["icon-size"].possiblyEvaluate(new Ei(ie),f.canonical)]}const D=A.get("text-line-height")*Yr,z=A.get("text-rotation-alignment")!=="viewport"&&A.get("symbol-placement")!=="point",F=A.get("text-keep-upright"),j=A.get("text-size");for(const q of f.bucket.features){const ie=A.get("text-font").evaluate(q,{},f.canonical).join(","),Ae=j.evaluate(q,{},f.canonical),ce=T.layoutTextSize.evaluate(q,{},f.canonical),pe=T.layoutIconSize.evaluate(q,{},f.canonical),me={horizontal:{},vertical:void 0},ye=q.text;let Ne,ze=[0,0];if(ye){const Ke=ye.toString(),st=A.get("text-letter-spacing").evaluate(q,{},f.canonical)*Yr,pt=Ll(Ke)?st:0,dt=A.get("text-anchor").evaluate(q,{},f.canonical),qt=A.get("text-variable-anchor");if(!qt){const Ht=A.get("text-radial-offset").evaluate(q,{},f.canonical);ze=Ht?z4(dt,[Ht*Yr,wv]):A.get("text-offset").evaluate(q,{},f.canonical).map(Gt=>Gt*Yr)}let en=z?"center":A.get("text-justify").evaluate(q,{},f.canonical);const $t=A.get("symbol-placement"),Nt=$t==="point"?A.get("text-max-width").evaluate(q,{},f.canonical)*Yr:0,zt=()=>{f.bucket.allowVerticalPlacement&&mA(Ke)&&(me.vertical=_m(ye,f.glyphMap,f.glyphPositions,f.imagePositions,ie,Nt,D,dt,"left",pt,ze,a.WritingMode.vertical,!0,$t,ce,Ae))};if(!z&&qt){const Ht=en==="auto"?qt.map(Tt=>bv(Tt)):[en];let Gt=!1;for(let Tt=0;Tt<Ht.length;Tt++){const pn=Ht[Tt];if(!me.horizontal[pn])if(Gt)me.horizontal[pn]=me.horizontal[0];else{const an=_m(ye,f.glyphMap,f.glyphPositions,f.imagePositions,ie,Nt,D,"center",pn,pt,ze,a.WritingMode.horizontal,!1,$t,ce,Ae);an&&(me.horizontal[pn]=an,Gt=an.positionedLines.length===1)}}zt()}else{en==="auto"&&(en=bv(dt));const Ht=_m(ye,f.glyphMap,f.glyphPositions,f.imagePositions,ie,Nt,D,dt,en,pt,ze,a.WritingMode.horizontal,!1,$t,ce,Ae);Ht&&(me.horizontal[en]=Ht),zt(),mA(Ke)&&z&&F&&(me.vertical=_m(ye,f.glyphMap,f.glyphPositions,f.imagePositions,ie,Nt,D,dt,en,pt,ze,a.WritingMode.vertical,!1,$t,ce,Ae))}}let Je=!1;if(q.icon&&q.icon.name){const Ke=f.imageMap[q.icon.name];Ke&&(Ne=GF(f.imagePositions[q.icon.name],A.get("icon-offset").evaluate(q,{},f.canonical),A.get("icon-anchor").evaluate(q,{},f.canonical)),Je=!!Ke.sdf,f.bucket.sdfIcons===void 0?f.bucket.sdfIcons=Je:f.bucket.sdfIcons!==Je&&ve("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ke.pixelRatio!==f.bucket.pixelRatio||A.get("icon-rotate").constantOr(1)!==0)&&(f.bucket.iconsNeedLinear=!0))}const lt=F4(me.horizontal)||me.vertical;f.bucket.iconsInText=!!lt&&lt.iconsInText,(lt||Ne)&&ZF(f.bucket,q,me,Ne,f.imageMap,T,ce,pe,ze,Je,f.canonical)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()},a.perspective=function(f,A,p,T,D){var z,F=1/Math.tan(A/2);return f[0]=F/p,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=F,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,D!=null&&D!==1/0?(f[10]=(D+T)*(z=1/(T-D)),f[14]=2*D*T*z):(f[10]=-1,f[14]=-2*T),f},a.pick=function(f,A){const p={};for(let T=0;T<A.length;T++){const D=A[T];D in f&&(p[D]=f[D])}return p},a.plugin=us,a.pointGeometry=Et,a.polygonIntersectsPolygon=VS,a.potpack=v4,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=Ft,a.registerForPluginStateChange=function(f){return f({pluginStatus:Dr,pluginURL:xo}),zi.on("pluginStateChange",f),f},a.renderColorRamp=JS,a.rotateX=function(f,A,p){var T=Math.sin(p),D=Math.cos(p),z=A[4],F=A[5],j=A[6],q=A[7],ie=A[8],Ae=A[9],ce=A[10],pe=A[11];return A!==f&&(f[0]=A[0],f[1]=A[1],f[2]=A[2],f[3]=A[3],f[12]=A[12],f[13]=A[13],f[14]=A[14],f[15]=A[15]),f[4]=z*D+ie*T,f[5]=F*D+Ae*T,f[6]=j*D+ce*T,f[7]=q*D+pe*T,f[8]=ie*D-z*T,f[9]=Ae*D-F*T,f[10]=ce*D-j*T,f[11]=pe*D-q*T,f},a.rotateZ=function(f,A,p){var T=Math.sin(p),D=Math.cos(p),z=A[0],F=A[1],j=A[2],q=A[3],ie=A[4],Ae=A[5],ce=A[6],pe=A[7];return A!==f&&(f[8]=A[8],f[9]=A[9],f[10]=A[10],f[11]=A[11],f[12]=A[12],f[13]=A[13],f[14]=A[14],f[15]=A[15]),f[0]=z*D+ie*T,f[1]=F*D+Ae*T,f[2]=j*D+ce*T,f[3]=q*D+pe*T,f[4]=ie*D-z*T,f[5]=Ae*D-F*T,f[6]=ce*D-j*T,f[7]=pe*D-q*T,f},a.scale=function(f,A,p){var T=p[0],D=p[1],z=p[2];return f[0]=A[0]*T,f[1]=A[1]*T,f[2]=A[2]*T,f[3]=A[3]*T,f[4]=A[4]*D,f[5]=A[5]*D,f[6]=A[6]*D,f[7]=A[7]*D,f[8]=A[8]*z,f[9]=A[9]*z,f[10]=A[10]*z,f[11]=A[11]*z,f[12]=A[12],f[13]=A[13],f[14]=A[14],f[15]=A[15],f},a.scale$1=function(f,A,p){return f[0]=A[0]*p,f[1]=A[1]*p,f[2]=A[2]*p,f},a.setCacheLimits=function(f,A){En=f,Si=A},a.setRTLTextPlugin=function(f,A,p=!1){if(Dr===su||Dr===ou||Dr===au)throw new Error("setRTLTextPlugin cannot be called multiple times.");xo=Xt.resolveURL(f),Dr=su,js=A,_a(),p||ac()},a.spec=ut,a.sphericalToCartesian=function([f,A,p]){return A+=90,A*=Math.PI/180,p*=Math.PI/180,{x:f*Math.cos(A)*Math.sin(p),y:f*Math.sin(A)*Math.sin(p),z:f*Math.cos(p)}},a.sqrLen=function(f){var A=f[0],p=f[1];return A*A+p*p},a.sub=function(f,A,p){return f[0]=A[0]-p[0],f[1]=A[1]-p[1],f[2]=A[2]-p[2],f},a.toEvaluationFeature=Ah,a.transformMat3=function(f,A,p){var T=A[0],D=A[1],z=A[2];return f[0]=T*p[0]+D*p[3]+z*p[6],f[1]=T*p[1]+D*p[4]+z*p[7],f[2]=T*p[2]+D*p[5]+z*p[8],f},a.transformMat4=cm,a.transformMat4$1=function(f,A,p){var T=A[0],D=A[1];return f[0]=p[0]*T+p[4]*D+p[12],f[1]=p[1]*T+p[5]*D+p[13],f},a.translate=function(f,A,p){var T,D,z,F,j,q,ie,Ae,ce,pe,me,ye,Ne=p[0],ze=p[1],Je=p[2];return A===f?(f[12]=A[0]*Ne+A[4]*ze+A[8]*Je+A[12],f[13]=A[1]*Ne+A[5]*ze+A[9]*Je+A[13],f[14]=A[2]*Ne+A[6]*ze+A[10]*Je+A[14],f[15]=A[3]*Ne+A[7]*ze+A[11]*Je+A[15]):(D=A[1],z=A[2],F=A[3],j=A[4],q=A[5],ie=A[6],Ae=A[7],ce=A[8],pe=A[9],me=A[10],ye=A[11],f[0]=T=A[0],f[1]=D,f[2]=z,f[3]=F,f[4]=j,f[5]=q,f[6]=ie,f[7]=Ae,f[8]=ce,f[9]=pe,f[10]=me,f[11]=ye,f[12]=T*Ne+j*ze+ce*Je+A[12],f[13]=D*Ne+q*ze+pe*Je+A[13],f[14]=z*Ne+ie*ze+me*Je+A[14],f[15]=F*Ne+Ae*ze+ye*Je+A[15]),f},a.triggerPluginCompletionEvent=lu,a.unicodeBlockLookup=Ut,a.uniqueId=function(){return Z++},a.validateCustomStyleLayer=function(f){const A=[],p=f.id;return p===void 0&&A.push({message:`layers.${p}: missing required property "id"`}),f.render===void 0&&A.push({message:`layers.${p}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&A.push({message:`layers.${p}: property "renderingMode" must be either "2d" or "3d"`}),A},a.validateLight=Za,a.validateStyle=kl,a.vectorTile=cc,a.warnOnce=ve,a.wrap=U}),s(["./shared"],function(a){function y(K){const H=typeof K;if(H==="number"||H==="boolean"||H==="string"||K==null)return JSON.stringify(K);if(Array.isArray(K)){let o="[";for(const G of K)o+=`${y(G)},`;return`${o}]`}const ee=Object.keys(K).sort();let he="{";for(let o=0;o<ee.length;o++)he+=`${JSON.stringify(ee[o])}:${y(K[ee[o]])},`;return`${he}}`}function w(K){let H="";for(const ee of a.refProperties)H+=`/${y(K[ee])}`;return H}class I{constructor(H){this.keyCache={},H&&this.replace(H)}replace(H){this._layerConfigs={},this._layers={},this.update(H,[])}update(H,ee){for(const o of H){this._layerConfigs[o.id]=o;const G=this._layers[o.id]=a.createStyleLayer(o);G._featureFilter=a.createFilter(G.filter),this.keyCache[o.id]&&delete this.keyCache[o.id]}for(const o of ee)delete this.keyCache[o],delete this._layerConfigs[o],delete this._layers[o];this.familiesBySource={};const he=function(o,G){const Le={};for(let Pe=0;Pe<o.length;Pe++){const ke=G&&G[o[Pe].id]||w(o[Pe]);G&&(G[o[Pe].id]=ke);let We=Le[ke];We||(We=Le[ke]=[]),We.push(o[Pe])}const Ie=[];for(const Pe in Le)Ie.push(Le[Pe]);return Ie}(Object.values(this._layerConfigs),this.keyCache);for(const o of he){const G=o.map(at=>this._layers[at.id]),Le=G[0];if(Le.visibility==="none")continue;const Ie=Le.source||"";let Pe=this.familiesBySource[Ie];Pe||(Pe=this.familiesBySource[Ie]={});const ke=Le.sourceLayer||"_geojsonTileLayer";let We=Pe[ke];We||(We=Pe[ke]=[]),We.push(G)}}}class P{constructor(H){const ee={},he=[];for(const Ie in H){const Pe=H[Ie],ke=ee[Ie]={};for(const We in Pe){const at=Pe[+We];if(!at||at.bitmap.width===0||at.bitmap.height===0)continue;const $e={x:0,y:0,w:at.bitmap.width+2,h:at.bitmap.height+2};he.push($e),ke[We]={rect:$e,metrics:at.metrics}}}const{w:o,h:G}=a.potpack(he),Le=new a.AlphaImage({width:o||1,height:G||1});for(const Ie in H){const Pe=H[Ie];for(const ke in Pe){const We=Pe[+ke];if(!We||We.bitmap.width===0||We.bitmap.height===0)continue;const at=ee[Ie][ke].rect;a.AlphaImage.copy(We.bitmap,Le,{x:0,y:0},{x:at.x+1,y:at.y+1},We.bitmap)}}this.image=Le,this.positions=ee}}a.register("GlyphAtlas",P);class L{constructor(H){this.tileID=new a.OverscaledTileID(H.tileID.overscaledZ,H.tileID.wrap,H.tileID.canonical.z,H.tileID.canonical.x,H.tileID.canonical.y),this.uid=H.uid,this.zoom=H.zoom,this.pixelRatio=H.pixelRatio,this.tileSize=H.tileSize,this.source=H.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=H.showCollisionBoxes,this.collectResourceTiming=!!H.collectResourceTiming,this.returnDependencies=!!H.returnDependencies,this.promoteId=H.promoteId}parse(H,ee,he,o,G){this.status="parsing",this.data=H,this.collisionBoxArray=new a.CollisionBoxArray;const Le=new a.DictionaryCoder(Object.keys(H.layers).sort()),Ie=new a.FeatureIndex(this.tileID,this.promoteId);Ie.bucketLayerIDs=[];const Pe={},ke={featureIndex:Ie,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:he},We=ee.familiesBySource[this.source];for(const Qt in We){const on=H.layers[Qt];if(!on)continue;on.version===1&&a.warnOnce(`Vector tile source "${this.source}" layer "${Qt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const vn=Le.encode(Qt),Ot=[];for(let Oe=0;Oe<on.length;Oe++){const Mt=on.feature(Oe),Se=Ie.getId(Mt,Qt);Ot.push({feature:Mt,id:Se,index:Oe,sourceLayerIndex:vn})}for(const Oe of We[Qt]){const Mt=Oe[0];Mt.source!==this.source&&a.warnOnce(`layer.source = ${Mt.source} does not equal this.source = ${this.source}`),Mt.minzoom&&this.zoom<Math.floor(Mt.minzoom)||Mt.maxzoom&&this.zoom>=Mt.maxzoom||Mt.visibility!=="none"&&(U(Oe,this.zoom,he),(Pe[Mt.id]=Mt.createBucket({index:Ie.bucketLayerIDs.length,layers:Oe,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:vn,sourceID:this.source})).populate(Ot,ke,this.tileID.canonical),Ie.bucketLayerIDs.push(Oe.map(Se=>Se.id)))}}let at,$e,ht,Lt;const Dt=a.mapObject(ke.glyphDependencies,Qt=>Object.keys(Qt).map(Number));Object.keys(Dt).length?o.send("getGlyphs",{uid:this.uid,stacks:Dt},(Qt,on)=>{at||(at=Qt,$e=on,dn.call(this))}):$e={};const rn=Object.keys(ke.iconDependencies);rn.length?o.send("getImages",{icons:rn,source:this.source,tileID:this.tileID,type:"icons"},(Qt,on)=>{at||(at=Qt,ht=on,dn.call(this))}):ht={};const jt=Object.keys(ke.patternDependencies);function dn(){if(at)return G(at);if($e&&ht&&Lt){const Qt=new P($e),on=new a.ImageAtlas(ht,Lt);for(const vn in Pe){const Ot=Pe[vn];Ot instanceof a.SymbolBucket?(U(Ot.layers,this.zoom,he),a.performSymbolLayout({bucket:Ot,glyphMap:$e,glyphPositions:Qt.positions,imageMap:ht,imagePositions:on.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ot.hasPattern&&(Ot instanceof a.LineBucket||Ot instanceof a.FillBucket||Ot instanceof a.FillExtrusionBucket)&&(U(Ot.layers,this.zoom,he),Ot.addFeatures(ke,this.tileID.canonical,on.patternPositions))}this.status="done",G(null,{buckets:Object.values(Pe).filter(vn=>!vn.isEmpty()),featureIndex:Ie,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Qt.image,imageAtlas:on,glyphMap:this.returnDependencies?$e:null,iconMap:this.returnDependencies?ht:null,glyphPositions:this.returnDependencies?Qt.positions:null})}}jt.length?o.send("getImages",{icons:jt,source:this.source,tileID:this.tileID,type:"patterns"},(Qt,on)=>{at||(at=Qt,Lt=on,dn.call(this))}):Lt={},dn.call(this)}}function U(K,H,ee){const he=new a.EvaluationParameters(H);for(const o of K)o.recalculate(he,ee)}function Q(K,H){const ee=a.getArrayBuffer(K.request,(he,o,G,Le)=>{he?H(he):o&&H(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(o)),rawData:o,cacheControl:G,expires:Le})});return()=>{ee.cancel(),H()}}class Z{constructor(H,ee,he,o){this.actor=H,this.layerIndex=ee,this.availableImages=he,this.loadVectorData=o||Q,this.loading={},this.loaded={}}loadTile(H,ee){const he=H.uid;this.loading||(this.loading={});const o=!!(H&&H.request&&H.request.collectResourceTiming)&&new a.RequestPerformance(H.request),G=this.loading[he]=new L(H);G.abort=this.loadVectorData(H,(Le,Ie)=>{if(delete this.loading[he],Le||!Ie)return G.status="done",this.loaded[he]=G,ee(Le);const Pe=Ie.rawData,ke={};Ie.expires&&(ke.expires=Ie.expires),Ie.cacheControl&&(ke.cacheControl=Ie.cacheControl);const We={};if(o){const at=o.finish();at&&(We.resourceTiming=JSON.parse(JSON.stringify(at)))}G.vectorTile=Ie.vectorTile,G.parse(Ie.vectorTile,this.layerIndex,this.availableImages,this.actor,(at,$e)=>{if(at||!$e)return ee(at);ee(null,a.extend({rawTileData:Pe.slice(0)},$e,ke,We))}),this.loaded=this.loaded||{},this.loaded[he]=G})}reloadTile(H,ee){const he=this.loaded,o=H.uid,G=this;if(he&&he[o]){const Le=he[o];Le.showCollisionBoxes=H.showCollisionBoxes;const Ie=(Pe,ke)=>{const We=Le.reloadCallback;We&&(delete Le.reloadCallback,Le.parse(Le.vectorTile,G.layerIndex,this.availableImages,G.actor,We)),ee(Pe,ke)};Le.status==="parsing"?Le.reloadCallback=Ie:Le.status==="done"&&(Le.vectorTile?Le.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.actor,Ie):Ie())}}abortTile(H,ee){const he=this.loading,o=H.uid;he&&he[o]&&he[o].abort&&(he[o].abort(),delete he[o]),ee()}removeTile(H,ee){const he=this.loaded,o=H.uid;he&&he[o]&&delete he[o],ee()}}class ae{constructor(){this.loaded={}}loadTile(H,ee){const{uid:he,encoding:o,rawImageData:G}=H,Le=a.isImageBitmap(G)?this.getImageData(G):G,Ie=new a.DEMData(he,Le,o);this.loaded=this.loaded||{},this.loaded[he]=Ie,ee(null,Ie)}getImageData(H){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(H.width,H.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=H.width,this.offscreenCanvas.height=H.height,this.offscreenCanvasContext.drawImage(H,0,0,H.width,H.height);const ee=this.offscreenCanvasContext.getImageData(-1,-1,H.width+2,H.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:ee.width,height:ee.height},ee.data)}removeTile(H){const ee=this.loaded,he=H.uid;ee&&ee[he]&&delete ee[he]}}var Y=function K(H,ee){var he,o=H&&H.type;if(o==="FeatureCollection")for(he=0;he<H.features.length;he++)K(H.features[he],ee);else if(o==="GeometryCollection")for(he=0;he<H.geometries.length;he++)K(H.geometries[he],ee);else if(o==="Feature")K(H.geometry,ee);else if(o==="Polygon")te(H.coordinates,ee);else if(o==="MultiPolygon")for(he=0;he<H.coordinates.length;he++)te(H.coordinates[he],ee);return H};function te(K,H){if(K.length!==0){re(K[0],H);for(var ee=1;ee<K.length;ee++)re(K[ee],!H)}}function re(K,H){for(var ee=0,he=0,o=0,G=K.length,Le=G-1;o<G;Le=o++){var Ie=(K[o][0]-K[Le][0])*(K[Le][1]+K[o][1]),Pe=ee+Ie;he+=Math.abs(ee)>=Math.abs(Ie)?ee-Pe+Ie:Ie-Pe+ee,ee=Pe}ee+he>=0!=!!H&&K.reverse()}const de=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ve{constructor(H){this._feature=H,this.extent=a.EXTENT,this.type=H.type,this.properties=H.tags,"id"in H&&!isNaN(H.id)&&(this.id=parseInt(H.id,10))}loadGeometry(){if(this._feature.type===1){const H=[];for(const ee of this._feature.geometry)H.push([new a.pointGeometry(ee[0],ee[1])]);return H}{const H=[];for(const ee of this._feature.geometry){const he=[];for(const o of ee)he.push(new a.pointGeometry(o[0],o[1]));H.push(he)}return H}}toGeoJSON(H,ee,he){return de.call(this,H,ee,he)}}class Me{constructor(H){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=H.length,this._features=H}feature(H){return new ve(this._features[H])}}var He={exports:{}},Qe=a.pointGeometry,et=a.vectorTile.VectorTileFeature,tt=Ve;function Ve(K,H){this.options=H||{},this.features=K,this.length=K.length}function nt(K,H){this.id=typeof K.id=="number"?K.id:void 0,this.type=K.type,this.rawGeometry=K.type===1?[K.geometry]:K.geometry,this.properties=K.tags,this.extent=H||4096}Ve.prototype.feature=function(K){return new nt(this.features[K],this.options.extent)},nt.prototype.loadGeometry=function(){var K=this.rawGeometry;this.geometry=[];for(var H=0;H<K.length;H++){for(var ee=K[H],he=[],o=0;o<ee.length;o++)he.push(new Qe(ee[o][0],ee[o][1]));this.geometry.push(he)}return this.geometry},nt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var K=this.geometry,H=1/0,ee=-1/0,he=1/0,o=-1/0,G=0;G<K.length;G++)for(var Le=K[G],Ie=0;Ie<Le.length;Ie++){var Pe=Le[Ie];H=Math.min(H,Pe.x),ee=Math.max(ee,Pe.x),he=Math.min(he,Pe.y),o=Math.max(o,Pe.y)}return[H,he,ee,o]},nt.prototype.toGeoJSON=et.prototype.toGeoJSON;var Ye=a.pbf,gt=tt;function Xt(K){var H=new Ye;return function(ee,he){for(var o in ee.layers)he.writeMessage(3,Et,ee.layers[o])}(K,H),H.finish()}function Et(K,H){var ee;H.writeVarintField(15,K.version||1),H.writeStringField(1,K.name||""),H.writeVarintField(5,K.extent||4096);var he={keys:[],values:[],keycache:{},valuecache:{}};for(ee=0;ee<K.length;ee++)he.feature=K.feature(ee),H.writeMessage(2,fn,he);var o=he.keys;for(ee=0;ee<o.length;ee++)H.writeStringField(3,o[ee]);var G=he.values;for(ee=0;ee<G.length;ee++)H.writeMessage(4,En,G[ee])}function fn(K,H){var ee=K.feature;ee.id!==void 0&&H.writeVarintField(1,ee.id),H.writeMessage(2,mt,K),H.writeVarintField(3,ee.type),H.writeMessage(4,In,ee)}function mt(K,H){var ee=K.feature,he=K.keys,o=K.values,G=K.keycache,Le=K.valuecache;for(var Ie in ee.properties){var Pe=ee.properties[Ie],ke=G[Ie];if(Pe!==null){ke===void 0&&(he.push(Ie),G[Ie]=ke=he.length-1),H.writeVarint(ke);var We=typeof Pe;We!=="string"&&We!=="boolean"&&We!=="number"&&(Pe=JSON.stringify(Pe));var at=We+":"+Pe,$e=Le[at];$e===void 0&&(o.push(Pe),Le[at]=$e=o.length-1),H.writeVarint($e)}}}function bt(K,H){return(H<<3)+(7&K)}function Kt(K){return K<<1^K>>31}function In(K,H){for(var ee=K.loadGeometry(),he=K.type,o=0,G=0,Le=ee.length,Ie=0;Ie<Le;Ie++){var Pe=ee[Ie],ke=1;he===1&&(ke=Pe.length),H.writeVarint(bt(1,ke));for(var We=he===3?Pe.length-1:Pe.length,at=0;at<We;at++){at===1&&he!==1&&H.writeVarint(bt(2,We-1));var $e=Pe[at].x-o,ht=Pe[at].y-G;H.writeVarint(Kt($e)),H.writeVarint(Kt(ht)),o+=$e,G+=ht}he===3&&H.writeVarint(bt(7,1))}}function En(K,H){var ee=typeof K;ee==="string"?H.writeStringField(1,K):ee==="boolean"?H.writeBooleanField(7,K):ee==="number"&&(K%1!=0?H.writeDoubleField(3,K):K<0?H.writeSVarintField(6,K):H.writeVarintField(5,K))}function Si(K,H,ee,he,o,G){if(o-he<=ee)return;const Le=he+o>>1;Jn(K,H,Le,he,o,G%2),Si(K,H,ee,he,Le-1,G+1),Si(K,H,ee,Le+1,o,G+1)}function Jn(K,H,ee,he,o,G){for(;o>he;){if(o-he>600){const ke=o-he+1,We=ee-he+1,at=Math.log(ke),$e=.5*Math.exp(2*at/3),ht=.5*Math.sqrt(at*$e*(ke-$e)/ke)*(We-ke/2<0?-1:1);Jn(K,H,ee,Math.max(he,Math.floor(ee-We*$e/ke+ht)),Math.min(o,Math.floor(ee+(ke-We)*$e/ke+ht)),G)}const Le=H[2*ee+G];let Ie=he,Pe=o;for(oi(K,H,he,ee),H[2*o+G]>Le&&oi(K,H,he,o);Ie<Pe;){for(oi(K,H,Ie,Pe),Ie++,Pe--;H[2*Ie+G]<Le;)Ie++;for(;H[2*Pe+G]>Le;)Pe--}H[2*he+G]===Le?oi(K,H,he,Pe):(Pe++,oi(K,H,Pe,o)),Pe<=ee&&(he=Pe+1),ee<=Pe&&(o=Pe-1)}}function oi(K,H,ee,he){ci(K,ee,he),ci(H,2*ee,2*he),ci(H,2*ee+1,2*he+1)}function ci(K,H,ee){const he=K[H];K[H]=K[ee],K[ee]=he}function Nn(K,H,ee,he){const o=K-ee,G=H-he;return o*o+G*G}He.exports=Xt,He.exports.fromVectorTileJs=Xt,He.exports.fromGeojsonVt=function(K,H){H=H||{};var ee={};for(var he in K)ee[he]=new gt(K[he].features,H),ee[he].name=he,ee[he].version=H.version,ee[he].extent=H.extent;return Xt({layers:ee})},He.exports.GeoJSONWrapper=gt;const bi=K=>K[0],xt=K=>K[1];class nn{constructor(H,ee=bi,he=xt,o=64,G=Float64Array){this.nodeSize=o,this.points=H;const Le=H.length<65536?Uint16Array:Uint32Array,Ie=this.ids=new Le(H.length),Pe=this.coords=new G(2*H.length);for(let ke=0;ke<H.length;ke++)Ie[ke]=ke,Pe[2*ke]=ee(H[ke]),Pe[2*ke+1]=he(H[ke]);Si(Ie,Pe,o,0,Ie.length-1,0)}range(H,ee,he,o){return function(G,Le,Ie,Pe,ke,We,at){const $e=[0,G.length-1,0],ht=[];let Lt,Dt;for(;$e.length;){const rn=$e.pop(),jt=$e.pop(),dn=$e.pop();if(jt-dn<=at){for(let vn=dn;vn<=jt;vn++)Lt=Le[2*vn],Dt=Le[2*vn+1],Lt>=Ie&&Lt<=ke&&Dt>=Pe&&Dt<=We&&ht.push(G[vn]);continue}const Qt=Math.floor((dn+jt)/2);Lt=Le[2*Qt],Dt=Le[2*Qt+1],Lt>=Ie&&Lt<=ke&&Dt>=Pe&&Dt<=We&&ht.push(G[Qt]);const on=(rn+1)%2;(rn===0?Ie<=Lt:Pe<=Dt)&&($e.push(dn),$e.push(Qt-1),$e.push(on)),(rn===0?ke>=Lt:We>=Dt)&&($e.push(Qt+1),$e.push(jt),$e.push(on))}return ht}(this.ids,this.coords,H,ee,he,o,this.nodeSize)}within(H,ee,he){return function(o,G,Le,Ie,Pe,ke){const We=[0,o.length-1,0],at=[],$e=Pe*Pe;for(;We.length;){const ht=We.pop(),Lt=We.pop(),Dt=We.pop();if(Lt-Dt<=ke){for(let on=Dt;on<=Lt;on++)Nn(G[2*on],G[2*on+1],Le,Ie)<=$e&&at.push(o[on]);continue}const rn=Math.floor((Dt+Lt)/2),jt=G[2*rn],dn=G[2*rn+1];Nn(jt,dn,Le,Ie)<=$e&&at.push(o[rn]);const Qt=(ht+1)%2;(ht===0?Le-Pe<=jt:Ie-Pe<=dn)&&(We.push(Dt),We.push(rn-1),We.push(Qt)),(ht===0?Le+Pe>=jt:Ie+Pe>=dn)&&(We.push(rn+1),We.push(Lt),We.push(Qt))}return at}(this.ids,this.coords,H,ee,he,this.nodeSize)}}const Mn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:K=>K},vt=Math.fround||(ei=new Float32Array(1),K=>(ei[0]=+K,ei[0]));var ei;class $n{constructor(H){this.options=Fr(Object.create(Mn),H),this.trees=new Array(this.options.maxZoom+1)}load(H){const{log:ee,minZoom:he,maxZoom:o,nodeSize:G}=this.options;ee&&console.time("total time");const Le=`prepare ${H.length} points`;ee&&console.time(Le),this.points=H;let Ie=[];for(let Pe=0;Pe<H.length;Pe++)H[Pe].geometry&&Ie.push(li(H[Pe],Pe));this.trees[o+1]=new nn(Ie,fo,Ni,G,Float32Array),ee&&console.timeEnd(Le);for(let Pe=o;Pe>=he;Pe--){const ke=+Date.now();Ie=this._cluster(Ie,Pe),this.trees[Pe]=new nn(Ie,fo,Ni,G,Float32Array),ee&&console.log("z%d: %d clusters in %dms",Pe,Ie.length,+Date.now()-ke)}return ee&&console.timeEnd("total time"),this}getClusters(H,ee){let he=((H[0]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,H[1]));let G=H[2]===180?180:((H[2]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,H[3]));if(H[2]-H[0]>=360)he=-180,G=180;else if(he>G){const We=this.getClusters([he,o,180,Le],ee),at=this.getClusters([-180,o,G,Le],ee);return We.concat(at)}const Ie=this.trees[this._limitZoom(ee)],Pe=Ie.range(Un(he),Cr(Le),Un(G),Cr(o)),ke=[];for(const We of Pe){const at=Ie.points[We];ke.push(at.numPoints?ti(at):this.points[at.index])}return ke}getChildren(H){const ee=this._getOriginId(H),he=this._getOriginZoom(H),o="No cluster with the specified id.",G=this.trees[he];if(!G)throw new Error(o);const Le=G.points[ee];if(!Le)throw new Error(o);const Ie=this.options.radius/(this.options.extent*Math.pow(2,he-1)),Pe=G.within(Le.x,Le.y,Ie),ke=[];for(const We of Pe){const at=G.points[We];at.parentId===H&&ke.push(at.numPoints?ti(at):this.points[at.index])}if(ke.length===0)throw new Error(o);return ke}getLeaves(H,ee,he){const o=[];return this._appendLeaves(o,H,ee=ee||10,he=he||0,0),o}getTile(H,ee,he){const o=this.trees[this._limitZoom(H)],G=Math.pow(2,H),{extent:Le,radius:Ie}=this.options,Pe=Ie/Le,ke=(he-Pe)/G,We=(he+1+Pe)/G,at={features:[]};return this._addTileFeatures(o.range((ee-Pe)/G,ke,(ee+1+Pe)/G,We),o.points,ee,he,G,at),ee===0&&this._addTileFeatures(o.range(1-Pe/G,ke,1,We),o.points,G,he,G,at),ee===G-1&&this._addTileFeatures(o.range(0,ke,Pe/G,We),o.points,-1,he,G,at),at.features.length?at:null}getClusterExpansionZoom(H){let ee=this._getOriginZoom(H)-1;for(;ee<=this.options.maxZoom;){const he=this.getChildren(H);if(ee++,he.length!==1)break;H=he[0].properties.cluster_id}return ee}_appendLeaves(H,ee,he,o,G){const Le=this.getChildren(ee);for(const Ie of Le){const Pe=Ie.properties;if(Pe&&Pe.cluster?G+Pe.point_count<=o?G+=Pe.point_count:G=this._appendLeaves(H,Pe.cluster_id,he,o,G):G<o?G++:H.push(Ie),H.length===he)break}return G}_addTileFeatures(H,ee,he,o,G,Le){for(const Ie of H){const Pe=ee[Ie],ke=Pe.numPoints;let We,at,$e;if(ke)We=Ki(Pe),at=Pe.x,$e=Pe.y;else{const Dt=this.points[Pe.index];We=Dt.properties,at=Un(Dt.geometry.coordinates[0]),$e=Cr(Dt.geometry.coordinates[1])}const ht={type:1,geometry:[[Math.round(this.options.extent*(at*G-he)),Math.round(this.options.extent*($e*G-o))]],tags:We};let Lt;ke?Lt=Pe.id:this.options.generateId?Lt=Pe.index:this.points[Pe.index].id&&(Lt=this.points[Pe.index].id),Lt!==void 0&&(ht.id=Lt),Le.features.push(ht)}}_limitZoom(H){return Math.max(this.options.minZoom,Math.min(Math.floor(+H),this.options.maxZoom+1))}_cluster(H,ee){const he=[],{radius:o,extent:G,reduce:Le,minPoints:Ie}=this.options,Pe=o/(G*Math.pow(2,ee));for(let ke=0;ke<H.length;ke++){const We=H[ke];if(We.zoom<=ee)continue;We.zoom=ee;const at=this.trees[ee+1],$e=at.within(We.x,We.y,Pe),ht=We.numPoints||1;let Lt=ht;for(const Dt of $e){const rn=at.points[Dt];rn.zoom>ee&&(Lt+=rn.numPoints||1)}if(Lt>ht&&Lt>=Ie){let Dt=We.x*ht,rn=We.y*ht,jt=Le&&ht>1?this._map(We,!0):null;const dn=(ke<<5)+(ee+1)+this.points.length;for(const Qt of $e){const on=at.points[Qt];if(on.zoom<=ee)continue;on.zoom=ee;const vn=on.numPoints||1;Dt+=on.x*vn,rn+=on.y*vn,on.parentId=dn,Le&&(jt||(jt=this._map(We,!0)),Le(jt,this._map(on)))}We.parentId=dn,he.push(yi(Dt/Lt,rn/Lt,dn,Lt,jt))}else if(he.push(We),Lt>1)for(const Dt of $e){const rn=at.points[Dt];rn.zoom<=ee||(rn.zoom=ee,he.push(rn))}}return he}_getOriginId(H){return H-this.points.length>>5}_getOriginZoom(H){return(H-this.points.length)%32}_map(H,ee){if(H.numPoints)return ee?Fr({},H.properties):H.properties;const he=this.points[H.index].properties,o=this.options.map(he);return ee&&o===he?Fr({},o):o}}function yi(K,H,ee,he,o){return{x:vt(K),y:vt(H),zoom:1/0,id:ee,parentId:-1,numPoints:he,properties:o}}function li(K,H){const[ee,he]=K.geometry.coordinates;return{x:vt(Un(ee)),y:vt(Cr(he)),zoom:1/0,index:H,parentId:-1}}function ti(K){return{type:"Feature",id:K.id,properties:Ki(K),geometry:{type:"Point",coordinates:[(H=K.x,360*(H-.5)),Hn(K.y)]}};var H}function Ki(K){const H=K.numPoints,ee=H>=1e4?`${Math.round(H/1e3)}k`:H>=1e3?Math.round(H/100)/10+"k":H;return Fr(Fr({},K.properties),{cluster:!0,cluster_id:K.id,point_count:H,point_count_abbreviated:ee})}function Un(K){return K/360+.5}function Cr(K){const H=Math.sin(K*Math.PI/180),ee=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return ee<0?0:ee>1?1:ee}function Hn(K){const H=(180-360*K)*Math.PI/180;return 360*Math.atan(Math.exp(H))/Math.PI-90}function Fr(K,H){for(const ee in H)K[ee]=H[ee];return K}function fo(K){return K.x}function Ni(K){return K.y}function Pr(K,H,ee,he){for(var o,G=he,Le=ee-H>>1,Ie=ee-H,Pe=K[H],ke=K[H+1],We=K[ee],at=K[ee+1],$e=H+3;$e<ee;$e+=3){var ht=Fo(K[$e],K[$e+1],Pe,ke,We,at);if(ht>G)o=$e,G=ht;else if(ht===G){var Lt=Math.abs($e-Le);Lt<Ie&&(o=$e,Ie=Lt)}}G>he&&(o-H>3&&Pr(K,H,o,he),K[o+2]=G,ee-o>3&&Pr(K,o,ee,he))}function Fo(K,H,ee,he,o,G){var Le=o-ee,Ie=G-he;if(Le!==0||Ie!==0){var Pe=((K-ee)*Le+(H-he)*Ie)/(Le*Le+Ie*Ie);Pe>1?(ee=o,he=G):Pe>0&&(ee+=Le*Pe,he+=Ie*Pe)}return(Le=K-ee)*Le+(Ie=H-he)*Ie}function is(K,H,ee,he){var o={id:K===void 0?null:K,type:H,geometry:ee,tags:he,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(G){var Le=G.geometry,Ie=G.type;if(Ie==="Point"||Ie==="MultiPoint"||Ie==="LineString")ut(G,Le);else if(Ie==="Polygon"||Ie==="MultiLineString")for(var Pe=0;Pe<Le.length;Pe++)ut(G,Le[Pe]);else if(Ie==="MultiPolygon")for(Pe=0;Pe<Le.length;Pe++)for(var ke=0;ke<Le[Pe].length;ke++)ut(G,Le[Pe][ke])}(o),o}function ut(K,H){for(var ee=0;ee<H.length;ee+=3)K.minX=Math.min(K.minX,H[ee]),K.minY=Math.min(K.minY,H[ee+1]),K.maxX=Math.max(K.maxX,H[ee]),K.maxY=Math.max(K.maxY,H[ee+1])}function It(K,H,ee,he){if(H.geometry){var o=H.geometry.coordinates,G=H.geometry.type,Le=Math.pow(ee.tolerance/((1<<ee.maxZoom)*ee.extent),2),Ie=[],Pe=H.id;if(ee.promoteId?Pe=H.properties[ee.promoteId]:ee.generateId&&(Pe=he||0),G==="Point")Bs(o,Ie);else if(G==="MultiPoint")for(var ke=0;ke<o.length;ke++)Bs(o[ke],Ie);else if(G==="LineString")xr(o,Ie,Le,!1);else if(G==="MultiLineString"){if(ee.lineMetrics){for(ke=0;ke<o.length;ke++)xr(o[ke],Ie=[],Le,!1),K.push(is(Pe,"LineString",Ie,H.properties));return}Rn(o,Ie,Le,!1)}else if(G==="Polygon")Rn(o,Ie,Le,!0);else{if(G!=="MultiPolygon"){if(G==="GeometryCollection"){for(ke=0;ke<H.geometry.geometries.length;ke++)It(K,{id:Pe,geometry:H.geometry.geometries[ke],properties:H.properties},ee,he);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ke=0;ke<o.length;ke++){var We=[];Rn(o[ke],We,Le,!0),Ie.push(We)}}K.push(is(Pe,G,Ie,H.properties))}}function Bs(K,H){H.push(Nr(K[0])),H.push(Ir(K[1])),H.push(0)}function xr(K,H,ee,he){for(var o,G,Le=0,Ie=0;Ie<K.length;Ie++){var Pe=Nr(K[Ie][0]),ke=Ir(K[Ie][1]);H.push(Pe),H.push(ke),H.push(0),Ie>0&&(Le+=he?(o*ke-Pe*G)/2:Math.sqrt(Math.pow(Pe-o,2)+Math.pow(ke-G,2))),o=Pe,G=ke}var We=H.length-3;H[2]=1,Pr(H,0,We,ee),H[We+2]=1,H.size=Math.abs(Le),H.start=0,H.end=H.size}function Rn(K,H,ee,he){for(var o=0;o<K.length;o++){var G=[];xr(K[o],G,ee,he),H.push(G)}}function Nr(K){return K/360+.5}function Ir(K){var H=Math.sin(K*Math.PI/180),ee=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return ee<0?0:ee>1?1:ee}function kr(K,H,ee,he,o,G,Le,Ie){if(he/=H,G>=(ee/=H)&&Le<he)return K;if(Le<ee||G>=he)return null;for(var Pe=[],ke=0;ke<K.length;ke++){var We=K[ke],at=We.geometry,$e=We.type,ht=o===0?We.minX:We.minY,Lt=o===0?We.maxX:We.maxY;if(ht>=ee&&Lt<he)Pe.push(We);else if(!(Lt<ee||ht>=he)){var Dt=[];if($e==="Point"||$e==="MultiPoint")rs(at,Dt,ee,he,o);else if($e==="LineString")kt(at,Dt,ee,he,o,!1,Ie.lineMetrics);else if($e==="MultiLineString")wn(at,Dt,ee,he,o,!1);else if($e==="Polygon")wn(at,Dt,ee,he,o,!0);else if($e==="MultiPolygon")for(var rn=0;rn<at.length;rn++){var jt=[];wn(at[rn],jt,ee,he,o,!0),jt.length&&Dt.push(jt)}if(Dt.length){if(Ie.lineMetrics&&$e==="LineString"){for(rn=0;rn<Dt.length;rn++)Pe.push(is(We.id,$e,Dt[rn],We.tags));continue}$e!=="LineString"&&$e!=="MultiLineString"||(Dt.length===1?($e="LineString",Dt=Dt[0]):$e="MultiLineString"),$e!=="Point"&&$e!=="MultiPoint"||($e=Dt.length===3?"Point":"MultiPoint"),Pe.push(is(We.id,$e,Dt,We.tags))}}}return Pe.length?Pe:null}function rs(K,H,ee,he,o){for(var G=0;G<K.length;G+=3){var Le=K[G+o];Le>=ee&&Le<=he&&(H.push(K[G]),H.push(K[G+1]),H.push(K[G+2]))}}function kt(K,H,ee,he,o,G,Le){for(var Ie,Pe,ke=Tn(K),We=o===0?vs:mn,at=K.start,$e=0;$e<K.length-3;$e+=3){var ht=K[$e],Lt=K[$e+1],Dt=K[$e+2],rn=K[$e+3],jt=K[$e+4],dn=o===0?ht:Lt,Qt=o===0?rn:jt,on=!1;Le&&(Ie=Math.sqrt(Math.pow(ht-rn,2)+Math.pow(Lt-jt,2))),dn<ee?Qt>ee&&(Pe=We(ke,ht,Lt,rn,jt,ee),Le&&(ke.start=at+Ie*Pe)):dn>he?Qt<he&&(Pe=We(ke,ht,Lt,rn,jt,he),Le&&(ke.start=at+Ie*Pe)):Ii(ke,ht,Lt,Dt),Qt<ee&&dn>=ee&&(Pe=We(ke,ht,Lt,rn,jt,ee),on=!0),Qt>he&&dn<=he&&(Pe=We(ke,ht,Lt,rn,jt,he),on=!0),!G&&on&&(Le&&(ke.end=at+Ie*Pe),H.push(ke),ke=Tn(K)),Le&&(at+=Ie)}var vn=K.length-3;ht=K[vn],Lt=K[vn+1],Dt=K[vn+2],(dn=o===0?ht:Lt)>=ee&&dn<=he&&Ii(ke,ht,Lt,Dt),vn=ke.length-3,G&&vn>=3&&(ke[vn]!==ke[0]||ke[vn+1]!==ke[1])&&Ii(ke,ke[0],ke[1],ke[2]),ke.length&&H.push(ke)}function Tn(K){var H=[];return H.size=K.size,H.start=K.start,H.end=K.end,H}function wn(K,H,ee,he,o,G){for(var Le=0;Le<K.length;Le++)kt(K[Le],H,ee,he,o,G,!1)}function Ii(K,H,ee,he){K.push(H),K.push(ee),K.push(he)}function vs(K,H,ee,he,o,G){var Le=(G-H)/(he-H);return K.push(G),K.push(ee+(o-ee)*Le),K.push(1),Le}function mn(K,H,ee,he,o,G){var Le=(G-ee)/(o-ee);return K.push(H+(he-H)*Le),K.push(G),K.push(1),Le}function qe(K,H){for(var ee=[],he=0;he<K.length;he++){var o,G=K[he],Le=G.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")o=$i(G.geometry,H);else if(Le==="MultiLineString"||Le==="Polygon"){o=[];for(var Ie=0;Ie<G.geometry.length;Ie++)o.push($i(G.geometry[Ie],H))}else if(Le==="MultiPolygon")for(o=[],Ie=0;Ie<G.geometry.length;Ie++){for(var Pe=[],ke=0;ke<G.geometry[Ie].length;ke++)Pe.push($i(G.geometry[Ie][ke],H));o.push(Pe)}ee.push(is(G.id,Le,o,G.tags))}return ee}function $i(K,H){var ee=[];ee.size=K.size,K.start!==void 0&&(ee.start=K.start,ee.end=K.end);for(var he=0;he<K.length;he+=3)ee.push(K[he]+H,K[he+1],K[he+2]);return ee}function zs(K,H){if(K.transformed)return K;var ee,he,o,G=1<<K.z,Le=K.x,Ie=K.y;for(ee=0;ee<K.features.length;ee++){var Pe=K.features[ee],ke=Pe.geometry,We=Pe.type;if(Pe.geometry=[],We===1)for(he=0;he<ke.length;he+=2)Pe.geometry.push(Ri(ke[he],ke[he+1],H,G,Le,Ie));else for(he=0;he<ke.length;he++){var at=[];for(o=0;o<ke[he].length;o+=2)at.push(Ri(ke[he][o],ke[he][o+1],H,G,Le,Ie));Pe.geometry.push(at)}}return K.transformed=!0,K}function Ri(K,H,ee,he,o,G){return[Math.round(ee*(K*he-o)),Math.round(ee*(H*he-G))]}function or(K,H,ee,he,o){for(var G=H===o.maxZoom?0:o.tolerance/((1<<H)*o.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ee,y:he,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ie=0;Ie<K.length;Ie++){Le.numFeatures++,qn(Le,K[Ie],G,o);var Pe=K[Ie].minX,ke=K[Ie].minY,We=K[Ie].maxX,at=K[Ie].maxY;Pe<Le.minX&&(Le.minX=Pe),ke<Le.minY&&(Le.minY=ke),We>Le.maxX&&(Le.maxX=We),at>Le.maxY&&(Le.maxY=at)}return Le}function qn(K,H,ee,he){var o=H.geometry,G=H.type,Le=[];if(G==="Point"||G==="MultiPoint")for(var Ie=0;Ie<o.length;Ie+=3)Le.push(o[Ie]),Le.push(o[Ie+1]),K.numPoints++,K.numSimplified++;else if(G==="LineString")Os(Le,o,K,ee,!1,!1);else if(G==="MultiLineString"||G==="Polygon")for(Ie=0;Ie<o.length;Ie++)Os(Le,o[Ie],K,ee,G==="Polygon",Ie===0);else if(G==="MultiPolygon")for(var Pe=0;Pe<o.length;Pe++){var ke=o[Pe];for(Ie=0;Ie<ke.length;Ie++)Os(Le,ke[Ie],K,ee,!0,Ie===0)}if(Le.length){var We=H.tags||null;if(G==="LineString"&&he.lineMetrics){for(var at in We={},H.tags)We[at]=H.tags[at];We.mapbox_clip_start=o.start/o.size,We.mapbox_clip_end=o.end/o.size}var $e={geometry:Le,type:G==="Polygon"||G==="MultiPolygon"?3:G==="LineString"||G==="MultiLineString"?2:1,tags:We};H.id!==null&&($e.id=H.id),K.features.push($e)}}function Os(K,H,ee,he,o,G){var Le=he*he;if(he>0&&H.size<(o?Le:he))ee.numPoints+=H.length/3;else{for(var Ie=[],Pe=0;Pe<H.length;Pe+=3)(he===0||H[Pe+2]>Le)&&(ee.numSimplified++,Ie.push(H[Pe]),Ie.push(H[Pe+1])),ee.numPoints++;o&&function(ke,We){for(var at=0,$e=0,ht=ke.length,Lt=ht-2;$e<ht;Lt=$e,$e+=2)at+=(ke[$e]-ke[Lt])*(ke[$e+1]+ke[Lt+1]);if(at>0===We)for($e=0,ht=ke.length;$e<ht/2;$e+=2){var Dt=ke[$e],rn=ke[$e+1];ke[$e]=ke[ht-2-$e],ke[$e+1]=ke[ht-1-$e],ke[ht-2-$e]=Dt,ke[ht-1-$e]=rn}}(Ie,G),K.push(Ie)}}function Ur(K,H){var ee=(H=this.options=function(o,G){for(var Le in G)o[Le]=G[Le];return o}(Object.create(this.options),H)).debug;if(ee&&console.time("preprocess data"),H.maxZoom<0||H.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(H.promoteId&&H.generateId)throw new Error("promoteId and generateId cannot be used together.");var he=function(o,G){var Le=[];if(o.type==="FeatureCollection")for(var Ie=0;Ie<o.features.length;Ie++)It(Le,o.features[Ie],G,Ie);else It(Le,o.type==="Feature"?o:{geometry:o},G);return Le}(K,H);this.tiles={},this.tileCoords=[],ee&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",H.indexMaxZoom,H.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),he=function(o,G){var Le=G.buffer/G.extent,Ie=o,Pe=kr(o,1,-1-Le,Le,0,-1,2,G),ke=kr(o,1,1-Le,2+Le,0,-1,2,G);return(Pe||ke)&&(Ie=kr(o,1,-Le,1+Le,0,-1,2,G)||[],Pe&&(Ie=qe(Pe,1).concat(Ie)),ke&&(Ie=Ie.concat(qe(ke,-1)))),Ie}(he,H),he.length&&this.splitTile(he,0,0,0),ee&&(he.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Vr(K,H,ee){return 32*((1<<K)*ee+H)+K}function Lr(K,H){const ee=K.tileID.canonical;if(!this._geoJSONIndex)return H(null,null);const he=this._geoJSONIndex.getTile(ee.z,ee.x,ee.y);if(!he)return H(null,null);const o=new Me(he.features);let G=He.exports(o);G.byteOffset===0&&G.byteLength===G.buffer.byteLength||(G=new Uint8Array(G)),H(null,{vectorTile:o,rawData:G.buffer})}Ur.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ur.prototype.splitTile=function(K,H,ee,he,o,G,Le){for(var Ie=[K,H,ee,he],Pe=this.options,ke=Pe.debug;Ie.length;){he=Ie.pop(),ee=Ie.pop(),H=Ie.pop(),K=Ie.pop();var We=1<<H,at=Vr(H,ee,he),$e=this.tiles[at];if(!$e&&(ke>1&&console.time("creation"),$e=this.tiles[at]=or(K,H,ee,he,Pe),this.tileCoords.push({z:H,x:ee,y:he}),ke)){ke>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",H,ee,he,$e.numFeatures,$e.numPoints,$e.numSimplified),console.timeEnd("creation"));var ht="z"+H;this.stats[ht]=(this.stats[ht]||0)+1,this.total++}if($e.source=K,o){if(H===Pe.maxZoom||H===o)continue;var Lt=1<<o-H;if(ee!==Math.floor(G/Lt)||he!==Math.floor(Le/Lt))continue}else if(H===Pe.indexMaxZoom||$e.numPoints<=Pe.indexMaxPoints)continue;if($e.source=null,K.length!==0){ke>1&&console.time("clipping");var Dt,rn,jt,dn,Qt,on,vn=.5*Pe.buffer/Pe.extent,Ot=.5-vn,Oe=.5+vn,Mt=1+vn;Dt=rn=jt=dn=null,Qt=kr(K,We,ee-vn,ee+Oe,0,$e.minX,$e.maxX,Pe),on=kr(K,We,ee+Ot,ee+Mt,0,$e.minX,$e.maxX,Pe),K=null,Qt&&(Dt=kr(Qt,We,he-vn,he+Oe,1,$e.minY,$e.maxY,Pe),rn=kr(Qt,We,he+Ot,he+Mt,1,$e.minY,$e.maxY,Pe),Qt=null),on&&(jt=kr(on,We,he-vn,he+Oe,1,$e.minY,$e.maxY,Pe),dn=kr(on,We,he+Ot,he+Mt,1,$e.minY,$e.maxY,Pe),on=null),ke>1&&console.timeEnd("clipping"),Ie.push(Dt||[],H+1,2*ee,2*he),Ie.push(rn||[],H+1,2*ee,2*he+1),Ie.push(jt||[],H+1,2*ee+1,2*he),Ie.push(dn||[],H+1,2*ee+1,2*he+1)}}},Ur.prototype.getTile=function(K,H,ee){var he=this.options,o=he.extent,G=he.debug;if(K<0||K>24)return null;var Le=1<<K,Ie=Vr(K,H=(H%Le+Le)%Le,ee);if(this.tiles[Ie])return zs(this.tiles[Ie],o);G>1&&console.log("drilling down to z%d-%d-%d",K,H,ee);for(var Pe,ke=K,We=H,at=ee;!Pe&&ke>0;)ke--,We=Math.floor(We/2),at=Math.floor(at/2),Pe=this.tiles[Vr(ke,We,at)];return Pe&&Pe.source?(G>1&&console.log("found parent tile z%d-%d-%d",ke,We,at),G>1&&console.time("drilling down"),this.splitTile(Pe.source,ke,We,at,K,H,ee),G>1&&console.timeEnd("drilling down"),this.tiles[Ie]?zs(this.tiles[Ie],o):null):null};class ss extends Z{constructor(H,ee,he,o){super(H,ee,he,Lr),o&&(this.loadGeoJSON=o)}loadData(H,ee){var he;(he=this._pendingRequest)===null||he===void 0||he.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const o=!!(H&&H.request&&H.request.collectResourceTiming)&&new a.RequestPerformance(H.request);this._pendingCallback=ee,this._pendingRequest=this.loadGeoJSON(H,(G,Le)=>{if(delete this._pendingCallback,delete this._pendingRequest,G||!Le)return ee(G);if(typeof Le!="object")return ee(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`));{Y(Le,!0);try{if(H.filter){const Pe=a.createExpression(H.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Pe.result==="error")throw new Error(Pe.value.map(We=>`${We.key}: ${We.message}`).join(", "));Le={type:"FeatureCollection",features:Le.features.filter(We=>Pe.value.evaluate({zoom:0},We))}}this._geoJSONIndex=H.cluster?new $n(function({superclusterOptions:Pe,clusterProperties:ke}){if(!ke||!Pe)return Pe;const We={},at={},$e={accumulated:null,zoom:0},ht={properties:null},Lt=Object.keys(ke);for(const Dt of Lt){const[rn,jt]=ke[Dt],dn=a.createExpression(jt),Qt=a.createExpression(typeof rn=="string"?[rn,["accumulated"],["get",Dt]]:rn);We[Dt]=dn.value,at[Dt]=Qt.value}return Pe.map=Dt=>{ht.properties=Dt;const rn={};for(const jt of Lt)rn[jt]=We[jt].evaluate($e,ht);return rn},Pe.reduce=(Dt,rn)=>{ht.properties=rn;for(const jt of Lt)$e.accumulated=Dt[jt],Dt[jt]=at[jt].evaluate($e,ht)},Pe}(H)).load(Le.features):function(Pe,ke){return new Ur(Pe,ke)}(Le,H.geojsonVtOptions)}catch(Pe){return ee(Pe)}this.loaded={};const Ie={};if(o){const Pe=o.finish();Pe&&(Ie.resourceTiming={},Ie.resourceTiming[H.source]=JSON.parse(JSON.stringify(Pe)))}ee(null,Ie)}})}reloadTile(H,ee){const he=this.loaded;return he&&he[H.uid]?super.reloadTile(H,ee):this.loadTile(H,ee)}loadGeoJSON(H,ee){if(H.request)return a.getJSON(H.request,ee);if(typeof H.data=="string")try{ee(null,JSON.parse(H.data))}catch{ee(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`))}else ee(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(H,ee){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ee()}getClusterExpansionZoom(H,ee){try{ee(null,this._geoJSONIndex.getClusterExpansionZoom(H.clusterId))}catch(he){ee(he)}}getClusterChildren(H,ee){try{ee(null,this._geoJSONIndex.getChildren(H.clusterId))}catch(he){ee(he)}}getClusterLeaves(H,ee){try{ee(null,this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset))}catch(he){ee(he)}}}class Bi{constructor(H){this.self=H,this.actor=new a.Actor(H,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Z,geojson:ss},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ee,he)=>{if(this.workerSourceTypes[ee])throw new Error(`Worker source with name "${ee}" already registered.`);this.workerSourceTypes[ee]=he},this.self.registerRTLTextPlugin=ee=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=ee.applyArabicShaping,a.plugin.processBidirectionalText=ee.processBidirectionalText,a.plugin.processStyledBidirectionalText=ee.processStyledBidirectionalText}}setReferrer(H,ee){this.referrer=ee}setImages(H,ee,he){this.availableImages[H]=ee;for(const o in this.workerSources[H]){const G=this.workerSources[H][o];for(const Le in G)G[Le].availableImages=ee}he()}setLayers(H,ee,he){this.getLayerIndex(H).replace(ee),he()}updateLayers(H,ee,he){this.getLayerIndex(H).update(ee.layers,ee.removedIds),he()}loadTile(H,ee,he){this.getWorkerSource(H,ee.type,ee.source).loadTile(ee,he)}loadDEMTile(H,ee,he){this.getDEMWorkerSource(H,ee.source).loadTile(ee,he)}reloadTile(H,ee,he){this.getWorkerSource(H,ee.type,ee.source).reloadTile(ee,he)}abortTile(H,ee,he){this.getWorkerSource(H,ee.type,ee.source).abortTile(ee,he)}removeTile(H,ee,he){this.getWorkerSource(H,ee.type,ee.source).removeTile(ee,he)}removeDEMTile(H,ee){this.getDEMWorkerSource(H,ee.source).removeTile(ee)}removeSource(H,ee,he){if(!this.workerSources[H]||!this.workerSources[H][ee.type]||!this.workerSources[H][ee.type][ee.source])return;const o=this.workerSources[H][ee.type][ee.source];delete this.workerSources[H][ee.type][ee.source],o.removeSource!==void 0?o.removeSource(ee,he):he()}loadWorkerSource(H,ee,he){try{this.self.importScripts(ee.url),he()}catch(o){he(o.toString())}}syncRTLPluginState(H,ee,he){try{a.plugin.setState(ee);const o=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&o!=null){this.self.importScripts(o);const G=a.plugin.isParsed();he(G?void 0:new Error(`RTL Text Plugin failed to import scripts from ${o}`),G)}}catch(o){he(o.toString())}}getAvailableImages(H){let ee=this.availableImages[H];return ee||(ee=[]),ee}getLayerIndex(H){let ee=this.layerIndexes[H];return ee||(ee=this.layerIndexes[H]=new I),ee}getWorkerSource(H,ee,he){if(this.workerSources[H]||(this.workerSources[H]={}),this.workerSources[H][ee]||(this.workerSources[H][ee]={}),!this.workerSources[H][ee][he]){const o={send:(G,Le,Ie)=>{this.actor.send(G,Le,Ie,H)}};this.workerSources[H][ee][he]=new this.workerSourceTypes[ee](o,this.getLayerIndex(H),this.getAvailableImages(H))}return this.workerSources[H][ee][he]}getDEMWorkerSource(H,ee){return this.demWorkerSources[H]||(this.demWorkerSources[H]={}),this.demWorkerSources[H][ee]||(this.demWorkerSources[H][ee]=new ae),this.demWorkerSources[H][ee]}enforceCacheSizeLimit(H,ee){a.enforceCacheSizeLimit(ee)}}return a.isWorker()&&(self.worker=new Bi(self)),Bi}),s(["./shared"],function(a){var y=w;function w(k){return!function(c){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var l,h,d=new Blob([""],{type:"text/javascript"}),x=URL.createObjectURL(d);try{h=new Worker(x),l=!0}catch{l=!1}return h&&h.terminate(),URL.revokeObjectURL(x),l}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var l=document.createElement("canvas");l.width=l.height=1;var h=l.getContext("2d");if(!h)return!1;var d=h.getImageData(0,0,1,1);return d&&d.width===l.width}()?(I[_=c&&c.failIfMajorPerformanceCaveat]===void 0&&(I[_]=function(l){var h,d=function(x){var b=document.createElement("canvas"),S=Object.create(w.webGLContextAttributes);return S.failIfMajorPerformanceCaveat=x,b.getContext("webgl",S)||b.getContext("experimental-webgl",S)}(l);if(!d)return!1;try{h=d.createShader(d.VERTEX_SHADER)}catch{return!1}return!(!h||d.isContextLost())&&(d.shaderSource(h,"void main() {}"),d.compileShader(h),d.getShaderParameter(h,d.COMPILE_STATUS)===!0)}(_)),I[_]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var _}(k)}var I={};function P(k,c){if(Array.isArray(k)){if(!Array.isArray(c)||k.length!==c.length)return!1;for(let _=0;_<k.length;_++)if(!P(k[_],c[_]))return!1;return!0}if(typeof k=="object"&&k!==null&&c!==null){if(typeof c!="object"||Object.keys(k).length!==Object.keys(c).length)return!1;for(const _ in k)if(!P(k[_],c[_]))return!1;return!0}return k===c}w.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class L{static testProp(c){if(!L.docStyle)return c[0];for(let _=0;_<c.length;_++)if(c[_]in L.docStyle)return c[_];return c[0]}static create(c,_,l){const h=window.document.createElement(c);return _!==void 0&&(h.className=_),l&&l.appendChild(h),h}static createNS(c,_){return window.document.createElementNS(c,_)}static disableDrag(){L.docStyle&&L.selectProp&&(L.userSelect=L.docStyle[L.selectProp],L.docStyle[L.selectProp]="none")}static enableDrag(){L.docStyle&&L.selectProp&&(L.docStyle[L.selectProp]=L.userSelect)}static setTransform(c,_){c.style[L.transformProp]=_}static addEventListener(c,_,l,h={}){c.addEventListener(_,l,"passive"in h?h:h.capture)}static removeEventListener(c,_,l,h={}){c.removeEventListener(_,l,"passive"in h?h:h.capture)}static suppressClickInternal(c){c.preventDefault(),c.stopPropagation(),window.removeEventListener("click",L.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",L.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",L.suppressClickInternal,!0)},0)}static mousePos(c,_){const l=c.getBoundingClientRect();return new a.pointGeometry(_.clientX-l.left-c.clientLeft,_.clientY-l.top-c.clientTop)}static touchPos(c,_){const l=c.getBoundingClientRect(),h=[];for(let d=0;d<_.length;d++)h.push(new a.pointGeometry(_[d].clientX-l.left-c.clientLeft,_[d].clientY-l.top-c.clientTop));return h}static mouseButton(c){return c.button}static remove(c){c.parentNode&&c.parentNode.removeChild(c)}}L.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,L.selectProp=L.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),L.transformProp=L.testProp(["transform","WebkitTransform"]);class U{constructor(c){this._transformRequestFn=c}transformRequest(c,_){return this._transformRequestFn&&this._transformRequestFn(c,_)||{url:c}}normalizeSpriteURL(c,_,l){const h=function(d){const x=d.match(Q);if(!x)throw new Error(`Unable to parse URL "${d}"`);return{protocol:x[1],authority:x[2],path:x[3]||"/",params:x[4]?x[4].split("&"):[]}}(c);return h.path+=`${_}${l}`,function(d){const x=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${x}`}(h)}setTransformRequest(c){this._transformRequestFn=c}}const Q=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class Z{constructor(c,_,l,h){this.context=c,this.format=l,this.texture=c.gl.createTexture(),this.update(_,h)}update(c,_,l){const{width:h,height:d}=c,x=!(this.size&&this.size[0]===h&&this.size[1]===d||l),{context:b}=this,{gl:S}=b;if(this.useMipmap=!!(_&&_.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!_||_.premultiply!==!1)),x)this.size=[h,d],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||a.isImageBitmap(c)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,c):S.texImage2D(S.TEXTURE_2D,0,this.format,h,d,0,this.format,S.UNSIGNED_BYTE,c.data);else{const{x:M,y:B}=l||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||a.isImageBitmap(c)?S.texSubImage2D(S.TEXTURE_2D,0,M,B,S.RGBA,S.UNSIGNED_BYTE,c):S.texSubImage2D(S.TEXTURE_2D,0,M,B,h,d,S.RGBA,S.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)}bind(c,_,l){const{context:h}=this,{gl:d}=h;d.bindTexture(d.TEXTURE_2D,this.texture),l!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=d.LINEAR),c!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,c),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,l||c),this.filter=c),_!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,_),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,_),this.wrap=_)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}function ae(k){const{userImage:c}=k;return!!(c&&c.render&&c.render())&&(k.data.replace(new Uint8Array(c.data.buffer)),!0)}class Y extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:_,callback:l}of this.requestors)this._notify(_,l);this.requestors=[]}}getImage(c){return this.images[c]}addImage(c,_){if(this.images[c])throw new Error(`Image id ${c} already exist, use updateImage instead`);this._validate(c,_)&&(this.images[c]=_)}_validate(c,_){let l=!0;return this._validateStretch(_.stretchX,_.data&&_.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),l=!1),this._validateStretch(_.stretchY,_.data&&_.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),l=!1),this._validateContent(_.content,_)||(this.fire(new a.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),l=!1),l}_validateStretch(c,_){if(!c)return!0;let l=0;for(const h of c){if(h[0]<l||h[1]<h[0]||_<h[1])return!1;l=h[1]}return!0}_validateContent(c,_){return!(c&&(c.length!==4||c[0]<0||_.data.width<c[0]||c[1]<0||_.data.height<c[1]||c[2]<0||_.data.width<c[2]||c[3]<0||_.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,_){const l=this.images[c];if(l.data.width!==_.data.width||l.data.height!==_.data.height)throw new Error(`size mismatch between old image (${l.data.width}x${l.data.height}) and new image (${_.data.width}x${_.data.height}).`);_.version=l.version+1,this.images[c]=_,this.updatedImages[c]=!0}removeImage(c){const _=this.images[c];delete this.images[c],delete this.patterns[c],_.userImage&&_.userImage.onRemove&&_.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,_){let l=!0;if(!this.isLoaded())for(const h of c)this.images[h]||(l=!1);this.isLoaded()||l?this._notify(c,_):this.requestors.push({ids:c,callback:_})}_notify(c,_){const l={};for(const h of c){this.images[h]||this.fire(new a.Event("styleimagemissing",{id:h}));const d=this.images[h];d?l[h]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:a.warnOnce(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}_(null,l)}getPixelSize(){const{width:c,height:_}=this.atlasImage;return{width:c,height:_}}getPattern(c){const _=this.patterns[c],l=this.getImage(c);if(!l)return null;if(_&&_.position.version===l.version)return _.position;if(_)_.position.version=l.version;else{const h={w:l.data.width+2,h:l.data.height+2,x:0,y:0},d=new a.ImagePosition(h,l);this.patterns[c]={bin:h,position:d}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const _=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Z(c,this.atlasImage,_.RGBA),this.atlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const d in this.patterns)c.push(this.patterns[d].bin);const{w:_,h:l}=a.potpack(c),h=this.atlasImage;h.resize({width:_||1,height:l||1});for(const d in this.patterns){const{bin:x}=this.patterns[d],b=x.x+1,S=x.y+1,M=this.images[d].data,B=M.width,V=M.height;a.RGBAImage.copy(M,h,{x:0,y:0},{x:b,y:S},{width:B,height:V}),a.RGBAImage.copy(M,h,{x:0,y:V-1},{x:b,y:S-1},{width:B,height:1}),a.RGBAImage.copy(M,h,{x:0,y:0},{x:b,y:S+V},{width:B,height:1}),a.RGBAImage.copy(M,h,{x:B-1,y:0},{x:b-1,y:S},{width:1,height:V}),a.RGBAImage.copy(M,h,{x:0,y:0},{x:b+B,y:S},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const _ of c){if(this.callbackDispatchedThisFrame[_])continue;this.callbackDispatchedThisFrame[_]=!0;const l=this.images[_];l||a.warnOnce(`Image with ID: "${_}" was not found`),ae(l)&&this.updateImage(_,l)}}}const te=1e20;function re(k,c,_,l,h,d,x,b,S){for(let M=c;M<c+l;M++)de(k,_*d+M,d,h,x,b,S);for(let M=_;M<_+h;M++)de(k,M*d+c,1,l,x,b,S)}function de(k,c,_,l,h,d,x){d[0]=0,x[0]=-te,x[1]=te,h[0]=k[c];for(let b=1,S=0,M=0;b<l;b++){h[b]=k[c+b*_];const B=b*b;do{const V=d[S];M=(h[b]-h[V]+B-V*V)/(b-V)/2}while(M<=x[S]&&--S>-1);S++,d[S]=b,x[S]=M,x[S+1]=te}for(let b=0,S=0;b<l;b++){for(;x[S+1]<b;)S++;const M=d[S],B=b-M;k[c+b*_]=h[M]+B*B}}class ve{constructor(c,_){this.requestManager=c,this.localIdeographFontFamily=_,this.entries={}}setURL(c){this.url=c}getGlyphs(c,_){const l=[];for(const h in c)for(const d of c[h])l.push({stack:h,id:d});a.asyncAll(l,({stack:h,id:d},x)=>{let b=this.entries[h];b||(b=this.entries[h]={glyphs:{},requests:{},ranges:{}});let S=b.glyphs[d];if(S!==void 0)return void x(null,{stack:h,id:d,glyph:S});if(S=this._tinySDF(b,h,d),S)return b.glyphs[d]=S,void x(null,{stack:h,id:d,glyph:S});const M=Math.floor(d/256);if(256*M>65535)return void x(new Error("glyphs > 65535 not supported"));if(b.ranges[M])return void x(null,{stack:h,id:d,glyph:S});let B=b.requests[M];B||(B=b.requests[M]=[],ve.loadGlyphRange(h,M,this.url,this.requestManager,(V,$)=>{if($){for(const X in $)this._doesCharSupportLocalGlyph(+X)||(b.glyphs[+X]=$[+X]);b.ranges[M]=!0}for(const X of B)X(V,$);delete b.requests[M]})),B.push((V,$)=>{V?x(V):$&&x(null,{stack:h,id:d,glyph:$[d]||null})})},(h,d)=>{if(h)_(h);else if(d){const x={};for(const{stack:b,id:S,glyph:M}of d)(x[b]||(x[b]={}))[S]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};_(null,x)}})}_doesCharSupportLocalGlyph(c){return!!this.localIdeographFontFamily&&(a.unicodeBlockLookup["CJK Unified Ideographs"](c)||a.unicodeBlockLookup["Hangul Syllables"](c)||a.unicodeBlockLookup.Hiragana(c)||a.unicodeBlockLookup.Katakana(c))}_tinySDF(c,_,l){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let d=c.tinySDF;if(!d){let b="400";/bold/i.test(_)?b="900":/medium/i.test(_)?b="500":/light/i.test(_)&&(b="200"),d=c.tinySDF=new ve.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:h,fontWeight:b})}const x=d.draw(String.fromCharCode(l));return{id:l,bitmap:new a.AlphaImage({width:x.width||30,height:x.height||30},x.data),metrics:{width:x.glyphWidth||24,height:x.glyphHeight||24,left:x.glyphLeft||0,top:x.glyphTop-27||-8,advance:x.glyphAdvance||24}}}}ve.loadGlyphRange=function(k,c,_,l,h){const d=256*c,x=d+255,b=l.transformRequest(_.replace("{fontstack}",k).replace("{range}",`${d}-${x}`),a.ResourceType.Glyphs);a.getArrayBuffer(b,(S,M)=>{if(S)h(S);else if(M){const B={};for(const V of a.parseGlyphPbf(M))B[V.id]=V;h(null,B)}})},ve.TinySDF=class{constructor({fontSize:k=24,buffer:c=3,radius:_=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:d="normal",fontStyle:x="normal"}={}){this.buffer=c,this.cutoff=l,this.radius=_;const b=this.size=k+4*c,S=this._createCanvas(b),M=this.ctx=S.getContext("2d",{willReadFrequently:!0});M.font=`${x} ${d} ${k}px ${h}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(k){const c=document.createElement("canvas");return c.width=c.height=k,c}draw(k){const{width:c,actualBoundingBoxAscent:_,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:d}=this.ctx.measureText(k),x=Math.ceil(_),b=Math.min(this.size-this.buffer,Math.ceil(d-h)),S=Math.min(this.size-this.buffer,x+Math.ceil(l)),M=b+2*this.buffer,B=S+2*this.buffer,V=Math.max(M*B,0),$=new Uint8ClampedArray(V),X={data:$,width:M,height:B,glyphWidth:b,glyphHeight:S,glyphTop:x,glyphLeft:0,glyphAdvance:c};if(b===0||S===0)return X;const{ctx:se,buffer:ne,gridInner:ue,gridOuter:be}=this;se.clearRect(ne,ne,b,S),se.fillText(k,ne,ne+x);const Ce=se.getImageData(ne,ne,b,S);be.fill(te,0,V),ue.fill(0,0,V);for(let _e=0;_e<S;_e++)for(let Ge=0;Ge<b;Ge++){const Te=Ce.data[4*(_e*b+Ge)+3]/255;if(Te===0)continue;const Ue=(_e+ne)*M+Ge+ne;if(Te===1)be[Ue]=0,ue[Ue]=te;else{const xe=.5-Te;be[Ue]=xe>0?xe*xe:0,ue[Ue]=xe<0?xe*xe:0}}re(be,0,0,M,B,M,this.f,this.v,this.z),re(ue,ne,ne,b,S,M,this.f,this.v,this.z);for(let _e=0;_e<V;_e++){const Ge=Math.sqrt(be[_e])-Math.sqrt(ue[_e]);$[_e]=Math.round(255-255*(Ge/this.radius+this.cutoff))}return X}};const Me=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(k,c){return a.sphericalToCartesian(k.expression.evaluate(c))}interpolate(k,c,_){return{x:a.number(k.x,c.x,_),y:a.number(k.y,c.y,_),z:a.number(k.z,c.z,_)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),He="-transition";class Qe extends a.Evented{constructor(c){super(),this._transitionable=new a.Transitionable(Me),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,_={}){if(!this._validate(a.validateLight,c,_))for(const l in c){const h=c[l];l.endsWith(He)?this._transitionable.setTransition(l.slice(0,-He.length),h):this._transitionable.setValue(l,h)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,_,l){return(!l||l.validate!==!1)&&a.emitValidationErrors(this,c.call(a.validateStyle,a.extend({value:_,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class et{constructor(c,_){this.width=c,this.height=_,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(c,_){const l=c.join(",")+String(_);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(c,_)),this.dashEntry[l]}getDashRanges(c,_,l){const h=[];let d=c.length%2==1?-c[c.length-1]*l:0,x=c[0]*l,b=!0;h.push({left:d,right:x,isDash:b,zeroLength:c[0]===0});let S=c[0];for(let M=1;M<c.length;M++){b=!b;const B=c[M];d=S*l,S+=B,x=S*l,h.push({left:d,right:x,isDash:b,zeroLength:B===0})}return h}addRoundDash(c,_,l){const h=_/2;for(let d=-l;d<=l;d++){const x=this.width*(this.nextRow+l+d);let b=0,S=c[b];for(let M=0;M<this.width;M++){M/S.right>1&&(S=c[++b]);const B=Math.abs(M-S.left),V=Math.abs(M-S.right),$=Math.min(B,V);let X;const se=d/l*(h+1);if(S.isDash){const ne=h-Math.abs(se);X=Math.sqrt($*$+ne*ne)}else X=h-Math.sqrt($*$+se*se);this.data[x+M]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(c){for(let b=c.length-1;b>=0;--b){const S=c[b],M=c[b+1];S.zeroLength?c.splice(b,1):M&&M.isDash===S.isDash&&(M.left=S.left,c.splice(b,1))}const _=c[0],l=c[c.length-1];_.isDash===l.isDash&&(_.left=l.left-this.width,l.right=_.right+this.width);const h=this.width*this.nextRow;let d=0,x=c[d];for(let b=0;b<this.width;b++){b/x.right>1&&(x=c[++d]);const S=Math.abs(b-x.left),M=Math.abs(b-x.right),B=Math.min(S,M);this.data[h+b]=Math.max(0,Math.min(255,(x.isDash?B:-B)+128))}}addDash(c,_){const l=_?7:0,h=2*l+1;if(this.nextRow+h>this.height)return a.warnOnce("LineAtlas out of space"),null;let d=0;for(let b=0;b<c.length;b++)d+=c[b];if(d!==0){const b=this.width/d,S=this.getDashRanges(c,this.width,b);_?this.addRoundDash(S,b,l):this.addRegularDash(S)}const x={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:d};return this.nextRow+=h,this.dirty=!0,x}bind(c){const _=c.gl;this.texture?(_.bindTexture(_.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,_.texSubImage2D(_.TEXTURE_2D,0,0,0,this.width,this.height,_.ALPHA,_.UNSIGNED_BYTE,this.data))):(this.texture=_.createTexture(),_.bindTexture(_.TEXTURE_2D,this.texture),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.REPEAT),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.REPEAT),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texImage2D(_.TEXTURE_2D,0,_.ALPHA,this.width,this.height,0,_.ALPHA,_.UNSIGNED_BYTE,this.data))}}class tt{constructor(c,_){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const l=this.workerPool.acquire(this.id);for(let h=0;h<l.length;h++){const d=new tt.Actor(l[h],_,this.id);d.name=`Worker ${h}`,this.actors.push(d)}if(!this.actors.length)throw new Error("No actors found")}broadcast(c,_,l){a.asyncAll(this.actors,(h,d)=>{h.send(c,_,d)},l=l||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ve(k,c,_){const l=function(h,d){if(h)return _(h);if(d){const x=a.pick(a.extend(d,k),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);d.vector_layers&&(x.vectorLayers=d.vector_layers,x.vectorLayerIds=x.vectorLayers.map(b=>b.id)),_(null,x)}};return k.url?a.getJSON(c.transformRequest(k.url,a.ResourceType.Source),l):a.exported.frame(()=>l(null,k))}tt.Actor=a.Actor;class nt{constructor(c,_,l){this.bounds=a.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=_||0,this.maxzoom=l||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const _=Math.pow(2,c.z),l=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*_),h=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*_),d=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*_),x=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*_);return c.x>=l&&c.x<d&&c.y>=h&&c.y<x}}class Ye extends a.Evented{constructor(c,_,l,h){if(super(),this.id=c,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(_,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},_),this._collectResourceTiming=_.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ve(this._options,this.map._requestManager,(c,_)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),c?this.fire(new a.ErrorEvent(c)):_&&(a.extend(this,_),_.bounds&&(this.tileBounds=new nt(_.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}setSourceProperty(c){this._tileJSONRequest&&this._tileJSONRequest.cancel(),c(),this.load()}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}setUrl(c){return this.setSourceProperty(()=>{this.url=c,this._options.url=c}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(c,_){const l=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h={request:this.map._requestManager.transformRequest(l,a.ResourceType.Tile),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function d(x,b){return delete c.request,c.aborted?_(null):x&&x.status!==404?_(x):(b&&b.resourceTiming&&(c.resourceTiming=b.resourceTiming),this.map._refreshExpiredTiles&&b&&c.setExpiryData(b),c.loadVectorData(b,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),_(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}h.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired"?c.state==="loading"?c.reloadCallback=_:c.request=c.actor.send("reloadTile",h,d.bind(this)):(c.actor=this.dispatcher.getActor(),c.request=c.actor.send("loadTile",h,d.bind(this)))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id},void 0)}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class gt extends a.Evented{constructor(c,_,l,h){super(),this.id=c,this.dispatcher=l,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},_),a.extend(this,a.pick(_,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ve(this._options,this.map._requestManager,(c,_)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new a.ErrorEvent(c)):_&&(a.extend(this,_),_.bounds&&(this.tileBounds=new nt(_.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,_){const l=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);c.request=a.getImage(this.map._requestManager.transformRequest(l,a.ResourceType.Tile),(h,d,x)=>{if(delete c.request,c.aborted)c.state="unloaded",_(null);else if(h)c.state="errored",_(h);else if(d){this.map._refreshExpiredTiles&&c.setExpiryData(x);const b=this.map.painter.context,S=b.gl;c.texture=this.map.painter.getTileTexture(d.width),c.texture?c.texture.update(d,{useMipmap:!0}):(c.texture=new Z(b,d,S.RGBA,{useMipmap:!0}),c.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),b.extTextureFilterAnisotropic&&S.texParameterf(S.TEXTURE_2D,b.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,b.extTextureFilterAnisotropicMax)),c.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),_(null)}})}abortTile(c,_){c.request&&(c.request.cancel(),delete c.request),_()}unloadTile(c,_){c.texture&&this.map.painter.saveTileTexture(c.texture),_()}hasTransition(){return!1}}let Xt;class Et extends gt{constructor(c,_,l,h){super(c,_,l,h),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},_),this.encoding=_.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(c,_){const l=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function h(d,x){d&&(c.state="errored",_(d)),x&&(c.dem=x,c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0,c.state="loaded",_(null))}c.request=a.getImage(this.map._requestManager.transformRequest(l,a.ResourceType.Tile),function(d,x){if(delete c.request,c.aborted)c.state="unloaded",_(null);else if(d)c.state="errored",_(d);else if(x){this.map._refreshExpiredTiles&&c.setExpiryData(x),delete x.cacheControl,delete x.expires;const b=a.isImageBitmap(x)&&(Xt==null&&(Xt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Xt)?x:a.exported.getImageData(x,1),S={uid:c.uid,coord:c.tileID,source:this.id,rawImageData:b,encoding:this.encoding};c.actor&&c.state!=="expired"||(c.actor=this.dispatcher.getActor(),c.actor.send("loadDEMTile",S,h.bind(this)))}}.bind(this)),c.neighboringTiles=this._getNeighboringTiles(c.tileID)}_getNeighboringTiles(c){const _=c.canonical,l=Math.pow(2,_.z),h=(_.x-1+l)%l,d=_.x===0?c.wrap-1:c.wrap,x=(_.x+1+l)%l,b=_.x+1===l?c.wrap+1:c.wrap,S={};return S[new a.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y).key]={backfilled:!1},S[new a.OverscaledTileID(c.overscaledZ,b,_.z,x,_.y).key]={backfilled:!1},_.y>0&&(S[new a.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y-1).key]={backfilled:!1},S[new a.OverscaledTileID(c.overscaledZ,c.wrap,_.z,_.x,_.y-1).key]={backfilled:!1},S[new a.OverscaledTileID(c.overscaledZ,b,_.z,x,_.y-1).key]={backfilled:!1}),_.y+1<l&&(S[new a.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y+1).key]={backfilled:!1},S[new a.OverscaledTileID(c.overscaledZ,c.wrap,_.z,_.x,_.y+1).key]={backfilled:!1},S[new a.OverscaledTileID(c.overscaledZ,b,_.z,x,_.y+1).key]={backfilled:!1}),S}unloadTile(c){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&c.actor.send("removeDEMTile",{uid:c.uid,source:this.id})}}class fn extends a.Evented{constructor(c,_,l,h){super(),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(h),this._data=_.data,this._options=a.extend({},_),this._collectResourceTiming=_.collectResourceTiming,_.maxzoom!==void 0&&(this.maxzoom=_.maxzoom),_.type&&(this.type=_.type),_.attribution&&(this.attribution=_.attribution),this.promoteId=_.promoteId;const d=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:_.cluster||!1,geojsonVtOptions:{buffer:(_.buffer!==void 0?_.buffer:128)*d,tolerance:(_.tolerance!==void 0?_.tolerance:.375)*d,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:_.lineMetrics||!1,generateId:_.generateId||!1},superclusterOptions:{maxZoom:_.clusterMaxZoom!==void 0?_.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,_.clusterMinPoints||2),extent:a.EXTENT,radius:(_.clusterRadius||50)*d,log:!1,generateId:_.generateId||!1},clusterProperties:_.clusterProperties,filter:_.filter},_.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(c){this.map=c,this.load()}setData(c){return this._data=c,this._updateWorkerData("content"),this}getClusterExpansionZoom(c,_){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:c,source:this.id},_),this}getClusterChildren(c,_){return this.actor.send("geojson.getClusterChildren",{clusterId:c,source:this.id},_),this}getClusterLeaves(c,_,l,h){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:c,limit:_,offset:l},h),this}_updateWorkerData(c){const _=a.extend({},this.workerOptions),l=this._data;typeof l=="string"?(_.request=this.map._requestManager.transformRequest(a.exported.resolveURL(l),a.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(l),this._pendingLoads++,this.fire(new a.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,_,(h,d)=>{if(this._pendingLoads--,this._removed||d&&d.abandoned)return void this.fire(new a.Event("dataabort",{dataType:"source",sourceDataType:c}));let x=null;if(d&&d.resourceTiming&&d.resourceTiming[this.id]&&(x=d.resourceTiming[this.id].slice(0)),h)return void this.fire(new a.ErrorEvent(h));const b={dataType:"source",sourceDataType:c};this._collectResourceTiming&&x&&x.length>0&&a.extend(b,{resourceTiming:x}),this.fire(new a.Event("data",b))})}loaded(){return this._pendingLoads===0}loadTile(c,_){const l=c.actor?"reloadTile":"loadTile";c.actor=this.actor;const h={type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};c.request=this.actor.send(l,h,(d,x)=>(delete c.request,c.unloadVectorData(),c.aborted?_(null):d?_(d):(c.loadVectorData(x,this.map.painter,l==="reloadTile"),_(null))))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.aborted=!0}unloadTile(c){c.unloadVectorData(),this.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var mt=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class bt extends a.Evented{constructor(c,_,l,h){super(),this.id=c,this.dispatcher=l,this.coordinates=_.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=_}load(c,_){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(l,h)=>{this._loaded=!0,l?this.fire(new a.ErrorEvent(l)):h&&(this.image=h,c&&(this.coordinates=c),_&&_(),this._finishLoading())})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this.options.url=c.url,this.load(c.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}setCoordinates(c){this.coordinates=c;const _=c.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(h){let d=1/0,x=1/0,b=-1/0,S=-1/0;for(const $ of h)d=Math.min(d,$.x),x=Math.min(x,$.y),b=Math.max(b,$.x),S=Math.max(S,$.y);const M=Math.max(b-d,S-x),B=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),V=Math.pow(2,B);return new a.CanonicalTileID(B,Math.floor((d+b)/2*V),Math.floor((x+S)/2*V))}(_),this.minzoom=this.maxzoom=this.tileID.z;const l=_.map(h=>this.tileID.getTilePoint(h)._round());return this._boundsArray=new a.RasterBoundsArray,this._boundsArray.emplaceBack(l[0].x,l[0].y,0,0),this._boundsArray.emplaceBack(l[1].x,l[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(l[3].x,l[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(l[2].x,l[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,_=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,mt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Z(c,this.image,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE));for(const l in this.tiles){const h=this.tiles[l];h.state!=="loaded"&&(h.state="loaded",h.texture=this.texture)}}loadTile(c,_){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},_(null)):(c.state="errored",_(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Kt extends bt{constructor(c,_,l,h){super(c,_,l,h),this.roundZoom=!0,this.type="video",this.options=_}load(){this._loaded=!1;const c=this.options;this.urls=[];for(const _ of c.urls)this.urls.push(this.map._requestManager.transformRequest(_,a.ResourceType.Source).url);a.getVideo(this.urls,(_,l)=>{this._loaded=!0,_?this.fire(new a.ErrorEvent(_)):l&&(this.video=l,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(c){if(this.video){const _=this.video.seekable;c<_.start(0)||c>_.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${_.start(0)} and ${_.end(0)}-second mark.`))):this.video.currentTime=c}}getVideo(){return this.video}onAdd(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const c=this.map.painter.context,_=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,mt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE),_.texSubImage2D(_.TEXTURE_2D,0,0,0,_.RGBA,_.UNSIGNED_BYTE,this.video)):(this.texture=new Z(c,this.video,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE));for(const l in this.tiles){const h=this.tiles[l];h.state!=="loaded"&&(h.state="loaded",h.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class In extends bt{constructor(c,_,l,h){super(c,_,l,h),_.coordinates?Array.isArray(_.coordinates)&&_.coordinates.length===4&&!_.coordinates.some(d=>!Array.isArray(d)||d.length!==2||d.some(x=>typeof x!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${c}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${c}`,null,'missing required property "coordinates"'))),_.animate&&typeof _.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${c}`,null,'optional "animate" property must be a boolean value'))),_.canvas?typeof _.canvas=="string"||_.canvas instanceof HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${c}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${c}`,null,'missing required property "canvas"'))),this.options=_,this.animate=_.animate===void 0||_.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const _=this.map.painter.context,l=_.gl;this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,mt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(c||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Z(_,this.canvas,l.RGBA,{premultiply:!0});for(const h in this.tiles){const d=this.tiles[h];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const c of[this.canvas.width,this.canvas.height])if(isNaN(c)||c<=0)return!0;return!1}}const En={vector:Ye,raster:gt,"raster-dem":Et,geojson:fn,video:Kt,image:bt,canvas:In};function Si(k,c){const _=a.create();return a.translate(_,_,[1,1,0]),a.scale(_,_,[.5*k.width,.5*k.height,1]),a.multiply(_,_,k.calculatePosMatrix(c.toUnwrapped()))}function Jn(k,c,_,l,h,d){const x=function(V,$,X){if(V)for(const se of V){const ne=$[se];if(ne&&ne.source===X&&ne.type==="fill-extrusion")return!0}else for(const se in $){const ne=$[se];if(ne.source===X&&ne.type==="fill-extrusion")return!0}return!1}(h&&h.layers,c,k.id),b=d.maxPitchScaleFactor(),S=k.tilesIn(l,b,x);S.sort(oi);const M=[];for(const V of S)M.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(c,_,k._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,h,d,b,Si(k.transform,V.tileID))});const B=function(V){const $={},X={};for(const se of V){const ne=se.queryResults,ue=se.wrappedTileID,be=X[ue]=X[ue]||{};for(const Ce in ne){const _e=ne[Ce],Ge=be[Ce]=be[Ce]||{},Te=$[Ce]=$[Ce]||[];for(const Ue of _e)Ge[Ue.featureIndex]||(Ge[Ue.featureIndex]=!0,Te.push(Ue))}}return $}(M);for(const V in B)B[V].forEach($=>{const X=$.feature,se=k.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=se});return B}function oi(k,c){const _=k.tileID,l=c.tileID;return _.overscaledZ-l.overscaledZ||_.canonical.y-l.canonical.y||_.wrap-l.wrap||_.canonical.x-l.canonical.x}class ci{constructor(c,_){this.tileID=c,this.uid=a.uniqueId(),this.uses=0,this.tileSize=_,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(c){const _=c+this.timeAdded;_<a.exported.now()||this.fadeEndTime&&_<this.fadeEndTime||(this.fadeEndTime=_)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(c){this.demTexture&&c.saveTileTexture(this.demTexture),this.textures.forEach(_=>c.saveTileTexture(_)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(c,_,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(h,d){const x={};if(!d)return x;for(const b of h){const S=b.layerIds.map(M=>d.getLayer(M)).filter(Boolean);if(S.length!==0){b.layers=S,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(M=>S.filter(B=>B.id===M)[0]));for(const M of S)x[M.id]=b}}return x}(c.buckets,_.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const d=this.buckets[h];if(d instanceof a.SymbolBucket){if(this.hasSymbolBuckets=!0,!l)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const d=this.buckets[h];if(d instanceof a.SymbolBucket&&d.hasRTLText){this.hasRTLText=!0,a.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const h in this.buckets){const d=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,_.style.getLayer(h).queryRadius(d))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new a.CollisionBoxArray}unloadVectorData(){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(c){return this.buckets[c.id]}upload(c){for(const l in this.buckets){const h=this.buckets[l];h.uploadPending()&&h.upload(c)}const _=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Z(c,this.imageAtlas.image,_.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Z(c,this.glyphAtlasImage,_.ALPHA),this.glyphAtlasImage=null)}prepare(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)}queryRenderedFeatures(c,_,l,h,d,x,b,S,M,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:d,scale:x,tileSize:this.tileSize,pixelPosMatrix:B,transform:S,params:b,queryPadding:this.queryPadding*M},c,_,l):{}}querySourceFeatures(c,_){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const h=l.loadVTLayers(),d=_?_.sourceLayer:"",x=h._geojsonTileLayer||h[d];if(!x)return;const b=a.createFilter(_&&_.filter),{z:S,x:M,y:B}=this.tileID.canonical,V={z:S,x:M,y:B};for(let $=0;$<x.length;$++){const X=x.feature($);if(b.needGeometry){const ue=a.toEvaluationFeature(X,!0);if(!b.filter(new a.EvaluationParameters(this.tileID.overscaledZ),ue,this.tileID.canonical))continue}else if(!b.filter(new a.EvaluationParameters(this.tileID.overscaledZ),X))continue;const se=l.getId(X,d),ne=new a.GeoJSONFeature(X,S,M,B,se);ne.tile=V,c.push(ne)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(c){const _=this.expirationTime;if(c.cacheControl){const l=a.parseCacheControl(c.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){const l=Date.now();let h=!1;if(this.expirationTime>l)h=!1;else if(_)if(this.expirationTime<_)h=!0;else{const d=this.expirationTime-_;d?this.expirationTime=l+Math.max(d,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(c,_){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(c).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!_.style.hasLayer(h))continue;const d=this.buckets[h],x=d.layers[0].sourceLayer||"_geojsonTileLayer",b=l[x],S=c[x];if(!b||!S||Object.keys(S).length===0)continue;d.update(S,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});const M=_&&_.style&&_.style.getLayer(h);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(c){this.symbolFadeHoldUntil=a.exported.now()+c}setDependencies(c,_){const l={};for(const h of _)l[h]=!0;this.dependencies[c]=l}hasDependency(c,_){for(const l of c){const h=this.dependencies[l];if(h){for(const d of _)if(h[d])return!0}}return!1}}class Nn{constructor(c,_){this.max=c,this.onRemove=_,this.reset()}reset(){for(const c in this.data)for(const _ of this.data[c])_.timeout&&clearTimeout(_.timeout),this.onRemove(_.value);return this.data={},this.order=[],this}add(c,_,l){const h=c.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const d={value:_,timeout:void 0};if(l!==void 0&&(d.timeout=setTimeout(()=>{this.remove(c,d)},l)),this.data[h].push(d),this.order.push(h),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(c){return c.wrapped().key in this.data}getAndRemove(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null}_getAndRemoveByKey(c){const _=this.data[c].shift();return _.timeout&&clearTimeout(_.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),_.value}getByKey(c){const _=this.data[c];return _?_[0].value:null}get(c){return this.has(c)?this.data[c.wrapped().key][0].value:null}remove(c,_){if(!this.has(c))return this;const l=c.wrapped().key,h=_===void 0?0:this.data[l].indexOf(_),d=this.data[l][h];return this.data[l].splice(h,1),d.timeout&&clearTimeout(d.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(d.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(c){for(this.max=c;this.order.length>this.max;){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}filter(c){const _=[];for(const l in this.data)for(const h of this.data[l])c(h.value)||_.push(h);for(const l of _)this.remove(l.value.tileID,l)}}class bi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,_,l){const h=String(_);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][h]=this.stateChanges[c][h]||{},a.extend(this.stateChanges[c][h],l),this.deletedStates[c]===null){this.deletedStates[c]={};for(const d in this.state[c])d!==h&&(this.deletedStates[c][d]=null)}else if(this.deletedStates[c]&&this.deletedStates[c][h]===null){this.deletedStates[c][h]={};for(const d in this.state[c][h])l[d]||(this.deletedStates[c][h][d]=null)}else for(const d in l)this.deletedStates[c]&&this.deletedStates[c][h]&&this.deletedStates[c][h][d]===null&&delete this.deletedStates[c][h][d]}removeFeatureState(c,_,l){if(this.deletedStates[c]===null)return;const h=String(_);if(this.deletedStates[c]=this.deletedStates[c]||{},l&&_!==void 0)this.deletedStates[c][h]!==null&&(this.deletedStates[c][h]=this.deletedStates[c][h]||{},this.deletedStates[c][h][l]=null);else if(_!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][h])for(l in this.deletedStates[c][h]={},this.stateChanges[c][h])this.deletedStates[c][h][l]=null;else this.deletedStates[c][h]=null;else this.deletedStates[c]=null}getState(c,_){const l=String(_),h=a.extend({},(this.state[c]||{})[l],(this.stateChanges[c]||{})[l]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){const d=this.deletedStates[c][_];if(d===null)return{};for(const x in d)delete h[x]}return h}initializeTileState(c,_){c.setFeatureState(this.state,_)}coalesceChanges(c,_){const l={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const d={};for(const x in this.stateChanges[h])this.state[h][x]||(this.state[h][x]={}),a.extend(this.state[h][x],this.stateChanges[h][x]),d[x]=this.state[h][x];l[h]=d}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const d={};if(this.deletedStates[h]===null)for(const x in this.state[h])d[x]={},this.state[h][x]={};else for(const x in this.deletedStates[h]){if(this.deletedStates[h][x]===null)this.state[h][x]={};else for(const b of Object.keys(this.deletedStates[h][x]))delete this.state[h][x][b];d[x]=this.state[h][x]}l[h]=l[h]||{},a.extend(l[h],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const h in c)c[h].setFeatureState(l,_)}}class xt extends a.Evented{constructor(c,_,l){super(),this.id=c,this.dispatcher=l,this.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(h,d,x,b){const S=new En[d.type](h,d,x,b);if(S.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${S.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],S),S}(c,_,l,this),this._tiles={},this._cache=new Nn(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new bi}onAdd(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(c)}onRemove(c){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(c)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const c in this._tiles){const _=this._tiles[c];if(_.state!=="loaded"&&_.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(c,_){return this._source.loadTile(c,_)}_unloadTile(c){if(this._source.unloadTile)return this._source.unloadTile(c,()=>{})}_abortTile(c){this._source.abortTile&&this._source.abortTile(c,()=>{}),this._source.fire(new a.Event("dataabort",{tile:c,coord:c.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(c){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const _ in this._tiles){const l=this._tiles[_];l.upload(c),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(c=>c.tileID).sort(nn).map(c=>c.key)}getRenderableIds(c){const _=[];for(const l in this._tiles)this._isIdRenderable(l,c)&&_.push(this._tiles[l]);return c?_.sort((l,h)=>{const d=l.tileID,x=h.tileID,b=new a.pointGeometry(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),S=new a.pointGeometry(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-x.overscaledZ||S.y-b.y||S.x-b.x}).map(l=>l.tileID.key):_.map(l=>l.tileID).sort(nn).map(l=>l.key)}hasRenderableParent(c){const _=this.findLoadedParent(c,0);return!!_&&this._isIdRenderable(_.tileID.key)}_isIdRenderable(c,_){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(_||!this._tiles[c].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)this._tiles[c].state!=="errored"&&this._reloadTile(c,"reloading")}}_reloadTile(c,_){const l=this._tiles[c];l&&(l.state!=="loading"&&(l.state=_),this._loadTile(l,this._tileLoaded.bind(this,l,c,_)))}_tileLoaded(c,_,l,h){if(h)return c.state="errored",void(h.status!==404?this._source.fire(new a.ErrorEvent(h,{tile:c})):this.update(this.transform,this.terrain));c.timeAdded=a.exported.now(),l==="expired"&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(_,c),this.getSource().type==="raster-dem"&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),c.aborted||this._source.fire(new a.Event("data",{dataType:"source",tile:c,coord:c.tileID}))}_backfillDEM(c){const _=this.getRenderableIds();for(let h=0;h<_.length;h++){const d=_[h];if(c.neighboringTiles&&c.neighboringTiles[d]){const x=this.getTileByID(d);l(c,x),l(x,c)}}function l(h,d){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let x=d.tileID.canonical.x-h.tileID.canonical.x;const b=d.tileID.canonical.y-h.tileID.canonical.y,S=Math.pow(2,h.tileID.canonical.z),M=d.tileID.key;x===0&&b===0||Math.abs(b)>1||(Math.abs(x)>1&&(Math.abs(x+S)===1?x+=S:Math.abs(x-S)===1&&(x-=S)),d.dem&&h.dem&&(h.dem.backfillBorder(d.dem,x,b),h.neighboringTiles&&h.neighboringTiles[M]&&(h.neighboringTiles[M].backfilled=!0)))}}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._tiles[c]}_retainLoadedChildren(c,_,l,h){for(const d in this._tiles){let x=this._tiles[d];if(h[d]||!x.hasData()||x.tileID.overscaledZ<=_||x.tileID.overscaledZ>l)continue;let b=x.tileID;for(;x&&x.tileID.overscaledZ>_+1;){const M=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[M.key],x&&x.hasData()&&(b=M)}let S=b;for(;S.overscaledZ>_;)if(S=S.scaledTo(S.overscaledZ-1),c[S.key]){h[b.key]=b;break}}}findLoadedParent(c,_){if(c.key in this._loadedParentTiles){const l=this._loadedParentTiles[c.key];return l&&l.tileID.overscaledZ>=_?l:null}for(let l=c.overscaledZ-1;l>=_;l--){const h=c.scaledTo(l),d=this._getLoadedTile(h);if(d)return d}}_getLoadedTile(c){const _=this._tiles[c.key];return _&&_.hasData()?_:this._cache.getByKey(c.wrapped().key)}updateCacheSize(c){const _=Math.ceil(c.width/this._source.tileSize)+1,l=Math.ceil(c.height/this._source.tileSize)+1,h=Math.floor(_*l*5),d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(d)}handleWrapJump(c){const _=Math.round((c-(this._prevLng===void 0?c:this._prevLng))/360);if(this._prevLng=c,_){const l={};for(const h in this._tiles){const d=this._tiles[h];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+_),l[d.tileID.key]=d}this._tiles=l;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}update(c,_){if(this.transform=c,this.terrain=_,!this._sourceLoaded||this._paused)return;let l;this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new a.OverscaledTileID(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(l=c.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:_}),this._source.hasTile&&(l=l.filter(M=>this._source.hasTile(M)))):l=[];const h=c.coveringZoomLevel(this._source),d=Math.max(h-xt.maxOverzooming,this._source.minzoom),x=Math.max(h+xt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const M={};for(const B of l)if(B.canonical.z>this._source.minzoom){const V=B.scaledTo(B.canonical.z-1);M[V.key]=V;const $=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));M[$.key]=$}l=l.concat(Object.values(M))}const b=this._updateRetainedTiles(l,h);if(Mn(this._source.type)){const M={},B={},V=Object.keys(b);for(const $ of V){const X=b[$],se=this._tiles[$];if(!se||se.fadeEndTime&&se.fadeEndTime<=a.exported.now())continue;const ne=this.findLoadedParent(X,d);ne&&(this._addTile(ne.tileID),M[ne.tileID.key]=ne.tileID),B[$]=X}this._retainLoadedChildren(B,h,x,b);for(const $ in M)b[$]||(this._coveredTiles[$]=!0,b[$]=M[$]);if(_){const $={},X={};for(const se of l)this._tiles[se.key].hasData()?$[se.key]=se:X[se.key]=se;for(const se in X){const ne=X[se].children(this._source.maxzoom);this._tiles[ne[0].key]&&this._tiles[ne[1].key]&&this._tiles[ne[2].key]&&this._tiles[ne[3].key]&&($[ne[0].key]=b[ne[0].key]=ne[0],$[ne[1].key]=b[ne[1].key]=ne[1],$[ne[2].key]=b[ne[2].key]=ne[2],$[ne[3].key]=b[ne[3].key]=ne[3],delete X[se])}for(const se in X){const ne=this.findLoadedParent(X[se],this._source.minzoom);if(ne){$[ne.tileID.key]=b[ne.tileID.key]=ne.tileID;for(const ue in $)$[ue].isChildOf(ne.tileID)&&delete $[ue]}}for(const se in this._tiles)$[se]||(this._coveredTiles[se]=!0)}}for(const M in b)this._tiles[M].clearFadeHold();const S=a.keysDifference(this._tiles,b);for(const M of S){const B=this._tiles[M];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(M)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(c)}_updateRetainedTiles(c,_){const l={},h={},d=Math.max(_-xt.maxOverzooming,this._source.minzoom),x=Math.max(_+xt.maxUnderzooming,this._source.minzoom),b={};for(const S of c){const M=this._addTile(S);l[S.key]=S,M.hasData()||_<this._source.maxzoom&&(b[S.key]=S)}this._retainLoadedChildren(b,_,x,l);for(const S of c){let M=this._tiles[S.key];if(M.hasData())continue;if(_+1>this._source.maxzoom){const V=S.children(this._source.maxzoom)[0],$=this.getTile(V);if($&&$.hasData()){l[V.key]=V;continue}}else{const V=S.children(this._source.maxzoom);if(l[V[0].key]&&l[V[1].key]&&l[V[2].key]&&l[V[3].key])continue}let B=M.wasRequested();for(let V=S.overscaledZ-1;V>=d;--V){const $=S.scaledTo(V);if(h[$.key]||(h[$.key]=!0,M=this.getTile($),!M&&B&&(M=this._addTile($)),M&&(l[$.key]=$,B=M.wasRequested(),M.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const c in this._tiles){const _=[];let l,h=this._tiles[c].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}_.push(h.key);const d=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(d),l)break;h=d}for(const d of _)this._loadedParentTiles[d]=l}}_addTile(c){let _=this._tiles[c.key];if(_)return _;_=this._cache.getAndRemove(c),_&&(this._setTileReloadTimer(c.key,_),_.tileID=c,this._state.initializeTileState(_,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,_)));const l=_;return _||(_=new ci(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(_,this._tileLoaded.bind(this,_,c.key,_.state))),_.uses++,this._tiles[c.key]=_,l||this._source.fire(new a.Event("dataloading",{tile:_,coord:_.tileID,dataType:"source"})),_}_setTileReloadTimer(c,_){c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);const l=_.getExpiryTimeout();l&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},l))}_removeTile(c){const _=this._tiles[c];_&&(_.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),_.uses>0||(_.hasData()&&_.state!=="reloading"?this._cache.add(_.tileID,_,_.getExpiryTimeout()):(_.aborted=!0,this._abortTile(_),this._unloadTile(_))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const c in this._tiles)this._removeTile(c);this._cache.reset()}tilesIn(c,_,l){const h=[],d=this.transform;if(!d)return h;const x=l?d.getCameraQueryGeometry(c):c,b=c.map(se=>d.pointCoordinate(se,this.terrain)),S=x.map(se=>d.pointCoordinate(se,this.terrain)),M=this.getIds();let B=1/0,V=1/0,$=-1/0,X=-1/0;for(const se of S)B=Math.min(B,se.x),V=Math.min(V,se.y),$=Math.max($,se.x),X=Math.max(X,se.y);for(let se=0;se<M.length;se++){const ne=this._tiles[M[se]];if(ne.holdingForFade())continue;const ue=ne.tileID,be=Math.pow(2,d.zoom-ne.tileID.overscaledZ),Ce=_*ne.queryPadding*a.EXTENT/ne.tileSize/be,_e=[ue.getTilePoint(new a.MercatorCoordinate(B,V)),ue.getTilePoint(new a.MercatorCoordinate($,X))];if(_e[0].x-Ce<a.EXTENT&&_e[0].y-Ce<a.EXTENT&&_e[1].x+Ce>=0&&_e[1].y+Ce>=0){const Ge=b.map(Ue=>ue.getTilePoint(Ue)),Te=S.map(Ue=>ue.getTilePoint(Ue));h.push({tile:ne,tileID:ue,queryGeometry:Ge,cameraQueryGeometry:Te,scale:be})}}return h}getVisibleCoordinates(c){const _=this.getRenderableIds(c).map(l=>this._tiles[l].tileID);for(const l of _)l.posMatrix=this.transform.calculatePosMatrix(l.toUnwrapped());return _}hasTransition(){if(this._source.hasTransition())return!0;if(Mn(this._source.type))for(const c in this._tiles){const _=this._tiles[c];if(_.fadeEndTime!==void 0&&_.fadeEndTime>=a.exported.now())return!0}return!1}setFeatureState(c,_,l){this._state.updateState(c=c||"_geojsonTileLayer",_,l)}removeFeatureState(c,_,l){this._state.removeFeatureState(c=c||"_geojsonTileLayer",_,l)}getFeatureState(c,_){return this._state.getState(c=c||"_geojsonTileLayer",_)}setDependencies(c,_,l){const h=this._tiles[c];h&&h.setDependencies(_,l)}reloadTilesForDependencies(c,_){for(const l in this._tiles)this._tiles[l].hasDependency(c,_)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(c,_))}}function nn(k,c){const _=Math.abs(2*k.wrap)-+(k.wrap<0),l=Math.abs(2*c.wrap)-+(c.wrap<0);return k.overscaledZ-c.overscaledZ||l-_||c.canonical.y-k.canonical.y||c.canonical.x-k.canonical.x}function Mn(k){return k==="raster"||k==="image"||k==="video"}xt.maxOverzooming=10,xt.maxUnderzooming=3;const vt="mapboxgl_preloaded_worker_pool";class ei{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<ei.workerCount;)this.workers.push(new Worker(Ws.workerUrl));return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(_=>{_.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[vt]}numActive(){return Object.keys(this.active).length}}const $n=Math.floor(a.exported.hardwareConcurrency/2);let yi;function li(){return yi||(yi=new ei),yi}function ti(k,c){const _={};for(const l in k)l!=="ref"&&(_[l]=k[l]);return a.refProperties.forEach(l=>{l in c&&(_[l]=c[l])}),_}function Ki(k){k=k.slice();const c=Object.create(null);for(let _=0;_<k.length;_++)c[k[_].id]=k[_];for(let _=0;_<k.length;_++)"ref"in k[_]&&(k[_]=ti(k[_],c[k[_].ref]));return k}ei.workerCount=Math.max(Math.min($n,6),1);const Un={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Cr(k,c,_){_.push({command:Un.addSource,args:[k,c[k]]})}function Hn(k,c,_){c.push({command:Un.removeSource,args:[k]}),_[k]=!0}function Fr(k,c,_,l){Hn(k,_,l),Cr(k,c,_)}function fo(k,c,_){let l;for(l in k[_])if(Object.prototype.hasOwnProperty.call(k[_],l)&&l!=="data"&&!P(k[_][l],c[_][l]))return!1;for(l in c[_])if(Object.prototype.hasOwnProperty.call(c[_],l)&&l!=="data"&&!P(k[_][l],c[_][l]))return!1;return!0}function Ni(k,c,_,l,h,d){let x;for(x in c=c||{},k=k||{})Object.prototype.hasOwnProperty.call(k,x)&&(P(k[x],c[x])||_.push({command:d,args:[l,x,c[x],h]}));for(x in c)Object.prototype.hasOwnProperty.call(c,x)&&!Object.prototype.hasOwnProperty.call(k,x)&&(P(k[x],c[x])||_.push({command:d,args:[l,x,c[x],h]}))}function Pr(k){return k.id}function Fo(k,c){return k[c.id]=c,k}class is{constructor(c,_){this.reset(c,_)}reset(c,_){this.points=c||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(_||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=a.clamp(c,0,1);let _=1,l=this._distances[_];const h=c*this.paddedLength+this.padding;for(;l<h&&_<this._distances.length;)l=this._distances[++_];const d=_-1,x=this._distances[d],b=l-x,S=b>0?(h-x)/b:0;return this.points[d].mult(1-S).add(this.points[_].mult(S))}}function ut(k,c){let _=!0;return k==="always"||k!=="never"&&c!=="never"||(_=!1),_}class It{constructor(c,_,l){const h=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(c/l),this.yCellCount=Math.ceil(_/l);for(let x=0;x<this.xCellCount*this.yCellCount;x++)h.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=_,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/_,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,_,l,h,d){this._forEachCell(_,l,h,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(_),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(d)}insertCircle(c,_,l,h){this._forEachCell(_-h,l-h,_+h,l+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(_),this.circles.push(l),this.circles.push(h)}_insertBoxCell(c,_,l,h,d,x){this.boxCells[d].push(x)}_insertCircleCell(c,_,l,h,d,x){this.circleCells[d].push(x)}_query(c,_,l,h,d,x,b){if(l<0||c>this.width||h<0||_>this.height)return[];const S=[];if(c<=0&&_<=0&&this.width<=l&&this.height<=h){if(d)return[{key:null,x1:c,y1:_,x2:l,y2:h}];for(let M=0;M<this.boxKeys.length;M++)S.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const B=this.circles[3*M],V=this.circles[3*M+1],$=this.circles[3*M+2];S.push({key:this.circleKeys[M],x1:B-$,y1:V-$,x2:B+$,y2:V+$})}}else this._forEachCell(c,_,l,h,this._queryCell,S,{hitTest:d,overlapMode:x,seenUids:{box:{},circle:{}}},b);return S}query(c,_,l,h){return this._query(c,_,l,h,!1,null)}hitTest(c,_,l,h,d,x){return this._query(c,_,l,h,!0,d,x).length>0}hitTestCircle(c,_,l,h,d){const x=c-l,b=c+l,S=_-l,M=_+l;if(b<0||x>this.width||M<0||S>this.height)return!1;const B=[];return this._forEachCell(x,S,b,M,this._queryCellCircle,B,{hitTest:!0,overlapMode:h,circle:{x:c,y:_,radius:l},seenUids:{box:{},circle:{}}},d),B.length>0}_queryCell(c,_,l,h,d,x,b,S){const{seenUids:M,hitTest:B,overlapMode:V}=b,$=this.boxCells[d];if($!==null){const se=this.bboxes;for(const ne of $)if(!M.box[ne]){M.box[ne]=!0;const ue=4*ne,be=this.boxKeys[ne];if(c<=se[ue+2]&&_<=se[ue+3]&&l>=se[ue+0]&&h>=se[ue+1]&&(!S||S(be))&&(!B||!ut(V,be.overlapMode))&&(x.push({key:be,x1:se[ue],y1:se[ue+1],x2:se[ue+2],y2:se[ue+3]}),B))return!0}}const X=this.circleCells[d];if(X!==null){const se=this.circles;for(const ne of X)if(!M.circle[ne]){M.circle[ne]=!0;const ue=3*ne,be=this.circleKeys[ne];if(this._circleAndRectCollide(se[ue],se[ue+1],se[ue+2],c,_,l,h)&&(!S||S(be))&&(!B||!ut(V,be.overlapMode))){const Ce=se[ue],_e=se[ue+1],Ge=se[ue+2];if(x.push({key:be,x1:Ce-Ge,y1:_e-Ge,x2:Ce+Ge,y2:_e+Ge}),B)return!0}}}return!1}_queryCellCircle(c,_,l,h,d,x,b,S){const{circle:M,seenUids:B,overlapMode:V}=b,$=this.boxCells[d];if($!==null){const se=this.bboxes;for(const ne of $)if(!B.box[ne]){B.box[ne]=!0;const ue=4*ne,be=this.boxKeys[ne];if(this._circleAndRectCollide(M.x,M.y,M.radius,se[ue+0],se[ue+1],se[ue+2],se[ue+3])&&(!S||S(be))&&!ut(V,be.overlapMode))return x.push(!0),!0}}const X=this.circleCells[d];if(X!==null){const se=this.circles;for(const ne of X)if(!B.circle[ne]){B.circle[ne]=!0;const ue=3*ne,be=this.circleKeys[ne];if(this._circlesCollide(se[ue],se[ue+1],se[ue+2],M.x,M.y,M.radius)&&(!S||S(be))&&!ut(V,be.overlapMode))return x.push(!0),!0}}}_forEachCell(c,_,l,h,d,x,b,S){const M=this._convertToXCellCoord(c),B=this._convertToYCellCoord(_),V=this._convertToXCellCoord(l),$=this._convertToYCellCoord(h);for(let X=M;X<=V;X++)for(let se=B;se<=$;se++)if(d.call(this,c,_,l,h,this.xCellCount*se+X,x,b,S))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,_,l,h,d,x){const b=h-c,S=d-_,M=l+x;return M*M>b*b+S*S}_circleAndRectCollide(c,_,l,h,d,x,b){const S=(x-h)/2,M=Math.abs(c-(h+S));if(M>S+l)return!1;const B=(b-d)/2,V=Math.abs(_-(d+B));if(V>B+l)return!1;if(M<=S||V<=B)return!0;const $=M-S,X=V-B;return $*$+X*X<=l*l}}function Bs(k,c,_,l,h){const d=a.create();return c?(a.scale(d,d,[1/h,1/h,1]),_||a.rotateZ(d,d,l.angle)):a.multiply(d,l.labelPlaneMatrix,k),d}function xr(k,c,_,l,h){if(c){const d=a.clone(k);return a.scale(d,d,[h,h,1]),_||a.rotateZ(d,d,-l.angle),d}return l.glCoordMatrix}function Rn(k,c,_){let l;_?(l=[k.x,k.y,_(k.x,k.y),1],a.transformMat4(l,l,c)):(l=[k.x,k.y,0,1],qe(l,l,c));const h=l[3];return{point:new a.pointGeometry(l[0]/h,l[1]/h),signedDistanceFromCamera:h}}function Nr(k,c){return .5+k/c*.5}function Ir(k,c){const _=k[0]/k[3],l=k[1]/k[3];return _>=-c[0]&&_<=c[0]&&l>=-c[1]&&l<=c[1]}function kr(k,c,_,l,h,d,x,b,S,M){const B=l?k.textSizeData:k.iconSizeData,V=a.evaluateSizeForZoom(B,_.transform.zoom),$=[256/_.width*2+1,256/_.height*2+1],X=l?k.text.dynamicLayoutVertexArray:k.icon.dynamicLayoutVertexArray;X.clear();const se=k.lineVertexArray,ne=l?k.text.placedSymbolArray:k.icon.placedSymbolArray,ue=_.transform.width/_.transform.height;let be=!1;for(let Ce=0;Ce<ne.length;Ce++){const _e=ne.get(Ce);if(_e.hidden||_e.writingMode===a.WritingMode.vertical&&!be){mn(_e.numGlyphs,X);continue}let Ge;if(be=!1,M?(Ge=[_e.anchorX,_e.anchorY,M(_e.anchorX,_e.anchorY),1],a.transformMat4(Ge,Ge,c)):(Ge=[_e.anchorX,_e.anchorY,0,1],qe(Ge,Ge,c)),!Ir(Ge,$)){mn(_e.numGlyphs,X);continue}const Te=Nr(_.transform.cameraToCenterDistance,Ge[3]),Ue=a.evaluateSizeForFeature(B,V,_e),xe=x?Ue/Te:Ue*Te,m=new a.pointGeometry(_e.anchorX,_e.anchorY),g=Rn(m,h,M).point,v={},E=Tn(_e,xe,!1,b,c,h,d,k.glyphOffsetArray,se,X,g,m,v,ue,S,M);be=E.useVertical,(E.notEnoughRoom||be||E.needsFlipping&&Tn(_e,xe,!0,b,c,h,d,k.glyphOffsetArray,se,X,g,m,v,ue,S,M).notEnoughRoom)&&mn(_e.numGlyphs,X)}l?k.text.dynamicLayoutVertexBuffer.updateData(X):k.icon.dynamicLayoutVertexBuffer.updateData(X)}function rs(k,c,_,l,h,d,x,b,S,M,B,V,$){const X=b.glyphStartIndex+b.numGlyphs,se=b.lineStartIndex,ne=b.lineStartIndex+b.lineLength,ue=c.getoffsetX(b.glyphStartIndex),be=c.getoffsetX(X-1),Ce=Ii(k*ue,_,l,h,d,x,b.segment,se,ne,S,M,B,V,$);if(!Ce)return null;const _e=Ii(k*be,_,l,h,d,x,b.segment,se,ne,S,M,B,V,$);return _e?{first:Ce,last:_e}:null}function kt(k,c,_,l){return k===a.WritingMode.horizontal&&Math.abs(_.y-c.y)>Math.abs(_.x-c.x)*l?{useVertical:!0}:(k===a.WritingMode.vertical?c.y<_.y:c.x>_.x)?{needsFlipping:!0}:null}function Tn(k,c,_,l,h,d,x,b,S,M,B,V,$,X,se,ne){const ue=c/24,be=k.lineOffsetX*ue,Ce=k.lineOffsetY*ue;let _e;if(k.numGlyphs>1){const Ge=k.glyphStartIndex+k.numGlyphs,Te=k.lineStartIndex,Ue=k.lineStartIndex+k.lineLength,xe=rs(ue,b,be,Ce,_,B,V,k,S,d,$,se,ne);if(!xe)return{notEnoughRoom:!0};const m=Rn(xe.first.point,x,ne).point,g=Rn(xe.last.point,x,ne).point;if(l&&!_){const v=kt(k.writingMode,m,g,X);if(v)return v}_e=[xe.first];for(let v=k.glyphStartIndex+1;v<Ge-1;v++)_e.push(Ii(ue*b.getoffsetX(v),be,Ce,_,B,V,k.segment,Te,Ue,S,d,$,se,ne));_e.push(xe.last)}else{if(l&&!_){const Te=Rn(V,h,ne).point,Ue=k.lineStartIndex+k.segment+1,xe=new a.pointGeometry(S.getx(Ue),S.gety(Ue)),m=Rn(xe,h,ne),g=m.signedDistanceFromCamera>0?m.point:wn(V,xe,Te,1,h,ne),v=kt(k.writingMode,Te,g,X);if(v)return v}const Ge=Ii(ue*b.getoffsetX(k.glyphStartIndex),be,Ce,_,B,V,k.segment,k.lineStartIndex,k.lineStartIndex+k.lineLength,S,d,$,se,ne);if(!Ge)return{notEnoughRoom:!0};_e=[Ge]}for(const Ge of _e)a.addDynamicAttributes(M,Ge.point,Ge.angle);return{}}function wn(k,c,_,l,h,d){const x=Rn(k.add(k.sub(c)._unit()),h,d).point,b=_.sub(x);return _.add(b._mult(l/b.mag()))}function Ii(k,c,_,l,h,d,x,b,S,M,B,V,$,X){const se=l?k-c:k+c;let ne=se>0?1:-1,ue=0;l&&(ne*=-1,ue=Math.PI),ne<0&&(ue+=Math.PI);let be=ne>0?b+x:b+x+1,Ce=h,_e=h,Ge=0,Te=0;const Ue=Math.abs(se),xe=[];for(;Ge+Te<=Ue;){if(be+=ne,be<b||be>=S)return null;if(_e=Ce,xe.push(Ce),Ce=V[be],Ce===void 0){const C=new a.pointGeometry(M.getx(be),M.gety(be)),R=Rn(C,B,X);if(R.signedDistanceFromCamera>0)Ce=V[be]=R.point;else{const O=be-ne;Ce=wn(Ge===0?d:new a.pointGeometry(M.getx(O),M.gety(O)),C,_e,Ue-Ge+1,B,X)}}Ge+=Te,Te=_e.dist(Ce)}const m=(Ue-Ge)/Te,g=Ce.sub(_e),v=g.mult(m)._add(_e);v._add(g._unit()._perp()._mult(_*ne));const E=ue+Math.atan2(Ce.y-_e.y,Ce.x-_e.x);return xe.push(v),{point:v,angle:$?E:0,path:xe}}const vs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function mn(k,c){for(let _=0;_<k;_++){const l=c.length;c.resize(l+4),c.float32.set(vs,3*l)}}function qe(k,c,_){const l=c[0],h=c[1];return k[0]=_[0]*l+_[4]*h+_[12],k[1]=_[1]*l+_[5]*h+_[13],k[3]=_[3]*l+_[7]*h+_[15],k}const $i=100;class zs{constructor(c,_=new It(c.width+200,c.height+200,25),l=new It(c.width+200,c.height+200,25)){this.transform=c,this.grid=_,this.ignoredGrid=l,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+$i,this.screenBottomBoundary=c.height+$i,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(c,_,l,h,d,x){const b=this.projectAndGetPerspectiveRatio(h,c.anchorPointX,c.anchorPointY,x),S=l*b.perspectiveRatio,M=c.x1*S+b.point.x,B=c.y1*S+b.point.y,V=c.x2*S+b.point.x,$=c.y2*S+b.point.y;return!this.isInsideGrid(M,B,V,$)||_!=="always"&&this.grid.hitTest(M,B,V,$,_,d)||b.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[M,B,V,$],offscreen:this.isOffscreen(M,B,V,$)}}placeCollisionCircles(c,_,l,h,d,x,b,S,M,B,V,$,X,se){const ne=[],ue=new a.pointGeometry(_.anchorX,_.anchorY),be=Rn(ue,x,se),Ce=Nr(this.transform.cameraToCenterDistance,be.signedDistanceFromCamera),_e=(B?d/Ce:d*Ce)/a.ONE_EM,Ge=Rn(ue,b,se).point,Te=rs(_e,h,_.lineOffsetX*_e,_.lineOffsetY*_e,!1,Ge,ue,_,l,b,{},!1,se);let Ue=!1,xe=!1,m=!0;if(Te){const g=.5*$*Ce+X,v=new a.pointGeometry(-100,-100),E=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),C=new is,R=Te.first,O=Te.last;let N=[];for(let le=R.path.length-1;le>=1;le--)N.push(R.path[le]);for(let le=1;le<O.path.length;le++)N.push(O.path[le]);const W=2.5*g;if(S){const le=N.map(fe=>Rn(fe,S,se));N=le.some(fe=>fe.signedDistanceFromCamera<=0)?[]:le.map(fe=>fe.point)}let J=[];if(N.length>0){const le=N[0].clone(),fe=N[0].clone();for(let Re=1;Re<N.length;Re++)le.x=Math.min(le.x,N[Re].x),le.y=Math.min(le.y,N[Re].y),fe.x=Math.max(fe.x,N[Re].x),fe.y=Math.max(fe.y,N[Re].y);J=le.x>=v.x&&fe.x<=E.x&&le.y>=v.y&&fe.y<=E.y?[N]:fe.x<v.x||le.x>E.x||fe.y<v.y||le.y>E.y?[]:a.clipLine([N],v.x,v.y,E.x,E.y)}for(const le of J){C.reset(le,.25*g);let fe=0;fe=C.length<=.5*g?1:Math.ceil(C.paddedLength/W)+1;for(let Re=0;Re<fe;Re++){const je=Re/Math.max(fe-1,1),Be=C.lerp(je),Ze=Be.x+$i,ct=Be.y+$i;ne.push(Ze,ct,g,0);const At=Ze-g,it=ct-g,rt=Ze+g,Xe=ct+g;if(m=m&&this.isOffscreen(At,it,rt,Xe),xe=xe||this.isInsideGrid(At,it,rt,Xe),c!=="always"&&this.grid.hitTestCircle(Ze,ct,g,c,V)&&(Ue=!0,!M))return{circles:[],offscreen:!1,collisionDetected:Ue}}}}return{circles:!M&&Ue||!xe||Ce<this.perspectiveRatioCutoff?[]:ne,offscreen:m,collisionDetected:Ue}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const _=[];let l=1/0,h=1/0,d=-1/0,x=-1/0;for(const B of c){const V=new a.pointGeometry(B.x+$i,B.y+$i);l=Math.min(l,V.x),h=Math.min(h,V.y),d=Math.max(d,V.x),x=Math.max(x,V.y),_.push(V)}const b=this.grid.query(l,h,d,x).concat(this.ignoredGrid.query(l,h,d,x)),S={},M={};for(const B of b){const V=B.key;if(S[V.bucketInstanceId]===void 0&&(S[V.bucketInstanceId]={}),S[V.bucketInstanceId][V.featureIndex])continue;const $=[new a.pointGeometry(B.x1,B.y1),new a.pointGeometry(B.x2,B.y1),new a.pointGeometry(B.x2,B.y2),new a.pointGeometry(B.x1,B.y2)];a.polygonIntersectsPolygon(_,$)&&(S[V.bucketInstanceId][V.featureIndex]=!0,M[V.bucketInstanceId]===void 0&&(M[V.bucketInstanceId]=[]),M[V.bucketInstanceId].push(V.featureIndex))}return M}insertCollisionBox(c,_,l,h,d,x){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:d,collisionGroupID:x,overlapMode:_},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,_,l,h,d,x){const b=l?this.ignoredGrid:this.grid,S={bucketInstanceId:h,featureIndex:d,collisionGroupID:x,overlapMode:_};for(let M=0;M<c.length;M+=4)b.insertCircle(S,c[M],c[M+1],c[M+2])}projectAndGetPerspectiveRatio(c,_,l,h){let d;return h?(d=[_,l,h(_,l),1],a.transformMat4(d,d,c)):(d=[_,l,0,1],qe(d,d,c)),{point:new a.pointGeometry((d[0]/d[3]+1)/2*this.transform.width+$i,(-d[1]/d[3]+1)/2*this.transform.height+$i),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}}isOffscreen(c,_,l,h){return l<$i||c>=this.screenRightBoundary||h<$i||_>this.screenBottomBoundary}isInsideGrid(c,_,l,h){return l>=0&&c<this.gridRightBoundary&&h>=0&&_<this.gridBottomBoundary}getViewportMatrix(){const c=a.identity([]);return a.translate(c,c,[-100,-100,0]),c}}function Ri(k,c,_){return c*(a.EXTENT/(k.tileSize*Math.pow(2,_-k.tileID.overscaledZ)))}class or{constructor(c,_,l,h){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?_:-_))):h&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class qn{constructor(c,_,l,h,d){this.text=new or(c?c.text:null,_,l,d),this.icon=new or(c?c.icon:null,_,h,d)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Os{constructor(c,_,l){this.text=c,this.icon=_,this.skipFade=l}}class Ur{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Vr{constructor(c,_,l,h,d){this.bucketInstanceId=c,this.featureIndex=_,this.sourceLayerIndex=l,this.bucketIndex=h,this.tileID=d}}class Lr{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const _=++this.maxGroupID;this.collisionGroups[c]={ID:_,predicate:l=>l.collisionGroupID===_}}return this.collisionGroups[c]}}function ss(k,c,_,l,h){const{horizontalAlign:d,verticalAlign:x}=a.getAnchorAlignment(k),b=-(d-.5)*c,S=-(x-.5)*_,M=a.evaluateVariableOffset(k,l);return new a.pointGeometry(b+M[0]*h,S+M[1]*h)}function Bi(k,c,_,l,h,d){const{x1:x,x2:b,y1:S,y2:M,anchorPointX:B,anchorPointY:V}=k,$=new a.pointGeometry(c,_);return l&&$._rotate(h?d:-d),{x1:x+$.x,y1:S+$.y,x2:b+$.x,y2:M+$.y,anchorPointX:B,anchorPointY:V}}class K{constructor(c,_,l,h,d){this.transform=c.clone(),this.terrain=_,this.collisionIndex=new zs(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Lr(h),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,_,l,h){const d=l.getBucket(_),x=l.latestFeatureIndex;if(!d||!x||_.id!==d.layerIds[0])return;const b=l.collisionBoxArray,S=d.layers[0].layout,M=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),B=l.tileSize/a.EXTENT,V=this.transform.calculatePosMatrix(l.tileID.toUnwrapped()),$=S.get("text-pitch-alignment")==="map",X=S.get("text-rotation-alignment")==="map",se=Ri(l,1,this.transform.zoom),ne=Bs(V,$,X,this.transform,se);let ue=null;if($){const Ce=xr(V,$,X,this.transform,se);ue=a.multiply([],this.transform.labelPlaneMatrix,Ce)}this.retainedQueryData[d.bucketInstanceId]=new Vr(d.bucketInstanceId,x,d.sourceLayerIndex,d.index,l.tileID);const be={bucket:d,layout:S,posMatrix:V,textLabelPlaneMatrix:ne,labelToScreenMatrix:ue,scale:M,textPixelRatio:B,holdingForFade:l.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(h)for(const Ce of d.sortKeyRanges){const{sortKey:_e,symbolInstanceStart:Ge,symbolInstanceEnd:Te}=Ce;c.push({sortKey:_e,symbolInstanceStart:Ge,symbolInstanceEnd:Te,parameters:be})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:be})}attemptAnchorPlacement(c,_,l,h,d,x,b,S,M,B,V,$,X,se,ne,ue){const be=[$.textOffset0,$.textOffset1],Ce=ss(c,l,h,be,d),_e=this.collisionIndex.placeCollisionBox(Bi(_,Ce.x,Ce.y,x,b,this.transform.angle),V,S,M,B.predicate,ue);if((!ne||this.collisionIndex.placeCollisionBox(Bi(ne,Ce.x,Ce.y,x,b,this.transform.angle),V,S,M,B.predicate,ue).box.length!==0)&&_e.box.length>0){let Ge;if(this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&(Ge=this.prevPlacement.variableOffsets[$.crossTileID].anchor),$.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[$.crossTileID]={textOffset:be,width:l,height:h,anchor:c,textBoxScale:d,prevAnchor:Ge},this.markUsedJustification(X,c,$,se),X.allowVerticalPlacement&&(this.markUsedOrientation(X,se,$),this.placedOrientations[$.crossTileID]=se),{shift:Ce,placedGlyphBoxes:_e}}}placeLayerBucketPart(c,_,l){const{bucket:h,layout:d,posMatrix:x,textLabelPlaneMatrix:b,labelToScreenMatrix:S,textPixelRatio:M,holdingForFade:B,collisionBoxArray:V,partiallyEvaluatedTextSize:$,collisionGroup:X}=c.parameters,se=d.get("text-optional"),ne=d.get("icon-optional"),ue=a.getOverlapMode(d,"text-overlap","text-allow-overlap"),be=ue==="always",Ce=a.getOverlapMode(d,"icon-overlap","icon-allow-overlap"),_e=Ce==="always",Ge=d.get("text-rotation-alignment")==="map",Te=d.get("text-pitch-alignment")==="map",Ue=d.get("icon-text-fit")!=="none",xe=d.get("symbol-z-order")==="viewport-y",m=be&&(_e||!h.hasIconData()||ne),g=_e&&(be||!h.hasTextData()||se);!h.collisionArrays&&V&&h.deserializeCollisionBoxes(V);const v=(E,C)=>{if(_[E.crossTileID])return;if(B)return void(this.placements[E.crossTileID]=new Os(!1,!1,!1));let R=!1,O=!1,N=!0,W=null,J={box:null,offscreen:null},le={box:null,offscreen:null},fe=null,Re=null,je=null,Be=0,Ze=0,ct=0;C.textFeatureIndex?Be=C.textFeatureIndex:E.useRuntimeCollisionCircles&&(Be=E.featureIndex),C.verticalTextFeatureIndex&&(Ze=C.verticalTextFeatureIndex);const At=this.retainedQueryData[h.bucketInstanceId].tileID,it=this.terrain?(Bt,ft)=>this.terrain.getElevation(At,Bt,ft):null;for(const Bt of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const ft=C[Bt];ft&&(ft.elevation=it?it(ft.anchorPointX,ft.anchorPointY):0)}const rt=C.textBox;if(rt){const Bt=yt=>{let Cn=a.WritingMode.horizontal;if(h.allowVerticalPlacement&&!yt&&this.prevPlacement){const xn=this.prevPlacement.placedOrientations[E.crossTileID];xn&&(this.placedOrientations[E.crossTileID]=xn,Cn=xn,this.markUsedOrientation(h,Cn,E))}return Cn},ft=(yt,Cn)=>{if(h.allowVerticalPlacement&&E.numVerticalGlyphVertices>0&&C.verticalTextBox){for(const xn of h.writingModes)if(xn===a.WritingMode.vertical?(J=Cn(),le=J):J=yt(),J&&J.box&&J.box.length)break}else J=yt()};if(d.get("text-variable-anchor")){let yt=d.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[E.crossTileID]){const gn=this.prevPlacement.variableOffsets[E.crossTileID];yt.indexOf(gn.anchor)>0&&(yt=yt.filter(yn=>yn!==gn.anchor),yt.unshift(gn.anchor))}const Cn=(gn,yn,bn)=>{const Ln=gn.x2-gn.x1,ai=gn.y2-gn.y1,Pn=E.textBoxScale,xi=Ue&&Ce==="never"?yn:null;let Qi={box:[],offscreen:!1};const el=ue!=="never"?2*yt.length:yt.length;for(let cu=0;cu<el;++cu){const p0=this.attemptAnchorPlacement(yt[cu%yt.length],gn,Ln,ai,Pn,Ge,Te,M,x,X,cu>=yt.length?ue:"never",E,h,bn,xi,it);if(p0&&(Qi=p0.placedGlyphBoxes,Qi&&Qi.box&&Qi.box.length)){R=!0,W=p0.shift;break}}return Qi};ft(()=>Cn(rt,C.iconBox,a.WritingMode.horizontal),()=>{const gn=C.verticalTextBox;return h.allowVerticalPlacement&&!(J&&J.box&&J.box.length)&&E.numVerticalGlyphVertices>0&&gn?Cn(gn,C.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),J&&(R=J.box,N=J.offscreen);const xn=Bt(J&&J.box);if(!R&&this.prevPlacement){const gn=this.prevPlacement.variableOffsets[E.crossTileID];gn&&(this.variableOffsets[E.crossTileID]=gn,this.markUsedJustification(h,gn.anchor,E,xn))}}else{const yt=(Cn,xn)=>{const gn=this.collisionIndex.placeCollisionBox(Cn,ue,M,x,X.predicate,it);return gn&&gn.box&&gn.box.length&&(this.markUsedOrientation(h,xn,E),this.placedOrientations[E.crossTileID]=xn),gn};ft(()=>yt(rt,a.WritingMode.horizontal),()=>{const Cn=C.verticalTextBox;return h.allowVerticalPlacement&&E.numVerticalGlyphVertices>0&&Cn?yt(Cn,a.WritingMode.vertical):{box:null,offscreen:null}}),Bt(J&&J.box&&J.box.length)}}if(fe=J,R=fe&&fe.box&&fe.box.length>0,N=fe&&fe.offscreen,E.useRuntimeCollisionCircles){const Bt=h.text.placedSymbolArray.get(E.centerJustifiedTextSymbolIndex),ft=a.evaluateSizeForFeature(h.textSizeData,$,Bt),yt=d.get("text-padding");Re=this.collisionIndex.placeCollisionCircles(ue,Bt,h.lineVertexArray,h.glyphOffsetArray,ft,x,b,S,l,Te,X.predicate,E.collisionCircleDiameter,yt,it),Re.circles.length&&Re.collisionDetected&&!l&&a.warnOnce("Collisions detected, but collision boxes are not shown"),R=be||Re.circles.length>0&&!Re.collisionDetected,N=N&&Re.offscreen}if(C.iconFeatureIndex&&(ct=C.iconFeatureIndex),C.iconBox){const Bt=ft=>{const yt=Ue&&W?Bi(ft,W.x,W.y,Ge,Te,this.transform.angle):ft;return this.collisionIndex.placeCollisionBox(yt,Ce,M,x,X.predicate,it)};le&&le.box&&le.box.length&&C.verticalIconBox?(je=Bt(C.verticalIconBox),O=je.box.length>0):(je=Bt(C.iconBox),O=je.box.length>0),N=N&&je.offscreen}const Xe=se||E.numHorizontalGlyphVertices===0&&E.numVerticalGlyphVertices===0,Vt=ne||E.numIconVertices===0;if(Xe||Vt?Vt?Xe||(O=O&&R):R=O&&R:O=R=O&&R,R&&fe&&fe.box&&this.collisionIndex.insertCollisionBox(fe.box,ue,d.get("text-ignore-placement"),h.bucketInstanceId,le&&le.box&&Ze?Ze:Be,X.ID),O&&je&&this.collisionIndex.insertCollisionBox(je.box,Ce,d.get("icon-ignore-placement"),h.bucketInstanceId,ct,X.ID),Re&&(R&&this.collisionIndex.insertCollisionCircles(Re.circles,ue,d.get("text-ignore-placement"),h.bucketInstanceId,Be,X.ID),l)){const Bt=h.bucketInstanceId;let ft=this.collisionCircleArrays[Bt];ft===void 0&&(ft=this.collisionCircleArrays[Bt]=new Ur);for(let yt=0;yt<Re.circles.length;yt+=4)ft.circles.push(Re.circles[yt+0]),ft.circles.push(Re.circles[yt+1]),ft.circles.push(Re.circles[yt+2]),ft.circles.push(Re.collisionDetected?1:0)}if(E.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[E.crossTileID]=new Os(R||m,O||g,N||h.justReloaded),_[E.crossTileID]=!0};if(xe){if(c.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const E=h.getSortedSymbolIndexes(this.transform.angle);for(let C=E.length-1;C>=0;--C){const R=E[C];v(h.symbolInstances.get(R),h.collisionArrays[R])}}else for(let E=c.symbolInstanceStart;E<c.symbolInstanceEnd;E++)v(h.symbolInstances.get(E),h.collisionArrays[E]);if(l&&h.bucketInstanceId in this.collisionCircleArrays){const E=this.collisionCircleArrays[h.bucketInstanceId];a.invert(E.invProjMatrix,x),E.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}markUsedJustification(c,_,l,h){let d;d=h===a.WritingMode.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(_)];const x=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const b of x)b>=0&&(c.text.placedSymbolArray.get(b).crossTileID=d>=0&&b!==d?0:l.crossTileID)}markUsedOrientation(c,_,l){const h=_===a.WritingMode.horizontal||_===a.WritingMode.horizontalOnly?_:0,d=_===a.WritingMode.vertical?_:0,x=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const b of x)c.text.placedSymbolArray.get(b).placedOrientation=h;l.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=d)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const _=this.prevPlacement;let l=!1;this.prevZoomAdjustment=_?_.zoomAdjustment(this.transform.zoom):0;const h=_?_.symbolFadeChange(c):1,d=_?_.opacities:{},x=_?_.variableOffsets:{},b=_?_.placedOrientations:{};for(const S in this.placements){const M=this.placements[S],B=d[S];B?(this.opacities[S]=new qn(B,h,M.text,M.icon),l=l||M.text!==B.text.placed||M.icon!==B.icon.placed):(this.opacities[S]=new qn(null,h,M.text,M.icon,M.skipFade),l=l||M.text||M.icon)}for(const S in d){const M=d[S];if(!this.opacities[S]){const B=new qn(M,h,!1,!1);B.isHidden()||(this.opacities[S]=B,l=l||M.text.placed||M.icon.placed)}}for(const S in x)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=x[S]);for(const S in b)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=b[S]);if(_&&_.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=_?_.lastPlacementChangeTime:c)}updateLayerOpacities(c,_){const l={};for(const h of _){const d=h.getBucket(c);d&&h.latestFeatureIndex&&c.id===d.layerIds[0]&&this.updateBucketOpacities(d,l,h.collisionBoxArray)}}updateBucketOpacities(c,_,l){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const h=c.layers[0].layout,d=new qn(null,0,!1,!1,!0),x=h.get("text-allow-overlap"),b=h.get("icon-allow-overlap"),S=h.get("text-variable-anchor"),M=h.get("text-rotation-alignment")==="map",B=h.get("text-pitch-alignment")==="map",V=h.get("icon-text-fit")!=="none",$=new qn(null,0,x&&(b||!c.hasIconData()||h.get("icon-optional")),b&&(x||!c.hasTextData()||h.get("text-optional")),!0);!c.collisionArrays&&l&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(l);const X=(se,ne,ue)=>{for(let be=0;be<ne/4;be++)se.opacityVertexArray.emplaceBack(ue)};for(let se=0;se<c.symbolInstances.length;se++){const ne=c.symbolInstances.get(se),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:be,crossTileID:Ce}=ne;let _e=this.opacities[Ce];_[Ce]?_e=d:_e||(_e=$,this.opacities[Ce]=_e),_[Ce]=!0;const Ge=ne.numIconVertices>0,Te=this.placedOrientations[ne.crossTileID],Ue=Te===a.WritingMode.vertical,xe=Te===a.WritingMode.horizontal||Te===a.WritingMode.horizontalOnly;if(ue>0||be>0){const m=ke(_e.text);X(c.text,ue,Ue?We:m),X(c.text,be,xe?We:m);const g=_e.text.isHidden();[ne.rightJustifiedTextSymbolIndex,ne.centerJustifiedTextSymbolIndex,ne.leftJustifiedTextSymbolIndex].forEach(C=>{C>=0&&(c.text.placedSymbolArray.get(C).hidden=g||Ue?1:0)}),ne.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(ne.verticalPlacedTextSymbolIndex).hidden=g||xe?1:0);const v=this.variableOffsets[ne.crossTileID];v&&this.markUsedJustification(c,v.anchor,ne,Te);const E=this.placedOrientations[ne.crossTileID];E&&(this.markUsedJustification(c,"left",ne,E),this.markUsedOrientation(c,E,ne))}if(Ge){const m=ke(_e.icon),g=!(V&&ne.verticalPlacedIconSymbolIndex&&Ue);ne.placedIconSymbolIndex>=0&&(X(c.icon,ne.numIconVertices,g?m:We),c.icon.placedSymbolArray.get(ne.placedIconSymbolIndex).hidden=_e.icon.isHidden()),ne.verticalPlacedIconSymbolIndex>=0&&(X(c.icon,ne.numVerticalIconVertices,g?We:m),c.icon.placedSymbolArray.get(ne.verticalPlacedIconSymbolIndex).hidden=_e.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const m=c.collisionArrays[se];if(m){let g=new a.pointGeometry(0,0);if(m.textBox||m.verticalTextBox){let E=!0;if(S){const C=this.variableOffsets[Ce];C?(g=ss(C.anchor,C.width,C.height,C.textOffset,C.textBoxScale),M&&g._rotate(B?this.transform.angle:-this.transform.angle)):E=!1}m.textBox&&H(c.textCollisionBox.collisionVertexArray,_e.text.placed,!E||Ue,g.x,g.y),m.verticalTextBox&&H(c.textCollisionBox.collisionVertexArray,_e.text.placed,!E||xe,g.x,g.y)}const v=!!(!xe&&m.verticalIconBox);m.iconBox&&H(c.iconCollisionBox.collisionVertexArray,_e.icon.placed,v,V?g.x:0,V?g.y:0),m.verticalIconBox&&H(c.iconCollisionBox.collisionVertexArray,_e.icon.placed,!v,V?g.x:0,V?g.y:0)}}}if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.text.opacityVertexArray.length!==c.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${c.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${c.text.layoutVertexArray.length}) / 4`);if(c.icon.opacityVertexArray.length!==c.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${c.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${c.icon.layoutVertexArray.length}) / 4`);if(c.bucketInstanceId in this.collisionCircleArrays){const se=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=se.invProjMatrix,c.placementViewportMatrix=se.viewportMatrix,c.collisionCircleArray=se.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,_){const l=this.zoomAtLastRecencyCheck===_?1-this.zoomAdjustment(_):1;return this.zoomAtLastRecencyCheck=_,this.commitTime+this.fadeDuration*l>c}setStale(){this.stale=!0}}function H(k,c,_,l,h){k.emplaceBack(c?1:0,_?1:0,l||0,h||0),k.emplaceBack(c?1:0,_?1:0,l||0,h||0),k.emplaceBack(c?1:0,_?1:0,l||0,h||0),k.emplaceBack(c?1:0,_?1:0,l||0,h||0)}const ee=Math.pow(2,25),he=Math.pow(2,24),o=Math.pow(2,17),G=Math.pow(2,16),Le=Math.pow(2,9),Ie=Math.pow(2,8),Pe=Math.pow(2,1);function ke(k){if(k.opacity===0&&!k.placed)return 0;if(k.opacity===1&&k.placed)return 4294967295;const c=k.placed?1:0,_=Math.floor(127*k.opacity);return _*ee+c*he+_*o+c*G+_*Le+c*Ie+_*Pe+c}const We=0;class at{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&!c.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,_,l,h,d){const x=this._bucketParts;for(;this._currentTileIndex<c.length;)if(_.getBucketParts(x,h,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((b,S)=>b.sortKey-S.sortKey));this._currentPartIndex<x.length;)if(_.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,d())return!0;return!1}}class $e{constructor(c,_,l,h,d,x,b,S){this.placement=new K(c,_,x,b,S),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=d,this._done=!1}isDone(){return this._done}continuePlacement(c,_,l){const h=a.exported.now(),d=()=>{const x=a.exported.now()-h;return!this._forceFullPlacement&&x>2};for(;this._currentPlacementIndex>=0;){const x=_[c[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=b)&&(!x.maxzoom||x.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new at(x)),this._inProgressLayer.continuePlacement(l[x.source],this.placement,this._showCollisionBoxes,x,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const ht=512/a.EXTENT/2;class Lt{constructor(c,_,l){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(let h=0;h<_.length;h++){const d=_.get(h),x=d.key;this.indexedSymbolInstances[x]||(this.indexedSymbolInstances[x]=[]),this.indexedSymbolInstances[x].push({crossTileID:d.crossTileID,coord:this.getScaledCoordinates(d,c)})}}getScaledCoordinates(c,_){const l=ht/Math.pow(2,_.canonical.z-this.tileID.canonical.z);return{x:Math.floor((_.canonical.x*a.EXTENT+c.anchorX)*l),y:Math.floor((_.canonical.y*a.EXTENT+c.anchorY)*l)}}findMatches(c,_,l){const h=this.tileID.canonical.z<_.canonical.z?1:Math.pow(2,this.tileID.canonical.z-_.canonical.z);for(let d=0;d<c.length;d++){const x=c.get(d);if(x.crossTileID)continue;const b=this.indexedSymbolInstances[x.key];if(!b)continue;const S=this.getScaledCoordinates(x,_);for(const M of b)if(Math.abs(M.coord.x-S.x)<=h&&Math.abs(M.coord.y-S.y)<=h&&!l[M.crossTileID]){l[M.crossTileID]=!0,x.crossTileID=M.crossTileID;break}}}}class Dt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class rn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const _=Math.round((c-this.lng)/360);if(_!==0)for(const l in this.indexes){const h=this.indexes[l],d={};for(const x in h){const b=h[x];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+_),d[b.tileID.key]=b}this.indexes[l]=d}this.lng=c}addBucket(c,_,l){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===_.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let d=0;d<_.symbolInstances.length;d++)_.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const h=this.usedCrossTileIDs[c.overscaledZ];for(const d in this.indexes){const x=this.indexes[d];if(Number(d)>c.overscaledZ)for(const b in x){const S=x[b];S.tileID.isChildOf(c)&&S.findMatches(_.symbolInstances,c,h)}else{const b=x[c.scaledTo(Number(d)).key];b&&b.findMatches(_.symbolInstances,c,h)}}for(let d=0;d<_.symbolInstances.length;d++){const x=_.symbolInstances.get(d);x.crossTileID||(x.crossTileID=l.generate(),h[x.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Lt(c,_.symbolInstances,_.bucketInstanceId),!0}removeBucketCrossTileIDs(c,_){for(const l in _.indexedSymbolInstances)for(const h of _.indexedSymbolInstances[l])delete this.usedCrossTileIDs[c][h.crossTileID]}removeStaleBuckets(c){let _=!1;for(const l in this.indexes){const h=this.indexes[l];for(const d in h)c[h[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,h[d]),delete h[d],_=!0)}return _}}class jt{constructor(){this.layerIndexes={},this.crossTileIDs=new Dt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,_,l){let h=this.layerIndexes[c.id];h===void 0&&(h=this.layerIndexes[c.id]=new rn);let d=!1;const x={};h.handleWrapJump(l);for(const b of _){const S=b.getBucket(c);S&&c.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(b.tileID,S,this.crossTileIDs)&&(d=!0),x[S.bucketInstanceId]=!0)}return h.removeStaleBuckets(x)&&(d=!0),d}pruneUnusedLayers(c){const _={};c.forEach(l=>{_[l]=!0});for(const l in this.layerIndexes)_[l]||delete this.layerIndexes[l]}}var dn=a.createLayout([{name:"a_pos",type:"Int16",components:2}]);class Qt extends a.Evented{constructor(c){super(),this.sourceCache=c,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=c._cache.max,c.usedForTerrain=!0,c.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const c in this._tiles){const _=this._tiles[c];_.textures.forEach(l=>l.destroy()),_.textures=[]}}update(c,_){this.sourceCache.update(c,_),this._renderableTilesKeys=[];for(const l of c.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:_}))this._renderableTilesKeys.push(l.key),this._tiles[l.key]||(l.posMatrix=new Float64Array(16),a.ortho(l.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),this._tiles[l.key]=new ci(l,this.tileSize))}removeOutdated(c){const _={};this.renderHistory=this.renderHistory.filter((l,h)=>this.renderHistory.indexOf(l)===h).slice(0,this.renderHistorySize);for(const l of this._renderableTilesKeys)_[l]=!0;for(const l of this.renderHistory)_[l]=!0;for(const l in this._tiles)_[l]||(this._tiles[l].clearTextures(c),delete this._tiles[l])}getRenderableTiles(){return this._renderableTilesKeys.map(c=>this.getTileByID(c))}getTileByID(c){return this._tiles[c]}getTerrainCoords(c){const _={};for(const l of this._renderableTilesKeys){const h=this._tiles[l].tileID;if(h.canonical.equals(c.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16),a.ortho(d.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),_[l]=d}else if(h.canonical.isChildOf(c.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16);const x=h.canonical.z-c.canonical.z,b=h.canonical.x-(h.canonical.x>>x<<x),S=h.canonical.y-(h.canonical.y>>x<<x),M=a.EXTENT>>x;a.ortho(d.posMatrix,0,M,0,M,0,1),a.translate(d.posMatrix,d.posMatrix,[-b*M,-S*M,0]),_[l]=d}else if(c.canonical.isChildOf(h.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16);const x=c.canonical.z-h.canonical.z,b=c.canonical.x-(c.canonical.x>>x<<x),S=c.canonical.y-(c.canonical.y>>x<<x),M=a.EXTENT>>x;a.ortho(d.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),a.translate(d.posMatrix,d.posMatrix,[b*M,S*M,0]),a.scale(d.posMatrix,d.posMatrix,[1/2**x,1/2**x,0]),_[l]=d}}return _}getSourceTile(c,_){const l=this.sourceCache._source;let h=c.overscaledZ-this.deltaZoom;if(h>l.maxzoom&&(h=l.maxzoom),h<l.minzoom)return null;this._sourceTileCache[c.key]||(this._sourceTileCache[c.key]=c.scaledTo(h).key);let d=this.sourceCache.getTileByID(this._sourceTileCache[c.key]);if((!d||!d.dem)&&_)for(;h>=l.minzoom&&(!d||!d.dem);)d=this.sourceCache.getTileByID(c.scaledTo(h--).key);return d}tilesAfterTime(c=Date.now()){return Object.values(this._tiles).filter(_=>_.timeLoaded>=c)}}class on{constructor(c,_,l){this.style=c,this.sourceCache=new Qt(_),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.elevationOffset=typeof l.elevationOffset=="number"?l.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(c,_,l,h=a.EXTENT){if(!(_>=0&&_<h&&l>=0&&l<h))return this.elevationOffset;let d=0;const x=this.getTerrainData(c);if(x.tile&&x.tile.dem){const b=a.transformMat4$1([],[_/h*a.EXTENT,l/h*a.EXTENT],x.u_terrain_matrix),S=[b[0]*x.tile.dem.dim,b[1]*x.tile.dem.dim],M=[Math.floor(S[0]),Math.floor(S[1])],B=x.tile.dem.get(M[0],M[1]),V=x.tile.dem.get(M[0],M[1]+1),$=x.tile.dem.get(M[0]+1,M[1]),X=x.tile.dem.get(M[0]+1,M[1]+1);d=a.number(a.number(B,V,S[0]-M[0]),a.number($,X,S[0]-M[0]),S[1]-M[1])}return d}rememberForRerender(c,_){for(const l in this.sourceCache._tiles){const h=this.sourceCache._tiles[l];(h.tileID.equals(_)||h.tileID.isChildOf(_))&&(c===this.sourceCache.sourceCache.id&&(h.timeLoaded=Date.now()),this._rerender[c]=this._rerender[c]||{},this._rerender[c][h.tileID.key]=!0)}}needsRerender(c,_){return this._rerender[c]&&this._rerender[c][_.key]}clearRerenderCache(){this._rerender={}}getElevation(c,_,l,h=a.EXTENT){return(this.getDEMElevation(c,_,l,h)+this.elevationOffset)*this.exaggeration}getTerrainData(c){if(!this._emptyDemTexture){const h=this.style.map.painter.context,d=new a.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Z(h,d,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Z(h,new a.RGBAImage({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.identity([])}const _=this.sourceCache.getSourceTile(c,!0);if(_&&_.dem&&(!_.demTexture||_.needsTerrainPrepare)){const h=this.style.map.painter.context;_.demTexture=this.style.map.painter.getTileTexture(_.dem.stride),_.demTexture?_.demTexture.update(_.dem.getPixels(),{premultiply:!1}):_.demTexture=new Z(h,_.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),_.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),_.needsTerrainPrepare=!1}const l=_&&_+_.tileID.key+c.key;if(l&&!this._demMatrixCache[l]){const h=this.sourceCache.sourceCache._source.maxzoom;let d=c.canonical.z-_.tileID.canonical.z;c.overscaledZ>c.canonical.z&&(c.canonical.z>=h?d=c.canonical.z-h:a.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=c.canonical.x-(c.canonical.x>>d<<d),b=c.canonical.y-(c.canonical.y>>d<<d),S=a.fromScaling(new Float64Array(16),[1/(a.EXTENT<<d),1/(a.EXTENT<<d),0]);a.translate(S,S,[x*a.EXTENT,b*a.EXTENT,0]),this._demMatrixCache[c.key]={matrix:S,coord:c}}return{u_depth:2,u_terrain:3,u_terrain_dim:_&&_.dem&&_.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[c.key].matrix:this._emptyDemMatrix,u_terrain_unpack:_&&_.dem&&_.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(_&&_.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:_}}getRTTFramebuffer(){const c=this.style.map.painter;if(!this._rttFramebuffer){const _=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=c.context.createFramebuffer(_,_,!0),this._rttFramebuffer.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,_,_))}return this._rttFramebuffer}getFramebuffer(c){const _=this.style.map.painter,l=_.width/devicePixelRatio,h=_.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Z(_.context,{width:l,height:h,data:null},_.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(_.context.gl.NEAREST,_.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Z(_.context,{width:l,height:h,data:null},_.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(_.context.gl.NEAREST,_.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=_.context.createFramebuffer(l,h,!0),this._fbo.depthAttachment.set(_.context.createRenderbuffer(_.context.gl.DEPTH_COMPONENT16,l,h))),this._fbo.colorAttachment.set(c==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const c=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const _=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let d=0,x=0;d<this._coordsTextureSize;d++)for(let b=0;b<this._coordsTextureSize;b++,x+=4)_[x+0]=255&b,_[x+1]=255&d,_[x+2]=b>>8<<4|d>>8,_[x+3]=0;const l=new a.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(_.buffer)),h=new Z(c,l,c.gl.RGBA,{premultiply:!1});return h.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(c){const _=new Uint8Array(4),l=this.style.map.painter,h=l.context,d=h.gl;h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(c.x,l.height/devicePixelRatio-c.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,_),h.bindFramebuffer.set(null);const x=_[0]+(_[2]>>4<<8),b=_[1]+((15&_[2])<<8),S=this.coordsIndex[255-_[3]],M=S&&this.sourceCache.getTileByID(S);if(!M)return null;const B=this._coordsTextureSize,V=(1<<M.tileID.canonical.z)*B;return new a.MercatorCoordinate((M.tileID.canonical.x*B+x)/V,(M.tileID.canonical.y*B+b)/V,this.getElevation(M.tileID,x,b,B))}getTerrainMesh(){if(this._mesh)return this._mesh;const c=this.style.map.painter.context,_=new a.PosArray,l=new a.TriangleIndexArray,h=this.meshSize,d=a.EXTENT/h,x=h*h;for(let b=0;b<=h;b++)for(let S=0;S<=h;S++)_.emplaceBack(S*d,b*d);for(let b=0;b<x;b+=h+1)for(let S=0;S<h;S++)l.emplaceBack(S+b,h+S+b+1,h+S+b+2),l.emplaceBack(S+b,h+S+b+2,S+b+1);return this._mesh={indexBuffer:c.createIndexBuffer(l),vertexBuffer:c.createVertexBuffer(_,dn.members),segments:a.SegmentVector.simpleSegment(0,0,_.length,l.length)},this._mesh}getMinMaxElevation(c){const _=this.getTerrainData(c).tile,l={minElevation:null,maxElevation:null};return _&&_.dem&&(l.minElevation=(_.dem.min+this.elevationOffset)*this.exaggeration,l.maxElevation=(_.dem.max+this.elevationOffset)*this.exaggeration),l}}const vn=(k,c)=>a.emitValidationErrors(k,c&&c.filter(_=>_.identifier!=="source.canvas")),Ot=a.pick(Un,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Oe=a.pick(Un,["setCenter","setZoom","setBearing","setPitch"]),Mt=function(){const k={},c=a.spec.$version;for(const _ in a.spec.$root){const l=a.spec.$root[_];if(l.required){let h=null;h=_==="version"?c:l.type==="array"?[]:{},h!=null&&(k[_]=h)}}return k}();class Se extends a.Evented{constructor(c,_={}){super(),this.map=c,this.dispatcher=new tt(li(),this),this.imageManager=new Y,this.imageManager.setEventedParent(this),this.glyphManager=new ve(c._requestManager,_.localIdeographFontFamily),this.lineAtlas=new et(256,512),this.crossTileSymbolIndex=new jt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const l=this;this._rtlTextPluginCallback=Se.registerForPluginStateChange(h=>{l.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:h.pluginStatus,pluginURL:h.pluginURL},(d,x)=>{if(a.triggerPluginCompletionEvent(d),x&&x.every(b=>b))for(const b in l.sourceCaches)l.sourceCaches[b].reload()})}),this.on("data",h=>{if(h.dataType!=="source"||h.sourceDataType!=="metadata")return;const d=this.sourceCaches[h.sourceId];if(!d)return;const x=d.getSource();if(x&&x.vectorLayerIds)for(const b in this._layers){const S=this._layers[b];S.source===x.id&&this._validateLayer(S)}})}loadURL(c,_={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const l=typeof _.validate!="boolean"||_.validate,h=this.map._requestManager.transformRequest(c,a.ResourceType.Style);this._request=a.getJSON(h,(d,x)=>{this._request=null,d?this.fire(new a.ErrorEvent(d)):x&&this._load(x,l)})}loadJSON(c,_={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(c,_.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Mt,!1)}_load(c,_){if(_&&vn(this,a.validateStyle(c)))return;this._loaded=!0,this.stylesheet=c;for(const h in c.sources)this.addSource(h,c.sources[h],{validate:!1});c.sprite?this._loadSprite(c.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(c.glyphs);const l=Ki(this.stylesheet.layers);this._order=l.map(h=>h.id),this._layers={},this._serializedLayers={};for(let h of l)h=a.createStyleLayer(h),h.setEventedParent(this,{layer:{id:h.id}}),this._layers[h.id]=h,this._serializedLayers[h.id]=h.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Qe(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}_loadSprite(c){this._spriteRequest=function(_,l,h,d){let x,b,S;const M=h>1?"@2x":"";let B=a.getJSON(l.transformRequest(l.normalizeSpriteURL(_,M,".json"),a.ResourceType.SpriteJSON),(X,se)=>{B=null,S||(S=X,x=se,$())}),V=a.getImage(l.transformRequest(l.normalizeSpriteURL(_,M,".png"),a.ResourceType.SpriteImage),(X,se)=>{V=null,S||(S=X,b=se,$())});function $(){if(S)d(S);else if(x&&b){const X=a.exported.getImageData(b),se={};for(const ne in x){const{width:ue,height:be,x:Ce,y:_e,sdf:Ge,pixelRatio:Te,stretchX:Ue,stretchY:xe,content:m}=x[ne],g=new a.RGBAImage({width:ue,height:be});a.RGBAImage.copy(X,g,{x:Ce,y:_e},{x:0,y:0},{width:ue,height:be}),se[ne]={data:g,pixelRatio:Te,sdf:Ge,stretchX:Ue,stretchY:xe,content:m}}d(null,se)}}return{cancel(){B&&(B.cancel(),B=null),V&&(V.cancel(),V=null)}}}(c,this.map._requestManager,this.map.getPixelRatio(),(_,l)=>{if(this._spriteRequest=null,_)this.fire(new a.ErrorEvent(_));else if(l)for(const h in l)this.imageManager.addImage(h,l[h]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(c){const _=this.sourceCaches[c.source];if(!_)return;const l=c.sourceLayer;if(!l)return;const h=_.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(l)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${l}" does not exist on source "${h.id}" as specified by style layer "${c.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this.sourceCaches)if(!this.sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const _=[];for(const l of c){const h=this._layers[l];h.type!=="custom"&&_.push(h.serialize())}return _}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(c){if(!this._loaded)return;const _=this._changed;if(this._changed){const h=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);(h.length||d.length)&&this._updateWorkerLayers(h,d);for(const x in this._updatedSources){const b=this._updatedSources[x];if(b==="reload")this._reloadSource(x);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(x)}}this._updateTilesForChangedImages();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(c);this.light.updateTransitions(c),this._resetUpdates()}const l={};for(const h in this.sourceCaches){const d=this.sourceCaches[h];l[h]=d.used,d.used=!1}for(const h of this._order){const d=this._layers[h];d.recalculate(c,this._availableImages),!d.isHidden(c.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(const h in l){const d=this.sourceCaches[h];l[h]!==d.used&&d.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(c),this.z=c.zoom,_&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const _ in this.sourceCaches)this.sourceCaches[_].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,_){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:_})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(c){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),c){const _=this.sourceCaches[c.source];if(!_)throw new Error(`cannot load terrain, because there exists no source with ID: ${c.source}`);this.terrain=new on(this,_,c),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=l=>{l.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=l=>{l.tile&&(l.sourceId===c.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(l.sourceId,l.tile.tileID)):l.source.type==="geojson"&&this.terrain.rememberForRerender(l.sourceId,l.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new a.Event("terrain",{terrain:c}))}setState(c){if(this._checkLoaded(),vn(this,a.validateStyle(c)))return!1;(c=a.clone$1(c)).layers=Ki(c.layers);const _=function(h,d){if(!h)return[{command:Un.setStyle,args:[d]}];let x=[];try{if(!P(h.version,d.version))return[{command:Un.setStyle,args:[d]}];P(h.center,d.center)||x.push({command:Un.setCenter,args:[d.center]}),P(h.zoom,d.zoom)||x.push({command:Un.setZoom,args:[d.zoom]}),P(h.bearing,d.bearing)||x.push({command:Un.setBearing,args:[d.bearing]}),P(h.pitch,d.pitch)||x.push({command:Un.setPitch,args:[d.pitch]}),P(h.sprite,d.sprite)||x.push({command:Un.setSprite,args:[d.sprite]}),P(h.glyphs,d.glyphs)||x.push({command:Un.setGlyphs,args:[d.glyphs]}),P(h.transition,d.transition)||x.push({command:Un.setTransition,args:[d.transition]}),P(h.light,d.light)||x.push({command:Un.setLight,args:[d.light]});const b={},S=[];(function(B,V,$,X){let se;for(se in V=V||{},B=B||{})Object.prototype.hasOwnProperty.call(B,se)&&(Object.prototype.hasOwnProperty.call(V,se)||Hn(se,$,X));for(se in V)Object.prototype.hasOwnProperty.call(V,se)&&(Object.prototype.hasOwnProperty.call(B,se)?P(B[se],V[se])||(B[se].type==="geojson"&&V[se].type==="geojson"&&fo(B,V,se)?$.push({command:Un.setGeoJSONSourceData,args:[se,V[se].data]}):Fr(se,V,$,X)):Cr(se,V,$))})(h.sources,d.sources,S,b);const M=[];h.layers&&h.layers.forEach(B=>{b[B.source]?x.push({command:Un.removeLayer,args:[B.id]}):M.push(B)}),x=x.concat(S),function(B,V,$){V=V||[];const X=(B=B||[]).map(Pr),se=V.map(Pr),ne=B.reduce(Fo,{}),ue=V.reduce(Fo,{}),be=X.slice(),Ce=Object.create(null);let _e,Ge,Te,Ue,xe,m,g;for(_e=0,Ge=0;_e<X.length;_e++)Te=X[_e],Object.prototype.hasOwnProperty.call(ue,Te)?Ge++:($.push({command:Un.removeLayer,args:[Te]}),be.splice(be.indexOf(Te,Ge),1));for(_e=0,Ge=0;_e<se.length;_e++)Te=se[se.length-1-_e],be[be.length-1-_e]!==Te&&(Object.prototype.hasOwnProperty.call(ne,Te)?($.push({command:Un.removeLayer,args:[Te]}),be.splice(be.lastIndexOf(Te,be.length-Ge),1)):Ge++,m=be[be.length-_e],$.push({command:Un.addLayer,args:[ue[Te],m]}),be.splice(be.length-_e,0,Te),Ce[Te]=!0);for(_e=0;_e<se.length;_e++)if(Te=se[_e],Ue=ne[Te],xe=ue[Te],!Ce[Te]&&!P(Ue,xe))if(P(Ue.source,xe.source)&&P(Ue["source-layer"],xe["source-layer"])&&P(Ue.type,xe.type)){for(g in Ni(Ue.layout,xe.layout,$,Te,null,Un.setLayoutProperty),Ni(Ue.paint,xe.paint,$,Te,null,Un.setPaintProperty),P(Ue.filter,xe.filter)||$.push({command:Un.setFilter,args:[Te,xe.filter]}),P(Ue.minzoom,xe.minzoom)&&P(Ue.maxzoom,xe.maxzoom)||$.push({command:Un.setLayerZoomRange,args:[Te,xe.minzoom,xe.maxzoom]}),Ue)Object.prototype.hasOwnProperty.call(Ue,g)&&g!=="layout"&&g!=="paint"&&g!=="filter"&&g!=="metadata"&&g!=="minzoom"&&g!=="maxzoom"&&(g.indexOf("paint.")===0?Ni(Ue[g],xe[g],$,Te,g.slice(6),Un.setPaintProperty):P(Ue[g],xe[g])||$.push({command:Un.setLayerProperty,args:[Te,g,xe[g]]}));for(g in xe)Object.prototype.hasOwnProperty.call(xe,g)&&!Object.prototype.hasOwnProperty.call(Ue,g)&&g!=="layout"&&g!=="paint"&&g!=="filter"&&g!=="metadata"&&g!=="minzoom"&&g!=="maxzoom"&&(g.indexOf("paint.")===0?Ni(Ue[g],xe[g],$,Te,g.slice(6),Un.setPaintProperty):P(Ue[g],xe[g])||$.push({command:Un.setLayerProperty,args:[Te,g,xe[g]]}))}else $.push({command:Un.removeLayer,args:[Te]}),m=be[be.lastIndexOf(Te)+1],$.push({command:Un.addLayer,args:[xe,m]})}(M,d.layers,x)}catch(b){console.warn("Unable to compute style diff:",b),x=[{command:Un.setStyle,args:[d]}]}return x}(this.serialize(),c).filter(h=>!(h.command in Oe));if(_.length===0)return!1;const l=_.filter(h=>!(h.command in Ot));if(l.length>0)throw new Error(`Unimplemented: ${l.map(h=>h.command).join(", ")}.`);return _.forEach(h=>{h.command!=="setTransition"&&this[h.command].apply(this,h.args)}),this.stylesheet=c,!0}addImage(c,_){if(this.getImage(c))return this.fire(new a.ErrorEvent(new Error(`An image named "${c}" already exists.`)));this.imageManager.addImage(c,_),this._afterImageUpdated(c)}updateImage(c,_){this.imageManager.updateImage(c,_)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){if(!this.getImage(c))return this.fire(new a.ErrorEvent(new Error(`An image named "${c}" does not exist.`)));this.imageManager.removeImage(c),this._afterImageUpdated(c)}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(c,_,l={}){if(this._checkLoaded(),this.sourceCaches[c]!==void 0)throw new Error(`Source "${c}" already exists.`);if(!_.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(_).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(_.type)>=0&&this._validate(a.validateStyle.source,`sources.${c}`,_,null,l))return;this.map&&this.map._collectResourceTiming&&(_.collectResourceTiming=!0);const h=this.sourceCaches[c]=new xt(c,_,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:h.serialize(),sourceId:c})),h.onAdd(this.map),this._changed=!0}removeSource(c){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===c)return this.fire(new a.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${l}" is using it.`)));const _=this.sourceCaches[c];delete this.sourceCaches[c],delete this._updatedSources[c],_.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),_.setEventedParent(null),_.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(c,_){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error(`There is no source with this ID=${c}`);const l=this.sourceCaches[c].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(_),this._changed=!0}getSource(c){return this.sourceCaches[c]&&this.sourceCaches[c].getSource()}addLayer(c,_,l={}){this._checkLoaded();const h=c.id;if(this.getLayer(h))return void this.fire(new a.ErrorEvent(new Error(`Layer "${h}" already exists on this map.`)));let d;if(c.type==="custom"){if(vn(this,a.validateCustomStyleLayer(c)))return;d=a.createStyleLayer(c)}else{if(typeof c.source=="object"&&(this.addSource(h,c.source),c=a.clone$1(c),c=a.extend(c,{source:h})),this._validate(a.validateStyle.layer,`layers.${h}`,c,{arrayIndex:-1},l))return;d=a.createStyleLayer(c),this._validateLayer(d),d.setEventedParent(this,{layer:{id:h}}),this._serializedLayers[d.id]=d.serialize()}const x=_?this._order.indexOf(_):this._order.length;if(_&&x===-1)this.fire(new a.ErrorEvent(new Error(`Cannot add layer "${h}" before non-existing layer "${_}".`)));else{if(this._order.splice(x,0,h),this._layerOrderChanged=!0,this._layers[h]=d,this._removedLayers[h]&&d.source&&d.type!=="custom"){const b=this._removedLayers[h];delete this._removedLayers[h],b.type!==d.type?this._updatedSources[d.source]="clear":(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map)}}moveLayer(c,_){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new a.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===_)return;const l=this._order.indexOf(c);this._order.splice(l,1);const h=_?this._order.indexOf(_):this._order.length;_&&h===-1?this.fire(new a.ErrorEvent(new Error(`Cannot move layer "${c}" before non-existing layer "${_}".`))):(this._order.splice(h,0,c),this._layerOrderChanged=!0)}removeLayer(c){this._checkLoaded();const _=this._layers[c];if(!_)return void this.fire(new a.ErrorEvent(new Error(`Cannot remove non-existing layer "${c}".`)));_.setEventedParent(null);const l=this._order.indexOf(c);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=_,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],_.onRemove&&_.onRemove(this.map)}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}setLayerZoomRange(c,_,l){this._checkLoaded();const h=this.getLayer(c);h?h.minzoom===_&&h.maxzoom===l||(_!=null&&(h.minzoom=_),l!=null&&(h.maxzoom=l),this._updateLayer(h)):this.fire(new a.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${c}".`)))}setFilter(c,_,l={}){this._checkLoaded();const h=this.getLayer(c);if(h){if(!P(h.filter,_))return _==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(a.validateStyle.filter,`layers.${h.id}.filter`,_,null,l)||(h.filter=a.clone$1(_),this._updateLayer(h)))}else this.fire(new a.ErrorEvent(new Error(`Cannot filter non-existing layer "${c}".`)))}getFilter(c){return a.clone$1(this.getLayer(c).filter)}setLayoutProperty(c,_,l,h={}){this._checkLoaded();const d=this.getLayer(c);d?P(d.getLayoutProperty(_),l)||(d.setLayoutProperty(_,l,h),this._updateLayer(d)):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getLayoutProperty(c,_){const l=this.getLayer(c);if(l)return l.getLayoutProperty(_);this.fire(new a.ErrorEvent(new Error(`Cannot get style of non-existing layer "${c}".`)))}setPaintProperty(c,_,l,h={}){this._checkLoaded();const d=this.getLayer(c);d?P(d.getPaintProperty(_),l)||(d.setPaintProperty(_,l,h)&&this._updateLayer(d),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getPaintProperty(c,_){return this.getLayer(c).getPaintProperty(_)}setFeatureState(c,_){this._checkLoaded();const l=c.source,h=c.sourceLayer,d=this.sourceCaches[l];if(d===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${l}' does not exist in the map's style.`)));const x=d.getSource().type;x==="geojson"&&h?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||h?(c.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),d.setFeatureState(h,c.id,_)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(c,_){this._checkLoaded();const l=c.source,h=this.sourceCaches[l];if(h===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${l}' does not exist in the map's style.`)));const d=h.getSource().type,x=d==="vector"?c.sourceLayer:void 0;d!=="vector"||x?_&&typeof c.id!="string"&&typeof c.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(x,c.id,_):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(c){this._checkLoaded();const _=c.source,l=c.sourceLayer,h=this.sourceCaches[_];if(h!==void 0)return h.getSource().type!=="vector"||l?(c.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),h.getFeatureState(l,c.id)):void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,c=>c.serialize()),layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&this.sourceCaches[c.source].getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(c){const _=x=>this._layers[x].type==="fill-extrusion",l={},h=[];for(let x=this._order.length-1;x>=0;x--){const b=this._order[x];if(_(b)){l[b]=x;for(const S of c){const M=S[b];if(M)for(const B of M)h.push(B)}}}h.sort((x,b)=>b.intersectionZ-x.intersectionZ);const d=[];for(let x=this._order.length-1;x>=0;x--){const b=this._order[x];if(_(b))for(let S=h.length-1;S>=0;S--){const M=h[S].feature;if(l[M.layer.id]<x)break;d.push(M),h.pop()}else for(const S of c){const M=S[b];if(M)for(const B of M)d.push(B.feature)}}return d}queryRenderedFeatures(c,_,l){_&&_.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",_.filter,null,_);const h={};if(_&&_.layers){if(!Array.isArray(_.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const x of _.layers){const b=this._layers[x];if(!b)return this.fire(new a.ErrorEvent(new Error(`The layer '${x}' does not exist in the map's style and cannot be queried for features.`))),[];h[b.source]=!0}}const d=[];_.availableImages=this._availableImages;for(const x in this.sourceCaches)_.layers&&!h[x]||d.push(Jn(this.sourceCaches[x],this._layers,this._serializedLayers,c,_,l));return this.placement&&d.push(function(x,b,S,M,B,V,$){const X={},se=V.queryRenderedSymbols(M),ne=[];for(const ue of Object.keys(se).map(Number))ne.push($[ue]);ne.sort(oi);for(const ue of ne){const be=ue.featureIndex.lookupSymbolFeatures(se[ue.bucketInstanceId],b,ue.bucketIndex,ue.sourceLayerIndex,B.filter,B.layers,B.availableImages,x);for(const Ce in be){const _e=X[Ce]=X[Ce]||[],Ge=be[Ce];Ge.sort((Te,Ue)=>{const xe=ue.featureSortOrder;if(xe){const m=xe.indexOf(Te.featureIndex);return xe.indexOf(Ue.featureIndex)-m}return Ue.featureIndex-Te.featureIndex});for(const Te of Ge)_e.push(Te)}}for(const ue in X)X[ue].forEach(be=>{const Ce=be.feature,_e=S[x[ue].source].getFeatureState(Ce.layer["source-layer"],Ce.id);Ce.source=Ce.layer.source,Ce.layer["source-layer"]&&(Ce.sourceLayer=Ce.layer["source-layer"]),Ce.state=_e});return X}(this._layers,this._serializedLayers,this.sourceCaches,c,_,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(c,_){_&&_.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",_.filter,null,_);const l=this.sourceCaches[c];return l?function(h,d){const x=h.getRenderableIds().map(M=>h.getTileByID(M)),b=[],S={};for(let M=0;M<x.length;M++){const B=x[M],V=B.tileID.canonical.key;S[V]||(S[V]=!0,B.querySourceFeatures(b,d))}return b}(l,_):[]}addSourceType(c,_,l){return Se.getSourceType(c)?l(new Error(`A source type called "${c}" already exists.`)):(Se.setSourceType(c,_),_.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:_.workerSourceURL},l):l(null,null))}getLight(){return this.light.getLight()}setLight(c,_={}){this._checkLoaded();const l=this.light.getLight();let h=!1;for(const x in c)if(!P(c[x],l[x])){h=!0;break}if(!h)return;const d={now:a.exported.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,_),this.light.updateTransitions(d)}_validate(c,_,l,h,d={}){return(!d||d.validate!==!1)&&vn(this,c.call(a.validateStyle,a.extend({key:_,style:this.serialize(),value:l,styleSpec:a.spec},h)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this.sourceCaches){const _=this.sourceCaches[c];_.setEventedParent(null),_.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){this.sourceCaches[c].clearTiles()}_reloadSource(c){this.sourceCaches[c].resume(),this.sourceCaches[c].reload()}_updateSources(c){for(const _ in this.sourceCaches)this.sourceCaches[_].update(c,this.terrain)}_generateCollisionBoxes(){for(const c in this.sourceCaches)this._reloadSource(c)}_updatePlacement(c,_,l,h,d=!1){let x=!1,b=!1;const S={};for(const M of this._order){const B=this._layers[M];if(B.type!=="symbol")continue;if(!S[B.source]){const $=this.sourceCaches[B.source];S[B.source]=$.getRenderableIds(!0).map(X=>$.getTileByID(X)).sort((X,se)=>se.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(se.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(B,S[B.source],c.center.lng);x=x||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((d=d||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),c.zoom))&&(this.pauseablePlacement=new $e(c,this.terrain,this._order,d,_,l,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),b=!0),x&&this.pauseablePlacement.placement.setStale()),b||x)for(const M of this._order){const B=this._layers[M];B.type==="symbol"&&this.placement.updateLayerOpacities(B,S[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const c in this.sourceCaches)this.sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,_,l){this.imageManager.getImages(_.icons,l),this._updateTilesForChangedImages();const h=this.sourceCaches[_.source];h&&h.setDependencies(_.tileID.key,_.type,_.icons)}getGlyphs(c,_,l){this.glyphManager.getGlyphs(_.stacks,l)}getResource(c,_,l){return a.makeRequest(_,l)}}Se.getSourceType=function(k){return En[k]},Se.setSourceType=function(k,c){En[k]=c},Se.registerForPluginStateChange=a.registerForPluginStateChange;var An="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const ar={prelude:ni(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:ni(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:ni(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ni(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ni("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ni(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:ni(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ni("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ni("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ni("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:ni(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:ni(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:ni(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:ni(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ni(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ni(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ni(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ni(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:ni(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ni(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ni(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ni(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ni(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:ni(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ni(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ni(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ni("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",An),terrainDepth:ni("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",An),terrainCoords:ni("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",An)};function ni(k,c){const _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=c.match(/attribute ([\w]+) ([\w]+)/g),h=k.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=d?d.concat(h):h,b={};return{fragmentSource:k=k.replace(_,(S,M,B,V,$)=>(b[$]=!0,M==="define"?`
#ifndef HAS_UNIFORM_u_${$}
varying ${B} ${V} ${$};
#else
uniform ${B} ${V} u_${$};
#endif
`:`
#ifdef HAS_UNIFORM_u_${$}
    ${B} ${V} ${$} = u_${$};
#endif
`)),vertexSource:c=c.replace(_,(S,M,B,V,$)=>{const X=V==="float"?"vec2":"vec4",se=$.match(/color/)?"color":X;return b[$]?M==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${B} ${X} a_${$};
varying ${B} ${V} ${$};
#else
uniform ${B} ${V} u_${$};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = a_${$};
#else
    ${B} ${V} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = unpack_mix_${se}(a_${$}, u_${$}_t);
#else
    ${B} ${V} ${$} = u_${$};
#endif
`:M==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${B} ${X} a_${$};
#else
uniform ${B} ${V} u_${$};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${B} ${V} ${$} = a_${$};
#else
    ${B} ${V} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${B} ${V} ${$} = unpack_mix_${se}(a_${$}, u_${$}_t);
#else
    ${B} ${V} ${$} = u_${$};
#endif
`}),staticAttributes:l,staticUniforms:x}}class la{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(c,_,l,h,d,x,b,S,M){this.context=c;let B=this.boundPaintVertexBuffers.length!==h.length;for(let V=0;!B&&V<h.length;V++)this.boundPaintVertexBuffers[V]!==h[V]&&(B=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===_&&this.boundLayoutVertexBuffer===l&&!B&&this.boundIndexBuffer===d&&this.boundVertexOffset===x&&this.boundDynamicVertexBuffer===b&&this.boundDynamicVertexBuffer2===S&&this.boundDynamicVertexBuffer3===M?(c.bindVertexArrayOES.set(this.vao),b&&b.bind(),d&&d.dynamicDraw&&d.bind(),S&&S.bind(),M&&M.bind()):this.freshBind(_,l,h,d,x,b,S,M)}freshBind(c,_,l,h,d,x,b,S){let M;const B=c.numAttributes,V=this.context,$=V.gl;if(V.extVertexArrayObject)this.vao&&this.destroy(),this.vao=V.extVertexArrayObject.createVertexArrayOES(),V.bindVertexArrayOES.set(this.vao),M=0,this.boundProgram=c,this.boundLayoutVertexBuffer=_,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=h,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=S;else{M=V.currentNumAttributes||0;for(let X=B;X<M;X++)$.disableVertexAttribArray(X)}_.enableAttributes($,c);for(const X of l)X.enableAttributes($,c);x&&x.enableAttributes($,c),b&&b.enableAttributes($,c),S&&S.enableAttributes($,c),_.bind(),_.setVertexAttribPointers($,c,d);for(const X of l)X.bind(),X.setVertexAttribPointers($,c,d);x&&(x.bind(),x.setVertexAttribPointers($,c,d)),h&&h.bind(),b&&(b.bind(),b.setVertexAttribPointers($,c,d)),S&&(S.bind(),S.setVertexAttribPointers($,c,d)),V.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function De(k){const c=[];for(let _=0;_<k.length;_++){if(k[_]===null)continue;const l=k[_].split(" ");c.push(l.pop())}return c}class Na{constructor(c,_,l,h,d,x,b){const S=c.gl;this.program=S.createProgram();const M=De(l.staticAttributes),B=h?h.getBinderAttributes():[],V=M.concat(B),$=ar.prelude.staticUniforms?De(ar.prelude.staticUniforms):[],X=l.staticUniforms?De(l.staticUniforms):[],se=h?h.getBinderUniforms():[],ne=$.concat(X).concat(se),ue=[];for(const xe of ne)ue.indexOf(xe)<0&&ue.push(xe);const be=h?h.defines():[];x&&be.push("#define OVERDRAW_INSPECTOR;"),b&&be.push("#define TERRAIN3D;");const Ce=be.concat(ar.prelude.fragmentSource,l.fragmentSource).join(`
`),_e=be.concat(ar.prelude.vertexSource,l.vertexSource).join(`
`),Ge=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(Ge,Ce),S.compileShader(Ge),S.attachShader(this.program,Ge);const Te=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(Te,_e),S.compileShader(Te),S.attachShader(this.program,Te),this.attributes={};const Ue={};this.numAttributes=V.length;for(let xe=0;xe<this.numAttributes;xe++)V[xe]&&(S.bindAttribLocation(this.program,xe,V[xe]),this.attributes[V[xe]]=xe);S.linkProgram(this.program),S.deleteShader(Te),S.deleteShader(Ge);for(let xe=0;xe<ue.length;xe++){const m=ue[xe];if(m&&!Ue[m]){const g=S.getUniformLocation(this.program,m);g&&(Ue[m]=g)}}this.fixedUniforms=d(c,Ue),this.terrainUniforms=((xe,m)=>({u_depth:new a.Uniform1i(xe,m.u_depth),u_terrain:new a.Uniform1i(xe,m.u_terrain),u_terrain_dim:new a.Uniform1f(xe,m.u_terrain_dim),u_terrain_matrix:new a.UniformMatrix4f(xe,m.u_terrain_matrix),u_terrain_unpack:new a.Uniform4f(xe,m.u_terrain_unpack),u_terrain_offset:new a.Uniform1f(xe,m.u_terrain_offset),u_terrain_exaggeration:new a.Uniform1f(xe,m.u_terrain_exaggeration)}))(c,Ue),this.binderUniforms=h?h.getUniforms(c,Ue):[]}draw(c,_,l,h,d,x,b,S,M,B,V,$,X,se,ne,ue,be,Ce){const _e=c.gl;if(this.failedToCreate)return;if(c.program.set(this.program),c.setDepthMode(l),c.setStencilMode(h),c.setColorMode(d),c.setCullFace(x),S){c.activeTexture.set(_e.TEXTURE2),_e.bindTexture(_e.TEXTURE_2D,S.depthTexture),c.activeTexture.set(_e.TEXTURE3),_e.bindTexture(_e.TEXTURE_2D,S.texture);for(const Te in this.terrainUniforms)this.terrainUniforms[Te].set(S[Te])}for(const Te in this.fixedUniforms)this.fixedUniforms[Te].set(b[Te]);ne&&ne.setUniforms(c,this.binderUniforms,X,{zoom:se});let Ge=0;switch(_){case _e.LINES:Ge=2;break;case _e.TRIANGLES:Ge=3;break;case _e.LINE_STRIP:Ge=1}for(const Te of $.get()){const Ue=Te.vaos||(Te.vaos={});(Ue[M]||(Ue[M]=new la)).bind(c,this,B,ne?ne.getPaintVertexBuffers():[],V,Te.vertexOffset,ue,be,Ce),_e.drawElements(_,Te.primitiveLength*Ge,_e.UNSIGNED_SHORT,Te.primitiveOffset*Ge*2)}}}function we(k,c,_){const l=1/Ri(_,1,c.transform.tileZoom),h=Math.pow(2,_.tileID.overscaledZ),d=_.tileSize*Math.pow(2,c.transform.tileZoom)/h,x=d*(_.tileID.canonical.x+_.tileID.wrap*h),b=d*_.tileID.canonical.y;return{u_image:0,u_texsize:_.imageAtlasTexture.size,u_scale:[l,k.fromScale,k.toScale],u_fade:k.t,u_pixel_coord_upper:[x>>16,b>>16],u_pixel_coord_lower:[65535&x,65535&b]}}const No=(k,c,_,l)=>{const h=c.style.light,d=h.properties.get("position"),x=[d.x,d.y,d.z],b=a.create$1();h.properties.get("anchor")==="viewport"&&a.fromRotation(b,-c.transform.angle),a.transformMat3(x,x,b);const S=h.properties.get("color");return{u_matrix:k,u_lightpos:x,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[S.r,S.g,S.b],u_vertical_gradient:+_,u_opacity:l}},xs=(k,c,_,l,h,d,x)=>a.extend(No(k,c,_,l),we(d,c,x),{u_height_factor:-Math.pow(2,h.overscaledZ)/x.tileSize/8}),Ua=k=>({u_matrix:k}),Va=(k,c,_,l)=>a.extend(Ua(k),we(_,c,l)),Aa=(k,c)=>({u_matrix:k,u_world:c}),ml=(k,c,_,l,h)=>a.extend(Va(k,c,_,l),{u_world:h}),ua=(k,c,_,l)=>{const h=k.transform;let d,x;if(l.paint.get("circle-pitch-alignment")==="map"){const b=Ri(_,1,h.zoom);d=!0,x=[b,b]}else d=!1,x=h.pixelsToGLUnits;return{u_camera_to_center_distance:h.cameraToCenterDistance,u_scale_with_map:+(l.paint.get("circle-pitch-scale")==="map"),u_matrix:k.translatePosMatrix(c.posMatrix,_,l.paint.get("circle-translate"),l.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:k.pixelRatio,u_extrude_scale:x}},Ji=(k,c,_)=>{const l=Ri(_,1,c.zoom),h=Math.pow(2,c.zoom-_.tileID.overscaledZ),d=_.tileID.overscaleFactor();return{u_matrix:k,u_camera_to_center_distance:c.cameraToCenterDistance,u_pixels_to_tile_units:l,u_extrude_scale:[c.pixelsToGLUnits[0]/(l*h),c.pixelsToGLUnits[1]/(l*h)],u_overscale_factor:d}},ge=(k,c,_=1)=>({u_matrix:k,u_color:c,u_overlay:0,u_overlay_scale:_}),Ee=k=>({u_matrix:k}),Fe=(k,c,_,l)=>({u_matrix:k,u_extrude_scale:Ri(c,1,_),u_intensity:l});function ot(k,c){const _=Math.pow(2,c.canonical.z),l=c.canonical.y;return[new a.MercatorCoordinate(0,l/_).toLngLat().lat,new a.MercatorCoordinate(0,(l+1)/_).toLngLat().lat]}const wt=(k,c,_,l)=>{const h=k.transform;return{u_matrix:ki(k,c,_,l),u_ratio:1/Ri(c,1,h.zoom),u_device_pixel_ratio:k.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Wt=(k,c,_,l,h)=>a.extend(wt(k,c,_,h),{u_image:0,u_image_height:l}),kn=(k,c,_,l,h)=>{const d=k.transform,x=Jt(c,d);return{u_matrix:ki(k,c,_,h),u_texsize:c.imageAtlasTexture.size,u_ratio:1/Ri(c,1,d.zoom),u_device_pixel_ratio:k.pixelRatio,u_image:0,u_scale:[x,l.fromScale,l.toScale],u_fade:l.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Pi=(k,c,_,l,h,d)=>{const x=k.lineAtlas,b=Jt(c,k.transform),S=_.layout.get("line-cap")==="round",M=x.getDash(l.from,S),B=x.getDash(l.to,S),V=M.width*h.fromScale,$=B.width*h.toScale;return a.extend(wt(k,c,_,d),{u_patternscale_a:[b/V,-M.height/2],u_patternscale_b:[b/$,-B.height/2],u_sdfgamma:x.width/(256*Math.min(V,$)*k.pixelRatio)/2,u_image:0,u_tex_y_a:M.y,u_tex_y_b:B.y,u_mix:h.t})};function Jt(k,c){return 1/Ri(k,1,c.tileZoom)}function ki(k,c,_,l){return k.translatePosMatrix(l?l.posMatrix:c.tileID.posMatrix,c,_.paint.get("line-translate"),_.paint.get("line-translate-anchor"))}const Vn=(k,c,_,l,h)=>{return{u_matrix:k,u_tl_parent:c,u_scale_parent:_,u_buffer_scale:1,u_fade_t:l.mix,u_opacity:l.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(x=h.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(d=h.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:aA(h.paint.get("raster-hue-rotate"))};var d,x};function aA(k){k*=Math.PI/180;const c=Math.sin(k),_=Math.cos(k);return[(2*_+1)/3,(-Math.sqrt(3)*c-_+1)/3,(Math.sqrt(3)*c-_+1)/3]}const lA=(k,c,_,l,h,d,x,b,S,M)=>{const B=h.transform;return{u_is_size_zoom_constant:+(k==="constant"||k==="source"),u_is_size_feature_constant:+(k==="constant"||k==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:B.cameraToCenterDistance,u_pitch:B.pitch/360*2*Math.PI,u_rotate_symbol:+_,u_aspect_ratio:B.width/B.height,u_fade_change:h.options.fadeDuration?h.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:x,u_coord_matrix:b,u_is_text:+S,u_pitch_with_map:+l,u_texsize:M,u_texture:0}},AA=(k,c,_,l,h,d,x,b,S,M,B)=>{const V=h.transform;return a.extend(lA(k,c,_,l,h,d,x,b,S,M),{u_gamma_scale:l?Math.cos(V._pitch)*V.cameraToCenterDistance:1,u_device_pixel_ratio:h.pixelRatio,u_is_halo:+B})},$A=(k,c,_,l,h,d,x,b,S,M)=>a.extend(AA(k,c,_,l,h,d,x,b,!0,S,!0),{u_texsize_icon:M,u_texture_icon:1}),HA=(k,c,_)=>({u_matrix:k,u_opacity:c,u_color:_}),uA=(k,c,_,l,h,d)=>a.extend(function(x,b,S,M){const B=S.imageManager.getPattern(x.from.toString()),V=S.imageManager.getPattern(x.to.toString()),{width:$,height:X}=S.imageManager.getPixelSize(),se=Math.pow(2,M.tileID.overscaledZ),ne=M.tileSize*Math.pow(2,S.transform.tileZoom)/se,ue=ne*(M.tileID.canonical.x+M.tileID.wrap*se),be=ne*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[$,X],u_mix:b.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/Ri(M,1,S.transform.tileZoom),u_pixel_coord_upper:[ue>>16,be>>16],u_pixel_coord_lower:[65535&ue,65535&be]}}(l,d,_,h),{u_matrix:k,u_opacity:c}),yl={fillExtrusion:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_lightpos:new a.Uniform3f(k,c.u_lightpos),u_lightintensity:new a.Uniform1f(k,c.u_lightintensity),u_lightcolor:new a.Uniform3f(k,c.u_lightcolor),u_vertical_gradient:new a.Uniform1f(k,c.u_vertical_gradient),u_opacity:new a.Uniform1f(k,c.u_opacity)}),fillExtrusionPattern:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_lightpos:new a.Uniform3f(k,c.u_lightpos),u_lightintensity:new a.Uniform1f(k,c.u_lightintensity),u_lightcolor:new a.Uniform3f(k,c.u_lightcolor),u_vertical_gradient:new a.Uniform1f(k,c.u_vertical_gradient),u_height_factor:new a.Uniform1f(k,c.u_height_factor),u_image:new a.Uniform1i(k,c.u_image),u_texsize:new a.Uniform2f(k,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(k,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(k,c.u_pixel_coord_lower),u_scale:new a.Uniform3f(k,c.u_scale),u_fade:new a.Uniform1f(k,c.u_fade),u_opacity:new a.Uniform1f(k,c.u_opacity)}),fill:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix)}),fillPattern:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_image:new a.Uniform1i(k,c.u_image),u_texsize:new a.Uniform2f(k,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(k,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(k,c.u_pixel_coord_lower),u_scale:new a.Uniform3f(k,c.u_scale),u_fade:new a.Uniform1f(k,c.u_fade)}),fillOutline:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_world:new a.Uniform2f(k,c.u_world)}),fillOutlinePattern:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_world:new a.Uniform2f(k,c.u_world),u_image:new a.Uniform1i(k,c.u_image),u_texsize:new a.Uniform2f(k,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(k,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(k,c.u_pixel_coord_lower),u_scale:new a.Uniform3f(k,c.u_scale),u_fade:new a.Uniform1f(k,c.u_fade)}),circle:(k,c)=>({u_camera_to_center_distance:new a.Uniform1f(k,c.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(k,c.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(k,c.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(k,c.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(k,c.u_matrix)}),collisionBox:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_camera_to_center_distance:new a.Uniform1f(k,c.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(k,c.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(k,c.u_extrude_scale),u_overscale_factor:new a.Uniform1f(k,c.u_overscale_factor)}),collisionCircle:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_inv_matrix:new a.UniformMatrix4f(k,c.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(k,c.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(k,c.u_viewport_size)}),debug:(k,c)=>({u_color:new a.UniformColor(k,c.u_color),u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_overlay:new a.Uniform1i(k,c.u_overlay),u_overlay_scale:new a.Uniform1f(k,c.u_overlay_scale)}),clippingMask:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix)}),heatmap:(k,c)=>({u_extrude_scale:new a.Uniform1f(k,c.u_extrude_scale),u_intensity:new a.Uniform1f(k,c.u_intensity),u_matrix:new a.UniformMatrix4f(k,c.u_matrix)}),heatmapTexture:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_world:new a.Uniform2f(k,c.u_world),u_image:new a.Uniform1i(k,c.u_image),u_color_ramp:new a.Uniform1i(k,c.u_color_ramp),u_opacity:new a.Uniform1f(k,c.u_opacity)}),hillshade:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_image:new a.Uniform1i(k,c.u_image),u_latrange:new a.Uniform2f(k,c.u_latrange),u_light:new a.Uniform2f(k,c.u_light),u_shadow:new a.UniformColor(k,c.u_shadow),u_highlight:new a.UniformColor(k,c.u_highlight),u_accent:new a.UniformColor(k,c.u_accent)}),hillshadePrepare:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_image:new a.Uniform1i(k,c.u_image),u_dimension:new a.Uniform2f(k,c.u_dimension),u_zoom:new a.Uniform1f(k,c.u_zoom),u_unpack:new a.Uniform4f(k,c.u_unpack)}),line:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_ratio:new a.Uniform1f(k,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(k,c.u_units_to_pixels)}),lineGradient:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_ratio:new a.Uniform1f(k,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(k,c.u_units_to_pixels),u_image:new a.Uniform1i(k,c.u_image),u_image_height:new a.Uniform1f(k,c.u_image_height)}),linePattern:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_texsize:new a.Uniform2f(k,c.u_texsize),u_ratio:new a.Uniform1f(k,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_image:new a.Uniform1i(k,c.u_image),u_units_to_pixels:new a.Uniform2f(k,c.u_units_to_pixels),u_scale:new a.Uniform3f(k,c.u_scale),u_fade:new a.Uniform1f(k,c.u_fade)}),lineSDF:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_ratio:new a.Uniform1f(k,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(k,c.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(k,c.u_patternscale_a),u_patternscale_b:new a.Uniform2f(k,c.u_patternscale_b),u_sdfgamma:new a.Uniform1f(k,c.u_sdfgamma),u_image:new a.Uniform1i(k,c.u_image),u_tex_y_a:new a.Uniform1f(k,c.u_tex_y_a),u_tex_y_b:new a.Uniform1f(k,c.u_tex_y_b),u_mix:new a.Uniform1f(k,c.u_mix)}),raster:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_tl_parent:new a.Uniform2f(k,c.u_tl_parent),u_scale_parent:new a.Uniform1f(k,c.u_scale_parent),u_buffer_scale:new a.Uniform1f(k,c.u_buffer_scale),u_fade_t:new a.Uniform1f(k,c.u_fade_t),u_opacity:new a.Uniform1f(k,c.u_opacity),u_image0:new a.Uniform1i(k,c.u_image0),u_image1:new a.Uniform1i(k,c.u_image1),u_brightness_low:new a.Uniform1f(k,c.u_brightness_low),u_brightness_high:new a.Uniform1f(k,c.u_brightness_high),u_saturation_factor:new a.Uniform1f(k,c.u_saturation_factor),u_contrast_factor:new a.Uniform1f(k,c.u_contrast_factor),u_spin_weights:new a.Uniform3f(k,c.u_spin_weights)}),symbolIcon:(k,c)=>({u_is_size_zoom_constant:new a.Uniform1i(k,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(k,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(k,c.u_size_t),u_size:new a.Uniform1f(k,c.u_size),u_camera_to_center_distance:new a.Uniform1f(k,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(k,c.u_pitch),u_rotate_symbol:new a.Uniform1i(k,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(k,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(k,c.u_fade_change),u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(k,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(k,c.u_coord_matrix),u_is_text:new a.Uniform1i(k,c.u_is_text),u_pitch_with_map:new a.Uniform1i(k,c.u_pitch_with_map),u_texsize:new a.Uniform2f(k,c.u_texsize),u_texture:new a.Uniform1i(k,c.u_texture)}),symbolSDF:(k,c)=>({u_is_size_zoom_constant:new a.Uniform1i(k,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(k,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(k,c.u_size_t),u_size:new a.Uniform1f(k,c.u_size),u_camera_to_center_distance:new a.Uniform1f(k,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(k,c.u_pitch),u_rotate_symbol:new a.Uniform1i(k,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(k,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(k,c.u_fade_change),u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(k,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(k,c.u_coord_matrix),u_is_text:new a.Uniform1i(k,c.u_is_text),u_pitch_with_map:new a.Uniform1i(k,c.u_pitch_with_map),u_texsize:new a.Uniform2f(k,c.u_texsize),u_texture:new a.Uniform1i(k,c.u_texture),u_gamma_scale:new a.Uniform1f(k,c.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(k,c.u_is_halo)}),symbolTextAndIcon:(k,c)=>({u_is_size_zoom_constant:new a.Uniform1i(k,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(k,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(k,c.u_size_t),u_size:new a.Uniform1f(k,c.u_size),u_camera_to_center_distance:new a.Uniform1f(k,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(k,c.u_pitch),u_rotate_symbol:new a.Uniform1i(k,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(k,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(k,c.u_fade_change),u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(k,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(k,c.u_coord_matrix),u_is_text:new a.Uniform1i(k,c.u_is_text),u_pitch_with_map:new a.Uniform1i(k,c.u_pitch_with_map),u_texsize:new a.Uniform2f(k,c.u_texsize),u_texsize_icon:new a.Uniform2f(k,c.u_texsize_icon),u_texture:new a.Uniform1i(k,c.u_texture),u_texture_icon:new a.Uniform1i(k,c.u_texture_icon),u_gamma_scale:new a.Uniform1f(k,c.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(k,c.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(k,c.u_is_halo)}),background:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_opacity:new a.Uniform1f(k,c.u_opacity),u_color:new a.UniformColor(k,c.u_color)}),backgroundPattern:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_opacity:new a.Uniform1f(k,c.u_opacity),u_image:new a.Uniform1i(k,c.u_image),u_pattern_tl_a:new a.Uniform2f(k,c.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(k,c.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(k,c.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(k,c.u_pattern_br_b),u_texsize:new a.Uniform2f(k,c.u_texsize),u_mix:new a.Uniform1f(k,c.u_mix),u_pattern_size_a:new a.Uniform2f(k,c.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(k,c.u_pattern_size_b),u_scale_a:new a.Uniform1f(k,c.u_scale_a),u_scale_b:new a.Uniform1f(k,c.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(k,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(k,c.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(k,c.u_tile_units_to_pixels)}),terrain:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_texture:new a.Uniform1i(k,c.u_texture)}),terrainDepth:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix)}),terrainCoords:(k,c)=>({u_matrix:new a.UniformMatrix4f(k,c.u_matrix),u_texture:new a.Uniform1i(k,c.u_texture),u_terrain_coords_id:new a.Uniform1f(k,c.u_terrain_coords_id)})};class _l{constructor(c,_,l){this.context=c;const h=c.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete _.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const _=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),_.bufferSubData(_.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const cA={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class hA{constructor(c,_,l,h){this.length=_.length,this.attributes=l,this.itemSize=_.bytesPerElement,this.dynamicDraw=h,this.context=c;const d=c.gl;this.buffer=d.createBuffer(),c.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete _.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){if(c.length!==this.length)throw new Error(`Length of new data is ${c.length}, which doesn't match current length of ${this.length}`);const _=this.context.gl;this.bind(),_.bufferSubData(_.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,_){for(let l=0;l<this.attributes.length;l++){const h=_.attributes[this.attributes[l].name];h!==void 0&&c.enableVertexAttribArray(h)}}setVertexAttribPointers(c,_,l){for(let h=0;h<this.attributes.length;h++){const d=this.attributes[h],x=_.attributes[d.name];x!==void 0&&c.vertexAttribPointer(x,d.components,c[cA[d.type]],!1,this.itemSize,d.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Zn{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class WA extends Zn{getDefault(){return a.Color.transparent}set(c){const _=this.current;(c.r!==_.r||c.g!==_.g||c.b!==_.b||c.a!==_.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Ku extends Zn{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class vl extends Zn{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class Hi extends Zn{getDefault(){return[!0,!0,!0,!0]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||c[3]!==_[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Uo extends Zn{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class Bn extends Zn{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class ws extends Zn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const _=this.current;(c.func!==_.func||c.ref!==_.ref||c.mask!==_.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class er extends Zn{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class po extends Zn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.STENCIL_TEST):_.disable(_.STENCIL_TEST),this.current=c,this.dirty=!1}}class xl extends Zn{getDefault(){return[0,1]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class Vo extends Zn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.DEPTH_TEST):_.disable(_.DEPTH_TEST),this.current=c,this.dirty=!1}}class ca extends Zn{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class go extends Zn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.BLEND):_.disable(_.BLEND),this.current=c,this.dirty=!1}}class fA extends Zn{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class Ga extends Zn{getDefault(){return a.Color.transparent}set(c){const _=this.current;(c.r!==_.r||c.g!==_.g||c.b!==_.b||c.a!==_.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Go extends Zn{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class Gr extends Zn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.CULL_FACE):_.disable(_.CULL_FACE),this.current=c,this.dirty=!1}}class jr extends Zn{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class QA extends Zn{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class wl extends Zn{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class mo extends Zn{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class jo extends Zn{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||c[3]!==_[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Ju extends Zn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindFramebuffer(_.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class qA extends Zn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindRenderbuffer(_.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class bl extends Zn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindTexture(_.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class dA extends Zn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindBuffer(_.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class ZA extends Zn{getDefault(){return null}set(c){const _=this.gl;_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class $o extends Zn{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class ja extends Zn{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class YA extends Zn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class XA extends Zn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class yo extends Zn{constructor(c,_){super(c),this.context=c,this.parent=_}getDefault(){return null}}class ha extends yo{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class KA extends yo{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class fa{constructor(c,_,l,h){this.context=c,this.width=_,this.height=l;const d=c.gl,x=this.framebuffer=d.createFramebuffer();if(this.colorAttachment=new ha(c,x),h&&(this.depthAttachment=new KA(c,x)),d.checkFramebufferStatus(d.FRAMEBUFFER)!==d.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const c=this.context.gl,_=this.colorAttachment.get();if(_&&c.deleteTexture(_),this.depthAttachment){const l=this.depthAttachment.get();l&&c.deleteRenderbuffer(l)}c.deleteFramebuffer(this.framebuffer)}}class hi{constructor(c,_,l){this.blendFunction=c,this.blendColor=_,this.mask=l}}hi.Replace=[1,0],hi.disabled=new hi(hi.Replace,a.Color.transparent,[!1,!1,!1,!1]),hi.unblended=new hi(hi.Replace,a.Color.transparent,[!0,!0,!0,!0]),hi.alphaBlended=new hi([1,771],a.Color.transparent,[!0,!0,!0,!0]);class Fs{constructor(c){this.gl=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new WA(this),this.clearDepth=new Ku(this),this.clearStencil=new vl(this),this.colorMask=new Hi(this),this.depthMask=new Uo(this),this.stencilMask=new Bn(this),this.stencilFunc=new ws(this),this.stencilOp=new er(this),this.stencilTest=new po(this),this.depthRange=new xl(this),this.depthTest=new Vo(this),this.depthFunc=new ca(this),this.blend=new go(this),this.blendFunc=new fA(this),this.blendColor=new Ga(this),this.blendEquation=new Go(this),this.cullFace=new Gr(this),this.cullFaceSide=new jr(this),this.frontFace=new QA(this),this.program=new wl(this),this.activeTexture=new mo(this),this.viewport=new jo(this),this.bindFramebuffer=new Ju(this),this.bindRenderbuffer=new qA(this),this.bindTexture=new bl(this),this.bindVertexBuffer=new dA(this),this.bindElementBuffer=new ZA(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new $o(this),this.pixelStoreUnpack=new ja(this),this.pixelStoreUnpackPremultiplyAlpha=new YA(this),this.pixelStoreUnpackFlipY=new XA(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=c.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(c.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,_){return new _l(this,c,_)}createVertexBuffer(c,_,l){return new hA(this,c,_,l)}createRenderbuffer(c,_,l){const h=this.gl,d=h.createRenderbuffer();return this.bindRenderbuffer.set(d),h.renderbufferStorage(h.RENDERBUFFER,c,_,l),this.bindRenderbuffer.set(null),d}createFramebuffer(c,_,l){return new fa(this,c,_,l)}clear({color:c,depth:_}){const l=this.gl;let h=0;c&&(h|=l.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),_!==void 0&&(h|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(_),this.depthMask.set(!0)),l.clear(h)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){P(c.blendFunction,hi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Gn{constructor(c,_,l){this.func=c,this.mask=_,this.range=l}}Gn.ReadOnly=!1,Gn.ReadWrite=!0,Gn.disabled=new Gn(519,Gn.ReadOnly,[0,1]);const Wn=7680;class vi{constructor(c,_,l,h,d,x){this.test=c,this.ref=_,this.mask=l,this.fail=h,this.depthFail=d,this.pass=x}}vi.disabled=new vi({func:519,mask:0},0,0,Wn,Wn,Wn);class di{constructor(c,_,l){this.enable=c,this.mode=_,this.frontFace=l}}let El;function Ho(k,c,_,l,h,d,x){const b=k.context,S=b.gl,M=k.useProgram("collisionBox"),B=[];let V=0,$=0;for(let _e=0;_e<l.length;_e++){const Ge=l[_e],Te=c.getTile(Ge),Ue=Te.getBucket(_);if(!Ue)continue;let xe=Ge.posMatrix;h[0]===0&&h[1]===0||(xe=k.translatePosMatrix(Ge.posMatrix,Te,h,d));const m=x?Ue.textCollisionBox:Ue.iconCollisionBox,g=Ue.collisionCircleArray;if(g.length>0){const v=a.create(),E=xe;a.mul(v,Ue.placementInvProjMatrix,k.transform.glCoordMatrix),a.mul(v,v,Ue.placementViewportMatrix),B.push({circleArray:g,circleOffset:$,transform:E,invTransform:v,coord:Ge}),V+=g.length/4,$=V}m&&M.draw(b,S.LINES,Gn.disabled,vi.disabled,k.colorModeForRenderPass(),di.disabled,Ji(xe,k.transform,Te),k.style.terrain&&k.style.terrain.getTerrainData(Ge),_.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,k.transform.zoom,null,null,m.collisionVertexBuffer)}if(!x||!B.length)return;const X=k.useProgram("collisionCircle"),se=new a.CollisionCircleLayoutArray;se.resize(4*V),se._trim();let ne=0;for(const _e of B)for(let Ge=0;Ge<_e.circleArray.length/4;Ge++){const Te=4*Ge,Ue=_e.circleArray[Te+0],xe=_e.circleArray[Te+1],m=_e.circleArray[Te+2],g=_e.circleArray[Te+3];se.emplace(ne++,Ue,xe,m,g,0),se.emplace(ne++,Ue,xe,m,g,1),se.emplace(ne++,Ue,xe,m,g,2),se.emplace(ne++,Ue,xe,m,g,3)}(!El||El.length<2*V)&&(El=function(_e){const Ge=2*_e,Te=new a.QuadTriangleArray;Te.resize(Ge),Te._trim();for(let Ue=0;Ue<Ge;Ue++){const xe=6*Ue;Te.uint16[xe+0]=4*Ue+0,Te.uint16[xe+1]=4*Ue+1,Te.uint16[xe+2]=4*Ue+2,Te.uint16[xe+3]=4*Ue+2,Te.uint16[xe+4]=4*Ue+3,Te.uint16[xe+5]=4*Ue+0}return Te}(V));const ue=b.createIndexBuffer(El,!0),be=b.createVertexBuffer(se,a.collisionCircleLayout.members,!0);for(const _e of B){const Ge={u_matrix:_e.transform,u_inv_matrix:_e.invTransform,u_camera_to_center_distance:(Ce=k.transform).cameraToCenterDistance,u_viewport_size:[Ce.width,Ce.height]};X.draw(b,S.TRIANGLES,Gn.disabled,vi.disabled,k.colorModeForRenderPass(),di.disabled,Ge,k.style.terrain&&k.style.terrain.getTerrainData(_e.coord),_.id,be,ue,a.SegmentVector.simpleSegment(0,2*_e.circleOffset,_e.circleArray.length,_e.circleArray.length/2),null,k.transform.zoom,null,null,null)}var Ce;be.destroy(),ue.destroy()}di.disabled=new di(!1,1029,2305),di.backCCW=new di(!0,1029,2305);const ec=a.identity(new Float32Array(16));function $a(k,c,_,l,h,d){const{horizontalAlign:x,verticalAlign:b}=a.getAnchorAlignment(k),S=-(x-.5)*c,M=-(b-.5)*_,B=a.evaluateVariableOffset(k,l);return new a.pointGeometry((S/h+B[0])*d,(M/h+B[1])*d)}function tc(k,c,_,l,h,d,x,b,S,M,B){const V=k.text.placedSymbolArray,$=k.text.dynamicLayoutVertexArray,X=k.icon.dynamicLayoutVertexArray,se={};$.clear();for(let ne=0;ne<V.length;ne++){const ue=V.get(ne),be=k.allowVerticalPlacement&&!ue.placedOrientation,Ce=ue.hidden||!ue.crossTileID||be?null:l[ue.crossTileID];if(Ce){const _e=new a.pointGeometry(ue.anchorX,ue.anchorY),Ge=Rn(_e,_?x:d,B),Te=Nr(h.cameraToCenterDistance,Ge.signedDistanceFromCamera);let Ue=a.evaluateSizeForFeature(k.textSizeData,S,ue)*Te/a.ONE_EM;_&&(Ue*=k.tilePixelRatio/b);const{width:xe,height:m,anchor:g,textOffset:v,textBoxScale:E}=Ce,C=$a(g,xe,m,v,E,Ue),R=_?Rn(_e.add(C),d,B).point:Ge.point.add(c?C.rotate(-h.angle):C),O=k.allowVerticalPlacement&&ue.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let N=0;N<ue.numGlyphs;N++)a.addDynamicAttributes($,R,O);M&&ue.associatedIconIndex>=0&&(se[ue.associatedIconIndex]={shiftedAnchor:R,angle:O})}else mn(ue.numGlyphs,$)}if(M){X.clear();const ne=k.icon.placedSymbolArray;for(let ue=0;ue<ne.length;ue++){const be=ne.get(ue);if(be.hidden)mn(be.numGlyphs,X);else{const Ce=se[ue];if(Ce)for(let _e=0;_e<be.numGlyphs;_e++)a.addDynamicAttributes(X,Ce.shiftedAnchor,Ce.angle);else mn(be.numGlyphs,X)}}k.icon.dynamicLayoutVertexBuffer.updateData(X)}k.text.dynamicLayoutVertexBuffer.updateData($)}function JA(k,c,_){return _.iconsInText&&c?"symbolTextAndIcon":k?"symbolSDF":"symbolIcon"}function Ns(k,c,_,l,h,d,x,b,S,M,B,V){const $=k.context,X=$.gl,se=k.transform,ne=b==="map",ue=S==="map",be=b!=="viewport"&&_.layout.get("symbol-placement")!=="point",Ce=ne&&!ue&&!be,_e=!_.layout.get("symbol-sort-key").isConstant();let Ge=!1;const Te=k.depthModeForSublayer(0,Gn.ReadOnly),Ue=_.layout.get("text-variable-anchor"),xe=[];for(const m of l){const g=c.getTile(m),v=g.getBucket(_);if(!v)continue;const E=h?v.text:v.icon;if(!E||!E.segments.get().length)continue;const C=E.programConfigurations.get(_.id),R=h||v.sdfIcons,O=h?v.textSizeData:v.iconSizeData,N=ue||se.pitch!==0,W=k.useProgram(JA(R,h,v),C),J=a.evaluateSizeForZoom(O,se.zoom),le=k.style.terrain&&k.style.terrain.getTerrainData(m);let fe,Re,je,Be,Ze=[0,0],ct=null;if(h){if(Re=g.glyphAtlasTexture,je=X.LINEAR,fe=g.glyphAtlasTexture.size,v.iconsInText){Ze=g.imageAtlasTexture.size,ct=g.imageAtlasTexture;const yn=O.kind==="composite"||O.kind==="camera";Be=N||k.options.rotating||k.options.zooming||yn?X.LINEAR:X.NEAREST}}else{const yn=_.layout.get("icon-size").constantOr(0)!==1||v.iconsNeedLinear;Re=g.imageAtlasTexture,je=R||k.options.rotating||k.options.zooming||yn||N?X.LINEAR:X.NEAREST,fe=g.imageAtlasTexture.size}const At=Ri(g,1,k.transform.zoom),it=Bs(m.posMatrix,ue,ne,k.transform,At),rt=xr(m.posMatrix,ue,ne,k.transform,At),Xe=Ue&&v.hasTextData(),Vt=_.layout.get("icon-text-fit")!=="none"&&Xe&&v.hasIconData();if(be){const yn=k.style.terrain?(Ln,ai)=>k.style.terrain.getElevation(m,Ln,ai):null,bn=_.layout.get("text-rotation-alignment")==="map";kr(v,m.posMatrix,k,h,it,rt,ue,M,bn,yn)}const Bt=k.translatePosMatrix(m.posMatrix,g,d,x),ft=be||h&&Ue||Vt?ec:it,yt=k.translatePosMatrix(rt,g,d,x,!0),Cn=R&&_.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let xn;xn=R?v.iconsInText?$A(O.kind,J,Ce,ue,k,Bt,ft,yt,fe,Ze):AA(O.kind,J,Ce,ue,k,Bt,ft,yt,h,fe,!0):lA(O.kind,J,Ce,ue,k,Bt,ft,yt,h,fe);const gn={program:W,buffers:E,uniformValues:xn,atlasTexture:Re,atlasTextureIcon:ct,atlasInterpolation:je,atlasInterpolationIcon:Be,isSDF:R,hasHalo:Cn};if(_e&&v.canOverlap){Ge=!0;const yn=E.segments.get();for(const bn of yn)xe.push({segments:new a.SegmentVector([bn]),sortKey:bn.sortKey,state:gn,terrainData:le})}else xe.push({segments:E.segments,sortKey:0,state:gn,terrainData:le})}Ge&&xe.sort((m,g)=>m.sortKey-g.sortKey);for(const m of xe){const g=m.state;if($.activeTexture.set(X.TEXTURE0),g.atlasTexture.bind(g.atlasInterpolation,X.CLAMP_TO_EDGE),g.atlasTextureIcon&&($.activeTexture.set(X.TEXTURE1),g.atlasTextureIcon&&g.atlasTextureIcon.bind(g.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),g.isSDF){const v=g.uniformValues;g.hasHalo&&(v.u_is_halo=1,Tl(g.buffers,m.segments,_,k,g.program,Te,B,V,v,m.terrainData)),v.u_is_halo=0}Tl(g.buffers,m.segments,_,k,g.program,Te,B,V,g.uniformValues,m.terrainData)}}function Tl(k,c,_,l,h,d,x,b,S,M){const B=l.context;h.draw(B,B.gl.TRIANGLES,d,x,b,di.disabled,S,M,_.id,k.layoutVertexBuffer,k.indexBuffer,c,_.paint,l.transform.zoom,k.programConfigurations.get(_.id),k.dynamicLayoutVertexBuffer,k.opacityVertexBuffer)}function Ha(k,c,_,l,h,d,x){const b=k.context.gl,S=_.paint.get("fill-pattern"),M=S&&S.constantOr(1),B=_.getCrossfadeParameters();let V,$,X,se,ne;x?($=M&&!_.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=b.LINES):($=M?"fillPattern":"fill",V=b.TRIANGLES);for(const ue of l){const be=c.getTile(ue);if(M&&!be.patternsLoaded())continue;const Ce=be.getBucket(_);if(!Ce)continue;const _e=Ce.programConfigurations.get(_.id),Ge=k.useProgram($,_e),Te=k.style.terrain&&k.style.terrain.getTerrainData(ue);M&&(k.context.activeTexture.set(b.TEXTURE0),be.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),_e.updatePaintBuffers(B));const Ue=S.constantOr(null);if(Ue&&be.imageAtlas){const g=be.imageAtlas,v=g.patternPositions[Ue.to.toString()],E=g.patternPositions[Ue.from.toString()];v&&E&&_e.setConstantPatternPositions(v,E)}const xe=Te?ue:null,m=k.translatePosMatrix(xe?xe.posMatrix:ue.posMatrix,be,_.paint.get("fill-translate"),_.paint.get("fill-translate-anchor"));if(x){se=Ce.indexBuffer2,ne=Ce.segments2;const g=[b.drawingBufferWidth,b.drawingBufferHeight];X=$==="fillOutlinePattern"&&M?ml(m,k,B,be,g):Aa(m,g)}else se=Ce.indexBuffer,ne=Ce.segments,X=M?Va(m,k,B,be):Ua(m);Ge.draw(k.context,V,h,k.stencilModeForClipping(ue),d,di.disabled,X,Te,_.id,Ce.layoutVertexBuffer,se,ne,_.paint,k.transform.zoom,_e)}}function da(k,c,_,l,h,d,x){const b=k.context,S=b.gl,M=_.paint.get("fill-extrusion-pattern"),B=M.constantOr(1),V=_.getCrossfadeParameters(),$=_.paint.get("fill-extrusion-opacity");for(const X of l){const se=c.getTile(X),ne=se.getBucket(_);if(!ne)continue;const ue=k.style.terrain&&k.style.terrain.getTerrainData(X),be=ne.programConfigurations.get(_.id),Ce=k.useProgram(B?"fillExtrusionPattern":"fillExtrusion",be);B&&(k.context.activeTexture.set(S.TEXTURE0),se.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),be.updatePaintBuffers(V));const _e=M.constantOr(null);if(_e&&se.imageAtlas){const xe=se.imageAtlas,m=xe.patternPositions[_e.to.toString()],g=xe.patternPositions[_e.from.toString()];m&&g&&be.setConstantPatternPositions(m,g)}const Ge=k.translatePosMatrix(X.posMatrix,se,_.paint.get("fill-extrusion-translate"),_.paint.get("fill-extrusion-translate-anchor")),Te=_.paint.get("fill-extrusion-vertical-gradient"),Ue=B?xs(Ge,k,Te,$,X,V,se):No(Ge,k,Te,$);Ce.draw(b,b.gl.TRIANGLES,h,d,x,di.backCCW,Ue,ue,_.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,_.paint,k.transform.zoom,be,k.style.terrain&&ne.centroidVertexBuffer)}}function Sl(k,c,_,l,h,d,x){const b=k.context,S=b.gl,M=_.fbo;if(!M)return;const B=k.useProgram("hillshade"),V=k.style.terrain&&k.style.terrain.getTerrainData(c);b.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,M.colorAttachment.get()),B.draw(b,S.TRIANGLES,h,d,x,di.disabled,(($,X,se,ne)=>{const ue=se.paint.get("hillshade-shadow-color"),be=se.paint.get("hillshade-highlight-color"),Ce=se.paint.get("hillshade-accent-color");let _e=se.paint.get("hillshade-illumination-direction")*(Math.PI/180);se.paint.get("hillshade-illumination-anchor")==="viewport"&&(_e-=$.transform.angle);const Ge=!$.options.moving;return{u_matrix:ne?ne.posMatrix:$.transform.calculatePosMatrix(X.tileID.toUnwrapped(),Ge),u_image:0,u_latrange:ot(0,X.tileID),u_light:[se.paint.get("hillshade-exaggeration"),_e],u_shadow:ue,u_highlight:be,u_accent:Ce}})(k,_,l,V?c:null),V,l.id,k.rasterBoundsBuffer,k.quadTriangleIndexBuffer,k.rasterBoundsSegments)}function Ml(k,c,_,l,h,d){const x=k.context,b=x.gl,S=c.dem;if(S&&S.data){const M=S.dim,B=S.stride,V=S.getPixels();if(x.activeTexture.set(b.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||k.getTileTexture(B),c.demTexture){const X=c.demTexture;X.update(V,{premultiply:!1}),X.bind(b.NEAREST,b.CLAMP_TO_EDGE)}else c.demTexture=new Z(x,V,b.RGBA,{premultiply:!1}),c.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);x.activeTexture.set(b.TEXTURE0);let $=c.fbo;if(!$){const X=new Z(x,{width:M,height:M,data:null},b.RGBA);X.bind(b.LINEAR,b.CLAMP_TO_EDGE),$=c.fbo=x.createFramebuffer(M,M,!0),$.colorAttachment.set(X.texture)}x.bindFramebuffer.set($.framebuffer),x.viewport.set([0,0,M,M]),k.useProgram("hillshadePrepare").draw(x,b.TRIANGLES,l,h,d,di.disabled,((X,se)=>{const ne=se.stride,ue=a.create();return a.ortho(ue,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(ue,ue,[0,-a.EXTENT,0]),{u_matrix:ue,u_image:1,u_dimension:[ne,ne],u_zoom:X.overscaledZ,u_unpack:se.getUnpackVector()}})(c.tileID,S),null,_.id,k.rasterBoundsBuffer,k.quadTriangleIndexBuffer,k.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function pi(k,c,_,l,h,d){const x=l.paint.get("raster-fade-duration");if(!d&&x>0){const b=a.exported.now(),S=(b-k.timeAdded)/x,M=c?(b-c.timeAdded)/x:-1,B=_.getSource(),V=h.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),$=!c||Math.abs(c.tileID.overscaledZ-V)>Math.abs(k.tileID.overscaledZ-V),X=$&&k.refreshedUponExpiration?1:a.clamp($?S:1-M,0,1);return k.refreshedUponExpiration&&S>=1&&(k.refreshedUponExpiration=!1),c?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const pA=new a.Color(1,0,0,1),os=new a.Color(0,1,0,1),eu=new a.Color(0,0,1,1),Cl=new a.Color(1,0,1,1),nc=new a.Color(0,1,1,1);function Wi(k,c,_,l){tr(k,0,c+_/2,k.transform.width,_,l)}function Li(k,c,_,l){tr(k,c-_/2,0,_,k.transform.height,l)}function tr(k,c,_,l,h,d){const x=k.context,b=x.gl;b.enable(b.SCISSOR_TEST),b.scissor(c*k.pixelRatio,_*k.pixelRatio,l*k.pixelRatio,h*k.pixelRatio),x.clear({color:d}),b.disable(b.SCISSOR_TEST)}function tu(k,c,_){const l=k.context,h=l.gl,d=_.posMatrix,x=k.useProgram("debug"),b=Gn.disabled,S=vi.disabled,M=k.colorModeForRenderPass(),B="$debug",V=k.style.terrain&&k.style.terrain.getTerrainData(_);l.activeTexture.set(h.TEXTURE0),k.emptyTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE);const $=c.getTileByID(_.key).latestRawTileData,X=Math.floor(($&&$.byteLength||0)/1024),se=c.getTile(_).tileSize,ne=512/Math.min(se,512)*(_.overscaledZ/k.transform.zoom)*.5;let ue=_.canonical.toString();_.overscaledZ!==_.canonical.z&&(ue+=` => ${_.overscaledZ}`),function(be,Ce){be.initDebugOverlayCanvas();const _e=be.debugOverlayCanvas,Ge=be.context.gl,Te=be.debugOverlayCanvas.getContext("2d");Te.clearRect(0,0,_e.width,_e.height),Te.shadowColor="white",Te.shadowBlur=2,Te.lineWidth=1.5,Te.strokeStyle="white",Te.textBaseline="top",Te.font="bold 36px Open Sans, sans-serif",Te.fillText(Ce,5,5),Te.strokeText(Ce,5,5),be.debugOverlayTexture.update(_e),be.debugOverlayTexture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE)}(k,`${ue} ${X}kB`),x.draw(l,h.TRIANGLES,b,S,hi.alphaBlended,di.disabled,ge(d,a.Color.transparent,ne),null,B,k.debugBuffer,k.quadTriangleIndexBuffer,k.debugSegments),x.draw(l,h.LINE_STRIP,b,S,M,di.disabled,ge(d,a.Color.red),V,B,k.debugBuffer,k.tileBorderIndexBuffer,k.debugSegments)}function Us(k,c,_){const l=k.context,h=l.gl,d=k.colorModeForRenderPass(),x=new Gn(h.LEQUAL,Gn.ReadWrite,k.depthRangeFor3D),b=k.useProgram("terrain"),S=c.getTerrainMesh(),M=c.getTerrainData(_.tileID);l.bindFramebuffer.set(null),l.viewport.set([0,0,k.width,k.height]),l.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,c.getRTTFramebuffer().colorAttachment.get());const B=k.transform.calculatePosMatrix(_.tileID.toUnwrapped());b.draw(l,h.TRIANGLES,x,vi.disabled,d,di.backCCW,{u_matrix:B,u_texture:0},M,"terrain",S.vertexBuffer,S.indexBuffer,S.segments)}function ic(k,c,_,l){const h=k.context,d=_.tileSize*c.qualityFactor;_.textures[l]||(_.textures[l]=k.getTileTexture(d)||new Z(h,{width:d,height:d,data:null},h.gl.RGBA),_.textures[l].bind(h.gl.LINEAR,h.gl.CLAMP_TO_EDGE),l===0&&c.sourceCache.renderHistory.unshift(_.tileID.key));const x=c.getRTTFramebuffer();x.colorAttachment.set(_.textures[l].texture),h.bindFramebuffer.set(x.framebuffer),h.viewport.set([0,0,d,d])}class gA{constructor(c){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=c,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=c.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const c=this.painter.style,_=c.terrain;for(const l in c.sourceCaches){this._coordsDescendingInv[l]={};const h=c.sourceCaches[l].getVisibleCoordinates();for(const d of h){const x=_.sourceCache.getTerrainCoords(d);for(const b in x)this._coordsDescendingInv[l][b]||(this._coordsDescendingInv[l][b]=[]),this._coordsDescendingInv[l][b].push(x[b])}}for(const l of c._order){const h=c._layers[l],d=h.source;if(this._renderToTexture[h.type]&&!this._coordsDescendingInvStr[d]){this._coordsDescendingInvStr[d]={};for(const x in this._coordsDescendingInv[d])this._coordsDescendingInvStr[d][x]=this._coordsDescendingInv[d][x].map(b=>b.key).sort().join()}}return this._renderableTiles.forEach(l=>{for(const h in this._coordsDescendingInvStr){const d=this._coordsDescendingInvStr[h][l.tileID.key];d&&d!==l.textureCoords[h]&&l.clearTextures(this.painter),_.needsRerender(h,l.tileID)&&l.clearTextures(this.painter)}this._rerender[l.tileID.key]=!l.textures.length}),_.clearRerenderCache(),_.sourceCache.removeOutdated(this.painter),this}renderLayer(c){const _=c.type,l=this.painter,h=l.style._order,d=l.currentLayer,x=d+1===h.length;if(this._renderToTexture[_]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=_,this._stacks[this._stacks.length-1].push(h[d]),!x))return!0;if(this._renderToTexture[this._prevType]||_==="hillshade"||this._renderToTexture[_]&&x){this._prevType=_;const b=this._stacks.length-1,S=this._stacks[b]||[];for(const M of this._renderableTiles){if(ic(l,l.style.terrain,M,b),this._rerender[M.tileID.key]){l.context.clear({color:a.Color.transparent});for(let B=0;B<S.length;B++){const V=l.style._layers[S[B]],$=V.source?this._coordsDescendingInv[V.source][M.tileID.key]:[M.tileID];l._renderTileClippingMasks(V,$),l.renderLayer(l,l.style.sourceCaches[V.source],V,$),V.source&&(M.textureCoords[V.source]=this._coordsDescendingInvStr[V.source][M.tileID.key])}}Us(l,l.style.terrain,M)}if(_==="hillshade"){this._stacks.push([h[d]]);for(const M of this._renderableTiles){const B=this._coordsDescendingInv[c.source][M.tileID.key];ic(l,l.style.terrain,M,this._stacks.length-1),l.context.clear({color:a.Color.transparent}),l._renderTileClippingMasks(c,B),l.renderLayer(l,l.style.sourceCaches[c.source],c,B),Us(l,l.style.terrain,M)}return!0}return this._renderToTexture[_]}return!1}}const lr={symbol:function(k,c,_,l,h){if(k.renderPass!=="translucent")return;const d=vi.disabled,x=k.colorModeForRenderPass();_.layout.get("text-variable-anchor")&&function(b,S,M,B,V,$,X){const se=S.transform,ne=V==="map",ue=$==="map";for(const be of b){const Ce=B.getTile(be),_e=Ce.getBucket(M);if(!_e||!_e.text||!_e.text.segments.get().length)continue;const Ge=a.evaluateSizeForZoom(_e.textSizeData,se.zoom),Te=Ri(Ce,1,S.transform.zoom),Ue=Bs(be.posMatrix,ue,ne,S.transform,Te),xe=M.layout.get("icon-text-fit")!=="none"&&_e.hasIconData();if(Ge){const m=Math.pow(2,se.zoom-Ce.tileID.overscaledZ);tc(_e,ne,ue,X,se,Ue,be.posMatrix,m,Ge,xe,S.style.terrain?(g,v)=>S.style.terrain.getElevation(be,g,v):null)}}}(l,k,_,c,_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),h),_.paint.get("icon-opacity").constantOr(1)!==0&&Ns(k,c,_,l,!1,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),_.layout.get("icon-rotation-alignment"),_.layout.get("icon-pitch-alignment"),_.layout.get("icon-keep-upright"),d,x),_.paint.get("text-opacity").constantOr(1)!==0&&Ns(k,c,_,l,!0,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),_.layout.get("text-keep-upright"),d,x),c.map.showCollisionBoxes&&(Ho(k,c,_,l,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),!0),Ho(k,c,_,l,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),!1))},circle:function(k,c,_,l){if(k.renderPass!=="translucent")return;const h=_.paint.get("circle-opacity"),d=_.paint.get("circle-stroke-width"),x=_.paint.get("circle-stroke-opacity"),b=!_.layout.get("circle-sort-key").isConstant();if(h.constantOr(1)===0&&(d.constantOr(1)===0||x.constantOr(1)===0))return;const S=k.context,M=S.gl,B=k.depthModeForSublayer(0,Gn.ReadOnly),V=vi.disabled,$=k.colorModeForRenderPass(),X=[];for(let se=0;se<l.length;se++){const ne=l[se],ue=c.getTile(ne),be=ue.getBucket(_);if(!be)continue;const Ce=be.programConfigurations.get(_.id),_e=k.useProgram("circle",Ce),Ge=be.layoutVertexBuffer,Te=be.indexBuffer,Ue=k.style.terrain&&k.style.terrain.getTerrainData(ne),xe={programConfiguration:Ce,program:_e,layoutVertexBuffer:Ge,indexBuffer:Te,uniformValues:ua(k,ne,ue,_),terrainData:Ue};if(b){const m=be.segments.get();for(const g of m)X.push({segments:new a.SegmentVector([g]),sortKey:g.sortKey,state:xe})}else X.push({segments:be.segments,sortKey:0,state:xe})}b&&X.sort((se,ne)=>se.sortKey-ne.sortKey);for(const se of X){const{programConfiguration:ne,program:ue,layoutVertexBuffer:be,indexBuffer:Ce,uniformValues:_e,terrainData:Ge}=se.state;ue.draw(S,M.TRIANGLES,B,V,$,di.disabled,_e,Ge,_.id,be,Ce,se.segments,_.paint,k.transform.zoom,ne)}},heatmap:function(k,c,_,l){if(_.paint.get("heatmap-opacity")!==0)if(k.renderPass==="offscreen"){const h=k.context,d=h.gl,x=vi.disabled,b=new hi([d.ONE,d.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(S,M,B){const V=S.gl;S.activeTexture.set(V.TEXTURE1),S.viewport.set([0,0,M.width/4,M.height/4]);let $=B.heatmapFbo;if($)V.bindTexture(V.TEXTURE_2D,$.colorAttachment.get()),S.bindFramebuffer.set($.framebuffer);else{const X=V.createTexture();V.bindTexture(V.TEXTURE_2D,X),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.LINEAR),$=B.heatmapFbo=S.createFramebuffer(M.width/4,M.height/4,!1),function(se,ne,ue,be){const Ce=se.gl;Ce.texImage2D(Ce.TEXTURE_2D,0,Ce.RGBA,ne.width/4,ne.height/4,0,Ce.RGBA,se.extRenderToTextureHalfFloat?se.extTextureHalfFloat.HALF_FLOAT_OES:Ce.UNSIGNED_BYTE,null),be.colorAttachment.set(ue)}(S,M,X,$)}})(h,k,_),h.clear({color:a.Color.transparent});for(let S=0;S<l.length;S++){const M=l[S];if(c.hasRenderableParent(M))continue;const B=c.getTile(M),V=B.getBucket(_);if(!V)continue;const $=V.programConfigurations.get(_.id),X=k.useProgram("heatmap",$),{zoom:se}=k.transform;X.draw(h,d.TRIANGLES,Gn.disabled,x,b,di.disabled,Fe(M.posMatrix,B,se,_.paint.get("heatmap-intensity")),null,_.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,_.paint,k.transform.zoom,$)}h.viewport.set([0,0,k.width,k.height])}else k.renderPass==="translucent"&&(k.context.setColorMode(k.colorModeForRenderPass()),function(h,d){const x=h.context,b=x.gl,S=d.heatmapFbo;if(!S)return;x.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,S.colorAttachment.get()),x.activeTexture.set(b.TEXTURE1);let M=d.colorRampTexture;M||(M=d.colorRampTexture=new Z(x,d.colorRamp,b.RGBA)),M.bind(b.LINEAR,b.CLAMP_TO_EDGE),h.useProgram("heatmapTexture").draw(x,b.TRIANGLES,Gn.disabled,vi.disabled,h.colorModeForRenderPass(),di.disabled,((B,V,$,X)=>{const se=a.create();a.ortho(se,0,B.width,B.height,0,0,1);const ne=B.context.gl;return{u_matrix:se,u_world:[ne.drawingBufferWidth,ne.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:V.paint.get("heatmap-opacity")}})(h,d),null,d.id,h.viewportBuffer,h.quadTriangleIndexBuffer,h.viewportSegments,d.paint,h.transform.zoom)}(k,_))},line:function(k,c,_,l){if(k.renderPass!=="translucent")return;const h=_.paint.get("line-opacity"),d=_.paint.get("line-width");if(h.constantOr(1)===0||d.constantOr(1)===0)return;const x=k.depthModeForSublayer(0,Gn.ReadOnly),b=k.colorModeForRenderPass(),S=_.paint.get("line-dasharray"),M=_.paint.get("line-pattern"),B=M.constantOr(1),V=_.paint.get("line-gradient"),$=_.getCrossfadeParameters(),X=B?"linePattern":S?"lineSDF":V?"lineGradient":"line",se=k.context,ne=se.gl;let ue=!0;for(const be of l){const Ce=c.getTile(be);if(B&&!Ce.patternsLoaded())continue;const _e=Ce.getBucket(_);if(!_e)continue;const Ge=_e.programConfigurations.get(_.id),Te=k.context.program.get(),Ue=k.useProgram(X,Ge),xe=ue||Ue.program!==Te,m=k.style.terrain&&k.style.terrain.getTerrainData(be),g=M.constantOr(null);if(g&&Ce.imageAtlas){const C=Ce.imageAtlas,R=C.patternPositions[g.to.toString()],O=C.patternPositions[g.from.toString()];R&&O&&Ge.setConstantPatternPositions(R,O)}const v=m?be:null,E=B?kn(k,Ce,_,$,v):S?Pi(k,Ce,_,S,$,v):V?Wt(k,Ce,_,_e.lineClipsArray.length,v):wt(k,Ce,_,v);if(B)se.activeTexture.set(ne.TEXTURE0),Ce.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),Ge.updatePaintBuffers($);else if(S&&(xe||k.lineAtlas.dirty))se.activeTexture.set(ne.TEXTURE0),k.lineAtlas.bind(se);else if(V){const C=_e.gradients[_.id];let R=C.texture;if(_.gradientVersion!==C.version){let O=256;if(_.stepInterpolant){const N=c.getSource().maxzoom,W=be.canonical.z===N?Math.ceil(1<<k.transform.maxZoom-be.canonical.z):1;O=a.clamp(a.nextPowerOfTwo(_e.maxLineLength/a.EXTENT*1024*W),256,se.maxTextureSize)}C.gradient=a.renderColorRamp({expression:_.gradientExpression(),evaluationKey:"lineProgress",resolution:O,image:C.gradient||void 0,clips:_e.lineClipsArray}),C.texture?C.texture.update(C.gradient):C.texture=new Z(se,C.gradient,ne.RGBA),C.version=_.gradientVersion,R=C.texture}se.activeTexture.set(ne.TEXTURE0),R.bind(_.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}Ue.draw(se,ne.TRIANGLES,x,k.stencilModeForClipping(be),b,di.disabled,E,m,_.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,_.paint,k.transform.zoom,Ge,_e.layoutVertexBuffer2),ue=!1}},fill:function(k,c,_,l){const h=_.paint.get("fill-color"),d=_.paint.get("fill-opacity");if(d.constantOr(1)===0)return;const x=k.colorModeForRenderPass(),b=_.paint.get("fill-pattern"),S=k.opaquePassEnabledForLayer()&&!b.constantOr(1)&&h.constantOr(a.Color.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(k.renderPass===S){const M=k.depthModeForSublayer(1,k.renderPass==="opaque"?Gn.ReadWrite:Gn.ReadOnly);Ha(k,c,_,l,M,x,!1)}if(k.renderPass==="translucent"&&_.paint.get("fill-antialias")){const M=k.depthModeForSublayer(_.getPaintProperty("fill-outline-color")?2:0,Gn.ReadOnly);Ha(k,c,_,l,M,x,!0)}},"fill-extrusion":function(k,c,_,l){const h=_.paint.get("fill-extrusion-opacity");if(h!==0&&k.renderPass==="translucent"){const d=new Gn(k.context.gl.LEQUAL,Gn.ReadWrite,k.depthRangeFor3D);if(h!==1||_.paint.get("fill-extrusion-pattern").constantOr(1))da(k,c,_,l,d,vi.disabled,hi.disabled),da(k,c,_,l,d,k.stencilModeFor3D(),k.colorModeForRenderPass());else{const x=k.colorModeForRenderPass();da(k,c,_,l,d,vi.disabled,x)}}},hillshade:function(k,c,_,l){if(k.renderPass!=="offscreen"&&k.renderPass!=="translucent")return;const h=k.context,d=k.depthModeForSublayer(0,Gn.ReadOnly),x=k.colorModeForRenderPass(),[b,S]=k.renderPass==="translucent"?k.stencilConfigForOverlap(l):[{},l];for(const M of S){const B=c.getTile(M);B.needsHillshadePrepare!==void 0&&B.needsHillshadePrepare&&k.renderPass==="offscreen"?Ml(k,B,_,d,vi.disabled,x):k.renderPass==="translucent"&&Sl(k,M,B,_,d,b[M.overscaledZ],x)}h.viewport.set([0,0,k.width,k.height])},raster:function(k,c,_,l){if(k.renderPass!=="translucent"||_.paint.get("raster-opacity")===0||!l.length)return;const h=k.context,d=h.gl,x=c.getSource(),b=k.useProgram("raster"),S=k.colorModeForRenderPass(),[M,B]=x instanceof bt?[{},l]:k.stencilConfigForOverlap(l),V=B[B.length-1].overscaledZ,$=!k.options.moving;for(const X of B){const se=k.depthModeForSublayer(X.overscaledZ-V,_.paint.get("raster-opacity")===1?Gn.ReadWrite:Gn.ReadOnly,d.LESS),ne=c.getTile(X);ne.registerFadeDuration(_.paint.get("raster-fade-duration"));const ue=c.findLoadedParent(X,0),be=pi(ne,ue,c,_,k.transform,k.style.terrain);let Ce,_e;const Ge=_.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;h.activeTexture.set(d.TEXTURE0),ne.texture.bind(Ge,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(d.TEXTURE1),ue?(ue.texture.bind(Ge,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),Ce=Math.pow(2,ue.tileID.overscaledZ-ne.tileID.overscaledZ),_e=[ne.tileID.canonical.x*Ce%1,ne.tileID.canonical.y*Ce%1]):ne.texture.bind(Ge,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);const Te=k.style.terrain&&k.style.terrain.getTerrainData(X),Ue=Te?X:null,xe=Ue?Ue.posMatrix:k.transform.calculatePosMatrix(X.toUnwrapped(),$),m=Vn(xe,_e||[0,0],Ce||1,be,_);x instanceof bt?b.draw(h,d.TRIANGLES,se,vi.disabled,S,di.disabled,m,Te,_.id,x.boundsBuffer,k.quadTriangleIndexBuffer,x.boundsSegments):b.draw(h,d.TRIANGLES,se,M[X.overscaledZ],S,di.disabled,m,Te,_.id,k.rasterBoundsBuffer,k.quadTriangleIndexBuffer,k.rasterBoundsSegments)}},background:function(k,c,_,l){const h=_.paint.get("background-color"),d=_.paint.get("background-opacity");if(d===0)return;const x=k.context,b=x.gl,S=k.transform,M=S.tileSize,B=_.paint.get("background-pattern");if(k.isPatternMissing(B))return;const V=!B&&h.a===1&&d===1&&k.opaquePassEnabledForLayer()?"opaque":"translucent";if(k.renderPass!==V)return;const $=vi.disabled,X=k.depthModeForSublayer(0,V==="opaque"?Gn.ReadWrite:Gn.ReadOnly),se=k.colorModeForRenderPass(),ne=k.useProgram(B?"backgroundPattern":"background"),ue=l||S.coveringTiles({tileSize:M,terrain:k.style.terrain});B&&(x.activeTexture.set(b.TEXTURE0),k.imageManager.bind(k.context));const be=_.getCrossfadeParameters();for(const Ce of ue){const _e=l?Ce.posMatrix:k.transform.calculatePosMatrix(Ce.toUnwrapped()),Ge=B?uA(_e,d,k,B,{tileID:Ce,tileSize:M},be):HA(_e,d,h),Te=k.style.terrain&&k.style.terrain.getTerrainData(Ce);ne.draw(x,b.TRIANGLES,X,$,se,di.disabled,Ge,Te,_.id,k.tileExtentBuffer,k.quadTriangleIndexBuffer,k.tileExtentSegments)}},debug:function(k,c,_){for(let l=0;l<_.length;l++)tu(k,c,_[l])},custom:function(k,c,_){const l=k.context,h=_.implementation;if(k.renderPass==="offscreen"){const d=h.prerender;d&&(k.setCustomLayerDefaults(),l.setColorMode(k.colorModeForRenderPass()),d.call(h,l.gl,k.transform.customLayerMatrix()),l.setDirty(),k.setBaseState())}else if(k.renderPass==="translucent"){k.setCustomLayerDefaults(),l.setColorMode(k.colorModeForRenderPass()),l.setStencilMode(vi.disabled);const d=h.renderingMode==="3d"?new Gn(k.context.gl.LEQUAL,Gn.ReadWrite,k.depthRangeFor3D):k.depthModeForSublayer(0,Gn.ReadOnly);l.setDepthMode(d),h.render(l.gl,k.transform.customLayerMatrix()),l.setDirty(),k.setBaseState(),l.bindFramebuffer.set(null)}}};class wr{constructor(c,_){this.context=new Fs(c),this.transform=_,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.create(),renderTime:0},this.setup(),this.numSublayers=xt.maxUnderzooming+xt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new jt,this.gpuTimers={}}resize(c,_,l){if(this.width=c*l,this.height=_*l,this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const c=this.context,_=new a.PosArray;_.emplaceBack(0,0),_.emplaceBack(a.EXTENT,0),_.emplaceBack(0,a.EXTENT),_.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(_,dn.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const l=new a.PosArray;l.emplaceBack(0,0),l.emplaceBack(a.EXTENT,0),l.emplaceBack(0,a.EXTENT),l.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=c.createVertexBuffer(l,dn.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const h=new a.RasterBoundsArray;h.emplaceBack(0,0,0,0),h.emplaceBack(a.EXTENT,0,a.EXTENT,0),h.emplaceBack(0,a.EXTENT,0,a.EXTENT),h.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(h,mt.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const d=new a.PosArray;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(d,dn.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const x=new a.LineStripIndexArray;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(x);const b=new a.TriangleIndexArray;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(b),this.emptyTexture=new Z(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA);const S=this.context.gl;this.stencilClearMode=new vi({func:S.ALWAYS,mask:0},0,255,S.ZERO,S.ZERO,S.ZERO)}clearStencil(){const c=this.context,_=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=a.create();a.ortho(l,0,this.width,this.height,0,0,1),a.scale(l,l,[_.drawingBufferWidth,_.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,_.TRIANGLES,Gn.disabled,this.stencilClearMode,hi.disabled,di.disabled,Ee(l),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(c,_){if(this.currentStencilSource===c.source||!c.isTileClipped()||!_||!_.length)return;this.currentStencilSource=c.source;const l=this.context,h=l.gl;this.nextStencilID+_.length>256&&this.clearStencil(),l.setColorMode(hi.disabled),l.setDepthMode(Gn.disabled);const d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of _){const b=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,S=this.style.terrain&&this.style.terrain.getTerrainData(x);d.draw(l,h.TRIANGLES,Gn.disabled,new vi({func:h.ALWAYS,mask:0},b,255,h.KEEP,h.KEEP,h.REPLACE),hi.disabled,di.disabled,Ee(x.posMatrix),S,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,_=this.context.gl;return new vi({func:_.NOTEQUAL,mask:255},c,255,_.KEEP,_.KEEP,_.REPLACE)}stencilModeForClipping(c){const _=this.context.gl;return new vi({func:_.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,_.KEEP,_.KEEP,_.REPLACE)}stencilConfigForOverlap(c){const _=this.context.gl,l=c.sort((x,b)=>b.overscaledZ-x.overscaledZ),h=l[l.length-1].overscaledZ,d=l[0].overscaledZ-h+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const x={};for(let b=0;b<d;b++)x[b+h]=new vi({func:_.GEQUAL,mask:255},b+this.nextStencilID,255,_.KEEP,_.KEEP,_.REPLACE);return this.nextStencilID+=d,[x,l]}return[{[h]:vi.disabled},l]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new hi([c.CONSTANT_COLOR,c.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?hi.unblended:hi.alphaBlended}depthModeForSublayer(c,_,l){if(!this.opaquePassEnabledForLayer())return Gn.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new Gn(l||this.context.gl.LEQUAL,_,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,_){this.style=c,this.options=_,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const l=this.style._order,h=this.style.sourceCaches,d=this.style.terrain&&new gA(this);for(const M in h){const B=h[M];B.used&&B.prepare(this.context)}const x={},b={},S={};for(const M in h){const B=h[M];x[M]=B.getVisibleCoordinates(),b[M]=x[M].slice().reverse(),S[M]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<l.length;M++)if(this.style._layers[l[M]].is3D()){this.opaquePassCutoff=M;break}if(d){this.opaquePassCutoff=0;const M=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||M.length)&&(a.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,V){const $=B.context,X=$.gl,se=hi.unblended,ne=new Gn(X.LEQUAL,Gn.ReadWrite,[0,1]),ue=V.getTerrainMesh(),be=V.sourceCache.getRenderableTiles(),Ce=B.useProgram("terrainDepth");$.bindFramebuffer.set(V.getFramebuffer("depth").framebuffer),$.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),$.clear({color:a.Color.transparent,depth:1});for(const _e of be){const Ge=V.getTerrainData(_e.tileID),Te=B.transform.calculatePosMatrix(_e.tileID.toUnwrapped());Ce.draw($,X.TRIANGLES,ne,vi.disabled,se,di.backCCW,{u_matrix:Te},Ge,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments)}$.bindFramebuffer.set(null),$.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain),function(B,V){const $=B.context,X=$.gl,se=hi.unblended,ne=new Gn(X.LEQUAL,Gn.ReadWrite,[0,1]),ue=V.getTerrainMesh(),be=V.getCoordsTexture(),Ce=V.sourceCache.getRenderableTiles(),_e=B.useProgram("terrainCoords");$.bindFramebuffer.set(V.getFramebuffer("coords").framebuffer),$.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),$.clear({color:a.Color.transparent,depth:1}),V.coordsIndex=[];for(const Ge of Ce){const Te=V.getTerrainData(Ge.tileID);$.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,be.texture);const Ue=B.transform.calculatePosMatrix(Ge.tileID.toUnwrapped());_e.draw($,X.TRIANGLES,ne,vi.disabled,se,di.backCCW,{u_matrix:Ue,u_terrain_coords_id:(255-V.coordsIndex.length)/255,u_texture:0},Te,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments),V.coordsIndex.push(Ge.tileID.key)}$.bindFramebuffer.set(null),$.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const M of l){const B=this.style._layers[M];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const V=b[B.source];(B.type==="custom"||V.length)&&this.renderLayer(this,h[B.source],B,V)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:_.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=_.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],!d)for(this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[l[this.currentLayer]],B=h[M.source],V=x[M.source];this._renderTileClippingMasks(M,V),this.renderLayer(this,B,M,V)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){const M=this.style._layers[l[this.currentLayer]],B=h[M.source];if(d&&d.renderLayer(M))continue;const V=(M.type==="symbol"?S:b)[M.source];this._renderTileClippingMasks(M,x[M.source]),this.renderLayer(this,B,M,V)}if(this.options.showTileBoundaries){let M,B;Object.values(this.style._layers).forEach(V=>{V.source&&!V.isHidden(this.transform.zoom)&&(V.source!==(B&&B.id)&&(B=this.style.sourceCaches[V.source]),(!M||M.getSource().maxzoom<B.getSource().maxzoom)&&(M=B))}),M&&lr.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const B=M.transform.padding;Wi(M,M.transform.height-(B.top||0),3,pA),Wi(M,B.bottom||0,3,os),Li(M,B.left||0,3,eu),Li(M,M.transform.width-(B.right||0),3,Cl);const V=M.transform.centerPoint;(function($,X,se,ne){tr($,X-1,se-10,2,20,ne),tr($,X-10,se-1,20,2,ne)})(M,V.x,M.transform.height-V.y,nc)}(this),this.context.setDefault()}renderLayer(c,_,l,h){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(h||[]).length)&&(this.id=l.id,this.gpuTimingStart(l),lr[l.type](c,_,l,h,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const _=this.context.extTimerQuery;let l=this.gpuTimers[c.id];l||(l=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:_.createQueryEXT()}),l.calls++,_.beginQueryEXT(_.TIME_ELAPSED_EXT,l.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}queryGpuTimers(c){const _={};for(const l in c){const h=c[l],d=this.context.extTimerQuery,x=d.getQueryObjectEXT(h.query,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(h.query),_[l]=x}return _}translatePosMatrix(c,_,l,h,d){if(!l[0]&&!l[1])return c;const x=d?h==="map"?this.transform.angle:0:h==="viewport"?-this.transform.angle:0;if(x){const M=Math.sin(x),B=Math.cos(x);l=[l[0]*B-l[1]*M,l[0]*M+l[1]*B]}const b=[d?l[0]:Ri(_,l[0],this.transform.zoom),d?l[1]:Ri(_,l[1],this.transform.zoom),0],S=new Float32Array(16);return a.translate(S,c,b),S}saveTileTexture(c){const _=this._tileTextures[c.size[0]];_?_.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const _=this._tileTextures[c];return _&&_.length>0?_.pop():null}isPatternMissing(c){if(!c)return!1;if(!c.from||!c.to)return!0;const _=this.imageManager.getPattern(c.from.toString()),l=this.imageManager.getPattern(c.to.toString());return!_||!l}useProgram(c,_){this.cache=this.cache||{};const l=c+(_?_.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[l]||(this.cache[l]=new Na(this.context,c,ar[c],_,yl[c],this._showOverdrawInspector,this.style.terrain)),this.cache[l]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Z(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class as{constructor(c,_){this.points=c,this.planes=_}static fromInvProjectionMatrix(c,_,l){const h=Math.pow(2,l),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const S=1/(b=a.transformMat4([],b,c))[3]/_*h;return a.mul$1(b,b,[S,S,1/b[3],S])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const S=a.sub([],d[b[0]],d[b[1]]),M=a.sub([],d[b[2]],d[b[1]]),B=a.normalize([],a.cross([],S,M)),V=-a.dot(B,d[b[1]]);return B.concat(V)});return new as(d,x)}}class pa{constructor(c,_){this.min=c,this.max=_,this.center=a.scale$1([],a.add([],this.min,this.max),.5)}quadrant(c){const _=[c%2==0,c<2],l=a.clone$2(this.min),h=a.clone$2(this.max);for(let d=0;d<_.length;d++)l[d]=_[d]?this.min[d]:this.center[d],h[d]=_[d]?this.center[d]:this.max[d];return h[2]=this.max[2],new pa(l,h)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}intersects(c){const _=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let l=!0;for(let h=0;h<c.planes.length;h++){const d=c.planes[h];let x=0;for(let b=0;b<_.length;b++)a.dot$1(d,_[b])>=0&&x++;if(x===0)return 0;x!==_.length&&(l=!1)}if(l)return 2;for(let h=0;h<3;h++){let d=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let b=0;b<c.points.length;b++){const S=c.points[b][h]-this.min[h];d=Math.min(d,S),x=Math.max(x,S)}if(x<0||d>this.max[h]-this.min[h])return 0}return 1}}class Qr{constructor(c=0,_=0,l=0,h=0){if(isNaN(c)||c<0||isNaN(_)||_<0||isNaN(l)||l<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=_,this.left=l,this.right=h}interpolate(c,_,l){return _.top!=null&&c.top!=null&&(this.top=a.number(c.top,_.top,l)),_.bottom!=null&&c.bottom!=null&&(this.bottom=a.number(c.bottom,_.bottom,l)),_.left!=null&&c.left!=null&&(this.left=a.number(c.left,_.left,l)),_.right!=null&&c.right!=null&&(this.right=a.number(c.right,_.right,l)),this}getCenter(c,_){const l=a.clamp((this.left+c-this.right)/2,0,c),h=a.clamp((this.top+_-this.bottom)/2,0,_);return new a.pointGeometry(l,h)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Qr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class _o{constructor(c,_,l,h,d){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=d===void 0||!!d,this._minZoom=c||0,this._maxZoom=_||22,this._minPitch=l??0,this._maxPitch=h??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Qr,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const c=new _o(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c._center=this._center,c._elevation=this._elevation,c.zoom=this.zoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(c){const _=-a.wrap(c,-180,180)*Math.PI/180;var l;this.angle!==_&&(this._unmodified=!1,this.angle=_,this._calcMatrices(),this.rotationMatrix=(l=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(l[1]=0,l[2]=0),l[0]=1,l[3]=1,l),function(h,d,x){var b=d[0],S=d[1],M=d[2],B=d[3],V=Math.sin(x),$=Math.cos(x);h[0]=b*$+M*V,h[1]=S*$+B*V,h[2]=b*-V+M*$,h[3]=S*-V+B*$}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const _=a.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==_&&(this._unmodified=!1,this._pitch=_,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(c){const _=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==_&&(this._unmodified=!1,this._zoom=_,this.scale=this.zoomScale(_),this.tileZoom=Math.floor(_),this.zoomFraction=_-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(c){c!==this._elevation&&(this._elevation=c,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,_,l){this._unmodified=!1,this._edgeInsets.interpolate(c,_,l),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const _=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,_)}getVisibleUnwrappedCoordinates(c){const _=[new a.UnwrappedTileID(0,c)];if(this._renderWorldCopies){const l=this.pointCoordinate(new a.pointGeometry(0,0)),h=this.pointCoordinate(new a.pointGeometry(this.width,0)),d=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),x=this.pointCoordinate(new a.pointGeometry(0,this.height)),b=Math.floor(Math.min(l.x,h.x,d.x,x.x)),S=Math.floor(Math.max(l.x,h.x,d.x,x.x)),M=1;for(let B=b-M;B<=S+M;B++)B!==0&&_.push(new a.UnwrappedTileID(B,c))}return _}coveringTiles(c){var _,l;let h=this.coveringZoomLevel(c);const d=h;if(c.minzoom!==void 0&&h<c.minzoom)return[];c.maxzoom!==void 0&&h>c.maxzoom&&(h=c.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),b=a.MercatorCoordinate.fromLngLat(this.center),S=Math.pow(2,h),M=[S*x.x,S*x.y,0],B=[S*b.x,S*b.y,0],V=as.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h);let $=c.minzoom||0;!c.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&($=h);const X=c.terrain?2/Math.min(this.tileSize,c.tileSize)*this.tileSize:3,se=_e=>({aabb:new pa([_e*S,0,0],[(_e+1)*S,S,0]),zoom:0,x:0,y:0,wrap:_e,fullyVisible:!1}),ne=[],ue=[],be=h,Ce=c.reparseOverscaled?d:h;if(this._renderWorldCopies)for(let _e=1;_e<=3;_e++)ne.push(se(-_e)),ne.push(se(_e));for(ne.push(se(0));ne.length>0;){const _e=ne.pop(),Ge=_e.x,Te=_e.y;let Ue=_e.fullyVisible;if(!Ue){const C=_e.aabb.intersects(V);if(C===0)continue;Ue=C===2}const xe=c.terrain?M:B,m=_e.aabb.distanceX(xe),g=_e.aabb.distanceY(xe),v=Math.max(Math.abs(m),Math.abs(g)),E=X+(1<<be-_e.zoom)-2;if(_e.zoom===be||v>E&&_e.zoom>=$){const C=be-_e.zoom,R=M[0]-.5-(Ge<<C),O=M[1]-.5-(Te<<C);ue.push({tileID:new a.OverscaledTileID(_e.zoom===be?Ce:_e.zoom,_e.wrap,_e.zoom,Ge,Te),distanceSq:a.sqrLen([B[0]-.5-Ge,B[1]-.5-Te]),tileDistanceToCamera:Math.sqrt(R*R+O*O)})}else for(let C=0;C<4;C++){const R=(Ge<<1)+C%2,O=(Te<<1)+(C>>1),N=_e.zoom+1;let W=_e.aabb.quadrant(C);if(c.terrain){const J=new a.OverscaledTileID(N,_e.wrap,N,R,O),le=c.terrain.getMinMaxElevation(J),fe=(_=le.minElevation)!==null&&_!==void 0?_:this.elevation,Re=(l=le.maxElevation)!==null&&l!==void 0?l:this.elevation;W=new pa([W.min[0],W.min[1],fe],[W.max[0],W.max[1],Re])}ne.push({aabb:W,zoom:N,x:R,y:O,wrap:_e.wrap,fullyVisible:Ue})}}return ue.sort((_e,Ge)=>_e.distanceSq-Ge.distanceSq).map(_e=>_e.tileID)}resize(c,_){this.width=c,this.height=_,this.pixelsToGLUnits=[2/c,-2/_],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const _=a.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.pointGeometry(a.mercatorXfromLng(c.lng)*this.worldSize,a.mercatorYfromLat(_)*this.worldSize)}unproject(c){return new a.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(c){this.freezeElevation||(this.elevation=c?this.getElevation(this._center,c):0)}getElevation(c,_){const l=a.MercatorCoordinate.fromLngLat(c),h=(1<<this.tileZoom)*a.EXTENT,d=l.x*h,x=l.y*h,b=Math.floor(d/a.EXTENT),S=Math.floor(x/a.EXTENT),M=new a.OverscaledTileID(this.tileZoom,0,this.tileZoom,b,S);return _.getElevation(M,d%a.EXTENT,x%a.EXTENT,a.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(c){const _=this.pointLocation(this.centerPoint,c),l=this.getElevation(_,c);if(!(this.elevation-l))return;const h=this.getCameraPosition(),d=a.MercatorCoordinate.fromLngLat(h.lngLat,h.altitude),x=a.MercatorCoordinate.fromLngLat(_,l),b=d.x-x.x,S=d.y-x.y,M=d.z-x.z,B=Math.sqrt(b*b+S*S+M*M),V=this.scaleZoom(this.cameraToCenterDistance/B/this.tileSize);this._elevation=l,this._center=_,this.zoom=V}setLocationAtPoint(c,_){const l=this.pointCoordinate(_),h=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(c),x=new a.MercatorCoordinate(d.x-(l.x-h.x),d.y-(l.y-h.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(c,_){return _?this.coordinatePoint(this.locationCoordinate(c),this.getElevation(c,_),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(c))}pointLocation(c,_){return this.coordinateLocation(this.pointCoordinate(c,_))}locationCoordinate(c){return a.MercatorCoordinate.fromLngLat(c)}coordinateLocation(c){return c&&c.toLngLat()}pointCoordinate(c,_){if(_){const $=_.pointCoordinate(c);if($!=null)return $}const l=[c.x,c.y,0,1],h=[c.x,c.y,1,1];a.transformMat4(l,l,this.pixelMatrixInverse),a.transformMat4(h,h,this.pixelMatrixInverse);const d=l[3],x=h[3],b=l[1]/d,S=h[1]/x,M=l[2]/d,B=h[2]/x,V=M===B?0:(0-M)/(B-M);return new a.MercatorCoordinate(a.number(l[0]/d,h[0]/x,V)/this.worldSize,a.number(b,S,V)/this.worldSize)}coordinatePoint(c,_=0,l=this.pixelMatrix){const h=[c.x*this.worldSize,c.y*this.worldSize,_,1];return a.transformMat4(h,h,l),new a.pointGeometry(h[0]/h[3],h[1]/h[3])}getBounds(){const c=Math.max(0,this.height/2-this.getHorizon());return new a.LngLatBounds().extend(this.pointLocation(new a.pointGeometry(0,c))).extend(this.pointLocation(new a.pointGeometry(this.width,c))).extend(this.pointLocation(new a.pointGeometry(this.width,this.height))).extend(this.pointLocation(new a.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(c,_=!1){const l=c.key,h=_?this._alignedPosMatrixCache:this._posMatrixCache;if(h[l])return h[l];const d=c.canonical,x=this.worldSize/this.zoomScale(d.z),b=d.x+Math.pow(2,d.z)*c.wrap,S=a.identity(new Float64Array(16));return a.translate(S,S,[b*x,d.y*x,0]),a.scale(S,S,[x/a.EXTENT,x/a.EXTENT,1]),a.multiply(S,_?this.alignedProjMatrix:this.projMatrix,S),h[l]=new Float32Array(S),h[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let c,_,l,h,d=-90,x=90,b=-180,S=180;const M=this.size,B=this._unmodified;if(this.latRange){const X=this.latRange;d=a.mercatorYfromLat(X[1])*this.worldSize,x=a.mercatorYfromLat(X[0])*this.worldSize,c=x-d<M.y?M.y/(x-d):0}if(this.lngRange){const X=this.lngRange;b=a.wrap(a.mercatorXfromLng(X[0])*this.worldSize,0,this.worldSize),S=a.wrap(a.mercatorXfromLng(X[1])*this.worldSize,0,this.worldSize),S<b&&(S+=this.worldSize),_=S-b<M.x?M.x/(S-b):0}const V=this.point,$=Math.max(_||0,c||0);if($)return this.center=this.unproject(new a.pointGeometry(_?(S+b)/2:V.x,c?(x+d)/2:V.y)),this.zoom+=this.scaleZoom($),this._unmodified=B,void(this._constraining=!1);if(this.latRange){const X=V.y,se=M.y/2;X-se<d&&(h=d+se),X+se>x&&(h=x-se)}if(this.lngRange){const X=(b+S)/2,se=a.wrap(V.x,X-this.worldSize/2,X+this.worldSize/2),ne=M.x/2;se-ne<b&&(l=b+ne),se+ne>S&&(l=S-ne)}l===void 0&&h===void 0||(this.center=this.unproject(new a.pointGeometry(l!==void 0?l:V.x,h!==void 0?h:V.y)).wrap()),this._unmodified=B,this._constraining=!1}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,_=this.point.x,l=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let h=a.identity(new Float64Array(16));a.scale(h,h,[this.width/2,-this.height/2,1]),a.translate(h,h,[1,-1,0]),this.labelPlaneMatrix=h,h=a.identity(new Float64Array(16)),a.scale(h,h,[1,-1,1]),a.translate(h,h,[-1,-1,0]),a.scale(h,h,[2/this.width,2/this.height,1]),this.glCoordMatrix=h,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const d=Math.PI/2+this._pitch,x=this._fov*(.5+c.y/this.height),b=Math.sin(x)*this.cameraToSeaLevelDistance/Math.sin(a.clamp(Math.PI-d-x,.01,Math.PI-.01)),S=this.getHorizon(),M=2*Math.atan(S/this.cameraToCenterDistance)*(.5+c.y/(2*S)),B=Math.sin(M)*this.cameraToSeaLevelDistance/Math.sin(a.clamp(Math.PI-d-M,.01,Math.PI-.01)),V=Math.cos(Math.PI/2-this._pitch)*b+this.cameraToSeaLevelDistance,$=Math.cos(Math.PI/2-this._pitch)*B+this.cameraToSeaLevelDistance,X=1.01*Math.min(V,$),se=this.height/50;h=new Float64Array(16),a.perspective(h,this._fov,this.width/this.height,se,X),h[8]=2*-c.x/this.width,h[9]=2*c.y/this.height,a.scale(h,h,[1,-1,1]),a.translate(h,h,[0,0,-this.cameraToCenterDistance]),a.rotateX(h,h,this._pitch),a.rotateZ(h,h,this.angle),a.translate(h,h,[-_,-l,0]),this.mercatorMatrix=a.scale([],h,[this.worldSize,this.worldSize,this.worldSize]),a.scale(h,h,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,h),a.translate(h,h,[0,0,-this.elevation]),this.projMatrix=h,this.invProjMatrix=a.invert([],h),this.pixelMatrix3D=a.multiply(new Float64Array(16),this.labelPlaneMatrix,h);const ne=this.width%2/2,ue=this.height%2/2,be=Math.cos(this.angle),Ce=Math.sin(this.angle),_e=_-Math.round(_)+be*ne+Ce*ue,Ge=l-Math.round(l)+be*ue+Ce*ne,Te=new Float64Array(h);if(a.translate(Te,Te,[_e>.5?_e-1:_e,Ge>.5?Ge-1:Ge,0]),this.alignedProjMatrix=Te,h=a.invert(new Float64Array(16),this.pixelMatrix),!h)throw new Error("failed to invert matrix");this.pixelMatrixInverse=h,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const c=this.pointCoordinate(new a.pointGeometry(0,0)),_=[c.x*this.worldSize,c.y*this.worldSize,0,1];return a.transformMat4(_,_,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,c))}getCameraQueryGeometry(c){const _=this.getCameraPoint();if(c.length===1)return[c[0],_];{let l=_.x,h=_.y,d=_.x,x=_.y;for(const b of c)l=Math.min(l,b.x),h=Math.min(h,b.y),d=Math.max(d,b.x),x=Math.max(x,b.y);return[new a.pointGeometry(l,h),new a.pointGeometry(d,h),new a.pointGeometry(d,x),new a.pointGeometry(l,x),new a.pointGeometry(l,h)]}}}class fr{constructor(c){this._hashName=c&&encodeURIComponent(c),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(_,l){let h=!1,d=null;const x=()=>{d=null,h&&(_(),d=setTimeout(x,300),h=!1)};return()=>(h=!0,d||x(),d)}(this._updateHashUnthrottled.bind(this))}addTo(c){return this._map=c,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(c){const _=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,h=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,h),x=Math.round(_.lng*d)/d,b=Math.round(_.lat*d)/d,S=this._map.getBearing(),M=this._map.getPitch();let B="";if(B+=c?`/${x}/${b}/${l}`:`${l}/${b}/${x}`,(S||M)&&(B+="/"+Math.round(10*S)/10),M&&(B+=`/${Math.round(M)}`),this._hashName){const V=this._hashName;let $=!1;const X=window.location.hash.slice(1).split("&").map(se=>{const ne=se.split("=")[0];return ne===V?($=!0,`${ne}=${B}`):se}).filter(se=>se);return $||X.push(`${V}=${B}`),`#${X.join("&")}`}return`#${B}`}_getCurrentHash(){const c=window.location.hash.replace("#","");if(this._hashName){let _;return c.split("&").map(l=>l.split("=")).forEach(l=>{l[0]===this._hashName&&(_=l)}),(_&&_[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._getCurrentHash();if(c.length>=3&&!c.some(_=>isNaN(_))){const _=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:_,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,c)}catch{}}}const Wa={linearity:.3,easing:a.bezier(0,0,.3,1)},Pl=a.extend({deceleration:2500,maxSpeed:1400},Wa),Qa=a.extend({deceleration:20,maxSpeed:1400},Wa),Vs=a.extend({deceleration:1e3,maxSpeed:360},Wa),ls=a.extend({deceleration:1e3,maxSpeed:90},Wa);class rc{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,_=a.exported.now();for(;c.length>0&&_-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const _={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)_.zoom+=d.zoomDelta||0,_.bearing+=d.bearingDelta||0,_.pitch+=d.pitchDelta||0,d.panDelta&&_.pan._add(d.panDelta),d.around&&(_.around=d.around),d.pinchAround&&(_.pinchAround=d.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(_.pan.mag()){const d=qa(_.pan.mag(),l,a.extend({},Pl,c||{}));h.offset=_.pan.mult(d.amount/_.pan.mag()),h.center=this._map.transform.center,ga(h,d)}if(_.zoom){const d=qa(_.zoom,l,Qa);h.zoom=this._map.transform.zoom+d.amount,ga(h,d)}if(_.bearing){const d=qa(_.bearing,l,Vs);h.bearing=this._map.transform.bearing+a.clamp(d.amount,-179,179),ga(h,d)}if(_.pitch){const d=qa(_.pitch,l,ls);h.pitch=this._map.transform.pitch+d.amount,ga(h,d)}if(h.zoom||h.bearing){const d=_.pinchAround===void 0?_.around:_.pinchAround;h.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),a.extend(h,{noMoveStart:!0})}}function ga(k,c){(!k.duration||k.duration<c.duration)&&(k.duration=c.duration,k.easing=c.easing)}function qa(k,c,_){const{maxSpeed:l,linearity:h,deceleration:d}=_,x=a.clamp(k*h/(c/1e3),-l,l),b=Math.abs(x)/(d*h);return{easing:_.easing,duration:1e3*b,amount:x*(b/2)}}class nr extends a.Event{constructor(c,_,l,h={}){const d=L.mousePos(_.getCanvasContainer(),l),x=_.unproject(d);super(c,a.extend({point:d,lngLat:x,originalEvent:l},h)),this._defaultPrevented=!1,this.target=_}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class bs extends a.Event{constructor(c,_,l){const h=c==="touchend"?l.changedTouches:l.touches,d=L.touchPos(_.getCanvasContainer(),h),x=d.map(S=>_.unproject(S)),b=d.reduce((S,M,B,V)=>S.add(M.div(V.length)),new a.pointGeometry(0,0));super(c,{points:d,point:b,lngLats:x,lngLat:_.unproject(b),originalEvent:l}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class qr extends a.Event{constructor(c,_,l){super(c,{originalEvent:l}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Il{constructor(c,_){this._map=c,this._clickTolerance=_.clickTolerance}reset(){delete this._mousedownPos}wheel(c){return this._firePreventable(new qr(c.type,this._map,c))}mousedown(c,_){return this._mousedownPos=_,this._firePreventable(new nr(c.type,this._map,c))}mouseup(c){this._map.fire(new nr(c.type,this._map,c))}click(c,_){this._mousedownPos&&this._mousedownPos.dist(_)>=this._clickTolerance||this._map.fire(new nr(c.type,this._map,c))}dblclick(c){return this._firePreventable(new nr(c.type,this._map,c))}mouseover(c){this._map.fire(new nr(c.type,this._map,c))}mouseout(c){this._map.fire(new nr(c.type,this._map,c))}touchstart(c){return this._firePreventable(new bs(c.type,this._map,c))}touchmove(c){this._map.fire(new bs(c.type,this._map,c))}touchend(c){this._map.fire(new bs(c.type,this._map,c))}touchcancel(c){this._map.fire(new bs(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Wo{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(c){this._map.fire(new nr(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new nr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._ignoreContextMenu||this._map.fire(new nr(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sc{constructor(c,_){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=_.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,_){this.isEnabled()&&c.shiftKey&&c.button===0&&(L.disableDrag(),this._startPos=this._lastPos=_,this._active=!0)}mousemoveWindow(c,_){if(!this._active)return;const l=_;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=l,this._box||(this._box=L.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const d=Math.min(h.x,l.x),x=Math.max(h.x,l.x),b=Math.min(h.y,l.y),S=Math.max(h.y,l.y);L.setTransform(this._box,`translate(${d}px,${b}px)`),this._box.style.width=x-d+"px",this._box.style.height=S-b+"px"}mouseupWindow(c,_){if(!this._active||c.button!==0)return;const l=this._startPos,h=_;if(this.reset(),L.suppressClick(),l.x!==h.x||l.y!==h.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:d=>d.fitScreenCoordinates(l,h,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",c)}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(L.remove(this._box),this._box=null),L.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(c,_){return this._map.fire(new a.Event(c,{originalEvent:_}))}}function vo(k,c){if(k.length!==c.length)throw new Error(`The number of touches and points are not equal - touches ${k.length}, points ${c.length}`);const _={};for(let l=0;l<k.length;l++)_[k[l].identifier]=c[l];return _}class kl{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(c,_,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),l.length===this.numTouches&&(this.centroid=function(h){const d=new a.pointGeometry(0,0);for(const x of h)d._add(x);return d.div(h.length)}(_),this.touches=vo(l,_)))}touchmove(c,_,l){if(this.aborted||!this.centroid)return;const h=vo(l,_);for(const d in this.touches){const x=this.touches[d],b=h[d];(!b||b.dist(x)>30)&&(this.aborted=!0)}}touchend(c,_,l){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class Za{constructor(c){this.singleTap=new kl(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(c,_,l){this.singleTap.touchstart(c,_,l)}touchmove(c,_,l){this.singleTap.touchmove(c,_,l)}touchend(c,_,l){const h=this.singleTap.touchend(c,_,l);if(h){const d=c.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(h)<30;if(d&&x||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class rh{constructor(){this._zoomIn=new Za({numTouches:1,numTaps:2}),this._zoomOut=new Za({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,_,l){this._zoomIn.touchstart(c,_,l),this._zoomOut.touchstart(c,_,l)}touchmove(c,_,l){this._zoomIn.touchmove(c,_,l),this._zoomOut.touchmove(c,_,l)}touchend(c,_,l){const h=this._zoomIn.touchend(c,_,l),d=this._zoomOut.touchend(c,_,l);return h?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()+1,around:x.unproject(h)},{originalEvent:c})}):d?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()-1,around:x.unproject(d)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const sh={0:1,2:2};class Ya{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(c,_){return!1}_move(c,_){return{}}mousedown(c,_){if(this._lastPoint)return;const l=L.mouseButton(c);this._correctButton(c,l)&&(this._lastPoint=_,this._eventButton=l)}mousemoveWindow(c,_){const l=this._lastPoint;if(l){if(c.preventDefault(),function(h,d){const x=sh[d];return h.buttons===void 0||(h.buttons&x)!==x}(c,this._eventButton))this.reset();else if(this._moved||!(_.dist(l)<this._clickTolerance))return this._moved=!0,this._lastPoint=_,this._move(l,_)}}mouseupWindow(c){this._lastPoint&&L.mouseButton(c)===this._eventButton&&(this._moved&&L.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ma extends Ya{mousedown(c,_){super.mousedown(c,_),this._lastPoint&&(this._active=!0)}_correctButton(c,_){return _===0&&!c.ctrlKey}_move(c,_){return{around:_,panDelta:_.sub(c)}}}class As extends Ya{_correctButton(c,_){return _===0&&c.ctrlKey||_===2}_move(c,_){const l=.8*(_.x-c.x);if(l)return this._active=!0,{bearingDelta:l}}contextmenu(c){c.preventDefault()}}class Ft extends Ya{_correctButton(c,_){return _===0&&c.ctrlKey||_===2}_move(c,_){const l=-.5*(_.y-c.y);if(l)return this._active=!0,{pitchDelta:l}}contextmenu(c){c.preventDefault()}}class nu{constructor(c,_){this._minTouches=c.cooperativeGestures?2:1,this._clickTolerance=c.clickTolerance||1,this._map=_,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(c,_,l){return this._calculateTransform(c,_,l)}touchmove(c,_,l){if(this._map._cooperativeGestures&&(this._minTouches===2&&l.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(c,!1,l.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(l.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,_,l)}touchend(c,_,l){this._calculateTransform(c,_,l),this._active&&l.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,_,l){l.length>0&&(this._active=!0);const h=vo(l,_),d=new a.pointGeometry(0,0),x=new a.pointGeometry(0,0);let b=0;for(const M in h){const B=h[M],V=this._touches[M];V&&(d._add(B),x._add(B.sub(V)),b++,h[M]=B)}if(this._touches=h,b<this._minTouches||!x.mag())return;const S=x.div(b);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(b),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ya{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(c){}_move(c,_,l){return{}}touchstart(c,_,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([_[0],_[1]]))}touchmove(c,_,l){if(!this._firstTwoTouches)return;c.preventDefault();const[h,d]=this._firstTwoTouches,x=Qo(l,_,h),b=Qo(l,_,d);if(!x||!b)return;const S=this._aroundCenter?null:x.add(b).div(2);return this._move([x,b],S,c)}touchend(c,_,l){if(!this._firstTwoTouches)return;const[h,d]=this._firstTwoTouches,x=Qo(l,_,h),b=Qo(l,_,d);x&&b||(this._active&&L.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Qo(k,c,_){for(let l=0;l<k.length;l++)if(k[l].identifier===_)return c[l]}function iu(k,c){return Math.log(k/c)/Math.LN2}class Ut extends ya{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,_){const l=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(iu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:iu(this._distance,l),pinchAround:_}}}function mA(k,c){return 180*k.angleWith(c)/Math.PI}class Ll extends ya{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,_){const l=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:mA(this._vector,l),pinchAround:_}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const _=25/(Math.PI*this._minDiameter)*360,l=mA(c,this._startVector);return Math.abs(l)<_}}function yA(k){return Math.abs(k.y)>Math.abs(k.x)}class Xa extends ya{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(c,_,l){super.touchstart(c,_,l),this._currentTouchCount=l.length}_start(c){this._lastPoints=c,yA(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,_,l){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const h=c[0].sub(this._lastPoints[0]),d=c[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,d,l.timeStamp),this._valid?(this._lastPoints=c,this._active=!0,{pitchDelta:(h.y+d.y)/2*-.5}):void 0}gestureBeginsVertically(c,_,l){if(this._valid!==void 0)return this._valid;const h=c.mag()>=2,d=_.mag()>=2;if(!h&&!d)return;if(!h||!d)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const x=c.y>0==_.y>0;return yA(c)&&yA(_)&&x}}const Gs={panStep:100,bearingStep:15,pitchStep:10};class ru{constructor(){const c=Gs;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let _=0,l=0,h=0,d=0,x=0;switch(c.keyCode){case 61:case 107:case 171:case 187:_=1;break;case 189:case 109:case 173:_=-1;break;case 37:c.shiftKey?l=-1:(c.preventDefault(),d=-1);break;case 39:c.shiftKey?l=1:(c.preventDefault(),d=1);break;case 38:c.shiftKey?h=1:(c.preventDefault(),x=-1);break;case 40:c.shiftKey?h=-1:(c.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(l=0,h=0),{cameraAnimation:b=>{const S=b.getZoom();b.easeTo({duration:300,easeId:"keyboardHandler",easing:oh,zoom:_?Math.round(S)+_*(c.shiftKey?2:1):S,bearing:b.getBearing()+l*this._bearingStep,pitch:b.getPitch()+h*this._pitchStep,offset:[-d*this._panStep,-x*this._panStep],center:b.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function oh(k){return k*(2-k)}const oc=4.000244140625;class su{constructor(c,_){this._map=c,this._el=c.getCanvasContainer(),this._handler=_,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&c.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;c.preventDefault()}let _=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const l=a.exported.now(),h=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,_!==0&&_%oc==0?this._type="wheel":_!==0&&Math.abs(_)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=_,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(h*_)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,_+=this._lastValue)),c.shiftKey&&_&&(_/=4),this._type&&(this._lastWheelEvent=c,this._delta-=_,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const _=L.mousePos(this._el,c);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(_)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>oc?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&S!==0&&(S=1/S);const M=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(M*S))),this._type==="wheel"&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const _=typeof this._targetZoom=="number"?this._targetZoom:c.zoom,l=this._startZoom,h=this._easing;let d,x=!1;if(this._type==="wheel"&&l&&h){const b=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),S=h(b);d=a.number(l,_,S),b<1?this._frameId||(this._frameId=!0):x=!0}else d=_,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:d-c.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let _=a.ease;if(this._prevEase){const l=this._prevEase,h=(a.exported.now()-l.start)/l.duration,d=l.easing(h+.01)-l.easing(h),x=.27/Math.sqrt(d*d+1e-4)*.01,b=Math.sqrt(.0729-x*x);_=a.bezier(x,b,.25,1)}return this._prevEase={start:a.exported.now(),duration:c,easing:_},_}reset(){this._active=!1}}class ou{constructor(c,_){this._clickZoom=c,this._tapZoom=_}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class au{constructor(){this.reset()}reset(){this._active=!1}dblclick(c,_){return c.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:l.getZoom()+(c.shiftKey?-1:1),around:l.unproject(_)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class js{constructor(){this._tap=new Za({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(c,_,l){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?l.length>0&&(this._swipePoint=_[0],this._swipeTouch=l[0].identifier):this._tap.touchstart(c,_,l))}touchmove(c,_,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const h=_[0],d=h.y-this._swipePoint.y;return this._swipePoint=h,c.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(c,_,l)}touchend(c,_,l){this._tapTime?this._swipePoint&&l.length===0&&this.reset():this._tap.touchend(c,_,l)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dr{constructor(c,_,l){this._el=c,this._mousePan=_,this._touchPan=l}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xo{constructor(c,_,l){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=_,this._mousePitch=l}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class lu{constructor(c,_,l,h){this._el=c,this._touchZoom=_,this._touchRotate=l,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const _a=k=>k.zoom||k.drag||k.pitch||k.rotate;class zi extends a.Event{}function Dl(k){return k.panDelta&&k.panDelta.mag()||k.zoomDelta||k.bearingDelta||k.pitchDelta}class ac{constructor(c,_){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new rc(c),this._bearingSnap=_.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(_),a.bindAll(["handleEvent","handleWindowEvent"],this);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,d,x]of this._listeners)L.addEventListener(h,d,h===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[c,_,l]of this._listeners)L.removeEventListener(c,_,c===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(c){const _=this._map,l=_.getCanvasContainer();this._add("mapEvent",new Il(_,c));const h=_.boxZoom=new sc(_,c);this._add("boxZoom",h);const d=new rh,x=new au;_.doubleClickZoom=new ou(x,d),this._add("tapZoom",d),this._add("clickZoom",x);const b=new js;this._add("tapDragZoom",b);const S=_.touchPitch=new Xa(_);this._add("touchPitch",S);const M=new As(c),B=new Ft(c);_.dragRotate=new xo(c,M,B),this._add("mouseRotate",M,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]);const V=new ma(c),$=new nu(c,_);_.dragPan=new Dr(l,V,$),this._add("mousePan",V),this._add("touchPan",$,["touchZoom","touchRotate"]);const X=new Ll,se=new Ut;_.touchZoomRotate=new lu(l,se,X,b),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",se,["touchPan","touchRotate"]);const ne=_.scrollZoom=new su(_,this);this._add("scrollZoom",ne,["mousePan"]);const ue=_.keyboard=new ru;this._add("keyboard",ue),this._add("blockableMapEvent",new Wo(_));for(const be of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[be]&&_[be].enable(c[be])}_add(c,_,l){this._handlers.push({handlerName:c,handler:_,allowed:l}),this._handlersById[c]=_}stop(c){if(!this._updatingCamera){for(const{handler:_}of this._handlers)_.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!_a(this._eventsInProgress)||this.isZooming()}_blockedByActive(c,_,l){for(const h in c)if(h!==l&&(!_||_.indexOf(h)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const _=[];for(const l of c)this._el.contains(l.target)&&_.push(l);return _}handleEvent(c,_){if(c.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const l=c.type==="renderFrame"?void 0:c,h={needsRenderFrame:!1},d={},x={},b=c.touches,S=b?this._getMapTouches(b):void 0,M=S?L.touchPos(this._el,S):L.mousePos(this._el,c);for(const{handlerName:$,handler:X,allowed:se}of this._handlers){if(!X.isEnabled())continue;let ne;this._blockedByActive(x,se,$)?X.reset():X[_||c.type]&&(ne=X[_||c.type](c,M,S),this.mergeHandlerResult(h,d,ne,$,l),ne&&ne.needsRenderFrame&&this._triggerRenderFrame()),(ne||X.isActive())&&(x[$]=X)}const B={};for(const $ in this._previousActiveHandlers)x[$]||(B[$]=l);this._previousActiveHandlers=x,(Object.keys(B).length||Dl(h))&&(this._changes.push([h,d,B]),this._triggerRenderFrame()),(Object.keys(x).length||Dl(h))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=h;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))}mergeHandlerResult(c,_,l,h,d){if(!l)return;a.extend(c,l);const x={handlerName:h,originalEvent:l.originalEvent||d};l.zoomDelta!==void 0&&(_.zoom=x),l.panDelta!==void 0&&(_.drag=x),l.pitchDelta!==void 0&&(_.pitch=x),l.bearingDelta!==void 0&&(_.rotate=x)}_applyChanges(){const c={},_={},l={};for(const[h,d,x]of this._changes)h.panDelta&&(c.panDelta=(c.panDelta||new a.pointGeometry(0,0))._add(h.panDelta)),h.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+h.pitchDelta),h.around!==void 0&&(c.around=h.around),h.pinchAround!==void 0&&(c.pinchAround=h.pinchAround),h.noInertia&&(c.noInertia=h.noInertia),a.extend(_,d),a.extend(l,x);this._updateMapTransform(c,_,l),this._changes=[]}_updateMapTransform(c,_,l){const h=this._map,d=h.transform,x=h.style&&h.style.terrain;if(!(Dl(c)||x&&this._drag))return this._fireEvents(_,l,!0);let{panDelta:b,zoomDelta:S,bearingDelta:M,pitchDelta:B,around:V,pinchAround:$}=c;$!==void 0&&(V=$),h._stop(!0),V=V||h.transform.centerPoint;const X=d.pointLocation(b?V.sub(b):V);M&&(d.bearing+=M),B&&(d.pitch+=B),S&&(d.zoom+=S),x?_.drag&&!this._drag?(this._drag={center:d.centerPoint,lngLat:d.pointLocation(V),point:V,handlerName:_.drag.handlerName},h.fire(new a.Event("freezeElevation",{freeze:!0}))):this._drag&&l[this._drag.handlerName]?(h.fire(new a.Event("freezeElevation",{freeze:!1})),this._drag=null):_.drag&&this._drag&&(d.center=d.pointLocation(d.centerPoint.sub(b))):d.setLocationAtPoint(X,V),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(_,l,!0)}_fireEvents(c,_,l){const h=_a(this._eventsInProgress),d=_a(c),x={};for(const B in c){const{originalEvent:V}=c[B];this._eventsInProgress[B]||(x[`${B}start`]=V),this._eventsInProgress[B]=c[B]}!h&&d&&this._fireEvent("movestart",d.originalEvent);for(const B in x)this._fireEvent(B,x[B]);d&&this._fireEvent("move",d.originalEvent);for(const B in c){const{originalEvent:V}=c[B];this._fireEvent(B,V)}const b={};let S;for(const B in this._eventsInProgress){const{handlerName:V,originalEvent:$}=this._eventsInProgress[B];this._handlersById[V].isActive()||(delete this._eventsInProgress[B],S=_[V]||$,b[`${B}end`]=S)}for(const B in b)this._fireEvent(B,b[B]);const M=_a(this._eventsInProgress);if(l&&(h||d)&&!M){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;B?(V(B.bearing||this._map.getBearing())&&(B.bearing=0),this._map.easeTo(B,{originalEvent:S})):(this._map.fire(new a.Event("moveend",{originalEvent:S})),V(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,_){this._map.fire(new a.Event(c,_?{originalEvent:_}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{delete this._frameId,this.handleEvent(new zi("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const us={extend:(k,...c)=>a.extend(k,...c),run(k){k()},logToElement(k,c=!1,_="log"){const l=window.document.getElementById(_);l&&(c&&(l.innerHTML=""),l.innerHTML+=`<br>${k}`)}};class Ei extends a.Evented{constructor(c,_){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=_.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,_){return this.jumpTo({center:c},_)}panBy(c,_,l){return c=a.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,a.extend({offset:c},_),l)}panTo(c,_,l){return this.easeTo(a.extend({center:c},_),l)}getZoom(){return this.transform.zoom}setZoom(c,_){return this.jumpTo({zoom:c},_),this}zoomTo(c,_,l){return this.easeTo(a.extend({zoom:c},_),l)}zoomIn(c,_){return this.zoomTo(this.getZoom()+1,c,_),this}zoomOut(c,_){return this.zoomTo(this.getZoom()-1,c,_),this}getBearing(){return this.transform.bearing}setBearing(c,_){return this.jumpTo({bearing:c},_),this}getPadding(){return this.transform.padding}setPadding(c,_){return this.jumpTo({padding:c},_),this}rotateTo(c,_,l){return this.easeTo(a.extend({bearing:c},_),l)}resetNorth(c,_){return this.rotateTo(0,a.extend({duration:1e3},c),_),this}resetNorthPitch(c,_){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},c),_),this}snapToNorth(c,_){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,_):this}getPitch(){return this.transform.pitch}setPitch(c,_){return this.jumpTo({pitch:c},_),this}cameraForBounds(c,_){c=a.LngLatBounds.convert(c);const l=_&&_.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),l,_)}_cameraForBoxAndBearing(c,_,l,h){const d={top:0,bottom:0,right:0,left:0};if(typeof(h=a.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const Te=h.padding;h.padding={top:Te,bottom:Te,right:Te,left:Te}}h.padding=a.extend(d,h.padding);const x=this.transform,b=x.padding,S=x.project(a.LngLat.convert(c)),M=x.project(a.LngLat.convert(_)),B=S.rotate(-l*Math.PI/180),V=M.rotate(-l*Math.PI/180),$=new a.pointGeometry(Math.max(B.x,V.x),Math.max(B.y,V.y)),X=new a.pointGeometry(Math.min(B.x,V.x),Math.min(B.y,V.y)),se=$.sub(X),ne=(x.width-(b.left+b.right+h.padding.left+h.padding.right))/se.x,ue=(x.height-(b.top+b.bottom+h.padding.top+h.padding.bottom))/se.y;if(ue<0||ne<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const be=Math.min(x.scaleZoom(x.scale*Math.min(ne,ue)),h.maxZoom),Ce=a.pointGeometry.convert(h.offset),_e=new a.pointGeometry((h.padding.left-h.padding.right)/2,(h.padding.top-h.padding.bottom)/2).rotate(l*Math.PI/180),Ge=Ce.add(_e).mult(x.scale/x.zoomScale(be));return{center:x.unproject(S.add(M).div(2).sub(Ge)),zoom:be,bearing:l}}fitBounds(c,_,l){return this._fitInternal(this.cameraForBounds(c,_),_,l)}fitScreenCoordinates(c,_,l,h,d){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.pointGeometry.convert(c)),this.transform.pointLocation(a.pointGeometry.convert(_)),l,h),h,d)}_fitInternal(c,_,l){return c?(delete(_=a.extend(c,_)).padding,_.linear?this.easeTo(_,l):this.flyTo(_,l)):this}jumpTo(c,_){this.stop();const l=this.transform;let h=!1,d=!1,x=!1;return"zoom"in c&&l.zoom!==+c.zoom&&(h=!0,l.zoom=+c.zoom),c.center!==void 0&&(l.center=a.LngLat.convert(c.center)),"bearing"in c&&l.bearing!==+c.bearing&&(d=!0,l.bearing=+c.bearing),"pitch"in c&&l.pitch!==+c.pitch&&(x=!0,l.pitch=+c.pitch),c.padding==null||l.isPaddingEqual(c.padding)||(l.padding=c.padding),this.fire(new a.Event("movestart",_)).fire(new a.Event("move",_)),h&&this.fire(new a.Event("zoomstart",_)).fire(new a.Event("zoom",_)).fire(new a.Event("zoomend",_)),d&&this.fire(new a.Event("rotatestart",_)).fire(new a.Event("rotate",_)).fire(new a.Event("rotateend",_)),x&&this.fire(new a.Event("pitchstart",_)).fire(new a.Event("pitch",_)).fire(new a.Event("pitchend",_)),this.fire(new a.Event("moveend",_))}calculateCameraOptionsFromTo(c,_,l,h=0){const d=a.MercatorCoordinate.fromLngLat(c,_),x=a.MercatorCoordinate.fromLngLat(l,h),b=x.x-d.x,S=x.y-d.y,M=x.z-d.z,B=Math.hypot(b,S,M);if(B===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(b,S),$=this.transform.scaleZoom(this.transform.cameraToCenterDistance/B/this.transform.tileSize),X=180*Math.atan2(b,-S)/Math.PI;let se=180*Math.acos(V/B)/Math.PI;return se=M<0?90-se:90+se,{center:x.toLngLat(),zoom:$,pitch:se,bearing:X}}easeTo(c,_){this._stop(!1,c.easeId),((c=a.extend({offset:[0,0],duration:500,easing:a.ease},c)).animate===!1||!c.essential&&a.exported.prefersReducedMotion)&&(c.duration=0);const l=this.transform,h=this.getZoom(),d=this.getBearing(),x=this.getPitch(),b=this.getPadding(),S="zoom"in c?+c.zoom:h,M="bearing"in c?this._normalizeBearing(c.bearing,d):d,B="pitch"in c?+c.pitch:x,V="padding"in c?c.padding:l.padding,$=a.pointGeometry.convert(c.offset);let X=l.centerPoint.add($);const se=l.pointLocation(X),ne=a.LngLat.convert(c.center||se);this._normalizeCenter(ne);const ue=l.project(se),be=l.project(ne).sub(ue),Ce=l.zoomScale(S-h);let _e,Ge;c.around&&(_e=a.LngLat.convert(c.around),Ge=l.locationPoint(_e));const Te={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||S!==h,this._rotating=this._rotating||d!==M,this._pitching=this._pitching||B!==x,this._padding=!l.isPaddingEqual(V),this._easeId=c.easeId,this._prepareEase(_,c.noMoveStart,Te),this._ease(Ue=>{if(this._zooming&&(l.zoom=a.number(h,S,Ue)),this._rotating&&(l.bearing=a.number(d,M,Ue)),this._pitching&&(l.pitch=a.number(x,B,Ue)),this._padding&&(l.interpolatePadding(b,V,Ue),X=l.centerPoint.add($)),_e)l.setLocationAtPoint(_e,Ge);else{const xe=l.zoomScale(l.zoom-h),m=S>h?Math.min(2,Ce):Math.max(.5,Ce),g=Math.pow(m,1-Ue),v=l.unproject(ue.add(be.mult(Ue*g)).mult(xe));l.setLocationAtPoint(l.renderWorldCopies?v.wrap():v,X)}this._fireMoveEvents(_)},Ue=>{this._afterEase(_,Ue)},c),this}_prepareEase(c,_,l={}){this._moving=!0,this.fire(new a.Event("freezeElevation",{freeze:!0})),_||l.moving||this.fire(new a.Event("movestart",c)),this._zooming&&!l.zooming&&this.fire(new a.Event("zoomstart",c)),this._rotating&&!l.rotating&&this.fire(new a.Event("rotatestart",c)),this._pitching&&!l.pitching&&this.fire(new a.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new a.Event("move",c)),this._zooming&&this.fire(new a.Event("zoom",c)),this._rotating&&this.fire(new a.Event("rotate",c)),this._pitching&&this.fire(new a.Event("pitch",c))}_afterEase(c,_){if(this._easeId&&_&&this._easeId===_)return;delete this._easeId,this.fire(new a.Event("freezeElevation",{freeze:!1}));const l=this._zooming,h=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,l&&this.fire(new a.Event("zoomend",c)),h&&this.fire(new a.Event("rotateend",c)),d&&this.fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))}flyTo(c,_){if(!c.essential&&a.exported.prefersReducedMotion){const N=a.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(N,_)}this.stop(),c=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},c);const l=this.transform,h=this.getZoom(),d=this.getBearing(),x=this.getPitch(),b=this.getPadding(),S="zoom"in c?a.clamp(+c.zoom,l.minZoom,l.maxZoom):h,M="bearing"in c?this._normalizeBearing(c.bearing,d):d,B="pitch"in c?+c.pitch:x,V="padding"in c?c.padding:l.padding,$=l.zoomScale(S-h),X=a.pointGeometry.convert(c.offset);let se=l.centerPoint.add(X);const ne=l.pointLocation(se),ue=a.LngLat.convert(c.center||ne);this._normalizeCenter(ue);const be=l.project(ne),Ce=l.project(ue).sub(be);let _e=c.curve;const Ge=Math.max(l.width,l.height),Te=Ge/$,Ue=Ce.mag();if("minZoom"in c){const N=a.clamp(Math.min(c.minZoom,h,S),l.minZoom,l.maxZoom),W=Ge/l.zoomScale(N-h);_e=Math.sqrt(W/Ue*2)}const xe=_e*_e;function m(N){const W=(Te*Te-Ge*Ge+(N?-1:1)*xe*xe*Ue*Ue)/(2*(N?Te:Ge)*xe*Ue);return Math.log(Math.sqrt(W*W+1)-W)}function g(N){return(Math.exp(N)-Math.exp(-N))/2}function v(N){return(Math.exp(N)+Math.exp(-N))/2}const E=m(0);let C=function(N){return v(E)/v(E+_e*N)},R=function(N){return Ge*((v(E)*(g(W=E+_e*N)/v(W))-g(E))/xe)/Ue;var W},O=(m(1)-E)/_e;if(Math.abs(Ue)<1e-6||!isFinite(O)){if(Math.abs(Ge-Te)<1e-6)return this.easeTo(c,_);const N=Te<Ge?-1:1;O=Math.abs(Math.log(Te/Ge))/_e,R=function(){return 0},C=function(W){return Math.exp(N*_e*W)}}return c.duration="duration"in c?+c.duration:1e3*O/("screenSpeed"in c?+c.screenSpeed/_e:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=d!==M,this._pitching=B!==x,this._padding=!l.isPaddingEqual(V),this._prepareEase(_,!1),this._ease(N=>{const W=N*O,J=1/C(W);l.zoom=N===1?S:h+l.scaleZoom(J),this._rotating&&(l.bearing=a.number(d,M,N)),this._pitching&&(l.pitch=a.number(x,B,N)),this._padding&&(l.interpolatePadding(b,V,N),se=l.centerPoint.add(X));const le=N===1?ue:l.unproject(be.add(Ce.mult(R(W))).mult(J));l.setLocationAtPoint(l.renderWorldCopies?le.wrap():le,se),this._fireMoveEvents(_)},()=>this._afterEase(_),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,_){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const l=this._onEaseEnd;delete this._onEaseEnd,l.call(this,_)}if(!c){const l=this.handlers;l&&l.stop(!1)}return this}_ease(c,_,l){l.animate===!1||l.duration===0?(c(1),_()):(this._easeStart=a.exported.now(),this._easeOptions=l,this._onEaseFrame=c,this._onEaseEnd=_,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,_){c=a.wrap(c,-180,180);const l=Math.abs(c-_);return Math.abs(c-360-_)<l&&(c-=360),Math.abs(c+360-_)<l&&(c+=360),c}_normalizeCenter(c){const _=this.transform;if(!_.renderWorldCopies||_.lngRange)return;const l=c.lng-_.center.lng;c.lng+=l>180?-360:l<-180?360:0}}class Ka{constructor(c={}){this.options=c,a.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){return this._map=c,this._compact=this.options&&this.options.compact,this._container=L.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){L.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(c,_){const l=this._map._getUIString(`AttributionControl.${_}`);c.title=l,c.setAttribute("aria-label",l)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const _=this._map.style.sourceCaches;for(const h in _){const d=_[h];if(d.used||d.usedForTerrain){const x=d.getSource();x.attribution&&c.indexOf(x.attribution)<0&&c.push(x.attribution)}}c=c.filter(h=>String(h).trim()),c.sort((h,d)=>h.length-d.length),c=c.filter((h,d)=>{for(let x=d+1;x<c.length;x++)if(c[x].indexOf(h)>=0)return!1;return!0});const l=c.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,c.length?(this._innerContainer.innerHTML=l,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Rl{constructor(c={}){this.options=c,a.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(c){this._map=c,this._compact=this.options&&this.options.compact,this._container=L.create("div","maplibregl-ctrl mapboxgl-ctrl");const _=L.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return _.target="_blank",_.rel="noopener nofollow",_.href="https://maplibre.org/",_.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),_.setAttribute("rel","noopener nofollow"),this._container.appendChild(_),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){L.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const c=this._container.children;if(c.length){const _=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&_.classList.add("maplibregl-compact","mapboxgl-compact"):_.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class Au{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const _=++this._id;return this._queue.push({callback:c,id:_,cancelled:!1}),_}remove(c){const _=this._currentlyRunning,l=_?this._queue.concat(_):this._queue;for(const h of l)if(h.id===c)return void(h.cancelled=!0)}run(c=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const _=this._currentlyRunning=this._queue;this._queue=[];for(const l of _)if(!l.cancelled&&(l.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const lc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},uu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Ac={showCompass:!0,showZoom:!0,visualizePitch:!1};class gi{constructor(c,_,l=!1){this._clickTolerance=10,this.element=_,this.mouseRotate=new As({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,l&&(this.mousePitch=new Ft({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),L.addEventListener(_,"mousedown",this.mousedown),L.addEventListener(_,"touchstart",this.touchstart,{passive:!1}),L.addEventListener(_,"touchmove",this.touchmove),L.addEventListener(_,"touchend",this.touchend),L.addEventListener(_,"touchcancel",this.reset)}down(c,_){this.mouseRotate.mousedown(c,_),this.mousePitch&&this.mousePitch.mousedown(c,_),L.disableDrag()}move(c,_){const l=this.map,h=this.mouseRotate.mousemoveWindow(c,_);if(h&&h.bearingDelta&&l.setBearing(l.getBearing()+h.bearingDelta),this.mousePitch){const d=this.mousePitch.mousemoveWindow(c,_);d&&d.pitchDelta&&l.setPitch(l.getPitch()+d.pitchDelta)}}off(){const c=this.element;L.removeEventListener(c,"mousedown",this.mousedown),L.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),L.removeEventListener(c,"touchmove",this.touchmove),L.removeEventListener(c,"touchend",this.touchend),L.removeEventListener(c,"touchcancel",this.reset),this.offTemp()}offTemp(){L.enableDrag(),L.removeEventListener(window,"mousemove",this.mousemove),L.removeEventListener(window,"mouseup",this.mouseup)}mousedown(c){this.down(a.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),L.mousePos(this.element,c)),L.addEventListener(window,"mousemove",this.mousemove),L.addEventListener(window,"mouseup",this.mouseup)}mousemove(c){this.move(c,L.mousePos(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=L.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){c.targetTouches.length!==1?this.reset():(this._lastPos=L.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Bl(k,c,_){if(k=new a.LngLat(k.lng,k.lat),c){const l=new a.LngLat(k.lng-360,k.lat),h=new a.LngLat(k.lng+360,k.lat),d=_.locationPoint(k).distSqr(c);_.locationPoint(l).distSqr(c)<d?k=l:_.locationPoint(h).distSqr(c)<d&&(k=h)}for(;Math.abs(k.lng-_.center.lng)>180;){const l=_.locationPoint(k);if(l.x>=0&&l.y>=0&&l.x<=_.width&&l.y<=_.height)break;k.lng>_.center.lng?k.lng-=360:k.lng+=360}return k}const Zt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Yt(k,c,_){const l=k.classList;for(const h in Zt)l.remove(`maplibregl-${_}-anchor-${h}`,`mapboxgl-${_}-anchor-${h}`);l.add(`maplibregl-${_}-anchor-${c}`,`mapboxgl-${_}-anchor-${c}`)}class cn extends a.Evented{constructor(c,_){if(super(),(c instanceof HTMLElement||_)&&(c=a.extend({element:c},_)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment!=="auto"?c.pitchAlignment:this._rotationAlignment,c&&c.element)this._element=c.element,this._offset=a.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=L.create("div"),this._element.setAttribute("aria-label","Map marker");const l=L.createNS("http://www.w3.org/2000/svg","svg"),h=41,d=27;l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height",`${h}px`),l.setAttributeNS(null,"width",`${d}px`),l.setAttributeNS(null,"viewBox",`0 0 ${d} ${h}`);const x=L.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const b=L.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const S=L.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ce of M){const _e=L.createNS("http://www.w3.org/2000/svg","ellipse");_e.setAttributeNS(null,"opacity","0.04"),_e.setAttributeNS(null,"cx","10.5"),_e.setAttributeNS(null,"cy","5.80029008"),_e.setAttributeNS(null,"rx",Ce.rx),_e.setAttributeNS(null,"ry",Ce.ry),S.appendChild(_e)}const B=L.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const V=L.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(V);const $=L.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");const X=L.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(X);const se=L.createNS("http://www.w3.org/2000/svg","g");se.setAttributeNS(null,"transform","translate(6.0, 7.0)"),se.setAttributeNS(null,"fill","#FFFFFF");const ne=L.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ue=L.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#000000"),ue.setAttributeNS(null,"opacity","0.25"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962");const be=L.createNS("http://www.w3.org/2000/svg","circle");be.setAttributeNS(null,"fill","#FFFFFF"),be.setAttributeNS(null,"cx","5.5"),be.setAttributeNS(null,"cy","5.5"),be.setAttributeNS(null,"r","5.4999962"),ne.appendChild(ue),ne.appendChild(be),b.appendChild(S),b.appendChild(B),b.appendChild($),b.appendChild(se),b.appendChild(ne),l.appendChild(b),l.setAttributeNS(null,"height",h*this._scale+"px"),l.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(l),this._offset=a.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",l=>{l.preventDefault()}),this._element.addEventListener("mousedown",l=>{l.preventDefault()}),Yt(this._element,this._anchor,"marker"),this._popup=null}addTo(c){return this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),L.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=a.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const h=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(c){const _=c.code,l=c.charCode||c.keyCode;_!=="Space"&&_!=="Enter"&&l!==32&&l!==13||this.togglePopup()}_onMapClick(c){const _=c.originalEvent.target,l=this._element;this._popup&&(_===l||l.contains(_))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?c.remove():c.addTo(this._map),this):this}_update(c){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Bl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let l="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?l="rotateX(0deg)":this._pitchAlignment==="map"&&(l=`rotateX(${this._map.getPitch()}deg)`),c&&c.type!=="moveend"||(this._pos=this._pos.round()),L.setTransform(this._element,`${Zt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${l} ${_}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const h=this._map.unproject(this._pos),d=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=h.distanceTo(this._lngLat)>20*d?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(c){return this._offset=a.pointGeometry.convert(c),this._update(),this}_onMove(c){if(!this._isDragging){const _=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=_}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(c){this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c&&c!=="auto"?c:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Zr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let qo,Ui=0,$s=!1;const Es={maxWidth:100,unit:"metric"};function Hs(k,c,_){const l=_&&_.maxWidth||100,h=k._container.clientHeight/2,d=k.unproject([0,h]),x=k.unproject([l,h]),b=d.distanceTo(x);if(_&&_.unit==="imperial"){const S=3.2808*b;S>5280?St(c,l,S/5280,k._getUIString("ScaleControl.Miles")):St(c,l,S,k._getUIString("ScaleControl.Feet"))}else _&&_.unit==="nautical"?St(c,l,b/1852,k._getUIString("ScaleControl.NauticalMiles")):b>=1e3?St(c,l,b/1e3,k._getUIString("ScaleControl.Kilometers")):St(c,l,b,k._getUIString("ScaleControl.Meters"))}function St(k,c,_,l){const h=function(d){const x=Math.pow(10,`${Math.floor(d)}`.length-1);let b=d/x;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(S){const M=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*M)/M}(b),x*b}(_);k.style.width=c*(h/_)+"px",k.innerHTML=`${h}&nbsp;${l}`}const Ct={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Vi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ja(k){if(k){if(typeof k=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(k,2)));return{center:new a.pointGeometry(0,0),top:new a.pointGeometry(0,k),"top-left":new a.pointGeometry(c,c),"top-right":new a.pointGeometry(-c,c),bottom:new a.pointGeometry(0,-k),"bottom-left":new a.pointGeometry(c,-c),"bottom-right":new a.pointGeometry(-c,-c),left:new a.pointGeometry(k,0),right:new a.pointGeometry(-k,0)}}if(k instanceof a.pointGeometry||Array.isArray(k)){const c=a.pointGeometry.convert(k);return{center:c,top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}return{center:a.pointGeometry.convert(k.center||[0,0]),top:a.pointGeometry.convert(k.top||[0,0]),"top-left":a.pointGeometry.convert(k["top-left"]||[0,0]),"top-right":a.pointGeometry.convert(k["top-right"]||[0,0]),bottom:a.pointGeometry.convert(k.bottom||[0,0]),"bottom-left":a.pointGeometry.convert(k["bottom-left"]||[0,0]),"bottom-right":a.pointGeometry.convert(k["bottom-right"]||[0,0]),left:a.pointGeometry.convert(k.left||[0,0]),right:a.pointGeometry.convert(k.right||[0,0])}}return Ja(new a.pointGeometry(0,0))}const Ws={supported:y,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends Ei{constructor(k){var c;if(a.PerformanceUtils.mark(a.PerformanceMarkers.create),(k=a.extend({},uu,k)).minZoom!=null&&k.maxZoom!=null&&k.minZoom>k.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(k.minPitch!=null&&k.maxPitch!=null&&k.minPitch>k.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(k.minPitch!=null&&k.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(k.maxPitch!=null&&k.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new _o(k.minZoom,k.maxZoom,k.minPitch,k.maxPitch,k.renderWorldCopies),{bearingSnap:k.bearingSnap}),this._interactive=k.interactive,this._cooperativeGestures=k.cooperativeGestures,this._maxTileCacheSize=k.maxTileCacheSize,this._failIfMajorPerformanceCaveat=k.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=k.preserveDrawingBuffer,this._antialias=k.antialias,this._trackResize=k.trackResize,this._bearingSnap=k.bearingSnap,this._refreshExpiredTiles=k.refreshExpiredTiles,this._fadeDuration=k.fadeDuration,this._crossSourceCollisions=k.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=k.collectResourceTiming,this._renderTaskQueue=new Au,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},lc,k.locale),this._clickTolerance=k.clickTolerance,this._pixelRatio=(c=k.pixelRatio)!==null&&c!==void 0?c:devicePixelRatio,this._requestManager=new U(k.transformRequest),typeof k.container=="string"){if(this._container=document.getElementById(k.container),!this._container)throw new Error(`Container '${k.container}' not found.`)}else{if(!(k.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=k.container}if(k.maxBounds&&this.setMaxBounds(k.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new ac(this,k),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=k.hash&&new fr(typeof k.hash=="string"&&k.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:k.center,zoom:k.zoom,bearing:k.bearing,pitch:k.pitch}),k.bounds&&(this.resize(),this.fitBounds(k.bounds,a.extend({},k.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=k.localIdeographFontFamily,k.style&&this.setStyle(k.style,{localIdeographFontFamily:k.localIdeographFontFamily}),k.attributionControl&&this.addControl(new Ka({customAttribution:k.customAttribution})),k.maplibreLogo&&this.addControl(new Rl,k.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",_=>{this._update(_.dataType==="style"),this.fire(new a.Event(`${_.dataType}data`,_))}),this.on("dataloading",_=>{this.fire(new a.Event(`${_.dataType}dataloading`,_))}),this.on("dataabort",_=>{this.fire(new a.Event("sourcedataabort",_))})}_getMapId(){return this._mapId}addControl(k,c){if(c===void 0&&(c=k.getDefaultPosition?k.getDefaultPosition():"top-right"),!k||!k.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const _=k.onAdd(this);this._controls.push(k);const l=this._controlPositions[c];return c.indexOf("bottom")!==-1?l.insertBefore(_,l.firstChild):l.appendChild(_),this}removeControl(k){if(!k||!k.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(k);return c>-1&&this._controls.splice(c,1),k.onRemove(this),this}hasControl(k){return this._controls.indexOf(k)>-1}calculateCameraOptionsFromTo(k,c,_,l){return l==null&&this.style.terrain&&(l=this.transform.getElevation(_,this.style.terrain)),super.calculateCameraOptionsFromTo(k,c,_,l)}resize(k){const c=this._containerDimensions(),_=c[0],l=c[1];this._resizeCanvas(_,l,this.getPixelRatio()),this.transform.resize(_,l),this.painter.resize(_,l,this.getPixelRatio());const h=!this._moving;return h&&(this.stop(),this.fire(new a.Event("movestart",k)).fire(new a.Event("move",k))),this.fire(new a.Event("resize",k)),h&&this.fire(new a.Event("moveend",k)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(k){const[c,_]=this._containerDimensions();this._pixelRatio=k,this._resizeCanvas(c,_,k),this.painter.resize(c,_,k)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(k){return this.transform.setMaxBounds(a.LngLatBounds.convert(k)),this._update()}setMinZoom(k){if((k=k??-2)>=-2&&k<=this.transform.maxZoom)return this.transform.minZoom=k,this._update(),this.getZoom()<k&&this.setZoom(k),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(k){if((k=k??22)>=this.transform.minZoom)return this.transform.maxZoom=k,this._update(),this.getZoom()>k&&this.setZoom(k),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(k){if((k=k??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(k>=0&&k<=this.transform.maxPitch)return this.transform.minPitch=k,this._update(),this.getPitch()<k&&this.setPitch(k),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(k){if((k=k??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(k>=this.transform.minPitch)return this.transform.maxPitch=k,this._update(),this.getPitch()>k&&this.setPitch(k),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(k){return this.transform.renderWorldCopies=k,this._update()}project(k){return this.transform.locationPoint(a.LngLat.convert(k),this.style&&this.style.terrain)}unproject(k){return this.transform.pointLocation(a.pointGeometry.convert(k),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(k,c,_){if(k==="mouseenter"||k==="mouseover"){let l=!1;return{layer:c,listener:_,delegates:{mousemove:d=>{const x=this.getLayer(c)?this.queryRenderedFeatures(d.point,{layers:[c]}):[];x.length?l||(l=!0,_.call(this,new nr(k,this,d.originalEvent,{features:x}))):l=!1},mouseout:()=>{l=!1}}}}if(k==="mouseleave"||k==="mouseout"){let l=!1;return{layer:c,listener:_,delegates:{mousemove:x=>{(this.getLayer(c)?this.queryRenderedFeatures(x.point,{layers:[c]}):[]).length?l=!0:l&&(l=!1,_.call(this,new nr(k,this,x.originalEvent)))},mouseout:x=>{l&&(l=!1,_.call(this,new nr(k,this,x.originalEvent)))}}}}{const l=h=>{const d=this.getLayer(c)?this.queryRenderedFeatures(h.point,{layers:[c]}):[];d.length&&(h.features=d,_.call(this,h),delete h.features)};return{layer:c,listener:_,delegates:{[k]:l}}}}on(k,c,_){if(_===void 0)return super.on(k,c);const l=this._createDelegatedListener(k,c,_);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[k]=this._delegatedListeners[k]||[],this._delegatedListeners[k].push(l);for(const h in l.delegates)this.on(h,l.delegates[h]);return this}once(k,c,_){if(_===void 0)return super.once(k,c);const l=this._createDelegatedListener(k,c,_);for(const h in l.delegates)this.once(h,l.delegates[h]);return this}off(k,c,_){return _===void 0?super.off(k,c):(this._delegatedListeners&&this._delegatedListeners[k]&&(l=>{const h=this._delegatedListeners[k];for(let d=0;d<h.length;d++){const x=h[d];if(x.layer===c&&x.listener===_){for(const b in x.delegates)this.off(b,x.delegates[b]);return h.splice(d,1),this}}})(),this)}queryRenderedFeatures(k,c){if(!this.style)return[];let _;if(c!==void 0||k===void 0||k instanceof a.pointGeometry||Array.isArray(k)||(c=k,k=void 0),c=c||{},(k=k||[[0,0],[this.transform.width,this.transform.height]])instanceof a.pointGeometry||typeof k[0]=="number")_=[a.pointGeometry.convert(k)];else{const l=a.pointGeometry.convert(k[0]),h=a.pointGeometry.convert(k[1]);_=[l,new a.pointGeometry(h.x,l.y),h,new a.pointGeometry(l.x,h.y),l]}return this.style.queryRenderedFeatures(_,c,this.transform)}querySourceFeatures(k,c){return this.style.querySourceFeatures(k,c)}setStyle(k,c){return(c=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&k?(this._diffStyle(k,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._updateStyle(k,c))}setTransformRequest(k){return this._requestManager.setTransformRequest(k),this}_getUIString(k){const c=this._locale[k];if(c==null)throw new Error(`Missing UI string '${k}'`);return c}_updateStyle(k,c){return this.style&&(this.style.setEventedParent(null),this.style._remove()),k?(this.style=new Se(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof k=="string"?this.style.loadURL(k):this.style.loadJSON(k),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Se(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(k,c){if(typeof k=="string"){const _=this._requestManager.transformRequest(k,a.ResourceType.Style);a.getJSON(_,(l,h)=>{l?this.fire(new a.ErrorEvent(l)):h&&this._updateDiff(h,c)})}else typeof k=="object"&&this._updateDiff(k,c)}_updateDiff(k,c){try{this.style.setState(k)&&this._update(!0)}catch(_){a.warnOnce(`Unable to perform style diff: ${_.message||_.error||_}.  Rebuilding the style from scratch.`),this._updateStyle(k,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")}addSource(k,c){return this._lazyInitEmptyStyle(),this.style.addSource(k,c),this._update(!0)}isSourceLoaded(k){const c=this.style&&this.style.sourceCaches[k];if(c!==void 0)return c.loaded();this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${k}'`)))}setTerrain(k){return this.style.setTerrain(k),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const k=this.style&&this.style.sourceCaches;for(const c in k){const _=k[c]._tiles;for(const l in _){const h=_[l];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}addSourceType(k,c,_){return this._lazyInitEmptyStyle(),this.style.addSourceType(k,c,_)}removeSource(k){return this.style.removeSource(k),this._update(!0)}getSource(k){return this.style.getSource(k)}addImage(k,c,{pixelRatio:_=1,sdf:l=!1,stretchX:h,stretchY:d,content:x}={}){if(this._lazyInitEmptyStyle(),c instanceof HTMLImageElement||a.isImageBitmap(c)){const{width:b,height:S,data:M}=a.exported.getImageData(c);this.style.addImage(k,{data:new a.RGBAImage({width:b,height:S},M),pixelRatio:_,stretchX:h,stretchY:d,content:x,sdf:l,version:0})}else{if(c.width===void 0||c.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:b,height:S,data:M}=c,B=c;this.style.addImage(k,{data:new a.RGBAImage({width:b,height:S},new Uint8Array(M)),pixelRatio:_,stretchX:h,stretchY:d,content:x,sdf:l,version:0,userImage:B}),B.onAdd&&B.onAdd(this,k)}}}updateImage(k,c){const _=this.style.getImage(k);if(!_)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=c instanceof HTMLImageElement||a.isImageBitmap(c)?a.exported.getImageData(c):c,{width:h,height:d,data:x}=l;if(h===void 0||d===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==_.data.width||d!==_.data.height)return this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(c instanceof HTMLImageElement||a.isImageBitmap(c));_.data.replace(x,b),this.style.updateImage(k,_)}hasImage(k){return k?!!this.style.getImage(k):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(k){this.style.removeImage(k)}loadImage(k,c){a.getImage(this._requestManager.transformRequest(k,a.ResourceType.Image),c)}listImages(){return this.style.listImages()}addLayer(k,c){return this._lazyInitEmptyStyle(),this.style.addLayer(k,c),this._update(!0)}moveLayer(k,c){return this.style.moveLayer(k,c),this._update(!0)}removeLayer(k){return this.style.removeLayer(k),this._update(!0)}getLayer(k){return this.style.getLayer(k)}setLayerZoomRange(k,c,_){return this.style.setLayerZoomRange(k,c,_),this._update(!0)}setFilter(k,c,_={}){return this.style.setFilter(k,c,_),this._update(!0)}getFilter(k){return this.style.getFilter(k)}setPaintProperty(k,c,_,l={}){return this.style.setPaintProperty(k,c,_,l),this._update(!0)}getPaintProperty(k,c){return this.style.getPaintProperty(k,c)}setLayoutProperty(k,c,_,l={}){return this.style.setLayoutProperty(k,c,_,l),this._update(!0)}getLayoutProperty(k,c){return this.style.getLayoutProperty(k,c)}setLight(k,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(k,c),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(k,c){return this.style.setFeatureState(k,c),this._update()}removeFeatureState(k,c){return this.style.removeFeatureState(k,c),this._update()}getFeatureState(k){return this.style.getFeatureState(k)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let k=0,c=0;return this._container&&(k=this._container.clientWidth||400,c=this._container.clientHeight||300),[k,c]}_setupContainer(){const k=this._container;k.classList.add("maplibregl-map","mapboxgl-map");const c=this._canvasContainer=L.create("div","maplibregl-canvas-container mapboxgl-canvas-container",k);this._interactive&&c.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=L.create("canvas","maplibregl-canvas mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const _=this._containerDimensions();this._resizeCanvas(_[0],_[1],this.getPixelRatio());const l=this._controlContainer=L.create("div","maplibregl-control-container mapboxgl-control-container",k),h=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(d=>{h[d]=L.create("div",`maplibregl-ctrl-${d} mapboxgl-ctrl-${d}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const k=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=L.create("div","maplibregl-cooperative-gesture-screen",k);let c="Control",_=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(_=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map",c="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${_}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",l=>{l.key===c&&(this._metaPress=!0)}),document.addEventListener("keyup",l=>{l.key===c&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",l=>{this._onCooperativeGesture(l,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(k,c,_){this._canvas.width=_*k,this._canvas.height=_*c,this._canvas.style.width=`${k}px`,this._canvas.style.height=`${c}px`}_setupPainter(){const k=a.extend({},y.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._canvas.getContext("webgl",k)||this._canvas.getContext("experimental-webgl",k);c?(this.painter=new wr(c,this.transform),a.exported$1.testSupport(c)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(k){k.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:k}))}_contextRestored(k){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:k}))}_onMapScroll(k){if(k.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(k,c,_){return!c&&_<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(k){return this.style?(this._styleDirty=this._styleDirty||k,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(k){return this._update(),this._renderTaskQueue.add(k)}_cancelRenderFrame(k){this._renderTaskQueue.remove(k)}_render(k){let c,_=0;const l=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(c=l.createQueryEXT(),l.beginQueryEXT(l.TIME_ELAPSED_EXT,c),_=a.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(k),this._removed)return;let h=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const x=this.transform.zoom,b=a.exported.now();this.style.zoomHistory.update(x,b);const S=new a.EvaluationParameters(x,{now:b,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),M=S.crossFadingFactor();M===1&&M===this._crossFadingFactor||(h=!0,this._crossFadingFactor=M),this.style.update(S)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.load),this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||h)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const x=a.exported.now()-_;l.endQueryEXT(l.TIME_ELAPSED_EXT,c),setTimeout(()=>{const b=l.getQueryObjectEXT(c,l.QUERY_RESULT_EXT)/1e6;l.deleteQueryEXT(c),this.fire(new a.Event("gpu-timing-frame",{cpuTime:x,gpuTime:b}))},50)}if(this.listens("gpu-timing-layer")){const x=this.painter.collectGpuTimers();setTimeout(()=>{const b=this.painter.queryGpuTimers(x);this.fire(new a.Event("gpu-timing-layer",{layerTimes:b}))},50)}const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const k=this.painter.context.gl.getExtension("WEBGL_lose_context");k&&k.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),L.remove(this._canvasContainer),L.remove(this._controlContainer),this._cooperativeGestures&&L.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),a.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=a.exported.frame(k=>{a.PerformanceUtils.frame(k),this._frame=null,this._render(k)}))}_onWindowOnline(){this._update()}_onWindowResize(k){this._trackResize&&this.resize({originalEvent:k})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(k){this._showTileBoundaries!==k&&(this._showTileBoundaries=k,this._update())}get showPadding(){return!!this._showPadding}set showPadding(k){this._showPadding!==k&&(this._showPadding=k,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(k){this._showCollisionBoxes!==k&&(this._showCollisionBoxes=k,k?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(k){this._showOverdrawInspector!==k&&(this._showOverdrawInspector=k,this._update())}get repaint(){return!!this._repaint}set repaint(k){this._repaint!==k&&(this._repaint=k,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(k){this._vertices=k,this._update()}_setCacheLimits(k,c){a.setCacheLimits(k,c)}get version(){return"2.4.0"}},NavigationControl:class{constructor(k){this.options=a.extend({},Ac,k),this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",c=>this._map.zoomIn({},{originalEvent:c})),L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",c=>this._map.zoomOut({},{originalEvent:c})),L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",c=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:c}):this._map.resetNorth({},{originalEvent:c})}),this._compassIcon=L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const k=this._map.getZoom(),c=k===this._map.getMaxZoom(),_=k===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const k=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=k}onAdd(k){return this._map=k,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new gi(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){L.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(k,c){const _=L.create("button",k,this._container);return _.type="button",_.addEventListener("click",c),_}_setButtonTitle(k,c){const _=this._map._getUIString(`NavigationControl.${c}`);k.title=_,k.setAttribute("aria-label",_)}},GeolocateControl:class extends a.Evented{constructor(k){super(),this.options=a.extend({},Zr,k),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(k){var c;return this._map=k,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,qo!==void 0?c(qo):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(_=>{qo=_.state!=="denied",c(qo)}):(qo=!!window.navigator.geolocation,c(qo)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),L.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ui=0,$s=!1}_isOutOfMapMaxBounds(k){const c=this._map.getMaxBounds(),_=k.coords;return c&&(_.longitude<c.getWest()||_.longitude>c.getEast()||_.latitude<c.getSouth()||_.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(k){if(this._map){if(this._isOutOfMapMaxBounds(k))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",k)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=k,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(k),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(k),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",k)),this._finish()}}_updateCamera(k){const c=new a.LngLat(k.coords.longitude,k.coords.latitude),_=k.coords.accuracy,l=this._map.getBearing(),h=a.extend({bearing:l},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(_),h,{geolocateSource:!0})}_updateMarker(k){if(k){const c=new a.LngLat(k.coords.longitude,k.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=k.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const k=this._map._container.clientHeight/2,c=this._map.unproject([0,k]),_=this._map.unproject([1,k]),l=c.distanceTo(_),h=Math.ceil(2*this._accuracy/l);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(k){if(this._map){if(this.options.trackUserLocation)if(k.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(k.code===3&&$s)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",k)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(k){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=L.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",k===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new cn(this._dotElement),this._circleElement=L.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new cn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ui--,$s=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let k;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ui++,Ui>1?(k={maximumAge:6e5,timeout:0},$s=!0):(k=this.options.positionOptions,$s=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,k)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ka,LogoControl:Rl,ScaleControl:class{constructor(k){this.options=a.extend({},Es,k),a.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Hs(this._map,this._container,this.options)}onAdd(k){return this._map=k,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",k.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){L.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(k){this.options.unit=k,Hs(this._map,this._container,this.options)}},FullscreenControl:class{constructor(k){this._fullscreen=!1,k&&k.container&&(k.container instanceof HTMLElement?this._container=k.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(k){return this._map=k,this._container||(this._container=this._map.getContainer()),this._controlContainer=L.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){L.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const k=this._fullscreenButton=L.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",k).setAttribute("aria-hidden","true"),k.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const k=this._getTitle();this._fullscreenButton.setAttribute("aria-label",k),this._fullscreenButton.title=k}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(k){this.options=k,a.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(k){return this._map=k,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=L.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),L.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){L.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends a.Evented{constructor(k){super(),this.options=a.extend(Object.create(Ct),k),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(k){return this._map&&this.remove(),this._map=k,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&L.remove(this._content),this._container&&(L.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(k){return this._lngLat=a.LngLat.convert(k),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(k){return this.setDOMContent(document.createTextNode(k))}setHTML(k){const c=document.createDocumentFragment(),_=document.createElement("body");let l;for(_.innerHTML=k;l=_.firstChild,l;)c.appendChild(l);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(k){return this.options.maxWidth=k,this._update(),this}setDOMContent(k){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=L.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(k),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(k){this._container&&this._container.classList.add(k)}removeClassName(k){this._container&&this._container.classList.remove(k)}setOffset(k){return this.options.offset=k,this._update(),this}toggleClassName(k){if(this._container)return this._container.classList.toggle(k)}_createCloseButton(){this.options.closeButton&&(this._closeButton=L.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(k){this._update(k.point)}_onMouseMove(k){this._update(k.point)}_onDrag(k){this._update(k.point)}_update(k){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=L.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=L.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(d=>this._container.classList.add(d)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Bl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!k))return;const c=this._pos=this._trackPointer&&k?k:this._map.project(this._lngLat);let _=this.options.anchor;const l=Ja(this.options.offset);if(!_){const d=this._container.offsetWidth,x=this._container.offsetHeight;let b;b=c.y+l.bottom.y<x?["top"]:c.y>this._map.transform.height-x?["bottom"]:[],c.x<d/2?b.push("left"):c.x>this._map.transform.width-d/2&&b.push("right"),_=b.length===0?"bottom":b.join("-")}const h=c.add(l[_]).round();L.setTransform(this._container,`${Zt[_]} translate(${h.x}px,${h.y}px)`),Yt(this._container,_,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const k=this._container.querySelector(Vi);k&&k.focus()}_onClose(){this.remove()}},Marker:cn,Style:Se,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,AJAXError:a.AJAXError,config:a.config,CanvasSource:In,GeoJSONSource:fn,ImageSource:bt,RasterDEMTileSource:Et,RasterTileSource:gt,VectorTileSource:Ye,VideoSource:Kt,prewarm:function(){li().acquire(vt)},clearPrewarmedResources:function(){const k=yi;k&&(k.isPreloaded()&&k.numActive()===1?(k.release(vt),yi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return ei.workerCount},set workerCount(k){ei.workerCount=k},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(k){a.config.MAX_PARALLEL_IMAGE_REQUESTS=k},clearStorage(k){a.clearTileCache(k)},workerUrl:"",addProtocol(k,c){a.config.REGISTERED_PROTOCOLS[k]=c},removeProtocol(k){delete a.config.REGISTERED_PROTOCOLS[k]}};return us.extend(Ws,{isSafari:a.isSafari,getPerformanceMetrics:a.PerformanceUtils.getPerformanceMetrics}),Ws});var u=r;return u})})(sB);var JJ=sB.exports;const eee=Z_(JJ),tee="modulepreload",nee=function(t){return"/"+t},wP={},iee=function(e,n,i){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=nee(s),s in wP)return;wP[s]=!0;const u=s.endsWith(".css"),a=u?'[rel="stylesheet"]':"";if(!!i)for(let I=r.length-1;I>=0;I--){const P=r[I];if(P.href===s&&(!u||P.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const w=document.createElement("link");if(w.rel=u?"stylesheet":tee,u||(w.as="script",w.crossOrigin=""),w.href=s,document.head.appendChild(w),u)return new Promise((I,P)=>{w.addEventListener("load",I),w.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=s,window.dispatchEvent(u),!u.defaultPrevented)throw s})},ree=_t.createContext(null);function see(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,i=Array.isArray(t)?t[1]:t?t.y:0,r=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===r&&i===s}function Eu(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Eu(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const r of n)if(!e.hasOwnProperty(r)||!Eu(t[r],e[r]))return!1;return!0}return!1}function oee(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function bP(t,e){if(!t.getProjection)return;const n=t.getProjection(),i=e.getProjection();Eu(n,i)||e.setProjection(n)}function EP(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function TP(t,e){const n=e.viewState||e;let i=!1;if("longitude"in n&&"latitude"in n){const r=t.center;t.center=new r.constructor(n.longitude,n.latitude),i=i||r!==t.center}if("zoom"in n){const r=t.zoom;t.zoom=n.zoom,i=i||r!==t.zoom}if("bearing"in n){const r=t.bearing;t.bearing=n.bearing,i=i||r!==t.bearing}if("pitch"in n){const r=t.pitch;t.pitch=n.pitch,i=i||r!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(i=!0,t.padding=n.padding),i}const aee=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function SP(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const i of t.layers)e[i.id]=i;const n=t.layers.map(i=>{let r=null;"interactive"in i&&(r=Object.assign({},i),delete r.interactive);const s=e[i.ref];if(s){r=r||Object.assign({},i),delete r.ref;for(const u of aee)u in s&&(r[u]=s[u])}return r||i});return{...t,layers:n}}const MP={version:8,sources:{},layers:[]},CP={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},jx={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},PP={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},lee=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Aee=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Hf{constructor(e,n,i){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=r=>{const s=this.props[PP[r.type]];s?s(r):r.type==="error"&&console.error(r.error)},this._onPointerEvent=r=>{(r.type==="mousemove"||r.type==="mouseout")&&this._updateHover(r);const s=this.props[CP[r.type]];s&&(this.props.interactiveLayerIds&&r.type!=="mouseover"&&r.type!=="mouseout"&&(r.features=this._hoveredFeatures||this._queryRenderedFeatures(r.point)),s(r),delete r.features)},this._onCameraEvent=r=>{if(!this._internalUpdate){const s=this.props[jx[r.type]];s&&s(r)}r.type in this._deferredEvents&&(this._deferredEvents[r.type]=!1)},this._MapClass=e,this.props=n,this._initialize(i)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const i=this._updateSettings(e,n);i&&this._createShadowTransform(this._map);const r=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(i||r||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const i=Hf.savedMaps.pop();if(!i)return null;const r=i.map,s=r.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);r._container=n;const u=r._resizeObserver;u&&(u.disconnect(),u.observe(n)),i.setProps({...e,styleDiffing:!1}),r.resize();const{initialViewState:a}=e;return a&&(a.bounds?r.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):i._updateViewState(a,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",()=>r.fire("load")),r._update(),i}_initialize(e){const{props:n}=this,{mapStyle:i=MP}=n,r={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||uee()||null,container:e,style:SP(i)},s=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const I=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=I,n.gl)}const u=new this._MapClass(r);s.padding&&u.setPadding(s.padding),n.cursor&&(u.getCanvas().style.cursor=n.cursor),this._createShadowTransform(u);const a=u._render;u._render=I=>{this._inRender=!0,a.call(u,I),this._inRender=!1};const y=u._renderTaskQueue.run;u._renderTaskQueue.run=I=>{y.call(u._renderTaskQueue,I),this._onBeforeRepaint()},u.on("render",()=>this._onAfterRepaint());const w=u.fire;u.fire=this._fireEvent.bind(this,w),u.on("resize",()=>{this._renderTransform.resize(u.transform.width,u.transform.height)}),u.on("styledata",()=>{this._updateStyleComponents(this.props,{}),bP(u.transform,this._renderTransform)}),u.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const I in CP)u.on(I,this._onPointerEvent);for(const I in jx)u.on(I,this._onCameraEvent);for(const I in PP)u.on(I,this._onEvent);this._map=u}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n?.remove(),Hf.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=oee(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const i=this._map;if(n.width!==i.transform.width||n.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const i=this._map,r=this._renderTransform,{zoom:s,pitch:u,bearing:a}=r,y=i.isMoving();y&&(r.cameraElevationReference="sea");const w=TP(r,{...EP(i.transform),...e});if(y&&(r.cameraElevationReference="ground"),w&&n){const I=this._deferredEvents;I.move=!0,I.zoom||(I.zoom=s!==r.zoom),I.rotate||(I.rotate=a!==r.bearing),I.pitch||(I.pitch=u!==r.pitch)}return y||TP(i.transform,e),w}_updateSettings(e,n){const i=this._map;let r=!1;for(const s of lee)if(s in e&&!Eu(e[s],n[s])){r=!0;const u=i[`set${s[0].toUpperCase()}${s.slice(1)}`];u?.call(i,e[s])}return r}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:i=MP,styleDiffing:r=!0}=e,s={diff:r};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(SP(i),s),!0}return!1}_updateStyleComponents(e,n){const i=this._map;let r=!1;return i.isStyleLoaded()&&("light"in e&&i.setLight&&!Eu(e.light,n.light)&&(r=!0,i.setLight(e.light)),"fog"in e&&i.setFog&&!Eu(e.fog,n.fog)&&(r=!0,i.setFog(e.fog)),"terrain"in e&&i.setTerrain&&!Eu(e.terrain,n.terrain)&&(!e.terrain||i.getSource(e.terrain.source))&&(r=!0,i.setTerrain(e.terrain))),r}_updateHandlers(e,n){var i,r;const s=this._map;let u=!1;for(const a of Aee){const y=(i=e[a])!==null&&i!==void 0?i:!0,w=(r=n[a])!==null&&r!==void 0?r:!0;Eu(y,w)||(u=!0,y?s[a].enable(y):s[a].disable())}return u}_queryRenderedFeatures(e){const n=this._map,i=n.transform,{interactiveLayerIds:r=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=i}}_updateHover(e){var n;const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const s=e.type,u=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),y=a.length>0;!y&&u&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,y&&!u&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,i){const r=this._map,s=r.transform,u=typeof n=="string"?n:n.type;return u==="move"&&this._updateViewState(this.props,!1),u in jx&&(typeof n=="object"&&(n.viewState=EP(s)),this._map.isMoving())?(r.transform=this._renderTransform,e.call(r,n,i),r.transform=s,r):(e.call(r,n,i),r)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const i in this._deferredEvents)this._deferredEvents[i]&&e.fire(i);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{bP(this._renderTransform,n),e.transform=n}}}Hf.savedMaps=[];function uee(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const cee=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function hee(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:i=>{const r=e.transform;e.transform=t.transform;const s=e.project(i);return e.transform=r,s},unproject:i=>{const r=e.transform;e.transform=t.transform;const s=e.unproject(i);return e.transform=r,s},queryTerrainElevation:(i,r)=>{const s=e.transform;e.transform=t.transform;const u=e.queryTerrainElevation(i,r);return e.transform=s,u},queryRenderedFeatures:(i,r)=>{const s=e.transform;e.transform=t.transform;const u=e.queryRenderedFeatures(i,r);return e.transform=s,u}};for(const i of fee(e))!(i in n)&&!cee.includes(i)&&(n[i]=e[i].bind(e));return n}function fee(t){const e=new Set;let n=t;for(;n;){for(const i of Object.getOwnPropertyNames(n))i[0]!=="_"&&typeof t[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&e.add(i);n=Object.getPrototypeOf(n)}return Array.from(e)}const dee=typeof document<"u"?_t.useLayoutEffect:_t.useEffect,pee=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function gee(t,e){for(const i of pee)i in e&&(t[i]=e[i]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,i=>{i&&console.error(i)},!1)}const v2=_t.createContext(null);function mee(t,e,n){const i=_t.useContext(ree),[r,s]=_t.useState(null),u=_t.useRef(),{current:a}=_t.useRef({mapLib:null,map:null});_t.useEffect(()=>{const I=t.mapLib;let P=!0,L;return Promise.resolve(I||n).then(U=>{if(!P)return;if(!U)throw new Error("Invalid mapLib");const Q="Map"in U?U:U.default;if(!Q.Map)throw new Error("Invalid mapLib");if(gee(Q,t),!Q.supported||Q.supported(t))t.reuseMaps&&(L=Hf.reuse(t,u.current)),L||(L=new Hf(Q.Map,t,u.current)),a.map=hee(L),a.mapLib=Q,s(L),i?.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(U=>{const{onError:Q}=t;Q?Q({type:"error",target:null,originalEvent:null,error:U}):console.error(U)}),()=>{P=!1,L&&(i?.onMapUnmount(t.id),t.reuseMaps?L.recycle():L.destroy())}},[]),dee(()=>{r&&r.setProps(t)}),_t.useImperativeHandle(e,()=>a.map,[r]);const y=_t.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),w={height:"100%"};return _t.createElement("div",{id:t.id,ref:u,style:y},r&&_t.createElement(v2.Provider,{value:a},_t.createElement("div",{"mapboxgl-children":"",style:w},t.children)))}const yee=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function l0(t,e){if(!t||!e)return;const n=t.style;for(const i in e){const r=e[i];Number.isFinite(r)&&!yee.test(i)?n[i]=`${r}px`:n[i]=r}}function _ee(t,e){const{map:n,mapLib:i}=_t.useContext(v2),r=_t.useRef({props:t});r.current.props=t;const s=_t.useMemo(()=>{let Z=!1;_t.Children.forEach(t.children,te=>{te&&(Z=!0)});const ae={...t,element:Z?document.createElement("div"):null},Y=new i.Marker(ae);return Y.setLngLat([t.longitude,t.latitude]),Y.getElement().addEventListener("click",te=>{var re,de;(de=(re=r.current.props).onClick)===null||de===void 0||de.call(re,{type:"click",target:Y,originalEvent:te})}),Y.on("dragstart",te=>{var re,de;const ve=te;ve.lngLat=s.getLngLat(),(de=(re=r.current.props).onDragStart)===null||de===void 0||de.call(re,ve)}),Y.on("drag",te=>{var re,de;const ve=te;ve.lngLat=s.getLngLat(),(de=(re=r.current.props).onDrag)===null||de===void 0||de.call(re,ve)}),Y.on("dragend",te=>{var re,de;const ve=te;ve.lngLat=s.getLngLat(),(de=(re=r.current.props).onDragEnd)===null||de===void 0||de.call(re,ve)}),Y},[]);_t.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:u,latitude:a,offset:y,style:w,draggable:I=!1,popup:P=null,rotation:L=0,rotationAlignment:U="auto",pitchAlignment:Q="auto"}=t;return _t.useEffect(()=>{l0(s.getElement(),w)},[w]),_t.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==u||s.getLngLat().lat!==a)&&s.setLngLat([u,a]),y&&!see(s.getOffset(),y)&&s.setOffset(y),s.isDraggable()!==I&&s.setDraggable(I),s.getRotation()!==L&&s.setRotation(L),s.getRotationAlignment()!==U&&s.setRotationAlignment(U),s.getPitchAlignment()!==Q&&s.setPitchAlignment(Q),s.getPopup()!==P&&s.setPopup(P),$E.createPortal(t.children,s.getElement())}_t.memo(_t.forwardRef(_ee));function IP(t){return new Set(t?t.trim().split(/\s+/):[])}function vee(t,e){const{map:n,mapLib:i}=_t.useContext(v2),r=_t.useMemo(()=>document.createElement("div"),[]),s=_t.useRef({props:t});s.current.props=t;const u=_t.useMemo(()=>{const a={...t},y=new i.Popup(a);return y.setLngLat([t.longitude,t.latitude]),y.once("open",w=>{var I,P;(P=(I=s.current.props).onOpen)===null||P===void 0||P.call(I,w)}),y},[]);if(_t.useEffect(()=>{const a=y=>{var w,I;(I=(w=s.current.props).onClose)===null||I===void 0||I.call(w,y)};return u.on("close",a),u.setDOMContent(r).addTo(n.getMap()),()=>{u.off("close",a),u.isOpen()&&u.remove()}},[]),_t.useEffect(()=>{l0(u.getElement(),t.style)},[t.style]),_t.useImperativeHandle(e,()=>u,[]),u.isOpen()&&((u.getLngLat().lng!==t.longitude||u.getLngLat().lat!==t.latitude)&&u.setLngLat([t.longitude,t.latitude]),t.offset&&!Eu(u.options.offset,t.offset)&&u.setOffset(t.offset),(u.options.anchor!==t.anchor||u.options.maxWidth!==t.maxWidth)&&(u.options.anchor=t.anchor,u.setMaxWidth(t.maxWidth)),u.options.className!==t.className)){const a=IP(u.options.className),y=IP(t.className);for(const w of a)y.has(w)||u.removeClassName(w);for(const w of y)a.has(w)||u.addClassName(w);u.options.className=t.className}return $E.createPortal(t.children,r)}_t.memo(_t.forwardRef(vee));function qg(t,e,n,i){const r=_t.useContext(v2),s=_t.useMemo(()=>t(r),[]);return _t.useEffect(()=>{const u=i||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,y=typeof n=="function"?n:typeof e=="function"?e:null,{map:w}=r;return w.hasControl(s)||(w.addControl(s,u?.position),a&&a(r)),()=>{y&&y(r),w.hasControl(s)&&w.removeControl(s)}},[]),s}function xee(t){const e=qg(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return _t.useEffect(()=>{l0(e._container,t.style)},[t.style]),null}_t.memo(xee);function wee(t){const e=qg(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return _t.useEffect(()=>{l0(e._controlContainer,t.style)},[t.style]),null}_t.memo(wee);function bee(t,e){const n=_t.useRef({props:t}),i=qg(({mapLib:r})=>{const s=new r.GeolocateControl(t),u=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||u(a)},s.on("geolocate",a=>{var y,w;(w=(y=n.current.props).onGeolocate)===null||w===void 0||w.call(y,a)}),s.on("error",a=>{var y,w;(w=(y=n.current.props).onError)===null||w===void 0||w.call(y,a)}),s.on("outofmaxbounds",a=>{var y,w;(w=(y=n.current.props).onOutOfMaxBounds)===null||w===void 0||w.call(y,a)}),s.on("trackuserlocationstart",a=>{var y,w;(w=(y=n.current.props).onTrackUserLocationStart)===null||w===void 0||w.call(y,a)}),s.on("trackuserlocationend",a=>{var y,w;(w=(y=n.current.props).onTrackUserLocationEnd)===null||w===void 0||w.call(y,a)}),s},{position:t.position});return n.current.props=t,_t.useImperativeHandle(e,()=>i,[]),_t.useEffect(()=>{l0(i._container,t.style)},[t.style]),null}_t.memo(_t.forwardRef(bee));function Eee(t){const e=qg(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return _t.useEffect(()=>{l0(e._container,t.style)},[t.style]),null}_t.memo(Eee);function Tee(t){const e=qg(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=_t.useRef(t),i=n.current;n.current=t;const{style:r}=t;return t.maxWidth!==void 0&&t.maxWidth!==i.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==i.unit&&e.setUnit(t.unit),_t.useEffect(()=>{l0(e._container,r)},[r]),null}_t.memo(Tee);const See=iee(()=>import("./__vite-optional-peer-dep_mapbox-gl_react-map-gl-b25bb000.js"),[]),Mee=(()=>_t.forwardRef(function(e,n){return mee(e,n,See)}))(),Cee=8,Pee="Positron",Iee={},kee={carto:{type:"vector",url:"https://tiles.basemaps.cartocdn.com/vector/carto.streets/v1/tiles.json"}},Lee="https://tiles.basemaps.cartocdn.com/gl/positron-gl-style/sprite",Dee="https://tiles.basemaps.cartocdn.com/fonts/{fontstack}/{range}.pbf",Ree=[{id:"waterway_label",type:"symbol",source:"carto","source-layer":"waterway",filter:["all",["has","name"],["==","class","river"]],layout:{"text-field":"{name_en}","text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-placement":"line","symbol-spacing":100,"symbol-avoid-edges":!1,"text-size":27,"text-padding":2,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-offset":[0,-.2],"text-letter-spacing":0,"text-keep-upright":!0},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"watername_ocean",type:"symbol",source:"carto","source-layer":"water_name",minzoom:0,maxzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","ocean"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":27,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":0}},{id:"watername_sea",type:"symbol",source:"carto","source-layer":"water_name",minzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","sea"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":27,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":0}},{id:"watername_lake",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","Point"],["==","class","lake"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"point","text-size":27,"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto"},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":1}},{id:"watername_lake_line",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","LineString"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"line","text-size":27,"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-spacing":350,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-line-height":1.2},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":1}},{id:"place_city_r6",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",6]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,12],[9,13],[10,14],[13,17],[14,20]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_r5",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",0],["<=","rank",5]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,14],[10,16],[13,19],[14,22]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",["!has","capital"],["!in","class","country","state"],[">=","rank",0],["<=","rank",7]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2]},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_capital_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",[">","capital",0]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"poi_stadium",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["in","class","stadium","cemetery","attraction"],["<=","rank",3]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"poi_park",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["==","class","park"]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"roadname_minor",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:16,filter:["all",["in","class","minor","service"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":9,"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_sec",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:15,filter:["all",["in","class","secondary","tertiary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,9],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_pri",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:14,filter:["all",["in","class","primary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[14,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_major",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:13,filter:["all",["in","class","trunk","motorway"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[13,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}}],Bee="voyager",zee="Carto",Oee={version:Cee,name:Pee,metadata:Iee,sources:kee,sprite:Lee,glyphs:Dee,layers:Ree,id:Bee,owner:zee};function bf(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Fee(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ET(t){let e,n,i;t.length!==2?(e=bf,n=(a,y)=>bf(t(a),y),i=(a,y)=>t(a)-y):(e=t===bf||t===Fee?t:Nee,n=t,i=t);function r(a,y,w=0,I=a.length){if(w<I){if(e(y,y)!==0)return I;do{const P=w+I>>>1;n(a[P],y)<0?w=P+1:I=P}while(w<I)}return w}function s(a,y,w=0,I=a.length){if(w<I){if(e(y,y)!==0)return I;do{const P=w+I>>>1;n(a[P],y)<=0?w=P+1:I=P}while(w<I)}return w}function u(a,y,w=0,I=a.length){const P=r(a,y,w,I-1);return P>w&&i(a[P-1],y)>-i(a[P],y)?P-1:P}return{left:r,center:u,right:s}}function Nee(){return 0}function Uee(t){return t===null?NaN:+t}function*Vee(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(i=+i)>=i&&(yield i)}}const Gee=ET(bf),jee=Gee.right;ET(Uee).center;const aB=jee;function TT(t,e){let n,i;if(e===void 0)for(const r of t)r!=null&&(n===void 0?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));else{let r=-1;for(let s of t)(s=e(s,++r,t))!=null&&(n===void 0?s>=s&&(n=i=s):(n>s&&(n=s),i<s&&(i=s)))}return[n,i]}function $ee(t=bf){if(t===bf)return lB;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const i=t(e,n);return i||i===0?i:(t(n,n)===0)-(t(e,e)===0)}}function lB(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const Hee=Math.sqrt(50),Wee=Math.sqrt(10),Qee=Math.sqrt(2);function o_(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),u=s>=Hee?10:s>=Wee?5:s>=Qee?2:1;let a,y,w;return r<0?(w=Math.pow(10,-r)/u,a=Math.round(t*w),y=Math.round(e*w),a/w<t&&++a,y/w>e&&--y,w=-w):(w=Math.pow(10,r)*u,a=Math.round(t/w),y=Math.round(e/w),a*w<t&&++a,y*w>e&&--y),y<a&&.5<=n&&n<2?o_(t,e,n*2):[a,y,w]}function A0(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const i=e<t,[r,s,u]=i?o_(e,t,n):o_(t,e,n);if(!(s>=r))return[];const a=s-r+1,y=new Array(a);if(i)if(u<0)for(let w=0;w<a;++w)y[w]=(s-w)/-u;else for(let w=0;w<a;++w)y[w]=(s-w)*u;else if(u<0)for(let w=0;w<a;++w)y[w]=(r+w)/-u;else for(let w=0;w<a;++w)y[w]=(r+w)*u;return y}function Jb(t,e,n){return e=+e,t=+t,n=+n,o_(t,e,n)[2]}function e3(t,e,n){e=+e,t=+t,n=+n;const i=e<t,r=i?Jb(e,t,n):Jb(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}function t3(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function kP(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function AB(t,e,n=0,i=1/0,r){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(t.length-1,i)),!(n<=e&&e<=i))return t;for(r=r===void 0?lB:$ee(r);i>n;){if(i-n>600){const y=i-n+1,w=e-n+1,I=Math.log(y),P=.5*Math.exp(2*I/3),L=.5*Math.sqrt(I*P*(y-P)/y)*(w-y/2<0?-1:1),U=Math.max(n,Math.floor(e-w*P/y+L)),Q=Math.min(i,Math.floor(e+(y-w)*P/y+L));AB(t,e,U,Q,r)}const s=t[e];let u=n,a=i;for(Kd(t,n,e),r(t[i],s)>0&&Kd(t,n,i);u<a;){for(Kd(t,u,a),++u,--a;r(t[u],s)<0;)++u;for(;r(t[a],s)>0;)--a}r(t[n],s)===0?Kd(t,n,a):(++a,Kd(t,a,i)),a<=e&&(n=a+1),e<=a&&(i=a-1)}return t}function Kd(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function qee(t,e,n){if(t=Float64Array.from(Vee(t,n)),!(!(i=t.length)||isNaN(e=+e))){if(e<=0||i<2)return kP(t);if(e>=1)return t3(t);var i,r=(i-1)*e,s=Math.floor(r),u=t3(AB(t,s).subarray(0,s+1)),a=kP(t.subarray(s+1));return u+(a-u)*(r-s)}}function ST(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(r);++i<r;)s[i]=t+i*n;return s}var Zee={value:()=>{}};function uB(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new ny(n)}function ny(t){this._=t}function Yee(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}ny.prototype=uB.prototype={constructor:ny,on:function(t,e){var n=this._,i=Yee(t+"",n),r,s=-1,u=i.length;if(arguments.length<2){for(;++s<u;)if((r=(t=i[s]).type)&&(r=Xee(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<u;)if(r=(t=i[s]).type)n[r]=LP(n[r],t.name,e);else if(e==null)for(r in n)n[r]=LP(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new ny(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],i=0,r=s.length;i<r;++i)s[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};function Xee(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function LP(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=Zee,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var n3="http://www.w3.org/1999/xhtml";const DP={svg:"http://www.w3.org/2000/svg",xhtml:n3,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function x2(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),DP.hasOwnProperty(e)?{space:DP[e],local:t}:t}function Kee(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===n3&&e.documentElement.namespaceURI===n3?e.createElement(t):e.createElementNS(n,t)}}function Jee(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function cB(t){var e=x2(t);return(e.local?Jee:Kee)(e)}function ete(){}function MT(t){return t==null?ete:function(){return this.querySelector(t)}}function tte(t){typeof t!="function"&&(t=MT(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],u=s.length,a=i[r]=new Array(u),y,w,I=0;I<u;++I)(y=s[I])&&(w=t.call(y,y.__data__,I,s))&&("__data__"in y&&(w.__data__=y.__data__),a[I]=w);return new Bo(i,this._parents)}function hB(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function nte(){return[]}function fB(t){return t==null?nte:function(){return this.querySelectorAll(t)}}function ite(t){return function(){return hB(t.apply(this,arguments))}}function rte(t){typeof t=="function"?t=ite(t):t=fB(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var u=e[s],a=u.length,y,w=0;w<a;++w)(y=u[w])&&(i.push(t.call(y,y.__data__,w,u)),r.push(y));return new Bo(i,r)}function dB(t){return function(){return this.matches(t)}}function pB(t){return function(e){return e.matches(t)}}var ste=Array.prototype.find;function ote(t){return function(){return ste.call(this.children,t)}}function ate(){return this.firstElementChild}function lte(t){return this.select(t==null?ate:ote(typeof t=="function"?t:pB(t)))}var Ate=Array.prototype.filter;function ute(){return Array.from(this.children)}function cte(t){return function(){return Ate.call(this.children,t)}}function hte(t){return this.selectAll(t==null?ute:cte(typeof t=="function"?t:pB(t)))}function fte(t){typeof t!="function"&&(t=dB(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],u=s.length,a=i[r]=[],y,w=0;w<u;++w)(y=s[w])&&t.call(y,y.__data__,w,s)&&a.push(y);return new Bo(i,this._parents)}function gB(t){return new Array(t.length)}function dte(){return new Bo(this._enter||this._groups.map(gB),this._parents)}function a_(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}a_.prototype={constructor:a_,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function pte(t){return function(){return t}}function gte(t,e,n,i,r,s){for(var u=0,a,y=e.length,w=s.length;u<w;++u)(a=e[u])?(a.__data__=s[u],i[u]=a):n[u]=new a_(t,s[u]);for(;u<y;++u)(a=e[u])&&(r[u]=a)}function mte(t,e,n,i,r,s,u){var a,y,w=new Map,I=e.length,P=s.length,L=new Array(I),U;for(a=0;a<I;++a)(y=e[a])&&(L[a]=U=u.call(y,y.__data__,a,e)+"",w.has(U)?r[a]=y:w.set(U,y));for(a=0;a<P;++a)U=u.call(t,s[a],a,s)+"",(y=w.get(U))?(i[a]=y,y.__data__=s[a],w.delete(U)):n[a]=new a_(t,s[a]);for(a=0;a<I;++a)(y=e[a])&&w.get(L[a])===y&&(r[a]=y)}function yte(t){return t.__data__}function _te(t,e){if(!arguments.length)return Array.from(this,yte);var n=e?mte:gte,i=this._parents,r=this._groups;typeof t!="function"&&(t=pte(t));for(var s=r.length,u=new Array(s),a=new Array(s),y=new Array(s),w=0;w<s;++w){var I=i[w],P=r[w],L=P.length,U=vte(t.call(I,I&&I.__data__,w,i)),Q=U.length,Z=a[w]=new Array(Q),ae=u[w]=new Array(Q),Y=y[w]=new Array(L);n(I,P,Z,ae,Y,U,e);for(var te=0,re=0,de,ve;te<Q;++te)if(de=Z[te]){for(te>=re&&(re=te+1);!(ve=ae[re])&&++re<Q;);de._next=ve||null}}return u=new Bo(u,i),u._enter=a,u._exit=y,u}function vte(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function xte(){return new Bo(this._exit||this._groups.map(gB),this._parents)}function wte(t,e,n){var i=this.enter(),r=this,s=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function bte(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,u=Math.min(r,s),a=new Array(r),y=0;y<u;++y)for(var w=n[y],I=i[y],P=w.length,L=a[y]=new Array(P),U,Q=0;Q<P;++Q)(U=w[Q]||I[Q])&&(L[Q]=U);for(;y<r;++y)a[y]=n[y];return new Bo(a,this._parents)}function Ete(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,s=i[r],u;--r>=0;)(u=i[r])&&(s&&u.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(u,s),s=u);return this}function Tte(t){t||(t=Ste);function e(P,L){return P&&L?t(P.__data__,L.__data__):!P-!L}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var u=n[s],a=u.length,y=r[s]=new Array(a),w,I=0;I<a;++I)(w=u[I])&&(y[I]=w);y.sort(e)}return new Bo(r,this._parents).order()}function Ste(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Mte(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Cte(){return Array.from(this)}function Pte(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var u=i[r];if(u)return u}return null}function Ite(){let t=0;for(const e of this)++t;return t}function kte(){return!this.node()}function Lte(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],s=0,u=r.length,a;s<u;++s)(a=r[s])&&t.call(a,a.__data__,s,r);return this}function Dte(t){return function(){this.removeAttribute(t)}}function Rte(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Bte(t,e){return function(){this.setAttribute(t,e)}}function zte(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ote(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Fte(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Nte(t,e){var n=x2(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?Rte:Dte:typeof e=="function"?n.local?Fte:Ote:n.local?zte:Bte)(n,e))}function mB(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ute(t){return function(){this.style.removeProperty(t)}}function Vte(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Gte(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function jte(t,e,n){return arguments.length>1?this.each((e==null?Ute:typeof e=="function"?Gte:Vte)(t,e,n??"")):Wf(this.node(),t)}function Wf(t,e){return t.style.getPropertyValue(e)||mB(t).getComputedStyle(t,null).getPropertyValue(e)}function $te(t){return function(){delete this[t]}}function Hte(t,e){return function(){this[t]=e}}function Wte(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Qte(t,e){return arguments.length>1?this.each((e==null?$te:typeof e=="function"?Wte:Hte)(t,e)):this.node()[t]}function yB(t){return t.trim().split(/^|\s+/)}function CT(t){return t.classList||new _B(t)}function _B(t){this._node=t,this._names=yB(t.getAttribute("class")||"")}_B.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function vB(t,e){for(var n=CT(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function xB(t,e){for(var n=CT(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function qte(t){return function(){vB(this,t)}}function Zte(t){return function(){xB(this,t)}}function Yte(t,e){return function(){(e.apply(this,arguments)?vB:xB)(this,t)}}function Xte(t,e){var n=yB(t+"");if(arguments.length<2){for(var i=CT(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?Yte:e?qte:Zte)(n,e))}function Kte(){this.textContent=""}function Jte(t){return function(){this.textContent=t}}function ene(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function tne(t){return arguments.length?this.each(t==null?Kte:(typeof t=="function"?ene:Jte)(t)):this.node().textContent}function nne(){this.innerHTML=""}function ine(t){return function(){this.innerHTML=t}}function rne(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function sne(t){return arguments.length?this.each(t==null?nne:(typeof t=="function"?rne:ine)(t)):this.node().innerHTML}function one(){this.nextSibling&&this.parentNode.appendChild(this)}function ane(){return this.each(one)}function lne(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ane(){return this.each(lne)}function une(t){var e=typeof t=="function"?t:cB(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function cne(){return null}function hne(t,e){var n=typeof t=="function"?t:cB(t),i=e==null?cne:typeof e=="function"?e:MT(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function fne(){var t=this.parentNode;t&&t.removeChild(this)}function dne(){return this.each(fne)}function pne(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function gne(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function mne(t){return this.select(t?gne:pne)}function yne(t){return arguments.length?this.property("__data__",t):this.node().__data__}function _ne(t){return function(e){t.call(this,e,this.__data__)}}function vne(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function xne(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,s;n<r;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function wne(t,e,n){return function(){var i=this.__on,r,s=_ne(e);if(i){for(var u=0,a=i.length;u<a;++u)if((r=i[u]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=e;return}}this.addEventListener(t.type,s,n),r={type:t.type,name:t.name,value:e,listener:s,options:n},i?i.push(r):this.__on=[r]}}function bne(t,e,n){var i=vne(t+""),r,s=i.length,u;if(arguments.length<2){var a=this.node().__on;if(a){for(var y=0,w=a.length,I;y<w;++y)for(r=0,I=a[y];r<s;++r)if((u=i[r]).type===I.type&&u.name===I.name)return I.value}return}for(a=e?wne:xne,r=0;r<s;++r)this.each(a(i[r],e,n));return this}function wB(t,e,n){var i=mB(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Ene(t,e){return function(){return wB(this,t,e)}}function Tne(t,e){return function(){return wB(this,t,e.apply(this,arguments))}}function Sne(t,e){return this.each((typeof e=="function"?Tne:Ene)(t,e))}function*Mne(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length,u;r<s;++r)(u=i[r])&&(yield u)}var PT=[null];function Bo(t,e){this._groups=t,this._parents=e}function Zg(){return new Bo([[document.documentElement]],PT)}function Cne(){return this}Bo.prototype=Zg.prototype={constructor:Bo,select:tte,selectAll:rte,selectChild:lte,selectChildren:hte,filter:fte,data:_te,enter:dte,exit:xte,join:wte,merge:bte,selection:Cne,order:Ete,sort:Tte,call:Mte,nodes:Cte,node:Pte,size:Ite,empty:kte,each:Lte,attr:Nte,style:jte,property:Qte,classed:Xte,text:tne,html:sne,raise:ane,lower:Ane,append:une,insert:hne,remove:dne,clone:mne,datum:yne,on:bne,dispatch:Sne,[Symbol.iterator]:Mne};function Sa(t){return typeof t=="string"?new Bo([[document.querySelector(t)]],[document.documentElement]):new Bo([[t]],PT)}function Pne(t){return typeof t=="string"?new Bo([document.querySelectorAll(t)],[document.documentElement]):new Bo([hB(t)],PT)}function Yg(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function w2(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function u0(){}var hg=.7,l_=1/hg,Ef="\\s*([+-]?\\d+)\\s*",fg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ine=/^#([0-9a-f]{3,8})$/,kne=new RegExp(`^rgb\\(${Ef},${Ef},${Ef}\\)$`),Lne=new RegExp(`^rgb\\(${zA},${zA},${zA}\\)$`),Dne=new RegExp(`^rgba\\(${Ef},${Ef},${Ef},${fg}\\)$`),Rne=new RegExp(`^rgba\\(${zA},${zA},${zA},${fg}\\)$`),Bne=new RegExp(`^hsl\\(${fg},${zA},${zA}\\)$`),zne=new RegExp(`^hsla\\(${fg},${zA},${zA},${fg}\\)$`),RP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Yg(u0,OA,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:BP,formatHex:BP,formatHex8:One,formatHsl:Fne,formatRgb:zP,toString:zP});function BP(){return this.rgb().formatHex()}function One(){return this.rgb().formatHex8()}function Fne(){return EB(this).formatHsl()}function zP(){return this.rgb().formatRgb()}function OA(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Ine.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?OP(e):n===3?new Ao(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?u1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?u1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=kne.exec(t))?new Ao(e[1],e[2],e[3],1):(e=Lne.exec(t))?new Ao(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Dne.exec(t))?u1(e[1],e[2],e[3],e[4]):(e=Rne.exec(t))?u1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Bne.exec(t))?UP(e[1],e[2]/100,e[3]/100,1):(e=zne.exec(t))?UP(e[1],e[2]/100,e[3]/100,e[4]):RP.hasOwnProperty(t)?OP(RP[t]):t==="transparent"?new Ao(NaN,NaN,NaN,0):null}function OP(t){return new Ao(t>>16&255,t>>8&255,t&255,1)}function u1(t,e,n,i){return i<=0&&(t=e=n=NaN),new Ao(t,e,n,i)}function bB(t){return t instanceof u0||(t=OA(t)),t?(t=t.rgb(),new Ao(t.r,t.g,t.b,t.opacity)):new Ao}function dg(t,e,n,i){return arguments.length===1?bB(t):new Ao(t,e,n,i??1)}function Ao(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}Yg(Ao,dg,w2(u0,{brighter(t){return t=t==null?l_:Math.pow(l_,t),new Ao(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?hg:Math.pow(hg,t),new Ao(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ao(Dh(this.r),Dh(this.g),Dh(this.b),A_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:FP,formatHex:FP,formatHex8:Nne,formatRgb:NP,toString:NP}));function FP(){return`#${Ch(this.r)}${Ch(this.g)}${Ch(this.b)}`}function Nne(){return`#${Ch(this.r)}${Ch(this.g)}${Ch(this.b)}${Ch((isNaN(this.opacity)?1:this.opacity)*255)}`}function NP(){const t=A_(this.opacity);return`${t===1?"rgb(":"rgba("}${Dh(this.r)}, ${Dh(this.g)}, ${Dh(this.b)}${t===1?")":`, ${t})`}`}function A_(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Dh(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ch(t){return t=Dh(t),(t<16?"0":"")+t.toString(16)}function UP(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Hl(t,e,n,i)}function EB(t){if(t instanceof Hl)return new Hl(t.h,t.s,t.l,t.opacity);if(t instanceof u0||(t=OA(t)),!t)return new Hl;if(t instanceof Hl)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),u=NaN,a=s-r,y=(s+r)/2;return a?(e===s?u=(n-i)/a+(n<i)*6:n===s?u=(i-e)/a+2:u=(e-n)/a+4,a/=y<.5?s+r:2-s-r,u*=60):a=y>0&&y<1?0:u,new Hl(u,a,y,t.opacity)}function Une(t,e,n,i){return arguments.length===1?EB(t):new Hl(t,e,n,i??1)}function Hl(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}Yg(Hl,Une,w2(u0,{brighter(t){return t=t==null?l_:Math.pow(l_,t),new Hl(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?hg:Math.pow(hg,t),new Hl(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Ao($x(t>=240?t-240:t+120,r,i),$x(t,r,i),$x(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Hl(VP(this.h),c1(this.s),c1(this.l),A_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=A_(this.opacity);return`${t===1?"hsl(":"hsla("}${VP(this.h)}, ${c1(this.s)*100}%, ${c1(this.l)*100}%${t===1?")":`, ${t})`}`}}));function VP(t){return t=(t||0)%360,t<0?t+360:t}function c1(t){return Math.max(0,Math.min(1,t||0))}function $x(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Vne=Math.PI/180,Gne=180/Math.PI,u_=18,TB=.96422,SB=1,MB=.82521,CB=4/29,Tf=6/29,PB=3*Tf*Tf,jne=Tf*Tf*Tf;function IB(t){if(t instanceof FA)return new FA(t.l,t.a,t.b,t.opacity);if(t instanceof LA)return LB(t);t instanceof Ao||(t=bB(t));var e=qx(t.r),n=qx(t.g),i=qx(t.b),r=Hx((.2225045*e+.7168786*n+.0606169*i)/SB),s,u;return e===n&&n===i?s=u=r:(s=Hx((.4360747*e+.3850649*n+.1430804*i)/TB),u=Hx((.0139322*e+.0971045*n+.7141733*i)/MB)),new FA(116*r-16,500*(s-r),200*(r-u),t.opacity)}function $ne(t,e,n,i){return arguments.length===1?IB(t):new FA(t,e,n,i??1)}function FA(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}Yg(FA,$ne,w2(u0,{brighter(t){return new FA(this.l+u_*(t??1),this.a,this.b,this.opacity)},darker(t){return new FA(this.l-u_*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=TB*Wx(e),t=SB*Wx(t),n=MB*Wx(n),new Ao(Qx(3.1338561*e-1.6168667*t-.4906146*n),Qx(-.9787684*e+1.9161415*t+.033454*n),Qx(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function Hx(t){return t>jne?Math.pow(t,1/3):t/PB+CB}function Wx(t){return t>Tf?t*t*t:PB*(t-CB)}function Qx(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function qx(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function kB(t){if(t instanceof LA)return new LA(t.h,t.c,t.l,t.opacity);if(t instanceof FA||(t=IB(t)),t.a===0&&t.b===0)return new LA(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Gne;return new LA(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function GP(t,e,n,i){return arguments.length===1?kB(t):new LA(n,e,t,i??1)}function Hne(t,e,n,i){return arguments.length===1?kB(t):new LA(t,e,n,i??1)}function LA(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function LB(t){if(isNaN(t.h))return new FA(t.l,0,0,t.opacity);var e=t.h*Vne;return new FA(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Yg(LA,Hne,w2(u0,{brighter(t){return new LA(this.h,this.c,this.l+u_*(t??1),this.opacity)},darker(t){return new LA(this.h,this.c,this.l-u_*(t??1),this.opacity)},rgb(){return LB(this).rgb()}}));function Wne(t,e,n,i,r){var s=t*t,u=s*t;return((1-3*t+3*s-u)*e+(4-6*s+3*u)*n+(1+3*t+3*s-3*u)*i+u*r)/6}function Qne(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],s=t[i+1],u=i>0?t[i-1]:2*r-s,a=i<e-1?t[i+2]:2*s-r;return Wne((n-i/e)*e,u,r,s,a)}}const IT=t=>()=>t;function qne(t,e){return function(n){return t+n*e}}function Zne(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function Yne(t){return(t=+t)==1?DB:function(e,n){return n-e?Zne(e,n,t):IT(isNaN(e)?n:e)}}function DB(t,e){var n=e-t;return n?qne(t,n):IT(isNaN(t)?e:t)}const c_=function t(e){var n=Yne(e);function i(r,s){var u=n((r=dg(r)).r,(s=dg(s)).r),a=n(r.g,s.g),y=n(r.b,s.b),w=DB(r.opacity,s.opacity);return function(I){return r.r=u(I),r.g=a(I),r.b=y(I),r.opacity=w(I),r+""}}return i.gamma=t,i}(1);function Xne(t){return function(e){var n=e.length,i=new Array(n),r=new Array(n),s=new Array(n),u,a;for(u=0;u<n;++u)a=dg(e[u]),i[u]=a.r||0,r[u]=a.g||0,s[u]=a.b||0;return i=t(i),r=t(r),s=t(s),a.opacity=1,function(y){return a.r=i(y),a.g=r(y),a.b=s(y),a+""}}}var Kne=Xne(Qne);function Jne(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=t[r]*(1-s)+e[r]*s;return i}}function eie(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function tie(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),s=new Array(n),u;for(u=0;u<i;++u)r[u]=kT(t[u],e[u]);for(;u<n;++u)s[u]=e[u];return function(a){for(u=0;u<i;++u)s[u]=r[u](a);return s}}function nie(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function $l(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function iie(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=kT(t[r],e[r]):i[r]=e[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var i3=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Zx=new RegExp(i3.source,"g");function rie(t){return function(){return t}}function sie(t){return function(e){return t(e)+""}}function RB(t,e){var n=i3.lastIndex=Zx.lastIndex=0,i,r,s,u=-1,a=[],y=[];for(t=t+"",e=e+"";(i=i3.exec(t))&&(r=Zx.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),a[u]?a[u]+=s:a[++u]=s),(i=i[0])===(r=r[0])?a[u]?a[u]+=r:a[++u]=r:(a[++u]=null,y.push({i:u,x:$l(i,r)})),n=Zx.lastIndex;return n<e.length&&(s=e.slice(n),a[u]?a[u]+=s:a[++u]=s),a.length<2?y[0]?sie(y[0].x):rie(e):(e=y.length,function(w){for(var I=0,P;I<e;++I)a[(P=y[I]).i]=P.x(w);return a.join("")})}function kT(t,e){var n=typeof e,i;return e==null||n==="boolean"?IT(e):(n==="number"?$l:n==="string"?(i=OA(e))?(e=i,c_):RB:e instanceof OA?c_:e instanceof Date?nie:eie(e)?Jne:Array.isArray(e)?tie:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?iie:$l)(t,e)}function oie(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var jP=180/Math.PI,r3={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function BB(t,e,n,i,r,s){var u,a,y;return(u=Math.sqrt(t*t+e*e))&&(t/=u,e/=u),(y=t*n+e*i)&&(n-=t*y,i-=e*y),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,y/=a),t*i<e*n&&(t=-t,e=-e,y=-y,u=-u),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*jP,skewX:Math.atan(y)*jP,scaleX:u,scaleY:a}}var h1;function aie(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?r3:BB(e.a,e.b,e.c,e.d,e.e,e.f)}function lie(t){return t==null||(h1||(h1=document.createElementNS("http://www.w3.org/2000/svg","g")),h1.setAttribute("transform",t),!(t=h1.transform.baseVal.consolidate()))?r3:(t=t.matrix,BB(t.a,t.b,t.c,t.d,t.e,t.f))}function zB(t,e,n,i){function r(w){return w.length?w.pop()+" ":""}function s(w,I,P,L,U,Q){if(w!==P||I!==L){var Z=U.push("translate(",null,e,null,n);Q.push({i:Z-4,x:$l(w,P)},{i:Z-2,x:$l(I,L)})}else(P||L)&&U.push("translate("+P+e+L+n)}function u(w,I,P,L){w!==I?(w-I>180?I+=360:I-w>180&&(w+=360),L.push({i:P.push(r(P)+"rotate(",null,i)-2,x:$l(w,I)})):I&&P.push(r(P)+"rotate("+I+i)}function a(w,I,P,L){w!==I?L.push({i:P.push(r(P)+"skewX(",null,i)-2,x:$l(w,I)}):I&&P.push(r(P)+"skewX("+I+i)}function y(w,I,P,L,U,Q){if(w!==P||I!==L){var Z=U.push(r(U)+"scale(",null,",",null,")");Q.push({i:Z-4,x:$l(w,P)},{i:Z-2,x:$l(I,L)})}else(P!==1||L!==1)&&U.push(r(U)+"scale("+P+","+L+")")}return function(w,I){var P=[],L=[];return w=t(w),I=t(I),s(w.translateX,w.translateY,I.translateX,I.translateY,P,L),u(w.rotate,I.rotate,P,L),a(w.skewX,I.skewX,P,L),y(w.scaleX,w.scaleY,I.scaleX,I.scaleY,P,L),w=I=null,function(U){for(var Q=-1,Z=L.length,ae;++Q<Z;)P[(ae=L[Q]).i]=ae.x(U);return P.join("")}}}var Aie=zB(aie,"px, ","px)","deg)"),uie=zB(lie,", ",")",")");function Xg(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t(i/(e-1));return n}var Qf=0,_p=0,Jd=0,OB=1e3,h_,vp,f_=0,Hh=0,b2=0,pg=typeof performance=="object"&&performance.now?performance:Date,FB=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function LT(){return Hh||(FB(cie),Hh=pg.now()+b2)}function cie(){Hh=0}function d_(){this._call=this._time=this._next=null}d_.prototype=NB.prototype={constructor:d_,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?LT():+n)+(e==null?0:+e),!this._next&&vp!==this&&(vp?vp._next=this:h_=this,vp=this),this._call=t,this._time=n,s3()},stop:function(){this._call&&(this._call=null,this._time=1/0,s3())}};function NB(t,e,n){var i=new d_;return i.restart(t,e,n),i}function hie(){LT(),++Qf;for(var t=h_,e;t;)(e=Hh-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Qf}function $P(){Hh=(f_=pg.now())+b2,Qf=_p=0;try{hie()}finally{Qf=0,die(),Hh=0}}function fie(){var t=pg.now(),e=t-f_;e>OB&&(b2-=e,f_=t)}function die(){for(var t,e=h_,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:h_=n);vp=t,s3(i)}function s3(t){if(!Qf){_p&&(_p=clearTimeout(_p));var e=t-Hh;e>24?(t<1/0&&(_p=setTimeout($P,t-pg.now()-b2)),Jd&&(Jd=clearInterval(Jd))):(Jd||(f_=pg.now(),Jd=setInterval(fie,OB)),Qf=1,FB($P))}}function HP(t,e,n){var i=new d_;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var pie=uB("start","end","cancel","interrupt"),gie=[],UB=0,WP=1,o3=2,iy=3,QP=4,a3=5,ry=6;function E2(t,e,n,i,r,s){var u=t.__transition;if(!u)t.__transition={};else if(n in u)return;mie(t,n,{name:e,index:i,group:r,on:pie,tween:gie,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:UB})}function DT(t,e){var n=rA(t,e);if(n.state>UB)throw new Error("too late; already scheduled");return n}function jA(t,e){var n=rA(t,e);if(n.state>iy)throw new Error("too late; already running");return n}function rA(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function mie(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=NB(s,0,n.time);function s(w){n.state=WP,n.timer.restart(u,n.delay,n.time),n.delay<=w&&u(w-n.delay)}function u(w){var I,P,L,U;if(n.state!==WP)return y();for(I in i)if(U=i[I],U.name===n.name){if(U.state===iy)return HP(u);U.state===QP?(U.state=ry,U.timer.stop(),U.on.call("interrupt",t,t.__data__,U.index,U.group),delete i[I]):+I<e&&(U.state=ry,U.timer.stop(),U.on.call("cancel",t,t.__data__,U.index,U.group),delete i[I])}if(HP(function(){n.state===iy&&(n.state=QP,n.timer.restart(a,n.delay,n.time),a(w))}),n.state=o3,n.on.call("start",t,t.__data__,n.index,n.group),n.state===o3){for(n.state=iy,r=new Array(L=n.tween.length),I=0,P=-1;I<L;++I)(U=n.tween[I].value.call(t,t.__data__,n.index,n.group))&&(r[++P]=U);r.length=P+1}}function a(w){for(var I=w<n.duration?n.ease.call(null,w/n.duration):(n.timer.restart(y),n.state=a3,1),P=-1,L=r.length;++P<L;)r[P].call(t,I);n.state===a3&&(n.on.call("end",t,t.__data__,n.index,n.group),y())}function y(){n.state=ry,n.timer.stop(),delete i[e];for(var w in i)return;delete t.__transition}}function yie(t,e){var n=t.__transition,i,r,s=!0,u;if(n){e=e==null?null:e+"";for(u in n){if((i=n[u]).name!==e){s=!1;continue}r=i.state>o3&&i.state<a3,i.state=ry,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[u]}s&&delete t.__transition}}function _ie(t){return this.each(function(){yie(this,t)})}function vie(t,e){var n,i;return function(){var r=jA(this,t),s=r.tween;if(s!==n){i=n=s;for(var u=0,a=i.length;u<a;++u)if(i[u].name===e){i=i.slice(),i.splice(u,1);break}}r.tween=i}}function xie(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var s=jA(this,t),u=s.tween;if(u!==i){r=(i=u).slice();for(var a={name:e,value:n},y=0,w=r.length;y<w;++y)if(r[y].name===e){r[y]=a;break}y===w&&r.push(a)}s.tween=r}}function wie(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=rA(this.node(),n).tween,r=0,s=i.length,u;r<s;++r)if((u=i[r]).name===t)return u.value;return null}return this.each((e==null?vie:xie)(n,t,e))}function RT(t,e,n){var i=t._id;return t.each(function(){var r=jA(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return rA(r,i).value[e]}}function VB(t,e){var n;return(typeof e=="number"?$l:e instanceof OA?c_:(n=OA(e))?(e=n,c_):RB)(t,e)}function bie(t){return function(){this.removeAttribute(t)}}function Eie(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Tie(t,e,n){var i,r=n+"",s;return function(){var u=this.getAttribute(t);return u===r?null:u===i?s:s=e(i=u,n)}}function Sie(t,e,n){var i,r=n+"",s;return function(){var u=this.getAttributeNS(t.space,t.local);return u===r?null:u===i?s:s=e(i=u,n)}}function Mie(t,e,n){var i,r,s;return function(){var u,a=n(this),y;return a==null?void this.removeAttribute(t):(u=this.getAttribute(t),y=a+"",u===y?null:u===i&&y===r?s:(r=y,s=e(i=u,a)))}}function Cie(t,e,n){var i,r,s;return function(){var u,a=n(this),y;return a==null?void this.removeAttributeNS(t.space,t.local):(u=this.getAttributeNS(t.space,t.local),y=a+"",u===y?null:u===i&&y===r?s:(r=y,s=e(i=u,a)))}}function Pie(t,e){var n=x2(t),i=n==="transform"?uie:VB;return this.attrTween(t,typeof e=="function"?(n.local?Cie:Mie)(n,i,RT(this,"attr."+t,e)):e==null?(n.local?Eie:bie)(n):(n.local?Sie:Tie)(n,i,e))}function Iie(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function kie(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Lie(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&kie(t,s)),n}return r._value=e,r}function Die(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&Iie(t,s)),n}return r._value=e,r}function Rie(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=x2(t);return this.tween(n,(i.local?Lie:Die)(i,e))}function Bie(t,e){return function(){DT(this,t).delay=+e.apply(this,arguments)}}function zie(t,e){return e=+e,function(){DT(this,t).delay=e}}function Oie(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Bie:zie)(e,t)):rA(this.node(),e).delay}function Fie(t,e){return function(){jA(this,t).duration=+e.apply(this,arguments)}}function Nie(t,e){return e=+e,function(){jA(this,t).duration=e}}function Uie(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Fie:Nie)(e,t)):rA(this.node(),e).duration}function Vie(t,e){if(typeof e!="function")throw new Error;return function(){jA(this,t).ease=e}}function Gie(t){var e=this._id;return arguments.length?this.each(Vie(e,t)):rA(this.node(),e).ease}function jie(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;jA(this,t).ease=n}}function $ie(t){if(typeof t!="function")throw new Error;return this.each(jie(this._id,t))}function Hie(t){typeof t!="function"&&(t=dB(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],u=s.length,a=i[r]=[],y,w=0;w<u;++w)(y=s[w])&&t.call(y,y.__data__,w,s)&&a.push(y);return new $u(i,this._parents,this._name,this._id)}function Wie(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),u=new Array(i),a=0;a<s;++a)for(var y=e[a],w=n[a],I=y.length,P=u[a]=new Array(I),L,U=0;U<I;++U)(L=y[U]||w[U])&&(P[U]=L);for(;a<i;++a)u[a]=e[a];return new $u(u,this._parents,this._name,this._id)}function Qie(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function qie(t,e,n){var i,r,s=Qie(e)?DT:jA;return function(){var u=s(this,t),a=u.on;a!==i&&(r=(i=a).copy()).on(e,n),u.on=r}}function Zie(t,e){var n=this._id;return arguments.length<2?rA(this.node(),n).on.on(t):this.each(qie(n,t,e))}function Yie(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Xie(){return this.on("end.remove",Yie(this._id))}function Kie(t){var e=this._name,n=this._id;typeof t!="function"&&(t=MT(t));for(var i=this._groups,r=i.length,s=new Array(r),u=0;u<r;++u)for(var a=i[u],y=a.length,w=s[u]=new Array(y),I,P,L=0;L<y;++L)(I=a[L])&&(P=t.call(I,I.__data__,L,a))&&("__data__"in I&&(P.__data__=I.__data__),w[L]=P,E2(w[L],e,n,L,w,rA(I,n)));return new $u(s,this._parents,e,n)}function Jie(t){var e=this._name,n=this._id;typeof t!="function"&&(t=fB(t));for(var i=this._groups,r=i.length,s=[],u=[],a=0;a<r;++a)for(var y=i[a],w=y.length,I,P=0;P<w;++P)if(I=y[P]){for(var L=t.call(I,I.__data__,P,y),U,Q=rA(I,n),Z=0,ae=L.length;Z<ae;++Z)(U=L[Z])&&E2(U,e,n,Z,L,Q);s.push(L),u.push(I)}return new $u(s,u,e,n)}var ere=Zg.prototype.constructor;function tre(){return new ere(this._groups,this._parents)}function nre(t,e){var n,i,r;return function(){var s=Wf(this,t),u=(this.style.removeProperty(t),Wf(this,t));return s===u?null:s===n&&u===i?r:r=e(n=s,i=u)}}function GB(t){return function(){this.style.removeProperty(t)}}function ire(t,e,n){var i,r=n+"",s;return function(){var u=Wf(this,t);return u===r?null:u===i?s:s=e(i=u,n)}}function rre(t,e,n){var i,r,s;return function(){var u=Wf(this,t),a=n(this),y=a+"";return a==null&&(y=a=(this.style.removeProperty(t),Wf(this,t))),u===y?null:u===i&&y===r?s:(r=y,s=e(i=u,a))}}function sre(t,e){var n,i,r,s="style."+e,u="end."+s,a;return function(){var y=jA(this,t),w=y.on,I=y.value[s]==null?a||(a=GB(e)):void 0;(w!==n||r!==I)&&(i=(n=w).copy()).on(u,r=I),y.on=i}}function ore(t,e,n){var i=(t+="")=="transform"?Aie:VB;return e==null?this.styleTween(t,nre(t,i)).on("end.style."+t,GB(t)):typeof e=="function"?this.styleTween(t,rre(t,i,RT(this,"style."+t,e))).each(sre(this._id,t)):this.styleTween(t,ire(t,i,e),n).on("end.style."+t,null)}function are(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function lre(t,e,n){var i,r;function s(){var u=e.apply(this,arguments);return u!==r&&(i=(r=u)&&are(t,u,n)),i}return s._value=e,s}function Are(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,lre(t,e,n??""))}function ure(t){return function(){this.textContent=t}}function cre(t){return function(){var e=t(this);this.textContent=e??""}}function hre(t){return this.tween("text",typeof t=="function"?cre(RT(this,"text",t)):ure(t==null?"":t+""))}function fre(t){return function(e){this.textContent=t.call(this,e)}}function dre(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&fre(r)),e}return i._value=t,i}function pre(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,dre(t))}function gre(){for(var t=this._name,e=this._id,n=jB(),i=this._groups,r=i.length,s=0;s<r;++s)for(var u=i[s],a=u.length,y,w=0;w<a;++w)if(y=u[w]){var I=rA(y,e);E2(y,t,n,w,u,{time:I.time+I.delay+I.duration,delay:0,duration:I.duration,ease:I.ease})}return new $u(i,this._parents,t,n)}function mre(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(s,u){var a={value:u},y={value:function(){--r===0&&s()}};n.each(function(){var w=jA(this,i),I=w.on;I!==t&&(e=(t=I).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(y)),w.on=e}),r===0&&s()})}var yre=0;function $u(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function jB(){return++yre}var _u=Zg.prototype;$u.prototype={constructor:$u,select:Kie,selectAll:Jie,selectChild:_u.selectChild,selectChildren:_u.selectChildren,filter:Hie,merge:Wie,selection:tre,transition:gre,call:_u.call,nodes:_u.nodes,node:_u.node,size:_u.size,empty:_u.empty,each:_u.each,on:Zie,attr:Pie,attrTween:Rie,style:ore,styleTween:Are,text:hre,textTween:pre,remove:Xie,tween:wie,delay:Oie,duration:Uie,ease:Gie,easeVarying:$ie,end:mre,[Symbol.iterator]:_u[Symbol.iterator]};function _re(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var BT=1.70158;(function t(e){e=+e;function n(i){return(i=+i)*i*(e*(i-1)+i)}return n.overshoot=t,n})(BT);var qP=function t(e){e=+e;function n(i){return--i*i*((i+1)*e+i)+1}return n.overshoot=t,n}(BT);(function t(e){e=+e;function n(i){return((i*=2)<1?i*i*((e+1)*i-e):(i-=2)*i*((e+1)*i+e)+2)/2}return n.overshoot=t,n})(BT);var vre={time:null,delay:0,duration:250,ease:_re};function xre(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function wre(t){var e,n;t instanceof $u?(e=t._id,t=t._name):(e=jB(),(n=vre).time=LT(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var u=i[s],a=u.length,y,w=0;w<a;++w)(y=u[w])&&E2(y,t,e,w,u,n||xre(y,e));return new $u(i,this._parents,t,e)}Zg.prototype.interrupt=_ie;Zg.prototype.transition=wre;const l3=Math.PI,A3=2*l3,wh=1e-6,bre=A3-wh;function $B(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Ere(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return $B;const n=10**e;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}let Tre=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?$B:Ere(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,i,r){this._append`Q${+e},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(e,n,i,r,s,u){this._append`C${+e},${+n},${+i},${+r},${this._x1=+s},${this._y1=+u}`}arcTo(e,n,i,r,s){if(e=+e,n=+n,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let u=this._x1,a=this._y1,y=i-e,w=r-n,I=u-e,P=a-n,L=I*I+P*P;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(L>wh)if(!(Math.abs(P*y-w*I)>wh)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let U=i-u,Q=r-a,Z=y*y+w*w,ae=U*U+Q*Q,Y=Math.sqrt(Z),te=Math.sqrt(L),re=s*Math.tan((l3-Math.acos((Z+L-ae)/(2*Y*te)))/2),de=re/te,ve=re/Y;Math.abs(de-1)>wh&&this._append`L${e+de*I},${n+de*P}`,this._append`A${s},${s},0,0,${+(P*U>I*Q)},${this._x1=e+ve*y},${this._y1=n+ve*w}`}}arc(e,n,i,r,s,u){if(e=+e,n=+n,i=+i,u=!!u,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),y=i*Math.sin(r),w=e+a,I=n+y,P=1^u,L=u?r-s:s-r;this._x1===null?this._append`M${w},${I}`:(Math.abs(this._x1-w)>wh||Math.abs(this._y1-I)>wh)&&this._append`L${w},${I}`,i&&(L<0&&(L=L%A3+A3),L>bre?this._append`A${i},${i},0,1,${P},${e-a},${n-y}A${i},${i},0,1,${P},${this._x1=w},${this._y1=I}`:L>wh&&this._append`A${i},${i},0,${+(L>=l3)},${P},${this._x1=e+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(e,n,i,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}};const Bu=11102230246251565e-32,Js=134217729,Sre=(3+8*Bu)*Bu;function Yx(t,e,n,i,r){let s,u,a,y,w=e[0],I=i[0],P=0,L=0;I>w==I>-w?(s=w,w=e[++P]):(s=I,I=i[++L]);let U=0;if(P<t&&L<n)for(I>w==I>-w?(u=w+s,a=s-(u-w),w=e[++P]):(u=I+s,a=s-(u-I),I=i[++L]),s=u,a!==0&&(r[U++]=a);P<t&&L<n;)I>w==I>-w?(u=s+w,y=u-s,a=s-(u-y)+(w-y),w=e[++P]):(u=s+I,y=u-s,a=s-(u-y)+(I-y),I=i[++L]),s=u,a!==0&&(r[U++]=a);for(;P<t;)u=s+w,y=u-s,a=s-(u-y)+(w-y),w=e[++P],s=u,a!==0&&(r[U++]=a);for(;L<n;)u=s+I,y=u-s,a=s-(u-y)+(I-y),I=i[++L],s=u,a!==0&&(r[U++]=a);return(s!==0||U===0)&&(r[U++]=s),U}function Mre(t,e){let n=e[0];for(let i=1;i<t;i++)n+=e[i];return n}function Kg(t){return new Float64Array(t)}const Cre=(3+16*Bu)*Bu,Pre=(2+12*Bu)*Bu,Ire=(9+64*Bu)*Bu*Bu,z0=Kg(4),ZP=Kg(8),YP=Kg(12),XP=Kg(16),Mo=Kg(4);function kre(t,e,n,i,r,s,u){let a,y,w,I,P,L,U,Q,Z,ae,Y,te,re,de,ve,Me,He,Qe;const et=t-r,tt=n-r,Ve=e-s,nt=i-s;de=et*nt,L=Js*et,U=L-(L-et),Q=et-U,L=Js*nt,Z=L-(L-nt),ae=nt-Z,ve=Q*ae-(de-U*Z-Q*Z-U*ae),Me=Ve*tt,L=Js*Ve,U=L-(L-Ve),Q=Ve-U,L=Js*tt,Z=L-(L-tt),ae=tt-Z,He=Q*ae-(Me-U*Z-Q*Z-U*ae),Y=ve-He,P=ve-Y,z0[0]=ve-(Y+P)+(P-He),te=de+Y,P=te-de,re=de-(te-P)+(Y-P),Y=re-Me,P=re-Y,z0[1]=re-(Y+P)+(P-Me),Qe=te+Y,P=Qe-te,z0[2]=te-(Qe-P)+(Y-P),z0[3]=Qe;let Ye=Mre(4,z0),gt=Pre*u;if(Ye>=gt||-Ye>=gt||(P=t-et,a=t-(et+P)+(P-r),P=n-tt,w=n-(tt+P)+(P-r),P=e-Ve,y=e-(Ve+P)+(P-s),P=i-nt,I=i-(nt+P)+(P-s),a===0&&y===0&&w===0&&I===0)||(gt=Ire*u+Sre*Math.abs(Ye),Ye+=et*I+nt*a-(Ve*w+tt*y),Ye>=gt||-Ye>=gt))return Ye;de=a*nt,L=Js*a,U=L-(L-a),Q=a-U,L=Js*nt,Z=L-(L-nt),ae=nt-Z,ve=Q*ae-(de-U*Z-Q*Z-U*ae),Me=y*tt,L=Js*y,U=L-(L-y),Q=y-U,L=Js*tt,Z=L-(L-tt),ae=tt-Z,He=Q*ae-(Me-U*Z-Q*Z-U*ae),Y=ve-He,P=ve-Y,Mo[0]=ve-(Y+P)+(P-He),te=de+Y,P=te-de,re=de-(te-P)+(Y-P),Y=re-Me,P=re-Y,Mo[1]=re-(Y+P)+(P-Me),Qe=te+Y,P=Qe-te,Mo[2]=te-(Qe-P)+(Y-P),Mo[3]=Qe;const Xt=Yx(4,z0,4,Mo,ZP);de=et*I,L=Js*et,U=L-(L-et),Q=et-U,L=Js*I,Z=L-(L-I),ae=I-Z,ve=Q*ae-(de-U*Z-Q*Z-U*ae),Me=Ve*w,L=Js*Ve,U=L-(L-Ve),Q=Ve-U,L=Js*w,Z=L-(L-w),ae=w-Z,He=Q*ae-(Me-U*Z-Q*Z-U*ae),Y=ve-He,P=ve-Y,Mo[0]=ve-(Y+P)+(P-He),te=de+Y,P=te-de,re=de-(te-P)+(Y-P),Y=re-Me,P=re-Y,Mo[1]=re-(Y+P)+(P-Me),Qe=te+Y,P=Qe-te,Mo[2]=te-(Qe-P)+(Y-P),Mo[3]=Qe;const Et=Yx(Xt,ZP,4,Mo,YP);de=a*I,L=Js*a,U=L-(L-a),Q=a-U,L=Js*I,Z=L-(L-I),ae=I-Z,ve=Q*ae-(de-U*Z-Q*Z-U*ae),Me=y*w,L=Js*y,U=L-(L-y),Q=y-U,L=Js*w,Z=L-(L-w),ae=w-Z,He=Q*ae-(Me-U*Z-Q*Z-U*ae),Y=ve-He,P=ve-Y,Mo[0]=ve-(Y+P)+(P-He),te=de+Y,P=te-de,re=de-(te-P)+(Y-P),Y=re-Me,P=re-Y,Mo[1]=re-(Y+P)+(P-Me),Qe=te+Y,P=Qe-te,Mo[2]=te-(Qe-P)+(Y-P),Mo[3]=Qe;const fn=Yx(Et,YP,4,Mo,XP);return XP[fn-1]}function Lre(t,e,n,i,r,s){const u=(e-s)*(n-r),a=(t-r)*(i-s),y=u-a,w=Math.abs(u+a);return Math.abs(y)>=Cre*w?y:-kre(t,e,n,i,r,s,w)}function Dre(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function p_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function qf(t){return t=p_(Math.abs(t)),t?t[1]:NaN}function Rre(t,e){return function(n,i){for(var r=n.length,s=[],u=0,a=t[0],y=0;r>0&&a>0&&(y+a+1>i&&(a=Math.max(1,i-y)),s.push(n.substring(r-=a,r+a)),!((y+=a+1)>i));)a=t[u=(u+1)%t.length];return s.reverse().join(e)}}function Bre(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var zre=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function g_(t){if(!(e=zre.exec(t)))throw new Error("invalid format: "+t);var e;return new zT({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}g_.prototype=zT.prototype;function zT(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}zT.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ore(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var HB;function Fre(t,e){var n=p_(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(HB=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,u=i.length;return s===u?i:s>u?i+new Array(s-u+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+p_(t,Math.max(0,e+s-1))[0]}function KP(t,e){var n=p_(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const JP={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Dre,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>KP(t*100,e),r:KP,s:Fre,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function eI(t){return t}var tI=Array.prototype.map,nI=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Nre(t){var e=t.grouping===void 0||t.thousands===void 0?eI:Rre(tI.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?eI:Bre(tI.call(t.numerals,String)),u=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"":t.minus+"",y=t.nan===void 0?"NaN":t.nan+"";function w(P){P=g_(P);var L=P.fill,U=P.align,Q=P.sign,Z=P.symbol,ae=P.zero,Y=P.width,te=P.comma,re=P.precision,de=P.trim,ve=P.type;ve==="n"?(te=!0,ve="g"):JP[ve]||(re===void 0&&(re=12),de=!0,ve="g"),(ae||L==="0"&&U==="=")&&(ae=!0,L="0",U="=");var Me=Z==="$"?n:Z==="#"&&/[boxX]/.test(ve)?"0"+ve.toLowerCase():"",He=Z==="$"?i:/[%p]/.test(ve)?u:"",Qe=JP[ve],et=/[defgprs%]/.test(ve);re=re===void 0?6:/[gprs]/.test(ve)?Math.max(1,Math.min(21,re)):Math.max(0,Math.min(20,re));function tt(Ve){var nt=Me,Ye=He,gt,Xt,Et;if(ve==="c")Ye=Qe(Ve)+Ye,Ve="";else{Ve=+Ve;var fn=Ve<0||1/Ve<0;if(Ve=isNaN(Ve)?y:Qe(Math.abs(Ve),re),de&&(Ve=Ore(Ve)),fn&&+Ve==0&&Q!=="+"&&(fn=!1),nt=(fn?Q==="("?Q:a:Q==="-"||Q==="("?"":Q)+nt,Ye=(ve==="s"?nI[8+HB/3]:"")+Ye+(fn&&Q==="("?")":""),et){for(gt=-1,Xt=Ve.length;++gt<Xt;)if(Et=Ve.charCodeAt(gt),48>Et||Et>57){Ye=(Et===46?r+Ve.slice(gt+1):Ve.slice(gt))+Ye,Ve=Ve.slice(0,gt);break}}}te&&!ae&&(Ve=e(Ve,1/0));var mt=nt.length+Ve.length+Ye.length,bt=mt<Y?new Array(Y-mt+1).join(L):"";switch(te&&ae&&(Ve=e(bt+Ve,bt.length?Y-Ye.length:1/0),bt=""),U){case"<":Ve=nt+Ve+Ye+bt;break;case"=":Ve=nt+bt+Ve+Ye;break;case"^":Ve=bt.slice(0,mt=bt.length>>1)+nt+Ve+Ye+bt.slice(mt);break;default:Ve=bt+nt+Ve+Ye;break}return s(Ve)}return tt.toString=function(){return P+""},tt}function I(P,L){var U=w((P=g_(P),P.type="f",P)),Q=Math.max(-8,Math.min(8,Math.floor(qf(L)/3)))*3,Z=Math.pow(10,-Q),ae=nI[8+Q/3];return function(Y){return U(Z*Y)+ae}}return{format:w,formatPrefix:I}}var f1,WB,QB;Ure({thousands:",",grouping:[3],currency:["$",""]});function Ure(t){return f1=Nre(t),WB=f1.format,QB=f1.formatPrefix,f1}function Vre(t){return Math.max(0,-qf(Math.abs(t)))}function Gre(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(qf(e)/3)))*3-qf(Math.abs(t)))}function jre(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,qf(e)-qf(t))+1}function OT(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function $re(t){return function(){return t}}function Hre(t){return+t}var iI=[0,1];function tf(t){return t}function u3(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:$re(isNaN(e)?NaN:.5)}function Wre(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function Qre(t,e,n){var i=t[0],r=t[1],s=e[0],u=e[1];return r<i?(i=u3(r,i),s=n(u,s)):(i=u3(i,r),s=n(s,u)),function(a){return s(i(a))}}function qre(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),u=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++u<i;)r[u]=u3(t[u],t[u+1]),s[u]=n(e[u],e[u+1]);return function(a){var y=aB(t,a,1,i)-1;return s[y](r[y](a))}}function qB(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Zre(){var t=iI,e=iI,n=kT,i,r,s,u=tf,a,y,w;function I(){var L=Math.min(t.length,e.length);return u!==tf&&(u=Wre(t[0],t[L-1])),a=L>2?qre:Qre,y=w=null,P}function P(L){return L==null||isNaN(L=+L)?s:(y||(y=a(t.map(i),e,n)))(i(u(L)))}return P.invert=function(L){return u(r((w||(w=a(e,t.map(i),$l)))(L)))},P.domain=function(L){return arguments.length?(t=Array.from(L,Hre),I()):t.slice()},P.range=function(L){return arguments.length?(e=Array.from(L),I()):e.slice()},P.rangeRound=function(L){return e=Array.from(L),n=oie,I()},P.clamp=function(L){return arguments.length?(u=L?!0:tf,I()):u!==tf},P.interpolate=function(L){return arguments.length?(n=L,I()):n},P.unknown=function(L){return arguments.length?(s=L,P):s},function(L,U){return i=L,r=U,I()}}function ZB(){return Zre()(tf,tf)}function Yre(t,e,n,i){var r=e3(t,e,n),s;switch(i=g_(i??",f"),i.type){case"s":{var u=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(s=Gre(r,u))&&(i.precision=s),QB(i,u)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=jre(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=Vre(r))&&(i.precision=s-(i.type==="%")*2);break}}return WB(i)}function YB(t){var e=t.domain;return t.ticks=function(n){var i=e();return A0(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return Yre(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,s=i.length-1,u=i[r],a=i[s],y,w,I=10;for(a<u&&(w=u,u=a,a=w,w=r,r=s,s=w);I-- >0;){if(w=Jb(u,a,n),w===y)return i[r]=u,i[s]=a,e(i);if(w>0)u=Math.floor(u/w)*w,a=Math.ceil(a/w)*w;else if(w<0)u=Math.ceil(u*w)/w,a=Math.floor(a*w)/w;else break;y=w}return t},t}function ys(){var t=ZB();return t.copy=function(){return qB(t,ys())},OT.apply(t,arguments),YB(t)}function Xre(t,e){t=t.slice();var n=0,i=t.length-1,r=t[n],s=t[i],u;return s<r&&(u=n,n=i,i=u,u=r,r=s,s=u),t[n]=e.floor(r),t[i]=e.ceil(s),t}function hr(){var t=0,e=1,n=1,i=[.5],r=[0,1],s;function u(y){return y!=null&&y<=y?r[aB(i,y,0,n)]:s}function a(){var y=-1;for(i=new Array(n);++y<n;)i[y]=((y+1)*e-(y-n)*t)/(n+1);return u}return u.domain=function(y){return arguments.length?([t,e]=y,t=+t,e=+e,a()):[t,e]},u.range=function(y){return arguments.length?(n=(r=Array.from(y)).length-1,a()):r.slice()},u.invertExtent=function(y){var w=r.indexOf(y);return w<0?[NaN,NaN]:w<1?[t,i[0]]:w>=n?[i[n-1],e]:[i[w-1],i[w]]},u.unknown=function(y){return arguments.length&&(s=y),u},u.thresholds=function(){return i.slice()},u.copy=function(){return hr().domain([t,e]).range(r).unknown(s)},OT.apply(YB(u),arguments)}const Xx=new Date,Kx=new Date;function ns(t,e,n,i){function r(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(t(s=new Date(+s)),s),r.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),r.round=s=>{const u=r(s),a=r.ceil(s);return s-u<a-s?u:a},r.offset=(s,u)=>(e(s=new Date(+s),u==null?1:Math.floor(u)),s),r.range=(s,u,a)=>{const y=[];if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<u)||!(a>0))return y;let w;do y.push(w=new Date(+s)),e(s,a),t(s);while(w<s&&s<u);return y},r.filter=s=>ns(u=>{if(u>=u)for(;t(u),!s(u);)u.setTime(u-1)},(u,a)=>{if(u>=u)if(a<0)for(;++a<=0;)for(;e(u,-1),!s(u););else for(;--a>=0;)for(;e(u,1),!s(u););}),n&&(r.count=(s,u)=>(Xx.setTime(+s),Kx.setTime(+u),t(Xx),t(Kx),Math.floor(n(Xx,Kx))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?u=>i(u)%s===0:u=>r.count(0,u)%s===0):r)),r}const m_=ns(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);m_.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?ns(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):m_);m_.range;const Mu=1e3,cl=Mu*60,Cu=cl*60,Hu=Cu*24,FT=Hu*7,rI=Hu*30,Jx=Hu*365,nf=ns(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Mu)},(t,e)=>(e-t)/Mu,t=>t.getUTCSeconds());nf.range;const NT=ns(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Mu)},(t,e)=>{t.setTime(+t+e*cl)},(t,e)=>(e-t)/cl,t=>t.getMinutes());NT.range;const Kre=ns(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*cl)},(t,e)=>(e-t)/cl,t=>t.getUTCMinutes());Kre.range;const UT=ns(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Mu-t.getMinutes()*cl)},(t,e)=>{t.setTime(+t+e*Cu)},(t,e)=>(e-t)/Cu,t=>t.getHours());UT.range;const Jre=ns(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Cu)},(t,e)=>(e-t)/Cu,t=>t.getUTCHours());Jre.range;const Jg=ns(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*cl)/Hu,t=>t.getDate()-1);Jg.range;const VT=ns(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Hu,t=>t.getUTCDate()-1);VT.range;const ese=ns(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Hu,t=>Math.floor(t/Hu));ese.range;function c0(t){return ns(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*cl)/FT)}const T2=c0(0),y_=c0(1),tse=c0(2),nse=c0(3),Zf=c0(4),ise=c0(5),rse=c0(6);T2.range;y_.range;tse.range;nse.range;Zf.range;ise.range;rse.range;function h0(t){return ns(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/FT)}const XB=h0(0),__=h0(1),sse=h0(2),ose=h0(3),Yf=h0(4),ase=h0(5),lse=h0(6);XB.range;__.range;sse.range;ose.range;Yf.range;ase.range;lse.range;const GT=ns(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());GT.range;const Ase=ns(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Ase.range;const Wu=ns(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Wu.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:ns(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});Wu.range;const Wh=ns(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Wh.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:ns(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});Wh.range;function use(t,e,n,i,r,s){const u=[[nf,1,Mu],[nf,5,5*Mu],[nf,15,15*Mu],[nf,30,30*Mu],[s,1,cl],[s,5,5*cl],[s,15,15*cl],[s,30,30*cl],[r,1,Cu],[r,3,3*Cu],[r,6,6*Cu],[r,12,12*Cu],[i,1,Hu],[i,2,2*Hu],[n,1,FT],[e,1,rI],[e,3,3*rI],[t,1,Jx]];function a(w,I,P){const L=I<w;L&&([w,I]=[I,w]);const U=P&&typeof P.range=="function"?P:y(w,I,P),Q=U?U.range(w,+I+1):[];return L?Q.reverse():Q}function y(w,I,P){const L=Math.abs(I-w)/P,U=ET(([,,ae])=>ae).right(u,L);if(U===u.length)return t.every(e3(w/Jx,I/Jx,P));if(U===0)return m_.every(Math.max(e3(w,I,P),1));const[Q,Z]=u[L/u[U-1][2]<u[U][2]/L?U-1:U];return Q.every(Z)}return[a,y]}const[cse,hse]=use(Wu,GT,T2,Jg,UT,NT);function ew(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function tw(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function ep(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function fse(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,s=t.days,u=t.shortDays,a=t.months,y=t.shortMonths,w=tp(r),I=np(r),P=tp(s),L=np(s),U=tp(u),Q=np(u),Z=tp(a),ae=np(a),Y=tp(y),te=np(y),re={a:fn,A:mt,b:bt,B:Kt,c:null,d:uI,e:uI,f:zse,g:Wse,G:qse,H:Dse,I:Rse,j:Bse,L:KB,m:Ose,M:Fse,p:In,q:En,Q:fI,s:dI,S:Nse,u:Use,U:Vse,V:Gse,w:jse,W:$se,x:null,X:null,y:Hse,Y:Qse,Z:Zse,"%":hI},de={a:Si,A:Jn,b:oi,B:ci,c:null,d:cI,e:cI,f:Jse,g:Aoe,G:coe,H:Yse,I:Xse,j:Kse,L:ez,m:eoe,M:toe,p:Nn,q:bi,Q:fI,s:dI,S:noe,u:ioe,U:roe,V:soe,w:ooe,W:aoe,x:null,X:null,y:loe,Y:uoe,Z:hoe,"%":hI},ve={a:tt,A:Ve,b:nt,B:Ye,c:gt,d:lI,e:lI,f:Pse,g:aI,G:oI,H:AI,I:AI,j:Tse,L:Cse,m:Ese,M:Sse,p:et,q:bse,Q:kse,s:Lse,S:Mse,u:yse,U:_se,V:vse,w:mse,W:xse,x:Xt,X:Et,y:aI,Y:oI,Z:wse,"%":Ise};re.x=Me(n,re),re.X=Me(i,re),re.c=Me(e,re),de.x=Me(n,de),de.X=Me(i,de),de.c=Me(e,de);function Me(xt,nn){return function(Mn){var vt=[],ei=-1,$n=0,yi=xt.length,li,ti,Ki;for(Mn instanceof Date||(Mn=new Date(+Mn));++ei<yi;)xt.charCodeAt(ei)===37&&(vt.push(xt.slice($n,ei)),(ti=sI[li=xt.charAt(++ei)])!=null?li=xt.charAt(++ei):ti=li==="e"?" ":"0",(Ki=nn[li])&&(li=Ki(Mn,ti)),vt.push(li),$n=ei+1);return vt.push(xt.slice($n,ei)),vt.join("")}}function He(xt,nn){return function(Mn){var vt=ep(1900,void 0,1),ei=Qe(vt,xt,Mn+="",0),$n,yi;if(ei!=Mn.length)return null;if("Q"in vt)return new Date(vt.Q);if("s"in vt)return new Date(vt.s*1e3+("L"in vt?vt.L:0));if(nn&&!("Z"in vt)&&(vt.Z=0),"p"in vt&&(vt.H=vt.H%12+vt.p*12),vt.m===void 0&&(vt.m="q"in vt?vt.q:0),"V"in vt){if(vt.V<1||vt.V>53)return null;"w"in vt||(vt.w=1),"Z"in vt?($n=tw(ep(vt.y,0,1)),yi=$n.getUTCDay(),$n=yi>4||yi===0?__.ceil($n):__($n),$n=VT.offset($n,(vt.V-1)*7),vt.y=$n.getUTCFullYear(),vt.m=$n.getUTCMonth(),vt.d=$n.getUTCDate()+(vt.w+6)%7):($n=ew(ep(vt.y,0,1)),yi=$n.getDay(),$n=yi>4||yi===0?y_.ceil($n):y_($n),$n=Jg.offset($n,(vt.V-1)*7),vt.y=$n.getFullYear(),vt.m=$n.getMonth(),vt.d=$n.getDate()+(vt.w+6)%7)}else("W"in vt||"U"in vt)&&("w"in vt||(vt.w="u"in vt?vt.u%7:"W"in vt?1:0),yi="Z"in vt?tw(ep(vt.y,0,1)).getUTCDay():ew(ep(vt.y,0,1)).getDay(),vt.m=0,vt.d="W"in vt?(vt.w+6)%7+vt.W*7-(yi+5)%7:vt.w+vt.U*7-(yi+6)%7);return"Z"in vt?(vt.H+=vt.Z/100|0,vt.M+=vt.Z%100,tw(vt)):ew(vt)}}function Qe(xt,nn,Mn,vt){for(var ei=0,$n=nn.length,yi=Mn.length,li,ti;ei<$n;){if(vt>=yi)return-1;if(li=nn.charCodeAt(ei++),li===37){if(li=nn.charAt(ei++),ti=ve[li in sI?nn.charAt(ei++):li],!ti||(vt=ti(xt,Mn,vt))<0)return-1}else if(li!=Mn.charCodeAt(vt++))return-1}return vt}function et(xt,nn,Mn){var vt=w.exec(nn.slice(Mn));return vt?(xt.p=I.get(vt[0].toLowerCase()),Mn+vt[0].length):-1}function tt(xt,nn,Mn){var vt=U.exec(nn.slice(Mn));return vt?(xt.w=Q.get(vt[0].toLowerCase()),Mn+vt[0].length):-1}function Ve(xt,nn,Mn){var vt=P.exec(nn.slice(Mn));return vt?(xt.w=L.get(vt[0].toLowerCase()),Mn+vt[0].length):-1}function nt(xt,nn,Mn){var vt=Y.exec(nn.slice(Mn));return vt?(xt.m=te.get(vt[0].toLowerCase()),Mn+vt[0].length):-1}function Ye(xt,nn,Mn){var vt=Z.exec(nn.slice(Mn));return vt?(xt.m=ae.get(vt[0].toLowerCase()),Mn+vt[0].length):-1}function gt(xt,nn,Mn){return Qe(xt,e,nn,Mn)}function Xt(xt,nn,Mn){return Qe(xt,n,nn,Mn)}function Et(xt,nn,Mn){return Qe(xt,i,nn,Mn)}function fn(xt){return u[xt.getDay()]}function mt(xt){return s[xt.getDay()]}function bt(xt){return y[xt.getMonth()]}function Kt(xt){return a[xt.getMonth()]}function In(xt){return r[+(xt.getHours()>=12)]}function En(xt){return 1+~~(xt.getMonth()/3)}function Si(xt){return u[xt.getUTCDay()]}function Jn(xt){return s[xt.getUTCDay()]}function oi(xt){return y[xt.getUTCMonth()]}function ci(xt){return a[xt.getUTCMonth()]}function Nn(xt){return r[+(xt.getUTCHours()>=12)]}function bi(xt){return 1+~~(xt.getUTCMonth()/3)}return{format:function(xt){var nn=Me(xt+="",re);return nn.toString=function(){return xt},nn},parse:function(xt){var nn=He(xt+="",!1);return nn.toString=function(){return xt},nn},utcFormat:function(xt){var nn=Me(xt+="",de);return nn.toString=function(){return xt},nn},utcParse:function(xt){var nn=He(xt+="",!0);return nn.toString=function(){return xt},nn}}}var sI={"-":"",_:" ",0:"0"},_s=/^\s*\d+/,dse=/^%/,pse=/[\\^$*+?|[\]().{}]/g;function Ti(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(e)+r:r)}function gse(t){return t.replace(pse,"\\$&")}function tp(t){return new RegExp("^(?:"+t.map(gse).join("|")+")","i")}function np(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function mse(t,e,n){var i=_s.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function yse(t,e,n){var i=_s.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function _se(t,e,n){var i=_s.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function vse(t,e,n){var i=_s.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function xse(t,e,n){var i=_s.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function oI(t,e,n){var i=_s.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function aI(t,e,n){var i=_s.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function wse(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function bse(t,e,n){var i=_s.exec(e.slice(n,n+1));return i?(t.q=i[0]*3-3,n+i[0].length):-1}function Ese(t,e,n){var i=_s.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function lI(t,e,n){var i=_s.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function Tse(t,e,n){var i=_s.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function AI(t,e,n){var i=_s.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function Sse(t,e,n){var i=_s.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function Mse(t,e,n){var i=_s.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function Cse(t,e,n){var i=_s.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function Pse(t,e,n){var i=_s.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function Ise(t,e,n){var i=dse.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function kse(t,e,n){var i=_s.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function Lse(t,e,n){var i=_s.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function uI(t,e){return Ti(t.getDate(),e,2)}function Dse(t,e){return Ti(t.getHours(),e,2)}function Rse(t,e){return Ti(t.getHours()%12||12,e,2)}function Bse(t,e){return Ti(1+Jg.count(Wu(t),t),e,3)}function KB(t,e){return Ti(t.getMilliseconds(),e,3)}function zse(t,e){return KB(t,e)+"000"}function Ose(t,e){return Ti(t.getMonth()+1,e,2)}function Fse(t,e){return Ti(t.getMinutes(),e,2)}function Nse(t,e){return Ti(t.getSeconds(),e,2)}function Use(t){var e=t.getDay();return e===0?7:e}function Vse(t,e){return Ti(T2.count(Wu(t)-1,t),e,2)}function JB(t){var e=t.getDay();return e>=4||e===0?Zf(t):Zf.ceil(t)}function Gse(t,e){return t=JB(t),Ti(Zf.count(Wu(t),t)+(Wu(t).getDay()===4),e,2)}function jse(t){return t.getDay()}function $se(t,e){return Ti(y_.count(Wu(t)-1,t),e,2)}function Hse(t,e){return Ti(t.getFullYear()%100,e,2)}function Wse(t,e){return t=JB(t),Ti(t.getFullYear()%100,e,2)}function Qse(t,e){return Ti(t.getFullYear()%1e4,e,4)}function qse(t,e){var n=t.getDay();return t=n>=4||n===0?Zf(t):Zf.ceil(t),Ti(t.getFullYear()%1e4,e,4)}function Zse(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ti(e/60|0,"0",2)+Ti(e%60,"0",2)}function cI(t,e){return Ti(t.getUTCDate(),e,2)}function Yse(t,e){return Ti(t.getUTCHours(),e,2)}function Xse(t,e){return Ti(t.getUTCHours()%12||12,e,2)}function Kse(t,e){return Ti(1+VT.count(Wh(t),t),e,3)}function ez(t,e){return Ti(t.getUTCMilliseconds(),e,3)}function Jse(t,e){return ez(t,e)+"000"}function eoe(t,e){return Ti(t.getUTCMonth()+1,e,2)}function toe(t,e){return Ti(t.getUTCMinutes(),e,2)}function noe(t,e){return Ti(t.getUTCSeconds(),e,2)}function ioe(t){var e=t.getUTCDay();return e===0?7:e}function roe(t,e){return Ti(XB.count(Wh(t)-1,t),e,2)}function tz(t){var e=t.getUTCDay();return e>=4||e===0?Yf(t):Yf.ceil(t)}function soe(t,e){return t=tz(t),Ti(Yf.count(Wh(t),t)+(Wh(t).getUTCDay()===4),e,2)}function ooe(t){return t.getUTCDay()}function aoe(t,e){return Ti(__.count(Wh(t)-1,t),e,2)}function loe(t,e){return Ti(t.getUTCFullYear()%100,e,2)}function Aoe(t,e){return t=tz(t),Ti(t.getUTCFullYear()%100,e,2)}function uoe(t,e){return Ti(t.getUTCFullYear()%1e4,e,4)}function coe(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Yf(t):Yf.ceil(t),Ti(t.getUTCFullYear()%1e4,e,4)}function hoe(){return"+0000"}function hI(){return"%"}function fI(t){return+t}function dI(t){return Math.floor(+t/1e3)}var O0,nz;foe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function foe(t){return O0=fse(t),nz=O0.format,O0.parse,O0.utcFormat,O0.utcParse,O0}function doe(t){return new Date(t)}function poe(t){return t instanceof Date?+t:+new Date(+t)}function iz(t,e,n,i,r,s,u,a,y,w){var I=ZB(),P=I.invert,L=I.domain,U=w(".%L"),Q=w(":%S"),Z=w("%I:%M"),ae=w("%I %p"),Y=w("%a %d"),te=w("%b %d"),re=w("%B"),de=w("%Y");function ve(Me){return(y(Me)<Me?U:a(Me)<Me?Q:u(Me)<Me?Z:s(Me)<Me?ae:i(Me)<Me?r(Me)<Me?Y:te:n(Me)<Me?re:de)(Me)}return I.invert=function(Me){return new Date(P(Me))},I.domain=function(Me){return arguments.length?L(Array.from(Me,poe)):L().map(doe)},I.ticks=function(Me){var He=L();return t(He[0],He[He.length-1],Me??10)},I.tickFormat=function(Me,He){return He==null?ve:w(He)},I.nice=function(Me){var He=L();return(!Me||typeof Me.range!="function")&&(Me=e(He[0],He[He.length-1],Me??10)),Me?L(Xre(He,Me)):I},I.copy=function(){return qB(I,iz(t,e,n,i,r,s,u,a,y,w))},I}function goe(){return OT.apply(iz(cse,hse,Wu,GT,T2,Jg,UT,NT,nf,nz).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function fd(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}const dd=t=>Kne(t[t.length-1]);var moe=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(fd);const yoe=dd(moe);var _oe=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(fd);const rz=dd(_oe);var voe=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(fd);const xoe=dd(voe);var woe=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(fd);const boe=dd(woe);var Eoe=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(fd);const Toe=dd(Eoe);var Soe=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(fd);const sz=dd(Soe);function Ko(t){return function(){return t}}const pI=Math.abs,eo=Math.atan2,gh=Math.cos,Moe=Math.max,nw=Math.min,EA=Math.sin,rf=Math.sqrt,io=1e-12,gg=Math.PI,v_=gg/2,Coe=2*gg;function Poe(t){return t>1?0:t<-1?gg:Math.acos(t)}function gI(t){return t>=1?v_:t<=-1?-v_:Math.asin(t)}function oz(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);e=i}return t},()=>new Tre(e)}function Ioe(t){return t.innerRadius}function koe(t){return t.outerRadius}function Loe(t){return t.startAngle}function Doe(t){return t.endAngle}function Roe(t){return t&&t.padAngle}function Boe(t,e,n,i,r,s,u,a){var y=n-t,w=i-e,I=u-r,P=a-s,L=P*y-I*w;if(!(L*L<io))return L=(I*(e-s)-P*(t-r))/L,[t+L*y,e+L*w]}function d1(t,e,n,i,r,s,u){var a=t-n,y=e-i,w=(u?s:-s)/rf(a*a+y*y),I=w*y,P=-w*a,L=t+I,U=e+P,Q=n+I,Z=i+P,ae=(L+Q)/2,Y=(U+Z)/2,te=Q-L,re=Z-U,de=te*te+re*re,ve=r-s,Me=L*Z-Q*U,He=(re<0?-1:1)*rf(Moe(0,ve*ve*de-Me*Me)),Qe=(Me*re-te*He)/de,et=(-Me*te-re*He)/de,tt=(Me*re+te*He)/de,Ve=(-Me*te+re*He)/de,nt=Qe-ae,Ye=et-Y,gt=tt-ae,Xt=Ve-Y;return nt*nt+Ye*Ye>gt*gt+Xt*Xt&&(Qe=tt,et=Ve),{cx:Qe,cy:et,x01:-I,y01:-P,x11:Qe*(r/ve-1),y11:et*(r/ve-1)}}function mI(){var t=Ioe,e=koe,n=Ko(0),i=null,r=Loe,s=Doe,u=Roe,a=null,y=oz(w);function w(){var I,P,L=+t.apply(this,arguments),U=+e.apply(this,arguments),Q=r.apply(this,arguments)-v_,Z=s.apply(this,arguments)-v_,ae=pI(Z-Q),Y=Z>Q;if(a||(a=I=y()),U<L&&(P=U,U=L,L=P),!(U>io))a.moveTo(0,0);else if(ae>Coe-io)a.moveTo(U*gh(Q),U*EA(Q)),a.arc(0,0,U,Q,Z,!Y),L>io&&(a.moveTo(L*gh(Z),L*EA(Z)),a.arc(0,0,L,Z,Q,Y));else{var te=Q,re=Z,de=Q,ve=Z,Me=ae,He=ae,Qe=u.apply(this,arguments)/2,et=Qe>io&&(i?+i.apply(this,arguments):rf(L*L+U*U)),tt=nw(pI(U-L)/2,+n.apply(this,arguments)),Ve=tt,nt=tt,Ye,gt;if(et>io){var Xt=gI(et/L*EA(Qe)),Et=gI(et/U*EA(Qe));(Me-=Xt*2)>io?(Xt*=Y?1:-1,de+=Xt,ve-=Xt):(Me=0,de=ve=(Q+Z)/2),(He-=Et*2)>io?(Et*=Y?1:-1,te+=Et,re-=Et):(He=0,te=re=(Q+Z)/2)}var fn=U*gh(te),mt=U*EA(te),bt=L*gh(ve),Kt=L*EA(ve);if(tt>io){var In=U*gh(re),En=U*EA(re),Si=L*gh(de),Jn=L*EA(de),oi;if(ae<gg)if(oi=Boe(fn,mt,Si,Jn,In,En,bt,Kt)){var ci=fn-oi[0],Nn=mt-oi[1],bi=In-oi[0],xt=En-oi[1],nn=1/EA(Poe((ci*bi+Nn*xt)/(rf(ci*ci+Nn*Nn)*rf(bi*bi+xt*xt)))/2),Mn=rf(oi[0]*oi[0]+oi[1]*oi[1]);Ve=nw(tt,(L-Mn)/(nn-1)),nt=nw(tt,(U-Mn)/(nn+1))}else Ve=nt=0}He>io?nt>io?(Ye=d1(Si,Jn,fn,mt,U,nt,Y),gt=d1(In,En,bt,Kt,U,nt,Y),a.moveTo(Ye.cx+Ye.x01,Ye.cy+Ye.y01),nt<tt?a.arc(Ye.cx,Ye.cy,nt,eo(Ye.y01,Ye.x01),eo(gt.y01,gt.x01),!Y):(a.arc(Ye.cx,Ye.cy,nt,eo(Ye.y01,Ye.x01),eo(Ye.y11,Ye.x11),!Y),a.arc(0,0,U,eo(Ye.cy+Ye.y11,Ye.cx+Ye.x11),eo(gt.cy+gt.y11,gt.cx+gt.x11),!Y),a.arc(gt.cx,gt.cy,nt,eo(gt.y11,gt.x11),eo(gt.y01,gt.x01),!Y))):(a.moveTo(fn,mt),a.arc(0,0,U,te,re,!Y)):a.moveTo(fn,mt),!(L>io)||!(Me>io)?a.lineTo(bt,Kt):Ve>io?(Ye=d1(bt,Kt,In,En,L,-Ve,Y),gt=d1(fn,mt,Si,Jn,L,-Ve,Y),a.lineTo(Ye.cx+Ye.x01,Ye.cy+Ye.y01),Ve<tt?a.arc(Ye.cx,Ye.cy,Ve,eo(Ye.y01,Ye.x01),eo(gt.y01,gt.x01),!Y):(a.arc(Ye.cx,Ye.cy,Ve,eo(Ye.y01,Ye.x01),eo(Ye.y11,Ye.x11),!Y),a.arc(0,0,L,eo(Ye.cy+Ye.y11,Ye.cx+Ye.x11),eo(gt.cy+gt.y11,gt.cx+gt.x11),Y),a.arc(gt.cx,gt.cy,Ve,eo(gt.y11,gt.x11),eo(gt.y01,gt.x01),!Y))):a.arc(0,0,L,ve,de,Y)}if(a.closePath(),I)return a=null,I+""||null}return w.centroid=function(){var I=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,P=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-gg/2;return[gh(P)*I,EA(P)*I]},w.innerRadius=function(I){return arguments.length?(t=typeof I=="function"?I:Ko(+I),w):t},w.outerRadius=function(I){return arguments.length?(e=typeof I=="function"?I:Ko(+I),w):e},w.cornerRadius=function(I){return arguments.length?(n=typeof I=="function"?I:Ko(+I),w):n},w.padRadius=function(I){return arguments.length?(i=I==null?null:typeof I=="function"?I:Ko(+I),w):i},w.startAngle=function(I){return arguments.length?(r=typeof I=="function"?I:Ko(+I),w):r},w.endAngle=function(I){return arguments.length?(s=typeof I=="function"?I:Ko(+I),w):s},w.padAngle=function(I){return arguments.length?(u=typeof I=="function"?I:Ko(+I),w):u},w.context=function(I){return arguments.length?(a=I??null,w):a},w}function zoe(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function az(t){this._context=t}az.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function lz(t){return new az(t)}function Ooe(t){return t[0]}function Foe(t){return t[1]}function Noe(t,e){var n=Ko(!0),i=null,r=lz,s=null,u=oz(a);t=typeof t=="function"?t:t===void 0?Ooe:Ko(t),e=typeof e=="function"?e:e===void 0?Foe:Ko(e);function a(y){var w,I=(y=zoe(y)).length,P,L=!1,U;for(i==null&&(s=r(U=u())),w=0;w<=I;++w)!(w<I&&n(P=y[w],w,y))===L&&((L=!L)?s.lineStart():s.lineEnd()),L&&s.point(+t(P,w,y),+e(P,w,y));if(U)return s=null,U+""||null}return a.x=function(y){return arguments.length?(t=typeof y=="function"?y:Ko(+y),a):t},a.y=function(y){return arguments.length?(e=typeof y=="function"?y:Ko(+y),a):e},a.defined=function(y){return arguments.length?(n=typeof y=="function"?y:Ko(!!y),a):n},a.curve=function(y){return arguments.length?(r=y,i!=null&&(s=r(i)),a):r},a.context=function(y){return arguments.length?(y==null?i=s=null:s=r(i=y),a):i},a}var Uoe=uz(lz);function Az(t){this._curve=t}Az.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};function uz(t){function e(n){return new Az(t(n))}return e._curve=t,e}function Voe(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(n){return arguments.length?e(uz(n)):e()._curve},t}function yI(){return Voe(Noe().curve(Uoe))}function _I(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function jT(t,e){this._context=t,this._k=(1-e)/6}jT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:_I(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:_I(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(i){return new jT(i,e)}return n.tension=function(i){return t(+i)},n})(0);function Goe(t,e,n){var i=t._x1,r=t._y1,s=t._x2,u=t._y2;if(t._l01_a>io){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,y=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/y,r=(r*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/y}if(t._l23_a>io){var w=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,I=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*w+t._x1*t._l23_2a-e*t._l12_2a)/I,u=(u*w+t._y1*t._l23_2a-n*t._l12_2a)/I}t._context.bezierCurveTo(i,r,s,u,t._x2,t._y2)}function cz(t,e){this._context=t,this._alpha=e}cz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Goe(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const vI=function t(e){function n(i){return e?new cz(i,e):new jT(i,0)}return n.alpha=function(i){return t(+i)},n}(.5);function xp(t,e,n){this.k=t,this.x=e,this.y=n}xp.prototype={constructor:xp,scale:function(t){return t===1?this:new xp(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new xp(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};xp.prototype;function c3(t,e){return t+e}function Fa(t,e=1,n=1){if(typeof t=="function")return u=>Fa(t(u),e,n);Array.isArray(t)&&(t=dg(...t).toString());const{l:i,c:r,h:s}=GP(t);return GP(i+18*n,r+18*e,s).toString()}function ks(t,e,n){let i={};return n||(n=[]),Object.keys(t).forEach(r=>{if(n.includes(r))return;let s=t[r],u={};Object.keys(s).forEach(a=>{e(s[a])&&(u[a]=s[a])}),i[r]=u}),i}function joe(t,e){return t.reduce(function(n,i){return n[e(i)]=i,n},{})}const Kc=[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,0],[-.67,0,0],[.67,0,0],[-.33,.58,0],[.33,.58,0],[-.33,-.58,0],[.33,-.58,0]]],$oe=[[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]]],[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,0],[-.67,0,0],[.67,0,0],[-.33,.58,0],[.33,.58,0],[-.33,-.58,0],[.33,-.58,0]]]],em=ks(await(await fetch("./assets/hex_5_6.json")).json(),t=>t.DemandBaseline),iw=await(await fetch("./assets/averages.json")).json(),Qh=await(await fetch("./assets/demand_geo.json")).json(),xI=joe(Qh.features,t=>t.properties.DU_ID),Hoe=await(await fetch("./assets/groundwater_geo.json")).json(),Woe=new Uint16Array([0,2,1,0,3,2]),Qoe=new Float32Array([0,1,0,0,1,0,1,1]);function qoe(t,e){if(!e)return Zoe(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),i=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),r=Math.ceil(n/e)+1,s=Math.ceil(i/e)+1,u=(r-1)*(s-1)*6,a=new Uint32Array(u),y=new Float32Array(r*s*2),w=new Float64Array(r*s*3);let I=0,P=0;for(let L=0;L<r;L++){const U=L/(r-1);for(let Q=0;Q<s;Q++){const Z=Q/(s-1),ae=Yoe(t,U,Z);w[I*3+0]=ae[0],w[I*3+1]=ae[1],w[I*3+2]=ae[2]||0,y[I*2+0]=U,y[I*2+1]=1-Z,L>0&&Q>0&&(a[P++]=I-s,a[P++]=I-s-1,a[P++]=I-1,a[P++]=I-s,a[P++]=I-1,a[P++]=I),I++}}return{vertexCount:u,positions:w,indices:a,texCoords:y}}function Zoe(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:Woe,texCoords:Qoe}}function Yoe(t,e,n){return BA(BA(t[0],t[1],n),BA(t[3],t[2],n),e)}const Xoe=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,Koe=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,Joe=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(Koe,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive && !picking_uAttribute) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),eae={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:Ai.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class S2 extends iA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:Xoe,fs:Joe,modules:[o0,a0]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:i=>i.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:i=>i.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:i=>i.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:i}){const r=this.getAttributeManager();if(i.extensionsChanged){var s;const{gl:u}=this.context;(s=this.state.model)===null||s===void 0||s.delete(),this.state.model=this._getModel(u),r.invalidateAll()}if(e.bounds!==n.bounds){const u=this.state.mesh,a=this._createMesh();this.state.model.setVertexCount(a.vertexCount);for(const y in a)u&&u[y]!==a[y]&&r.invalidate(y);this.setState({mesh:a,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,i=e.info;if(!i.color||!n)return i.bitmap=null,i;const{width:r,height:s}=n;i.index=0;const u=tae(i.color),a=[Math.floor(u[0]*r),Math.floor(u[1]*s)];return i.bitmap={size:{width:r,height:s},uv:u,pixel:a},i}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return wI(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),qoe(n,this.context.viewport.resolution)}_getModel(e){return e?new Gu(e,{...this.getShaders(),id:this.props.id,geometry:new Ru({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:i}=e,{model:r,coordinateConversion:s,bounds:u,disablePicking:a}=this.state,{image:y,desaturate:w,transparentColor:I,tintColor:P}=this.props;i.pickingActive&&a||y&&r&&r.setUniforms(n).setUniforms({bitmapTexture:y,desaturate:w,transparentColor:I.map(L=>L/255),tintColor:P.slice(0,3).map(L=>L/255),coordinateConversion:s,bounds:u}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:i}=Ai;let{_imageCoordinateSystem:r}=this.props;if(r!==i){const{bounds:s}=this.props;if(!wI(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const u=this.context.viewport.resolution?e:n;if(r=r===e?e:n,r===e&&u===n)return{coordinateConversion:-1,bounds:s};if(r===n&&u===e){const a=GA([s[0],s[1]]),y=GA([s[2],s[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],y[0],y[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}oe(S2,"layerName","BitmapLayer");oe(S2,"defaultProps",eae);function tae(t){const[e,n,i]=t,r=(i&240)/256,s=(i&15)/16;return[(e+s)/256,(n+r)/256]}function wI(t){return Number.isFinite(t[0])}const nae=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,iae=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,rae=1024,sae=4,bI=()=>{},EI={10241:9987,10240:9729,10242:33071,10243:33071};function oae(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function aae(t,e,n,i){const r=Math.min(n/e.width,i/e.height),s=Math.floor(e.width*r),u=Math.floor(e.height*r);return r===1?{data:e,width:s,height:u}:(t.canvas.height=u,t.canvas.width=s,t.clearRect(0,0,s,u),t.drawImage(e,0,0,e.width,e.height,0,0,s,u),{data:t.canvas,width:s,height:u})}function mg(t){return t&&(t.id||t.url)}function lae(t,e,n,i){const r=t.width,s=t.height,u=new oa(t.gl,{width:e,height:n,parameters:i});return J$(t,u,{targetY:0,width:r,height:s}),t.delete(),u}function TI(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:s}=e[i],u=mg(r);t[u]={...r,x:s,y:n}}}function Aae({icons:t,buffer:e,mapping:n={},xOffset:i=0,yOffset:r=0,rowHeight:s=0,canvasWidth:u}){let a=[];for(let y=0;y<t.length;y++){const w=t[y],I=mg(w);if(!n[I]){const{height:P,width:L}=w;i+L+e>u&&(TI(n,a,r),i=0,r=s+r+e,s=0,a=[]),a.push({icon:w,xOffset:i}),i=i+L+e,s=Math.max(s,P)}}return a.length>0&&TI(n,a,r),{mapping:n,rowHeight:s,xOffset:i,yOffset:r,canvasWidth:u,canvasHeight:oae(s+r+e)}}function uae(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:s}=cd(t);for(const u of r){s.index++;const a=e(u,s),y=mg(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[y]&&(!n[y]||a.url!==n[y].url)&&(i[y]={...a,source:u,sourceIndex:s.index})}return i}class cae{constructor(e,{onUpdate:n=bI,onError:i=bI}){oe(this,"gl",void 0),oe(this,"onUpdate",void 0),oe(this,"onError",void 0),oe(this,"_loadOptions",null),oe(this,"_texture",null),oe(this,"_externalTexture",null),oe(this,"_mapping",{}),oe(this,"_textureParameters",null),oe(this,"_pendingCount",0),oe(this,"_autoPacking",!1),oe(this,"_xOffset",0),oe(this,"_yOffset",0),oe(this,"_rowHeight",0),oe(this,"_buffer",sae),oe(this,"_canvasWidth",rae),oe(this,"_canvasHeight",0),oe(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=i}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?mg(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:i,iconMapping:r,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),r&&(this._mapping=r),i){var u;(u=this._texture)===null||u===void 0||u.delete(),this._texture=null,this._externalTexture=i}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const i=Object.values(uae(e,n,this._mapping)||{});if(i.length>0){const{mapping:r,xOffset:s,yOffset:u,rowHeight:a,canvasHeight:y}=Aae({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=r,this._xOffset=s,this._yOffset=u,this._canvasHeight=y,this._texture||(this._texture=new oa(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||EI})),this._texture.height!==this._canvasHeight&&(this._texture=lae(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||EI)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const i of e)this._pendingCount++,$y(i.url,this._loadOptions).then(r=>{const s=mg(i),u=this._mapping[s],{x:a,y,width:w,height:I}=u,{data:P,width:L,height:U}=aae(n,r,w,I);this._texture.setSubImageData({data:P,x:a+(w-L)/2,y:y+(I-U)/2,width:L,height:U}),u.width=L,u.height=U,this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const hz=[0,0,0,255],hae={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:hz},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class tm extends iA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:nae,fs:iae,modules:[o0,a0]})}initializeState(){this.state={iconManager:new cae(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:hz},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager(),{iconAtlas:u,iconMapping:a,data:y,getIcon:w,textureParameters:I}=n,{iconManager:P}=this.state,L=u||this.internalState.isAsyncPropLoading("iconAtlas");if(P.setProps({loadOptions:n.loadOptions,autoPacking:!L,iconAtlas:u,iconMapping:L?a:null,textureParameters:I}),L?i.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&P.packIcons(y,w),r.extensionsChanged){var U;const{gl:Q}=this.context;(U=this.state.model)===null||U===void 0||U.delete(),this.state.model=this._getModel(Q),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,sizeUnits:s,billboard:u,alphaCutoff:a}=this.props,{iconManager:y}=this.state,w=y.getTexture();w&&this.state.model.setUniforms(e).setUniforms({iconsTexture:w,iconsTextureDim:[w.width,w.height],sizeUnits:Nh[s],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,billboard:u,alphaCutoff:a}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new Gu(e,{...this.getShaders(),id:this.props.id,geometry:new Ru({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const i=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;i?i(e):si.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:i,anchorX:r=n/2,anchorY:s=i/2}=this.state.iconManager.getIconMapping(e);return[n/2-r,i/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:i,width:r,height:s}=this.state.iconManager.getIconMapping(e);return[n,i,r,s]}}oe(tm,"defaultProps",hae);oe(tm,"layerName","IconLayer");const fae=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,dae=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,SI=[0,0,0,255],pae={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:SI},getLineColor:{type:"accessor",value:SI},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class $T extends iA{getShaders(){return super.getShaders({vs:fae,fs:dae,modules:[o0,a0]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:i}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:i,radiusMinPixels:r,radiusMaxPixels:s,stroked:u,filled:a,billboard:y,antialiasing:w,lineWidthUnits:I,lineWidthScale:P,lineWidthMinPixels:L,lineWidthMaxPixels:U}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:u?1:0,filled:a,billboard:y,antialiasing:w,radiusUnits:Nh[n],radiusScale:i,radiusMinPixels:r,radiusMaxPixels:s,lineWidthUnits:Nh[I],lineWidthScale:P,lineWidthMinPixels:L,lineWidthMaxPixels:U}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new Gu(e,{...this.getShaders(),id:this.props.id,geometry:new Ru({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}oe($T,"defaultProps",pae);oe($T,"layerName","ScatterplotLayer");const fz={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function dz(t,e,n={}){return gae(t,n)!==e?(yae(t,n),!0):!1}function gae(t,e={}){return Math.sign(mae(t,e))}function mae(t,e={}){const{start:n=0,end:i=t.length}=e,r=e.size||2;let s=0;for(let u=n,a=i-r;u<i;u+=r)s+=(t[u]-t[a])*(t[u+1]+t[a+1]),a=u;return s/2}function yae(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,s=(i-n)/r,u=Math.floor(s/2);for(let a=0;a<u;++a){const y=n+a*r,w=n+(s-1-a)*r;for(let I=0;I<r;++I){const P=t[y+I];t[y+I]=t[w+I],t[w+I]=P}}}function Zl(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let s=0;s<n;s++)if(t[i-n+s]!==e[s]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function h3(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function yg(t,e,n,i,r=[]){const s=i+e*n;for(let u=0;u<n;u++)r[u]=t[s+u];return r}function f3(t,e,n,i,r=[]){let s,u;if(n&8)s=(i[3]-t[1])/(e[1]-t[1]),u=3;else if(n&4)s=(i[1]-t[1])/(e[1]-t[1]),u=1;else if(n&2)s=(i[2]-t[0])/(e[0]-t[0]),u=2;else if(n&1)s=(i[0]-t[0])/(e[0]-t[0]),u=0;else return null;for(let a=0;a<t.length;a++)r[a]=(u&1)===a?i[u]:s*(e[a]-t[a])+t[a];return r}function sy(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function pz(t,e){const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:s=[0,0],startIndex:u=0,endIndex:a=t.length}=e||{},y=(a-u)/n;let w=[];const I=[w],P=yg(t,0,n,u);let L,U;const Q=mz(P,r,s,[]),Z=[];Zl(w,P);for(let ae=1;ae<y;ae++){for(L=yg(t,ae,n,u,L),U=sy(L,Q);U;){f3(P,L,U,Q,Z);const Y=sy(Z,Q);Y&&(f3(P,Z,Y,Q,Z),U=Y),Zl(w,Z),h3(P,Z),vae(Q,r,U),i&&w.length>n&&(w=[],I.push(w),Zl(w,P)),U=sy(L,Q)}Zl(w,L),h3(P,L)}return i?I:I[0]}const MI=0,_ae=1;function p1(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function gz(t,e=null,n){if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:s=[0,0],edgeTypes:u=!1}=n||{},a=[],y=[{pos:t,types:u?new Array(t.length/i).fill(_ae):null,holes:e||[]}],w=[[],[]];let I=[];for(;y.length;){const{pos:P,types:L,holes:U}=y.shift();xae(P,i,U[0]||P.length,w),I=mz(w[0],r,s,I);const Q=sy(w[1],I);if(Q){let Z=CI(P,L,i,0,U[0]||P.length,I,Q);const ae={pos:Z[0].pos,types:Z[0].types,holes:[]},Y={pos:Z[1].pos,types:Z[1].types,holes:[]};y.push(ae,Y);for(let te=0;te<U.length;te++)Z=CI(P,L,i,U[te],U[te+1]||P.length,I,Q),Z[0]&&(ae.holes.push(ae.pos.length),ae.pos=p1(ae.pos,Z[0].pos),u&&(ae.types=p1(ae.types,Z[0].types))),Z[1]&&(Y.holes.push(Y.pos.length),Y.pos=p1(Y.pos,Z[1].pos),u&&(Y.types=p1(Y.types,Z[1].types)))}else{const Z={positions:P};u&&(Z.edgeTypes=L),U.length&&(Z.holeIndices=U),a.push(Z)}}return a}function CI(t,e,n,i,r,s,u){const a=(r-i)/n,y=[],w=[],I=[],P=[],L=[];let U,Q,Z;const ae=yg(t,a-1,n,i);let Y=Math.sign(u&8?ae[1]-s[3]:ae[0]-s[2]),te=e&&e[a-1],re=0,de=0;for(let ve=0;ve<a;ve++)U=yg(t,ve,n,i,U),Q=Math.sign(u&8?U[1]-s[3]:U[0]-s[2]),Z=e&&e[i/n+ve],Q&&Y&&Y!==Q&&(f3(ae,U,u,s,L),Zl(y,L)&&I.push(te),Zl(w,L)&&P.push(te)),Q<=0?(Zl(y,U)&&I.push(Z),re-=Q):I.length&&(I[I.length-1]=MI),Q>=0?(Zl(w,U)&&P.push(Z),de+=Q):P.length&&(P[P.length-1]=MI),h3(ae,U),Y=Q,te=Z;return[re?{pos:y,types:e&&I}:null,de?{pos:w,types:e&&P}:null]}function mz(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=s,i[2]=r+e,i[3]=s+e,i}function vae(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function xae(t,e,n,i){let r=1/0,s=-1/0,u=1/0,a=-1/0;for(let y=0;y<n;y+=e){const w=t[y],I=t[y+1];r=w<r?w:r,s=w>s?w:s,u=I<u?I:u,a=I>a?I:a}return i[0][0]=r,i[0][1]=u,i[1][0]=s,i[1][1]=a,i}const wae=85.051129;function bae(t,e){const{size:n=2,startIndex:i=0,endIndex:r=t.length,normalize:s=!0}=e||{},u=t.slice(i,r);yz(u,n,0,r-i);const a=pz(u,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const y of a)_z(y,n);return a}function Eae(t,e=null,n){const{size:i=2,normalize:r=!0,edgeTypes:s=!1}=n||{};e=e||[];const u=[],a=[];let y=0,w=0;for(let P=0;P<=e.length;P++){const L=e[P]||t.length,U=w,Q=Tae(t,i,y,L);for(let Z=Q;Z<L;Z++)u[w++]=t[Z];for(let Z=y;Z<Q;Z++)u[w++]=t[Z];yz(u,i,U,w),Sae(u,i,U,w,n?.maxLatitude),y=L,a[P]=w}a.pop();const I=gz(u,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(r)for(const P of I)_z(P.positions,i);return I}function Tae(t,e,n,i){let r=-1,s=-1;for(let u=n+1;u<i;u+=e){const a=Math.abs(t[u]);a>r&&(r=a,s=u-1)}return s}function Sae(t,e,n,i,r=wae){const s=t[n],u=t[i-e];if(Math.abs(s-u)>180){const a=yg(t,0,e,n);a[0]+=Math.round((u-s)/360)*360,Zl(t,a),a[1]=Math.sign(a[1])*r,Zl(t,a),a[0]=s,Zl(t,a)}}function yz(t,e,n,i){let r=t[0],s;for(let u=n;u<i;u+=e){s=t[u];const a=s-r;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[u]=r=s}}function _z(t,e){let n;const i=t.length/e;for(let s=0;s<i&&(n=t[s*e],(n+180)%360===0);s++);const r=-Math.round(n/360)*360;if(r!==0)for(let s=0;s<i;s++)t[s*e]+=r}function Mae(t,e,n,i){let r;if(Array.isArray(t[0])){const s=t.length*e;r=new Array(s);for(let u=0;u<t.length;u++)for(let a=0;a<e;a++)r[u*e+a]=t[u][a]||0}else r=t;return n?pz(r,{size:e,gridResolution:n}):i?bae(r,{size:e}):r}const Cae=1,Pae=2,rw=4;class Iae extends tB{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?Mae(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(PI(e)){let i=0;for(const r of e)i+=this.getGeometrySize(r);return i}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&PI(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const i=this.attributes.segmentTypes,r=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:u}=n;i.fill(0,s,s+u),r?(i[s]=rw,i[s+u-2]=rw):(i[s]+=Cae,i[s+u-2]+=Pae),i[s+u-1]=rw}_updatePositions(e,n){const{positions:i}=this.attributes;if(!i||!e)return;const{vertexStart:r,geometrySize:s}=n,u=new Array(3);for(let a=r,y=0;y<s;a++,y++)this.getPointOnPath(e,y,u),i[a*3]=u[0],i[a*3+1]=u[1],i[a*3+2]=u[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,i=[]){const{positionSize:r}=this;n*r>=e.length&&(n+=1-e.length/r);const s=n*r;return i[0]=e[s],i[1]=e[s+1],i[2]=r===3&&e[s+2]||0,i}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,i=e.length-n;return e[0]===e[i]&&e[1]===e[i+1]&&(n===2||e[2]===e[i+2])}}function PI(t){return Array.isArray(t[0])}const kae=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Lae=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,vz=[0,0,0,255],Dae={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:vz},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},sw={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class M2 extends iA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:kae,fs:Lae,modules:[o0,a0]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:sw,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:sw,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:sw,defaultValue:vz},instancePickingColors:{size:3,type:5121,accessor:(i,{index:r,target:s})=>this.encodePickingColor(i&&i.__source?i.__source.index:r,s)}}),this.setState({pathTesselator:new Iae({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:i}=e,r=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,y=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:y.getPath,buffers:y,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),i.dataChanged||r.invalidateAll()}if(i.extensionsChanged){var u;const{gl:a}=this.context;(u=this.state.model)===null||u===void 0||u.delete(),this.state.model=this._getModel(a),r.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(s=>s.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:i,billboard:r,miterLimit:s,widthUnits:u,widthScale:a,widthMinPixels:y,widthMaxPixels:w}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(i),billboard:r,widthUnits:Nh[u],widthScale:a,miterLimit:s,widthMinPixels:y,widthMaxPixels:w}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],i=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Gu(e,{...this.getShaders(),id:this.props.id,geometry:new Ru({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(i),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}oe(M2,"defaultProps",Dae);oe(M2,"layerName","PathLayer");var HT={exports:{}};HT.exports=C2;HT.exports.default=C2;function C2(t,e,n){n=n||2;var i=e&&e.length,r=i?e[0]*n:t.length,s=xz(t,0,r,n,!0),u=[];if(!s||s.next===s.prev)return u;var a,y,w,I,P,L,U;if(i&&(s=Fae(t,e,s,n)),t.length>80*n){a=w=t[0],y=I=t[1];for(var Q=n;Q<r;Q+=n)P=t[Q],L=t[Q+1],P<a&&(a=P),L<y&&(y=L),P>w&&(w=P),L>I&&(I=L);U=Math.max(w-a,I-y),U=U!==0?32767/U:0}return _g(s,u,n,a,y,U,0),u}function xz(t,e,n,i,r){var s,u;if(r===g3(t,e,n,i)>0)for(s=e;s<n;s+=i)u=II(s,t[s],t[s+1],u);else for(s=n-i;s>=e;s-=i)u=II(s,t[s],t[s+1],u);return u&&P2(u,u.next)&&(xg(u),u=u.next),u}function qh(t,e){if(!t)return t;e||(e=t);var n=t,i;do if(i=!1,!n.steiner&&(P2(n,n.next)||mr(n.prev,n,n.next)===0)){if(xg(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function _g(t,e,n,i,r,s,u){if(t){!u&&s&&jae(t,i,r,s);for(var a=t,y,w;t.prev!==t.next;){if(y=t.prev,w=t.next,s?Bae(t,i,r,s):Rae(t)){e.push(y.i/n|0),e.push(t.i/n|0),e.push(w.i/n|0),xg(t),t=w.next,a=w.next;continue}if(t=w,t===a){u?u===1?(t=zae(qh(t),e,n),_g(t,e,n,i,r,s,2)):u===2&&Oae(t,e,n,i,r,s):_g(qh(t),e,n,i,r,s,1);break}}}}function Rae(t){var e=t.prev,n=t,i=t.next;if(mr(e,n,i)>=0)return!1;for(var r=e.x,s=n.x,u=i.x,a=e.y,y=n.y,w=i.y,I=r<s?r<u?r:u:s<u?s:u,P=a<y?a<w?a:w:y<w?y:w,L=r>s?r>u?r:u:s>u?s:u,U=a>y?a>w?a:w:y>w?y:w,Q=i.next;Q!==e;){if(Q.x>=I&&Q.x<=L&&Q.y>=P&&Q.y<=U&&sf(r,a,s,y,u,w,Q.x,Q.y)&&mr(Q.prev,Q,Q.next)>=0)return!1;Q=Q.next}return!0}function Bae(t,e,n,i){var r=t.prev,s=t,u=t.next;if(mr(r,s,u)>=0)return!1;for(var a=r.x,y=s.x,w=u.x,I=r.y,P=s.y,L=u.y,U=a<y?a<w?a:w:y<w?y:w,Q=I<P?I<L?I:L:P<L?P:L,Z=a>y?a>w?a:w:y>w?y:w,ae=I>P?I>L?I:L:P>L?P:L,Y=d3(U,Q,e,n,i),te=d3(Z,ae,e,n,i),re=t.prevZ,de=t.nextZ;re&&re.z>=Y&&de&&de.z<=te;){if(re.x>=U&&re.x<=Z&&re.y>=Q&&re.y<=ae&&re!==r&&re!==u&&sf(a,I,y,P,w,L,re.x,re.y)&&mr(re.prev,re,re.next)>=0||(re=re.prevZ,de.x>=U&&de.x<=Z&&de.y>=Q&&de.y<=ae&&de!==r&&de!==u&&sf(a,I,y,P,w,L,de.x,de.y)&&mr(de.prev,de,de.next)>=0))return!1;de=de.nextZ}for(;re&&re.z>=Y;){if(re.x>=U&&re.x<=Z&&re.y>=Q&&re.y<=ae&&re!==r&&re!==u&&sf(a,I,y,P,w,L,re.x,re.y)&&mr(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;de&&de.z<=te;){if(de.x>=U&&de.x<=Z&&de.y>=Q&&de.y<=ae&&de!==r&&de!==u&&sf(a,I,y,P,w,L,de.x,de.y)&&mr(de.prev,de,de.next)>=0)return!1;de=de.nextZ}return!0}function zae(t,e,n){var i=t;do{var r=i.prev,s=i.next.next;!P2(r,s)&&wz(r,i,i.next,s)&&vg(r,s)&&vg(s,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),xg(i),xg(i.next),i=t=s),i=i.next}while(i!==t);return qh(i)}function Oae(t,e,n,i,r,s){var u=t;do{for(var a=u.next.next;a!==u.prev;){if(u.i!==a.i&&Wae(u,a)){var y=bz(u,a);u=qh(u,u.next),y=qh(y,y.next),_g(u,e,n,i,r,s,0),_g(y,e,n,i,r,s,0);return}a=a.next}u=u.next}while(u!==t)}function Fae(t,e,n,i){var r=[],s,u,a,y,w;for(s=0,u=e.length;s<u;s++)a=e[s]*i,y=s<u-1?e[s+1]*i:t.length,w=xz(t,a,y,i,!1),w===w.next&&(w.steiner=!0),r.push(Hae(w));for(r.sort(Nae),s=0;s<r.length;s++)n=Uae(r[s],n);return n}function Nae(t,e){return t.x-e.x}function Uae(t,e){var n=Vae(t,e);if(!n)return e;var i=bz(n,t);return qh(i,i.next),qh(n,n.next)}function Vae(t,e){var n=e,i=t.x,r=t.y,s=-1/0,u;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var a=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>s&&(s=a,u=n.x<n.next.x?n:n.next,a===i))return u}n=n.next}while(n!==e);if(!u)return null;var y=u,w=u.x,I=u.y,P=1/0,L;n=u;do i>=n.x&&n.x>=w&&i!==n.x&&sf(r<I?i:s,r,w,I,r<I?s:i,r,n.x,n.y)&&(L=Math.abs(r-n.y)/(i-n.x),vg(n,t)&&(L<P||L===P&&(n.x>u.x||n.x===u.x&&Gae(u,n)))&&(u=n,P=L)),n=n.next;while(n!==y);return u}function Gae(t,e){return mr(t.prev,t,e.prev)<0&&mr(e.next,t,t.next)<0}function jae(t,e,n,i){var r=t;do r.z===0&&(r.z=d3(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,$ae(r)}function $ae(t){var e,n,i,r,s,u,a,y,w=1;do{for(n=t,t=null,s=null,u=0;n;){for(u++,i=n,a=0,e=0;e<w&&(a++,i=i.nextZ,!!i);e++);for(y=w;a>0||y>0&&i;)a!==0&&(y===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,y--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,w*=2}while(u>1);return t}function d3(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Hae(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function sf(t,e,n,i,r,s,u,a){return(r-u)*(e-a)>=(t-u)*(s-a)&&(t-u)*(i-a)>=(n-u)*(e-a)&&(n-u)*(s-a)>=(r-u)*(i-a)}function Wae(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Qae(t,e)&&(vg(t,e)&&vg(e,t)&&qae(t,e)&&(mr(t.prev,t,e.prev)||mr(t,e.prev,e))||P2(t,e)&&mr(t.prev,t,t.next)>0&&mr(e.prev,e,e.next)>0)}function mr(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function P2(t,e){return t.x===e.x&&t.y===e.y}function wz(t,e,n,i){var r=m1(mr(t,e,n)),s=m1(mr(t,e,i)),u=m1(mr(n,i,t)),a=m1(mr(n,i,e));return!!(r!==s&&u!==a||r===0&&g1(t,n,e)||s===0&&g1(t,i,e)||u===0&&g1(n,t,i)||a===0&&g1(n,e,i))}function g1(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function m1(t){return t>0?1:t<0?-1:0}function Qae(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&wz(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function vg(t,e){return mr(t.prev,t,t.next)<0?mr(t,e,t.next)>=0&&mr(t,t.prev,e)>=0:mr(t,e,t.prev)<0||mr(t,t.next,e)<0}function qae(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function bz(t,e){var n=new p3(t.i,t.x,t.y),i=new p3(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function II(t,e,n,i){var r=new p3(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function xg(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function p3(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}C2.deviation=function(t,e,n,i){var r=e&&e.length,s=r?e[0]*n:t.length,u=Math.abs(g3(t,0,s,n));if(r)for(var a=0,y=e.length;a<y;a++){var w=e[a]*n,I=a<y-1?e[a+1]*n:t.length;u-=Math.abs(g3(t,w,I,n))}var P=0;for(a=0;a<i.length;a+=3){var L=i[a]*n,U=i[a+1]*n,Q=i[a+2]*n;P+=Math.abs((t[L]-t[Q])*(t[U+1]-t[L+1])-(t[L]-t[U])*(t[Q+1]-t[L+1]))}return u===0&&P===0?0:Math.abs((P-u)/u)};function g3(t,e,n,i){for(var r=0,s=e,u=n-i;s<n;s+=i)r+=(t[u]-t[s])*(t[s+1]+t[u+1]),u=s;return r}C2.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var u=0;u<e;u++)n.vertices.push(t[r][s][u]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n};var Zae=HT.exports;const Yae=Z_(Zae),y1=fz.CLOCKWISE,kI=fz.COUNTER_CLOCKWISE,Dc={isClosed:!0};function Xae(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function wp(t){return"positions"in t?t.positions:t}function oy(t){return"holeIndices"in t?t.holeIndices:null}function Kae(t){return Array.isArray(t[0])}function Jae(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function ele(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function tle(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}function LI(t,e,n,i,r){let s=e;const u=n.length;for(let a=0;a<u;a++)for(let y=0;y<i;y++)t[s++]=n[a][y]||0;if(!ele(n))for(let a=0;a<i;a++)t[s++]=n[0][a]||0;return Dc.start=e,Dc.end=s,Dc.size=i,dz(t,r,Dc),s}function DI(t,e,n,i,r=0,s,u){s=s||n.length;const a=s-r;if(a<=0)return e;let y=e;for(let w=0;w<a;w++)t[y++]=n[r+w];if(!tle(n,i,r,s))for(let w=0;w<i;w++)t[y++]=n[r+w];return Dc.start=e,Dc.end=y,Dc.size=i,dz(t,u,Dc),y}function Ez(t,e){Xae(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:s}=t;if(s){let u=0;for(let a=0;a<=s.length;a++)u=DI(n,u,r,e,s[a-1],s[a],a===0?y1:kI),i.push(u);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!Kae(t))return DI(n,0,t,e,0,n.length,y1),n;if(!Jae(t)){let r=0;for(const[s,u]of t.entries())r=LI(n,r,u,e,s===0?y1:kI),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return LI(n,0,t,e,y1),n}function ow(t,e,n){const i=t.length/3;let r=0;for(let s=0;s<i;s++){const u=(s+1)%i;r+=t[s*3+e]*t[u*3+n],r-=t[u*3+e]*t[s*3+n]}return Math.abs(r/2)}function RI(t,e,n,i){const r=t.length/3;for(let s=0;s<r;s++){const u=s*3,a=t[u+0],y=t[u+1],w=t[u+2];t[u+e]=a,t[u+n]=y,t[u+i]=w}}function nle(t,e,n,i){let r=oy(t);r&&(r=r.map(a=>a/e));let s=wp(t);const u=i&&e===3;if(n){const a=s.length;s=s.slice();const y=[];for(let w=0;w<a;w+=e){y[0]=s[w],y[1]=s[w+1],u&&(y[2]=s[w+2]);const I=n(y);s[w]=I[0],s[w+1]=I[1],u&&(s[w+2]=I[2])}}if(u){const a=ow(s,0,1),y=ow(s,0,2),w=ow(s,1,2);if(!a&&!y&&!w)return[];a>y&&a>w||(y>w?(n||(s=s.slice()),RI(s,0,2,1)):(n||(s=s.slice()),RI(s,2,0,1)))}return Yae(s,r,e)}class ile extends tB{constructor(e){const{fp64:n,IndexType:i=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:i,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=Ez(e,this.positionSize);return this.opts.resolution?gz(wp(n),oy(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?Eae(wp(n),oy(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(BI(e)){let n=0;for(const i of e)n+=this.getGeometrySize(i);return n}return wp(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&BI(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:i,indexStart:r}){const{attributes:s,indexStarts:u,typedArrayManager:a}=this;let y=s.indices;if(!y||!e)return;let w=r;const I=nle(e,this.positionSize,this.opts.preproject,this.opts.full3d);y=a.allocate(y,r+I.length,{copy:!0});for(let P=0;P<I.length;P++)y[w++]=I[P]+i;u[n+1]=r+I.length,s.indices=y}_updatePositions(e,{vertexStart:n,geometrySize:i}){const{attributes:{positions:r},positionSize:s}=this;if(!r||!e)return;const u=wp(e);for(let a=n,y=0;y<i;a++,y++){const w=u[y*s],I=u[y*s+1],P=s>2?u[y*s+2]:0;r[a*3]=w,r[a*3+1]=I,r[a*3+2]=P}}_updateVertexValid(e,{vertexStart:n,geometrySize:i}){const{positionSize:r}=this,s=this.attributes.vertexValid,u=e&&oy(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+i),u)for(let a=0;a<u.length;a++)s[n+u[a]/r-1]=0;s[n+i-1]=0}}function BI(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const Tz=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,rle=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(Tz,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),sle=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(Tz,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),ole=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,x_=[0,0,0,255],ale={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:x_},getLineColor:{type:"accessor",value:x_},material:!0},_1={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class I2 extends iA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?rle:sle,fs:ole,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[o0,iZ,a0]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:i}=this.props;const{_full3d:r}=this.props;n.isGeospatial&&i===Ai.DEFAULT&&(i=Ai.LNGLAT);let s;i===Ai.LNGLAT&&(r?s=n.projectPosition.bind(n):s=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new ile({preproject:s,fp64:this.use64bitPositions(),IndexType:!e||rT(e,Yi.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const u=this.getAttributeManager(),a=!0;u.remove(["instancePickingColors"]),u.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:a},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:_1,accessor:"getPolygon",update:this.calculatePositions,noAlloc:a,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:a},elevations:{size:1,transition:_1,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:_1,accessor:"getFillColor",defaultValue:x_,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:_1,accessor:"getLineColor",defaultValue:x_,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(y,{index:w,target:I})=>this.encodePickingColor(y&&y.__source?y.__source.index:w,I),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(s=>s.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:i,wireframe:r,elevationScale:s}=this.props,{topModel:u,sideModel:a,polygonTesselator:y}=this.state,w={...e,extruded:!!n,elevationScale:s};a&&(a.setInstanceCount(y.instanceCount-1),a.setUniforms(w),r&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),i&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),u&&(u.setVertexCount(y.vertexCount),u.setUniforms(w).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager();if(r.extensionsChanged||n.filled!==i.filled||n.extruded!==i.extruded){var a;(a=this.state.models)===null||a===void 0||a.forEach(y=>y.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:i}){if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,u=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:u.getPolygon,buffers:u,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:i,extruded:r}=this.props;let s,u;if(i){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1,s=new Gu(e,{...a,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(u=new Gu(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Ru({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),u.userData.excludeAttributes={indices:!0}),{models:[u,s].filter(Boolean),topModel:s,sideModel:u}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}oe(I2,"defaultProps",ale);oe(I2,"layerName","SolidPolygonLayer");function Sz({data:t,getIndex:e,dataRange:n,replace:i}){const{startRow:r=0,endRow:s=1/0}=n,u=t.length;let a=u,y=u;for(let L=0;L<u;L++){const U=e(t[L]);if(a>L&&U>=r&&(a=L),U>=s){y=L;break}}let w=a;const P=y-a!==i.length?t.slice(y):void 0;for(let L=0;L<i.length;L++)t[w++]=i[L];if(P){for(let L=0;L<P.length;L++)t[w++]=P[L];t.length=w}return{startRow:a,endRow:a+i.length}}const Mz=[0,0,0,255],lle=[0,0,0,255],Ale={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:lle},getLineColor:{type:"accessor",value:Mz},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class k2 extends Kn{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&si.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const i=this.state.paths.slice(),r=e.dataChanged.map(s=>Sz({data:i,getIndex:u=>u.__source.index,dataRange:s,replace:this._getPaths(s)}));this.setState({paths:i,pathsDiff:r})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:i,positionFormat:r,_normalize:s}=this.props,u=[],a=r==="XY"?2:3,{startRow:y,endRow:w}=e,{iterable:I,objectInfo:P}=cd(n,y,w);for(const L of I){P.index++;let U=i(L,P);s&&(U=Ez(U,a));const{holeIndices:Q}=U,Z=U.positions||U;if(Q)for(let ae=0;ae<=Q.length;ae++){const Y=Z.slice(Q[ae-1]||0,Q[ae]||Z.length);u.push(this.getSubLayerRow({path:Y},L,P.index))}else u.push(this.getSubLayerRow({path:Z},L,P.index))}return u}renderLayers(){const{data:e,_dataDiff:n,stroked:i,filled:r,extruded:s,wireframe:u,_normalize:a,_windingOrder:y,elevationScale:w,transitions:I,positionFormat:P}=this.props,{lineWidthUnits:L,lineWidthScale:U,lineWidthMinPixels:Q,lineWidthMaxPixels:Z,lineJointRounded:ae,lineMiterLimit:Y,lineDashJustified:te}=this.props,{getFillColor:re,getLineColor:de,getLineWidth:ve,getLineDashArray:Me,getElevation:He,getPolygon:Qe,updateTriggers:et,material:tt}=this.props,{paths:Ve,pathsDiff:nt}=this.state,Ye=this.getSubLayerClass("fill",I2),gt=this.getSubLayerClass("stroke",M2),Xt=this.shouldRenderSubLayer("fill",Ve)&&new Ye({_dataDiff:n,extruded:s,elevationScale:w,filled:r,wireframe:u,_normalize:a,_windingOrder:y,getElevation:He,getFillColor:re,getLineColor:s&&u?de:Mz,material:tt,transitions:I},this.getSubLayerProps({id:"fill",updateTriggers:et&&{getPolygon:et.getPolygon,getElevation:et.getElevation,getFillColor:et.getFillColor,lineColors:s&&u,getLineColor:et.getLineColor}}),{data:e,positionFormat:P,getPolygon:Qe}),Et=!s&&i&&this.shouldRenderSubLayer("stroke",Ve)&&new gt({_dataDiff:nt&&(()=>nt),widthUnits:L,widthScale:U,widthMinPixels:Q,widthMaxPixels:Z,jointRounded:ae,miterLimit:Y,dashJustified:te,_pathType:"loop",transitions:I&&{getWidth:I.getLineWidth,getColor:I.getLineColor,getPath:I.getPolygon},getColor:this.getSubLayerAccessor(de),getWidth:this.getSubLayerAccessor(ve),getDashArray:this.getSubLayerAccessor(Me)},this.getSubLayerProps({id:"stroke",updateTriggers:et&&{getWidth:et.getLineWidth,getColor:et.getLineColor,getDashArray:et.getLineDashArray}}),{data:Ve,positionFormat:P,getPath:fn=>fn.path});return[!s&&Xt,Et,s&&Xt]}}oe(k2,"layerName","PolygonLayer");oe(k2,"defaultProps",Ale);function ule(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[n];return n!==-1?cle(t,i,n):null}function cle(t,e,n){const i={properties:{...t.properties[e]}};for(const r in t.numericProps)i.properties[r]=t.numericProps[r].value[n];return i}function hle(t,e){const n={points:null,lines:null,polygons:null};for(const i in n){const r=t[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(r.length*3);const s=[];for(let u=0;u<r.length;u++)e(r[u],s),n[i][u*3+0]=s[0],n[i][u*3+1]=s[1],n[i][u*3+2]=s[2]}return n}const fle=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,aw=192/256,zI=[],dle={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class WT extends tm{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:fle}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:i,target:r})=>this.encodePickingColor(i,r)}})}updateState(e){super.updateState(e);const{props:n,oldProps:i}=e;let{outlineColor:r}=n;r!==i.outlineColor&&(r=r.map(s=>s/255),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!n.sdf&&n.outlineWidth&&si.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:i,outlineWidth:r}=this.props,{outlineColor:s}=this.state,u=r?Math.max(i,aw*(1-r)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:aw,outlineBuffer:u,gamma:i,sdf:!!n,outlineColor:s},super.draw(e),n&&r){const{iconManager:a}=this.state;a.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:aw}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):zI}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):zI}}oe(WT,"defaultProps",dle);oe(WT,"layerName","MultiIconLayer");const Vp=1e20;class ple{constructor({fontSize:e=24,buffer:n=3,radius:i=8,cutoff:r=.25,fontFamily:s="sans-serif",fontWeight:u="normal",fontStyle:a="normal"}={}){this.buffer=n,this.cutoff=r,this.radius=i;const y=this.size=e+n*4,w=this._createCanvas(y),I=this.ctx=w.getContext("2d",{willReadFrequently:!0});I.font=`${a} ${u} ${e}px ${s}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:s,actualBoundingBoxRight:u}=this.ctx.measureText(e),a=Math.ceil(i),y=0,w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(u-s))),I=Math.min(this.size-this.buffer,a+Math.ceil(r)),P=w+2*this.buffer,L=I+2*this.buffer,U=Math.max(P*L,0),Q=new Uint8ClampedArray(U),Z={data:Q,width:P,height:L,glyphWidth:w,glyphHeight:I,glyphTop:a,glyphLeft:y,glyphAdvance:n};if(w===0||I===0)return Z;const{ctx:ae,buffer:Y,gridInner:te,gridOuter:re}=this;ae.clearRect(Y,Y,w,I),ae.fillText(e,Y,Y+a);const de=ae.getImageData(Y,Y,w,I);re.fill(Vp,0,U),te.fill(0,0,U);for(let ve=0;ve<I;ve++)for(let Me=0;Me<w;Me++){const He=de.data[4*(ve*w+Me)+3]/255;if(He===0)continue;const Qe=(ve+Y)*P+Me+Y;if(He===1)re[Qe]=0,te[Qe]=Vp;else{const et=.5-He;re[Qe]=et>0?et*et:0,te[Qe]=et<0?et*et:0}}OI(re,0,0,P,L,P,this.f,this.v,this.z),OI(te,Y,Y,w,I,P,this.f,this.v,this.z);for(let ve=0;ve<U;ve++){const Me=Math.sqrt(re[ve])-Math.sqrt(te[ve]);Q[ve]=Math.round(255-255*(Me/this.radius+this.cutoff))}return Z}}function OI(t,e,n,i,r,s,u,a,y){for(let w=e;w<e+i;w++)FI(t,n*s+w,s,r,u,a,y);for(let w=n;w<n+r;w++)FI(t,w*s+e,1,i,u,a,y)}function FI(t,e,n,i,r,s,u){s[0]=0,u[0]=-Vp,u[1]=Vp,r[0]=t[e];for(let a=1,y=0,w=0;a<i;a++){r[a]=t[e+a*n];const I=a*a;do{const P=s[y];w=(r[a]-r[P]+I-P*P)/(a-P)/2}while(w<=u[y]&&--y>-1);y++,s[y]=a,u[y]=w,u[y+1]=Vp}for(let a=0,y=0;a<i;a++){for(;u[y+1]<a;)y++;const w=s[y],I=a-w;t[e+a*n]=r[w]+I*I}}const gle=32,mle=[];function yle(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function _le({characterSet:t,getFontWidth:e,fontHeight:n,buffer:i,maxCanvasWidth:r,mapping:s={},xOffset:u=0,yOffset:a=0}){let y=0,w=u;const I=n+i*2;for(const P of t)if(!s[P]){const L=e(P);w+L+i*2>r&&(w=0,y++),s[P]={x:w+i,y:a+y*I+i,width:L,height:I,layoutWidth:L,layoutHeight:n},w+=L+i*2}return{mapping:s,xOffset:w,yOffset:a+y*I,canvasHeight:yle(a+(y+1)*I)}}function Cz(t,e,n,i){let r=0;for(let u=e;u<n;u++){var s;const a=t[u];r+=((s=i[a])===null||s===void 0?void 0:s.layoutWidth)||0}return r}function Pz(t,e,n,i,r,s){let u=e,a=0;for(let y=e;y<n;y++){const w=Cz(t,y,y+1,r);a+w>i&&(u<y&&s.push(y),u=y,a=0),a+=w}return a}function vle(t,e,n,i,r,s){let u=e,a=e,y=e,w=0;for(let I=e;I<n;I++)if((t[I]===" "||t[I+1]===" "||I+1===n)&&(y=I+1),y>a){let P=Cz(t,a,y,r);w+P>i&&(u<a&&(s.push(a),u=a,w=0),P>i&&(P=Pz(t,a,y,i,r,s),u=s[s.length-1])),a=y,w+=P}return w}function xle(t,e,n,i,r=0,s){s===void 0&&(s=t.length);const u=[];return e==="break-all"?Pz(t,r,s,n,i,u):vle(t,r,s,n,i,u),u}function wle(t,e,n,i,r,s){let u=0,a=0;for(let y=e;y<n;y++){const w=t[y],I=i[w];I?(a||(a=I.layoutHeight),r[y]=u+I.layoutWidth/2,u+=I.layoutWidth):(si.warn("Missing character: ".concat(w," (").concat(w.codePointAt(0),")"))(),r[y]=u,u+=gle)}s[0]=u,s[1]=a}function ble(t,e,n,i,r){const s=Array.from(t),u=s.length,a=new Array(u),y=new Array(u),w=new Array(u),I=(n==="break-word"||n==="break-all")&&isFinite(i)&&i>0,P=[0,0],L=[0,0];let U=0,Q=0,Z=0;for(let Y=0;Y<=u;Y++){const te=s[Y];if((te===`
`||Y===u)&&(Z=Y),Z>Q){const re=I?xle(s,n,i,r,Q,Z):mle;for(let de=0;de<=re.length;de++){const ve=de===0?Q:re[de-1],Me=de<re.length?re[de]:Z;wle(s,ve,Me,r,a,L);for(let He=ve;He<Me;He++){var ae;const Qe=s[He],et=((ae=r[Qe])===null||ae===void 0?void 0:ae.layoutOffsetY)||0;y[He]=U+L[1]/2+et,w[He]=L[0]}U=U+L[1]*e,P[0]=Math.max(P[0],L[0])}Q=Z}te===`
`&&(a[Q]=0,y[Q]=0,w[Q]=0,Q++)}return P[1]=U,{x:a,y,rowWidth:w,size:P}}function Ele({value:t,length:e,stride:n,offset:i,startIndices:r,characterSet:s}){const u=t.BYTES_PER_ELEMENT,a=n?n/u:1,y=i?i/u:0,w=r[e]||Math.ceil((t.length-y)/a),I=s&&new Set,P=new Array(e);let L=t;if(a>1||y>0){const U=t.constructor;L=new U(w);for(let Q=0;Q<w;Q++)L[Q]=t[Q*a+y]}for(let U=0;U<e;U++){const Q=r[U],Z=r[U+1]||w,ae=L.subarray(Q,Z);P[U]=String.fromCodePoint.apply(null,ae),I&&ae.forEach(I.add,I)}if(I)for(const U of I)s.add(String.fromCodePoint(U));return{texts:P,characterCount:w}}class Iz{constructor(e=5){oe(this,"limit",void 0),oe(this,"_cache",{}),oe(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function Tle(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const Sf={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:Tle(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},NI=1024,UI=.9,VI=1.2,kz=3;let w_=new Iz(kz);function Sle(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const i=w_.get(t);if(!i)return n;for(const r in i.mapping)n.has(r)&&n.delete(r);return n}function Mle(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function GI(t,e,n,i){t.font="".concat(i," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function Cle(t){si.assert(Number.isFinite(t)&&t>=kz,"Invalid cache limit"),w_=new Iz(t)}class Ple{constructor(){oe(this,"props",{...Sf}),oe(this,"_key",void 0),oe(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*VI+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=Sle(this._key,this.props.characterSet),i=w_.get(this._key);if(i&&n.size===0){this._atlas!==i&&(this._atlas=i);return}const r=this._generateFontAtlas(n,i);this._atlas=r,w_.set(this._key,r)}_generateFontAtlas(e,n){const{fontFamily:i,fontWeight:r,fontSize:s,buffer:u,sdf:a,radius:y,cutoff:w}=this.props;let I=n&&n.data;I||(I=document.createElement("canvas"),I.width=NI);const P=I.getContext("2d",{willReadFrequently:!0});GI(P,i,s,r);const{mapping:L,canvasHeight:U,xOffset:Q,yOffset:Z}=_le({getFontWidth:ae=>P.measureText(ae).width,fontHeight:s*VI,buffer:u,characterSet:e,maxCanvasWidth:NI,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(I.height!==U){const ae=P.getImageData(0,0,I.width,I.height);I.height=U,P.putImageData(ae,0,0)}if(GI(P,i,s,r),a){const ae=new ple({fontSize:s,buffer:u,radius:y,cutoff:w,fontFamily:i,fontWeight:"".concat(r)});for(const Y of e){const{data:te,width:re,height:de,glyphTop:ve}=ae.draw(Y);L[Y].width=re,L[Y].layoutOffsetY=s*UI-ve;const Me=P.createImageData(re,de);Mle(te,Me),P.putImageData(Me,L[Y].x,L[Y].y)}}else for(const ae of e)P.fillText(ae,L[ae].x,L[ae].y+u+s*UI);return{xOffset:Q,yOffset:Z,mapping:L,data:I,width:I.width,height:I.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:i,buffer:r,sdf:s,radius:u,cutoff:a}=this.props;return s?"".concat(e," ").concat(n," ").concat(i," ").concat(r," ").concat(u," ").concat(a):"".concat(e," ").concat(n," ").concat(i," ").concat(r)}}const Ile=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,kle=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Lle={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class QT extends iA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:Ile,fs:kle,modules:[o0,a0]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var i;const{gl:r}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:i,sizeUnits:r,sizeMinPixels:s,sizeMaxPixels:u,getLineWidth:a}=this.props;let{padding:y}=this.props;y.length<4&&(y=[y[0],y[1],y[0],y[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!a,padding:y,sizeUnits:Nh[r],sizeScale:i,sizeMinPixels:s,sizeMaxPixels:u}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new Gu(e,{...this.getShaders(),id:this.props.id,geometry:new Ru({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}oe(QT,"defaultProps",Lle);oe(QT,"layerName","TextBackgroundLayer");const jI={start:1,middle:0,end:-1},$I={top:1,center:0,bottom:-1},lw=[0,0,0,255],Dle=1,Rle={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:lw},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Sf.characterSet},fontFamily:Sf.fontFamily,fontWeight:Sf.fontWeight,lineHeight:Dle,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:lw},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:lw},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class qT extends Kn{constructor(...e){super(...e),oe(this,"state",void 0),oe(this,"getBoundingRect",(n,i)=>{let{size:[r,s]}=this.transformParagraph(n,i);const{fontSize:u}=this.state.fontAtlasManager.props;r/=u,s/=u;const{getTextAnchor:a,getAlignmentBaseline:y}=this.props,w=jI[typeof a=="function"?a(n,i):a],I=$I[typeof y=="function"?y(n,i):y];return[(w-1)*r/2,(I-1)*s/2,r,s]}),oe(this,"getIconOffsets",(n,i)=>{const{getTextAnchor:r,getAlignmentBaseline:s}=this.props,{x:u,y:a,rowWidth:y,size:[w,I]}=this.transformParagraph(n,i),P=jI[typeof r=="function"?r(n,i):r],L=$I[typeof s=="function"?s(n,i):s],U=u.length,Q=new Array(U*2);let Z=0;for(let ae=0;ae<U;ae++){const Y=(1-P)*(w-y[ae])/2;Q[Z++]=(P-1)*w/2+Y+u[ae],Q[Z++]=(L-1)*I/2+a[ae]}return Q})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new Ple},this.props.maxWidth>0&&si.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:i,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==i.lineHeight||n.wordBreak!==i.wordBreak||n.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:i}=this.props,{fontAtlasManager:r,characterSet:s}=this.state,u={...e,characterSet:s,fontFamily:n,fontWeight:i};if(!r.mapping)return r.setProps(u),!0;for(const a in u)if(u[a]!==r.props[a])return r.setProps(u),!0;return!1}_updateText(){var e;const{data:n,characterSet:i}=this.props,r=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,u=n.startIndices,a;const y=i==="auto"&&new Set;if(r&&u){const{texts:w,characterCount:I}=Ele({...ArrayBuffer.isView(r)?{value:r}:r,length:n.length,startIndices:u,characterSet:y});a=I,s=(P,{index:L})=>w[L]}else{const{iterable:w,objectInfo:I}=cd(n);u=[0],a=0;for(const P of w){I.index++;const L=Array.from(s(P,I)||"");y&&L.forEach(y.add,y),a+=L.length,u.push(a)}}this.setState({getText:s,startIndices:u,numInstances:a,characterSet:y||i})}transformParagraph(e,n){const{fontAtlasManager:i}=this.state,r=i.mapping,s=this.state.getText,{wordBreak:u,lineHeight:a,maxWidth:y}=this.props,w=s(e,n)||"";return ble(w,a,u,y*i.props.fontSize,r)}renderLayers(){const{startIndices:e,numInstances:n,getText:i,fontAtlasManager:{scale:r,texture:s,mapping:u},styleVersion:a}=this.state,{data:y,_dataDiff:w,getPosition:I,getColor:P,getSize:L,getAngle:U,getPixelOffset:Q,getBackgroundColor:Z,getBorderColor:ae,getBorderWidth:Y,backgroundPadding:te,background:re,billboard:de,fontSettings:ve,outlineWidth:Me,outlineColor:He,sizeScale:Qe,sizeUnits:et,sizeMinPixels:tt,sizeMaxPixels:Ve,transitions:nt,updateTriggers:Ye}=this.props,gt=this.getSubLayerClass("characters",WT),Xt=this.getSubLayerClass("background",QT);return[re&&new Xt({getFillColor:Z,getLineColor:ae,getLineWidth:Y,padding:te,getPosition:I,getSize:L,getAngle:U,getPixelOffset:Q,billboard:de,sizeScale:Qe,sizeUnits:et,sizeMinPixels:tt,sizeMaxPixels:Ve,transitions:nt&&{getPosition:nt.getPosition,getAngle:nt.getAngle,getSize:nt.getSize,getFillColor:nt.getBackgroundColor,getLineColor:nt.getBorderColor,getLineWidth:nt.getBorderWidth,getPixelOffset:nt.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:Ye.getPosition,getAngle:Ye.getAngle,getSize:Ye.getSize,getFillColor:Ye.getBackgroundColor,getLineColor:Ye.getBorderColor,getLineWidth:Ye.getBorderWidth,getPixelOffset:Ye.getPixelOffset,getBoundingRect:{getText:Ye.getText,getTextAnchor:Ye.getTextAnchor,getAlignmentBaseline:Ye.getAlignmentBaseline,styleVersion:a}}}),{data:y.attributes&&y.attributes.background?{length:y.length,attributes:y.attributes.background}:y,_dataDiff:w,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new gt({sdf:ve.sdf,smoothing:Number.isFinite(ve.smoothing)?ve.smoothing:Sf.smoothing,outlineWidth:Me/(ve.radius||Sf.radius),outlineColor:He,iconAtlas:s,iconMapping:u,getPosition:I,getColor:P,getSize:L,getAngle:U,getPixelOffset:Q,billboard:de,sizeScale:Qe*r,sizeUnits:et,sizeMinPixels:tt*r,sizeMaxPixels:Ve*r,transitions:nt&&{getPosition:nt.getPosition,getAngle:nt.getAngle,getColor:nt.getColor,getSize:nt.getSize,getPixelOffset:nt.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:Ye.getText,getPosition:Ye.getPosition,getAngle:Ye.getAngle,getColor:Ye.getColor,getSize:Ye.getSize,getPixelOffset:Ye.getPixelOffset,getIconOffsets:{getTextAnchor:Ye.getTextAnchor,getAlignmentBaseline:Ye.getAlignmentBaseline,styleVersion:a}}}),{data:y,_dataDiff:w,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(e){Cle(e)}}oe(qT,"defaultProps",Rle);oe(qT,"layerName","TextLayer");const ay={circle:{type:$T,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:tm,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:qT,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},ly={type:M2,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},m3={type:I2,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function ip({type:t,props:e}){const n={};for(const i in e)n[i]=t.defaultProps[e[i]];return n}function Aw(t,e){const{transitions:n,updateTriggers:i}=t.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const u=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),r.updateTriggers[u]=i[s],n&&(r.transitions[u]=n[s])),r[u]=a}return r}function Ble(t){if(Array.isArray(t))return t;switch(si.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return si.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function HI(t,e,n={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:s=t.length}=n;for(let u=r;u<s;u++){const a=t[u],{geometry:y}=a;if(y)if(y.type==="GeometryCollection"){si.assert(Array.isArray(y.geometries),"GeoJSON does not have geometries array");const{geometries:w}=y;for(let I=0;I<w.length;I++){const P=w[I];WI(P,i,e,a,u)}}else WI(y,i,e,a,u)}return i}function WI(t,e,n,i,r){const{type:s,coordinates:u}=t,{pointFeatures:a,lineFeatures:y,polygonFeatures:w,polygonOutlineFeatures:I}=e;if(!Ole(s,u)){si.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":a.push(n({geometry:t},i,r));break;case"MultiPoint":u.forEach(P=>{a.push(n({geometry:{type:"Point",coordinates:P}},i,r))});break;case"LineString":y.push(n({geometry:t},i,r));break;case"MultiLineString":u.forEach(P=>{y.push(n({geometry:{type:"LineString",coordinates:P}},i,r))});break;case"Polygon":w.push(n({geometry:t},i,r)),u.forEach(P=>{I.push(n({geometry:{type:"LineString",coordinates:P}},i,r))});break;case"MultiPolygon":u.forEach(P=>{w.push(n({geometry:{type:"Polygon",coordinates:P}},i,r)),P.forEach(L=>{I.push(n({geometry:{type:"LineString",coordinates:L}},i,r))})});break}}const zle={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function Ole(t,e){let n=zle[t];for(si.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function Lz(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function v1(t){return t.geometry.coordinates}function Fle(t,e){const n=Lz(),{pointFeatures:i,lineFeatures:r,polygonFeatures:s,polygonOutlineFeatures:u}=t;return n.points.data=i,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=v1,n.lines.data=r,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=v1,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=v1,n.polygonsOutline.data=u,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=v1,n}function Nle(t,e){const n=Lz(),{points:i,lines:r,polygons:s}=t,u=hle(t,e);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:u.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:u.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:u.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:u.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const Ule=["points","linestrings","polygons"],Vle={...ip(ay.circle),...ip(ay.icon),...ip(ay.text),...ip(ly),...ip(m3),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class dl extends Kn{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:i}=this.props,r=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:r}),r?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const i=Nle(e.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON({props:e,changeFlags:n}){const i=Ble(e.data),r=this.getSubLayerRow.bind(this);let s={};const u={};if(Array.isArray(n.dataChanged)){const y=this.state.features;for(const w in y)s[w]=y[w].slice(),u[w]=[];for(const w of n.dataChanged){const I=HI(i,r,w);for(const P in y)u[P].push(Sz({data:s[P],getIndex:L=>L.__source.index,dataRange:w,replace:I[P]}))}}else s=HI(i,r);const a=Fle(s,u);this.setState({features:s,featuresDiff:u,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i,sourceLayer:r}=n;return n.featureType=Ule.find(s=>r.id.startsWith("".concat(this.id,"-").concat(s,"-"))),i>=0&&r.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[i]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),i=e.featureType==="points";for(const r of this.getSubLayers())r.id.startsWith(n)===i&&r.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:i}=this.state,r="polygons-fill",s=this.shouldRenderSubLayer(r,i.polygons.data)&&this.getSubLayerClass(r,m3.type);if(s){const u=Aw(this,m3.props),a=e&&n;return a||delete u.getLineColor,u.updateTriggers.lineColors=a,new s(u,this.getSubLayerProps({id:r,updateTriggers:u.updateTriggers}),i.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:i}=this.state,r="polygons-stroke",s="linestrings",u=!e&&n&&this.shouldRenderSubLayer(r,i.polygonsOutline.data)&&this.getSubLayerClass(r,ly.type),a=this.shouldRenderSubLayer(s,i.lines.data)&&this.getSubLayerClass(s,ly.type);if(u||a){const y=Aw(this,ly.props);return[u&&new u(y,this.getSubLayerProps({id:r,updateTriggers:y.updateTriggers}),i.polygonsOutline),a&&new a(y,this.getSubLayerProps({id:s,updateTriggers:y.updateTriggers}),i.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:i}=this.state;let{highlightedObjectIndex:r}=this.props;!i&&Number.isFinite(r)&&(r=n.points.data.findIndex(a=>a.__source.index===r));const s=new Set(e.split("+")),u=[];for(const a of s){const y="points-".concat(a),w=ay[a],I=w&&this.shouldRenderSubLayer(y,n.points.data)&&this.getSubLayerClass(y,w.type);if(I){const P=Aw(this,w.props);let L=n.points;if(a==="text"&&i){const{instancePickingColors:U,...Q}=L.data.attributes;L={...L,data:{...L.data,attributes:Q}}}u.push(new I(P,this.getSubLayerProps({id:y,updateTriggers:P.updateTriggers,highlightedObjectIndex:r}),L))}}return u}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),i=this._renderLineLayers(),r=this._renderPointLayers();return[!e&&n,i,r,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(i,r)=>{const{data:s,index:u}=r,a=ule(s,u);return e(a,r)}}}oe(dl,"layerName","GeoJsonLayer");oe(dl,"defaultProps",Vle);class Gle{constructor(e){oe(this,"index",void 0),oe(this,"isVisible",void 0),oe(this,"isSelected",void 0),oe(this,"parent",void 0),oe(this,"children",void 0),oe(this,"content",void 0),oe(this,"state",void 0),oe(this,"layers",void 0),oe(this,"id",void 0),oe(this,"zoom",void 0),oe(this,"userData",void 0),oe(this,"boundingBox",void 0),oe(this,"_abortController",void 0),oe(this,"_loader",void 0),oe(this,"_loaderId",void 0),oe(this,"_isLoaded",void 0),oe(this,"_isCancelled",void 0),oe(this,"_needsReload",void 0),oe(this,"_bbox",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:n,onLoad:i,onError:r}){const{index:s,id:u,bbox:a,userData:y,zoom:w}=this,I=this._loaderId;this._abortController=new AbortController;const{signal:P}=this._abortController,L=await n.scheduleRequest(this,Z=>Z.isSelected?1:-1);if(!L){this._isCancelled=!0;return}if(this._isCancelled){L.done();return}let U=null,Q;try{U=await e({index:s,id:u,bbox:a,userData:y,zoom:w,signal:P})}catch(Z){Q=Z||!0}finally{L.done()}if(I===this._loaderId){if(this._loader=void 0,this.content=U,this._isCancelled&&!U){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,Q?r(Q,this):i(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const oo={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},QI=new ln,jle=new ln;class ZT{constructor(e=[0,0,0],n=[0,0,0],i){oe(this,"center",void 0),oe(this,"halfDiagonal",void 0),oe(this,"minimum",void 0),oe(this,"maximum",void 0),i=i||QI.copy(e).add(n).scale(.5),this.center=new ln(i),this.halfDiagonal=new ln(n).subtract(this.center),this.minimum=new ln(e),this.maximum=new ln(n)}clone(){return new ZT(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,i=jle.from(e.normal),r=n.x*Math.abs(i.x)+n.y*Math.abs(i.y)+n.z*Math.abs(i.z),s=this.center.dot(i)+e.distance;return s-r>0?oo.INSIDE:s+r<0?oo.OUTSIDE:oo.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=QI.from(e).subtract(this.center),{halfDiagonal:i}=this;let r=0,s;return s=Math.abs(n.x)-i.x,s>0&&(r+=s*s),s=Math.abs(n.y)-i.y,s>0&&(r+=s*s),s=Math.abs(n.z)-i.z,s>0&&(r+=s*s),r}}const rp=new ln,qI=new ln;class YT{constructor(e=[0,0,0],n=0){oe(this,"center",void 0),oe(this,"radius",void 0),this.radius=-0,this.center=new ln,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=rp.from(n),this.center=new ln().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new YT(this.center,this.radius)}union(e){const n=this.center,i=this.radius,r=e.center,s=e.radius,u=rp.copy(r).subtract(n),a=u.magnitude();if(i>=a+s)return this.clone();if(s>=a+i)return e.clone();const y=(i+a+s)*.5;return qI.copy(u).scale((-i+y)/a).add(n),this.center.copy(qI),this.radius=y,this}expand(e){const i=rp.from(e).subtract(this.center).magnitude();return i>this.radius&&(this.radius=i),this}transform(e){this.center.transform(e);const n=uq(rp,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const i=rp.from(e).subtract(this.center);return Math.max(0,i.len()-this.radius)}intersectPlane(e){const n=this.center,i=this.radius,s=e.normal.dot(n)+e.distance;return s<-i?oo.OUTSIDE:s<i?oo.INTERSECTING:oo.INSIDE}}const $le=new ln,Hle=new ln,x1=new ln,w1=new ln,b1=new ln,Wle=new ln,Qle=new ln,vu={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class XT{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){oe(this,"center",void 0),oe(this,"halfAxes",void 0),this.center=new ln().from(e),this.halfAxes=new Is(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new ln(e).len(),new ln(n).len(),new ln(i).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),r=new ln(e).normalize(),s=new ln(n).normalize(),u=new ln(i).normalize();return new RC().fromMatrix3(new Is([...r,...s,...u]))}fromCenterHalfSizeQuaternion(e,n,i){const r=new RC(i),s=new Is().fromQuaternion(r);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new ln().from(e),this.halfAxes=s,this}clone(){return new XT(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new YT){const n=this.halfAxes,i=n.getColumn(0,x1),r=n.getColumn(1,w1),s=n.getColumn(2,b1),u=$le.copy(i).add(r).add(s);return e.center.copy(this.center),e.radius=u.magnitude(),e}intersectPlane(e){const n=this.center,i=e.normal,r=this.halfAxes,s=i.x,u=i.y,a=i.z,y=Math.abs(s*r[vu.COLUMN0ROW0]+u*r[vu.COLUMN0ROW1]+a*r[vu.COLUMN0ROW2])+Math.abs(s*r[vu.COLUMN1ROW0]+u*r[vu.COLUMN1ROW1]+a*r[vu.COLUMN1ROW2])+Math.abs(s*r[vu.COLUMN2ROW0]+u*r[vu.COLUMN2ROW1]+a*r[vu.COLUMN2ROW2]),w=i.dot(n)+e.distance;return w<=-y?oo.OUTSIDE:w>=y?oo.INSIDE:oo.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=Hle.from(e).subtract(this.center),i=this.halfAxes,r=i.getColumn(0,x1),s=i.getColumn(1,w1),u=i.getColumn(2,b1),a=r.magnitude(),y=s.magnitude(),w=u.magnitude();r.normalize(),s.normalize(),u.normalize();let I=0,P;return P=Math.abs(n.dot(r))-a,P>0&&(I+=P*P),P=Math.abs(n.dot(s))-y,P>0&&(I+=P*P),P=Math.abs(n.dot(u))-w,P>0&&(I+=P*P),I}computePlaneDistances(e,n,i=[-0,-0]){let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const u=this.center,a=this.halfAxes,y=a.getColumn(0,x1),w=a.getColumn(1,w1),I=a.getColumn(2,b1),P=Wle.copy(y).add(w).add(I).add(u),L=Qle.copy(P).subtract(e);let U=n.dot(L);return r=Math.min(U,r),s=Math.max(U,s),P.copy(u).add(y).add(w).subtract(I),L.copy(P).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),P.copy(u).add(y).subtract(w).add(I),L.copy(P).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),P.copy(u).add(y).subtract(w).subtract(I),L.copy(P).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),u.copy(P).subtract(y).add(w).add(I),L.copy(P).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),u.copy(P).subtract(y).add(w).subtract(I),L.copy(P).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),u.copy(P).subtract(y).subtract(w).add(I),L.copy(P).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),u.copy(P).subtract(y).subtract(w).subtract(I),L.copy(P).subtract(e),U=n.dot(L),r=Math.min(U,r),s=Math.max(U,s),i[0]=r,i[1]=s,i}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,x1);n.transformAsPoint(e);const i=this.halfAxes.getColumn(1,w1);i.transformAsPoint(e);const r=this.halfAxes.getColumn(2,b1);return r.transformAsPoint(e),this.halfAxes=new Is([...n,...i,...r]),this}getTransform(){throw new Error("not implemented")}}const ZI=new ln,YI=new ln;class Xf{constructor(e=[0,0,1],n=0){oe(this,"normal",void 0),oe(this,"distance",void 0),this.normal=new ln,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return cg(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=ZI.from(e),this.normal.from(n).normalize();const i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,n,i,r){return this.normal.set(e,n,i),cg(Du(this.normal.len(),1)),this.distance=r,this}clone(){return new Xf(this.normal,this.distance)}equals(e){return Du(this.distance,e.distance)&&Du(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=YI.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,n)}projectPointOntoPlane(e,n=[0,0,0]){e=ZI.from(e);const i=this.getPointDistance(e),r=YI.copy(this.normal).scale(i);return e.subtract(r).to(n)}}const XI=[new ln([1,0,0]),new ln([0,1,0]),new ln([0,0,1])],KI=new ln,qle=new ln;new Xf(new ln(1,0,0),0);class Pu{constructor(e=[]){oe(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*XI.length;const n=e.center,i=e.radius;let r=0;for(const s of XI){let u=this.planes[r],a=this.planes[r+1];u||(u=this.planes[r]=new Xf),a||(a=this.planes[r+1]=new Xf);const y=KI.copy(s).scale(-i).add(n);-s.dot(y),u.fromPointNormal(y,s);const w=KI.copy(s).scale(i).add(n),I=qle.copy(s).negate();-I.dot(w),a.fromPointNormal(w,I),r+=2}return this}computeVisibility(e){let n=oo.INSIDE;for(const i of this.planes)switch(e.intersectPlane(i)){case oo.OUTSIDE:return oo.OUTSIDE;case oo.INTERSECTING:n=oo.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(cg(Number.isFinite(n),"parentPlaneMask is required."),n===Pu.MASK_OUTSIDE||n===Pu.MASK_INSIDE)return n;let i=Pu.MASK_INSIDE;const r=this.planes;for(let s=0;s<this.planes.length;++s){const u=s<31?1<<s:0;if(s<31&&!(n&u))continue;const a=r[s],y=e.intersectPlane(a);if(y===oo.OUTSIDE)return Pu.MASK_OUTSIDE;y===oo.INTERSECTING&&(i|=u)}return i}}oe(Pu,"MASK_OUTSIDE",4294967295);oe(Pu,"MASK_INSIDE",0);oe(Pu,"MASK_INDETERMINATE",2147483647);new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;new ln;const SA=new Is,Zle=new Is,Yle=new Is,E1=new Is,JI=new Is;function Xle(t,e={}){const n=hR.EPSILON20,i=10;let r=0,s=0;const u=Zle,a=Yle;u.identity(),a.copy(t);const y=n*Kle(a);for(;s<i&&Jle(a)>y;)eAe(a,E1),JI.copy(E1).transpose(),a.multiplyRight(E1),a.multiplyLeft(JI),u.multiplyRight(E1),++r>2&&(++s,r=0);return e.unitary=u.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function Kle(t){let e=0;for(let n=0;n<9;++n){const i=t[n];e+=i*i}return Math.sqrt(e)}const y3=[1,0,0],_3=[2,2,1];function Jle(t){let e=0;for(let n=0;n<3;++n){const i=t[SA.getElementIndex(_3[n],y3[n])];e+=2*i*i}return Math.sqrt(e)}function eAe(t,e){const n=hR.EPSILON15;let i=0,r=1;for(let w=0;w<3;++w){const I=Math.abs(t[SA.getElementIndex(_3[w],y3[w])]);I>i&&(r=w,i=I)}const s=y3[r],u=_3[r];let a=1,y=0;if(Math.abs(t[SA.getElementIndex(u,s)])>n){const w=t[SA.getElementIndex(u,u)],I=t[SA.getElementIndex(s,s)],P=t[SA.getElementIndex(u,s)],L=(w-I)/2/P;let U;L<0?U=-1/(-L+Math.sqrt(1+L*L)):U=1/(L+Math.sqrt(1+L*L)),a=1/Math.sqrt(1+U*U),y=U*a}return Is.IDENTITY.to(e),e[SA.getElementIndex(s,s)]=e[SA.getElementIndex(u,u)]=a,e[SA.getElementIndex(u,s)]=y,e[SA.getElementIndex(s,u)]=-y,e}const xc=new ln,tAe=new ln,nAe=new ln,iAe=new ln,rAe=new ln,sAe=new Is,oAe={diagonal:new Is,unitary:new Is};function aAe(t,e=new XT){if(!t||t.length===0)return e.halfAxes=new Is([0,0,0,0,0,0,0,0,0]),e.center=new ln,e;const n=t.length,i=new ln(0,0,0);for(const et of t)i.add(et);const r=1/n;i.multiplyByScalar(r);let s=0,u=0,a=0,y=0,w=0,I=0;for(const et of t){const tt=xc.copy(et).subtract(i);s+=tt.x*tt.x,u+=tt.x*tt.y,a+=tt.x*tt.z,y+=tt.y*tt.y,w+=tt.y*tt.z,I+=tt.z*tt.z}s*=r,u*=r,a*=r,y*=r,w*=r,I*=r;const P=sAe;P[0]=s,P[1]=u,P[2]=a,P[3]=u,P[4]=y,P[5]=w,P[6]=a,P[7]=w,P[8]=I;const{unitary:L}=Xle(P,oAe),U=e.halfAxes.copy(L);let Q=U.getColumn(0,nAe),Z=U.getColumn(1,iAe),ae=U.getColumn(2,rAe),Y=-Number.MAX_VALUE,te=-Number.MAX_VALUE,re=-Number.MAX_VALUE,de=Number.MAX_VALUE,ve=Number.MAX_VALUE,Me=Number.MAX_VALUE;for(const et of t)xc.copy(et),Y=Math.max(xc.dot(Q),Y),te=Math.max(xc.dot(Z),te),re=Math.max(xc.dot(ae),re),de=Math.min(xc.dot(Q),de),ve=Math.min(xc.dot(Z),ve),Me=Math.min(xc.dot(ae),Me);Q=Q.multiplyByScalar(.5*(de+Y)),Z=Z.multiplyByScalar(.5*(ve+te)),ae=ae.multiplyByScalar(.5*(Me+re)),e.center.copy(Q).add(Z).add(ae);const He=tAe.set(Y-de,te-ve,re-Me).multiplyByScalar(.5),Qe=new Is([He[0],0,0,0,He[1],0,0,0,He[2]]);return e.halfAxes.multiplyRight(Qe),e}const of=512,e6=3,Dz=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],Rz=Dz.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),lAe=Rz.concat([[.25,.5],[.75,.5]]);class af{constructor(e,n,i){oe(this,"x",void 0),oe(this,"y",void 0),oe(this,"z",void 0),oe(this,"childVisible",void 0),oe(this,"selected",void 0),oe(this,"_children",void 0),this.x=e,this.y=n,this.z=i}get children(){if(!this._children){const e=this.x*2,n=this.y*2,i=this.z+1;this._children=[new af(e,n,i),new af(e,n+1,i),new af(e+1,n,i),new af(e+1,n+1,i)]}return this._children}update(e){const{viewport:n,cullingVolume:i,elevationBounds:r,minZ:s,maxZ:u,bounds:a,offset:y,project:w}=e,I=this.getBoundingVolume(r,y,w);if(a&&!this.insideBounds(a)||i.computeVisibility(I)<0)return!1;if(!this.childVisible){let{z:L}=this;if(L<u&&L>=s){const U=I.distanceTo(n.cameraPosition)*n.scale/n.height;L+=Math.floor(Math.log2(U))}if(L>=u)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const L of this.children)L.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,i,r]){const s=Math.pow(2,this.z),u=of/s;return this.x*u<i&&this.y*u<r&&(this.x+1)*u>e&&(this.y+1)*u>n}getBoundingVolume(e,n,i){if(i){const y=this.z<1?lAe:this.z<2?Rz:Dz,w=[];for(const I of y){const P=x3(this.x+I[0],this.y+I[1],this.z);P[2]=e[0],w.push(i(P)),e[0]!==e[1]&&(P[2]=e[1],w.push(i(P)))}return aAe(w)}const r=Math.pow(2,this.z),s=of/r,u=this.x*s+n*of,a=of-(this.y+1)*s;return new ZT([u,a,e[0]],[u+s,a+s,e[1]])}}function AAe(t,e,n,i){const r=t instanceof FJ&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map(({normal:U,distance:Q})=>new Xf(U.clone().negate(),Q)),u=new Pu(s),a=t.distanceScales.unitsPerMeter[2],y=n&&n[0]*a||0,w=n&&n[1]*a||0,I=t instanceof Xc&&t.pitch<=60?e:0;if(i){const[U,Q,Z,ae]=i,Y=GA([U,ae]),te=GA([Z,Q]);i=[Y[0],of-Y[1],te[0],of-te[1]]}const P=new af(0,0,0),L={viewport:t,project:r,cullingVolume:u,elevationBounds:[y,w],minZ:I,maxZ:e,bounds:i,offset:0};if(P.update(L),t instanceof Xc&&t.subViewports&&t.subViewports.length>1){for(L.offset=-1;P.update(L)&&!(--L.offset<-e6););for(L.offset=1;P.update(L)&&!(++L.offset>e6););}return P.getSelected()}const Qu=512,uAe=[-1/0,-1/0,1/0,1/0],cAe={type:"object",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}};function Bz(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(r=>r[0])),Math.min(...n.map(r=>r[1])),Math.max(...n.map(r=>r[0])),Math.max(...n.map(r=>r[1]))]}function hAe(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function fAe(t,e){if(!t||!t.length)return null;const{index:n,id:i}=e;if(Array.isArray(t)){const s=hAe(i)%t.length;t=t[s]}let r=t;for(const s of Object.keys(n)){const u=new RegExp("{".concat(s,"}"),"g");r=r.replace(u,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(r=r.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),r}function dAe(t,e,n){let i;if(e&&e.length===2){const[r,s]=e,u=t.getBounds({z:r}),a=t.getBounds({z:s});i=[Math.min(u[0],a[0]),Math.min(u[1],a[1]),Math.max(u[2],a[2]),Math.max(u[3],a[3])]}else i=t.getBounds();return t.isGeospatial?[Math.max(i[0],n[0]),Math.max(i[1],n[1]),Math.min(i[2],n[2]),Math.min(i[3],n[3])]:[Math.max(Math.min(i[0],n[2]),n[0]),Math.max(Math.min(i[1],n[3]),n[1]),Math.min(Math.max(i[2],n[0]),n[2]),Math.min(Math.max(i[3],n[1]),n[3])]}function pAe({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map(r=>v3(r,e,n))}function v3(t,e,n){if(!Array.isArray(e)){const s=n.x-t.x,u=n.y-t.y,{width:a,height:y}=n,w={targetZ:e},I=t.unproject([s,u],w),P=t.unproject([s+a,u],w),L=t.unproject([s,u+y],w),U=t.unproject([s+a,u+y],w);return[Math.min(I[0],P[0],L[0],U[0]),Math.min(I[1],P[1],L[1],U[1]),Math.max(I[0],P[0],L[0],U[0]),Math.max(I[1],P[1],L[1],U[1])]}const i=v3(t,e[0],n),r=v3(t,e[1],n);return[Math.min(i[0],r[0]),Math.min(i[1],r[1]),Math.max(i[2],r[2]),Math.max(i[3],r[3])]}function gAe(t,e,n){return n?Bz(t,n).map(r=>r*e/Qu):t.map(i=>i*e/Qu)}function KT(t,e){return Math.pow(2,t)*Qu/e}function x3(t,e,n){const i=KT(n,Qu),r=t/i*360-180,s=Math.PI-2*Math.PI*e/i,u=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[r,u]}function t6(t,e,n,i){const r=KT(n,i);return[t/r*Qu,e/r*Qu]}function mAe(t,e,n,i,r=Qu){if(t.isGeospatial){const[w,I]=x3(e,n,i),[P,L]=x3(e+1,n+1,i);return{west:w,north:I,east:P,south:L}}const[s,u]=t6(e,n,i,r),[a,y]=t6(e+1,n+1,i,r);return{left:s,top:u,right:a,bottom:y}}function yAe(t,e,n,i,r){const s=dAe(t,null,i),u=KT(e,n),[a,y,w,I]=gAe(s,u,r),P=[];for(let L=Math.floor(a);L<w;L++)for(let U=Math.floor(y);U<I;U++)P.push({x:L,y:U,z:e});return P}function _Ae({viewport:t,maxZoom:e,minZoom:n,zRange:i,extent:r,tileSize:s=Qu,modelMatrix:u,modelMatrixInverse:a,zoomOffset:y=0}){let w=t.isGeospatial?Math.round(t.zoom+Math.log2(Qu/s))+y:Math.ceil(t.zoom)+y;if(typeof n=="number"&&Number.isFinite(n)&&w<n){if(!r)return[];w=n}typeof e=="number"&&Number.isFinite(e)&&w>e&&(w=e);let I=r;return u&&a&&r&&!t.isGeospatial&&(I=Bz(r,u)),t.isGeospatial?AAe(t,w,i,r):yAe(t,w,s,I||uAe,a)}function vAe(t){let e={},n;return i=>{for(const r in i)if(!xAe(i[r],e[r])){n=t(i),e=i;break}return n}}function xAe(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}const n6=1,L2=2,wAe="never",bAe="no-overlap",JT="best-available",EAe=5,TAe={[JT]:CAe,[bAe]:PAe,[wAe]:()=>{}},SAe={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class MAe{constructor(e){oe(this,"opts",void 0),oe(this,"_requestScheduler",void 0),oe(this,"_cache",void 0),oe(this,"_dirty",void 0),oe(this,"_tiles",void 0),oe(this,"_cacheByteSize",void 0),oe(this,"_viewport",void 0),oe(this,"_zRange",void 0),oe(this,"_selectedTiles",void 0),oe(this,"_frameNumber",void 0),oe(this,"_modelMatrix",void 0),oe(this,"_modelMatrixInverse",void 0),oe(this,"_maxZoom",void 0),oe(this,"_minZoom",void 0),oe(this,"onTileLoad",void 0),oe(this,"_getCullBounds",vAe(pAe)),this.opts={...SAe,...e},this.onTileLoad=n=>{var i,r;(i=(r=this.opts).onTileLoad)===null||i===void 0||i.call(r,n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new AV({maxRequests:e.maxRequests,throttleRequests:!!(e.maxRequests&&e.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new ra,this._modelMatrixInverse=new ra,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:i}={}){const r=new ra(i),s=!r.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!Du(this._zRange,n)||s){s&&(this._modelMatrixInverse=r.clone().invert(),this._modelMatrix=r),this._viewport=e,this._zRange=n;const a=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(y=>this._getTile(y,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));const u=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),u&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const i=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:r}=e;for(const[s,u,a,y]of i){let w;if("west"in r)w=r.west<a&&r.east>s&&r.south<y&&r.north>u;else{const I=Math.min(r.top,r.bottom),P=Math.max(r.top,r.bottom);w=r.left<a&&r.right>s&&I<y&&P>u}if(w)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:i,zRange:r,modelMatrix:s,modelMatrixInverse:u}){const{tileSize:a,extent:y,zoomOffset:w}=this.opts;return _Ae({viewport:e,maxZoom:n,minZoom:i,zRange:r,tileSize:a,extent:y,modelMatrix:s,modelMatrixInverse:u,zoomOffset:w})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:mAe(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),i=Math.floor(e.y/2),r=e.z-1;return{x:n,y:i,z:r}}updateTileStates(){const e=this.opts.refinementStrategy||JT,n=new Array(this._cache.size);let i=0;for(const r of this._cache.values())n[i++]=r.isVisible,r.isSelected=!1,r.isVisible=!1;for(const r of this._selectedTiles)r.isSelected=!0,r.isVisible=!0;(typeof e=="function"?e:TAe[e])(Array.from(this._cache.values())),i=0;for(const r of this._cache.values())if(n[i++]!==r.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,n=[];let i=0;for(const r of this._cache.values())r.isLoading&&(i++,!r.isSelected&&!r.isVisible&&n.push(r));for(;e>0&&i>e&&n.length>0;)n.shift().abort(),i--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const i=this._getNearestAncestor(n);n.parent=i,i!=null&&i.children&&i.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,i=n.maxCacheSize||(n.maxCacheByteSize?1/0:EAe*this.selectedTiles.length),r=n.maxCacheByteSize||1/0;if(e.size>i||this._cacheByteSize>r){for(const[y,w]of e){if(!w.isVisible&&!w.isSelected){var u,a;this._cacheByteSize-=n.maxCacheByteSize?w.byteLength:0,e.delete(y),(u=(a=this.opts).onTileUnload)===null||u===void 0||u.call(a,w)}if(e.size<=i&&this._cacheByteSize<=r)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((y,w)=>y.zoom-w.zoom),this._dirty=!1)}_getTile(e,n){const i=this.getTileId(e);let r=this._cache.get(i),s=!1;return!r&&n?(r=new Gle(e),Object.assign(r,this.getTileMetadata(r.index)),Object.assign(r,{id:i,zoom:this.getTileZoom(r.index)}),s=!0,this._cache.set(i,r),this._dirty=!0):r&&r.needsReload&&(s=!0),r&&s&&r.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),r}_getNearestAncestor(e){const{_minZoom:n=0}=this;let i=e.index;for(;this.getTileZoom(i)>n;){i=this.getParentIndex(i);const r=this._getTile(i);if(r)return r}return null}}function CAe(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!zz(e)&&eS(e);for(const e of t)e.isVisible=!!(e.state&L2)}function PAe(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&zz(n);const e=Array.from(t).sort((n,i)=>n.zoom-i.zoom);for(const n of e)if(n.isVisible=!!(n.state&L2),n.children&&(n.isVisible||n.state&n6))for(const i of n.children)i.state=n6;else n.isSelected&&eS(n)}function zz(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=L2,!0;e=e.parent}return!1}function eS(t){for(const e of t.children)e.isLoaded||e.content?e.state|=L2:eS(e)}const IAe={TilesetClass:MAe,data:{type:"data",value:[]},dataComparator:cAe.equal,renderSubLayers:{type:"function",value:t=>new dl(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:JT,zRange:null,maxRequests:6,zoomOffset:0};class D2 extends Kn{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n,i;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||(i=n.selectedTiles)===null||i===void 0?void 0:i.every(r=>r.isLoaded&&r.layers&&r.layers.every(s=>s.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const i=e.propsOrDataChanged||e.updateTriggersChanged,r=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?i&&(n.setOptions(this._getTilesetOptions()),r?n.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:i,refinementStrategy:r,extent:s,maxZoom:u,minZoom:a,maxRequests:y,zoomOffset:w}=this.props;return{maxCacheSize:n,maxCacheByteSize:i,maxZoom:u,minZoom:a,tileSize:e,refinementStrategy:r,extent:s,maxRequests:y,zoomOffset:w,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:i}=this.props,r=e.update(this.context.viewport,{zRange:n,modelMatrix:i}),{isLoaded:s}=e,u=this.state.isLoaded!==s,a=this.state.frameNumber!==r;s&&(u||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:r}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:i,fetch:r}=this.props,{signal:s}=e;return e.url=typeof n=="string"||Array.isArray(n)?fAe(n,e):null,i?i(e):r&&e.url?r(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){const i=n.props.tile;return e.picked&&(e.tile=i),e.sourceTile=i,e}_updateAutoHighlight(e){const n=e.sourceTile;if(n&&n.layers)for(const i of n.layers)i.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(i=>e.layers[0].props[i]!==n[i])&&(e.layers=e.layers.map(i=>i.clone(n)));else{const i=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=p2(i,Boolean).map(r=>r.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:i}=e.props;return this.state.tileset.isTileVisible(i,n)}}oe(D2,"defaultProps",IAe);oe(D2,"layerName","TileLayer");const uw=Math.PI/180,T1=new Float32Array(16),i6=new Float32Array(12);function r6(t,e,n){const i=e[0]*uw,r=e[1]*uw,s=e[2]*uw,u=Math.sin(s),a=Math.sin(i),y=Math.sin(r),w=Math.cos(s),I=Math.cos(i),P=Math.cos(r),L=n[0],U=n[1],Q=n[2];t[0]=L*P*I,t[1]=L*y*I,t[2]=L*-a,t[3]=U*(-y*w+P*a*u),t[4]=U*(P*w+y*a*u),t[5]=U*I*u,t[6]=Q*(y*u+P*a*w),t[7]=Q*(-P*u+y*a*w),t[8]=Q*I*w}function s6(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const kAe={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:i,getOrientation:r,getScale:s,getTranslation:u,getTransformMatrix:a}=this.props,y=Array.isArray(a),w=y&&a.length===16,I=Array.isArray(s),P=Array.isArray(r),L=Array.isArray(u),U=w||!y&&!!a(i[0]);U?t.constant=w:t.constant=P&&I&&L;const Q=t.value;if(t.constant){let Z;U?(T1.set(a),Z=s6(T1)):(Z=i6,r6(Z,r,s),Z.set(u,9)),t.value=new Float32Array(Z)}else{let Z=e*t.size;const{iterable:ae,objectInfo:Y}=cd(i,e,n);for(const te of ae){Y.index++;let re;if(U)T1.set(w?a:a(te,Y)),re=s6(T1);else{re=i6;const de=P?r:r(te,Y),ve=I?s:s(te,Y);r6(re,de,ve),re.set(L?u:u(te,Y),9)}Q[Z++]=re[0],Q[Z++]=re[1],Q[Z++]=re[2],Q[Z++]=re[3],Q[Z++]=re[4],Q[Z++]=re[5],Q[Z++]=re[6],Q[Z++]=re[7],Q[Z++]=re[8],Q[Z++]=re[9],Q[Z++]=re[10],Q[Z++]=re[11]}}}};function LAe(t,e){return e===Ai.CARTESIAN||e===Ai.METER_OFFSETS||e===Ai.DEFAULT&&!t.isGeospatial}const DAe=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,RAe=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function Oz(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,u=-1/0;const a=t.POSITION?t.POSITION.value:[],y=a&&a.length;for(let w=0;w<y;w+=3){const I=a[w],P=a[w+1],L=a[w+2];e=I<e?I:e,n=P<n?P:n,i=L<i?L:i,r=I>r?I:r,s=P>s?P:s,u=L>u?L:u}return[[e,n,i],[r,s,u]]}function BAe(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class lf{constructor(e,n){oe(this,"fields",void 0),oe(this,"metadata",void 0),BAe(Array.isArray(e)),zAe(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];for(const u of i)e[u]=!0;const s=this.fields.filter(u=>e[u.name]);return new lf(s,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];const r=n.map(s=>this.fields[s]).filter(Boolean);return new lf(r,this.metadata)}assign(e){let n,i=this.metadata;if(e instanceof lf){const u=e;n=u.fields,i=o6(o6(new Map,this.metadata),u.metadata)}else n=e;const r=Object.create(null);for(const u of this.fields)r[u.name]=u;for(const u of n)r[u.name]=u;const s=Object.values(r);return new lf(s,i)}}function zAe(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function o6(t,e){return new Map([...t||new Map,...e||new Map])}class Gp{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"nullable",void 0),oe(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new Gp(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Sr=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({}),Fz,Nz,Uz;class tS{static isNull(e){return e&&e.typeId===Sr.Null}static isInt(e){return e&&e.typeId===Sr.Int}static isFloat(e){return e&&e.typeId===Sr.Float}static isBinary(e){return e&&e.typeId===Sr.Binary}static isUtf8(e){return e&&e.typeId===Sr.Utf8}static isBool(e){return e&&e.typeId===Sr.Bool}static isDecimal(e){return e&&e.typeId===Sr.Decimal}static isDate(e){return e&&e.typeId===Sr.Date}static isTime(e){return e&&e.typeId===Sr.Time}static isTimestamp(e){return e&&e.typeId===Sr.Timestamp}static isInterval(e){return e&&e.typeId===Sr.Interval}static isList(e){return e&&e.typeId===Sr.List}static isStruct(e){return e&&e.typeId===Sr.Struct}static isUnion(e){return e&&e.typeId===Sr.Union}static isFixedSizeBinary(e){return e&&e.typeId===Sr.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Sr.FixedSizeList}static isMap(e){return e&&e.typeId===Sr.Map}static isDictionary(e){return e&&e.typeId===Sr.Dictionary}get typeId(){return Sr.NONE}compareTo(e){return this===e}}Fz=Symbol.toStringTag;class pd extends tS{constructor(e,n){super(),oe(this,"isSigned",void 0),oe(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return Sr.Int}get[Fz](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class OAe extends pd{constructor(){super(!0,8)}}class FAe extends pd{constructor(){super(!0,16)}}class NAe extends pd{constructor(){super(!0,32)}}class UAe extends pd{constructor(){super(!1,8)}}class VAe extends pd{constructor(){super(!1,16)}}class GAe extends pd{constructor(){super(!1,32)}}const Vz={HALF:16,SINGLE:32,DOUBLE:64};Nz=Symbol.toStringTag;class Gz extends tS{constructor(e){super(),oe(this,"precision",void 0),this.precision=e}get typeId(){return Sr.Float}get[Nz](){return"Float"}toString(){return"Float".concat(this.precision)}}class jAe extends Gz{constructor(){super(Vz.SINGLE)}}class $Ae extends Gz{constructor(){super(Vz.DOUBLE)}}Uz=Symbol.toStringTag;class HAe extends tS{constructor(e,n){super(),oe(this,"listSize",void 0),oe(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return Sr.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[Uz](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function WAe(t){switch(t.constructor){case Int8Array:return new OAe;case Uint8Array:return new UAe;case Int16Array:return new FAe;case Uint16Array:return new VAe;case Int32Array:return new NAe;case Uint32Array:return new GAe;case Float32Array:return new jAe;case Float64Array:return new $Ae;default:throw new Error("array type not supported")}}function a6(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),si.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function l6(t,e){if(t.attributes)return a6(t.attributes,e),t instanceof Ru?t:new Ru(t);if(t.positions||t.POSITION)return a6(t,e),new Ru({attributes:t});throw Error("Invalid mesh")}const QAe=[0,0,0,255],qAe={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:QAe},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class f0 extends iA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){const e=!ui(this.context.gl),n={};return BD(this.context.gl,Yi.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:DAe,fs:RAe,modules:[o0,rZ,a0],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:i}=this.props;if(!i)return null;if(n=(e=i.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:r}=l6(i,this.props._useMeshColors);r.POSITION=r.POSITION||r.positions,n=Oz(r)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:kAe}),this.setState({emptyTexture:new oa(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e;if(n.mesh!==i.mesh||r.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const u=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(u.NORMAL||u.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==i.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:i,coordinateSystem:r,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!s||LAe(n,r),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new Gu(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:l6(e,this.props._useMeshColors),isInstanced:!0}),{texture:i}=this.props,{emptyTexture:r}=this.state;return n.setUniforms({sampler:i||r,hasTexture:!!i}),n}setTexture(e){const{emptyTexture:n,model:i}=this.state;i&&i.setUniforms({sampler:e||n,hasTexture:!!e})}}oe(f0,"defaultProps",qAe);oe(f0,"layerName","SimpleMeshLayer");const ZAe={inject:{"vs:#decl":`
attribute vec2 instanceDashArrays;
attribute float instanceDashOffsets;
varying vec2 vDashArray;
varying float vDashOffset;
`,"vs:#main-end":`
vDashArray = instanceDashArrays;
vDashOffset = instanceDashOffsets / width.x;
`,"fs:#decl":`
uniform float dashAlignMode;
uniform float capType;
uniform bool dashGapPickable;
varying vec2 vDashArray;
varying float vDashOffset;

float round(float x) {
  return floor(x + 0.5);
}
`,"fs:#main-start":`
  float solidLength = vDashArray.x;
  float gapLength = vDashArray.y;
  float unitLength = solidLength + gapLength;

  float offset;

  if (unitLength > 0.0) {
    if (dashAlignMode == 0.0) {
      offset = vDashOffset;
    } else {
      unitLength = vPathLength / round(vPathLength / unitLength);
      offset = solidLength / 2.0;
    }

    float unitOffset = mod(vPathPosition.y + offset, unitLength);

    if (gapLength > 0.0 && unitOffset > solidLength) {
      if (capType <= 0.5) {
        if (!(dashGapPickable && picking_uActive)) {
          discard;
        }
      } else {
        float distToEnd = length(vec2(
          min(unitOffset - solidLength, unitLength - unitOffset),
          vPathPosition.x
        ));
        if (distToEnd > 1.0) {
          if (!(dashGapPickable && picking_uActive)) {
            discard;
          }
        }
      }
    }
  }
`}},YAe={inject:{"vs:#decl":`
attribute float instanceOffsets;
`,"vs:DECKGL_FILTER_SIZE":`
  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
  size *= offsetWidth;
`,"vs:#main-end":`
  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
  float offsetDir = sign(instanceOffsets);
  vPathPosition.x = (vPathPosition.x + offsetDir) * offsetWidth - offsetDir;
  vPathPosition.y *= offsetWidth;
  vPathLength *= offsetWidth;
`,"fs:#main-start":`
  float isInside;
  isInside = step(-1.0, vPathPosition.x) * step(vPathPosition.x, 1.0);
  if (isInside == 0.0) {
    discard;
  }
`}},XAe={getDashArray:{type:"accessor",value:[0,0]},getOffset:{type:"accessor",value:0},dashJustified:!1,dashGapPickable:!1};class R2 extends y2{constructor({dash:e=!1,offset:n=!1,highPrecisionDash:i=!1}={}){super({dash:e||i,offset:n,highPrecisionDash:i})}isEnabled(e){return"pathTesselator"in e.state}getShaders(e){if(!e.isEnabled(this))return null;let n={};return e.opts.dash&&(n=qb(n,ZAe)),e.opts.offset&&(n=qb(n,YAe)),n}initializeState(e,n){const i=this.getAttributeManager();!i||!n.isEnabled(this)||(n.opts.dash&&i.addInstanced({instanceDashArrays:{size:2,accessor:"getDashArray"}}),n.opts.highPrecisionDash&&i.addInstanced({instanceDashOffsets:{size:1,accessor:"getPath",transform:n.getDashOffsets.bind(this)}}),n.opts.offset&&i.addInstanced({instanceOffsets:{size:1,accessor:"getOffset"}}))}updateState(e,n){if(!n.isEnabled(this))return;const i={};n.opts.dash&&(i.dashAlignMode=this.props.dashJustified?1:0,i.dashGapPickable=!!this.props.dashGapPickable),this.state.model.setUniforms(i)}getDashOffsets(e){const n=[0],i=this.props.positionFormat==="XY"?2:3,r=Array.isArray(e[0]),s=r?e.length:e.length/i;let u,a;for(let y=0;y<s-1;y++)u=r?e[y]:e.slice(y*i,y*i+i),u=this.projectPosition(u),y>0&&(n[y]=n[y-1]+qQ(a,u)),a=u;return n}}oe(R2,"defaultProps",XAe);oe(R2,"extensionName","PathStyleExtension");function jz(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function KAe(t){return t.length===1&&(t=JAe(t)),{left:function(e,n,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var s=i+r>>>1;t(e[s],n)<0?i=s+1:r=s}return i},right:function(e,n,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var s=i+r>>>1;t(e[s],n)>0?r=s:i=s+1}return i}}}function JAe(t){return function(e,n){return jz(t(e),n)}}KAe(jz);function wg(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(r);++i<r;)s[i]=t+i*n;return s}var cw=Array.prototype.slice;function eue(t){return t}var Ay=1,uy=2,w3=3,S1=4,A6=1e-6;function tue(t){return"translate("+(t+.5)+",0)"}function nue(t){return"translate(0,"+(t+.5)+")"}function iue(t){return function(e){return+t(e)}}function rue(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function sue(){return!this.__axis}function nS(t,e){var n=[],i=null,r=null,s=6,u=6,a=3,y=t===Ay||t===S1?-1:1,w=t===S1||t===uy?"x":"y",I=t===Ay||t===w3?tue:nue;function P(L){var U=i??(e.ticks?e.ticks.apply(e,n):e.domain()),Q=r??(e.tickFormat?e.tickFormat.apply(e,n):eue),Z=Math.max(s,0)+a,ae=e.range(),Y=+ae[0]+.5,te=+ae[ae.length-1]+.5,re=(e.bandwidth?rue:iue)(e.copy()),de=L.selection?L.selection():L,ve=de.selectAll(".domain").data([null]),Me=de.selectAll(".tick").data(U,e).order(),He=Me.exit(),Qe=Me.enter().append("g").attr("class","tick"),et=Me.select("line"),tt=Me.select("text");ve=ve.merge(ve.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Me=Me.merge(Qe),et=et.merge(Qe.append("line").attr("stroke","currentColor").attr(w+"2",y*s)),tt=tt.merge(Qe.append("text").attr("fill","currentColor").attr(w,y*Z).attr("dy",t===Ay?"0em":t===w3?"0.71em":"0.32em")),L!==de&&(ve=ve.transition(L),Me=Me.transition(L),et=et.transition(L),tt=tt.transition(L),He=He.transition(L).attr("opacity",A6).attr("transform",function(Ve){return isFinite(Ve=re(Ve))?I(Ve):this.getAttribute("transform")}),Qe.attr("opacity",A6).attr("transform",function(Ve){var nt=this.parentNode.__axis;return I(nt&&isFinite(nt=nt(Ve))?nt:re(Ve))})),He.remove(),ve.attr("d",t===S1||t==uy?u?"M"+y*u+","+Y+"H0.5V"+te+"H"+y*u:"M0.5,"+Y+"V"+te:u?"M"+Y+","+y*u+"V0.5H"+te+"V"+y*u:"M"+Y+",0.5H"+te),Me.attr("opacity",1).attr("transform",function(Ve){return I(re(Ve))}),et.attr(w+"2",y*s),tt.attr(w,y*Z).text(Q),de.filter(sue).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===uy?"start":t===S1?"end":"middle"),de.each(function(){this.__axis=re})}return P.scale=function(L){return arguments.length?(e=L,P):e},P.ticks=function(){return n=cw.call(arguments),P},P.tickArguments=function(L){return arguments.length?(n=L==null?[]:cw.call(L),P):n.slice()},P.tickValues=function(L){return arguments.length?(i=L==null?null:cw.call(L),P):i&&i.slice()},P.tickFormat=function(L){return arguments.length?(r=L,P):r},P.tickSize=function(L){return arguments.length?(s=u=+L,P):s},P.tickSizeInner=function(L){return arguments.length?(s=+L,P):s},P.tickSizeOuter=function(L){return arguments.length?(u=+L,P):u},P.tickPadding=function(L){return arguments.length?(a=+L,P):a},P}function oue(t){return nS(Ay,t)}function $z(t){return nS(uy,t)}function aue(t){return nS(w3,t)}var lue={value:function(){}};function Hz(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new cy(n)}function cy(t){this._=t}function Aue(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}cy.prototype=Hz.prototype={constructor:cy,on:function(t,e){var n=this._,i=Aue(t+"",n),r,s=-1,u=i.length;if(arguments.length<2){for(;++s<u;)if((r=(t=i[s]).type)&&(r=uue(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<u;)if(r=(t=i[s]).type)n[r]=u6(n[r],t.name,e);else if(e==null)for(r in n)n[r]=u6(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new cy(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],i=0,r=s.length;i<r;++i)s[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};function uue(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function u6(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=lue,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var b3="http://www.w3.org/1999/xhtml";const c6={svg:"http://www.w3.org/2000/svg",xhtml:b3,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function B2(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),c6.hasOwnProperty(e)?{space:c6[e],local:t}:t}function cue(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===b3&&e.documentElement.namespaceURI===b3?e.createElement(t):e.createElementNS(n,t)}}function hue(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Wz(t){var e=B2(t);return(e.local?hue:cue)(e)}function fue(){}function iS(t){return t==null?fue:function(){return this.querySelector(t)}}function due(t){typeof t!="function"&&(t=iS(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],u=s.length,a=i[r]=new Array(u),y,w,I=0;I<u;++I)(y=s[I])&&(w=t.call(y,y.__data__,I,s))&&("__data__"in y&&(w.__data__=y.__data__),a[I]=w);return new nA(i,this._parents)}function pue(){return[]}function Qz(t){return t==null?pue:function(){return this.querySelectorAll(t)}}function gue(t){typeof t!="function"&&(t=Qz(t));for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var u=e[s],a=u.length,y,w=0;w<a;++w)(y=u[w])&&(i.push(t.call(y,y.__data__,w,u)),r.push(y));return new nA(i,r)}function qz(t){return function(){return this.matches(t)}}function mue(t){typeof t!="function"&&(t=qz(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],u=s.length,a=i[r]=[],y,w=0;w<u;++w)(y=s[w])&&t.call(y,y.__data__,w,s)&&a.push(y);return new nA(i,this._parents)}function Zz(t){return new Array(t.length)}function yue(){return new nA(this._enter||this._groups.map(Zz),this._parents)}function b_(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}b_.prototype={constructor:b_,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function _ue(t){return function(){return t}}var h6="$";function vue(t,e,n,i,r,s){for(var u=0,a,y=e.length,w=s.length;u<w;++u)(a=e[u])?(a.__data__=s[u],i[u]=a):n[u]=new b_(t,s[u]);for(;u<y;++u)(a=e[u])&&(r[u]=a)}function xue(t,e,n,i,r,s,u){var a,y,w={},I=e.length,P=s.length,L=new Array(I),U;for(a=0;a<I;++a)(y=e[a])&&(L[a]=U=h6+u.call(y,y.__data__,a,e),U in w?r[a]=y:w[U]=y);for(a=0;a<P;++a)U=h6+u.call(t,s[a],a,s),(y=w[U])?(i[a]=y,y.__data__=s[a],w[U]=null):n[a]=new b_(t,s[a]);for(a=0;a<I;++a)(y=e[a])&&w[L[a]]===y&&(r[a]=y)}function wue(t,e){if(!t)return U=new Array(this.size()),w=-1,this.each(function(Me){U[++w]=Me}),U;var n=e?xue:vue,i=this._parents,r=this._groups;typeof t!="function"&&(t=_ue(t));for(var s=r.length,u=new Array(s),a=new Array(s),y=new Array(s),w=0;w<s;++w){var I=i[w],P=r[w],L=P.length,U=t.call(I,I&&I.__data__,w,i),Q=U.length,Z=a[w]=new Array(Q),ae=u[w]=new Array(Q),Y=y[w]=new Array(L);n(I,P,Z,ae,Y,U,e);for(var te=0,re=0,de,ve;te<Q;++te)if(de=Z[te]){for(te>=re&&(re=te+1);!(ve=ae[re])&&++re<Q;);de._next=ve||null}}return u=new nA(u,i),u._enter=a,u._exit=y,u}function bue(){return new nA(this._exit||this._groups.map(Zz),this._parents)}function Eue(t,e,n){var i=this.enter(),r=this,s=this.exit();return i=typeof t=="function"?t(i):i.append(t+""),e!=null&&(r=e(r)),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function Tue(t){for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),u=new Array(i),a=0;a<s;++a)for(var y=e[a],w=n[a],I=y.length,P=u[a]=new Array(I),L,U=0;U<I;++U)(L=y[U]||w[U])&&(P[U]=L);for(;a<i;++a)u[a]=e[a];return new nA(u,this._parents)}function Sue(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,s=i[r],u;--r>=0;)(u=i[r])&&(s&&u.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(u,s),s=u);return this}function Mue(t){t||(t=Cue);function e(P,L){return P&&L?t(P.__data__,L.__data__):!P-!L}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var u=n[s],a=u.length,y=r[s]=new Array(a),w,I=0;I<a;++I)(w=u[I])&&(y[I]=w);y.sort(e)}return new nA(r,this._parents).order()}function Cue(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Pue(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Iue(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function kue(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var u=i[r];if(u)return u}return null}function Lue(){var t=0;return this.each(function(){++t}),t}function Due(){return!this.node()}function Rue(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],s=0,u=r.length,a;s<u;++s)(a=r[s])&&t.call(a,a.__data__,s,r);return this}function Bue(t){return function(){this.removeAttribute(t)}}function zue(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Oue(t,e){return function(){this.setAttribute(t,e)}}function Fue(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Nue(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Uue(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Vue(t,e){var n=B2(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?zue:Bue:typeof e=="function"?n.local?Uue:Nue:n.local?Fue:Oue)(n,e))}function Yz(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Gue(t){return function(){this.style.removeProperty(t)}}function jue(t,e,n){return function(){this.style.setProperty(t,e,n)}}function $ue(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Hue(t,e,n){return arguments.length>1?this.each((e==null?Gue:typeof e=="function"?$ue:jue)(t,e,n??"")):Kf(this.node(),t)}function Kf(t,e){return t.style.getPropertyValue(e)||Yz(t).getComputedStyle(t,null).getPropertyValue(e)}function Wue(t){return function(){delete this[t]}}function Que(t,e){return function(){this[t]=e}}function que(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Zue(t,e){return arguments.length>1?this.each((e==null?Wue:typeof e=="function"?que:Que)(t,e)):this.node()[t]}function Xz(t){return t.trim().split(/^|\s+/)}function rS(t){return t.classList||new Kz(t)}function Kz(t){this._node=t,this._names=Xz(t.getAttribute("class")||"")}Kz.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Jz(t,e){for(var n=rS(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function eO(t,e){for(var n=rS(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Yue(t){return function(){Jz(this,t)}}function Xue(t){return function(){eO(this,t)}}function Kue(t,e){return function(){(e.apply(this,arguments)?Jz:eO)(this,t)}}function Jue(t,e){var n=Xz(t+"");if(arguments.length<2){for(var i=rS(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?Kue:e?Yue:Xue)(n,e))}function ece(){this.textContent=""}function tce(t){return function(){this.textContent=t}}function nce(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ice(t){return arguments.length?this.each(t==null?ece:(typeof t=="function"?nce:tce)(t)):this.node().textContent}function rce(){this.innerHTML=""}function sce(t){return function(){this.innerHTML=t}}function oce(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function ace(t){return arguments.length?this.each(t==null?rce:(typeof t=="function"?oce:sce)(t)):this.node().innerHTML}function lce(){this.nextSibling&&this.parentNode.appendChild(this)}function Ace(){return this.each(lce)}function uce(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function cce(){return this.each(uce)}function hce(t){var e=typeof t=="function"?t:Wz(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function fce(){return null}function dce(t,e){var n=typeof t=="function"?t:Wz(t),i=e==null?fce:typeof e=="function"?e:iS(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function pce(){var t=this.parentNode;t&&t.removeChild(this)}function gce(){return this.each(pce)}function mce(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function yce(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function _ce(t){return this.select(t?yce:mce)}function vce(t){return arguments.length?this.property("__data__",t):this.node().__data__}var tO={};if(typeof document<"u"){var xce=document.documentElement;"onmouseenter"in xce||(tO={mouseenter:"mouseover",mouseleave:"mouseout"})}function wce(t,e,n){return t=nO(t,e,n),function(i){var r=i.relatedTarget;(!r||r!==this&&!(r.compareDocumentPosition(this)&8))&&t.call(this,i)}}function nO(t,e,n){return function(i){try{t.call(this,this.__data__,e,n)}finally{}}}function bce(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Ece(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,s;n<r;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.capture):e[++i]=s;++i?e.length=i:delete this.__on}}}function Tce(t,e,n){var i=tO.hasOwnProperty(t.type)?wce:nO;return function(r,s,u){var a=this.__on,y,w=i(e,s,u);if(a){for(var I=0,P=a.length;I<P;++I)if((y=a[I]).type===t.type&&y.name===t.name){this.removeEventListener(y.type,y.listener,y.capture),this.addEventListener(y.type,y.listener=w,y.capture=n),y.value=e;return}}this.addEventListener(t.type,w,n),y={type:t.type,name:t.name,value:e,listener:w,capture:n},a?a.push(y):this.__on=[y]}}function Sce(t,e,n){var i=bce(t+""),r,s=i.length,u;if(arguments.length<2){var a=this.node().__on;if(a){for(var y=0,w=a.length,I;y<w;++y)for(r=0,I=a[y];r<s;++r)if((u=i[r]).type===I.type&&u.name===I.name)return I.value}return}for(a=e?Tce:Ece,n==null&&(n=!1),r=0;r<s;++r)this.each(a(i[r],e,n));return this}function iO(t,e,n){var i=Yz(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Mce(t,e){return function(){return iO(this,t,e)}}function Cce(t,e){return function(){return iO(this,t,e.apply(this,arguments))}}function Pce(t,e){return this.each((typeof e=="function"?Cce:Mce)(t,e))}var Ice=[null];function nA(t,e){this._groups=t,this._parents=e}function nm(){return new nA([[document.documentElement]],Ice)}nA.prototype=nm.prototype={constructor:nA,select:due,selectAll:gue,filter:mue,data:wue,enter:yue,exit:bue,join:Eue,merge:Tue,order:Sue,sort:Mue,call:Pue,nodes:Iue,node:kue,size:Lue,empty:Due,each:Rue,attr:Vue,style:Hue,property:Zue,classed:Jue,text:ice,html:ace,raise:Ace,lower:cce,append:hce,insert:dce,remove:gce,clone:_ce,datum:vce,on:Sce,dispatch:Pce};function im(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function z2(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function d0(){}var bg=.7,E_=1/bg,Mf="\\s*([+-]?\\d+)\\s*",Eg="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",NA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",kce=/^#([0-9a-f]{3,8})$/,Lce=new RegExp("^rgb\\("+[Mf,Mf,Mf]+"\\)$"),Dce=new RegExp("^rgb\\("+[NA,NA,NA]+"\\)$"),Rce=new RegExp("^rgba\\("+[Mf,Mf,Mf,Eg]+"\\)$"),Bce=new RegExp("^rgba\\("+[NA,NA,NA,Eg]+"\\)$"),zce=new RegExp("^hsl\\("+[Eg,NA,NA]+"\\)$"),Oce=new RegExp("^hsla\\("+[Eg,NA,NA,Eg]+"\\)$"),f6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};im(d0,Zh,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:d6,formatHex:d6,formatHsl:Fce,formatRgb:p6,toString:p6});function d6(){return this.rgb().formatHex()}function Fce(){return sO(this).formatHsl()}function p6(){return this.rgb().formatRgb()}function Zh(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=kce.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?g6(e):n===3?new ko(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?M1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?M1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Lce.exec(t))?new ko(e[1],e[2],e[3],1):(e=Dce.exec(t))?new ko(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Rce.exec(t))?M1(e[1],e[2],e[3],e[4]):(e=Bce.exec(t))?M1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=zce.exec(t))?_6(e[1],e[2]/100,e[3]/100,1):(e=Oce.exec(t))?_6(e[1],e[2]/100,e[3]/100,e[4]):f6.hasOwnProperty(t)?g6(f6[t]):t==="transparent"?new ko(NaN,NaN,NaN,0):null}function g6(t){return new ko(t>>16&255,t>>8&255,t&255,1)}function M1(t,e,n,i){return i<=0&&(t=e=n=NaN),new ko(t,e,n,i)}function rO(t){return t instanceof d0||(t=Zh(t)),t?(t=t.rgb(),new ko(t.r,t.g,t.b,t.opacity)):new ko}function E3(t,e,n,i){return arguments.length===1?rO(t):new ko(t,e,n,i??1)}function ko(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}im(ko,E3,z2(d0,{brighter:function(t){return t=t==null?E_:Math.pow(E_,t),new ko(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?bg:Math.pow(bg,t),new ko(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:m6,formatHex:m6,formatRgb:y6,toString:y6}));function m6(){return"#"+hw(this.r)+hw(this.g)+hw(this.b)}function y6(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function hw(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function _6(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new IA(t,e,n,i)}function sO(t){if(t instanceof IA)return new IA(t.h,t.s,t.l,t.opacity);if(t instanceof d0||(t=Zh(t)),!t)return new IA;if(t instanceof IA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),u=NaN,a=s-r,y=(s+r)/2;return a?(e===s?u=(n-i)/a+(n<i)*6:n===s?u=(i-e)/a+2:u=(e-n)/a+4,a/=y<.5?s+r:2-s-r,u*=60):a=y>0&&y<1?0:u,new IA(u,a,y,t.opacity)}function T3(t,e,n,i){return arguments.length===1?sO(t):new IA(t,e,n,i??1)}function IA(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}im(IA,T3,z2(d0,{brighter:function(t){return t=t==null?E_:Math.pow(E_,t),new IA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?bg:Math.pow(bg,t),new IA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new ko(fw(t>=240?t-240:t+120,r,i),fw(t,r,i),fw(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function fw(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}var Nce=Math.PI/180,Uce=180/Math.PI,T_=18,oO=.96422,aO=1,lO=.82521,AO=4/29,Cf=6/29,uO=3*Cf*Cf,Vce=Cf*Cf*Cf;function cO(t){if(t instanceof UA)return new UA(t.l,t.a,t.b,t.opacity);if(t instanceof Iu)return hO(t);t instanceof ko||(t=rO(t));var e=mw(t.r),n=mw(t.g),i=mw(t.b),r=dw((.2225045*e+.7168786*n+.0606169*i)/aO),s,u;return e===n&&n===i?s=u=r:(s=dw((.4360747*e+.3850649*n+.1430804*i)/oO),u=dw((.0139322*e+.0971045*n+.7141733*i)/lO)),new UA(116*r-16,500*(s-r),200*(r-u),t.opacity)}function Tg(t,e,n,i){return arguments.length===1?cO(t):new UA(t,e,n,i??1)}function UA(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}im(UA,Tg,z2(d0,{brighter:function(t){return new UA(this.l+T_*(t??1),this.a,this.b,this.opacity)},darker:function(t){return new UA(this.l-T_*(t??1),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=oO*pw(e),t=aO*pw(t),n=lO*pw(n),new ko(gw(3.1338561*e-1.6168667*t-.4906146*n),gw(-.9787684*e+1.9161415*t+.033454*n),gw(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function dw(t){return t>Vce?Math.pow(t,1/3):t/uO+AO}function pw(t){return t>Cf?t*t*t:uO*(t-AO)}function gw(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function mw(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Gce(t){if(t instanceof Iu)return new Iu(t.h,t.c,t.l,t.opacity);if(t instanceof UA||(t=cO(t)),t.a===0&&t.b===0)return new Iu(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Uce;return new Iu(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function jce(t,e,n,i){return arguments.length===1?Gce(t):new Iu(t,e,n,i??1)}function Iu(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function hO(t){if(isNaN(t.h))return new UA(t.l,0,0,t.opacity);var e=t.h*Nce;return new UA(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}im(Iu,jce,z2(d0,{brighter:function(t){return new Iu(this.h,this.c,this.l+T_*(t??1),this.opacity)},darker:function(t){return new Iu(this.h,this.c,this.l-T_*(t??1),this.opacity)},rgb:function(){return hO(this).rgb()}}));function fO(t){return function(){return t}}function $ce(t,e){return function(n){return t+n*e}}function Hce(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function Wce(t){return(t=+t)==1?Af:function(e,n){return n-e?Hce(e,n,t):fO(isNaN(e)?n:e)}}function Af(t,e){var n=e-t;return n?$ce(t,n):fO(isNaN(t)?e:t)}const v6=function t(e){var n=Wce(e);function i(r,s){var u=n((r=E3(r)).r,(s=E3(s)).r),a=n(r.g,s.g),y=n(r.b,s.b),w=Af(r.opacity,s.opacity);return function(I){return r.r=u(I),r.g=a(I),r.b=y(I),r.opacity=w(I),r+""}}return i.gamma=t,i}(1);function Tc(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var S3=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yw=new RegExp(S3.source,"g");function Qce(t){return function(){return t}}function qce(t){return function(e){return t(e)+""}}function Zce(t,e){var n=S3.lastIndex=yw.lastIndex=0,i,r,s,u=-1,a=[],y=[];for(t=t+"",e=e+"";(i=S3.exec(t))&&(r=yw.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),a[u]?a[u]+=s:a[++u]=s),(i=i[0])===(r=r[0])?a[u]?a[u]+=r:a[++u]=r:(a[++u]=null,y.push({i:u,x:Tc(i,r)})),n=yw.lastIndex;return n<e.length&&(s=e.slice(n),a[u]?a[u]+=s:a[++u]=s),a.length<2?y[0]?qce(y[0].x):Qce(e):(e=y.length,function(w){for(var I=0,P;I<e;++I)a[(P=y[I]).i]=P.x(w);return a.join("")})}var x6=180/Math.PI,M3={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function dO(t,e,n,i,r,s){var u,a,y;return(u=Math.sqrt(t*t+e*e))&&(t/=u,e/=u),(y=t*n+e*i)&&(n-=t*y,i-=e*y),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,y/=a),t*i<e*n&&(t=-t,e=-e,y=-y,u=-u),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*x6,skewX:Math.atan(y)*x6,scaleX:u,scaleY:a}}var sp,_w,w6,C1;function Yce(t){return t==="none"?M3:(sp||(sp=document.createElement("DIV"),_w=document.documentElement,w6=document.defaultView),sp.style.transform=t,t=w6.getComputedStyle(_w.appendChild(sp),null).getPropertyValue("transform"),_w.removeChild(sp),t=t.slice(7,-1).split(","),dO(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function Xce(t){return t==null||(C1||(C1=document.createElementNS("http://www.w3.org/2000/svg","g")),C1.setAttribute("transform",t),!(t=C1.transform.baseVal.consolidate()))?M3:(t=t.matrix,dO(t.a,t.b,t.c,t.d,t.e,t.f))}function pO(t,e,n,i){function r(w){return w.length?w.pop()+" ":""}function s(w,I,P,L,U,Q){if(w!==P||I!==L){var Z=U.push("translate(",null,e,null,n);Q.push({i:Z-4,x:Tc(w,P)},{i:Z-2,x:Tc(I,L)})}else(P||L)&&U.push("translate("+P+e+L+n)}function u(w,I,P,L){w!==I?(w-I>180?I+=360:I-w>180&&(w+=360),L.push({i:P.push(r(P)+"rotate(",null,i)-2,x:Tc(w,I)})):I&&P.push(r(P)+"rotate("+I+i)}function a(w,I,P,L){w!==I?L.push({i:P.push(r(P)+"skewX(",null,i)-2,x:Tc(w,I)}):I&&P.push(r(P)+"skewX("+I+i)}function y(w,I,P,L,U,Q){if(w!==P||I!==L){var Z=U.push(r(U)+"scale(",null,",",null,")");Q.push({i:Z-4,x:Tc(w,P)},{i:Z-2,x:Tc(I,L)})}else(P!==1||L!==1)&&U.push(r(U)+"scale("+P+","+L+")")}return function(w,I){var P=[],L=[];return w=t(w),I=t(I),s(w.translateX,w.translateY,I.translateX,I.translateY,P,L),u(w.rotate,I.rotate,P,L),a(w.skewX,I.skewX,P,L),y(w.scaleX,w.scaleY,I.scaleX,I.scaleY,P,L),w=I=null,function(U){for(var Q=-1,Z=L.length,ae;++Q<Z;)P[(ae=L[Q]).i]=ae.x(U);return P.join("")}}}var Kce=pO(Yce,"px, ","px)","deg)"),Jce=pO(Xce,", ",")",")");function ehe(t,e){var n=Af((t=Tg(t)).l,(e=Tg(e)).l),i=Af(t.a,e.a),r=Af(t.b,e.b),s=Af(t.opacity,e.opacity);return function(u){return t.l=n(u),t.a=i(u),t.b=r(u),t.opacity=s(u),t+""}}var Jf=0,bp=0,op=0,gO=1e3,S_,Ep,M_=0,Yh=0,O2=0,Sg=typeof performance=="object"&&performance.now?performance:Date,mO=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function F2(){return Yh||(mO(the),Yh=Sg.now()+O2)}function the(){Yh=0}function C_(){this._call=this._time=this._next=null}C_.prototype=yO.prototype={constructor:C_,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?F2():+n)+(e==null?0:+e),!this._next&&Ep!==this&&(Ep?Ep._next=this:S_=this,Ep=this),this._call=t,this._time=n,C3()},stop:function(){this._call&&(this._call=null,this._time=1/0,C3())}};function yO(t,e,n){var i=new C_;return i.restart(t,e,n),i}function nhe(){F2(),++Jf;for(var t=S_,e;t;)(e=Yh-t._time)>=0&&t._call.call(null,e),t=t._next;--Jf}function b6(){Yh=(M_=Sg.now())+O2,Jf=bp=0;try{nhe()}finally{Jf=0,rhe(),Yh=0}}function ihe(){var t=Sg.now(),e=t-M_;e>gO&&(O2-=e,M_=t)}function rhe(){for(var t,e=S_,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:S_=n);Ep=t,C3(i)}function C3(t){if(!Jf){bp&&(bp=clearTimeout(bp));var e=t-Yh;e>24?(t<1/0&&(bp=setTimeout(b6,t-Sg.now()-O2)),op&&(op=clearInterval(op))):(op||(M_=Sg.now(),op=setInterval(ihe,gO)),Jf=1,mO(b6))}}function E6(t,e,n){var i=new C_;return e=e==null?0:+e,i.restart(function(r){i.stop(),t(r+e)},e,n),i}var she=Hz("start","end","cancel","interrupt"),ohe=[],_O=0,T6=1,P3=2,hy=3,S6=4,I3=5,fy=6;function N2(t,e,n,i,r,s){var u=t.__transition;if(!u)t.__transition={};else if(n in u)return;ahe(t,n,{name:e,index:i,group:r,on:she,tween:ohe,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:_O})}function sS(t,e){var n=sA(t,e);if(n.state>_O)throw new Error("too late; already scheduled");return n}function Xu(t,e){var n=sA(t,e);if(n.state>hy)throw new Error("too late; already running");return n}function sA(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function ahe(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=yO(s,0,n.time);function s(w){n.state=T6,n.timer.restart(u,n.delay,n.time),n.delay<=w&&u(w-n.delay)}function u(w){var I,P,L,U;if(n.state!==T6)return y();for(I in i)if(U=i[I],U.name===n.name){if(U.state===hy)return E6(u);U.state===S6?(U.state=fy,U.timer.stop(),U.on.call("interrupt",t,t.__data__,U.index,U.group),delete i[I]):+I<e&&(U.state=fy,U.timer.stop(),U.on.call("cancel",t,t.__data__,U.index,U.group),delete i[I])}if(E6(function(){n.state===hy&&(n.state=S6,n.timer.restart(a,n.delay,n.time),a(w))}),n.state=P3,n.on.call("start",t,t.__data__,n.index,n.group),n.state===P3){for(n.state=hy,r=new Array(L=n.tween.length),I=0,P=-1;I<L;++I)(U=n.tween[I].value.call(t,t.__data__,n.index,n.group))&&(r[++P]=U);r.length=P+1}}function a(w){for(var I=w<n.duration?n.ease.call(null,w/n.duration):(n.timer.restart(y),n.state=I3,1),P=-1,L=r.length;++P<L;)r[P].call(t,I);n.state===I3&&(n.on.call("end",t,t.__data__,n.index,n.group),y())}function y(){n.state=fy,n.timer.stop(),delete i[e];for(var w in i)return;delete t.__transition}}function lhe(t,e){var n=t.__transition,i,r,s=!0,u;if(n){e=e==null?null:e+"";for(u in n){if((i=n[u]).name!==e){s=!1;continue}r=i.state>P3&&i.state<I3,i.state=fy,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[u]}s&&delete t.__transition}}function Ahe(t){return this.each(function(){lhe(this,t)})}function uhe(t,e){var n,i;return function(){var r=Xu(this,t),s=r.tween;if(s!==n){i=n=s;for(var u=0,a=i.length;u<a;++u)if(i[u].name===e){i=i.slice(),i.splice(u,1);break}}r.tween=i}}function che(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var s=Xu(this,t),u=s.tween;if(u!==i){r=(i=u).slice();for(var a={name:e,value:n},y=0,w=r.length;y<w;++y)if(r[y].name===e){r[y]=a;break}y===w&&r.push(a)}s.tween=r}}function hhe(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=sA(this.node(),n).tween,r=0,s=i.length,u;r<s;++r)if((u=i[r]).name===t)return u.value;return null}return this.each((e==null?uhe:che)(n,t,e))}function oS(t,e,n){var i=t._id;return t.each(function(){var r=Xu(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return sA(r,i).value[e]}}function vO(t,e){var n;return(typeof e=="number"?Tc:e instanceof Zh?v6:(n=Zh(e))?(e=n,v6):Zce)(t,e)}function fhe(t){return function(){this.removeAttribute(t)}}function dhe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function phe(t,e,n){var i,r=n+"",s;return function(){var u=this.getAttribute(t);return u===r?null:u===i?s:s=e(i=u,n)}}function ghe(t,e,n){var i,r=n+"",s;return function(){var u=this.getAttributeNS(t.space,t.local);return u===r?null:u===i?s:s=e(i=u,n)}}function mhe(t,e,n){var i,r,s;return function(){var u,a=n(this),y;return a==null?void this.removeAttribute(t):(u=this.getAttribute(t),y=a+"",u===y?null:u===i&&y===r?s:(r=y,s=e(i=u,a)))}}function yhe(t,e,n){var i,r,s;return function(){var u,a=n(this),y;return a==null?void this.removeAttributeNS(t.space,t.local):(u=this.getAttributeNS(t.space,t.local),y=a+"",u===y?null:u===i&&y===r?s:(r=y,s=e(i=u,a)))}}function _he(t,e){var n=B2(t),i=n==="transform"?Jce:vO;return this.attrTween(t,typeof e=="function"?(n.local?yhe:mhe)(n,i,oS(this,"attr."+t,e)):e==null?(n.local?dhe:fhe)(n):(n.local?ghe:phe)(n,i,e))}function vhe(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function xhe(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function whe(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&xhe(t,s)),n}return r._value=e,r}function bhe(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&vhe(t,s)),n}return r._value=e,r}function Ehe(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=B2(t);return this.tween(n,(i.local?whe:bhe)(i,e))}function The(t,e){return function(){sS(this,t).delay=+e.apply(this,arguments)}}function She(t,e){return e=+e,function(){sS(this,t).delay=e}}function Mhe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?The:She)(e,t)):sA(this.node(),e).delay}function Che(t,e){return function(){Xu(this,t).duration=+e.apply(this,arguments)}}function Phe(t,e){return e=+e,function(){Xu(this,t).duration=e}}function Ihe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Che:Phe)(e,t)):sA(this.node(),e).duration}function khe(t,e){if(typeof e!="function")throw new Error;return function(){Xu(this,t).ease=e}}function Lhe(t){var e=this._id;return arguments.length?this.each(khe(e,t)):sA(this.node(),e).ease}function Dhe(t){typeof t!="function"&&(t=qz(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],u=s.length,a=i[r]=[],y,w=0;w<u;++w)(y=s[w])&&t.call(y,y.__data__,w,s)&&a.push(y);return new qu(i,this._parents,this._name,this._id)}function Rhe(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),u=new Array(i),a=0;a<s;++a)for(var y=e[a],w=n[a],I=y.length,P=u[a]=new Array(I),L,U=0;U<I;++U)(L=y[U]||w[U])&&(P[U]=L);for(;a<i;++a)u[a]=e[a];return new qu(u,this._parents,this._name,this._id)}function Bhe(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function zhe(t,e,n){var i,r,s=Bhe(e)?sS:Xu;return function(){var u=s(this,t),a=u.on;a!==i&&(r=(i=a).copy()).on(e,n),u.on=r}}function Ohe(t,e){var n=this._id;return arguments.length<2?sA(this.node(),n).on.on(t):this.each(zhe(n,t,e))}function Fhe(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Nhe(){return this.on("end.remove",Fhe(this._id))}function Uhe(t){var e=this._name,n=this._id;typeof t!="function"&&(t=iS(t));for(var i=this._groups,r=i.length,s=new Array(r),u=0;u<r;++u)for(var a=i[u],y=a.length,w=s[u]=new Array(y),I,P,L=0;L<y;++L)(I=a[L])&&(P=t.call(I,I.__data__,L,a))&&("__data__"in I&&(P.__data__=I.__data__),w[L]=P,N2(w[L],e,n,L,w,sA(I,n)));return new qu(s,this._parents,e,n)}function Vhe(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Qz(t));for(var i=this._groups,r=i.length,s=[],u=[],a=0;a<r;++a)for(var y=i[a],w=y.length,I,P=0;P<w;++P)if(I=y[P]){for(var L=t.call(I,I.__data__,P,y),U,Q=sA(I,n),Z=0,ae=L.length;Z<ae;++Z)(U=L[Z])&&N2(U,e,n,Z,L,Q);s.push(L),u.push(I)}return new qu(s,u,e,n)}var Ghe=nm.prototype.constructor;function jhe(){return new Ghe(this._groups,this._parents)}function $he(t,e){var n,i,r;return function(){var s=Kf(this,t),u=(this.style.removeProperty(t),Kf(this,t));return s===u?null:s===n&&u===i?r:r=e(n=s,i=u)}}function xO(t){return function(){this.style.removeProperty(t)}}function Hhe(t,e,n){var i,r=n+"",s;return function(){var u=Kf(this,t);return u===r?null:u===i?s:s=e(i=u,n)}}function Whe(t,e,n){var i,r,s;return function(){var u=Kf(this,t),a=n(this),y=a+"";return a==null&&(y=a=(this.style.removeProperty(t),Kf(this,t))),u===y?null:u===i&&y===r?s:(r=y,s=e(i=u,a))}}function Qhe(t,e){var n,i,r,s="style."+e,u="end."+s,a;return function(){var y=Xu(this,t),w=y.on,I=y.value[s]==null?a||(a=xO(e)):void 0;(w!==n||r!==I)&&(i=(n=w).copy()).on(u,r=I),y.on=i}}function qhe(t,e,n){var i=(t+="")=="transform"?Kce:vO;return e==null?this.styleTween(t,$he(t,i)).on("end.style."+t,xO(t)):typeof e=="function"?this.styleTween(t,Whe(t,i,oS(this,"style."+t,e))).each(Qhe(this._id,t)):this.styleTween(t,Hhe(t,i,e),n).on("end.style."+t,null)}function Zhe(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function Yhe(t,e,n){var i,r;function s(){var u=e.apply(this,arguments);return u!==r&&(i=(r=u)&&Zhe(t,u,n)),i}return s._value=e,s}function Xhe(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,Yhe(t,e,n??""))}function Khe(t){return function(){this.textContent=t}}function Jhe(t){return function(){var e=t(this);this.textContent=e??""}}function e0e(t){return this.tween("text",typeof t=="function"?Jhe(oS(this,"text",t)):Khe(t==null?"":t+""))}function t0e(t){return function(e){this.textContent=t.call(this,e)}}function n0e(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&t0e(r)),e}return i._value=t,i}function i0e(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,n0e(t))}function r0e(){for(var t=this._name,e=this._id,n=wO(),i=this._groups,r=i.length,s=0;s<r;++s)for(var u=i[s],a=u.length,y,w=0;w<a;++w)if(y=u[w]){var I=sA(y,e);N2(y,t,n,w,u,{time:I.time+I.delay+I.duration,delay:0,duration:I.duration,ease:I.ease})}return new qu(i,this._parents,t,n)}function s0e(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(s,u){var a={value:u},y={value:function(){--r===0&&s()}};n.each(function(){var w=Xu(this,i),I=w.on;I!==t&&(e=(t=I).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(y)),w.on=e})})}var o0e=0;function qu(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function wO(){return++o0e}var F0=nm.prototype;qu.prototype={constructor:qu,select:Uhe,selectAll:Vhe,filter:Dhe,merge:Rhe,selection:jhe,transition:r0e,call:F0.call,nodes:F0.nodes,node:F0.node,size:F0.size,empty:F0.empty,each:F0.each,on:Ohe,attr:_he,attrTween:Ehe,style:qhe,styleTween:Xhe,text:e0e,textTween:i0e,remove:Nhe,tween:hhe,delay:Mhe,duration:Ihe,ease:Lhe,end:s0e};function a0e(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var k3={time:null,delay:0,duration:250,ease:a0e};function l0e(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return k3.time=F2(),k3;return n}function A0e(t){var e,n;t instanceof qu?(e=t._id,t=t._name):(e=wO(),(n=k3).time=F2(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var u=i[s],a=u.length,y,w=0;w<a;++w)(y=u[w])&&N2(y,t,e,w,u,n||l0e(y,e));return new qu(i,this._parents,t,e)}nm.prototype.interrupt=Ahe;nm.prototype.transition=A0e;var L3=Math.PI,D3=2*L3,bh=1e-6,u0e=D3-bh;function R3(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function bO(){return new R3}R3.prototype=bO.prototype={constructor:R3,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+s)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var s=this._x1,u=this._y1,a=n-t,y=i-e,w=s-t,I=u-e,P=w*w+I*I;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(P>bh)if(!(Math.abs(I*a-y*w)>bh)||!r)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var L=n-s,U=i-u,Q=a*a+y*y,Z=L*L+U*U,ae=Math.sqrt(Q),Y=Math.sqrt(P),te=r*Math.tan((L3-Math.acos((Q+P-Z)/(2*ae*Y)))/2),re=te/Y,de=te/ae;Math.abs(re-1)>bh&&(this._+="L"+(t+re*w)+","+(e+re*I)),this._+="A"+r+","+r+",0,0,"+ +(I*L>w*U)+","+(this._x1=t+de*a)+","+(this._y1=e+de*y)}},arc:function(t,e,n,i,r,s){t=+t,e=+e,n=+n,s=!!s;var u=n*Math.cos(i),a=n*Math.sin(i),y=t+u,w=e+a,I=1^s,P=s?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+y+","+w:(Math.abs(this._x1-y)>bh||Math.abs(this._y1-w)>bh)&&(this._+="L"+y+","+w),n&&(P<0&&(P=P%D3+D3),P>u0e?this._+="A"+n+","+n+",0,1,"+I+","+(t-u)+","+(e-a)+"A"+n+","+n+",0,1,"+I+","+(this._x1=y)+","+(this._y1=w):P>bh&&(this._+="A"+n+","+n+",0,"+ +(P>=L3)+","+I+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var il="$";function P_(){}P_.prototype=I_.prototype={constructor:P_,has:function(t){return il+t in this},get:function(t){return this[il+t]},set:function(t,e){return this[il+t]=e,this},remove:function(t){var e=il+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===il&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===il&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===il&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===il&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===il&&++t;return t},empty:function(){for(var t in this)if(t[0]===il)return!1;return!0},each:function(t){for(var e in this)e[0]===il&&t(this[e],e.slice(1),this)}};function I_(t,e){var n=new P_;if(t instanceof P_)t.each(function(a,y){n.set(y,a)});else if(Array.isArray(t)){var i=-1,r=t.length,s;if(e==null)for(;++i<r;)n.set(i,t[i]);else for(;++i<r;)n.set(e(s=t[i],i,t),s)}else if(t)for(var u in t)n.set(u,t[u]);return n}function M6(){}var mh=I_.prototype;M6.prototype={constructor:M6,has:mh.has,add:function(t){return t+="",this[il+t]=t,this},remove:mh.remove,clear:mh.clear,values:mh.keys,size:mh.size,empty:mh.empty,each:mh.each};function c0e(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function k_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function h0e(t){return t=k_(Math.abs(t)),t?t[1]:NaN}function f0e(t,e){return function(n,i){for(var r=n.length,s=[],u=0,a=t[0],y=0;r>0&&a>0&&(y+a+1>i&&(a=Math.max(1,i-y)),s.push(n.substring(r-=a,r+a)),!((y+=a+1)>i));)a=t[u=(u+1)%t.length];return s.reverse().join(e)}}function d0e(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var p0e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function B3(t){if(!(e=p0e.exec(t)))throw new Error("invalid format: "+t);var e;return new aS({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}B3.prototype=aS.prototype;function aS(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}aS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function g0e(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var EO;function m0e(t,e){var n=k_(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(EO=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,u=i.length;return s===u?i:s>u?i+new Array(s-u+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+k_(t,Math.max(0,e+s-1))[0]}function C6(t,e){var n=k_(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const P6={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:c0e,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return C6(t*100,e)},r:C6,s:m0e,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function I6(t){return t}var k6=Array.prototype.map,L6=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function y0e(t){var e=t.grouping===void 0||t.thousands===void 0?I6:f0e(k6.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?I6:d0e(k6.call(t.numerals,String)),u=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"-":t.minus+"",y=t.nan===void 0?"NaN":t.nan+"";function w(P){P=B3(P);var L=P.fill,U=P.align,Q=P.sign,Z=P.symbol,ae=P.zero,Y=P.width,te=P.comma,re=P.precision,de=P.trim,ve=P.type;ve==="n"?(te=!0,ve="g"):P6[ve]||(re===void 0&&(re=12),de=!0,ve="g"),(ae||L==="0"&&U==="=")&&(ae=!0,L="0",U="=");var Me=Z==="$"?n:Z==="#"&&/[boxX]/.test(ve)?"0"+ve.toLowerCase():"",He=Z==="$"?i:/[%p]/.test(ve)?u:"",Qe=P6[ve],et=/[defgprs%]/.test(ve);re=re===void 0?6:/[gprs]/.test(ve)?Math.max(1,Math.min(21,re)):Math.max(0,Math.min(20,re));function tt(Ve){var nt=Me,Ye=He,gt,Xt,Et;if(ve==="c")Ye=Qe(Ve)+Ye,Ve="";else{Ve=+Ve;var fn=Ve<0||1/Ve<0;if(Ve=isNaN(Ve)?y:Qe(Math.abs(Ve),re),de&&(Ve=g0e(Ve)),fn&&+Ve==0&&Q!=="+"&&(fn=!1),nt=(fn?Q==="("?Q:a:Q==="-"||Q==="("?"":Q)+nt,Ye=(ve==="s"?L6[8+EO/3]:"")+Ye+(fn&&Q==="("?")":""),et){for(gt=-1,Xt=Ve.length;++gt<Xt;)if(Et=Ve.charCodeAt(gt),48>Et||Et>57){Ye=(Et===46?r+Ve.slice(gt+1):Ve.slice(gt))+Ye,Ve=Ve.slice(0,gt);break}}}te&&!ae&&(Ve=e(Ve,1/0));var mt=nt.length+Ve.length+Ye.length,bt=mt<Y?new Array(Y-mt+1).join(L):"";switch(te&&ae&&(Ve=e(bt+Ve,bt.length?Y-Ye.length:1/0),bt=""),U){case"<":Ve=nt+Ve+Ye+bt;break;case"=":Ve=nt+bt+Ve+Ye;break;case"^":Ve=bt.slice(0,mt=bt.length>>1)+nt+Ve+Ye+bt.slice(mt);break;default:Ve=bt+nt+Ve+Ye;break}return s(Ve)}return tt.toString=function(){return P+""},tt}function I(P,L){var U=w((P=B3(P),P.type="f",P)),Q=Math.max(-8,Math.min(8,Math.floor(h0e(L)/3)))*3,Z=Math.pow(10,-Q),ae=L6[8+Q/3];return function(Y){return U(Z*Y)+ae}}return{format:w,formatPrefix:I}}var P1,ed;_0e({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function _0e(t){return P1=y0e(t),ed=P1.format,P1.formatPrefix,P1}function gd(){return Math.random()}(function t(e){function n(i,r){return i=i==null?0:+i,r=r==null?1:+r,arguments.length===1?(r=i,i=0):r-=i,function(){return e()*r+i}}return n.source=t,n})(gd);const v0e=function t(e){function n(i,r){var s,u;return i=i==null?0:+i,r=r==null?1:+r,function(){var a;if(s!=null)a=s,s=null;else do s=e()*2-1,a=e()*2-1,u=s*s+a*a;while(!u||u>1);return i+r*a*Math.sqrt(-2*Math.log(u)/u)}}return n.source=t,n}(gd);(function t(e){function n(){var i=v0e.source(e).apply(this,arguments);return function(){return Math.exp(i())}}return n.source=t,n})(gd);const x0e=function t(e){function n(i){return function(){for(var r=0,s=0;s<i;++s)r+=e();return r}}return n.source=t,n}(gd);(function t(e){function n(i){var r=x0e.source(e)(i);return function(){return r()/i}}return n.source=t,n})(gd);(function t(e){function n(i){return function(){return-Math.log(1-e())/i}}return n.source=t,n})(gd);function TO(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function w0e(t){return t.length===1&&(t=b0e(t)),{left:function(e,n,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var s=i+r>>>1;t(e[s],n)<0?i=s+1:r=s}return i},right:function(e,n,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var s=i+r>>>1;t(e[s],n)>0?r=s:i=s+1}return i}}}function b0e(t){return function(e,n){return TO(t(e),n)}}var E0e=w0e(TO),T0e=E0e.right;function S0e(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(r);++i<r;)s[i]=t+i*n;return s}var z3=Math.sqrt(50),O3=Math.sqrt(10),F3=Math.sqrt(2);function M0e(t,e,n){var i,r=-1,s,u,a;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((i=e<t)&&(s=t,t=e,e=s),(a=dy(t,e,n))===0||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),u=new Array(s=Math.ceil(e-t+1));++r<s;)u[r]=(t+r)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),u=new Array(s=Math.ceil(t-e+1));++r<s;)u[r]=(t-r)/a;return i&&u.reverse(),u}function dy(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,r);return r>=0?(s>=z3?10:s>=O3?5:s>=F3?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=z3?10:s>=O3?5:s>=F3?2:1)}function C0e(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/r;return s>=z3?r*=10:s>=O3?r*=5:s>=F3&&(r*=2),e<t?-r:r}function lS(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var SO=Array.prototype,P0e=SO.map,N3=SO.slice,D6={name:"implicit"};function MO(){var t=I_(),e=[],n=[],i=D6;function r(s){var u=s+"",a=t.get(u);if(!a){if(i!==D6)return i;t.set(u,a=e.push(s))}return n[(a-1)%n.length]}return r.domain=function(s){if(!arguments.length)return e.slice();e=[],t=I_();for(var u=-1,a=s.length,y,w;++u<a;)t.has(w=(y=s[u])+"")||t.set(w,e.push(y));return r},r.range=function(s){return arguments.length?(n=N3.call(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return MO(e,n).unknown(i)},lS.apply(r,arguments),r}function CO(){var t=MO().unknown(void 0),e=t.domain,n=t.range,i=[0,1],r,s,u=!1,a=0,y=0,w=.5;delete t.unknown;function I(){var P=e().length,L=i[1]<i[0],U=i[L-0],Q=i[1-L];r=(Q-U)/Math.max(1,P-a+y*2),u&&(r=Math.floor(r)),U+=(Q-U-r*(P-a))*w,s=r*(1-a),u&&(U=Math.round(U),s=Math.round(s));var Z=S0e(P).map(function(ae){return U+r*ae});return n(L?Z.reverse():Z)}return t.domain=function(P){return arguments.length?(e(P),I()):e()},t.range=function(P){return arguments.length?(i=[+P[0],+P[1]],I()):i.slice()},t.rangeRound=function(P){return i=[+P[0],+P[1]],u=!0,I()},t.bandwidth=function(){return s},t.step=function(){return r},t.round=function(P){return arguments.length?(u=!!P,I()):u},t.padding=function(P){return arguments.length?(a=Math.min(1,y=+P),I()):a},t.paddingInner=function(P){return arguments.length?(a=Math.min(1,P),I()):a},t.paddingOuter=function(P){return arguments.length?(y=+P,I()):y},t.align=function(P){return arguments.length?(w=Math.max(0,Math.min(1,P)),I()):w},t.copy=function(){return CO(e(),i).round(u).paddingInner(a).paddingOuter(y).align(w)},lS.apply(I(),arguments)}function PO(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return PO(e())},t}function L_(){return PO(CO.apply(null,arguments).paddingInner(1))}function AS(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function IO(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function rm(){}var Mg=.7,D_=1/Mg,Pf="\\s*([+-]?\\d+)\\s*",Cg="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",VA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",I0e=/^#([0-9a-f]{3,8})$/,k0e=new RegExp("^rgb\\("+[Pf,Pf,Pf]+"\\)$"),L0e=new RegExp("^rgb\\("+[VA,VA,VA]+"\\)$"),D0e=new RegExp("^rgba\\("+[Pf,Pf,Pf,Cg]+"\\)$"),R0e=new RegExp("^rgba\\("+[VA,VA,VA,Cg]+"\\)$"),B0e=new RegExp("^hsl\\("+[Cg,VA,VA]+"\\)$"),z0e=new RegExp("^hsla\\("+[Cg,VA,VA,Cg]+"\\)$"),R6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};AS(rm,Pg,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:B6,formatHex:B6,formatHsl:O0e,formatRgb:z6,toString:z6});function B6(){return this.rgb().formatHex()}function O0e(){return kO(this).formatHsl()}function z6(){return this.rgb().formatRgb()}function Pg(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=I0e.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?O6(e):n===3?new La(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?I1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?I1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=k0e.exec(t))?new La(e[1],e[2],e[3],1):(e=L0e.exec(t))?new La(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=D0e.exec(t))?I1(e[1],e[2],e[3],e[4]):(e=R0e.exec(t))?I1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=B0e.exec(t))?U6(e[1],e[2]/100,e[3]/100,1):(e=z0e.exec(t))?U6(e[1],e[2]/100,e[3]/100,e[4]):R6.hasOwnProperty(t)?O6(R6[t]):t==="transparent"?new La(NaN,NaN,NaN,0):null}function O6(t){return new La(t>>16&255,t>>8&255,t&255,1)}function I1(t,e,n,i){return i<=0&&(t=e=n=NaN),new La(t,e,n,i)}function F0e(t){return t instanceof rm||(t=Pg(t)),t?(t=t.rgb(),new La(t.r,t.g,t.b,t.opacity)):new La}function U3(t,e,n,i){return arguments.length===1?F0e(t):new La(t,e,n,i??1)}function La(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}AS(La,U3,IO(rm,{brighter:function(t){return t=t==null?D_:Math.pow(D_,t),new La(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?Mg:Math.pow(Mg,t),new La(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:F6,formatHex:F6,formatRgb:N6,toString:N6}));function F6(){return"#"+vw(this.r)+vw(this.g)+vw(this.b)}function N6(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function vw(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function U6(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new kA(t,e,n,i)}function kO(t){if(t instanceof kA)return new kA(t.h,t.s,t.l,t.opacity);if(t instanceof rm||(t=Pg(t)),!t)return new kA;if(t instanceof kA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),u=NaN,a=s-r,y=(s+r)/2;return a?(e===s?u=(n-i)/a+(n<i)*6:n===s?u=(i-e)/a+2:u=(e-n)/a+4,a/=y<.5?s+r:2-s-r,u*=60):a=y>0&&y<1?0:u,new kA(u,a,y,t.opacity)}function N0e(t,e,n,i){return arguments.length===1?kO(t):new kA(t,e,n,i??1)}function kA(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}AS(kA,N0e,IO(rm,{brighter:function(t){return t=t==null?D_:Math.pow(D_,t),new kA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?Mg:Math.pow(Mg,t),new kA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new La(xw(t>=240?t-240:t+120,r,i),xw(t,r,i),xw(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function xw(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function uS(t){return function(){return t}}function U0e(t,e){return function(n){return t+n*e}}function V0e(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function G0e(t){return(t=+t)==1?LO:function(e,n){return n-e?V0e(e,n,t):uS(isNaN(e)?n:e)}}function LO(t,e){var n=e-t;return n?U0e(t,n):uS(isNaN(t)?e:t)}const V6=function t(e){var n=G0e(e);function i(r,s){var u=n((r=U3(r)).r,(s=U3(s)).r),a=n(r.g,s.g),y=n(r.b,s.b),w=LO(r.opacity,s.opacity);return function(I){return r.r=u(I),r.g=a(I),r.b=y(I),r.opacity=w(I),r+""}}return i.gamma=t,i}(1);function j0e(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=t[r]*(1-s)+e[r]*s;return i}}function $0e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function H0e(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),s=new Array(n),u;for(u=0;u<i;++u)r[u]=cS(t[u],e[u]);for(;u<n;++u)s[u]=e[u];return function(a){for(u=0;u<i;++u)s[u]=r[u](a);return s}}function W0e(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function R_(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Q0e(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=cS(t[r],e[r]):i[r]=e[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var V3=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ww=new RegExp(V3.source,"g");function q0e(t){return function(){return t}}function Z0e(t){return function(e){return t(e)+""}}function Y0e(t,e){var n=V3.lastIndex=ww.lastIndex=0,i,r,s,u=-1,a=[],y=[];for(t=t+"",e=e+"";(i=V3.exec(t))&&(r=ww.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),a[u]?a[u]+=s:a[++u]=s),(i=i[0])===(r=r[0])?a[u]?a[u]+=r:a[++u]=r:(a[++u]=null,y.push({i:u,x:R_(i,r)})),n=ww.lastIndex;return n<e.length&&(s=e.slice(n),a[u]?a[u]+=s:a[++u]=s),a.length<2?y[0]?Z0e(y[0].x):q0e(e):(e=y.length,function(w){for(var I=0,P;I<e;++I)a[(P=y[I]).i]=P.x(w);return a.join("")})}function cS(t,e){var n=typeof e,i;return e==null||n==="boolean"?uS(e):(n==="number"?R_:n==="string"?(i=Pg(e))?(e=i,V6):Y0e:e instanceof Pg?V6:e instanceof Date?W0e:$0e(e)?j0e:Array.isArray(e)?H0e:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Q0e:R_)(t,e)}function X0e(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function K0e(t){return function(){return t}}function J0e(t){return+t}var G6=[0,1];function uf(t){return t}function G3(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:K0e(isNaN(e)?NaN:.5)}function j6(t){var e=t[0],n=t[t.length-1],i;return e>n&&(i=e,e=n,n=i),function(r){return Math.max(e,Math.min(n,r))}}function efe(t,e,n){var i=t[0],r=t[1],s=e[0],u=e[1];return r<i?(i=G3(r,i),s=n(u,s)):(i=G3(i,r),s=n(s,u)),function(a){return s(i(a))}}function tfe(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),u=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++u<i;)r[u]=G3(t[u],t[u+1]),s[u]=n(e[u],e[u+1]);return function(a){var y=T0e(t,a,1,i)-1;return s[y](r[y](a))}}function nfe(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ife(){var t=G6,e=G6,n=cS,i,r,s,u=uf,a,y,w;function I(){return a=Math.min(t.length,e.length)>2?tfe:efe,y=w=null,P}function P(L){return isNaN(L=+L)?s:(y||(y=a(t.map(i),e,n)))(i(u(L)))}return P.invert=function(L){return u(r((w||(w=a(e,t.map(i),R_)))(L)))},P.domain=function(L){return arguments.length?(t=P0e.call(L,J0e),u===uf||(u=j6(t)),I()):t.slice()},P.range=function(L){return arguments.length?(e=N3.call(L),I()):e.slice()},P.rangeRound=function(L){return e=N3.call(L),n=X0e,I()},P.clamp=function(L){return arguments.length?(u=L?j6(t):uf,P):u!==uf},P.interpolate=function(L){return arguments.length?(n=L,I()):n},P.unknown=function(L){return arguments.length?(s=L,P):s},function(L,U){return i=L,r=U,I()}}function rfe(t,e){return ife()(t,e)}function sfe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function B_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function td(t){return t=B_(Math.abs(t)),t?t[1]:NaN}function ofe(t,e){return function(n,i){for(var r=n.length,s=[],u=0,a=t[0],y=0;r>0&&a>0&&(y+a+1>i&&(a=Math.max(1,i-y)),s.push(n.substring(r-=a,r+a)),!((y+=a+1)>i));)a=t[u=(u+1)%t.length];return s.reverse().join(e)}}function afe(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var lfe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function z_(t){if(!(e=lfe.exec(t)))throw new Error("invalid format: "+t);var e;return new hS({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}z_.prototype=hS.prototype;function hS(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}hS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Afe(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var DO;function ufe(t,e){var n=B_(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(DO=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,u=i.length;return s===u?i:s>u?i+new Array(s-u+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+B_(t,Math.max(0,e+s-1))[0]}function $6(t,e){var n=B_(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const H6={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:sfe,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return $6(t*100,e)},r:$6,s:ufe,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function W6(t){return t}var Q6=Array.prototype.map,q6=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function cfe(t){var e=t.grouping===void 0||t.thousands===void 0?W6:ofe(Q6.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?W6:afe(Q6.call(t.numerals,String)),u=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"-":t.minus+"",y=t.nan===void 0?"NaN":t.nan+"";function w(P){P=z_(P);var L=P.fill,U=P.align,Q=P.sign,Z=P.symbol,ae=P.zero,Y=P.width,te=P.comma,re=P.precision,de=P.trim,ve=P.type;ve==="n"?(te=!0,ve="g"):H6[ve]||(re===void 0&&(re=12),de=!0,ve="g"),(ae||L==="0"&&U==="=")&&(ae=!0,L="0",U="=");var Me=Z==="$"?n:Z==="#"&&/[boxX]/.test(ve)?"0"+ve.toLowerCase():"",He=Z==="$"?i:/[%p]/.test(ve)?u:"",Qe=H6[ve],et=/[defgprs%]/.test(ve);re=re===void 0?6:/[gprs]/.test(ve)?Math.max(1,Math.min(21,re)):Math.max(0,Math.min(20,re));function tt(Ve){var nt=Me,Ye=He,gt,Xt,Et;if(ve==="c")Ye=Qe(Ve)+Ye,Ve="";else{Ve=+Ve;var fn=Ve<0||1/Ve<0;if(Ve=isNaN(Ve)?y:Qe(Math.abs(Ve),re),de&&(Ve=Afe(Ve)),fn&&+Ve==0&&Q!=="+"&&(fn=!1),nt=(fn?Q==="("?Q:a:Q==="-"||Q==="("?"":Q)+nt,Ye=(ve==="s"?q6[8+DO/3]:"")+Ye+(fn&&Q==="("?")":""),et){for(gt=-1,Xt=Ve.length;++gt<Xt;)if(Et=Ve.charCodeAt(gt),48>Et||Et>57){Ye=(Et===46?r+Ve.slice(gt+1):Ve.slice(gt))+Ye,Ve=Ve.slice(0,gt);break}}}te&&!ae&&(Ve=e(Ve,1/0));var mt=nt.length+Ve.length+Ye.length,bt=mt<Y?new Array(Y-mt+1).join(L):"";switch(te&&ae&&(Ve=e(bt+Ve,bt.length?Y-Ye.length:1/0),bt=""),U){case"<":Ve=nt+Ve+Ye+bt;break;case"=":Ve=nt+bt+Ve+Ye;break;case"^":Ve=bt.slice(0,mt=bt.length>>1)+nt+Ve+Ye+bt.slice(mt);break;default:Ve=bt+nt+Ve+Ye;break}return s(Ve)}return tt.toString=function(){return P+""},tt}function I(P,L){var U=w((P=z_(P),P.type="f",P)),Q=Math.max(-8,Math.min(8,Math.floor(td(L)/3)))*3,Z=Math.pow(10,-Q),ae=q6[8+Q/3];return function(Y){return U(Z*Y)+ae}}return{format:w,formatPrefix:I}}var k1,RO,BO;hfe({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function hfe(t){return k1=cfe(t),RO=k1.format,BO=k1.formatPrefix,k1}function ffe(t){return Math.max(0,-td(Math.abs(t)))}function dfe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(td(e)/3)))*3-td(Math.abs(t)))}function pfe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,td(e)-td(t))+1}function gfe(t,e,n,i){var r=C0e(t,e,n),s;switch(i=z_(i??",f"),i.type){case"s":{var u=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(s=dfe(r,u))&&(i.precision=s),BO(i,u)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=pfe(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=ffe(r))&&(i.precision=s-(i.type==="%")*2);break}}return RO(i)}function mfe(t){var e=t.domain;return t.ticks=function(n){var i=e();return M0e(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return gfe(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,s=i.length-1,u=i[r],a=i[s],y;return a<u&&(y=u,u=a,a=y,y=r,r=s,s=y),y=dy(u,a,n),y>0?(u=Math.floor(u/y)*y,a=Math.ceil(a/y)*y,y=dy(u,a,n)):y<0&&(u=Math.ceil(u*y)/y,a=Math.floor(a*y)/y,y=dy(u,a,n)),y>0?(i[r]=Math.floor(u/y)*y,i[s]=Math.ceil(a/y)*y,e(i)):y<0&&(i[r]=Math.ceil(u*y)/y,i[s]=Math.floor(a*y)/y,e(i)),t},t}function ku(){var t=rfe(uf,uf);return t.copy=function(){return nfe(t,ku())},lS.apply(t,arguments),mfe(t)}function U2(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}function V2(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const yfe=V2(U2("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));V2(U2("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));V2(U2("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));V2(U2("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function wc(t){return function(){return t}}var Z6=Math.abs,to=Math.atan2,yh=Math.cos,_fe=Math.max,bw=Math.min,TA=Math.sin,cf=Math.sqrt,Xo=1e-12,Ig=Math.PI,O_=Ig/2,vfe=2*Ig;function xfe(t){return t>1?0:t<-1?Ig:Math.acos(t)}function Y6(t){return t>=1?O_:t<=-1?-O_:Math.asin(t)}function wfe(t){return t.innerRadius}function bfe(t){return t.outerRadius}function Efe(t){return t.startAngle}function Tfe(t){return t.endAngle}function Sfe(t){return t&&t.padAngle}function Mfe(t,e,n,i,r,s,u,a){var y=n-t,w=i-e,I=u-r,P=a-s,L=P*y-I*w;if(!(L*L<Xo))return L=(I*(e-s)-P*(t-r))/L,[t+L*y,e+L*w]}function L1(t,e,n,i,r,s,u){var a=t-n,y=e-i,w=(u?s:-s)/cf(a*a+y*y),I=w*y,P=-w*a,L=t+I,U=e+P,Q=n+I,Z=i+P,ae=(L+Q)/2,Y=(U+Z)/2,te=Q-L,re=Z-U,de=te*te+re*re,ve=r-s,Me=L*Z-Q*U,He=(re<0?-1:1)*cf(_fe(0,ve*ve*de-Me*Me)),Qe=(Me*re-te*He)/de,et=(-Me*te-re*He)/de,tt=(Me*re+te*He)/de,Ve=(-Me*te+re*He)/de,nt=Qe-ae,Ye=et-Y,gt=tt-ae,Xt=Ve-Y;return nt*nt+Ye*Ye>gt*gt+Xt*Xt&&(Qe=tt,et=Ve),{cx:Qe,cy:et,x01:-I,y01:-P,x11:Qe*(r/ve-1),y11:et*(r/ve-1)}}function zO(){var t=wfe,e=bfe,n=wc(0),i=null,r=Efe,s=Tfe,u=Sfe,a=null;function y(){var w,I,P=+t.apply(this,arguments),L=+e.apply(this,arguments),U=r.apply(this,arguments)-O_,Q=s.apply(this,arguments)-O_,Z=Z6(Q-U),ae=Q>U;if(a||(a=w=bO()),L<P&&(I=L,L=P,P=I),!(L>Xo))a.moveTo(0,0);else if(Z>vfe-Xo)a.moveTo(L*yh(U),L*TA(U)),a.arc(0,0,L,U,Q,!ae),P>Xo&&(a.moveTo(P*yh(Q),P*TA(Q)),a.arc(0,0,P,Q,U,ae));else{var Y=U,te=Q,re=U,de=Q,ve=Z,Me=Z,He=u.apply(this,arguments)/2,Qe=He>Xo&&(i?+i.apply(this,arguments):cf(P*P+L*L)),et=bw(Z6(L-P)/2,+n.apply(this,arguments)),tt=et,Ve=et,nt,Ye;if(Qe>Xo){var gt=Y6(Qe/P*TA(He)),Xt=Y6(Qe/L*TA(He));(ve-=gt*2)>Xo?(gt*=ae?1:-1,re+=gt,de-=gt):(ve=0,re=de=(U+Q)/2),(Me-=Xt*2)>Xo?(Xt*=ae?1:-1,Y+=Xt,te-=Xt):(Me=0,Y=te=(U+Q)/2)}var Et=L*yh(Y),fn=L*TA(Y),mt=P*yh(de),bt=P*TA(de);if(et>Xo){var Kt=L*yh(te),In=L*TA(te),En=P*yh(re),Si=P*TA(re),Jn;if(Z<Ig&&(Jn=Mfe(Et,fn,En,Si,Kt,In,mt,bt))){var oi=Et-Jn[0],ci=fn-Jn[1],Nn=Kt-Jn[0],bi=In-Jn[1],xt=1/TA(xfe((oi*Nn+ci*bi)/(cf(oi*oi+ci*ci)*cf(Nn*Nn+bi*bi)))/2),nn=cf(Jn[0]*Jn[0]+Jn[1]*Jn[1]);tt=bw(et,(P-nn)/(xt-1)),Ve=bw(et,(L-nn)/(xt+1))}}Me>Xo?Ve>Xo?(nt=L1(En,Si,Et,fn,L,Ve,ae),Ye=L1(Kt,In,mt,bt,L,Ve,ae),a.moveTo(nt.cx+nt.x01,nt.cy+nt.y01),Ve<et?a.arc(nt.cx,nt.cy,Ve,to(nt.y01,nt.x01),to(Ye.y01,Ye.x01),!ae):(a.arc(nt.cx,nt.cy,Ve,to(nt.y01,nt.x01),to(nt.y11,nt.x11),!ae),a.arc(0,0,L,to(nt.cy+nt.y11,nt.cx+nt.x11),to(Ye.cy+Ye.y11,Ye.cx+Ye.x11),!ae),a.arc(Ye.cx,Ye.cy,Ve,to(Ye.y11,Ye.x11),to(Ye.y01,Ye.x01),!ae))):(a.moveTo(Et,fn),a.arc(0,0,L,Y,te,!ae)):a.moveTo(Et,fn),!(P>Xo)||!(ve>Xo)?a.lineTo(mt,bt):tt>Xo?(nt=L1(mt,bt,Kt,In,P,-tt,ae),Ye=L1(Et,fn,En,Si,P,-tt,ae),a.lineTo(nt.cx+nt.x01,nt.cy+nt.y01),tt<et?a.arc(nt.cx,nt.cy,tt,to(nt.y01,nt.x01),to(Ye.y01,Ye.x01),!ae):(a.arc(nt.cx,nt.cy,tt,to(nt.y01,nt.x01),to(nt.y11,nt.x11),!ae),a.arc(0,0,P,to(nt.cy+nt.y11,nt.cx+nt.x11),to(Ye.cy+Ye.y11,Ye.cx+Ye.x11),ae),a.arc(Ye.cx,Ye.cy,tt,to(Ye.y11,Ye.x11),to(Ye.y01,Ye.x01),!ae))):a.arc(0,0,P,de,re,ae)}if(a.closePath(),w)return a=null,w+""||null}return y.centroid=function(){var w=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,I=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-Ig/2;return[yh(I)*w,TA(I)*w]},y.innerRadius=function(w){return arguments.length?(t=typeof w=="function"?w:wc(+w),y):t},y.outerRadius=function(w){return arguments.length?(e=typeof w=="function"?w:wc(+w),y):e},y.cornerRadius=function(w){return arguments.length?(n=typeof w=="function"?w:wc(+w),y):n},y.padRadius=function(w){return arguments.length?(i=w==null?null:typeof w=="function"?w:wc(+w),y):i},y.startAngle=function(w){return arguments.length?(r=typeof w=="function"?w:wc(+w),y):r},y.endAngle=function(w){return arguments.length?(s=typeof w=="function"?w:wc(+w),y):s},y.padAngle=function(w){return arguments.length?(u=typeof w=="function"?w:wc(+w),y):u},y.context=function(w){return arguments.length?(a=w??null,y):a},y}function F_(){this._=null}function G2(t){t.U=t.C=t.L=t.R=t.P=t.N=null}F_.prototype={constructor:F_,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=X6(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)i=n.U,n===i.L?(r=i.R,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(ap(this,n),t=n,n=t.U),n.C=!1,i.C=!0,lp(this,i))):(r=i.L,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(lp(this,n),t=n,n=t.U),n.C=!1,i.C=!0,ap(this,i))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e=t.U,n,i=t.L,r=t.R,s,u;if(i?r?s=X6(r):s=i:s=r,e?e.L===t?e.L=s:e.R=s:this._=s,i&&r?(u=s.C,s.C=t.C,s.L=i,i.U=s,s!==r?(e=s.U,s.U=t.U,t=s.R,e.L=t,s.R=r,r.U=s):(s.U=e,e=s,t=s.R)):(u=t.C,t=s),t&&(t.U=e),!u){if(t&&t.C){t.C=!1;return}do{if(t===this._)break;if(t===e.L){if(n=e.R,n.C&&(n.C=!1,e.C=!0,ap(this,e),n=e.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,lp(this,n),n=e.R),n.C=e.C,e.C=n.R.C=!1,ap(this,e),t=this._;break}}else if(n=e.L,n.C&&(n.C=!1,e.C=!0,lp(this,e),n=e.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,ap(this,n),n=e.L),n.C=e.C,e.C=n.L.C=!1,lp(this,e),t=this._;break}n.C=!0,t=e,e=e.U}while(!t.C);t&&(t.C=!1)}}};function ap(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function lp(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function X6(t){for(;t.L;)t=t.L;return t}function Tp(t,e,n,i){var r=[null,null],s=ro.push(r)-1;return r.left=t,r.right=e,n&&N_(r,t,e,n),i&&N_(r,e,t,i),Ia[t.index].halfedges.push(s),Ia[e.index].halfedges.push(s),r}function Ap(t,e,n){var i=[e,n];return i.left=t,i}function N_(t,e,n,i){!t[0]&&!t[1]?(t[0]=i,t.left=e,t.right=n):t.left===n?t[1]=i:t[0]=i}function Cfe(t,e,n,i,r){var s=t[0],u=t[1],a=s[0],y=s[1],w=u[0],I=u[1],P=0,L=1,U=w-a,Q=I-y,Z;if(Z=e-a,!(!U&&Z>0)){if(Z/=U,U<0){if(Z<P)return;Z<L&&(L=Z)}else if(U>0){if(Z>L)return;Z>P&&(P=Z)}if(Z=i-a,!(!U&&Z<0)){if(Z/=U,U<0){if(Z>L)return;Z>P&&(P=Z)}else if(U>0){if(Z<P)return;Z<L&&(L=Z)}if(Z=n-y,!(!Q&&Z>0)){if(Z/=Q,Q<0){if(Z<P)return;Z<L&&(L=Z)}else if(Q>0){if(Z>L)return;Z>P&&(P=Z)}if(Z=r-y,!(!Q&&Z<0)){if(Z/=Q,Q<0){if(Z>L)return;Z>P&&(P=Z)}else if(Q>0){if(Z<P)return;Z<L&&(L=Z)}return!(P>0)&&!(L<1)||(P>0&&(t[0]=[a+P*U,y+P*Q]),L<1&&(t[1]=[a+L*U,y+L*Q])),!0}}}}}function Pfe(t,e,n,i,r){var s=t[1];if(s)return!0;var u=t[0],a=t.left,y=t.right,w=a[0],I=a[1],P=y[0],L=y[1],U=(w+P)/2,Q=(I+L)/2,Z,ae;if(L===I){if(U<e||U>=i)return;if(w>P){if(!u)u=[U,n];else if(u[1]>=r)return;s=[U,r]}else{if(!u)u=[U,r];else if(u[1]<n)return;s=[U,n]}}else if(Z=(w-P)/(L-I),ae=Q-Z*U,Z<-1||Z>1)if(w>P){if(!u)u=[(n-ae)/Z,n];else if(u[1]>=r)return;s=[(r-ae)/Z,r]}else{if(!u)u=[(r-ae)/Z,r];else if(u[1]<n)return;s=[(n-ae)/Z,n]}else if(I<L){if(!u)u=[e,Z*e+ae];else if(u[0]>=i)return;s=[i,Z*i+ae]}else{if(!u)u=[i,Z*i+ae];else if(u[0]<e)return;s=[e,Z*e+ae]}return t[0]=u,t[1]=s,!0}function Ife(t,e,n,i){for(var r=ro.length,s;r--;)(!Pfe(s=ro[r],t,e,n,i)||!Cfe(s,t,e,n,i)||!(Math.abs(s[0][0]-s[1][0])>ur||Math.abs(s[0][1]-s[1][1])>ur))&&delete ro[r]}function kfe(t){return Ia[t.index]={site:t,halfedges:[]}}function Lfe(t,e){var n=t.site,i=e.left,r=e.right;return n===r&&(r=i,i=n),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(n===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function OO(t,e){return e[+(e.left!==t.site)]}function Dfe(t,e){return e[+(e.left===t.site)]}function Rfe(){for(var t=0,e=Ia.length,n,i,r,s;t<e;++t)if((n=Ia[t])&&(s=(i=n.halfedges).length)){var u=new Array(s),a=new Array(s);for(r=0;r<s;++r)u[r]=r,a[r]=Lfe(n,ro[i[r]]);for(u.sort(function(y,w){return a[w]-a[y]}),r=0;r<s;++r)a[r]=i[u[r]];for(r=0;r<s;++r)i[r]=a[r]}}function Bfe(t,e,n,i){var r=Ia.length,s,u,a,y,w,I,P,L,U,Q,Z,ae,Y=!0;for(s=0;s<r;++s)if(u=Ia[s]){for(a=u.site,w=u.halfedges,y=w.length;y--;)ro[w[y]]||w.splice(y,1);for(y=0,I=w.length;y<I;)Q=Dfe(u,ro[w[y]]),Z=Q[0],ae=Q[1],P=OO(u,ro[w[++y%I]]),L=P[0],U=P[1],(Math.abs(Z-L)>ur||Math.abs(ae-U)>ur)&&(w.splice(y,0,ro.push(Ap(a,Q,Math.abs(Z-t)<ur&&i-ae>ur?[t,Math.abs(L-t)<ur?U:i]:Math.abs(ae-i)<ur&&n-Z>ur?[Math.abs(U-i)<ur?L:n,i]:Math.abs(Z-n)<ur&&ae-e>ur?[n,Math.abs(L-n)<ur?U:e]:Math.abs(ae-e)<ur&&Z-t>ur?[Math.abs(U-e)<ur?L:t,e]:null))-1),++I);I&&(Y=!1)}if(Y){var te,re,de,ve=1/0;for(s=0,Y=null;s<r;++s)(u=Ia[s])&&(a=u.site,te=a[0]-t,re=a[1]-e,de=te*te+re*re,de<ve&&(ve=de,Y=u));if(Y){var Me=[t,e],He=[t,i],Qe=[n,i],et=[n,e];Y.halfedges.push(ro.push(Ap(a=Y.site,Me,He))-1,ro.push(Ap(a,He,Qe))-1,ro.push(Ap(a,Qe,et))-1,ro.push(Ap(a,et,Me))-1)}}for(s=0;s<r;++s)(u=Ia[s])&&(u.halfedges.length||delete Ia[s])}var FO=[],fS;function zfe(){G2(this),this.x=this.y=this.arc=this.site=this.cy=null}function hf(t){var e=t.P,n=t.N;if(!(!e||!n)){var i=e.site,r=t.site,s=n.site;if(i!==s){var u=r[0],a=r[1],y=i[0]-u,w=i[1]-a,I=s[0]-u,P=s[1]-a,L=2*(y*P-w*I);if(!(L>=-Vfe)){var U=y*y+w*w,Q=I*I+P*P,Z=(P*U-w*Q)/L,ae=(y*Q-I*U)/L,Y=FO.pop()||new zfe;Y.arc=t,Y.site=r,Y.x=Z+u,Y.y=(Y.cy=ae+a)+Math.sqrt(Z*Z+ae*ae),t.circle=Y;for(var te=null,re=kg._;re;)if(Y.y<re.y||Y.y===re.y&&Y.x<=re.x)if(re.L)re=re.L;else{te=re.P;break}else if(re.R)re=re.R;else{te=re;break}kg.insert(te,Y),te||(fS=Y)}}}}function If(t){var e=t.circle;e&&(e.P||(fS=e.N),kg.remove(e),FO.push(e),G2(e),t.circle=null)}var NO=[];function Ofe(){G2(this),this.edge=this.site=this.circle=null}function K6(t){var e=NO.pop()||new Ofe;return e.site=t,e}function Ew(t){If(t),kf.remove(t),NO.push(t),G2(t)}function Ffe(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],s=t.P,u=t.N,a=[t];Ew(t);for(var y=s;y.circle&&Math.abs(n-y.circle.x)<ur&&Math.abs(i-y.circle.cy)<ur;)s=y.P,a.unshift(y),Ew(y),y=s;a.unshift(y),If(y);for(var w=u;w.circle&&Math.abs(n-w.circle.x)<ur&&Math.abs(i-w.circle.cy)<ur;)u=w.N,a.push(w),Ew(w),w=u;a.push(w),If(w);var I=a.length,P;for(P=1;P<I;++P)w=a[P],y=a[P-1],N_(w.edge,y.site,w.site,r);y=a[0],w=a[I-1],w.edge=Tp(y.site,w.site,null,r),hf(y),hf(w)}function Nfe(t){for(var e=t[0],n=t[1],i,r,s,u,a=kf._;a;)if(s=UO(a,n)-e,s>ur)a=a.L;else if(u=e-Ufe(a,n),u>ur){if(!a.R){i=a;break}a=a.R}else{s>-ur?(i=a.P,r=a):u>-ur?(i=a,r=a.N):i=r=a;break}kfe(t);var y=K6(t);if(kf.insert(i,y),!(!i&&!r)){if(i===r){If(i),r=K6(i.site),kf.insert(y,r),y.edge=r.edge=Tp(i.site,y.site),hf(i),hf(r);return}if(!r){y.edge=Tp(i.site,y.site);return}If(i),If(r);var w=i.site,I=w[0],P=w[1],L=t[0]-I,U=t[1]-P,Q=r.site,Z=Q[0]-I,ae=Q[1]-P,Y=2*(L*ae-U*Z),te=L*L+U*U,re=Z*Z+ae*ae,de=[(ae*te-U*re)/Y+I,(L*re-Z*te)/Y+P];N_(r.edge,w,Q,de),y.edge=Tp(w,t,null,de),r.edge=Tp(t,Q,null,de),hf(i),hf(r)}}function UO(t,e){var n=t.site,i=n[0],r=n[1],s=r-e;if(!s)return i;var u=t.P;if(!u)return-1/0;n=u.site;var a=n[0],y=n[1],w=y-e;if(!w)return a;var I=a-i,P=1/s-1/w,L=I/w;return P?(-L+Math.sqrt(L*L-2*P*(I*I/(-2*w)-y+w/2+r-s/2)))/P+i:(i+a)/2}function Ufe(t,e){var n=t.N;if(n)return UO(n,e);var i=t.site;return i[1]===e?i[0]:1/0}var ur=1e-6,Vfe=1e-12,kf,Ia,kg,ro;function Gfe(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function jfe(t,e){return e[1]-t[1]||e[0]-t[0]}function J6(t,e){var n=t.sort(jfe).pop(),i,r,s;for(ro=[],Ia=new Array(t.length),kf=new F_,kg=new F_;;)if(s=fS,n&&(!s||n[1]<s.y||n[1]===s.y&&n[0]<s.x))(n[0]!==i||n[1]!==r)&&(Nfe(n),i=n[0],r=n[1]),n=t.pop();else if(s)Ffe(s.arc);else break;if(Rfe(),e){var u=+e[0][0],a=+e[0][1],y=+e[1][0],w=+e[1][1];Ife(u,a,y,w),Bfe(u,a,y,w)}this.edges=ro,this.cells=Ia,kf=kg=ro=Ia=null}J6.prototype={constructor:J6,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(i){return OO(e,t[i])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,i){if(a=(s=n.halfedges).length)for(var r=n.site,s,u=-1,a,y,w=e[s[a-1]],I=w.left===r?w.right:w.left;++u<a;)y=I,w=e[s[u]],I=w.left===r?w.right:w.left,y&&I&&i<y.index&&i<I.index&&Gfe(r,y,I)<0&&t.push([r.data,y.data,I.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var i=this,r,s=i._found||0,u=i.cells.length,a;!(a=i.cells[s]);)if(++s>=u)return null;var y=t-a.site[0],w=e-a.site[1],I=y*y+w*w;do a=i.cells[r=s],s=null,a.halfedges.forEach(function(P){var L=i.edges[P],U=L.left;if(!((U===a.site||!U)&&!(U=L.right))){var Q=t-U[0],Z=e-U[1],ae=Q*Q+Z*Z;ae<I&&(I=ae,s=U.index)}});while(s!==null);return i._found=r,n==null||I<=n*n?a.site:null}};function Sp(t,e,n){this.k=t,this.x=e,this.y=n}Sp.prototype={constructor:Sp,scale:function(t){return t===1?this:new Sp(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Sp(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Sp.prototype;function VO(t,e,n,i,r,s){var u=r||0,a=s||0,y=n||0,w=e||function(){return"#fff"},I=i,P;function L(U){L.el=U,L.setProperties()}return L.setProperties=function(){this.el&&(L.svgGroup||(L.svgGroup=L.el.append("g")),L.svgGroup.attr("transform","translate("+u+","+a+")"),L.svgGroup.selectAll("g").data(t).enter().append("g").selectAll("rect").data(function(U,Q){return U.map(function(Z){return{r:Q,v:Z}})}).enter().append("rect").datum(function(U,Q){return U.c=Q,U}),L.svgGroup.selectAll("g").selectAll("rect").attr("x",function(U){return y/t[U.r].length*U.c}).attr("y",function(U){return U.r*P}).attr("width",function(U){return y/t[U.r].length}).attr("height",P).attr("fill",function(U){return w(U.v)}),I&&L.svgGroup.attr("id",I))},L.data=function(U){return arguments.length?(t=U,P=y/t.length,L.setProperties(),L):t},L.x=function(U){return arguments.length?(u=U,L.setProperties(),L):u},L.y=function(U){return arguments.length?(a=U,L.setProperties(),L):a},L.size=function(U){return arguments.length?(y=U,t&&(P=y/t.length,L.setProperties()),L):y},L.scale=function(U){return arguments.length?(w=U,t&&L.setProperties(),L):w},L.id=function(U){return arguments.length?(I=U,L.setProperties(),L):I},L}function $fe(t,e,n,i,r,s){var u=VO(t,e,n,i,r,s);function a(y,w,I,P){var L=ku().domain([0,P]).range([-Math.PI/6,Math.PI/6]),U=ku().domain([0,I]).range([w,0]),Q=zO().innerRadius(U(y.r+1)).outerRadius(U(y.r)).startAngle(L(y.c)).endAngle(L(y.c+1));return Q()}return u.setProperties=function(){var y=u.data(),w=u.size(),I=u.scale(),P=u.id(),L=u.x(),U=u.y();u.el&&(u.svgGroup||(u.svgGroup=u.el.append("g")),u.svgGroup.attr("transform","translate("+L+","+U+")"),u.svgGroup.selectAll("g").data(y).enter().append("g").selectAll("path").data(function(Q,Z){return Q.map(function(ae){return{r:Z,v:ae}})}).enter().append("path").datum(function(Q,Z){return Q.c=Z,Q}),u.svgGroup.selectAll("g").selectAll("path").attr("transform","translate("+w/2+","+w+")").attr("d",function(Q){return a(Q,w,y.length,y[Q.r].length)}).attr("fill",function(Q){return I(Q.v)}),P&&u.svgGroup.attr("id",P))},u}function dS(t,e,n){var i=e||yfe,r=n||function(y,w){var I=w!=null?{v:y,u:w}:{v:y.v,u:y.u};return I},s=t;function u(y,w){var I=Tg(Zh(y)),P=Tg(Zh(w));return Math.sqrt(Math.pow(I.l-P.l,2)+Math.pow(I.a-P.a,2)+Math.pow(I.b-P.b,2))}function a(y,w){var I=r(y,w),P=[0,1],L=[0,1];r.uncertaintyDomain&&(P=r.uncertaintyDomain()),r.valueDomain&&(L=r.valueDomain());var U=ku().domain(P).range([0,1]),Q=ku().domain(L).range([0,1]),Z=i(Q(I.v));switch(s){case"usl":default:Z=ehe(Z,"#fff")(U(I.u));break;case"us":Z=T3(Z);var ae=ku().domain([0,1]).range([Z.s,0]);Z.s=ae(U(I.u));break;case"ul":Z=T3(Z);var Y=ku().domain([0,1]).range([Z.l,1]);Z.l=Y(U(I.u));break}return Z}return a.colorList=function(){return this.quantize().range().map(function(y){return a(y)})},a.colorDists=function(){for(var y=this.colorList(),w=new Array(y.length),I,P=new Array(2),L,U=0;U<w.length;U++){w[U]=new Array(y.length);for(var Q=0;Q<w[U].length;Q++)L=u(y[U],y[Q]),w[U][Q]=L,U!=Q&&(U==0&&Q==1||L<I)&&(I=L,P=[y[U],y[Q]])}return w.minDist=I,w.minPair=P,w},a.mode=function(y){return arguments.length?(s=y,a):s},a.range=function(y){return arguments.length?(i=y,a):i},a.quantize=function(y){return arguments.length?(r=y,a):r},a}function Hfe(t,e,n,i,r,s,u){var a=null,y=r,w=t||null,I=e||200,P=n||30,L=i||null,U=s||0,Q=u||0;function Z(ae){a=ae,Z.setProperties()}return Z.setProperties=function(){if(a){var ae=w.domain?w.domain():[0,1],Y=I/w.range().length,te=(ae[1]-ae[0])/w.range().length,re=wg(ae[0],ae[1]+te,te),de=L_().range([0,I]).domain(re).round(!0);a.attr("class","legend").attr("transform","translate("+U+","+Q+")");var ve=a.selectAll("rect").data(w.range());ve.enter().append("rect").merge(ve).attr("x",function(Qe,et){return et*Y}).attr("y",0).attr("height",P).attr("width",Y).attr("fill",function(Qe){return Qe});var Me=a.select("g.legend > g");Me.empty()&&(Me=a.append("g")),Me.attr("transform","translate(0, "+P+")").call(aue(de).tickFormat(ed(L||"")));var He=a.select("g.legend > text");He.empty()&&(He=a.append("text")),He.style("text-anchor","middle").style("font-size",13).attr("transform","translate("+I/2+", "+(P+30)+")").text(y)}},Z.title=function(ae){return arguments.length?(y=ae,Z.setProperties(),Z):y},Z.scale=function(ae){return arguments.length?(w=ae,Z.setProperties(),Z):w},Z.size=function(ae){return arguments.length?(I=ae,Z.setProperties(),Z):I},Z.height=function(ae){return arguments.length?(P=ae,Z.setProperties(),Z):P},Z.format=function(ae){return arguments.length?(L=ae,Z.setProperties(),Z):L},Z.x=function(ae){return arguments.length?(U=ae,Z.setProperties(),Z):U},Z.y=function(ae){return arguments.length?(Q=ae,Z.setProperties(),Z):Q},Z}function Wfe(t,e,n,i,r,s,u){var a=null,y=i||"Uncertainty",w=r||"Value",I=t||null,P=e||200,L=n||null,U=s||0,Q=u||0,Z=null,ae=VO(),Y=function(te){a=te,Y.setProperties(),a.call(ae)};return Y.setProperties=function(){if(a){var te=Z;te||(te=I.quantize().data());for(var re=[],de=0;de<te.length;de++)re[de]=te[te.length-de-1];ae.y(1),ae.data(re),ae.scale(I),ae.size(P),a.attr("class","legend").attr("transform","translate("+U+","+Q+")");var ve=I&&I.quantize?I.quantize().uncertaintyDomain():[0,1],Me=(ve[1]-ve[0])/re.length,He=wg(ve[0],ve[1]+Me,Me),Qe=I&&I.quantize?I.quantize().valueDomain():[0,1],et=(Qe[1]-Qe[0])/re.length,tt=wg(Qe[0],Qe[1]+et,et),Ve=L_().range([0,P]).domain(tt);a.append("g").call(oue(Ve).tickFormat(ed(L||""))),a.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+P/2+", -25)").text(w);var nt=L_().range([0,P]).domain(He);a.append("g").attr("transform","translate("+P+", 0)").call($z(nt).tickFormat(ed(L||""))),a.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(P+40)+", "+P/2+")rotate(90)").text(y)}},Y.data=function(te){return arguments.length?(Z=te,Y.setProperties(),Y):Z},Y.scale=function(te){return arguments.length?(I=te,Y.setProperties(),Y):I},Y.size=function(te){return arguments.length?(P=te,Y.setProperties(),Y):P},Y.format=function(te){return arguments.length?(L=te,Y.setProperties(),Y):L},Y.x=function(te){return arguments.length?(U=te,Y.setProperties(),Y):U},Y.y=function(te){return arguments.length?(Q=te,Y.setProperties(),Y):Q},Y.utitle=function(te){return arguments.length?(y=te,Y.setProperties(),Y):y},Y.vtitle=function(te){return arguments.length?(w=te,Y.setProperties(),Y):w},Y}function Qfe(t,e,n,i,r,s,u){var a=null,y=i||"Uncertainty",w=r||"Value",I=t||null,P=e||200,L=n||null,U=s||0,Q=u||0,Z=null,ae=$fe(),Y=function(te){a=te,Y.setProperties(),a.call(ae)};return Y.setProperties=function(){if(a){var te=Z;te||(te=I.quantize().data());for(var re=[],de=0;de<te.length;de++)re[de]=te[te.length-de-1];ae.data(re),ae.scale(I),ae.size(P),a.attr("class","legend").attr("transform","translate("+U+","+Q+")");var ve=I&&I.quantize?I.quantize().uncertaintyDomain():[0,1],Me=(ve[1]-ve[0])/re.length,He=wg(ve[0],ve[1]+Me,Me),Qe=L_().range([0,P]).domain(He),et=P/180;a.append("g").attr("transform","translate("+(P+6*et)+","+28*et+")rotate(30)").call($z(Qe).tickFormat(ed(L||""))),a.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(P+10*et)+","+(40*et+P/2)+")rotate(-60)").text(y);var tt=I&&I.quantize?I.quantize().valueDomain():[0,1],Ve=(tt[1]-tt[0])/re[0].length,nt=wg(tt[0],tt[1]+Ve,Ve),Ye=ku().range([0,P]).domain(tt),gt=L?ed(L):Ye.tickFormat(nt.length),Xt=ku().domain(tt).range([-30,30]),Et=3*et,fn=zO().innerRadius(P+Et).outerRadius(P+Et+1).startAngle(-Math.PI/6).endAngle(Math.PI/6),mt=a.append("g").attr("transform","translate("+P/2+","+(P-Et)+")");mt.append("path").attr("fill","black").attr("stroke","transparent").attr("d",fn);var bt=mt.selectAll(".arc-label").data(nt).enter().append("g").attr("class","arc-label").attr("transform",function(Kt){return"rotate("+Xt(Kt)+")translate(0,"+(-P-Et)+")"});bt.append("text").style("font-size","11").style("text-anchor","middle").attr("y",-10).text(gt),bt.append("line").attr("x1",.5).attr("x2",.5).attr("y1",-6).attr("y2",0).attr("stroke","#000"),a.append("text").style("text-anchor","middle").style("font-size",13).attr("x",P/2).attr("y",-30).text(w)}},Y.data=function(te){return arguments.length?(Z=te,Y.setProperties(),Y):Z},Y.scale=function(te){return arguments.length?(I=te,Y.setProperties(),Y):I},Y.size=function(te){return arguments.length?(P=te,Y.setProperties(),Y):P},Y.format=function(te){return arguments.length?(L=te,Y.setProperties(),Y):L},Y.x=function(te){return arguments.length?(U=te,Y.setProperties(),Y):U},Y.y=function(te){return arguments.length?(Q=te,Y.setProperties(),Y):Q},Y.utitle=function(te){return arguments.length?(y=te,Y.setProperties(),Y):y},Y.vtitle=function(te){return arguments.length?(w=te,Y.setProperties(),Y):w},Y}const qfe=Object.freeze(Object.defineProperty({__proto__:null,arcmapLegend:Qfe,heatmapLegend:Wfe,simpleLegend:Hfe},Symbol.toStringTag,{value:"Module"}));var ek=qfe;const j2=[-300,700],pS=TT(Object.values(Object.values(em).slice(-1)[0]).map(t=>t.DemandBaselineAverage)),$2=TT(Object.values(Object.values(em).slice(-1)[0]).map(t=>t.UnmetDemandBaselineAverage)),H2=[-30,30];TT(Object.values(Object.values(em).slice(-1)[0]).map(t=>t.DemandBaselineAverage+t.UnmetDemandBaselineAverage));const gS=[0,qee(Object.values(Object.values(em).slice(-1)[0]).map(t=>t.GroundwaterVar[0]),1)],sm=[0,650],GO=sm,aa=10;ys().domain(j2).range([.5,1]).clamp(!0);const mS=hr().domain(j2).range(A0(0,1,aa));ys().domain(pS).range([0,1]).clamp(!0);const jO=hr().domain(pS).range(A0(0,1,aa)),Zfe=ys().domain($2).range([1,0]).clamp(!0),U_=hr().domain($2).range(A0(1,0,aa)),j3=ys().domain(H2).range([0,1]).clamp(!0),nd=hr().domain(H2).range(A0(0,1,aa));ys().domain(gS).range([0,.5]).clamp(!0);ys().domain(sm).range([.9,.4]).clamp(!0);hr().domain(gS).range(A0(.9,.4,aa));const $O=hr().domain(sm).range(A0(.9,.4,aa)),Yfe=ys().domain(GO).range([0,1]).clamp(!0),HO=Fa(t=>rz(ys([.75,1])(t)),-.5,.5),Xfe=Fa(sz,1,1),WO=Fa(sz,0,2),QO=Fa(yoe,0,0),Kfe=Fa(rz,0,0),qO=hr().domain(j2).range(Xg(HO,aa));hr().domain(pS).range(Xg(Xfe,aa));const ZO=hr().domain($2).range(Xg(WO,aa).reverse()),yS=hr().domain(H2).range(Xg(QO,aa));hr().domain(sm).range(Xg(Kfe,aa).reverse());const YO=dS().quantize(_S().branching(2).layers(4).valueDomain(j2).uncertaintyDomain(gS)).range(HO);dS().quantize(_S().branching(2).layers(4).valueDomain($2).uncertaintyDomain(sm)).range(WO);const Jfe=dS().quantize(_S().branching(2).layers(4).valueDomain(H2).uncertaintyDomain(GO)).range(QO),om=(t,e=0)=>Math.abs(t-e)<1/aa?0:1,am=(t,e=!1,n=!1)=>[...qO(t).replace(/[^\d,]/g,"").split(",").map(i=>Number(i)),(e?om(mS(t)):1)*255],Ph=(t,e=!1,n=!1)=>[...ZO(t).replace(/[^\d,]/g,"").split(",").map(i=>Number(i)),(e?om(U_(t)):1)*255],Xh=(t,e=!1,n=!1)=>[...yS(t).replace(/[^\d,]/g,"").split(",").map(i=>Number(i)),(e?om(nd(t),.5):1)*255],ede=(t,e,n=!1,i=!1)=>[...YO(t,e).replace(/[^\d,]/g,"").split(",").map(r=>Number(r)),(n?om(mS(t)):1)*255],tde=(t,e,n=!1,i=!1)=>[...Jfe(t,e).replace(/[^\d,]/g,"").split(",").map(r=>Number(r)),(n?om(nd(t),.5):1)*255],XO=t=>[...Fa({col:Toe(U_(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),saturation:1}),U_(t)<1/aa?0:255],KO=t=>Fa({col:xoe(jO(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),saturation:1}),JO=t=>[...Fa({col:boe(j3(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),saturation:1}),j3(t)<1/aa?0:255],Hc=ys().domain([-150,0]).range([1,0]).clamp(!0),V_=ys().domain([0,150]).range([0,1]).clamp(!0),e7=t=>ys([100,4090])(Zfe(t)),Kh=ys().domain([7,12]).range([0,1]).clamp(!0),py=goe().domain([new Date("10/31/1921"),new Date("9/30/2021")]).range([0,1199]).invert,t7=am(mS.invertExtent(.5)[0]);JO(j3.invert(.5));const nde=Xh(nd.invertExtent(hr().domain([0,1]).range(nd.range())(.75))[0]),ide=Xh(nd.invertExtent(hr().domain([0,1]).range(nd.range())(.25))[1]),Tw=XO(U_.invertExtent(.5)[0]),D1=KO(jO.invertExtent(.5)[0]),rde=1e-9;function _S(t,e){let n=t||2,i=e||2;const r=ys(),s=ys();let u=y();function a(w,I){var P=I??w.u,L=I!=null?w:w.v;let U=0;for(;U<u.length-1&&r(P)<1-(U+1)/i-rde;)U++;const Q=u[U].length>1?(u[U][1].v-u[U][0].v)/2:0;let Z=0;for(;Z<u[U].length-1&&L>u[U][Z].v+Q;)Z++;return u[U][Z]}function y(){const w=[];let I;s.nice(Math.pow(n,i-1)),r.nice(i),w[0]=[],w[0].push({u:r.invert((i-1)/i),v:s.invert(.5)});for(let P=1;P<i;P++){w[P]=[],I=2*Math.pow(n,P);for(let L=1;L<I;L+=2)w[P].push({u:r.invert(1-(P+1)/i),v:s.invert(L/I)})}return w}return a.range=()=>[].concat.apply([],u),a.tree=()=>u,a.data=a.tree,a.branching=function(w){return arguments.length?(n=Math.max(1,w),u=y(),a):n},a.layers=function(w){return arguments.length?(i=Math.max(1,w),u=y(),a):i},a.uncertaintyDomain=function(w){return arguments.length?(r.domain(w),u=y(),a):r.domain()},a.valueDomain=function(w){return arguments.length?(s.domain(w),u=y(),a):s.domain()},a}const sde={longitude:-121.046040643251,latitude:37.53320315272563,zoom:7.3252675985610685,minZoom:7,maxZoom:15,pitch:50.85,bearing:32.58},ode={longitude:-120.799348991653,latitude:37.07909824584108,zoom:9.589607161282105,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new hd},tk={longitude:-121.134704643101,latitude:37.71392572292552,zoom:7.714668594935653,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new hd},ade={longitude:-121.724611542995,latitude:38.20436329728941,zoom:8.054386171593723,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new hd},lde={longitude:-121.816103974157,latitude:38.98693235425995,zoom:9.654348182289308,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new hd},Ade={longitude:-121.80183018585,latitude:38.26807071392864,zoom:9.572807132250027,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new hd},ude={longitude:-120.732027389154,latitude:37.00972667884932,zoom:8.599616427840187,minZoom:7,maxZoom:11,pitch:50.85,bearing:32.58,transitionDuration:3e3,transitionInterpolator:new hd},cde=new yR({color:[255,255,255],intensity:1.7}),hde=new iX({timestamp:Date.UTC(2019,6,1,22),color:[255,255,255],intensity:.8}),nk={0:"Settlement",1:"Exchange",2:"Project",3:"Non-Project"},ii={0:"bl_h000",1:"CS3_ALT3_2022med_L2020ADV",2:"LTO_BA_EXP1_2022MED"},ik={0:"Scenario 1",1:"Scenario 2",2:"Scenario 3"};function ri(t,e,n){return t>=e&&t<=n}const fde=new yT({ambientLight:cde,dirLight:hde});var ts=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},i;for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);var r="";function s(K){return e.locateFile?e.locateFile(K,r):r+K}var u;typeof document<"u"&&document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",u=function(H,ee,he){var o=new XMLHttpRequest;o.open("GET",H,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){ee(o.response);return}var Le=Ii(H);if(Le){ee(Le.buffer);return}he()},o.onerror=he,o.send(null)};var a=e.print||console.log.bind(console),y=e.printErr||console.warn.bind(console);for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i]);n=null,e.arguments&&e.arguments;var w=0,I=function(K){w=K},P=function(){return w},L=8;function U(K,H,ee,he){switch(ee=ee||"i8",ee.charAt(ee.length-1)==="*"&&(ee="i32"),ee){case"i1":nt[K>>0]=H;break;case"i8":nt[K>>0]=H;break;case"i16":gt[K>>1]=H;break;case"i32":Xt[K>>2]=H;break;case"i64":Pr=[H>>>0,(Ni=H,+ei(Ni)>=1?Ni>0?(li(+yi(Ni/4294967296),4294967295)|0)>>>0:~~+$n((Ni-+(~~Ni>>>0))/4294967296)>>>0:0)],Xt[K>>2]=Pr[0],Xt[K+4>>2]=Pr[1];break;case"float":Et[K>>2]=H;break;case"double":fn[K>>3]=H;break;default:Bi("invalid type for setValue: "+ee)}}function Q(K,H,ee){switch(H=H||"i8",H.charAt(H.length-1)==="*"&&(H="i32"),H){case"i1":return nt[K>>0];case"i8":return nt[K>>0];case"i16":return gt[K>>1];case"i32":return Xt[K>>2];case"i64":return Xt[K>>2];case"float":return Et[K>>2];case"double":return fn[K>>3];default:Bi("invalid type for getValue: "+H)}return null}var Z=!1;function ae(K,H){K||Bi("Assertion failed: "+H)}function Y(K){var H=e["_"+K];return ae(H,"Cannot call unknown function "+K+", make sure it is exported"),H}function te(K,H,ee,he,o){var G={string:function(ht){var Lt=0;if(ht!=null&&ht!==0){var Dt=(ht.length<<2)+1;Lt=zs(Dt),Qe(ht,Lt,Dt)}return Lt},array:function(ht){var Lt=zs(ht.length);return et(ht,Lt),Lt}};function Le(ht){return H==="string"?Me(ht):H==="boolean"?!!ht:ht}var Ie=Y(K),Pe=[],ke=0;if(he)for(var We=0;We<he.length;We++){var at=G[ee[We]];at?(ke===0&&(ke=or()),Pe[We]=at(he[We])):Pe[We]=he[We]}var $e=Ie.apply(null,Pe);return $e=Le($e),ke!==0&&Ri(ke),$e}function re(K,H,ee,he){ee=ee||[];var o=ee.every(function(Le){return Le==="number"}),G=H!=="string";return G&&o&&!he?Y(K):function(){return te(K,H,ee,arguments)}}var de=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function ve(K,H,ee){for(var he=H+ee,o=H;K[o]&&!(o>=he);)++o;if(o-H>16&&K.subarray&&de)return de.decode(K.subarray(H,o));for(var G="";H<o;){var Le=K[H++];if(!(Le&128)){G+=String.fromCharCode(Le);continue}var Ie=K[H++]&63;if((Le&224)==192){G+=String.fromCharCode((Le&31)<<6|Ie);continue}var Pe=K[H++]&63;if((Le&240)==224?Le=(Le&15)<<12|Ie<<6|Pe:Le=(Le&7)<<18|Ie<<12|Pe<<6|K[H++]&63,Le<65536)G+=String.fromCharCode(Le);else{var ke=Le-65536;G+=String.fromCharCode(55296|ke>>10,56320|ke&1023)}}return G}function Me(K,H){return K?ve(Ye,K,H):""}function He(K,H,ee,he){if(!(he>0))return 0;for(var o=ee,G=ee+he-1,Le=0;Le<K.length;++Le){var Ie=K.charCodeAt(Le);if(Ie>=55296&&Ie<=57343){var Pe=K.charCodeAt(++Le);Ie=65536+((Ie&1023)<<10)|Pe&1023}if(Ie<=127){if(ee>=G)break;H[ee++]=Ie}else if(Ie<=2047){if(ee+1>=G)break;H[ee++]=192|Ie>>6,H[ee++]=128|Ie&63}else if(Ie<=65535){if(ee+2>=G)break;H[ee++]=224|Ie>>12,H[ee++]=128|Ie>>6&63,H[ee++]=128|Ie&63}else{if(ee+3>=G)break;H[ee++]=240|Ie>>18,H[ee++]=128|Ie>>12&63,H[ee++]=128|Ie>>6&63,H[ee++]=128|Ie&63}}return H[ee]=0,ee-o}function Qe(K,H,ee){return He(K,Ye,H,ee)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function et(K,H){nt.set(K,H)}function tt(K,H){return K%H>0&&(K+=H-K%H),K}var Ve,nt,Ye,gt,Xt,Et,fn;function mt(K){Ve=K,e.HEAP8=nt=new Int8Array(K),e.HEAP16=gt=new Int16Array(K),e.HEAP32=Xt=new Int32Array(K),e.HEAPU8=Ye=new Uint8Array(K),e.HEAPU16=new Uint16Array(K),e.HEAPU32=new Uint32Array(K),e.HEAPF32=Et=new Float32Array(K),e.HEAPF64=fn=new Float64Array(K)}var bt=5267040,Kt=24128,In=e.TOTAL_MEMORY||33554432;e.buffer?Ve=e.buffer:Ve=new ArrayBuffer(In),In=Ve.byteLength,mt(Ve),Xt[Kt>>2]=bt;function En(K){for(;K.length>0;){var H=K.shift();if(typeof H=="function"){H();continue}var ee=H.func;typeof ee=="number"?H.arg===void 0?e.dynCall_v(ee):e.dynCall_vi(ee,H.arg):ee(H.arg===void 0?null:H.arg)}}var Si=[],Jn=[],oi=[],ci=[];function Nn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Mn(e.preRun.shift());En(Si)}function bi(){En(Jn)}function xt(){En(oi)}function nn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)vt(e.postRun.shift());En(ci)}function Mn(K){Si.unshift(K)}function vt(K){ci.unshift(K)}var ei=Math.abs,$n=Math.ceil,yi=Math.floor,li=Math.min,ti=0,Ki=null;function Un(K){ti++,e.monitorRunDependencies&&e.monitorRunDependencies(ti)}function Cr(K){if(ti--,e.monitorRunDependencies&&e.monitorRunDependencies(ti),ti==0&&Ki){var H=Ki;Ki=null,H()}}e.preloadedImages={},e.preloadedAudios={};var Hn=null,Fr="data:application/octet-stream;base64,";function fo(K){return String.prototype.startsWith?K.startsWith(Fr):K.indexOf(Fr)===0}var Ni,Pr;Hn="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var Fo=24144;function is(K){return K}function ut(K){var H=/\b__Z[\w\d_]+/g;return K.replace(H,function(ee){var he=ee;return ee===he?ee:he+" ["+ee+"]"})}function It(){var K=new Error;if(!K.stack){try{throw new Error(0)}catch(H){K=H}if(!K.stack)return"(no stack trace available)"}return K.stack.toString()}function Bs(){var K=It();return e.extraStackTrace&&(K+=`
`+e.extraStackTrace()),ut(K)}function xr(K,H,ee,he){Bi("Assertion failed: "+Me(K)+", at: "+[H?Me(H):"unknown filename",ee,he?Me(he):"unknown function"])}function Rn(){return nt.length}function Nr(K,H,ee){Ye.set(Ye.subarray(H,H+ee),K)}function Ir(K){return e.___errno_location&&(Xt[e.___errno_location()>>2]=K),K}function kr(K){Bi("OOM")}function rs(K){try{var H=new ArrayBuffer(K);return H.byteLength!=K?void 0:(new Int8Array(H).set(nt),$i(H),mt(H),1)}catch{}}function kt(K){var H=Rn(),ee=16777216,he=2147483648-ee;if(K>he)return!1;for(var o=16777216,G=Math.max(H,o);G<K;)G<=536870912?G=tt(2*G,ee):G=Math.min(tt((3*G+2147483648)/4,ee),he);var Le=rs(G);return!!Le}var Tn=typeof atob=="function"?atob:function(K){var H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ee="",he,o,G,Le,Ie,Pe,ke,We=0;K=K.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Le=H.indexOf(K.charAt(We++)),Ie=H.indexOf(K.charAt(We++)),Pe=H.indexOf(K.charAt(We++)),ke=H.indexOf(K.charAt(We++)),he=Le<<2|Ie>>4,o=(Ie&15)<<4|Pe>>2,G=(Pe&3)<<6|ke,ee=ee+String.fromCharCode(he),Pe!==64&&(ee=ee+String.fromCharCode(o)),ke!==64&&(ee=ee+String.fromCharCode(G));while(We<K.length);return ee};function wn(K){try{for(var H=Tn(K),ee=new Uint8Array(H.length),he=0;he<H.length;++he)ee[he]=H.charCodeAt(he);return ee}catch{throw new Error("Converting base64 string to bytes failed.")}}function Ii(K){if(fo(K))return wn(K.slice(Fr.length))}var vs={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},mn={a:Bi,b:I,c:P,d:xr,e:Ir,f:Rn,g:Nr,h:kt,i:kr,j:is,k:ut,l:rs,m:It,n:Bs,o:Fo,p:Kt},qe=function(K,H,ee){"almost asm";var he=new K.Int8Array(ee),o=new K.Int32Array(ee);new K.Uint8Array(ee),new K.Float32Array(ee);var G=new K.Float64Array(ee),Le=H.o|0,Ie=H.p|0,Pe=K.Math.floor,ke=K.Math.abs,We=K.Math.sqrt,at=K.Math.pow,$e=K.Math.cos,ht=K.Math.sin,Lt=K.Math.tan,Dt=K.Math.acos,rn=K.Math.asin,jt=K.Math.atan,dn=K.Math.atan2,Qt=K.Math.ceil,on=K.Math.imul,vn=K.Math.min,Ot=K.Math.max,Oe=K.Math.clz32,Mt=H.b,Se=H.c,An=H.d,ar=H.e,ni=H.f,la=H.g,De=H.h,Na=H.i,we=24160;function No(m){return he=new Int8Array(m),o=new Int32Array(m),G=new Float64Array(m),ee=m,!0}function xs(m){m=m|0;var g=0;return g=we,we=we+m|0,we=we+15&-16,g|0}function Ua(){return we|0}function Va(m){m=m|0,we=m}function Aa(m,g){m=m|0,we=m}function ml(m,g){m=m|0,g=g|0;var v=0,E=0,C=0;return(m|0)<0?(g=2,g|0):(m|0)>13780509?(g=Ya(15,g)|0,g|0):(v=((m|0)<0)<<31>>31,C=V(m|0,v|0,3,0)|0,E=Se()|0,v=d(m|0,v|0,1,0)|0,v=V(C|0,E|0,v|0,Se()|0)|0,v=d(v|0,Se()|0,1,0)|0,m=Se()|0,o[g>>2]=v,o[g+4>>2]=m,g=0,g|0)}function ua(m,g,v,E){return m=m|0,g=g|0,v=v|0,E=E|0,Ji(m,g,v,E,0)|0}function Ji(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0,J=0;if(W=we,we=we+16|0,O=W,!(ge(m,g,v,E,C)|0))return E=0,we=W,E|0;do if((v|0)>=0){if((v|0)>13780509){if(R=Ya(15,O)|0,R|0)break;N=O,O=o[N>>2]|0,N=o[N+4>>2]|0}else R=((v|0)<0)<<31>>31,J=V(v|0,R|0,3,0)|0,N=Se()|0,R=d(v|0,R|0,1,0)|0,R=V(J|0,N|0,R|0,Se()|0)|0,R=d(R|0,Se()|0,1,0)|0,N=Se()|0,o[O>>2]=R,o[O+4>>2]=N,O=R;if(Te(E|0,0,O<<3|0)|0,C|0){Te(C|0,0,O<<2|0)|0,R=Ee(m,g,v,E,C,O,N,0)|0;break}R=h(O,4)|0,R?(J=Ee(m,g,v,E,R,O,N,0)|0,l(R),R=J):R=13}else R=2;while(0);return J=R,we=W,J|0}function ge(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0;if(Ze=we,we=we+16|0,je=Ze,Be=Ze+8|0,Re=je,o[Re>>2]=m,o[Re+4>>2]=g,(v|0)<0)return Be=2,we=Ze,Be|0;if(R=E,o[R>>2]=m,o[R+4>>2]=g,R=(C|0)!=0,R&&(o[C>>2]=0),pi(m,g)|0)return Be=9,we=Ze,Be|0;o[Be>>2]=0;e:do if((v|0)>=1)if(R)for(le=1,J=0,fe=0,Re=1,R=m;;){if(!(J|fe)){if(R=Fe(R,g,4,Be,je)|0,R|0)break e;if(g=je,R=o[g>>2]|0,g=o[g+4>>2]|0,pi(R,g)|0){R=9;break e}}if(R=Fe(R,g,o[22384+(fe<<2)>>2]|0,Be,je)|0,R|0)break e;if(g=je,R=o[g>>2]|0,g=o[g+4>>2]|0,m=E+(le<<3)|0,o[m>>2]=R,o[m+4>>2]=g,o[C+(le<<2)>>2]=Re,m=J+1|0,O=(m|0)==(Re|0),N=fe+1|0,W=(N|0)==6,pi(R,g)|0){R=9;break e}if(Re=Re+(W&O&1)|0,(Re|0)>(v|0)){R=0;break}else le=le+1|0,J=O?0:m,fe=O?W?0:N:fe}else for(le=1,J=0,fe=0,Re=1,R=m;;){if(!(J|fe)){if(R=Fe(R,g,4,Be,je)|0,R|0)break e;if(g=je,R=o[g>>2]|0,g=o[g+4>>2]|0,pi(R,g)|0){R=9;break e}}if(R=Fe(R,g,o[22384+(fe<<2)>>2]|0,Be,je)|0,R|0)break e;if(g=je,R=o[g>>2]|0,g=o[g+4>>2]|0,m=E+(le<<3)|0,o[m>>2]=R,o[m+4>>2]=g,m=J+1|0,O=(m|0)==(Re|0),N=fe+1|0,W=(N|0)==6,pi(R,g)|0){R=9;break e}if(Re=Re+(W&O&1)|0,(Re|0)>(v|0)){R=0;break}else le=le+1|0,J=O?0:m,fe=O?W?0:N:fe}else R=0;while(0);return Be=R,we=Ze,Be|0}function Ee(m,g,v,E,C,R,O,N){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0,R=R|0,O=O|0,N=N|0;var W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0;if(Ze=we,we=we+16|0,je=Ze+8|0,Be=Ze,W=X(m|0,g|0,R|0,O|0)|0,le=Se()|0,fe=E+(W<<3)|0,ct=fe,At=o[ct>>2]|0,ct=o[ct+4>>2]|0,J=(At|0)==(m|0)&(ct|0)==(g|0),!((At|0)==0&(ct|0)==0|J))do W=d(W|0,le|0,1,0)|0,W=$(W|0,Se()|0,R|0,O|0)|0,le=Se()|0,fe=E+(W<<3)|0,At=fe,ct=o[At>>2]|0,At=o[At+4>>2]|0,J=(ct|0)==(m|0)&(At|0)==(g|0);while(!((ct|0)==0&(At|0)==0|J));if(W=C+(W<<2)|0,J&&(o[W>>2]|0)<=(N|0)||(At=fe,o[At>>2]=m,o[At+4>>2]=g,o[W>>2]=N,(N|0)>=(v|0)))return At=0,we=Ze,At|0;switch(J=N+1|0,o[je>>2]=0,W=Fe(m,g,2,je,Be)|0,W|0){case 9:{Re=9;break}case 0:{W=Be,W=Ee(o[W>>2]|0,o[W+4>>2]|0,v,E,C,R,O,J)|0,W||(Re=9);break}}e:do if((Re|0)==9){switch(o[je>>2]=0,W=Fe(m,g,3,je,Be)|0,W|0){case 9:break;case 0:{if(W=Be,W=Ee(o[W>>2]|0,o[W+4>>2]|0,v,E,C,R,O,J)|0,W|0)break e;break}default:break e}switch(o[je>>2]=0,W=Fe(m,g,1,je,Be)|0,W|0){case 9:break;case 0:{if(W=Be,W=Ee(o[W>>2]|0,o[W+4>>2]|0,v,E,C,R,O,J)|0,W|0)break e;break}default:break e}switch(o[je>>2]=0,W=Fe(m,g,5,je,Be)|0,W|0){case 9:break;case 0:{if(W=Be,W=Ee(o[W>>2]|0,o[W+4>>2]|0,v,E,C,R,O,J)|0,W|0)break e;break}default:break e}switch(o[je>>2]=0,W=Fe(m,g,4,je,Be)|0,W|0){case 9:break;case 0:{if(W=Be,W=Ee(o[W>>2]|0,o[W+4>>2]|0,v,E,C,R,O,J)|0,W|0)break e;break}default:break e}switch(o[je>>2]=0,W=Fe(m,g,6,je,Be)|0,W|0){case 9:break;case 0:{if(W=Be,W=Ee(o[W>>2]|0,o[W+4>>2]|0,v,E,C,R,O,J)|0,W|0)break e;break}default:break e}return At=0,we=Ze,At|0}while(0);return At=W,we=Ze,At|0}function Fe(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0;if(v>>>0>6)return C=1,C|0;if(fe=(o[E>>2]|0)%6|0,o[E>>2]=fe,(fe|0)>0){R=0;do v=mo(v)|0,R=R+1|0;while((R|0)<(o[E>>2]|0))}if(fe=ne(m|0,g|0,45)|0,Se()|0,le=fe&127,le>>>0>121)return C=5,C|0;W=tr(m,g)|0,R=ne(m|0,g|0,52)|0,Se()|0,R=R&15;e:do if(!R)J=8;else{for(;;){if(O=(15-R|0)*3|0,N=ne(m|0,g|0,O|0)|0,Se()|0,N=N&7,(N|0)==7){g=5;break}if(Be=(wr(R)|0)==0,R=R+-1|0,Re=ue(7,0,O|0)|0,g=g&~(Se()|0),je=ue(o[(Be?432:16)+(N*28|0)+(v<<2)>>2]|0,0,O|0)|0,O=Se()|0,v=o[(Be?640:224)+(N*28|0)+(v<<2)>>2]|0,m=je|m&~Re,g=O|g,!v){v=0;break e}if(!R){J=8;break e}}return g|0}while(0);(J|0)==8&&(Be=o[848+(le*28|0)+(v<<2)>>2]|0,je=ue(Be|0,0,45)|0,m=je|m,g=Se()|0|g&-1040385,v=o[4272+(le*28|0)+(v<<2)>>2]|0,(Be&127|0)==127&&(Be=ue(o[848+(le*28|0)+20>>2]|0,0,45)|0,g=Se()|0|g&-1040385,v=o[4272+(le*28|0)+20>>2]|0,m=Us(Be|m,g)|0,g=Se()|0,o[E>>2]=(o[E>>2]|0)+1)),N=ne(m|0,g|0,45)|0,Se()|0,N=N&127;e:do if(Vn(N)|0){t:do if((tr(m,g)|0)==1){if((le|0)!=(N|0))if(uA(N,o[7696+(le*28|0)>>2]|0)|0){m=gA(m,g)|0,O=1,g=Se()|0;break}else An(23313,22416,436,22424);switch(W|0){case 3:{m=Us(m,g)|0,g=Se()|0,o[E>>2]=(o[E>>2]|0)+1,O=0;break t}case 5:{m=gA(m,g)|0,g=Se()|0,o[E>>2]=(o[E>>2]|0)+5,O=0;break t}case 0:return Be=9,Be|0;default:return Be=1,Be|0}}else O=0;while(0);if((v|0)>0){R=0;do m=tu(m,g)|0,g=Se()|0,R=R+1|0;while((R|0)!=(v|0))}if((le|0)!=(N|0)){if(!(aA(N)|0)){if((O|0)!=0|(tr(m,g)|0)!=5)break;o[E>>2]=(o[E>>2]|0)+1;break}switch(fe&127){case 8:case 118:break e}(tr(m,g)|0)!=3&&(o[E>>2]=(o[E>>2]|0)+1)}}else if((v|0)>0){R=0;do m=Us(m,g)|0,g=Se()|0,R=R+1|0;while((R|0)!=(v|0))}while(0);return o[E>>2]=((o[E>>2]|0)+v|0)%6|0,Be=C,o[Be>>2]=m,o[Be+4>>2]=g,Be=0,Be|0}function ot(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0,J=0;for(N=we,we=we+16|0,R=N,O=N+8|0,C=(pi(m,g)|0)==0,C=C?1:2;;){if(o[O>>2]=0,J=(Fe(m,g,C,O,R)|0)==0,W=R,J&((o[W>>2]|0)==(v|0)?(o[W+4>>2]|0)==(E|0):0)){m=4;break}if(C=C+1|0,C>>>0>=7){C=7,m=4;break}}return(m|0)==4?(we=N,C|0):0}function wt(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0;if(Be=we,we=we+16|0,Re=Be,je=Be+8|0,fe=Re,o[fe>>2]=m,o[fe+4>>2]=g,!v)return je=E,o[je>>2]=m,o[je+4>>2]=g,je=0,we=Be,je|0;o[je>>2]=0;e:do if(pi(m,g)|0)m=9;else{if(R=(v|0)>0,R){C=0,fe=m;do{if(m=Fe(fe,g,4,je,Re)|0,m|0)break e;if(g=Re,fe=o[g>>2]|0,g=o[g+4>>2]|0,C=C+1|0,pi(fe,g)|0){m=9;break e}}while((C|0)<(v|0));if(le=E,o[le>>2]=fe,o[le+4>>2]=g,le=v+-1|0,R){J=0,m=1;do{if(C=22384+(J<<2)|0,(J|0)==5)for(O=o[C>>2]|0,R=0,C=m;;){if(m=Re,m=Fe(o[m>>2]|0,o[m+4>>2]|0,O,je,Re)|0,m|0)break e;if((R|0)!=(le|0))if(W=Re,N=o[W>>2]|0,W=o[W+4>>2]|0,m=E+(C<<3)|0,o[m>>2]=N,o[m+4>>2]=W,!(pi(N,W)|0))m=C+1|0;else{m=9;break e}else m=C;if(R=R+1|0,(R|0)>=(v|0))break;C=m}else for(O=Re,W=o[C>>2]|0,N=0,C=m,R=o[O>>2]|0,O=o[O+4>>2]|0;;){if(m=Fe(R,O,W,je,Re)|0,m|0)break e;if(O=Re,R=o[O>>2]|0,O=o[O+4>>2]|0,m=E+(C<<3)|0,o[m>>2]=R,o[m+4>>2]=O,m=C+1|0,pi(R,O)|0){m=9;break e}if(N=N+1|0,(N|0)>=(v|0))break;C=m}J=J+1|0}while(J>>>0<6);m=Re,O=fe,C=o[m>>2]|0,R=g,m=o[m+4>>2]|0}else O=fe,C=fe,R=g,m=g}else O=E,o[O>>2]=m,o[O+4>>2]=g,O=m,C=m,R=g,m=g;m=(O|0)==(C|0)&(R|0)==(m|0)?0:9}while(0);return je=m,we=Be,je|0}function Wt(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0,J=0;if(N=we,we=we+48|0,C=N+16|0,R=N+8|0,O=N,v|0)return O=15,we=N,O|0;if(J=m,W=o[J+4>>2]|0,v=R,o[v>>2]=o[J>>2],o[v+4>>2]=W,xo(R,C),g=Ku(C,g,O)|0,!g){if(v=o[R>>2]|0,R=o[m+8>>2]|0,(R|0)>0){C=o[m+12>>2]|0,g=0;do v=(o[C+(g<<3)>>2]|0)+v|0,g=g+1|0;while((g|0)<(R|0))}g=O,C=o[g>>2]|0,g=o[g+4>>2]|0,R=((v|0)<0)<<31>>31,(g|0)<(R|0)|(g|0)==(R|0)&C>>>0<v>>>0?(g=O,o[g>>2]=v,o[g+4>>2]=R,g=R):v=C,W=d(v|0,g|0,12,0)|0,J=Se()|0,g=O,o[g>>2]=W,o[g+4>>2]=J,g=E,o[g>>2]=W,o[g+4>>2]=J,g=0}return J=g,we=N,J|0}function kn(m,g,v,E,C,R,O){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0,R=R|0,O=O|0;var N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0,rt=0,Xe=0,Vt=0,Bt=0,ft=0,yt=0,Cn=0,xn=0,gn=0,yn=0,bn=0,Ln=0,ai=0,Pn=0,xi=0,Qi=0,el=0;if(ai=we,we=we+64|0,gn=ai+48|0,yn=ai+32|0,bn=ai+24|0,Vt=ai+8|0,Bt=ai,W=o[m>>2]|0,(W|0)<=0)return Ln=0,we=ai,Ln|0;for(ft=m+4|0,yt=gn+8|0,Cn=yn+8|0,xn=Vt+8|0,N=0,rt=0;;){J=o[ft>>2]|0,it=J+(rt<<4)|0,o[gn>>2]=o[it>>2],o[gn+4>>2]=o[it+4>>2],o[gn+8>>2]=o[it+8>>2],o[gn+12>>2]=o[it+12>>2],(rt|0)==(W+-1|0)?(o[yn>>2]=o[J>>2],o[yn+4>>2]=o[J+4>>2],o[yn+8>>2]=o[J+8>>2],o[yn+12>>2]=o[J+12>>2]):(it=J+(rt+1<<4)|0,o[yn>>2]=o[it>>2],o[yn+4>>2]=o[it+4>>2],o[yn+8>>2]=o[it+8>>2],o[yn+12>>2]=o[it+12>>2]),W=vl(gn,yn,E,bn)|0;e:do if(W)J=0,N=W;else if(J=bn,W=o[J>>2]|0,J=o[J+4>>2]|0,(J|0)>0|(J|0)==0&W>>>0>0){At=0,it=0;t:for(;;){if(el=+G[gn>>3],ct=x(W|0,J|0,At|0,it|0)|0,Qi=+(ct>>>0)+4294967296*+(Se()|0),Pn=+(W>>>0)+4294967296*+(J|0),xi=+(At>>>0)+4294967296*+(it|0),G[Vt>>3]=el*Qi/Pn+ +G[yn>>3]*xi/Pn,G[xn>>3]=+G[yt>>3]*Qi/Pn+ +G[Cn>>3]*xi/Pn,W=as(Vt,E,Bt)|0,W|0){N=W;break}ct=Bt,Ze=o[ct>>2]|0,ct=o[ct+4>>2]|0,Re=X(Ze|0,ct|0,g|0,v|0)|0,le=Se()|0,W=O+(Re<<3)|0,fe=W,J=o[fe>>2]|0,fe=o[fe+4>>2]|0;n:do if((J|0)==0&(fe|0)==0)Xe=W,Ln=16;else for(je=0,Be=0;;){if((je|0)>(v|0)|(je|0)==(v|0)&Be>>>0>g>>>0){N=1;break t}if((J|0)==(Ze|0)&(fe|0)==(ct|0))break n;if(W=d(Re|0,le|0,1,0)|0,Re=$(W|0,Se()|0,g|0,v|0)|0,le=Se()|0,Be=d(Be|0,je|0,1,0)|0,je=Se()|0,W=O+(Re<<3)|0,fe=W,J=o[fe>>2]|0,fe=o[fe+4>>2]|0,(J|0)==0&(fe|0)==0){Xe=W,Ln=16;break}}while(0);if((Ln|0)==16&&(Ln=0,!((Ze|0)==0&(ct|0)==0))&&(Be=Xe,o[Be>>2]=Ze,o[Be+4>>2]=ct,Be=R+(o[C>>2]<<3)|0,o[Be>>2]=Ze,o[Be+4>>2]=ct,Be=C,Be=d(o[Be>>2]|0,o[Be+4>>2]|0,1,0)|0,Ze=Se()|0,ct=C,o[ct>>2]=Be,o[ct+4>>2]=Ze),At=d(At|0,it|0,1,0)|0,it=Se()|0,J=bn,W=o[J>>2]|0,J=o[J+4>>2]|0,!((J|0)>(it|0)|(J|0)==(it|0)&W>>>0>At>>>0)){J=1;break e}}J=0}else J=1;while(0);if(rt=rt+1|0,!J){Ln=21;break}if(W=o[m>>2]|0,(rt|0)>=(W|0)){N=0,Ln=21;break}}return(Ln|0)==21?(we=ai,N|0):0}function Pi(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0,rt=0,Xe=0,Vt=0,Bt=0,ft=0,yt=0,Cn=0,xn=0,gn=0,yn=0,bn=0,Ln=0,ai=0,Pn=0,xi=0,Qi=0;if(Qi=we,we=we+112|0,Ln=Qi+80|0,W=Qi+72|0,ai=Qi,Pn=Qi+56|0,v|0)return xi=15,we=Qi,xi|0;if(J=m+8|0,xi=_((o[J>>2]<<5)+32|0)|0,!xi)return xi=13,we=Qi,xi|0;if(lu(m,xi),yn=m,bn=o[yn+4>>2]|0,v=W,o[v>>2]=o[yn>>2],o[v+4>>2]=bn,xo(W,Ln),v=Ku(Ln,g,ai)|0,v)yn=0,bn=0;else{if(v=o[W>>2]|0,R=o[J>>2]|0,(R|0)>0){O=o[m+12>>2]|0,C=0;do v=(o[O+(C<<3)>>2]|0)+v|0,C=C+1|0;while((C|0)!=(R|0));C=v}else C=v;v=ai,R=o[v>>2]|0,v=o[v+4>>2]|0,O=((C|0)<0)<<31>>31,(v|0)<(O|0)|(v|0)==(O|0)&R>>>0<C>>>0?(v=ai,o[v>>2]=C,o[v+4>>2]=O,v=O):C=R,yn=d(C|0,v|0,12,0)|0,bn=Se()|0,v=ai,o[v>>2]=yn,o[v+4>>2]=bn,v=0}if(v|0)return l(xi),xi=v,we=Qi,xi|0;if(C=h(yn,8)|0,!C)return l(xi),xi=13,we=Qi,xi|0;if(N=h(yn,8)|0,!N)return l(xi),l(C),xi=13,we=Qi,xi|0;xn=Ln,o[xn>>2]=0,o[xn+4>>2]=0,xn=m,gn=o[xn+4>>2]|0,v=W,o[v>>2]=o[xn>>2],o[v+4>>2]=gn,v=kn(W,yn,bn,g,Ln,C,N)|0;e:do if(v)l(C),l(N),l(xi);else{t:do if((o[J>>2]|0)>0){for(O=m+12|0,R=0;v=kn((o[O>>2]|0)+(R<<3)|0,yn,bn,g,Ln,C,N)|0,R=R+1|0,!(v|0);)if((R|0)>=(o[J>>2]|0))break t;l(C),l(N),l(xi);break e}while(0);(bn|0)>0|(bn|0)==0&yn>>>0>0&&Te(N|0,0,yn<<3|0)|0,gn=Ln,xn=o[gn+4>>2]|0;t:do if((xn|0)>0|(xn|0)==0&(o[gn>>2]|0)>>>0>0){ft=C,yt=N,Cn=C,xn=N,gn=C,v=C,Xe=C,Vt=N,Bt=N,C=N;n:for(;;){for(ct=0,At=0,it=0,rt=0,R=0,O=0;;){N=ai,W=N+56|0;do o[N>>2]=0,N=N+4|0;while((N|0)<(W|0));if(g=ft+(ct<<3)|0,J=o[g>>2]|0,g=o[g+4>>2]|0,ge(J,g,1,ai,0)|0){N=ai,W=N+56|0;do o[N>>2]=0,N=N+4|0;while((N|0)<(W|0));N=h(7,4)|0,N|0&&(Ee(J,g,1,ai,N,7,0,0)|0,l(N))}for(Ze=0;;){Be=ai+(Ze<<3)|0,je=o[Be>>2]|0,Be=o[Be+4>>2]|0;i:do if((je|0)==0&(Be|0)==0)N=R,W=O;else{if(le=X(je|0,Be|0,yn|0,bn|0)|0,J=Se()|0,N=E+(le<<3)|0,g=N,W=o[g>>2]|0,g=o[g+4>>2]|0,!((W|0)==0&(g|0)==0)){fe=0,Re=0;do{if((fe|0)>(bn|0)|(fe|0)==(bn|0)&Re>>>0>yn>>>0)break n;if((W|0)==(je|0)&(g|0)==(Be|0)){N=R,W=O;break i}N=d(le|0,J|0,1,0)|0,le=$(N|0,Se()|0,yn|0,bn|0)|0,J=Se()|0,Re=d(Re|0,fe|0,1,0)|0,fe=Se()|0,N=E+(le<<3)|0,g=N,W=o[g>>2]|0,g=o[g+4>>2]|0}while(!((W|0)==0&(g|0)==0))}(je|0)==0&(Be|0)==0?(N=R,W=O):(_o(je,Be,Pn)|0,_a(m,xi,Pn)|0&&(Re=d(R|0,O|0,1,0)|0,O=Se()|0,fe=N,o[fe>>2]=je,o[fe+4>>2]=Be,R=yt+(R<<3)|0,o[R>>2]=je,o[R+4>>2]=Be,R=Re),N=R,W=O)}while(0);if(Ze=Ze+1|0,Ze>>>0>=7)break;R=N,O=W}if(ct=d(ct|0,At|0,1,0)|0,At=Se()|0,it=d(it|0,rt|0,1,0)|0,rt=Se()|0,O=Ln,R=o[O>>2]|0,O=o[O+4>>2]|0,(rt|0)<(O|0)|(rt|0)==(O|0)&it>>>0<R>>>0)R=N,O=W;else break}if((O|0)>0|(O|0)==0&R>>>0>0){R=0,O=0;do rt=ft+(R<<3)|0,o[rt>>2]=0,o[rt+4>>2]=0,R=d(R|0,O|0,1,0)|0,O=Se()|0,rt=Ln,it=o[rt+4>>2]|0;while((O|0)<(it|0)|((O|0)==(it|0)?R>>>0<(o[rt>>2]|0)>>>0:0))}if(rt=Ln,o[rt>>2]=N,o[rt+4>>2]=W,(W|0)>0|(W|0)==0&N>>>0>0)Ze=C,ct=Bt,At=gn,it=Vt,rt=yt,C=Xe,Bt=v,Vt=Cn,Xe=Ze,v=ct,gn=xn,xn=At,Cn=it,yt=ft,ft=rt;else break t}l(Cn),l(xn),l(xi),v=1;break e}else v=N;while(0);l(xi),l(C),l(v),v=0}while(0);return xi=v,we=Qi,xi|0}function Jt(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0;if(le=we,we=we+176|0,W=le,(g|0)<1)return $s(v,0,0),J=0,we=le,J|0;for(N=m,N=ne(o[N>>2]|0,o[N+4>>2]|0,52)|0,Se()|0,$s(v,(g|0)>6?g:6,N&15),N=0;E=m+(N<<3)|0,E=fr(o[E>>2]|0,o[E+4>>2]|0,W)|0,!(E|0);){if(E=o[W>>2]|0,(E|0)>0){O=0;do R=W+8+(O<<4)|0,O=O+1|0,E=W+8+(((O|0)%(E|0)|0)<<4)|0,C=Vi(v,E,R)|0,C?St(v,C)|0:Ct(v,R,E)|0,E=o[W>>2]|0;while((O|0)<(E|0))}if(N=N+1|0,(N|0)>=(g|0)){E=0,J=13;break}}return(J|0)==13?(we=le,E|0):(Es(v),J=E,we=le,J|0)}function ki(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0;if(R=we,we=we+32|0,E=R,C=R+16|0,m=Jt(m,g,C)|0,m|0)return v=m,we=R,v|0;if(o[v>>2]=0,o[v+4>>2]=0,o[v+8>>2]=0,m=Hs(C)|0,m|0)do{g=Ut(v)|0;do mA(g,m)|0,O=m+16|0,o[E>>2]=o[O>>2],o[E+4>>2]=o[O+4>>2],o[E+8>>2]=o[O+8>>2],o[E+12>>2]=o[O+12>>2],St(C,m)|0,m=Ja(C,E)|0;while(m|0);m=Hs(C)|0}while(m|0);return Es(C),m=yA(v)|0,m?(Ll(v),O=m,we=R,O|0):(O=0,we=R,O|0)}function Vn(m){return m=m|0,m>>>0>121?(m=0,m|0):(m=o[7696+(m*28|0)+16>>2]|0,m|0)}function aA(m){return m=m|0,(m|0)==4|(m|0)==117|0}function lA(m){return m=m|0,o[11120+((o[m>>2]|0)*216|0)+((o[m+4>>2]|0)*72|0)+((o[m+8>>2]|0)*24|0)+(o[m+12>>2]<<3)>>2]|0}function AA(m){return m=m|0,o[11120+((o[m>>2]|0)*216|0)+((o[m+4>>2]|0)*72|0)+((o[m+8>>2]|0)*24|0)+(o[m+12>>2]<<3)+4>>2]|0}function $A(m,g){m=m|0,g=g|0,m=7696+(m*28|0)|0,o[g>>2]=o[m>>2],o[g+4>>2]=o[m+4>>2],o[g+8>>2]=o[m+8>>2],o[g+12>>2]=o[m+12>>2]}function HA(m,g){m=m|0,g=g|0;var v=0,E=0;if(g>>>0>20)return g=-1,g|0;do if((o[11120+(g*216|0)>>2]|0)!=(m|0))if((o[11120+(g*216|0)+8>>2]|0)!=(m|0))if((o[11120+(g*216|0)+16>>2]|0)!=(m|0))if((o[11120+(g*216|0)+24>>2]|0)!=(m|0))if((o[11120+(g*216|0)+32>>2]|0)!=(m|0))if((o[11120+(g*216|0)+40>>2]|0)!=(m|0))if((o[11120+(g*216|0)+48>>2]|0)!=(m|0))if((o[11120+(g*216|0)+56>>2]|0)!=(m|0))if((o[11120+(g*216|0)+64>>2]|0)!=(m|0))if((o[11120+(g*216|0)+72>>2]|0)!=(m|0))if((o[11120+(g*216|0)+80>>2]|0)!=(m|0))if((o[11120+(g*216|0)+88>>2]|0)!=(m|0))if((o[11120+(g*216|0)+96>>2]|0)!=(m|0))if((o[11120+(g*216|0)+104>>2]|0)!=(m|0))if((o[11120+(g*216|0)+112>>2]|0)!=(m|0))if((o[11120+(g*216|0)+120>>2]|0)!=(m|0))if((o[11120+(g*216|0)+128>>2]|0)!=(m|0))if((o[11120+(g*216|0)+136>>2]|0)==(m|0))m=2,v=1,E=2;else{if((o[11120+(g*216|0)+144>>2]|0)==(m|0)){m=0,v=2,E=0;break}if((o[11120+(g*216|0)+152>>2]|0)==(m|0)){m=0,v=2,E=1;break}if((o[11120+(g*216|0)+160>>2]|0)==(m|0)){m=0,v=2,E=2;break}if((o[11120+(g*216|0)+168>>2]|0)==(m|0)){m=1,v=2,E=0;break}if((o[11120+(g*216|0)+176>>2]|0)==(m|0)){m=1,v=2,E=1;break}if((o[11120+(g*216|0)+184>>2]|0)==(m|0)){m=1,v=2,E=2;break}if((o[11120+(g*216|0)+192>>2]|0)==(m|0)){m=2,v=2,E=0;break}if((o[11120+(g*216|0)+200>>2]|0)==(m|0)){m=2,v=2,E=1;break}if((o[11120+(g*216|0)+208>>2]|0)==(m|0)){m=2,v=2,E=2;break}else m=-1;return m|0}else m=2,v=1,E=1;else m=2,v=1,E=0;else m=1,v=1,E=2;else m=1,v=1,E=1;else m=1,v=1,E=0;else m=0,v=1,E=2;else m=0,v=1,E=1;else m=0,v=1,E=0;else m=2,v=0,E=2;else m=2,v=0,E=1;else m=2,v=0,E=0;else m=1,v=0,E=2;else m=1,v=0,E=1;else m=1,v=0,E=0;else m=0,v=0,E=2;else m=0,v=0,E=1;else m=0,v=0,E=0;while(0);return g=o[11120+(g*216|0)+(v*72|0)+(m*24|0)+(E<<3)+4>>2]|0,g|0}function uA(m,g){return m=m|0,g=g|0,(o[7696+(m*28|0)+20>>2]|0)==(g|0)?(g=1,g|0):(g=(o[7696+(m*28|0)+24>>2]|0)==(g|0),g|0)}function yl(m,g){return m=m|0,g=g|0,o[848+(m*28|0)+(g<<2)>>2]|0}function _l(m,g){return m=m|0,g=g|0,(o[848+(m*28|0)>>2]|0)==(g|0)?(g=0,g|0):(o[848+(m*28|0)+4>>2]|0)==(g|0)?(g=1,g|0):(o[848+(m*28|0)+8>>2]|0)==(g|0)?(g=2,g|0):(o[848+(m*28|0)+12>>2]|0)==(g|0)?(g=3,g|0):(o[848+(m*28|0)+16>>2]|0)==(g|0)?(g=4,g|0):(o[848+(m*28|0)+20>>2]|0)==(g|0)?(g=5,g|0):((o[848+(m*28|0)+24>>2]|0)==(g|0)?6:7)|0}function cA(){return 122}function hA(m){m=m|0;var g=0,v=0,E=0;g=0;do ue(g|0,0,45)|0,E=Se()|0|134225919,v=m+(g<<3)|0,o[v>>2]=-1,o[v+4>>2]=E,g=g+1|0;while((g|0)!=122);return 0}function Zn(m){return m=m|0,+G[m+16>>3]<+G[m+24>>3]|0}function WA(m,g){m=m|0,g=g|0;var v=0,E=0,C=0;return v=+G[g>>3],!(v>=+G[m+8>>3])||!(v<=+G[m>>3])?(g=0,g|0):(E=+G[m+16>>3],v=+G[m+24>>3],C=+G[g+8>>3],g=C>=v,m=C<=E&1,E<v?g&&(m=1):g||(m=0),g=(m|0)!=0,g|0)}function Ku(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0;Be=we,we=we+288|0,le=Be+264|0,fe=Be+96|0,J=Be,N=J,W=N+96|0;do o[N>>2]=0,N=N+4|0;while((N|0)<(W|0));return g=Vs(g,J)|0,g|0?(je=g,we=Be,je|0):(W=J,J=o[W>>2]|0,W=o[W+4>>2]|0,_o(J,W,le)|0,fr(J,W,fe)|0,O=+Il(le,fe+8|0),G[le>>3]=+G[m>>3],W=le+8|0,G[W>>3]=+G[m+16>>3],G[fe>>3]=+G[m+8>>3],J=fe+8|0,G[J>>3]=+G[m+24>>3],C=+Il(le,fe),ct=+G[W>>3]-+G[J>>3],R=+ke(+ct),Ze=+G[le>>3]-+G[fe>>3],E=+ke(+Ze),!(ct==0|Ze==0)&&(ct=+be(+R,+E),ct=+Qt(+(C*C/+Ce(+(ct/+Ce(+R,+E)),3)/(O*(O*2.59807621135)*.8))),G[Le>>3]=ct,Re=~~ct>>>0,je=+ke(ct)>=1?ct>0?~~+vn(+Pe(ct/4294967296),4294967295)>>>0:~~+Qt((ct-+(~~ct>>>0))/4294967296)>>>0:0,(o[Le+4>>2]&2146435072|0)!=2146435072)?(fe=(Re|0)==0&(je|0)==0,g=v,o[g>>2]=fe?1:Re,o[g+4>>2]=fe?0:je,g=0):g=1,je=g,we=Be,je|0)}function vl(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0,J=0,le=0;J=we,we=we+288|0,O=J+264|0,N=J+96|0,W=J,C=W,R=C+96|0;do o[C>>2]=0,C=C+4|0;while((C|0)<(R|0));return v=Vs(v,W)|0,v|0?(E=v,we=J,E|0):(v=W,C=o[v>>2]|0,v=o[v+4>>2]|0,_o(C,v,O)|0,fr(C,v,N)|0,le=+Il(O,N+8|0),le=+Qt(+(+Il(m,g)/(le*2))),G[Le>>3]=le,v=~~le>>>0,C=+ke(le)>=1?le>0?~~+vn(+Pe(le/4294967296),4294967295)>>>0:~~+Qt((le-+(~~le>>>0))/4294967296)>>>0:0,(o[Le+4>>2]&2146435072|0)==2146435072?(E=1,we=J,E|0):(W=(v|0)==0&(C|0)==0,o[E>>2]=W?1:v,o[E+4>>2]=W?0:C,E=0,we=J,E|0))}function Hi(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0,o[m>>2]=g,o[m+4>>2]=v,o[m+8>>2]=E}function Uo(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0;fe=g+8|0,o[fe>>2]=0,W=+G[m>>3],O=+ke(+W),J=+G[m+8>>3],N=+ke(+J)/.8660254037844386,O=O+N*.5,v=~~O,m=~~N,O=O-+(v|0),N=N-+(m|0);do if(O<.5)if(O<.3333333333333333)if(o[g>>2]=v,N<(O+1)*.5){o[g+4>>2]=m;break}else{m=m+1|0,o[g+4>>2]=m;break}else if(Re=1-O,m=(!(N<Re)&1)+m|0,o[g+4>>2]=m,Re<=N&N<O*2){v=v+1|0,o[g>>2]=v;break}else{o[g>>2]=v;break}else{if(!(O<.6666666666666666))if(v=v+1|0,o[g>>2]=v,N<O*.5){o[g+4>>2]=m;break}else{m=m+1|0,o[g+4>>2]=m;break}if(N<1-O){if(o[g+4>>2]=m,O*2+-1<N){o[g>>2]=v;break}}else m=m+1|0,o[g+4>>2]=m;v=v+1|0,o[g>>2]=v}while(0);do if(W<0)if(m&1){le=(m+1|0)/2|0,le=x(v|0,((v|0)<0)<<31>>31|0,le|0,((le|0)<0)<<31>>31|0)|0,v=~~(+(v|0)-((+(le>>>0)+4294967296*+(Se()|0))*2+1)),o[g>>2]=v;break}else{le=(m|0)/2|0,le=x(v|0,((v|0)<0)<<31>>31|0,le|0,((le|0)<0)<<31>>31|0)|0,v=~~(+(v|0)-(+(le>>>0)+4294967296*+(Se()|0))*2),o[g>>2]=v;break}while(0);le=g+4|0,J<0&&(v=v-((m<<1|1|0)/2|0)|0,o[g>>2]=v,m=0-m|0,o[le>>2]=m),E=m-v|0,(v|0)<0?(C=0-v|0,o[le>>2]=E,o[fe>>2]=C,o[g>>2]=0,m=E,v=0):C=0,(m|0)<0&&(v=v-m|0,o[g>>2]=v,C=C-m|0,o[fe>>2]=C,o[le>>2]=0,m=0),R=v-C|0,E=m-C|0,(C|0)<0&&(o[g>>2]=R,o[le>>2]=E,o[fe>>2]=0,m=E,v=R,C=0),E=(m|0)<(v|0)?m:v,E=(C|0)<(E|0)?C:E,!((E|0)<=0)&&(o[g>>2]=v-E,o[le>>2]=m-E,o[fe>>2]=C-E)}function Bn(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0;g=o[m>>2]|0,O=m+4|0,v=o[O>>2]|0,(g|0)<0&&(v=v-g|0,o[O>>2]=v,R=m+8|0,o[R>>2]=(o[R>>2]|0)-g,o[m>>2]=0,g=0),(v|0)<0?(g=g-v|0,o[m>>2]=g,R=m+8|0,C=(o[R>>2]|0)-v|0,o[R>>2]=C,o[O>>2]=0,v=0):(C=m+8|0,R=C,C=o[C>>2]|0),(C|0)<0&&(g=g-C|0,o[m>>2]=g,v=v-C|0,o[O>>2]=v,o[R>>2]=0,C=0),E=(v|0)<(g|0)?v:g,E=(C|0)<(E|0)?C:E,!((E|0)<=0)&&(o[m>>2]=g-E,o[O>>2]=v-E,o[R>>2]=C-E)}function ws(m,g){m=m|0,g=g|0;var v=0,E=0;E=o[m+8>>2]|0,v=+((o[m+4>>2]|0)-E|0),G[g>>3]=+((o[m>>2]|0)-E|0)-v*.5,G[g+8>>3]=v*.8660254037844386}function er(m,g,v){m=m|0,g=g|0,v=v|0,o[v>>2]=(o[g>>2]|0)+(o[m>>2]|0),o[v+4>>2]=(o[g+4>>2]|0)+(o[m+4>>2]|0),o[v+8>>2]=(o[g+8>>2]|0)+(o[m+8>>2]|0)}function po(m,g,v){m=m|0,g=g|0,v=v|0,o[v>>2]=(o[m>>2]|0)-(o[g>>2]|0),o[v+4>>2]=(o[m+4>>2]|0)-(o[g+4>>2]|0),o[v+8>>2]=(o[m+8>>2]|0)-(o[g+8>>2]|0)}function xl(m,g){m=m|0,g=g|0;var v=0,E=0;v=on(o[m>>2]|0,g)|0,o[m>>2]=v,v=m+4|0,E=on(o[v>>2]|0,g)|0,o[v>>2]=E,m=m+8|0,g=on(o[m>>2]|0,g)|0,o[m>>2]=g}function Vo(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;O=o[m>>2]|0,N=(O|0)<0,E=(o[m+4>>2]|0)-(N?O:0)|0,R=(E|0)<0,C=(R?0-E|0:0)+((o[m+8>>2]|0)-(N?O:0))|0,v=(C|0)<0,m=v?0:C,g=(R?0:E)-(v?C:0)|0,C=(N?0:O)-(R?E:0)-(v?C:0)|0,v=(g|0)<(C|0)?g:C,v=(m|0)<(v|0)?m:v,E=(v|0)>0,m=m-(E?v:0)|0,g=g-(E?v:0)|0;e:do switch(C-(E?v:0)|0){case 0:switch(g|0){case 0:return N=m|0?(m|0)==1?1:7:0,N|0;case 1:return N=m|0?(m|0)==1?3:7:2,N|0;default:break e}case 1:switch(g|0){case 0:return N=m|0?(m|0)==1?5:7:4,N|0;case 1:{if(!m)m=6;else break e;return m|0}default:break e}}while(0);return N=7,N|0}function ca(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;O=m+8|0,C=o[O>>2]|0,R=(o[m>>2]|0)-C|0,N=m+4|0,C=(o[N>>2]|0)-C|0;do if(R>>>0>715827881|C>>>0>715827881){if(v=(R|0)>0,v){if((2147483647-R|0)<(R|0)||(2147483647-(R<<1)|0)<(R|0))return N=1,N|0}else if((-2147483648-R|0)>(R|0)||(-2147483648-(R<<1)|0)>(R|0))return N=1,N|0;if(g=R*3|0,(C|0)>0){if((2147483647-C|0)<(C|0))return N=1,N|0}else if((-2147483648-C|0)>(C|0))return N=1,N|0;if(E=C<<1,(R|0)>-1){if((g|-2147483648|0)>=(C|0))return N=1,N|0}else if((g^-2147483648|0)<(C|0))return N=1,N|0;if(v){if((2147483647-R|0)<(E|0))g=1;else{v=E;break}return g|0}else{if((-2147483648-R|0)>(E|0))g=1;else{v=E;break}return g|0}}else v=C<<1,g=R*3|0;while(0);E=c(+(g-C|0)/7)|0,o[m>>2]=E,C=c(+(v+R|0)/7)|0,o[N>>2]=C,o[O>>2]=0,v=(C|0)<(E|0),g=v?E:C,v=v?C:E;do if((v|0)<0){if((g|0)>0){if((g|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-g|0)>=(v|0)))break;An(23313,22444,355,22455)}if((v|0)==-2147483648|(-2147483648-g|0)>(v|0)&&An(23313,22444,355,22455),(g|0)>-1){if((g|-2147483648|0)<(v|0))break;An(23313,22444,355,22455)}else{if((g^-2147483648|0)>=(v|0))break;An(23313,22444,355,22455)}}while(0);return g=C-E|0,(E|0)<0?(v=0-E|0,o[N>>2]=g,o[O>>2]=v,o[m>>2]=0,E=0):(g=C,v=0),(g|0)<0&&(E=E-g|0,o[m>>2]=E,v=v-g|0,o[O>>2]=v,o[N>>2]=0,g=0),R=E-v|0,C=g-v|0,(v|0)<0?(o[m>>2]=R,o[N>>2]=C,o[O>>2]=0,g=C,C=R,v=0):C=E,E=(g|0)<(C|0)?g:C,E=(v|0)<(E|0)?v:E,(E|0)<=0?(N=0,N|0):(o[m>>2]=C-E,o[N>>2]=g-E,o[O>>2]=v-E,N=0,N|0)}function go(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;O=m+8|0,C=o[O>>2]|0,R=(o[m>>2]|0)-C|0,N=m+4|0,C=(o[N>>2]|0)-C|0;do if(R>>>0>715827881|C>>>0>715827881){if(v=(R|0)>0,v){if((2147483647-R|0)<(R|0))return N=1,N|0}else if((-2147483648-R|0)>(R|0))return N=1,N|0;if(g=R<<1,(C|0)>0){if((2147483647-C|0)<(C|0)||(2147483647-(C<<1)|0)<(C|0))return N=1,N|0}else if((-2147483648-C|0)>(C|0)||(-2147483648-(C<<1)|0)>(C|0))return N=1,N|0;if(E=C*3|0,v){if((2147483647-g|0)<(C|0))return N=1,N|0}else if((-2147483648-g|0)>(C|0))return N=1,N|0;if((C|0)>-1){if((E|-2147483648|0)<(R|0)){v=E;break}else g=1;return g|0}else{if((E^-2147483648|0)<(R|0))g=1;else{v=E;break}return g|0}}else v=C*3|0,g=R<<1;while(0);E=c(+(g+C|0)/7)|0,o[m>>2]=E,C=c(+(v-R|0)/7)|0,o[N>>2]=C,o[O>>2]=0,v=(C|0)<(E|0),g=v?E:C,v=v?C:E;do if((v|0)<0){if((g|0)>0){if((g|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-g|0)>=(v|0)))break;An(23313,22444,404,22469)}if((v|0)==-2147483648|(-2147483648-g|0)>(v|0)&&An(23313,22444,404,22469),(g|0)>-1){if((g|-2147483648|0)<(v|0))break;An(23313,22444,404,22469)}else{if((g^-2147483648|0)>=(v|0))break;An(23313,22444,404,22469)}}while(0);return g=C-E|0,(E|0)<0?(v=0-E|0,o[N>>2]=g,o[O>>2]=v,o[m>>2]=0,E=0):(g=C,v=0),(g|0)<0&&(E=E-g|0,o[m>>2]=E,v=v-g|0,o[O>>2]=v,o[N>>2]=0,g=0),R=E-v|0,C=g-v|0,(v|0)<0?(o[m>>2]=R,o[N>>2]=C,o[O>>2]=0,g=C,C=R,v=0):C=E,E=(g|0)<(C|0)?g:C,E=(v|0)<(E|0)?v:E,(E|0)<=0?(N=0,N|0):(o[m>>2]=C-E,o[N>>2]=g-E,o[O>>2]=v-E,N=0,N|0)}function fA(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;O=m+8|0,v=o[O>>2]|0,g=(o[m>>2]|0)-v|0,N=m+4|0,v=(o[N>>2]|0)-v|0,E=c(+((g*3|0)-v|0)/7)|0,o[m>>2]=E,g=c(+((v<<1)+g|0)/7)|0,o[N>>2]=g,o[O>>2]=0,v=g-E|0,(E|0)<0?(R=0-E|0,o[N>>2]=v,o[O>>2]=R,o[m>>2]=0,g=v,E=0,v=R):v=0,(g|0)<0&&(E=E-g|0,o[m>>2]=E,v=v-g|0,o[O>>2]=v,o[N>>2]=0,g=0),R=E-v|0,C=g-v|0,(v|0)<0?(o[m>>2]=R,o[N>>2]=C,o[O>>2]=0,g=C,C=R,v=0):C=E,E=(g|0)<(C|0)?g:C,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(o[m>>2]=C-E,o[N>>2]=g-E,o[O>>2]=v-E)}function Ga(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;O=m+8|0,v=o[O>>2]|0,g=(o[m>>2]|0)-v|0,N=m+4|0,v=(o[N>>2]|0)-v|0,E=c(+((g<<1)+v|0)/7)|0,o[m>>2]=E,g=c(+((v*3|0)-g|0)/7)|0,o[N>>2]=g,o[O>>2]=0,v=g-E|0,(E|0)<0?(R=0-E|0,o[N>>2]=v,o[O>>2]=R,o[m>>2]=0,g=v,E=0,v=R):v=0,(g|0)<0&&(E=E-g|0,o[m>>2]=E,v=v-g|0,o[O>>2]=v,o[N>>2]=0,g=0),R=E-v|0,C=g-v|0,(v|0)<0?(o[m>>2]=R,o[N>>2]=C,o[O>>2]=0,g=C,C=R,v=0):C=E,E=(g|0)<(C|0)?g:C,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(o[m>>2]=C-E,o[N>>2]=g-E,o[O>>2]=v-E)}function Go(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;g=o[m>>2]|0,O=m+4|0,v=o[O>>2]|0,N=m+8|0,E=o[N>>2]|0,C=v+(g*3|0)|0,o[m>>2]=C,v=E+(v*3|0)|0,o[O>>2]=v,g=(E*3|0)+g|0,o[N>>2]=g,E=v-C|0,(C|0)<0?(g=g-C|0,o[O>>2]=E,o[N>>2]=g,o[m>>2]=0,v=E,E=0):E=C,(v|0)<0&&(E=E-v|0,o[m>>2]=E,g=g-v|0,o[N>>2]=g,o[O>>2]=0,v=0),R=E-g|0,C=v-g|0,(g|0)<0?(o[m>>2]=R,o[O>>2]=C,o[N>>2]=0,E=R,g=0):C=v,v=(C|0)<(E|0)?C:E,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=E-v,o[O>>2]=C-v,o[N>>2]=g-v)}function Gr(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;C=o[m>>2]|0,O=m+4|0,g=o[O>>2]|0,N=m+8|0,v=o[N>>2]|0,E=(g*3|0)+C|0,C=v+(C*3|0)|0,o[m>>2]=C,o[O>>2]=E,g=(v*3|0)+g|0,o[N>>2]=g,v=E-C|0,(C|0)<0?(g=g-C|0,o[O>>2]=v,o[N>>2]=g,o[m>>2]=0,C=0):v=E,(v|0)<0&&(C=C-v|0,o[m>>2]=C,g=g-v|0,o[N>>2]=g,o[O>>2]=0,v=0),R=C-g|0,E=v-g|0,(g|0)<0?(o[m>>2]=R,o[O>>2]=E,o[N>>2]=0,C=R,g=0):E=v,v=(E|0)<(C|0)?E:C,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=C-v,o[O>>2]=E-v,o[N>>2]=g-v)}function jr(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0;(g+-1|0)>>>0>=6||(C=(o[15440+(g*12|0)>>2]|0)+(o[m>>2]|0)|0,o[m>>2]=C,N=m+4|0,E=(o[15440+(g*12|0)+4>>2]|0)+(o[N>>2]|0)|0,o[N>>2]=E,O=m+8|0,g=(o[15440+(g*12|0)+8>>2]|0)+(o[O>>2]|0)|0,o[O>>2]=g,v=E-C|0,(C|0)<0?(g=g-C|0,o[N>>2]=v,o[O>>2]=g,o[m>>2]=0,E=0):(v=E,E=C),(v|0)<0&&(E=E-v|0,o[m>>2]=E,g=g-v|0,o[O>>2]=g,o[N>>2]=0,v=0),R=E-g|0,C=v-g|0,(g|0)<0?(o[m>>2]=R,o[N>>2]=C,o[O>>2]=0,E=R,g=0):C=v,v=(C|0)<(E|0)?C:E,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=E-v,o[N>>2]=C-v,o[O>>2]=g-v))}function QA(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;C=o[m>>2]|0,O=m+4|0,g=o[O>>2]|0,N=m+8|0,v=o[N>>2]|0,E=g+C|0,C=v+C|0,o[m>>2]=C,o[O>>2]=E,g=v+g|0,o[N>>2]=g,v=E-C|0,(C|0)<0?(g=g-C|0,o[O>>2]=v,o[N>>2]=g,o[m>>2]=0,E=0):(v=E,E=C),(v|0)<0&&(E=E-v|0,o[m>>2]=E,g=g-v|0,o[N>>2]=g,o[O>>2]=0,v=0),R=E-g|0,C=v-g|0,(g|0)<0?(o[m>>2]=R,o[O>>2]=C,o[N>>2]=0,E=R,g=0):C=v,v=(C|0)<(E|0)?C:E,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=E-v,o[O>>2]=C-v,o[N>>2]=g-v)}function wl(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;g=o[m>>2]|0,O=m+4|0,E=o[O>>2]|0,N=m+8|0,v=o[N>>2]|0,C=E+g|0,o[m>>2]=C,E=v+E|0,o[O>>2]=E,g=v+g|0,o[N>>2]=g,v=E-C|0,(C|0)<0?(g=g-C|0,o[O>>2]=v,o[N>>2]=g,o[m>>2]=0,E=0):(v=E,E=C),(v|0)<0&&(E=E-v|0,o[m>>2]=E,g=g-v|0,o[N>>2]=g,o[O>>2]=0,v=0),R=E-g|0,C=v-g|0,(g|0)<0?(o[m>>2]=R,o[O>>2]=C,o[N>>2]=0,E=R,g=0):C=v,v=(C|0)<(E|0)?C:E,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=E-v,o[O>>2]=C-v,o[N>>2]=g-v)}function mo(m){switch(m=m|0,m|0){case 1:{m=5;break}case 5:{m=4;break}case 4:{m=6;break}case 6:{m=2;break}case 2:{m=3;break}case 3:{m=1;break}}return m|0}function jo(m){switch(m=m|0,m|0){case 1:{m=3;break}case 3:{m=2;break}case 2:{m=6;break}case 6:{m=4;break}case 4:{m=5;break}case 5:{m=1;break}}return m|0}function Ju(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;g=o[m>>2]|0,O=m+4|0,v=o[O>>2]|0,N=m+8|0,E=o[N>>2]|0,C=v+(g<<1)|0,o[m>>2]=C,v=E+(v<<1)|0,o[O>>2]=v,g=(E<<1)+g|0,o[N>>2]=g,E=v-C|0,(C|0)<0?(g=g-C|0,o[O>>2]=E,o[N>>2]=g,o[m>>2]=0,v=E,E=0):E=C,(v|0)<0&&(E=E-v|0,o[m>>2]=E,g=g-v|0,o[N>>2]=g,o[O>>2]=0,v=0),R=E-g|0,C=v-g|0,(g|0)<0?(o[m>>2]=R,o[O>>2]=C,o[N>>2]=0,E=R,g=0):C=v,v=(C|0)<(E|0)?C:E,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=E-v,o[O>>2]=C-v,o[N>>2]=g-v)}function qA(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;C=o[m>>2]|0,O=m+4|0,g=o[O>>2]|0,N=m+8|0,v=o[N>>2]|0,E=(g<<1)+C|0,C=v+(C<<1)|0,o[m>>2]=C,o[O>>2]=E,g=(v<<1)+g|0,o[N>>2]=g,v=E-C|0,(C|0)<0?(g=g-C|0,o[O>>2]=v,o[N>>2]=g,o[m>>2]=0,C=0):v=E,(v|0)<0&&(C=C-v|0,o[m>>2]=C,g=g-v|0,o[N>>2]=g,o[O>>2]=0,v=0),R=C-g|0,E=v-g|0,(g|0)<0?(o[m>>2]=R,o[O>>2]=E,o[N>>2]=0,C=R,g=0):E=v,v=(E|0)<(C|0)?E:C,v=(g|0)<(v|0)?g:v,!((v|0)<=0)&&(o[m>>2]=C-v,o[O>>2]=E-v,o[N>>2]=g-v)}function bl(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0;return O=(o[m>>2]|0)-(o[g>>2]|0)|0,N=(O|0)<0,E=(o[m+4>>2]|0)-(o[g+4>>2]|0)-(N?O:0)|0,R=(E|0)<0,C=(N?0-O|0:0)+(o[m+8>>2]|0)-(o[g+8>>2]|0)+(R?0-E|0:0)|0,m=(C|0)<0,g=m?0:C,v=(R?0:E)-(m?C:0)|0,C=(N?0:O)-(R?E:0)-(m?C:0)|0,m=(v|0)<(C|0)?v:C,m=(g|0)<(m|0)?g:m,E=(m|0)>0,g=g-(E?m:0)|0,v=v-(E?m:0)|0,m=C-(E?m:0)|0,m=(m|0)>-1?m:0-m|0,v=(v|0)>-1?v:0-v|0,g=(g|0)>-1?g:0-g|0,g=(v|0)>(g|0)?v:g,((m|0)>(g|0)?m:g)|0}function dA(m,g){m=m|0,g=g|0;var v=0;v=o[m+8>>2]|0,o[g>>2]=(o[m>>2]|0)-v,o[g+4>>2]=(o[m+4>>2]|0)-v}function ZA(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0;E=o[m>>2]|0,o[g>>2]=E,C=o[m+4>>2]|0,O=g+4|0,o[O>>2]=C,N=g+8|0,o[N>>2]=0,v=(C|0)<(E|0),m=v?E:C,v=v?C:E;do if((v|0)<0){if((m|0)>0){if((m|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-m|0)>=(v|0)))break;return m=1,m|0}if((v|0)==-2147483648|(-2147483648-m|0)>(v|0))return g=1,g|0;if((m|0)>-1){if((m|-2147483648|0)<(v|0))break;return m=1,m|0}else{if((m^-2147483648|0)<(v|0))m=1;else break;return m|0}}while(0);return m=C-E|0,(E|0)<0?(v=0-E|0,o[O>>2]=m,o[N>>2]=v,o[g>>2]=0,E=0):(m=C,v=0),(m|0)<0&&(E=E-m|0,o[g>>2]=E,v=v-m|0,o[N>>2]=v,o[O>>2]=0,m=0),R=E-v|0,C=m-v|0,(v|0)<0?(o[g>>2]=R,o[O>>2]=C,o[N>>2]=0,m=C,C=R,v=0):C=E,E=(m|0)<(C|0)?m:C,E=(v|0)<(E|0)?v:E,(E|0)<=0?(g=0,g|0):(o[g>>2]=C-E,o[O>>2]=m-E,o[N>>2]=v-E,g=0,g|0)}function $o(m){m=m|0;var g=0,v=0,E=0,C=0;g=m+8|0,C=o[g>>2]|0,v=C-(o[m>>2]|0)|0,o[m>>2]=v,E=m+4|0,m=(o[E>>2]|0)-C|0,o[E>>2]=m,o[g>>2]=0-(m+v)}function ja(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;v=o[m>>2]|0,g=0-v|0,o[m>>2]=g,O=m+8|0,o[O>>2]=0,N=m+4|0,E=o[N>>2]|0,C=E+v|0,(v|0)>0?(o[N>>2]=C,o[O>>2]=v,o[m>>2]=0,g=0,E=C):v=0,(E|0)<0?(R=g-E|0,o[m>>2]=R,v=v-E|0,o[O>>2]=v,o[N>>2]=0,C=R-v|0,g=0-v|0,(v|0)<0?(o[m>>2]=C,o[N>>2]=g,o[O>>2]=0,E=g,v=0):(E=0,C=R)):C=g,g=(E|0)<(C|0)?E:C,g=(v|0)<(g|0)?v:g,!((g|0)<=0)&&(o[m>>2]=C-g,o[N>>2]=E-g,o[O>>2]=v-g)}function YA(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0,J=0,le=0,fe=0;if(fe=we,we=we+64|0,le=fe,N=fe+56|0,!(!0&(g&2013265920|0)==134217728&(!0&(E&2013265920|0)==134217728)))return C=5,we=fe,C|0;if((m|0)==(v|0)&(g|0)==(E|0))return o[C>>2]=0,C=0,we=fe,C|0;if(O=ne(m|0,g|0,52)|0,Se()|0,O=O&15,J=ne(v|0,E|0,52)|0,Se()|0,(O|0)!=(J&15|0))return C=12,we=fe,C|0;if(R=O+-1|0,O>>>0>1){Sl(m,g,R,le)|0,Sl(v,E,R,N)|0,J=le,W=o[J>>2]|0,J=o[J+4>>2]|0;e:do if((W|0)==(o[N>>2]|0)&&(J|0)==(o[N+4>>2]|0)){O=(O^15)*3|0,R=ne(m|0,g|0,O|0)|0,Se()|0,R=R&7,O=ne(v|0,E|0,O|0)|0,Se()|0,O=O&7;do if((R|0)==0|(O|0)==0)o[C>>2]=1,R=0;else if((R|0)==7)R=5;else{if((R|0)==1|(O|0)==1&&pi(W,J)|0){R=5;break}if((o[15536+(R<<2)>>2]|0)!=(O|0)&&(o[15568+(R<<2)>>2]|0)!=(O|0))break e;o[C>>2]=1,R=0}while(0);return C=R,we=fe,C|0}while(0)}R=le,O=R+56|0;do o[R>>2]=0,R=R+4|0;while((R|0)<(O|0));return ua(m,g,1,le)|0,g=le,!((o[g>>2]|0)==(v|0)&&(o[g+4>>2]|0)==(E|0))&&(g=le+8|0,!((o[g>>2]|0)==(v|0)&&(o[g+4>>2]|0)==(E|0)))&&(g=le+16|0,!((o[g>>2]|0)==(v|0)&&(o[g+4>>2]|0)==(E|0)))&&(g=le+24|0,!((o[g>>2]|0)==(v|0)&&(o[g+4>>2]|0)==(E|0)))&&(g=le+32|0,!((o[g>>2]|0)==(v|0)&&(o[g+4>>2]|0)==(E|0)))&&(g=le+40|0,!((o[g>>2]|0)==(v|0)&&(o[g+4>>2]|0)==(E|0)))?(R=le+48|0,R=((o[R>>2]|0)==(v|0)?(o[R+4>>2]|0)==(E|0):0)&1):R=1,o[C>>2]=R,C=0,we=fe,C|0}function XA(m,g,v,E,C){return m=m|0,g=g|0,v=v|0,E=E|0,C=C|0,v=ot(m,g,v,E)|0,(v|0)==7?(C=11,C|0):(E=ue(v|0,0,56)|0,g=g&-2130706433|(Se()|0)|268435456,o[C>>2]=m|E,o[C+4>>2]=g,C=0,C|0)}function yo(m,g,v){return m=m|0,g=g|0,v=v|0,!0&(g&2013265920|0)==268435456?(o[v>>2]=m,o[v+4>>2]=g&-2130706433|134217728,v=0,v|0):(v=6,v|0)}function ha(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;return C=we,we=we+16|0,E=C,o[E>>2]=0,!0&(g&2013265920|0)==268435456?(R=ne(m|0,g|0,56)|0,Se()|0,E=Fe(m,g&-2130706433|134217728,R&7,E,v)|0,we=C,E|0):(E=6,we=C,E|0)}function KA(m,g){m=m|0,g=g|0;var v=0;switch(v=ne(m|0,g|0,56)|0,Se()|0,v&7){case 0:case 7:return v=0,v|0}return v=g&-2130706433|134217728,!(!0&(g&2013265920|0)==268435456)||!0&(g&117440512|0)==16777216&(pi(m,v)|0)!=0?(v=0,v|0):(v=da(m,v)|0,v|0)}function fa(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0;return C=we,we=we+16|0,E=C,!0&(g&2013265920|0)==268435456?(R=g&-2130706433|134217728,O=v,o[O>>2]=m,o[O+4>>2]=R,o[E>>2]=0,g=ne(m|0,g|0,56)|0,Se()|0,E=Fe(m,R,g&7,E,v+8|0)|0,we=C,E|0):(E=6,we=C,E|0)}function hi(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0;return C=(pi(m,g)|0)==0,g=g&-2130706433,E=v,o[E>>2]=C?m:0,o[E+4>>2]=C?g|285212672:0,E=v+8|0,o[E>>2]=m,o[E+4>>2]=g|301989888,E=v+16|0,o[E>>2]=m,o[E+4>>2]=g|318767104,E=v+24|0,o[E>>2]=m,o[E+4>>2]=g|335544320,E=v+32|0,o[E>>2]=m,o[E+4>>2]=g|352321536,v=v+40|0,o[v>>2]=m,o[v+4>>2]=g|369098752,0}function Fs(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0;return O=we,we=we+16|0,C=O,R=g&-2130706433|134217728,!0&(g&2013265920|0)==268435456?(E=ne(m|0,g|0,56)|0,Se()|0,E=Zt(m,R,E&7)|0,(E|0)==-1?(o[v>>2]=0,R=6,we=O,R|0):(Qr(m,R,C)|0&&An(23313,22484,282,22499),g=ne(m|0,g|0,52)|0,Se()|0,g=g&15,pi(m,R)|0?Ho(C,g,E,2,v):JA(C,g,E,2,v),R=0,we=O,R|0)):(R=6,we=O,R|0)}function Gn(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0;E=we,we=we+16|0,C=E,Wn(m,g,v,C),Uo(C,v+4|0),we=E}function Wn(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0;if(N=we,we=we+16|0,W=N,vi(m,v,W),R=+Dt(+(1-+G[W>>3]*.5)),R<1e-16){o[E>>2]=0,o[E+4>>2]=0,o[E+8>>2]=0,o[E+12>>2]=0,we=N;return}if(W=o[v>>2]|0,C=+G[15920+(W*24|0)>>3],C=+nr(C-+nr(+sc(15600+(W<<4)|0,m))),wr(g)|0?O=+nr(C+-.3334731722518321):O=C,C=+Lt(+R)/.381966011250105,(g|0)>0){m=0;do C=C*2.6457513110645907,m=m+1|0;while((m|0)!=(g|0))}R=+$e(+O)*C,G[E>>3]=R,O=+ht(+O)*C,G[E+8>>3]=O,we=N}function vi(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;if(R=we,we=we+32|0,C=R,Bl(m,C),o[g>>2]=0,G[v>>3]=5,E=+gi(16400,C),E<+G[v>>3]&&(o[g>>2]=0,G[v>>3]=E),E=+gi(16424,C),E<+G[v>>3]&&(o[g>>2]=1,G[v>>3]=E),E=+gi(16448,C),E<+G[v>>3]&&(o[g>>2]=2,G[v>>3]=E),E=+gi(16472,C),E<+G[v>>3]&&(o[g>>2]=3,G[v>>3]=E),E=+gi(16496,C),E<+G[v>>3]&&(o[g>>2]=4,G[v>>3]=E),E=+gi(16520,C),E<+G[v>>3]&&(o[g>>2]=5,G[v>>3]=E),E=+gi(16544,C),E<+G[v>>3]&&(o[g>>2]=6,G[v>>3]=E),E=+gi(16568,C),E<+G[v>>3]&&(o[g>>2]=7,G[v>>3]=E),E=+gi(16592,C),E<+G[v>>3]&&(o[g>>2]=8,G[v>>3]=E),E=+gi(16616,C),E<+G[v>>3]&&(o[g>>2]=9,G[v>>3]=E),E=+gi(16640,C),E<+G[v>>3]&&(o[g>>2]=10,G[v>>3]=E),E=+gi(16664,C),E<+G[v>>3]&&(o[g>>2]=11,G[v>>3]=E),E=+gi(16688,C),E<+G[v>>3]&&(o[g>>2]=12,G[v>>3]=E),E=+gi(16712,C),E<+G[v>>3]&&(o[g>>2]=13,G[v>>3]=E),E=+gi(16736,C),E<+G[v>>3]&&(o[g>>2]=14,G[v>>3]=E),E=+gi(16760,C),E<+G[v>>3]&&(o[g>>2]=15,G[v>>3]=E),E=+gi(16784,C),E<+G[v>>3]&&(o[g>>2]=16,G[v>>3]=E),E=+gi(16808,C),E<+G[v>>3]&&(o[g>>2]=17,G[v>>3]=E),E=+gi(16832,C),E<+G[v>>3]&&(o[g>>2]=18,G[v>>3]=E),E=+gi(16856,C),!(E<+G[v>>3])){we=R;return}o[g>>2]=19,G[v>>3]=E,we=R}function di(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0;if(R=+lc(m),R<1e-16){g=15600+(g<<4)|0,o[C>>2]=o[g>>2],o[C+4>>2]=o[g+4>>2],o[C+8>>2]=o[g+8>>2],o[C+12>>2]=o[g+12>>2];return}if(O=+dn(+ +G[m+8>>3],+ +G[m>>3]),(v|0)>0){m=0;do R=R/2.6457513110645907,m=m+1|0;while((m|0)!=(v|0))}E?(R=R/3,v=(wr(v)|0)==0,R=+jt(+((v?R:R/2.6457513110645907)*.381966011250105))):(R=+jt(+(R*.381966011250105)),wr(v)|0&&(O=+nr(O+.3334731722518321))),vo(15600+(g<<4)|0,+nr(+G[15920+(g*24|0)>>3]-O),R,C)}function El(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0;E=we,we=we+16|0,C=E,ws(m+4|0,C),di(C,o[m>>2]|0,g,0,v),we=E}function Ho(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0,rt=0,Xe=0,Vt=0,Bt=0,ft=0,yt=0,Cn=0,xn=0,gn=0,yn=0,bn=0,Ln=0,ai=0,Pn=0;if(Ln=we,we=we+272|0,R=Ln+256|0,it=Ln+240|0,gn=Ln,yn=Ln+224|0,bn=Ln+208|0,rt=Ln+176|0,Xe=Ln+160|0,Vt=Ln+192|0,Bt=Ln+144|0,ft=Ln+128|0,yt=Ln+112|0,Cn=Ln+96|0,xn=Ln+80|0,o[R>>2]=g,o[it>>2]=o[m>>2],o[it+4>>2]=o[m+4>>2],o[it+8>>2]=o[m+8>>2],o[it+12>>2]=o[m+12>>2],ec(it,R,gn),o[C>>2]=0,it=E+v+((E|0)==5&1)|0,(it|0)<=(v|0)){we=Ln;return}W=o[R>>2]|0,J=yn+4|0,le=rt+4|0,fe=v+5|0,Re=16880+(W<<2)|0,je=16960+(W<<2)|0,Be=ft+8|0,Ze=yt+8|0,ct=Cn+8|0,At=bn+4|0,N=v;e:for(;;){O=gn+(((N|0)%5|0)<<4)|0,o[bn>>2]=o[O>>2],o[bn+4>>2]=o[O+4>>2],o[bn+8>>2]=o[O+8>>2],o[bn+12>>2]=o[O+12>>2];do;while(($a(bn,W,0,1)|0)==2);if((N|0)>(v|0)&(wr(g)|0)!=0){if(o[rt>>2]=o[bn>>2],o[rt+4>>2]=o[bn+4>>2],o[rt+8>>2]=o[bn+8>>2],o[rt+12>>2]=o[bn+12>>2],ws(J,Xe),E=o[rt>>2]|0,R=o[17040+(E*80|0)+(o[yn>>2]<<2)>>2]|0,o[rt>>2]=o[18640+(E*80|0)+(R*20|0)>>2],O=o[18640+(E*80|0)+(R*20|0)+16>>2]|0,(O|0)>0){m=0;do QA(le),m=m+1|0;while((m|0)<(O|0))}switch(O=18640+(E*80|0)+(R*20|0)+4|0,o[Vt>>2]=o[O>>2],o[Vt+4>>2]=o[O+4>>2],o[Vt+8>>2]=o[O+8>>2],xl(Vt,(o[Re>>2]|0)*3|0),er(le,Vt,le),Bn(le),ws(le,Bt),ai=+(o[je>>2]|0),G[ft>>3]=ai*3,G[Be>>3]=0,Pn=ai*-1.5,G[yt>>3]=Pn,G[Ze>>3]=ai*2.598076211353316,G[Cn>>3]=Pn,G[ct>>3]=ai*-2.598076211353316,o[17040+((o[rt>>2]|0)*80|0)+(o[bn>>2]<<2)>>2]|0){case 1:{m=yt,E=ft;break}case 3:{m=Cn,E=yt;break}case 2:{m=ft,E=Cn;break}default:{m=12;break e}}uu(Xe,Bt,E,m,xn),di(xn,o[rt>>2]|0,W,1,C+8+(o[C>>2]<<4)|0),o[C>>2]=(o[C>>2]|0)+1}if((N|0)<(fe|0)&&(ws(At,rt),di(rt,o[bn>>2]|0,W,1,C+8+(o[C>>2]<<4)|0),o[C>>2]=(o[C>>2]|0)+1),o[yn>>2]=o[bn>>2],o[yn+4>>2]=o[bn+4>>2],o[yn+8>>2]=o[bn+8>>2],o[yn+12>>2]=o[bn+12>>2],N=N+1|0,(N|0)>=(it|0)){m=3;break}}if((m|0)==3){we=Ln;return}else(m|0)==12&&An(22522,22569,571,22579)}function ec(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0;W=we,we=we+128|0,E=W+64|0,C=W,R=E,O=20240,N=R+60|0;do o[R>>2]=o[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));R=C,O=20304,N=R+60|0;do o[R>>2]=o[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));N=(wr(o[g>>2]|0)|0)==0,E=N?E:C,C=m+4|0,Ju(C),qA(C),wr(o[g>>2]|0)|0&&(Gr(C),o[g>>2]=(o[g>>2]|0)+1),o[v>>2]=o[m>>2],g=v+4|0,er(C,E,g),Bn(g),o[v+16>>2]=o[m>>2],g=v+20|0,er(C,E+12|0,g),Bn(g),o[v+32>>2]=o[m>>2],g=v+36|0,er(C,E+24|0,g),Bn(g),o[v+48>>2]=o[m>>2],g=v+52|0,er(C,E+36|0,g),Bn(g),o[v+64>>2]=o[m>>2],v=v+68|0,er(C,E+48|0,v),Bn(v),we=W}function $a(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0;if(Be=we,we=we+32|0,Re=Be+12|0,N=Be,je=m+4|0,fe=o[16960+(g<<2)>>2]|0,le=(E|0)!=0,fe=le?fe*3|0:fe,C=o[je>>2]|0,J=m+8|0,O=o[J>>2]|0,le){if(R=m+12|0,E=o[R>>2]|0,C=O+C+E|0,(C|0)==(fe|0))return je=1,we=Be,je|0;W=R}else W=m+12|0,E=o[W>>2]|0,C=O+C+E|0;if((C|0)<=(fe|0))return je=0,we=Be,je|0;do if((E|0)>0){if(E=o[m>>2]|0,(O|0)>0){R=18640+(E*80|0)+60|0,E=m;break}E=18640+(E*80|0)+40|0,v?(Hi(Re,fe,0,0),po(je,Re,N),wl(N),er(N,Re,je),R=E,E=m):(R=E,E=m)}else R=18640+((o[m>>2]|0)*80|0)+20|0,E=m;while(0);if(o[E>>2]=o[R>>2],C=R+16|0,(o[C>>2]|0)>0){E=0;do QA(je),E=E+1|0;while((E|0)<(o[C>>2]|0))}return m=R+4|0,o[Re>>2]=o[m>>2],o[Re+4>>2]=o[m+4>>2],o[Re+8>>2]=o[m+8>>2],g=o[16880+(g<<2)>>2]|0,xl(Re,le?g*3|0:g),er(je,Re,je),Bn(je),le?E=((o[J>>2]|0)+(o[je>>2]|0)+(o[W>>2]|0)|0)==(fe|0)?1:2:E=2,je=E,we=Be,je|0}function tc(m,g){m=m|0,g=g|0;var v=0;do v=$a(m,g,0,1)|0;while((v|0)==2);return v|0}function JA(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0,rt=0,Xe=0,Vt=0,Bt=0,ft=0,yt=0,Cn=0,xn=0,gn=0;if(Cn=we,we=we+240|0,R=Cn+224|0,Vt=Cn+208|0,Bt=Cn,ft=Cn+192|0,yt=Cn+176|0,ct=Cn+160|0,At=Cn+144|0,it=Cn+128|0,rt=Cn+112|0,Xe=Cn+96|0,o[R>>2]=g,o[Vt>>2]=o[m>>2],o[Vt+4>>2]=o[m+4>>2],o[Vt+8>>2]=o[m+8>>2],o[Vt+12>>2]=o[m+12>>2],Ns(Vt,R,Bt),o[C>>2]=0,Ze=E+v+((E|0)==6&1)|0,(Ze|0)<=(v|0)){we=Cn;return}W=o[R>>2]|0,J=v+6|0,le=16960+(W<<2)|0,fe=At+8|0,Re=it+8|0,je=rt+8|0,Be=ft+4|0,O=0,N=v,E=-1;e:for(;;){if(R=(N|0)%6|0,m=Bt+(R<<4)|0,o[ft>>2]=o[m>>2],o[ft+4>>2]=o[m+4>>2],o[ft+8>>2]=o[m+8>>2],o[ft+12>>2]=o[m+12>>2],m=O,O=$a(ft,W,0,1)|0,(N|0)>(v|0)&(wr(g)|0)!=0&&(m|0)!=1&&(o[ft>>2]|0)!=(E|0)){switch(ws(Bt+(((R+5|0)%6|0)<<4)+4|0,yt),ws(Bt+(R<<4)+4|0,ct),xn=+(o[le>>2]|0),G[At>>3]=xn*3,G[fe>>3]=0,gn=xn*-1.5,G[it>>3]=gn,G[Re>>3]=xn*2.598076211353316,G[rt>>3]=gn,G[je>>3]=xn*-2.598076211353316,R=o[Vt>>2]|0,o[17040+(R*80|0)+(((E|0)==(R|0)?o[ft>>2]|0:E)<<2)>>2]|0){case 1:{m=it,E=At;break}case 3:{m=rt,E=it;break}case 2:{m=At,E=rt;break}default:{m=8;break e}}uu(yt,ct,E,m,Xe),!(Ac(yt,Xe)|0)&&!(Ac(ct,Xe)|0)&&(di(Xe,o[Vt>>2]|0,W,1,C+8+(o[C>>2]<<4)|0),o[C>>2]=(o[C>>2]|0)+1)}if((N|0)<(J|0)&&(ws(Be,yt),di(yt,o[ft>>2]|0,W,1,C+8+(o[C>>2]<<4)|0),o[C>>2]=(o[C>>2]|0)+1),N=N+1|0,(N|0)>=(Ze|0)){m=3;break}else E=o[ft>>2]|0}if((m|0)==3){we=Cn;return}else(m|0)==8&&An(22606,22569,736,22651)}function Ns(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0;W=we,we=we+160|0,E=W+80|0,C=W,R=E,O=20368,N=R+72|0;do o[R>>2]=o[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));R=C,O=20448,N=R+72|0;do o[R>>2]=o[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));N=(wr(o[g>>2]|0)|0)==0,E=N?E:C,C=m+4|0,Ju(C),qA(C),wr(o[g>>2]|0)|0&&(Gr(C),o[g>>2]=(o[g>>2]|0)+1),o[v>>2]=o[m>>2],g=v+4|0,er(C,E,g),Bn(g),o[v+16>>2]=o[m>>2],g=v+20|0,er(C,E+12|0,g),Bn(g),o[v+32>>2]=o[m>>2],g=v+36|0,er(C,E+24|0,g),Bn(g),o[v+48>>2]=o[m>>2],g=v+52|0,er(C,E+36|0,g),Bn(g),o[v+64>>2]=o[m>>2],g=v+68|0,er(C,E+48|0,g),Bn(g),o[v+80>>2]=o[m>>2],v=v+84|0,er(C,E+60|0,v),Bn(v),we=W}function Tl(m,g){return m=m|0,g=g|0,g=ne(m|0,g|0,52)|0,Se()|0,g&15|0}function Ha(m,g){return m=m|0,g=g|0,g=ne(m|0,g|0,45)|0,Se()|0,g&127|0}function da(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0;if(!(!0&(g&-16777216|0)==134217728)||(O=ne(m|0,g|0,45)|0,Se()|0,O=O&127,O>>>0>121))return g=0,g|0;v=ne(m|0,g|0,52)|0,Se()|0,v=v&15;do if(v|0){for(C=1,E=0;;){if(R=ne(m|0,g|0,(15-C|0)*3|0)|0,Se()|0,R=R&7,(R|0)!=0&(E^1))if((R|0)==1&(Vn(O)|0)!=0){N=0,E=13;break}else E=1;if((R|0)==7){N=0,E=13;break}if(C>>>0<v>>>0)C=C+1|0;else{E=9;break}}if((E|0)==9){if((v|0)==15)N=1;else break;return N|0}else if((E|0)==13)return N|0}while(0);for(;;){if(N=ne(m|0,g|0,(14-v|0)*3|0)|0,Se()|0,!((N&7|0)==7&!0)){N=0,E=13;break}if(v>>>0<14)v=v+1|0;else{N=1,E=13;break}}return(E|0)==13?N|0:0}function Sl(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0;if(R=ne(m|0,g|0,52)|0,Se()|0,R=R&15,v>>>0>15)return E=4,E|0;if((R|0)<(v|0))return E=12,E|0;if((R|0)==(v|0))return o[E>>2]=m,o[E+4>>2]=g,E=0,E|0;if(C=ue(v|0,0,52)|0,C=C|m,m=Se()|0|g&-15728641,(R|0)>(v|0))do g=ue(7,0,(14-v|0)*3|0)|0,v=v+1|0,C=g|C,m=Se()|0|m;while((v|0)<(R|0));return o[E>>2]=C,o[E+4>>2]=m,E=0,E|0}function Ml(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0;if(R=ne(m|0,g|0,52)|0,Se()|0,R=R&15,!((v|0)<16&(R|0)<=(v|0)))return E=4,E|0;C=v-R|0,v=ne(m|0,g|0,45)|0,Se()|0;e:do if(!(Vn(v&127)|0))v=js(7,0,C,((C|0)<0)<<31>>31)|0,C=Se()|0;else{t:do if(R|0){for(v=1;O=ue(7,0,(15-v|0)*3|0)|0,!!((O&m|0)==0&((Se()|0)&g|0)==0);)if(v>>>0<R>>>0)v=v+1|0;else break t;v=js(7,0,C,((C|0)<0)<<31>>31)|0,C=Se()|0;break e}while(0);v=js(7,0,C,((C|0)<0)<<31>>31)|0,v=V(v|0,Se()|0,5,0)|0,v=d(v|0,Se()|0,-5,-1)|0,v=M(v|0,Se()|0,6,0)|0,v=d(v|0,Se()|0,1,0)|0,C=Se()|0}while(0);return O=E,o[O>>2]=v,o[O+4>>2]=C,O=0,O|0}function pi(m,g){m=m|0,g=g|0;var v=0,E=0,C=0;if(C=ne(m|0,g|0,45)|0,Se()|0,!(Vn(C&127)|0))return C=0,C|0;C=ne(m|0,g|0,52)|0,Se()|0,C=C&15;e:do if(!C)v=0;else for(E=1;;){if(v=ne(m|0,g|0,(15-E|0)*3|0)|0,Se()|0,v=v&7,v|0)break e;if(E>>>0<C>>>0)E=E+1|0;else{v=0;break}}while(0);return C=(v|0)==0&1,C|0}function pA(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0;if(O=we,we=we+16|0,R=O,ga(R,m,g,v),g=R,m=o[g>>2]|0,g=o[g+4>>2]|0,(m|0)==0&(g|0)==0)return we=O,0;C=0,v=0;do N=E+(C<<3)|0,o[N>>2]=m,o[N+4>>2]=g,C=d(C|0,v|0,1,0)|0,v=Se()|0,qa(R),N=R,m=o[N>>2]|0,g=o[N+4>>2]|0;while(!((m|0)==0&(g|0)==0));return we=O,0}function os(m,g,v,E){return m=m|0,g=g|0,v=v|0,E=E|0,(E|0)<(v|0)?(v=g,E=m,Mt(v|0),E|0):(v=ue(-1,-1,((E-v|0)*3|0)+3|0)|0,E=ue(~v|0,~(Se()|0)|0,(15-E|0)*3|0)|0,v=~(Se()|0)&g,E=~E&m,Mt(v|0),E|0)}function eu(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0;return C=ne(m|0,g|0,52)|0,Se()|0,C=C&15,(v|0)<16&(C|0)<=(v|0)?((C|0)<(v|0)&&(C=ue(-1,-1,((v+-1-C|0)*3|0)+3|0)|0,C=ue(~C|0,~(Se()|0)|0,(15-v|0)*3|0)|0,g=~(Se()|0)&g,m=~C&m),C=ue(v|0,0,52)|0,v=g&-15728641|(Se()|0),o[E>>2]=m|C,o[E+4>>2]=v,E=0,E|0):(E=4,E|0)}function Cl(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0,rt=0,Xe=0,Vt=0,Bt=0,ft=0,yt=0;if((v|0)==0&(E|0)==0)return ft=0,ft|0;if(C=m,R=o[C>>2]|0,C=o[C+4>>2]|0,!0&(C&15728640|0)==0){if(!((E|0)>0|(E|0)==0&v>>>0>0)||(ft=g,o[ft>>2]=R,o[ft+4>>2]=C,(v|0)==1&(E|0)==0))return ft=0,ft|0;C=1;do Vt=m+(C<<3)|0,Bt=o[Vt+4>>2]|0,ft=g+(C<<3)|0,o[ft>>2]=o[Vt>>2],o[ft+4>>2]=Bt,C=C+1|0;while(0<(E|0)|(E|0)==0&C>>>0<v>>>0);return C=0,C|0}if(Xe=v<<3,Bt=_(Xe)|0,!Bt)return ft=13,ft|0;if(Ge(Bt|0,m|0,Xe|0)|0,Vt=h(v,8)|0,!Vt)return l(Bt),ft=13,ft|0;e:do if(v|0){t:for(;;){C=Bt,At=o[C>>2]|0,C=o[C+4>>2]|0,it=ne(At|0,C|0,52)|0,Se()|0,it=it&15,rt=it+-1|0,ct=(v|0)>0;n:do if((it|0)!=0&ct){if(je=((v|0)<0)<<31>>31,Be=ue(rt|0,0,52)|0,Ze=Se()|0,rt>>>0>15){if(!((At|0)==0&(C|0)==0)){ft=17;break t}for(R=0;;){if(R=R+1|0,(R|0)>=(v|0))break n;if(E=Bt+(R<<3)|0,Ze=o[E>>2]|0,E=o[E+4>>2]|0,!((Ze|0)==0&(E|0)==0)){C=E,ft=17;break t}}}for(R=0,m=At,E=C;;){if(!((m|0)==0&(E|0)==0)){if(!(!0&(E&117440512|0)==0)){ft=22;break t}if(N=ne(m|0,E|0,52)|0,Se()|0,N=N&15,(N|0)<(rt|0)){C=12,ft=28;break t}if((N|0)!=(rt|0)&&(m=m|Be,E=E&-15728641|Ze,N>>>0>=it>>>0)){O=rt;do Re=ue(7,0,(14-O|0)*3|0)|0,O=O+1|0,m=Re|m,E=Se()|0|E;while(O>>>0<N>>>0)}if(O=X(m|0,E|0,v|0,je|0)|0,Se()|0,J=Vt+(O<<3)|0,N=J,W=o[N>>2]|0,N=o[N+4>>2]|0,(W|0)==0&(N|0)==0)O=J;else for(Re=0;;){if((Re|0)>(v|0)){ft=32;break t}if((W|0)==(m|0)&(N&-117440513|0)==(E|0)){le=ne(W|0,N|0,56)|0,Se()|0,le=le&7,fe=le+1|0,yt=ne(W|0,N|0,45)|0,Se()|0;i:do if(!(Vn(yt&127)|0))N=7;else{if(W=ne(W|0,N|0,52)|0,Se()|0,W=W&15,!W){N=6;break}for(N=1;;){if(yt=ue(7,0,(15-N|0)*3|0)|0,!((yt&m|0)==0&((Se()|0)&E|0)==0)){N=7;break i}if(N>>>0<W>>>0)N=N+1|0;else{N=6;break}}}while(0);if((le+2|0)>>>0>N>>>0){ft=42;break t}yt=ue(fe|0,0,56)|0,E=Se()|0|E&-117440513,fe=J,o[fe>>2]=0,o[fe+4>>2]=0,m=yt|m}else O=(O+1|0)%(v|0)|0;if(J=Vt+(O<<3)|0,N=J,W=o[N>>2]|0,N=o[N+4>>2]|0,(W|0)==0&(N|0)==0){O=J;break}else Re=Re+1|0}yt=O,o[yt>>2]=m,o[yt+4>>2]=E}if(R=R+1|0,(R|0)>=(v|0))break n;E=Bt+(R<<3)|0,m=o[E>>2]|0,E=o[E+4>>2]|0}}while(0);if((v+5|0)>>>0<11){ft=85;break}if(Ze=h((v|0)/6|0,8)|0,!Ze){ft=49;break}n:do if(ct){Re=0,fe=0;do{if(N=Vt+(Re<<3)|0,E=N,R=o[E>>2]|0,E=o[E+4>>2]|0,!((R|0)==0&(E|0)==0)){W=ne(R|0,E|0,56)|0,Se()|0,W=W&7,m=W+1|0,J=E&-117440513,yt=ne(R|0,E|0,45)|0,Se()|0;i:do if(Vn(yt&127)|0){if(le=ne(R|0,E|0,52)|0,Se()|0,le=le&15,le|0)for(O=1;;){if(yt=ue(7,0,(15-O|0)*3|0)|0,!((R&yt|0)==0&(J&(Se()|0)|0)==0))break i;if(O>>>0<le>>>0)O=O+1|0;else break}E=ue(m|0,0,56)|0,R=E|R,E=Se()|0|J,m=N,o[m>>2]=R,o[m+4>>2]=E,m=W+2|0}while(0);(m|0)==7&&(yt=Ze+(fe<<3)|0,o[yt>>2]=R,o[yt+4>>2]=E&-117440513,fe=fe+1|0)}Re=Re+1|0}while((Re|0)!=(v|0));if(ct){if(Re=((v|0)<0)<<31>>31,je=ue(rt|0,0,52)|0,Be=Se()|0,rt>>>0>15){if(!((At|0)==0&(C|0)==0)){C=4,ft=84;break t}for(C=0;;){if(C=C+1|0,(C|0)>=(v|0)){R=0,C=fe;break n}if(yt=Bt+(C<<3)|0,!((o[yt>>2]|0)==0&(o[yt+4>>2]|0)==0)){C=4,ft=84;break t}}}for(le=0,R=0,J=At;;){do if(!((J|0)==0&(C|0)==0)){if(N=ne(J|0,C|0,52)|0,Se()|0,N=N&15,(N|0)<(rt|0)){C=12,ft=84;break t}do if((N|0)==(rt|0))E=J,N=C;else{if(E=J|je,m=C&-15728641|Be,N>>>0<it>>>0){N=m;break}O=rt;do yt=ue(7,0,(14-O|0)*3|0)|0,O=O+1|0,E=yt|E,m=Se()|0|m;while(O>>>0<N>>>0);N=m}while(0);for(O=X(E|0,N|0,v|0,Re|0)|0,Se()|0,m=0;;){if((m|0)>(v|0)){ft=77;break t}if(yt=Vt+(O<<3)|0,W=o[yt+4>>2]|0,(W&-117440513|0)==(N|0)&&(o[yt>>2]|0)==(E|0)){ft=79;break}if(O=(O+1|0)%(v|0)|0,yt=Vt+(O<<3)|0,(o[yt>>2]|0)==(E|0)&&(o[yt+4>>2]|0)==(N|0))break;m=m+1|0}if((ft|0)==79&&(ft=0,!0&(W&117440512|0)==100663296))break;yt=g+(R<<3)|0,o[yt>>2]=J,o[yt+4>>2]=C,R=R+1|0}while(0);if(C=le+1|0,(C|0)>=(v|0)){C=fe;break n}yt=Bt+(C<<3)|0,le=C,J=o[yt>>2]|0,C=o[yt+4>>2]|0}}else R=0,C=fe}else R=0,C=0;while(0);if(Te(Vt|0,0,Xe|0)|0,Ge(Bt|0,Ze|0,C<<3|0)|0,l(Ze),C)g=g+(R<<3)|0,v=C;else break e}if((ft|0)==17)!0&(C&117440512|0)==0?(C=4,ft=28):ft=22;else if((ft|0)==32)An(23313,22674,362,22684);else{if((ft|0)==42)return l(Bt),l(Vt),yt=10,yt|0;if((ft|0)==49)return l(Bt),l(Vt),yt=13,yt|0;if((ft|0)==77)An(23313,22674,462,22684);else{if((ft|0)==84)return l(Ze),l(Bt),l(Vt),yt=C,yt|0;if((ft|0)==85){Ge(g|0,Bt|0,v<<3|0)|0;break}}}if((ft|0)==22)return l(Bt),l(Vt),yt=5,yt|0;if((ft|0)==28)return l(Bt),l(Vt),yt=C,yt|0}while(0);return l(Bt),l(Vt),yt=0,yt|0}function nc(m,g,v,E,C,R,O){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0,R=R|0,O=O|0;var N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0;if(Ze=we,we=we+16|0,Be=Ze,!((v|0)>0|(v|0)==0&g>>>0>0))return Be=0,we=Ze,Be|0;if((O|0)>=16)return Be=12,we=Ze,Be|0;Re=0,je=0,fe=0,N=0;e:for(;;){if(J=m+(Re<<3)|0,W=o[J>>2]|0,J=o[J+4>>2]|0,le=ne(W|0,J|0,52)|0,Se()|0,(le&15|0)>(O|0)){N=12,W=11;break}if(ga(Be,W,J,O),le=Be,J=o[le>>2]|0,le=o[le+4>>2]|0,(J|0)==0&(le|0)==0)W=fe;else{W=fe;do{if(!((N|0)<(R|0)|(N|0)==(R|0)&W>>>0<C>>>0)){W=10;break e}fe=E+(W<<3)|0,o[fe>>2]=J,o[fe+4>>2]=le,W=d(W|0,N|0,1,0)|0,N=Se()|0,qa(Be),fe=Be,J=o[fe>>2]|0,le=o[fe+4>>2]|0}while(!((J|0)==0&(le|0)==0))}if(Re=d(Re|0,je|0,1,0)|0,je=Se()|0,(je|0)<(v|0)|(je|0)==(v|0)&Re>>>0<g>>>0)fe=W;else{N=0,W=11;break}}return(W|0)==10?(Be=14,we=Ze,Be|0):(W|0)==11?(we=Ze,N|0):0}function Wi(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0;Re=we,we=we+16|0,fe=Re;e:do if((v|0)>0|(v|0)==0&g>>>0>0){for(J=0,O=0,R=0,le=0;;){if(W=m+(J<<3)|0,N=o[W>>2]|0,W=o[W+4>>2]|0,!((N|0)==0&(W|0)==0)&&(W=(Ml(N,W,E,fe)|0)==0,N=fe,O=d(o[N>>2]|0,o[N+4>>2]|0,O|0,R|0)|0,R=Se()|0,!W)){R=12;break}if(J=d(J|0,le|0,1,0)|0,le=Se()|0,!((le|0)<(v|0)|(le|0)==(v|0)&J>>>0<g>>>0))break e}return we=Re,R|0}else O=0,R=0;while(0);return o[C>>2]=O,o[C+4>>2]=R,C=0,we=Re,C|0}function Li(m,g){return m=m|0,g=g|0,g=ne(m|0,g|0,52)|0,Se()|0,g&1|0}function tr(m,g){m=m|0,g=g|0;var v=0,E=0,C=0;if(C=ne(m|0,g|0,52)|0,Se()|0,C=C&15,!C)return C=0,C|0;for(E=1;;){if(v=ne(m|0,g|0,(15-E|0)*3|0)|0,Se()|0,v=v&7,v|0){E=5;break}if(E>>>0<C>>>0)E=E+1|0;else{v=0,E=5;break}}return(E|0)==5?v|0:0}function tu(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,W=0;if(W=ne(m|0,g|0,52)|0,Se()|0,W=W&15,!W)return N=g,W=m,Mt(N|0),W|0;for(N=1,v=0;;){R=(15-N|0)*3|0,E=ue(7,0,R|0)|0,C=Se()|0,O=ne(m|0,g|0,R|0)|0,Se()|0,R=ue(mo(O&7)|0,0,R|0)|0,O=Se()|0,m=R|m&~E,g=O|g&~C;e:do if(!v)if((R&E|0)==0&(O&C|0)==0)v=0;else if(E=ne(m|0,g|0,52)|0,Se()|0,E=E&15,!E)v=1;else{v=1;t:for(;;){switch(O=ne(m|0,g|0,(15-v|0)*3|0)|0,Se()|0,O&7){case 1:break t;case 0:break;default:{v=1;break e}}if(v>>>0<E>>>0)v=v+1|0;else{v=1;break e}}for(v=1;;)if(O=(15-v|0)*3|0,C=ne(m|0,g|0,O|0)|0,Se()|0,R=ue(7,0,O|0)|0,g=g&~(Se()|0),O=ue(mo(C&7)|0,0,O|0)|0,m=m&~R|O,g=g|(Se()|0),v>>>0<E>>>0)v=v+1|0;else{v=1;break}}while(0);if(N>>>0<W>>>0)N=N+1|0;else break}return Mt(g|0),m|0}function Us(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0;if(E=ne(m|0,g|0,52)|0,Se()|0,E=E&15,!E)return v=g,E=m,Mt(v|0),E|0;for(v=1;R=(15-v|0)*3|0,O=ne(m|0,g|0,R|0)|0,Se()|0,C=ue(7,0,R|0)|0,g=g&~(Se()|0),R=ue(mo(O&7)|0,0,R|0)|0,m=R|m&~C,g=Se()|0|g,v>>>0<E>>>0;)v=v+1|0;return Mt(g|0),m|0}function ic(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,W=0;if(W=ne(m|0,g|0,52)|0,Se()|0,W=W&15,!W)return N=g,W=m,Mt(N|0),W|0;for(N=1,v=0;;){R=(15-N|0)*3|0,E=ue(7,0,R|0)|0,C=Se()|0,O=ne(m|0,g|0,R|0)|0,Se()|0,R=ue(jo(O&7)|0,0,R|0)|0,O=Se()|0,m=R|m&~E,g=O|g&~C;e:do if(!v)if((R&E|0)==0&(O&C|0)==0)v=0;else if(E=ne(m|0,g|0,52)|0,Se()|0,E=E&15,!E)v=1;else{v=1;t:for(;;){switch(O=ne(m|0,g|0,(15-v|0)*3|0)|0,Se()|0,O&7){case 1:break t;case 0:break;default:{v=1;break e}}if(v>>>0<E>>>0)v=v+1|0;else{v=1;break e}}for(v=1;;)if(C=(15-v|0)*3|0,R=ue(7,0,C|0)|0,O=g&~(Se()|0),g=ne(m|0,g|0,C|0)|0,Se()|0,g=ue(jo(g&7)|0,0,C|0)|0,m=m&~R|g,g=O|(Se()|0),v>>>0<E>>>0)v=v+1|0;else{v=1;break}}while(0);if(N>>>0<W>>>0)N=N+1|0;else break}return Mt(g|0),m|0}function gA(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0;if(E=ne(m|0,g|0,52)|0,Se()|0,E=E&15,!E)return v=g,E=m,Mt(v|0),E|0;for(v=1;O=(15-v|0)*3|0,R=ue(7,0,O|0)|0,C=g&~(Se()|0),g=ne(m|0,g|0,O|0)|0,Se()|0,g=ue(jo(g&7)|0,0,O|0)|0,m=g|m&~R,g=Se()|0|C,v>>>0<E>>>0;)v=v+1|0;return Mt(g|0),m|0}function lr(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0;if(W=we,we=we+64|0,N=W+40|0,E=W+24|0,C=W+12|0,R=W,ue(g|0,0,52)|0,v=Se()|0|134225919,!g)return(o[m+4>>2]|0)>2||(o[m+8>>2]|0)>2||(o[m+12>>2]|0)>2?(O=0,N=0,Mt(O|0),we=W,N|0):(ue(lA(m)|0,0,45)|0,O=Se()|0|v,N=-1,Mt(O|0),we=W,N|0);if(o[N>>2]=o[m>>2],o[N+4>>2]=o[m+4>>2],o[N+8>>2]=o[m+8>>2],o[N+12>>2]=o[m+12>>2],O=N+4|0,(g|0)>0)for(m=-1;o[E>>2]=o[O>>2],o[E+4>>2]=o[O+4>>2],o[E+8>>2]=o[O+8>>2],g&1?(fA(O),o[C>>2]=o[O>>2],o[C+4>>2]=o[O+4>>2],o[C+8>>2]=o[O+8>>2],Go(C)):(Ga(O),o[C>>2]=o[O>>2],o[C+4>>2]=o[O+4>>2],o[C+8>>2]=o[O+8>>2],Gr(C)),po(E,C,R),Bn(R),le=(15-g|0)*3|0,J=ue(7,0,le|0)|0,v=v&~(Se()|0),le=ue(Vo(R)|0,0,le|0)|0,m=le|m&~J,v=Se()|0|v,(g|0)>1;)g=g+-1|0;else m=-1;e:do if((o[O>>2]|0)<=2&&(o[N+8>>2]|0)<=2&&(o[N+12>>2]|0)<=2){if(E=lA(N)|0,g=ue(E|0,0,45)|0,g=g|m,m=Se()|0|v&-1040385,R=AA(N)|0,!(Vn(E)|0)){if((R|0)<=0)break;for(C=0;;){if(E=ne(g|0,m|0,52)|0,Se()|0,E=E&15,E)for(v=1;le=(15-v|0)*3|0,N=ne(g|0,m|0,le|0)|0,Se()|0,J=ue(7,0,le|0)|0,m=m&~(Se()|0),le=ue(mo(N&7)|0,0,le|0)|0,g=g&~J|le,m=m|(Se()|0),v>>>0<E>>>0;)v=v+1|0;if(C=C+1|0,(C|0)==(R|0))break e}}C=ne(g|0,m|0,52)|0,Se()|0,C=C&15;t:do if(C){v=1;n:for(;;){switch(le=ne(g|0,m|0,(15-v|0)*3|0)|0,Se()|0,le&7){case 1:break n;case 0:break;default:break t}if(v>>>0<C>>>0)v=v+1|0;else break t}if(uA(E,o[N>>2]|0)|0)for(v=1;N=(15-v|0)*3|0,J=ue(7,0,N|0)|0,le=m&~(Se()|0),m=ne(g|0,m|0,N|0)|0,Se()|0,m=ue(jo(m&7)|0,0,N|0)|0,g=g&~J|m,m=le|(Se()|0),v>>>0<C>>>0;)v=v+1|0;else for(v=1;le=(15-v|0)*3|0,N=ne(g|0,m|0,le|0)|0,Se()|0,J=ue(7,0,le|0)|0,m=m&~(Se()|0),le=ue(mo(N&7)|0,0,le|0)|0,g=g&~J|le,m=m|(Se()|0),v>>>0<C>>>0;)v=v+1|0}while(0);if((R|0)>0){v=0;do g=tu(g,m)|0,m=Se()|0,v=v+1|0;while((v|0)!=(R|0))}}else g=0,m=0;while(0);return J=m,le=g,Mt(J|0),we=W,le|0}function wr(m){return m=m|0,(m|0)%2|0|0}function as(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0;return C=we,we=we+16|0,E=C,g>>>0>15?(E=4,we=C,E|0):(o[m+4>>2]&2146435072|0)==2146435072||(o[m+8+4>>2]&2146435072|0)==2146435072?(E=3,we=C,E|0):(Gn(m,g,E),g=lr(E,g)|0,E=Se()|0,o[v>>2]=g,o[v+4>>2]=E,(g|0)==0&(E|0)==0&&An(23313,22674,786,22697),E=0,we=C,E|0)}function pa(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0;if(C=v+4|0,R=ne(m|0,g|0,52)|0,Se()|0,R=R&15,O=ne(m|0,g|0,45)|0,Se()|0,E=(R|0)==0,Vn(O&127)|0){if(E)return O=1,O|0;E=1}else{if(E)return O=0,O|0;!(o[C>>2]|0)&&!(o[v+8>>2]|0)?E=(o[v+12>>2]|0)!=0&1:E=1}for(v=1;v&1?Go(C):Gr(C),O=ne(m|0,g|0,(15-v|0)*3|0)|0,Se()|0,jr(C,O&7),v>>>0<R>>>0;)v=v+1|0;return E|0}function Qr(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0;if(le=we,we=we+16|0,W=le,J=ne(m|0,g|0,45)|0,Se()|0,J=J&127,J>>>0>121)return o[v>>2]=0,o[v+4>>2]=0,o[v+8>>2]=0,o[v+12>>2]=0,J=5,we=le,J|0;e:do if(Vn(J)|0&&(R=ne(m|0,g|0,52)|0,Se()|0,R=R&15,(R|0)!=0)){E=1;t:for(;;){switch(N=ne(m|0,g|0,(15-E|0)*3|0)|0,Se()|0,N&7){case 5:break t;case 0:break;default:{E=g;break e}}if(E>>>0<R>>>0)E=E+1|0;else{E=g;break e}}for(C=1,E=g;g=(15-C|0)*3|0,O=ue(7,0,g|0)|0,N=E&~(Se()|0),E=ne(m|0,E|0,g|0)|0,Se()|0,E=ue(jo(E&7)|0,0,g|0)|0,m=m&~O|E,E=N|(Se()|0),C>>>0<R>>>0;)C=C+1|0}else E=g;while(0);if(N=7696+(J*28|0)|0,o[v>>2]=o[N>>2],o[v+4>>2]=o[N+4>>2],o[v+8>>2]=o[N+8>>2],o[v+12>>2]=o[N+12>>2],!(pa(m,E,v)|0))return J=0,we=le,J|0;if(O=v+4|0,o[W>>2]=o[O>>2],o[W+4>>2]=o[O+4>>2],o[W+8>>2]=o[O+8>>2],R=ne(m|0,E|0,52)|0,Se()|0,N=R&15,R&1?(Gr(O),R=N+1|0):R=N,!(Vn(J)|0))E=0;else{e:do if(!N)E=0;else for(g=1;;){if(C=ne(m|0,E|0,(15-g|0)*3|0)|0,Se()|0,C=C&7,C|0){E=C;break e}if(g>>>0<N>>>0)g=g+1|0;else{E=0;break}}while(0);E=(E|0)==4&1}if(!($a(v,R,E,0)|0))(R|0)!=(N|0)&&(o[O>>2]=o[W>>2],o[O+4>>2]=o[W+4>>2],o[O+8>>2]=o[W+8>>2]);else{if(Vn(J)|0)do;while($a(v,R,0,0)|0);(R|0)!=(N|0)&&Ga(O)}return J=0,we=le,J|0}function _o(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;return R=we,we=we+16|0,E=R,C=Qr(m,g,E)|0,C|0?(we=R,C|0):(C=ne(m|0,g|0,52)|0,Se()|0,El(E,C&15,v),C=0,we=R,C|0)}function fr(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0;if(O=we,we=we+16|0,R=O,E=Qr(m,g,R)|0,E|0)return R=E,we=O,R|0;E=ne(m|0,g|0,45)|0,Se()|0,E=(Vn(E&127)|0)==0,C=ne(m|0,g|0,52)|0,Se()|0,C=C&15;e:do if(!E){if(C|0)for(E=1;;){if(N=ue(7,0,(15-E|0)*3|0)|0,!((N&m|0)==0&((Se()|0)&g|0)==0))break e;if(E>>>0<C>>>0)E=E+1|0;else break}return Ho(R,C,0,5,v),N=0,we=O,N|0}while(0);return JA(R,C,0,6,v),N=0,we=O,N|0}function Wa(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;if(C=ne(m|0,g|0,45)|0,Se()|0,!(Vn(C&127)|0))return C=2,o[v>>2]=C,0;if(C=ne(m|0,g|0,52)|0,Se()|0,C=C&15,!C)return C=5,o[v>>2]=C,0;for(E=1;;){if(R=ue(7,0,(15-E|0)*3|0)|0,!((R&m|0)==0&((Se()|0)&g|0)==0)){E=2,m=6;break}if(E>>>0<C>>>0)E=E+1|0;else{E=5,m=6;break}}return(m|0)==6&&(o[v>>2]=E),0}function Pl(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0;fe=we,we=we+128|0,J=fe+112|0,R=fe+96|0,le=fe,C=ne(m|0,g|0,52)|0,Se()|0,N=C&15,o[J>>2]=N,O=ne(m|0,g|0,45)|0,Se()|0,O=O&127;e:do if(Vn(O)|0){if(N|0)for(E=1;;){if(W=ue(7,0,(15-E|0)*3|0)|0,!((W&m|0)==0&((Se()|0)&g|0)==0)){C=0;break e}if(E>>>0<N>>>0)E=E+1|0;else break}if(C&1)C=1;else return W=ue(N+1|0,0,52)|0,le=Se()|0|g&-15728641,J=ue(7,0,(14-N|0)*3|0)|0,le=Pl((W|m)&~J,le&~(Se()|0),v)|0,we=fe,le|0}else C=0;while(0);if(E=Qr(m,g,R)|0,!E){C?(ec(R,J,le),W=5):(Ns(R,J,le),W=6);e:do if(Vn(O)|0)if(!N)m=5;else for(E=1;;){if(O=ue(7,0,(15-E|0)*3|0)|0,!((O&m|0)==0&((Se()|0)&g|0)==0)){m=2;break e}if(E>>>0<N>>>0)E=E+1|0;else{m=5;break}}else m=2;while(0);Te(v|0,-1,m<<2|0)|0;e:do if(C)for(R=0;;){if(O=le+(R<<4)|0,tc(O,o[J>>2]|0)|0,O=o[O>>2]|0,N=o[v>>2]|0,(N|0)==-1|(N|0)==(O|0))E=v;else{C=0;do{if(C=C+1|0,C>>>0>=m>>>0){E=1;break e}E=v+(C<<2)|0,N=o[E>>2]|0}while(!((N|0)==-1|(N|0)==(O|0)))}if(o[E>>2]=O,R=R+1|0,R>>>0>=W>>>0){E=0;break}}else for(R=0;;){if(O=le+(R<<4)|0,$a(O,o[J>>2]|0,0,1)|0,O=o[O>>2]|0,N=o[v>>2]|0,(N|0)==-1|(N|0)==(O|0))E=v;else{C=0;do{if(C=C+1|0,C>>>0>=m>>>0){E=1;break e}E=v+(C<<2)|0,N=o[E>>2]|0}while(!((N|0)==-1|(N|0)==(O|0)))}if(o[E>>2]=O,R=R+1|0,R>>>0>=W>>>0){E=0;break}}while(0)}return le=E,we=fe,le|0}function Qa(){return 12}function Vs(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,W=0;if(m>>>0>15)return N=4,N|0;if(ue(m|0,0,52)|0,N=Se()|0|134225919,!m){v=0,E=0;do Vn(E)|0&&(ue(E|0,0,45)|0,O=N|(Se()|0),m=g+(v<<3)|0,o[m>>2]=-1,o[m+4>>2]=O,v=v+1|0),E=E+1|0;while((E|0)!=122);return v=0,v|0}v=0,O=0;do{if(Vn(O)|0){for(ue(O|0,0,45)|0,E=1,C=-1,R=N|(Se()|0);W=ue(7,0,(15-E|0)*3|0)|0,C=C&~W,R=R&~(Se()|0),(E|0)!=(m|0);)E=E+1|0;W=g+(v<<3)|0,o[W>>2]=C,o[W+4>>2]=R,v=v+1|0}O=O+1|0}while((O|0)!=122);return v=0,v|0}function ls(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0;if(it=we,we=we+16|0,ct=it,At=ne(m|0,g|0,52)|0,Se()|0,At=At&15,v>>>0>15)return At=4,we=it,At|0;if((At|0)<(v|0))return At=12,we=it,At|0;if((At|0)!=(v|0))if(R=ue(v|0,0,52)|0,R=R|m,N=Se()|0|g&-15728641,(At|0)>(v|0)){W=v;do Ze=ue(7,0,(14-W|0)*3|0)|0,W=W+1|0,R=Ze|R,N=Se()|0|N;while((W|0)<(At|0));Ze=R}else Ze=R;else Ze=m,N=g;Be=ne(Ze|0,N|0,45)|0,Se()|0;e:do if(Vn(Be&127)|0){if(W=ne(Ze|0,N|0,52)|0,Se()|0,W=W&15,W|0)for(R=1;;){if(Be=ue(7,0,(15-R|0)*3|0)|0,!((Be&Ze|0)==0&((Se()|0)&N|0)==0)){J=33;break e}if(R>>>0<W>>>0)R=R+1|0;else break}if(Be=E,o[Be>>2]=0,o[Be+4>>2]=0,(At|0)>(v|0)){for(Be=g&-15728641,je=At;;){if(Re=je,je=je+-1|0,je>>>0>15|(At|0)<(je|0)){J=19;break}if((At|0)!=(je|0))if(R=ue(je|0,0,52)|0,R=R|m,W=Se()|0|Be,(At|0)<(Re|0))fe=R;else{J=je;do fe=ue(7,0,(14-J|0)*3|0)|0,J=J+1|0,R=fe|R,W=Se()|0|W;while((J|0)<(At|0));fe=R}else fe=m,W=g;if(le=ne(fe|0,W|0,45)|0,Se()|0,!(Vn(le&127)|0))R=0;else{le=ne(fe|0,W|0,52)|0,Se()|0,le=le&15;t:do if(!le)R=0;else for(J=1;;){if(R=ne(fe|0,W|0,(15-J|0)*3|0)|0,Se()|0,R=R&7,R|0)break t;if(J>>>0<le>>>0)J=J+1|0;else{R=0;break}}while(0);R=(R|0)==0&1}if(W=ne(m|0,g|0,(15-Re|0)*3|0)|0,Se()|0,W=W&7,(W|0)==7){C=5,J=42;break}if(R=(R|0)!=0,(W|0)==1&R){C=5,J=42;break}if(fe=W+(((W|0)!=0&R)<<31>>31)|0,fe|0&&(J=At-Re|0,J=js(7,0,J,((J|0)<0)<<31>>31)|0,le=Se()|0,R?(R=V(J|0,le|0,5,0)|0,R=d(R|0,Se()|0,-5,-1)|0,R=M(R|0,Se()|0,6,0)|0,R=d(R|0,Se()|0,1,0)|0,W=Se()|0):(R=J,W=le),Re=fe+-1|0,Re=V(J|0,le|0,Re|0,((Re|0)<0)<<31>>31|0)|0,Re=d(R|0,W|0,Re|0,Se()|0)|0,fe=Se()|0,le=E,le=d(Re|0,fe|0,o[le>>2]|0,o[le+4>>2]|0)|0,fe=Se()|0,Re=E,o[Re>>2]=le,o[Re+4>>2]=fe),(je|0)<=(v|0)){J=37;break}}if((J|0)==19)An(23313,22674,1099,22710);else if((J|0)==37){O=E,C=o[O+4>>2]|0,O=o[O>>2]|0;break}else if((J|0)==42)return we=it,C|0}else C=0,O=0}else J=33;while(0);e:do if((J|0)==33)if(Be=E,o[Be>>2]=0,o[Be+4>>2]=0,(At|0)>(v|0)){for(R=At;;){if(C=ne(m|0,g|0,(15-R|0)*3|0)|0,Se()|0,C=C&7,(C|0)==7){C=5;break}if(O=At-R|0,O=js(7,0,O,((O|0)<0)<<31>>31)|0,C=V(O|0,Se()|0,C|0,0)|0,O=Se()|0,Be=E,O=d(o[Be>>2]|0,o[Be+4>>2]|0,C|0,O|0)|0,C=Se()|0,Be=E,o[Be>>2]=O,o[Be+4>>2]=C,R=R+-1|0,(R|0)<=(v|0))break e}return we=it,C|0}else C=0,O=0;while(0);return Ml(Ze,N,At,ct)|0&&An(23313,22674,1063,22725),At=ct,ct=o[At+4>>2]|0,((C|0)>-1|(C|0)==-1&O>>>0>4294967295)&((ct|0)>(C|0)|((ct|0)==(C|0)?(o[At>>2]|0)>>>0>O>>>0:0))?(At=0,we=it,At|0):(An(23313,22674,1139,22710),0)}function rc(m,g,v,E,C,R){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0,R=R|0;var O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0;if(fe=we,we=we+16|0,O=fe,C>>>0>15)return R=4,we=fe,R|0;if(N=ne(v|0,E|0,52)|0,Se()|0,N=N&15,(N|0)>(C|0))return R=12,we=fe,R|0;if(Ml(v,E,C,O)|0&&An(23313,22674,1063,22725),le=O,J=o[le+4>>2]|0,!(((g|0)>-1|(g|0)==-1&m>>>0>4294967295)&((J|0)>(g|0)|((J|0)==(g|0)?(o[le>>2]|0)>>>0>m>>>0:0))))return R=2,we=fe,R|0;le=C-N|0,C=ue(C|0,0,52)|0,W=Se()|0|E&-15728641,J=R,o[J>>2]=C|v,o[J+4>>2]=W,J=ne(v|0,E|0,45)|0,Se()|0;e:do if(Vn(J&127)|0){if(N|0)for(O=1;;){if(J=ue(7,0,(15-O|0)*3|0)|0,!((J&v|0)==0&((Se()|0)&E|0)==0))break e;if(O>>>0<N>>>0)O=O+1|0;else break}if((le|0)<1)return R=0,we=fe,R|0;for(J=N^15,E=-1,W=1,O=1;;){N=le-W|0,N=js(7,0,N,((N|0)<0)<<31>>31)|0,v=Se()|0;do if(O)if(O=V(N|0,v|0,5,0)|0,O=d(O|0,Se()|0,-5,-1)|0,O=M(O|0,Se()|0,6,0)|0,C=Se()|0,(g|0)>(C|0)|(g|0)==(C|0)&m>>>0>O>>>0){g=d(m|0,g|0,-1,-1)|0,g=x(g|0,Se()|0,O|0,C|0)|0,O=Se()|0,Re=R,Be=o[Re>>2]|0,Re=o[Re+4>>2]|0,Ze=(J+E|0)*3|0,je=ue(7,0,Ze|0)|0,Re=Re&~(Se()|0),E=M(g|0,O|0,N|0,v|0)|0,m=Se()|0,C=d(E|0,m|0,2,0)|0,Ze=ue(C|0,Se()|0,Ze|0)|0,Re=Se()|0|Re,C=R,o[C>>2]=Ze|Be&~je,o[C+4>>2]=Re,m=V(E|0,m|0,N|0,v|0)|0,m=x(g|0,O|0,m|0,Se()|0)|0,O=0,g=Se()|0;break}else{Ze=R,je=o[Ze>>2]|0,Ze=o[Ze+4>>2]|0,Be=ue(7,0,(J+E|0)*3|0)|0,Ze=Ze&~(Se()|0),O=R,o[O>>2]=je&~Be,o[O+4>>2]=Ze,O=1;break}else je=R,C=o[je>>2]|0,je=o[je+4>>2]|0,E=(J+E|0)*3|0,Re=ue(7,0,E|0)|0,je=je&~(Se()|0),Ze=M(m|0,g|0,N|0,v|0)|0,O=Se()|0,E=ue(Ze|0,O|0,E|0)|0,je=Se()|0|je,Be=R,o[Be>>2]=E|C&~Re,o[Be+4>>2]=je,O=V(Ze|0,O|0,N|0,v|0)|0,m=x(m|0,g|0,O|0,Se()|0)|0,O=0,g=Se()|0;while(0);if((le|0)>(W|0))E=~W,W=W+1|0;else{g=0;break}}return we=fe,g|0}while(0);if((le|0)<1)return Ze=0,we=fe,Ze|0;for(C=N^15,O=1;;)if(Be=le-O|0,Be=js(7,0,Be,((Be|0)<0)<<31>>31)|0,Ze=Se()|0,W=R,v=o[W>>2]|0,W=o[W+4>>2]|0,N=(C-O|0)*3|0,E=ue(7,0,N|0)|0,W=W&~(Se()|0),Re=M(m|0,g|0,Be|0,Ze|0)|0,je=Se()|0,N=ue(Re|0,je|0,N|0)|0,W=Se()|0|W,J=R,o[J>>2]=N|v&~E,o[J+4>>2]=W,Ze=V(Re|0,je|0,Be|0,Ze|0)|0,m=x(m|0,g|0,Ze|0,Se()|0)|0,g=Se()|0,(le|0)<=(O|0)){g=0;break}else O=O+1|0;return we=fe,g|0}function ga(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0;C=ne(g|0,v|0,52)|0,Se()|0,C=C&15,(g|0)==0&(v|0)==0|((E|0)>15|(C|0)>(E|0))?(E=-1,C=-1,g=0,v=0):(R=os(g,v,C+1|0,E)|0,v=(Se()|0)&-15728641,g=ue(E|0,0,52)|0,g=R|g,v=v|(Se()|0),R=(pi(g,v)|0)==0,E=R?-1:E),R=m,o[R>>2]=g,o[R+4>>2]=v,o[m+8>>2]=C,o[m+12>>2]=E}function qa(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0,W=0,J=0;if(v=m,g=o[v>>2]|0,v=o[v+4>>2]|0,!((g|0)==0&(v|0)==0)&&(E=ne(g|0,v|0,52)|0,Se()|0,E=E&15,N=ue(1,0,(E^15)*3|0)|0,g=d(N|0,Se()|0,g|0,v|0)|0,v=Se()|0,N=m,o[N>>2]=g,o[N+4>>2]=v,N=m+8|0,O=o[N>>2]|0,!((E|0)<(O|0)))){for(W=m+12|0,R=E;;){if((R|0)==(O|0)){E=5;break}if(J=(R|0)==(o[W>>2]|0),C=(15-R|0)*3|0,E=ne(g|0,v|0,C|0)|0,Se()|0,E=E&7,J&((E|0)==1&!0)){E=7;break}if(!((E|0)==7&!0)){E=10;break}if(J=ue(1,0,C|0)|0,g=d(g|0,v|0,J|0,Se()|0)|0,v=Se()|0,J=m,o[J>>2]=g,o[J+4>>2]=v,(R|0)>(O|0))R=R+-1|0;else{E=10;break}}if((E|0)==5){J=m,o[J>>2]=0,o[J+4>>2]=0,o[N>>2]=-1,o[W>>2]=-1;return}else if((E|0)==7){O=ue(1,0,C|0)|0,O=d(g|0,v|0,O|0,Se()|0)|0,N=Se()|0,J=m,o[J>>2]=O,o[J+4>>2]=N,o[W>>2]=R+-1;return}else if((E|0)==10)return}}function nr(m){m=+m;var g=0;return g=m<0?m+6.283185307179586:m,+(m>=6.283185307179586?g+-6.283185307179586:g)}function bs(m,g){return m=m|0,g=g|0,+ke(+(+G[m>>3]-+G[g>>3]))<17453292519943298e-27?(g=+ke(+(+G[m+8>>3]-+G[g+8>>3]))<17453292519943298e-27,g|0):(g=0,g|0)}function qr(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0;return C=+G[g>>3],E=+G[m>>3],R=+ht(+((C-E)*.5)),v=+ht(+((+G[g+8>>3]-+G[m+8>>3])*.5)),v=R*R+v*(+$e(+C)*+$e(+E)*v),+(+dn(+ +We(+v),+ +We(+(1-v)))*2)}function Il(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0;return C=+G[g>>3],E=+G[m>>3],R=+ht(+((C-E)*.5)),v=+ht(+((+G[g+8>>3]-+G[m+8>>3])*.5)),v=R*R+v*(+$e(+C)*+$e(+E)*v),+(+dn(+ +We(+v),+ +We(+(1-v)))*2*6371.007180918475)}function Wo(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0;return C=+G[g>>3],E=+G[m>>3],R=+ht(+((C-E)*.5)),v=+ht(+((+G[g+8>>3]-+G[m+8>>3])*.5)),v=R*R+v*(+$e(+C)*+$e(+E)*v),+(+dn(+ +We(+v),+ +We(+(1-v)))*2*6371.007180918475*1e3)}function sc(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0;return R=+G[g>>3],E=+$e(+R),C=+G[g+8>>3]-+G[m+8>>3],O=E*+ht(+C),v=+G[m>>3],+ +dn(+O,+(+ht(+R)*+$e(+v)-+$e(+C)*(E*+ht(+v))))}function vo(m,g,v,E){m=m|0,g=+g,v=+v,E=E|0;var C=0,R=0,O=0,N=0;if(v<1e-16){o[E>>2]=o[m>>2],o[E+4>>2]=o[m+4>>2],o[E+8>>2]=o[m+8>>2],o[E+12>>2]=o[m+12>>2];return}R=g<0?g+6.283185307179586:g,R=g>=6.283185307179586?R+-6.283185307179586:R;do if(R<1e-16)g=+G[m>>3]+v,G[E>>3]=g,C=E;else{if(C=+ke(+(R+-3.141592653589793))<1e-16,g=+G[m>>3],C){g=g-v,G[E>>3]=g,C=E;break}if(O=+$e(+v),v=+ht(+v),g=O*+ht(+g)+ +$e(+R)*(v*+$e(+g)),g=g>1?1:g,g=+rn(+(g<-1?-1:g)),G[E>>3]=g,+ke(+(g+-1.5707963267948966))<1e-16){G[E>>3]=1.5707963267948966,G[E+8>>3]=0;return}if(+ke(+(g+1.5707963267948966))<1e-16){G[E>>3]=-1.5707963267948966,G[E+8>>3]=0;return}if(N=+$e(+g),R=v*+ht(+R)/N,v=+G[m>>3],g=(O-+ht(+g)*+ht(+v))/+$e(+v)/N,O=R>1?1:R,g=g>1?1:g,g=+G[m+8>>3]+ +dn(+(O<-1?-1:O),+(g<-1?-1:g)),g>3.141592653589793)do g=g+-6.283185307179586;while(g>3.141592653589793);if(g<-3.141592653589793)do g=g+6.283185307179586;while(g<-3.141592653589793);G[E+8>>3]=g;return}while(0);if(+ke(+(g+-1.5707963267948966))<1e-16){G[C>>3]=1.5707963267948966,G[E+8>>3]=0;return}if(+ke(+(g+1.5707963267948966))<1e-16){G[C>>3]=-1.5707963267948966,G[E+8>>3]=0;return}if(g=+G[m+8>>3],g>3.141592653589793)do g=g+-6.283185307179586;while(g>3.141592653589793);if(g<-3.141592653589793)do g=g+6.283185307179586;while(g<-3.141592653589793);G[E+8>>3]=g}function kl(m,g){return m=m|0,g=g|0,m>>>0>15?(g=4,g|0):(G[g>>3]=+G[20528+(m<<3)>>3],g=0,g|0)}function Za(m,g){return m=m|0,g=g|0,m>>>0>15?(g=4,g|0):(G[g>>3]=+G[20656+(m<<3)>>3],g=0,g|0)}function rh(m,g){return m=m|0,g=g|0,m>>>0>15?(g=4,g|0):(G[g>>3]=+G[20784+(m<<3)>>3],g=0,g|0)}function sh(m,g){return m=m|0,g=g|0,m>>>0>15?(g=4,g|0):(G[g>>3]=+G[20912+(m<<3)>>3],g=0,g|0)}function Ya(m,g){m=m|0,g=g|0;var v=0;return m>>>0>15?(g=4,g|0):(v=js(7,0,m,((m|0)<0)<<31>>31)|0,v=V(v|0,Se()|0,120,0)|0,m=Se()|0,o[g>>2]=v|2,o[g+4>>2]=m,g=0,g|0)}function ma(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0;return Re=+G[g>>3],le=+G[m>>3],W=+ht(+((Re-le)*.5)),R=+G[g+8>>3],J=+G[m+8>>3],O=+ht(+((R-J)*.5)),N=+$e(+le),fe=+$e(+Re),O=W*W+O*(fe*N*O),O=+dn(+ +We(+O),+ +We(+(1-O)))*2,W=+G[v>>3],Re=+ht(+((W-Re)*.5)),E=+G[v+8>>3],R=+ht(+((E-R)*.5)),C=+$e(+W),R=Re*Re+R*(fe*C*R),R=+dn(+ +We(+R),+ +We(+(1-R)))*2,W=+ht(+((le-W)*.5)),E=+ht(+((J-E)*.5)),E=W*W+E*(N*C*E),E=+dn(+ +We(+E),+ +We(+(1-E)))*2,C=(O+R+E)*.5,+(+jt(+ +We(+(+Lt(+(C*.5))*+Lt(+((C-O)*.5))*+Lt(+((C-R)*.5))*+Lt(+((C-E)*.5)))))*4)}function As(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0;if(N=we,we=we+192|0,R=N+168|0,O=N,C=_o(m,g,R)|0,C|0)return v=C,we=N,v|0;if(fr(m,g,O)|0&&An(23313,22742,386,22751),g=o[O>>2]|0,(g|0)>0){if(E=+ma(O+8|0,O+8+(((g|0)!=1&1)<<4)|0,R)+0,(g|0)!=1){m=1;do C=m,m=m+1|0,E=E+ +ma(O+8+(C<<4)|0,O+8+(((m|0)%(g|0)|0)<<4)|0,R);while((m|0)<(g|0))}}else E=0;return G[v>>3]=E,v=0,we=N,v|0}function Ft(m,g,v){return m=m|0,g=g|0,v=v|0,m=As(m,g,v)|0,m|0||(G[v>>3]=+G[v>>3]*6371.007180918475*6371.007180918475),m|0}function nu(m,g,v){return m=m|0,g=g|0,v=v|0,m=As(m,g,v)|0,m|0||(G[v>>3]=+G[v>>3]*6371.007180918475*6371.007180918475*1e3*1e3),m|0}function ya(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0;if(N=we,we=we+176|0,O=N,m=Fs(m,g,O)|0,m|0)return O=m,we=N,O|0;if(G[v>>3]=0,m=o[O>>2]|0,(m|0)<=1)return O=0,we=N,O|0;g=m+-1|0,m=0,E=+G[O+8>>3],C=+G[O+16>>3],R=0;do m=m+1|0,J=E,E=+G[O+8+(m<<4)>>3],le=+ht(+((E-J)*.5)),W=C,C=+G[O+8+(m<<4)+8>>3],W=+ht(+((C-W)*.5)),W=le*le+W*(+$e(+E)*+$e(+J)*W),R=R+ +dn(+ +We(+W),+ +We(+(1-W)))*2;while((m|0)<(g|0));return G[v>>3]=R,O=0,we=N,O|0}function Qo(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0;if(N=we,we=we+176|0,O=N,m=Fs(m,g,O)|0,m|0)return O=m,R=+G[v>>3],R=R*6371.007180918475,G[v>>3]=R,we=N,O|0;if(G[v>>3]=0,m=o[O>>2]|0,(m|0)<=1)return O=0,R=0,R=R*6371.007180918475,G[v>>3]=R,we=N,O|0;g=m+-1|0,m=0,E=+G[O+8>>3],C=+G[O+16>>3],R=0;do m=m+1|0,J=E,E=+G[O+8+(m<<4)>>3],le=+ht(+((E-J)*.5)),W=C,C=+G[O+8+(m<<4)+8>>3],W=+ht(+((C-W)*.5)),W=le*le+W*(+$e(+J)*+$e(+E)*W),R=R+ +dn(+ +We(+W),+ +We(+(1-W)))*2;while((m|0)!=(g|0));return G[v>>3]=R,O=0,le=R,le=le*6371.007180918475,G[v>>3]=le,we=N,O|0}function iu(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0;if(N=we,we=we+176|0,O=N,m=Fs(m,g,O)|0,m|0)return O=m,R=+G[v>>3],R=R*6371.007180918475,R=R*1e3,G[v>>3]=R,we=N,O|0;if(G[v>>3]=0,m=o[O>>2]|0,(m|0)<=1)return O=0,R=0,R=R*6371.007180918475,R=R*1e3,G[v>>3]=R,we=N,O|0;g=m+-1|0,m=0,E=+G[O+8>>3],C=+G[O+16>>3],R=0;do m=m+1|0,J=E,E=+G[O+8+(m<<4)>>3],le=+ht(+((E-J)*.5)),W=C,C=+G[O+8+(m<<4)+8>>3],W=+ht(+((C-W)*.5)),W=le*le+W*(+$e(+J)*+$e(+E)*W),R=R+ +dn(+ +We(+W),+ +We(+(1-W)))*2;while((m|0)!=(g|0));return G[v>>3]=R,O=0,le=R,le=le*6371.007180918475,le=le*1e3,G[v>>3]=le,we=N,O|0}function Ut(m){m=m|0;var g=0,v=0,E=0;return g=h(1,12)|0,g||An(22832,22787,49,22845),v=m+4|0,E=o[v>>2]|0,E|0?(E=E+8|0,o[E>>2]=g,o[v>>2]=g,g|0):(o[m>>2]|0&&An(22862,22787,61,22885),E=m,o[E>>2]=g,o[v>>2]=g,g|0)}function mA(m,g){m=m|0,g=g|0;var v=0,E=0;return E=_(24)|0,E||An(22899,22787,78,22913),o[E>>2]=o[g>>2],o[E+4>>2]=o[g+4>>2],o[E+8>>2]=o[g+8>>2],o[E+12>>2]=o[g+12>>2],o[E+16>>2]=0,g=m+4|0,v=o[g>>2]|0,v|0?(o[v+16>>2]=E,o[g>>2]=E,E|0):(o[m>>2]|0&&An(22928,22787,82,22913),o[m>>2]=E,o[g>>2]=E,E|0)}function Ll(m){m=m|0;var g=0,v=0,E=0,C=0;if(m)for(E=1;;){if(g=o[m>>2]|0,g|0)do{if(v=o[g>>2]|0,v|0)do C=v,v=o[v+16>>2]|0,l(C);while(v|0);C=g,g=o[g+8>>2]|0,l(C)}while(g|0);if(g=m,m=o[m+8>>2]|0,E||l(g),m)E=0;else break}}function yA(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0,rt=0,Xe=0,Vt=0,Bt=0,ft=0,yt=0,Cn=0,xn=0,gn=0,yn=0,bn=0,Ln=0,ai=0,Pn=0;if(C=m+8|0,o[C>>2]|0)return Pn=1,Pn|0;if(E=o[m>>2]|0,!E)return Pn=0,Pn|0;g=E,v=0;do v=v+1|0,g=o[g+8>>2]|0;while(g|0);if(v>>>0<2)return Pn=0,Pn|0;Ln=_(v<<2)|0,Ln||An(22948,22787,317,22967),bn=_(v<<5)|0,bn||An(22989,22787,321,22967),o[m>>2]=0,Bt=m+4|0,o[Bt>>2]=0,o[C>>2]=0,v=0,yn=0,Vt=0,fe=0;e:for(;;){if(le=o[E>>2]|0,le){R=0,O=le;do{if(W=+G[O+8>>3],g=O,O=o[O+16>>2]|0,J=(O|0)==0,C=J?le:O,N=+G[C+8>>3],+ke(+(W-N))>3.141592653589793){Pn=14;break}R=R+(N-W)*(+G[g>>3]+ +G[C>>3])}while(!J);if((Pn|0)==14){Pn=0,R=0,g=le;do Xe=+G[g+8>>3],gn=g+16|0,xn=o[gn>>2]|0,xn=xn|0?xn:le,rt=+G[xn+8>>3],R=R+(+G[g>>3]+ +G[xn>>3])*((rt<0?rt+6.283185307179586:rt)-(Xe<0?Xe+6.283185307179586:Xe)),g=o[(g|0?gn:E)>>2]|0;while(g|0)}R>0?(o[Ln+(yn<<2)>>2]=E,yn=yn+1|0,C=Vt,g=fe):Pn=19}else Pn=19;if((Pn|0)==19){Pn=0;do if(v){if(g=v+8|0,o[g>>2]|0){Pn=21;break e}if(v=h(1,12)|0,!v){Pn=23;break e}o[g>>2]=v,C=v+4|0,O=v,g=fe}else if(fe){C=Bt,O=fe+8|0,g=E,v=m;break}else if(o[m>>2]|0){Pn=27;break e}else{C=Bt,O=m,g=E,v=m;break}while(0);if(o[O>>2]=E,o[C>>2]=E,O=bn+(Vt<<5)|0,J=o[E>>2]|0,J){for(le=bn+(Vt<<5)+8|0,G[le>>3]=17976931348623157e292,fe=bn+(Vt<<5)+24|0,G[fe>>3]=17976931348623157e292,G[O>>3]=-17976931348623157e292,Re=bn+(Vt<<5)+16|0,G[Re>>3]=-17976931348623157e292,At=17976931348623157e292,it=-17976931348623157e292,C=0,je=J,W=17976931348623157e292,Ze=17976931348623157e292,ct=-17976931348623157e292,N=-17976931348623157e292;R=+G[je>>3],Xe=+G[je+8>>3],je=o[je+16>>2]|0,Be=(je|0)==0,rt=+G[(Be?J:je)+8>>3],R<W&&(G[le>>3]=R,W=R),Xe<Ze&&(G[fe>>3]=Xe,Ze=Xe),R>ct?G[O>>3]=R:R=ct,Xe>N&&(G[Re>>3]=Xe,N=Xe),At=Xe>0&Xe<At?Xe:At,it=Xe<0&Xe>it?Xe:it,C=C|+ke(+(Xe-rt))>3.141592653589793,!Be;)ct=R;C&&(G[Re>>3]=it,G[fe>>3]=At)}else o[O>>2]=0,o[O+4>>2]=0,o[O+8>>2]=0,o[O+12>>2]=0,o[O+16>>2]=0,o[O+20>>2]=0,o[O+24>>2]=0,o[O+28>>2]=0;C=Vt+1|0}if(gn=E+8|0,E=o[gn>>2]|0,o[gn>>2]=0,E)Vt=C,fe=g;else{Pn=45;break}}if((Pn|0)==21)An(22765,22787,35,22799);else if((Pn|0)==23)An(22819,22787,37,22799);else if((Pn|0)==27)An(22862,22787,61,22885);else if((Pn|0)==45){e:do if((yn|0)>0){for(gn=(C|0)==0,Cn=C<<2,xn=(m|0)==0,yt=0,g=0;;){if(ft=o[Ln+(yt<<2)>>2]|0,gn)Pn=73;else{if(Vt=_(Cn)|0,!Vt){Pn=50;break}if(Bt=_(Cn)|0,!Bt){Pn=52;break}t:do if(xn)v=0;else{for(C=0,v=0,O=m;E=bn+(C<<5)|0,Xa(o[O>>2]|0,E,o[ft>>2]|0)|0?(o[Vt+(v<<2)>>2]=O,o[Bt+(v<<2)>>2]=E,Be=v+1|0):Be=v,O=o[O+8>>2]|0,O;)C=C+1|0,v=Be;if((Be|0)>0)if(E=o[Vt>>2]|0,(Be|0)==1)v=E;else for(Re=0,je=-1,v=E,fe=E;;){for(J=o[fe>>2]|0,E=0,O=0;C=o[o[Vt+(O<<2)>>2]>>2]|0,(C|0)==(J|0)?le=E:le=E+((Xa(C,o[Bt+(O<<2)>>2]|0,o[J>>2]|0)|0)&1)|0,O=O+1|0,(O|0)!=(Be|0);)E=le;if(C=(le|0)>(je|0),v=C?fe:v,E=Re+1|0,(E|0)==(Be|0))break t;Re=E,je=C?le:je,fe=o[Vt+(E<<2)>>2]|0}else v=0}while(0);if(l(Vt),l(Bt),v){if(C=v+4|0,E=o[C>>2]|0,E)v=E+8|0;else if(o[v>>2]|0){Pn=70;break}o[v>>2]=ft,o[C>>2]=ft}else Pn=73}if((Pn|0)==73){if(Pn=0,g=o[ft>>2]|0,g|0)do Bt=g,g=o[g+16>>2]|0,l(Bt);while(g|0);l(ft),g=1}if(yt=yt+1|0,(yt|0)>=(yn|0)){ai=g;break e}}(Pn|0)==50?An(23004,22787,249,23023):(Pn|0)==52?An(23042,22787,252,23023):(Pn|0)==70&&An(22862,22787,61,22885)}else ai=0;while(0);return l(Ln),l(bn),Pn=ai,Pn|0}return 0}function Xa(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0;if(!(WA(g,v)|0)||(g=Zn(g)|0,E=+G[v>>3],C=+G[v+8>>3],C=g&C<0?C+6.283185307179586:C,m=o[m>>2]|0,!m))return m=0,m|0;if(g){g=0,J=C,v=m;e:for(;;){for(;O=+G[v>>3],C=+G[v+8>>3],v=v+16|0,le=o[v>>2]|0,le=le|0?le:m,R=+G[le>>3],N=+G[le+8>>3],O>R?(W=O,O=N):(W=R,R=O,O=C,C=N),E=E==R|E==W?E+2220446049250313e-31:E,!!(E<R|E>W);)if(v=o[v>>2]|0,!v){v=22;break e}if(N=O<0?O+6.283185307179586:O,O=C<0?C+6.283185307179586:C,J=N==J|O==J?J+-2220446049250313e-31:J,W=N+(O-N)*((E-R)/(W-R)),(W<0?W+6.283185307179586:W)>J&&(g=g^1),v=o[v>>2]|0,!v){v=22;break}}if((v|0)==22)return g|0}else{g=0,J=C,v=m;e:for(;;){for(;O=+G[v>>3],C=+G[v+8>>3],v=v+16|0,le=o[v>>2]|0,le=le|0?le:m,R=+G[le>>3],N=+G[le+8>>3],O>R?(W=O,O=N):(W=R,R=O,O=C,C=N),E=E==R|E==W?E+2220446049250313e-31:E,!!(E<R|E>W);)if(v=o[v>>2]|0,!v){v=22;break e}if(J=O==J|C==J?J+-2220446049250313e-31:J,O+(C-O)*((E-R)/(W-R))>J&&(g=g^1),v=o[v>>2]|0,!v){v=22;break}}if((v|0)==22)return g|0}return 0}function Gs(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0;if(it=we,we=we+32|0,At=it+16|0,ct=it,R=ne(m|0,g|0,52)|0,Se()|0,R=R&15,je=ne(v|0,E|0,52)|0,Se()|0,(R|0)!=(je&15|0))return At=12,we=it,At|0;if(J=ne(m|0,g|0,45)|0,Se()|0,J=J&127,le=ne(v|0,E|0,45)|0,Se()|0,le=le&127,J>>>0>121|le>>>0>121)return At=5,we=it,At|0;if(je=(J|0)!=(le|0),je){if(N=_l(J,le)|0,(N|0)==7)return At=1,we=it,At|0;W=_l(le,J)|0,(W|0)==7?An(23066,23090,161,23100):(Be=N,O=W)}else Be=0,O=0;fe=Vn(J)|0,Re=Vn(le)|0,o[At>>2]=0,o[At+4>>2]=0,o[At+8>>2]=0,o[At+12>>2]=0;do if(Be){if(le=o[4272+(J*28|0)+(Be<<2)>>2]|0,N=(le|0)>0,Re)if(N){J=0,W=v,N=E;do W=ic(W,N)|0,N=Se()|0,O=jo(O)|0,(O|0)==1&&(O=jo(1)|0),J=J+1|0;while((J|0)!=(le|0));le=O,J=W,W=N}else le=O,J=v,W=E;else if(N){J=0,W=v,N=E;do W=gA(W,N)|0,N=Se()|0,O=jo(O)|0,J=J+1|0;while((J|0)!=(le|0));le=O,J=W,W=N}else le=O,J=v,W=E;if(pa(J,W,At)|0,je||An(23115,23090,191,23100),N=(fe|0)!=0,O=(Re|0)!=0,N&O&&An(23142,23090,192,23100),N){if(O=tr(m,g)|0,(O|0)==7){R=5;break}if(he[21872+(O*7|0)+Be>>0]|0){R=1;break}W=o[21040+(O*28|0)+(Be<<2)>>2]|0,J=W}else if(O){if(O=tr(J,W)|0,(O|0)==7){R=5;break}if(he[21872+(O*7|0)+le>>0]|0){R=1;break}J=0,W=o[21040+(le*28|0)+(O<<2)>>2]|0}else J=0,W=0;if((J|W|0)<0)R=5;else{if((W|0)>0){N=At+4|0,O=0;do wl(N),O=O+1|0;while((O|0)!=(W|0))}if(o[ct>>2]=0,o[ct+4>>2]=0,o[ct+8>>2]=0,jr(ct,Be),R|0)for(;wr(R)|0?Go(ct):Gr(ct),(R|0)>1;)R=R+-1|0;if((J|0)>0){R=0;do wl(ct),R=R+1|0;while((R|0)!=(J|0))}Ze=At+4|0,er(Ze,ct,Ze),Bn(Ze),Ze=51}}else if(pa(v,E,At)|0,(fe|0)!=0&(Re|0)!=0)if((le|0)!=(J|0)&&An(23173,23090,261,23100),O=tr(m,g)|0,R=tr(v,E)|0,(O|0)==7|(R|0)==7)R=5;else if(he[21872+(O*7|0)+R>>0]|0)R=1;else if(O=o[21040+(O*28|0)+(R<<2)>>2]|0,(O|0)>0){N=At+4|0,R=0;do wl(N),R=R+1|0;while((R|0)!=(O|0));Ze=51}else Ze=51;else Ze=51;while(0);return(Ze|0)==51&&(R=At+4|0,o[C>>2]=o[R>>2],o[C+4>>2]=o[R+4>>2],o[C+8>>2]=o[R+8>>2],R=0),At=R,we=it,At|0}function ru(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0,rt=0;if(Ze=we,we=we+48|0,J=Ze+36|0,O=Ze+24|0,N=Ze+12|0,W=Ze,C=ne(m|0,g|0,52)|0,Se()|0,C=C&15,Re=ne(m|0,g|0,45)|0,Se()|0,Re=Re&127,Re>>>0>121)return E=5,we=Ze,E|0;if(le=Vn(Re)|0,ue(C|0,0,52)|0,ct=Se()|0|134225919,R=E,o[R>>2]=-1,o[R+4>>2]=ct,!C)return C=Vo(v)|0,(C|0)==7||(C=yl(Re,C)|0,(C|0)==127)?(ct=1,we=Ze,ct|0):(je=ue(C|0,0,45)|0,Be=Se()|0,Re=E,Be=o[Re+4>>2]&-1040385|Be,ct=E,o[ct>>2]=o[Re>>2]|je,o[ct+4>>2]=Be,ct=0,we=Ze,ct|0);for(o[J>>2]=o[v>>2],o[J+4>>2]=o[v+4>>2],o[J+8>>2]=o[v+8>>2],v=C;;){if(R=v,v=v+-1|0,o[O>>2]=o[J>>2],o[O+4>>2]=o[J+4>>2],o[O+8>>2]=o[J+8>>2],wr(R)|0){if(C=ca(J)|0,C|0){v=13;break}o[N>>2]=o[J>>2],o[N+4>>2]=o[J+4>>2],o[N+8>>2]=o[J+8>>2],Go(N)}else{if(C=go(J)|0,C|0){v=13;break}o[N>>2]=o[J>>2],o[N+4>>2]=o[J+4>>2],o[N+8>>2]=o[J+8>>2],Gr(N)}if(po(O,N,W),Bn(W),C=E,it=o[C>>2]|0,C=o[C+4>>2]|0,rt=(15-R|0)*3|0,At=ue(7,0,rt|0)|0,C=C&~(Se()|0),rt=ue(Vo(W)|0,0,rt|0)|0,C=Se()|0|C,ct=E,o[ct>>2]=rt|it&~At,o[ct+4>>2]=C,(R|0)<=1){v=14;break}}e:do if((v|0)!=13&&(v|0)==14)if((o[J>>2]|0)<=1&&(o[J+4>>2]|0)<=1&&(o[J+8>>2]|0)<=1){v=Vo(J)|0,C=yl(Re,v)|0,(C|0)==127?W=0:W=Vn(C)|0;t:do if(v){if(le){if(C=tr(m,g)|0,(C|0)==7){C=5;break e}if(R=o[21248+(C*28|0)+(v<<2)>>2]|0,(R|0)>0){C=v,v=0;do C=mo(C)|0,v=v+1|0;while((v|0)!=(R|0))}else C=v;if((C|0)==1){C=9;break e}v=yl(Re,C)|0,(v|0)==127&&An(23200,23090,411,23230),Vn(v)|0?An(23245,23090,412,23230):(Be=v,je=R,fe=C)}else Be=C,je=0,fe=v;if(N=o[4272+(Re*28|0)+(fe<<2)>>2]|0,(N|0)<=-1&&An(23276,23090,419,23230),!W){if((je|0)<0){C=5;break e}if(je|0){R=E,C=0,v=o[R>>2]|0,R=o[R+4>>2]|0;do v=Us(v,R)|0,R=Se()|0,rt=E,o[rt>>2]=v,o[rt+4>>2]=R,C=C+1|0;while((C|0)<(je|0))}if((N|0)<=0){C=Be,v=58;break}for(R=E,C=0,v=o[R>>2]|0,R=o[R+4>>2]|0;;)if(v=Us(v,R)|0,R=Se()|0,rt=E,o[rt>>2]=v,o[rt+4>>2]=R,C=C+1|0,(C|0)==(N|0)){C=Be,v=58;break t}}if(O=_l(Be,Re)|0,(O|0)==7&&An(23066,23090,428,23230),C=E,v=o[C>>2]|0,C=o[C+4>>2]|0,(N|0)>0){R=0;do v=Us(v,C)|0,C=Se()|0,rt=E,o[rt>>2]=v,o[rt+4>>2]=C,R=R+1|0;while((R|0)!=(N|0))}if(C=tr(v,C)|0,(C|0)==7&&An(23313,23090,440,23230),v=aA(Be)|0,v=o[(v?21664:21456)+(O*28|0)+(C<<2)>>2]|0,(v|0)<0&&An(23313,23090,454,23230),!v)C=Be,v=58;else{O=E,C=0,R=o[O>>2]|0,O=o[O+4>>2]|0;do R=tu(R,O)|0,O=Se()|0,rt=E,o[rt>>2]=R,o[rt+4>>2]=O,C=C+1|0;while((C|0)<(v|0));C=Be,v=58}}else if((le|0)!=0&(W|0)!=0){if(v=tr(m,g)|0,R=E,R=tr(o[R>>2]|0,o[R+4>>2]|0)|0,(v|0)==7|(R|0)==7){C=5;break e}if(R=o[21248+(v*28|0)+(R<<2)>>2]|0,(R|0)<0){C=5;break e}if(!R)v=59;else{N=E,v=0,O=o[N>>2]|0,N=o[N+4>>2]|0;do O=Us(O,N)|0,N=Se()|0,rt=E,o[rt>>2]=O,o[rt+4>>2]=N,v=v+1|0;while((v|0)<(R|0));v=58}}else v=58;while(0);if((v|0)==58&&W&&(v=59),(v|0)==59&&(rt=E,(tr(o[rt>>2]|0,o[rt+4>>2]|0)|0)==1)){C=9;break}rt=E,At=o[rt>>2]|0,rt=o[rt+4>>2]&-1040385,it=ue(C|0,0,45)|0,rt=rt|(Se()|0),C=E,o[C>>2]=At|it,o[C+4>>2]=rt,C=0}else C=1;while(0);return rt=C,we=Ze,rt|0}function oh(m,g,v,E,C,R){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0,R=R|0;var O=0,N=0;return N=we,we=we+16|0,O=N,C?m=15:(m=Gs(m,g,v,E,O)|0,m||(dA(O,R),m=0)),we=N,m|0}function oc(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0;return O=we,we=we+16|0,R=O,E?v=15:(v=ZA(v,R)|0,v||(v=ru(m,g,R,C)|0)),we=O,v|0}function su(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0;return W=we,we=we+32|0,O=W+12|0,N=W,R=Gs(m,g,m,g,O)|0,R|0?(N=R,we=W,N|0):(m=Gs(m,g,v,E,N)|0,m|0?(N=m,we=W,N|0):(O=bl(O,N)|0,N=C,o[N>>2]=O,o[N+4>>2]=((O|0)<0)<<31>>31,N=0,we=W,N|0))}function ou(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0;return W=we,we=we+32|0,O=W+12|0,N=W,R=Gs(m,g,m,g,O)|0,!R&&(R=Gs(m,g,v,E,N)|0,!R)?(E=bl(O,N)|0,E=d(E|0,((E|0)<0)<<31>>31|0,1,0)|0,O=Se()|0,N=C,o[N>>2]=E,o[N+4>>2]=O,N=0,we=W,N|0):(N=R,we=W,N|0)}function au(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0,rt=0,Xe=0,Vt=0,Bt=0,ft=0,yt=0;if(ft=we,we=we+48|0,O=ft+24|0,N=ft+12|0,Bt=ft,R=Gs(m,g,m,g,O)|0,!R&&(R=Gs(m,g,v,E,N)|0,!R)){Xe=bl(O,N)|0,Vt=((Xe|0)<0)<<31>>31,o[O>>2]=0,o[O+4>>2]=0,o[O+8>>2]=0,o[N>>2]=0,o[N+4>>2]=0,o[N+8>>2]=0,Gs(m,g,m,g,O)|0&&An(23313,23090,691,23299),Gs(m,g,v,E,N)|0&&An(23313,23090,696,23299),$o(O),$o(N),Xe?(fe=o[O>>2]|0,Be=+(Xe|0),At=O+4|0,Re=o[At>>2]|0,it=O+8|0,je=o[it>>2]|0,rt=O,E=fe,R=Re,v=je,Ze=+((o[N>>2]|0)-fe|0)/Be,ct=+((o[N+4>>2]|0)-Re|0)/Be,Be=+((o[N+8>>2]|0)-je|0)/Be):(R=O+4|0,v=O+8|0,At=R,it=v,rt=O,E=o[O>>2]|0,R=o[R>>2]|0,v=o[v>>2]|0,Ze=0,ct=0,Be=0),o[Bt>>2]=E,je=Bt+4|0,o[je>>2]=R,Re=Bt+8|0,o[Re>>2]=v;e:do if((Xe|0)<0)R=0;else for(le=0,fe=0,R=E;;){J=+(fe>>>0)+4294967296*+(le|0),yt=Ze*J+ +(R|0),W=ct*J+ +(o[At>>2]|0),J=Be*J+ +(o[it>>2]|0),v=~~+_e(+yt),O=~~+_e(+W),R=~~+_e(+J),yt=+ke(+(+(v|0)-yt)),W=+ke(+(+(O|0)-W)),J=+ke(+(+(R|0)-J));do if(yt>W&yt>J)v=0-(O+R)|0,E=O;else if(N=0-v|0,W>J){E=N-R|0;break}else{E=O,R=N-O|0;break}while(0);if(o[Bt>>2]=v,o[je>>2]=E,o[Re>>2]=R,ja(Bt),R=ru(m,g,Bt,C+(fe<<3)|0)|0,R|0)break e;if(!((le|0)<(Vt|0)|(le|0)==(Vt|0)&fe>>>0<Xe>>>0)){R=0;break e}R=d(fe|0,le|0,1,0)|0,N=Se()|0,le=N,fe=R,R=o[rt>>2]|0}while(0);return Bt=R,we=ft,Bt|0}return Bt=R,we=ft,Bt|0}function js(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0;if((v|0)==0&(E|0)==0)return C=0,R=1,Mt(C|0),R|0;R=m,C=g,m=1,g=0;do O=(v&1|0)==0&!0,m=V((O?1:R)|0,(O?0:C)|0,m|0,g|0)|0,g=Se()|0,v=se(v|0,E|0,1)|0,E=Se()|0,R=V(R|0,C|0,R|0,C|0)|0,C=Se()|0;while(!((v|0)==0&(E|0)==0));return Mt(g|0),m|0}function Dr(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0;if(!(WA(g,v)|0)||(g=Zn(g)|0,E=+G[v>>3],C=+G[v+8>>3],C=g&C<0?C+6.283185307179586:C,Re=o[m>>2]|0,(Re|0)<=0))return Re=0,Re|0;if(fe=o[m+4>>2]|0,g){g=0,le=C,v=-1,m=0;e:for(;;){for(J=m;O=+G[fe+(J<<4)>>3],C=+G[fe+(J<<4)+8>>3],m=(v+2|0)%(Re|0)|0,R=+G[fe+(m<<4)>>3],N=+G[fe+(m<<4)+8>>3],O>R?(W=O,O=N):(W=R,R=O,O=C,C=N),E=E==R|E==W?E+2220446049250313e-31:E,!!(E<R|E>W);)if(v=J+1|0,(v|0)>=(Re|0)){v=22;break e}else m=J,J=v,v=m;if(N=O<0?O+6.283185307179586:O,O=C<0?C+6.283185307179586:C,le=N==le|O==le?le+-2220446049250313e-31:le,W=N+(O-N)*((E-R)/(W-R)),(W<0?W+6.283185307179586:W)>le&&(g=g^1),m=J+1|0,(m|0)>=(Re|0)){v=22;break}else v=J}if((v|0)==22)return g|0}else{g=0,le=C,v=-1,m=0;e:for(;;){for(J=m;O=+G[fe+(J<<4)>>3],C=+G[fe+(J<<4)+8>>3],m=(v+2|0)%(Re|0)|0,R=+G[fe+(m<<4)>>3],N=+G[fe+(m<<4)+8>>3],O>R?(W=O,O=N):(W=R,R=O,O=C,C=N),E=E==R|E==W?E+2220446049250313e-31:E,!!(E<R|E>W);)if(v=J+1|0,(v|0)>=(Re|0)){v=22;break e}else m=J,J=v,v=m;if(le=O==le|C==le?le+-2220446049250313e-31:le,O+(C-O)*((E-R)/(W-R))>le&&(g=g^1),m=J+1|0,(m|0)>=(Re|0)){v=22;break}else v=J}if((v|0)==22)return g|0}return 0}function xo(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0;if(Be=o[m>>2]|0,!Be){o[g>>2]=0,o[g+4>>2]=0,o[g+8>>2]=0,o[g+12>>2]=0,o[g+16>>2]=0,o[g+20>>2]=0,o[g+24>>2]=0,o[g+28>>2]=0;return}if(Ze=g+8|0,G[Ze>>3]=17976931348623157e292,ct=g+24|0,G[ct>>3]=17976931348623157e292,G[g>>3]=-17976931348623157e292,At=g+16|0,G[At>>3]=-17976931348623157e292,!((Be|0)<=0)){for(Re=o[m+4>>2]|0,J=17976931348623157e292,le=-17976931348623157e292,fe=0,m=-1,R=17976931348623157e292,O=17976931348623157e292,W=-17976931348623157e292,E=-17976931348623157e292,je=0;v=+G[Re+(je<<4)>>3],N=+G[Re+(je<<4)+8>>3],m=m+2|0,C=+G[Re+(((m|0)==(Be|0)?0:m)<<4)+8>>3],v<R&&(G[Ze>>3]=v,R=v),N<O&&(G[ct>>3]=N,O=N),v>W?G[g>>3]=v:v=W,N>E&&(G[At>>3]=N,E=N),J=N>0&N<J?N:J,le=N<0&N>le?N:le,fe=fe|+ke(+(N-C))>3.141592653589793,m=je+1|0,(m|0)!=(Be|0);)it=je,W=v,je=m,m=it;fe&&(G[At>>3]=le,G[ct>>3]=J)}}function lu(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0,rt=0,Xe=0,Vt=0,Bt=0,ft=0;if(Be=o[m>>2]|0,Be){if(Ze=g+8|0,G[Ze>>3]=17976931348623157e292,ct=g+24|0,G[ct>>3]=17976931348623157e292,G[g>>3]=-17976931348623157e292,At=g+16|0,G[At>>3]=-17976931348623157e292,(Be|0)>0){for(C=o[m+4>>2]|0,Re=17976931348623157e292,je=-17976931348623157e292,E=0,v=-1,W=17976931348623157e292,J=17976931348623157e292,fe=-17976931348623157e292,O=-17976931348623157e292,it=0;R=+G[C+(it<<4)>>3],le=+G[C+(it<<4)+8>>3],Bt=v+2|0,N=+G[C+(((Bt|0)==(Be|0)?0:Bt)<<4)+8>>3],R<W&&(G[Ze>>3]=R,W=R),le<J&&(G[ct>>3]=le,J=le),R>fe?G[g>>3]=R:R=fe,le>O&&(G[At>>3]=le,O=le),Re=le>0&le<Re?le:Re,je=le<0&le>je?le:je,E=E|+ke(+(le-N))>3.141592653589793,v=it+1|0,(v|0)!=(Be|0);)Bt=it,fe=R,it=v,v=Bt;E&&(G[At>>3]=je,G[ct>>3]=Re)}}else o[g>>2]=0,o[g+4>>2]=0,o[g+8>>2]=0,o[g+12>>2]=0,o[g+16>>2]=0,o[g+20>>2]=0,o[g+24>>2]=0,o[g+28>>2]=0;if(Bt=m+8|0,v=o[Bt>>2]|0,!((v|0)<=0)){Vt=m+12|0,Xe=0;do if(C=o[Vt>>2]|0,E=Xe,Xe=Xe+1|0,ct=g+(Xe<<5)|0,At=o[C+(E<<3)>>2]|0,At){if(it=g+(Xe<<5)+8|0,G[it>>3]=17976931348623157e292,m=g+(Xe<<5)+24|0,G[m>>3]=17976931348623157e292,G[ct>>3]=-17976931348623157e292,rt=g+(Xe<<5)+16|0,G[rt>>3]=-17976931348623157e292,(At|0)>0){for(Be=o[C+(E<<3)+4>>2]|0,Re=17976931348623157e292,je=-17976931348623157e292,C=0,E=-1,Ze=0,W=17976931348623157e292,J=17976931348623157e292,le=-17976931348623157e292,O=-17976931348623157e292;R=+G[Be+(Ze<<4)>>3],fe=+G[Be+(Ze<<4)+8>>3],E=E+2|0,N=+G[Be+(((E|0)==(At|0)?0:E)<<4)+8>>3],R<W&&(G[it>>3]=R,W=R),fe<J&&(G[m>>3]=fe,J=fe),R>le?G[ct>>3]=R:R=le,fe>O&&(G[rt>>3]=fe,O=fe),Re=fe>0&fe<Re?fe:Re,je=fe<0&fe>je?fe:je,C=C|+ke(+(fe-N))>3.141592653589793,E=Ze+1|0,(E|0)!=(At|0);)ft=Ze,Ze=E,le=R,E=ft;C&&(G[rt>>3]=je,G[m>>3]=Re)}}else o[ct>>2]=0,o[ct+4>>2]=0,o[ct+8>>2]=0,o[ct+12>>2]=0,o[ct+16>>2]=0,o[ct+20>>2]=0,o[ct+24>>2]=0,o[ct+28>>2]=0,v=o[Bt>>2]|0;while((Xe|0)<(v|0))}}function _a(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;if(!(Dr(m,g,v)|0))return C=0,C|0;if(C=m+8|0,(o[C>>2]|0)<=0)return C=1,C|0;for(E=m+12|0,m=0;;){if(R=m,m=m+1|0,Dr((o[E>>2]|0)+(R<<3)|0,g+(m<<5)|0,v)|0){m=0,E=6;break}if((m|0)>=(o[C>>2]|0)){m=1,E=6;break}}return(E|0)==6?m|0:0}function zi(){return 8}function Dl(){return 16}function ac(){return 168}function us(){return 8}function Ei(){return 16}function Ka(){return 12}function Rl(){return 8}function Au(m){return m=m|0,+(+((o[m>>2]|0)>>>0)+4294967296*+(o[m+4>>2]|0))}function lc(m){m=m|0;var g=0,v=0;return v=+G[m>>3],g=+G[m+8>>3],+ +We(+(v*v+g*g))}function uu(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0;J=+G[m>>3],W=+G[g>>3]-J,N=+G[m+8>>3],O=+G[g+8>>3]-N,fe=+G[v>>3],R=+G[E>>3]-fe,Re=+G[v+8>>3],le=+G[E+8>>3]-Re,R=(R*(N-Re)-(J-fe)*le)/(W*le-O*R),G[C>>3]=J+W*R,G[C+8>>3]=N+O*R}function Ac(m,g){return m=m|0,g=g|0,+ke(+(+G[m>>3]-+G[g>>3]))<11920928955078125e-23?(g=+ke(+(+G[m+8>>3]-+G[g+8>>3]))<11920928955078125e-23,g|0):(g=0,g|0)}function gi(m,g){m=m|0,g=g|0;var v=0,E=0,C=0;return C=+G[m>>3]-+G[g>>3],E=+G[m+8>>3]-+G[g+8>>3],v=+G[m+16>>3]-+G[g+16>>3],+(C*C+E*E+v*v)}function Bl(m,g){m=m|0,g=g|0;var v=0,E=0,C=0;v=+G[m>>3],E=+$e(+v),v=+ht(+v),G[g+16>>3]=v,v=+G[m+8>>3],C=E*+$e(+v),G[g>>3]=C,v=E*+ht(+v),G[g+8>>3]=v}function Zt(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;if(R=we,we=we+16|0,C=R,E=pi(m,g)|0,(v+-1|0)>>>0>5||(E=(E|0)!=0,(v|0)==1&E))return C=-1,we=R,C|0;do if(Yt(m,g,C)|0)E=-1;else if(E){E=((o[21936+(v<<2)>>2]|0)+5-(o[C>>2]|0)|0)%5|0;break}else{E=((o[21968+(v<<2)>>2]|0)+6-(o[C>>2]|0)|0)%6|0;break}while(0);return C=E,we=R,C|0}function Yt(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0,J=0;if(J=we,we=we+32|0,O=J+16|0,N=J,E=Qr(m,g,O)|0,E|0)return v=E,we=J,v|0;R=Ha(m,g)|0,W=tr(m,g)|0,$A(R,N),E=HA(R,o[O>>2]|0)|0;e:do if(Vn(R)|0){do switch(R|0){case 4:{m=0;break}case 14:{m=1;break}case 24:{m=2;break}case 38:{m=3;break}case 49:{m=4;break}case 58:{m=5;break}case 63:{m=6;break}case 72:{m=7;break}case 83:{m=8;break}case 97:{m=9;break}case 107:{m=10;break}case 117:{m=11;break}default:{E=1;break e}}while(0);if(C=o[22e3+(m*24|0)+8>>2]|0,g=o[22e3+(m*24|0)+16>>2]|0,m=o[O>>2]|0,(m|0)!=(o[N>>2]|0)&&(N=aA(R)|0,m=o[O>>2]|0,N|(m|0)==(g|0)&&(E=(E+1|0)%6|0)),(W|0)==3&(m|0)==(g|0)){E=(E+5|0)%6|0,C=22;break}(W|0)==5&(m|0)==(C|0)&&(E=(E+1|0)%6|0),C=22}else C=22;while(0);return(C|0)==22&&(o[v>>2]=E,E=0),v=E,we=J,v|0}function cn(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0,rt=0;if(rt=we,we=we+32|0,it=rt+24|0,ct=rt+20|0,Be=rt+8|0,je=rt+16|0,Re=rt,W=(pi(m,g)|0)==0,W=W?6:5,le=ne(m|0,g|0,52)|0,Se()|0,le=le&15,W>>>0<=v>>>0)return E=2,we=rt,E|0;fe=(le|0)==0,!fe&&(Ze=ue(7,0,(le^15)*3|0)|0,(Ze&m|0)==0&((Se()|0)&g|0)==0)?C=v:R=4;e:do if((R|0)==4){if(C=(pi(m,g)|0)!=0,((C?4:5)|0)<(v|0)||Yt(m,g,it)|0||(R=(o[it>>2]|0)+v|0,C?C=22288+(((R|0)%5|0)<<2)|0:C=22320+(((R|0)%6|0)<<2)|0,Ze=o[C>>2]|0,(Ze|0)==7))return E=1,we=rt,E|0;o[ct>>2]=0,C=Fe(m,g,Ze,ct,Be)|0;do if(!C){if(N=Be,J=o[N>>2]|0,N=o[N+4>>2]|0,O=N>>>0<g>>>0|(N|0)==(g|0)&J>>>0<m>>>0,R=O?J:m,O=O?N:g,!fe&&(fe=ue(7,0,(le^15)*3|0)|0,(J&fe|0)==0&(N&(Se()|0)|0)==0))C=v;else{if(N=(v+-1+W|0)%(W|0)|0,C=pi(m,g)|0,(N|0)<0&&An(23313,23315,245,23324),W=(C|0)!=0,((W?4:5)|0)<(N|0)&&An(23313,23315,245,23324),Yt(m,g,it)|0&&An(23313,23315,245,23324),C=(o[it>>2]|0)+N|0,W?C=22288+(((C|0)%5|0)<<2)|0:C=22320+(((C|0)%6|0)<<2)|0,N=o[C>>2]|0,(N|0)==7&&An(23313,23315,245,23324),o[je>>2]=0,C=Fe(m,g,N,je,Re)|0,C|0)break;J=Re,W=o[J>>2]|0,J=o[J+4>>2]|0;do if(J>>>0<O>>>0|(J|0)==(O|0)&W>>>0<R>>>0){if(pi(W,J)|0?R=ot(W,J,m,g)|0:R=o[22384+((((o[je>>2]|0)+(o[22352+(N<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,C=pi(W,J)|0,(R+-1|0)>>>0>5){C=-1,R=W,O=J;break}if(C=(C|0)!=0,(R|0)==1&C){C=-1,R=W,O=J;break}do if(Yt(W,J,it)|0)C=-1;else if(C){C=((o[21936+(R<<2)>>2]|0)+5-(o[it>>2]|0)|0)%5|0;break}else{C=((o[21968+(R<<2)>>2]|0)+6-(o[it>>2]|0)|0)%6|0;break}while(0);R=W,O=J}else C=v;while(0);N=Be,J=o[N>>2]|0,N=o[N+4>>2]|0}if((R|0)==(J|0)&(O|0)==(N|0)){if(W=(pi(J,N)|0)!=0,W?m=ot(J,N,m,g)|0:m=o[22384+((((o[ct>>2]|0)+(o[22352+(Ze<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,C=pi(J,N)|0,(m+-1|0)>>>0<=5&&(At=(C|0)!=0,!((m|0)==1&At)))do if(Yt(J,N,it)|0)C=-1;else if(At){C=((o[21936+(m<<2)>>2]|0)+5-(o[it>>2]|0)|0)%5|0;break}else{C=((o[21968+(m<<2)>>2]|0)+6-(o[it>>2]|0)|0)%6|0;break}while(0);else C=-1;C=C+1|0,C=(C|0)==6|W&(C|0)==5?0:C}g=O,m=R;break e}while(0);return E=C,we=rt,E|0}while(0);return At=ue(C|0,0,56)|0,it=Se()|0|g&-2130706433|536870912,o[E>>2]=At|m,o[E+4>>2]=it,E=0,we=rt,E|0}function Zr(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;return R=(pi(m,g)|0)==0,E=cn(m,g,0,v)|0,C=(E|0)==0,R?!C||(E=cn(m,g,1,v+8|0)|0,E|0)||(E=cn(m,g,2,v+16|0)|0,E|0)||(E=cn(m,g,3,v+24|0)|0,E|0)||(E=cn(m,g,4,v+32|0)|0,E)?(R=E,R|0):cn(m,g,5,v+40|0)|0:!C||(E=cn(m,g,1,v+8|0)|0,E|0)||(E=cn(m,g,2,v+16|0)|0,E|0)||(E=cn(m,g,3,v+24|0)|0,E|0)||(E=cn(m,g,4,v+32|0)|0,E|0)?(R=E,R|0):(R=v+40|0,o[R>>2]=0,o[R+4>>2]=0,R=0,R|0)}function qo(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0,N=0,W=0;return W=we,we=we+192|0,C=W,R=W+168|0,O=ne(m|0,g|0,56)|0,Se()|0,O=O&7,N=g&-2130706433|134217728,E=Qr(m,N,R)|0,E|0?(N=E,we=W,N|0):(g=ne(m|0,g|0,52)|0,Se()|0,g=g&15,pi(m,N)|0?Ho(R,g,O,1,C):JA(R,g,O,1,C),N=C+8|0,o[v>>2]=o[N>>2],o[v+4>>2]=o[N+4>>2],o[v+8>>2]=o[N+8>>2],o[v+12>>2]=o[N+12>>2],N=0,we=W,N|0)}function Ui(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0;return C=we,we=we+16|0,v=C,!(!0&(g&2013265920|0)==536870912)||(E=g&-2130706433|134217728,!(da(m,E)|0))?(E=0,we=C,E|0):(R=ne(m|0,g|0,56)|0,Se()|0,R=(cn(m,E,R&7,v)|0)==0,E=v,E=R&((o[E>>2]|0)==(m|0)?(o[E+4>>2]|0)==(g|0):0)&1,we=C,E|0)}function $s(m,g,v){m=m|0,g=g|0,v=v|0;var E=0;(g|0)>0?(E=h(g,4)|0,o[m>>2]=E,E||An(23337,23360,40,23374)):o[m>>2]=0,o[m+4>>2]=g,o[m+8>>2]=0,o[m+12>>2]=v}function Es(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0;C=m+4|0,R=m+12|0,O=m+8|0;e:for(;;){for(v=o[C>>2]|0,g=0;;){if((g|0)>=(v|0))break e;if(E=o[m>>2]|0,N=o[E+(g<<2)>>2]|0,!N)g=g+1|0;else break}g=E+(~~(+ke(+(+at(10,+ +(15-(o[R>>2]|0)|0))*(+G[N>>3]+ +G[N+8>>3])))%+(v|0))>>>0<<2)|0,v=o[g>>2]|0;t:do if(v|0){if(E=N+32|0,(v|0)==(N|0))o[g>>2]=o[E>>2];else{if(v=v+32|0,g=o[v>>2]|0,!g)break;for(;(g|0)!=(N|0);)if(v=g+32|0,g=o[v>>2]|0,!g)break t;o[v>>2]=o[E>>2]}l(N),o[O>>2]=(o[O>>2]|0)+-1}while(0)}l(o[m>>2]|0)}function Hs(m){m=m|0;var g=0,v=0,E=0;for(E=o[m+4>>2]|0,v=0;;){if((v|0)>=(E|0)){g=0,v=4;break}if(g=o[(o[m>>2]|0)+(v<<2)>>2]|0,!g)v=v+1|0;else{v=4;break}}return(v|0)==4?g|0:0}function St(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0;if(v=~~(+ke(+(+at(10,+ +(15-(o[m+12>>2]|0)|0))*(+G[g>>3]+ +G[g+8>>3])))%+(o[m+4>>2]|0))>>>0,v=(o[m>>2]|0)+(v<<2)|0,E=o[v>>2]|0,!E)return R=1,R|0;R=g+32|0;do if((E|0)!=(g|0)){if(v=o[E+32>>2]|0,!v)return R=1,R|0;for(C=v;;){if((C|0)==(g|0)){C=8;break}if(v=o[C+32>>2]|0,v)E=C,C=v;else{v=1,C=10;break}}if((C|0)==8){o[E+32>>2]=o[R>>2];break}else if((C|0)==10)return v|0}else o[v>>2]=o[R>>2];while(0);return l(g),R=m+8|0,o[R>>2]=(o[R>>2]|0)+-1,R=0,R|0}function Ct(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0;R=_(40)|0,R||An(23390,23360,98,23403),o[R>>2]=o[g>>2],o[R+4>>2]=o[g+4>>2],o[R+8>>2]=o[g+8>>2],o[R+12>>2]=o[g+12>>2],C=R+16|0,o[C>>2]=o[v>>2],o[C+4>>2]=o[v+4>>2],o[C+8>>2]=o[v+8>>2],o[C+12>>2]=o[v+12>>2],o[R+32>>2]=0,C=~~(+ke(+(+at(10,+ +(15-(o[m+12>>2]|0)|0))*(+G[g>>3]+ +G[g+8>>3])))%+(o[m+4>>2]|0))>>>0,C=(o[m>>2]|0)+(C<<2)|0,E=o[C>>2]|0;do if(!E)o[C>>2]=R;else{for(;!(bs(E,g)|0&&bs(E+16|0,v)|0);)if(C=o[E+32>>2]|0,E=C|0?C:E,!(o[E+32>>2]|0)){O=10;break}if((O|0)==10){o[E+32>>2]=R;break}return l(R),O=E,O|0}while(0);return O=m+8|0,o[O>>2]=(o[O>>2]|0)+1,O=R,O|0}function Vi(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0;if(C=~~(+ke(+(+at(10,+ +(15-(o[m+12>>2]|0)|0))*(+G[g>>3]+ +G[g+8>>3])))%+(o[m+4>>2]|0))>>>0,C=o[(o[m>>2]|0)+(C<<2)>>2]|0,!C)return v=0,v|0;if(!v){for(m=C;;){if(bs(m,g)|0){E=10;break}if(m=o[m+32>>2]|0,!m){m=0,E=10;break}}if((E|0)==10)return m|0}for(m=C;;){if(bs(m,g)|0&&bs(m+16|0,v)|0){E=10;break}if(m=o[m+32>>2]|0,!m){m=0,E=10;break}}return(E|0)==10?m|0:0}function Ja(m,g){m=m|0,g=g|0;var v=0;if(v=~~(+ke(+(+at(10,+ +(15-(o[m+12>>2]|0)|0))*(+G[g>>3]+ +G[g+8>>3])))%+(o[m+4>>2]|0))>>>0,m=o[(o[m>>2]|0)+(v<<2)>>2]|0,!m)return v=0,v|0;for(;;){if(bs(m,g)|0){g=5;break}if(m=o[m+32>>2]|0,!m){m=0,g=5;break}}return(g|0)==5?m|0:0}function Ws(){return 23424}function k(m){return m=+m,+ +Ue(+m)}function c(m){return m=+m,~~+k(m)|0}function _(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0,Ze=0,ct=0,At=0,it=0,rt=0,Xe=0,Vt=0;Vt=we,we=we+16|0,Re=Vt;do if(m>>>0<245){if(J=m>>>0<11?16:m+11&-8,m=J>>>3,fe=o[5857]|0,v=fe>>>m,v&3|0)return g=(v&1^1)+m|0,m=23468+(g<<1<<2)|0,v=m+8|0,E=o[v>>2]|0,C=E+8|0,R=o[C>>2]|0,(R|0)==(m|0)?o[5857]=fe&~(1<<g):(o[R+12>>2]=m,o[v>>2]=R),Xe=g<<3,o[E+4>>2]=Xe|3,Xe=E+Xe+4|0,o[Xe>>2]=o[Xe>>2]|1,Xe=C,we=Vt,Xe|0;if(le=o[5859]|0,J>>>0>le>>>0){if(v|0)return g=2<<m,g=v<<m&(g|0-g),g=(g&0-g)+-1|0,N=g>>>12&16,g=g>>>N,v=g>>>5&8,g=g>>>v,R=g>>>2&4,g=g>>>R,m=g>>>1&2,g=g>>>m,E=g>>>1&1,E=(v|N|R|m|E)+(g>>>E)|0,g=23468+(E<<1<<2)|0,m=g+8|0,R=o[m>>2]|0,N=R+8|0,v=o[N>>2]|0,(v|0)==(g|0)?(m=fe&~(1<<E),o[5857]=m):(o[v+12>>2]=g,o[m>>2]=v,m=fe),Xe=E<<3,O=Xe-J|0,o[R+4>>2]=J|3,C=R+J|0,o[C+4>>2]=O|1,o[R+Xe>>2]=O,le|0&&(E=o[5862]|0,g=le>>>3,v=23468+(g<<1<<2)|0,g=1<<g,m&g?(m=v+8|0,g=o[m>>2]|0):(o[5857]=m|g,g=v,m=v+8|0),o[m>>2]=E,o[g+12>>2]=E,o[E+8>>2]=g,o[E+12>>2]=v),o[5859]=O,o[5862]=C,Xe=N,we=Vt,Xe|0;if(R=o[5858]|0,R){for(v=(R&0-R)+-1|0,C=v>>>12&16,v=v>>>C,E=v>>>5&8,v=v>>>E,O=v>>>2&4,v=v>>>O,N=v>>>1&2,v=v>>>N,W=v>>>1&1,W=o[23732+((E|C|O|N|W)+(v>>>W)<<2)>>2]|0,v=W,N=W,W=(o[W+4>>2]&-8)-J|0;m=o[v+16>>2]|0,!(!m&&(m=o[v+20>>2]|0,!m));)O=(o[m+4>>2]&-8)-J|0,C=O>>>0<W>>>0,v=m,N=C?m:N,W=C?O:W;if(O=N+J|0,O>>>0>N>>>0){C=o[N+24>>2]|0,g=o[N+12>>2]|0;do if((g|0)==(N|0)){if(m=N+20|0,g=o[m>>2]|0,!g&&(m=N+16|0,g=o[m>>2]|0,!g)){v=0;break}for(;;)if(E=g+20|0,v=o[E>>2]|0,v)g=v,m=E;else if(E=g+16|0,v=o[E>>2]|0,v)g=v,m=E;else break;o[m>>2]=0,v=g}else v=o[N+8>>2]|0,o[v+12>>2]=g,o[g+8>>2]=v,v=g;while(0);do if(C|0){if(g=o[N+28>>2]|0,m=23732+(g<<2)|0,(N|0)==(o[m>>2]|0)){if(o[m>>2]=v,!v){o[5858]=R&~(1<<g);break}}else if(Xe=C+16|0,o[((o[Xe>>2]|0)==(N|0)?Xe:C+20|0)>>2]=v,!v)break;o[v+24>>2]=C,g=o[N+16>>2]|0,g|0&&(o[v+16>>2]=g,o[g+24>>2]=v),g=o[N+20>>2]|0,g|0&&(o[v+20>>2]=g,o[g+24>>2]=v)}while(0);return W>>>0<16?(Xe=W+J|0,o[N+4>>2]=Xe|3,Xe=N+Xe+4|0,o[Xe>>2]=o[Xe>>2]|1):(o[N+4>>2]=J|3,o[O+4>>2]=W|1,o[O+W>>2]=W,le|0&&(E=o[5862]|0,g=le>>>3,v=23468+(g<<1<<2)|0,g=1<<g,g&fe?(m=v+8|0,g=o[m>>2]|0):(o[5857]=g|fe,g=v,m=v+8|0),o[m>>2]=E,o[g+12>>2]=E,o[E+8>>2]=g,o[E+12>>2]=v),o[5859]=W,o[5862]=O),Xe=N+8|0,we=Vt,Xe|0}else fe=J}else fe=J}else fe=J}else if(m>>>0<=4294967231)if(m=m+11|0,J=m&-8,E=o[5858]|0,E){C=0-J|0,m=m>>>8,m?J>>>0>16777215?W=31:(fe=(m+1048320|0)>>>16&8,Ze=m<<fe,N=(Ze+520192|0)>>>16&4,Ze=Ze<<N,W=(Ze+245760|0)>>>16&2,W=14-(N|fe|W)+(Ze<<W>>>15)|0,W=J>>>(W+7|0)&1|W<<1):W=0,v=o[23732+(W<<2)>>2]|0;e:do if(!v)v=0,m=0,Ze=61;else for(m=0,N=J<<((W|0)==31?0:25-(W>>>1)|0),R=0;;){if(O=(o[v+4>>2]&-8)-J|0,O>>>0<C>>>0)if(O)m=v,C=O;else{m=v,C=0,Ze=65;break e}if(Ze=o[v+20>>2]|0,v=o[v+16+(N>>>31<<2)>>2]|0,R=(Ze|0)==0|(Ze|0)==(v|0)?R:Ze,v)N=N<<1;else{v=R,Ze=61;break}}while(0);if((Ze|0)==61){if((v|0)==0&(m|0)==0){if(m=2<<W,m=(m|0-m)&E,!m){fe=J;break}fe=(m&0-m)+-1|0,O=fe>>>12&16,fe=fe>>>O,R=fe>>>5&8,fe=fe>>>R,N=fe>>>2&4,fe=fe>>>N,W=fe>>>1&2,fe=fe>>>W,v=fe>>>1&1,m=0,v=o[23732+((R|O|N|W|v)+(fe>>>v)<<2)>>2]|0}v?Ze=65:(N=m,O=C)}if((Ze|0)==65)for(R=v;;)if(fe=(o[R+4>>2]&-8)-J|0,v=fe>>>0<C>>>0,C=v?fe:C,m=v?R:m,v=o[R+16>>2]|0,v||(v=o[R+20>>2]|0),v)R=v;else{N=m,O=C;break}if(N|0&&O>>>0<((o[5859]|0)-J|0)>>>0&&(le=N+J|0,le>>>0>N>>>0)){R=o[N+24>>2]|0,g=o[N+12>>2]|0;do if((g|0)==(N|0)){if(m=N+20|0,g=o[m>>2]|0,!g&&(m=N+16|0,g=o[m>>2]|0,!g)){g=0;break}for(;;)if(C=g+20|0,v=o[C>>2]|0,v)g=v,m=C;else if(C=g+16|0,v=o[C>>2]|0,v)g=v,m=C;else break;o[m>>2]=0}else Xe=o[N+8>>2]|0,o[Xe+12>>2]=g,o[g+8>>2]=Xe;while(0);do if(R){if(m=o[N+28>>2]|0,v=23732+(m<<2)|0,(N|0)==(o[v>>2]|0)){if(o[v>>2]=g,!g){E=E&~(1<<m),o[5858]=E;break}}else if(Xe=R+16|0,o[((o[Xe>>2]|0)==(N|0)?Xe:R+20|0)>>2]=g,!g)break;o[g+24>>2]=R,m=o[N+16>>2]|0,m|0&&(o[g+16>>2]=m,o[m+24>>2]=g),m=o[N+20>>2]|0,m&&(o[g+20>>2]=m,o[m+24>>2]=g)}while(0);e:do if(O>>>0<16)Xe=O+J|0,o[N+4>>2]=Xe|3,Xe=N+Xe+4|0,o[Xe>>2]=o[Xe>>2]|1;else{if(o[N+4>>2]=J|3,o[le+4>>2]=O|1,o[le+O>>2]=O,g=O>>>3,O>>>0<256){v=23468+(g<<1<<2)|0,m=o[5857]|0,g=1<<g,m&g?(m=v+8|0,g=o[m>>2]|0):(o[5857]=m|g,g=v,m=v+8|0),o[m>>2]=le,o[g+12>>2]=le,o[le+8>>2]=g,o[le+12>>2]=v;break}if(g=O>>>8,g?O>>>0>16777215?v=31:(rt=(g+1048320|0)>>>16&8,Xe=g<<rt,it=(Xe+520192|0)>>>16&4,Xe=Xe<<it,v=(Xe+245760|0)>>>16&2,v=14-(it|rt|v)+(Xe<<v>>>15)|0,v=O>>>(v+7|0)&1|v<<1):v=0,g=23732+(v<<2)|0,o[le+28>>2]=v,m=le+16|0,o[m+4>>2]=0,o[m>>2]=0,m=1<<v,!(E&m)){o[5858]=E|m,o[g>>2]=le,o[le+24>>2]=g,o[le+12>>2]=le,o[le+8>>2]=le;break}g=o[g>>2]|0;t:do if((o[g+4>>2]&-8|0)!=(O|0)){for(E=O<<((v|0)==31?0:25-(v>>>1)|0);v=g+16+(E>>>31<<2)|0,m=o[v>>2]|0,!!m;)if((o[m+4>>2]&-8|0)==(O|0)){g=m;break t}else E=E<<1,g=m;o[v>>2]=le,o[le+24>>2]=g,o[le+12>>2]=le,o[le+8>>2]=le;break e}while(0);rt=g+8|0,Xe=o[rt>>2]|0,o[Xe+12>>2]=le,o[rt>>2]=le,o[le+8>>2]=Xe,o[le+12>>2]=g,o[le+24>>2]=0}while(0);return Xe=N+8|0,we=Vt,Xe|0}else fe=J}else fe=J;else fe=-1;while(0);if(v=o[5859]|0,v>>>0>=fe>>>0)return g=v-fe|0,m=o[5862]|0,g>>>0>15?(Xe=m+fe|0,o[5862]=Xe,o[5859]=g,o[Xe+4>>2]=g|1,o[m+v>>2]=g,o[m+4>>2]=fe|3):(o[5859]=0,o[5862]=0,o[m+4>>2]=v|3,Xe=m+v+4|0,o[Xe>>2]=o[Xe>>2]|1),Xe=m+8|0,we=Vt,Xe|0;if(O=o[5860]|0,O>>>0>fe>>>0)return it=O-fe|0,o[5860]=it,Xe=o[5863]|0,rt=Xe+fe|0,o[5863]=rt,o[rt+4>>2]=it|1,o[Xe+4>>2]=fe|3,Xe=Xe+8|0,we=Vt,Xe|0;if(o[5975]|0?m=o[5977]|0:(o[5977]=4096,o[5976]=4096,o[5978]=-1,o[5979]=-1,o[5980]=0,o[5968]=0,o[5975]=Re&-16^1431655768,m=4096),N=fe+48|0,W=fe+47|0,R=m+W|0,C=0-m|0,J=R&C,J>>>0<=fe>>>0||(m=o[5967]|0,m|0&&(le=o[5965]|0,Re=le+J|0,Re>>>0<=le>>>0|Re>>>0>m>>>0)))return Xe=0,we=Vt,Xe|0;e:do if(o[5968]&4)g=0,Ze=143;else{v=o[5863]|0;t:do if(v){for(E=23876;Re=o[E>>2]|0,!(Re>>>0<=v>>>0&&(Re+(o[E+4>>2]|0)|0)>>>0>v>>>0);)if(m=o[E+8>>2]|0,m)E=m;else{Ze=128;break t}if(g=R-O&C,g>>>0<2147483647)if(m=xe(g|0)|0,(m|0)==((o[E>>2]|0)+(o[E+4>>2]|0)|0)){if((m|0)!=-1){O=g,R=m,Ze=145;break e}}else E=m,Ze=136;else g=0}else Ze=128;while(0);do if((Ze|0)==128)if(v=xe(0)|0,(v|0)!=-1&&(g=v,je=o[5976]|0,Be=je+-1|0,g=(Be&g|0?(Be+g&0-je)-g|0:0)+J|0,je=o[5965]|0,Be=g+je|0,g>>>0>fe>>>0&g>>>0<2147483647)){if(Re=o[5967]|0,Re|0&&Be>>>0<=je>>>0|Be>>>0>Re>>>0){g=0;break}if(m=xe(g|0)|0,(m|0)==(v|0)){O=g,R=v,Ze=145;break e}else E=m,Ze=136}else g=0;while(0);do if((Ze|0)==136){if(v=0-g|0,!(N>>>0>g>>>0&(g>>>0<2147483647&(E|0)!=-1)))if((E|0)==-1){g=0;break}else{O=g,R=E,Ze=145;break e}if(m=o[5977]|0,m=W-g+m&0-m,m>>>0>=2147483647){O=g,R=E,Ze=145;break e}if((xe(m|0)|0)==-1){xe(v|0)|0,g=0;break}else{O=m+g|0,R=E,Ze=145;break e}}while(0);o[5968]=o[5968]|4,Ze=143}while(0);if((Ze|0)==143&&J>>>0<2147483647&&(it=xe(J|0)|0,Be=xe(0)|0,ct=Be-it|0,At=ct>>>0>(fe+40|0)>>>0,!((it|0)==-1|At^1|it>>>0<Be>>>0&((it|0)!=-1&(Be|0)!=-1)^1))&&(O=At?ct:g,R=it,Ze=145),(Ze|0)==145){g=(o[5965]|0)+O|0,o[5965]=g,g>>>0>(o[5966]|0)>>>0&&(o[5966]=g),W=o[5863]|0;e:do if(W){for(g=23876;;){if(m=o[g>>2]|0,v=o[g+4>>2]|0,(R|0)==(m+v|0)){Ze=154;break}if(E=o[g+8>>2]|0,E)g=E;else break}if((Ze|0)==154&&(rt=g+4|0,(o[g+12>>2]&8|0)==0)&&R>>>0>W>>>0&m>>>0<=W>>>0){o[rt>>2]=v+O,Xe=(o[5860]|0)+O|0,it=W+8|0,it=it&7|0?0-it&7:0,rt=W+it|0,it=Xe-it|0,o[5863]=rt,o[5860]=it,o[rt+4>>2]=it|1,o[W+Xe+4>>2]=40,o[5864]=o[5979];break}for(R>>>0<(o[5861]|0)>>>0&&(o[5861]=R),v=R+O|0,g=23876;;){if((o[g>>2]|0)==(v|0)){Ze=162;break}if(m=o[g+8>>2]|0,m)g=m;else break}if((Ze|0)==162&&!(o[g+12>>2]&8|0)){o[g>>2]=R,le=g+4|0,o[le>>2]=(o[le>>2]|0)+O,le=R+8|0,le=R+(le&7|0?0-le&7:0)|0,g=v+8|0,g=v+(g&7|0?0-g&7:0)|0,J=le+fe|0,N=g-le-fe|0,o[le+4>>2]=fe|3;t:do if((W|0)==(g|0))Xe=(o[5860]|0)+N|0,o[5860]=Xe,o[5863]=J,o[J+4>>2]=Xe|1;else{if((o[5862]|0)==(g|0)){Xe=(o[5859]|0)+N|0,o[5859]=Xe,o[5862]=J,o[J+4>>2]=Xe|1,o[J+Xe>>2]=Xe;break}if(m=o[g+4>>2]|0,(m&3|0)==1){O=m&-8,E=m>>>3;n:do if(m>>>0<256)if(m=o[g+8>>2]|0,v=o[g+12>>2]|0,(v|0)==(m|0)){o[5857]=o[5857]&~(1<<E);break}else{o[m+12>>2]=v,o[v+8>>2]=m;break}else{R=o[g+24>>2]|0,m=o[g+12>>2]|0;do if((m|0)==(g|0)){if(v=g+16|0,E=v+4|0,m=o[E>>2]|0,m)v=E;else if(m=o[v>>2]|0,!m){m=0;break}for(;;)if(C=m+20|0,E=o[C>>2]|0,E)m=E,v=C;else if(C=m+16|0,E=o[C>>2]|0,E)m=E,v=C;else break;o[v>>2]=0}else Xe=o[g+8>>2]|0,o[Xe+12>>2]=m,o[m+8>>2]=Xe;while(0);if(!R)break;v=o[g+28>>2]|0,E=23732+(v<<2)|0;do if((o[E>>2]|0)!=(g|0)){if(Xe=R+16|0,o[((o[Xe>>2]|0)==(g|0)?Xe:R+20|0)>>2]=m,!m)break n}else{if(o[E>>2]=m,m|0)break;o[5858]=o[5858]&~(1<<v);break n}while(0);if(o[m+24>>2]=R,v=g+16|0,E=o[v>>2]|0,E|0&&(o[m+16>>2]=E,o[E+24>>2]=m),v=o[v+4>>2]|0,!v)break;o[m+20>>2]=v,o[v+24>>2]=m}while(0);g=g+O|0,C=O+N|0}else C=N;if(g=g+4|0,o[g>>2]=o[g>>2]&-2,o[J+4>>2]=C|1,o[J+C>>2]=C,g=C>>>3,C>>>0<256){v=23468+(g<<1<<2)|0,m=o[5857]|0,g=1<<g,m&g?(m=v+8|0,g=o[m>>2]|0):(o[5857]=m|g,g=v,m=v+8|0),o[m>>2]=J,o[g+12>>2]=J,o[J+8>>2]=g,o[J+12>>2]=v;break}g=C>>>8;do if(!g)E=0;else{if(C>>>0>16777215){E=31;break}rt=(g+1048320|0)>>>16&8,Xe=g<<rt,it=(Xe+520192|0)>>>16&4,Xe=Xe<<it,E=(Xe+245760|0)>>>16&2,E=14-(it|rt|E)+(Xe<<E>>>15)|0,E=C>>>(E+7|0)&1|E<<1}while(0);if(g=23732+(E<<2)|0,o[J+28>>2]=E,m=J+16|0,o[m+4>>2]=0,o[m>>2]=0,m=o[5858]|0,v=1<<E,!(m&v)){o[5858]=m|v,o[g>>2]=J,o[J+24>>2]=g,o[J+12>>2]=J,o[J+8>>2]=J;break}g=o[g>>2]|0;n:do if((o[g+4>>2]&-8|0)!=(C|0)){for(E=C<<((E|0)==31?0:25-(E>>>1)|0);v=g+16+(E>>>31<<2)|0,m=o[v>>2]|0,!!m;)if((o[m+4>>2]&-8|0)==(C|0)){g=m;break n}else E=E<<1,g=m;o[v>>2]=J,o[J+24>>2]=g,o[J+12>>2]=J,o[J+8>>2]=J;break t}while(0);rt=g+8|0,Xe=o[rt>>2]|0,o[Xe+12>>2]=J,o[rt>>2]=J,o[J+8>>2]=Xe,o[J+12>>2]=g,o[J+24>>2]=0}while(0);return Xe=le+8|0,we=Vt,Xe|0}for(g=23876;m=o[g>>2]|0,!(m>>>0<=W>>>0&&(Xe=m+(o[g+4>>2]|0)|0,Xe>>>0>W>>>0));)g=o[g+8>>2]|0;C=Xe+-47|0,m=C+8|0,m=C+(m&7|0?0-m&7:0)|0,C=W+16|0,m=m>>>0<C>>>0?W:m,g=m+8|0,v=O+-40|0,it=R+8|0,it=it&7|0?0-it&7:0,rt=R+it|0,it=v-it|0,o[5863]=rt,o[5860]=it,o[rt+4>>2]=it|1,o[R+v+4>>2]=40,o[5864]=o[5979],v=m+4|0,o[v>>2]=27,o[g>>2]=o[5969],o[g+4>>2]=o[5970],o[g+8>>2]=o[5971],o[g+12>>2]=o[5972],o[5969]=R,o[5970]=O,o[5972]=0,o[5971]=g,g=m+24|0;do rt=g,g=g+4|0,o[g>>2]=7;while((rt+8|0)>>>0<Xe>>>0);if((m|0)!=(W|0)){if(R=m-W|0,o[v>>2]=o[v>>2]&-2,o[W+4>>2]=R|1,o[m>>2]=R,g=R>>>3,R>>>0<256){v=23468+(g<<1<<2)|0,m=o[5857]|0,g=1<<g,m&g?(m=v+8|0,g=o[m>>2]|0):(o[5857]=m|g,g=v,m=v+8|0),o[m>>2]=W,o[g+12>>2]=W,o[W+8>>2]=g,o[W+12>>2]=v;break}if(g=R>>>8,g?R>>>0>16777215?E=31:(rt=(g+1048320|0)>>>16&8,Xe=g<<rt,it=(Xe+520192|0)>>>16&4,Xe=Xe<<it,E=(Xe+245760|0)>>>16&2,E=14-(it|rt|E)+(Xe<<E>>>15)|0,E=R>>>(E+7|0)&1|E<<1):E=0,v=23732+(E<<2)|0,o[W+28>>2]=E,o[W+20>>2]=0,o[C>>2]=0,g=o[5858]|0,m=1<<E,!(g&m)){o[5858]=g|m,o[v>>2]=W,o[W+24>>2]=v,o[W+12>>2]=W,o[W+8>>2]=W;break}g=o[v>>2]|0;t:do if((o[g+4>>2]&-8|0)!=(R|0)){for(E=R<<((E|0)==31?0:25-(E>>>1)|0);v=g+16+(E>>>31<<2)|0,m=o[v>>2]|0,!!m;)if((o[m+4>>2]&-8|0)==(R|0)){g=m;break t}else E=E<<1,g=m;o[v>>2]=W,o[W+24>>2]=g,o[W+12>>2]=W,o[W+8>>2]=W;break e}while(0);rt=g+8|0,Xe=o[rt>>2]|0,o[Xe+12>>2]=W,o[rt>>2]=W,o[W+8>>2]=Xe,o[W+12>>2]=g,o[W+24>>2]=0}}else Xe=o[5861]|0,(Xe|0)==0|R>>>0<Xe>>>0&&(o[5861]=R),o[5969]=R,o[5970]=O,o[5972]=0,o[5866]=o[5975],o[5865]=-1,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,o[5906]=23612,o[5905]=23612,o[5908]=23620,o[5907]=23620,o[5910]=23628,o[5909]=23628,o[5912]=23636,o[5911]=23636,o[5914]=23644,o[5913]=23644,o[5916]=23652,o[5915]=23652,o[5918]=23660,o[5917]=23660,o[5920]=23668,o[5919]=23668,o[5922]=23676,o[5921]=23676,o[5924]=23684,o[5923]=23684,o[5926]=23692,o[5925]=23692,o[5928]=23700,o[5927]=23700,o[5930]=23708,o[5929]=23708,o[5932]=23716,o[5931]=23716,Xe=O+-40|0,it=R+8|0,it=it&7|0?0-it&7:0,rt=R+it|0,it=Xe-it|0,o[5863]=rt,o[5860]=it,o[rt+4>>2]=it|1,o[R+Xe+4>>2]=40,o[5864]=o[5979];while(0);if(g=o[5860]|0,g>>>0>fe>>>0)return it=g-fe|0,o[5860]=it,Xe=o[5863]|0,rt=Xe+fe|0,o[5863]=rt,o[rt+4>>2]=it|1,o[Xe+4>>2]=fe|3,Xe=Xe+8|0,we=Vt,Xe|0}return Xe=Ws()|0,o[Xe>>2]=12,Xe=0,we=Vt,Xe|0}function l(m){m=m|0;var g=0,v=0,E=0,C=0,R=0,O=0,N=0,W=0;if(m){v=m+-8|0,C=o[5861]|0,m=o[m+-4>>2]|0,g=m&-8,W=v+g|0;do if(m&1)N=v,O=v;else{if(E=o[v>>2]|0,!(m&3)||(O=v+(0-E)|0,R=E+g|0,O>>>0<C>>>0))return;if((o[5862]|0)==(O|0)){if(m=W+4|0,g=o[m>>2]|0,(g&3|0)!=3){N=O,g=R;break}o[5859]=R,o[m>>2]=g&-2,o[O+4>>2]=R|1,o[O+R>>2]=R;return}if(v=E>>>3,E>>>0<256)if(m=o[O+8>>2]|0,g=o[O+12>>2]|0,(g|0)==(m|0)){o[5857]=o[5857]&~(1<<v),N=O,g=R;break}else{o[m+12>>2]=g,o[g+8>>2]=m,N=O,g=R;break}C=o[O+24>>2]|0,m=o[O+12>>2]|0;do if((m|0)==(O|0)){if(g=O+16|0,v=g+4|0,m=o[v>>2]|0,m)g=v;else if(m=o[g>>2]|0,!m){m=0;break}for(;;)if(E=m+20|0,v=o[E>>2]|0,v)m=v,g=E;else if(E=m+16|0,v=o[E>>2]|0,v)m=v,g=E;else break;o[g>>2]=0}else N=o[O+8>>2]|0,o[N+12>>2]=m,o[m+8>>2]=N;while(0);if(C){if(g=o[O+28>>2]|0,v=23732+(g<<2)|0,(o[v>>2]|0)==(O|0)){if(o[v>>2]=m,!m){o[5858]=o[5858]&~(1<<g),N=O,g=R;break}}else if(N=C+16|0,o[((o[N>>2]|0)==(O|0)?N:C+20|0)>>2]=m,!m){N=O,g=R;break}o[m+24>>2]=C,g=O+16|0,v=o[g>>2]|0,v|0&&(o[m+16>>2]=v,o[v+24>>2]=m),g=o[g+4>>2]|0,g?(o[m+20>>2]=g,o[g+24>>2]=m,N=O,g=R):(N=O,g=R)}else N=O,g=R}while(0);if(!(O>>>0>=W>>>0)&&(m=W+4|0,E=o[m>>2]|0,!!(E&1))){if(E&2)o[m>>2]=E&-2,o[N+4>>2]=g|1,o[O+g>>2]=g,C=g;else{if((o[5863]|0)==(W|0)){if(W=(o[5860]|0)+g|0,o[5860]=W,o[5863]=N,o[N+4>>2]=W|1,(N|0)!=(o[5862]|0))return;o[5862]=0,o[5859]=0;return}if((o[5862]|0)==(W|0)){W=(o[5859]|0)+g|0,o[5859]=W,o[5862]=O,o[N+4>>2]=W|1,o[O+W>>2]=W;return}C=(E&-8)+g|0,v=E>>>3;do if(E>>>0<256)if(g=o[W+8>>2]|0,m=o[W+12>>2]|0,(m|0)==(g|0)){o[5857]=o[5857]&~(1<<v);break}else{o[g+12>>2]=m,o[m+8>>2]=g;break}else{R=o[W+24>>2]|0,m=o[W+12>>2]|0;do if((m|0)==(W|0)){if(g=W+16|0,v=g+4|0,m=o[v>>2]|0,m)g=v;else if(m=o[g>>2]|0,!m){v=0;break}for(;;)if(E=m+20|0,v=o[E>>2]|0,v)m=v,g=E;else if(E=m+16|0,v=o[E>>2]|0,v)m=v,g=E;else break;o[g>>2]=0,v=m}else v=o[W+8>>2]|0,o[v+12>>2]=m,o[m+8>>2]=v,v=m;while(0);if(R|0){if(m=o[W+28>>2]|0,g=23732+(m<<2)|0,(o[g>>2]|0)==(W|0)){if(o[g>>2]=v,!v){o[5858]=o[5858]&~(1<<m);break}}else if(E=R+16|0,o[((o[E>>2]|0)==(W|0)?E:R+20|0)>>2]=v,!v)break;o[v+24>>2]=R,m=W+16|0,g=o[m>>2]|0,g|0&&(o[v+16>>2]=g,o[g+24>>2]=v),m=o[m+4>>2]|0,m|0&&(o[v+20>>2]=m,o[m+24>>2]=v)}}while(0);if(o[N+4>>2]=C|1,o[O+C>>2]=C,(N|0)==(o[5862]|0)){o[5859]=C;return}}if(m=C>>>3,C>>>0<256){v=23468+(m<<1<<2)|0,g=o[5857]|0,m=1<<m,g&m?(g=v+8|0,m=o[g>>2]|0):(o[5857]=g|m,m=v,g=v+8|0),o[g>>2]=N,o[m+12>>2]=N,o[N+8>>2]=m,o[N+12>>2]=v;return}m=C>>>8,m?C>>>0>16777215?E=31:(O=(m+1048320|0)>>>16&8,W=m<<O,R=(W+520192|0)>>>16&4,W=W<<R,E=(W+245760|0)>>>16&2,E=14-(R|O|E)+(W<<E>>>15)|0,E=C>>>(E+7|0)&1|E<<1):E=0,m=23732+(E<<2)|0,o[N+28>>2]=E,o[N+20>>2]=0,o[N+16>>2]=0,g=o[5858]|0,v=1<<E;e:do if(!(g&v))o[5858]=g|v,o[m>>2]=N,o[N+24>>2]=m,o[N+12>>2]=N,o[N+8>>2]=N;else{m=o[m>>2]|0;t:do if((o[m+4>>2]&-8|0)!=(C|0)){for(E=C<<((E|0)==31?0:25-(E>>>1)|0);v=m+16+(E>>>31<<2)|0,g=o[v>>2]|0,!!g;)if((o[g+4>>2]&-8|0)==(C|0)){m=g;break t}else E=E<<1,m=g;o[v>>2]=N,o[N+24>>2]=m,o[N+12>>2]=N,o[N+8>>2]=N;break e}while(0);O=m+8|0,W=o[O>>2]|0,o[W+12>>2]=N,o[O>>2]=N,o[N+8>>2]=W,o[N+12>>2]=m,o[N+24>>2]=0}while(0);if(W=(o[5865]|0)+-1|0,o[5865]=W,!(W|0)){for(m=23884;m=o[m>>2]|0,m;)m=m+8|0;o[5865]=-1}}}}function h(m,g){m=m|0,g=g|0;var v=0;return m?(v=on(g,m)|0,(g|m)>>>0>65535&&(v=((v>>>0)/(m>>>0)|0|0)==(g|0)?v:-1)):v=0,m=_(v)|0,!m||!(o[m+-4>>2]&3)||Te(m|0,0,v|0)|0,m|0}function d(m,g,v,E){return m=m|0,g=g|0,v=v|0,E=E|0,v=m+v>>>0,Mt(g+E+(v>>>0<m>>>0|0)>>>0|0),v|0|0}function x(m,g,v,E){return m=m|0,g=g|0,v=v|0,E=E|0,E=g-E-(v>>>0>m>>>0|0)>>>0,Mt(E|0),m-v>>>0|0|0}function b(m){return m=m|0,(m?31-(Oe(m^m-1)|0)|0:32)|0}function S(m,g,v,E,C){m=m|0,g=g|0,v=v|0,E=E|0,C=C|0;var R=0,O=0,N=0,W=0,J=0,le=0,fe=0,Re=0,je=0,Be=0;if(le=m,W=g,J=W,O=v,Re=E,N=Re,!J)return R=(C|0)!=0,N?R?(o[C>>2]=m|0,o[C+4>>2]=g&0,Re=0,C=0,Mt(Re|0),C|0):(Re=0,C=0,Mt(Re|0),C|0):(R&&(o[C>>2]=(le>>>0)%(O>>>0),o[C+4>>2]=0),Re=0,C=(le>>>0)/(O>>>0)>>>0,Mt(Re|0),C|0);R=(N|0)==0;do if(O){if(!R){if(R=(Oe(N|0)|0)-(Oe(J|0)|0)|0,R>>>0<=31){fe=R+1|0,N=31-R|0,g=R-31>>31,O=fe,m=le>>>(fe>>>0)&g|J<<N,g=J>>>(fe>>>0)&g,R=0,N=le<<N;break}return C?(o[C>>2]=m|0,o[C+4>>2]=W|g&0,Re=0,C=0,Mt(Re|0),C|0):(Re=0,C=0,Mt(Re|0),C|0)}if(R=O-1|0,R&O|0){N=(Oe(O|0)|0)+33-(Oe(J|0)|0)|0,Be=64-N|0,fe=32-N|0,W=fe>>31,je=N-32|0,g=je>>31,O=N,m=fe-1>>31&J>>>(je>>>0)|(J<<fe|le>>>(N>>>0))&g,g=g&J>>>(N>>>0),R=le<<Be&W,N=(J<<Be|le>>>(je>>>0))&W|le<<fe&N-33>>31;break}return C|0&&(o[C>>2]=R&le,o[C+4>>2]=0),(O|0)==1?(je=W|g&0,Be=m|0|0,Mt(je|0),Be|0):(Be=b(O|0)|0,je=J>>>(Be>>>0)|0,Be=J<<32-Be|le>>>(Be>>>0)|0,Mt(je|0),Be|0)}else{if(R)return C|0&&(o[C>>2]=(J>>>0)%(O>>>0),o[C+4>>2]=0),je=0,Be=(J>>>0)/(O>>>0)>>>0,Mt(je|0),Be|0;if(!le)return C|0&&(o[C>>2]=0,o[C+4>>2]=(J>>>0)%(N>>>0)),je=0,Be=(J>>>0)/(N>>>0)>>>0,Mt(je|0),Be|0;if(R=N-1|0,!(R&N))return C|0&&(o[C>>2]=m|0,o[C+4>>2]=R&J|g&0),je=0,Be=J>>>((b(N|0)|0)>>>0),Mt(je|0),Be|0;if(R=(Oe(N|0)|0)-(Oe(J|0)|0)|0,R>>>0<=30){g=R+1|0,N=31-R|0,O=g,m=J<<N|le>>>(g>>>0),g=J>>>(g>>>0),R=0,N=le<<N;break}return C?(o[C>>2]=m|0,o[C+4>>2]=W|g&0,je=0,Be=0,Mt(je|0),Be|0):(je=0,Be=0,Mt(je|0),Be|0)}while(0);if(!O)J=N,W=0,N=0;else{fe=v|0|0,le=Re|E&0,J=d(fe|0,le|0,-1,-1)|0,v=Se()|0,W=N,N=0;do E=W,W=R>>>31|W<<1,R=N|R<<1,E=m<<1|E>>>31|0,Re=m>>>31|g<<1|0,x(J|0,v|0,E|0,Re|0)|0,Be=Se()|0,je=Be>>31|((Be|0)<0?-1:0)<<1,N=je&1,m=x(E|0,Re|0,je&fe|0,(((Be|0)<0?-1:0)>>31|((Be|0)<0?-1:0)<<1)&le|0)|0,g=Se()|0,O=O-1|0;while(O|0);J=W,W=0}return O=0,C|0&&(o[C>>2]=m,o[C+4>>2]=g),je=(R|0)>>>31|(J|O)<<1|(O<<1|R>>>31)&0|W,Be=(R<<1|0)&-2|N,Mt(je|0),Be|0}function M(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0,J=0;return J=g>>31|((g|0)<0?-1:0)<<1,W=((g|0)<0?-1:0)>>31|((g|0)<0?-1:0)<<1,R=E>>31|((E|0)<0?-1:0)<<1,C=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,N=x(J^m|0,W^g|0,J|0,W|0)|0,O=Se()|0,m=R^J,g=C^W,x((S(N,O,x(R^v|0,C^E|0,R|0,C|0)|0,Se()|0,0)|0)^m|0,(Se()|0)^g|0,m|0,g|0)|0}function B(m,g){m=m|0,g=g|0;var v=0,E=0,C=0,R=0;return R=m&65535,C=g&65535,v=on(C,R)|0,E=m>>>16,m=(v>>>16)+(on(C,E)|0)|0,C=g>>>16,g=on(C,R)|0,Mt((m>>>16)+(on(C,E)|0)+(((m&65535)+g|0)>>>16)|0),m+g<<16|v&65535|0|0}function V(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0;return C=m,R=v,v=B(C,R)|0,m=Se()|0,Mt((on(g,R)|0)+(on(E,C)|0)+m|m&0|0),v|0|0|0}function $(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0,O=0,N=0,W=0,J=0;return C=we,we=we+16|0,N=C|0,O=g>>31|((g|0)<0?-1:0)<<1,R=((g|0)<0?-1:0)>>31|((g|0)<0?-1:0)<<1,J=E>>31|((E|0)<0?-1:0)<<1,W=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,m=x(O^m|0,R^g|0,O|0,R|0)|0,g=Se()|0,S(m,g,x(J^v|0,W^E|0,J|0,W|0)|0,Se()|0,N)|0,E=x(o[N>>2]^O|0,o[N+4>>2]^R|0,O|0,R|0)|0,v=Se()|0,we=C,Mt(v|0),E|0}function X(m,g,v,E){m=m|0,g=g|0,v=v|0,E=E|0;var C=0,R=0;return R=we,we=we+16|0,C=R|0,S(m,g,v,E,C)|0,we=R,Mt(o[C+4>>2]|0),o[C>>2]|0|0}function se(m,g,v){return m=m|0,g=g|0,v=v|0,(v|0)<32?(Mt(g>>v|0),m>>>v|(g&(1<<v)-1)<<32-v):(Mt(((g|0)<0?-1:0)|0),g>>v-32|0)}function ne(m,g,v){return m=m|0,g=g|0,v=v|0,(v|0)<32?(Mt(g>>>v|0),m>>>v|(g&(1<<v)-1)<<32-v):(Mt(0),g>>>v-32|0)}function ue(m,g,v){return m=m|0,g=g|0,v=v|0,(v|0)<32?(Mt(g<<v|(m&(1<<v)-1<<32-v)>>>32-v|0),m<<v):(Mt(m<<v-32|0),0)}function be(m,g){return m=+m,g=+g,m!=m?+g:g!=g?+m:+Ot(+m,+g)}function Ce(m,g){return m=+m,g=+g,m!=m?+g:g!=g?+m:+vn(+m,+g)}function _e(m){return m=+m,m>=0?+Pe(m+.5):+Qt(m-.5)}function Ge(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0;if((v|0)>=8192)return la(m|0,g|0,v|0)|0,m|0;if(R=m|0,C=m+v|0,(m&3)==(g&3)){for(;m&3;){if(!v)return R|0;he[m>>0]=he[g>>0]|0,m=m+1|0,g=g+1|0,v=v-1|0}for(v=C&-4|0,E=v-64|0;(m|0)<=(E|0);)o[m>>2]=o[g>>2],o[m+4>>2]=o[g+4>>2],o[m+8>>2]=o[g+8>>2],o[m+12>>2]=o[g+12>>2],o[m+16>>2]=o[g+16>>2],o[m+20>>2]=o[g+20>>2],o[m+24>>2]=o[g+24>>2],o[m+28>>2]=o[g+28>>2],o[m+32>>2]=o[g+32>>2],o[m+36>>2]=o[g+36>>2],o[m+40>>2]=o[g+40>>2],o[m+44>>2]=o[g+44>>2],o[m+48>>2]=o[g+48>>2],o[m+52>>2]=o[g+52>>2],o[m+56>>2]=o[g+56>>2],o[m+60>>2]=o[g+60>>2],m=m+64|0,g=g+64|0;for(;(m|0)<(v|0);)o[m>>2]=o[g>>2],m=m+4|0,g=g+4|0}else for(v=C-4|0;(m|0)<(v|0);)he[m>>0]=he[g>>0]|0,he[m+1>>0]=he[g+1>>0]|0,he[m+2>>0]=he[g+2>>0]|0,he[m+3>>0]=he[g+3>>0]|0,m=m+4|0,g=g+4|0;for(;(m|0)<(C|0);)he[m>>0]=he[g>>0]|0,m=m+1|0,g=g+1|0;return R|0}function Te(m,g,v){m=m|0,g=g|0,v=v|0;var E=0,C=0,R=0,O=0;if(R=m+v|0,g=g&255,(v|0)>=67){for(;m&3;)he[m>>0]=g,m=m+1|0;for(E=R&-4|0,O=g|g<<8|g<<16|g<<24,C=E-64|0;(m|0)<=(C|0);)o[m>>2]=O,o[m+4>>2]=O,o[m+8>>2]=O,o[m+12>>2]=O,o[m+16>>2]=O,o[m+20>>2]=O,o[m+24>>2]=O,o[m+28>>2]=O,o[m+32>>2]=O,o[m+36>>2]=O,o[m+40>>2]=O,o[m+44>>2]=O,o[m+48>>2]=O,o[m+52>>2]=O,o[m+56>>2]=O,o[m+60>>2]=O,m=m+64|0;for(;(m|0)<(E|0);)o[m>>2]=O,m=m+4|0}for(;(m|0)<(R|0);)he[m>>0]=g,m=m+1|0;return R-v|0}function Ue(m){return m=+m,m>=0?+Pe(m+.5):+Qt(m-.5)}function xe(m){m=m|0;var g=0,v=0,E=0;return E=ni()|0,v=o[Ie>>2]|0,g=v+m|0,(m|0)>0&(g|0)<(v|0)|(g|0)<0?(Na(g|0)|0,ar(12),-1):(g|0)>(E|0)&&!(De(g|0)|0)?(ar(12),-1):(o[Ie>>2]=g,v|0)}return{___divdi3:M,___muldi3:V,___remdi3:$,___uremdi3:X,_areNeighborCells:YA,_bitshift64Ashr:se,_bitshift64Lshr:ne,_bitshift64Shl:ue,_calloc:h,_cellAreaKm2:Ft,_cellAreaM2:nu,_cellAreaRads2:As,_cellToBoundary:fr,_cellToCenterChild:eu,_cellToChildPos:ls,_cellToChildren:pA,_cellToChildrenSize:Ml,_cellToLatLng:_o,_cellToLocalIj:oh,_cellToParent:Sl,_cellToVertex:cn,_cellToVertexes:Zr,_cellsToDirectedEdge:XA,_cellsToLinkedMultiPolygon:ki,_childPosToCell:rc,_compactCells:Cl,_destroyLinkedMultiPolygon:Ll,_directedEdgeToBoundary:Fs,_directedEdgeToCells:fa,_edgeLengthKm:Qo,_edgeLengthM:iu,_edgeLengthRads:ya,_emscripten_replace_memory:No,_free:l,_getBaseCellNumber:Ha,_getDirectedEdgeDestination:ha,_getDirectedEdgeOrigin:yo,_getHexagonAreaAvgKm2:kl,_getHexagonAreaAvgM2:Za,_getHexagonEdgeLengthAvgKm:rh,_getHexagonEdgeLengthAvgM:sh,_getIcosahedronFaces:Pl,_getNumCells:Ya,_getPentagons:Vs,_getRes0Cells:hA,_getResolution:Tl,_greatCircleDistanceKm:Il,_greatCircleDistanceM:Wo,_greatCircleDistanceRads:qr,_gridDisk:ua,_gridDiskDistances:Ji,_gridDistance:su,_gridPathCells:au,_gridPathCellsSize:ou,_gridRingUnsafe:wt,_i64Add:d,_i64Subtract:x,_isPentagon:pi,_isResClassIII:Li,_isValidCell:da,_isValidDirectedEdge:KA,_isValidVertex:Ui,_latLngToCell:as,_llvm_maxnum_f64:be,_llvm_minnum_f64:Ce,_llvm_round_f64:_e,_localIjToCell:oc,_malloc:_,_maxFaceCount:Wa,_maxGridDiskSize:ml,_maxPolygonToCellsSize:Wt,_memcpy:Ge,_memset:Te,_originToDirectedEdges:hi,_pentagonCount:Qa,_polygonToCells:Pi,_readInt64AsDoubleFromPointer:Au,_res0CellCount:cA,_round:Ue,_sbrk:xe,_sizeOfCellBoundary:ac,_sizeOfCoordIJ:Rl,_sizeOfGeoLoop:us,_sizeOfGeoPolygon:Ei,_sizeOfH3Index:zi,_sizeOfLatLng:Dl,_sizeOfLinkedGeoPolygon:Ka,_uncompactCells:nc,_uncompactCellsSize:Wi,_vertexToLatLng:qo,establishStackSpace:Aa,stackAlloc:xs,stackRestore:Va,stackSave:Ua}}(vs,mn,Ve);e.___divdi3=qe.___divdi3,e.___muldi3=qe.___muldi3,e.___remdi3=qe.___remdi3,e.___uremdi3=qe.___uremdi3,e._areNeighborCells=qe._areNeighborCells,e._bitshift64Ashr=qe._bitshift64Ashr,e._bitshift64Lshr=qe._bitshift64Lshr,e._bitshift64Shl=qe._bitshift64Shl,e._calloc=qe._calloc,e._cellAreaKm2=qe._cellAreaKm2,e._cellAreaM2=qe._cellAreaM2,e._cellAreaRads2=qe._cellAreaRads2,e._cellToBoundary=qe._cellToBoundary,e._cellToCenterChild=qe._cellToCenterChild,e._cellToChildPos=qe._cellToChildPos,e._cellToChildren=qe._cellToChildren,e._cellToChildrenSize=qe._cellToChildrenSize,e._cellToLatLng=qe._cellToLatLng,e._cellToLocalIj=qe._cellToLocalIj,e._cellToParent=qe._cellToParent,e._cellToVertex=qe._cellToVertex,e._cellToVertexes=qe._cellToVertexes,e._cellsToDirectedEdge=qe._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=qe._cellsToLinkedMultiPolygon,e._childPosToCell=qe._childPosToCell,e._compactCells=qe._compactCells,e._destroyLinkedMultiPolygon=qe._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=qe._directedEdgeToBoundary,e._directedEdgeToCells=qe._directedEdgeToCells,e._edgeLengthKm=qe._edgeLengthKm,e._edgeLengthM=qe._edgeLengthM,e._edgeLengthRads=qe._edgeLengthRads;var $i=e._emscripten_replace_memory=qe._emscripten_replace_memory;e._free=qe._free,e._getBaseCellNumber=qe._getBaseCellNumber,e._getDirectedEdgeDestination=qe._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=qe._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=qe._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=qe._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=qe._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=qe._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=qe._getIcosahedronFaces,e._getNumCells=qe._getNumCells,e._getPentagons=qe._getPentagons,e._getRes0Cells=qe._getRes0Cells,e._getResolution=qe._getResolution,e._greatCircleDistanceKm=qe._greatCircleDistanceKm,e._greatCircleDistanceM=qe._greatCircleDistanceM,e._greatCircleDistanceRads=qe._greatCircleDistanceRads,e._gridDisk=qe._gridDisk,e._gridDiskDistances=qe._gridDiskDistances,e._gridDistance=qe._gridDistance,e._gridPathCells=qe._gridPathCells,e._gridPathCellsSize=qe._gridPathCellsSize,e._gridRingUnsafe=qe._gridRingUnsafe,e._i64Add=qe._i64Add,e._i64Subtract=qe._i64Subtract,e._isPentagon=qe._isPentagon,e._isResClassIII=qe._isResClassIII,e._isValidCell=qe._isValidCell,e._isValidDirectedEdge=qe._isValidDirectedEdge,e._isValidVertex=qe._isValidVertex,e._latLngToCell=qe._latLngToCell,e._llvm_maxnum_f64=qe._llvm_maxnum_f64,e._llvm_minnum_f64=qe._llvm_minnum_f64,e._llvm_round_f64=qe._llvm_round_f64,e._localIjToCell=qe._localIjToCell,e._malloc=qe._malloc,e._maxFaceCount=qe._maxFaceCount,e._maxGridDiskSize=qe._maxGridDiskSize,e._maxPolygonToCellsSize=qe._maxPolygonToCellsSize,e._memcpy=qe._memcpy,e._memset=qe._memset,e._originToDirectedEdges=qe._originToDirectedEdges,e._pentagonCount=qe._pentagonCount,e._polygonToCells=qe._polygonToCells,e._readInt64AsDoubleFromPointer=qe._readInt64AsDoubleFromPointer,e._res0CellCount=qe._res0CellCount,e._round=qe._round,e._sbrk=qe._sbrk,e._sizeOfCellBoundary=qe._sizeOfCellBoundary,e._sizeOfCoordIJ=qe._sizeOfCoordIJ,e._sizeOfGeoLoop=qe._sizeOfGeoLoop,e._sizeOfGeoPolygon=qe._sizeOfGeoPolygon,e._sizeOfH3Index=qe._sizeOfH3Index,e._sizeOfLatLng=qe._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=qe._sizeOfLinkedGeoPolygon,e._uncompactCells=qe._uncompactCells,e._uncompactCellsSize=qe._uncompactCellsSize,e._vertexToLatLng=qe._vertexToLatLng,e.establishStackSpace=qe.establishStackSpace;var zs=e.stackAlloc=qe.stackAlloc,Ri=e.stackRestore=qe.stackRestore,or=e.stackSave=qe.stackSave;if(e.asm=qe,e.cwrap=re,e.setValue=U,e.getValue=Q,Hn){fo(Hn)||(Hn=s(Hn));{Un();var qn=function(K){K.byteLength&&(K=new Uint8Array(K)),Ye.set(K,L),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Cr()},Os=function(){u(Hn,qn,function(){throw"could not load memory initializer "+Hn})},Ur=Ii(Hn);if(Ur)qn(Ur.buffer);else if(e.memoryInitializerRequest){var Vr=function(){var K=e.memoryInitializerRequest,H=K.response;if(K.status!==200&&K.status!==0){var ee=Ii(e.memoryInitializerRequestURL);if(ee)H=ee.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+K.status+", retrying "+Hn),Os();return}}qn(H)};e.memoryInitializerRequest.response?setTimeout(Vr,0):e.memoryInitializerRequest.addEventListener("load",Vr)}else Os()}}var Lr;Ki=function K(){Lr||ss(),Lr||(Ki=K)};function ss(K){if(ti>0||(Nn(),ti>0))return;function H(){Lr||(Lr=!0,!Z&&(bi(),xt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),nn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),H()},1)):H()}e.run=ss;function Bi(K){throw e.onAbort&&e.onAbort(K),K+="",a(K),y(K),Z=!0,"abort("+K+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Bi,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return ss(),t}(typeof ts=="object"?ts:{}),Qn="number",Dn=Qn,up=Qn,zn=Qn,On=Qn,no=Qn,hn=Qn,dde=[["sizeOfH3Index",Qn],["sizeOfLatLng",Qn],["sizeOfCellBoundary",Qn],["sizeOfGeoLoop",Qn],["sizeOfGeoPolygon",Qn],["sizeOfLinkedGeoPolygon",Qn],["sizeOfCoordIJ",Qn],["readInt64AsDoubleFromPointer",Qn],["isValidCell",up,[zn,On]],["latLngToCell",Dn,[Qn,Qn,no,hn]],["cellToLatLng",Dn,[zn,On,hn]],["cellToBoundary",Dn,[zn,On,hn]],["maxGridDiskSize",Dn,[Qn,hn]],["gridDisk",Dn,[zn,On,Qn,hn]],["gridDiskDistances",Dn,[zn,On,Qn,hn,hn]],["gridRingUnsafe",Dn,[zn,On,Qn,hn]],["maxPolygonToCellsSize",Dn,[hn,no,Qn,hn]],["polygonToCells",Dn,[hn,no,Qn,hn]],["cellsToLinkedMultiPolygon",Dn,[hn,Qn,hn]],["destroyLinkedMultiPolygon",null,[hn]],["compactCells",Dn,[hn,hn,Qn,Qn]],["uncompactCells",Dn,[hn,Qn,Qn,hn,Qn,no]],["uncompactCellsSize",Dn,[hn,Qn,Qn,no,hn]],["isPentagon",up,[zn,On]],["isResClassIII",up,[zn,On]],["getBaseCellNumber",Qn,[zn,On]],["getResolution",Qn,[zn,On]],["maxFaceCount",Dn,[zn,On,hn]],["getIcosahedronFaces",Dn,[zn,On,hn]],["cellToParent",Dn,[zn,On,no,hn]],["cellToChildren",Dn,[zn,On,no,hn]],["cellToCenterChild",Dn,[zn,On,no,hn]],["cellToChildrenSize",Dn,[zn,On,no,hn]],["cellToChildPos",Dn,[zn,On,no,hn]],["childPosToCell",Dn,[Qn,Qn,zn,On,no,hn]],["areNeighborCells",Dn,[zn,On,zn,On,hn]],["cellsToDirectedEdge",Dn,[zn,On,zn,On,hn]],["getDirectedEdgeOrigin",Dn,[zn,On,hn]],["getDirectedEdgeDestination",Dn,[zn,On,hn]],["isValidDirectedEdge",up,[zn,On]],["directedEdgeToCells",Dn,[zn,On,hn]],["originToDirectedEdges",Dn,[zn,On,hn]],["directedEdgeToBoundary",Dn,[zn,On,hn]],["gridDistance",Dn,[zn,On,zn,On,hn]],["gridPathCells",Dn,[zn,On,zn,On,hn]],["gridPathCellsSize",Dn,[zn,On,zn,On,hn]],["cellToLocalIj",Dn,[zn,On,zn,On,Qn,hn]],["localIjToCell",Dn,[zn,On,hn,Qn,hn]],["getHexagonAreaAvgM2",Dn,[no,hn]],["getHexagonAreaAvgKm2",Dn,[no,hn]],["getHexagonEdgeLengthAvgM",Dn,[no,hn]],["getHexagonEdgeLengthAvgKm",Dn,[no,hn]],["greatCircleDistanceM",Qn,[hn,hn]],["greatCircleDistanceKm",Qn,[hn,hn]],["greatCircleDistanceRads",Qn,[hn,hn]],["cellAreaM2",Dn,[zn,On,hn]],["cellAreaKm2",Dn,[zn,On,hn]],["cellAreaRads2",Dn,[zn,On,hn]],["edgeLengthM",Dn,[zn,On,hn]],["edgeLengthKm",Dn,[zn,On,hn]],["edgeLengthRads",Dn,[zn,On,hn]],["getNumCells",Dn,[no,hn]],["getRes0Cells",Dn,[hn]],["res0CellCount",Qn],["getPentagons",Dn,[Qn,hn]],["pentagonCount",Qn],["cellToVertex",Dn,[zn,On,Qn,hn]],["cellToVertexes",Dn,[zn,On,hn]],["vertexToLatLng",Dn,[zn,On,hn]],["isValidVertex",up,[zn,On]]],pde=0,gde=1,mde=2,yde=3,n7=4,_de=5,vde=6,xde=7,wde=8,bde=9,Ede=10,Tde=11,Sde=12,Mde=13,Cde=14,Pde=15,Rs={};Rs[pde]="Success";Rs[gde]="The operation failed but a more specific error is not available";Rs[mde]="Argument was outside of acceptable range";Rs[yde]="Latitude or longitude arguments were outside of acceptable range";Rs[n7]="Resolution argument was outside of acceptable range";Rs[_de]="Cell argument was not valid";Rs[vde]="Directed edge argument was not valid";Rs[xde]="Undirected edge argument was not valid";Rs[wde]="Vertex argument was not valid";Rs[bde]="Pentagon distortion was encountered";Rs[Ede]="Duplicate input";Rs[Tde]="Cell arguments were not neighbors";Rs[Sde]="Cell arguments had incompatible resolutions";Rs[Mde]="Memory allocation failed";Rs[Cde]="Bounds of provided memory were insufficient";Rs[Pde]="Mode or flags argument was not valid";var vS=1e3,Ide=1001,kde=1002,W2={};W2[vS]="Unknown unit";W2[Ide]="Array length out of bounds";W2[kde]="Got unexpected null value for H3 index";var Lde="Unknown error";function i7(t,e,n){var i=n&&"value"in n,r=new Error((t[e]||Lde)+" (code: "+e+(i?", value: "+n.value:"")+")");return r.code=e,r}function r7(t,e){var n=arguments.length===2?{value:e}:{};return i7(Rs,t,n)}function s7(t,e){var n=arguments.length===2?{value:e}:{};return i7(W2,t,n)}function Wc(t){if(t!==0)throw r7(t)}var uo={};dde.forEach(function(e){uo[e[0]]=ts.cwrap.apply(ts,e)});var ff=16,Dde=4,Jh=8,$3=uo.sizeOfH3Index(),Rde=uo.sizeOfLatLng(),Bde=uo.sizeOfCellBoundary();uo.sizeOfGeoPolygon();uo.sizeOfGeoLoop();uo.sizeOfLinkedGeoPolygon();uo.sizeOfCoordIJ();var Lo={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function zde(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw r7(n7,t);return t}var Ode=/[^0-9a-fA-F]/;function Q2(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||Ode.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),ff),n=parseInt(t.substring(t.length-8),ff);return[n,e]}function rk(t){if(t>=0)return t.toString(ff);t=t&2147483647;var e=o7(8,t.toString(ff)),n=(parseInt(e[0],ff)+8).toString(ff);return e=n+e.substring(1),e}function Fde(t,e){return rk(e)+o7(8,rk(t))}function o7(t,e){for(var n=t-e.length,i="",r=0;r<n;r++)i+="0";return i=i+e,i}function Nde(t,e){e===void 0&&(e=0);var n=ts.getValue(t+$3*e,"i32"),i=ts.getValue(t+$3*e+Dde,"i32");return i?Fde(n,i):null}function a7(t,e){return e===void 0&&(e=0),ts.getValue(t+Jh*e,"double")}function Ude(t,e){for(var n=[],i=0;i<e;i++){var r=Nde(t,i);r!==null&&n.push(r)}return n}function G_(t){return $de(ts.getValue(t,"double"))}function l7(t){return[G_(t),G_(t+Jh)]}function Vde(t){return[G_(t+Jh),G_(t)]}function Gde(t,e,n){for(var i=ts.getValue(t,"i32"),r=t+Jh,s=[],u=e?Vde:l7,a=0;a<i*2;a+=2)s.push(u(r+Jh*a));return n&&s.push(s[0]),s}function q2(t){var e=ts._malloc(Rde),n=Q2(t),i=n[0],r=n[1];try{return Wc(uo.cellToLatLng(i,r,e)),l7(e)}finally{ts._free(e)}}function jde(t,e){var n=ts._malloc(Bde),i=Q2(t),r=i[0],s=i[1];try{return Wc(uo.cellToBoundary(r,s,n)),Gde(n,e,e)}finally{ts._free(n)}}function j_(t){var e=Q2(t),n=e[0],i=e[1],r=6,s=ts._calloc(r,$3);try{return Wc(uo.originToDirectedEdges(n,i,s)),Ude(s,r)}finally{ts._free(s)}}function $_(t,e){var n=Q2(t),i=n[0],r=n[1],s=ts._malloc(Jh);try{switch(e){case Lo.m:Wc(uo.edgeLengthM(i,r,s));break;case Lo.km:Wc(uo.edgeLengthKm(i,r,s));break;case Lo.rads:Wc(uo.edgeLengthRads(i,r,s));break;default:throw s7(vS,e)}return a7(s)}finally{ts._free(s)}}function id(t,e){zde(t);var n=ts._malloc(Jh);try{switch(e){case Lo.m:Wc(uo.getHexagonEdgeLengthAvgM(t,n));break;case Lo.km:Wc(uo.getHexagonEdgeLengthAvgKm(t,n));break;default:throw s7(vS,e)}return a7(n)}finally{ts._free(n)}}function $de(t){return t*180/Math.PI}function sk(t,e,n=1){const i=n,[r,s]=q2(t);return e.map(a=>{let y=BA(s,a[0],i),w=BA(r,a[1],i);return[y,w]})}function Hde(t,[e,n]){let i=jde(t).map(u=>[u[1],u[0]]),r=sk(t,i,n),s=sk(t,i,e);return[r,s]}class yr extends Kn{initializeState(){super.initializeState();const e=Object.keys(this.props.data).map(i=>parseInt(i)),n=hr().domain([0,1]).range(e)(Kh(this.context.viewport.zoom));this.setState({...this.state,resRange:e,lastResolution:n}),this.createPolygons()}createPolygons(){const{lastResolution:e}=this.state,n=[],i=this.props.data[e];Object.keys(i).forEach((r,s)=>{let u=i[r];const a=this.props.getValue?ys().domain([0,1]).range([this.props.thicknessRange[1],this.props.thicknessRange[0]])(this.props.getValue({properties:u})):this.props.thicknessRange[0];let y=Hde(r,[a,this.props.thicknessRange[1]]);this.props.raised?n.push({polygon:y.map(w=>w.map(([I,P])=>[I,P,typeof this.props.getElevation=="function"?this.props.getElevation({hexId:r,properties:u}):this.props.getElevation])),hexId:r,properties:u}):n.push({hexId:r,polygon:y,properties:u})}),this.setState({...this.state,polygons:n})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:i}=this.state,{props:r,oldProps:s,changeFlags:u,context:a}=e;if(r.getElevation!=s.getElevation||r.getValue!=s.getValue||u.viewportChanged){const y=hr().domain([0,1]).range(n)(Kh(a.viewport.zoom));(y!=i||r.getValue!=s.getValue||r.getElevation!=s.getElevation)&&(this.setState({...this.state,lastResolution:y}),this.createPolygons())}}renderLayers(){return[new k2(this.getSubLayerProps({data:this.props.data,filled:this.props.filled,stroked:this.props.stroked,extruded:this.props.extruded,wireframe:this.props.wireframe,_normalize:this.props._normalize,_windingOrder:this.props._windingOrder,_full3d:this.props._full3d,elevationScale:this.props.elevationScale,getPolygon:this.props.getPolygon,getElevation:this.props.getElevation,getFillColor:this.props.getFillColor,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,id:"SolidHexTileLayer",data:this.state.polygons,getPolygon:e=>e.polygon,pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,extensions:this.props.extensions,getOffset:this.props.getOffset,lineJointRounded:this.props.lineJointRounded}))]}}yr.layerName="SolidHexTileLayer";yr.defaultProps={...Kn.defaultProps,...k2.defaultProps,thicknessRange:[.7,.9],getValue:void 0,raised:!1};class xS extends Kn{initializeState(){super.initializeState(),this.setState({getElevationFn:e=>!this.props.transitioning&&(ri(this.props.slide,9,9)&&e.properties.LandUse[0]==1||ri(this.props.slide,10,10)&&e.properties.LandUse[0]==2||ri(this.props.slide,11,11)&&e.properties.LandUse[0]==0)?2e3:0})}updateState(e){const{props:n,oldProps:i}=e;(n.transitioning!=i.transitioning||n.slide!=i.slide)&&this.setState({getElevationFn:r=>!n.transitioning&&(ri(n.slide,9,9)&&r.properties.LandUse[0]==1||ri(n.slide,10,10)&&r.properties.LandUse[0]==2||ri(n.slide,11,11)&&r.properties.LandUse[0]==0)?2e3:0})}renderLayers(){const{data:e,slide:n,transitioning:i}=this.props;return[new yr({id:"AverageDemand",data:e,thicknessRange:[0,1],filled:!0,extruded:!0,getElevation:this.state.getElevationFn,raised:!1,getFillColor:r=>KO(r.properties.DemandBaselineAverage),visible:ri(n,6,11),opacity:n>=7?1:0,transitions:{opacity:250},pickable:!0,autoHighlight:!0,updateTriggers:{getElevation:[n,i]}}),new yr({id:"AverageUnmetDemand",data:e,thicknessRange:[.5,.65],filled:!0,extruded:!0,getElevation:this.state.getElevationFn,raised:!1,getFillColor:r=>XO(r.properties.UnmetDemandBaselineAverage),visible:ri(n,6,11),opacity:n>=7?1:0,transitions:{opacity:250},updateTriggers:{getElevation:[n,i]}})]}}xS.layerName="SlideAverages";xS.defaultProps={...Kn.defaultProps};class wS extends Kn{renderLayers(){const{data:e,slide:n}=this.props;return[new yr({id:"GroundwaterAgainLayer",data:e,thicknessRange:[0,1],filled:!0,extruded:!1,raised:!1,getFillColor:i=>am(i.properties.GroundwaterAverage),visible:ri(n,12,13),opacity:ri(n,13,13)?.2:0,transitions:{opacity:250}}),new yr({id:"DeliveryWaterLayer",data:e,thicknessRange:[.5,.65],filled:!0,extruded:!1,raised:!1,getFillColor:i=>JO(i.properties.DemandBaselineAverage+i.properties.UnmetDemandBaselineAverage),visible:ri(n,11,13),opacity:ri(n,12,13)?1:0,transitions:{opacity:250}})]}}wS.layerName="SlideDeliveries";wS.defaultProps={...Kn.defaultProps};const Wde=/^[og]\s*(.+)?/,Qde=/^mtllib /,qde=/^usemtl /;class bS{constructor(e){let{index:n,name:i="",mtllib:r,smooth:s,groupStart:u}=e;this.index=n,this.name=i,this.mtllib=r,this.smooth=s,this.groupStart=u,this.groupEnd=-1,this.groupCount=-1,this.inherited=!1}clone(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.index;return new bS({index:e,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0})}}class Zde{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.name=e,this.geometry={vertices:[],normals:[],colors:[],uvs:[]},this.materials=[],this.smooth=!0,this.fromDeclaration=null}startMaterial(e,n){const i=this._finalize(!1);i&&(i.inherited||i.groupCount<=0)&&this.materials.splice(i.index,1);const r=new bS({index:this.materials.length,name:e,mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:i!==void 0?i.smooth:this.smooth,groupStart:i!==void 0?i.groupEnd:0});return this.materials.push(r),r}currentMaterial(){if(this.materials.length>0)return this.materials[this.materials.length-1]}_finalize(e){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),e&&this.materials.length>1)for(let i=this.materials.length-1;i>=0;i--)this.materials[i].groupCount<=0&&this.materials.splice(i,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}}class Yde{constructor(){this.objects=[],this.object=null,this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.materialLibraries=[],this.startObject("",!1)}startObject(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.object&&!this.object.fromDeclaration){this.object.name=e,this.object.fromDeclaration=n;return}const i=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object=new Zde(e),this.object.fromDeclaration=n,i&&i.name&&typeof i.clone=="function"){const r=i.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)}finalize(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)}parseVertexIndex(e,n){const i=parseInt(e);return(i>=0?i-1:i+n/3)*3}parseNormalIndex(e,n){const i=parseInt(e);return(i>=0?i-1:i+n/3)*3}parseUVIndex(e,n){const i=parseInt(e);return(i>=0?i-1:i+n/2)*2}addVertex(e,n,i){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[n+0],r[n+1],r[n+2]),s.push(r[i+0],r[i+1],r[i+2])}addVertexPoint(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addVertexLine(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addNormal(e,n,i){const r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[n+0],r[n+1],r[n+2]),s.push(r[i+0],r[i+1],r[i+2])}addColor(e,n,i){const r=this.colors,s=this.object.geometry.colors;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[n+0],r[n+1],r[n+2]),s.push(r[i+0],r[i+1],r[i+2])}addUV(e,n,i){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[n+0],r[n+1]),s.push(r[i+0],r[i+1])}addUVLine(e){const n=this.uvs;this.object.geometry.uvs.push(n[e+0],n[e+1])}addFace(e,n,i,r,s,u,a,y,w){const I=this.vertices.length;let P=this.parseVertexIndex(e,I),L=this.parseVertexIndex(n,I),U=this.parseVertexIndex(i,I);if(this.addVertex(P,L,U),r!==void 0&&r!==""){const Q=this.uvs.length;P=this.parseUVIndex(r,Q),L=this.parseUVIndex(s,Q),U=this.parseUVIndex(u,Q),this.addUV(P,L,U)}if(a!==void 0&&a!==""){const Q=this.normals.length;P=this.parseNormalIndex(a,Q),L=a===y?P:this.parseNormalIndex(y,Q),U=a===w?P:this.parseNormalIndex(w,Q),this.addNormal(P,L,U)}this.colors.length>0&&this.addColor(P,L,U)}addPointGeometry(e){this.object.geometry.type="Points";const n=this.vertices.length;for(const i of e)this.addVertexPoint(this.parseVertexIndex(i,n))}addLineGeometry(e,n){this.object.geometry.type="Line";const i=this.vertices.length,r=this.uvs.length;for(const s of e)this.addVertexLine(this.parseVertexIndex(s,i));for(const s of n)this.addUVLine(this.parseUVIndex(s,r))}}function Xde(t){const e=new Yde;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let i="",r="",s=0,u=[];const a=typeof"".trimLeft=="function";for(let I=0,P=n.length;I<P;I++)if(i=n[I],i=a?i.trimLeft():i.trim(),s=i.length,s!==0&&(r=i.charAt(0),r!=="#"))if(r==="v"){const L=i.split(/\s+/);switch(L[0]){case"v":e.vertices.push(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3])),L.length>=7&&e.colors.push(parseFloat(L[4]),parseFloat(L[5]),parseFloat(L[6]));break;case"vn":e.normals.push(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3]));break;case"vt":e.uvs.push(parseFloat(L[1]),parseFloat(L[2]));break}}else if(r==="f"){const U=i.substr(1).trim().split(/\s+/),Q=[];for(let ae=0,Y=U.length;ae<Y;ae++){const te=U[ae];if(te.length>0){const re=te.split("/");Q.push(re)}}const Z=Q[0];for(let ae=1,Y=Q.length-1;ae<Y;ae++){const te=Q[ae],re=Q[ae+1];e.addFace(Z[0],te[0],re[0],Z[1],te[1],re[1],Z[2],te[2],re[2])}}else if(r==="l"){const L=i.substring(1).trim().split(" ");let U;const Q=[];if(i.indexOf("/")===-1)U=L;else{U=[];for(let Z=0,ae=L.length;Z<ae;Z++){const Y=L[Z].split("/");Y[0]!==""&&U.push(Y[0]),Y[1]!==""&&Q.push(Y[1])}}e.addLineGeometry(U,Q)}else if(r==="p"){const U=i.substr(1).trim().split(" ");e.addPointGeometry(U)}else if((u=Wde.exec(i))!==null){const L=(" "+u[0].substr(1).trim()).substr(1);e.startObject(L)}else if(qde.test(i))e.object.startMaterial(i.substring(7).trim(),e.materialLibraries);else if(Qde.test(i))e.materialLibraries.push(i.substring(7).trim());else if(r==="s"){if(u=i.split(" "),u.length>1){const U=u[1].trim().toLowerCase();e.object.smooth=U!=="0"&&U!=="off"}else e.object.smooth=!0;const L=e.object.currentMaterial();L&&(L.smooth=e.object.smooth)}else{if(i==="\0")continue;throw new Error('Unexpected line: "'.concat(i,'"'))}e.finalize();const y=[],w=[];for(const I of e.objects){const{geometry:P}=I;if(P.vertices.length===0)continue;const L={header:{vertexCount:P.vertices.length/3},attributes:{}};switch(P.type){case"Points":L.mode=0;break;case"Line":L.mode=1;break;default:L.mode=4;break}L.attributes.POSITION={value:new Float32Array(P.vertices),size:3},P.normals.length>0&&(L.attributes.NORMAL={value:new Float32Array(P.normals),size:3}),P.colors.length>0&&(L.attributes.COLOR_0={value:new Float32Array(P.colors),size:3}),P.uvs.length>0&&(L.attributes.TEXCOORD_0={value:new Float32Array(P.uvs),size:2}),L.materials=[];for(const U of I.materials){const Q={name:U.name,flatShading:!U.smooth};L.materials.push(Q),w.push(Q)}L.name=I.name,y.push(L)}return{meshes:y,materials:w}}function Kde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;for(const r in e)n=n||new Map,r!=="value"&&n.set(r,JSON.stringify(e[r]));const i=[];for(const r in t){const s=t[r],u=Jde(r,s);i.push(u)}return new lf(i,n)}function Jde(t,e){const n=new Map;for(const s in e)s!=="value"&&n.set(s,JSON.stringify(e[s]));const i=WAe(e.value);return!("size"in e)||e.size===1?new Gp(t,i,!1,n):new Gp(t,new HAe(e.size,new Gp("value",i)),!1,n)}function ok(t,e){const{meshes:n}=Xde(t),i=n.reduce((a,y)=>a+y.header.vertexCount,0),r=epe(n,i),s={vertexCount:i,boundingBox:Oz(r)},u=Kde(r,{mode:4,boundingBox:s.boundingBox});return{loaderData:{header:{}},schema:u,header:s,mode:4,attributes:r}}function epe(t,e){const n=new Float32Array(e*3);let i,r,s,u=0;for(const y of t){const{POSITION:w,NORMAL:I,COLOR_0:P,TEXCOORD_0:L}=y.attributes;n.set(w.value,u*3),I&&(i=i||new Float32Array(e*3),i.set(I.value,u*3)),P&&(r=r||new Float32Array(e*3),r.set(P.value,u*3)),L&&(s=s||new Float32Array(e*2),s.set(L.value,u*2)),u+=w.value.length/3}const a={};return a.POSITION={value:n,size:3},i&&(a.NORMAL={value:i,size:3}),r&&(a.COLOR_0={value:r,size:3}),s&&(a.TEXCOORD_0={value:s,size:2}),a}const tpe="3.4.14",npe={name:"OBJ",id:"obj",module:"obj",version:tpe,worker:!0,extensions:["obj"],mimeTypes:["text/plain"],testText:ipe,options:{obj:{}}};function ipe(t){return t[0]==="v"}const gr={...npe,parse:async(t,e)=>ok(new TextDecoder().decode(t)),parseTextSync:(t,e)=>ok(t)},rpe=hr().domain([0,1]).range(ST(0,Kc.length)),spe=Kc[0];class Or extends Kn{initializeState(){super.initializeState();const{zoom:e}=this.context.viewport,n=Object.keys(this.props.data).map(r=>parseInt(r)),i=hr().domain([0,1]).range(n)(Kh(e));this.setState({hextiles:this.props.data,resRange:n,lastResolution:i}),this.createPolygons()}createPolygons(){const{hextiles:e,lastResolution:n}=this.state,i=[],r=e[n],[s,u]=this.props.offset;Object.keys(r).forEach(a=>{const y=r[a],w=$_(j_(a)[0],Lo.km)*.48,[I,P]=q2(a);let L=0;for(let[U,Q,Z]of this.props.getValue?spe:[[0,0,0]])i.push({position:[P+(U+s)*w/(111.32*Math.cos(I*Math.PI/180)),I+(Q+u)*w/110.574,(typeof this.props.getElevation=="function"?this.props.getElevation({properties:y}):this.props.getElevation)+Z*1e4],properties:y,polyIdx:L++,hexID:a})}),this.setState({...this.state,polygons:i})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:i}=this.state,{props:r,oldProps:s,changeFlags:u,context:a}=e;if(r.getElevation!=s.getElevation||u.viewportChanged){const y=hr().domain([0,1]).range(n)(Kh(a.viewport.zoom));(y!=i||r.getElevation!=s.getElevation)&&(this.setState({...this.state,lastResolution:y}),this.createPolygons())}}renderLayers(){const{polygons:e,lastResolution:n,resRange:i}=this.state,r=id(n,Lo.km)/id(5,Lo.km);return[new f0(this.getSubLayerProps({data:this.props.data,mesh:this.props.mesh,texture:this.props.texture,textureParameters:this.props.textureParameters,getPosition:this.props.getPosition,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,sizeScale:this.props.sizeScale,_useMeshColors:this.props._useMeshColors,_instanced:this.props._instanced,wireframe:this.props.wireframe,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,id:"IconHexTileLayer",data:e,getPosition:s=>s.position,sizeScale:this.props.sizeScale*r,getTranslation:this.props.getValue===null?[0,0,0]:s=>{const u=Kc[rpe(this.props.getValue(s))][s.polyIdx],a=Kc[0][s.polyIdx],y=$_(j_(s.hexID)[0],Lo.m)*.5;return[(u[0]-a[0])*y,(u[1]-a[1])*y,(u[2]-a[2])*1e4]}}))]}}Or.layerName="IconHexTileLayer";Or.defaultProps={...Kn.defaultProps,...f0.defaultProps,thicknessRange:[.7,.9],getValue:null,getElevation:()=>0,offset:[0,0]};class ES extends Kn{renderLayers(){const{data:e,slide:n,counter:i}=this.props;return[new Or({id:"DemandIcons",data:e,loaders:[gr],mesh:"assets/drop.obj",raised:!0,extruded:!1,getColor:[255,130,35],getValue:r=>V_(r.properties.DemandBaseline[i]),sizeScale:3e3,visible:n==1,opacity:1,updateTriggers:{getTranslation:[i]}})]}}ES.layerName="SlideDemandIntro";ES.defaultProps={...Kn.defaultProps};const ak=hr().domain([0,1]).range(ST(0,Kc.length));class rd extends Kn{initializeState(){super.initializeState(),this.setState({hextiles:this.props.data,resRange:Object.keys(this.props.data).map(e=>parseInt(e)),transitioning:!1,prevGetValueFn:null})}renderLayers(){let{hextiles:e,transitioning:n,prevGetValueFn:i,resRange:r}=this.state;const{zoom:s}=this.context.viewport;i===null?this.setState(Object.assign(this.state,{prevGetValueFn:this.props.getValue})):i!==this.props.getValue&&!n&&(this.setState(Object.assign(this.state,{transitioning:!0})),n=!0,setTimeout(()=>{this.setState(Object.assign(this.state,{transitioning:!1,prevGetValueFn:this.props.getValue}))},300));let u=[];const a=hr().domain([0,1]).range(r)(Kh(s));let y=e[a],w=id(a,Lo.km)/id(5,Lo.km);return Object.keys(y).forEach(I=>{let P=y[I];const L=$_(j_(I)[0],Lo.km)*.5,[U,Q]=q2(I),Z=this.props.getValue?ak(this.props.getValue({properties:P})):1;for(let[ae,Y,te]of this.props.getValue?n?$oe[ak(i({properties:P}))][Z]:Kc[Z]:[[0,0,0]]){let[re,de]=this.props.offset;u.push({position:[Q+(ae+re)*L/(111.32*Math.cos(U*3.1415/180)),U+(Y+de)*L/110.574,(typeof this.props.getElevation=="function"?this.props.getElevation({properties:P}):this.props.getElevation)+te*1e4],properties:P})}}),[new f0(this.getSubLayerProps({data:this.props.data,mesh:this.props.mesh,texture:this.props.texture,textureParameters:this.props.textureParameters,getPosition:this.props.getPosition,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,sizeScale:this.props.sizeScale,_useMeshColors:this.props._useMeshColors,_instanced:this.props._instanced,wireframe:this.props.wireframe,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,id:"AnimatedIconHexTileLayer",data:u,getPosition:I=>I.position,sizeScale:this.props.sizeScale*w}))]}}rd.layerName="AnimatedIconHexTileLayer";rd.defaultProps={...Kn.defaultProps,...f0.defaultProps,getValue:void 0,getElevation:()=>0,offset:[0,0],transitions:{getPosition:{duration:300,easing:qP.overshoot(2)},getColor:{duration:300,easing:qP.overshoot(2)}}};class TS extends Kn{renderLayers(){const{data:e,slide:n,counter:i}=this.props;return[new yr({id:"GroundwaterLayer",data:e,thicknessRange:[0,1],filled:!0,extruded:!1,raised:!1,getFillColor:r=>am(r.properties.Groundwater[n<=2?i:n<=4?1026:1197]),visible:ri(n,1,6),opacity:n>=2?.2:0,transitions:{opacity:250},updateTriggers:{getFillColor:[i,n]}}),new rd({id:"UnmetDemandIcons1",data:e,loaders:[gr],mesh:"assets/drop.obj",raised:!0,extruded:!1,getColor:ri(n,2,3)?[255,130,35]:[255,130,35],getValue:n==2||n==5?r=>0:n==3?r=>V_(r.properties.DemandBaseline[1026]):r=>Hc(r.properties.UnmetDemandBaseline[1026]),sizeScale:3e3,visible:ri(n,2,5),opacity:1}),new rd({id:"UnmetDemandIcons2",data:e,loaders:[gr],mesh:"assets/drop.obj",raised:!0,extruded:!1,getColor:ri(n,4,5)?[255,130,35]:[255,130,35],getValue:n==4||n==7?r=>0:n==5?r=>V_(r.properties.DemandBaseline[1197]):r=>Hc(r.properties.UnmetDemandBaseline[1197]),sizeScale:3e3,visible:ri(n,4,7),opacity:1})]}}TS.layerName="SlideDemandVsUnmet";TS.defaultProps={...Kn.defaultProps};class SS extends Kn{renderLayers(){const{data:e,slide:n,cycler:i}=this.props;return[new Or({id:"ScenarioUnmetRandomized",data:e,loaders:[gr],mesh:"assets/drop.obj",raised:!0,extruded:!1,getColor:r=>[255,130,35],getValue:r=>Hc(r.properties.UnmetDemand[ii[i%3]][Math.floor(i/3)*67%1199+1]),sizeScale:3e3,visible:ri(n,21,21),opacity:1,updateTriggers:{getTranslation:[i]}}),new yr({id:"DifferenceLayerRandomized",data:e,thicknessRange:[.5,.65],filled:!0,extruded:!1,raised:!1,getFillColor:r=>Xh(r.properties.UnmetDemand[ii[i%3]][Math.floor(i/3)*67%1199+1]-r.properties.UnmetDemandBaseline[Math.floor(i/3)*67%1199+1]),visible:ri(n,20,21),opacity:ri(n,21,21)?1:0,transitions:{opacity:250},updateTriggers:{getFillColor:[i]}})]}}SS.layerName="SlideEndRandomized";SS.defaultProps={...Kn.defaultProps};class MS extends Kn{renderLayers(){const{data:e,slide:n,transitioning:i}=this.props;return[new Or({id:"SettlementIconsLayer",data:ks(e,r=>r.LandUse[0]==0),loaders:[gr],mesh:"assets/dam.obj",raised:!0,getElevation:!i&&ri(n,11,11)?2e3:0,getColor:[255,127,206],sizeScale:.8*500,visible:ri(n,9,13),opacity:1,updateTriggers:{getElevation:[n,i]}}),new Or({id:"ExhangeIconsLayer",data:ks(e,r=>r.LandUse[0]==1),loaders:[gr],mesh:"assets/cow.obj",raised:!0,getElevation:!i&&ri(n,9,9)?2e3:0,getColor:[255,127,206],sizeScale:.8*550,visible:ri(n,9,13),opacity:1,updateTriggers:{getElevation:[n,i]}}),new Or({id:"ProjectIconsLayer",data:ks(e,r=>r.LandUse[0]==2),loaders:[gr],mesh:"assets/project.obj",raised:!0,getElevation:!i&&ri(n,10,10)?2e3:0,getColor:[255,127,206],sizeScale:.8*180,visible:ri(n,9,13),opacity:1,updateTriggers:{getElevation:[n,i]}}),new Or({id:"NonProjectIconsLayer",data:ks(e,r=>r.LandUse[0]==3),loaders:[gr],mesh:"assets/nonproject.obj",raised:!0,getElevation:0,getColor:[255,127,206],sizeScale:.8*140,visible:ri(n,9,13),opacity:1,updateTriggers:{getElevation:[n,i]}})]}}MS.layerName="SlideOwners";MS.defaultProps={...Kn.defaultProps};class CS extends Kn{renderLayers(){const{data:e,slide:n,curScenario:i,cycler:r}=this.props;return[new yr({id:"GroundwaterAgainTimed",data:e,thicknessRange:[0,1],filled:!0,extruded:!1,raised:!1,getFillColor:s=>am(s.properties.Groundwater[ri(n,13,19)?1026:n==20?1197:Math.floor(r/3)*67%1199+1]),visible:ri(n,13,21),opacity:ri(n,14,21)?.2:0,transitions:{opacity:250}}),new rd({id:"ScenarioUnmet",data:e,loaders:[gr],mesh:"assets/drop.obj",raised:!0,extruded:!1,getColor:s=>[255,130,35],getValue:n==13?s=>0:n==14?s=>Hc(s.properties.UnmetDemandBaseline[1026]):s=>Hc(s.properties.UnmetDemand[ii[i]][1026]),sizeScale:3e3,visible:ri(n,13,19),opacity:1,updateTriggers:{getFillColor:[i]}}),new yr({id:"DifferenceLayer",data:e,thicknessRange:[.5,.65],filled:!0,extruded:!1,raised:!1,getFillColor:s=>Xh(s.properties.UnmetDemand[ii[i]][1026]-s.properties.UnmetDemandBaseline[1026]),visible:ri(n,15,19),opacity:ri(n,16,19)?1:0,transitions:{opacity:250},updateTriggers:{getFillColor:[i]}}),new rd({id:"ScenarioUnmet1197",data:e,loaders:[gr],mesh:"assets/drop.obj",raised:!0,extruded:!1,getColor:s=>[255,130,35],getValue:s=>Hc(s.properties.UnmetDemand[ii[r%3]][1197]),sizeScale:3e3,visible:ri(n,20,20),opacity:1,updateTriggers:{getFillColor:[r]}}),new yr({id:"DifferenceLayer1197",data:e,thicknessRange:[.5,.65],filled:!0,extruded:!1,raised:!1,getFillColor:s=>Xh(s.properties.UnmetDemand[ii[r%3]][1197]-s.properties.UnmetDemandBaseline[1197]),visible:ri(n,19,20),opacity:ri(n,20,20)?1:0,transitions:{opacity:250},updateTriggers:{getFillColor:[r]}})]}}CS.layerName="SlideScenarioExplanations";CS.defaultProps={...Kn.defaultProps};let PS=class extends Kn{renderLayers(){return[new D2({data:"https://services.arcgisonline.com/ArcGIS/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}.png",minZoom:7,maxZoom:11,tileSize:256,zoomOffset:-1,renderSubLayers:e=>{const{bbox:{west:n,south:i,east:r,north:s}}=e.tile;return new S2(e,{data:null,image:e.data,bounds:[n,i,r,s]})}}),new yr({id:"HoveringTiles",data:this.props.data,thicknessRange:[0,1],filled:!0,extruded:!1,raised:!1,getFillColor:[0,0,0,0],pickable:!0,autoHighlight:!0})]}};PS.layerName="SlideTerrain";PS.defaultProps={...Kn.defaultProps};class A7 extends Kn{renderLayers(){return[new PS(this.props),new ES(this.props),new TS(this.props),new xS(this.props),new MS(this.props),new wS(this.props),new CS(this.props),new SS(this.props)]}}A7.layerName="MartiniSlides";A7.defaultProps={...Kn.defaultProps};class u7 extends Kn{initializeState(){super.initializeState(),this.setState({data0:ks(this.props.data,e=>e.LandUse[0]==0),data1:ks(this.props.data,e=>e.LandUse[0]==1),data2:ks(this.props.data,e=>e.LandUse[0]==2),data3:ks(this.props.data,e=>e.LandUse[0]==3)})}renderLayers(){const{data:e,slide:n,curScenario:i,speedyCounter:r,displayGW:s,displayDiff:u,displayUnmet:a,displayDemand:y,displayLandUse:w}=this.props,I=n>=22;return[new yr({id:"HoveringTilesEpilogue",data:e,thicknessRange:[0,1],filled:!0,extruded:!1,raised:!1,getFillColor:[0,0,0,0],visible:I,pickable:!0,autoHighlight:!0}),new yr({id:"GroundwaterEpilogue",data:e,thicknessRange:[0,1],filled:!0,extruded:!1,raised:!1,getFillColor:P=>am(P.properties.Groundwater[r]),visible:s&&I,opacity:.2,updateTriggers:{getFillColor:[r]}}),new yr({id:"DifferenceEpilogue",data:e,thicknessRange:[.5,.65],filled:!0,extruded:!1,raised:!1,getFillColor:P=>Xh(P.properties.UnmetDemand[ii[i]][r]-P.properties.UnmetDemandBaseline[r]),visible:u&&I,opacity:1,updateTriggers:{getFillColor:[r,i]}}),new Or({id:"ScenarioUnmetEpilogue",data:e,loaders:[gr],mesh:"assets/drop.obj",raised:!0,extruded:!1,getColor:[255,130,35],getValue:P=>Hc(P.properties.UnmetDemand[ii[i]][r]),sizeScale:3e3,visible:a&&I,opacity:1,updateTriggers:{getTranslation:[r,i]}}),new Or({id:"ScenarioDemandEpilogue",data:e,loaders:[gr],mesh:"assets/drop.obj",raised:!0,extruded:!1,getColor:[255,130,35],getValue:P=>V_(P.properties.Demand[ii[i]][r]),sizeScale:3e3,visible:y&&I,opacity:1,updateTriggers:{getTranslation:[r,i]}}),new Or({id:"SettlementIconsEpilogue",data:this.state.data0,loaders:[gr],mesh:"assets/dam.obj",raised:!1,getColor:[255,127,206],sizeScale:.8*500,visible:w&&I,opacity:1,updateTriggers:{getTranslation:[r]}}),new Or({id:"ExhangeIconsEpilogue",data:this.state.data1,loaders:[gr],mesh:"assets/cow.obj",raised:!1,getColor:[255,127,206],sizeScale:.8*550,visible:w&&I,opacity:1,updateTriggers:{getTranslation:[r]}}),new Or({id:"ProjectIconsEpilogue",data:this.state.data2,loaders:[gr],mesh:"assets/project.obj",raised:!1,getColor:[255,127,206],sizeScale:.8*180,visible:w&&I,opacity:1,updateTriggers:{getTranslation:[r]}}),new Or({id:"NonProjectIconsEpilogue",data:this.state.data3,loaders:[gr],mesh:"assets/nonproject.obj",raised:!1,getColor:[255,127,206],sizeScale:.8*140,visible:w&&I,opacity:1,updateTriggers:{getTranslation:[r]}})]}}u7.layerName="SlideEpilogue";u7.defaultProps={...Kn.defaultProps,autoHighlight:!0};const ope={0:"This is Californias <b>Central Valley</b>, home to over 7 million people and 18% of Californias total population. (2020 US Census)",1:"We have lots of demand that tends to cycle through highs and lows depending on the time of the year, peaking at around July. Each drop that you see represents a unit of <b>demand</b> for water.",2:"However, our groundwater supply stays consistent throughout the year, and usually cannot keep up during peak demands.",3:"This leads to unmet demand. For example, take May 2007. This is the demand of that month.",4:"This is unmet demand. As you can see, not everyone will get their demand. Notice anything?",5:"Lets try another timestep. This is water demand from July 2021.",6:"This is unmet demand.",7:`This is the average over 100 years. We can see that the areas of <b style="color: rgb(${Tw});">unmet demand</b> does not necessarily correspond with areas of <b style="color: rgb(${D1});">demand</b>.`,8:"If we take a closer look at this region, we can investigate what might have contributed to this inequity.",9:`If we overlay the map with land holders, we can see that exchange holders, symbolized with cows, are the ones predominantly demanding high amounts of <b style="color: rgb(${D1});">demand</b>. However, they arent suffering from as high <b style="color: rgb(${Tw});">unmet demand</b>. In fact, they seem to be doing quite well.`,10:`What we should expect is more of the following. Here, a patch of land held by project holders are symbolized with a paper scroll. This area contends with high levels of <b style="color: rgb(${Tw});">unmet demand</b>; this is expected, since it has high levels of <b style="color: rgb(${D1});">demand</b>.`,11:`On the other hand, settlement holders are similar to exchange holders in that they also historically have <b style="color: rgb(${D1});">high demand</b>, but get special treatment as well.`,12:"In fact, we can see on average, settlement and exchange land holders get higher water delivery rates because they are higher priority; this is how they are able to maintain low average levels of unmet demand even though they have high average levels of demand.",13:"And this does not necessarily correspond to groundwater supply.",14:"Thus, we can see that due to certain government policies, certain regions get higher priority and access to water supply, even if their demand largely outweigh surrounding regions. The question is, is this the only option?",15:"Certainly not. That is where CalSim comes in, a simulation program that plays out the what-if scenarios. Imagine an alternate universe where government policies were different; well call this Scenario 1. Let us revisit the first time step from earlier, May 2007.",16:`This time, the rings indicate regions that are doing <b style="color: rgb(${nde});">better</b> or <b style="color: rgb(${ide});">worse</b> than real-life, or historical, baselines.`,17:"Notice that now in this region, unmet demand is now more equal across regions, at the cost of some regions doing better than historical levels and other regions doing worse than historical levels.",18:"What about another alternate scenario, Scenario 2? We can see that this scenario favors less equal distribution of unmet demand at the tradeoff of keeping levels closer to baseline historical level.",19:"Scenario 3 is somewhere in between.",20:"Heres a timestep with more dramatic differences between scenarios, July 2021.",21:"As you may have noticed, rarely is there a situation where everyone wins. Tradeoffs must be made between regions, if not between months, and who and when to save water. With climate change and increasing population in the Central Valley, these choices become all the more pertinent. Which scenario is best? That choice is up to <b>you</b>.<br/><i>Data from James Gilbert (NOAA)</i>"};Object.values(ope).length;const lk=Fa(t7,.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),Ak=Fa(t7,.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),uk=Fa("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),ck=Fa("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t));function ape({counter:t,displayMonth:e,dataset:n}){const i=(t+9)%12+1,r=_t.useRef();_t.useEffect(()=>{r.current=Object.groupBy(iw[n],(w,I)=>py(I).toLocaleString("default",{year:"numeric"}))},[n]);const s=ys().domain([0,t3(iw[n],w=>w)]).range([40,90]),u=ys().domain([1,12]).range([0,2*Math.PI]),a=yI().radius(w=>s(w)).curve(vI).angle((w,I)=>u((I+9)%12+1)),y=yI().radius(w=>s(w)).curve(vI).angle((w,I)=>u(I%12+1));_t.useEffect(()=>(Sa("#clockContainer").style("visibility","visible"),Sa("#pieOutline path").attr("d",mI().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*2)).attr("fill","none").attr("stroke",n=="averageGroundwater"?`rgb(${lk})`:`rgba(${uk}, 1)`),Sa("#demandLine path").data([iw[n]]).join("path").attr("d",w=>a(w)).attr("stroke",n=="averageGroundwater"?`rgba(${Ak}, 0.3)`:`rgba(${ck}, 0.3)`).attr("stroke-width","0.2").attr("fill","none"),function(){Sa("#clockContainer").style("visibility","hidden"),Sa("#pie path").attr("d",""),Sa("#pieOutline path").attr("d",""),Sa("#demandLine path").attr("d",""),Sa("#demandLineCur path").attr("d",""),Sa("#date").text("")}),[n]),_t.useEffect(()=>{Sa("#pie path").attr("d",mI().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*i/12*2)).attr("fill",n=="averageGroundwater"?`rgb(${lk})`:`rgba(${uk}, 1)`);let w=py(t);e?Sa("#date").html("<b>"+w.toLocaleString("default",{year:"numeric"})+"</b><br/>"+w.toLocaleString("default",{month:"long"})):Sa("#date").html("<b>"+w.toLocaleString("default",{year:"numeric"})+"</b>"),Pne("#demandLineCur path").data([r.current[py(t).toLocaleString("default",{year:"numeric"})]]).join("path").attr("d",I=>y(I)).attr("stroke",n=="averageGroundwater"?`rgba(${Ak}, 1)`:`rgba(${ck}, 1)`).attr("stroke-width","2").attr("fill","none")},[n,t])}function lpe({slide:t,setCurScenario:e}){const[n,i]=_t.useState(sde),[r,s]=_t.useState(!1),u=_t.useCallback(()=>{i({...ode,onTransitionEnd:()=>s(!1)})},[]),a=_t.useCallback(()=>{i({...lde,onTransitionEnd:()=>s(!1)})},[]),y=_t.useCallback(()=>{i({...Ade,onTransitionEnd:()=>s(!1)})},[]),w=_t.useCallback(()=>{i({...ude,onTransitionEnd:()=>s(!1)})},[]),I=_t.useCallback(()=>{i({...tk,onTransitionEnd:()=>s(!1)})},[]),P=_t.useCallback(()=>{s(!0),i({...ade,onTransitionEnd:a})},[]),L=_t.useCallback(()=>{s(!0),i({...tk,onTransitionEnd:y})},[]);return _t.useEffect(()=>{t==8?(s(!0),u()):t==10?L():t==11?P():t==12?(s(!0),I()):t==17&&(s(!0),w()),ri(t,15,17)?e(0):t==18?e(1):t==19&&e(2)},[t]),{curViewState:n,transitioning:r}}function Ape({slide:t}){const[e,n]=_t.useState(1027),[i,r]=_t.useState(1027),[s,u]=_t.useState(!1),[a,y]=_t.useState(0),[w,I]=_t.useState(!1);return _t.useEffect(()=>{if(s){let P=setTimeout(()=>r(L=>L%1199+1),33.333333333333336);return function(){clearTimeout(P)}}},[i,s]),_t.useEffect(()=>{if(ri(t,1,2)){I(!0);let P=setTimeout(()=>n(L=>L%1199+1),250);return function(){clearTimeout(P),I(!1)}}},[e,t]),_t.useEffect(()=>{if(ri(t,20,21)){let P=setTimeout(()=>y(L=>(L+1)%1e3),2e3);return function(){clearTimeout(P)}}},[a,t]),{counter:e,setCounter:n,speedyCounter:i,setSpeedyCounter:r,playing:s,setPlaying:u,cycler:a,setCycler:y,counting:w,setCounting:I}}class c7 extends Kn{initializeState(){super.initializeState(),this.setState({data0:ks(this.props.data,e=>e.LandUse[0]==0),data1:ks(this.props.data,e=>e.LandUse[0]==1),data2:ks(this.props.data,e=>e.LandUse[0]==2),data3:ks(this.props.data,e=>e.LandUse[0]==3)})}renderLayers(){const{data:e,curScenario:n,speedyCounter:i,displayGW:r,displayDiff:s,displayUnmet:u,displayDemand:a,displayLandUse:y,displayDemAsRings:w,hoveredHex:I,clickedHexes:P,hoveredGeoActive:L,hoveredGeos:U,selectedGeoJSON:Q,selectedGeos:Z,selectionFinalized:ae}=this.props;return[new dl({id:"GeoJsonExt",data:Q,opacity:.75,extruded:!0,getElevation:Y=>e7(n>-1?Y.properties.UnmetDemand[ii[n]][i]:Y.properties.UnmetDemandBaseline[i]),pickable:!0,getLineWidth:100,getFillColor:Y=>{let te=Ph(n>-1?Y.properties.UnmetDemand[ii[n]][i]:Y.properties.UnmetDemandBaseline[i]);if(te[3]==0&&(te=[255,255,255,255]),Y.properties.DU_ID==L){const re=[0,0,.5019607843137255,.5019607843137255];return[(re[0]*re[3]+te[0]/255*(1-re[3]))*255,(re[1]*re[3]+te[1]/255*(1-re[3]))*255,(re[2]*re[3]+te[2]/255*(1-re[3]))*255,(re[3]*re[3]+te[3]/255*(1-re[3]))*255]}return te},updateTriggers:{getFillColor:[n,i,L,ae],getElevation:[n,i]}}),new dl({id:"GeoJsonGray",data:Qh,opacity:.3,stroked:!1,getFillColor:Y=>!ae&&Y.properties.DU_ID in U?[100,100,100,205*U[Y.properties.DU_ID]+50]:[0,0,0,0],visible:!ae,updateTriggers:{getFillColor:[I,ae]}}),new dl({id:"GeoJsonColor",data:{type:"FeatureCollection",features:Qh.features.filter(Y=>Y.properties.DU_ID in Z)},opacity:.3,pickable:!0,getLineWidth:Y=>Y.properties.DU_ID==L?100:20,getFillColor:Y=>{if(Y.properties.DU_ID==L){const te=[0,0,.5019607843137255,.5019607843137255],re=Ph(n>-1?Z[Y.properties.DU_ID].UnmetDemand[ii[n]][i]:Z[Y.properties.DU_ID].UnmetDemandBaseline[i]);return[(te[0]*te[3]+re[0]/255*(1-te[3]))*255,(te[1]*te[3]+re[1]/255*(1-te[3]))*255,(te[2]*te[3]+re[2]/255*(1-te[3]))*255,(te[3]*te[3]+re[3]/255*(1-te[3]))*255]}return Y.properties.DU_ID in Z?Ph(n>-1?Z[Y.properties.DU_ID].UnmetDemand[ii[n]][i]:Z[Y.properties.DU_ID].UnmetDemandBaseline[i]):[0,0,0,0]},getLineColor:[0,0,0],updateTriggers:{getFillColor:[L,n,ae],getLineWidth:[L]}}),new yr({id:"HoveringTiles",data:e,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:!ae,autoHighlight:!ae}),new yr({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:Y=>colorInterpGW(Y.properties.Groundwater[i]),visible:r,opacity:.2,updateTriggers:{getFillColor:[i]}}),new yr({id:"Difference",data:e,thicknessRange:[.5,.65],getFillColor:Y=>colorInterpDemDiff(n<0?0:Y.properties.UnmetDemand[ii[n]][i]-Y.properties.UnmetDemandBaseline[i]),visible:s&&n>-1,opacity:1,updateTriggers:{getFillColor:[n,i]}}),new yr({id:"UnmetRings",data:e,thicknessRange:[.4,.65],getFillColor:Y=>Ph(n>-1?Y.properties.UnmetDemand[ii[n]][i]:Y.properties.UnmetDemandBaseline[i]),getValue:Y=>$O(n>-1?1:Y.properties.MUnmetDemandBaseline[i]),raised:!0,getElevation:Y=>Y.hexId in P?5e3:0,getLineWidth:Y=>Y.hexId in P?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],visible:u&&w,getOffset:-.5,extensions:[new R2({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,i],getValue:[n,i],getElevation:[ae],getLineWidth:[ae]}}),new yr({id:"DemandRings",data:e,thicknessRange:[.5,.65],getFillColor:Y=>colorInterpDem(n>-1?Y.properties.Demand[ii[n]][i]:Y.properties.DemandBaseline[i]),visible:a&&w,opacity:1,updateTriggers:{getFillColor:[n,i]}}),new Or({id:"ScenarioUnmet",data:e,loaders:[gr],mesh:"assets/drop.obj",raised:!0,getColor:[255,130,35],getValue:Y=>valueInterpUDem(n>-1?Y.properties.UnmetDemand[ii[n]][i]:Y.properties.UnmetDemandBaseline[i]),sizeScale:3e3,visible:u&&!w,opacity:1,updateTriggers:{getTranslation:[n,i]}}),new Or({id:"ScenarioDemand",data:e,loaders:[gr],mesh:"assets/drop.obj",raised:!0,getColor:[255,130,35],getValue:Y=>valueInterpDem(n>-1?Y.properties.Demand[ii[n]][i]:Y.properties.DemandBaseline[i]),sizeScale:3e3,visible:a&&!w,opacity:1,updateTriggers:{getTranslation:[n,i]}}),new Or({id:"SettlementIcons",data:this.state.data0,loaders:[gr],mesh:"assets/dam.obj",getColor:[255,127,206],sizeScale:.8*500,visible:y,opacity:1,updateTriggers:{getTranslation:[i]}}),new Or({id:"ExhangeIcons",data:this.state.data1,loaders:[gr],mesh:"assets/cow.obj",getColor:[255,127,206],sizeScale:.8*550,visible:y,opacity:1,updateTriggers:{getTranslation:[i]}}),new Or({id:"ProjectIcons",data:this.state.data2,loaders:[gr],mesh:"assets/project.obj",getColor:[255,127,206],sizeScale:.8*180,visible:y,opacity:1,updateTriggers:{getTranslation:[i]}}),new Or({id:"NonProjectIcons",data:this.state.data3,loaders:[gr],mesh:"assets/nonproject.obj",getColor:[255,127,206],sizeScale:.8*140,visible:y,opacity:1,updateTriggers:{getTranslation:[i]}})]}}c7.layerName="SandboxSlide";c7.defaultProps={...Kn.defaultProps};class IS extends Kn{renderLayers(){return[new D2({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:i,east:r,north:s}}=e.tile;return new S2(e,{data:null,image:e.data,bounds:[n,i,r,s]})}})]}}IS.layerName="SlideTerrain";IS.defaultProps={...Kn.defaultProps};function upe(t,e){var n,i,r,s,u,a,y,w,I,P,L=0,U=t.type==="FeatureCollection",Q=t.type==="Feature",Z=U?t.features.length:1;for(n=0;n<Z;n++){for(a=U?t.features[n].geometry:Q?t.geometry:t,w=U?t.features[n].properties:Q?t.properties:{},I=U?t.features[n].bbox:Q?t.bbox:void 0,P=U?t.features[n].id:Q?t.id:void 0,y=a?a.type==="GeometryCollection":!1,u=y?a.geometries.length:1,r=0;r<u;r++){if(s=y?a.geometries[r]:a,s===null){if(e(null,L,w,I,P)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,L,w,I,P)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<s.geometries.length;i++)if(e(s.geometries[i],L,w,I,P)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}L++}}function cpe(t,e,n){var i=n;return upe(t,function(r,s,u,a,y){s===0&&n===void 0?i=r:i=e(i,r,s,u,a,y)}),i}var hk=6378137;function fk(t){return cpe(t,function(e,n){return e+hpe(n)},0)}function hpe(t){var e=0,n;switch(t.type){case"Polygon":return dk(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)e+=dk(t.coordinates[n]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function dk(t){var e=0;if(t&&t.length>0){e+=Math.abs(pk(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(pk(t[n]))}return e}function pk(t){var e,n,i,r,s,u,a,y=0,w=t.length;if(w>2){for(a=0;a<w;a++)a===w-2?(r=w-2,s=w-1,u=0):a===w-1?(r=w-1,s=0,u=1):(r=a,s=a+1,u=a+2),e=t[r],n=t[s],i=t[u],y+=(Sw(i[0])-Sw(e[0]))*Math.sin(Sw(n[1]));y=y*hk*hk/2}return y}function Sw(t){return t*Math.PI/180}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function fpe(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,u;return u={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function a(w){return function(I){return y([w,I])}}function y(w){if(i)throw new TypeError("Generator is already executing.");for(;n;)try{if(i=1,r&&(s=w[0]&2?r.return:w[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,w[1])).done)return s;switch(r=0,s&&(w=[w[0]&2,s.value]),w[0]){case 0:case 1:s=w;break;case 4:return n.label++,{value:w[1],done:!1};case 5:n.label++,r=w[1],w=[0];continue;case 7:w=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(w[0]===6||w[0]===2)){n=0;continue}if(w[0]===3&&(!s||w[1]>s[0]&&w[1]<s[3])){n.label=w[1];break}if(w[0]===6&&n.label<s[1]){n.label=s[1],s=w;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(w);break}s[2]&&n.ops.pop(),n.trys.pop();continue}w=e.call(t,n)}catch(I){w=[6,I],r=0}finally{i=s=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}}var Jc=function(){function t(e,n){this.next=null,this.key=e,this.data=n,this.left=null,this.right=null}return t}();function dpe(t,e){return t>e?1:t<e?-1:0}function Cc(t,e,n){for(var i=new Jc(null,null),r=i,s=i;;){var u=n(t,e.key);if(u<0){if(e.left===null)break;if(n(t,e.left.key)<0){var a=e.left;if(e.left=a.right,a.right=e,e=a,e.left===null)break}s.left=e,s=e,e=e.left}else if(u>0){if(e.right===null)break;if(n(t,e.right.key)>0){var a=e.right;if(e.right=a.left,a.left=e,e=a,e.right===null)break}r.right=e,r=e,e=e.right}else break}return r.right=e.left,s.left=e.right,e.left=i.right,e.right=i.left,e}function Mw(t,e,n,i){var r=new Jc(t,e);if(n===null)return r.left=r.right=null,r;n=Cc(t,n,i);var s=i(t,n.key);return s<0?(r.left=n.left,r.right=n,n.left=null):s>=0&&(r.right=n.right,r.left=n,n.right=null),r}function gk(t,e,n){var i=null,r=null;if(e){e=Cc(t,e,n);var s=n(e.key,t);s===0?(i=e.left,r=e.right):s<0?(r=e.right,e.right=null,i=e):(i=e.left,e.left=null,r=e)}return{left:i,right:r}}function ppe(t,e,n){return e===null?t:(t===null||(e=Cc(t.key,e,n),e.left=t),e)}function H3(t,e,n,i,r){if(t){i(""+e+(n?" ":" ")+r(t)+`
`);var s=e+(n?"    ":"   ");t.left&&H3(t.left,s,!1,i,r),t.right&&H3(t.right,s,!0,i,r)}}var kS=function(){function t(e){e===void 0&&(e=dpe),this._root=null,this._size=0,this._comparator=e}return t.prototype.insert=function(e,n){return this._size++,this._root=Mw(e,n,this._root,this._comparator)},t.prototype.add=function(e,n){var i=new Jc(e,n);this._root===null&&(i.left=i.right=null,this._size++,this._root=i);var r=this._comparator,s=Cc(e,this._root,r),u=r(e,s.key);return u===0?this._root=s:(u<0?(i.left=s.left,i.right=s,s.left=null):u>0&&(i.right=s.right,i.left=s,s.right=null),this._size++,this._root=i),this._root},t.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},t.prototype._remove=function(e,n,i){var r;if(n===null)return null;n=Cc(e,n,i);var s=i(e,n.key);return s===0?(n.left===null?r=n.right:(r=Cc(e,n.left,i),r.right=n.right),this._size--,r):n},t.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=Cc(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},t.prototype.findStatic=function(e){for(var n=this._root,i=this._comparator;n;){var r=i(e,n.key);if(r===0)return n;r<0?n=n.left:n=n.right}return null},t.prototype.find=function(e){return this._root&&(this._root=Cc(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},t.prototype.contains=function(e){for(var n=this._root,i=this._comparator;n;){var r=i(e,n.key);if(r===0)return!0;r<0?n=n.left:n=n.right}return!1},t.prototype.forEach=function(e,n){for(var i=this._root,r=[],s=!1;!s;)i!==null?(r.push(i),i=i.left):r.length!==0?(i=r.pop(),e.call(n,i),i=i.right):s=!0;return this},t.prototype.range=function(e,n,i,r){for(var s=[],u=this._comparator,a=this._root,y;s.length!==0||a;)if(a)s.push(a),a=a.left;else{if(a=s.pop(),y=u(a.key,n),y>0)break;if(u(a.key,e)>=0&&i.call(r,a))return this;a=a.right}return this},t.prototype.keys=function(){var e=[];return this.forEach(function(n){var i=n.key;return e.push(i)}),e},t.prototype.values=function(){var e=[];return this.forEach(function(n){var i=n.data;return e.push(i)}),e},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},t.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},t.prototype.at=function(e){for(var n=this._root,i=!1,r=0,s=[];!i;)if(n)s.push(n),n=n.left;else if(s.length>0){if(n=s.pop(),r===e)return n;r++,n=n.right}else i=!0;return null},t.prototype.next=function(e){var n=this._root,i=null;if(e.right){for(i=e.right;i.left;)i=i.left;return i}for(var r=this._comparator;n;){var s=r(e.key,n.key);if(s===0)break;s<0?(i=n,n=n.left):n=n.right}return i},t.prototype.prev=function(e){var n=this._root,i=null;if(e.left!==null){for(i=e.left;i.right;)i=i.right;return i}for(var r=this._comparator;n;){var s=r(e.key,n.key);if(s===0)break;s<0?n=n.left:(i=n,n=n.right)}return i},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return mpe(this._root)},t.prototype.load=function(e,n,i){n===void 0&&(n=[]),i===void 0&&(i=!1);var r=e.length,s=this._comparator;if(i&&q3(e,n,0,r-1,s),this._root===null)this._root=W3(e,n,0,r),this._size=r;else{var u=ype(this.toList(),gpe(e,n),s);r=this._size+r,this._root=Q3({head:u},0,r)}return this},t.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){e===void 0&&(e=function(i){return String(i.key)});var n=[];return H3(this._root,"",!0,function(i){return n.push(i)},e),n.join("")},t.prototype.update=function(e,n,i){var r=this._comparator,s=gk(e,this._root,r),u=s.left,a=s.right;r(e,n)<0?a=Mw(n,i,a,r):u=Mw(n,i,u,r),this._root=ppe(u,a,r)},t.prototype.split=function(e){return gk(e,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var e,n,i;return fpe(this,function(r){switch(r.label){case 0:e=this._root,n=[],i=!1,r.label=1;case 1:return i?[3,6]:e===null?[3,2]:(n.push(e),e=e.left,[3,5]);case 2:return n.length===0?[3,4]:(e=n.pop(),[4,e]);case 3:return r.sent(),e=e.right,[3,5];case 4:i=!0,r.label=5;case 5:return[3,1];case 6:return[2]}})},t}();function W3(t,e,n,i){var r=i-n;if(r>0){var s=n+Math.floor(r/2),u=t[s],a=e[s],y=new Jc(u,a);return y.left=W3(t,e,n,s),y.right=W3(t,e,s+1,i),y}return null}function gpe(t,e){for(var n=new Jc(null,null),i=n,r=0;r<t.length;r++)i=i.next=new Jc(t[r],e[r]);return i.next=null,n.next}function mpe(t){for(var e=t,n=[],i=!1,r=new Jc(null,null),s=r;!i;)e?(n.push(e),e=e.left):n.length>0?(e=s=s.next=n.pop(),e=e.right):i=!0;return s.next=null,r.next}function Q3(t,e,n){var i=n-e;if(i>0){var r=e+Math.floor(i/2),s=Q3(t,e,r),u=t.head;return u.left=s,t.head=t.head.next,u.right=Q3(t,r+1,n),u}return null}function ype(t,e,n){for(var i=new Jc(null,null),r=i,s=t,u=e;s!==null&&u!==null;)n(s.key,u.key)<0?(r.next=s,s=s.next):(r.next=u,u=u.next),r=r.next;return s!==null?r.next=s:u!==null&&(r.next=u),i.next}function q3(t,e,n,i,r){if(!(n>=i)){for(var s=t[n+i>>1],u=n-1,a=i+1;;){do u++;while(r(t[u],s)<0);do a--;while(r(t[a],s)>0);if(u>=a)break;var y=t[u];t[u]=t[a],t[a]=y,y=e[u],e[u]=e[a],e[a]=y}q3(t,e,n,a,r),q3(t,e,a+1,i,r)}}const cp=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,Z3=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;const n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,i=t.ur.x<e.ur.x?t.ur.x:e.ur.x,r=t.ll.y<e.ll.y?e.ll.y:t.ll.y,s=t.ur.y<e.ur.y?t.ur.y:e.ur.y;return{ll:{x:n,y:r},ur:{x:i,y:s}}};let Rc=Number.EPSILON;Rc===void 0&&(Rc=Math.pow(2,-52));const _pe=Rc*Rc,mk=(t,e)=>{if(-Rc<t&&t<Rc&&-Rc<e&&e<Rc)return 0;const n=t-e;return n*n<_pe*t*e?0:t<e?-1:1};class vpe{constructor(){this.reset()}reset(){this.xRounder=new yk,this.yRounder=new yk}round(e,n){return{x:this.xRounder.round(e),y:this.yRounder.round(n)}}}class yk{constructor(){this.tree=new kS,this.round(0)}round(e){const n=this.tree.add(e),i=this.tree.prev(n);if(i!==null&&mk(n.key,i.key)===0)return this.tree.remove(e),i.key;const r=this.tree.next(n);return r!==null&&mk(n.key,r.key)===0?(this.tree.remove(e),r.key):e}}const Lg=new vpe,gy=(t,e)=>t.x*e.y-t.y*e.x,h7=(t,e)=>t.x*e.x+t.y*e.y,_k=(t,e,n)=>{const i=Lre(t.x,t.y,e.x,e.y,n.x,n.y);return i>0?-1:i<0?1:0},H_=t=>Math.sqrt(h7(t,t)),xpe=(t,e,n)=>{const i={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y};return gy(r,i)/H_(r)/H_(i)},wpe=(t,e,n)=>{const i={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y};return h7(r,i)/H_(r)/H_(i)},vk=(t,e,n)=>e.y===0?null:{x:t.x+e.x/e.y*(n-t.y),y:n},xk=(t,e,n)=>e.x===0?null:{x:n,y:t.y+e.y/e.x*(n-t.x)},bpe=(t,e,n,i)=>{if(e.x===0)return xk(n,i,t.x);if(i.x===0)return xk(t,e,n.x);if(e.y===0)return vk(n,i,t.y);if(i.y===0)return vk(t,e,n.y);const r=gy(e,i);if(r==0)return null;const s={x:n.x-t.x,y:n.y-t.y},u=gy(s,e)/r,a=gy(s,i)/r,y=t.x+a*e.x,w=n.x+u*i.x,I=t.y+a*e.y,P=n.y+u*i.y,L=(y+w)/2,U=(I+P)/2;return{x:L,y:U}};class al{static compare(e,n){const i=al.comparePoints(e.point,n.point);return i!==0?i:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:Qc.compare(e.segment,n.segment))}static comparePoints(e,n){return e.x<n.x?-1:e.x>n.x?1:e.y<n.y?-1:e.y>n.y?1:0}constructor(e,n){e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const n=e.point.events;for(let i=0,r=n.length;i<r;i++){const s=n[i];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let n=0;n<e;n++){const i=this.point.events[n];if(i.segment.consumedBy===void 0)for(let r=n+1;r<e;r++){const s=this.point.events[r];s.consumedBy===void 0&&i.otherSE.point.events===s.otherSE.point.events&&i.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const e=[];for(let n=0,i=this.point.events.length;n<i;n++){const r=this.point.events[n];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&e.push(r)}return e}getLeftmostComparator(e){const n=new Map,i=r=>{const s=r.otherSE;n.set(r,{sine:xpe(this.point,e.point,s.point),cosine:wpe(this.point,e.point,s.point)})};return(r,s)=>{n.has(r)||i(r),n.has(s)||i(s);const{sine:u,cosine:a}=n.get(r),{sine:y,cosine:w}=n.get(s);return u>=0&&y>=0?a<w?1:a>w?-1:0:u<0&&y<0?a<w?-1:a>w?1:0:y<u?-1:y>u?1:0}}}let Epe=0;class Qc{static compare(e,n){const i=e.leftSE.point.x,r=n.leftSE.point.x,s=e.rightSE.point.x,u=n.rightSE.point.x;if(u<i)return 1;if(s<r)return-1;const a=e.leftSE.point.y,y=n.leftSE.point.y,w=e.rightSE.point.y,I=n.rightSE.point.y;if(i<r){if(y<a&&y<w)return 1;if(y>a&&y>w)return-1;const P=e.comparePoint(n.leftSE.point);if(P<0)return 1;if(P>0)return-1;const L=n.comparePoint(e.rightSE.point);return L!==0?L:-1}if(i>r){if(a<y&&a<I)return-1;if(a>y&&a>I)return 1;const P=n.comparePoint(e.leftSE.point);if(P!==0)return P;const L=e.comparePoint(n.rightSE.point);return L<0?1:L>0?-1:1}if(a<y)return-1;if(a>y)return 1;if(s<u){const P=n.comparePoint(e.rightSE.point);if(P!==0)return P}if(s>u){const P=e.comparePoint(n.rightSE.point);if(P<0)return 1;if(P>0)return-1}if(s!==u){const P=w-a,L=s-i,U=I-y,Q=u-r;if(P>L&&U<Q)return 1;if(P<L&&U>Q)return-1}return s>u?1:s<u||w<I?-1:w>I?1:e.id<n.id?-1:e.id>n.id?1:0}constructor(e,n,i,r){this.id=++Epe,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=i,this.windings=r}static fromRing(e,n,i){let r,s,u;const a=al.comparePoints(e,n);if(a<0)r=e,s=n,u=1;else if(a>0)r=n,s=e,u=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const y=new al(r,!0),w=new al(s,!1);return new Qc(y,w,[i],[u])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<n?e:n},ur:{x:this.rightSE.point.x,y:e>n?e:n}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}comparePoint(e){if(this.isAnEndpoint(e))return 0;const n=this.leftSE.point,i=this.rightSE.point,r=this.vector();if(n.x===i.x)return e.x===n.x?0:e.x<n.x?1:-1;const s=(e.y-n.y)/r.y,u=n.x+s*r.x;if(e.x===u)return 0;const a=(e.x-n.x)/r.x,y=n.y+a*r.y;return e.y===y?0:e.y<y?-1:1}getIntersection(e){const n=this.bbox(),i=e.bbox(),r=Z3(n,i);if(r===null)return null;const s=this.leftSE.point,u=this.rightSE.point,a=e.leftSE.point,y=e.rightSE.point,w=cp(n,a)&&this.comparePoint(a)===0,I=cp(i,s)&&e.comparePoint(s)===0,P=cp(n,y)&&this.comparePoint(y)===0,L=cp(i,u)&&e.comparePoint(u)===0;if(I&&w)return L&&!P?u:!L&&P?y:null;if(I)return P&&s.x===y.x&&s.y===y.y?null:s;if(w)return L&&u.x===a.x&&u.y===a.y?null:a;if(L&&P)return null;if(L)return u;if(P)return y;const U=bpe(s,this.vector(),a,e.vector());return U===null||!cp(r,U)?null:Lg.round(U.x,U.y)}split(e){const n=[],i=e.events!==void 0,r=new al(e,!0),s=new al(e,!1),u=this.rightSE;this.replaceRightSE(s),n.push(s),n.push(r);const a=new Qc(r,u,this.rings.slice(),this.windings.slice());return al.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),al.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(r.checkForConsuming(),s.checkForConsuming()),n}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,i=this.windings.length;n<i;n++)this.windings[n]*=-1}consume(e){let n=this,i=e;for(;n.consumedBy;)n=n.consumedBy;for(;i.consumedBy;)i=i.consumedBy;const r=Qc.compare(n,i);if(r!==0){if(r>0){const s=n;n=i,i=s}if(n.prev===i){const s=n;n=i,i=s}for(let s=0,u=i.rings.length;s<u;s++){const a=i.rings[s],y=i.windings[s],w=n.rings.indexOf(a);w===-1?(n.rings.push(a),n.windings.push(y)):n.windings[w]+=y}i.rings=null,i.windings=null,i.consumedBy=n,i.leftSE.consumedBy=n.leftSE,i.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,i=this._afterState.windings,r=this._afterState.multiPolys;for(let a=0,y=this.rings.length;a<y;a++){const w=this.rings[a],I=this.windings[a],P=n.indexOf(w);P===-1?(n.push(w),i.push(I)):i[P]+=I}const s=[],u=[];for(let a=0,y=n.length;a<y;a++){if(i[a]===0)continue;const w=n[a],I=w.poly;if(u.indexOf(I)===-1)if(w.isExterior)s.push(I);else{u.indexOf(I)===-1&&u.push(I);const P=s.indexOf(w.poly);P!==-1&&s.splice(P,1)}}for(let a=0,y=s.length;a<y;a++){const w=s[a].multiPoly;r.indexOf(w)===-1&&r.push(w)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(Yl.type){case"union":{const i=e.length===0,r=n.length===0;this._isInResult=i!==r;break}case"intersection":{let i,r;e.length<n.length?(i=e.length,r=n.length):(i=n.length,r=e.length),this._isInResult=r===Yl.numMultiPolys&&i<r;break}case"xor":{const i=Math.abs(e.length-n.length);this._isInResult=i%2===1;break}case"difference":{const i=r=>r.length===1&&r[0].isSubject;this._isInResult=i(e)!==i(n);break}default:throw new Error(`Unrecognized operation type found ${Yl.type}`)}return this._isInResult}}class wk{constructor(e,n,i){if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=i,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const r=Lg.round(e[0][0],e[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};let s=r;for(let u=1,a=e.length;u<a;u++){if(typeof e[u][0]!="number"||typeof e[u][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let y=Lg.round(e[u][0],e[u][1]);y.x===s.x&&y.y===s.y||(this.segments.push(Qc.fromRing(s,y,this)),y.x<this.bbox.ll.x&&(this.bbox.ll.x=y.x),y.y<this.bbox.ll.y&&(this.bbox.ll.y=y.y),y.x>this.bbox.ur.x&&(this.bbox.ur.x=y.x),y.y>this.bbox.ur.y&&(this.bbox.ur.y=y.y),s=y)}(r.x!==s.x||r.y!==s.y)&&this.segments.push(Qc.fromRing(s,r,this))}getSweepEvents(){const e=[];for(let n=0,i=this.segments.length;n<i;n++){const r=this.segments[n];e.push(r.leftSE),e.push(r.rightSE)}return e}}class Tpe{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new wk(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let i=1,r=e.length;i<r;i++){const s=new wk(e[i],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,i=this.interiorRings.length;n<i;n++){const r=this.interiorRings[n].getSweepEvents();for(let s=0,u=r.length;s<u;s++)e.push(r[s])}return e}}class bk{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let i=0,r=e.length;i<r;i++){const s=new Tpe(e[i],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,i=this.polys.length;n<i;n++){const r=this.polys[n].getSweepEvents();for(let s=0,u=r.length;s<u;s++)e.push(r[s])}return e}}class W_{static factory(e){const n=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];if(!s.isInResult()||s.ringOut)continue;let u=null,a=s.leftSE,y=s.rightSE;const w=[a],I=a.point,P=[];for(;u=a,a=y,w.push(a),a.point!==I;)for(;;){const L=a.getAvailableLinkedEvents();if(L.length===0){const Z=w[0].point,ae=w[w.length-1].point;throw new Error(`Unable to complete output ring starting at [${Z.x}, ${Z.y}]. Last matching segment found ends at [${ae.x}, ${ae.y}].`)}if(L.length===1){y=L[0].otherSE;break}let U=null;for(let Z=0,ae=P.length;Z<ae;Z++)if(P[Z].point===a.point){U=Z;break}if(U!==null){const Z=P.splice(U)[0],ae=w.splice(Z.index);ae.unshift(ae[0].otherSE),n.push(new W_(ae.reverse()));continue}P.push({index:w.length,point:a.point});const Q=a.getLeftmostComparator(u);y=L.sort(Q)[0].otherSE;break}n.push(new W_(w))}return n}constructor(e){this.events=e;for(let n=0,i=e.length;n<i;n++)e[n].segment.ringOut=this;this.poly=null}getGeom(){let e=this.events[0].point;const n=[e];for(let w=1,I=this.events.length-1;w<I;w++){const P=this.events[w].point,L=this.events[w+1].point;_k(P,e,L)!==0&&(n.push(P),e=P)}if(n.length===1)return null;const i=n[0],r=n[1];_k(i,e,r)===0&&n.shift(),n.push(n[0]);const s=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:n.length-1,a=this.isExteriorRing()?n.length:-1,y=[];for(let w=u;w!=a;w+=s)y.push([n[w].x,n[w].y]);return y}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let e=this.events[0];for(let r=1,s=this.events.length;r<s;r++){const u=this.events[r];al.compare(e,u)>0&&(e=u)}let n=e.segment.prevInResult(),i=n?n.prevInResult():null;for(;;){if(!n)return null;if(!i)return n.ringOut;if(i.ringOut!==n.ringOut)return i.ringOut.enclosingRing()!==n.ringOut?n.ringOut:n.ringOut.enclosingRing();n=i.prevInResult(),i=n?n.prevInResult():null}}}class Ek{constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(let n=0,i=this.interiorRings.length;n<i;n++){const r=this.interiorRings[n].getGeom();r!==null&&e.push(r)}return e}}class Spe{constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,i=this.polys.length;n<i;n++){const r=this.polys[n].getGeom();r!==null&&e.push(r)}return e}_composePolys(e){const n=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];if(!s.poly)if(s.isExteriorRing())n.push(new Ek(s));else{const u=s.enclosingRing();u.poly||n.push(new Ek(u)),u.poly.addInterior(s)}}return n}}class Mpe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qc.compare;this.queue=e,this.tree=new kS(n),this.segments=[]}process(e){const n=e.segment,i=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(n),i;const r=e.isLeft?this.tree.add(n):this.tree.find(n);if(!r)throw new Error(`Unable to find segment #${n.id} [${n.leftSE.point.x}, ${n.leftSE.point.y}] -> [${n.rightSE.point.x}, ${n.rightSE.point.y}] in SweepLine tree.`);let s=r,u=r,a,y;for(;a===void 0;)s=this.tree.prev(s),s===null?a=null:s.key.consumedBy===void 0&&(a=s.key);for(;y===void 0;)u=this.tree.next(u),u===null?y=null:u.key.consumedBy===void 0&&(y=u.key);if(e.isLeft){let w=null;if(a){const P=a.getIntersection(n);if(P!==null&&(n.isAnEndpoint(P)||(w=P),!a.isAnEndpoint(P))){const L=this._splitSafely(a,P);for(let U=0,Q=L.length;U<Q;U++)i.push(L[U])}}let I=null;if(y){const P=y.getIntersection(n);if(P!==null&&(n.isAnEndpoint(P)||(I=P),!y.isAnEndpoint(P))){const L=this._splitSafely(y,P);for(let U=0,Q=L.length;U<Q;U++)i.push(L[U])}}if(w!==null||I!==null){let P=null;w===null?P=I:I===null?P=w:P=al.comparePoints(w,I)<=0?w:I,this.queue.remove(n.rightSE),i.push(n.rightSE);const L=n.split(P);for(let U=0,Q=L.length;U<Q;U++)i.push(L[U])}i.length>0?(this.tree.remove(n),i.push(e)):(this.segments.push(n),n.prev=a)}else{if(a&&y){const w=a.getIntersection(y);if(w!==null){if(!a.isAnEndpoint(w)){const I=this._splitSafely(a,w);for(let P=0,L=I.length;P<L;P++)i.push(I[P])}if(!y.isAnEndpoint(w)){const I=this._splitSafely(y,w);for(let P=0,L=I.length;P<L;P++)i.push(I[P])}}}this.tree.remove(n)}return i}_splitSafely(e,n){this.tree.remove(e);const i=e.rightSE;this.queue.remove(i);const r=e.split(n);return r.push(i),e.consumedBy===void 0&&this.tree.add(e),r}}const Tk=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Cpe=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class Ppe{run(e,n,i){Yl.type=e,Lg.reset();const r=[new bk(n,!0)];for(let P=0,L=i.length;P<L;P++)r.push(new bk(i[P],!1));if(Yl.numMultiPolys=r.length,Yl.type==="difference"){const P=r[0];let L=1;for(;L<r.length;)Z3(r[L].bbox,P.bbox)!==null?L++:r.splice(L,1)}if(Yl.type==="intersection")for(let P=0,L=r.length;P<L;P++){const U=r[P];for(let Q=P+1,Z=r.length;Q<Z;Q++)if(Z3(U.bbox,r[Q].bbox)===null)return[]}const s=new kS(al.compare);for(let P=0,L=r.length;P<L;P++){const U=r[P].getSweepEvents();for(let Q=0,Z=U.length;Q<Z;Q++)if(s.insert(U[Q]),s.size>Tk)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const u=new Mpe(s);let a=s.size,y=s.pop();for(;y;){const P=y.key;if(s.size===a){const U=P.segment;throw new Error(`Unable to pop() ${P.isLeft?"left":"right"} SweepEvent [${P.point.x}, ${P.point.y}] from segment #${U.id} [${U.leftSE.point.x}, ${U.leftSE.point.y}] -> [${U.rightSE.point.x}, ${U.rightSE.point.y}] from queue.`)}if(s.size>Tk)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(u.segments.length>Cpe)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const L=u.process(P);for(let U=0,Q=L.length;U<Q;U++){const Z=L[U];Z.consumedBy===void 0&&s.insert(Z)}a=s.size,y=s.pop()}Lg.reset();const w=W_.factory(u.segments);return new Spe(w).getGeom()}}const Yl=new Ppe,Ipe=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Yl.run("union",t,n)},kpe=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Yl.run("intersection",t,n)},Lpe=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Yl.run("xor",t,n)},Dpe=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Yl.run("difference",t,n)};var Rpe={union:Ipe,intersection:kpe,xor:Lpe,difference:Dpe};function f7(t,e,n){n===void 0&&(n={});var i={type:"Feature"};return(n.id===0||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function Bpe(t,e,n){n===void 0&&(n={});for(var i=0,r=t;i<r.length;i++){var s=r[i];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var u=0;u<s[s.length-1].length;u++)if(s[s.length-1][u]!==s[0][u])throw new Error("First and last Position are not equivalent.")}var a={type:"Polygon",coordinates:t};return f7(a,e,n)}function zpe(t,e,n){n===void 0&&(n={});var i={type:"MultiPolygon",coordinates:t};return f7(i,e,n)}function Sk(t){return t.type==="Feature"?t.geometry:t}function Mk(t,e,n){n===void 0&&(n={});var i=Sk(t),r=Sk(e),s=Rpe.intersection(i.coordinates,r.coordinates);return s.length===0?null:s.length===1?Bpe(s[0],n.properties):zpe(s,n.properties)}var Pt=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},i;for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);var r="";function s(K){return e.locateFile?e.locateFile(K,r):r+K}var u;document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",u=function(H,ee,he){var o=new XMLHttpRequest;o.open("GET",H,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status==200||o.status==0&&o.response){ee(o.response);return}var Le=Ii(H);if(Le){ee(Le.buffer);return}he()},o.onerror=he,o.send(null)};var a=e.print||console.log.bind(console),y=e.printErr||console.warn.bind(console);for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i]);n=null,e.arguments&&e.arguments;var w=0,I=function(K){w=K},P=function(){return w},L=8;function U(K,H,ee,he){switch(ee=ee||"i8",ee.charAt(ee.length-1)==="*"&&(ee="i32"),ee){case"i1":nt[K>>0]=H;break;case"i8":nt[K>>0]=H;break;case"i16":gt[K>>1]=H;break;case"i32":Xt[K>>2]=H;break;case"i64":Pr=[H>>>0,(Ni=H,+ei(Ni)>=1?Ni>0?(li(+yi(Ni/4294967296),4294967295)|0)>>>0:~~+$n((Ni-+(~~Ni>>>0))/4294967296)>>>0:0)],Xt[K>>2]=Pr[0],Xt[K+4>>2]=Pr[1];break;case"float":Et[K>>2]=H;break;case"double":fn[K>>3]=H;break;default:Bi("invalid type for setValue: "+ee)}}function Q(K,H,ee){switch(H=H||"i8",H.charAt(H.length-1)==="*"&&(H="i32"),H){case"i1":return nt[K>>0];case"i8":return nt[K>>0];case"i16":return gt[K>>1];case"i32":return Xt[K>>2];case"i64":return Xt[K>>2];case"float":return Et[K>>2];case"double":return fn[K>>3];default:Bi("invalid type for getValue: "+H)}return null}var Z=!1;function ae(K,H){K||Bi("Assertion failed: "+H)}function Y(K){var H=e["_"+K];return ae(H,"Cannot call unknown function "+K+", make sure it is exported"),H}function te(K,H,ee,he,o){var G={string:function(ht){var Lt=0;if(ht!=null&&ht!==0){var Dt=(ht.length<<2)+1;Lt=zs(Dt),Qe(ht,Lt,Dt)}return Lt},array:function(ht){var Lt=zs(ht.length);return et(ht,Lt),Lt}};function Le(ht){return H==="string"?Me(ht):H==="boolean"?!!ht:ht}var Ie=Y(K),Pe=[],ke=0;if(he)for(var We=0;We<he.length;We++){var at=G[ee[We]];at?(ke===0&&(ke=or()),Pe[We]=at(he[We])):Pe[We]=he[We]}var $e=Ie.apply(null,Pe);return $e=Le($e),ke!==0&&Ri(ke),$e}function re(K,H,ee,he){ee=ee||[];var o=ee.every(function(Le){return Le==="number"}),G=H!=="string";return G&&o&&!he?Y(K):function(){return te(K,H,ee,arguments)}}var de=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function ve(K,H,ee){for(var he=H+ee,o=H;K[o]&&!(o>=he);)++o;if(o-H>16&&K.subarray&&de)return de.decode(K.subarray(H,o));for(var G="";H<o;){var Le=K[H++];if(!(Le&128)){G+=String.fromCharCode(Le);continue}var Ie=K[H++]&63;if((Le&224)==192){G+=String.fromCharCode((Le&31)<<6|Ie);continue}var Pe=K[H++]&63;if((Le&240)==224?Le=(Le&15)<<12|Ie<<6|Pe:Le=(Le&7)<<18|Ie<<12|Pe<<6|K[H++]&63,Le<65536)G+=String.fromCharCode(Le);else{var ke=Le-65536;G+=String.fromCharCode(55296|ke>>10,56320|ke&1023)}}return G}function Me(K,H){return K?ve(Ye,K,H):""}function He(K,H,ee,he){if(!(he>0))return 0;for(var o=ee,G=ee+he-1,Le=0;Le<K.length;++Le){var Ie=K.charCodeAt(Le);if(Ie>=55296&&Ie<=57343){var Pe=K.charCodeAt(++Le);Ie=65536+((Ie&1023)<<10)|Pe&1023}if(Ie<=127){if(ee>=G)break;H[ee++]=Ie}else if(Ie<=2047){if(ee+1>=G)break;H[ee++]=192|Ie>>6,H[ee++]=128|Ie&63}else if(Ie<=65535){if(ee+2>=G)break;H[ee++]=224|Ie>>12,H[ee++]=128|Ie>>6&63,H[ee++]=128|Ie&63}else{if(ee+3>=G)break;H[ee++]=240|Ie>>18,H[ee++]=128|Ie>>12&63,H[ee++]=128|Ie>>6&63,H[ee++]=128|Ie&63}}return H[ee]=0,ee-o}function Qe(K,H,ee){return He(K,Ye,H,ee)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function et(K,H){nt.set(K,H)}function tt(K,H){return K%H>0&&(K+=H-K%H),K}var Ve,nt,Ye,gt,Xt,Et,fn;function mt(K){Ve=K,e.HEAP8=nt=new Int8Array(K),e.HEAP16=gt=new Int16Array(K),e.HEAP32=Xt=new Int32Array(K),e.HEAPU8=Ye=new Uint8Array(K),e.HEAPU16=new Uint16Array(K),e.HEAPU32=new Uint32Array(K),e.HEAPF32=Et=new Float32Array(K),e.HEAPF64=fn=new Float64Array(K)}var bt=5266928,Kt=24016,In=e.TOTAL_MEMORY||33554432;e.buffer?Ve=e.buffer:Ve=new ArrayBuffer(In),In=Ve.byteLength,mt(Ve),Xt[Kt>>2]=bt;function En(K){for(;K.length>0;){var H=K.shift();if(typeof H=="function"){H();continue}var ee=H.func;typeof ee=="number"?H.arg===void 0?e.dynCall_v(ee):e.dynCall_vi(ee,H.arg):ee(H.arg===void 0?null:H.arg)}}var Si=[],Jn=[],oi=[],ci=[];function Nn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Mn(e.preRun.shift());En(Si)}function bi(){En(Jn)}function xt(){En(oi)}function nn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)vt(e.postRun.shift());En(ci)}function Mn(K){Si.unshift(K)}function vt(K){ci.unshift(K)}var ei=Math.abs,$n=Math.ceil,yi=Math.floor,li=Math.min,ti=0,Ki=null;function Un(K){ti++,e.monitorRunDependencies&&e.monitorRunDependencies(ti)}function Cr(K){if(ti--,e.monitorRunDependencies&&e.monitorRunDependencies(ti),ti==0&&Ki){var H=Ki;Ki=null,H()}}e.preloadedImages={},e.preloadedAudios={};var Hn=null,Fr="data:application/octet-stream;base64,";function fo(K){return String.prototype.startsWith?K.startsWith(Fr):K.indexOf(Fr)===0}var Ni,Pr;Hn="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var Fo=24032;function is(K){return K}function ut(K){var H=/\b__Z[\w\d_]+/g;return K.replace(H,function(ee){var he=ee;return ee===he?ee:he+" ["+ee+"]"})}function It(){var K=new Error;if(!K.stack){try{throw new Error(0)}catch(H){K=H}if(!K.stack)return"(no stack trace available)"}return K.stack.toString()}function Bs(){var K=It();return e.extraStackTrace&&(K+=`
`+e.extraStackTrace()),ut(K)}function xr(K,H,ee,he){Bi("Assertion failed: "+Me(K)+", at: "+[H?Me(H):"unknown filename",ee,he?Me(he):"unknown function"])}function Rn(){return nt.length}function Nr(K,H,ee){Ye.set(Ye.subarray(H,H+ee),K)}function Ir(K){return e.___errno_location&&(Xt[e.___errno_location()>>2]=K),K}function kr(K){Bi("OOM")}function rs(K){try{var H=new ArrayBuffer(K);return H.byteLength!=K?void 0:(new Int8Array(H).set(nt),$i(H),mt(H),1)}catch{}}function kt(K){var H=Rn(),ee=16777216,he=2147483648-ee;if(K>he)return!1;for(var o=16777216,G=Math.max(H,o);G<K;)G<=536870912?G=tt(2*G,ee):G=Math.min(tt((3*G+2147483648)/4,ee),he);var Le=rs(G);return!!Le}var Tn=typeof atob=="function"?atob:function(K){var H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ee="",he,o,G,Le,Ie,Pe,ke,We=0;K=K.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Le=H.indexOf(K.charAt(We++)),Ie=H.indexOf(K.charAt(We++)),Pe=H.indexOf(K.charAt(We++)),ke=H.indexOf(K.charAt(We++)),he=Le<<2|Ie>>4,o=(Ie&15)<<4|Pe>>2,G=(Pe&3)<<6|ke,ee=ee+String.fromCharCode(he),Pe!==64&&(ee=ee+String.fromCharCode(o)),ke!==64&&(ee=ee+String.fromCharCode(G));while(We<K.length);return ee};function wn(K){try{for(var H=Tn(K),ee=new Uint8Array(H.length),he=0;he<H.length;++he)ee[he]=H.charCodeAt(he);return ee}catch{throw new Error("Converting base64 string to bytes failed.")}}function Ii(K){if(fo(K))return wn(K.slice(Fr.length))}var vs={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},mn={a:Bi,b:I,c:P,d:xr,e:Ir,f:Rn,g:Nr,h:kt,i:kr,j:is,k:ut,l:rs,m:It,n:Bs,o:Fo,p:Kt},qe=function(K,H,ee){"almost asm";var he=new K.Int8Array(ee),o=new K.Int32Array(ee);new K.Uint8Array(ee),new K.Float32Array(ee);var G=new K.Float64Array(ee),Le=H.p|0,Ie=K.Math.floor,Pe=K.Math.abs,ke=K.Math.sqrt,We=K.Math.pow,at=K.Math.cos,$e=K.Math.sin,ht=K.Math.tan,Lt=K.Math.acos,Dt=K.Math.asin,rn=K.Math.atan,jt=K.Math.atan2,dn=K.Math.ceil,Qt=K.Math.imul,on=K.Math.min,vn=K.Math.clz32,Ot=H.b,Oe=H.c,Mt=H.d,Se=H.e,An=H.f,ar=H.g,ni=H.h,la=H.i,De=24048;function Na(l){return he=new Int8Array(l),o=new Int32Array(l),G=new Float64Array(l),ee=l,!0}function we(l){l=l|0;var h=0;return h=De,De=De+l|0,De=De+15&-16,h|0}function No(){return De|0}function xs(l){l=l|0,De=l}function Ua(l,h){l=l|0,De=l}function Va(l){return l=l|0,(Qt(l*3|0,l+1|0)|0)+1|0}function Aa(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0;ua(l,h,d,x,0)|0&&(S=(Qt(d*3|0,d+1|0)|0)+1|0,k(x|0,0,S<<3|0)|0,b=Zr(S,4)|0,b&&(Ji(l,h,d,x,b,S,0),cn(b)))}function ml(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0;if(ua(l,h,d,x,b)|0){if(S=(Qt(d*3|0,d+1|0)|0)+1|0,k(x|0,0,S<<3|0)|0,b|0){k(b|0,0,S<<2|0)|0,Ji(l,h,d,x,b,S,0);return}b=Zr(S,4)|0,b&&(Ji(l,h,d,x,b,S,0),cn(b))}}function ua(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0;if(ue=De,De=De+16|0,ne=ue,S=x,o[S>>2]=l,o[S+4>>2]=h,S=(b|0)!=0,S&&(o[b>>2]=0),Li(l,h)|0)return ne=1,De=ue,ne|0;o[ne>>2]=0;e:do if((d|0)>=1)if(S)for($=0,X=1,se=1,M=0,S=l;;){if(!(M|$)){if(S=ge(S,h,4,ne)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(Li(S,h)|0){S=1;break e}}if(S=ge(S,h,o[16+($<<2)>>2]|0,ne)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(l=x+(se<<3)|0,o[l>>2]=S,o[l+4>>2]=h,o[b+(se<<2)>>2]=X,M=M+1|0,l=(M|0)==(X|0),B=$+1|0,V=(B|0)==6,Li(S,h)|0){S=1;break e}if(X=X+(V&l&1)|0,(X|0)>(d|0)){S=0;break}else $=l?V?0:B:$,se=se+1|0,M=l?0:M}else for($=0,X=1,se=1,M=0,S=l;;){if(!(M|$)){if(S=ge(S,h,4,ne)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(Li(S,h)|0){S=1;break e}}if(S=ge(S,h,o[16+($<<2)>>2]|0,ne)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(l=x+(se<<3)|0,o[l>>2]=S,o[l+4>>2]=h,M=M+1|0,l=(M|0)==(X|0),B=$+1|0,V=(B|0)==6,Li(S,h)|0){S=1;break e}if(X=X+(V&l&1)|0,(X|0)>(d|0)){S=0;break}else $=l?V?0:B:$,se=se+1|0,M=l?0:M}else S=0;while(0);return ne=S,De=ue,ne|0}function Ji(l,h,d,x,b,S,M){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0,S=S|0,M=M|0;var B=0,V=0,$=0,X=0,se=0,ne=0,ue=0;if(se=De,De=De+16|0,X=se,(l|0)==0&(h|0)==0){De=se;return}if(B=Hs(l|0,h|0,S|0,((S|0)<0)<<31>>31|0)|0,Oe()|0,V=x+(B<<3)|0,ne=V,ue=o[ne>>2]|0,ne=o[ne+4>>2]|0,$=(ue|0)==(l|0)&(ne|0)==(h|0),!((ue|0)==0&(ne|0)==0|$))do B=(B+1|0)%(S|0)|0,V=x+(B<<3)|0,ue=V,ne=o[ue>>2]|0,ue=o[ue+4>>2]|0,$=(ne|0)==(l|0)&(ue|0)==(h|0);while(!((ne|0)==0&(ue|0)==0|$));if(B=b+(B<<2)|0,$&&(o[B>>2]|0)<=(M|0)){De=se;return}if(ue=V,o[ue>>2]=l,o[ue+4>>2]=h,o[B>>2]=M,(M|0)>=(d|0)){De=se;return}ue=M+1|0,o[X>>2]=0,ne=ge(l,h,2,X)|0,Ji(ne,Oe()|0,d,x,b,S,ue),o[X>>2]=0,ne=ge(l,h,3,X)|0,Ji(ne,Oe()|0,d,x,b,S,ue),o[X>>2]=0,ne=ge(l,h,1,X)|0,Ji(ne,Oe()|0,d,x,b,S,ue),o[X>>2]=0,ne=ge(l,h,5,X)|0,Ji(ne,Oe()|0,d,x,b,S,ue),o[X>>2]=0,ne=ge(l,h,4,X)|0,Ji(ne,Oe()|0,d,x,b,S,ue),o[X>>2]=0,ne=ge(l,h,6,X)|0,Ji(ne,Oe()|0,d,x,b,S,ue),De=se}function ge(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0;if((o[x>>2]|0)>0){b=0;do d=Gr(d)|0,b=b+1|0;while((b|0)<(o[x>>2]|0))}B=St(l|0,h|0,45)|0,Oe()|0,V=B&127,S=lr(l,h)|0,b=St(l|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!b)M=6;else for(;;){if(se=(15-b|0)*3|0,ne=St(l|0,h|0,se|0)|0,Oe()|0,ne=ne&7,ue=(fr(b)|0)==0,b=b+-1|0,X=Ct(7,0,se|0)|0,h=h&~(Oe()|0),se=Ct(o[(ue?464:48)+(ne*28|0)+(d<<2)>>2]|0,0,se|0)|0,$=Oe()|0,d=o[(ue?672:256)+(ne*28|0)+(d<<2)>>2]|0,l=se|l&~X,h=$|h,!d){d=0;break e}if(!b){M=6;break}}while(0);(M|0)==6&&(ue=o[880+(V*28|0)+(d<<2)>>2]|0,ne=Ct(ue|0,0,45)|0,l=ne|l,h=Oe()|0|h&-1040385,d=o[4304+(V*28|0)+(d<<2)>>2]|0,(ue&127|0)==127&&(ue=Ct(o[880+(V*28|0)+20>>2]|0,0,45)|0,h=Oe()|0|h&-1040385,d=o[4304+(V*28|0)+20>>2]|0,l=as(ue|l,h)|0,h=Oe()|0,o[x>>2]=(o[x>>2]|0)+1)),M=St(l|0,h|0,45)|0,Oe()|0,M=M&127;e:do if(Jt(M)|0){t:do if((lr(l,h)|0)==1){if((V|0)!=(M|0))if($A(M,o[7728+(V*28|0)>>2]|0)|0){l=Qr(l,h)|0,S=1,h=Oe()|0;break}else{l=as(l,h)|0,S=1,h=Oe()|0;break}switch(S|0){case 5:{l=Qr(l,h)|0,h=Oe()|0,o[x>>2]=(o[x>>2]|0)+5,S=0;break t}case 3:{l=as(l,h)|0,h=Oe()|0,o[x>>2]=(o[x>>2]|0)+1,S=0;break t}default:return ne=0,ue=0,Ot(ne|0),ue|0}}else S=0;while(0);if((d|0)>0){b=0;do l=wr(l,h)|0,h=Oe()|0,b=b+1|0;while((b|0)!=(d|0))}if((V|0)!=(M|0)){if(!(ki(M)|0)){if((S|0)!=0|(lr(l,h)|0)!=5)break;o[x>>2]=(o[x>>2]|0)+1;break}switch(B&127){case 8:case 118:break e}(lr(l,h)|0)!=3&&(o[x>>2]=(o[x>>2]|0)+1)}}else if((d|0)>0){b=0;do l=as(l,h)|0,h=Oe()|0,b=b+1|0;while((b|0)!=(d|0))}while(0);return o[x>>2]=((o[x>>2]|0)+d|0)%6|0,ne=h,ue=l,Ot(ne|0),ue|0}function Ee(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0;if(se=De,De=De+16|0,X=se,!d)return X=x,o[X>>2]=l,o[X+4>>2]=h,X=0,De=se,X|0;o[X>>2]=0;e:do if(Li(l,h)|0)l=1;else{if(S=(d|0)>0,S){b=0,$=l;do{if($=ge($,h,4,X)|0,h=Oe()|0,($|0)==0&(h|0)==0){l=2;break e}if(b=b+1|0,Li($,h)|0){l=1;break e}}while((b|0)<(d|0));if(V=x,o[V>>2]=$,o[V+4>>2]=h,V=d+-1|0,S){S=0,M=1,b=$,l=h;do{if(b=ge(b,l,2,X)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(B=x+(M<<3)|0,o[B>>2]=b,o[B+4>>2]=l,M=M+1|0,Li(b,l)|0){l=1;break e}S=S+1|0}while((S|0)<(d|0));B=0,S=M;do{if(b=ge(b,l,3,X)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(M=x+(S<<3)|0,o[M>>2]=b,o[M+4>>2]=l,S=S+1|0,Li(b,l)|0){l=1;break e}B=B+1|0}while((B|0)<(d|0));M=0;do{if(b=ge(b,l,1,X)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(B=x+(S<<3)|0,o[B>>2]=b,o[B+4>>2]=l,S=S+1|0,Li(b,l)|0){l=1;break e}M=M+1|0}while((M|0)<(d|0));M=0;do{if(b=ge(b,l,5,X)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(B=x+(S<<3)|0,o[B>>2]=b,o[B+4>>2]=l,S=S+1|0,Li(b,l)|0){l=1;break e}M=M+1|0}while((M|0)<(d|0));M=0;do{if(b=ge(b,l,4,X)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(B=x+(S<<3)|0,o[B>>2]=b,o[B+4>>2]=l,S=S+1|0,Li(b,l)|0){l=1;break e}M=M+1|0}while((M|0)<(d|0));for(M=0;;){if(b=ge(b,l,6,X)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if((M|0)!=(V|0))if(B=x+(S<<3)|0,o[B>>2]=b,o[B+4>>2]=l,!(Li(b,l)|0))S=S+1|0;else{l=1;break e}if(M=M+1|0,(M|0)>=(d|0)){M=$,S=h;break}}}else M=$,b=$,S=h,l=h}else M=x,o[M>>2]=l,o[M+4>>2]=h,M=l,b=l,S=h,l=h;l=((M|0)!=(b|0)|(S|0)!=(l|0))&1}while(0);return X=l,De=se,X|0}function Fe(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;if(S=De,De=De+48|0,b=S+8|0,x=S,B=l,M=o[B+4>>2]|0,d=x,o[d>>2]=o[B>>2],o[d+4>>2]=M,Xa(x,b),b=Zn(b,h)|0,h=o[x>>2]|0,x=o[l+8>>2]|0,(x|0)<=0)return B=h,M=(b|0)<(B|0),B=M?B:b,B=B+12|0,De=S,B|0;d=o[l+12>>2]|0,l=0;do h=(o[d+(l<<3)>>2]|0)+h|0,l=l+1|0;while((l|0)<(x|0));return B=(b|0)<(h|0),B=B?h:b,B=B+12|0,De=S,B|0}function ot(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0;if(B=De,De=De+48|0,x=B+8|0,b=B,!(wt(l,h,d)|0)){De=B;return}if(V=l,S=o[V+4>>2]|0,M=b,o[M>>2]=o[V>>2],o[M+4>>2]=S,Xa(b,x),M=Zn(x,h)|0,h=o[b>>2]|0,S=o[l+8>>2]|0,(S|0)>0){b=o[l+12>>2]|0,x=0;do h=(o[b+(x<<3)>>2]|0)+h|0,x=x+1|0;while((x|0)!=(S|0))}if(h=(M|0)<(h|0)?h:M,(h|0)<=-12){De=B;return}V=h+11|0,k(d|0,0,(((V|0)>0?V:0)<<3)+8|0)|0,De=B}function wt(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0,Ce=0,_e=0,Ge=0,Te=0,Ue=0,xe=0,m=0,g=0,v=0,E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0;if(fe=De,De=De+112|0,N=fe+80|0,V=fe+72|0,W=fe,J=fe+56|0,$=l+8|0,le=Yt((o[$>>2]<<5)+32|0)|0,le||Mt(22848,22448,800,22456),Gs(l,le),S=l,x=o[S+4>>2]|0,B=V,o[B>>2]=o[S>>2],o[B+4>>2]=x,Xa(V,N),B=Zn(N,h)|0,x=o[V>>2]|0,S=o[$>>2]|0,(S|0)>0){M=o[l+12>>2]|0,b=0;do x=(o[M+(b<<3)>>2]|0)+x|0,b=b+1|0;while((b|0)!=(S|0))}if(B=(B|0)<(x|0)?x:B,O=B+12|0,b=Zr(O,8)|0,X=Zr(O,8)|0,o[N>>2]=0,C=l,R=o[C+4>>2]|0,x=V,o[x>>2]=o[C>>2],o[x+4>>2]=R,x=Wt(V,O,h,N,b,X)|0,x|0)return cn(b),cn(X),cn(le),le=x,De=fe,le|0;e:do if((o[$>>2]|0)>0){for(S=l+12|0,x=0;M=Wt((o[S>>2]|0)+(x<<3)|0,O,h,N,b,X)|0,x=x+1|0,!(M|0);)if((x|0)>=(o[$>>2]|0))break e;return cn(b),cn(X),cn(le),le=M,De=fe,le|0}while(0);(B|0)>-12&&k(X|0,0,((O|0)>1?O:1)<<3|0)|0;e:do if((o[N>>2]|0)>0){R=((O|0)<0)<<31>>31,xe=b,m=X,g=b,v=b,E=X,C=b,x=b,_e=b,Ge=X,Te=X,Ue=X,b=X;t:for(;;){for(Ce=o[N>>2]|0,ue=0,be=0,S=0;;){M=W,B=M+56|0;do o[M>>2]=0,M=M+4|0;while((M|0)<(B|0));if(h=xe+(ue<<3)|0,V=o[h>>2]|0,h=o[h+4>>2]|0,ua(V,h,1,W,0)|0){M=W,B=M+56|0;do o[M>>2]=0,M=M+4|0;while((M|0)<(B|0));M=Zr(7,4)|0,M|0&&(Ji(V,h,1,W,M,7,0),cn(M))}ne=0;do{se=W+(ne<<3)|0,X=o[se>>2]|0,se=o[se+4>>2]|0;n:do if(!((X|0)==0&(se|0)==0)){if(V=Hs(X|0,se|0,O|0,R|0)|0,Oe()|0,M=d+(V<<3)|0,B=M,h=o[B>>2]|0,B=o[B+4>>2]|0,!((h|0)==0&(B|0)==0))for($=0;;){if(($|0)>(O|0))break t;if((h|0)==(X|0)&(B|0)==(se|0))break n;if(V=(V+1|0)%(O|0)|0,M=d+(V<<3)|0,B=M,h=o[B>>2]|0,B=o[B+4>>2]|0,(h|0)==0&(B|0)==0)break;$=$+1|0}(X|0)==0&(se|0)==0||(Vs(X,se,J),ru(l,le,J)|0&&($=M,o[$>>2]=X,o[$+4>>2]=se,$=m+(S<<3)|0,o[$>>2]=X,o[$+4>>2]=se,S=S+1|0))}while(0);ne=ne+1|0}while(ne>>>0<7);if(be=be+1|0,(be|0)>=(Ce|0))break;ue=ue+1|0}if((Ce|0)>0&&k(g|0,0,Ce<<3|0)|0,o[N>>2]=S,(S|0)>0)X=b,se=Ue,ne=C,ue=Te,be=Ge,Ce=m,b=_e,Ue=x,Te=v,Ge=g,_e=X,x=se,C=E,E=ne,v=ue,g=be,m=xe,xe=Ce;else break e}return cn(v),cn(E),cn(le),le=-1,De=fe,le|0}else x=X;while(0);return cn(le),cn(b),cn(x),le=0,De=fe,le|0}function Wt(l,h,d,x,b,S){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0,S=S|0;var M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0,Ce=0,_e=0,Ge=0,Te=0,Ue=0,xe=0,m=0,g=0,v=0,E=0,C=0,R=0,O=0,N=0;if(R=De,De=De+48|0,g=R+32|0,v=R+16|0,E=R,M=o[l>>2]|0,(M|0)<=0)return C=0,De=R,C|0;Ge=l+4|0,Te=g+8|0,Ue=v+8|0,xe=E+8|0,m=((h|0)<0)<<31>>31,_e=0;e:for(;;){B=o[Ge>>2]|0,be=B+(_e<<4)|0,o[g>>2]=o[be>>2],o[g+4>>2]=o[be+4>>2],o[g+8>>2]=o[be+8>>2],o[g+12>>2]=o[be+12>>2],(_e|0)==(M+-1|0)?(o[v>>2]=o[B>>2],o[v+4>>2]=o[B+4>>2],o[v+8>>2]=o[B+8>>2],o[v+12>>2]=o[B+12>>2]):(be=B+(_e+1<<4)|0,o[v>>2]=o[be>>2],o[v+4>>2]=o[be+4>>2],o[v+8>>2]=o[be+8>>2],o[v+12>>2]=o[be+12>>2]),be=WA(g,v,d)|0;t:do if((be|0)>0){Ce=+(be|0),ue=0;n:for(;;){N=+(be-ue|0),O=+(ue|0),G[E>>3]=+G[g>>3]*N/Ce+ +G[v>>3]*O/Ce,G[xe>>3]=+G[Te>>3]*N/Ce+ +G[Ue>>3]*O/Ce,se=Wa(E,d)|0,ne=Oe()|0,B=Hs(se|0,ne|0,h|0,m|0)|0,Oe()|0,M=S+(B<<3)|0,V=M,$=o[V>>2]|0,V=o[V+4>>2]|0;i:do if(($|0)==0&(V|0)==0)C=14;else for(X=0;;){if((X|0)>(h|0)){M=1;break i}if(($|0)==(se|0)&(V|0)==(ne|0)){M=7;break i}if(B=(B+1|0)%(h|0)|0,M=S+(B<<3)|0,V=M,$=o[V>>2]|0,V=o[V+4>>2]|0,($|0)==0&(V|0)==0){C=14;break}else X=X+1|0}while(0);switch((C|0)==14&&(C=0,(se|0)==0&(ne|0)==0?M=7:(o[M>>2]=se,o[M+4>>2]=ne,M=o[x>>2]|0,X=b+(M<<3)|0,o[X>>2]=se,o[X+4>>2]=ne,o[x>>2]=M+1,M=0)),M&7){case 7:case 0:break;default:break n}if(ue=ue+1|0,(be|0)<=(ue|0)){C=8;break t}}if(M|0){M=-1,C=20;break e}}else C=8;while(0);if((C|0)==8&&(C=0),_e=_e+1|0,M=o[l>>2]|0,(_e|0)>=(M|0)){M=0,C=20;break}}return(C|0)==20?(De=R,M|0):0}function kn(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0;if($=De,De=De+176|0,V=$,(h|0)<1){Ei(d,0,0),De=$;return}M=l,M=St(o[M>>2]|0,o[M+4>>2]|0,52)|0,Oe()|0,Ei(d,(h|0)>6?h:6,M&15),M=0;do{if(x=l+(M<<3)|0,ls(o[x>>2]|0,o[x+4>>2]|0,V),x=o[V>>2]|0,(x|0)>0){B=0;do S=V+8+(B<<4)|0,B=B+1|0,x=V+8+(((B|0)%(x|0)|0)<<4)|0,b=uu(d,x,S)|0,b?Au(d,b)|0:lc(d,S,x)|0,x=o[V>>2]|0;while((B|0)<(x|0))}M=M+1|0}while((M|0)!=(h|0));De=$}function Pi(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if(S=De,De=De+32|0,x=S,b=S+16|0,kn(l,h,b),o[d>>2]=0,o[d+4>>2]=0,o[d+8>>2]=0,l=Rl(b)|0,!l){ma(d)|0,Ka(b),De=S;return}do{h=rh(d)|0;do sh(h,l)|0,M=l+16|0,o[x>>2]=o[M>>2],o[x+4>>2]=o[M+4>>2],o[x+8>>2]=o[M+8>>2],o[x+12>>2]=o[M+12>>2],Au(b,l)|0,l=Ac(b,x)|0;while(l|0);l=Rl(b)|0}while(l|0);ma(d)|0,Ka(b),De=S}function Jt(l){return l=l|0,o[7728+(l*28|0)+16>>2]|0}function ki(l){return l=l|0,(l|0)==4|(l|0)==117|0}function Vn(l){return l=l|0,o[11152+((o[l>>2]|0)*216|0)+((o[l+4>>2]|0)*72|0)+((o[l+8>>2]|0)*24|0)+(o[l+12>>2]<<3)>>2]|0}function aA(l){return l=l|0,o[11152+((o[l>>2]|0)*216|0)+((o[l+4>>2]|0)*72|0)+((o[l+8>>2]|0)*24|0)+(o[l+12>>2]<<3)+4>>2]|0}function lA(l,h){l=l|0,h=h|0,l=7728+(l*28|0)|0,o[h>>2]=o[l>>2],o[h+4>>2]=o[l+4>>2],o[h+8>>2]=o[l+8>>2],o[h+12>>2]=o[l+12>>2]}function AA(l,h){l=l|0,h=h|0;var d=0,x=0;if(h>>>0>20)return h=-1,h|0;do if((o[11152+(h*216|0)>>2]|0)!=(l|0))if((o[11152+(h*216|0)+8>>2]|0)!=(l|0))if((o[11152+(h*216|0)+16>>2]|0)!=(l|0))if((o[11152+(h*216|0)+24>>2]|0)!=(l|0))if((o[11152+(h*216|0)+32>>2]|0)!=(l|0))if((o[11152+(h*216|0)+40>>2]|0)!=(l|0))if((o[11152+(h*216|0)+48>>2]|0)!=(l|0))if((o[11152+(h*216|0)+56>>2]|0)!=(l|0))if((o[11152+(h*216|0)+64>>2]|0)!=(l|0))if((o[11152+(h*216|0)+72>>2]|0)!=(l|0))if((o[11152+(h*216|0)+80>>2]|0)!=(l|0))if((o[11152+(h*216|0)+88>>2]|0)!=(l|0))if((o[11152+(h*216|0)+96>>2]|0)!=(l|0))if((o[11152+(h*216|0)+104>>2]|0)!=(l|0))if((o[11152+(h*216|0)+112>>2]|0)!=(l|0))if((o[11152+(h*216|0)+120>>2]|0)!=(l|0))if((o[11152+(h*216|0)+128>>2]|0)!=(l|0))if((o[11152+(h*216|0)+136>>2]|0)==(l|0))l=2,d=1,x=2;else{if((o[11152+(h*216|0)+144>>2]|0)==(l|0)){l=0,d=2,x=0;break}if((o[11152+(h*216|0)+152>>2]|0)==(l|0)){l=0,d=2,x=1;break}if((o[11152+(h*216|0)+160>>2]|0)==(l|0)){l=0,d=2,x=2;break}if((o[11152+(h*216|0)+168>>2]|0)==(l|0)){l=1,d=2,x=0;break}if((o[11152+(h*216|0)+176>>2]|0)==(l|0)){l=1,d=2,x=1;break}if((o[11152+(h*216|0)+184>>2]|0)==(l|0)){l=1,d=2,x=2;break}if((o[11152+(h*216|0)+192>>2]|0)==(l|0)){l=2,d=2,x=0;break}if((o[11152+(h*216|0)+200>>2]|0)==(l|0)){l=2,d=2,x=1;break}if((o[11152+(h*216|0)+208>>2]|0)==(l|0)){l=2,d=2,x=2;break}else l=-1;return l|0}else l=2,d=1,x=1;else l=2,d=1,x=0;else l=1,d=1,x=2;else l=1,d=1,x=1;else l=1,d=1,x=0;else l=0,d=1,x=2;else l=0,d=1,x=1;else l=0,d=1,x=0;else l=2,d=0,x=2;else l=2,d=0,x=1;else l=2,d=0,x=0;else l=1,d=0,x=2;else l=1,d=0,x=1;else l=1,d=0,x=0;else l=0,d=0,x=2;else l=0,d=0,x=1;else l=0,d=0,x=0;while(0);return h=o[11152+(h*216|0)+(d*72|0)+(l*24|0)+(x<<3)+4>>2]|0,h|0}function $A(l,h){return l=l|0,h=h|0,(o[7728+(l*28|0)+20>>2]|0)==(h|0)?(h=1,h|0):(h=(o[7728+(l*28|0)+24>>2]|0)==(h|0),h|0)}function HA(l,h){return l=l|0,h=h|0,o[880+(l*28|0)+(h<<2)>>2]|0}function uA(l,h){return l=l|0,h=h|0,(o[880+(l*28|0)>>2]|0)==(h|0)?(h=0,h|0):(o[880+(l*28|0)+4>>2]|0)==(h|0)?(h=1,h|0):(o[880+(l*28|0)+8>>2]|0)==(h|0)?(h=2,h|0):(o[880+(l*28|0)+12>>2]|0)==(h|0)?(h=3,h|0):(o[880+(l*28|0)+16>>2]|0)==(h|0)?(h=4,h|0):(o[880+(l*28|0)+20>>2]|0)==(h|0)?(h=5,h|0):((o[880+(l*28|0)+24>>2]|0)==(h|0)?6:7)|0}function yl(){return 122}function _l(l){l=l|0;var h=0,d=0,x=0;h=0;do Ct(h|0,0,45)|0,x=Oe()|0|134225919,d=l+(h<<3)|0,o[d>>2]=-1,o[d+4>>2]=x,h=h+1|0;while((h|0)!=122)}function cA(l){return l=l|0,+G[l+16>>3]<+G[l+24>>3]|0}function hA(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;return d=+G[h>>3],!(d>=+G[l+8>>3])||!(d<=+G[l>>3])?(h=0,h|0):(x=+G[l+16>>3],d=+G[l+24>>3],b=+G[h+8>>3],h=b>=d,l=b<=x&1,x<d?h&&(l=1):h||(l=0),h=(l|0)!=0,h|0)}function Zn(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0;M=De,De=De+288|0,d=M+264|0,x=M+96|0,b=M,S=b,B=S+96|0;do o[S>>2]=0,S=S+4|0;while((S|0)<(B|0));return nr(h,b),S=b,B=o[S>>2]|0,S=o[S+4>>2]|0,Vs(B,S,d),ls(B,S,x),V=+Wn(d,x+8|0),G[d>>3]=+G[l>>3],S=d+8|0,G[S>>3]=+G[l+16>>3],G[x>>3]=+G[l+8>>3],B=x+8|0,G[B>>3]=+G[l+24>>3],$=+Wn(d,x),B=~~+dn(+($*$/+Vi(+ +Pe(+((+G[S>>3]-+G[B>>3])/(+G[d>>3]-+G[x>>3]))),3)/(V*(V*2.59807621135)*.8))),De=M,(B|0?B:1)|0}function WA(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0;B=De,De=De+288|0,x=B+264|0,b=B+96|0,S=B,M=S,V=M+96|0;do o[M>>2]=0,M=M+4|0;while((M|0)<(V|0));return nr(d,S),V=S,M=o[V>>2]|0,V=o[V+4>>2]|0,Vs(M,V,x),ls(M,V,b),$=+Wn(x,b+8|0),V=~~+dn(+(+Wn(l,h)/($*2))),De=B,(V|0?V:1)|0}function Ku(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0,o[l>>2]=h,o[l+4>>2]=d,o[l+8>>2]=x}function vl(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0;se=h+8|0,o[se>>2]=0,V=+G[l>>3],M=+Pe(+V),$=+G[l+8>>3],B=+Pe(+$)/.8660254037844386,M=M+B*.5,d=~~M,l=~~B,M=M-+(d|0),B=B-+(l|0);do if(M<.5)if(M<.3333333333333333)if(o[h>>2]=d,B<(M+1)*.5){o[h+4>>2]=l;break}else{l=l+1|0,o[h+4>>2]=l;break}else if(ne=1-M,l=(!(B<ne)&1)+l|0,o[h+4>>2]=l,ne<=B&B<M*2){d=d+1|0,o[h>>2]=d;break}else{o[h>>2]=d;break}else{if(!(M<.6666666666666666))if(d=d+1|0,o[h>>2]=d,B<M*.5){o[h+4>>2]=l;break}else{l=l+1|0,o[h+4>>2]=l;break}if(B<1-M){if(o[h+4>>2]=l,M*2+-1<B){o[h>>2]=d;break}}else l=l+1|0,o[h+4>>2]=l;d=d+1|0,o[h>>2]=d}while(0);do if(V<0)if(l&1){X=(l+1|0)/2|0,X=Ui(d|0,((d|0)<0)<<31>>31|0,X|0,((X|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-((+(X>>>0)+4294967296*+(Oe()|0))*2+1)),o[h>>2]=d;break}else{X=(l|0)/2|0,X=Ui(d|0,((d|0)<0)<<31>>31|0,X|0,((X|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-(+(X>>>0)+4294967296*+(Oe()|0))*2),o[h>>2]=d;break}while(0);X=h+4|0,$<0&&(d=d-((l<<1|1|0)/2|0)|0,o[h>>2]=d,l=0-l|0,o[X>>2]=l),x=l-d|0,(d|0)<0?(b=0-d|0,o[X>>2]=x,o[se>>2]=b,o[h>>2]=0,l=x,d=0):b=0,(l|0)<0&&(d=d-l|0,o[h>>2]=d,b=b-l|0,o[se>>2]=b,o[X>>2]=0,l=0),S=d-b|0,x=l-b|0,(b|0)<0&&(o[h>>2]=S,o[X>>2]=x,o[se>>2]=0,l=x,d=S,b=0),x=(l|0)<(d|0)?l:d,x=(b|0)<(x|0)?b:x,!((x|0)<=0)&&(o[h>>2]=d-x,o[X>>2]=l-x,o[se>>2]=b-x)}function Hi(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0;h=o[l>>2]|0,M=l+4|0,d=o[M>>2]|0,(h|0)<0&&(d=d-h|0,o[M>>2]=d,S=l+8|0,o[S>>2]=(o[S>>2]|0)-h,o[l>>2]=0,h=0),(d|0)<0?(h=h-d|0,o[l>>2]=h,S=l+8|0,b=(o[S>>2]|0)-d|0,o[S>>2]=b,o[M>>2]=0,d=0):(b=l+8|0,S=b,b=o[b>>2]|0),(b|0)<0&&(h=h-b|0,o[l>>2]=h,d=d-b|0,o[M>>2]=d,o[S>>2]=0,b=0),x=(d|0)<(h|0)?d:h,x=(b|0)<(x|0)?b:x,!((x|0)<=0)&&(o[l>>2]=h-x,o[M>>2]=d-x,o[S>>2]=b-x)}function Uo(l,h){l=l|0,h=h|0;var d=0,x=0;x=o[l+8>>2]|0,d=+((o[l+4>>2]|0)-x|0),G[h>>3]=+((o[l>>2]|0)-x|0)-d*.5,G[h+8>>3]=d*.8660254037844386}function Bn(l,h,d){l=l|0,h=h|0,d=d|0,o[d>>2]=(o[h>>2]|0)+(o[l>>2]|0),o[d+4>>2]=(o[h+4>>2]|0)+(o[l+4>>2]|0),o[d+8>>2]=(o[h+8>>2]|0)+(o[l+8>>2]|0)}function ws(l,h,d){l=l|0,h=h|0,d=d|0,o[d>>2]=(o[l>>2]|0)-(o[h>>2]|0),o[d+4>>2]=(o[l+4>>2]|0)-(o[h+4>>2]|0),o[d+8>>2]=(o[l+8>>2]|0)-(o[h+8>>2]|0)}function er(l,h){l=l|0,h=h|0;var d=0,x=0;d=Qt(o[l>>2]|0,h)|0,o[l>>2]=d,d=l+4|0,x=Qt(o[d>>2]|0,h)|0,o[d>>2]=x,l=l+8|0,h=Qt(o[l>>2]|0,h)|0,o[l>>2]=h}function po(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;M=o[l>>2]|0,B=(M|0)<0,x=(o[l+4>>2]|0)-(B?M:0)|0,S=(x|0)<0,b=(S?0-x|0:0)+((o[l+8>>2]|0)-(B?M:0))|0,d=(b|0)<0,l=d?0:b,h=(S?0:x)-(d?b:0)|0,b=(B?0:M)-(S?x:0)-(d?b:0)|0,d=(h|0)<(b|0)?h:b,d=(l|0)<(d|0)?l:d,x=(d|0)>0,l=l-(x?d:0)|0,h=h-(x?d:0)|0;e:do switch(b-(x?d:0)|0){case 0:switch(h|0){case 0:return B=l|0?(l|0)==1?1:7:0,B|0;case 1:return B=l|0?(l|0)==1?3:7:2,B|0;default:break e}case 1:switch(h|0){case 0:return B=l|0?(l|0)==1?5:7:4,B|0;case 1:{if(!l)l=6;else break e;return l|0}default:break e}}while(0);return B=7,B|0}function xl(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;M=l+8|0,d=o[M>>2]|0,h=(o[l>>2]|0)-d|0,B=l+4|0,d=(o[B>>2]|0)-d|0,x=Zt(+((h*3|0)-d|0)/7)|0,o[l>>2]=x,h=Zt(+((d<<1)+h|0)/7)|0,o[B>>2]=h,o[M>>2]=0,d=h-x|0,(x|0)<0?(S=0-x|0,o[B>>2]=d,o[M>>2]=S,o[l>>2]=0,h=d,x=0,d=S):d=0,(h|0)<0&&(x=x-h|0,o[l>>2]=x,d=d-h|0,o[M>>2]=d,o[B>>2]=0,h=0),S=x-d|0,b=h-d|0,(d|0)<0?(o[l>>2]=S,o[B>>2]=b,o[M>>2]=0,h=b,b=S,d=0):b=x,x=(h|0)<(b|0)?h:b,x=(d|0)<(x|0)?d:x,!((x|0)<=0)&&(o[l>>2]=b-x,o[B>>2]=h-x,o[M>>2]=d-x)}function Vo(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;M=l+8|0,d=o[M>>2]|0,h=(o[l>>2]|0)-d|0,B=l+4|0,d=(o[B>>2]|0)-d|0,x=Zt(+((h<<1)+d|0)/7)|0,o[l>>2]=x,h=Zt(+((d*3|0)-h|0)/7)|0,o[B>>2]=h,o[M>>2]=0,d=h-x|0,(x|0)<0?(S=0-x|0,o[B>>2]=d,o[M>>2]=S,o[l>>2]=0,h=d,x=0,d=S):d=0,(h|0)<0&&(x=x-h|0,o[l>>2]=x,d=d-h|0,o[M>>2]=d,o[B>>2]=0,h=0),S=x-d|0,b=h-d|0,(d|0)<0?(o[l>>2]=S,o[B>>2]=b,o[M>>2]=0,h=b,b=S,d=0):b=x,x=(h|0)<(b|0)?h:b,x=(d|0)<(x|0)?d:x,!((x|0)<=0)&&(o[l>>2]=b-x,o[B>>2]=h-x,o[M>>2]=d-x)}function ca(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;h=o[l>>2]|0,M=l+4|0,d=o[M>>2]|0,B=l+8|0,x=o[B>>2]|0,b=d+(h*3|0)|0,o[l>>2]=b,d=x+(d*3|0)|0,o[M>>2]=d,h=(x*3|0)+h|0,o[B>>2]=h,x=d-b|0,(b|0)<0?(h=h-b|0,o[M>>2]=x,o[B>>2]=h,o[l>>2]=0,d=x,x=0):x=b,(d|0)<0&&(x=x-d|0,o[l>>2]=x,h=h-d|0,o[B>>2]=h,o[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(o[l>>2]=S,o[M>>2]=b,o[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=x-d,o[M>>2]=b-d,o[B>>2]=h-d)}function go(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=o[l>>2]|0,M=l+4|0,h=o[M>>2]|0,B=l+8|0,d=o[B>>2]|0,x=(h*3|0)+b|0,b=d+(b*3|0)|0,o[l>>2]=b,o[M>>2]=x,h=(d*3|0)+h|0,o[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,o[M>>2]=d,o[B>>2]=h,o[l>>2]=0,b=0):d=x,(d|0)<0&&(b=b-d|0,o[l>>2]=b,h=h-d|0,o[B>>2]=h,o[M>>2]=0,d=0),S=b-h|0,x=d-h|0,(h|0)<0?(o[l>>2]=S,o[M>>2]=x,o[B>>2]=0,b=S,h=0):x=d,d=(x|0)<(b|0)?x:b,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=b-d,o[M>>2]=x-d,o[B>>2]=h-d)}function fA(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;(h+-1|0)>>>0>=6||(b=(o[15472+(h*12|0)>>2]|0)+(o[l>>2]|0)|0,o[l>>2]=b,B=l+4|0,x=(o[15472+(h*12|0)+4>>2]|0)+(o[B>>2]|0)|0,o[B>>2]=x,M=l+8|0,h=(o[15472+(h*12|0)+8>>2]|0)+(o[M>>2]|0)|0,o[M>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,o[B>>2]=d,o[M>>2]=h,o[l>>2]=0,x=0):(d=x,x=b),(d|0)<0&&(x=x-d|0,o[l>>2]=x,h=h-d|0,o[M>>2]=h,o[B>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(o[l>>2]=S,o[B>>2]=b,o[M>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=x-d,o[B>>2]=b-d,o[M>>2]=h-d))}function Ga(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=o[l>>2]|0,M=l+4|0,h=o[M>>2]|0,B=l+8|0,d=o[B>>2]|0,x=h+b|0,b=d+b|0,o[l>>2]=b,o[M>>2]=x,h=d+h|0,o[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,o[M>>2]=d,o[B>>2]=h,o[l>>2]=0,x=0):(d=x,x=b),(d|0)<0&&(x=x-d|0,o[l>>2]=x,h=h-d|0,o[B>>2]=h,o[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(o[l>>2]=S,o[M>>2]=b,o[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=x-d,o[M>>2]=b-d,o[B>>2]=h-d)}function Go(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;h=o[l>>2]|0,M=l+4|0,x=o[M>>2]|0,B=l+8|0,d=o[B>>2]|0,b=x+h|0,o[l>>2]=b,x=d+x|0,o[M>>2]=x,h=d+h|0,o[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,o[M>>2]=d,o[B>>2]=h,o[l>>2]=0,x=0):(d=x,x=b),(d|0)<0&&(x=x-d|0,o[l>>2]=x,h=h-d|0,o[B>>2]=h,o[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(o[l>>2]=S,o[M>>2]=b,o[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=x-d,o[M>>2]=b-d,o[B>>2]=h-d)}function Gr(l){switch(l=l|0,l|0){case 1:{l=5;break}case 5:{l=4;break}case 4:{l=6;break}case 6:{l=2;break}case 2:{l=3;break}case 3:{l=1;break}}return l|0}function jr(l){switch(l=l|0,l|0){case 1:{l=3;break}case 3:{l=2;break}case 2:{l=6;break}case 6:{l=4;break}case 4:{l=5;break}case 5:{l=1;break}}return l|0}function QA(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;h=o[l>>2]|0,M=l+4|0,d=o[M>>2]|0,B=l+8|0,x=o[B>>2]|0,b=d+(h<<1)|0,o[l>>2]=b,d=x+(d<<1)|0,o[M>>2]=d,h=(x<<1)+h|0,o[B>>2]=h,x=d-b|0,(b|0)<0?(h=h-b|0,o[M>>2]=x,o[B>>2]=h,o[l>>2]=0,d=x,x=0):x=b,(d|0)<0&&(x=x-d|0,o[l>>2]=x,h=h-d|0,o[B>>2]=h,o[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(o[l>>2]=S,o[M>>2]=b,o[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=x-d,o[M>>2]=b-d,o[B>>2]=h-d)}function wl(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=o[l>>2]|0,M=l+4|0,h=o[M>>2]|0,B=l+8|0,d=o[B>>2]|0,x=(h<<1)+b|0,b=d+(b<<1)|0,o[l>>2]=b,o[M>>2]=x,h=(d<<1)+h|0,o[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,o[M>>2]=d,o[B>>2]=h,o[l>>2]=0,b=0):d=x,(d|0)<0&&(b=b-d|0,o[l>>2]=b,h=h-d|0,o[B>>2]=h,o[M>>2]=0,d=0),S=b-h|0,x=d-h|0,(h|0)<0?(o[l>>2]=S,o[M>>2]=x,o[B>>2]=0,b=S,h=0):x=d,d=(x|0)<(b|0)?x:b,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(o[l>>2]=b-d,o[M>>2]=x-d,o[B>>2]=h-d)}function mo(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;return M=(o[l>>2]|0)-(o[h>>2]|0)|0,B=(M|0)<0,x=(o[l+4>>2]|0)-(o[h+4>>2]|0)-(B?M:0)|0,S=(x|0)<0,b=(B?0-M|0:0)+(o[l+8>>2]|0)-(o[h+8>>2]|0)+(S?0-x|0:0)|0,l=(b|0)<0,h=l?0:b,d=(S?0:x)-(l?b:0)|0,b=(B?0:M)-(S?x:0)-(l?b:0)|0,l=(d|0)<(b|0)?d:b,l=(h|0)<(l|0)?h:l,x=(l|0)>0,h=h-(x?l:0)|0,d=d-(x?l:0)|0,l=b-(x?l:0)|0,l=(l|0)>-1?l:0-l|0,d=(d|0)>-1?d:0-d|0,h=(h|0)>-1?h:0-h|0,h=(d|0)>(h|0)?d:h,((l|0)>(h|0)?l:h)|0}function jo(l,h){l=l|0,h=h|0;var d=0;d=o[l+8>>2]|0,o[h>>2]=(o[l>>2]|0)-d,o[h+4>>2]=(o[l+4>>2]|0)-d}function Ju(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;x=o[l>>2]|0,o[h>>2]=x,l=o[l+4>>2]|0,M=h+4|0,o[M>>2]=l,B=h+8|0,o[B>>2]=0,d=l-x|0,(x|0)<0?(l=0-x|0,o[M>>2]=d,o[B>>2]=l,o[h>>2]=0,x=0):(d=l,l=0),(d|0)<0&&(x=x-d|0,o[h>>2]=x,l=l-d|0,o[B>>2]=l,o[M>>2]=0,d=0),S=x-l|0,b=d-l|0,(l|0)<0?(o[h>>2]=S,o[M>>2]=b,o[B>>2]=0,d=b,b=S,l=0):b=x,x=(d|0)<(b|0)?d:b,x=(l|0)<(x|0)?l:x,!((x|0)<=0)&&(o[h>>2]=b-x,o[M>>2]=d-x,o[B>>2]=l-x)}function qA(l){l=l|0;var h=0,d=0,x=0,b=0;h=l+8|0,b=o[h>>2]|0,d=b-(o[l>>2]|0)|0,o[l>>2]=d,x=l+4|0,l=(o[x>>2]|0)-b|0,o[x>>2]=l,o[h>>2]=0-(l+d)}function bl(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;d=o[l>>2]|0,h=0-d|0,o[l>>2]=h,M=l+8|0,o[M>>2]=0,B=l+4|0,x=o[B>>2]|0,b=x+d|0,(d|0)>0?(o[B>>2]=b,o[M>>2]=d,o[l>>2]=0,h=0,x=b):d=0,(x|0)<0?(S=h-x|0,o[l>>2]=S,d=d-x|0,o[M>>2]=d,o[B>>2]=0,b=S-d|0,h=0-d|0,(d|0)<0?(o[l>>2]=b,o[B>>2]=h,o[M>>2]=0,x=h,d=0):(x=0,b=S)):b=h,h=(x|0)<(b|0)?x:b,h=(d|0)<(h|0)?d:h,!((h|0)<=0)&&(o[l>>2]=b-h,o[B>>2]=x-h,o[M>>2]=d-h)}function dA(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;x=De,De=De+16|0,b=x,ZA(l,h,d,b),vl(b,d+4|0),De=x}function ZA(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0;if(V=De,De=De+32|0,S=V,Dl(l,S),o[d>>2]=0,b=+zi(15888,S),M=+zi(15912,S),M<b&&(o[d>>2]=1,b=M),M=+zi(15936,S),M<b&&(o[d>>2]=2,b=M),M=+zi(15960,S),M<b&&(o[d>>2]=3,b=M),M=+zi(15984,S),M<b&&(o[d>>2]=4,b=M),M=+zi(16008,S),M<b&&(o[d>>2]=5,b=M),M=+zi(16032,S),M<b&&(o[d>>2]=6,b=M),M=+zi(16056,S),M<b&&(o[d>>2]=7,b=M),M=+zi(16080,S),M<b&&(o[d>>2]=8,b=M),M=+zi(16104,S),M<b&&(o[d>>2]=9,b=M),M=+zi(16128,S),M<b&&(o[d>>2]=10,b=M),M=+zi(16152,S),M<b&&(o[d>>2]=11,b=M),M=+zi(16176,S),M<b&&(o[d>>2]=12,b=M),M=+zi(16200,S),M<b&&(o[d>>2]=13,b=M),M=+zi(16224,S),M<b&&(o[d>>2]=14,b=M),M=+zi(16248,S),M<b&&(o[d>>2]=15,b=M),M=+zi(16272,S),M<b&&(o[d>>2]=16,b=M),M=+zi(16296,S),M<b&&(o[d>>2]=17,b=M),M=+zi(16320,S),M<b&&(o[d>>2]=18,b=M),M=+zi(16344,S),M<b&&(o[d>>2]=19,b=M),M=+Lt(+(1-b*.5)),M<1e-16){o[x>>2]=0,o[x+4>>2]=0,o[x+8>>2]=0,o[x+12>>2]=0,De=V;return}if(d=o[d>>2]|0,b=+G[16368+(d*24|0)>>3],b=+hi(b-+hi(+di(15568+(d<<4)|0,l))),fr(h)|0?B=+hi(b+-.3334731722518321):B=b,b=+ht(+M)/.381966011250105,(h|0)>0){S=0;do b=b*2.6457513110645907,S=S+1|0;while((S|0)!=(h|0))}M=+at(+B)*b,G[x>>3]=M,B=+$e(+B)*b,G[x+8>>3]=B,De=V}function $o(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0;if(S=+xo(l),S<1e-16){h=15568+(h<<4)|0,o[b>>2]=o[h>>2],o[b+4>>2]=o[h+4>>2],o[b+8>>2]=o[h+8>>2],o[b+12>>2]=o[h+12>>2];return}if(M=+jt(+ +G[l+8>>3],+ +G[l>>3]),(d|0)>0){l=0;do S=S/2.6457513110645907,l=l+1|0;while((l|0)!=(d|0))}x?(S=S/3,d=(fr(d)|0)==0,S=+rn(+((d?S:S/2.6457513110645907)*.381966011250105))):(S=+rn(+(S*.381966011250105)),fr(d)|0&&(M=+hi(M+.3334731722518321))),El(15568+(h<<4)|0,+hi(+G[16368+(h*24|0)>>3]-M),S,b)}function ja(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;x=De,De=De+16|0,b=x,Uo(l+4|0,b),$o(b,o[l>>2]|0,h,0,d),De=x}function YA(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0,Ce=0,_e=0,Ge=0,Te=0,Ue=0,xe=0,m=0,g=0,v=0,E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0;if(J=De,De=De+272|0,S=J+256|0,Te=J+240|0,O=J,N=J+224|0,W=J+208|0,Ue=J+176|0,xe=J+160|0,m=J+192|0,g=J+144|0,v=J+128|0,E=J+112|0,C=J+96|0,R=J+80|0,o[S>>2]=h,o[Te>>2]=o[l>>2],o[Te+4>>2]=o[l+4>>2],o[Te+8>>2]=o[l+8>>2],o[Te+12>>2]=o[l+12>>2],XA(Te,S,O),o[b>>2]=0,Te=x+d+((x|0)==5&1)|0,(Te|0)<=(d|0)){De=J;return}V=o[S>>2]|0,$=N+4|0,X=Ue+4|0,se=d+5|0,ne=16848+(V<<2)|0,ue=16928+(V<<2)|0,be=v+8|0,Ce=E+8|0,_e=C+8|0,Ge=W+4|0,B=d;e:for(;;){M=O+(((B|0)%5|0)<<4)|0,o[W>>2]=o[M>>2],o[W+4>>2]=o[M+4>>2],o[W+8>>2]=o[M+8>>2],o[W+12>>2]=o[M+12>>2];do;while((yo(W,V,0,1)|0)==2);if((B|0)>(d|0)&(fr(h)|0)!=0){if(o[Ue>>2]=o[W>>2],o[Ue+4>>2]=o[W+4>>2],o[Ue+8>>2]=o[W+8>>2],o[Ue+12>>2]=o[W+12>>2],Uo($,xe),x=o[Ue>>2]|0,S=o[17008+(x*80|0)+(o[N>>2]<<2)>>2]|0,o[Ue>>2]=o[18608+(x*80|0)+(S*20|0)>>2],M=o[18608+(x*80|0)+(S*20|0)+16>>2]|0,(M|0)>0){l=0;do Ga(X),l=l+1|0;while((l|0)<(M|0))}switch(M=18608+(x*80|0)+(S*20|0)+4|0,o[m>>2]=o[M>>2],o[m+4>>2]=o[M+4>>2],o[m+8>>2]=o[M+8>>2],er(m,(o[ne>>2]|0)*3|0),Bn(X,m,X),Hi(X),Uo(X,g),le=+(o[ue>>2]|0),G[v>>3]=le*3,G[be>>3]=0,fe=le*-1.5,G[E>>3]=fe,G[Ce>>3]=le*2.598076211353316,G[C>>3]=fe,G[_e>>3]=le*-2.598076211353316,o[17008+((o[Ue>>2]|0)*80|0)+(o[W>>2]<<2)>>2]|0){case 1:{l=E,x=v;break}case 3:{l=C,x=E;break}case 2:{l=v,x=C;break}default:{l=12;break e}}lu(xe,g,x,l,R),$o(R,o[Ue>>2]|0,V,1,b+8+(o[b>>2]<<4)|0),o[b>>2]=(o[b>>2]|0)+1}if((B|0)<(se|0)&&(Uo(Ge,Ue),$o(Ue,o[W>>2]|0,V,1,b+8+(o[b>>2]<<4)|0),o[b>>2]=(o[b>>2]|0)+1),o[N>>2]=o[W>>2],o[N+4>>2]=o[W+4>>2],o[N+8>>2]=o[W+8>>2],o[N+12>>2]=o[W+12>>2],B=B+1|0,(B|0)>=(Te|0)){l=3;break}}if((l|0)==3){De=J;return}else(l|0)==12&&Mt(22474,22521,581,22531)}function XA(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0;V=De,De=De+128|0,x=V+64|0,b=V,S=x,M=20208,B=S+60|0;do o[S>>2]=o[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));S=b,M=20272,B=S+60|0;do o[S>>2]=o[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));B=(fr(o[h>>2]|0)|0)==0,x=B?x:b,b=l+4|0,QA(b),wl(b),fr(o[h>>2]|0)|0&&(go(b),o[h>>2]=(o[h>>2]|0)+1),o[d>>2]=o[l>>2],h=d+4|0,Bn(b,x,h),Hi(h),o[d+16>>2]=o[l>>2],h=d+20|0,Bn(b,x+12|0,h),Hi(h),o[d+32>>2]=o[l>>2],h=d+36|0,Bn(b,x+24|0,h),Hi(h),o[d+48>>2]=o[l>>2],h=d+52|0,Bn(b,x+36|0,h),Hi(h),o[d+64>>2]=o[l>>2],d=d+68|0,Bn(b,x+48|0,d),Hi(d),De=V}function yo(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0;if(be=De,De=De+32|0,ne=be+12|0,B=be,ue=l+4|0,se=o[16928+(h<<2)>>2]|0,X=(x|0)!=0,se=X?se*3|0:se,b=o[ue>>2]|0,$=l+8|0,M=o[$>>2]|0,X){if(S=l+12|0,x=o[S>>2]|0,b=M+b+x|0,(b|0)==(se|0))return ue=1,De=be,ue|0;V=S}else V=l+12|0,x=o[V>>2]|0,b=M+b+x|0;if((b|0)<=(se|0))return ue=0,De=be,ue|0;do if((x|0)>0){if(x=o[l>>2]|0,(M|0)>0){S=18608+(x*80|0)+60|0,x=l;break}x=18608+(x*80|0)+40|0,d?(Ku(ne,se,0,0),ws(ue,ne,B),Go(B),Bn(B,ne,ue),S=x,x=l):(S=x,x=l)}else S=18608+((o[l>>2]|0)*80|0)+20|0,x=l;while(0);if(o[x>>2]=o[S>>2],b=S+16|0,(o[b>>2]|0)>0){x=0;do Ga(ue),x=x+1|0;while((x|0)<(o[b>>2]|0))}return l=S+4|0,o[ne>>2]=o[l>>2],o[ne+4>>2]=o[l+4>>2],o[ne+8>>2]=o[l+8>>2],h=o[16848+(h<<2)>>2]|0,er(ne,X?h*3|0:h),Bn(ue,ne,ue),Hi(ue),X?x=((o[$>>2]|0)+(o[ue>>2]|0)+(o[V>>2]|0)|0)==(se|0)?1:2:x=2,ue=x,De=be,ue|0}function ha(l,h){l=l|0,h=h|0;var d=0;do d=yo(l,h,0,1)|0;while((d|0)==2);return d|0}function KA(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0,Ce=0,_e=0,Ge=0,Te=0,Ue=0,xe=0,m=0,g=0,v=0,E=0,C=0,R=0,O=0;if(C=De,De=De+240|0,S=C+224|0,m=C+208|0,g=C,v=C+192|0,E=C+176|0,_e=C+160|0,Ge=C+144|0,Te=C+128|0,Ue=C+112|0,xe=C+96|0,o[S>>2]=h,o[m>>2]=o[l>>2],o[m+4>>2]=o[l+4>>2],o[m+8>>2]=o[l+8>>2],o[m+12>>2]=o[l+12>>2],fa(m,S,g),o[b>>2]=0,Ce=x+d+((x|0)==6&1)|0,(Ce|0)<=(d|0)){De=C;return}V=o[S>>2]|0,$=d+6|0,X=16928+(V<<2)|0,se=Ge+8|0,ne=Te+8|0,ue=Ue+8|0,be=v+4|0,M=0,B=d,x=-1;e:for(;;){if(S=(B|0)%6|0,l=g+(S<<4)|0,o[v>>2]=o[l>>2],o[v+4>>2]=o[l+4>>2],o[v+8>>2]=o[l+8>>2],o[v+12>>2]=o[l+12>>2],l=M,M=yo(v,V,0,1)|0,(B|0)>(d|0)&(fr(h)|0)!=0&&(l|0)!=1&&(o[v>>2]|0)!=(x|0)){switch(Uo(g+(((S+5|0)%6|0)<<4)+4|0,E),Uo(g+(S<<4)+4|0,_e),R=+(o[X>>2]|0),G[Ge>>3]=R*3,G[se>>3]=0,O=R*-1.5,G[Te>>3]=O,G[ne>>3]=R*2.598076211353316,G[Ue>>3]=O,G[ue>>3]=R*-2.598076211353316,S=o[m>>2]|0,o[17008+(S*80|0)+(((x|0)==(S|0)?o[v>>2]|0:x)<<2)>>2]|0){case 1:{l=Te,x=Ge;break}case 3:{l=Ue,x=Te;break}case 2:{l=Ge,x=Ue;break}default:{l=8;break e}}lu(E,_e,x,l,xe),!(_a(E,xe)|0)&&!(_a(_e,xe)|0)&&($o(xe,o[m>>2]|0,V,1,b+8+(o[b>>2]<<4)|0),o[b>>2]=(o[b>>2]|0)+1)}if((B|0)<($|0)&&(Uo(be,E),$o(E,o[v>>2]|0,V,1,b+8+(o[b>>2]<<4)|0),o[b>>2]=(o[b>>2]|0)+1),B=B+1|0,(B|0)>=(Ce|0)){l=3;break}else x=o[v>>2]|0}if((l|0)==3){De=C;return}else(l|0)==8&&Mt(22557,22521,746,22602)}function fa(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0;V=De,De=De+160|0,x=V+80|0,b=V,S=x,M=20336,B=S+72|0;do o[S>>2]=o[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));S=b,M=20416,B=S+72|0;do o[S>>2]=o[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));B=(fr(o[h>>2]|0)|0)==0,x=B?x:b,b=l+4|0,QA(b),wl(b),fr(o[h>>2]|0)|0&&(go(b),o[h>>2]=(o[h>>2]|0)+1),o[d>>2]=o[l>>2],h=d+4|0,Bn(b,x,h),Hi(h),o[d+16>>2]=o[l>>2],h=d+20|0,Bn(b,x+12|0,h),Hi(h),o[d+32>>2]=o[l>>2],h=d+36|0,Bn(b,x+24|0,h),Hi(h),o[d+48>>2]=o[l>>2],h=d+52|0,Bn(b,x+36|0,h),Hi(h),o[d+64>>2]=o[l>>2],h=d+68|0,Bn(b,x+48|0,h),Hi(h),o[d+80>>2]=o[l>>2],d=d+84|0,Bn(b,x+60|0,d),Hi(d),De=V}function hi(l){l=+l;var h=0;return h=l<0?l+6.283185307179586:l,+(l>=6.283185307179586?h+-6.283185307179586:h)}function Fs(l,h){return l=l|0,h=h|0,+Pe(+(+G[l>>3]-+G[h>>3]))<17453292519943298e-27?(h=+Pe(+(+G[l+8>>3]-+G[h+8>>3]))<17453292519943298e-27,h|0):(h=0,h|0)}function Gn(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0;return b=+G[h>>3],x=+G[l>>3],S=+$e(+((b-x)*.5)),d=+$e(+((+G[h+8>>3]-+G[l+8>>3])*.5)),d=S*S+d*(+at(+b)*+at(+x)*d),+(+jt(+ +ke(+d),+ +ke(+(1-d)))*2)}function Wn(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0;return b=+G[h>>3],x=+G[l>>3],S=+$e(+((b-x)*.5)),d=+$e(+((+G[h+8>>3]-+G[l+8>>3])*.5)),d=S*S+d*(+at(+b)*+at(+x)*d),+(+jt(+ +ke(+d),+ +ke(+(1-d)))*2*6371.007180918475)}function vi(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0;return b=+G[h>>3],x=+G[l>>3],S=+$e(+((b-x)*.5)),d=+$e(+((+G[h+8>>3]-+G[l+8>>3])*.5)),d=S*S+d*(+at(+b)*+at(+x)*d),+(+jt(+ +ke(+d),+ +ke(+(1-d)))*2*6371.007180918475*1e3)}function di(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;return S=+G[h>>3],x=+at(+S),b=+G[h+8>>3]-+G[l+8>>3],M=x*+$e(+b),d=+G[l>>3],+ +jt(+M,+(+$e(+S)*+at(+d)-+at(+b)*(x*+$e(+d))))}function El(l,h,d,x){l=l|0,h=+h,d=+d,x=x|0;var b=0,S=0,M=0,B=0;if(d<1e-16){o[x>>2]=o[l>>2],o[x+4>>2]=o[l+4>>2],o[x+8>>2]=o[l+8>>2],o[x+12>>2]=o[l+12>>2];return}S=h<0?h+6.283185307179586:h,S=h>=6.283185307179586?S+-6.283185307179586:S;do if(S<1e-16)h=+G[l>>3]+d,G[x>>3]=h,b=x;else{if(b=+Pe(+(S+-3.141592653589793))<1e-16,h=+G[l>>3],b){h=h-d,G[x>>3]=h,b=x;break}if(M=+at(+d),d=+$e(+d),h=M*+$e(+h)+ +at(+S)*(d*+at(+h)),h=h>1?1:h,h=+Dt(+(h<-1?-1:h)),G[x>>3]=h,+Pe(+(h+-1.5707963267948966))<1e-16){G[x>>3]=1.5707963267948966,G[x+8>>3]=0;return}if(+Pe(+(h+1.5707963267948966))<1e-16){G[x>>3]=-1.5707963267948966,G[x+8>>3]=0;return}if(B=+at(+h),S=d*+$e(+S)/B,d=+G[l>>3],h=(M-+$e(+h)*+$e(+d))/+at(+d)/B,M=S>1?1:S,h=h>1?1:h,h=+G[l+8>>3]+ +jt(+(M<-1?-1:M),+(h<-1?-1:h)),h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);G[x+8>>3]=h;return}while(0);if(+Pe(+(h+-1.5707963267948966))<1e-16){G[b>>3]=1.5707963267948966,G[x+8>>3]=0;return}if(+Pe(+(h+1.5707963267948966))<1e-16){G[b>>3]=-1.5707963267948966,G[x+8>>3]=0;return}if(h=+G[l+8>>3],h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);G[x+8>>3]=h}function Ho(l){return l=l|0,+ +G[20496+(l<<3)>>3]}function ec(l){return l=l|0,+ +G[20624+(l<<3)>>3]}function $a(l){return l=l|0,+ +G[20752+(l<<3)>>3]}function tc(l){return l=l|0,+ +G[20880+(l<<3)>>3]}function JA(l){l=l|0;var h=0;return h=21008+(l<<3)|0,l=o[h>>2]|0,Ot(o[h+4>>2]|0),l|0}function Ns(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0;return ne=+G[h>>3],X=+G[l>>3],V=+$e(+((ne-X)*.5)),S=+G[h+8>>3],$=+G[l+8>>3],M=+$e(+((S-$)*.5)),B=+at(+X),se=+at(+ne),M=V*V+M*(se*B*M),M=+jt(+ +ke(+M),+ +ke(+(1-M)))*2,V=+G[d>>3],ne=+$e(+((V-ne)*.5)),x=+G[d+8>>3],S=+$e(+((x-S)*.5)),b=+at(+V),S=ne*ne+S*(se*b*S),S=+jt(+ +ke(+S),+ +ke(+(1-S)))*2,V=+$e(+((X-V)*.5)),x=+$e(+(($-x)*.5)),x=V*V+x*(B*b*x),x=+jt(+ +ke(+x),+ +ke(+(1-x)))*2,b=(M+S+x)*.5,+(+rn(+ +ke(+(+ht(+(b*.5))*+ht(+((b-M)*.5))*+ht(+((b-S)*.5))*+ht(+((b-x)*.5)))))*4)}function Tl(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(S=De,De=De+192|0,x=S+168|0,b=S,Vs(l,h,x),ls(l,h,b),h=o[b>>2]|0,(h|0)<=0)return d=0,De=S,+d;if(d=+Ns(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,x)+0,(h|0)==1)return De=S,+d;l=1;do M=l,l=l+1|0,d=d+ +Ns(b+8+(M<<4)|0,b+8+(((l|0)%(h|0)|0)<<4)|0,x);while((l|0)<(h|0));return De=S,+d}function Ha(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(S=De,De=De+192|0,x=S+168|0,b=S,Vs(l,h,x),ls(l,h,b),h=o[b>>2]|0,(h|0)>0){if(d=+Ns(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,x)+0,(h|0)!=1){l=1;do M=l,l=l+1|0,d=d+ +Ns(b+8+(M<<4)|0,b+8+(((l|0)%(h|0)|0)<<4)|0,x);while((l|0)<(h|0))}}else d=0;return De=S,+(d*6371.007180918475*6371.007180918475)}function da(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(S=De,De=De+192|0,x=S+168|0,b=S,Vs(l,h,x),ls(l,h,b),h=o[b>>2]|0,(h|0)>0){if(d=+Ns(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,x)+0,(h|0)!=1){l=1;do M=l,l=l+1|0,d=d+ +Ns(b+8+(M<<4)|0,b+8+(((l|0)%(h|0)|0)<<4)|0,x);while((l|0)<(h|0))}}else d=0;return De=S,+(d*6371.007180918475*6371.007180918475*1e3*1e3)}function Sl(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0;if(M=De,De=De+176|0,S=M,Za(l,h,S),l=o[S>>2]|0,(l|0)<=1)return b=0,De=M,+b;h=l+-1|0,l=0,d=0,x=+G[S+8>>3],b=+G[S+16>>3];do l=l+1|0,V=x,x=+G[S+8+(l<<4)>>3],$=+$e(+((x-V)*.5)),B=b,b=+G[S+8+(l<<4)+8>>3],B=+$e(+((b-B)*.5)),B=$*$+B*(+at(+x)*+at(+V)*B),d=d+ +jt(+ +ke(+B),+ +ke(+(1-B)))*2;while((l|0)<(h|0));return De=M,+d}function Ml(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0;if(M=De,De=De+176|0,S=M,Za(l,h,S),l=o[S>>2]|0,(l|0)<=1)return b=0,De=M,+b;h=l+-1|0,l=0,d=0,x=+G[S+8>>3],b=+G[S+16>>3];do l=l+1|0,V=x,x=+G[S+8+(l<<4)>>3],$=+$e(+((x-V)*.5)),B=b,b=+G[S+8+(l<<4)+8>>3],B=+$e(+((b-B)*.5)),B=$*$+B*(+at(+V)*+at(+x)*B),d=d+ +jt(+ +ke(+B),+ +ke(+(1-B)))*2;while((l|0)!=(h|0));return $=d*6371.007180918475,De=M,+$}function pi(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0;if(M=De,De=De+176|0,S=M,Za(l,h,S),l=o[S>>2]|0,(l|0)<=1)return b=0,De=M,+b;h=l+-1|0,l=0,d=0,x=+G[S+8>>3],b=+G[S+16>>3];do l=l+1|0,V=x,x=+G[S+8+(l<<4)>>3],$=+$e(+((x-V)*.5)),B=b,b=+G[S+8+(l<<4)+8>>3],B=+$e(+((b-B)*.5)),B=$*$+B*(+at(+V)*+at(+x)*B),d=d+ +jt(+ +ke(+B),+ +ke(+(1-B)))*2;while((l|0)!=(h|0));return $=d*6371.007180918475*1e3,De=M,+$}function pA(l,h){return l=l|0,h=h|0,h=St(l|0,h|0,52)|0,Oe()|0,h&15|0}function os(l,h){return l=l|0,h=h|0,h=St(l|0,h|0,45)|0,Oe()|0,h&127|0}function eu(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;if(!(!0&(h&-16777216|0)==134217728)||(M=St(l|0,h|0,45)|0,Oe()|0,M=M&127,M>>>0>121))return h=0,h|0;d=St(l|0,h|0,52)|0,Oe()|0,d=d&15;do if(d|0){for(b=1,x=0;;){if(S=St(l|0,h|0,(15-b|0)*3|0)|0,Oe()|0,S=S&7,(S|0)!=0&(x^1))if((S|0)==1&(Jt(M)|0)!=0){B=0,x=13;break}else x=1;if((S|0)==7){B=0,x=13;break}if(b>>>0<d>>>0)b=b+1|0;else{x=9;break}}if((x|0)==9){if((d|0)==15)B=1;else break;return B|0}else if((x|0)==13)return B|0}while(0);for(;;){if(B=St(l|0,h|0,(14-d|0)*3|0)|0,Oe()|0,!((B&7|0)==7&!0)){B=0,x=13;break}if(d>>>0<14)d=d+1|0;else{B=1,x=13;break}}return(x|0)==13?B|0:0}function Cl(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,(x|0)>=(d|0)){if((x|0)!=(d|0))if(d>>>0<=15){if(b=Ct(d|0,0,52)|0,l=b|l,h=Oe()|0|h&-15728641,(x|0)>(d|0))do b=Ct(7,0,(14-d|0)*3|0)|0,d=d+1|0,l=b|l,h=Oe()|0|h;while((d|0)<(x|0))}else h=0,l=0}else h=0,l=0;return Ot(h|0),l|0}function nc(l,h,d){return l=l|0,h=h|0,d=d|0,l=St(l|0,h|0,52)|0,Oe()|0,l=l&15,(d|0)<16&(l|0)<=(d|0)?(d=Ll(7,d-l|0)|0,d|0):(d=0,d|0)}function Wi(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0,X=0;if(M=St(l|0,h|0,52)|0,Oe()|0,M=M&15,!!((d|0)<16&(M|0)<=(d|0))){if((M|0)==(d|0)){d=x,o[d>>2]=l,o[d+4>>2]=h;return}if(V=Ll(7,d-M|0)|0,$=(V|0)/7|0,B=St(l|0,h|0,45)|0,Oe()|0,!(Jt(B&127)|0))S=0;else{e:do if(!M)b=0;else for(S=1;;){if(b=St(l|0,h|0,(15-S|0)*3|0)|0,Oe()|0,b=b&7,b|0)break e;if(S>>>0<M>>>0)S=S+1|0;else{b=0;break}}while(0);S=(b|0)==0}if(X=Ct(M+1|0,0,52)|0,b=Oe()|0|h&-15728641,B=(14-M|0)*3|0,h=Ct(7,0,B|0)|0,h=(X|l)&~h,M=b&~(Oe()|0),Wi(h,M,d,x),b=x+($<<3)|0,!S){X=Ct(1,0,B|0)|0,Wi(X|h,Oe()|0|M,d,b),X=b+($<<3)|0,V=Ct(2,0,B|0)|0,Wi(V|h,Oe()|0|M,d,X),X=X+($<<3)|0,V=Ct(3,0,B|0)|0,Wi(V|h,Oe()|0|M,d,X),X=X+($<<3)|0,V=Ct(4,0,B|0)|0,Wi(V|h,Oe()|0|M,d,X),X=X+($<<3)|0,V=Ct(5,0,B|0)|0,Wi(V|h,Oe()|0|M,d,X),V=Ct(6,0,B|0)|0,Wi(V|h,Oe()|0|M,d,X+($<<3)|0);return}S=b+($<<3)|0,(V|0)>6&&(V=b+8|0,X=(S>>>0>V>>>0?S:V)+-1+(0-b)|0,k(b|0,0,X+8&-8|0)|0,b=V+(X>>>3<<3)|0),X=Ct(2,0,B|0)|0,Wi(X|h,Oe()|0|M,d,b),X=b+($<<3)|0,V=Ct(3,0,B|0)|0,Wi(V|h,Oe()|0|M,d,X),X=X+($<<3)|0,V=Ct(4,0,B|0)|0,Wi(V|h,Oe()|0|M,d,X),X=X+($<<3)|0,V=Ct(5,0,B|0)|0,Wi(V|h,Oe()|0|M,d,X),V=Ct(6,0,B|0)|0,Wi(V|h,Oe()|0|M,d,X+($<<3)|0)}}function Li(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;if(b=St(l|0,h|0,45)|0,Oe()|0,!(Jt(b&127)|0))return b=0,b|0;b=St(l|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!b)d=0;else for(x=1;;){if(d=St(l|0,h|0,(15-x|0)*3|0)|0,Oe()|0,d=d&7,d|0)break e;if(x>>>0<b>>>0)x=x+1|0;else{d=0;break}}while(0);return b=(d|0)==0&1,b|0}function tr(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,(d|0)<16&(x|0)<=(d|0)){if((x|0)!=(d|0)&&(b=Ct(d|0,0,52)|0,l=b|l,h=Oe()|0|h&-15728641,(x|0)<(d|0)))do b=Ct(7,0,(14-x|0)*3|0)|0,x=x+1|0,l=l&~b,h=h&~(Oe()|0);while((x|0)<(d|0))}else h=0,l=0;return Ot(h|0),l|0}function tu(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0,Ce=0,_e=0,Ge=0,Te=0,Ue=0,xe=0,m=0,g=0,v=0,E=0;if(!d)return v=0,v|0;if(b=l,x=o[b>>2]|0,b=o[b+4>>2]|0,!0&(b&15728640|0)==0){if((d|0)<=0||(v=h,o[v>>2]=x,o[v+4>>2]=b,(d|0)==1))return v=0,v|0;x=1;do m=l+(x<<3)|0,g=o[m+4>>2]|0,v=h+(x<<3)|0,o[v>>2]=o[m>>2],o[v+4>>2]=g,x=x+1|0;while((x|0)!=(d|0));return x=0,x|0}if(m=d<<3,g=Yt(m)|0,!g)return v=-3,v|0;if(Ws(g|0,l|0,m|0)|0,xe=Zr(d,8)|0,!xe)return cn(g),v=-3,v|0;x=d;e:for(;;){M=g,X=o[M>>2]|0,M=o[M+4>>2]|0,Te=St(X|0,M|0,52)|0,Oe()|0,Te=Te&15,Ue=Te+-1|0,Ge=(x|0)>0;t:do if(Ge){if(_e=((x|0)<0)<<31>>31,be=Ct(Ue|0,0,52)|0,Ce=Oe()|0,Ue>>>0>15)for(b=0,l=X,d=M;;){if(!((l|0)==0&(d|0)==0)){if(S=St(l|0,d|0,52)|0,Oe()|0,S=S&15,B=(S|0)<(Ue|0),S=(S|0)==(Ue|0),$=B?0:S?l:0,l=B?0:S?d:0,d=Hs($|0,l|0,x|0,_e|0)|0,Oe()|0,S=xe+(d<<3)|0,B=S,V=o[B>>2]|0,B=o[B+4>>2]|0,(V|0)==0&(B|0)==0)d=$;else for(be=0,ue=d,ne=B,d=$;;){if((be|0)>(x|0)){v=41;break e}if((V|0)==(d|0)&(ne&-117440513|0)==(l|0)){$=St(V|0,ne|0,56)|0,Oe()|0,$=$&7,se=$+1|0,Ce=St(V|0,ne|0,45)|0,Oe()|0;n:do if(!(Jt(Ce&127)|0))B=7;else{if(V=St(V|0,ne|0,52)|0,Oe()|0,V=V&15,!V){B=6;break}for(B=1;;){if(Ce=Ct(7,0,(15-B|0)*3|0)|0,!((Ce&d|0)==0&((Oe()|0)&l|0)==0)){B=7;break n}if(B>>>0<V>>>0)B=B+1|0;else{B=6;break}}}while(0);if(($+2|0)>>>0>B>>>0){v=51;break e}Ce=Ct(se|0,0,56)|0,l=Oe()|0|l&-117440513,B=S,o[B>>2]=0,o[B+4>>2]=0,B=ue,d=Ce|d}else B=(ue+1|0)%(x|0)|0;if(S=xe+(B<<3)|0,ne=S,V=o[ne>>2]|0,ne=o[ne+4>>2]|0,(V|0)==0&(ne|0)==0)break;be=be+1|0,ue=B}Ce=S,o[Ce>>2]=d,o[Ce+4>>2]=l}if(b=b+1|0,(b|0)>=(x|0))break t;d=g+(b<<3)|0,l=o[d>>2]|0,d=o[d+4>>2]|0}for(b=0,l=X,d=M;;){if(!((l|0)==0&(d|0)==0)){if(B=St(l|0,d|0,52)|0,Oe()|0,B=B&15,(B|0)>=(Ue|0)){if((B|0)!=(Ue|0)&&(l=l|be,d=d&-15728641|Ce,B>>>0>=Te>>>0)){S=Ue;do ue=Ct(7,0,(14-S|0)*3|0)|0,S=S+1|0,l=ue|l,d=Oe()|0|d;while(S>>>0<B>>>0)}}else l=0,d=0;if(B=Hs(l|0,d|0,x|0,_e|0)|0,Oe()|0,S=xe+(B<<3)|0,V=S,$=o[V>>2]|0,V=o[V+4>>2]|0,!(($|0)==0&(V|0)==0))for(ue=0;;){if((ue|0)>(x|0)){v=41;break e}if(($|0)==(l|0)&(V&-117440513|0)==(d|0)){se=St($|0,V|0,56)|0,Oe()|0,se=se&7,ne=se+1|0,E=St($|0,V|0,45)|0,Oe()|0;n:do if(!(Jt(E&127)|0))V=7;else{if($=St($|0,V|0,52)|0,Oe()|0,$=$&15,!$){V=6;break}for(V=1;;){if(E=Ct(7,0,(15-V|0)*3|0)|0,!((E&l|0)==0&((Oe()|0)&d|0)==0)){V=7;break n}if(V>>>0<$>>>0)V=V+1|0;else{V=6;break}}}while(0);if((se+2|0)>>>0>V>>>0){v=51;break e}E=Ct(ne|0,0,56)|0,d=Oe()|0|d&-117440513,ne=S,o[ne>>2]=0,o[ne+4>>2]=0,l=E|l}else B=(B+1|0)%(x|0)|0;if(S=xe+(B<<3)|0,V=S,$=o[V>>2]|0,V=o[V+4>>2]|0,($|0)==0&(V|0)==0)break;ue=ue+1|0}E=S,o[E>>2]=l,o[E+4>>2]=d}if(b=b+1|0,(b|0)>=(x|0))break t;d=g+(b<<3)|0,l=o[d>>2]|0,d=o[d+4>>2]|0}}while(0);if((x+5|0)>>>0<11){v=99;break}if(Ce=Zr((x|0)/6|0,8)|0,!Ce){v=58;break}t:do if(Ge){ue=0,ne=0;do{if(B=xe+(ue<<3)|0,l=B,b=o[l>>2]|0,l=o[l+4>>2]|0,!((b|0)==0&(l|0)==0)){V=St(b|0,l|0,56)|0,Oe()|0,V=V&7,d=V+1|0,$=l&-117440513,E=St(b|0,l|0,45)|0,Oe()|0;n:do if(Jt(E&127)|0){if(se=St(b|0,l|0,52)|0,Oe()|0,se=se&15,se|0)for(S=1;;){if(E=Ct(7,0,(15-S|0)*3|0)|0,!((b&E|0)==0&($&(Oe()|0)|0)==0))break n;if(S>>>0<se>>>0)S=S+1|0;else break}l=Ct(d|0,0,56)|0,b=l|b,l=Oe()|0|$,d=B,o[d>>2]=b,o[d+4>>2]=l,d=V+2|0}while(0);(d|0)==7&&(E=Ce+(ne<<3)|0,o[E>>2]=b,o[E+4>>2]=l&-117440513,ne=ne+1|0)}ue=ue+1|0}while((ue|0)!=(x|0));if(Ge){if(be=((x|0)<0)<<31>>31,se=Ct(Ue|0,0,52)|0,ue=Oe()|0,Ue>>>0>15)for(l=0,b=0;;){do if(!((X|0)==0&(M|0)==0)){for(V=St(X|0,M|0,52)|0,Oe()|0,V=V&15,S=(V|0)<(Ue|0),V=(V|0)==(Ue|0),B=S?0:V?X:0,V=S?0:V?M:0,S=Hs(B|0,V|0,x|0,be|0)|0,Oe()|0,d=0;;){if((d|0)>(x|0)){v=98;break e}if(E=xe+(S<<3)|0,$=o[E+4>>2]|0,($&-117440513|0)==(V|0)&&(o[E>>2]|0)==(B|0)){v=70;break}if(S=(S+1|0)%(x|0)|0,E=xe+(S<<3)|0,(o[E>>2]|0)==(B|0)&&(o[E+4>>2]|0)==(V|0))break;d=d+1|0}if((v|0)==70&&(v=0,!0&($&117440512|0)==100663296))break;E=h+(b<<3)|0,o[E>>2]=X,o[E+4>>2]=M,b=b+1|0}while(0);if(l=l+1|0,(l|0)>=(x|0)){x=ne;break t}M=g+(l<<3)|0,X=o[M>>2]|0,M=o[M+4>>2]|0}for(l=0,b=0;;){do if(!((X|0)==0&(M|0)==0)){if(V=St(X|0,M|0,52)|0,Oe()|0,V=V&15,(V|0)>=(Ue|0))if((V|0)!=(Ue|0))if(d=X|se,S=M&-15728641|ue,V>>>0<Te>>>0)V=S;else{B=Ue;do E=Ct(7,0,(14-B|0)*3|0)|0,B=B+1|0,d=E|d,S=Oe()|0|S;while(B>>>0<V>>>0);V=S}else d=X,V=M;else d=0,V=0;for(B=Hs(d|0,V|0,x|0,be|0)|0,Oe()|0,S=0;;){if((S|0)>(x|0)){v=98;break e}if(E=xe+(B<<3)|0,$=o[E+4>>2]|0,($&-117440513|0)==(V|0)&&(o[E>>2]|0)==(d|0)){v=93;break}if(B=(B+1|0)%(x|0)|0,E=xe+(B<<3)|0,(o[E>>2]|0)==(d|0)&&(o[E+4>>2]|0)==(V|0))break;S=S+1|0}if((v|0)==93&&(v=0,!0&($&117440512|0)==100663296))break;E=h+(b<<3)|0,o[E>>2]=X,o[E+4>>2]=M,b=b+1|0}while(0);if(l=l+1|0,(l|0)>=(x|0)){x=ne;break t}M=g+(l<<3)|0,X=o[M>>2]|0,M=o[M+4>>2]|0}}else b=0,x=ne}else b=0,x=0;while(0);if(k(xe|0,0,m|0)|0,Ws(g|0,Ce|0,x<<3|0)|0,cn(Ce),x)h=h+(b<<3)|0;else break}return(v|0)==41?(cn(g),cn(xe),E=-1,E|0):(v|0)==51?(cn(g),cn(xe),E=-2,E|0):(v|0)==58?(cn(g),cn(xe),E=-3,E|0):(v|0)==98?(cn(Ce),cn(g),cn(xe),E=-1,E|0):((v|0)==99&&Ws(h|0,g|0,x<<3|0)|0,cn(g),cn(xe),E=0,E|0)}function Us(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,X=0;if((h|0)<=0)return b=0,b|0;if((b|0)>=16){for(S=0;;){if(X=l+(S<<3)|0,!((o[X>>2]|0)==0&(o[X+4>>2]|0)==0)){S=14;break}if(S=S+1|0,(S|0)>=(h|0)){M=0,S=16;break}}if((S|0)==14)return((x|0)>0?-2:-1)|0;if((S|0)==16)return M|0}S=0,X=0;e:for(;;){$=l+(X<<3)|0,B=$,M=o[B>>2]|0,B=o[B+4>>2]|0;do if(!((M|0)==0&(B|0)==0)){if((S|0)>=(x|0)){M=-1,S=16;break e}if(V=St(M|0,B|0,52)|0,Oe()|0,V=V&15,(V|0)>(b|0)){M=-2,S=16;break e}if((V|0)==(b|0)){$=d+(S<<3)|0,o[$>>2]=M,o[$+4>>2]=B,S=S+1|0;break}if(M=(Ll(7,b-V|0)|0)+S|0,(M|0)>(x|0)){M=-1,S=16;break e}Wi(o[$>>2]|0,o[$+4>>2]|0,b,d+(S<<3)|0),S=M}while(0);if(X=X+1|0,(X|0)>=(h|0)){M=0,S=16;break}}return(S|0)==16?M|0:0}function ic(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if((h|0)<=0)return d=0,d|0;if((d|0)>=16){for(x=0;;){if(M=l+(x<<3)|0,!((o[M>>2]|0)==0&(o[M+4>>2]|0)==0)){x=-1,b=13;break}if(x=x+1|0,(x|0)>=(h|0)){x=0,b=13;break}}if((b|0)==13)return x|0}x=0,M=0;e:for(;;){b=l+(M<<3)|0,S=o[b>>2]|0,b=o[b+4>>2]|0;do if(!((S|0)==0&(b|0)==0)){if(b=St(S|0,b|0,52)|0,Oe()|0,b=b&15,(b|0)>(d|0)){x=-1,b=13;break e}if((b|0)==(d|0)){x=x+1|0;break}else{x=(Ll(7,d-b|0)|0)+x|0;break}}while(0);if(M=M+1|0,(M|0)>=(h|0)){b=13;break}}return(b|0)==13?x|0:0}function gA(l,h){return l=l|0,h=h|0,h=St(l|0,h|0,52)|0,Oe()|0,h&1|0}function lr(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;if(b=St(l|0,h|0,52)|0,Oe()|0,b=b&15,!b)return b=0,b|0;for(x=1;;){if(d=St(l|0,h|0,(15-x|0)*3|0)|0,Oe()|0,d=d&7,d|0){x=5;break}if(x>>>0<b>>>0)x=x+1|0;else{d=0,x=5;break}}return(x|0)==5?d|0:0}function wr(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(V=St(l|0,h|0,52)|0,Oe()|0,V=V&15,!V)return B=h,V=l,Ot(B|0),V|0;for(B=1,d=0;;){S=(15-B|0)*3|0,x=Ct(7,0,S|0)|0,b=Oe()|0,M=St(l|0,h|0,S|0)|0,Oe()|0,S=Ct(Gr(M&7)|0,0,S|0)|0,M=Oe()|0,l=S|l&~x,h=M|h&~b;e:do if(!d)if((S&x|0)==0&(M&b|0)==0)d=0;else if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)d=1;else{d=1;t:for(;;){switch(M=St(l|0,h|0,(15-d|0)*3|0)|0,Oe()|0,M&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<x>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(M=(15-d|0)*3|0,b=St(l|0,h|0,M|0)|0,Oe()|0,S=Ct(7,0,M|0)|0,h=h&~(Oe()|0),M=Ct(Gr(b&7)|0,0,M|0)|0,l=l&~S|M,h=h|(Oe()|0),d>>>0<x>>>0)d=d+1|0;else{d=1;break}}while(0);if(B>>>0<V>>>0)B=B+1|0;else break}return Ot(h|0),l|0}function as(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)return d=h,x=l,Ot(d|0),x|0;for(d=1;S=(15-d|0)*3|0,M=St(l|0,h|0,S|0)|0,Oe()|0,b=Ct(7,0,S|0)|0,h=h&~(Oe()|0),S=Ct(Gr(M&7)|0,0,S|0)|0,l=S|l&~b,h=Oe()|0|h,d>>>0<x>>>0;)d=d+1|0;return Ot(h|0),l|0}function pa(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(V=St(l|0,h|0,52)|0,Oe()|0,V=V&15,!V)return B=h,V=l,Ot(B|0),V|0;for(B=1,d=0;;){S=(15-B|0)*3|0,x=Ct(7,0,S|0)|0,b=Oe()|0,M=St(l|0,h|0,S|0)|0,Oe()|0,S=Ct(jr(M&7)|0,0,S|0)|0,M=Oe()|0,l=S|l&~x,h=M|h&~b;e:do if(!d)if((S&x|0)==0&(M&b|0)==0)d=0;else if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)d=1;else{d=1;t:for(;;){switch(M=St(l|0,h|0,(15-d|0)*3|0)|0,Oe()|0,M&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<x>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(b=(15-d|0)*3|0,S=Ct(7,0,b|0)|0,M=h&~(Oe()|0),h=St(l|0,h|0,b|0)|0,Oe()|0,h=Ct(jr(h&7)|0,0,b|0)|0,l=l&~S|h,h=M|(Oe()|0),d>>>0<x>>>0)d=d+1|0;else{d=1;break}}while(0);if(B>>>0<V>>>0)B=B+1|0;else break}return Ot(h|0),l|0}function Qr(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)return d=h,x=l,Ot(d|0),x|0;for(d=1;M=(15-d|0)*3|0,S=Ct(7,0,M|0)|0,b=h&~(Oe()|0),h=St(l|0,h|0,M|0)|0,Oe()|0,h=Ct(jr(h&7)|0,0,M|0)|0,l=h|l&~S,h=Oe()|0|b,d>>>0<x>>>0;)d=d+1|0;return Ot(h|0),l|0}function _o(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0;if(V=De,De=De+64|0,B=V+40|0,x=V+24|0,b=V+12|0,S=V,Ct(h|0,0,52)|0,d=Oe()|0|134225919,!h)return(o[l+4>>2]|0)>2||(o[l+8>>2]|0)>2||(o[l+12>>2]|0)>2?(M=0,B=0,Ot(M|0),De=V,B|0):(Ct(Vn(l)|0,0,45)|0,M=Oe()|0|d,B=-1,Ot(M|0),De=V,B|0);if(o[B>>2]=o[l>>2],o[B+4>>2]=o[l+4>>2],o[B+8>>2]=o[l+8>>2],o[B+12>>2]=o[l+12>>2],M=B+4|0,(h|0)>0)for(l=-1;o[x>>2]=o[M>>2],o[x+4>>2]=o[M+4>>2],o[x+8>>2]=o[M+8>>2],h&1?(xl(M),o[b>>2]=o[M>>2],o[b+4>>2]=o[M+4>>2],o[b+8>>2]=o[M+8>>2],ca(b)):(Vo(M),o[b>>2]=o[M>>2],o[b+4>>2]=o[M+4>>2],o[b+8>>2]=o[M+8>>2],go(b)),ws(x,b,S),Hi(S),X=(15-h|0)*3|0,$=Ct(7,0,X|0)|0,d=d&~(Oe()|0),X=Ct(po(S)|0,0,X|0)|0,l=X|l&~$,d=Oe()|0|d,(h|0)>1;)h=h+-1|0;else l=-1;e:do if((o[M>>2]|0)<=2&&(o[B+8>>2]|0)<=2&&(o[B+12>>2]|0)<=2){if(x=Vn(B)|0,h=Ct(x|0,0,45)|0,h=h|l,l=Oe()|0|d&-1040385,S=aA(B)|0,!(Jt(x)|0)){if((S|0)<=0)break;for(b=0;;){if(x=St(h|0,l|0,52)|0,Oe()|0,x=x&15,x)for(d=1;X=(15-d|0)*3|0,B=St(h|0,l|0,X|0)|0,Oe()|0,$=Ct(7,0,X|0)|0,l=l&~(Oe()|0),X=Ct(Gr(B&7)|0,0,X|0)|0,h=h&~$|X,l=l|(Oe()|0),d>>>0<x>>>0;)d=d+1|0;if(b=b+1|0,(b|0)==(S|0))break e}}b=St(h|0,l|0,52)|0,Oe()|0,b=b&15;t:do if(b){d=1;n:for(;;){switch(X=St(h|0,l|0,(15-d|0)*3|0)|0,Oe()|0,X&7){case 1:break n;case 0:break;default:break t}if(d>>>0<b>>>0)d=d+1|0;else break t}if($A(x,o[B>>2]|0)|0)for(d=1;B=(15-d|0)*3|0,$=Ct(7,0,B|0)|0,X=l&~(Oe()|0),l=St(h|0,l|0,B|0)|0,Oe()|0,l=Ct(jr(l&7)|0,0,B|0)|0,h=h&~$|l,l=X|(Oe()|0),d>>>0<b>>>0;)d=d+1|0;else for(d=1;X=(15-d|0)*3|0,B=St(h|0,l|0,X|0)|0,Oe()|0,$=Ct(7,0,X|0)|0,l=l&~(Oe()|0),X=Ct(Gr(B&7)|0,0,X|0)|0,h=h&~$|X,l=l|(Oe()|0),d>>>0<b>>>0;)d=d+1|0}while(0);if((S|0)>0){d=0;do h=wr(h,l)|0,l=Oe()|0,d=d+1|0;while((d|0)!=(S|0))}}else h=0,l=0;while(0);return $=l,X=h,Ot($|0),De=V,X|0}function fr(l){return l=l|0,(l|0)%2|0|0}function Wa(l,h){l=l|0,h=h|0;var d=0,x=0;return x=De,De=De+16|0,d=x,h>>>0<=15&&(o[l+4>>2]&2146435072|0)!=2146435072&&(o[l+8+4>>2]&2146435072|0)!=2146435072?(dA(l,h,d),h=_o(d,h)|0,l=Oe()|0):(l=0,h=0),Ot(l|0),De=x,h|0}function Pl(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if(b=d+4|0,S=St(l|0,h|0,52)|0,Oe()|0,S=S&15,M=St(l|0,h|0,45)|0,Oe()|0,x=(S|0)==0,Jt(M&127)|0){if(x)return M=1,M|0;x=1}else{if(x)return M=0,M|0;!(o[b>>2]|0)&&!(o[d+8>>2]|0)?x=(o[d+12>>2]|0)!=0&1:x=1}for(d=1;d&1?ca(b):go(b),M=St(l|0,h|0,(15-d|0)*3|0)|0,Oe()|0,fA(b,M&7),d>>>0<S>>>0;)d=d+1|0;return x|0}function Qa(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0;X=De,De=De+16|0,V=X,$=St(l|0,h|0,45)|0,Oe()|0,$=$&127;e:do if(Jt($)|0&&(S=St(l|0,h|0,52)|0,Oe()|0,S=S&15,(S|0)!=0)){x=1;t:for(;;){switch(B=St(l|0,h|0,(15-x|0)*3|0)|0,Oe()|0,B&7){case 5:break t;case 0:break;default:{x=h;break e}}if(x>>>0<S>>>0)x=x+1|0;else{x=h;break e}}for(b=1,x=h;h=(15-b|0)*3|0,M=Ct(7,0,h|0)|0,B=x&~(Oe()|0),x=St(l|0,x|0,h|0)|0,Oe()|0,x=Ct(jr(x&7)|0,0,h|0)|0,l=l&~M|x,x=B|(Oe()|0),b>>>0<S>>>0;)b=b+1|0}else x=h;while(0);if(B=7728+($*28|0)|0,o[d>>2]=o[B>>2],o[d+4>>2]=o[B+4>>2],o[d+8>>2]=o[B+8>>2],o[d+12>>2]=o[B+12>>2],!(Pl(l,x,d)|0)){De=X;return}if(M=d+4|0,o[V>>2]=o[M>>2],o[V+4>>2]=o[M+4>>2],o[V+8>>2]=o[M+8>>2],S=St(l|0,x|0,52)|0,Oe()|0,B=S&15,S&1?(go(M),S=B+1|0):S=B,!(Jt($)|0))x=0;else{e:do if(!B)x=0;else for(h=1;;){if(b=St(l|0,x|0,(15-h|0)*3|0)|0,Oe()|0,b=b&7,b|0){x=b;break e}if(h>>>0<B>>>0)h=h+1|0;else{x=0;break}}while(0);x=(x|0)==4&1}if(!(yo(d,S,x,0)|0))(S|0)!=(B|0)&&(o[M>>2]=o[V>>2],o[M+4>>2]=o[V+4>>2],o[M+8>>2]=o[V+8>>2]);else{if(Jt($)|0)do;while(yo(d,S,0,0)|0);(S|0)!=(B|0)&&Vo(M)}De=X}function Vs(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;x=De,De=De+16|0,b=x,Qa(l,h,b),h=St(l|0,h|0,52)|0,Oe()|0,ja(b,h&15,d),De=x}function ls(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0;M=De,De=De+16|0,S=M,Qa(l,h,S),x=St(l|0,h|0,45)|0,Oe()|0,x=(Jt(x&127)|0)==0,b=St(l|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!x){if(b|0)for(x=1;;){if(B=Ct(7,0,(15-x|0)*3|0)|0,!((B&l|0)==0&((Oe()|0)&h|0)==0))break e;if(x>>>0<b>>>0)x=x+1|0;else break}YA(S,b,0,5,d),De=M;return}while(0);KA(S,b,0,6,d),De=M}function rc(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;if(x=St(l|0,h|0,45)|0,Oe()|0,!(Jt(x&127)|0))return x=2,x|0;if(x=St(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)return x=5,x|0;for(d=1;;){if(b=Ct(7,0,(15-d|0)*3|0)|0,!((b&l|0)==0&((Oe()|0)&h|0)==0)){d=2,l=6;break}if(d>>>0<x>>>0)d=d+1|0;else{d=5,l=6;break}}return(l|0)==6?d|0:0}function ga(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0;se=De,De=De+128|0,$=se+112|0,S=se+96|0,X=se,b=St(l|0,h|0,52)|0,Oe()|0,B=b&15,o[$>>2]=B,M=St(l|0,h|0,45)|0,Oe()|0,M=M&127;e:do if(Jt(M)|0){if(B|0)for(x=1;;){if(V=Ct(7,0,(15-x|0)*3|0)|0,!((V&l|0)==0&((Oe()|0)&h|0)==0)){b=0;break e}if(x>>>0<B>>>0)x=x+1|0;else break}if(b&1)b=1;else{V=Ct(B+1|0,0,52)|0,X=Oe()|0|h&-15728641,$=Ct(7,0,(14-B|0)*3|0)|0,ga((V|l)&~$,X&~(Oe()|0),d),De=se;return}}else b=0;while(0);Qa(l,h,S),b?(XA(S,$,X),V=5):(fa(S,$,X),V=6);e:do if(Jt(M)|0)if(!B)x=20;else for(x=1;;){if(M=Ct(7,0,(15-x|0)*3|0)|0,!((M&l|0)==0&((Oe()|0)&h|0)==0)){x=8;break e}if(x>>>0<B>>>0)x=x+1|0;else{x=20;break}}else x=8;while(0);if(k(d|0,-1,x|0)|0,b){b=0;do{for(S=X+(b<<4)|0,ha(S,o[$>>2]|0)|0,S=o[S>>2]|0,x=0;M=d+(x<<2)|0,B=o[M>>2]|0,!((B|0)==-1|(B|0)==(S|0));)x=x+1|0;o[M>>2]=S,b=b+1|0}while((b|0)!=(V|0))}else{b=0;do{for(S=X+(b<<4)|0,yo(S,o[$>>2]|0,0,1)|0,S=o[S>>2]|0,x=0;M=d+(x<<2)|0,B=o[M>>2]|0,!((B|0)==-1|(B|0)==(S|0));)x=x+1|0;o[M>>2]=S,b=b+1|0}while((b|0)!=(V|0))}De=se}function qa(){return 12}function nr(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(Ct(l|0,0,52)|0,B=Oe()|0|134225919,(l|0)<1){x=0,d=0;do Jt(x)|0&&(Ct(x|0,0,45)|0,M=B|(Oe()|0),l=h+(d<<3)|0,o[l>>2]=-1,o[l+4>>2]=M,d=d+1|0),x=x+1|0;while((x|0)!=122);return}M=0,d=0;do{if(Jt(M)|0){for(Ct(M|0,0,45)|0,x=1,b=-1,S=B|(Oe()|0);V=Ct(7,0,(15-x|0)*3|0)|0,b=b&~V,S=S&~(Oe()|0),(x|0)!=(l|0);)x=x+1|0;V=h+(d<<3)|0,o[V>>2]=b,o[V+4>>2]=S,d=d+1|0}M=M+1|0}while((M|0)!=122)}function bs(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0;if(B=De,De=De+64|0,M=B,(l|0)==(d|0)&(h|0)==(x|0)|(!1|(h&2013265920|0)!=134217728|(!1|(x&2013265920|0)!=134217728))||(b=St(l|0,h|0,52)|0,Oe()|0,b=b&15,S=St(d|0,x|0,52)|0,Oe()|0,(b|0)!=(S&15|0)))return M=0,De=B,M|0;if(S=b+-1|0,b>>>0>1&&($=Cl(l,h,S)|0,V=Oe()|0,S=Cl(d,x,S)|0,($|0)==(S|0)&(V|0)==(Oe()|0))&&(S=(b^15)*3|0,b=St(l|0,h|0,S|0)|0,Oe()|0,b=b&7,S=St(d|0,x|0,S|0)|0,Oe()|0,S=S&7,(b|0)==0|(S|0)==0||(o[21136+(b<<2)>>2]|0)==(S|0)||(o[21168+(b<<2)>>2]|0)==(S|0)))return $=1,De=B,$|0;b=M,S=b+56|0;do o[b>>2]=0,b=b+4|0;while((b|0)<(S|0));return Aa(l,h,1,M),$=M,!((o[$>>2]|0)==(d|0)&&(o[$+4>>2]|0)==(x|0))&&($=M+8|0,!((o[$>>2]|0)==(d|0)&&(o[$+4>>2]|0)==(x|0)))&&($=M+16|0,!((o[$>>2]|0)==(d|0)&&(o[$+4>>2]|0)==(x|0)))&&($=M+24|0,!((o[$>>2]|0)==(d|0)&&(o[$+4>>2]|0)==(x|0)))&&($=M+32|0,!((o[$>>2]|0)==(d|0)&&(o[$+4>>2]|0)==(x|0)))&&($=M+40|0,!((o[$>>2]|0)==(d|0)&&(o[$+4>>2]|0)==(x|0)))?(b=M+48|0,b=((o[b>>2]|0)==(d|0)?(o[b+4>>2]|0)==(x|0):0)&1):b=1,$=b,De=B,$|0}function qr(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0,X=0;if($=De,De=De+16|0,M=$,!(bs(l,h,d,x)|0))return B=0,V=0,Ot(B|0),De=$,V|0;for(B=h&-2130706433,b=(Li(l,h)|0)==0,b=b?1:2;o[M>>2]=0,X=ge(l,h,b,M)|0,S=b+1|0,!((X|0)==(d|0)&(Oe()|0)==(x|0));)if(S>>>0<7)b=S;else{b=0,l=0,V=6;break}return(V|0)==6?(Ot(b|0),De=$,l|0):(X=Ct(b|0,0,56)|0,V=B|(Oe()|0)|268435456,X=l|X,Ot(V|0),De=$,X|0)}function Il(l,h){l=l|0,h=h|0;var d=0;return d=!0&(h&2013265920|0)==268435456,Ot((d?h&-2130706433|134217728:0)|0),(d?l:0)|0}function Wo(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;return x=De,De=De+16|0,d=x,!0&(h&2013265920|0)==268435456?(b=St(l|0,h|0,56)|0,Oe()|0,o[d>>2]=0,d=ge(l,h&-2130706433|134217728,b&7,d)|0,h=Oe()|0,Ot(h|0),De=x,d|0):(h=0,d=0,Ot(h|0),De=x,d|0)}function sc(l,h){l=l|0,h=h|0;var d=0;if(!(!0&(h&2013265920|0)==268435456))return d=0,d|0;switch(d=St(l|0,h|0,56)|0,Oe()|0,d&7){case 0:case 7:return d=0,d|0}return d=h&-2130706433|134217728,!0&(h&117440512|0)==16777216&(Li(l,d)|0)!=0?(d=0,d|0):(d=eu(l,d)|0,d|0)}function vo(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0;S=De,De=De+16|0,x=S,M=!0&(h&2013265920|0)==268435456,b=h&-2130706433|134217728,B=d,o[B>>2]=M?l:0,o[B+4>>2]=M?b:0,M?(h=St(l|0,h|0,56)|0,Oe()|0,o[x>>2]=0,l=ge(l,b,h&7,x)|0,h=Oe()|0):(l=0,h=0),B=d+8|0,o[B>>2]=l,o[B+4>>2]=h,De=S}function kl(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;b=(Li(l,h)|0)==0,h=h&-2130706433,x=d,o[x>>2]=b?l:0,o[x+4>>2]=b?h|285212672:0,x=d+8|0,o[x>>2]=l,o[x+4>>2]=h|301989888,x=d+16|0,o[x>>2]=l,o[x+4>>2]=h|318767104,x=d+24|0,o[x>>2]=l,o[x+4>>2]=h|335544320,x=d+32|0,o[x>>2]=l,o[x+4>>2]=h|352321536,d=d+40|0,o[d>>2]=l,o[d+4>>2]=h|369098752}function Za(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0;if(M=De,De=De+16|0,S=M,x=St(l|0,h|0,56)|0,Oe()|0,B=!0&(h&2013265920|0)==268435456,b=B?l:0,l=B?h&-2130706433|134217728:0,h=us(b,l,x&7)|0,(h|0)==-1){o[d>>2]=0,De=M;return}Qa(b,l,S),x=St(b|0,l|0,52)|0,Oe()|0,x=x&15,Li(b,l)|0?YA(S,x,h,2,d):KA(S,x,h,2,d),De=M}function rh(l){l=l|0;var h=0,d=0,x=0;return h=Zr(1,12)|0,h||Mt(22691,22646,49,22704),d=l+4|0,x=o[d>>2]|0,x|0?(x=x+8|0,o[x>>2]=h,o[d>>2]=h,h|0):(o[l>>2]|0&&Mt(22721,22646,61,22744),x=l,o[x>>2]=h,o[d>>2]=h,h|0)}function sh(l,h){l=l|0,h=h|0;var d=0,x=0;return x=Yt(24)|0,x||Mt(22758,22646,78,22772),o[x>>2]=o[h>>2],o[x+4>>2]=o[h+4>>2],o[x+8>>2]=o[h+8>>2],o[x+12>>2]=o[h+12>>2],o[x+16>>2]=0,h=l+4|0,d=o[h>>2]|0,d|0?(o[d+16>>2]=x,o[h>>2]=x,x|0):(o[l>>2]|0&&Mt(22787,22646,82,22772),o[l>>2]=x,o[h>>2]=x,x|0)}function Ya(l){l=l|0;var h=0,d=0,x=0,b=0;if(l)for(x=1;;){if(h=o[l>>2]|0,h|0)do{if(d=o[h>>2]|0,d|0)do b=d,d=o[d+16>>2]|0,cn(b);while(d|0);b=h,h=o[h+8>>2]|0,cn(b)}while(h|0);if(h=l,l=o[l+8>>2]|0,x||cn(h),l)x=0;else break}}function ma(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0,Ce=0,_e=0,Ge=0,Te=0,Ue=0,xe=0,m=0,g=0,v=0,E=0,C=0,R=0,O=0,N=0,W=0,J=0,le=0,fe=0;if(b=l+8|0,o[b>>2]|0)return fe=1,fe|0;if(x=o[l>>2]|0,!x)return fe=0,fe|0;h=x,d=0;do d=d+1|0,h=o[h+8>>2]|0;while(h|0);if(d>>>0<2)return fe=0,fe|0;J=Yt(d<<2)|0,J||Mt(22807,22646,317,22826),W=Yt(d<<5)|0,W||Mt(22848,22646,321,22826),o[l>>2]=0,g=l+4|0,o[g>>2]=0,o[b>>2]=0,d=0,N=0,m=0,se=0;e:for(;;){if(X=o[x>>2]|0,X){S=0,M=X;do{if(V=+G[M+8>>3],h=M,M=o[M+16>>2]|0,$=(M|0)==0,b=$?X:M,B=+G[b+8>>3],+Pe(+(V-B))>3.141592653589793){fe=14;break}S=S+(B-V)*(+G[h>>3]+ +G[b>>3])}while(!$);if((fe|0)==14){fe=0,S=0,h=X;do xe=+G[h+8>>3],O=h+16|0,R=o[O>>2]|0,R=R|0?R:X,Ue=+G[R+8>>3],S=S+(+G[h>>3]+ +G[R>>3])*((Ue<0?Ue+6.283185307179586:Ue)-(xe<0?xe+6.283185307179586:xe)),h=o[(h|0?O:x)>>2]|0;while(h|0)}S>0?(o[J+(N<<2)>>2]=x,N=N+1|0,b=m,h=se):fe=19}else fe=19;if((fe|0)==19){fe=0;do if(d){if(h=d+8|0,o[h>>2]|0){fe=21;break e}if(d=Zr(1,12)|0,!d){fe=23;break e}o[h>>2]=d,b=d+4|0,M=d,h=se}else if(se){b=g,M=se+8|0,h=x,d=l;break}else if(o[l>>2]|0){fe=27;break e}else{b=g,M=l,h=x,d=l;break}while(0);if(o[M>>2]=x,o[b>>2]=x,M=W+(m<<5)|0,$=o[x>>2]|0,$){for(X=W+(m<<5)+8|0,G[X>>3]=17976931348623157e292,se=W+(m<<5)+24|0,G[se>>3]=17976931348623157e292,G[M>>3]=-17976931348623157e292,ne=W+(m<<5)+16|0,G[ne>>3]=-17976931348623157e292,Ge=17976931348623157e292,Te=-17976931348623157e292,b=0,ue=$,V=17976931348623157e292,Ce=17976931348623157e292,_e=-17976931348623157e292,B=-17976931348623157e292;S=+G[ue>>3],xe=+G[ue+8>>3],ue=o[ue+16>>2]|0,be=(ue|0)==0,Ue=+G[(be?$:ue)+8>>3],S<V&&(G[X>>3]=S,V=S),xe<Ce&&(G[se>>3]=xe,Ce=xe),S>_e?G[M>>3]=S:S=_e,xe>B&&(G[ne>>3]=xe,B=xe),Ge=xe>0&xe<Ge?xe:Ge,Te=xe<0&xe>Te?xe:Te,b=b|+Pe(+(xe-Ue))>3.141592653589793,!be;)_e=S;b&&(G[ne>>3]=Te,G[se>>3]=Ge)}else o[M>>2]=0,o[M+4>>2]=0,o[M+8>>2]=0,o[M+12>>2]=0,o[M+16>>2]=0,o[M+20>>2]=0,o[M+24>>2]=0,o[M+28>>2]=0;b=m+1|0}if(O=x+8|0,x=o[O>>2]|0,o[O>>2]=0,x)m=b,se=h;else{fe=45;break}}if((fe|0)==21)Mt(22624,22646,35,22658);else if((fe|0)==23)Mt(22678,22646,37,22658);else if((fe|0)==27)Mt(22721,22646,61,22744);else if((fe|0)==45){e:do if((N|0)>0){for(O=(b|0)==0,C=b<<2,R=(l|0)==0,E=0,h=0;;){if(v=o[J+(E<<2)>>2]|0,O)fe=73;else{if(m=Yt(C)|0,!m){fe=50;break}if(g=Yt(C)|0,!g){fe=52;break}t:do if(R)d=0;else{for(b=0,d=0,M=l;x=W+(b<<5)|0,As(o[M>>2]|0,x,o[v>>2]|0)|0?(o[m+(d<<2)>>2]=M,o[g+(d<<2)>>2]=x,be=d+1|0):be=d,M=o[M+8>>2]|0,M;)b=b+1|0,d=be;if((be|0)>0)if(x=o[m>>2]|0,(be|0)==1)d=x;else for(ne=0,ue=-1,d=x,se=x;;){for($=o[se>>2]|0,x=0,M=0;b=o[o[m+(M<<2)>>2]>>2]|0,(b|0)==($|0)?X=x:X=x+((As(b,o[g+(M<<2)>>2]|0,o[$>>2]|0)|0)&1)|0,M=M+1|0,(M|0)!=(be|0);)x=X;if(b=(X|0)>(ue|0),d=b?se:d,x=ne+1|0,(x|0)==(be|0))break t;ne=x,ue=b?X:ue,se=o[m+(x<<2)>>2]|0}else d=0}while(0);if(cn(m),cn(g),d){if(b=d+4|0,x=o[b>>2]|0,x)d=x+8|0;else if(o[d>>2]|0){fe=70;break}o[d>>2]=v,o[b>>2]=v}else fe=73}if((fe|0)==73){if(fe=0,h=o[v>>2]|0,h|0)do g=h,h=o[h+16>>2]|0,cn(g);while(h|0);cn(v),h=2}if(E=E+1|0,(E|0)>=(N|0)){le=h;break e}}(fe|0)==50?Mt(22863,22646,249,22882):(fe|0)==52?Mt(22901,22646,252,22882):(fe|0)==70&&Mt(22721,22646,61,22744)}else le=0;while(0);return cn(J),cn(W),fe=le,fe|0}return 0}function As(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0;if(!(hA(h,d)|0)||(h=cA(h)|0,$=+G[d>>3],x=+G[d+8>>3],x=h&x<0?x+6.283185307179586:x,l=o[l>>2]|0,!l))return l=0,l|0;if(h){h=0,d=l;e:for(;;){for(;M=+G[d>>3],V=+G[d+8>>3],d=d+16|0,X=o[d>>2]|0,X=X|0?X:l,S=+G[X>>3],b=+G[X+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!($<S|$>B);)if(d=o[d>>2]|0,!d){d=22;break e}if(V=b<0?b+6.283185307179586:b,M=M<0?M+6.283185307179586:M,x=M==x|V==x?x+-2220446049250313e-31:x,V=V+($-S)/(B-S)*(M-V),(V<0?V+6.283185307179586:V)>x&&(h=h^1),d=o[d>>2]|0,!d){d=22;break}}if((d|0)==22)return h|0}else{h=0,d=l;e:for(;;){for(;M=+G[d>>3],V=+G[d+8>>3],d=d+16|0,X=o[d>>2]|0,X=X|0?X:l,S=+G[X>>3],b=+G[X+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!($<S|$>B);)if(d=o[d>>2]|0,!d){d=22;break e}if(x=M==x|b==x?x+-2220446049250313e-31:x,b+($-S)/(B-S)*(M-b)>x&&(h=h^1),d=o[d>>2]|0,!d){d=22;break}}if((d|0)==22)return h|0}return 0}function Ft(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0,Ce=0,_e=0,Ge=0,Te=0;if(Te=De,De=De+32|0,Ge=Te+16|0,_e=Te,S=St(l|0,h|0,52)|0,Oe()|0,S=S&15,ue=St(d|0,x|0,52)|0,Oe()|0,(S|0)!=(ue&15|0))return Ge=1,De=Te,Ge|0;if($=St(l|0,h|0,45)|0,Oe()|0,$=$&127,X=St(d|0,x|0,45)|0,Oe()|0,X=X&127,ue=($|0)!=(X|0),ue){if(B=uA($,X)|0,(B|0)==7)return Ge=2,De=Te,Ge|0;V=uA(X,$)|0,(V|0)==7?Mt(22925,22949,151,22959):(be=B,M=V)}else be=0,M=0;se=Jt($)|0,ne=Jt(X)|0,o[Ge>>2]=0,o[Ge+4>>2]=0,o[Ge+8>>2]=0,o[Ge+12>>2]=0;do if(be){if(X=o[4304+($*28|0)+(be<<2)>>2]|0,B=(X|0)>0,ne)if(B){$=0,V=d,B=x;do V=pa(V,B)|0,B=Oe()|0,M=jr(M)|0,(M|0)==1&&(M=jr(1)|0),$=$+1|0;while(($|0)!=(X|0));X=M,$=V,V=B}else X=M,$=d,V=x;else if(B){$=0,V=d,B=x;do V=Qr(V,B)|0,B=Oe()|0,M=jr(M)|0,$=$+1|0;while(($|0)!=(X|0));X=M,$=V,V=B}else X=M,$=d,V=x;if(Pl($,V,Ge)|0,ue||Mt(22972,22949,181,22959),B=(se|0)!=0,M=(ne|0)!=0,B&M&&Mt(22999,22949,182,22959),B){if(M=lr(l,h)|0,he[22032+(M*7|0)+be>>0]|0){S=3;break}V=o[21200+(M*28|0)+(be<<2)>>2]|0,$=V,Ce=26}else if(M){if(M=lr($,V)|0,he[22032+(M*7|0)+X>>0]|0){S=4;break}$=0,V=o[21200+(X*28|0)+(M<<2)>>2]|0,Ce=26}else M=0;if((Ce|0)==26)if((V|0)<=-1&&Mt(23030,22949,212,22959),($|0)<=-1&&Mt(23053,22949,213,22959),(V|0)>0){B=Ge+4|0,M=0;do Go(B),M=M+1|0;while((M|0)!=(V|0));M=$}else M=$;if(o[_e>>2]=0,o[_e+4>>2]=0,o[_e+8>>2]=0,fA(_e,be),S|0)for(;fr(S)|0?ca(_e):go(_e),(S|0)>1;)S=S+-1|0;if((M|0)>0){S=0;do Go(_e),S=S+1|0;while((S|0)!=(M|0))}Ce=Ge+4|0,Bn(Ce,_e,Ce),Hi(Ce),Ce=50}else if(Pl(d,x,Ge)|0,(se|0)!=0&(ne|0)!=0)if((X|0)!=($|0)&&Mt(23077,22949,243,22959),M=lr(l,h)|0,S=lr(d,x)|0,he[22032+(M*7|0)+S>>0]|0)S=5;else if(M=o[21200+(M*28|0)+(S<<2)>>2]|0,(M|0)>0){B=Ge+4|0,S=0;do Go(B),S=S+1|0;while((S|0)!=(M|0));Ce=50}else Ce=50;else Ce=50;while(0);return(Ce|0)==50&&(S=Ge+4|0,o[b>>2]=o[S>>2],o[b+4>>2]=o[S+4>>2],o[b+8>>2]=o[S+8>>2],S=0),Ge=S,De=Te,Ge|0}function nu(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0,Ce=0,_e=0,Ge=0,Te=0;if(be=De,De=De+48|0,M=be+36|0,B=be+24|0,V=be+12|0,$=be,S=St(l|0,h|0,52)|0,Oe()|0,S=S&15,ne=St(l|0,h|0,45)|0,Oe()|0,ne=ne&127,X=Jt(ne)|0,Ct(S|0,0,52)|0,_e=Oe()|0|134225919,Ce=x,o[Ce>>2]=-1,o[Ce+4>>2]=_e,!S)return(o[d>>2]|0)>1||(o[d+4>>2]|0)>1||(o[d+8>>2]|0)>1||(b=HA(ne,po(d)|0)|0,(b|0)==127)?(_e=1,De=be,_e|0):(ue=Ct(b|0,0,45)|0,Ce=Oe()|0,ne=x,Ce=o[ne+4>>2]&-1040385|Ce,_e=x,o[_e>>2]=o[ne>>2]|ue,o[_e+4>>2]=Ce,_e=0,De=be,_e|0);for(o[M>>2]=o[d>>2],o[M+4>>2]=o[d+4>>2],o[M+8>>2]=o[d+8>>2];o[B>>2]=o[M>>2],o[B+4>>2]=o[M+4>>2],o[B+8>>2]=o[M+8>>2],fr(S)|0?(xl(M),o[V>>2]=o[M>>2],o[V+4>>2]=o[M+4>>2],o[V+8>>2]=o[M+8>>2],ca(V)):(Vo(M),o[V>>2]=o[M>>2],o[V+4>>2]=o[M+4>>2],o[V+8>>2]=o[M+8>>2],go(V)),ws(B,V,$),Hi($),Ce=x,Ge=o[Ce>>2]|0,Ce=o[Ce+4>>2]|0,Te=(15-S|0)*3|0,d=Ct(7,0,Te|0)|0,Ce=Ce&~(Oe()|0),Te=Ct(po($)|0,0,Te|0)|0,Ce=Oe()|0|Ce,_e=x,o[_e>>2]=Te|Ge&~d,o[_e+4>>2]=Ce,(S|0)>1;)S=S+-1|0;e:do if((o[M>>2]|0)<=1&&(o[M+4>>2]|0)<=1&&(o[M+8>>2]|0)<=1){S=po(M)|0,B=HA(ne,S)|0,(B|0)==127?$=0:$=Jt(B)|0;t:do if(S){if(X){if(M=21408+((lr(l,h)|0)*28|0)+(S<<2)|0,M=o[M>>2]|0,(M|0)>0){d=0;do S=Gr(S)|0,d=d+1|0;while((d|0)!=(M|0))}if((S|0)==1){b=3;break e}d=HA(ne,S)|0,(d|0)==127&&Mt(23104,22949,376,23134),Jt(d)|0?Mt(23147,22949,377,23134):(ue=M,se=S,b=d)}else ue=0,se=S,b=B;if(V=o[4304+(ne*28|0)+(se<<2)>>2]|0,(V|0)<=-1&&Mt(23178,22949,384,23134),!$){if((ue|0)<=-1&&Mt(23030,22949,417,23134),ue|0){M=x,S=0,d=o[M>>2]|0,M=o[M+4>>2]|0;do d=as(d,M)|0,M=Oe()|0,Te=x,o[Te>>2]=d,o[Te+4>>2]=M,S=S+1|0;while((S|0)<(ue|0))}if((V|0)<=0){S=54;break}for(M=x,S=0,d=o[M>>2]|0,M=o[M+4>>2]|0;;)if(d=as(d,M)|0,M=Oe()|0,Te=x,o[Te>>2]=d,o[Te+4>>2]=M,S=S+1|0,(S|0)==(V|0)){S=54;break t}}if(B=uA(b,ne)|0,(B|0)==7&&Mt(22925,22949,393,23134),S=x,d=o[S>>2]|0,S=o[S+4>>2]|0,(V|0)>0){M=0;do d=as(d,S)|0,S=Oe()|0,Te=x,o[Te>>2]=d,o[Te+4>>2]=S,M=M+1|0;while((M|0)!=(V|0))}if(d=lr(d,S)|0,Te=ki(b)|0,d=o[(Te?21824:21616)+(B*28|0)+(d<<2)>>2]|0,(d|0)<=-1&&Mt(23030,22949,412,23134),!d)S=54;else{B=x,S=0,M=o[B>>2]|0,B=o[B+4>>2]|0;do M=wr(M,B)|0,B=Oe()|0,Te=x,o[Te>>2]=M,o[Te+4>>2]=B,S=S+1|0;while((S|0)<(d|0));S=54}}else if((X|0)!=0&($|0)!=0)if(Te=lr(l,h)|0,S=x,S=21408+(Te*28|0)+((lr(o[S>>2]|0,o[S+4>>2]|0)|0)<<2)|0,S=o[S>>2]|0,(S|0)<=-1&&Mt(23201,22949,433,23134),!S)b=B,S=55;else{M=x,b=0,d=o[M>>2]|0,M=o[M+4>>2]|0;do d=as(d,M)|0,M=Oe()|0,Te=x,o[Te>>2]=d,o[Te+4>>2]=M,b=b+1|0;while((b|0)<(S|0));b=B,S=54}else b=B,S=54;while(0);if((S|0)==54&&$&&(S=55),(S|0)==55&&(Te=x,(lr(o[Te>>2]|0,o[Te+4>>2]|0)|0)==1)){b=4;break}Te=x,_e=o[Te>>2]|0,Te=o[Te+4>>2]&-1040385,Ge=Ct(b|0,0,45)|0,Te=Te|(Oe()|0),b=x,o[b>>2]=_e|Ge,o[b+4>>2]=Te,b=0}else b=2;while(0);return Te=b,De=be,Te|0}function ya(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0;return M=De,De=De+16|0,S=M,l=Ft(l,h,d,x,S)|0,l||(jo(S,b),l=0),De=M,l|0}function Qo(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0;return b=De,De=De+16|0,S=b,Ju(d,S),x=nu(l,h,S,x)|0,De=b,x|0}function iu(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0;return M=De,De=De+32|0,b=M+12|0,S=M,!(Ft(l,h,l,h,b)|0)&&!(Ft(l,h,d,x,S)|0)?l=mo(b,S)|0:l=-1,De=M,l|0}function Ut(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0;return M=De,De=De+32|0,b=M+12|0,S=M,!(Ft(l,h,l,h,b)|0)&&!(Ft(l,h,d,x,S)|0)?l=mo(b,S)|0:l=-1,De=M,(l>>>31^1)+l|0}function mA(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0,Ce=0,_e=0,Ge=0,Te=0,Ue=0,xe=0,m=0,g=0;if(m=De,De=De+48|0,S=m+24|0,M=m+12|0,xe=m,!(Ft(l,h,l,h,S)|0)&&!(Ft(l,h,d,x,M)|0)){if(Ue=mo(S,M)|0,(Ue|0)<0)return xe=Ue,De=m,xe|0;for(o[S>>2]=0,o[S+4>>2]=0,o[S+8>>2]=0,o[M>>2]=0,o[M+4>>2]=0,o[M+8>>2]=0,Ft(l,h,l,h,S)|0,Ft(l,h,d,x,M)|0,qA(S),qA(M),Ue?(X=o[S>>2]|0,ue=+(Ue|0),_e=S+4|0,se=o[_e>>2]|0,Ge=S+8|0,ne=o[Ge>>2]|0,Te=S,d=X,x=se,S=ne,be=+((o[M>>2]|0)-X|0)/ue,Ce=+((o[M+4>>2]|0)-se|0)/ue,ue=+((o[M+8>>2]|0)-ne|0)/ue):(x=S+4|0,ne=S+8|0,_e=x,Ge=ne,Te=S,d=o[S>>2]|0,x=o[x>>2]|0,S=o[ne>>2]|0,be=0,Ce=0,ue=0),o[xe>>2]=d,ne=xe+4|0,o[ne>>2]=x,se=xe+8|0,o[se>>2]=S,X=0;;){V=+(X|0),g=be*V+ +(d|0),B=Ce*V+ +(o[_e>>2]|0),V=ue*V+ +(o[Ge>>2]|0),x=~~+Ja(+g),M=~~+Ja(+B),d=~~+Ja(+V),g=+Pe(+(+(x|0)-g)),B=+Pe(+(+(M|0)-B)),V=+Pe(+(+(d|0)-V));do if(g>B&g>V)x=0-(M+d)|0,S=M;else if($=0-x|0,B>V){S=$-d|0;break}else{S=M,d=$-M|0;break}while(0);if(o[xe>>2]=x,o[ne>>2]=S,o[se>>2]=d,bl(xe),nu(l,h,xe,b+(X<<3)|0)|0,(X|0)==(Ue|0))break;X=X+1|0,d=o[Te>>2]|0}return xe=0,De=m,xe|0}return xe=-1,De=m,xe|0}function Ll(l,h){l=l|0,h=h|0;var d=0;if(!h)return d=1,d|0;d=l,l=1;do l=Qt(h&1|0?d:1,l)|0,h=h>>1,d=Qt(d,d)|0;while(h|0);return l|0}function yA(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0;if(!(hA(h,d)|0)||(h=cA(h)|0,ne=+G[d>>3],x=+G[d+8>>3],x=h&x<0?x+6.283185307179586:x,se=o[l>>2]|0,(se|0)<=0))return se=0,se|0;if(X=o[l+4>>2]|0,h){h=0,d=-1,l=0;e:for(;;){for($=l;M=+G[X+($<<4)>>3],V=+G[X+($<<4)+8>>3],l=(d+2|0)%(se|0)|0,S=+G[X+(l<<4)>>3],b=+G[X+(l<<4)+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!(ne<S|ne>B);)if(d=$+1|0,(d|0)<(se|0))l=$,$=d,d=l;else{d=22;break e}if(V=b<0?b+6.283185307179586:b,M=M<0?M+6.283185307179586:M,x=M==x|V==x?x+-2220446049250313e-31:x,V=V+(ne-S)/(B-S)*(M-V),(V<0?V+6.283185307179586:V)>x&&(h=h^1),l=$+1|0,(l|0)>=(se|0)){d=22;break}else d=$}if((d|0)==22)return h|0}else{h=0,d=-1,l=0;e:for(;;){for($=l;M=+G[X+($<<4)>>3],V=+G[X+($<<4)+8>>3],l=(d+2|0)%(se|0)|0,S=+G[X+(l<<4)>>3],b=+G[X+(l<<4)+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!(ne<S|ne>B);)if(d=$+1|0,(d|0)<(se|0))l=$,$=d,d=l;else{d=22;break e}if(x=M==x|b==x?x+-2220446049250313e-31:x,b+(ne-S)/(B-S)*(M-b)>x&&(h=h^1),l=$+1|0,(l|0)>=(se|0)){d=22;break}else d=$}if((d|0)==22)return h|0}return 0}function Xa(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0,Ce=0,_e=0,Ge=0,Te=0;if(be=o[l>>2]|0,!be){o[h>>2]=0,o[h+4>>2]=0,o[h+8>>2]=0,o[h+12>>2]=0,o[h+16>>2]=0,o[h+20>>2]=0,o[h+24>>2]=0,o[h+28>>2]=0;return}if(Ce=h+8|0,G[Ce>>3]=17976931348623157e292,_e=h+24|0,G[_e>>3]=17976931348623157e292,G[h>>3]=-17976931348623157e292,Ge=h+16|0,G[Ge>>3]=-17976931348623157e292,!((be|0)<=0)){for(ne=o[l+4>>2]|0,$=17976931348623157e292,X=-17976931348623157e292,se=0,l=-1,S=17976931348623157e292,M=17976931348623157e292,V=-17976931348623157e292,x=-17976931348623157e292,ue=0;d=+G[ne+(ue<<4)>>3],B=+G[ne+(ue<<4)+8>>3],l=l+2|0,b=+G[ne+(((l|0)==(be|0)?0:l)<<4)+8>>3],d<S&&(G[Ce>>3]=d,S=d),B<M&&(G[_e>>3]=B,M=B),d>V?G[h>>3]=d:d=V,B>x&&(G[Ge>>3]=B,x=B),$=B>0&B<$?B:$,X=B<0&B>X?B:X,se=se|+Pe(+(B-b))>3.141592653589793,l=ue+1|0,(l|0)!=(be|0);)Te=ue,V=d,ue=l,l=Te;se&&(G[Ge>>3]=X,G[_e>>3]=$)}}function Gs(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0,Ce=0,_e=0,Ge=0,Te=0,Ue=0,xe=0,m=0,g=0,v=0;if(be=o[l>>2]|0,be){if(Ce=h+8|0,G[Ce>>3]=17976931348623157e292,_e=h+24|0,G[_e>>3]=17976931348623157e292,G[h>>3]=-17976931348623157e292,Ge=h+16|0,G[Ge>>3]=-17976931348623157e292,(be|0)>0){for(b=o[l+4>>2]|0,ne=17976931348623157e292,ue=-17976931348623157e292,x=0,d=-1,V=17976931348623157e292,$=17976931348623157e292,se=-17976931348623157e292,M=-17976931348623157e292,Te=0;S=+G[b+(Te<<4)>>3],X=+G[b+(Te<<4)+8>>3],g=d+2|0,B=+G[b+(((g|0)==(be|0)?0:g)<<4)+8>>3],S<V&&(G[Ce>>3]=S,V=S),X<$&&(G[_e>>3]=X,$=X),S>se?G[h>>3]=S:S=se,X>M&&(G[Ge>>3]=X,M=X),ne=X>0&X<ne?X:ne,ue=X<0&X>ue?X:ue,x=x|+Pe(+(X-B))>3.141592653589793,d=Te+1|0,(d|0)!=(be|0);)g=Te,se=S,Te=d,d=g;x&&(G[Ge>>3]=ue,G[_e>>3]=ne)}}else o[h>>2]=0,o[h+4>>2]=0,o[h+8>>2]=0,o[h+12>>2]=0,o[h+16>>2]=0,o[h+20>>2]=0,o[h+24>>2]=0,o[h+28>>2]=0;if(g=l+8|0,d=o[g>>2]|0,!((d|0)<=0)){m=l+12|0,xe=0;do if(b=o[m>>2]|0,x=xe,xe=xe+1|0,_e=h+(xe<<5)|0,Ge=o[b+(x<<3)>>2]|0,Ge){if(Te=h+(xe<<5)+8|0,G[Te>>3]=17976931348623157e292,l=h+(xe<<5)+24|0,G[l>>3]=17976931348623157e292,G[_e>>3]=-17976931348623157e292,Ue=h+(xe<<5)+16|0,G[Ue>>3]=-17976931348623157e292,(Ge|0)>0){for(be=o[b+(x<<3)+4>>2]|0,ne=17976931348623157e292,ue=-17976931348623157e292,b=0,x=-1,Ce=0,V=17976931348623157e292,$=17976931348623157e292,X=-17976931348623157e292,M=-17976931348623157e292;S=+G[be+(Ce<<4)>>3],se=+G[be+(Ce<<4)+8>>3],x=x+2|0,B=+G[be+(((x|0)==(Ge|0)?0:x)<<4)+8>>3],S<V&&(G[Te>>3]=S,V=S),se<$&&(G[l>>3]=se,$=se),S>X?G[_e>>3]=S:S=X,se>M&&(G[Ue>>3]=se,M=se),ne=se>0&se<ne?se:ne,ue=se<0&se>ue?se:ue,b=b|+Pe(+(se-B))>3.141592653589793,x=Ce+1|0,(x|0)!=(Ge|0);)v=Ce,Ce=x,X=S,x=v;b&&(G[Ue>>3]=ue,G[l>>3]=ne)}}else o[_e>>2]=0,o[_e+4>>2]=0,o[_e+8>>2]=0,o[_e+12>>2]=0,o[_e+16>>2]=0,o[_e+20>>2]=0,o[_e+24>>2]=0,o[_e+28>>2]=0,d=o[g>>2]|0;while((xe|0)<(d|0))}}function ru(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0;if(!(yA(l,h,d)|0))return b=0,b|0;if(b=l+8|0,(o[b>>2]|0)<=0)return b=1,b|0;for(x=l+12|0,l=0;;){if(S=l,l=l+1|0,yA((o[x>>2]|0)+(S<<3)|0,h+(l<<5)|0,d)|0){l=0,x=6;break}if((l|0)>=(o[b>>2]|0)){l=1,x=6;break}}return(x|0)==6?l|0:0}function oh(){return 8}function oc(){return 16}function su(){return 168}function ou(){return 8}function au(){return 16}function js(){return 12}function Dr(){return 8}function xo(l){l=l|0;var h=0,d=0;return d=+G[l>>3],h=+G[l+8>>3],+ +ke(+(d*d+h*h))}function lu(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0;$=+G[l>>3],V=+G[h>>3]-$,B=+G[l+8>>3],M=+G[h+8>>3]-B,se=+G[d>>3],S=+G[x>>3]-se,ne=+G[d+8>>3],X=+G[x+8>>3]-ne,S=(S*(B-ne)-($-se)*X)/(V*X-M*S),G[b>>3]=$+V*S,G[b+8>>3]=B+M*S}function _a(l,h){return l=l|0,h=h|0,+G[l>>3]!=+G[h>>3]?(h=0,h|0):(h=+G[l+8>>3]==+G[h+8>>3],h|0)}function zi(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;return b=+G[l>>3]-+G[h>>3],x=+G[l+8>>3]-+G[h+8>>3],d=+G[l+16>>3]-+G[h+16>>3],+(b*b+x*x+d*d)}function Dl(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;d=+G[l>>3],x=+at(+d),d=+$e(+d),G[h+16>>3]=d,d=+G[l+8>>3],b=x*+at(+d),G[h>>3]=b,d=x*+$e(+d),G[h+8>>3]=d}function ac(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0;if($=De,De=De+32|0,b=$+16|0,S=$,Qa(l,h,b),M=os(l,h)|0,V=lr(l,h)|0,lA(M,S),h=AA(M,o[b>>2]|0)|0,!(Jt(M)|0))return V=h,De=$,V|0;do switch(M|0){case 4:{l=0,d=14;break}case 14:{l=1,d=14;break}case 24:{l=2,d=14;break}case 38:{l=3,d=14;break}case 49:{l=4,d=14;break}case 58:{l=5,d=14;break}case 63:{l=6,d=14;break}case 72:{l=7,d=14;break}case 83:{l=8,d=14;break}case 97:{l=9,d=14;break}case 107:{l=10,d=14;break}case 117:{l=11,d=14;break}default:B=0,x=0}while(0);return(d|0)==14&&(B=o[22096+(l*24|0)+8>>2]|0,x=o[22096+(l*24|0)+16>>2]|0),l=o[b>>2]|0,(l|0)!=(o[S>>2]|0)&&(M=ki(M)|0,l=o[b>>2]|0,M|(l|0)==(x|0)&&(h=(h+1|0)%6|0)),(V|0)==3&(l|0)==(x|0)?(V=(h+5|0)%6|0,De=$,V|0):(V|0)==5&(l|0)==(B|0)?(V=(h+1|0)%6|0,De=$,V|0):(V=h,De=$,V|0)}function us(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;return x=Li(l,h)|0,(d+-1|0)>>>0>5||(b=(x|0)!=0,(d|0)==1&b)?(d=-1,d|0):(x=ac(l,h)|0,b?(d=(5-x+(o[22384+(d<<2)>>2]|0)|0)%5|0,d|0):(d=(6-x+(o[22416+(d<<2)>>2]|0)|0)%6|0,d|0))}function Ei(l,h,d){l=l|0,h=h|0,d=d|0;var x=0;(h|0)>0?(x=Zr(h,4)|0,o[l>>2]=x,x||Mt(23230,23253,40,23267)):o[l>>2]=0,o[l+4>>2]=h,o[l+8>>2]=0,o[l+12>>2]=d}function Ka(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=l+4|0,S=l+12|0,M=l+8|0;e:for(;;){for(d=o[b>>2]|0,h=0;;){if((h|0)>=(d|0))break e;if(x=o[l>>2]|0,B=o[x+(h<<2)>>2]|0,!B)h=h+1|0;else break}h=x+(~~(+Pe(+(+We(10,+ +(15-(o[S>>2]|0)|0))*(+G[B>>3]+ +G[B+8>>3])))%+(d|0))>>>0<<2)|0,d=o[h>>2]|0;t:do if(d|0){if(x=B+32|0,(d|0)==(B|0))o[h>>2]=o[x>>2];else{if(d=d+32|0,h=o[d>>2]|0,!h)break;for(;(h|0)!=(B|0);)if(d=h+32|0,h=o[d>>2]|0,!h)break t;o[d>>2]=o[x>>2]}cn(B),o[M>>2]=(o[M>>2]|0)+-1}while(0)}cn(o[l>>2]|0)}function Rl(l){l=l|0;var h=0,d=0,x=0;for(x=o[l+4>>2]|0,d=0;;){if((d|0)>=(x|0)){h=0,d=4;break}if(h=o[(o[l>>2]|0)+(d<<2)>>2]|0,!h)d=d+1|0;else{d=4;break}}return(d|0)==4?h|0:0}function Au(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0;if(d=~~(+Pe(+(+We(10,+ +(15-(o[l+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(o[l+4>>2]|0))>>>0,d=(o[l>>2]|0)+(d<<2)|0,x=o[d>>2]|0,!x)return S=1,S|0;S=h+32|0;do if((x|0)!=(h|0)){if(d=o[x+32>>2]|0,!d)return S=1,S|0;for(b=d;;){if((b|0)==(h|0)){b=8;break}if(d=o[b+32>>2]|0,d)x=b,b=d;else{d=1,b=10;break}}if((b|0)==8){o[x+32>>2]=o[S>>2];break}else if((b|0)==10)return d|0}else o[d>>2]=o[S>>2];while(0);return cn(h),S=l+8|0,o[S>>2]=(o[S>>2]|0)+-1,S=0,S|0}function lc(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;S=Yt(40)|0,S||Mt(23283,23253,98,23296),o[S>>2]=o[h>>2],o[S+4>>2]=o[h+4>>2],o[S+8>>2]=o[h+8>>2],o[S+12>>2]=o[h+12>>2],b=S+16|0,o[b>>2]=o[d>>2],o[b+4>>2]=o[d+4>>2],o[b+8>>2]=o[d+8>>2],o[b+12>>2]=o[d+12>>2],o[S+32>>2]=0,b=~~(+Pe(+(+We(10,+ +(15-(o[l+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(o[l+4>>2]|0))>>>0,b=(o[l>>2]|0)+(b<<2)|0,x=o[b>>2]|0;do if(!x)o[b>>2]=S;else{for(;!(Fs(x,h)|0&&Fs(x+16|0,d)|0);)if(b=o[x+32>>2]|0,x=b|0?b:x,!(o[x+32>>2]|0)){M=10;break}if((M|0)==10){o[x+32>>2]=S;break}return cn(S),M=x,M|0}while(0);return M=l+8|0,o[M>>2]=(o[M>>2]|0)+1,M=S,M|0}function uu(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;if(b=~~(+Pe(+(+We(10,+ +(15-(o[l+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(o[l+4>>2]|0))>>>0,b=o[(o[l>>2]|0)+(b<<2)>>2]|0,!b)return d=0,d|0;if(!d){for(l=b;;){if(Fs(l,h)|0){x=10;break}if(l=o[l+32>>2]|0,!l){l=0,x=10;break}}if((x|0)==10)return l|0}for(l=b;;){if(Fs(l,h)|0&&Fs(l+16|0,d)|0){x=10;break}if(l=o[l+32>>2]|0,!l){l=0,x=10;break}}return(x|0)==10?l|0:0}function Ac(l,h){l=l|0,h=h|0;var d=0;if(d=~~(+Pe(+(+We(10,+ +(15-(o[l+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(o[l+4>>2]|0))>>>0,l=o[(o[l>>2]|0)+(d<<2)>>2]|0,!l)return d=0,d|0;for(;;){if(Fs(l,h)|0){h=5;break}if(l=o[l+32>>2]|0,!l){l=0,h=5;break}}return(h|0)==5?l|0:0}function gi(){return 23312}function Bl(l){return l=+l,+ +c(+l)}function Zt(l){return l=+l,~~+Bl(l)|0}function Yt(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0,Ce=0,_e=0,Ge=0,Te=0,Ue=0,xe=0,m=0;m=De,De=De+16|0,ne=m;do if(l>>>0<245){if($=l>>>0<11?16:l+11&-8,l=$>>>3,se=o[5829]|0,d=se>>>l,d&3|0)return h=(d&1^1)+l|0,l=23356+(h<<1<<2)|0,d=l+8|0,x=o[d>>2]|0,b=x+8|0,S=o[b>>2]|0,(S|0)==(l|0)?o[5829]=se&~(1<<h):(o[S+12>>2]=l,o[d>>2]=S),xe=h<<3,o[x+4>>2]=xe|3,xe=x+xe+4|0,o[xe>>2]=o[xe>>2]|1,xe=b,De=m,xe|0;if(X=o[5831]|0,$>>>0>X>>>0){if(d|0)return h=2<<l,h=d<<l&(h|0-h),h=(h&0-h)+-1|0,B=h>>>12&16,h=h>>>B,d=h>>>5&8,h=h>>>d,S=h>>>2&4,h=h>>>S,l=h>>>1&2,h=h>>>l,x=h>>>1&1,x=(d|B|S|l|x)+(h>>>x)|0,h=23356+(x<<1<<2)|0,l=h+8|0,S=o[l>>2]|0,B=S+8|0,d=o[B>>2]|0,(d|0)==(h|0)?(l=se&~(1<<x),o[5829]=l):(o[d+12>>2]=h,o[l>>2]=d,l=se),xe=x<<3,M=xe-$|0,o[S+4>>2]=$|3,b=S+$|0,o[b+4>>2]=M|1,o[S+xe>>2]=M,X|0&&(x=o[5834]|0,h=X>>>3,d=23356+(h<<1<<2)|0,h=1<<h,l&h?(l=d+8|0,h=o[l>>2]|0):(o[5829]=l|h,h=d,l=d+8|0),o[l>>2]=x,o[h+12>>2]=x,o[x+8>>2]=h,o[x+12>>2]=d),o[5831]=M,o[5834]=b,xe=B,De=m,xe|0;if(S=o[5830]|0,S){for(d=(S&0-S)+-1|0,b=d>>>12&16,d=d>>>b,x=d>>>5&8,d=d>>>x,M=d>>>2&4,d=d>>>M,B=d>>>1&2,d=d>>>B,V=d>>>1&1,V=o[23620+((x|b|M|B|V)+(d>>>V)<<2)>>2]|0,d=V,B=V,V=(o[V+4>>2]&-8)-$|0;l=o[d+16>>2]|0,!(!l&&(l=o[d+20>>2]|0,!l));)M=(o[l+4>>2]&-8)-$|0,b=M>>>0<V>>>0,d=l,B=b?l:B,V=b?M:V;if(M=B+$|0,M>>>0>B>>>0){b=o[B+24>>2]|0,h=o[B+12>>2]|0;do if((h|0)==(B|0)){if(l=B+20|0,h=o[l>>2]|0,!h&&(l=B+16|0,h=o[l>>2]|0,!h)){d=0;break}for(;;)if(x=h+20|0,d=o[x>>2]|0,d)h=d,l=x;else if(x=h+16|0,d=o[x>>2]|0,d)h=d,l=x;else break;o[l>>2]=0,d=h}else d=o[B+8>>2]|0,o[d+12>>2]=h,o[h+8>>2]=d,d=h;while(0);do if(b|0){if(h=o[B+28>>2]|0,l=23620+(h<<2)|0,(B|0)==(o[l>>2]|0)){if(o[l>>2]=d,!d){o[5830]=S&~(1<<h);break}}else if(xe=b+16|0,o[((o[xe>>2]|0)==(B|0)?xe:b+20|0)>>2]=d,!d)break;o[d+24>>2]=b,h=o[B+16>>2]|0,h|0&&(o[d+16>>2]=h,o[h+24>>2]=d),h=o[B+20>>2]|0,h|0&&(o[d+20>>2]=h,o[h+24>>2]=d)}while(0);return V>>>0<16?(xe=V+$|0,o[B+4>>2]=xe|3,xe=B+xe+4|0,o[xe>>2]=o[xe>>2]|1):(o[B+4>>2]=$|3,o[M+4>>2]=V|1,o[M+V>>2]=V,X|0&&(x=o[5834]|0,h=X>>>3,d=23356+(h<<1<<2)|0,h=1<<h,h&se?(l=d+8|0,h=o[l>>2]|0):(o[5829]=h|se,h=d,l=d+8|0),o[l>>2]=x,o[h+12>>2]=x,o[x+8>>2]=h,o[x+12>>2]=d),o[5831]=V,o[5834]=M),xe=B+8|0,De=m,xe|0}else se=$}else se=$}else se=$}else if(l>>>0<=4294967231)if(l=l+11|0,$=l&-8,x=o[5830]|0,x){b=0-$|0,l=l>>>8,l?$>>>0>16777215?V=31:(se=(l+1048320|0)>>>16&8,Ce=l<<se,B=(Ce+520192|0)>>>16&4,Ce=Ce<<B,V=(Ce+245760|0)>>>16&2,V=14-(B|se|V)+(Ce<<V>>>15)|0,V=$>>>(V+7|0)&1|V<<1):V=0,d=o[23620+(V<<2)>>2]|0;e:do if(!d)d=0,l=0,Ce=61;else for(l=0,B=$<<((V|0)==31?0:25-(V>>>1)|0),S=0;;){if(M=(o[d+4>>2]&-8)-$|0,M>>>0<b>>>0)if(M)l=d,b=M;else{l=d,b=0,Ce=65;break e}if(Ce=o[d+20>>2]|0,d=o[d+16+(B>>>31<<2)>>2]|0,S=(Ce|0)==0|(Ce|0)==(d|0)?S:Ce,d)B=B<<1;else{d=S,Ce=61;break}}while(0);if((Ce|0)==61){if((d|0)==0&(l|0)==0){if(l=2<<V,l=(l|0-l)&x,!l){se=$;break}se=(l&0-l)+-1|0,M=se>>>12&16,se=se>>>M,S=se>>>5&8,se=se>>>S,B=se>>>2&4,se=se>>>B,V=se>>>1&2,se=se>>>V,d=se>>>1&1,l=0,d=o[23620+((S|M|B|V|d)+(se>>>d)<<2)>>2]|0}d?Ce=65:(B=l,M=b)}if((Ce|0)==65)for(S=d;;)if(se=(o[S+4>>2]&-8)-$|0,d=se>>>0<b>>>0,b=d?se:b,l=d?S:l,d=o[S+16>>2]|0,d||(d=o[S+20>>2]|0),d)S=d;else{B=l,M=b;break}if(B|0&&M>>>0<((o[5831]|0)-$|0)>>>0&&(X=B+$|0,X>>>0>B>>>0)){S=o[B+24>>2]|0,h=o[B+12>>2]|0;do if((h|0)==(B|0)){if(l=B+20|0,h=o[l>>2]|0,!h&&(l=B+16|0,h=o[l>>2]|0,!h)){h=0;break}for(;;)if(b=h+20|0,d=o[b>>2]|0,d)h=d,l=b;else if(b=h+16|0,d=o[b>>2]|0,d)h=d,l=b;else break;o[l>>2]=0}else xe=o[B+8>>2]|0,o[xe+12>>2]=h,o[h+8>>2]=xe;while(0);do if(S){if(l=o[B+28>>2]|0,d=23620+(l<<2)|0,(B|0)==(o[d>>2]|0)){if(o[d>>2]=h,!h){x=x&~(1<<l),o[5830]=x;break}}else if(xe=S+16|0,o[((o[xe>>2]|0)==(B|0)?xe:S+20|0)>>2]=h,!h)break;o[h+24>>2]=S,l=o[B+16>>2]|0,l|0&&(o[h+16>>2]=l,o[l+24>>2]=h),l=o[B+20>>2]|0,l&&(o[h+20>>2]=l,o[l+24>>2]=h)}while(0);e:do if(M>>>0<16)xe=M+$|0,o[B+4>>2]=xe|3,xe=B+xe+4|0,o[xe>>2]=o[xe>>2]|1;else{if(o[B+4>>2]=$|3,o[X+4>>2]=M|1,o[X+M>>2]=M,h=M>>>3,M>>>0<256){d=23356+(h<<1<<2)|0,l=o[5829]|0,h=1<<h,l&h?(l=d+8|0,h=o[l>>2]|0):(o[5829]=l|h,h=d,l=d+8|0),o[l>>2]=X,o[h+12>>2]=X,o[X+8>>2]=h,o[X+12>>2]=d;break}if(h=M>>>8,h?M>>>0>16777215?d=31:(Ue=(h+1048320|0)>>>16&8,xe=h<<Ue,Te=(xe+520192|0)>>>16&4,xe=xe<<Te,d=(xe+245760|0)>>>16&2,d=14-(Te|Ue|d)+(xe<<d>>>15)|0,d=M>>>(d+7|0)&1|d<<1):d=0,h=23620+(d<<2)|0,o[X+28>>2]=d,l=X+16|0,o[l+4>>2]=0,o[l>>2]=0,l=1<<d,!(x&l)){o[5830]=x|l,o[h>>2]=X,o[X+24>>2]=h,o[X+12>>2]=X,o[X+8>>2]=X;break}h=o[h>>2]|0;t:do if((o[h+4>>2]&-8|0)!=(M|0)){for(x=M<<((d|0)==31?0:25-(d>>>1)|0);d=h+16+(x>>>31<<2)|0,l=o[d>>2]|0,!!l;)if((o[l+4>>2]&-8|0)==(M|0)){h=l;break t}else x=x<<1,h=l;o[d>>2]=X,o[X+24>>2]=h,o[X+12>>2]=X,o[X+8>>2]=X;break e}while(0);Ue=h+8|0,xe=o[Ue>>2]|0,o[xe+12>>2]=X,o[Ue>>2]=X,o[X+8>>2]=xe,o[X+12>>2]=h,o[X+24>>2]=0}while(0);return xe=B+8|0,De=m,xe|0}else se=$}else se=$;else se=-1;while(0);if(d=o[5831]|0,d>>>0>=se>>>0)return h=d-se|0,l=o[5834]|0,h>>>0>15?(xe=l+se|0,o[5834]=xe,o[5831]=h,o[xe+4>>2]=h|1,o[l+d>>2]=h,o[l+4>>2]=se|3):(o[5831]=0,o[5834]=0,o[l+4>>2]=d|3,xe=l+d+4|0,o[xe>>2]=o[xe>>2]|1),xe=l+8|0,De=m,xe|0;if(M=o[5832]|0,M>>>0>se>>>0)return Te=M-se|0,o[5832]=Te,xe=o[5835]|0,Ue=xe+se|0,o[5835]=Ue,o[Ue+4>>2]=Te|1,o[xe+4>>2]=se|3,xe=xe+8|0,De=m,xe|0;if(o[5947]|0?l=o[5949]|0:(o[5949]=4096,o[5948]=4096,o[5950]=-1,o[5951]=-1,o[5952]=0,o[5940]=0,o[5947]=ne&-16^1431655768,l=4096),B=se+48|0,V=se+47|0,S=l+V|0,b=0-l|0,$=S&b,$>>>0<=se>>>0||(l=o[5939]|0,l|0&&(X=o[5937]|0,ne=X+$|0,ne>>>0<=X>>>0|ne>>>0>l>>>0)))return xe=0,De=m,xe|0;e:do if(o[5940]&4)h=0,Ce=143;else{d=o[5835]|0;t:do if(d){for(x=23764;ne=o[x>>2]|0,!(ne>>>0<=d>>>0&&(ne+(o[x+4>>2]|0)|0)>>>0>d>>>0);)if(l=o[x+8>>2]|0,l)x=l;else{Ce=128;break t}if(h=S-M&b,h>>>0<2147483647)if(l=_(h|0)|0,(l|0)==((o[x>>2]|0)+(o[x+4>>2]|0)|0)){if((l|0)!=-1){M=h,S=l,Ce=145;break e}}else x=l,Ce=136;else h=0}else Ce=128;while(0);do if((Ce|0)==128)if(d=_(0)|0,(d|0)!=-1&&(h=d,ue=o[5948]|0,be=ue+-1|0,h=(be&h|0?(be+h&0-ue)-h|0:0)+$|0,ue=o[5937]|0,be=h+ue|0,h>>>0>se>>>0&h>>>0<2147483647)){if(ne=o[5939]|0,ne|0&&be>>>0<=ue>>>0|be>>>0>ne>>>0){h=0;break}if(l=_(h|0)|0,(l|0)==(d|0)){M=h,S=d,Ce=145;break e}else x=l,Ce=136}else h=0;while(0);do if((Ce|0)==136){if(d=0-h|0,!(B>>>0>h>>>0&(h>>>0<2147483647&(x|0)!=-1)))if((x|0)==-1){h=0;break}else{M=h,S=x,Ce=145;break e}if(l=o[5949]|0,l=V-h+l&0-l,l>>>0>=2147483647){M=h,S=x,Ce=145;break e}if((_(l|0)|0)==-1){_(d|0)|0,h=0;break}else{M=l+h|0,S=x,Ce=145;break e}}while(0);o[5940]=o[5940]|4,Ce=143}while(0);if((Ce|0)==143&&$>>>0<2147483647&&(Te=_($|0)|0,be=_(0)|0,_e=be-Te|0,Ge=_e>>>0>(se+40|0)>>>0,!((Te|0)==-1|Ge^1|Te>>>0<be>>>0&((Te|0)!=-1&(be|0)!=-1)^1))&&(M=Ge?_e:h,S=Te,Ce=145),(Ce|0)==145){h=(o[5937]|0)+M|0,o[5937]=h,h>>>0>(o[5938]|0)>>>0&&(o[5938]=h),V=o[5835]|0;e:do if(V){for(h=23764;;){if(l=o[h>>2]|0,d=o[h+4>>2]|0,(S|0)==(l+d|0)){Ce=154;break}if(x=o[h+8>>2]|0,x)h=x;else break}if((Ce|0)==154&&(Ue=h+4|0,(o[h+12>>2]&8|0)==0)&&S>>>0>V>>>0&l>>>0<=V>>>0){o[Ue>>2]=d+M,xe=(o[5832]|0)+M|0,Te=V+8|0,Te=Te&7|0?0-Te&7:0,Ue=V+Te|0,Te=xe-Te|0,o[5835]=Ue,o[5832]=Te,o[Ue+4>>2]=Te|1,o[V+xe+4>>2]=40,o[5836]=o[5951];break}for(S>>>0<(o[5833]|0)>>>0&&(o[5833]=S),d=S+M|0,h=23764;;){if((o[h>>2]|0)==(d|0)){Ce=162;break}if(l=o[h+8>>2]|0,l)h=l;else break}if((Ce|0)==162&&!(o[h+12>>2]&8|0)){o[h>>2]=S,X=h+4|0,o[X>>2]=(o[X>>2]|0)+M,X=S+8|0,X=S+(X&7|0?0-X&7:0)|0,h=d+8|0,h=d+(h&7|0?0-h&7:0)|0,$=X+se|0,B=h-X-se|0,o[X+4>>2]=se|3;t:do if((V|0)==(h|0))xe=(o[5832]|0)+B|0,o[5832]=xe,o[5835]=$,o[$+4>>2]=xe|1;else{if((o[5834]|0)==(h|0)){xe=(o[5831]|0)+B|0,o[5831]=xe,o[5834]=$,o[$+4>>2]=xe|1,o[$+xe>>2]=xe;break}if(l=o[h+4>>2]|0,(l&3|0)==1){M=l&-8,x=l>>>3;n:do if(l>>>0<256)if(l=o[h+8>>2]|0,d=o[h+12>>2]|0,(d|0)==(l|0)){o[5829]=o[5829]&~(1<<x);break}else{o[l+12>>2]=d,o[d+8>>2]=l;break}else{S=o[h+24>>2]|0,l=o[h+12>>2]|0;do if((l|0)==(h|0)){if(d=h+16|0,x=d+4|0,l=o[x>>2]|0,l)d=x;else if(l=o[d>>2]|0,!l){l=0;break}for(;;)if(b=l+20|0,x=o[b>>2]|0,x)l=x,d=b;else if(b=l+16|0,x=o[b>>2]|0,x)l=x,d=b;else break;o[d>>2]=0}else xe=o[h+8>>2]|0,o[xe+12>>2]=l,o[l+8>>2]=xe;while(0);if(!S)break;d=o[h+28>>2]|0,x=23620+(d<<2)|0;do if((o[x>>2]|0)!=(h|0)){if(xe=S+16|0,o[((o[xe>>2]|0)==(h|0)?xe:S+20|0)>>2]=l,!l)break n}else{if(o[x>>2]=l,l|0)break;o[5830]=o[5830]&~(1<<d);break n}while(0);if(o[l+24>>2]=S,d=h+16|0,x=o[d>>2]|0,x|0&&(o[l+16>>2]=x,o[x+24>>2]=l),d=o[d+4>>2]|0,!d)break;o[l+20>>2]=d,o[d+24>>2]=l}while(0);h=h+M|0,b=M+B|0}else b=B;if(h=h+4|0,o[h>>2]=o[h>>2]&-2,o[$+4>>2]=b|1,o[$+b>>2]=b,h=b>>>3,b>>>0<256){d=23356+(h<<1<<2)|0,l=o[5829]|0,h=1<<h,l&h?(l=d+8|0,h=o[l>>2]|0):(o[5829]=l|h,h=d,l=d+8|0),o[l>>2]=$,o[h+12>>2]=$,o[$+8>>2]=h,o[$+12>>2]=d;break}h=b>>>8;do if(!h)x=0;else{if(b>>>0>16777215){x=31;break}Ue=(h+1048320|0)>>>16&8,xe=h<<Ue,Te=(xe+520192|0)>>>16&4,xe=xe<<Te,x=(xe+245760|0)>>>16&2,x=14-(Te|Ue|x)+(xe<<x>>>15)|0,x=b>>>(x+7|0)&1|x<<1}while(0);if(h=23620+(x<<2)|0,o[$+28>>2]=x,l=$+16|0,o[l+4>>2]=0,o[l>>2]=0,l=o[5830]|0,d=1<<x,!(l&d)){o[5830]=l|d,o[h>>2]=$,o[$+24>>2]=h,o[$+12>>2]=$,o[$+8>>2]=$;break}h=o[h>>2]|0;n:do if((o[h+4>>2]&-8|0)!=(b|0)){for(x=b<<((x|0)==31?0:25-(x>>>1)|0);d=h+16+(x>>>31<<2)|0,l=o[d>>2]|0,!!l;)if((o[l+4>>2]&-8|0)==(b|0)){h=l;break n}else x=x<<1,h=l;o[d>>2]=$,o[$+24>>2]=h,o[$+12>>2]=$,o[$+8>>2]=$;break t}while(0);Ue=h+8|0,xe=o[Ue>>2]|0,o[xe+12>>2]=$,o[Ue>>2]=$,o[$+8>>2]=xe,o[$+12>>2]=h,o[$+24>>2]=0}while(0);return xe=X+8|0,De=m,xe|0}for(h=23764;l=o[h>>2]|0,!(l>>>0<=V>>>0&&(xe=l+(o[h+4>>2]|0)|0,xe>>>0>V>>>0));)h=o[h+8>>2]|0;b=xe+-47|0,l=b+8|0,l=b+(l&7|0?0-l&7:0)|0,b=V+16|0,l=l>>>0<b>>>0?V:l,h=l+8|0,d=M+-40|0,Te=S+8|0,Te=Te&7|0?0-Te&7:0,Ue=S+Te|0,Te=d-Te|0,o[5835]=Ue,o[5832]=Te,o[Ue+4>>2]=Te|1,o[S+d+4>>2]=40,o[5836]=o[5951],d=l+4|0,o[d>>2]=27,o[h>>2]=o[5941],o[h+4>>2]=o[5942],o[h+8>>2]=o[5943],o[h+12>>2]=o[5944],o[5941]=S,o[5942]=M,o[5944]=0,o[5943]=h,h=l+24|0;do Ue=h,h=h+4|0,o[h>>2]=7;while((Ue+8|0)>>>0<xe>>>0);if((l|0)!=(V|0)){if(S=l-V|0,o[d>>2]=o[d>>2]&-2,o[V+4>>2]=S|1,o[l>>2]=S,h=S>>>3,S>>>0<256){d=23356+(h<<1<<2)|0,l=o[5829]|0,h=1<<h,l&h?(l=d+8|0,h=o[l>>2]|0):(o[5829]=l|h,h=d,l=d+8|0),o[l>>2]=V,o[h+12>>2]=V,o[V+8>>2]=h,o[V+12>>2]=d;break}if(h=S>>>8,h?S>>>0>16777215?x=31:(Ue=(h+1048320|0)>>>16&8,xe=h<<Ue,Te=(xe+520192|0)>>>16&4,xe=xe<<Te,x=(xe+245760|0)>>>16&2,x=14-(Te|Ue|x)+(xe<<x>>>15)|0,x=S>>>(x+7|0)&1|x<<1):x=0,d=23620+(x<<2)|0,o[V+28>>2]=x,o[V+20>>2]=0,o[b>>2]=0,h=o[5830]|0,l=1<<x,!(h&l)){o[5830]=h|l,o[d>>2]=V,o[V+24>>2]=d,o[V+12>>2]=V,o[V+8>>2]=V;break}h=o[d>>2]|0;t:do if((o[h+4>>2]&-8|0)!=(S|0)){for(x=S<<((x|0)==31?0:25-(x>>>1)|0);d=h+16+(x>>>31<<2)|0,l=o[d>>2]|0,!!l;)if((o[l+4>>2]&-8|0)==(S|0)){h=l;break t}else x=x<<1,h=l;o[d>>2]=V,o[V+24>>2]=h,o[V+12>>2]=V,o[V+8>>2]=V;break e}while(0);Ue=h+8|0,xe=o[Ue>>2]|0,o[xe+12>>2]=V,o[Ue>>2]=V,o[V+8>>2]=xe,o[V+12>>2]=h,o[V+24>>2]=0}}else xe=o[5833]|0,(xe|0)==0|S>>>0<xe>>>0&&(o[5833]=S),o[5941]=S,o[5942]=M,o[5944]=0,o[5838]=o[5947],o[5837]=-1,o[5842]=23356,o[5841]=23356,o[5844]=23364,o[5843]=23364,o[5846]=23372,o[5845]=23372,o[5848]=23380,o[5847]=23380,o[5850]=23388,o[5849]=23388,o[5852]=23396,o[5851]=23396,o[5854]=23404,o[5853]=23404,o[5856]=23412,o[5855]=23412,o[5858]=23420,o[5857]=23420,o[5860]=23428,o[5859]=23428,o[5862]=23436,o[5861]=23436,o[5864]=23444,o[5863]=23444,o[5866]=23452,o[5865]=23452,o[5868]=23460,o[5867]=23460,o[5870]=23468,o[5869]=23468,o[5872]=23476,o[5871]=23476,o[5874]=23484,o[5873]=23484,o[5876]=23492,o[5875]=23492,o[5878]=23500,o[5877]=23500,o[5880]=23508,o[5879]=23508,o[5882]=23516,o[5881]=23516,o[5884]=23524,o[5883]=23524,o[5886]=23532,o[5885]=23532,o[5888]=23540,o[5887]=23540,o[5890]=23548,o[5889]=23548,o[5892]=23556,o[5891]=23556,o[5894]=23564,o[5893]=23564,o[5896]=23572,o[5895]=23572,o[5898]=23580,o[5897]=23580,o[5900]=23588,o[5899]=23588,o[5902]=23596,o[5901]=23596,o[5904]=23604,o[5903]=23604,xe=M+-40|0,Te=S+8|0,Te=Te&7|0?0-Te&7:0,Ue=S+Te|0,Te=xe-Te|0,o[5835]=Ue,o[5832]=Te,o[Ue+4>>2]=Te|1,o[S+xe+4>>2]=40,o[5836]=o[5951];while(0);if(h=o[5832]|0,h>>>0>se>>>0)return Te=h-se|0,o[5832]=Te,xe=o[5835]|0,Ue=xe+se|0,o[5835]=Ue,o[Ue+4>>2]=Te|1,o[xe+4>>2]=se|3,xe=xe+8|0,De=m,xe|0}return xe=gi()|0,o[xe>>2]=12,xe=0,De=m,xe|0}function cn(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(l){d=l+-8|0,b=o[5833]|0,l=o[l+-4>>2]|0,h=l&-8,V=d+h|0;do if(l&1)B=d,M=d;else{if(x=o[d>>2]|0,!(l&3)||(M=d+(0-x)|0,S=x+h|0,M>>>0<b>>>0))return;if((o[5834]|0)==(M|0)){if(l=V+4|0,h=o[l>>2]|0,(h&3|0)!=3){B=M,h=S;break}o[5831]=S,o[l>>2]=h&-2,o[M+4>>2]=S|1,o[M+S>>2]=S;return}if(d=x>>>3,x>>>0<256)if(l=o[M+8>>2]|0,h=o[M+12>>2]|0,(h|0)==(l|0)){o[5829]=o[5829]&~(1<<d),B=M,h=S;break}else{o[l+12>>2]=h,o[h+8>>2]=l,B=M,h=S;break}b=o[M+24>>2]|0,l=o[M+12>>2]|0;do if((l|0)==(M|0)){if(h=M+16|0,d=h+4|0,l=o[d>>2]|0,l)h=d;else if(l=o[h>>2]|0,!l){l=0;break}for(;;)if(x=l+20|0,d=o[x>>2]|0,d)l=d,h=x;else if(x=l+16|0,d=o[x>>2]|0,d)l=d,h=x;else break;o[h>>2]=0}else B=o[M+8>>2]|0,o[B+12>>2]=l,o[l+8>>2]=B;while(0);if(b){if(h=o[M+28>>2]|0,d=23620+(h<<2)|0,(o[d>>2]|0)==(M|0)){if(o[d>>2]=l,!l){o[5830]=o[5830]&~(1<<h),B=M,h=S;break}}else if(B=b+16|0,o[((o[B>>2]|0)==(M|0)?B:b+20|0)>>2]=l,!l){B=M,h=S;break}o[l+24>>2]=b,h=M+16|0,d=o[h>>2]|0,d|0&&(o[l+16>>2]=d,o[d+24>>2]=l),h=o[h+4>>2]|0,h?(o[l+20>>2]=h,o[h+24>>2]=l,B=M,h=S):(B=M,h=S)}else B=M,h=S}while(0);if(!(M>>>0>=V>>>0)&&(l=V+4|0,x=o[l>>2]|0,!!(x&1))){if(x&2)o[l>>2]=x&-2,o[B+4>>2]=h|1,o[M+h>>2]=h,b=h;else{if((o[5835]|0)==(V|0)){if(V=(o[5832]|0)+h|0,o[5832]=V,o[5835]=B,o[B+4>>2]=V|1,(B|0)!=(o[5834]|0))return;o[5834]=0,o[5831]=0;return}if((o[5834]|0)==(V|0)){V=(o[5831]|0)+h|0,o[5831]=V,o[5834]=M,o[B+4>>2]=V|1,o[M+V>>2]=V;return}b=(x&-8)+h|0,d=x>>>3;do if(x>>>0<256)if(h=o[V+8>>2]|0,l=o[V+12>>2]|0,(l|0)==(h|0)){o[5829]=o[5829]&~(1<<d);break}else{o[h+12>>2]=l,o[l+8>>2]=h;break}else{S=o[V+24>>2]|0,l=o[V+12>>2]|0;do if((l|0)==(V|0)){if(h=V+16|0,d=h+4|0,l=o[d>>2]|0,l)h=d;else if(l=o[h>>2]|0,!l){d=0;break}for(;;)if(x=l+20|0,d=o[x>>2]|0,d)l=d,h=x;else if(x=l+16|0,d=o[x>>2]|0,d)l=d,h=x;else break;o[h>>2]=0,d=l}else d=o[V+8>>2]|0,o[d+12>>2]=l,o[l+8>>2]=d,d=l;while(0);if(S|0){if(l=o[V+28>>2]|0,h=23620+(l<<2)|0,(o[h>>2]|0)==(V|0)){if(o[h>>2]=d,!d){o[5830]=o[5830]&~(1<<l);break}}else if(x=S+16|0,o[((o[x>>2]|0)==(V|0)?x:S+20|0)>>2]=d,!d)break;o[d+24>>2]=S,l=V+16|0,h=o[l>>2]|0,h|0&&(o[d+16>>2]=h,o[h+24>>2]=d),l=o[l+4>>2]|0,l|0&&(o[d+20>>2]=l,o[l+24>>2]=d)}}while(0);if(o[B+4>>2]=b|1,o[M+b>>2]=b,(B|0)==(o[5834]|0)){o[5831]=b;return}}if(l=b>>>3,b>>>0<256){d=23356+(l<<1<<2)|0,h=o[5829]|0,l=1<<l,h&l?(h=d+8|0,l=o[h>>2]|0):(o[5829]=h|l,l=d,h=d+8|0),o[h>>2]=B,o[l+12>>2]=B,o[B+8>>2]=l,o[B+12>>2]=d;return}l=b>>>8,l?b>>>0>16777215?x=31:(M=(l+1048320|0)>>>16&8,V=l<<M,S=(V+520192|0)>>>16&4,V=V<<S,x=(V+245760|0)>>>16&2,x=14-(S|M|x)+(V<<x>>>15)|0,x=b>>>(x+7|0)&1|x<<1):x=0,l=23620+(x<<2)|0,o[B+28>>2]=x,o[B+20>>2]=0,o[B+16>>2]=0,h=o[5830]|0,d=1<<x;e:do if(!(h&d))o[5830]=h|d,o[l>>2]=B,o[B+24>>2]=l,o[B+12>>2]=B,o[B+8>>2]=B;else{l=o[l>>2]|0;t:do if((o[l+4>>2]&-8|0)!=(b|0)){for(x=b<<((x|0)==31?0:25-(x>>>1)|0);d=l+16+(x>>>31<<2)|0,h=o[d>>2]|0,!!h;)if((o[h+4>>2]&-8|0)==(b|0)){l=h;break t}else x=x<<1,l=h;o[d>>2]=B,o[B+24>>2]=l,o[B+12>>2]=B,o[B+8>>2]=B;break e}while(0);M=l+8|0,V=o[M>>2]|0,o[V+12>>2]=B,o[M>>2]=B,o[B+8>>2]=V,o[B+12>>2]=l,o[B+24>>2]=0}while(0);if(V=(o[5837]|0)+-1|0,o[5837]=V,!(V|0)){for(l=23772;l=o[l>>2]|0,l;)l=l+8|0;o[5837]=-1}}}}function Zr(l,h){l=l|0,h=h|0;var d=0;return l?(d=Qt(h,l)|0,(h|l)>>>0>65535&&(d=((d>>>0)/(l>>>0)|0|0)==(h|0)?d:-1)):d=0,l=Yt(d)|0,!l||!(o[l+-4>>2]&3)||k(l|0,0,d|0)|0,l|0}function qo(l,h,d,x){return l=l|0,h=h|0,d=d|0,x=x|0,d=l+d>>>0,Ot(h+x+(d>>>0<l>>>0|0)>>>0|0),d|0|0}function Ui(l,h,d,x){return l=l|0,h=h|0,d=d|0,x=x|0,x=h-x-(d>>>0>l>>>0|0)>>>0,Ot(x|0),l-d>>>0|0|0}function $s(l){return l=l|0,(l?31-(vn(l^l-1)|0)|0:32)|0}function Es(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,$=0,X=0,se=0,ne=0,ue=0,be=0;if(X=l,V=h,$=V,M=d,ne=x,B=ne,!$)return S=(b|0)!=0,B?S?(o[b>>2]=l|0,o[b+4>>2]=h&0,ne=0,b=0,Ot(ne|0),b|0):(ne=0,b=0,Ot(ne|0),b|0):(S&&(o[b>>2]=(X>>>0)%(M>>>0),o[b+4>>2]=0),ne=0,b=(X>>>0)/(M>>>0)>>>0,Ot(ne|0),b|0);S=(B|0)==0;do if(M){if(!S){if(S=(vn(B|0)|0)-(vn($|0)|0)|0,S>>>0<=31){se=S+1|0,B=31-S|0,h=S-31>>31,M=se,l=X>>>(se>>>0)&h|$<<B,h=$>>>(se>>>0)&h,S=0,B=X<<B;break}return b?(o[b>>2]=l|0,o[b+4>>2]=V|h&0,ne=0,b=0,Ot(ne|0),b|0):(ne=0,b=0,Ot(ne|0),b|0)}if(S=M-1|0,S&M|0){B=(vn(M|0)|0)+33-(vn($|0)|0)|0,be=64-B|0,se=32-B|0,V=se>>31,ue=B-32|0,h=ue>>31,M=B,l=se-1>>31&$>>>(ue>>>0)|($<<se|X>>>(B>>>0))&h,h=h&$>>>(B>>>0),S=X<<be&V,B=($<<be|X>>>(ue>>>0))&V|X<<se&B-33>>31;break}return b|0&&(o[b>>2]=S&X,o[b+4>>2]=0),(M|0)==1?(ue=V|h&0,be=l|0|0,Ot(ue|0),be|0):(be=$s(M|0)|0,ue=$>>>(be>>>0)|0,be=$<<32-be|X>>>(be>>>0)|0,Ot(ue|0),be|0)}else{if(S)return b|0&&(o[b>>2]=($>>>0)%(M>>>0),o[b+4>>2]=0),ue=0,be=($>>>0)/(M>>>0)>>>0,Ot(ue|0),be|0;if(!X)return b|0&&(o[b>>2]=0,o[b+4>>2]=($>>>0)%(B>>>0)),ue=0,be=($>>>0)/(B>>>0)>>>0,Ot(ue|0),be|0;if(S=B-1|0,!(S&B))return b|0&&(o[b>>2]=l|0,o[b+4>>2]=S&$|h&0),ue=0,be=$>>>(($s(B|0)|0)>>>0),Ot(ue|0),be|0;if(S=(vn(B|0)|0)-(vn($|0)|0)|0,S>>>0<=30){h=S+1|0,B=31-S|0,M=h,l=$<<B|X>>>(h>>>0),h=$>>>(h>>>0),S=0,B=X<<B;break}return b?(o[b>>2]=l|0,o[b+4>>2]=V|h&0,ue=0,be=0,Ot(ue|0),be|0):(ue=0,be=0,Ot(ue|0),be|0)}while(0);if(!M)$=B,V=0,B=0;else{se=d|0|0,X=ne|x&0,$=qo(se|0,X|0,-1,-1)|0,d=Oe()|0,V=B,B=0;do x=V,V=S>>>31|V<<1,S=B|S<<1,x=l<<1|x>>>31|0,ne=l>>>31|h<<1|0,Ui($|0,d|0,x|0,ne|0)|0,be=Oe()|0,ue=be>>31|((be|0)<0?-1:0)<<1,B=ue&1,l=Ui(x|0,ne|0,ue&se|0,(((be|0)<0?-1:0)>>31|((be|0)<0?-1:0)<<1)&X|0)|0,h=Oe()|0,M=M-1|0;while(M|0);$=V,V=0}return M=0,b|0&&(o[b>>2]=l,o[b+4>>2]=h),ue=(S|0)>>>31|($|M)<<1|(M<<1|S>>>31)&0|V,be=(S<<1|0)&-2|B,Ot(ue|0),be|0}function Hs(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0;return S=De,De=De+16|0,b=S|0,Es(l,h,d,x,b)|0,De=S,Ot(o[b+4>>2]|0),o[b>>2]|0|0}function St(l,h,d){return l=l|0,h=h|0,d=d|0,(d|0)<32?(Ot(h>>>d|0),l>>>d|(h&(1<<d)-1)<<32-d):(Ot(0),h>>>d-32|0)}function Ct(l,h,d){return l=l|0,h=h|0,d=d|0,(d|0)<32?(Ot(h<<d|(l&(1<<d)-1<<32-d)>>>32-d|0),l<<d):(Ot(l<<d-32|0),0)}function Vi(l,h){return l=+l,h=+h,l!=l?+h:h!=h?+l:+on(+l,+h)}function Ja(l){return l=+l,l>=0?+Ie(l+.5):+dn(l-.5)}function Ws(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0;if((d|0)>=8192)return ar(l|0,h|0,d|0)|0,l|0;if(S=l|0,b=l+d|0,(l&3)==(h&3)){for(;l&3;){if(!d)return S|0;he[l>>0]=he[h>>0]|0,l=l+1|0,h=h+1|0,d=d-1|0}for(d=b&-4|0,x=d-64|0;(l|0)<=(x|0);)o[l>>2]=o[h>>2],o[l+4>>2]=o[h+4>>2],o[l+8>>2]=o[h+8>>2],o[l+12>>2]=o[h+12>>2],o[l+16>>2]=o[h+16>>2],o[l+20>>2]=o[h+20>>2],o[l+24>>2]=o[h+24>>2],o[l+28>>2]=o[h+28>>2],o[l+32>>2]=o[h+32>>2],o[l+36>>2]=o[h+36>>2],o[l+40>>2]=o[h+40>>2],o[l+44>>2]=o[h+44>>2],o[l+48>>2]=o[h+48>>2],o[l+52>>2]=o[h+52>>2],o[l+56>>2]=o[h+56>>2],o[l+60>>2]=o[h+60>>2],l=l+64|0,h=h+64|0;for(;(l|0)<(d|0);)o[l>>2]=o[h>>2],l=l+4|0,h=h+4|0}else for(d=b-4|0;(l|0)<(d|0);)he[l>>0]=he[h>>0]|0,he[l+1>>0]=he[h+1>>0]|0,he[l+2>>0]=he[h+2>>0]|0,he[l+3>>0]=he[h+3>>0]|0,l=l+4|0,h=h+4|0;for(;(l|0)<(b|0);)he[l>>0]=he[h>>0]|0,l=l+1|0,h=h+1|0;return S|0}function k(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if(S=l+d|0,h=h&255,(d|0)>=67){for(;l&3;)he[l>>0]=h,l=l+1|0;for(x=S&-4|0,M=h|h<<8|h<<16|h<<24,b=x-64|0;(l|0)<=(b|0);)o[l>>2]=M,o[l+4>>2]=M,o[l+8>>2]=M,o[l+12>>2]=M,o[l+16>>2]=M,o[l+20>>2]=M,o[l+24>>2]=M,o[l+28>>2]=M,o[l+32>>2]=M,o[l+36>>2]=M,o[l+40>>2]=M,o[l+44>>2]=M,o[l+48>>2]=M,o[l+52>>2]=M,o[l+56>>2]=M,o[l+60>>2]=M,l=l+64|0;for(;(l|0)<(x|0);)o[l>>2]=M,l=l+4|0}for(;(l|0)<(S|0);)he[l>>0]=h,l=l+1|0;return S-d|0}function c(l){return l=+l,l>=0?+Ie(l+.5):+dn(l-.5)}function _(l){l=l|0;var h=0,d=0,x=0;return x=An()|0,d=o[Le>>2]|0,h=d+l|0,(l|0)>0&(h|0)<(d|0)|(h|0)<0?(la(h|0)|0,Se(12),-1):(h|0)>(x|0)&&!(ni(h|0)|0)?(Se(12),-1):(o[Le>>2]=h,d|0)}return{___uremdi3:Hs,_bitshift64Lshr:St,_bitshift64Shl:Ct,_calloc:Zr,_cellAreaKm2:Ha,_cellAreaM2:da,_cellAreaRads2:Tl,_compact:tu,_destroyLinkedPolygon:Ya,_edgeLengthKm:$a,_edgeLengthM:tc,_emscripten_replace_memory:Na,_exactEdgeLengthKm:Ml,_exactEdgeLengthM:pi,_exactEdgeLengthRads:Sl,_experimentalH3ToLocalIj:ya,_experimentalLocalIjToH3:Qo,_free:cn,_geoToH3:Wa,_getDestinationH3IndexFromUnidirectionalEdge:Wo,_getH3IndexesFromUnidirectionalEdge:vo,_getH3UnidirectionalEdge:qr,_getH3UnidirectionalEdgeBoundary:Za,_getH3UnidirectionalEdgesFromHexagon:kl,_getOriginH3IndexFromUnidirectionalEdge:Il,_getPentagonIndexes:nr,_getRes0Indexes:_l,_h3Distance:iu,_h3GetBaseCell:os,_h3GetFaces:ga,_h3GetResolution:pA,_h3IndexesAreNeighbors:bs,_h3IsPentagon:Li,_h3IsResClassIII:gA,_h3IsValid:eu,_h3Line:mA,_h3LineSize:Ut,_h3SetToLinkedGeo:Pi,_h3ToCenterChild:tr,_h3ToChildren:Wi,_h3ToGeo:Vs,_h3ToGeoBoundary:ls,_h3ToParent:Cl,_h3UnidirectionalEdgeIsValid:sc,_hexAreaKm2:Ho,_hexAreaM2:ec,_hexRing:Ee,_i64Subtract:Ui,_kRing:Aa,_kRingDistances:ml,_llvm_minnum_f64:Vi,_llvm_round_f64:Ja,_malloc:Yt,_maxFaceCount:rc,_maxH3ToChildrenSize:nc,_maxKringSize:Va,_maxPolyfillSize:Fe,_maxUncompactSize:ic,_memcpy:Ws,_memset:k,_numHexagons:JA,_pentagonIndexCount:qa,_pointDistKm:Wn,_pointDistM:vi,_pointDistRads:Gn,_polyfill:ot,_res0IndexCount:yl,_round:c,_sbrk:_,_sizeOfCoordIJ:Dr,_sizeOfGeoBoundary:su,_sizeOfGeoCoord:oc,_sizeOfGeoPolygon:au,_sizeOfGeofence:ou,_sizeOfH3Index:oh,_sizeOfLinkedGeoPolygon:js,_uncompact:Us,establishStackSpace:Ua,stackAlloc:we,stackRestore:xs,stackSave:No}}(vs,mn,Ve);e.___uremdi3=qe.___uremdi3,e._bitshift64Lshr=qe._bitshift64Lshr,e._bitshift64Shl=qe._bitshift64Shl,e._calloc=qe._calloc,e._cellAreaKm2=qe._cellAreaKm2,e._cellAreaM2=qe._cellAreaM2,e._cellAreaRads2=qe._cellAreaRads2,e._compact=qe._compact,e._destroyLinkedPolygon=qe._destroyLinkedPolygon,e._edgeLengthKm=qe._edgeLengthKm,e._edgeLengthM=qe._edgeLengthM;var $i=e._emscripten_replace_memory=qe._emscripten_replace_memory;e._exactEdgeLengthKm=qe._exactEdgeLengthKm,e._exactEdgeLengthM=qe._exactEdgeLengthM,e._exactEdgeLengthRads=qe._exactEdgeLengthRads,e._experimentalH3ToLocalIj=qe._experimentalH3ToLocalIj,e._experimentalLocalIjToH3=qe._experimentalLocalIjToH3,e._free=qe._free,e._geoToH3=qe._geoToH3,e._getDestinationH3IndexFromUnidirectionalEdge=qe._getDestinationH3IndexFromUnidirectionalEdge,e._getH3IndexesFromUnidirectionalEdge=qe._getH3IndexesFromUnidirectionalEdge,e._getH3UnidirectionalEdge=qe._getH3UnidirectionalEdge,e._getH3UnidirectionalEdgeBoundary=qe._getH3UnidirectionalEdgeBoundary,e._getH3UnidirectionalEdgesFromHexagon=qe._getH3UnidirectionalEdgesFromHexagon,e._getOriginH3IndexFromUnidirectionalEdge=qe._getOriginH3IndexFromUnidirectionalEdge,e._getPentagonIndexes=qe._getPentagonIndexes,e._getRes0Indexes=qe._getRes0Indexes,e._h3Distance=qe._h3Distance,e._h3GetBaseCell=qe._h3GetBaseCell,e._h3GetFaces=qe._h3GetFaces,e._h3GetResolution=qe._h3GetResolution,e._h3IndexesAreNeighbors=qe._h3IndexesAreNeighbors,e._h3IsPentagon=qe._h3IsPentagon,e._h3IsResClassIII=qe._h3IsResClassIII,e._h3IsValid=qe._h3IsValid,e._h3Line=qe._h3Line,e._h3LineSize=qe._h3LineSize,e._h3SetToLinkedGeo=qe._h3SetToLinkedGeo,e._h3ToCenterChild=qe._h3ToCenterChild,e._h3ToChildren=qe._h3ToChildren,e._h3ToGeo=qe._h3ToGeo,e._h3ToGeoBoundary=qe._h3ToGeoBoundary,e._h3ToParent=qe._h3ToParent,e._h3UnidirectionalEdgeIsValid=qe._h3UnidirectionalEdgeIsValid,e._hexAreaKm2=qe._hexAreaKm2,e._hexAreaM2=qe._hexAreaM2,e._hexRing=qe._hexRing,e._i64Subtract=qe._i64Subtract,e._kRing=qe._kRing,e._kRingDistances=qe._kRingDistances,e._llvm_minnum_f64=qe._llvm_minnum_f64,e._llvm_round_f64=qe._llvm_round_f64,e._malloc=qe._malloc,e._maxFaceCount=qe._maxFaceCount,e._maxH3ToChildrenSize=qe._maxH3ToChildrenSize,e._maxKringSize=qe._maxKringSize,e._maxPolyfillSize=qe._maxPolyfillSize,e._maxUncompactSize=qe._maxUncompactSize,e._memcpy=qe._memcpy,e._memset=qe._memset,e._numHexagons=qe._numHexagons,e._pentagonIndexCount=qe._pentagonIndexCount,e._pointDistKm=qe._pointDistKm,e._pointDistM=qe._pointDistM,e._pointDistRads=qe._pointDistRads,e._polyfill=qe._polyfill,e._res0IndexCount=qe._res0IndexCount,e._round=qe._round,e._sbrk=qe._sbrk,e._sizeOfCoordIJ=qe._sizeOfCoordIJ,e._sizeOfGeoBoundary=qe._sizeOfGeoBoundary,e._sizeOfGeoCoord=qe._sizeOfGeoCoord,e._sizeOfGeoPolygon=qe._sizeOfGeoPolygon,e._sizeOfGeofence=qe._sizeOfGeofence,e._sizeOfH3Index=qe._sizeOfH3Index,e._sizeOfLinkedGeoPolygon=qe._sizeOfLinkedGeoPolygon,e._uncompact=qe._uncompact,e.establishStackSpace=qe.establishStackSpace;var zs=e.stackAlloc=qe.stackAlloc,Ri=e.stackRestore=qe.stackRestore,or=e.stackSave=qe.stackSave;if(e.asm=qe,e.cwrap=re,e.setValue=U,e.getValue=Q,e.getTempRet0=P,Hn){fo(Hn)||(Hn=s(Hn));{Un();var qn=function(K){K.byteLength&&(K=new Uint8Array(K)),Ye.set(K,L),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Cr()},Os=function(){u(Hn,qn,function(){throw"could not load memory initializer "+Hn})},Ur=Ii(Hn);if(Ur)qn(Ur.buffer);else if(e.memoryInitializerRequest){var Vr=function(){var K=e.memoryInitializerRequest,H=K.response;if(K.status!==200&&K.status!==0){var ee=Ii(e.memoryInitializerRequestURL);if(ee)H=ee.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+K.status+", retrying "+Hn),Os();return}}qn(H)};e.memoryInitializerRequest.response?setTimeout(Vr,0):e.memoryInitializerRequest.addEventListener("load",Vr)}else Os()}}var Lr;Ki=function K(){Lr||ss(),Lr||(Ki=K)};function ss(K){if(ti>0||(Nn(),ti>0))return;function H(){Lr||(Lr=!0,!Z&&(bi(),xt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),nn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),H()},1)):H()}e.run=ss;function Bi(K){throw e.onAbort&&e.onAbort(K),K+="",a(K),y(K),Z=!0,"abort("+K+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Bi,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return ss(),t}(typeof Pt=="object"?Pt:{}),Sn="number",hp=Sn,Fn=Sn,Xn=Sn,Yo=Sn,_i=Sn,Ope=[["sizeOfH3Index",Sn],["sizeOfGeoCoord",Sn],["sizeOfGeoBoundary",Sn],["sizeOfGeoPolygon",Sn],["sizeOfGeofence",Sn],["sizeOfLinkedGeoPolygon",Sn],["sizeOfCoordIJ",Sn],["h3IsValid",hp,[Fn,Xn]],["geoToH3",Fn,[Sn,Sn,Yo]],["h3ToGeo",null,[Fn,Xn,_i]],["h3ToGeoBoundary",null,[Fn,Xn,_i]],["maxKringSize",Sn,[Sn]],["kRing",null,[Fn,Xn,Sn,_i]],["kRingDistances",null,[Fn,Xn,Sn,_i,_i]],["hexRing",null,[Fn,Xn,Sn,_i]],["maxPolyfillSize",Sn,[_i,Yo]],["polyfill",null,[_i,Yo,_i]],["h3SetToLinkedGeo",null,[_i,Sn,_i]],["destroyLinkedPolygon",null,[_i]],["compact",Sn,[_i,_i,Sn]],["uncompact",Sn,[_i,Sn,_i,Sn,Yo]],["maxUncompactSize",Sn,[_i,Sn,Yo]],["h3IsPentagon",hp,[Fn,Xn]],["h3IsResClassIII",hp,[Fn,Xn]],["h3GetBaseCell",Sn,[Fn,Xn]],["h3GetResolution",Sn,[Fn,Xn]],["maxFaceCount",Sn,[Fn,Xn]],["h3GetFaces",null,[Fn,Xn,_i]],["h3ToParent",Fn,[Fn,Xn,Yo]],["h3ToChildren",null,[Fn,Xn,Yo,_i]],["h3ToCenterChild",Fn,[Fn,Xn,Yo]],["maxH3ToChildrenSize",Sn,[Fn,Xn,Yo]],["h3IndexesAreNeighbors",hp,[Fn,Xn,Fn,Xn]],["getH3UnidirectionalEdge",Fn,[Fn,Xn,Fn,Xn]],["getOriginH3IndexFromUnidirectionalEdge",Fn,[Fn,Xn]],["getDestinationH3IndexFromUnidirectionalEdge",Fn,[Fn,Xn]],["h3UnidirectionalEdgeIsValid",hp,[Fn,Xn]],["getH3IndexesFromUnidirectionalEdge",null,[Fn,Xn,_i]],["getH3UnidirectionalEdgesFromHexagon",null,[Fn,Xn,_i]],["getH3UnidirectionalEdgeBoundary",null,[Fn,Xn,_i]],["h3Distance",Sn,[Fn,Xn,Fn,Xn]],["h3Line",Sn,[Fn,Xn,Fn,Xn,_i]],["h3LineSize",Sn,[Fn,Xn,Fn,Xn]],["experimentalH3ToLocalIj",Sn,[Fn,Xn,Fn,Xn,_i]],["experimentalLocalIjToH3",Sn,[Fn,Xn,_i,_i]],["hexAreaM2",Sn,[Yo]],["hexAreaKm2",Sn,[Yo]],["edgeLengthM",Sn,[Yo]],["edgeLengthKm",Sn,[Yo]],["pointDistM",Sn,[_i,_i]],["pointDistKm",Sn,[_i,_i]],["pointDistRads",Sn,[_i,_i]],["cellAreaM2",Sn,[Fn,Xn]],["cellAreaKm2",Sn,[Fn,Xn]],["cellAreaRads2",Sn,[Fn,Xn]],["exactEdgeLengthM",Sn,[Fn,Xn]],["exactEdgeLengthKm",Sn,[Fn,Xn]],["exactEdgeLengthRads",Sn,[Fn,Xn]],["numHexagons",Sn,[Yo]],["getRes0Indexes",null,[_i]],["res0IndexCount",Sn],["getPentagonIndexes",null,[Sn,_i]],["pentagonIndexCount",Sn]],sn={};Ope.forEach(function(e){sn[e[0]]=Pt.cwrap.apply(Pt,e)});var df=16,Do=4,Ck=4,eh=8,ho=sn.sizeOfH3Index(),Z2=sn.sizeOfGeoCoord(),d7=sn.sizeOfGeoBoundary(),Fpe=sn.sizeOfGeoPolygon(),jp=sn.sizeOfGeofence(),Npe=sn.sizeOfLinkedGeoPolygon(),p7=sn.sizeOfCoordIJ(),sa={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function md(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var Upe=/[^0-9a-fA-F]/;function mi(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||Upe.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),df),n=parseInt(t.substring(t.length-8),df);return[n,e]}function Pk(t){if(t>=0)return t.toString(df);t=t&2147483647;var e=g7(8,t.toString(df)),n=(parseInt(e[0],df)+8).toString(df);return e=n+e.substring(1),e}function Y2(t,e){return Pk(e)+g7(8,Pk(t))}function g7(t,e){for(var n=t-e.length,i="",r=0;r<n;r++)i+="0";return i=i+e,i}function Ik(t,e,n){for(var i=t.length,r=Pt._calloc(i,Z2),s=n?1:0,u=n?0:1,a=0;a<i*2;a+=2)Pt.HEAPF64.set([t[a/2][s],t[a/2][u]].map(X2),r/eh+a);return Pt.HEAPU32.set([i,r],e/Do),e}function Vpe(t,e){var n=t.length-1,i=Pt._calloc(Fpe),r=0,s=r+jp,u=s+Do;Ik(t[0],i+r,e);var a;if(n>0){a=Pt._calloc(n,jp);for(var y=0;y<n;y++)Ik(t[y+1],a+jp*y,e)}return Pt.setValue(i+s,n,"i32"),Pt.setValue(i+u,a,"i32"),i}function Gpe(t){var e=0,n=e+jp,i=n+Do,r=Do;Pt._free(Pt.getValue(t+e+r,"i8*"));var s=Pt.getValue(t+n,"i32");if(s>0){for(var u=Pt.getValue(t+i,"i32"),a=0;a<s;a++)Pt._free(Pt.getValue(u+jp*a+r,"i8*"));Pt._free(u)}Pt._free(t)}function m7(t){var e=Pt.getTempRet0();return[t,e]}function yd(t){var e=m7(t),n=e[0],i=e[1];return i?Y2(n,i):null}function y7(t,e){e===void 0&&(e=0);var n=Pt.getValue(t+Do*e*2,"i32"),i=Pt.getValue(t+Do*(e*2+1),"i32");return i?Y2(n,i):null}function jpe(t,e,n){Pt.HEAPU32.set(mi(t),e/Do+2*n)}function oA(t,e){for(var n=[],i=0;i<e;i++){var r=y7(t,i);r!==null&&n.push(r)}return n}function LS(t,e){for(var n=e.length,i=0;i<n;i++)jpe(e[i],t,i)}function kk(t,e){var n=Pt._calloc(1,Z2);return Pt.HEAPF64.set([t,e].map(X2),n/eh),n}function Q_(t){return w7(Pt.getValue(t,"double"))}function DS(t){return[Q_(t),Q_(t+eh)]}function _7(t){return[Q_(t+eh),Q_(t)]}function v7(t,e,n){for(var i=Pt.getValue(t,"i32"),r=t+eh,s=[],u=e?_7:DS,a=0;a<i*2;a+=2)s.push(u(r+eh*a));return n&&s.push(s[0]),s}function $pe(t,e){for(var n=[],i=e?_7:DS,r,s,u,a;t;){for(n.push(r=[]),s=Pt.getValue(t,"i8*");s;){for(r.push(u=[]),a=Pt.getValue(s,"i8*");a;)u.push(i(a)),a=Pt.getValue(a+eh*2,"i8*");e&&u.push(u[0]),s=Pt.getValue(s+Ck*2,"i8*")}t=Pt.getValue(t+Ck*2,"i8*")}return n}function Hpe(t){return{i:Pt.getValue(t,"i32"),j:Pt.getValue(t+Do,"i32")}}function Wpe(t,e){var n=e.i,i=e.j;Pt.setValue(t,n,"i32"),Pt.setValue(t+Do,i,"i32")}function Qpe(t,e){for(var n=[],i=0;i<e;i++){var r=Pt.getValue(t+Do*i,"i32");r>=0&&n.push(r)}return n}function x7(t){var e=mi(t),n=e[0],i=e[1];return!!sn.h3IsValid(n,i)}function qpe(t){var e=mi(t),n=e[0],i=e[1];return!!sn.h3IsPentagon(n,i)}function Zpe(t){var e=mi(t),n=e[0],i=e[1];return!!sn.h3IsResClassIII(n,i)}function Ype(t){var e=mi(t),n=e[0],i=e[1];return sn.h3GetBaseCell(n,i)}function Xpe(t){var e=mi(t),n=e[0],i=e[1],r=sn.maxFaceCount(n,i),s=Pt._malloc(Do*r);sn.h3GetFaces(n,i,s);var u=Qpe(s,r);return Pt._free(s),u}function Kpe(t){var e=mi(t),n=e[0],i=e[1];return sn.h3IsValid(n,i)?sn.h3GetResolution(n,i):-1}function Jpe(t,e,n){var i=Pt._malloc(Z2);Pt.HEAPF64.set([t,e].map(X2),i/eh);var r=yd(sn.geoToH3(i,n));return Pt._free(i),r}function ege(t){var e=Pt._malloc(Z2),n=mi(t),i=n[0],r=n[1];sn.h3ToGeo(i,r,e);var s=DS(e);return Pt._free(e),s}function tge(t,e){var n=Pt._malloc(d7),i=mi(t),r=i[0],s=i[1];sn.h3ToGeoBoundary(r,s,n);var u=v7(n,e,e);return Pt._free(n),u}function nge(t,e){var n=mi(t),i=n[0],r=n[1];return yd(sn.h3ToParent(i,r,e))}function ige(t,e){if(!x7(t))return[];var n=mi(t),i=n[0],r=n[1],s=sn.maxH3ToChildrenSize(i,r,e),u=Pt._calloc(s,ho);sn.h3ToChildren(i,r,e,u);var a=oA(u,s);return Pt._free(u),a}function rge(t,e){var n=mi(t),i=n[0],r=n[1];return yd(sn.h3ToCenterChild(i,r,e))}function sge(t,e){var n=mi(t),i=n[0],r=n[1],s=sn.maxKringSize(e),u=Pt._calloc(s,ho);sn.kRing(i,r,e,u);var a=oA(u,s);return Pt._free(u),a}function oge(t,e){var n=mi(t),i=n[0],r=n[1],s=sn.maxKringSize(e),u=Pt._calloc(s,ho),a=Pt._calloc(s,Do);sn.kRingDistances(i,r,e,u,a);for(var y=[],w=0;w<e+1;w++)y.push([]);for(var I=0;I<s*2;I+=2){var P=Pt.getValue(u+Do*I,"i32"),L=Pt.getValue(u+Do*(I+1),"i32"),U=Pt.getValue(a+Do*(I/2),"i32");(P!==0||L!==0)&&y[U].push(Y2(P,L))}return Pt._free(u),Pt._free(a),y}function age(t,e){var n=e===0?1:6*e,i=Pt._calloc(n,ho),r=sn.hexRing.apply(sn,mi(t).concat([e],[i]));if(r!==0)throw Pt._free(i),new Error("Failed to get hexRing (encountered a pentagon?)");var s=oA(i,n);return Pt._free(i),s}function lge(t,e,n){if(md(e),n=!!n,t.length===0||t[0].length===0)return[];typeof t[0][0]=="number"&&(t=[t]);var i=Vpe(t,n),r=sn.maxPolyfillSize(i,e),s=Pt._calloc(r,ho);sn.polyfill(i,e,s);var u=oA(s,r);return Pt._free(s),Gpe(i),u}function Age(t,e){if(!t||!t.length)return[];var n=t.length,i=Pt._calloc(n,ho);LS(i,t);var r=Pt._calloc(Npe),s=r;sn.h3SetToLinkedGeo(i,n,r);var u=$pe(r,e);return sn.destroyLinkedPolygon(s),Pt._free(s),Pt._free(i),u}function uge(t){if(!t||!t.length)return[];var e=t.length,n=Pt._calloc(e,ho);LS(n,t);var i=Pt._calloc(e,ho),r=sn.compact(n,i,e);if(r!==0)throw Pt._free(n),Pt._free(i),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var s=oA(i,e);return Pt._free(n),Pt._free(i),s}function cge(t,e){if(md(e),!t||!t.length)return[];var n=t.length,i=Pt._calloc(n,ho);LS(i,t);var r=sn.maxUncompactSize(i,n,e),s=Pt._calloc(r,ho),u=sn.uncompact(i,n,s,r,e);if(u!==0)throw Pt._free(i),Pt._free(s),new Error("Failed to uncompact (bad resolution?)");var a=oA(s,r);return Pt._free(i),Pt._free(s),a}function hge(t,e){var n=mi(t),i=n[0],r=n[1],s=mi(e),u=s[0],a=s[1];return!!sn.h3IndexesAreNeighbors(i,r,u,a)}function fge(t,e){var n=mi(t),i=n[0],r=n[1],s=mi(e),u=s[0],a=s[1];return yd(sn.getH3UnidirectionalEdge(i,r,u,a))}function dge(t){var e=mi(t),n=e[0],i=e[1];return yd(sn.getOriginH3IndexFromUnidirectionalEdge(n,i))}function pge(t){var e=mi(t),n=e[0],i=e[1];return yd(sn.getDestinationH3IndexFromUnidirectionalEdge(n,i))}function gge(t){var e=mi(t),n=e[0],i=e[1];return!!sn.h3UnidirectionalEdgeIsValid(n,i)}function mge(t){var e=mi(t),n=e[0],i=e[1],r=2,s=Pt._calloc(r,ho);sn.getH3IndexesFromUnidirectionalEdge(n,i,s);var u=oA(s,r);return Pt._free(s),u}function yge(t){var e=mi(t),n=e[0],i=e[1],r=6,s=Pt._calloc(r,ho);sn.getH3UnidirectionalEdgesFromHexagon(n,i,s);var u=oA(s,r);return Pt._free(s),u}function _ge(t,e){var n=Pt._malloc(d7),i=mi(t),r=i[0],s=i[1];sn.getH3UnidirectionalEdgeBoundary(r,s,n);var u=v7(n,e);return Pt._free(n),u}function vge(t,e){var n=mi(t),i=n[0],r=n[1],s=mi(e),u=s[0],a=s[1];return sn.h3Distance(i,r,u,a)}function xge(t,e){var n=mi(t),i=n[0],r=n[1],s=mi(e),u=s[0],a=s[1],y=sn.h3LineSize(i,r,u,a);if(y<0)throw new Error("Line cannot be calculated");var w=Pt._calloc(y,ho);sn.h3Line(i,r,u,a,w);var I=oA(w,y);return Pt._free(w),I}function wge(t,e){var n=Pt._malloc(p7),i=sn.experimentalH3ToLocalIj.apply(sn,mi(t).concat(mi(e),[n])),r=Hpe(n);switch(Pt._free(n),i){case 0:return r;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function bge(t,e){if(!e||typeof e.i!="number"||typeof e.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var n=Pt._malloc(p7),i=Pt._malloc(ho);Wpe(n,e);var r=sn.experimentalLocalIjToH3.apply(sn,mi(t).concat([n],[i])),s=y7(i);if(Pt._free(n),Pt._free(i),r!==0)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return s}function Ege(t,e,n){var i=kk(t[0],t[1]),r=kk(e[0],e[1]),s;switch(n){case sa.m:s=sn.pointDistM(i,r);break;case sa.km:s=sn.pointDistKm(i,r);break;case sa.rads:s=sn.pointDistRads(i,r);break;default:s=null}if(Pt._free(i),Pt._free(r),s===null)throw new Error("Unknown unit: "+n);return s}function Tge(t,e){var n=mi(t),i=n[0],r=n[1];switch(e){case sa.m2:return sn.cellAreaM2(i,r);case sa.km2:return sn.cellAreaKm2(i,r);case sa.rads2:return sn.cellAreaRads2(i,r);default:throw new Error("Unknown unit: "+e)}}function Sge(t,e){var n=mi(t),i=n[0],r=n[1];switch(e){case sa.m:return sn.exactEdgeLengthM(i,r);case sa.km:return sn.exactEdgeLengthKm(i,r);case sa.rads:return sn.exactEdgeLengthRads(i,r);default:throw new Error("Unknown unit: "+e)}}function Mge(t,e){switch(md(t),e){case sa.m2:return sn.hexAreaM2(t);case sa.km2:return sn.hexAreaKm2(t);default:throw new Error("Unknown unit: "+e)}}function Cge(t,e){switch(md(t),e){case sa.m:return sn.edgeLengthM(t);case sa.km:return sn.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function Pge(t){md(t);var e=m7(sn.numHexagons(t)),n=e[0],i=e[1];return i?i*Math.pow(2,32)+n:n}function Ige(){var t=sn.res0IndexCount(),e=Pt._malloc(ho*t);sn.getRes0Indexes(e);var n=oA(e,t);return Pt._free(e),n}function kge(t){md(t);var e=sn.pentagonIndexCount(),n=Pt._malloc(ho*e);sn.getPentagonIndexes(t,n);var i=oA(n,e);return Pt._free(n),i}function X2(t){return t*Math.PI/180}function w7(t){return t*180/Math.PI}const Lge=Object.freeze(Object.defineProperty({__proto__:null,UNITS:sa,cellArea:Tge,compact:uge,degsToRads:X2,edgeLength:Cge,exactEdgeLength:Sge,experimentalH3ToLocalIj:wge,experimentalLocalIjToH3:bge,geoToH3:Jpe,getDestinationH3IndexFromUnidirectionalEdge:pge,getH3IndexesFromUnidirectionalEdge:mge,getH3UnidirectionalEdge:fge,getH3UnidirectionalEdgeBoundary:_ge,getH3UnidirectionalEdgesFromHexagon:yge,getOriginH3IndexFromUnidirectionalEdge:dge,getPentagonIndexes:kge,getRes0Indexes:Ige,h3Distance:vge,h3GetBaseCell:Ype,h3GetFaces:Xpe,h3GetResolution:Kpe,h3IndexToSplitLong:mi,h3IndexesAreNeighbors:hge,h3IsPentagon:qpe,h3IsResClassIII:Zpe,h3IsValid:x7,h3Line:xge,h3SetToMultiPolygon:Age,h3ToCenterChild:rge,h3ToChildren:ige,h3ToGeo:ege,h3ToGeoBoundary:tge,h3ToParent:nge,h3UnidirectionalEdgeIsValid:gge,hexArea:Mge,hexRing:age,kRing:sge,kRingDistances:oge,numHexagons:Pge,pointDist:Ege,polyfill:lge,radsToDegs:w7,splitLongToh3Index:Y2,uncompact:cge},Symbol.toStringTag,{value:"Module"})),Dge=yN(Lge);var Dg=Dge,K2="Feature",b7="FeatureCollection",q_="Polygon",RS="MultiPolygon";function E7(t){for(var e=null,n=0;n<t.length;n++)if(e!==null)for(var i=0;i<t[n].length;i++)e.push(t[n][i]);else e=t[n];return Array.from(new Set(e))}function Rge(t){for(var e=0,n=0,i=0,r=t[0],s=0;s<r.length;s++)e+=r[s][0],n+=r[s][1],i++;return[e/i,n/i]}function Bge(t,e){var n=t.features;if(!n)throw new Error("No features found");return E7(n.map(function(i){return T7(i,e)}))}function T7(t,e,n){n===void 0&&(n={});var i=t.type,r=t.geometry,s=r&&r.type;if(i===b7)return Bge(t,e);if(i!==K2)throw new Error("Unhandled type: "+i);if(s!==q_&&s!==RS)throw new Error("Unhandled geometry type: "+s);var u=s===q_?[r.coordinates]:r.coordinates;return E7(u.map(function(a){var y=Dg.polyfill(a,e,!0);if(y.length||!n.ensureOutput)return y;var w=Rge(a),I=w[0],P=w[1];return[Dg.geoToH3(P,I,e)]}))}function S7(t,e){e===void 0&&(e={});var n=[Dg.h3ToGeoBoundary(t,!0)];return{type:K2,id:t,properties:e,geometry:{type:q_,coordinates:n}}}function zge(t,e){e===void 0&&(e={});var n=Dg.h3SetToMultiPolygon(t,!0),i=n.length>1,r=i?RS:q_,s=i?n:n[0]||[];return{type:K2,properties:e,geometry:{type:r,coordinates:s}}}function Oge(t,e){e===void 0&&(e={});var n=t.map(function(i){return[Dg.h3ToGeoBoundary(i,{geoJson:!0})]});return{type:K2,properties:e,geometry:{type:RS,coordinates:n}}}function Fge(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i],s=e?e(r):{};n.push(S7(r,s))}return{type:b7,features:n}}var Nge={featureToH3Set:T7,h3ToFeature:S7,h3SetToFeature:zge,h3SetToMultiPolygonFeature:Oge,h3SetToFeatureCollection:Fge},Lk=Nge;function Uge({curOption:t}){const[e,n]=_t.useState(null),[i,r]=_t.useState({}),[s,u]=_t.useState([]),[a,y]=_t.useState({}),[w,I]=_t.useState({type:"FeatureCollection",features:[]}),[P,L]=_t.useState({}),[U,Q]=_t.useState(!1),Z=_t.useCallback(({object:Y})=>{if(!Y){n(null),r({}),u([]);return}if(!(t>1)){if(U)n(null),r({}),u(Y.properties.DU_ID);else{const te=Lk.h3ToFeature(Y.hexId),re={};for(const de of Y.properties.DURgs){const ve=xI[de],Me=Mk(te,ve.geometry);re[ve.properties.DU_ID]=fk(Me)/fk(te)}r(re),n(Y.hexId)}return!0}},[a,U,t]),ae=_t.useCallback(({object:Y},te)=>{if(Y.properties.DU_ID==s)return I({type:"FeatureCollection",features:[]}),L({}),y({}),Q(!1),!0;if(Y.properties.GroundwaterVar==null)return;if(te.srcEvent.shiftKey)return y(Me=>({...Me,[Y.hexId]:Y.properties.DURgs})),!0;Q(!0),n(null),r({}),u(Y.properties.DU_ID),y({});const re={...a,[Y.hexId]:Y.properties.DURgs};y(re);const de={},ve={type:"FeatureCollection",features:[]};for(const Me in re)for(const He of re[Me]){const Qe=xI[He],et=Lk.h3ToFeature(Me),tt=Mk(et,Qe.geometry);ve.features.push({...tt,properties:{...Qe.properties}}),de[Qe.properties.DU_ID]={...Qe.properties}}return L(de),I(ve),!0},[a,s,U]);return{hoveredHex:e,clickedHexes:a,hoveredGeos:i,selectedGeoJSON:w,selectedGeos:P,hoveredGeoActive:s,onHover:Z,onClick:ae,selectionFinalized:U}}const Cw=t=>!!(t.properties||{}).DU_ID;function Vge({slide:t,curScenario:e,speedyCounter:n,curOption:i}){const r=_t.useRef(),s=_t.useRef(),u=_t.useRef(),a=_t.useRef({});return _t.useEffect(()=>{r.current=document.querySelector("#main-tooltip"),u.current=document.querySelector("#secondary-tooltip")},[]),{getTooltip:_t.useCallback(({object:w})=>{if(!w){a.current&&(Cw(a.current)?u.current.classList.remove("active"):(u.current.classList.remove("active"),r.current.classList.remove("active")),a.current=w),i>1&&(u.current.classList.remove("active"),r.current.classList.remove("active"));return}a.current&&Cw(a.current)&&u.current.classList.remove("active");const I=py(n);i<=1&&Cw(w)?(r.current.classList.add("active"),r.current.innerHTML=s.current,u.current.classList.add("active"),u.current.innerHTML=`      ${w.properties.DU_ID?`<div><b>Region ID</b> ${w.properties.DU_ID}</div>`:""}
      <div><b>Scenario Demand</b> ${e>-1?w.properties.Demand[ii[e]][n]:w.properties.DemandBaseline[n]}</div>
      <div><b>Scen. Unmet Demand</b> ${e>-1?-w.properties.UnmetDemand[ii[e]][n]:-w.properties.UnmetDemandBaseline[n]}</div>
      <div><b>Difference in Unmet Demand</b> ${w.properties.UnmetDemand[ii[e]][n]-w.properties.UnmetDemandBaseline[n]}</div>
      <div><b>Land Holder</b> ${nk[w.properties.LandUse.constructor===Array?w.properties.LandUse[0]:w.properties.LandUse]}</div>
  `):(r.current.classList.add("active"),w.properties.GroundwaterVar==null?r.current.innerHTML=s.current=`        <div><i>${I.toLocaleString("default",{month:"long"})} ${I.toLocaleString("default",{year:"numeric"})}</i></div>
        <div><i>${w.properties.DU_ID?e>-1?ik[e]:"Historical Baseline":""}</i></div>
        ${w.properties.DU_ID?`<b>Region ID</b> ${w.properties.DU_ID}</div>`:""}
        ${w.properties.elem_id?`<b>Elem ID</b> ${w.properties.elem_id}</div>`:""}
        ${w.properties.Groundwater?`<div><b>Groundwater</b> ${w.properties.Groundwater[n]}</div>`:""}
        ${w.properties.DU_ID?`
          <div><b>Scenario Demand</b> ${e>-1?w.properties.Demand[ii[e]][n]:w.properties.DemandBaseline[n]}</div>
          <div><b>Scen. Unmet Demand</b> ${e>-1?-w.properties.UnmetDemand[ii[e]][n]:-w.properties.UnmetDemandBaseline[n]}</div>
          <div><b>Difference in Unmet Demand</b> ${w.properties.UnmetDemand[ii[e]][n]-w.properties.UnmetDemandBaseline[n]}</div>`:""}
      `:r.current.innerHTML=s.current=`        <div><i>${I.toLocaleString("default",{month:"long"})} ${I.toLocaleString("default",{year:"numeric"})}</i></div>
        <div><i>${e>-1?ik[e]:"Historical Baseline"}</i></div>
      ${w.properties.DU_ID?`<b>Region ID</b> ${w.properties.DU_ID}</div>`:""}
      ${w.properties.Groundwater?`<div><b>Groundwater</b> ${w.properties.Groundwater[n]}</div>`:""}
      <div><b>Scenario Demand</b> ${e>-1?w.properties.Demand[ii[e]][n]:w.properties.DemandBaseline[n]}</div>
      <div><b>Scen. Unmet Demand</b> ${e>-1?-w.properties.UnmetDemand[ii[e]][n]:-w.properties.UnmetDemandBaseline[n]}</div>
      <div><b>Difference in Unmet Demand</b> ${w.properties.UnmetDemand[ii[e]][n]-w.properties.UnmetDemandBaseline[n]}</div>
      <div><b>Land Holder</b> ${nk[w.properties.LandUse.constructor===Array?w.properties.LandUse[0]:w.properties.LandUse]}</div>
      ${w.properties.GroundwaterVar?`<div><b>Variance (GW)</b> ${w.properties.GroundwaterVar[n]}
      </div>`:""}
      ${w.properties.UnmetDemandVar?`<div><b>Var. (Scen. UnmetDem)</b> ${w.properties.UnmetDemandVar[ii[e]][n]}
      </div>`:""}
      ${w.properties.UnmetDemandVar?`<div><b>Var. (Difference)</b> ${c3(w.properties.UnmetDemandBaselineVar[n],w.properties.UnmetDemandVar[ii[e]][n])}
      </div>`:""}
      ${w.properties.DURgs?`<div><b>Demand Regions</b> ${w.properties.DURgs.join(", ")}</div>`:""}
      ${w.properties.GWRgs?`<div><b>GW Regions</b> ${w.properties.GWRgs.join(", ")}</div>`:""}
  `),a.current=w},[t,n,e,i])}}const Gge=hr().domain([0,1]).range(ST(0,Kc.length));class jge extends y2{initializeState(e,n){if(!n.isEnabled(this))return;const i=this.getAttributeManager();n.opts.pattern&&i.add({colorFrames:{size:4,accessor:"getColor",shaderAttributes:{colorFrames:{divisor:0},instanceColorFrames:{divisor:1}}}})}getShaders(){return{inject:{"fs:#decl":"uniform vec4 tint;","fs:DECKGL_FILTER_COLOR":`
          color *= tint;
        `},getUniforms:function(e,n){if(!e)return{}}}}updateState(e){const{tint:n=[1,0,0,1]}=e.props;for(const i of this.getModels())i.setUniforms({tint:n})}getSubLayerProps(){const{tint:e=[1,0,0,1]}=params.props;return{tint:e}}}class M7 extends Kn{initializeState(){super.initializeState();const{zoom:e}=this.context.viewport,n=Object.keys(this.props.data).map(r=>parseInt(r)),i=hr().domain([0,1]).range(n)(Kh(e));this.setState({hextiles:this.props.data,resRange:n,lastResolution:i}),this.createPolygons()}createPolygons(){const{hextiles:e,lastResolution:n}=this.state,i=[],r=e[n],[s,u]=this.props.offset;Object.keys(r).forEach(a=>{const y=r[a],w=$_(j_(a)[0],Lo.km)*.48,[I,P]=q2(a);let L=0;for(let[U,Q,Z]of this.props.getValue?Kc[Gge(this.props.getValue({properties:y}))]:[[0,0,0]])i.push({position:[P+(U+s)*w/(111.32*Math.cos(I*Math.PI/180)),I+(Q+u)*w/110.574,(typeof this.props.getElevation=="function"?this.props.getElevation({properties:y}):this.props.getElevation)+Z*1e6+1500],properties:y,polyIdx:L++,hexID:a})}),this.setState({...this.state,polygons:i})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:i}=this.state,{props:r,oldProps:s,changeFlags:u,context:a}=e;if(r.getValue!=s.getValue||r.getElevation!=s.getElevation||u.viewportChanged){const y=hr().domain([0,1]).range(n)(Kh(a.viewport.zoom));(r.getValue!=s.getValue||y!=i||r.getElevation!=s.getElevation)&&(this.setState({...this.state,lastResolution:y}),this.createPolygons())}}renderLayers(){const{polygons:e,lastResolution:n,resRange:i}=this.state,r=id(n,Lo.km)/id(5,Lo.km);return[new tm(this.getSubLayerProps({data:this.props.data,mesh:this.props.mesh,texture:this.props.texture,textureParameters:this.props.textureParameters,getPosition:this.props.getPosition,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,sizeScale:this.props.sizeScale,_useMeshColors:this.props._useMeshColors,_instanced:this.props._instanced,wireframe:this.props.wireframe,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,id:"BillboardIconHexTileLayer",data:e,iconAtlas:this.props.iconAtlas,iconMapping:{marker:{x:0,y:0,width:128,height:128,mask:!1}},sizeUnits:"meters",getIcon:s=>"marker",getPosition:s=>s.position,sizeScale:4e3*r,extensions:[new jge]}))]}}M7.layerName="BillboardIconHexTileLayer";M7.defaultProps={...Kn.defaultProps,...f0.defaultProps,thicknessRange:[.7,.9],getValue:null,getElevation:()=>0,offset:[0,0]};function $ge(){const[t,e]=_t.useState(1),n=_t.useRef(),i=Uge({curOption:t}),r={data:em,curOption:t,curScenario:0,setCurOption:e,...i},s=Hge(),u=Ape(r),{curViewState:a,transitioning:y}=lpe(r),{getTooltip:w}=Vge({...r,...u}),I={...r,...u,transitioning:y};_t.useLayoutEffect(()=>{Sa(n.current).attr("width",400).attr("height",500).call(function(Q){Q.append("g").call(ek.arcmapLegend().vtitle("Groundwater").utitle("Variance").scale(YO).size(150).x(400-180).y(500-300))}).call(function(Q){Q.append("g").call(ek.simpleLegend().title("Difference w/ Baseline").size(250).height(20).scale(yS).x(400-280).y(500-100))})},[]);const P=[new IS(I),new BS({...I,...s}),new zS({...I,...s})];return Ci.createElement(Ci.Fragment,null,Ci.createElement(KJ,{layers:P,effects:[fde],initialViewState:a,controller:!0,getTooltip:w},Ci.createElement(Mee,{reuseMaps:!0,mapLib:eee,mapStyle:Oee,preventStyleDiffing:!0})),Ci.createElement(ape,{counter:u.speedyCounter,displayMonth:!1,dataset:"averageDemandBaseline"}),Ci.createElement(Wge,{...I,...s}),Ci.createElement("svg",{className:"legend-area",ref:n}))}class BS extends Kn{initializeState(){super.initializeState(),this.setState({data0:ks(this.props.data,e=>e.LandUse[0]==0),data1:ks(this.props.data,e=>e.LandUse[0]==1),data2:ks(this.props.data,e=>e.LandUse[0]==2),data3:ks(this.props.data,e=>e.LandUse[0]==3)})}renderLayers(){const{data:e,curOption:n,speedyCounter:i,hoveredHex:r,clickedHexes:s,hoveredGeoActive:u,hoveredGeos:a,selectedGeoJSON:y,selectedGeos:w,selectionFinalized:I}=this.props;return[new yr({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:P=>ede(P.properties.Groundwater[i],P.properties.GroundwaterVar[i]),opacity:1,visible:n==0||n==1,updateTriggers:{getFillColor:[i]}}),new yr({id:"DiffRings",data:e,thicknessRange:[.4,.65],getFillColor:P=>n==0?tde(P.properties.UnmetDemand[ii[0]][i]-P.properties.UnmetDemandBaseline[i],c3(P.properties.UnmetDemandBaselineVar[i],P.properties.UnmetDemandVar[ii[0]][i]),!0):Xh(P.properties.UnmetDemand[ii[0]][i]-P.properties.UnmetDemandBaseline[i],!0),getValue:P=>n==0?1:$O(c3(P.properties.UnmetDemandBaselineVar[i],P.properties.UnmetDemandVar[ii[0]][i])),raised:!0,visible:n==0||n==1,getElevation:P=>P.hexId in s?5e3:0,getLineWidth:P=>P.hexId in s?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new R2({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,i],getValue:[n,i],getElevation:[I],getLineWidth:[I]}}),new Or({id:"ScenarioUnmet",data:e,loaders:[gr],mesh:"./assets/drop.obj",raised:!0,getColor:P=>[255,130,35,(1-Yfe(P.properties.UnmetDemandBaselineVar[i]))*200+55],getValue:P=>Hc(P.properties.UnmetDemand[ii[0]][i]),visible:n==0||n==1,sizeScale:3e3,opacity:1,updateTriggers:{getTranslation:[i]}}),new dl({id:"GeoJsonExt",data:y,opacity:.75,extruded:!0,getElevation:P=>e7(P.properties.UnmetDemand[ii[0]][i]),visible:n==0||n==1,pickable:!0,getLineWidth:100,getFillColor:P=>{let L=Ph(P.properties.UnmetDemand[ii[0]][i]);if(L[3]==0&&(L=[255,255,255,255]),P.properties.DU_ID==u){const U=[0,0,.5019607843137255,.5019607843137255];return[(U[0]*U[3]+L[0]/255*(1-U[3]))*255,(U[1]*U[3]+L[1]/255*(1-U[3]))*255,(U[2]*U[3]+L[2]/255*(1-U[3]))*255,(U[3]*U[3]+L[3]/255*(1-U[3]))*255]}return L},updateTriggers:{getFillColor:[n,i,u,I],getElevation:[n,i]}}),new dl({id:"GeoJsonGray",data:Qh,opacity:.3,stroked:!1,getFillColor:P=>!I&&P.properties.DU_ID in a?[100,100,100,205*a[P.properties.DU_ID]+50]:[0,0,0,0],visible:!I&&n==0||n==1,updateTriggers:{getFillColor:[r,I]}}),new dl({id:"GeoJsonColor",data:{type:"FeatureCollection",features:Qh.features.filter(P=>P.properties.DU_ID in w)},opacity:.3,pickable:!0,visible:n==0||n==1,getLineWidth:P=>P.properties.DU_ID==u?100:20,getFillColor:P=>{if(P.properties.DU_ID==u){const L=[0,0,.5019607843137255,.5019607843137255],U=Ph(n>-1?w[P.properties.DU_ID].UnmetDemand[ii[0]][i]:w[P.properties.DU_ID].UnmetDemandBaseline[i]);return[(L[0]*L[3]+U[0]/255*(1-L[3]))*255,(L[1]*L[3]+U[1]/255*(1-L[3]))*255,(L[2]*L[3]+U[2]/255*(1-L[3]))*255,(L[3]*L[3]+U[3]/255*(1-L[3]))*255]}return P.properties.DU_ID in w?Ph(n>-1?w[P.properties.DU_ID].UnmetDemand[ii[0]][i]:w[P.properties.DU_ID].UnmetDemandBaseline[i]):[0,0,0,0]},getLineColor:[0,0,0],updateTriggers:{getFillColor:[u,n,I],getLineWidth:[u]}}),new yr({id:"HoveringTiles",data:e,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:!I,autoHighlight:!I,visible:n==0||n==1})]}}BS.layerName="CentralValleyWaterSlide";BS.defaultProps={...Kn.defaultProps,autoHighlight:!0};function Hge(){return{}}function Wge({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:i,playing:r,setPlaying:s}){return Ci.createElement(Ci.Fragment,null,Ci.createElement("div",{className:"styled-input"},Ci.createElement("button",{onClick:()=>{s(u=>!u)}},r?"Pause":"Play"),Ci.createElement("div",null,Ci.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:n,onChange:function(u){i(parseInt(u.target.value))}}),Ci.createElement("input",{onChange:function(u){s(!1),i(parseInt(u.target.value))},onInput:function(u){i(parseInt(u.target.value))},value:n,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))),Ci.createElement("div",{onChange:function(u){e(u.target.value)},style:{position:"absolute",display:"block",bottom:"60%",right:"0",transform:"translateY(50%)"}},Ci.createElement("div",null,Ci.createElement("input",{type:"radio",name:"option",value:"0",checked:t==0}),Ci.createElement("label",{htmlFor:"option1"},"Option 1")),Ci.createElement("div",null,Ci.createElement("input",{type:"radio",name:"option",value:"1",checked:t==1}),Ci.createElement("label",{htmlFor:"option2"},"Option 2")),Ci.createElement("div",null,Ci.createElement("input",{type:"radio",name:"option",value:"2",checked:t==2}),Ci.createElement("label",{htmlFor:"option2"},"GW")),Ci.createElement("div",null,Ci.createElement("input",{type:"radio",name:"option",value:"3",checked:t==3}),Ci.createElement("label",{htmlFor:"option2"},"Scenario Unmet Dem")),Ci.createElement("div",null,Ci.createElement("input",{type:"radio",name:"option",value:"4",checked:t==4}),Ci.createElement("label",{htmlFor:"option2"},"Difference"))))}class zS extends Kn{initializeState(){super.initializeState()}renderLayers(){const{data:e,curOption:n,speedyCounter:i,hoveredHex:r,clickedHexes:s,hoveredGeoActive:u,hoveredGeos:a,selectedGeoJSON:y,selectedGeos:w,selectionFinalized:I}=this.props;return[new dl({id:"GroundwaterGeo",data:Hoe,opacity:1,stroked:!1,filled:!0,getFillColor:P=>Object.values({...OA(qO(P.properties.Groundwater[i])),opacity:255}),visible:n==2,updateTriggers:{getFillColor:[i]},pickable:!0,autoHighlight:!0}),new dl({id:"UDemGeo",data:Qh,opacity:1,stroked:!1,filled:!0,getFillColor:P=>Object.values({...OA(ZO(P.properties.UnmetDemand[ii[0]][i])),opacity:255}),visible:n==3,updateTriggers:{getFillColor:[i]},pickable:!0,autoHighlight:!0}),new dl({id:"DemDiffGeo",data:Qh,opacity:1,stroked:!1,filled:!0,getFillColor:P=>Object.values({...OA(yS(P.properties.UnmetDemand[ii[0]][i]-P.properties.UnmetDemandBaseline[i])),opacity:255}),visible:n==4,updateTriggers:{getFillColor:[i]},pickable:!0,autoHighlight:!0})]}}zS.layerName="ControlMap";zS.defaultProps={...Kn.defaultProps,autoHighlight:!0};function Qge(t){$L(t).render(Ci.createElement($ge,null))}Qge(document.getElementById("app"));
