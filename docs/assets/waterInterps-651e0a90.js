import{aX as $,aY as A,aZ as x,j as m,aS as I,p as y,s as _,a_ as b,a$ as d,l as M,b0 as P}from"./settings-71d1aff4.js";import{r as o}from"./index-7d9125c4.js";import{d as f}from"./scales-aa151059.js";import{s as G}from"./selectAll-9991ac0f.js";function j(t,i){let e;if(i===void 0)for(const n of t)n!=null&&(e<n||e===void 0&&n>=n)&&(e=n);else{let n=-1;for(let s of t)(s=i(s,++n,t))!=null&&(e<s||e===void 0&&s>=s)&&(e=s)}return e}var U=L($);function N(t){this._curve=t}N.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,i){this._curve.point(i*Math.sin(t),i*-Math.cos(t))}};function L(t){function i(e){return new N(t(e))}return i._curve=t,i}function D(t){var i=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(e){return arguments.length?i(L(e)):i()._curve},t}function v(){return D(A().curve(U))}function S(t,i,e){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-i),t._y2+t._k*(t._y1-e),t._x2,t._y2)}function g(t,i){this._context=t,this._k=(1-i)/6}g.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:S(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,i){switch(t=+t,i=+i,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,i):this._context.moveTo(t,i);break;case 1:this._point=2,this._x1=t,this._y1=i;break;case 2:this._point=3;default:S(this,t,i);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=i}};(function t(i){function e(n){return new g(n,i)}return e.tension=function(n){return t(+n)},e})(0);function B(t,i,e){var n=t._x1,s=t._y1,l=t._x2,c=t._y2;if(t._l01_a>x){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,h=3*t._l01_a*(t._l01_a+t._l12_a);n=(n*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/h,s=(s*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/h}if(t._l23_a>x){var a=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,r=3*t._l23_a*(t._l23_a+t._l12_a);l=(l*a+t._x1*t._l23_2a-i*t._l12_2a)/r,c=(c*a+t._y1*t._l23_2a-e*t._l12_2a)/r}t._context.bezierCurveTo(n,s,l,c,t._x2,t._y2)}function T(t,i){this._context=t,this._alpha=i}T.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,i){if(t=+t,i=+i,this._point){var e=this._x2-t,n=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,i):this._context.moveTo(t,i);break;case 1:this._point=2;break;case 2:this._point=3;default:B(this,t,i);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=i}};const w=function t(i){function e(n){return i?new T(n,i):new g(n,0)}return e.alpha=function(n){return t(+n)},e}(.5),q=await m("demand_geo_small"),O=await m("hex_5_6",function(i){return I(i,e=>e.DemandBaseline)});function F(){const[t,i]=o.useState(1027),[e,n]=o.useState(!1),[s,l]=o.useState(!1),[c,u]=o.useState(!1);return o.useEffect(()=>{if(e){let h=setTimeout(()=>i(a=>a%1199+1),33.333333333333336);return function(){clearTimeout(h)}}},[t,e]),{speedyCounter:t,setSpeedyCounter:i,playing:e,setPlaying:n,useVsup:s,setUseVsup:l,showAllRings:c,setShowAllRings:u}}const p=await m("averages"),k=d("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),R=d("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),E=d("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),C=d("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t));function H({counter:t,displayMonth:i,dataset:e}){const n=(t+9)%12+1,s=o.useRef();o.useEffect(()=>{s.current=Object.groupBy(p[e],(a,r)=>f(r).toLocaleString("default",{year:"numeric"}))},[e]);const l=y().domain([0,j(p[e],a=>a)]).range([40,90]),c=y().domain([1,12]).range([0,2*Math.PI]),u=v().radius(a=>l(a)).curve(w).angle((a,r)=>c((r+9)%12+1)),h=v().radius(a=>l(a)).curve(w).angle((a,r)=>c(r%12+1));o.useEffect(()=>(_("#clockContainer").style("visibility","visible"),_("#pieOutline path").attr("d",b().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*2)).attr("fill","none").attr("stroke",e=="averageGroundwater"?`rgb(${k})`:`rgba(${E}, 1)`),_("#demandLine path").data([p[e]]).join("path").attr("d",a=>u(a)).attr("stroke",e=="averageGroundwater"?`rgba(${R}, 0.3)`:`rgba(${C}, 0.3)`).attr("stroke-width","0.2").attr("fill","none"),function(){_("#clockContainer").style("visibility","hidden"),_("#pie path").attr("d",""),_("#pieOutline path").attr("d",""),_("#demandLine path").attr("d",""),_("#demandLineCur path").attr("d",""),_("#date").text("")}),[e]),o.useEffect(()=>{_("#pie path").attr("d",b().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*n/12*2)).attr("fill",e=="averageGroundwater"?`rgb(${k})`:`rgba(${E}, 1)`);let a=f(t);i?_("#date").html("<b>"+a.toLocaleString("default",{year:"numeric"})+"</b><br/>"+a.toLocaleString("default",{month:"long"})):_("#date").html("<b>"+a.toLocaleString("default",{year:"numeric"})+"</b>"),G("#demandLineCur path").data([s.current[f(t).toLocaleString("default",{year:"numeric"})]]).join("path").attr("d",r=>h(r)).attr("stroke",e=="averageGroundwater"?`rgba(${R}, 1)`:`rgba(${C}, 1)`).attr("stroke-width","2").attr("fill","none")},[e,t])}const X=M(P,O);export{H as C,X as W,q as d,F as u,O as w};
